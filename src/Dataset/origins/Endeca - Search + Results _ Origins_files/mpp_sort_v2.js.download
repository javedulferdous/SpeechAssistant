var site=site||{};site.template=site.template||{},function(t){Drupal.behaviors.mppSortV2={attach:function(e){var a=this,i=t(".mpp-sort-v2",e),s=t(".js-mpp-sort-menu",i),o=t(".js-mpp-sort-option",i),r=t(".js-mpp-sort-title",i),d=t(".js-mpp-sort-rendered",i),n=t(".js-product-grid-sorted",e);if(n.length){var l=t(".product-grid__item--promo",n),c=t(".js-has-franchise-tout",e);l.removeAttr("tabindex"),o.once().on("click",(function(){var e=t(this),a=e.data("sort-option");e.attr("disabled")||(n.mixItUp("sort",a),"default"===a?l.removeClass("hide-touts"):l.addClass("hide-touts"),d.addClass("hide-sort"),r.removeClass("sort-active"),e.toggleClass("active"),e.attr("selected","selected"),o.removeAttr("selected"))})),r.once().on("click",(function(e){var a=t(this),i=a.siblings(".js-mpp-sort-rendered");i.hasClass("hide-sort")?(d.addClass("hide-sort"),i.removeClass("hide-sort"),a.addClass("sort-active"),e.stopPropagation(),t("body").once().on("click",(function(e){0===t(e.target).closest(".js-mpp-sort-rendered").length&&(r.removeClass("sort-active"),d.addClass("hide-sort"),t("body").off("click"))}))):(i.addClass("hide-sort"),a.removeClass("sort-active"))})),s.on("change",(function(){n.mixItUp("sort",this.value),"default"===this.value?l.removeClass("hide-touts"):l.addClass("hide-touts")})),n.each((function(){var e=t(".js-grid-item",this),i=e.eq(0).data("promo-sort"),s=t(this);if(c.length&&1===i&&e.eq(0).attr("data-promo-sort",3),a.attachRatingsToSort(this),!s.hasClass("mixitup-initialized")){var o=s.addClass("mixitup-initialized"),r={selectors:{target:".js-product-grid-item--sortable",sort:".js-mpp-sort-option"},layout:{display:"block"}};o.on("mixEnd",(function(){o.addClass("mixitup-loaded"),o.data("deferredAnimation")&&o.data("deferredAnimation",!1).data("mixItUp").setOptions({animation:{enable:!0}})})).on("mixitup.initialize",(function(){o.mixItUp("destroy"),o.find(".js-product-grid-item").attr("data-bound","").data("bound",""),r.animation={enable:!1},o.data("deferredAnimation",!0).mixItUp(r)})),o.mixItUp(r)}}))}},attachRatingsToSort:function(e){t(".js-product-grid-item--sortable",e).each((function(){var e=t(this),a=t(".product-brief__review-snippet",e),i=t(".pr-snippet-rating-decimal",e);if(a.length){var s=new MutationObserver((function(a,i){a.forEach((function(a){var s=t(a.addedNodes);s.length&&s.find(".pr-snippet-rating-decimal").each((function(){var a=t(this);e.attr("data-rating-sort",a.text()),i.disconnect()}))}))}));i.length?e.attr("data-rating-sort",i.text()):e.attr("data-rating-sort",0),s.observe(a[0],{childList:!0,subtree:!0})}}))}}}(jQuery);
//# sourceMappingURL=mpp_sort_v2.js.map
