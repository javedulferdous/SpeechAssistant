var generic=generic||{},site=site||{};!function(e){site.signupFooter={templateContainer:e(),initSignUpFooter:function(){var s=this.templateContainer;if(!s.length)return null;s.each((function(){var s=e(this),n=s.is("form")?s:e("form",s),o=e(".signup-footer__fields",s),i=e(".js-signup-footer__success",s),t=e(".signup-footer__success-message",s),r=e(".signup-footer__success-offer",s),a=e(".js-signup-footer__error",s),p=e('input[name="PC_EMAIL_ADDRESS"]',s),u=e('input[name="LANGUAGE_ID"]',s),m=e(".signup-footer__terms-conditions-label",s),d=s.hasClass("show-email-promotion-option"),l=e('input[name="MOBILE_PHONE"]',s),c=e(".signup-footer__terms-conditions-sms-label",s),_=s.hasClass("no-sms-promotion");Drupal.settings.common.has_onelink_trans&&generic.cookie("LOCALE")===Drupal.settings.common.locate_one_link_translation&&u.val(Drupal.settings.common.lang_id_one_link_translation),n.once("js-signup-footer").submit((function(u){u.preventDefault();var g={};i.addClass("hidden"),a.html(""),p.removeClass("error"),_||(c.removeClass("error"),l.removeClass("error")),d&&m.removeClass("error"),e.each(n.serializeArray(),(function(e,s){g[s.name]=s.value.replace("undefined","").replace("%40","@")})),g._TOKEN=e.cookie("csrftoken"),_||s.find('input[name="SMS_PROMOTIONS"]').prop("checked")&&(g.SMS_PROMOTIONS=1),d&&(s.find('input[name="PC_EMAIL_PROMOTIONS"]').prop("checked")?g.PC_EMAIL_PROMOTIONS=1:g.PC_EMAIL_PROMOTIONS=0),e.cookie("csrftoken")&&(g._TOKEN=e.cookie("csrftoken")),generic.jsonrpc.fetch({method:"rpc.form",params:[g],onSuccess:function(){o.addClass("hidden"),i.html(t.val()+"<br>"+r.val()),i.removeClass("hidden")},onFailure:function(o){var i=o.getMessages(),t="",r=["required.pc_email_address.email_signup","invalid.pc_email_address.email_signup","required_dependency.pc_email_address.pc_email_promotions.dependency.email_signup","required_dependency.pc_email_promotions.pc_email_address..dependency.email_signup","format.mobile_phone.sms","invalid.mobile_phone.sms","required_dependency.mobile_phone.sms_promotions.dependency.sms","required_dependency.sms_promotions.mobile_phone.dependency.sms"];a.empty(),s.find("input").removeClass("error"),(i=jQuery.grep(i,(function(e){return""!==e.key&&"system.error"!==e.key}))).sort((function(e,s){return r.indexOf(e.key)-r.indexOf(s.key)}));for(var u=0;u<i.length;u++){var d=i[u];if(d&&d.key){var _=d.tags[2].substr(6).toUpperCase(),g=e("[name="+_+"]",n);g.length&&!g.hasClass("error")&&(t+='<li class="'+d.key+'">'+d.text+"</li>",g.addClass("error")),"required_dependency.pc_email_address.pc_email_promotions.dependency.email_signup"!==d.key&&"required_dependency.pc_email_promotions.pc_email_address..dependency.email_signup"!==d.key||(p.addClass("error"),m.addClass("error")),"required_dependency.mobile_phone.sms_promotions.dependency.sms"!==d.key&&"required_dependency.sms_promotions.mobile_phone.dependency.sms"!==d.key||(l.addClass("error"),c.addClass("error"))}}a.html(t).removeClass("hidden"),generic.focusErrors(e(".js-signup-footer__error"),e(".js-email-signup-processed"))}})}))}))}},Drupal.behaviors.signupFooterV1={attach:function(s){site.signupFooter.content=e(".site-footer-pc__column",s),site.signupFooter.templateContainer=e(".js-signup-footer",s),site.signupFooter.emailSubmit=e(".js-signup-footer__submit",site.signupFooter.templateContainer),site.signupFooter.formInputs=e('input[name="PC_EMAIL_ADDRESS"], input[name="MOBILE_PHONE"]',site.signupFooter.templateContainer),site.signupFooter.emailAddress=e('input[name="PC_EMAIL_ADDRESS"]',site.signupFooter.templateContainer),site.signupFooter.mobileNumberInput=e('input[name="MOBILE_PHONE"]',site.signupFooter.templateContainer),site.signupFooter.smsTermsAndConditions=e(".js-signup-footer__sms-terms-conditions",site.signupFooter.templateContainer),site.signupFooter.emailTermsAndConditions=e(".js-signup-footer__email-terms-conditions",site.signupFooter.templateContainer),site.signupFooter.initSignUpFooter(),site.signupFooter.emailAddress.off("focus").on("focus",(function(){site.signupFooter.emailTermsAndConditions.slideDown(300,(function(){Drupal.behaviors.grids.equalHeights(site.signupFooter.content)})),site.signupFooter.smsTermsAndConditions.slideUp(300,(function(){Drupal.behaviors.grids.equalHeights(site.signupFooter.content)}))})),site.signupFooter.mobileNumberInput.off("focus").on("focus",(function(){site.signupFooter.smsTermsAndConditions.slideDown(300,(function(){Drupal.behaviors.grids.equalHeights(site.signupFooter.content)}))})),e(document).click((function(s){e(s.target).closest(site.signupFooter.templateContainer).length||e(s.target).is(site.signupFooter.templateContainer)||(site.signupFooter.emailTermsAndConditions.is(":visible")&&site.signupFooter.emailTermsAndConditions.slideUp(300,(function(){Drupal.behaviors.grids.equalHeights(site.signupFooter.content)})),site.signupFooter.smsTermsAndConditions.is(":visible")&&site.signupFooter.smsTermsAndConditions.slideUp(300,(function(){Drupal.behaviors.grids.equalHeights(site.signupFooter.content)})))})),site.signupFooter.formInputs.each((function(){e(this).on("focus",(function(){site.signupFooter.emailSubmit.removeClass("hidden")}))}))}}}(jQuery);
//# sourceMappingURL=signup_footer_v1.js.map
