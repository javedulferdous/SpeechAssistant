(window.webpackJsonp=window.webpackJsonp||[]).push([[0,14,30],{1e3:function(t,e,r){"use strict";var o=r(688);r.n(o).a},1001:function(t,e,r){(e=r(7)(!1)).push([t.i,"form[data-v-cdf77906]{color:#31363f}form .loader[data-v-cdf77906]{text-align:center;line-height:3.4375rem}form .cta[data-v-cdf77906]{margin-top:1.5rem;text-align:center}form .cta a[data-v-cdf77906]{cursor:pointer;font-weight:700}",""]),t.exports=e},1002:function(t,e,r){"use strict";var o=r(689);r.n(o).a},1003:function(t,e,r){(e=r(7)(!1)).push([t.i,".success[data-v-a5a215fc]{text-align:center}.success .confirmation[data-v-a5a215fc]{display:flex;color:#26a159;font-size:2.5rem;justify-content:center}.success h2[data-v-a5a215fc]{color:#636c7e;font-weight:700;margin:1.5rem 0 1rem}form[data-v-a5a215fc]{color:#31363f}form p[data-v-a5a215fc]{margin-bottom:1.5rem}form .loader[data-v-a5a215fc]{text-align:center;line-height:3.4375rem}.cta[data-v-a5a215fc]{margin-top:1.5rem;text-align:center}.cta a[data-v-a5a215fc]{font-weight:700;cursor:pointer}",""]),t.exports=e},1006:function(t,e,r){"use strict";var o=r(691);r.n(o).a},1007:function(t,e,r){(e=r(7)(!1)).push([t.i,".content[data-v-12da0f73]{text-align:center;padding:4rem 1.5rem 1.5rem}.content .submit-buttons[data-v-12da0f73]{margin-top:1.5rem}",""]),t.exports=e},1008:function(t,e,r){"use strict";var o=r(692);r.n(o).a},1009:function(t,e,r){(e=r(7)(!1)).push([t.i,".simple-confirmation-modal[data-v-74468a48]{text-align:center}.simple-confirmation-modal h1[data-v-74468a48]{font-weight:700;color:#31363f;margin:1rem 1.5rem .5rem}.simple-confirmation-modal p[data-v-74468a48]{color:#636c7e}",""]),t.exports=e},1044:function(t,e,r){"use strict";var o=r(709);r.n(o).a},1045:function(t,e,r){(e=r(7)(!1)).push([t.i,".terms-conditions[data-v-4342d9d9]{overflow:auto;height:100%}.terms-conditions p[data-v-4342d9d9]{margin-bottom:1rem;color:#31363f}.terms-conditions p[data-v-4342d9d9] ul{margin:1.5rem}.terms-conditions p[data-v-4342d9d9] ul li{list-style:circle}.terms-conditions h3[data-v-4342d9d9]{color:#31363f;margin-bottom:.5rem}.terms-conditions .group-terms-checkbox[data-v-4342d9d9]{padding-top:1rem;border-top:.0625rem solid #f1f2f4}.terms-conditions .group-terms-checkbox p.group-tc-error[data-v-4342d9d9]{color:#636c7e}.terms-conditions .submit-buttons[data-v-4342d9d9]{margin:1rem 0;display:flex;justify-content:flex-end}.terms-conditions .submit-buttons[data-v-4342d9d9] button{text-transform:capitalize}",""]),t.exports=e},1058:function(t,e,r){"use strict";r.r(e);var o=r(432),n=r(314);var l={pt_BR:"Há Termos e Condições adicionais que se aplicam para uma Reserva em Grupo. Leia e clique em 'Aceito' abaixo para continuar a sua reserva",cs_CZ:"",da_DK:"",de_DE:'Da du eine Gruppenbuchung vornimmst, gelten zusätzliche allgemeine Geschäftsbedingungen. Bitte lies dir diese gut durch und klicke dann auf "Ich akzeptiere", um mit deiner Buchung fortzufahren',en_GB:"Because you are making a Group Booking, there are additional Terms and Conditions that apply. Please read them and click 'I Accept' below to continue with your booking",es_ES:"Como estás haciendo una Reserva de grupo, se aplican Términos y Condiciones adicionales. Léelos y haz clic a continuación en 'Acepto' para continuar con tu reserva",fi_FI:"",fr_FR:"Nous vous rappelons que les Réservations de groupes sont soumises à des Conditions générales supplémentaires. Veuillez les lire et cliquer sur 'J'accepte' pour effectuer votre réservation",it_IT:'Prima di effettuare una prenotazione per gruppi, ti ricordiamo che sono previsti termini e condizioni extra. Leggi e clicca su "Accetto" sotto per continuare con la prenotazione',ja_JP:"グループでのご予約をご希望の方は、補足のご利用規約がございます。内容をご確認いただき、下記の「同意する」をクリックしてください。",ko_KR:'단체예약이기 때문에 별도의 이용약관이 추가 적용됩니다. 약간을 읽고 ""동의합니다""를 누르면 예약이 계속 진행됩니다',nb_NO:"",nl_NL:"Omdat u een groepsboeking maakt zijn er andere Algemene Voorwaarden van toepassing. Lees de voorwaarden en klik hieronder op 'Ik accepteer' om verder te gaan met uw boeking",pl_PL:"Ponieważ dokonujesz rezerwacji grupowej, mają zastosowanie dodatkowe Warunku i postanowienia. Przeczytaj je i kliknij „Akceptuję” poniżej, aby kontynuować proces rezerwacji.",pt_PT:"Because you are making a Group Booking, there are additional Terms and Conditions that apply. Please read them and click 'I Accept' below to continue with your booking",ru_RU:'Вы делаете групповое бронирование, в данном случае применяются дополнительные Правила и Условия. Прочитайте их, пожалуйста, и нажмите кнопку ""Я согласен"" для продолжения бронирования.',sv_SE:"",tr_TR:"",zh_CN:"团队预订有额外适用条款与条件，请在阅读后勾选“我接受”以完成订单。"};var c={pt_BR:"Termos Gerais das Reservas de Grupo",cs_CZ:"General Group Booking Terms",da_DK:"General Group Booking Terms",de_DE:"Allgemeine Geschäftsbedingungen für Gruppenbuchungen",en_GB:"General Group Booking Terms",es_ES:"Términos generales para reservas de grupos",fi_FI:"General Group Booking Terms",fr_FR:"Conditions générales des réservations de groupes",it_IT:"Termini di prenotazione generici per gruppi",ja_JP:"General Group Booking Terms",ko_KR:"General Group Booking Terms",nb_NO:"General Group Booking Terms",nl_NL:"Algemene Voorwaarden Groepsboekingen",pl_PL:"Ogólne warunki rezerwacji grupowych",pt_PT:"General Group Booking Terms",ru_RU:"General Group Booking Terms",sv_SE:"General Group Booking Terms",tr_TR:"General Group Booking Terms",zh_CN:"General Group Booking Terms"};var h={pt_BR:"Ao fazer uma reserva de grupo pelo Hostelworld.com, você concorda com os termos e condições a seguir, conforme definido pelo Hostelworld.com e pelo hostel em questão. <UL> <LI>Para fazer uma reserva de grupo no Hostelworld.com, é necessário pagar um depósito de 10% e um encargo de serviço de US$2,00 por cartão de crédito. O saldo deverá ser quitado diretamente ao hostel, de acordo com as condições de pagamento. <LI>O encargo de serviço e o depósito da reserva não são reembolsáveis <LI>O Hostelworld.com não é responsável por alterações ou correções na sua reserva depois de ela ser processada. Todos os acordos relativos às alterações na sua reserva precisam ser feitos diretamente com o hostel. <LI>O cancelamento das reservas deve ser feito pelo hostel, sendo necessário estar em conformidade com a política de cancelamento de cada hostel (veja abaixo) <LI>É de sua responsabilidade pagar o saldo do custo de acomodação ao hostel de acordo com as condições de pagamento (veja abaixo). Se você não fizer isso, sua reserva poderá ser cancelada pelo hostel. <LI>Cada hostel pode ter condições de reserva especiais relacionadas a estadias de grupo. Leia as condições de reserva do hostel com cuidado antes de fazer sua reserva. </UL>",cs_CZ:"Provedením skupinové rezervace přes společnost Hostelworld.com souhlasíte s následujícími obchodními podmínkami stanovenými společností Hostelworld.com a předmětným hostelem. <UL><LI>Aby bylo možné provést skupinovou rezervaci na Hostelworld.com, je nutné platební kartou zaplatit 10% zálohu a poplatek za službu ve výši 2 USD. Zbývající částka je splatná přímo hostelu podle jeho platebních podmínek. <LI> Poplatek za službu a záloha za rezervaci jsou nevratné <LI>Společnost Hostelworld.com není po zpracování rezervace zodpovědná za její změny nebo úpravy. Veškerou korespondenci týkající se změn v rezervaci je nutné řešit přímo s hostelem. <LI>Rezervace je nutno stornovat přímo u provozovatele hostelu a musí být v souladu se storno podmínkami jednotlivých hostelů (viz níže) <LI>Je vaší povinností uhradit hostelu zbytek nákladů na ubytování v souladu s jejich platebními podmínkami (viz níže). Pokud tak neučiníte, může dojít ke stornu rezervace hostelem. <LI>Jednotlivé hostely mohou mít zvláštní podmínky týkající se rezervací skupinových pobytů, přečtěte si proto podmínky rezervace hostelu pečlivě před provedením rezervace samotné. </UL>",da_DK:"Ved at foretage en gruppereservation gennem Hostelworld.com accepterer du de følgende vilkår og betingelser, som fremsat af Hostelworld.com og som fremsat af det aktuelle hostel. <UL> <LI>For at foretage en gruppereservation på Hostelworld.com er det nødvendigt at betale et depositum på 10 % samt en serviceafgift på $2,00 USD med kreditkort. Beløbet betales direkte til hostellet i overensstemmelse med deres betalingsbetingelser. <LI>Serviceafgiften og reservationsdepositummet kan ikke refunderes <LI>Hostelworld.com er ikke ansvarlig for nogen ændringer i din reservation, efter den er blevet behandlet. Al korrespondence mht. ændring af din reservation skal klares direkte med hostellet. <LI>Afbestilling af reservationer skal foretages direkte til hostellet og skal være i overensstemmelse med det individuelle hostels afbestillingsregler (se nedenfor) <LI> Du er ansvarlig for at betale resten af indkvarteringsomkostningerne til hostellet i overensstemmelse med deres betalingsbetingelser (se nedenfor). Hvis du ikke gør dette, kan det resultere i, at hostellet aflyser din reservation. <LI>Individuelle hostels  har muligvis særlige reservationsbetingelser i forhold til gruppeophold",de_DE:"Mit der Buchung einer Gruppenreservierung über Hostelworld.com stimmst du den folgenden, von Hostelworld.com und dem betreffenden Hostel aufgestellten, allgemeinen Geschäftbedingungen zu. <UL> <LI>Bei einer Gruppenreservierung über Hostelworld.com wird deine Kreditkarte mit einer Anzahlung in Höhe von 10 % und einer Service-Gebühr in Höhe von 2 USD belastet. Der Restbetrag ist direkt an das Hostel und in Einklang mit den jeweiligen Zahlungsbedingungen zu zahlen. <LI>Die Service-Gebühr und die Buchungsanzahlung können nicht rückerstattet werden. <li>Bitte beachten Sie, dass eine Stornierung mindestens 24 Stunden vor Anreise direkt bei der Unterkunft gemacht werden muss. (Ausser andere Bedingungen sind in den Buchungskonditionen aufgeführt) </li><LI>Hostelworld.com ist nicht verantwortlich für Änderungen an deiner Reservierung, nachdem diese verarbeitet wurde. Die gesamte Korrespondenz hinsichtlich Änderungen an deiner Buchung muss direkt mit dem Hostel abgewickelt werden. <LI>Stornierungen von Reservierungen müssen direkt an das Hostel gesendet werden und der jeweiligen Stornierungsrichtlinie des Hostels entsprechen.<LI>Du bist für die Zahlung des ausstehenden Restbetrags für die Unterkunft an das Hostel, entsprechend den geltenden Zahlungsbedingungen (siehe unten), verantwortlich. Bei nicht geleisteten Zahlungen kann deine Reservierung durch das Hostel storniert werden. <LI>Manche Hostels haben eventuell besondere Buchungsbedingungen für Gruppenaufenthalte. Bitte lies dir die Buchungsbedingungen des Hostels sorgfältig durch, bevor du eine Reservierung buchst. </UL>",en_GB:"By making a group reservation through Hostelworld.com you agree to the following terms and conditions as set by Hostelworld.com and as set by the hostel in question. <ul> <li>In order to make a group reservation on Hostelworld.com it is necessary to pay a deposit. The balance is due directly to the hostel according to their payment conditions.</li> <li>The booking deposit is non-refundable.</li><li>Please note that any cancellations must be notified directly to the hostel at least 24 hours in advance of your scheduled arrival date, unless otherwise stated in the hostel's conditions.</li> <li>Hostelworld.com are not responsible for changes or amendments to your reservation once it has been processed. All correspondence with regard to changes to your booking need to be dealt with directly with the hostel.</li> <li>Cancellations for reservations must be made directly with the hostel and must conform with the individual hostels cancellation policy (see below)</li> <li>It is your responsibility to pay the balance of your accommodation cost to the hostel in accordance with their payment conditions (see below). Failure to do so may result in your reservation being cancelled by the hostel. </li> <li>Individual hostels may have special booking conditions relating to group stays, please read the hostel booking conditions carefully before making your reservation.</li> </ul>",es_ES:"Al realizar una reserva para grupos mediante Hostelworld.com aceptas los siguientes términos y condiciones de Hostelworld.com y los del hostel en cuestión. <UL> <LI>Para realizar una reserva para grupos en Hostelworld.com, es necesario abonar un depósito del 10% y unos gastos de servicio de US$2.00 mediante tarjeta de crédito. El importe se abonará directamente al hostel conforme a sus condiciones de pago. <LI>Los gastos de servicio y el depósito de la reserva no son reembolsables <li>Ten en cuenta que las cancelaciones deben notificarse directamente al hostel con una antelación mínima de 24 horas a la hora de llegada, a menos que el Hostel tenga otra politica de cancelación señalada en sus condiciones</li><LI>Una vez procesada la reserva, Hostelworld.com no se responsabilizará de ningún cambio o modificación que realices en ella. Toda la correspondencia relacionada con los cambios de la reserva deberá gestionarse directamente con el hostel. <LI>Las cancelaciones de reserva deberán hacerse directamente con el hostel y deberán atenerse a la política de cancelación de cada hostel (consulta más abajo) <LI>Es tu responsabilidad abonar el importe del coste del alojamiento al hostel conforme a sus condiciones de pago (consulta más abajo). De lo contrario, el hostel cancelará tu reserva. <LI>Algunos hostels pueden tener condiciones de reserva especiales relacionadas con las estancias de grupos. Lee atentamente las condiciones de reserva del hostel antes de realizar la reserva. </UL>",fi_FI:"Tekemällä ryhmävarauksen Hostelworld.comin kautta sitoudut seuraaviin Hostelworld.comin ja kyseisen hostellin asettamiin ehtoihin. <UL><LI>Jotta voit tehdä ryhmävarauksen Hostelworld.comissa on tarpeen suorittaa 10 prosentin talletusmaksu ja 2,00 Yhdysvaltain dollarin palvelumaksu luottokortilla. Saldo tulee suoraan hostellilta sen maksuehtojen mukaisesti. <LI>Palvelumaksua ja varaustalletusta ei voida palauttaa <LI> Hostelworld.com ei vastaa varauksen muutoksista tai oikaisuista sen ollessa käsitelty. Kaikki varauksen muutoksiin liittyvät asiat tulee sopia suoraan hostellin kanssa. <LI>Varausten peruutukset tulee hoitaa suoraan hostellin kanssa ja niiden kanssa tulee noudattaa yksittäisten hostellien peruutusehtoja (katso alla) <LI>On sinun vastuullasi maksaa majoituksesi kulut hostellille heidän maksuehtojensa mukaisesti (katso alla). Muussa tapauksessa hostelli voi perua varauksesi. <LI>Yksittäisillä hostelleilla voi olla erityisiä varausehtoja ryhmävaraukselle. Lue hostellin varausehdot huolellisesti ennen varaustasi. </UL>",fr_FR:"En effectuant une réservation de groupe par l’intermédiaire de Hostelworld.com, vous acceptez les conditions générales suivantes définies par Hostelworld.com et l’auberge en question. <UL> <LI>Pour effectuer une réservation de groupe sur Hostelworld.com, il est nécessaire de payer par carte bancaire un acompte de 10 % et des frais de service de 2 dollars. Le solde devra être réglé directement à l’auberge dans le respect des conditions de paiement de celle-ci. <LI>Les frais de service et l’acompte ne sont pas remboursables.<li>Veuillez noter que toute annulation doit être signalée directement auprès de l'hotel au moins 24 heures avant votre date d'arrivée prévue, sauf si il est indique différemment dans les conditions de l'hôtel</<li><LI>Hostelworld.com n’est pas responsable des modifications apportées à votre réservation une fois celle-ci traitée. Toute correspondance relative à des modifications apportées à votre réservation doit se faire directement avec l’auberge. <LI>Les annulations de réservations doivent être effectuées directement auprès de l’auberge et doivent se conformer à la politique d’annulation de celle-ci (voir ci-dessous). <LI>Il relève de votre responsabilité de régler le solde du coût de votre hébergement à l’auberge dans le respect des conditions de paiement de celle-ci (voir ci-dessous). Si vous manquez à cette obligation, votre réservation pourrait être annulée par l’auberge. <LI>Certaines auberges peuvent avoir mis en place des conditions de réservation spécifiques pour le séjour de groupes. Veuillez lire les conditions attentivement avant d’effectuer votre réservation. </UL>",it_IT:"Facendo una prenotazione di gruppo tramite Hostelworld.com, accetti i seguenti Termini e Condizioni stabiliti da Hostelworld.com e applicati dall’ostello in questione. <UL> <LI>Per fare una prenotazione di gruppo su Hostelworld.com, è necessario versare un 10% di cauzione e 2 dollari USA come commissione di servizio tramite carta di credito. La differenza a saldo viene pagata direttamente in ostello secondo le loro condizioni di pagamento. <LI> La commissione di servizio e la cauzione di prenotazione non sono rimborsabili.<li>Ogni disdetta deve essere notificata all’alloggio almeno 24 ore prima del previsto arrivo, a meno che le condizioni della struttura non siano differenti. Nel caso di mancato arrivo, il totale della prima notte verra’addebitato dalla tua carta di credito da parte della struttura</li><LI>Hostelworld.com non è responsabile per eventuali modifiche o variazioni alla tua prenotazione una volta che è stata inviata. Tutta la corrispondenza relativa a cambi di prenotazione deve essere gestita direttamente con l’ostello. <LI>Le cancellazioni di prenotazione devono essere inoltrate direttamente all’ostello conformemente alla politica di cancellazione dei singoli ostelli (vedi in basso) <LI>Sei tenuto a versare all’arrivo la differenza a saldo per il costo totale della camera secondo le condizioni di pagamento dell’ostello (vedi in basso). In caso di mancato pagamento, l’ostello ha diritto di cancellare la prenotazione. <LI>I singoli ostelli possono avere delle condizioni di prenotazione speciali per soggiorni di gruppo",ja_JP:"Hostelworld.comを通してグループ予約をする場合は、下記のHostelworld.com及びホステルの利用規約に同意したものとみなします。<UL> <LI>Hostelworld.com でグループ予約をするにあたり、10%のデポジットとUS２ドルのサービス料がクレジットカードで決済されます。残りのお支払は予約したホステルのお支払規定に従ってお支払ください。<LI>デポジットとサービス料の返金出来かねます。<LI>予約が確定しした後の予約の変更などについてはHostelworld.com は原則的に関知しません。予約の変更についてはホステルに直接お問い合わせください。<LI>予約のキャンセルはホステルのキャンセル規定（下記ご参照ください）に従ってホステルに直接ご連絡ください。<LI>お支払については、ホステルのお支払規定（下記ご参照ください）に従ってホステルに直接お支払ください。お支払を怠った場合は、ホステルによってご予約がキャンセルされる事もあります。 <LI>ホステルによってはグループ予約用の規定がある場合もありますので、予めご確認ください。 </UL>",ko_KR:"Hostelworld.com을 통해 단체 예약을 하시는 고객님은 Hostelworld.com과 해당 호스텔이 설정한 다음의 이용약관에 동의해야 합니다. <UL><LI> Hostelworld.com에서 단체 예약을 하기 위해서는 10 %의 보증금과 미화 $ 2.00를 신용 카드로 지불하셔야 합니다. 나머지 잔금은 해당 호스텔의 지불 방침에 따라 호스텔에 직접 지불하셔야 합니다. <LI> 예약 보증금은 환불되지 않습니다 <LI> Hostelworld.com는 고객님의 예약이 처리된 후에 발생하는 변경사항들에 대해 책임을 지지 않습니다. 예약 변경 사항과 관련된 모든 연락은 해당 숙소와 직접 하셔야 합니다. <LI> 예약 취소는 호스텔로 직접 접수해야 하며 개별 호텔의 취소 정책에 따라 처리해야 합니다 (아래 참조) <LI> 고객님은 해당 호스텔의 지불 조건에 따라 숙박비의 잔금을 호스텔에 지급해야 할 책임이 있습니다(아래 참조). 그렇게 하지 않을 경우 고객님의 예약은 해당 호스텔에 의해 취소될 수 있습니다. <LI> 각 호스텔은 단체 숙박과 관련하여 특정한 예약 조건을 적용할 수 있습니다. 예약 전에 해당 호스텔의 예약 조건들을 자세히 읽어보십시오. </UL>",nb_NO:"Door het maken van een groep reservering via Hostelworld.com gaat u akkoord met de volgende voorwaarden zoals vastgesteld door Hostelworld.com en zoals vastgesteld door het hostel in kwestie. <UL><LI> Om groepsreservering via Hostelworld.com is het noodzakelijk om een aanbetaling te maken van 10% en ook een dienstkost van US $ 2,00 servicekosten per kredietkaart. Het nog uitstaande bedrag moet direct aan het hostel betaald worden volgens de betalingsvoorwaarden. <LI> De dienstkost en de aanbetaling worden niet terugbetaald <LI> Hostelworld.com is niet verantwoordelijk voor wijzigingen of aanpassingen aan uw reservering wanneer deze eemals het eenmaal verwerkt is. Alle correspondentie met betrekking tot wijzigingen in uw reservering moet worden direct met het hostel worden behandeld. <LI> Annuleringen voor reserveringen moeten rechtstreeks worden gemaakt met het hostel en moeten voldoen aan de individuele annuleringsvoorwaarden van het hostel (zie hieronder) <LI> Het uitblijven hiervan kan er toe leiden dat uw reservering door het hostel wordt geannuleerd <LI>Individuele vandrerhjem kunnen speciale voorwaarden met betrekking tot het boeken van groepsverblijven hebben, lees de hostel reserveringsvoorwaarden zorgvuldig door voordat u uw reservering maakt. </UL>",nl_NL:"Door het maken van een groepsreservering via Hostelworld.com gaat u akkoord met de volgende voorwaarden zoals vastgesteld door Hostelworld.com en zoals vastgesteld door het hostel in kwestie. <UL><LI> Om een groepsreservering via Hostelworld.com te maken is een aanbetaling van 10% verplicht en ook een administratiekost van US $ 2,00 per kredietkaart. Het nog uitstaande bedrag moet direct aan het hostel betaald worden volgens de betalingsvoorwaarden. <LI> De administratiekost en de aanbetaling worden niet terugbetaald.<li>Houd er rekening mee dat eventuele annuleringen moeten rechtstreeks aan het hostel gemeld worden op zijn minst ##XHOURSCANCELLATION## uur voor uw geplande aankomst, tenzij anders vermeld in de voorwaarden van het hostel. </i> <LI> Hostelworld.com is niet verantwoordelijk voor wijzigingen of aanpassingen aan uw reservering wanneer deze eenmaal verwerkt is. Alle correspondentie met betrekking tot wijzigingen in uw reservering moet rechtstreeks met het hostel worden behandeld. <LI> Annuleringen voor reserveringen moeten rechtstreeks met het hostel geregeld worden en moeten voldoen aan de individuele annuleringsvoorwaarden van het hostel (zie hieronder) <LI> Indien u dit niet doet kan uw reservering geannuleerd worden<LI>Individuele hostels kunnen speciale voorwaarden met betrekking tot het boeken van groepsverblijven hebben, lees de hostel reserveringsvoorwaarden zorgvuldig door voordat u uw reservering maakt. </UL>",pl_PL:"Dokonując rezerwacji grupowej poprzez Hostelworld.com wyrażasz zgodę na następujące zasady i warunki określone zarówno przez Hostelworld.com, jak i przez dany hostel. <UL><LI> W celu dokonania rezerwacji grupowej na Hostelworld.com należy zapłacić kartą kredytową 10% zaliczki oraz dodatkowe 2 dolary stanowiące opłatę za usługę. Pozostała kwota pozostaje do uiszczenia bezpośrednio w hostelu, zgodnie z warunkami płatności. <LI> Opłata za usługę i zaliczka nie podlegają zwrotowi <LI> Hostelworld.com nie jest odpowiedzialny za zmiany lub korekty rezerwacji po jej przetworzeniu. Wszelka korespondencja w odniesieniu do zmian w rezerwacji musi być skierowana bezpośrednio do hostelu. <LI> Anulowanie rezerwacji należy dokonywać bezpośrednio w hostelu i musi ono odbyć się zgodne z polityką  anulowania noclegów danego hostelu (patrz poniżej) <LI> Twoim obowiązkiem jest zapłacenie pozostałych kosztów zakwaterowania , zgodnie z warunkami płatności hostelu (patrz poniżej). Niezastosowanie się do tych warunków może ponieść za sobą anulowanie rezerwacji przez hostel. <LI>Poszczególne hostele mogą mieć specjalne warunki rezerwacji dla noclegów grupowych, proszę zapoznać się dokładnie z warunkami rezerwacji hostelu przed dokonaniem rezerwacji . </UL>",pt_PT:"Ao efectuar uma reserva de grupo através da Hostelworld.com, concorda com os seguintes termos e condições definidos pela Hostelworld.com e pelo hostel em causa. <UL> <LI>Para efectuar uma reserva de grupo em Hostelworld.com é necessário pagar um depósito de 10% e uma taxa de serviço de dois dólares através de cartão de crédito. O saldo deverá ser pago directamente ao hostel, de acordo com as respectivas condições de pagamento. <LI>A taxa de serviço e o depósito de reserva não são reembolsáveis <li>Por favor note que quaisquer cancelamentos devem ser comunicados diretamente ao hostel com pelo menos 24 horas de antecedência da data de chegada prevista, salvo indicação em contrário nas condições da pousada.</li><LI>Hostelworld.com não é responsável por alterações ou correcções às reservas, uma vez que estas tenham sido processadas. Toda a correspondência respeitante a alterações das reservas tem de ser efectuada directamente com o hostel. <LI>Os cancelamentos de reservas têm de ser efectuados directamente com o hostel e têm de obedecer às políticas de cancelamento individuais dos hostels (ver abaixo) <LI>É da responsabilidade do cliente o pagamento do saldo restante do valor do alojamento ao hostel, de acordo com as respectivas condições de pagamento (ver abaixo). O não cumprimento destas condições pode resultar no cancelamento da reserva por parte do hostel. <LI>As hostels individuais podem ter condições de reserva especiais relativas a estadas de grupos",ru_RU:"Совершая групповое бронирование на Hostelworld.com вы соглашаетесь со следующими условиями, установленными Hostelworld.com и выбранным хостелом. <UL><LI> Для совершения группового бронирования на Hostelworld.com необходимо заплатить 10% депозита и 2,00 доллара США за обслуживание при оплате кредитной картой. Остаток оплачивается непосредственно в хостелу в соответствии с его условиями оплаты. <LI> Плата за обслуживание кредитной карты и предоплата не возвращаются <LI> Hostelworld.com не несет ответственности за изменения или поправки в бронировании после его обработки. Всю переписку в отношении изменений в бронирование необходимо вести с непосредственно с хостелом. <LI> Аннулирование бронирования должно осуществляться непосредственно хостелом и должно соответствовать политике отмены бронирования хостелов (см. ниже) <LI> Вы обязаны оплатить остаток суммы вашего проживания в хостеле в соответствии с его условиями оплаты (см. ниже). Невыполнение этого требования может привести к тому, что ваше бронирование будет отменено хостелом. <LI>Хостелы могут иметь свои условия бронирования в отношении проживания группы, поэтому, пожалуйста, внимательно читайте условия бронирования по каждому отдельно взятому хостелу, прежде чем вы совершите бронирование.</UL>",sv_SE:"Genom att göra en gruppbokning genom Hostelworld.com godkänner du följande villkor som fastställts av Hostelworld.com och som fastställts av boendet i fråga. <UL><LI>För att kunna göra en gruppbokning på Hostelworld.com måste man betala en deposition på 10 % och en serviceavgift på 2 USD med kreditkort. Beloppet ska betalas direkt till boendet enligt deras betalningsvillkor. <LI> Service- och bokningsavgiften återbetalas inte <LI> Hostelworld.com ansvarar inte för ändringar eller tillägg till din bokning när den har behandlats. All korrespondens med hänsyn till ändringar i din bokning måste hanteras direkt med boendet. <LI> Avbokningar av reservationer måste göras direkt hos boendet och måste följa boendets enskilda avbeställningsregler (se nedan) <LI> Det är ditt ansvar att betala återstoden av din boendekostnad till boendet i enlighet med deras betalningsvillkor (se nedan). Underlåtenhet att göra detta kan resultera i att din reservation annulleras av boendet. <LI>Enskilda hostels kan ha särskilda bokningsvillkor för grupper, var god läs bokningsvillkoren för boendet noga innan du bokar. </UL>",tr_TR:"By making a group reservation through Hostelworld.com you agree to the following terms and conditions as set by Hostelworld.com and as set by the hostel in question. <ul> <li>In order to make a group reservation on Hostelworld.com it is necessary to pay a deposit. The balance is due directly to the hostel according to their payment conditions.</li> <li>The booking deposit is non-refundable</li> <li>Hostelworld.com are not responsible for changes or amendments to your reservation once it has been processed. All correspondence with regard to changes to your booking need to be dealt with directly with the hostel.</li> <li>Cancellations for reservations must be made directly with the hostel and must conform with the individual hostels cancellation policy (see below)</li> <li>It is your responsibility to pay the balance of your accommodation cost to the hostel in accordance with their payment conditions (see below). Failure to do so may result in your reservation being cancelled by the hostel. </li> <li>Individual hostels may have special booking conditions relating to group stays, please read the hostel booking conditions carefully before making your reservation.</li> </ul>",zh_CN:"通过 Hostelworld.com 按团队预订房间，即表明您已经同意了 Hostelworld.com 及相应旅舍规定的以下条件和条款。 <UL> <LI>要在 Hostelworld.com 按团队预订房间，需要支持 10% 的押金，同时，每张信用卡需加收 2.00 美元的服务费。 余额将按照旅舍的付款要求，直接支付给旅舍。 <LI>服务费和预订押金不可退还。<LI>您的预订一经受理，有关预订的任何变更或调整不再由 Hostelworld.com负责。 有关预订变更，需要直接与旅舍交涉办理。 <LI>若要取消预订，需要直接联系旅舍，同时必须要满足各家旅舍的取消预订注意事项（见下面所述）<LI>您应按照旅舍的付规定，将住宿费余额支付给旅舍（见下面所述）。 否则，将您的预订将可能被旅舍取消。 <LI>每家旅舍针对团队顾客都可能有特殊的预订要求，在预订前，请仔细地阅读旅舍的预订要求。 </UL>"};var d={pt_BR:"Termos e condições específicos do hostel",cs_CZ:"Obchodní podmínky pro specifický hostel",da_DK:"Særlige vilkår og betingelser for hostels",de_DE:"Hostel-spezifische, allgemeine Geschäftsbedingungen",en_GB:"Hostel Specific Terms & Conditions",es_ES:"Términos y condiciones específicos del hostel",fi_FI:"Hostellin erityisehdot",fr_FR:"Conditions générales spécifiques à l’auberge",it_IT:"Termini e condizioni specifiche dell’ostello",ja_JP:"ホステル特定の利用規定",ko_KR:"호스텔 전용 이용 약관",nb_NO:"Specifieke Hostel Bepalingen en Voorwaarden",nl_NL:"Hostel Specifieke Bepalingen en Voorwaarden",pl_PL:"Szczegółowe zasady i warunki hostelu",pt_PT:"Termos e condições específicos do hostel",ru_RU:"Условия хостелов",sv_SE:"hostels Särskilda villkor",tr_TR:"Hostel Özel Kayıt ve Şartlar",zh_CN:"旅舍的特殊条件和条款"};var f={pt_BR:"O restante da quantia devida será cobrado no seu cartão de crédito",cs_CZ:"Zbytek dlužné částky bude naúčtován vaší platební kartě",da_DK:"Den resterende del af det skyldige beløb vil blive opkrævet på dit kreditkort",de_DE:"Deine Kreditkarte wird mit dem verbleibenden Betrag belastet.",en_GB:"The remainder of the amount due will be charged to your credit card",es_ES:"El resto del importe pendiente se cargará a tu tarjeta de crédito",fi_FI:"Loput summasta veloitetaan luottokortiltasi",fr_FR:"Le reste du montant dû sera débité sur votre carte bancaire.",it_IT:"Il resto dell’importo dovuto sarà addebito sulla tua carta di credito.",ja_JP:"残金はクレジットカードに課金されます。",ko_KR:"나머지 잔금은 귀하의 신용 카드로 청구됩니다",nb_NO:"Resten av beløpet vil bli belastet ditt kredittkort",nl_NL:"Het resterende bedrag zal op uw creditcard in rekening gebracht worden",pl_PL:"Pozostała część należnej kwoty zostanie pobrana z karty kredytowej",pt_PT:"O valor restante da quantia devida será cobrado no seu cartão de crédito",ru_RU:"The remainder of the amount due will be charged to your credit card",sv_SE:"Resten av beloppet debiteras ditt kreditkort",tr_TR:"",zh_CN:"应付余额将从您的信用卡中扣除"};var m={pt_BR:"Caso os números ou a seleção de quartos mude, será deduzido da tarifa de acomodação cobrada pelo hostel o depósito por pessoa vezes o número de pessoas que de fato viajaram.",cs_CZ:"Pokud by se změnil počet osob nebo pokojů, z celkového poplatku za ubytování odvedeného hostelu bude odečtena záloha na osobu krát počet lidí, kteří se skutečně ubytovali.",da_DK:"I tilfælde af at antallet eller udvalget af værelser ændrer sig, vil depositummet pr. person gange antallet af personer, der i realiteten rejste, blive trukket fra den samlede værelsesafgift opkrævet af hostellet.",de_DE:"Bei veränderter Teilnehmerzahl oder Änderungen der Zimmerauswahl wird die Anzahlung pro Einzelperson, multipliziert mit der Anzahl der tatsächlich Reisenden, vom durch das Hostel erhobenen Gesamtbetrag für die Unterkünfte abgezogen.",en_GB:"Should numbers or room selection change, the per person deposit times the number of people who actually travelled will be deducted from the total accommodation charge levvied by the hostel.",es_ES:"Si cambias el número o selección de habitaciones, se te deducirá del cargo total de alojamiento que cobra el hostel el depósito por persona multiplicado por el número de personas que realmente ha viajado.",fi_FI:"Jos henkilöiden määrä tai huoneiden valinta muuttuu, matkustavien henkilöiden määrä korjataan oikeelliseksi hostellin veloittamasta summasta.",fr_FR:"Si le nombre de personnes ou le type de chambre choisi change, un montant égal à l’acompte par personne fois le nombre de personnes ayant effectivement voyagé sera déduit du montant total facturé par l’auberge pour l’hébergement.",it_IT:"In caso di variazione del numero o della tipologia di camere, il deposito a persona è calcolato sul numero di persone che viaggiano e sarà dedotto dalle spese totali riscosse dall’ostello.",ja_JP:"部屋の数や部屋タイプが変更された場合は、実際に宿泊された人数分のデポジット総額がホステルによる請求合計金額より差し引かれます。",ko_KR:"인원 또는 선택한 객실이 변경될 경우, 1인당 보증금과 실제로 여행을 한 사람의 숫자를 곱한 금액이 호스텔이 부과하는 전체 숙박료로부터 공제됩니다.",nb_NO:"Zouden getallen of kamerkeuzes veranderen dan zal de aanbetaling per persoon die daadwerkelijk reist, afgetrokken worden van de totale verblijfsaanrekening door het hostel.",nl_NL:"Mocht het aantal reizigers of de kamerkeuze wijzigen, zal de aanbetaling per persoon, vermenigvuldigd met het aantal personen dat daadwerkelijk gereisd heeft, van het totale bedrag dat geheft is door het hostel afgetrokken worden.",pl_PL:"W przypadku zmiany liczby lub wyboru pokojów, kaucja za osobę pomnożona przez liczbę osób, które faktycznie podróżują, zostanie potrącona z całkowitej opłaty za zakwaterowanie pobranej przez hostel.",pt_PT:"Se houver alteração do número de pessoas, ou da selecção dos quartos, a quantia equivalente ao valor do depósito por pessoa multiplicada pelo número de pessoas que compareceram será deduzida do custo total do alojamento cobrado pelo hostel.",ru_RU:"Если изменится количество или выбранные номера, депозит на человека будет рассчитан в соответствии с количеством тех людей, которые на самом деле будут проживать, и будет вычтен из общей суммы, подлежащей оплате за размещение, выставленной хостелом.",sv_SE:'Om antal rum eller rumsort förändras, kommer "per person"-insättningen gånger antalet personer som faktiskt rest att dras av från den totala boendeavgift som tagits ut av boendet.',tr_TR:"",zh_CN:"若人数或所选择的房间类型发生变化，则将在旅舍所收取的总住宿费中，按照实际出行人数乘以每人押金额扣除相应费用。"};var y={pt_BR:"Política de cancelamento / não comparecimento e redução nos números",cs_CZ:"Podmínky stornování/nedostavení se a snížení počtu osob",da_DK:"Regler for annullering / udeblivelse og reduktion af antal gæster",de_DE:"Stornierung / Richtlinie für Nichterscheinen oder reduzierte Teilnehmerzahl",en_GB:"Cancellation / No Show & Reduction in Numbers Policy",es_ES:"Política de cancelación/no comparecencia y reducción de días",fi_FI:"Peruutusten varausmaksut ennen matkan alkua ovat seuraavat",fr_FR:"Politique en matière d’annulation, de non-présentation et de réduction du nombre de personnes",it_IT:"Cancellazione / Nessuna mostra e riduzione per polizza illegale",ja_JP:"予約取り消し / ノーショー と 定員減に関する規定",ko_KR:"취소 / 예약을 지키지 않거나 숫자가 감소될 경우에 대한 정책",nb_NO:"Avbestilling / Ikke Oppmøte & Reduksjon av Antall politikk",nl_NL:"Beleid aangaande Annulering / No Show & Verandering in het aantal reizigers",pl_PL:"Regulamin anulowania / nie stawienia się na miejscu i zmniejszenia liczby",pt_PT:"Política de cancelamentos, não comparência e redução de números",ru_RU:"Политика Отмены / Неявки и сокращения количества человек",sv_SE:"Avbokning / inget visas &amp",tr_TR:"",zh_CN:"有关取消预订/未抵店及预订单缩减的说明"};var v={pt_BR:"Termos e condições adicionais",cs_CZ:"Doplňkové Obchodní podmínky",da_DK:"Yderligere handelsbetingelser",de_DE:"Zusätzliche allgemeine Geschäftsbedingungen",en_GB:"Additional Terms and Conditions",es_ES:"Términos y condiciones adicionales",fi_FI:"Lisäehdot",fr_FR:"Conditions supplémentaires",it_IT:"Termini e condizioni integrativi",ja_JP:"ご利用条件の補足",ko_KR:"추가 이용약관",nb_NO:"Ytterligere Vilkår og Betingelser",nl_NL:"Aanvullende Voorwaarden",pl_PL:"Dodatkowe warunki i zasady",pt_PT:"Termos e condições adicionais",ru_RU:"Дополнительные условия",sv_SE:"Tilläggsvillkor",tr_TR:"",zh_CN:"更多条款和条件"};var _={pt_BR:"Informações adicionais",cs_CZ:"Další informace",da_DK:"Yderligere oplysninger",de_DE:"Zusätzliche Information",en_GB:"Additional Info:",es_ES:"Información Adicional",fi_FI:"Lisätietoja",fr_FR:"Information additionnelle",it_IT:"Informazioni supplementari",ja_JP:"追加情報",ko_KR:"추가 정보",nb_NO:"Ytterligere opplysninger",nl_NL:"Aanvullende informatie",pl_PL:"Dodatkowe informacje",pt_PT:"Informações adicionais",ru_RU:"Дополнительная информация",sv_SE:"Ytterligare information",tr_TR:"Ek Bilgiler",zh_CN:"额外信息"};var x={pt_BR:"Quaisquer cancelamentos sob pretextos falsos, segundo os termos e condições desse acordo, irão resultar na perda do depósito.",cs_CZ:"",da_DK:"",de_DE:"Alle Stornierungen, die aus einer Zustimmung zu diesen allgemeinen Geschäftsbedingungen unter Vortäuschung falscher Tatsachen entstehen, führen zu einem Verlust der Anzahlung.",en_GB:"Any cancellations resulting from agreement to these terms and conditions under false pretences will result in loss of deposit.",es_ES:"Cualquier cancelación resultado de aceptar estos términos y condiciones con falsos pretextos tendrá como resultado la pérdida del depósito.",fi_FI:"",fr_FR:"L'acompte sera perdu en cas d'annulation consécutive à une fausse déclaration en vertu de ces conditions générales.",it_IT:"Tutta le cancellazioni conseguenti all'accettazione, effettuata usando dichiarazioni mendaci, di questi termini e condizioni comporteranno la perdita del deposito cauzionale.",ja_JP:"",ko_KR:"",nb_NO:"",nl_NL:"Alle annuleringen als gevolg van een akkoord met deze voorwaarden onder valse voorwendselen zullen resulteren in een verlies van de aanbetaling.",pl_PL:"Wszelkie anulowania rezerwacji wynikające z zaakceptowania niniejszych warunków i postanowień pod fałszywymi pozorami spowoduje utratę kaucji.",pt_PT:"Any cancellations resulting from agreement to these terms and conditions under false pretences will result in loss of deposit.",ru_RU:"",sv_SE:"",tr_TR:"",zh_CN:""};var w={pt_BR:"Por favor selecione para mostrar que leu e entendeu os termos e condições.<br/>  Você deve aceitar os termos e condições para que possamos confirmar sua reserva.",cs_CZ:"Prosím zaškrtněte políčko, pokud jste si přečetli a rozumíte našim smluvním podmínkám. <br/> Abychom vám mohli potvrdit rezervaci, musíte přijmout naše smluvní podmínky.",da_DK:"Sæt kryds her for at angive, at du har læst og forstået vilkår og betingelser. <br/> Du skal acceptere vilkår og betingelser, for at vi kan bekræfte din booking.",de_DE:"Bitte kreuz das Kästchen, um das Lesen und Verstehen der Bedingungen für Gruppenbuchungen zu bestätigen.<br/>  Du musst die Bedingungen annehmen, um die Buchung zu bestätigen",en_GB:"Please tick the box to show you have read and understand the terms & conditions.<br/>  You must accept the terms and conditions for us to confirm your booking.",es_ES:"Por favor, señale la caja si ha leido y entiende los Términos y Condiciones.<br/>  Debe aceptarlos para que podamos confirmar su reserva.",fi_FI:"Rastita ruutu merkiksi siitä, että olet lukenut säännöt ja ehdot ja että hyväksyt ne. <br/> Varauksen vahvistaminen edellyttää sääntöjen ja ehtojen hyväksymistä.",fr_FR:"Veuillez cocher la case pour indiquer que vous acceptez les termes et conditions.<br/>  Vous devez accepter les termes et conditions pour que nous puissions confirmer votre réservation",it_IT:"Per favore clicchi nella casella per mostrare di aver letto e capito i termini e condizioni.<br/>  É necessario accettare i termini e condizioni per confermare la prenotazione.",ja_JP:"ボックスにチェックを入れて、利用規約を読んで理解していることを示してください。<br/> 予約を確認するためには、利用規約に同意していただかなければなりません。",ko_KR:"표준 이용 약관에 동의하시면 확인란에 체크해주세요. 예약을 확정하기 위해 표준 이용 약관에 반드시 동의해야 합니다.",nb_NO:"Merk av i boksen for å vise at du har lest og forstått vilkårene og betingelsene. <br/> Du må godta vilkårene og betingelsene før vi kan bekrefte bestillingen.",nl_NL:"Zet een vinkje om aan te geven dat je de algemene voorwaarden hebt gelezen en begrepen.<br/> Je moet de algemene voorwaarden accepteren om je reservering te bevestigen.",pl_PL:"Proszę zaznacz pole, aby zapoznać się z regulaminem rezerwacji. <br/> Musisz zakceptować nasze warunki aby twoja rezerwacja została potwierdzona",pt_PT:"Por favor selecione para mostrar que leu e entendeu os termos e condições.<br/>  Você deve aceitar os termos e condições para que possamos confirmar sua reserva.",ru_RU:"Установите флажок, чтобы показать, что вы прочитали и поняли условия. <br/> Вы должны принять условия для подтверждения бронирования.",sv_SE:"Kryssa för rutan för att visa att du har läst och förstått villkoren. <br/>  Du måste godkänna våra villkor för att bekräfta din bokning.",tr_TR:"Hüküm ve koşulları okuyup anladığınızı göstermek için aşağıdaki kutuyu işaretleyin. <br/> Rezervasyonunuzu onaylamamız için hüküm ve koşulları okuyup anlamanız gerekir.",zh_CN:"请在这个框里打勾，表示您已经阅读并理解条款和条件。<br/> 您必须先接受条款和条件，我们才能确认您的预订。"};var E={pt_BR:"Eu confirmo que li e entendi os termos e condições da reserva de grupo acima.",cs_CZ:"Potvrzuji, že jsem si přečetl/a a rozumím výše uvedeným smluvním podmínkám pro skupinové rezervace v angličtině.",da_DK:"Jeg bekræfter, at jeg har læst og forstået ovenstående vilkår og betingelser for gruppebookinger som angivet her på dansk.",de_DE:"Ich bestätige, ich habe die auf Englisch oben genannten Bedingungen für Gruppenbuchungen gelesen und verstanden.",en_GB:"I confirm I have read and understand the above Group Booking Terms & Conditions as outlined here in English.",es_ES:"Confirmo que he leido y comprendo los Terminos y Condiciones de la reserva de Grupo que se explican en Inglés.",fi_FI:"Vahvistan, että olen lukenut ryhmävarausten säännöt ja ehdot ja että ymmärrän ne sellaisina kuin ne on esitetty tässä suomeksi.",fr_FR:"Je confirme, J'ai lu et compris les conditions ci-dessus de réservation groupe et des conditions énoncées ici en anglais.",it_IT:"Confermo di aver letto e compreso i sopracitati Termini e Condizioni delle Prenotazioni di Gruppo come riportato qui in inglese.",ja_JP:"私は、ここで日本語であらましが説明されている上記のグループ予約利用規約をに読み、理解していることを確認します。",ko_KR:"표준 이용 약관에 동의하시면 확인란에 체크해주세요. 예약을 확정하기 위해 표준 이용 약관에 반드시 동의해야 합니다.",nb_NO:"Jeg bekrefter at jeg har lest og forstått ovenstående vilkår og betingelser for gruppebestillinger som oppgitt her på norsk.",nl_NL:"Ik verklaar dat ik de Algemene Voorwaarden van de Groepsreservering heb gelezen en begrepen zoals deze hierboven in het Nederlands zijn weergegeven.",pl_PL:"Potwierdzam, że zapoznałem się z powyższymi warunkami rezerwacji grupowych, które zostały opisane w języku angielskim.",pt_PT:"Eu confirmo que li e entendi os termos e condições da reserva de grupo acima.",ru_RU:"Подтверждаю, что прочитал и понял приведенные выше условия бронирования, как указано здесь на английском языке.",sv_SE:"Jag bekräftar att jag har läst och förstått ovanstående gruppbokningsvillkor som beskrivs här på svenska.",tr_TR:"Yukarıda İngilizce olarak belirtilen Grup Rezervasyonu Hüküm ve Koşullarını okuyup anladığımı onaylıyorum.",zh_CN:"我确认我已经阅读并理解以上用中文列出的团体预订条款和条件。"},k=r(462),S=r(463);const T={t_GROUPTERMSHEADING:l,t_GENERALGROUPBOOKINGTERMS:c,t_GROUPTERMSMAIN:h,t_HOSTELSPECIFICTERMS:d,t_REMAINDERPAYABLE:f,t_GROUPNUMBERSCHANGE:m,t_CANCELLATIONTERMS:y,t_ADDITIONALTERMS:v,t_ADDITIONALINFO:_,t_GROUPTERMSWARNING:x,t_GROUPTERMSAGREEERROR:w,t_GROUPTERMSAGREE:E,t_CANCEL:k.a,t_CONFIRM:S.a};var I=t=>Object.assign({},...Object.keys(T).map(e=>({[e]:T[e][t]||T[e].en_GB}))),z={name:"TermsConditions",components:{Checkbox:o.a,Button:n.a},props:{remainderDue:{type:String,required:!1,default:""},cancellationTerms:{type:String,required:!1,default:""},additionalTerms:{type:String,required:!1,default:""},notes:{type:Array,required:!1,default:()=>[]},displaySubmit:{type:Boolean,required:!1,default:!0}},data:()=>({groupBookingTerms:!1}),computed:{showCheckbox(){return"en_GB"!==this.$store.state.session.language.code&&this.displaySubmit}},created(){this.$setTranscodes(I(this.$store.state.session.language.code))},methods:{cancelTerms(){this.$emit("close")},confirmTerms(){this.$emit("confirm")}}},C=(r(1044),r(5)),component=Object(C.a)(z,(function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("div",{staticClass:"terms-conditions"},[r("p",{staticClass:"body-2"},[t._v(t._s(t.$t("t_GROUPTERMSHEADING")))]),t._v(" "),r("h3",{staticClass:"title-5"},[t._v(t._s(t.$t("t_GENERALGROUPBOOKINGTERMS")))]),t._v(" "),r("p",{staticClass:"body-2",domProps:{innerHTML:t._s(t.$t("t_GROUPTERMSMAIN"))}}),t._v(" "),r("h3",{staticClass:"title-5"},[t._v(t._s(t.$t("t_HOSTELSPECIFICTERMS")))]),t._v(" "),r("p",{staticClass:"body-2"},[t._v(t._s(t.$t("t_REMAINDERPAYABLE"))+" "+t._s(t.$t(t.remainderDue))+" "+t._s(t.$t("t_GROUPNUMBERSCHANGE")))]),t._v(" "),t.cancellationTerms?r("div",{staticClass:"cancellation-terms"},[r("h3",{staticClass:"title-5"},[t._v(t._s(t.$t("t_CANCELLATIONTERMS")))]),t._v(" "),r("p",{staticClass:"body-2"},[t._v(t._s(t.cancellationTerms))])]):t._e(),t._v(" "),t.additionalTerms.length?r("div",{staticClass:"additional-terms"},[r("h3",{staticClass:"title-5"},[t._v(t._s(t.$t("t_ADDITIONALTERMS")))]),t._v(" "),r("p",{staticClass:"body-2"},[t._v(t._s(t.additionalTerms))])]):t._e(),t._v(" "),t.notes.length?r("div",{staticClass:"additional-notes"},[r("h3",{staticClass:"title-5"},[t._v(t._s(t.$t("t_ADDITIONALINFO")))]),t._v(" "),r("p",{staticClass:"body-2"},[t._v(t._s(t.notes))])]):t._e(),t._v(" "),r("p",{staticClass:"body-2"},[t._v(t._s(t.$t("t_GROUPTERMSWARNING")))]),t._v(" "),t.showCheckbox?r("div",{staticClass:"group-terms-checkbox"},[r("p",{staticClass:"group-tc-error body-2",domProps:{innerHTML:t._s(t.$t("t_GROUPTERMSAGREEERROR"))}}),t._v(" "),r("Checkbox",{attrs:{label:t.$t("t_GROUPTERMSAGREE")},model:{value:t.groupBookingTerms,callback:function(e){t.groupBookingTerms=e},expression:"groupBookingTerms"}})],1):t._e(),t._v(" "),t.displaySubmit?r("div",{staticClass:"submit-buttons"},[r("Button",{attrs:{id:"cancel-terms",color:"secondary"},on:{click:t.cancelTerms}},[r("span",[t._v(t._s(t.$t("t_CANCEL")))])]),t._v(" "),r("Button",{attrs:{id:"confirm-terms",disabled:!t.groupBookingTerms&&t.showCheckbox},on:{click:t.confirmTerms}},[r("span",[t._v(t._s(t.$t("t_CONFIRM")))])])],1):t._e()])}),[],!1,null,"4342d9d9",null);e.default=component.exports},1073:function(t,e,r){"use strict";r.r(e);var o=r(724),n=r(326),l=r(41),c=r(21),h=r(373);var d={pt_BR:"Início",cs_CZ:"Domů",da_DK:"Hjem",de_DE:"Home",en_GB:"Home",es_ES:"Inicio",fi_FI:"Etusivu",fr_FR:"Accueil",it_IT:"Home",ja_JP:"ホーム",ko_KR:"홈",nb_NO:"Home",nl_NL:"Thuis",pl_PL:"Strona główna",pt_PT:"Início",ru_RU:"Главная",sv_SE:"Hem",tr_TR:"Ana Sayfa",zh_CN:"首页"},f=r(387),m=r(117),y=r(83),v=r(103),_=r(104),x=r(105),w=r(45),E=r(106),k=r(108),S=r(110);var T={pt_BR:"http://signup.hostelworld.com/br/property/intro",cs_CZ:"http://signup.hostelworld.com/cs/property/intro",da_DK:"http://signup.hostelworld.com/da/property/intro",de_DE:"http://signup.hostelworld.com/de/property/intro",en_GB:"https://signup.hostelworld.com/en/property/intro",es_ES:"https://signup.hostelworld.com/es/property/lang",fi_FI:"http://signup.hostelworld.com/fi/property/intro",fr_FR:"http://signup.hostelworld.com/fr/property/intro",it_IT:"http://signup.hostelworld.com/it/property/intro",ja_JP:"http://signup.hostelworld.com/jp/property/intro",ko_KR:"http://signup.hostelworld.com/ko/property/intro",nb_NO:"http://signup.hostelworld.com/no/property/intro",nl_NL:"http://signup.hostelworld.com/nl/property/intro",pl_PL:"http://signup.hostelworld.com/pl/property/intro",pt_PT:"http://signup.hostelworld.com/pt/property/intro",ru_RU:"http://signup.hostelworld.com/ru/property/intro",sv_SE:"http://signup.hostelworld.com/sv/property/intro",tr_TR:"http://signup.hostelworld.com/tr/property/intro",zh_CN:"http://signup.hostelworld.com/zh/property/intro"};var I={pt_BR:"http://partners.hostelworld.com/",cs_CZ:"http://partners.hostelworld.com/",da_DK:"http://partners.hostelworld.com/",de_DE:"http://partners.hostelworld.com/",en_GB:"http://partners.hostelworld.com/",es_ES:"http://partners.hostelworld.com/",fi_FI:"http://partners.hostelworld.com/",fr_FR:"http://partners.hostelworld.com/",it_IT:"http://partners.hostelworld.com/",ja_JP:"http://partners.hostelworld.com/",ko_KR:"http://partners.hostelworld.com/",nb_NO:"http://partners.hostelworld.com/",nl_NL:"http://partners.hostelworld.com/",pl_PL:"http://partners.hostelworld.com/",pt_PT:"http://partners.hostelworld.com/",ru_RU:"http://partners.hostelworld.com/",sv_SE:"http://partners.hostelworld.com/",tr_TR:"http://partners.hostelworld.com/",zh_CN:"http://partners.hostelworld.com/",th_TH:"http://partners.hostelworld.com/"},z=r(383),C=r(352),P=r(384);var A={pt_BR:"Listas de Desejo",cs_CZ:"Seznamy přání",da_DK:"Ønskelister",de_DE:"Wunschliste",en_GB:"Wish Lists",es_ES:"Listas de deseos",fi_FI:"Toivelistat",fr_FR:"Wish Lists",it_IT:"Lista dei desideri",ja_JP:"ウィッシュリスト",ko_KR:"위시리스트",nb_NO:"Ønskelister",nl_NL:"Wenslijsten",pl_PL:"Lista życzeń",pt_PT:"Favoritos",ru_RU:"Список желаний",sv_SE:"Önskelistor",tr_TR:"İstek Listeleri",zh_CN:"心愿单"},M=r(385);var L={pt_BR:"Explorar o Hostelworld",cs_CZ:"Prohlédnout Hostelworld",da_DK:"Udforsk Hostelworld",de_DE:"Hostelworld entdecken",en_GB:"Explore Hostelworld",es_ES:"Explorar Hostelworld",fi_FI:"Tutustu Hostelworldiin",fr_FR:"Découvrez Hostelworld",it_IT:"Esplora Hostelworld",ja_JP:"Hostelworld について",ko_KR:"호스텔월드 알아보기",nb_NO:"Utforsk Hostelworld",nl_NL:"Hostelworld verkennen",pl_PL:"Odkryj Hostelworld",pt_PT:"Explorar Hostelworld",ru_RU:"Узнать больше о Hostelworld",sv_SE:"Utforska Hostelworld",tr_TR:"Hostelworld'ü Keşfet",zh_CN:"浏览旅舍世界Hostelworld网页"},R=r(96),D=r(46),O=r(107),B=r(109),F=r(90);var U={pt_BR:"Trabalhe Conosco",cs_CZ:"Pracujte pro nás",da_DK:"Arbejd hos os",de_DE:"Arbeite mit uns",en_GB:"Work With Us",es_ES:"Trabaje con nosotros",fi_FI:"Työskentely kanssamme",fr_FR:"Travailler pour nous",it_IT:"Lavora con noi",ja_JP:"採用情報",ko_KR:"숙소등록/제휴",nb_NO:"Jobbe hos oss",nl_NL:"Samenwerking",pl_PL:"Pracuj dla nas",pt_PT:"Trabalhe connosco",ru_RU:"Карьера в Hostelworld",sv_SE:"Arbeta med oss",tr_TR:"Bizimle Çalışın",zh_CN:"工作机会"},N=r(111),j=r(112),V=r(85),G=r(89);var Z={pt_BR:"Pousadas",cs_CZ:"Nocleh se snídaní",da_DK:"Bed & Breakfast",de_DE:"Bed and Breakfast",en_GB:"Bed and Breakfasts",es_ES:"Pensiones",fi_FI:"Aamiaismajoitukset",fr_FR:"Chambres d'hôtes",it_IT:"Bed and Breakfast",ja_JP:"朝食付き宿（B&B）",ko_KR:"침대 및 조식제공 숙소",nb_NO:"Bed and Breakfast",nl_NL:"Bed en Breakfasts",pl_PL:"Noclegi ze śniadaniem",pt_PT:"Pensões",ru_RU:"Гостевой дом",sv_SE:"Bed & breakfast",tr_TR:"Pansiyonlar",zh_CN:"旅馆"},H=r(362),K=r(386),W=r(114),X=r(113);function $(object,t){var e=Object.keys(object);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(object);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(object,t).enumerable}))),e.push.apply(e,r)}return e}function J(t){for(var i=1;i<arguments.length;i++){var source=null!=arguments[i]?arguments[i]:{};i%2?$(Object(source),!0).forEach((function(e){Y(t,e,source[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(source)):$(Object(source)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(source,e))}))}return t}function Y(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}const Q=J(J({},{t_HOME:d,t_SIGNINCREATEACCOUNT:f.a,t_CONTACTUSURL:m.a,t_HELP:y.a,t_MENUURLHOSTELS:v.a,t_MENUURLHOTELS:_.a,t_MENUURLBB:x.a,t_MENUURLBLOG:w.a,t_MENUURLGROUPBOOKINGS:E.a,t_MENUURLBOOKINGGUARANTEE:k.a,t_MENUURLHOSCARAWARDS:S.a,t_MENUURLHOSTELSIGNUP:T,t_MENUURLAFFILIATEPROGRAM:I,t_BOOKINGS:z.a,t_REVIEWS:C.a,t_LOGOUT:P.a,t_WISHLISTS:A,t_ACCOUNT:M.a,t_EXPLOREHOSTELWORLD:L,t_ACCOMMODATION:R.a,t_BLOG:D.a,t_GROUPBOOKINGS:O.a,t_BOOKINGGUARANTEE:B.a,t_HOSCARAWARDS:F.a,t_WORKWITHUS:U,t_HOSTELSIGNUP:N.a,t_AFFILIATEPROGRAM:j.a,t_HOSTELS:V.a,t_HOTELS:G.a,t_GUESTHOUSES:Z,t_ERRORPROCESSINGREQUESTMESSAGE:H.a,t_YOUHAVEBEENLOGGEDOUT:K.a,t_INBOXLOGIN:W.a,t_MENUURLINBOXLOGIN:X.a}),h);var tt=t=>Object.assign({},...Object.keys(Q).map(e=>({[e]:Q[e][t]||Q[e].en_GB})));function et(object,t){var e=Object.keys(object);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(object);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(object,t).enumerable}))),e.push.apply(e,r)}return e}function it(t){for(var i=1;i<arguments.length;i++){var source=null!=arguments[i]?arguments[i]:{};i%2?et(Object(source),!0).forEach((function(e){ot(t,e,source[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(source)):et(Object(source)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(source,e))}))}return t}function ot(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}var nt={name:"HamburgerMenu",components:{Dropdown:o.a,DrawerTransition:n.b,LanguagePicker:()=>r.e(34).then(r.bind(null,401)),CurrencyPicker:()=>r.e(33).then(r.bind(null,402)),LoginDialog:()=>Promise.all([r.e(0),r.e(32)]).then(r.bind(null,1091)),LoginModal:()=>Promise.all([r.e(0),r.e(1),r.e(40)]).then(r.bind(null,1088)),Icon:l.a},data:()=>({showLogin:!1}),computed:it(it({},Object(c.e)({loggedIn:t=>t.session.auth})),{},{languageText(){return this.$store.state.session.language.name},currencyText(){const t=this.$store.state.session.currency;return"".concat(this.$t(t.transcode)," (").concat(t.symbol,")")}}),created(){this.$setTranscodes(tt(this.$store.state.session.language.code))},mounted(){window.addEventListener("keydown",this.handleEscape)},destroyed(){window.removeEventListener("keydown",this.handleEscape)},methods:{handleEscape(t){27===t.keyCode&&this.$emit("close")},async logout(){let t;try{const e=await this.$services.auth();t=await e.logout(),this.$emit("close"),this.displayToastMessage(this.$t("t_YOUHAVEBEENLOGGEDOUT"),"success")}catch(t){return void this.displayToastMessage(this.$t("t_ERRORPROCESSINGREQUESTMESSAGE"),"error")}t.loggedOut?(this.$store.dispatch("session/logout"),this.displayToastMessage(t.messages.join(", "),"info")):this.displayToastMessage(t.errors.join(", "),"error")},displayToastMessage(t,e){this.$store.commit("toast/show",{message:t,type:e})}}},at=(r(978),r(5)),component=Object(at.a)(nt,(function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("DrawerTransition",{attrs:{appear:""}},[r("div",{staticClass:"screen menu"},[r("div",{staticClass:"scroll-wrapper"},[r("div",{staticClass:"navigation"},[r("span",{staticClass:"icon",on:{click:function(e){return t.$emit("close")}}},[r("Icon",{attrs:{name:"core-close"}})],1)]),t._v(" "),r("div",{staticClass:"content"},[t.loggedIn?r("ul",[r("li",{staticClass:"go-to-account"},[r("a",{attrs:{href:t.$langHwUrl+"/account"}},[t._v("\n              "+t._s(t.$t("t_BOOKINGS"))+"\n            ")])]),t._v(" "),r("li",{staticClass:"go-to-reviews"},[r("a",{attrs:{href:t.$langHwUrl+"/account/reviews"}},[t._v("\n              "+t._s(t.$t("t_REVIEWS"))+"\n            ")])]),t._v(" "),r("li",{staticClass:"go-to-settings"},[r("a",{attrs:{href:t.$langHwUrl+"/account/settings"}},[t._v("\n              "+t._s(t.$t("t_ACCOUNT"))+"\n            ")])]),t._v(" "),r("li",{staticClass:"go-to-contact-us"},[r("a",{attrs:{href:t.$t("t_CONTACTUSURL"),rel:"noopener noreferrer"}},[t._v(t._s(t.$t("t_HELP")))])]),t._v(" "),r("li",{staticClass:"logout-action",on:{click:t.logout}},[t._v(t._s(t.$t("t_LOGOUT")))])]):r("ul",[r("li",[r("nuxt-link",{attrs:{to:"/",title:t.$t("t_HOME")}},[t._v(t._s(t.$t("t_HOME")))])],1),t._v(" "),r("li",{staticClass:"login-action",attrs:{id:"menu-login"},on:{click:function(e){t.showLogin=!0}}},[t._v(t._s(t.$t("t_SIGNINCREATEACCOUNT")))]),t._v(" "),r("li",[r("a",{attrs:{href:t.$t("t_CONTACTUSURL"),rel:"noopener noreferrer"}},[t._v(t._s(t.$t("t_HELP")))])])]),t._v(" "),t.$device.isMobile?[r("div",{staticClass:"option"},[r("LanguagePicker",{attrs:{id:"menu-language-picker"}},[r("Dropdown",{attrs:{text:t.languageText,size:"large","full-width":""}})],1)],1),t._v(" "),r("div",{staticClass:"option"},[r("CurrencyPicker",{attrs:{id:"menu-currency-picker"}},[r("Dropdown",{attrs:{text:t.currencyText,size:"large","full-width":""}})],1)],1)]:t._e(),t._v(" "),r("ul",[r("li",{staticClass:"section"},[t._v(t._s(t.$t("t_ACCOMMODATION")))]),t._v(" "),r("li",[r("a",{attrs:{href:t.$t("t_MENUURLHOSTELS")}},[t._v(t._s(t.$t("t_HOSTELS")))])]),t._v(" "),r("li",[r("a",{attrs:{href:t.$t("t_MENUURLHOTELS")}},[t._v(t._s(t.$t("t_HOTELS")))])]),t._v(" "),r("li",[r("a",{attrs:{href:t.$t("t_MENUURLBB")}},[t._v(t._s(t.$t("t_GUESTHOUSES")))])])]),t._v(" "),r("ul",[r("li",{staticClass:"section"},[t._v(t._s(t.$t("t_EXPLOREHOSTELWORLD")))]),t._v(" "),r("li",[r("a",{attrs:{href:t.$t("t_MENUURLBLOG"),rel:"noopener noreferrer",target:"_blank"}},[t._v("\n              "+t._s(t.$t("t_BLOG"))+"\n            ")])]),t._v(" "),r("li",[r("a",{attrs:{href:t.$t("t_MENUURLGROUPBOOKINGS"),rel:"noopener noreferrer",target:"_blank"}},[t._v("\n              "+t._s(t.$t("t_GROUPBOOKINGS"))+"\n            ")])]),t._v(" "),r("li",[r("a",{attrs:{href:t.$t("t_MENUURLBOOKINGGUARANTEE"),rel:"noopener noreferrer",target:"_blank"}},[t._v("\n              "+t._s(t.$t("t_BOOKINGGUARANTEE"))+"\n            ")])]),t._v(" "),r("li",[r("a",{attrs:{href:t.$t("t_MENUURLHOSCARAWARDS"),rel:"noopener noreferrer",target:"_blank"}},[t._v("\n              "+t._s(t.$t("t_HOSCARAWARDS"))+"\n            ")])])]),t._v(" "),r("ul",[r("li",{staticClass:"section"},[t._v(t._s(t.$t("t_WORKWITHUS")))]),t._v(" "),r("li",[r("a",{attrs:{href:t.$t("t_MENUURLHOSTELSIGNUP"),rel:"noopener noreferrer",target:"_blank"}},[t._v("\n              "+t._s(t.$t("t_HOSTELSIGNUP"))+"\n            ")])]),t._v(" "),r("li",[r("a",{attrs:{href:t.$t("t_MENUURLAFFILIATEPROGRAM"),rel:"noopener noreferrer",target:"_blank"}},[t._v("\n              "+t._s(t.$t("t_AFFILIATEPROGRAM"))+"\n            ")])]),t._v(" "),t.$device.isDesktop?r("li",[r("a",{attrs:{href:t.$t("t_MENUURLINBOXLOGIN"),rel:"noopener noreferrer",target:"_blank"}},[t._v("\n              "+t._s(t.$t("t_INBOXLOGIN"))+"\n            ")])]):t._e()])],2)]),t._v(" "),t.showLogin?[t.$device.isDesktopOrTablet?r("LoginModal",{on:{close:function(e){t.showLogin=!1}}}):r("LoginDialog",{on:{close:function(e){t.showLogin=!1}}})]:t._e()],2)])}),[],!1,null,"24ff4d5f",null);e.default=component.exports},1074:function(t,e,r){"use strict";r.r(e);var o=r(375),n=r(314),l={name:"GenericQuestionModal",components:{Modal:o.a,ModalHeader:o.d,ModalContent:o.b,Button:n.a},props:{confirmLabel:{type:String,required:!1,default:null},cancelLabel:{type:String,required:!1,default:null}},data:()=>({showModal:!1})},c=(r(1006),r(5)),h=Object(c.a)(l,(function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("modal",{attrs:{size:"small","full-height":t.$screen.isSmall()},on:{close:function(e){return t.$emit("cancel")}}},[r("modal-header"),t._v(" "),r("modal-content",[r("div",{staticClass:"content"},[t._t("content"),t._v(" "),r("div",{staticClass:"submit-buttons"},[t.cancelLabel?r("Button",{attrs:{id:"cancel",color:"secondary"},on:{click:function(e){return t.$emit("cancel")}}},[r("span",[t._v(t._s(t.cancelLabel))])]):t._e(),t._v(" "),r("Button",{attrs:{id:"confirm"},on:{click:function(e){return t.$emit("confirm")}}},[r("span",[t._v(t._s(t.confirmLabel))])])],1)],2)])],1)}),[],!1,null,"12da0f73",null).exports,d=r(462),f=r(463);var m={pt_BR:"Choose rooms.",cs_CZ:"Choose rooms.",da_DK:"Choose rooms.",de_DE:"Choose rooms.",en_GB:"Choose rooms.",es_ES:"Choose rooms.",fi_FI:"Choose rooms.",fr_FR:"Choose rooms.",it_IT:"Choose rooms.",ja_JP:"Choose rooms.",ko_KR:"Choose rooms.",nb_NO:"Choose rooms.",nl_NL:"Choose rooms.",pl_PL:"Choose rooms.",pt_PT:"Choose rooms.",ru_RU:"Choose rooms.",sv_SE:"Choose rooms.",tr_TR:"Choose rooms.",zh_CN:"Choose rooms.",th_TH:"Choose rooms."};const y={t_CANCEL:d.a,t_CONFIRM:f.a,t_CHOOSEROOMS:m};var v=t=>Object.assign({},...Object.keys(y).map(e=>({[e]:y[e][t]||y[e].en_GB}))),_={name:"SimpleConfirmationModal",components:{GenericQuestionModal:h},props:{image:{type:String,required:!0},title:{type:String,required:!0},message:{type:String,required:!0},confirmOnly:{type:Boolean,required:!1,default:!1},confirmationTranscode:{type:String,required:!1,default:"t_CONFIRM"}},computed:{cancelOption(){return this.confirmOnly?null:this.$t("t_CANCEL")}},created(){this.$setTranscodes(v(this.$store.state.session.language.code))}},x=(r(1008),Object(c.a)(_,(function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("div",{staticClass:"simple-confirmation-modal"},[r("generic-question-modal",{attrs:{"confirm-label":t.$t(t.confirmationTranscode),"cancel-label":t.cancelOption},on:{confirm:function(e){return t.$emit("confirm")},cancel:function(e){return t.$emit("cancel")}}},[r("div",{attrs:{slot:"content"},slot:"content"},[r("img",{attrs:{src:t.image,alt:t.title}}),t._v(" "),r("h1",{staticClass:"title-6"},[t._v(t._s(t.title))]),t._v(" "),r("p",{staticClass:"body-1"},[t._v(t._s(t.message))])])])],1)}),[],!1,null,"74468a48",null));e.default=x.exports},1088:function(t,e,r){"use strict";r.r(e);var o=r(375),n=r(774),l=r(775),c=r(766),h={name:"LoginModal",components:{Modal:o.a,ModalHeader:o.d,ModalContent:o.b,ModalFooterError:o.c,LoginForm:n.a,ResetPasswordForm:l.a},data:()=>({email:null,resetPassword:!1,errorMsg:null}),computed:{title(){return this.resetPassword?this.$t("t_FORGOTTENPASSWORD"):this.$t("t_LOGIN")}},created(){this.$setTranscodes(Object(c.a)(this.$store.state.session.language.code))},methods:{close(){this.$emit("close")},handleForgotPassword(t){this.email=t,this.resetPassword=!0},hasLoginError(t){this.errorMsg=t}}},d=r(5),component=Object(d.a)(h,(function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("Modal",{attrs:{size:"small"},on:{close:t.close}},[r("ModalHeader",{attrs:{title:t.title}}),t._v(" "),r("ModalContent",{attrs:{padded:""}},[t.resetPassword?r("ResetPasswordForm",{attrs:{"initial-email":t.email},on:{back:function(e){t.resetPassword=!1}}}):r("LoginForm",{attrs:{"initial-email":t.email},on:{"forgot-password":t.handleForgotPassword,login:t.close,hasError:t.hasLoginError}})],1),t._v(" "),t.errorMsg?r("ModalFooterError",{attrs:{error:t.errorMsg}}):t._e()],1)}),[],!1,null,null,null);e.default=component.exports},1091:function(t,e,r){"use strict";r.r(e);var o=r(353),n=r(326),l=r(774),c=r(775),h=r(766),d={name:"LoginDialog",components:{FullScreenDialog:o.a,FullScreenDialogHeader:o.c,FullScreenDialogContent:o.b,PopTransition:n.c,LoginForm:l.a,ResetPasswordForm:c.a},data:()=>({email:null,resetPassword:!1}),computed:{title(){return this.resetPassword?this.$t("t_FORGOTTENPASSWORD"):this.$t("t_LOGIN")}},created(){this.$setTranscodes(Object(h.a)(this.$store.state.session.language.code))},methods:{close(){this.$emit("close")},handleForgotPassword(t){this.email=t,this.resetPassword=!0}}},f=r(5),component=Object(f.a)(d,(function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("PopTransition",{attrs:{appear:""}},[r("FullScreenDialog",{on:{close:t.close}},[r("FullScreenDialogHeader",{attrs:{title:t.title}}),t._v(" "),r("FullScreenDialogContent",{attrs:{padded:""}},[t.resetPassword?r("ResetPasswordForm",{attrs:{"initial-email":t.email},on:{back:function(e){t.resetPassword=!1}}}):r("LoginForm",{attrs:{"initial-email":t.email},on:{"forgot-password":t.handleForgotPassword,login:t.close}})],1)],1)],1)}),[],!1,null,null,null);e.default=component.exports},158:function(t,e,r){"use strict";r.r(e),e.default={microsite:{token:"pk.eyJ1IjoiaG9zdGVsd29ybGRwcm9kdWN0IiwiYSI6ImNqc3VmNmRxOTE4MDM0M3M5MGk3czk2ZzIifQ.xsWIVAnUNKLtwrnAfCVvbQ",style:"mapbox/streets-v11",zoom:13},search:{token:"pk.eyJ1IjoiaG9zdGVsd29ybGRwcm9kdWN0IiwiYSI6ImNqdXR1NHBxdDA1cGc0ZW54MWFyOGRpZTQifQ.j9wsue6dC2EVRzS_WUVIPQ",style:"mapbox://styles/hostelworldproduct/cjsu9bpqn6ew61fmsw6fvmszb"}}},266:function(t,e,r){"use strict";r.r(e),r.d(e,"Client",(function(){return O})),r.d(e,"Response",(function(){return o})),r.d(e,"FilterData",(function(){return S})),r.d(e,"Location",(function(){return w})),r.d(e,"Pagination",(function(){return I})),r.d(e,"Property",(function(){return n})),r.d(e,"Price",(function(){return T})),r.d(e,"Image",(function(){return v})),r.d(e,"Facility",(function(){return x})),r.d(e,"FacilityCategory",(function(){return _})),r.d(e,"FreeCancellationDetails",(function(){return h})),r.d(e,"District",(function(){return c})),r.d(e,"Distance",(function(){return d})),r.d(e,"RoomBreakdown",(function(){return m})),r.d(e,"OverallRating",(function(){return l})),r.d(e,"Room",(function(){return y})),r.d(e,"Region",(function(){return k})),r.d(e,"StayRuleViolation",(function(){return f})),r.d(e,"City",(function(){return E}));class o{constructor(t,e,r,o,n){this.properties=t,this.location=e,this.filterData=r,this.pagination=o,this.sortOrder=n}}class n{constructor(t,e,r,o,n,l,c,h,d,f,m,y,v,_,x,w,E,k,S,T,I,z,C,P,A,M,L,R,D,O,B,F,U,N,j,V,G,Z,H){this.id=t,this.isPromoted=e,this.hbid=r,this.name=o,this.starRating=n,this.overallRating=l,this.latitude=c,this.longitude=h,this.isFeatured=d,this.type=f,this.address1=m,this.address2=y,this.freeCancellationAvailable=v,this.freeCancellationAvailableUntil=_,this.districts=x,this.freeCancellation=w,this.lowestPricePerNight=E,this.lowestPrivatePricePerNight=k,this.lowestDormPricePerNight=S,this.lowestAveragePricePerNight=T,this.lowestAverageDormPricePerNight=I,this.lowestAveragePrivatePricePerNight=z,this.originalLowestAveragePricePerNight=C,this.originalLowestAverageDormPricePerNight=P,this.originalLowestAveragePrivatePricePerNight=A,this.isNew=M,this.overview=L,this.isElevate=R,this.hostelworldRecommends=D,this.distance=O,this.position=B,this.fabSort=F,this.stayRuleViolations=U,this.veryPopular=N,this.rooms=j,this.images=V,this.imagesGallery=G,this.facilities=Z,this.ratingBreakdown=H}}class l{constructor(t,e){this.overall=t,this.numberOfRatings=e}}class c{constructor(t,e){this.id=t,this.name=e}}class h{constructor(label,t){this.label=label,this.description=t}}class d{constructor(t,e){this.value=t,this.units=e}}class f{constructor(t){this.description=t}}class m{constructor(t,e){this.privates=t,this.dorms=e}}class y{constructor(t,e,r,o,n,l,c){this.id=t,this.token=e,this.name=r,this.capacity=o,this.ensuite=n,this.basicType=l,this.conditions=c}}class v{constructor(t,e){this.prefix=t,this.suffix=e}}class _{constructor(t,e,r){this.name=t,this.id=e,this.facilities=r}}class x{constructor(t,e){this.name=t,this.id=e}}class w{constructor(t,e){this.city=t,this.region=e}}class E{constructor(t,e,r,o){this.id=t,this.name=e,this.idCountry=r,this.country=o}}class k{constructor(t,e){this.id=t,this.name=e}}class S{constructor(t,e){this.highestPricePerNight=t,this.lowestPricePerNight=e}}class T{constructor(t,e){this.value=Number(t),this.currency=e}}class I{constructor(t,e,r,o){this.next=t,this.prev=e,this.numberOfPages=r,this.totalNumberOfItems=o}}const z=data=>new n(data.id,data.isPromoted,data.hbid,data.name,data.starRating,P(data.overallRating),data.latitude,data.longitude,data.isFeatured,data.type,data.address1,data.address2,data.freeCancellationAvailable,new Date(data.freeCancellationAvailableUntil),data.districts.map(t=>new c(t.id,t.name)),new h(data.freeCancellation.label,data.freeCancellation.description),A(data.lowestPricePerNight),A(data.lowestPrivatePricePerNight),A(data.lowestDormPricePerNight),A(data.lowestAveragePricePerNight),A(data.lowestAverageDormPricePerNight),A(data.lowestAveragePrivatePricePerNight),A(data.originalLowestAveragePricePerNight),A(data.originalLowestAverageDormPricePerNight),A(data.originalLowestAveragePrivatePricePerNight),data.isNew,data.overview,data.isElevate,data.hostelworldRecommends,new d(data.distance.value,data.distance.units),data.position,data.fabSort,data.stayRuleViolations.map(t=>new f(t.description)),data.veryPopular,data.rooms?M(data.rooms):null,data.images.map(i=>new v(i.prefix,i.suffix)),data.imagesGallery.map(i=>new v(i.prefix,i.suffix)),data.facilities.map(t=>L(t)),data.ratingBreakdown),C=data=>data?new S(new T(data.highestPricePerNight.value,data.highestPricePerNight.currency),new T(data.lowestPricePerNight.value,data.lowestPricePerNight.currency)):null,P=data=>data?new l(Number(data.overall),Number(data.numberOfRatings)):new l(0,0),A=t=>t?new T(t.value,t.currency):null,M=data=>{const t=t=>t.map(t=>new y(t.id,t.token,t.name,Number(t.capacity),t.ensuite,t.basicType,t.conditions));return new m(t(data.privates),t(data.dorms))},L=data=>new _(data.name,data.id,data.facilities.map(t=>new x(t.name,t.id)));var R=r(42);function D(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}class O{constructor(t,e,r,o){this.axios=t,this.baseUrl=e,this.language=r,this.currency=o}async search(t,e={},r=!1){const n={headers:{"Accept-Language":this.language},params:{currency:this.currency,application:"web"},onUploadProgress:null},l=Object(R.c)(document.cookie||"");r&&(n.params["user-id"]=l["optimizely-aid"]||""),e.dateStart&&(n.params["date-start"]=e.dateStart),e.numNights&&(n.params["num-nights"]=e.numNights),e.guests&&(n.params.guests=e.guests),e.sort&&(n.params.sort=e.sort),e.page&&(n.params.page=e.page),e.perPage&&(n.params["per-page"]=e.perPage),e.latitude&&(n.params.latitude=e.latitude),e.longitude&&(n.params.longitude=e.longitude),e.groupType&&(n.params["group-type"]=e.groupType),e.groupAgeRange&&(n.params["group-age-range"]=e.groupAgeRange.join(",")),e.showRooms&&(n.params["show-rooms"]=Number(e.showRooms)),e.propertyType&&(n.params["property-type"]=e.propertyType),e.propertyNumImages&&(n.params["property-num-images"]=e.propertyNumImages),e.roomType&&(n.params["room-type"]=e.roomType);return(data=>{var t;const e=data.location,r=data.pagination;return new o(data.properties.map(p=>z(p)),new w(new E(e.city.id,e.city.name,e.city.idCountry,e.city.country),e.region?new k(e.region.id,e.region.name):null),C(data.filterData),new I(r.next,r.prev,r.numberOfPages,r.totalNumberOfItems),(null===(t=data.sortOrder)||void 0===t?void 0:t.segment)||null)})((await this.axios.get("".concat(this.baseUrl,"/cities/").concat(t,"/properties/"),n)).data)}}D(O,"sort",{NAME_DESC:"name",NAME_ASC:"-name",PRICE_DESC:"price",PRICE_ASC:"-price",RATING_DESC:"rating",RATING_ASC:"-rating",DISTANCE_DESC:"distance",DISTANCE_ASC:"-distance"}),D(O,"groupType",{HOLIDAY_WITH_FRIENDS:1,JUNIOR_PRIMARY_SCHOOL:2,HIGH_SECONDARY_SCHOOL:3,COLLEGE_UNIVERSITY:4,BUSINESS_TRIP:5,STAG_HEN_BACHELOR_PARTY:6,SPORTS_GROUP:7,CULTURAL_GROUP:8}),D(O,"ageRange",{ZERO_TO_TWELVE:1,TWELVE_TO_EIGHTEEN:2,EIGHTEEN_TO_TWENTYONE:3,TWENTYONE_TO_THIRTYFIVE:4,THIRTYFIVE_TO_FIFTY:5,FIFTY_PLUS:6}),D(O,"propertyType",{HOSTEL:"hostel",HOTEL:"hotel",GUESTHOUSE:"guesthouse",APARTMENT:"apartment",CAMPSITE:"campsite"}),D(O,"roomType",{DORM:"dorm",PRIVATE:"private"});e.default=O},353:function(t,e,r){"use strict";var o=r(327);r.d(e,"a",(function(){return o.a}));var n=r(328);r.d(e,"c",(function(){return n.a}));var l=r(329);r.d(e,"b",(function(){return l.a}))},364:function(t,e,r){t.exports=function(){"use strict";var t,e,r;function o(o,n){if(t)if(e){var l="var sharedChunk = {}; ("+t+")(sharedChunk); ("+e+")(sharedChunk);",c={};t(c),r=n(c),"undefined"!=typeof window&&(r.workerUrl=window.URL.createObjectURL(new Blob([l],{type:"text/javascript"})))}else e=n;else t=n}return o(0,(function(t){function e(t,e){return t(e={exports:{}},e.exports),e.exports}var r=o;function o(t,e,r,o){this.cx=3*t,this.bx=3*(r-t)-this.cx,this.ax=1-this.cx-this.bx,this.cy=3*e,this.by=3*(o-e)-this.cy,this.ay=1-this.cy-this.by,this.p1x=t,this.p1y=o,this.p2x=r,this.p2y=o}o.prototype.sampleCurveX=function(t){return((this.ax*t+this.bx)*t+this.cx)*t},o.prototype.sampleCurveY=function(t){return((this.ay*t+this.by)*t+this.cy)*t},o.prototype.sampleCurveDerivativeX=function(t){return(3*this.ax*t+2*this.bx)*t+this.cx},o.prototype.solveCurveX=function(t,e){var r,o,i,a,n;for(void 0===e&&(e=1e-6),i=t,n=0;n<8;n++){if(a=this.sampleCurveX(i)-t,Math.abs(a)<e)return i;var s=this.sampleCurveDerivativeX(i);if(Math.abs(s)<1e-6)break;i-=a/s}if((i=t)<(r=0))return r;if(i>(o=1))return o;for(;r<o;){if(a=this.sampleCurveX(i),Math.abs(a-t)<e)return i;t>a?r=i:o=i,i=.5*(o-r)+r}return i},o.prototype.solve=function(t,e){return this.sampleCurveY(this.solveCurveX(t,e))};var i=a;function a(t,e){this.x=t,this.y=e}a.prototype={clone:function(){return new a(this.x,this.y)},add:function(t){return this.clone()._add(t)},sub:function(t){return this.clone()._sub(t)},multByPoint:function(t){return this.clone()._multByPoint(t)},divByPoint:function(t){return this.clone()._divByPoint(t)},mult:function(t){return this.clone()._mult(t)},div:function(t){return this.clone()._div(t)},rotate:function(t){return this.clone()._rotate(t)},rotateAround:function(t,e){return this.clone()._rotateAround(t,e)},matMult:function(t){return this.clone()._matMult(t)},unit:function(){return this.clone()._unit()},perp:function(){return this.clone()._perp()},round:function(){return this.clone()._round()},mag:function(){return Math.sqrt(this.x*this.x+this.y*this.y)},equals:function(t){return this.x===t.x&&this.y===t.y},dist:function(t){return Math.sqrt(this.distSqr(t))},distSqr:function(t){var e=t.x-this.x,r=t.y-this.y;return e*e+r*r},angle:function(){return Math.atan2(this.y,this.x)},angleTo:function(t){return Math.atan2(this.y-t.y,this.x-t.x)},angleWith:function(t){return this.angleWithSep(t.x,t.y)},angleWithSep:function(t,e){return Math.atan2(this.x*e-this.y*t,this.x*t+this.y*e)},_matMult:function(t){var e=t[2]*this.x+t[3]*this.y;return this.x=t[0]*this.x+t[1]*this.y,this.y=e,this},_add:function(t){return this.x+=t.x,this.y+=t.y,this},_sub:function(t){return this.x-=t.x,this.y-=t.y,this},_mult:function(t){return this.x*=t,this.y*=t,this},_div:function(t){return this.x/=t,this.y/=t,this},_multByPoint:function(t){return this.x*=t.x,this.y*=t.y,this},_divByPoint:function(t){return this.x/=t.x,this.y/=t.y,this},_unit:function(){return this._div(this.mag()),this},_perp:function(){var t=this.y;return this.y=this.x,this.x=-t,this},_rotate:function(t){var e=Math.cos(t),r=Math.sin(t),o=r*this.x+e*this.y;return this.x=e*this.x-r*this.y,this.y=o,this},_rotateAround:function(t,e){var r=Math.cos(t),o=Math.sin(t),i=e.y+o*(this.x-e.x)+r*(this.y-e.y);return this.x=e.x+r*(this.x-e.x)-o*(this.y-e.y),this.y=i,this},_round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}},a.convert=function(t){return t instanceof a?t:Array.isArray(t)?new a(t[0],t[1]):t};var n="undefined"!=typeof self?self:{};function s(t,e,o,i){var a=new r(t,e,o,i);return function(t){return a.solve(t)}}var u=s(.25,.1,.25,1);function l(t,e,r){return Math.min(r,Math.max(e,t))}function p(t,e,r){var o=r-e,i=((t-e)%o+o)%o+e;return i===e?r:i}function c(t){for(var e=[],r=arguments.length-1;r-- >0;)e[r]=arguments[r+1];for(var o=0,i=e;o<i.length;o+=1){var a=i[o];for(var n in a)t[n]=a[n]}return t}var h=1;function d(){return h++}function f(){return function t(e){return e?(e^16*Math.random()>>e/4).toString(16):([1e7]+-[1e3]+-4e3+-8e3+-1e11).replace(/[018]/g,t)}()}function m(t){return!!t&&/^[0-9a-f]{8}-[0-9a-f]{4}-[4][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}$/i.test(t)}function y(t,e){t.forEach((function(t){e[t]&&(e[t]=e[t].bind(e))}))}function v(t,e){return-1!==t.indexOf(e,t.length-e.length)}function g(t,e,r){var o={};for(var i in t)o[i]=e.call(r||this,t[i],i,t);return o}function _(t,e,r){var o={};for(var i in t)e.call(r||this,t[i],i,t)&&(o[i]=t[i]);return o}function b(t){return Array.isArray(t)?t.map(b):"object"==typeof t&&t?g(t,b):t}var x={};function w(t){x[t]||("undefined"!=typeof console&&console.warn(t),x[t]=!0)}function E(t,e,r){return(r.y-t.y)*(e.x-t.x)>(e.y-t.y)*(r.x-t.x)}function k(t){for(var e=0,r=0,o=t.length,i=o-1,a=void 0,n=void 0;r<o;i=r++)e+=((n=t[i]).x-(a=t[r]).x)*(a.y+n.y);return e}function S(){return"undefined"!=typeof WorkerGlobalScope&&"undefined"!=typeof self&&self instanceof WorkerGlobalScope}function T(t){var e={};if(t.replace(/(?:^|(?:\s*\,\s*))([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)(?:\=(?:([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)|(?:\"((?:[^"\\]|\\.)*)\")))?/g,(function(t,r,o,i){var a=o||i;return e[r]=!a||a.toLowerCase(),""})),e["max-age"]){var r=parseInt(e["max-age"],10);isNaN(r)?delete e["max-age"]:e["max-age"]=r}return e}var I=null;function z(t){if(null==I){var e=t.navigator?t.navigator.userAgent:null;I=!!t.safari||!(!e||!(/\b(iPad|iPhone|iPod)\b/.test(e)||e.match("Safari")&&!e.match("Chrome")))}return I}function C(t){try{var e=n[t];return e.setItem("_mapbox_test_",1),e.removeItem("_mapbox_test_"),!0}catch(t){return!1}}var P,A,M,L,R=n.performance&&n.performance.now?n.performance.now.bind(n.performance):Date.now.bind(Date),D=n.requestAnimationFrame||n.mozRequestAnimationFrame||n.webkitRequestAnimationFrame||n.msRequestAnimationFrame,O=n.cancelAnimationFrame||n.mozCancelAnimationFrame||n.webkitCancelAnimationFrame||n.msCancelAnimationFrame,B={now:R,frame:function(t){var e=D(t);return{cancel:function(){return O(e)}}},getImageData:function(t,e){void 0===e&&(e=0);var r=n.document.createElement("canvas"),o=r.getContext("2d");if(!o)throw new Error("failed to create canvas 2d context");return r.width=t.width,r.height=t.height,o.drawImage(t,0,0,t.width,t.height),o.getImageData(-e,-e,t.width+2*e,t.height+2*e)},resolveURL:function(t){return P||(P=n.document.createElement("a")),P.href=t,P.href},hardwareConcurrency:n.navigator&&n.navigator.hardwareConcurrency||4,get devicePixelRatio(){return n.devicePixelRatio},get prefersReducedMotion(){return!!n.matchMedia&&(null==A&&(A=n.matchMedia("(prefers-reduced-motion: reduce)")),A.matches)}},F={API_URL:"https://api.mapbox.com",get EVENTS_URL(){return this.API_URL?0===this.API_URL.indexOf("https://api.mapbox.cn")?"https://events.mapbox.cn/events/v2":0===this.API_URL.indexOf("https://api.mapbox.com")?"https://events.mapbox.com/events/v2":null:null},FEEDBACK_URL:"https://apps.mapbox.com/feedback",REQUIRE_ACCESS_TOKEN:!0,ACCESS_TOKEN:null,MAX_PARALLEL_IMAGE_REQUESTS:16},U={supported:!1,testSupport:function(t){!N&&L&&(j?q(t):M=t)}},N=!1,j=!1;function q(t){var e=t.createTexture();t.bindTexture(t.TEXTURE_2D,e);try{if(t.texImage2D(t.TEXTURE_2D,0,t.RGBA,t.RGBA,t.UNSIGNED_BYTE,L),t.isContextLost())return;U.supported=!0}catch(t){}t.deleteTexture(e),N=!0}n.document&&((L=n.document.createElement("img")).onload=function(){M&&q(M),M=null,j=!0},L.onerror=function(){N=!0,M=null},L.src="data:image/webp;base64,UklGRh4AAABXRUJQVlA4TBEAAAAvAQAAAAfQ//73v/+BiOh/AAA=");var V="01",G=function(t,e){this._transformRequestFn=t,this._customAccessToken=e,this._createSkuToken()};function Z(t){return 0===t.indexOf("mapbox:")}G.prototype._createSkuToken=function(){var t=function(){for(var t="",e=0;e<10;e++)t+="0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ"[Math.floor(62*Math.random())];return{token:["1",V,t].join(""),tokenExpiresAt:Date.now()+432e5}}();this._skuToken=t.token,this._skuTokenExpiresAt=t.tokenExpiresAt},G.prototype._isSkuTokenExpired=function(){return Date.now()>this._skuTokenExpiresAt},G.prototype.transformRequest=function(t,e){return this._transformRequestFn&&this._transformRequestFn(t,e)||{url:t}},G.prototype.normalizeStyleURL=function(t,e){if(!Z(t))return t;var r=X(t);return r.path="/styles/v1"+r.path,this._makeAPIURL(r,this._customAccessToken||e)},G.prototype.normalizeGlyphsURL=function(t,e){if(!Z(t))return t;var r=X(t);return r.path="/fonts/v1"+r.path,this._makeAPIURL(r,this._customAccessToken||e)},G.prototype.normalizeSourceURL=function(t,e){if(!Z(t))return t;var r=X(t);return r.path="/v4/"+r.authority+".json",r.params.push("secure"),this._makeAPIURL(r,this._customAccessToken||e)},G.prototype.normalizeSpriteURL=function(t,e,r,o){var i=X(t);return Z(t)?(i.path="/styles/v1"+i.path+"/sprite"+e+r,this._makeAPIURL(i,this._customAccessToken||o)):(i.path+=""+e+r,$(i))},G.prototype.normalizeTileURL=function(t,e){if(this._isSkuTokenExpired()&&this._createSkuToken(),t&&!Z(t))return t;var r=X(t);r.path=r.path.replace(/(\.(png|jpg)\d*)(?=$)/,(B.devicePixelRatio>=2||512===e?"@2x":"")+(U.supported?".webp":"$1")),r.path=r.path.replace(/^.+\/v4\//,"/"),r.path="/v4"+r.path;var o=this._customAccessToken||function(t){for(var e=0,r=t;e<r.length;e+=1){var o=r[e].match(/^access_token=(.*)$/);if(o)return o[1]}return null}(r.params)||F.ACCESS_TOKEN;return F.REQUIRE_ACCESS_TOKEN&&o&&this._skuToken&&r.params.push("sku="+this._skuToken),this._makeAPIURL(r,o)},G.prototype.canonicalizeTileURL=function(t,e){var r=X(t);if(!r.path.match(/(^\/v4\/)/)||!r.path.match(/\.[\w]+$/))return t;var o="mapbox://tiles/";o+=r.path.replace("/v4/","");var i=r.params;return e&&(i=i.filter((function(t){return!t.match(/^access_token=/)}))),i.length&&(o+="?"+i.join("&")),o},G.prototype.canonicalizeTileset=function(t,e){for(var r=!!e&&Z(e),o=[],i=0,a=t.tiles||[];i<a.length;i+=1){var n=a[i];K(n)?o.push(this.canonicalizeTileURL(n,r)):o.push(n)}return o},G.prototype._makeAPIURL=function(t,e){var r="See https://www.mapbox.com/api-documentation/#access-tokens-and-token-scopes",o=X(F.API_URL);if(t.protocol=o.protocol,t.authority=o.authority,"/"!==o.path&&(t.path=""+o.path+t.path),!F.REQUIRE_ACCESS_TOKEN)return $(t);if(!(e=e||F.ACCESS_TOKEN))throw new Error("An API access token is required to use Mapbox GL. "+r);if("s"===e[0])throw new Error("Use a public access token (pk.*) with Mapbox GL, not a secret access token (sk.*). "+r);return t.params=t.params.filter((function(t){return-1===t.indexOf("access_token")})),t.params.push("access_token="+e),$(t)};var H=/^((https?:)?\/\/)?([^\/]+\.)?mapbox\.c(n|om)(\/|\?|$)/i;function K(t){return H.test(t)}var W=/^(\w+):\/\/([^/?]*)(\/[^?]+)?\??(.+)?/;function X(t){var e=t.match(W);if(!e)throw new Error("Unable to parse URL object");return{protocol:e[1],authority:e[2],path:e[3]||"/",params:e[4]?e[4].split("&"):[]}}function $(t){var e=t.params.length?"?"+t.params.join("&"):"";return t.protocol+"://"+t.authority+t.path+e}function J(t){if(!t)return null;var e=t.split(".");if(!e||3!==e.length)return null;try{return JSON.parse(decodeURIComponent(n.atob(e[1]).split("").map((function(t){return"%"+("00"+t.charCodeAt(0).toString(16)).slice(-2)})).join("")))}catch(t){return null}}var Y=function(t){this.type=t,this.anonId=null,this.eventData={},this.queue=[],this.pendingRequest=null};Y.prototype.getStorageKey=function(t){var e,r=J(F.ACCESS_TOKEN);return e=r&&r.u?n.btoa(encodeURIComponent(r.u).replace(/%([0-9A-F]{2})/g,(function(t,e){return String.fromCharCode(Number("0x"+e))}))):F.ACCESS_TOKEN||"",t?"mapbox.eventData."+t+":"+e:"mapbox.eventData:"+e},Y.prototype.fetchEventData=function(){var t=C("localStorage"),e=this.getStorageKey(),r=this.getStorageKey("uuid");if(t)try{var o=n.localStorage.getItem(e);o&&(this.eventData=JSON.parse(o));var i=n.localStorage.getItem(r);i&&(this.anonId=i)}catch(t){w("Unable to read from LocalStorage")}},Y.prototype.saveEventData=function(){var t=C("localStorage"),e=this.getStorageKey(),r=this.getStorageKey("uuid");if(t)try{n.localStorage.setItem(r,this.anonId),Object.keys(this.eventData).length>=1&&n.localStorage.setItem(e,JSON.stringify(this.eventData))}catch(t){w("Unable to write to LocalStorage")}},Y.prototype.processRequests=function(t){},Y.prototype.postEvent=function(t,e,r,o){var i=this;if(F.EVENTS_URL){var a=X(F.EVENTS_URL);a.params.push("access_token="+(o||F.ACCESS_TOKEN||""));var n={event:this.type,created:new Date(t).toISOString(),sdkIdentifier:"mapbox-gl-js",sdkVersion:"1.11.1",skuId:V,userId:this.anonId},s=e?c(n,e):n,u={url:$(a),headers:{"Content-Type":"text/plain"},body:JSON.stringify([s])};this.pendingRequest=xt(u,(function(t){i.pendingRequest=null,r(t),i.saveEventData(),i.processRequests(o)}))}},Y.prototype.queueRequest=function(t,e){this.queue.push(t),this.processRequests(e)};var Q,tt,et=function(t){function e(){t.call(this,"map.load"),this.success={},this.skuToken=""}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e,e.prototype.postMapLoadEvent=function(t,e,r,o){this.skuToken=r,(F.EVENTS_URL&&o||F.ACCESS_TOKEN&&Array.isArray(t)&&t.some((function(t){return Z(t)||K(t)})))&&this.queueRequest({id:e,timestamp:Date.now()},o)},e.prototype.processRequests=function(t){var e=this;if(!this.pendingRequest&&0!==this.queue.length){var r=this.queue.shift(),o=r.id,i=r.timestamp;o&&this.success[o]||(this.anonId||this.fetchEventData(),m(this.anonId)||(this.anonId=f()),this.postEvent(i,{skuToken:this.skuToken},(function(t){t||o&&(e.success[o]=!0)}),t))}},e}(Y),rt=new(function(t){function e(e){t.call(this,"appUserTurnstile"),this._customAccessToken=e}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e,e.prototype.postTurnstileEvent=function(t,e){F.EVENTS_URL&&F.ACCESS_TOKEN&&Array.isArray(t)&&t.some((function(t){return Z(t)||K(t)}))&&this.queueRequest(Date.now(),e)},e.prototype.processRequests=function(t){var e=this;if(!this.pendingRequest&&0!==this.queue.length){this.anonId&&this.eventData.lastSuccess&&this.eventData.tokenU||this.fetchEventData();var r=J(F.ACCESS_TOKEN),o=r?r.u:F.ACCESS_TOKEN,i=o!==this.eventData.tokenU;m(this.anonId)||(this.anonId=f(),i=!0);var a=this.queue.shift();if(this.eventData.lastSuccess){var n=new Date(this.eventData.lastSuccess),s=new Date(a),u=(a-this.eventData.lastSuccess)/864e5;i=i||u>=1||u<-1||n.getDate()!==s.getDate()}else i=!0;if(!i)return this.processRequests();this.postEvent(a,{"enabled.telemetry":!1},(function(t){t||(e.eventData.lastSuccess=a,e.eventData.tokenU=o)}),t)}},e}(Y)),it=rt.postTurnstileEvent.bind(rt),ot=new et,nt=ot.postMapLoadEvent.bind(ot),at=500,st=50;function lt(){n.caches&&!Q&&(Q=n.caches.open("mapbox-tiles"))}function ut(t){var e=t.indexOf("?");return e<0?t:t.slice(0,e)}var ct,pt=1/0;function ht(){return null==ct&&(ct=n.OffscreenCanvas&&new n.OffscreenCanvas(1,1).getContext("2d")&&"function"==typeof n.createImageBitmap),ct}var ft={Unknown:"Unknown",Style:"Style",Source:"Source",Tile:"Tile",Glyphs:"Glyphs",SpriteImage:"SpriteImage",SpriteJSON:"SpriteJSON",Image:"Image"};"function"==typeof Object.freeze&&Object.freeze(ft);var mt,gt,yt=function(t){function e(e,r,o){401===r&&K(o)&&(e+=": you may have provided an invalid Mapbox access token. See https://www.mapbox.com/api-documentation/#access-tokens-and-token-scopes"),t.call(this,e),this.status=r,this.url=o,this.name=this.constructor.name,this.message=e}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e,e.prototype.toString=function(){return this.name+": "+this.message+" ("+this.status+"): "+this.url},e}(Error),dt=S()?function(){return self.worker&&self.worker.referrer}:function(){return("blob:"===n.location.protocol?n.parent:n).location.href},vt=function(t,e){if(!(/^file:/.test(r=t.url)||/^file:/.test(dt())&&!/^\w+:/.test(r))){if(n.fetch&&n.Request&&n.AbortController&&n.Request.prototype.hasOwnProperty("signal"))return function(t,e){var r,o=new n.AbortController,i=new n.Request(t.url,{method:t.method||"GET",body:t.body,credentials:t.credentials,headers:t.headers,referrer:dt(),signal:o.signal}),a=!1,s=!1,u=(r=i.url).indexOf("sku=")>0&&K(r);"json"===t.type&&i.headers.set("Accept","application/json");var l=function(r,o,a){if(!s){if(r&&"SecurityError"!==r.message&&w(r),o&&a)return p(o);var l=Date.now();n.fetch(i).then((function(r){if(r.ok){var o=u?r.clone():null;return p(r,o,l)}return e(new yt(r.statusText,r.status,t.url))})).catch((function(t){20!==t.code&&e(new Error(t.message))}))}},p=function(r,o,u){("arrayBuffer"===t.type?r.arrayBuffer():"json"===t.type?r.json():r.text()).then((function(t){s||(o&&u&&function(t,e,r){if(lt(),Q){var o={status:e.status,statusText:e.statusText,headers:new n.Headers};e.headers.forEach((function(t,e){return o.headers.set(e,t)}));var i=T(e.headers.get("Cache-Control")||"");i["no-store"]||(i["max-age"]&&o.headers.set("Expires",new Date(r+1e3*i["max-age"]).toUTCString()),new Date(o.headers.get("Expires")).getTime()-r<42e4||function(t,e){if(void 0===tt)try{new Response(new ReadableStream),tt=!0}catch(t){tt=!1}tt?e(t.body):t.blob().then(e)}(e,(function(e){var r=new n.Response(e,o);lt(),Q&&Q.then((function(e){return e.put(ut(t.url),r)})).catch((function(t){return w(t.message)}))})))}}(i,o,u),a=!0,e(null,t,r.headers.get("Cache-Control"),r.headers.get("Expires")))})).catch((function(t){s||e(new Error(t.message))}))};return u?function(t,e){if(lt(),!Q)return e(null);var r=ut(t.url);Q.then((function(t){t.match(r).then((function(o){var i=function(t){if(!t)return!1;var e=new Date(t.headers.get("Expires")||0),r=T(t.headers.get("Cache-Control")||"");return e>Date.now()&&!r["no-cache"]}(o);t.delete(r),i&&t.put(r,o.clone()),e(null,o,i)})).catch(e)})).catch(e)}(i,l):l(null,null),{cancel:function(){s=!0,a||o.abort()}}}(t,e);if(S()&&self.worker&&self.worker.actor)return self.worker.actor.send("getResource",t,e,void 0,!0)}var r;return function(t,e){var r=new n.XMLHttpRequest;for(var o in r.open(t.method||"GET",t.url,!0),"arrayBuffer"===t.type&&(r.responseType="arraybuffer"),t.headers)r.setRequestHeader(o,t.headers[o]);return"json"===t.type&&(r.responseType="text",r.setRequestHeader("Accept","application/json")),r.withCredentials="include"===t.credentials,r.onerror=function(){e(new Error(r.statusText))},r.onload=function(){if((r.status>=200&&r.status<300||0===r.status)&&null!==r.response){var o=r.response;if("json"===t.type)try{o=JSON.parse(r.response)}catch(t){return e(t)}e(null,o,r.getResponseHeader("Cache-Control"),r.getResponseHeader("Expires"))}else e(new yt(r.statusText,r.status,t.url))},r.send(t.body),{cancel:function(){return r.abort()}}}(t,e)},_t=function(t,e){return vt(c(t,{type:"arrayBuffer"}),e)},xt=function(t,e){return vt(c(t,{method:"POST"}),e)};mt=[],gt=0;var bt=function(t,e){if(U.supported&&(t.headers||(t.headers={}),t.headers.accept="image/webp,*/*"),gt>=F.MAX_PARALLEL_IMAGE_REQUESTS){var r={requestParameters:t,callback:e,cancelled:!1,cancel:function(){this.cancelled=!0}};return mt.push(r),r}gt++;var o=!1,i=function(){if(!o)for(o=!0,gt--;mt.length&&gt<F.MAX_PARALLEL_IMAGE_REQUESTS;){var t=mt.shift();t.cancelled||(t.cancel=bt(t.requestParameters,t.callback).cancel)}},a=_t(t,(function(t,r,o,a){i(),t?e(t):r&&(ht()?function(t,e){var r=new n.Blob([new Uint8Array(t)],{type:"image/png"});n.createImageBitmap(r).then((function(t){e(null,t)})).catch((function(t){e(new Error("Could not load image because of "+t.message+". Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported."))}))}(r,e):function(t,e,r,o){var i=new n.Image,a=n.URL;i.onload=function(){e(null,i),a.revokeObjectURL(i.src)},i.onerror=function(){return e(new Error("Could not load image. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported."))};var s=new n.Blob([new Uint8Array(t)],{type:"image/png"});i.cacheControl=r,i.expires=o,i.src=t.byteLength?a.createObjectURL(s):"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAAC0lEQVQYV2NgAAIAAAUAAarVyFEAAAAASUVORK5CYII="}(r,e,o,a))}));return{cancel:function(){a.cancel(),i()}}};function wt(t,e,r){r[t]&&-1!==r[t].indexOf(e)||(r[t]=r[t]||[],r[t].push(e))}function Et(t,e,r){if(r&&r[t]){var o=r[t].indexOf(e);-1!==o&&r[t].splice(o,1)}}var kt=function(t,e){void 0===e&&(e={}),c(this,e),this.type=t},St=function(t){function e(e,r){void 0===r&&(r={}),t.call(this,"error",c({error:e},r))}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e,e}(kt),Tt=function(){};Tt.prototype.on=function(t,e){return this._listeners=this._listeners||{},wt(t,e,this._listeners),this},Tt.prototype.off=function(t,e){return Et(t,e,this._listeners),Et(t,e,this._oneTimeListeners),this},Tt.prototype.once=function(t,e){return this._oneTimeListeners=this._oneTimeListeners||{},wt(t,e,this._oneTimeListeners),this},Tt.prototype.fire=function(t,e){"string"==typeof t&&(t=new kt(t,e||{}));var r=t.type;if(this.listens(r)){t.target=this;for(var o=0,i=this._listeners&&this._listeners[r]?this._listeners[r].slice():[];o<i.length;o+=1)i[o].call(this,t);for(var a=0,n=this._oneTimeListeners&&this._oneTimeListeners[r]?this._oneTimeListeners[r].slice():[];a<n.length;a+=1){var s=n[a];Et(r,s,this._oneTimeListeners),s.call(this,t)}var u=this._eventedParent;u&&(c(t,"function"==typeof this._eventedParentData?this._eventedParentData():this._eventedParentData),u.fire(t))}else t instanceof St&&console.error(t.error);return this},Tt.prototype.listens=function(t){return this._listeners&&this._listeners[t]&&this._listeners[t].length>0||this._oneTimeListeners&&this._oneTimeListeners[t]&&this._oneTimeListeners[t].length>0||this._eventedParent&&this._eventedParent.listens(t)},Tt.prototype.setEventedParent=function(t,e){return this._eventedParent=t,this._eventedParentData=e,this};var It={$version:8,$root:{version:{required:!0,type:"enum",values:[8]},name:{type:"string"},metadata:{type:"*"},center:{type:"array",value:"number"},zoom:{type:"number"},bearing:{type:"number",default:0,period:360,units:"degrees"},pitch:{type:"number",default:0,units:"degrees"},light:{type:"light"},sources:{required:!0,type:"sources"},sprite:{type:"string"},glyphs:{type:"string"},transition:{type:"transition"},layers:{required:!0,type:"array",value:"layer"}},sources:{"*":{type:"source"}},source:["source_vector","source_raster","source_raster_dem","source_geojson","source_video","source_image"],source_vector:{type:{required:!0,type:"enum",values:{vector:{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},scheme:{type:"enum",values:{xyz:{},tms:{}},default:"xyz"},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},attribution:{type:"string"},promoteId:{type:"promoteId"},volatile:{type:"boolean",default:!1},"*":{type:"*"}},source_raster:{type:{required:!0,type:"enum",values:{raster:{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},tileSize:{type:"number",default:512,units:"pixels"},scheme:{type:"enum",values:{xyz:{},tms:{}},default:"xyz"},attribution:{type:"string"},volatile:{type:"boolean",default:!1},"*":{type:"*"}},source_raster_dem:{type:{required:!0,type:"enum",values:{"raster-dem":{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},tileSize:{type:"number",default:512,units:"pixels"},attribution:{type:"string"},encoding:{type:"enum",values:{terrarium:{},mapbox:{}},default:"mapbox"},volatile:{type:"boolean",default:!1},"*":{type:"*"}},source_geojson:{type:{required:!0,type:"enum",values:{geojson:{}}},data:{type:"*"},maxzoom:{type:"number",default:18},attribution:{type:"string"},buffer:{type:"number",default:128,maximum:512,minimum:0},tolerance:{type:"number",default:.375},cluster:{type:"boolean",default:!1},clusterRadius:{type:"number",default:50,minimum:0},clusterMaxZoom:{type:"number"},clusterMinPoints:{type:"number"},clusterProperties:{type:"*"},lineMetrics:{type:"boolean",default:!1},generateId:{type:"boolean",default:!1},promoteId:{type:"promoteId"}},source_video:{type:{required:!0,type:"enum",values:{video:{}}},urls:{required:!0,type:"array",value:"string"},coordinates:{required:!0,type:"array",length:4,value:{type:"array",length:2,value:"number"}}},source_image:{type:{required:!0,type:"enum",values:{image:{}}},url:{required:!0,type:"string"},coordinates:{required:!0,type:"array",length:4,value:{type:"array",length:2,value:"number"}}},layer:{id:{type:"string",required:!0},type:{type:"enum",values:{fill:{},line:{},symbol:{},circle:{},heatmap:{},"fill-extrusion":{},raster:{},hillshade:{},background:{}},required:!0},metadata:{type:"*"},source:{type:"string"},"source-layer":{type:"string"},minzoom:{type:"number",minimum:0,maximum:24},maxzoom:{type:"number",minimum:0,maximum:24},filter:{type:"filter"},layout:{type:"layout"},paint:{type:"paint"}},layout:["layout_fill","layout_line","layout_circle","layout_heatmap","layout_fill-extrusion","layout_symbol","layout_raster","layout_hillshade","layout_background"],layout_background:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_fill:{"fill-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_circle:{"circle-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_heatmap:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},"layout_fill-extrusion":{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_line:{"line-cap":{type:"enum",values:{butt:{},round:{},square:{}},default:"butt",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"line-join":{type:"enum",values:{bevel:{},round:{},miter:{}},default:"miter",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"line-miter-limit":{type:"number",default:2,requires:[{"line-join":"miter"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-round-limit":{type:"number",default:1.05,requires:[{"line-join":"round"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_symbol:{"symbol-placement":{type:"enum",values:{point:{},line:{},"line-center":{}},default:"point",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"symbol-spacing":{type:"number",default:250,minimum:1,units:"pixels",requires:[{"symbol-placement":"line"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"symbol-avoid-edges":{type:"boolean",default:!1,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"symbol-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"symbol-z-order":{type:"enum",values:{auto:{},"viewport-y":{},source:{}},default:"auto",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-allow-overlap":{type:"boolean",default:!1,requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-ignore-placement":{type:"boolean",default:!1,requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-optional":{type:"boolean",default:!1,requires:["icon-image","text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-rotation-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-size":{type:"number",default:1,minimum:0,units:"factor of the original icon size",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-text-fit":{type:"enum",values:{none:{},width:{},height:{},both:{}},default:"none",requires:["icon-image","text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-text-fit-padding":{type:"array",value:"number",length:4,default:[0,0,0,0],units:"pixels",requires:["icon-image","text-field",{"icon-text-fit":["both","width","height"]}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"icon-image":{type:"resolvedImage",tokens:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-rotate":{type:"number",default:0,period:360,units:"degrees",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-padding":{type:"number",default:2,minimum:0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"icon-keep-upright":{type:"boolean",default:!1,requires:["icon-image",{"icon-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-offset":{type:"array",value:"number",length:2,default:[0,0],requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-anchor":{type:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},default:"center",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-pitch-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-pitch-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-rotation-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-field":{type:"formatted",default:"",tokens:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-font":{type:"array",value:"string",default:["Open Sans Regular","Arial Unicode MS Regular"],requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-size":{type:"number",default:16,minimum:0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-max-width":{type:"number",default:10,minimum:0,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-line-height":{type:"number",default:1.2,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-letter-spacing":{type:"number",default:0,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-justify":{type:"enum",values:{auto:{},left:{},center:{},right:{}},default:"center",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-radial-offset":{type:"number",units:"ems",default:0,requires:["text-field"],"property-type":"data-driven",expression:{interpolated:!0,parameters:["zoom","feature"]}},"text-variable-anchor":{type:"array",value:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-anchor":{type:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},default:"center",requires:["text-field",{"!":"text-variable-anchor"}],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-max-angle":{type:"number",default:45,units:"degrees",requires:["text-field",{"symbol-placement":["line","line-center"]}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-writing-mode":{type:"array",value:"enum",values:{horizontal:{},vertical:{}},requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-rotate":{type:"number",default:0,period:360,units:"degrees",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-padding":{type:"number",default:2,minimum:0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-keep-upright":{type:"boolean",default:!0,requires:["text-field",{"text-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-transform":{type:"enum",values:{none:{},uppercase:{},lowercase:{}},default:"none",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-offset":{type:"array",value:"number",units:"ems",length:2,default:[0,0],requires:["text-field",{"!":"text-radial-offset"}],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-allow-overlap":{type:"boolean",default:!1,requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-ignore-placement":{type:"boolean",default:!1,requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-optional":{type:"boolean",default:!1,requires:["text-field","icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_raster:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_hillshade:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},filter:{type:"array",value:"*"},filter_operator:{type:"enum",values:{"==":{},"!=":{},">":{},">=":{},"<":{},"<=":{},in:{},"!in":{},all:{},any:{},none:{},has:{},"!has":{},within:{}}},geometry_type:{type:"enum",values:{Point:{},LineString:{},Polygon:{}}},function:{expression:{type:"expression"},stops:{type:"array",value:"function_stop"},base:{type:"number",default:1,minimum:0},property:{type:"string",default:"$zoom"},type:{type:"enum",values:{identity:{},exponential:{},interval:{},categorical:{}},default:"exponential"},colorSpace:{type:"enum",values:{rgb:{},lab:{},hcl:{}},default:"rgb"},default:{type:"*",required:!1}},function_stop:{type:"array",minimum:0,maximum:24,value:["number","color"],length:2},expression:{type:"array",value:"*",minimum:1},expression_name:{type:"enum",values:{let:{group:"Variable binding"},var:{group:"Variable binding"},literal:{group:"Types"},array:{group:"Types"},at:{group:"Lookup"},in:{group:"Lookup"},"index-of":{group:"Lookup"},slice:{group:"Lookup"},case:{group:"Decision"},match:{group:"Decision"},coalesce:{group:"Decision"},step:{group:"Ramps, scales, curves"},interpolate:{group:"Ramps, scales, curves"},"interpolate-hcl":{group:"Ramps, scales, curves"},"interpolate-lab":{group:"Ramps, scales, curves"},ln2:{group:"Math"},pi:{group:"Math"},e:{group:"Math"},typeof:{group:"Types"},string:{group:"Types"},number:{group:"Types"},boolean:{group:"Types"},object:{group:"Types"},collator:{group:"Types"},format:{group:"Types"},image:{group:"Types"},"number-format":{group:"Types"},"to-string":{group:"Types"},"to-number":{group:"Types"},"to-boolean":{group:"Types"},"to-rgba":{group:"Color"},"to-color":{group:"Types"},rgb:{group:"Color"},rgba:{group:"Color"},get:{group:"Lookup"},has:{group:"Lookup"},length:{group:"Lookup"},properties:{group:"Feature data"},"feature-state":{group:"Feature data"},"geometry-type":{group:"Feature data"},id:{group:"Feature data"},zoom:{group:"Zoom"},"heatmap-density":{group:"Heatmap"},"line-progress":{group:"Feature data"},accumulated:{group:"Feature data"},"+":{group:"Math"},"*":{group:"Math"},"-":{group:"Math"},"/":{group:"Math"},"%":{group:"Math"},"^":{group:"Math"},sqrt:{group:"Math"},log10:{group:"Math"},ln:{group:"Math"},log2:{group:"Math"},sin:{group:"Math"},cos:{group:"Math"},tan:{group:"Math"},asin:{group:"Math"},acos:{group:"Math"},atan:{group:"Math"},min:{group:"Math"},max:{group:"Math"},round:{group:"Math"},abs:{group:"Math"},ceil:{group:"Math"},floor:{group:"Math"},distance:{group:"Math"},"==":{group:"Decision"},"!=":{group:"Decision"},">":{group:"Decision"},"<":{group:"Decision"},">=":{group:"Decision"},"<=":{group:"Decision"},all:{group:"Decision"},any:{group:"Decision"},"!":{group:"Decision"},within:{group:"Decision"},"is-supported-script":{group:"String"},upcase:{group:"String"},downcase:{group:"String"},concat:{group:"String"},"resolved-locale":{group:"String"}}},light:{anchor:{type:"enum",default:"viewport",values:{map:{},viewport:{}},"property-type":"data-constant",transition:!1,expression:{interpolated:!1,parameters:["zoom"]}},position:{type:"array",default:[1.15,210,30],length:3,value:"number","property-type":"data-constant",transition:!0,expression:{interpolated:!0,parameters:["zoom"]}},color:{type:"color","property-type":"data-constant",default:"#ffffff",expression:{interpolated:!0,parameters:["zoom"]},transition:!0},intensity:{type:"number","property-type":"data-constant",default:.5,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0}},paint:["paint_fill","paint_line","paint_circle","paint_heatmap","paint_fill-extrusion","paint_symbol","paint_raster","paint_hillshade","paint_background"],paint_fill:{"fill-antialias":{type:"boolean",default:!0,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"fill-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-outline-color":{type:"color",transition:!0,requires:[{"!":"fill-pattern"},{"fill-antialias":!0}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["fill-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"}},"paint_fill-extrusion":{"fill-extrusion-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"fill-extrusion-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["fill-extrusion-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"},"fill-extrusion-height":{type:"number",default:0,minimum:0,units:"meters",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-base":{type:"number",default:0,minimum:0,units:"meters",transition:!0,requires:["fill-extrusion-height"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-vertical-gradient":{type:"boolean",default:!0,transition:!1,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"}},paint_line:{"line-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"line-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["line-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"line-width":{type:"number",default:1,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-gap-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-offset":{type:"number",default:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-dasharray":{type:"array",value:"number",minimum:0,transition:!0,units:"line widths",requires:[{"!":"line-pattern"}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"cross-faded"},"line-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"},"line-gradient":{type:"color",transition:!1,requires:[{"!":"line-dasharray"},{"!":"line-pattern"},{source:"geojson",has:{lineMetrics:!0}}],expression:{interpolated:!0,parameters:["line-progress"]},"property-type":"color-ramp"}},paint_circle:{"circle-radius":{type:"number",default:5,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-blur":{type:"number",default:0,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"circle-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["circle-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-pitch-scale":{type:"enum",values:{map:{},viewport:{}},default:"map",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-pitch-alignment":{type:"enum",values:{map:{},viewport:{}},default:"viewport",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-stroke-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"}},paint_heatmap:{"heatmap-radius":{type:"number",default:30,minimum:1,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-weight":{type:"number",default:1,minimum:0,transition:!1,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-intensity":{type:"number",default:1,minimum:0,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"heatmap-color":{type:"color",default:["interpolate",["linear"],["heatmap-density"],0,"rgba(0, 0, 255, 0)",.1,"royalblue",.3,"cyan",.5,"lime",.7,"yellow",1,"red"],transition:!1,expression:{interpolated:!0,parameters:["heatmap-density"]},"property-type":"color-ramp"},"heatmap-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_symbol:{"icon-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-color":{type:"color",default:"#000000",transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-color":{type:"color",default:"rgba(0, 0, 0, 0)",transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"icon-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["icon-image","icon-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-color":{type:"color",default:"#000000",transition:!0,overridable:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-color":{type:"color",default:"rgba(0, 0, 0, 0)",transition:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["text-field","text-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"}},paint_raster:{"raster-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-hue-rotate":{type:"number",default:0,period:360,transition:!0,units:"degrees",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-brightness-min":{type:"number",default:0,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-brightness-max":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-saturation":{type:"number",default:0,minimum:-1,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-contrast":{type:"number",default:0,minimum:-1,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-resampling":{type:"enum",values:{linear:{},nearest:{}},default:"linear",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"raster-fade-duration":{type:"number",default:300,minimum:0,transition:!1,units:"milliseconds",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_hillshade:{"hillshade-illumination-direction":{type:"number",default:335,minimum:0,maximum:359,transition:!1,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-illumination-anchor":{type:"enum",values:{map:{},viewport:{}},default:"viewport",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-exaggeration":{type:"number",default:.5,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-shadow-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-highlight-color":{type:"color",default:"#FFFFFF",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-accent-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_background:{"background-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"background-pattern"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"background-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"cross-faded"},"background-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},transition:{duration:{type:"number",default:300,minimum:0,units:"milliseconds"},delay:{type:"number",default:0,minimum:0,units:"milliseconds"}},"property-type":{"data-driven":{type:"property-type"},"cross-faded":{type:"property-type"},"cross-faded-data-driven":{type:"property-type"},"color-ramp":{type:"property-type"},"data-constant":{type:"property-type"},constant:{type:"property-type"}},promoteId:{"*":{type:"string"}}},zt=function(t,e,r,o){this.message=(t?t+": ":"")+r,o&&(this.identifier=o),null!=e&&e.__line__&&(this.line=e.__line__)};function Ct(t){var e=t.value;return e?[new zt(t.key,e,"constants have been deprecated as of v8")]:[]}function Pt(t){for(var e=[],r=arguments.length-1;r-- >0;)e[r]=arguments[r+1];for(var o=0,i=e;o<i.length;o+=1){var a=i[o];for(var n in a)t[n]=a[n]}return t}function At(t){return t instanceof Number||t instanceof String||t instanceof Boolean?t.valueOf():t}function Mt(t){if(Array.isArray(t))return t.map(Mt);if(t instanceof Object&&!(t instanceof Number||t instanceof String||t instanceof Boolean)){var e={};for(var r in t)e[r]=Mt(t[r]);return e}return At(t)}var Lt=function(t){function e(e,r){t.call(this,r),this.message=r,this.key=e}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e,e}(Error),Rt=function(t,e){void 0===e&&(e=[]),this.parent=t,this.bindings={};for(var r=0,o=e;r<o.length;r+=1){var i=o[r];this.bindings[i[0]]=i[1]}};Rt.prototype.concat=function(t){return new Rt(this,t)},Rt.prototype.get=function(t){if(this.bindings[t])return this.bindings[t];if(this.parent)return this.parent.get(t);throw new Error(t+" not found in scope.")},Rt.prototype.has=function(t){return!!this.bindings[t]||!!this.parent&&this.parent.has(t)};var Dt={kind:"null"},Ot={kind:"number"},Bt={kind:"string"},Ft={kind:"boolean"},Ut={kind:"color"},Nt={kind:"object"},jt={kind:"value"},Vt={kind:"collator"},qt={kind:"formatted"},Gt={kind:"resolvedImage"};function Zt(t,e){return{kind:"array",itemType:t,N:e}}function Ht(t){if("array"===t.kind){var e=Ht(t.itemType);return"number"==typeof t.N?"array<"+e+", "+t.N+">":"value"===t.itemType.kind?"array":"array<"+e+">"}return t.kind}var Kt=[Dt,Ot,Bt,Ft,Ut,qt,Nt,Zt(jt),Gt];function Wt(t,e){if("error"===e.kind)return null;if("array"===t.kind){if("array"===e.kind&&(0===e.N&&"value"===e.itemType.kind||!Wt(t.itemType,e.itemType))&&("number"!=typeof t.N||t.N===e.N))return null}else{if(t.kind===e.kind)return null;if("value"===t.kind)for(var r=0,o=Kt;r<o.length;r+=1)if(!Wt(o[r],e))return null}return"Expected "+Ht(t)+" but found "+Ht(e)+" instead."}function Xt(t,e){return e.some((function(e){return e.kind===t.kind}))}function $t(t,e){return e.some((function(e){return"null"===e?null===t:"array"===e?Array.isArray(t):"object"===e?t&&!Array.isArray(t)&&"object"==typeof t:e===typeof t}))}var Jt=e((function(t,e){var r={transparent:[0,0,0,0],aliceblue:[240,248,255,1],antiquewhite:[250,235,215,1],aqua:[0,255,255,1],aquamarine:[127,255,212,1],azure:[240,255,255,1],beige:[245,245,220,1],bisque:[255,228,196,1],black:[0,0,0,1],blanchedalmond:[255,235,205,1],blue:[0,0,255,1],blueviolet:[138,43,226,1],brown:[165,42,42,1],burlywood:[222,184,135,1],cadetblue:[95,158,160,1],chartreuse:[127,255,0,1],chocolate:[210,105,30,1],coral:[255,127,80,1],cornflowerblue:[100,149,237,1],cornsilk:[255,248,220,1],crimson:[220,20,60,1],cyan:[0,255,255,1],darkblue:[0,0,139,1],darkcyan:[0,139,139,1],darkgoldenrod:[184,134,11,1],darkgray:[169,169,169,1],darkgreen:[0,100,0,1],darkgrey:[169,169,169,1],darkkhaki:[189,183,107,1],darkmagenta:[139,0,139,1],darkolivegreen:[85,107,47,1],darkorange:[255,140,0,1],darkorchid:[153,50,204,1],darkred:[139,0,0,1],darksalmon:[233,150,122,1],darkseagreen:[143,188,143,1],darkslateblue:[72,61,139,1],darkslategray:[47,79,79,1],darkslategrey:[47,79,79,1],darkturquoise:[0,206,209,1],darkviolet:[148,0,211,1],deeppink:[255,20,147,1],deepskyblue:[0,191,255,1],dimgray:[105,105,105,1],dimgrey:[105,105,105,1],dodgerblue:[30,144,255,1],firebrick:[178,34,34,1],floralwhite:[255,250,240,1],forestgreen:[34,139,34,1],fuchsia:[255,0,255,1],gainsboro:[220,220,220,1],ghostwhite:[248,248,255,1],gold:[255,215,0,1],goldenrod:[218,165,32,1],gray:[128,128,128,1],green:[0,128,0,1],greenyellow:[173,255,47,1],grey:[128,128,128,1],honeydew:[240,255,240,1],hotpink:[255,105,180,1],indianred:[205,92,92,1],indigo:[75,0,130,1],ivory:[255,255,240,1],khaki:[240,230,140,1],lavender:[230,230,250,1],lavenderblush:[255,240,245,1],lawngreen:[124,252,0,1],lemonchiffon:[255,250,205,1],lightblue:[173,216,230,1],lightcoral:[240,128,128,1],lightcyan:[224,255,255,1],lightgoldenrodyellow:[250,250,210,1],lightgray:[211,211,211,1],lightgreen:[144,238,144,1],lightgrey:[211,211,211,1],lightpink:[255,182,193,1],lightsalmon:[255,160,122,1],lightseagreen:[32,178,170,1],lightskyblue:[135,206,250,1],lightslategray:[119,136,153,1],lightslategrey:[119,136,153,1],lightsteelblue:[176,196,222,1],lightyellow:[255,255,224,1],lime:[0,255,0,1],limegreen:[50,205,50,1],linen:[250,240,230,1],magenta:[255,0,255,1],maroon:[128,0,0,1],mediumaquamarine:[102,205,170,1],mediumblue:[0,0,205,1],mediumorchid:[186,85,211,1],mediumpurple:[147,112,219,1],mediumseagreen:[60,179,113,1],mediumslateblue:[123,104,238,1],mediumspringgreen:[0,250,154,1],mediumturquoise:[72,209,204,1],mediumvioletred:[199,21,133,1],midnightblue:[25,25,112,1],mintcream:[245,255,250,1],mistyrose:[255,228,225,1],moccasin:[255,228,181,1],navajowhite:[255,222,173,1],navy:[0,0,128,1],oldlace:[253,245,230,1],olive:[128,128,0,1],olivedrab:[107,142,35,1],orange:[255,165,0,1],orangered:[255,69,0,1],orchid:[218,112,214,1],palegoldenrod:[238,232,170,1],palegreen:[152,251,152,1],paleturquoise:[175,238,238,1],palevioletred:[219,112,147,1],papayawhip:[255,239,213,1],peachpuff:[255,218,185,1],peru:[205,133,63,1],pink:[255,192,203,1],plum:[221,160,221,1],powderblue:[176,224,230,1],purple:[128,0,128,1],rebeccapurple:[102,51,153,1],red:[255,0,0,1],rosybrown:[188,143,143,1],royalblue:[65,105,225,1],saddlebrown:[139,69,19,1],salmon:[250,128,114,1],sandybrown:[244,164,96,1],seagreen:[46,139,87,1],seashell:[255,245,238,1],sienna:[160,82,45,1],silver:[192,192,192,1],skyblue:[135,206,235,1],slateblue:[106,90,205,1],slategray:[112,128,144,1],slategrey:[112,128,144,1],snow:[255,250,250,1],springgreen:[0,255,127,1],steelblue:[70,130,180,1],tan:[210,180,140,1],teal:[0,128,128,1],thistle:[216,191,216,1],tomato:[255,99,71,1],turquoise:[64,224,208,1],violet:[238,130,238,1],wheat:[245,222,179,1],white:[255,255,255,1],whitesmoke:[245,245,245,1],yellow:[255,255,0,1],yellowgreen:[154,205,50,1]};function o(t){return(t=Math.round(t))<0?0:t>255?255:t}function i(t){return o("%"===t[t.length-1]?parseFloat(t)/100*255:parseInt(t))}function a(t){return(e="%"===t[t.length-1]?parseFloat(t)/100:parseFloat(t))<0?0:e>1?1:e;var e}function n(t,e,r){return r<0?r+=1:r>1&&(r-=1),6*r<1?t+(e-t)*r*6:2*r<1?e:3*r<2?t+(e-t)*(2/3-r)*6:t}try{e.parseCSSColor=function(t){var e,s=t.replace(/ /g,"").toLowerCase();if(s in r)return r[s].slice();if("#"===s[0])return 4===s.length?(e=parseInt(s.substr(1),16))>=0&&e<=4095?[(3840&e)>>4|(3840&e)>>8,240&e|(240&e)>>4,15&e|(15&e)<<4,1]:null:7===s.length&&(e=parseInt(s.substr(1),16))>=0&&e<=16777215?[(16711680&e)>>16,(65280&e)>>8,255&e,1]:null;var u=s.indexOf("("),l=s.indexOf(")");if(-1!==u&&l+1===s.length){var p=s.substr(0,u),c=s.substr(u+1,l-(u+1)).split(","),h=1;switch(p){case"rgba":if(4!==c.length)return null;h=a(c.pop());case"rgb":return 3!==c.length?null:[i(c[0]),i(c[1]),i(c[2]),h];case"hsla":if(4!==c.length)return null;h=a(c.pop());case"hsl":if(3!==c.length)return null;var d=(parseFloat(c[0])%360+360)%360/360,f=a(c[1]),m=a(c[2]),y=m<=.5?m*(f+1):m+f-m*f,v=2*m-y;return[o(255*n(v,y,d+1/3)),o(255*n(v,y,d)),o(255*n(v,y,d-1/3)),h];default:return null}}return null}}catch(t){}})).parseCSSColor,Yt=function(t,e,r,o){void 0===o&&(o=1),this.r=t,this.g=e,this.b=r,this.a=o};Yt.parse=function(t){if(t){if(t instanceof Yt)return t;if("string"==typeof t){var e=Jt(t);if(e)return new Yt(e[0]/255*e[3],e[1]/255*e[3],e[2]/255*e[3],e[3])}}},Yt.prototype.toString=function(){var t=this.toArray(),e=t[1],r=t[2],o=t[3];return"rgba("+Math.round(t[0])+","+Math.round(e)+","+Math.round(r)+","+o+")"},Yt.prototype.toArray=function(){var t=this.a;return 0===t?[0,0,0,0]:[255*this.r/t,255*this.g/t,255*this.b/t,t]},Yt.black=new Yt(0,0,0,1),Yt.white=new Yt(1,1,1,1),Yt.transparent=new Yt(0,0,0,0),Yt.red=new Yt(1,0,0,1);var Qt=function(t,e,r){this.sensitivity=t?e?"variant":"case":e?"accent":"base",this.locale=r,this.collator=new Intl.Collator(this.locale?this.locale:[],{sensitivity:this.sensitivity,usage:"search"})};Qt.prototype.compare=function(t,e){return this.collator.compare(t,e)},Qt.prototype.resolvedLocale=function(){return new Intl.Collator(this.locale?this.locale:[]).resolvedOptions().locale};var te=function(t,e,r,o,i){this.text=t,this.image=e,this.scale=r,this.fontStack=o,this.textColor=i},ee=function(t){this.sections=t};ee.fromString=function(t){return new ee([new te(t,null,null,null,null)])},ee.prototype.isEmpty=function(){return 0===this.sections.length||!this.sections.some((function(t){return 0!==t.text.length||t.image&&0!==t.image.name.length}))},ee.factory=function(t){return t instanceof ee?t:ee.fromString(t)},ee.prototype.toString=function(){return 0===this.sections.length?"":this.sections.map((function(t){return t.text})).join("")},ee.prototype.serialize=function(){for(var t=["format"],e=0,r=this.sections;e<r.length;e+=1){var o=r[e];if(o.image)t.push(["image",o.image.name]);else{t.push(o.text);var i={};o.fontStack&&(i["text-font"]=["literal",o.fontStack.split(",")]),o.scale&&(i["font-scale"]=o.scale),o.textColor&&(i["text-color"]=["rgba"].concat(o.textColor.toArray())),t.push(i)}}return t};var re=function(t){this.name=t.name,this.available=t.available};function ie(t,e,r,o){return"number"==typeof t&&t>=0&&t<=255&&"number"==typeof e&&e>=0&&e<=255&&"number"==typeof r&&r>=0&&r<=255?void 0===o||"number"==typeof o&&o>=0&&o<=1?null:"Invalid rgba value ["+[t,e,r,o].join(", ")+"]: 'a' must be between 0 and 1.":"Invalid rgba value ["+("number"==typeof o?[t,e,r,o]:[t,e,r]).join(", ")+"]: 'r', 'g', and 'b' must be between 0 and 255."}function oe(t){if(null===t)return!0;if("string"==typeof t)return!0;if("boolean"==typeof t)return!0;if("number"==typeof t)return!0;if(t instanceof Yt)return!0;if(t instanceof Qt)return!0;if(t instanceof ee)return!0;if(t instanceof re)return!0;if(Array.isArray(t)){for(var e=0,r=t;e<r.length;e+=1)if(!oe(r[e]))return!1;return!0}if("object"==typeof t){for(var o in t)if(!oe(t[o]))return!1;return!0}return!1}function ne(t){if(null===t)return Dt;if("string"==typeof t)return Bt;if("boolean"==typeof t)return Ft;if("number"==typeof t)return Ot;if(t instanceof Yt)return Ut;if(t instanceof Qt)return Vt;if(t instanceof ee)return qt;if(t instanceof re)return Gt;if(Array.isArray(t)){for(var e,r=t.length,o=0,i=t;o<i.length;o+=1){var a=ne(i[o]);if(e){if(e===a)continue;e=jt;break}e=a}return Zt(e||jt,r)}return Nt}function ae(t){var e=typeof t;return null===t?"":"string"===e||"number"===e||"boolean"===e?String(t):t instanceof Yt||t instanceof ee||t instanceof re?t.toString():JSON.stringify(t)}re.prototype.toString=function(){return this.name},re.fromString=function(t){return t?new re({name:t,available:!1}):null},re.prototype.serialize=function(){return["image",this.name]};var se=function(t,e){this.type=t,this.value=e};se.parse=function(t,e){if(2!==t.length)return e.error("'literal' expression requires exactly one argument, but found "+(t.length-1)+" instead.");if(!oe(t[1]))return e.error("invalid value");var r=t[1],o=ne(r),i=e.expectedType;return"array"!==o.kind||0!==o.N||!i||"array"!==i.kind||"number"==typeof i.N&&0!==i.N||(o=i),new se(o,r)},se.prototype.evaluate=function(){return this.value},se.prototype.eachChild=function(){},se.prototype.outputDefined=function(){return!0},se.prototype.serialize=function(){return"array"===this.type.kind||"object"===this.type.kind?["literal",this.value]:this.value instanceof Yt?["rgba"].concat(this.value.toArray()):this.value instanceof ee?this.value.serialize():this.value};var le=function(t){this.name="ExpressionEvaluationError",this.message=t};le.prototype.toJSON=function(){return this.message};var ue={string:Bt,number:Ot,boolean:Ft,object:Nt},ce=function(t,e){this.type=t,this.args=e};ce.parse=function(t,e){if(t.length<2)return e.error("Expected at least one argument.");var r,o=1,i=t[0];if("array"===i){var a,n;if(t.length>2){var s=t[1];if("string"!=typeof s||!(s in ue)||"object"===s)return e.error('The item type argument of "array" must be one of string, number, boolean',1);a=ue[s],o++}else a=jt;if(t.length>3){if(null!==t[2]&&("number"!=typeof t[2]||t[2]<0||t[2]!==Math.floor(t[2])))return e.error('The length argument to "array" must be a positive integer literal',2);n=t[2],o++}r=Zt(a,n)}else r=ue[i];for(var u=[];o<t.length;o++){var l=e.parse(t[o],o,jt);if(!l)return null;u.push(l)}return new ce(r,u)},ce.prototype.evaluate=function(t){for(var e=0;e<this.args.length;e++){var r=this.args[e].evaluate(t);if(!Wt(this.type,ne(r)))return r;if(e===this.args.length-1)throw new le("Expected value to be of type "+Ht(this.type)+", but found "+Ht(ne(r))+" instead.")}return null},ce.prototype.eachChild=function(t){this.args.forEach(t)},ce.prototype.outputDefined=function(){return this.args.every((function(t){return t.outputDefined()}))},ce.prototype.serialize=function(){var t=this.type,e=[t.kind];if("array"===t.kind){var r=t.itemType;if("string"===r.kind||"number"===r.kind||"boolean"===r.kind){e.push(r.kind);var o=t.N;("number"==typeof o||this.args.length>1)&&e.push(o)}}return e.concat(this.args.map((function(t){return t.serialize()})))};var pe=function(t){this.type=qt,this.sections=t};pe.parse=function(t,e){if(t.length<2)return e.error("Expected at least one argument.");var r=t[1];if(!Array.isArray(r)&&"object"==typeof r)return e.error("First argument must be an image or text section.");for(var o=[],i=!1,a=1;a<=t.length-1;++a){var n=t[a];if(i&&"object"==typeof n&&!Array.isArray(n)){i=!1;var s=null;if(n["font-scale"]&&!(s=e.parse(n["font-scale"],1,Ot)))return null;var u=null;if(n["text-font"]&&!(u=e.parse(n["text-font"],1,Zt(Bt))))return null;var l=null;if(n["text-color"]&&!(l=e.parse(n["text-color"],1,Ut)))return null;var p=o[o.length-1];p.scale=s,p.font=u,p.textColor=l}else{var c=e.parse(t[a],1,jt);if(!c)return null;var h=c.type.kind;if("string"!==h&&"value"!==h&&"null"!==h&&"resolvedImage"!==h)return e.error("Formatted text type must be 'string', 'value', 'image' or 'null'.");i=!0,o.push({content:c,scale:null,font:null,textColor:null})}}return new pe(o)},pe.prototype.evaluate=function(t){return new ee(this.sections.map((function(e){var r=e.content.evaluate(t);return ne(r)===Gt?new te("",r,null,null,null):new te(ae(r),null,e.scale?e.scale.evaluate(t):null,e.font?e.font.evaluate(t).join(","):null,e.textColor?e.textColor.evaluate(t):null)})))},pe.prototype.eachChild=function(t){for(var e=0,r=this.sections;e<r.length;e+=1){var o=r[e];t(o.content),o.scale&&t(o.scale),o.font&&t(o.font),o.textColor&&t(o.textColor)}},pe.prototype.outputDefined=function(){return!1},pe.prototype.serialize=function(){for(var t=["format"],e=0,r=this.sections;e<r.length;e+=1){var o=r[e];t.push(o.content.serialize());var i={};o.scale&&(i["font-scale"]=o.scale.serialize()),o.font&&(i["text-font"]=o.font.serialize()),o.textColor&&(i["text-color"]=o.textColor.serialize()),t.push(i)}return t};var he=function(t){this.type=Gt,this.input=t};he.parse=function(t,e){if(2!==t.length)return e.error("Expected two arguments.");var r=e.parse(t[1],1,Bt);return r?new he(r):e.error("No image name provided.")},he.prototype.evaluate=function(t){var e=this.input.evaluate(t),r=re.fromString(e);return r&&t.availableImages&&(r.available=t.availableImages.indexOf(e)>-1),r},he.prototype.eachChild=function(t){t(this.input)},he.prototype.outputDefined=function(){return!1},he.prototype.serialize=function(){return["image",this.input.serialize()]};var de={"to-boolean":Ft,"to-color":Ut,"to-number":Ot,"to-string":Bt},fe=function(t,e){this.type=t,this.args=e};fe.parse=function(t,e){if(t.length<2)return e.error("Expected at least one argument.");var r=t[0];if(("to-boolean"===r||"to-string"===r)&&2!==t.length)return e.error("Expected one argument.");for(var o=de[r],i=[],a=1;a<t.length;a++){var n=e.parse(t[a],a,jt);if(!n)return null;i.push(n)}return new fe(o,i)},fe.prototype.evaluate=function(t){if("boolean"===this.type.kind)return Boolean(this.args[0].evaluate(t));if("color"===this.type.kind){for(var e,r,o=0,i=this.args;o<i.length;o+=1){if(r=null,(e=i[o].evaluate(t))instanceof Yt)return e;if("string"==typeof e){var a=t.parseColor(e);if(a)return a}else if(Array.isArray(e)&&!(r=e.length<3||e.length>4?"Invalid rbga value "+JSON.stringify(e)+": expected an array containing either three or four numeric values.":ie(e[0],e[1],e[2],e[3])))return new Yt(e[0]/255,e[1]/255,e[2]/255,e[3])}throw new le(r||"Could not parse color from value '"+("string"==typeof e?e:String(JSON.stringify(e)))+"'")}if("number"===this.type.kind){for(var n=null,s=0,u=this.args;s<u.length;s+=1){if(null===(n=u[s].evaluate(t)))return 0;var l=Number(n);if(!isNaN(l))return l}throw new le("Could not convert "+JSON.stringify(n)+" to number.")}return"formatted"===this.type.kind?ee.fromString(ae(this.args[0].evaluate(t))):"resolvedImage"===this.type.kind?re.fromString(ae(this.args[0].evaluate(t))):ae(this.args[0].evaluate(t))},fe.prototype.eachChild=function(t){this.args.forEach(t)},fe.prototype.outputDefined=function(){return this.args.every((function(t){return t.outputDefined()}))},fe.prototype.serialize=function(){if("formatted"===this.type.kind)return new pe([{content:this.args[0],scale:null,font:null,textColor:null}]).serialize();if("resolvedImage"===this.type.kind)return new he(this.args[0]).serialize();var t=["to-"+this.type.kind];return this.eachChild((function(e){t.push(e.serialize())})),t};var me=["Unknown","Point","LineString","Polygon"],ge=function(){this.globals=null,this.feature=null,this.featureState=null,this.formattedSection=null,this._parseColorCache={},this.availableImages=null,this.canonical=null};ge.prototype.id=function(){return this.feature&&"id"in this.feature?this.feature.id:null},ge.prototype.geometryType=function(){return this.feature?"number"==typeof this.feature.type?me[this.feature.type]:this.feature.type:null},ge.prototype.geometry=function(){return this.feature&&"geometry"in this.feature?this.feature.geometry:null},ge.prototype.canonicalID=function(){return this.canonical},ge.prototype.properties=function(){return this.feature&&this.feature.properties||{}},ge.prototype.parseColor=function(t){var e=this._parseColorCache[t];return e||(e=this._parseColorCache[t]=Yt.parse(t)),e};var ye=function(t,e,r,o){this.name=t,this.type=e,this._evaluate=r,this.args=o};ye.prototype.evaluate=function(t){return this._evaluate(t,this.args)},ye.prototype.eachChild=function(t){this.args.forEach(t)},ye.prototype.outputDefined=function(){return!1},ye.prototype.serialize=function(){return[this.name].concat(this.args.map((function(t){return t.serialize()})))},ye.parse=function(t,e){var r,o=t[0],i=ye.definitions[o];if(!i)return e.error('Unknown expression "'+o+'". If you wanted a literal array, use ["literal", [...]].',0);for(var a=Array.isArray(i)?i[0]:i.type,n=Array.isArray(i)?[[i[1],i[2]]]:i.overloads,s=n.filter((function(e){var r=e[0];return!Array.isArray(r)||r.length===t.length-1})),u=null,l=0,p=s;l<p.length;l+=1){var c=p[l],h=c[0],d=c[1];u=new Ue(e.registry,e.path,null,e.scope);for(var f=[],m=!1,y=1;y<t.length;y++){var v=t[y],g=Array.isArray(h)?h[y-1]:h.type,_=u.parse(v,1+f.length,g);if(!_){m=!0;break}f.push(_)}if(!m)if(Array.isArray(h)&&h.length!==f.length)u.error("Expected "+h.length+" arguments, but found "+f.length+" instead.");else{for(var b=0;b<f.length;b++){var x=Array.isArray(h)?h[b]:h.type,w=f[b];u.concat(b+1).checkSubtype(x,w.type)}if(0===u.errors.length)return new ye(o,a,d,f)}}if(1===s.length)(r=e.errors).push.apply(r,u.errors);else{for(var E=(s.length?s:n).map((function(t){var e;return e=t[0],Array.isArray(e)?"("+e.map(Ht).join(", ")+")":"("+Ht(e.type)+"...)"})).join(" | "),k=[],S=1;S<t.length;S++){var T=e.parse(t[S],1+k.length);if(!T)return null;k.push(Ht(T.type))}e.error("Expected arguments of type "+E+", but found ("+k.join(", ")+") instead.")}return null},ye.register=function(t,e){for(var r in ye.definitions=e,e)t[r]=ye};var ve=function(t,e,r){this.type=Vt,this.locale=r,this.caseSensitive=t,this.diacriticSensitive=e};function _e(t,e){t[0]=Math.min(t[0],e[0]),t[1]=Math.min(t[1],e[1]),t[2]=Math.max(t[2],e[0]),t[3]=Math.max(t[3],e[1])}function xe(t,e){return!(t[0]<=e[0]||t[2]>=e[2]||t[1]<=e[1]||t[3]>=e[3])}function be(t,e){var r=(180+t[0])/360,o=(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+t[1]*Math.PI/360)))/360,i=Math.pow(2,e.z);return[Math.round(r*i*8192),Math.round(o*i*8192)]}function we(t,e,r){return e[1]>t[1]!=r[1]>t[1]&&t[0]<(r[0]-e[0])*(t[1]-e[1])/(r[1]-e[1])+e[0]}function Ee(t,e){for(var r,o,i,a,n,s,u,l=!1,p=0,c=e.length;p<c;p++)for(var h=e[p],d=0,f=h.length;d<f-1;d++){if((a=(r=t)[0]-(o=h[d])[0])*(u=r[1]-(i=h[d+1])[1])-(s=r[0]-i[0])*(n=r[1]-o[1])==0&&a*s<=0&&n*u<=0)return!1;we(t,h[d],h[d+1])&&(l=!l)}return l}function ke(t,e){for(var r=0;r<e.length;r++)if(Ee(t,e[r]))return!0;return!1}function Se(t,e,r,o){var i=o[0]-r[0],a=o[1]-r[1],n=(t[0]-r[0])*a-i*(t[1]-r[1]),s=(e[0]-r[0])*a-i*(e[1]-r[1]);return n>0&&s<0||n<0&&s>0}function Te(t,e,r){for(var o=0,i=r;o<i.length;o+=1)for(var a=i[o],n=0;n<a.length-1;++n)if(0!=(c=[(p=a[n+1])[0]-(l=a[n])[0],p[1]-l[1]])[0]*(h=[(u=e)[0]-(s=t)[0],u[1]-s[1]])[1]-c[1]*h[0]&&Se(s,u,l,p)&&Se(l,p,s,u))return!0;var s,u,l,p,c,h;return!1}function Ie(t,e){for(var r=0;r<t.length;++r)if(!Ee(t[r],e))return!1;for(var o=0;o<t.length-1;++o)if(Te(t[o],t[o+1],e))return!1;return!0}function ze(t,e){for(var r=0;r<e.length;r++)if(Ie(t,e[r]))return!0;return!1}function Ce(t,e,r){for(var o=[],i=0;i<t.length;i++){for(var a=[],n=0;n<t[i].length;n++){var s=be(t[i][n],r);_e(e,s),a.push(s)}o.push(a)}return o}function Pe(t,e,r){for(var o=[],i=0;i<t.length;i++){var a=Ce(t[i],e,r);o.push(a)}return o}function Ae(t,e,r,o){if(t[0]<r[0]||t[0]>r[2]){var i=.5*o,a=t[0]-r[0]>i?-o:r[0]-t[0]>i?o:0;0===a&&(a=t[0]-r[2]>i?-o:r[2]-t[0]>i?o:0),t[0]+=a}_e(e,t)}function Me(t,e,r,o){for(var i=8192*Math.pow(2,o.z),a=[8192*o.x,8192*o.y],n=[],s=0,u=t;s<u.length;s+=1)for(var l=0,p=u[s];l<p.length;l+=1){var c=p[l],h=[c.x+a[0],c.y+a[1]];Ae(h,e,r,i),n.push(h)}return n}function Le(t,e,r,o){for(var i,a=8192*Math.pow(2,o.z),n=[8192*o.x,8192*o.y],s=[],u=0,l=t;u<l.length;u+=1){for(var p=[],c=0,h=l[u];c<h.length;c+=1){var d=h[c],f=[d.x+n[0],d.y+n[1]];_e(e,f),p.push(f)}s.push(p)}if(e[2]-e[0]<=a/2){(i=e)[0]=i[1]=1/0,i[2]=i[3]=-1/0;for(var m=0,y=s;m<y.length;m+=1)for(var v=0,g=y[m];v<g.length;v+=1)Ae(g[v],e,r,a)}return s}ve.parse=function(t,e){if(2!==t.length)return e.error("Expected one argument.");var r=t[1];if("object"!=typeof r||Array.isArray(r))return e.error("Collator options argument must be an object.");var o=e.parse(void 0!==r["case-sensitive"]&&r["case-sensitive"],1,Ft);if(!o)return null;var i=e.parse(void 0!==r["diacritic-sensitive"]&&r["diacritic-sensitive"],1,Ft);if(!i)return null;var a=null;return r.locale&&!(a=e.parse(r.locale,1,Bt))?null:new ve(o,i,a)},ve.prototype.evaluate=function(t){return new Qt(this.caseSensitive.evaluate(t),this.diacriticSensitive.evaluate(t),this.locale?this.locale.evaluate(t):null)},ve.prototype.eachChild=function(t){t(this.caseSensitive),t(this.diacriticSensitive),this.locale&&t(this.locale)},ve.prototype.outputDefined=function(){return!1},ve.prototype.serialize=function(){var t={};return t["case-sensitive"]=this.caseSensitive.serialize(),t["diacritic-sensitive"]=this.diacriticSensitive.serialize(),this.locale&&(t.locale=this.locale.serialize()),["collator",t]};var Re=function(t,e){this.type=Ft,this.geojson=t,this.geometries=e};function De(t){if(t instanceof ye){if("get"===t.name&&1===t.args.length)return!1;if("feature-state"===t.name)return!1;if("has"===t.name&&1===t.args.length)return!1;if("properties"===t.name||"geometry-type"===t.name||"id"===t.name)return!1;if(/^filter-/.test(t.name))return!1}if(t instanceof Re)return!1;var e=!0;return t.eachChild((function(t){e&&!De(t)&&(e=!1)})),e}function Oe(t){if(t instanceof ye&&"feature-state"===t.name)return!1;var e=!0;return t.eachChild((function(t){e&&!Oe(t)&&(e=!1)})),e}function Be(t,e){if(t instanceof ye&&e.indexOf(t.name)>=0)return!1;var r=!0;return t.eachChild((function(t){r&&!Be(t,e)&&(r=!1)})),r}Re.parse=function(t,e){if(2!==t.length)return e.error("'within' expression requires exactly one argument, but found "+(t.length-1)+" instead.");if(oe(t[1])){var r=t[1];if("FeatureCollection"===r.type)for(var o=0;o<r.features.length;++o){var i=r.features[o].geometry.type;if("Polygon"===i||"MultiPolygon"===i)return new Re(r,r.features[o].geometry)}else if("Feature"===r.type){var a=r.geometry.type;if("Polygon"===a||"MultiPolygon"===a)return new Re(r,r.geometry)}else if("Polygon"===r.type||"MultiPolygon"===r.type)return new Re(r,r)}return e.error("'within' expression requires valid geojson object that contains polygon geometry type.")},Re.prototype.evaluate=function(t){if(null!=t.geometry()&&null!=t.canonicalID()){if("Point"===t.geometryType())return function(t,e){var r=[1/0,1/0,-1/0,-1/0],o=[1/0,1/0,-1/0,-1/0],i=t.canonicalID();if("Polygon"===e.type){var a=Ce(e.coordinates,o,i),n=Me(t.geometry(),r,o,i);if(!xe(r,o))return!1;for(var s=0,u=n;s<u.length;s+=1)if(!Ee(u[s],a))return!1}if("MultiPolygon"===e.type){var l=Pe(e.coordinates,o,i),p=Me(t.geometry(),r,o,i);if(!xe(r,o))return!1;for(var c=0,h=p;c<h.length;c+=1)if(!ke(h[c],l))return!1}return!0}(t,this.geometries);if("LineString"===t.geometryType())return function(t,e){var r=[1/0,1/0,-1/0,-1/0],o=[1/0,1/0,-1/0,-1/0],i=t.canonicalID();if("Polygon"===e.type){var a=Ce(e.coordinates,o,i),n=Le(t.geometry(),r,o,i);if(!xe(r,o))return!1;for(var s=0,u=n;s<u.length;s+=1)if(!Ie(u[s],a))return!1}if("MultiPolygon"===e.type){var l=Pe(e.coordinates,o,i),p=Le(t.geometry(),r,o,i);if(!xe(r,o))return!1;for(var c=0,h=p;c<h.length;c+=1)if(!ze(h[c],l))return!1}return!0}(t,this.geometries)}return!1},Re.prototype.eachChild=function(){},Re.prototype.outputDefined=function(){return!0},Re.prototype.serialize=function(){return["within",this.geojson]};var Fe=function(t,e){this.type=e.type,this.name=t,this.boundExpression=e};Fe.parse=function(t,e){if(2!==t.length||"string"!=typeof t[1])return e.error("'var' expression requires exactly one string literal argument.");var r=t[1];return e.scope.has(r)?new Fe(r,e.scope.get(r)):e.error('Unknown variable "'+r+'". Make sure "'+r+'" has been bound in an enclosing "let" expression before using it.',1)},Fe.prototype.evaluate=function(t){return this.boundExpression.evaluate(t)},Fe.prototype.eachChild=function(){},Fe.prototype.outputDefined=function(){return!1},Fe.prototype.serialize=function(){return["var",this.name]};var Ue=function(t,e,r,o,i){void 0===e&&(e=[]),void 0===o&&(o=new Rt),void 0===i&&(i=[]),this.registry=t,this.path=e,this.key=e.map((function(t){return"["+t+"]"})).join(""),this.scope=o,this.errors=i,this.expectedType=r};function Ne(t,e){for(var r,o=t.length-1,i=0,a=o,n=0;i<=a;)if((r=t[n=Math.floor((i+a)/2)])<=e){if(n===o||e<t[n+1])return n;i=n+1}else{if(!(r>e))throw new le("Input is not a number.");a=n-1}return 0}Ue.prototype.parse=function(t,e,r,o,i){return void 0===i&&(i={}),e?this.concat(e,r,o)._parse(t,i):this._parse(t,i)},Ue.prototype._parse=function(t,e){function r(t,e,r){return"assert"===r?new ce(e,[t]):"coerce"===r?new fe(e,[t]):t}if(null!==t&&"string"!=typeof t&&"boolean"!=typeof t&&"number"!=typeof t||(t=["literal",t]),Array.isArray(t)){if(0===t.length)return this.error('Expected an array with at least one element. If you wanted a literal array, use ["literal", []].');var o=t[0];if("string"!=typeof o)return this.error("Expression name must be a string, but found "+typeof o+' instead. If you wanted a literal array, use ["literal", [...]].',0),null;var i=this.registry[o];if(i){var a=i.parse(t,this);if(!a)return null;if(this.expectedType){var n=this.expectedType,s=a.type;if("string"!==n.kind&&"number"!==n.kind&&"boolean"!==n.kind&&"object"!==n.kind&&"array"!==n.kind||"value"!==s.kind)if("color"!==n.kind&&"formatted"!==n.kind&&"resolvedImage"!==n.kind||"value"!==s.kind&&"string"!==s.kind){if(this.checkSubtype(n,s))return null}else a=r(a,n,e.typeAnnotation||"coerce");else a=r(a,n,e.typeAnnotation||"assert")}if(!(a instanceof se)&&"resolvedImage"!==a.type.kind&&function t(e){if(e instanceof Fe)return t(e.boundExpression);if(e instanceof ye&&"error"===e.name)return!1;if(e instanceof ve)return!1;if(e instanceof Re)return!1;var r=e instanceof fe||e instanceof ce,o=!0;return e.eachChild((function(e){o=r?o&&t(e):o&&e instanceof se})),!!o&&De(e)&&Be(e,["zoom","heatmap-density","line-progress","accumulated","is-supported-script"])}(a)){var u=new ge;try{a=new se(a.type,a.evaluate(u))}catch(t){return this.error(t.message),null}}return a}return this.error('Unknown expression "'+o+'". If you wanted a literal array, use ["literal", [...]].',0)}return this.error(void 0===t?"'undefined' value invalid. Use null instead.":"object"==typeof t?'Bare objects invalid. Use ["literal", {...}] instead.':"Expected an array, but found "+typeof t+" instead.")},Ue.prototype.concat=function(t,e,r){var o="number"==typeof t?this.path.concat(t):this.path,i=r?this.scope.concat(r):this.scope;return new Ue(this.registry,o,e||null,i,this.errors)},Ue.prototype.error=function(t){for(var e=[],r=arguments.length-1;r-- >0;)e[r]=arguments[r+1];var o=""+this.key+e.map((function(t){return"["+t+"]"})).join("");this.errors.push(new Lt(o,t))},Ue.prototype.checkSubtype=function(t,e){var r=Wt(t,e);return r&&this.error(r),r};var je=function(t,e,r){this.type=t,this.input=e,this.labels=[],this.outputs=[];for(var o=0,i=r;o<i.length;o+=1){var a=i[o],n=a[1];this.labels.push(a[0]),this.outputs.push(n)}};function Ve(t,e,r){return t*(1-r)+e*r}je.parse=function(t,e){if(t.length-1<4)return e.error("Expected at least 4 arguments, but found only "+(t.length-1)+".");if((t.length-1)%2!=0)return e.error("Expected an even number of arguments.");var r=e.parse(t[1],1,Ot);if(!r)return null;var o=[],i=null;e.expectedType&&"value"!==e.expectedType.kind&&(i=e.expectedType);for(var a=1;a<t.length;a+=2){var n=1===a?-1/0:t[a],s=t[a+1],u=a,l=a+1;if("number"!=typeof n)return e.error('Input/output pairs for "step" expressions must be defined using literal numeric values (not computed expressions) for the input values.',u);if(o.length&&o[o.length-1][0]>=n)return e.error('Input/output pairs for "step" expressions must be arranged with input values in strictly ascending order.',u);var p=e.parse(s,l,i);if(!p)return null;i=i||p.type,o.push([n,p])}return new je(i,r,o)},je.prototype.evaluate=function(t){var e=this.labels,r=this.outputs;if(1===e.length)return r[0].evaluate(t);var o=this.input.evaluate(t);if(o<=e[0])return r[0].evaluate(t);var i=e.length;return o>=e[i-1]?r[i-1].evaluate(t):r[Ne(e,o)].evaluate(t)},je.prototype.eachChild=function(t){t(this.input);for(var e=0,r=this.outputs;e<r.length;e+=1)t(r[e])},je.prototype.outputDefined=function(){return this.outputs.every((function(t){return t.outputDefined()}))},je.prototype.serialize=function(){for(var t=["step",this.input.serialize()],e=0;e<this.labels.length;e++)e>0&&t.push(this.labels[e]),t.push(this.outputs[e].serialize());return t};var qe=Object.freeze({__proto__:null,number:Ve,color:function(t,e,r){return new Yt(Ve(t.r,e.r,r),Ve(t.g,e.g,r),Ve(t.b,e.b,r),Ve(t.a,e.a,r))},array:function(t,e,r){return t.map((function(t,o){return Ve(t,e[o],r)}))}}),Ge=6/29*3*(6/29),Ze=Math.PI/180,He=180/Math.PI;function Ke(t){return t>.008856451679035631?Math.pow(t,1/3):t/Ge+4/29}function We(t){return t>6/29?t*t*t:Ge*(t-4/29)}function Xe(t){return 255*(t<=.0031308?12.92*t:1.055*Math.pow(t,1/2.4)-.055)}function $e(t){return(t/=255)<=.04045?t/12.92:Math.pow((t+.055)/1.055,2.4)}function Je(t){var e=$e(t.r),r=$e(t.g),o=$e(t.b),i=Ke((.4124564*e+.3575761*r+.1804375*o)/.95047),a=Ke((.2126729*e+.7151522*r+.072175*o)/1);return{l:116*a-16,a:500*(i-a),b:200*(a-Ke((.0193339*e+.119192*r+.9503041*o)/1.08883)),alpha:t.a}}function Ye(t){var e=(t.l+16)/116,r=isNaN(t.a)?e:e+t.a/500,o=isNaN(t.b)?e:e-t.b/200;return e=1*We(e),r=.95047*We(r),o=1.08883*We(o),new Yt(Xe(3.2404542*r-1.5371385*e-.4985314*o),Xe(-.969266*r+1.8760108*e+.041556*o),Xe(.0556434*r-.2040259*e+1.0572252*o),t.alpha)}function Qe(t,e,r){var o=e-t;return t+r*(o>180||o<-180?o-360*Math.round(o/360):o)}var tr={forward:Je,reverse:Ye,interpolate:function(t,e,r){return{l:Ve(t.l,e.l,r),a:Ve(t.a,e.a,r),b:Ve(t.b,e.b,r),alpha:Ve(t.alpha,e.alpha,r)}}},er={forward:function(t){var e=Je(t),r=e.l,o=e.a,i=e.b,a=Math.atan2(i,o)*He;return{h:a<0?a+360:a,c:Math.sqrt(o*o+i*i),l:r,alpha:t.a}},reverse:function(t){var e=t.h*Ze,r=t.c;return Ye({l:t.l,a:Math.cos(e)*r,b:Math.sin(e)*r,alpha:t.alpha})},interpolate:function(t,e,r){return{h:Qe(t.h,e.h,r),c:Ve(t.c,e.c,r),l:Ve(t.l,e.l,r),alpha:Ve(t.alpha,e.alpha,r)}}},rr=Object.freeze({__proto__:null,lab:tr,hcl:er}),ir=function(t,e,r,o,i){this.type=t,this.operator=e,this.interpolation=r,this.input=o,this.labels=[],this.outputs=[];for(var a=0,n=i;a<n.length;a+=1){var s=n[a],u=s[1];this.labels.push(s[0]),this.outputs.push(u)}};function or(t,e,r,o){var i=o-r,a=t-r;return 0===i?0:1===e?a/i:(Math.pow(e,a)-1)/(Math.pow(e,i)-1)}ir.interpolationFactor=function(t,e,o,i){var a=0;if("exponential"===t.name)a=or(e,t.base,o,i);else if("linear"===t.name)a=or(e,1,o,i);else if("cubic-bezier"===t.name){var n=t.controlPoints;a=new r(n[0],n[1],n[2],n[3]).solve(or(e,1,o,i))}return a},ir.parse=function(t,e){var r=t[0],o=t[1],i=t[2],a=t.slice(3);if(!Array.isArray(o)||0===o.length)return e.error("Expected an interpolation type expression.",1);if("linear"===o[0])o={name:"linear"};else if("exponential"===o[0]){var n=o[1];if("number"!=typeof n)return e.error("Exponential interpolation requires a numeric base.",1,1);o={name:"exponential",base:n}}else{if("cubic-bezier"!==o[0])return e.error("Unknown interpolation type "+String(o[0]),1,0);var s=o.slice(1);if(4!==s.length||s.some((function(t){return"number"!=typeof t||t<0||t>1})))return e.error("Cubic bezier interpolation requires four numeric arguments with values between 0 and 1.",1);o={name:"cubic-bezier",controlPoints:s}}if(t.length-1<4)return e.error("Expected at least 4 arguments, but found only "+(t.length-1)+".");if((t.length-1)%2!=0)return e.error("Expected an even number of arguments.");if(!(i=e.parse(i,2,Ot)))return null;var u=[],l=null;"interpolate-hcl"===r||"interpolate-lab"===r?l=Ut:e.expectedType&&"value"!==e.expectedType.kind&&(l=e.expectedType);for(var p=0;p<a.length;p+=2){var c=a[p],h=a[p+1],d=p+3,f=p+4;if("number"!=typeof c)return e.error('Input/output pairs for "interpolate" expressions must be defined using literal numeric values (not computed expressions) for the input values.',d);if(u.length&&u[u.length-1][0]>=c)return e.error('Input/output pairs for "interpolate" expressions must be arranged with input values in strictly ascending order.',d);var m=e.parse(h,f,l);if(!m)return null;l=l||m.type,u.push([c,m])}return"number"===l.kind||"color"===l.kind||"array"===l.kind&&"number"===l.itemType.kind&&"number"==typeof l.N?new ir(l,r,o,i,u):e.error("Type "+Ht(l)+" is not interpolatable.")},ir.prototype.evaluate=function(t){var e=this.labels,r=this.outputs;if(1===e.length)return r[0].evaluate(t);var o=this.input.evaluate(t);if(o<=e[0])return r[0].evaluate(t);var i=e.length;if(o>=e[i-1])return r[i-1].evaluate(t);var a=Ne(e,o),n=ir.interpolationFactor(this.interpolation,o,e[a],e[a+1]),s=r[a].evaluate(t),u=r[a+1].evaluate(t);return"interpolate"===this.operator?qe[this.type.kind.toLowerCase()](s,u,n):"interpolate-hcl"===this.operator?er.reverse(er.interpolate(er.forward(s),er.forward(u),n)):tr.reverse(tr.interpolate(tr.forward(s),tr.forward(u),n))},ir.prototype.eachChild=function(t){t(this.input);for(var e=0,r=this.outputs;e<r.length;e+=1)t(r[e])},ir.prototype.outputDefined=function(){return this.outputs.every((function(t){return t.outputDefined()}))},ir.prototype.serialize=function(){var t;t="linear"===this.interpolation.name?["linear"]:"exponential"===this.interpolation.name?1===this.interpolation.base?["linear"]:["exponential",this.interpolation.base]:["cubic-bezier"].concat(this.interpolation.controlPoints);for(var e=[this.operator,t,this.input.serialize()],r=0;r<this.labels.length;r++)e.push(this.labels[r],this.outputs[r].serialize());return e};var nr=function(t,e){this.type=t,this.args=e};nr.parse=function(t,e){if(t.length<2)return e.error("Expectected at least one argument.");var r=null,o=e.expectedType;o&&"value"!==o.kind&&(r=o);for(var i=[],a=0,n=t.slice(1);a<n.length;a+=1){var s=e.parse(n[a],1+i.length,r,void 0,{typeAnnotation:"omit"});if(!s)return null;r=r||s.type,i.push(s)}var u=o&&i.some((function(t){return Wt(o,t.type)}));return new nr(u?jt:r,i)},nr.prototype.evaluate=function(t){for(var e,r=null,o=0,i=0,a=this.args;i<a.length&&(o++,(r=a[i].evaluate(t))&&r instanceof re&&!r.available&&(e||(e=r.name),r=null,o===this.args.length&&(r=e)),null===r);i+=1);return r},nr.prototype.eachChild=function(t){this.args.forEach(t)},nr.prototype.outputDefined=function(){return this.args.every((function(t){return t.outputDefined()}))},nr.prototype.serialize=function(){var t=["coalesce"];return this.eachChild((function(e){t.push(e.serialize())})),t};var ar=function(t,e){this.type=e.type,this.bindings=[].concat(t),this.result=e};ar.prototype.evaluate=function(t){return this.result.evaluate(t)},ar.prototype.eachChild=function(t){for(var e=0,r=this.bindings;e<r.length;e+=1)t(r[e][1]);t(this.result)},ar.parse=function(t,e){if(t.length<4)return e.error("Expected at least 3 arguments, but found "+(t.length-1)+" instead.");for(var r=[],o=1;o<t.length-1;o+=2){var i=t[o];if("string"!=typeof i)return e.error("Expected string, but found "+typeof i+" instead.",o);if(/[^a-zA-Z0-9_]/.test(i))return e.error("Variable names must contain only alphanumeric characters or '_'.",o);var a=e.parse(t[o+1],o+1);if(!a)return null;r.push([i,a])}var n=e.parse(t[t.length-1],t.length-1,e.expectedType,r);return n?new ar(r,n):null},ar.prototype.outputDefined=function(){return this.result.outputDefined()},ar.prototype.serialize=function(){for(var t=["let"],e=0,r=this.bindings;e<r.length;e+=1){var o=r[e];t.push(o[0],o[1].serialize())}return t.push(this.result.serialize()),t};var sr=function(t,e,r){this.type=t,this.index=e,this.input=r};sr.parse=function(t,e){if(3!==t.length)return e.error("Expected 2 arguments, but found "+(t.length-1)+" instead.");var r=e.parse(t[1],1,Ot),o=e.parse(t[2],2,Zt(e.expectedType||jt));return r&&o?new sr(o.type.itemType,r,o):null},sr.prototype.evaluate=function(t){var e=this.index.evaluate(t),r=this.input.evaluate(t);if(e<0)throw new le("Array index out of bounds: "+e+" < 0.");if(e>=r.length)throw new le("Array index out of bounds: "+e+" > "+(r.length-1)+".");if(e!==Math.floor(e))throw new le("Array index must be an integer, but found "+e+" instead.");return r[e]},sr.prototype.eachChild=function(t){t(this.index),t(this.input)},sr.prototype.outputDefined=function(){return!1},sr.prototype.serialize=function(){return["at",this.index.serialize(),this.input.serialize()]};var lr=function(t,e){this.type=Ft,this.needle=t,this.haystack=e};lr.parse=function(t,e){if(3!==t.length)return e.error("Expected 2 arguments, but found "+(t.length-1)+" instead.");var r=e.parse(t[1],1,jt),o=e.parse(t[2],2,jt);return r&&o?Xt(r.type,[Ft,Bt,Ot,Dt,jt])?new lr(r,o):e.error("Expected first argument to be of type boolean, string, number or null, but found "+Ht(r.type)+" instead"):null},lr.prototype.evaluate=function(t){var e=this.needle.evaluate(t),r=this.haystack.evaluate(t);if(!r)return!1;if(!$t(e,["boolean","string","number","null"]))throw new le("Expected first argument to be of type boolean, string, number or null, but found "+Ht(ne(e))+" instead.");if(!$t(r,["string","array"]))throw new le("Expected second argument to be of type array or string, but found "+Ht(ne(r))+" instead.");return r.indexOf(e)>=0},lr.prototype.eachChild=function(t){t(this.needle),t(this.haystack)},lr.prototype.outputDefined=function(){return!0},lr.prototype.serialize=function(){return["in",this.needle.serialize(),this.haystack.serialize()]};var ur=function(t,e,r){this.type=Ot,this.needle=t,this.haystack=e,this.fromIndex=r};ur.parse=function(t,e){if(t.length<=2||t.length>=5)return e.error("Expected 3 or 4 arguments, but found "+(t.length-1)+" instead.");var r=e.parse(t[1],1,jt),o=e.parse(t[2],2,jt);if(!r||!o)return null;if(!Xt(r.type,[Ft,Bt,Ot,Dt,jt]))return e.error("Expected first argument to be of type boolean, string, number or null, but found "+Ht(r.type)+" instead");if(4===t.length){var i=e.parse(t[3],3,Ot);return i?new ur(r,o,i):null}return new ur(r,o)},ur.prototype.evaluate=function(t){var e=this.needle.evaluate(t),r=this.haystack.evaluate(t);if(!$t(e,["boolean","string","number","null"]))throw new le("Expected first argument to be of type boolean, string, number or null, but found "+Ht(ne(e))+" instead.");if(!$t(r,["string","array"]))throw new le("Expected second argument to be of type array or string, but found "+Ht(ne(r))+" instead.");if(this.fromIndex){var o=this.fromIndex.evaluate(t);return r.indexOf(e,o)}return r.indexOf(e)},ur.prototype.eachChild=function(t){t(this.needle),t(this.haystack),this.fromIndex&&t(this.fromIndex)},ur.prototype.outputDefined=function(){return!1},ur.prototype.serialize=function(){if(null!=this.fromIndex&&void 0!==this.fromIndex){var t=this.fromIndex.serialize();return["index-of",this.needle.serialize(),this.haystack.serialize(),t]}return["index-of",this.needle.serialize(),this.haystack.serialize()]};var cr=function(t,e,r,o,i,a){this.inputType=t,this.type=e,this.input=r,this.cases=o,this.outputs=i,this.otherwise=a};cr.parse=function(t,e){if(t.length<5)return e.error("Expected at least 4 arguments, but found only "+(t.length-1)+".");if(t.length%2!=1)return e.error("Expected an even number of arguments.");var r,o;e.expectedType&&"value"!==e.expectedType.kind&&(o=e.expectedType);for(var i={},a=[],n=2;n<t.length-1;n+=2){var s=t[n],u=t[n+1];Array.isArray(s)||(s=[s]);var l=e.concat(n);if(0===s.length)return l.error("Expected at least one branch label.");for(var p=0,c=s;p<c.length;p+=1){var h=c[p];if("number"!=typeof h&&"string"!=typeof h)return l.error("Branch labels must be numbers or strings.");if("number"==typeof h&&Math.abs(h)>Number.MAX_SAFE_INTEGER)return l.error("Branch labels must be integers no larger than "+Number.MAX_SAFE_INTEGER+".");if("number"==typeof h&&Math.floor(h)!==h)return l.error("Numeric branch labels must be integer values.");if(r){if(l.checkSubtype(r,ne(h)))return null}else r=ne(h);if(void 0!==i[String(h)])return l.error("Branch labels must be unique.");i[String(h)]=a.length}var d=e.parse(u,n,o);if(!d)return null;o=o||d.type,a.push(d)}var f=e.parse(t[1],1,jt);if(!f)return null;var m=e.parse(t[t.length-1],t.length-1,o);return m?"value"!==f.type.kind&&e.concat(1).checkSubtype(r,f.type)?null:new cr(r,o,f,i,a,m):null},cr.prototype.evaluate=function(t){var e=this.input.evaluate(t);return(ne(e)===this.inputType&&this.outputs[this.cases[e]]||this.otherwise).evaluate(t)},cr.prototype.eachChild=function(t){t(this.input),this.outputs.forEach(t),t(this.otherwise)},cr.prototype.outputDefined=function(){return this.outputs.every((function(t){return t.outputDefined()}))&&this.otherwise.outputDefined()},cr.prototype.serialize=function(){for(var t=this,e=["match",this.input.serialize()],r=[],o={},i=0,a=Object.keys(this.cases).sort();i<a.length;i+=1){var n=a[i];void 0===(c=o[this.cases[n]])?(o[this.cases[n]]=r.length,r.push([this.cases[n],[n]])):r[c][1].push(n)}for(var s=function(e){return"number"===t.inputType.kind?Number(e):e},u=0,l=r;u<l.length;u+=1){var p=l[u],c=p[0],h=p[1];e.push(1===h.length?s(h[0]):h.map(s)),e.push(this.outputs[outputIndex$1].serialize())}return e.push(this.otherwise.serialize()),e};var pr=function(t,e,r){this.type=t,this.branches=e,this.otherwise=r};pr.parse=function(t,e){if(t.length<4)return e.error("Expected at least 3 arguments, but found only "+(t.length-1)+".");if(t.length%2!=0)return e.error("Expected an odd number of arguments.");var r;e.expectedType&&"value"!==e.expectedType.kind&&(r=e.expectedType);for(var o=[],i=1;i<t.length-1;i+=2){var a=e.parse(t[i],i,Ft);if(!a)return null;var n=e.parse(t[i+1],i+1,r);if(!n)return null;o.push([a,n]),r=r||n.type}var s=e.parse(t[t.length-1],t.length-1,r);return s?new pr(r,o,s):null},pr.prototype.evaluate=function(t){for(var e=0,r=this.branches;e<r.length;e+=1){var o=r[e],i=o[1];if(o[0].evaluate(t))return i.evaluate(t)}return this.otherwise.evaluate(t)},pr.prototype.eachChild=function(t){for(var e=0,r=this.branches;e<r.length;e+=1){var o=r[e],i=o[1];t(o[0]),t(i)}t(this.otherwise)},pr.prototype.outputDefined=function(){return this.branches.every((function(t){return t[1].outputDefined()}))&&this.otherwise.outputDefined()},pr.prototype.serialize=function(){var t=["case"];return this.eachChild((function(e){t.push(e.serialize())})),t};var hr=function(t,e,r,o){this.type=t,this.input=e,this.beginIndex=r,this.endIndex=o};function dr(t,e){return"=="===t||"!="===t?"boolean"===e.kind||"string"===e.kind||"number"===e.kind||"null"===e.kind||"value"===e.kind:"string"===e.kind||"number"===e.kind||"value"===e.kind}function fr(t,e,r,o){return 0===o.compare(e,r)}function mr(t,e,r){var o="=="!==t&&"!="!==t;return function(){function i(t,e,r){this.type=Ft,this.lhs=t,this.rhs=e,this.collator=r,this.hasUntypedArgument="value"===t.type.kind||"value"===e.type.kind}return i.parse=function(t,e){if(3!==t.length&&4!==t.length)return e.error("Expected two or three arguments.");var r=t[0],a=e.parse(t[1],1,jt);if(!a)return null;if(!dr(r,a.type))return e.concat(1).error('"'+r+"\" comparisons are not supported for type '"+Ht(a.type)+"'.");var n=e.parse(t[2],2,jt);if(!n)return null;if(!dr(r,n.type))return e.concat(2).error('"'+r+"\" comparisons are not supported for type '"+Ht(n.type)+"'.");if(a.type.kind!==n.type.kind&&"value"!==a.type.kind&&"value"!==n.type.kind)return e.error("Cannot compare types '"+Ht(a.type)+"' and '"+Ht(n.type)+"'.");o&&("value"===a.type.kind&&"value"!==n.type.kind?a=new ce(n.type,[a]):"value"!==a.type.kind&&"value"===n.type.kind&&(n=new ce(a.type,[n])));var s=null;if(4===t.length){if("string"!==a.type.kind&&"string"!==n.type.kind&&"value"!==a.type.kind&&"value"!==n.type.kind)return e.error("Cannot use collator to compare non-string types.");if(!(s=e.parse(t[3],3,Vt)))return null}return new i(a,n,s)},i.prototype.evaluate=function(i){var a=this.lhs.evaluate(i),n=this.rhs.evaluate(i);if(o&&this.hasUntypedArgument){var s=ne(a),u=ne(n);if(s.kind!==u.kind||"string"!==s.kind&&"number"!==s.kind)throw new le('Expected arguments for "'+t+'" to be (string, string) or (number, number), but found ('+s.kind+", "+u.kind+") instead.")}if(this.collator&&!o&&this.hasUntypedArgument){var l=ne(a),p=ne(n);if("string"!==l.kind||"string"!==p.kind)return e(i,a,n)}return this.collator?r(i,a,n,this.collator.evaluate(i)):e(i,a,n)},i.prototype.eachChild=function(t){t(this.lhs),t(this.rhs),this.collator&&t(this.collator)},i.prototype.outputDefined=function(){return!0},i.prototype.serialize=function(){var e=[t];return this.eachChild((function(t){e.push(t.serialize())})),e},i}()}hr.parse=function(t,e){if(t.length<=2||t.length>=5)return e.error("Expected 3 or 4 arguments, but found "+(t.length-1)+" instead.");var r=e.parse(t[1],1,jt),o=e.parse(t[2],2,Ot);if(!r||!o)return null;if(!Xt(r.type,[Zt(jt),Bt,jt]))return e.error("Expected first argument to be of type array or string, but found "+Ht(r.type)+" instead");if(4===t.length){var i=e.parse(t[3],3,Ot);return i?new hr(r.type,r,o,i):null}return new hr(r.type,r,o)},hr.prototype.evaluate=function(t){var e=this.input.evaluate(t),r=this.beginIndex.evaluate(t);if(!$t(e,["string","array"]))throw new le("Expected first argument to be of type array or string, but found "+Ht(ne(e))+" instead.");if(this.endIndex){var o=this.endIndex.evaluate(t);return e.slice(r,o)}return e.slice(r)},hr.prototype.eachChild=function(t){t(this.input),t(this.beginIndex),this.endIndex&&t(this.endIndex)},hr.prototype.outputDefined=function(){return!1},hr.prototype.serialize=function(){if(null!=this.endIndex&&void 0!==this.endIndex){var t=this.endIndex.serialize();return["slice",this.input.serialize(),this.beginIndex.serialize(),t]}return["slice",this.input.serialize(),this.beginIndex.serialize()]};var gr=mr("==",(function(t,e,r){return e===r}),fr),yr=mr("!=",(function(t,e,r){return e!==r}),(function(t,e,r,o){return!fr(0,e,r,o)})),vr=mr("<",(function(t,e,r){return e<r}),(function(t,e,r,o){return o.compare(e,r)<0})),_r=mr(">",(function(t,e,r){return e>r}),(function(t,e,r,o){return o.compare(e,r)>0})),br=mr("<=",(function(t,e,r){return e<=r}),(function(t,e,r,o){return o.compare(e,r)<=0})),xr=mr(">=",(function(t,e,r){return e>=r}),(function(t,e,r,o){return o.compare(e,r)>=0})),wr=function(t,e,r,o,i){this.type=Bt,this.number=t,this.locale=e,this.currency=r,this.minFractionDigits=o,this.maxFractionDigits=i};wr.parse=function(t,e){if(3!==t.length)return e.error("Expected two arguments.");var r=e.parse(t[1],1,Ot);if(!r)return null;var o=t[2];if("object"!=typeof o||Array.isArray(o))return e.error("NumberFormat options argument must be an object.");var i=null;if(o.locale&&!(i=e.parse(o.locale,1,Bt)))return null;var a=null;if(o.currency&&!(a=e.parse(o.currency,1,Bt)))return null;var n=null;if(o["min-fraction-digits"]&&!(n=e.parse(o["min-fraction-digits"],1,Ot)))return null;var s=null;return o["max-fraction-digits"]&&!(s=e.parse(o["max-fraction-digits"],1,Ot))?null:new wr(r,i,a,n,s)},wr.prototype.evaluate=function(t){return new Intl.NumberFormat(this.locale?this.locale.evaluate(t):[],{style:this.currency?"currency":"decimal",currency:this.currency?this.currency.evaluate(t):void 0,minimumFractionDigits:this.minFractionDigits?this.minFractionDigits.evaluate(t):void 0,maximumFractionDigits:this.maxFractionDigits?this.maxFractionDigits.evaluate(t):void 0}).format(this.number.evaluate(t))},wr.prototype.eachChild=function(t){t(this.number),this.locale&&t(this.locale),this.currency&&t(this.currency),this.minFractionDigits&&t(this.minFractionDigits),this.maxFractionDigits&&t(this.maxFractionDigits)},wr.prototype.outputDefined=function(){return!1},wr.prototype.serialize=function(){var t={};return this.locale&&(t.locale=this.locale.serialize()),this.currency&&(t.currency=this.currency.serialize()),this.minFractionDigits&&(t["min-fraction-digits"]=this.minFractionDigits.serialize()),this.maxFractionDigits&&(t["max-fraction-digits"]=this.maxFractionDigits.serialize()),["number-format",this.number.serialize(),t]};var Er=function(t){this.type=Ot,this.input=t};Er.parse=function(t,e){if(2!==t.length)return e.error("Expected 1 argument, but found "+(t.length-1)+" instead.");var r=e.parse(t[1],1);return r?"array"!==r.type.kind&&"string"!==r.type.kind&&"value"!==r.type.kind?e.error("Expected argument of type string or array, but found "+Ht(r.type)+" instead."):new Er(r):null},Er.prototype.evaluate=function(t){var e=this.input.evaluate(t);if("string"==typeof e)return e.length;if(Array.isArray(e))return e.length;throw new le("Expected value to be of type string or array, but found "+Ht(ne(e))+" instead.")},Er.prototype.eachChild=function(t){t(this.input)},Er.prototype.outputDefined=function(){return!1},Er.prototype.serialize=function(){var t=["length"];return this.eachChild((function(e){t.push(e.serialize())})),t};var kr={"==":gr,"!=":yr,">":_r,"<":vr,">=":xr,"<=":br,array:ce,at:sr,boolean:ce,case:pr,coalesce:nr,collator:ve,format:pe,image:he,in:lr,"index-of":ur,interpolate:ir,"interpolate-hcl":ir,"interpolate-lab":ir,length:Er,let:ar,literal:se,match:cr,number:ce,"number-format":wr,object:ce,slice:hr,step:je,string:ce,"to-boolean":fe,"to-color":fe,"to-number":fe,"to-string":fe,var:Fe,within:Re};function Sr(t,e){var r=e[0],o=e[1],i=e[2],a=e[3];r=r.evaluate(t),o=o.evaluate(t),i=i.evaluate(t);var n=a?a.evaluate(t):1,s=ie(r,o,i,n);if(s)throw new le(s);return new Yt(r/255*n,o/255*n,i/255*n,n)}function Tr(t,e){return t in e}function Ir(t,e){var r=e[t];return void 0===r?null:r}function zr(t){return{type:t}}function Cr(t){return{result:"success",value:t}}function Pr(t){return{result:"error",value:t}}function Ar(t){return"data-driven"===t["property-type"]||"cross-faded-data-driven"===t["property-type"]}function Mr(t){return!!t.expression&&t.expression.parameters.indexOf("zoom")>-1}function Lr(t){return!!t.expression&&t.expression.interpolated}function Rr(t){return t instanceof Number?"number":t instanceof String?"string":t instanceof Boolean?"boolean":Array.isArray(t)?"array":null===t?"null":typeof t}function Dr(t){return"object"==typeof t&&null!==t&&!Array.isArray(t)}function Or(t){return t}function Br(t,e,r){return void 0!==t?t:void 0!==e?e:void 0!==r?r:void 0}function Fr(t,e,r,o,i){return Br(typeof r===i?o[r]:void 0,t.default,e.default)}function Ur(t,e,r){if("number"!==Rr(r))return Br(t.default,e.default);var o=t.stops.length;if(1===o)return t.stops[0][1];if(r<=t.stops[0][0])return t.stops[0][1];if(r>=t.stops[o-1][0])return t.stops[o-1][1];var i=Ne(t.stops.map((function(t){return t[0]})),r);return t.stops[i][1]}function Nr(t,e,r){var o=void 0!==t.base?t.base:1;if("number"!==Rr(r))return Br(t.default,e.default);var i=t.stops.length;if(1===i)return t.stops[0][1];if(r<=t.stops[0][0])return t.stops[0][1];if(r>=t.stops[i-1][0])return t.stops[i-1][1];var a=Ne(t.stops.map((function(t){return t[0]})),r),n=function(t,e,r,o){var i=o-r,a=t-r;return 0===i?0:1===e?a/i:(Math.pow(e,a)-1)/(Math.pow(e,i)-1)}(r,o,t.stops[a][0],t.stops[a+1][0]),s=t.stops[a][1],u=t.stops[a+1][1],l=qe[e.type]||Or;if(t.colorSpace&&"rgb"!==t.colorSpace){var p=rr[t.colorSpace];l=function(t,e){return p.reverse(p.interpolate(p.forward(t),p.forward(e),n))}}return"function"==typeof s.evaluate?{evaluate:function(){for(var t=[],e=arguments.length;e--;)t[e]=arguments[e];var r=s.evaluate.apply(void 0,t),o=u.evaluate.apply(void 0,t);if(void 0!==r&&void 0!==o)return l(r,o,n)}}:l(s,u,n)}function jr(t,e,r){return"color"===e.type?r=Yt.parse(r):"formatted"===e.type?r=ee.fromString(r.toString()):"resolvedImage"===e.type?r=re.fromString(r.toString()):Rr(r)===e.type||"enum"===e.type&&e.values[r]||(r=void 0),Br(r,t.default,e.default)}ye.register(kr,{error:[{kind:"error"},[Bt],function(t,e){throw new le(e[0].evaluate(t))}],typeof:[Bt,[jt],function(t,e){return Ht(ne(e[0].evaluate(t)))}],"to-rgba":[Zt(Ot,4),[Ut],function(t,e){return e[0].evaluate(t).toArray()}],rgb:[Ut,[Ot,Ot,Ot],Sr],rgba:[Ut,[Ot,Ot,Ot,Ot],Sr],has:{type:Ft,overloads:[[[Bt],function(t,e){return Tr(e[0].evaluate(t),t.properties())}],[[Bt,Nt],function(t,e){var r=e[1];return Tr(e[0].evaluate(t),r.evaluate(t))}]]},get:{type:jt,overloads:[[[Bt],function(t,e){return Ir(e[0].evaluate(t),t.properties())}],[[Bt,Nt],function(t,e){var r=e[1];return Ir(e[0].evaluate(t),r.evaluate(t))}]]},"feature-state":[jt,[Bt],function(t,e){return Ir(e[0].evaluate(t),t.featureState||{})}],properties:[Nt,[],function(t){return t.properties()}],"geometry-type":[Bt,[],function(t){return t.geometryType()}],id:[jt,[],function(t){return t.id()}],zoom:[Ot,[],function(t){return t.globals.zoom}],"heatmap-density":[Ot,[],function(t){return t.globals.heatmapDensity||0}],"line-progress":[Ot,[],function(t){return t.globals.lineProgress||0}],accumulated:[jt,[],function(t){return void 0===t.globals.accumulated?null:t.globals.accumulated}],"+":[Ot,zr(Ot),function(t,e){for(var r=0,o=0,i=e;o<i.length;o+=1)r+=i[o].evaluate(t);return r}],"*":[Ot,zr(Ot),function(t,e){for(var r=1,o=0,i=e;o<i.length;o+=1)r*=i[o].evaluate(t);return r}],"-":{type:Ot,overloads:[[[Ot,Ot],function(t,e){var r=e[1];return e[0].evaluate(t)-r.evaluate(t)}],[[Ot],function(t,e){return-e[0].evaluate(t)}]]},"/":[Ot,[Ot,Ot],function(t,e){var r=e[1];return e[0].evaluate(t)/r.evaluate(t)}],"%":[Ot,[Ot,Ot],function(t,e){var r=e[1];return e[0].evaluate(t)%r.evaluate(t)}],ln2:[Ot,[],function(){return Math.LN2}],pi:[Ot,[],function(){return Math.PI}],e:[Ot,[],function(){return Math.E}],"^":[Ot,[Ot,Ot],function(t,e){var r=e[1];return Math.pow(e[0].evaluate(t),r.evaluate(t))}],sqrt:[Ot,[Ot],function(t,e){return Math.sqrt(e[0].evaluate(t))}],log10:[Ot,[Ot],function(t,e){return Math.log(e[0].evaluate(t))/Math.LN10}],ln:[Ot,[Ot],function(t,e){return Math.log(e[0].evaluate(t))}],log2:[Ot,[Ot],function(t,e){return Math.log(e[0].evaluate(t))/Math.LN2}],sin:[Ot,[Ot],function(t,e){return Math.sin(e[0].evaluate(t))}],cos:[Ot,[Ot],function(t,e){return Math.cos(e[0].evaluate(t))}],tan:[Ot,[Ot],function(t,e){return Math.tan(e[0].evaluate(t))}],asin:[Ot,[Ot],function(t,e){return Math.asin(e[0].evaluate(t))}],acos:[Ot,[Ot],function(t,e){return Math.acos(e[0].evaluate(t))}],atan:[Ot,[Ot],function(t,e){return Math.atan(e[0].evaluate(t))}],min:[Ot,zr(Ot),function(t,e){return Math.min.apply(Math,e.map((function(e){return e.evaluate(t)})))}],max:[Ot,zr(Ot),function(t,e){return Math.max.apply(Math,e.map((function(e){return e.evaluate(t)})))}],abs:[Ot,[Ot],function(t,e){return Math.abs(e[0].evaluate(t))}],round:[Ot,[Ot],function(t,e){var r=e[0].evaluate(t);return r<0?-Math.round(-r):Math.round(r)}],floor:[Ot,[Ot],function(t,e){return Math.floor(e[0].evaluate(t))}],ceil:[Ot,[Ot],function(t,e){return Math.ceil(e[0].evaluate(t))}],"filter-==":[Ft,[Bt,jt],function(t,e){var r=e[0],o=e[1];return t.properties()[r.value]===o.value}],"filter-id-==":[Ft,[jt],function(t,e){var r=e[0];return t.id()===r.value}],"filter-type-==":[Ft,[Bt],function(t,e){var r=e[0];return t.geometryType()===r.value}],"filter-<":[Ft,[Bt,jt],function(t,e){var r=e[0],o=e[1],i=t.properties()[r.value],a=o.value;return typeof i==typeof a&&i<a}],"filter-id-<":[Ft,[jt],function(t,e){var r=e[0],o=t.id(),i=r.value;return typeof o==typeof i&&o<i}],"filter->":[Ft,[Bt,jt],function(t,e){var r=e[0],o=e[1],i=t.properties()[r.value],a=o.value;return typeof i==typeof a&&i>a}],"filter-id->":[Ft,[jt],function(t,e){var r=e[0],o=t.id(),i=r.value;return typeof o==typeof i&&o>i}],"filter-<=":[Ft,[Bt,jt],function(t,e){var r=e[0],o=e[1],i=t.properties()[r.value],a=o.value;return typeof i==typeof a&&i<=a}],"filter-id-<=":[Ft,[jt],function(t,e){var r=e[0],o=t.id(),i=r.value;return typeof o==typeof i&&o<=i}],"filter->=":[Ft,[Bt,jt],function(t,e){var r=e[0],o=e[1],i=t.properties()[r.value],a=o.value;return typeof i==typeof a&&i>=a}],"filter-id->=":[Ft,[jt],function(t,e){var r=e[0],o=t.id(),i=r.value;return typeof o==typeof i&&o>=i}],"filter-has":[Ft,[jt],function(t,e){return e[0].value in t.properties()}],"filter-has-id":[Ft,[],function(t){return null!==t.id()&&void 0!==t.id()}],"filter-type-in":[Ft,[Zt(Bt)],function(t,e){return e[0].value.indexOf(t.geometryType())>=0}],"filter-id-in":[Ft,[Zt(jt)],function(t,e){return e[0].value.indexOf(t.id())>=0}],"filter-in-small":[Ft,[Bt,Zt(jt)],function(t,e){var r=e[0];return e[1].value.indexOf(t.properties()[r.value])>=0}],"filter-in-large":[Ft,[Bt,Zt(jt)],function(t,e){var r=e[0],o=e[1];return function(t,e,r,o){for(;r<=o;){var i=r+o>>1;if(e[i]===t)return!0;e[i]>t?o=i-1:r=i+1}return!1}(t.properties()[r.value],o.value,0,o.value.length-1)}],all:{type:Ft,overloads:[[[Ft,Ft],function(t,e){var r=e[1];return e[0].evaluate(t)&&r.evaluate(t)}],[zr(Ft),function(t,e){for(var r=0,o=e;r<o.length;r+=1)if(!o[r].evaluate(t))return!1;return!0}]]},any:{type:Ft,overloads:[[[Ft,Ft],function(t,e){var r=e[1];return e[0].evaluate(t)||r.evaluate(t)}],[zr(Ft),function(t,e){for(var r=0,o=e;r<o.length;r+=1)if(o[r].evaluate(t))return!0;return!1}]]},"!":[Ft,[Ft],function(t,e){return!e[0].evaluate(t)}],"is-supported-script":[Ft,[Bt],function(t,e){var r=t.globals&&t.globals.isSupportedScript;return!r||r(e[0].evaluate(t))}],upcase:[Bt,[Bt],function(t,e){return e[0].evaluate(t).toUpperCase()}],downcase:[Bt,[Bt],function(t,e){return e[0].evaluate(t).toLowerCase()}],concat:[Bt,zr(jt),function(t,e){return e.map((function(e){return ae(e.evaluate(t))})).join("")}],"resolved-locale":[Bt,[Vt],function(t,e){return e[0].evaluate(t).resolvedLocale()}]});var Vr=function(t,e){this.expression=t,this._warningHistory={},this._evaluator=new ge,this._defaultValue=e?function(t){return"color"===t.type&&Dr(t.default)?new Yt(0,0,0,0):"color"===t.type?Yt.parse(t.default)||null:void 0===t.default?null:t.default}(e):null,this._enumValues=e&&"enum"===e.type?e.values:null};function qr(t){return Array.isArray(t)&&t.length>0&&"string"==typeof t[0]&&t[0]in kr}function Gr(t,e){var r=new Ue(kr,[],e?function(t){var e={color:Ut,string:Bt,number:Ot,enum:Bt,boolean:Ft,formatted:qt,resolvedImage:Gt};return"array"===t.type?Zt(e[t.value]||jt,t.length):e[t.type]}(e):void 0),o=r.parse(t,void 0,void 0,void 0,e&&"string"===e.type?{typeAnnotation:"coerce"}:void 0);return o?Cr(new Vr(o,e)):Pr(r.errors)}Vr.prototype.evaluateWithoutErrorHandling=function(t,e,r,o,i,a){return this._evaluator.globals=t,this._evaluator.feature=e,this._evaluator.featureState=r,this._evaluator.canonical=o,this._evaluator.availableImages=i||null,this._evaluator.formattedSection=a,this.expression.evaluate(this._evaluator)},Vr.prototype.evaluate=function(t,e,r,o,i,a){this._evaluator.globals=t,this._evaluator.feature=e||null,this._evaluator.featureState=r||null,this._evaluator.canonical=o,this._evaluator.availableImages=i||null,this._evaluator.formattedSection=a||null;try{var n=this.expression.evaluate(this._evaluator);if(null==n||"number"==typeof n&&n!=n)return this._defaultValue;if(this._enumValues&&!(n in this._enumValues))throw new le("Expected value to be one of "+Object.keys(this._enumValues).map((function(t){return JSON.stringify(t)})).join(", ")+", but found "+JSON.stringify(n)+" instead.");return n}catch(t){return this._warningHistory[t.message]||(this._warningHistory[t.message]=!0,"undefined"!=typeof console&&console.warn(t.message)),this._defaultValue}};var Zr=function(t,e){this.kind=t,this._styleExpression=e,this.isStateDependent="constant"!==t&&!Oe(e.expression)};Zr.prototype.evaluateWithoutErrorHandling=function(t,e,r,o,i,a){return this._styleExpression.evaluateWithoutErrorHandling(t,e,r,o,i,a)},Zr.prototype.evaluate=function(t,e,r,o,i,a){return this._styleExpression.evaluate(t,e,r,o,i,a)};var Hr=function(t,e,r,o){this.kind=t,this.zoomStops=r,this._styleExpression=e,this.isStateDependent="camera"!==t&&!Oe(e.expression),this.interpolationType=o};function Kr(t,e){if("error"===(t=Gr(t,e)).result)return t;var r=t.value.expression,o=De(r);if(!o&&!Ar(e))return Pr([new Lt("","data expressions not supported")]);var i=Be(r,["zoom"]);if(!i&&!Mr(e))return Pr([new Lt("","zoom expressions not supported")]);var a=function t(e){var r=null;if(e instanceof ar)r=t(e.result);else if(e instanceof nr)for(var o=0,i=e.args;o<i.length&&!(r=t(i[o]));o+=1);else(e instanceof je||e instanceof ir)&&e.input instanceof ye&&"zoom"===e.input.name&&(r=e);return r instanceof Lt||e.eachChild((function(e){var o=t(e);o instanceof Lt?r=o:!r&&o?r=new Lt("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.'):r&&o&&r!==o&&(r=new Lt("",'Only one zoom-based "step" or "interpolate" subexpression may be used in an expression.'))})),r}(r);return a||i?a instanceof Lt?Pr([a]):a instanceof ir&&!Lr(e)?Pr([new Lt("",'"interpolate" expressions cannot be used with this property')]):Cr(a?new Hr(o?"camera":"composite",t.value,a.labels,a instanceof ir?a.interpolation:void 0):new Zr(o?"constant":"source",t.value)):Pr([new Lt("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.')])}Hr.prototype.evaluateWithoutErrorHandling=function(t,e,r,o,i,a){return this._styleExpression.evaluateWithoutErrorHandling(t,e,r,o,i,a)},Hr.prototype.evaluate=function(t,e,r,o,i,a){return this._styleExpression.evaluate(t,e,r,o,i,a)},Hr.prototype.interpolationFactor=function(t,e,r){return this.interpolationType?ir.interpolationFactor(this.interpolationType,t,e,r):0};var Wr=function(t,e){this._parameters=t,this._specification=e,Pt(this,function t(e,r){var o,i,a,n="color"===r.type,s=e.stops&&"object"==typeof e.stops[0][0],u=s||!(s||void 0!==e.property),l=e.type||(Lr(r)?"exponential":"interval");if(n&&((e=Pt({},e)).stops&&(e.stops=e.stops.map((function(t){return[t[0],Yt.parse(t[1])]}))),e.default=Yt.parse(e.default?e.default:r.default)),e.colorSpace&&"rgb"!==e.colorSpace&&!rr[e.colorSpace])throw new Error("Unknown color space: "+e.colorSpace);if("exponential"===l)o=Nr;else if("interval"===l)o=Ur;else if("categorical"===l){o=Fr,i=Object.create(null);for(var p=0,c=e.stops;p<c.length;p+=1){var h=c[p];i[h[0]]=h[1]}a=typeof e.stops[0][0]}else{if("identity"!==l)throw new Error('Unknown function type "'+l+'"');o=jr}if(s){for(var d={},f=[],m=0;m<e.stops.length;m++){var y=e.stops[m],v=y[0].zoom;void 0===d[v]&&(d[v]={zoom:v,type:e.type,property:e.property,default:e.default,stops:[]},f.push(v)),d[v].stops.push([y[0].value,y[1]])}for(var g=[],_=0,b=f;_<b.length;_+=1){var x=b[_];g.push([d[x].zoom,t(d[x],r)])}var w={name:"linear"};return{kind:"composite",interpolationType:w,interpolationFactor:ir.interpolationFactor.bind(void 0,w),zoomStops:g.map((function(t){return t[0]})),evaluate:function(t,o){var i=t.zoom;return Nr({stops:g,base:e.base},r,i).evaluate(i,o)}}}if(u){var E="exponential"===l?{name:"exponential",base:void 0!==e.base?e.base:1}:null;return{kind:"camera",interpolationType:E,interpolationFactor:ir.interpolationFactor.bind(void 0,E),zoomStops:e.stops.map((function(t){return t[0]})),evaluate:function(t){return o(e,r,t.zoom,i,a)}}}return{kind:"source",evaluate:function(t,n){var s=n&&n.properties?n.properties[e.property]:void 0;return void 0===s?Br(e.default,r.default):o(e,r,s,i,a)}}}(this._parameters,this._specification))};function Xr(t){var e=t.key,r=t.value,o=t.valueSpec||{},i=t.objectElementValidators||{},a=t.style,n=t.styleSpec,s=[],u=Rr(r);if("object"!==u)return[new zt(e,r,"object expected, "+u+" found")];for(var l in r){var p=l.split(".")[0],c=o[p]||o["*"],h=void 0;if(i[p])h=i[p];else if(o[p])h=bi;else if(i["*"])h=i["*"];else{if(!o["*"]){s.push(new zt(e,r[l],'unknown property "'+l+'"'));continue}h=bi}s=s.concat(h({key:(e?e+".":e)+l,value:r[l],valueSpec:c,style:a,styleSpec:n,object:r,objectKey:l},r))}for(var d in o)i[d]||o[d].required&&void 0===o[d].default&&void 0===r[d]&&s.push(new zt(e,r,'missing required property "'+d+'"'));return s}function $r(t){var e=t.value,r=t.valueSpec,o=t.style,i=t.styleSpec,a=t.key,n=t.arrayElementValidator||bi;if("array"!==Rr(e))return[new zt(a,e,"array expected, "+Rr(e)+" found")];if(r.length&&e.length!==r.length)return[new zt(a,e,"array length "+r.length+" expected, length "+e.length+" found")];if(r["min-length"]&&e.length<r["min-length"])return[new zt(a,e,"array length at least "+r["min-length"]+" expected, length "+e.length+" found")];var s={type:r.value,values:r.values};i.$version<7&&(s.function=r.function),"object"===Rr(r.value)&&(s=r.value);for(var u=[],l=0;l<e.length;l++)u=u.concat(n({array:e,arrayIndex:l,value:e[l],valueSpec:s,style:o,styleSpec:i,key:a+"["+l+"]"}));return u}function Jr(t){var e=t.key,r=t.value,o=t.valueSpec,i=Rr(r);return"number"===i&&r!=r&&(i="NaN"),"number"!==i?[new zt(e,r,"number expected, "+i+" found")]:"minimum"in o&&r<o.minimum?[new zt(e,r,r+" is less than the minimum value "+o.minimum)]:"maximum"in o&&r>o.maximum?[new zt(e,r,r+" is greater than the maximum value "+o.maximum)]:[]}function Yr(t){var e,r,o,i=t.valueSpec,a=At(t.value.type),n={},s="categorical"!==a&&void 0===t.value.property,u=!s,l="array"===Rr(t.value.stops)&&"array"===Rr(t.value.stops[0])&&"object"===Rr(t.value.stops[0][0]),p=Xr({key:t.key,value:t.value,valueSpec:t.styleSpec.function,style:t.style,styleSpec:t.styleSpec,objectElementValidators:{stops:function(t){if("identity"===a)return[new zt(t.key,t.value,'identity function may not have a "stops" property')];var e=[],r=t.value;return e=e.concat($r({key:t.key,value:r,valueSpec:t.valueSpec,style:t.style,styleSpec:t.styleSpec,arrayElementValidator:c})),"array"===Rr(r)&&0===r.length&&e.push(new zt(t.key,r,"array must have at least one stop")),e},default:function(t){return bi({key:t.key,value:t.value,valueSpec:i,style:t.style,styleSpec:t.styleSpec})}}});return"identity"===a&&s&&p.push(new zt(t.key,t.value,'missing required property "property"')),"identity"===a||t.value.stops||p.push(new zt(t.key,t.value,'missing required property "stops"')),"exponential"===a&&t.valueSpec.expression&&!Lr(t.valueSpec)&&p.push(new zt(t.key,t.value,"exponential functions not supported")),t.styleSpec.$version>=8&&(u&&!Ar(t.valueSpec)?p.push(new zt(t.key,t.value,"property functions not supported")):s&&!Mr(t.valueSpec)&&p.push(new zt(t.key,t.value,"zoom functions not supported"))),"categorical"!==a&&!l||void 0!==t.value.property||p.push(new zt(t.key,t.value,'"property" property is required')),p;function c(t){var e=[],a=t.value,s=t.key;if("array"!==Rr(a))return[new zt(s,a,"array expected, "+Rr(a)+" found")];if(2!==a.length)return[new zt(s,a,"array length 2 expected, length "+a.length+" found")];if(l){if("object"!==Rr(a[0]))return[new zt(s,a,"object expected, "+Rr(a[0])+" found")];if(void 0===a[0].zoom)return[new zt(s,a,"object stop key must have zoom")];if(void 0===a[0].value)return[new zt(s,a,"object stop key must have value")];if(o&&o>At(a[0].zoom))return[new zt(s,a[0].zoom,"stop zoom values must appear in ascending order")];At(a[0].zoom)!==o&&(o=At(a[0].zoom),r=void 0,n={}),e=e.concat(Xr({key:s+"[0]",value:a[0],valueSpec:{zoom:{}},style:t.style,styleSpec:t.styleSpec,objectElementValidators:{zoom:Jr,value:h}}))}else e=e.concat(h({key:s+"[0]",value:a[0],valueSpec:{},style:t.style,styleSpec:t.styleSpec},a));return qr(Mt(a[1]))?e.concat([new zt(s+"[1]",a[1],"expressions are not allowed in function stops.")]):e.concat(bi({key:s+"[1]",value:a[1],valueSpec:i,style:t.style,styleSpec:t.styleSpec}))}function h(t,o){var s=Rr(t.value),u=At(t.value),l=null!==t.value?t.value:o;if(e){if(s!==e)return[new zt(t.key,l,s+" stop domain type must match previous stop domain type "+e)]}else e=s;if("number"!==s&&"string"!==s&&"boolean"!==s)return[new zt(t.key,l,"stop domain value must be a number, string, or boolean")];if("number"!==s&&"categorical"!==a){var p="number expected, "+s+" found";return Ar(i)&&void 0===a&&(p+='\nIf you intended to use a categorical function, specify `"type": "categorical"`.'),[new zt(t.key,l,p)]}return"categorical"!==a||"number"!==s||isFinite(u)&&Math.floor(u)===u?"categorical"!==a&&"number"===s&&void 0!==r&&u<r?[new zt(t.key,l,"stop domain values must appear in ascending order")]:(r=u,"categorical"===a&&u in n?[new zt(t.key,l,"stop domain values must be unique")]:(n[u]=!0,[])):[new zt(t.key,l,"integer expected, found "+u)]}}function Qr(t){var e=("property"===t.expressionContext?Kr:Gr)(Mt(t.value),t.valueSpec);if("error"===e.result)return e.value.map((function(e){return new zt(""+t.key+e.key,t.value,e.message)}));var r=e.value.expression||e.value._styleExpression.expression;if("property"===t.expressionContext&&"text-font"===t.propertyKey&&!r.outputDefined())return[new zt(t.key,t.value,'Invalid data expression for "'+t.propertyKey+'". Output values must be contained as literals within the expression.')];if("property"===t.expressionContext&&"layout"===t.propertyType&&!Oe(r))return[new zt(t.key,t.value,'"feature-state" data expressions are not supported with layout properties.')];if("filter"===t.expressionContext&&!Oe(r))return[new zt(t.key,t.value,'"feature-state" data expressions are not supported with filters.')];if(t.expressionContext&&0===t.expressionContext.indexOf("cluster")){if(!Be(r,["zoom","feature-state"]))return[new zt(t.key,t.value,'"zoom" and "feature-state" expressions are not supported with cluster properties.')];if("cluster-initial"===t.expressionContext&&!De(r))return[new zt(t.key,t.value,"Feature data expressions are not supported with initial expression part of cluster properties.")]}return[]}function ti(t){var e=t.key,r=t.value,o=t.valueSpec,i=[];return Array.isArray(o.values)?-1===o.values.indexOf(At(r))&&i.push(new zt(e,r,"expected one of ["+o.values.join(", ")+"], "+JSON.stringify(r)+" found")):-1===Object.keys(o.values).indexOf(At(r))&&i.push(new zt(e,r,"expected one of ["+Object.keys(o.values).join(", ")+"], "+JSON.stringify(r)+" found")),i}function ei(t){if(!0===t||!1===t)return!0;if(!Array.isArray(t)||0===t.length)return!1;switch(t[0]){case"has":return t.length>=2&&"$id"!==t[1]&&"$type"!==t[1];case"in":return t.length>=3&&("string"!=typeof t[1]||Array.isArray(t[2]));case"!in":case"!has":case"none":return!1;case"==":case"!=":case">":case">=":case"<":case"<=":return 3!==t.length||Array.isArray(t[1])||Array.isArray(t[2]);case"any":case"all":for(var e=0,r=t.slice(1);e<r.length;e+=1){var o=r[e];if(!ei(o)&&"boolean"!=typeof o)return!1}return!0;default:return!0}}Wr.deserialize=function(t){return new Wr(t._parameters,t._specification)},Wr.serialize=function(t){return{_parameters:t._parameters,_specification:t._specification}};var ri={type:"boolean",default:!1,transition:!1,"property-type":"data-driven",expression:{interpolated:!1,parameters:["zoom","feature"]}};function ii(t){if(null==t)return{filter:function(){return!0},needGeometry:!1};ei(t)||(t=ni(t));var e=Gr(t,ri);if("error"===e.result)throw new Error(e.value.map((function(t){return t.key+": "+t.message})).join(", "));return{filter:function(t,r,o){return e.value.evaluate(t,r,{},o)},needGeometry:function t(e){if(!Array.isArray(e))return!1;if("within"===e[0])return!0;for(var r=1;r<e.length;r++)if(t(e[r]))return!0;return!1}(t)}}function oi(t,e){return t<e?-1:t>e?1:0}function ni(t){if(!t)return!0;var e,r=t[0];return t.length<=1?"any"!==r:"=="===r?ai(t[1],t[2],"=="):"!="===r?ci(ai(t[1],t[2],"==")):"<"===r||">"===r||"<="===r||">="===r?ai(t[1],t[2],r):"any"===r?(e=t.slice(1),["any"].concat(e.map(ni))):"all"===r?["all"].concat(t.slice(1).map(ni)):"none"===r?["all"].concat(t.slice(1).map(ni).map(ci)):"in"===r?si(t[1],t.slice(2)):"!in"===r?ci(si(t[1],t.slice(2))):"has"===r?ui(t[1]):"!has"===r?ci(ui(t[1])):"within"!==r||t}function ai(t,e,r){switch(t){case"$type":return["filter-type-"+r,e];case"$id":return["filter-id-"+r,e];default:return["filter-"+r,t,e]}}function si(t,e){if(0===e.length)return!1;switch(t){case"$type":return["filter-type-in",["literal",e]];case"$id":return["filter-id-in",["literal",e]];default:return e.length>200&&!e.some((function(t){return typeof t!=typeof e[0]}))?["filter-in-large",t,["literal",e.sort(oi)]]:["filter-in-small",t,["literal",e]]}}function ui(t){switch(t){case"$type":return!0;case"$id":return["filter-has-id"];default:return["filter-has",t]}}function ci(t){return["!",t]}function pi(t){return ei(Mt(t.value))?Qr(Pt({},t,{expressionContext:"filter",valueSpec:{value:"boolean"}})):function t(e){var r=e.value,o=e.key;if("array"!==Rr(r))return[new zt(o,r,"array expected, "+Rr(r)+" found")];var i,a=e.styleSpec,n=[];if(r.length<1)return[new zt(o,r,"filter array must have at least 1 element")];switch(n=n.concat(ti({key:o+"[0]",value:r[0],valueSpec:a.filter_operator,style:e.style,styleSpec:e.styleSpec})),At(r[0])){case"<":case"<=":case">":case">=":r.length>=2&&"$type"===At(r[1])&&n.push(new zt(o,r,'"$type" cannot be use with operator "'+r[0]+'"'));case"==":case"!=":3!==r.length&&n.push(new zt(o,r,'filter array for operator "'+r[0]+'" must have 3 elements'));case"in":case"!in":r.length>=2&&"string"!==(i=Rr(r[1]))&&n.push(new zt(o+"[1]",r[1],"string expected, "+i+" found"));for(var s=2;s<r.length;s++)i=Rr(r[s]),"$type"===At(r[1])?n=n.concat(ti({key:o+"["+s+"]",value:r[s],valueSpec:a.geometry_type,style:e.style,styleSpec:e.styleSpec})):"string"!==i&&"number"!==i&&"boolean"!==i&&n.push(new zt(o+"["+s+"]",r[s],"string, number, or boolean expected, "+i+" found"));break;case"any":case"all":case"none":for(var u=1;u<r.length;u++)n=n.concat(t({key:o+"["+u+"]",value:r[u],style:e.style,styleSpec:e.styleSpec}));break;case"has":case"!has":i=Rr(r[1]),2!==r.length?n.push(new zt(o,r,'filter array for "'+r[0]+'" operator must have 2 elements')):"string"!==i&&n.push(new zt(o+"[1]",r[1],"string expected, "+i+" found"));break;case"within":i=Rr(r[1]),2!==r.length?n.push(new zt(o,r,'filter array for "'+r[0]+'" operator must have 2 elements')):"object"!==i&&n.push(new zt(o+"[1]",r[1],"object expected, "+i+" found"))}return n}(t)}function hi(t,e){var r=t.key,o=t.style,i=t.styleSpec,a=t.value,n=t.objectKey,s=i[e+"_"+t.layerType];if(!s)return[];var u=n.match(/^(.*)-transition$/);if("paint"===e&&u&&s[u[1]]&&s[u[1]].transition)return bi({key:r,value:a,valueSpec:i.transition,style:o,styleSpec:i});var l,p=t.valueSpec||s[n];if(!p)return[new zt(r,a,'unknown property "'+n+'"')];if("string"===Rr(a)&&Ar(p)&&!p.tokens&&(l=/^{([^}]+)}$/.exec(a)))return[new zt(r,a,'"'+n+'" does not support interpolation syntax\nUse an identity property function instead: `{ "type": "identity", "property": '+JSON.stringify(l[1])+" }`.")];var c=[];return"symbol"===t.layerType&&("text-field"===n&&o&&!o.glyphs&&c.push(new zt(r,a,'use of "text-field" requires a style "glyphs" property')),"text-font"===n&&Dr(Mt(a))&&"identity"===At(a.type)&&c.push(new zt(r,a,'"text-font" does not support identity functions'))),c.concat(bi({key:t.key,value:a,valueSpec:p,style:o,styleSpec:i,expressionContext:"property",propertyType:e,propertyKey:n}))}function di(t){return hi(t,"paint")}function fi(t){return hi(t,"layout")}function mi(t){var e=[],r=t.value,o=t.key,i=t.style,a=t.styleSpec;r.type||r.ref||e.push(new zt(o,r,'either "type" or "ref" is required'));var n,s=At(r.type),u=At(r.ref);if(r.id)for(var l=At(r.id),p=0;p<t.arrayIndex;p++){var c=i.layers[p];At(c.id)===l&&e.push(new zt(o,r.id,'duplicate layer id "'+r.id+'", previously used at line '+c.id.__line__))}if("ref"in r)["type","source","source-layer","filter","layout"].forEach((function(t){t in r&&e.push(new zt(o,r[t],'"'+t+'" is prohibited for ref layers'))})),i.layers.forEach((function(t){At(t.id)===u&&(n=t)})),n?n.ref?e.push(new zt(o,r.ref,"ref cannot reference another ref layer")):s=At(n.type):e.push(new zt(o,r.ref,'ref layer "'+u+'" not found'));else if("background"!==s)if(r.source){var h=i.sources&&i.sources[r.source],d=h&&At(h.type);h?"vector"===d&&"raster"===s?e.push(new zt(o,r.source,'layer "'+r.id+'" requires a raster source')):"raster"===d&&"raster"!==s?e.push(new zt(o,r.source,'layer "'+r.id+'" requires a vector source')):"vector"!==d||r["source-layer"]?"raster-dem"===d&&"hillshade"!==s?e.push(new zt(o,r.source,"raster-dem source can only be used with layer type 'hillshade'.")):"line"!==s||!r.paint||!r.paint["line-gradient"]||"geojson"===d&&h.lineMetrics||e.push(new zt(o,r,'layer "'+r.id+'" specifies a line-gradient, which requires a GeoJSON source with `lineMetrics` enabled.')):e.push(new zt(o,r,'layer "'+r.id+'" must specify a "source-layer"')):e.push(new zt(o,r.source,'source "'+r.source+'" not found'))}else e.push(new zt(o,r,'missing required property "source"'));return e=e.concat(Xr({key:o,value:r,valueSpec:a.layer,style:t.style,styleSpec:t.styleSpec,objectElementValidators:{"*":function(){return[]},type:function(){return bi({key:o+".type",value:r.type,valueSpec:a.layer.type,style:t.style,styleSpec:t.styleSpec,object:r,objectKey:"type"})},filter:pi,layout:function(t){return Xr({layer:r,key:t.key,value:t.value,style:t.style,styleSpec:t.styleSpec,objectElementValidators:{"*":function(t){return fi(Pt({layerType:s},t))}}})},paint:function(t){return Xr({layer:r,key:t.key,value:t.value,style:t.style,styleSpec:t.styleSpec,objectElementValidators:{"*":function(t){return di(Pt({layerType:s},t))}}})}}}))}function gi(t){var e=t.value,r=t.key,o=Rr(e);return"string"!==o?[new zt(r,e,"string expected, "+o+" found")]:[]}var yi={promoteId:function(t){var e=t.key,r=t.value;if("string"===Rr(r))return gi({key:e,value:r});var o=[];for(var i in r)o.push.apply(o,gi({key:e+"."+i,value:r[i]}));return o}};function vi(t){var e=t.value,r=t.key,o=t.styleSpec,i=t.style;if(!e.type)return[new zt(r,e,'"type" is required')];var a,n=At(e.type);switch(n){case"vector":case"raster":case"raster-dem":return Xr({key:r,value:e,valueSpec:o["source_"+n.replace("-","_")],style:t.style,styleSpec:o,objectElementValidators:yi});case"geojson":if(a=Xr({key:r,value:e,valueSpec:o.source_geojson,style:i,styleSpec:o,objectElementValidators:yi}),e.cluster)for(var s in e.clusterProperties){var u=e.clusterProperties[s],l=u[0],p="string"==typeof l?[l,["accumulated"],["get",s]]:l;a.push.apply(a,Qr({key:r+"."+s+".map",value:u[1],expressionContext:"cluster-map"})),a.push.apply(a,Qr({key:r+"."+s+".reduce",value:p,expressionContext:"cluster-reduce"}))}return a;case"video":return Xr({key:r,value:e,valueSpec:o.source_video,style:i,styleSpec:o});case"image":return Xr({key:r,value:e,valueSpec:o.source_image,style:i,styleSpec:o});case"canvas":return[new zt(r,null,"Please use runtime APIs to add canvas sources, rather than including them in stylesheets.","source.canvas")];default:return ti({key:r+".type",value:e.type,valueSpec:{values:["vector","raster","raster-dem","geojson","video","image"]},style:i,styleSpec:o})}}function _i(t){var e=t.value,r=t.styleSpec,o=r.light,i=t.style,a=[],n=Rr(e);if(void 0===e)return a;if("object"!==n)return a.concat([new zt("light",e,"object expected, "+n+" found")]);for(var s in e){var u=s.match(/^(.*)-transition$/);a=a.concat(u&&o[u[1]]&&o[u[1]].transition?bi({key:s,value:e[s],valueSpec:r.transition,style:i,styleSpec:r}):o[s]?bi({key:s,value:e[s],valueSpec:o[s],style:i,styleSpec:r}):[new zt(s,e[s],'unknown property "'+s+'"')])}return a}var xi={"*":function(){return[]},array:$r,boolean:function(t){var e=t.value,r=t.key,o=Rr(e);return"boolean"!==o?[new zt(r,e,"boolean expected, "+o+" found")]:[]},number:Jr,color:function(t){var e=t.key,r=t.value,o=Rr(r);return"string"!==o?[new zt(e,r,"color expected, "+o+" found")]:null===Jt(r)?[new zt(e,r,'color expected, "'+r+'" found')]:[]},constants:Ct,enum:ti,filter:pi,function:Yr,layer:mi,object:Xr,source:vi,light:_i,string:gi,formatted:function(t){return 0===gi(t).length?[]:Qr(t)},resolvedImage:function(t){return 0===gi(t).length?[]:Qr(t)}};function bi(t){var e=t.value,r=t.valueSpec,o=t.styleSpec;return r.expression&&Dr(At(e))?Yr(t):r.expression&&qr(Mt(e))?Qr(t):r.type&&xi[r.type]?xi[r.type](t):Xr(Pt({},t,{valueSpec:r.type?o[r.type]:r}))}function wi(t){var e=t.value,r=t.key,o=gi(t);return o.length||(-1===e.indexOf("{fontstack}")&&o.push(new zt(r,e,'"glyphs" url must include a "{fontstack}" token')),-1===e.indexOf("{range}")&&o.push(new zt(r,e,'"glyphs" url must include a "{range}" token'))),o}function Ei(t,e){void 0===e&&(e=It);var r=[];return r=r.concat(bi({key:"",value:t,valueSpec:e.$root,styleSpec:e,style:t,objectElementValidators:{glyphs:wi,"*":function(){return[]}}})),t.constants&&(r=r.concat(Ct({key:"constants",value:t.constants,style:t,styleSpec:e}))),ki(r)}function ki(t){return[].concat(t).sort((function(t,e){return t.line-e.line}))}function Si(t){return function(){for(var e=[],r=arguments.length;r--;)e[r]=arguments[r];return ki(t.apply(this,e))}}Ei.source=Si(vi),Ei.light=Si(_i),Ei.layer=Si(mi),Ei.filter=Si(pi),Ei.paintProperty=Si(di),Ei.layoutProperty=Si(fi);var Ti=Ei,Ii=Ti.light,zi=Ti.paintProperty,Ci=Ti.layoutProperty;function Pi(t,e){var r=!1;if(e&&e.length)for(var o=0,i=e;o<i.length;o+=1)t.fire(new St(new Error(i[o].message))),r=!0;return r}var Ai=Mi;function Mi(t,e,r){var o=this.cells=[];if(t instanceof ArrayBuffer){this.arrayBuffer=t;var i=new Int32Array(this.arrayBuffer);t=i[0],this.d=(e=i[1])+2*(r=i[2]);for(var a=0;a<this.d*this.d;a++){var n=i[3+a],s=i[3+a+1];o.push(n===s?null:i.subarray(n,s))}var u=i[3+o.length+1];this.keys=i.subarray(i[3+o.length],u),this.bboxes=i.subarray(u),this.insert=this._insertReadonly}else{this.d=e+2*r;for(var l=0;l<this.d*this.d;l++)o.push([]);this.keys=[],this.bboxes=[]}this.n=e,this.extent=t,this.padding=r,this.scale=e/t,this.uid=0;var p=r/e*t;this.min=-p,this.max=t+p}Mi.prototype.insert=function(t,e,r,o,i){this._forEachCell(e,r,o,i,this._insertCell,this.uid++),this.keys.push(t),this.bboxes.push(e),this.bboxes.push(r),this.bboxes.push(o),this.bboxes.push(i)},Mi.prototype._insertReadonly=function(){throw"Cannot insert into a GridIndex created from an ArrayBuffer."},Mi.prototype._insertCell=function(t,e,r,o,i,a){this.cells[i].push(a)},Mi.prototype.query=function(t,e,r,o,i){var a=this.min,n=this.max;if(t<=a&&e<=a&&n<=r&&n<=o&&!i)return Array.prototype.slice.call(this.keys);var s=[];return this._forEachCell(t,e,r,o,this._queryCell,s,{},i),s},Mi.prototype._queryCell=function(t,e,r,o,i,a,n,s){var u=this.cells[i];if(null!==u)for(var l=this.keys,p=this.bboxes,c=0;c<u.length;c++){var h=u[c];if(void 0===n[h]){var d=4*h;(s?s(p[d+0],p[d+1],p[d+2],p[d+3]):t<=p[d+2]&&e<=p[d+3]&&r>=p[d+0]&&o>=p[d+1])?(n[h]=!0,a.push(l[h])):n[h]=!1}}},Mi.prototype._forEachCell=function(t,e,r,o,i,a,n,s){for(var u=this._convertToCellCoord(t),l=this._convertToCellCoord(e),p=this._convertToCellCoord(r),c=this._convertToCellCoord(o),h=u;h<=p;h++)for(var d=l;d<=c;d++){var f=this.d*d+h;if((!s||s(this._convertFromCellCoord(h),this._convertFromCellCoord(d),this._convertFromCellCoord(h+1),this._convertFromCellCoord(d+1)))&&i.call(this,t,e,r,o,f,a,n,s))return}},Mi.prototype._convertFromCellCoord=function(t){return(t-this.padding)/this.scale},Mi.prototype._convertToCellCoord=function(t){return Math.max(0,Math.min(this.d-1,Math.floor(t*this.scale)+this.padding))},Mi.prototype.toArrayBuffer=function(){if(this.arrayBuffer)return this.arrayBuffer;for(var t=this.cells,e=3+this.cells.length+1+1,r=0,o=0;o<this.cells.length;o++)r+=this.cells[o].length;var i=new Int32Array(e+r+this.keys.length+this.bboxes.length);i[0]=this.extent,i[1]=this.n,i[2]=this.padding;for(var a=e,n=0;n<t.length;n++){var s=t[n];i[3+n]=a,i.set(s,a),a+=s.length}return i[3+t.length]=a,i.set(this.keys,a),i[3+t.length+1]=a+=this.keys.length,i.set(this.bboxes,a),a+=this.bboxes.length,i.buffer};var Li=n.ImageData,Ri=n.ImageBitmap,Di={};function Oi(t,e,r){void 0===r&&(r={}),Object.defineProperty(e,"_classRegistryKey",{value:t,writeable:!1}),Di[t]={klass:e,omit:r.omit||[],shallow:r.shallow||[]}}for(var Bi in Oi("Object",Object),Ai.serialize=function(t,e){var r=t.toArrayBuffer();return e&&e.push(r),{buffer:r}},Ai.deserialize=function(t){return new Ai(t.buffer)},Oi("Grid",Ai),Oi("Color",Yt),Oi("Error",Error),Oi("ResolvedImage",re),Oi("StylePropertyFunction",Wr),Oi("StyleExpression",Vr,{omit:["_evaluator"]}),Oi("ZoomDependentExpression",Hr),Oi("ZoomConstantExpression",Zr),Oi("CompoundExpression",ye,{omit:["_evaluate"]}),kr)kr[Bi]._classRegistryKey||Oi("Expression_"+Bi,kr[Bi]);function Fi(t){return t&&"undefined"!=typeof ArrayBuffer&&(t instanceof ArrayBuffer||t.constructor&&"ArrayBuffer"===t.constructor.name)}function Ui(t){return Ri&&t instanceof Ri}function Ni(t,e){if(null==t||"boolean"==typeof t||"number"==typeof t||"string"==typeof t||t instanceof Boolean||t instanceof Number||t instanceof String||t instanceof Date||t instanceof RegExp)return t;if(Fi(t)||Ui(t))return e&&e.push(t),t;if(ArrayBuffer.isView(t)){var r=t;return e&&e.push(r.buffer),r}if(t instanceof Li)return e&&e.push(t.data.buffer),t;if(Array.isArray(t)){for(var o=[],i=0,a=t;i<a.length;i+=1)o.push(Ni(a[i],e));return o}if("object"==typeof t){var n=t.constructor,s=n._classRegistryKey;if(!s)throw new Error("can't serialize object of unregistered class");var u=n.serialize?n.serialize(t,e):{};if(!n.serialize){for(var l in t)if(t.hasOwnProperty(l)&&!(Di[s].omit.indexOf(l)>=0)){var p=t[l];u[l]=Di[s].shallow.indexOf(l)>=0?p:Ni(p,e)}t instanceof Error&&(u.message=t.message)}if(u.$name)throw new Error("$name property is reserved for worker serialization logic.");return"Object"!==s&&(u.$name=s),u}throw new Error("can't serialize object of type "+typeof t)}function ji(t){if(null==t||"boolean"==typeof t||"number"==typeof t||"string"==typeof t||t instanceof Boolean||t instanceof Number||t instanceof String||t instanceof Date||t instanceof RegExp||Fi(t)||Ui(t)||ArrayBuffer.isView(t)||t instanceof Li)return t;if(Array.isArray(t))return t.map(ji);if("object"==typeof t){var e=t.$name||"Object",r=Di[e].klass;if(!r)throw new Error("can't deserialize unregistered class "+e);if(r.deserialize)return r.deserialize(t);for(var o=Object.create(r.prototype),i=0,a=Object.keys(t);i<a.length;i+=1){var n=a[i];if("$name"!==n){var s=t[n];o[n]=Di[e].shallow.indexOf(n)>=0?s:ji(s)}}return o}throw new Error("can't deserialize object of type "+typeof t)}var Vi=function(){this.first=!0};Vi.prototype.update=function(t,e){var r=Math.floor(t);return this.first?(this.first=!1,this.lastIntegerZoom=r,this.lastIntegerZoomTime=0,this.lastZoom=t,this.lastFloorZoom=r,!0):(this.lastFloorZoom>r?(this.lastIntegerZoom=r+1,this.lastIntegerZoomTime=e):this.lastFloorZoom<r&&(this.lastIntegerZoom=r,this.lastIntegerZoomTime=e),t!==this.lastZoom&&(this.lastZoom=t,this.lastFloorZoom=r,!0))};var qi={"Latin-1 Supplement":function(t){return t>=128&&t<=255},Arabic:function(t){return t>=1536&&t<=1791},"Arabic Supplement":function(t){return t>=1872&&t<=1919},"Arabic Extended-A":function(t){return t>=2208&&t<=2303},"Hangul Jamo":function(t){return t>=4352&&t<=4607},"Unified Canadian Aboriginal Syllabics":function(t){return t>=5120&&t<=5759},Khmer:function(t){return t>=6016&&t<=6143},"Unified Canadian Aboriginal Syllabics Extended":function(t){return t>=6320&&t<=6399},"General Punctuation":function(t){return t>=8192&&t<=8303},"Letterlike Symbols":function(t){return t>=8448&&t<=8527},"Number Forms":function(t){return t>=8528&&t<=8591},"Miscellaneous Technical":function(t){return t>=8960&&t<=9215},"Control Pictures":function(t){return t>=9216&&t<=9279},"Optical Character Recognition":function(t){return t>=9280&&t<=9311},"Enclosed Alphanumerics":function(t){return t>=9312&&t<=9471},"Geometric Shapes":function(t){return t>=9632&&t<=9727},"Miscellaneous Symbols":function(t){return t>=9728&&t<=9983},"Miscellaneous Symbols and Arrows":function(t){return t>=11008&&t<=11263},"CJK Radicals Supplement":function(t){return t>=11904&&t<=12031},"Kangxi Radicals":function(t){return t>=12032&&t<=12255},"Ideographic Description Characters":function(t){return t>=12272&&t<=12287},"CJK Symbols and Punctuation":function(t){return t>=12288&&t<=12351},Hiragana:function(t){return t>=12352&&t<=12447},Katakana:function(t){return t>=12448&&t<=12543},Bopomofo:function(t){return t>=12544&&t<=12591},"Hangul Compatibility Jamo":function(t){return t>=12592&&t<=12687},Kanbun:function(t){return t>=12688&&t<=12703},"Bopomofo Extended":function(t){return t>=12704&&t<=12735},"CJK Strokes":function(t){return t>=12736&&t<=12783},"Katakana Phonetic Extensions":function(t){return t>=12784&&t<=12799},"Enclosed CJK Letters and Months":function(t){return t>=12800&&t<=13055},"CJK Compatibility":function(t){return t>=13056&&t<=13311},"CJK Unified Ideographs Extension A":function(t){return t>=13312&&t<=19903},"Yijing Hexagram Symbols":function(t){return t>=19904&&t<=19967},"CJK Unified Ideographs":function(t){return t>=19968&&t<=40959},"Yi Syllables":function(t){return t>=40960&&t<=42127},"Yi Radicals":function(t){return t>=42128&&t<=42191},"Hangul Jamo Extended-A":function(t){return t>=43360&&t<=43391},"Hangul Syllables":function(t){return t>=44032&&t<=55215},"Hangul Jamo Extended-B":function(t){return t>=55216&&t<=55295},"Private Use Area":function(t){return t>=57344&&t<=63743},"CJK Compatibility Ideographs":function(t){return t>=63744&&t<=64255},"Arabic Presentation Forms-A":function(t){return t>=64336&&t<=65023},"Vertical Forms":function(t){return t>=65040&&t<=65055},"CJK Compatibility Forms":function(t){return t>=65072&&t<=65103},"Small Form Variants":function(t){return t>=65104&&t<=65135},"Arabic Presentation Forms-B":function(t){return t>=65136&&t<=65279},"Halfwidth and Fullwidth Forms":function(t){return t>=65280&&t<=65519}};function Gi(t){for(var e=0,r=t;e<r.length;e+=1)if(Zi(r[e].charCodeAt(0)))return!0;return!1}function Zi(t){return!(746!==t&&747!==t&&(t<4352||!(qi["Bopomofo Extended"](t)||qi.Bopomofo(t)||qi["CJK Compatibility Forms"](t)&&!(t>=65097&&t<=65103)||qi["CJK Compatibility Ideographs"](t)||qi["CJK Compatibility"](t)||qi["CJK Radicals Supplement"](t)||qi["CJK Strokes"](t)||!(!qi["CJK Symbols and Punctuation"](t)||t>=12296&&t<=12305||t>=12308&&t<=12319||12336===t)||qi["CJK Unified Ideographs Extension A"](t)||qi["CJK Unified Ideographs"](t)||qi["Enclosed CJK Letters and Months"](t)||qi["Hangul Compatibility Jamo"](t)||qi["Hangul Jamo Extended-A"](t)||qi["Hangul Jamo Extended-B"](t)||qi["Hangul Jamo"](t)||qi["Hangul Syllables"](t)||qi.Hiragana(t)||qi["Ideographic Description Characters"](t)||qi.Kanbun(t)||qi["Kangxi Radicals"](t)||qi["Katakana Phonetic Extensions"](t)||qi.Katakana(t)&&12540!==t||!(!qi["Halfwidth and Fullwidth Forms"](t)||65288===t||65289===t||65293===t||t>=65306&&t<=65310||65339===t||65341===t||65343===t||t>=65371&&t<=65503||65507===t||t>=65512&&t<=65519)||!(!qi["Small Form Variants"](t)||t>=65112&&t<=65118||t>=65123&&t<=65126)||qi["Unified Canadian Aboriginal Syllabics"](t)||qi["Unified Canadian Aboriginal Syllabics Extended"](t)||qi["Vertical Forms"](t)||qi["Yijing Hexagram Symbols"](t)||qi["Yi Syllables"](t)||qi["Yi Radicals"](t))))}function Hi(t){return!(Zi(t)||function(t){return!!(qi["Latin-1 Supplement"](t)&&(167===t||169===t||174===t||177===t||188===t||189===t||190===t||215===t||247===t)||qi["General Punctuation"](t)&&(8214===t||8224===t||8225===t||8240===t||8241===t||8251===t||8252===t||8258===t||8263===t||8264===t||8265===t||8273===t)||qi["Letterlike Symbols"](t)||qi["Number Forms"](t)||qi["Miscellaneous Technical"](t)&&(t>=8960&&t<=8967||t>=8972&&t<=8991||t>=8996&&t<=9e3||9003===t||t>=9085&&t<=9114||t>=9150&&t<=9165||9167===t||t>=9169&&t<=9179||t>=9186&&t<=9215)||qi["Control Pictures"](t)&&9251!==t||qi["Optical Character Recognition"](t)||qi["Enclosed Alphanumerics"](t)||qi["Geometric Shapes"](t)||qi["Miscellaneous Symbols"](t)&&!(t>=9754&&t<=9759)||qi["Miscellaneous Symbols and Arrows"](t)&&(t>=11026&&t<=11055||t>=11088&&t<=11097||t>=11192&&t<=11243)||qi["CJK Symbols and Punctuation"](t)||qi.Katakana(t)||qi["Private Use Area"](t)||qi["CJK Compatibility Forms"](t)||qi["Small Form Variants"](t)||qi["Halfwidth and Fullwidth Forms"](t)||8734===t||8756===t||8757===t||t>=9984&&t<=10087||t>=10102&&t<=10131||65532===t||65533===t)}(t))}function Ki(t){return t>=1424&&t<=2303||qi["Arabic Presentation Forms-A"](t)||qi["Arabic Presentation Forms-B"](t)}function Wi(t,e){return!(!e&&Ki(t)||t>=2304&&t<=3583||t>=3840&&t<=4255||qi.Khmer(t))}function Xi(t){for(var e=0,r=t;e<r.length;e+=1)if(Ki(r[e].charCodeAt(0)))return!0;return!1}var $i=null,Ji="unavailable",Yi=null,Qi=function(t){t&&"string"==typeof t&&t.indexOf("NetworkError")>-1&&(Ji="error"),$i&&$i(t)};function to(){eo.fire(new kt("pluginStateChange",{pluginStatus:Ji,pluginURL:Yi}))}var eo=new Tt,ro=function(){return Ji},io=function(){if("deferred"!==Ji||!Yi)throw new Error("rtl-text-plugin cannot be downloaded unless a pluginURL is specified");Ji="loading",to(),Yi&&_t({url:Yi},(function(t){t?Qi(t):(Ji="loaded",to())}))},oo={applyArabicShaping:null,processBidirectionalText:null,processStyledBidirectionalText:null,isLoaded:function(){return"loaded"===Ji||null!=oo.applyArabicShaping},isLoading:function(){return"loading"===Ji},setState:function(t){Ji=t.pluginStatus,Yi=t.pluginURL},isParsed:function(){return null!=oo.applyArabicShaping&&null!=oo.processBidirectionalText&&null!=oo.processStyledBidirectionalText},getPluginURL:function(){return Yi}},no=function(t,e){this.zoom=t,e?(this.now=e.now,this.fadeDuration=e.fadeDuration,this.zoomHistory=e.zoomHistory,this.transition=e.transition):(this.now=0,this.fadeDuration=0,this.zoomHistory=new Vi,this.transition={})};no.prototype.isSupportedScript=function(t){return function(t,e){for(var r=0,o=t;r<o.length;r+=1)if(!Wi(o[r].charCodeAt(0),e))return!1;return!0}(t,oo.isLoaded())},no.prototype.crossFadingFactor=function(){return 0===this.fadeDuration?1:Math.min((this.now-this.zoomHistory.lastIntegerZoomTime)/this.fadeDuration,1)},no.prototype.getCrossfadeParameters=function(){var t=this.zoom,e=t-Math.floor(t),r=this.crossFadingFactor();return t>this.zoomHistory.lastIntegerZoom?{fromScale:2,toScale:1,t:e+(1-e)*r}:{fromScale:.5,toScale:1,t:1-(1-r)*e}};var ao=function(t,e){this.property=t,this.value=e,this.expression=function(t,e){if(Dr(t))return new Wr(t,e);if(qr(t)){var r=Kr(t,e);if("error"===r.result)throw new Error(r.value.map((function(t){return t.key+": "+t.message})).join(", "));return r.value}var o=t;return"string"==typeof t&&"color"===e.type&&(o=Yt.parse(t)),{kind:"constant",evaluate:function(){return o}}}(void 0===e?t.specification.default:e,t.specification)};ao.prototype.isDataDriven=function(){return"source"===this.expression.kind||"composite"===this.expression.kind},ao.prototype.possiblyEvaluate=function(t,e,r){return this.property.possiblyEvaluate(this,t,e,r)};var so=function(t){this.property=t,this.value=new ao(t,void 0)};so.prototype.transitioned=function(t,e){return new li(this.property,this.value,e,c({},t.transition,this.transition),t.now)},so.prototype.untransitioned=function(){return new li(this.property,this.value,null,{},0)};var lo=function(t){this._properties=t,this._values=Object.create(t.defaultTransitionablePropertyValues)};lo.prototype.getValue=function(t){return b(this._values[t].value.value)},lo.prototype.setValue=function(t,e){this._values.hasOwnProperty(t)||(this._values[t]=new so(this._values[t].property)),this._values[t].value=new ao(this._values[t].property,null===e?void 0:b(e))},lo.prototype.getTransition=function(t){return b(this._values[t].transition)},lo.prototype.setTransition=function(t,e){this._values.hasOwnProperty(t)||(this._values[t]=new so(this._values[t].property)),this._values[t].transition=b(e)||void 0},lo.prototype.serialize=function(){for(var t={},e=0,r=Object.keys(this._values);e<r.length;e+=1){var o=r[e],i=this.getValue(o);void 0!==i&&(t[o]=i);var a=this.getTransition(o);void 0!==a&&(t[o+"-transition"]=a)}return t},lo.prototype.transitioned=function(t,e){for(var r=new uo(this._properties),o=0,i=Object.keys(this._values);o<i.length;o+=1){var a=i[o];r._values[a]=this._values[a].transitioned(t,e._values[a])}return r},lo.prototype.untransitioned=function(){for(var t=new uo(this._properties),e=0,r=Object.keys(this._values);e<r.length;e+=1){var o=r[e];t._values[o]=this._values[o].untransitioned()}return t};var li=function(t,e,r,o,i){this.property=t,this.value=e,this.begin=i+o.delay||0,this.end=this.begin+o.duration||0,t.specification.transition&&(o.delay||o.duration)&&(this.prior=r)};li.prototype.possiblyEvaluate=function(t,e,r){var o=t.now||0,i=this.value.possiblyEvaluate(t,e,r),a=this.prior;if(a){if(o>this.end)return this.prior=null,i;if(this.value.isDataDriven())return this.prior=null,i;if(o<this.begin)return a.possiblyEvaluate(t,e,r);var n=(o-this.begin)/(this.end-this.begin);return this.property.interpolate(a.possiblyEvaluate(t,e,r),i,function(t){if(t<=0)return 0;if(t>=1)return 1;var e=t*t,r=e*t;return 4*(t<.5?r:3*(t-e)+r-.75)}(n))}return i};var uo=function(t){this._properties=t,this._values=Object.create(t.defaultTransitioningPropertyValues)};uo.prototype.possiblyEvaluate=function(t,e,r){for(var o=new ho(this._properties),i=0,a=Object.keys(this._values);i<a.length;i+=1){var n=a[i];o._values[n]=this._values[n].possiblyEvaluate(t,e,r)}return o},uo.prototype.hasTransition=function(){for(var t=0,e=Object.keys(this._values);t<e.length;t+=1)if(this._values[e[t]].prior)return!0;return!1};var co=function(t){this._properties=t,this._values=Object.create(t.defaultPropertyValues)};co.prototype.getValue=function(t){return b(this._values[t].value)},co.prototype.setValue=function(t,e){this._values[t]=new ao(this._values[t].property,null===e?void 0:b(e))},co.prototype.serialize=function(){for(var t={},e=0,r=Object.keys(this._values);e<r.length;e+=1){var o=r[e],i=this.getValue(o);void 0!==i&&(t[o]=i)}return t},co.prototype.possiblyEvaluate=function(t,e,r){for(var o=new ho(this._properties),i=0,a=Object.keys(this._values);i<a.length;i+=1){var n=a[i];o._values[n]=this._values[n].possiblyEvaluate(t,e,r)}return o};var po=function(t,e,r){this.property=t,this.value=e,this.parameters=r};po.prototype.isConstant=function(){return"constant"===this.value.kind},po.prototype.constantOr=function(t){return"constant"===this.value.kind?this.value.value:t},po.prototype.evaluate=function(t,e,r,o){return this.property.evaluate(this.value,this.parameters,t,e,r,o)};var ho=function(t){this._properties=t,this._values=Object.create(t.defaultPossiblyEvaluatedValues)};ho.prototype.get=function(t){return this._values[t]};var fo=function(t){this.specification=t};fo.prototype.possiblyEvaluate=function(t,e){return t.expression.evaluate(e)},fo.prototype.interpolate=function(t,e,r){var o=qe[this.specification.type];return o?o(t,e,r):t};var mo=function(t,e){this.specification=t,this.overrides=e};mo.prototype.possiblyEvaluate=function(t,e,r,o){return new po(this,"constant"===t.expression.kind||"camera"===t.expression.kind?{kind:"constant",value:t.expression.evaluate(e,null,{},r,o)}:t.expression,e)},mo.prototype.interpolate=function(t,e,r){if("constant"!==t.value.kind||"constant"!==e.value.kind)return t;if(void 0===t.value.value||void 0===e.value.value)return new po(this,{kind:"constant",value:void 0},t.parameters);var o=qe[this.specification.type];return o?new po(this,{kind:"constant",value:o(t.value.value,e.value.value,r)},t.parameters):t},mo.prototype.evaluate=function(t,e,r,o,i,a){return"constant"===t.kind?t.value:t.evaluate(e,r,o,i,a)};var go=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e,e.prototype.possiblyEvaluate=function(t,e,r,o){if(void 0===t.value)return new po(this,{kind:"constant",value:void 0},e);if("constant"===t.expression.kind){var i=t.expression.evaluate(e,null,{},r,o),a="resolvedImage"===t.property.specification.type&&"string"!=typeof i?i.name:i,n=this._calculate(a,a,a,e);return new po(this,{kind:"constant",value:n},e)}if("camera"===t.expression.kind){var s=this._calculate(t.expression.evaluate({zoom:e.zoom-1}),t.expression.evaluate({zoom:e.zoom}),t.expression.evaluate({zoom:e.zoom+1}),e);return new po(this,{kind:"constant",value:s},e)}return new po(this,t.expression,e)},e.prototype.evaluate=function(t,e,r,o,i,a){if("source"===t.kind){var n=t.evaluate(e,r,o,i,a);return this._calculate(n,n,n,e)}return"composite"===t.kind?this._calculate(t.evaluate({zoom:Math.floor(e.zoom)-1},r,o),t.evaluate({zoom:Math.floor(e.zoom)},r,o),t.evaluate({zoom:Math.floor(e.zoom)+1},r,o),e):t.value},e.prototype._calculate=function(t,e,r,o){return o.zoom>o.zoomHistory.lastIntegerZoom?{from:t,to:e}:{from:r,to:e}},e.prototype.interpolate=function(t){return t},e}(mo),yo=function(t){this.specification=t};yo.prototype.possiblyEvaluate=function(t,e,r,o){if(void 0!==t.value){if("constant"===t.expression.kind){var i=t.expression.evaluate(e,null,{},r,o);return this._calculate(i,i,i,e)}return this._calculate(t.expression.evaluate(new no(Math.floor(e.zoom-1),e)),t.expression.evaluate(new no(Math.floor(e.zoom),e)),t.expression.evaluate(new no(Math.floor(e.zoom+1),e)),e)}},yo.prototype._calculate=function(t,e,r,o){return o.zoom>o.zoomHistory.lastIntegerZoom?{from:t,to:e}:{from:r,to:e}},yo.prototype.interpolate=function(t){return t};var vo=function(t){this.specification=t};vo.prototype.possiblyEvaluate=function(t,e,r,o){return!!t.expression.evaluate(e,null,{},r,o)},vo.prototype.interpolate=function(){return!1};var _o=function(t){for(var e in this.properties=t,this.defaultPropertyValues={},this.defaultTransitionablePropertyValues={},this.defaultTransitioningPropertyValues={},this.defaultPossiblyEvaluatedValues={},this.overridableProperties=[],t){var r=t[e];r.specification.overridable&&this.overridableProperties.push(e);var o=this.defaultPropertyValues[e]=new ao(r,void 0),i=this.defaultTransitionablePropertyValues[e]=new so(r);this.defaultTransitioningPropertyValues[e]=i.untransitioned(),this.defaultPossiblyEvaluatedValues[e]=o.possiblyEvaluate({})}};Oi("DataDrivenProperty",mo),Oi("DataConstantProperty",fo),Oi("CrossFadedDataDrivenProperty",go),Oi("CrossFadedProperty",yo),Oi("ColorRampProperty",vo);var xo=function(t){function e(e,r){if(t.call(this),this.id=e.id,this.type=e.type,this._featureFilter={filter:function(){return!0},needGeometry:!1},"custom"!==e.type&&(this.metadata=(e=e).metadata,this.minzoom=e.minzoom,this.maxzoom=e.maxzoom,"background"!==e.type&&(this.source=e.source,this.sourceLayer=e["source-layer"],this.filter=e.filter),r.layout&&(this._unevaluatedLayout=new co(r.layout)),r.paint)){for(var o in this._transitionablePaint=new lo(r.paint),e.paint)this.setPaintProperty(o,e.paint[o],{validate:!1});for(var i in e.layout)this.setLayoutProperty(i,e.layout[i],{validate:!1});this._transitioningPaint=this._transitionablePaint.untransitioned(),this.paint=new ho(r.paint)}}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e,e.prototype.getCrossfadeParameters=function(){return this._crossfadeParameters},e.prototype.getLayoutProperty=function(t){return"visibility"===t?this.visibility:this._unevaluatedLayout.getValue(t)},e.prototype.setLayoutProperty=function(t,e,r){void 0===r&&(r={}),null!=e&&this._validate(Ci,"layers."+this.id+".layout."+t,t,e,r)||("visibility"!==t?this._unevaluatedLayout.setValue(t,e):this.visibility=e)},e.prototype.getPaintProperty=function(t){return v(t,"-transition")?this._transitionablePaint.getTransition(t.slice(0,-"-transition".length)):this._transitionablePaint.getValue(t)},e.prototype.setPaintProperty=function(t,e,r){if(void 0===r&&(r={}),null!=e&&this._validate(zi,"layers."+this.id+".paint."+t,t,e,r))return!1;if(v(t,"-transition"))return this._transitionablePaint.setTransition(t.slice(0,-"-transition".length),e||void 0),!1;var o=this._transitionablePaint._values[t],i="cross-faded-data-driven"===o.property.specification["property-type"],a=o.value.isDataDriven(),n=o.value;this._transitionablePaint.setValue(t,e),this._handleSpecialPaintPropertyUpdate(t);var s=this._transitionablePaint._values[t].value;return s.isDataDriven()||a||i||this._handleOverridablePaintPropertyUpdate(t,n,s)},e.prototype._handleSpecialPaintPropertyUpdate=function(t){},e.prototype._handleOverridablePaintPropertyUpdate=function(t,e,r){return!1},e.prototype.isHidden=function(t){return!!(this.minzoom&&t<this.minzoom)||!!(this.maxzoom&&t>=this.maxzoom)||"none"===this.visibility},e.prototype.updateTransitions=function(t){this._transitioningPaint=this._transitionablePaint.transitioned(t,this._transitioningPaint)},e.prototype.hasTransition=function(){return this._transitioningPaint.hasTransition()},e.prototype.recalculate=function(t,e){t.getCrossfadeParameters&&(this._crossfadeParameters=t.getCrossfadeParameters()),this._unevaluatedLayout&&(this.layout=this._unevaluatedLayout.possiblyEvaluate(t,void 0,e)),this.paint=this._transitioningPaint.possiblyEvaluate(t,void 0,e)},e.prototype.serialize=function(){var t={id:this.id,type:this.type,source:this.source,"source-layer":this.sourceLayer,metadata:this.metadata,minzoom:this.minzoom,maxzoom:this.maxzoom,filter:this.filter,layout:this._unevaluatedLayout&&this._unevaluatedLayout.serialize(),paint:this._transitionablePaint&&this._transitionablePaint.serialize()};return this.visibility&&(t.layout=t.layout||{},t.layout.visibility=this.visibility),_(t,(function(t,e){return!(void 0===t||"layout"===e&&!Object.keys(t).length||"paint"===e&&!Object.keys(t).length)}))},e.prototype._validate=function(t,e,r,o,i){return void 0===i&&(i={}),(!i||!1!==i.validate)&&Pi(this,t.call(Ti,{key:e,layerType:this.type,objectKey:r,value:o,styleSpec:It,style:{glyphs:!0,sprite:!0}}))},e.prototype.is3D=function(){return!1},e.prototype.isTileClipped=function(){return!1},e.prototype.hasOffscreenPass=function(){return!1},e.prototype.resize=function(){},e.prototype.isStateDependent=function(){for(var t in this.paint._values){var e=this.paint.get(t);if(e instanceof po&&Ar(e.property.specification)&&("source"===e.value.kind||"composite"===e.value.kind)&&e.value.isStateDependent)return!0}return!1},e}(Tt),bo={Int8:Int8Array,Uint8:Uint8Array,Int16:Int16Array,Uint16:Uint16Array,Int32:Int32Array,Uint32:Uint32Array,Float32:Float32Array},wo=function(t,e){this._structArray=t,this._pos1=e*this.size,this._pos2=this._pos1/2,this._pos4=this._pos1/4,this._pos8=this._pos1/8},Eo=function(){this.isTransferred=!1,this.capacity=-1,this.resize(0)};function ko(t,e){void 0===e&&(e=1);var r=0,o=0;return{members:t.map((function(t){var i=bo[t.type].BYTES_PER_ELEMENT,a=r=So(r,Math.max(e,i)),n=t.components||1;return o=Math.max(o,i),r+=i*n,{name:t.name,type:t.type,components:n,offset:a}})),size:So(r,Math.max(o,e)),alignment:e}}function So(t,e){return Math.ceil(t/e)*e}Eo.serialize=function(t,e){return t._trim(),e&&(t.isTransferred=!0,e.push(t.arrayBuffer)),{length:t.length,arrayBuffer:t.arrayBuffer}},Eo.deserialize=function(t){var e=Object.create(this.prototype);return e.arrayBuffer=t.arrayBuffer,e.length=t.length,e.capacity=t.arrayBuffer.byteLength/e.bytesPerElement,e._refreshViews(),e},Eo.prototype._trim=function(){this.length!==this.capacity&&(this.capacity=this.length,this.arrayBuffer=this.arrayBuffer.slice(0,this.length*this.bytesPerElement),this._refreshViews())},Eo.prototype.clear=function(){this.length=0},Eo.prototype.resize=function(t){this.reserve(t),this.length=t},Eo.prototype.reserve=function(t){if(t>this.capacity){this.capacity=Math.max(t,Math.floor(5*this.capacity),128),this.arrayBuffer=new ArrayBuffer(this.capacity*this.bytesPerElement);var e=this.uint8;this._refreshViews(),e&&this.uint8.set(e)}},Eo.prototype._refreshViews=function(){throw new Error("_refreshViews() must be implemented by each concrete StructArray layout")};var To=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e,e.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)},e.prototype.emplaceBack=function(t,e){var r=this.length;return this.resize(r+1),this.emplace(r,t,e)},e.prototype.emplace=function(t,e,r){var o=2*t;return this.int16[o+0]=e,this.int16[o+1]=r,t},e}(Eo);To.prototype.bytesPerElement=4,Oi("StructArrayLayout2i4",To);var Io=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e,e.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)},e.prototype.emplaceBack=function(t,e,r,o){var i=this.length;return this.resize(i+1),this.emplace(i,t,e,r,o)},e.prototype.emplace=function(t,e,r,o,i){var a=4*t;return this.int16[a+0]=e,this.int16[a+1]=r,this.int16[a+2]=o,this.int16[a+3]=i,t},e}(Eo);Io.prototype.bytesPerElement=8,Oi("StructArrayLayout4i8",Io);var zo=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e,e.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)},e.prototype.emplaceBack=function(t,e,r,o,i,a){var n=this.length;return this.resize(n+1),this.emplace(n,t,e,r,o,i,a)},e.prototype.emplace=function(t,e,r,o,i,a,n){var s=6*t;return this.int16[s+0]=e,this.int16[s+1]=r,this.int16[s+2]=o,this.int16[s+3]=i,this.int16[s+4]=a,this.int16[s+5]=n,t},e}(Eo);zo.prototype.bytesPerElement=12,Oi("StructArrayLayout2i4i12",zo);var Co=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e,e.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)},e.prototype.emplaceBack=function(t,e,r,o,i,a){var n=this.length;return this.resize(n+1),this.emplace(n,t,e,r,o,i,a)},e.prototype.emplace=function(t,e,r,o,i,a,n){var s=4*t,u=8*t;return this.int16[s+0]=e,this.int16[s+1]=r,this.uint8[u+4]=o,this.uint8[u+5]=i,this.uint8[u+6]=a,this.uint8[u+7]=n,t},e}(Eo);Co.prototype.bytesPerElement=8,Oi("StructArrayLayout2i4ub8",Co);var Po=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e,e.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)},e.prototype.emplaceBack=function(t,e,r,o,i,a,n,s,u,l){var p=this.length;return this.resize(p+1),this.emplace(p,t,e,r,o,i,a,n,s,u,l)},e.prototype.emplace=function(t,e,r,o,i,a,n,s,u,l,p){var c=10*t;return this.uint16[c+0]=e,this.uint16[c+1]=r,this.uint16[c+2]=o,this.uint16[c+3]=i,this.uint16[c+4]=a,this.uint16[c+5]=n,this.uint16[c+6]=s,this.uint16[c+7]=u,this.uint16[c+8]=l,this.uint16[c+9]=p,t},e}(Eo);Po.prototype.bytesPerElement=20,Oi("StructArrayLayout10ui20",Po);var Ao=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e,e.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)},e.prototype.emplaceBack=function(t,e,r,o,i,a,n,s,u,l,p,c){var h=this.length;return this.resize(h+1),this.emplace(h,t,e,r,o,i,a,n,s,u,l,p,c)},e.prototype.emplace=function(t,e,r,o,i,a,n,s,u,l,p,c,h){var d=12*t;return this.int16[d+0]=e,this.int16[d+1]=r,this.int16[d+2]=o,this.int16[d+3]=i,this.uint16[d+4]=a,this.uint16[d+5]=n,this.uint16[d+6]=s,this.uint16[d+7]=u,this.int16[d+8]=l,this.int16[d+9]=p,this.int16[d+10]=c,this.int16[d+11]=h,t},e}(Eo);Ao.prototype.bytesPerElement=24,Oi("StructArrayLayout4i4ui4i24",Ao);var Mo=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e,e.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)},e.prototype.emplaceBack=function(t,e,r){var o=this.length;return this.resize(o+1),this.emplace(o,t,e,r)},e.prototype.emplace=function(t,e,r,o){var i=3*t;return this.float32[i+0]=e,this.float32[i+1]=r,this.float32[i+2]=o,t},e}(Eo);Mo.prototype.bytesPerElement=12,Oi("StructArrayLayout3f12",Mo);var Lo=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e,e.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer)},e.prototype.emplaceBack=function(t){var e=this.length;return this.resize(e+1),this.emplace(e,t)},e.prototype.emplace=function(t,e){return this.uint32[1*t+0]=e,t},e}(Eo);Lo.prototype.bytesPerElement=4,Oi("StructArrayLayout1ul4",Lo);var Ro=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e,e.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)},e.prototype.emplaceBack=function(t,e,r,o,i,a,n,s,u){var l=this.length;return this.resize(l+1),this.emplace(l,t,e,r,o,i,a,n,s,u)},e.prototype.emplace=function(t,e,r,o,i,a,n,s,u,l){var p=10*t,c=5*t;return this.int16[p+0]=e,this.int16[p+1]=r,this.int16[p+2]=o,this.int16[p+3]=i,this.int16[p+4]=a,this.int16[p+5]=n,this.uint32[c+3]=s,this.uint16[p+8]=u,this.uint16[p+9]=l,t},e}(Eo);Ro.prototype.bytesPerElement=20,Oi("StructArrayLayout6i1ul2ui20",Ro);var Do=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e,e.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)},e.prototype.emplaceBack=function(t,e,r,o,i,a){var n=this.length;return this.resize(n+1),this.emplace(n,t,e,r,o,i,a)},e.prototype.emplace=function(t,e,r,o,i,a,n){var s=6*t;return this.int16[s+0]=e,this.int16[s+1]=r,this.int16[s+2]=o,this.int16[s+3]=i,this.int16[s+4]=a,this.int16[s+5]=n,t},e}(Eo);Do.prototype.bytesPerElement=12,Oi("StructArrayLayout2i2i2i12",Do);var Oo=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e,e.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)},e.prototype.emplaceBack=function(t,e,r,o,i){var a=this.length;return this.resize(a+1),this.emplace(a,t,e,r,o,i)},e.prototype.emplace=function(t,e,r,o,i,a){var n=4*t,s=8*t;return this.float32[n+0]=e,this.float32[n+1]=r,this.float32[n+2]=o,this.int16[s+6]=i,this.int16[s+7]=a,t},e}(Eo);Oo.prototype.bytesPerElement=16,Oi("StructArrayLayout2f1f2i16",Oo);var Bo=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e,e.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)},e.prototype.emplaceBack=function(t,e,r,o){var i=this.length;return this.resize(i+1),this.emplace(i,t,e,r,o)},e.prototype.emplace=function(t,e,r,o,i){var a=12*t,n=3*t;return this.uint8[a+0]=e,this.uint8[a+1]=r,this.float32[n+1]=o,this.float32[n+2]=i,t},e}(Eo);Bo.prototype.bytesPerElement=12,Oi("StructArrayLayout2ub2f12",Bo);var Fo=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e,e.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)},e.prototype.emplaceBack=function(t,e,r){var o=this.length;return this.resize(o+1),this.emplace(o,t,e,r)},e.prototype.emplace=function(t,e,r,o){var i=3*t;return this.uint16[i+0]=e,this.uint16[i+1]=r,this.uint16[i+2]=o,t},e}(Eo);Fo.prototype.bytesPerElement=6,Oi("StructArrayLayout3ui6",Fo);var Uo=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e,e.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)},e.prototype.emplaceBack=function(t,e,r,o,i,a,n,s,u,l,p,c,h,d,f,m,y){var v=this.length;return this.resize(v+1),this.emplace(v,t,e,r,o,i,a,n,s,u,l,p,c,h,d,f,m,y)},e.prototype.emplace=function(t,e,r,o,i,a,n,s,u,l,p,c,h,d,f,m,y,v){var g=24*t,_=12*t,b=48*t;return this.int16[g+0]=e,this.int16[g+1]=r,this.uint16[g+2]=o,this.uint16[g+3]=i,this.uint32[_+2]=a,this.uint32[_+3]=n,this.uint32[_+4]=s,this.uint16[g+10]=u,this.uint16[g+11]=l,this.uint16[g+12]=p,this.float32[_+7]=c,this.float32[_+8]=h,this.uint8[b+36]=d,this.uint8[b+37]=f,this.uint8[b+38]=m,this.uint32[_+10]=y,this.int16[g+22]=v,t},e}(Eo);Uo.prototype.bytesPerElement=48,Oi("StructArrayLayout2i2ui3ul3ui2f3ub1ul1i48",Uo);var No=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e,e.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)},e.prototype.emplaceBack=function(t,e,r,o,i,a,n,s,u,l,p,c,h,d,f,m,y,v,g,_,b,x,w,E,k,S,T,I){var z=this.length;return this.resize(z+1),this.emplace(z,t,e,r,o,i,a,n,s,u,l,p,c,h,d,f,m,y,v,g,_,b,x,w,E,k,S,T,I)},e.prototype.emplace=function(t,e,r,o,i,a,n,s,u,l,p,c,h,d,f,m,y,v,g,_,b,x,w,E,k,S,T,I,z){var C=34*t,P=17*t;return this.int16[C+0]=e,this.int16[C+1]=r,this.int16[C+2]=o,this.int16[C+3]=i,this.int16[C+4]=a,this.int16[C+5]=n,this.int16[C+6]=s,this.int16[C+7]=u,this.uint16[C+8]=l,this.uint16[C+9]=p,this.uint16[C+10]=c,this.uint16[C+11]=h,this.uint16[C+12]=d,this.uint16[C+13]=f,this.uint16[C+14]=m,this.uint16[C+15]=y,this.uint16[C+16]=v,this.uint16[C+17]=g,this.uint16[C+18]=_,this.uint16[C+19]=b,this.uint16[C+20]=x,this.uint16[C+21]=w,this.uint16[C+22]=E,this.uint32[P+12]=k,this.float32[P+13]=S,this.float32[P+14]=T,this.float32[P+15]=I,this.float32[P+16]=z,t},e}(Eo);No.prototype.bytesPerElement=68,Oi("StructArrayLayout8i15ui1ul4f68",No);var jo=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e,e.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)},e.prototype.emplaceBack=function(t){var e=this.length;return this.resize(e+1),this.emplace(e,t)},e.prototype.emplace=function(t,e){return this.float32[1*t+0]=e,t},e}(Eo);jo.prototype.bytesPerElement=4,Oi("StructArrayLayout1f4",jo);var Vo=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e,e.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)},e.prototype.emplaceBack=function(t,e,r){var o=this.length;return this.resize(o+1),this.emplace(o,t,e,r)},e.prototype.emplace=function(t,e,r,o){var i=3*t;return this.int16[i+0]=e,this.int16[i+1]=r,this.int16[i+2]=o,t},e}(Eo);Vo.prototype.bytesPerElement=6,Oi("StructArrayLayout3i6",Vo);var qo=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e,e.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)},e.prototype.emplaceBack=function(t,e,r){var o=this.length;return this.resize(o+1),this.emplace(o,t,e,r)},e.prototype.emplace=function(t,e,r,o){var i=4*t;return this.uint32[2*t+0]=e,this.uint16[i+2]=r,this.uint16[i+3]=o,t},e}(Eo);qo.prototype.bytesPerElement=8,Oi("StructArrayLayout1ul2ui8",qo);var Go=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e,e.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)},e.prototype.emplaceBack=function(t,e){var r=this.length;return this.resize(r+1),this.emplace(r,t,e)},e.prototype.emplace=function(t,e,r){var o=2*t;return this.uint16[o+0]=e,this.uint16[o+1]=r,t},e}(Eo);Go.prototype.bytesPerElement=4,Oi("StructArrayLayout2ui4",Go);var Zo=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e,e.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)},e.prototype.emplaceBack=function(t){var e=this.length;return this.resize(e+1),this.emplace(e,t)},e.prototype.emplace=function(t,e){return this.uint16[1*t+0]=e,t},e}(Eo);Zo.prototype.bytesPerElement=2,Oi("StructArrayLayout1ui2",Zo);var Ho=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e,e.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)},e.prototype.emplaceBack=function(t,e){var r=this.length;return this.resize(r+1),this.emplace(r,t,e)},e.prototype.emplace=function(t,e,r){var o=2*t;return this.float32[o+0]=e,this.float32[o+1]=r,t},e}(Eo);Ho.prototype.bytesPerElement=8,Oi("StructArrayLayout2f8",Ho);var Ko=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e,e.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)},e.prototype.emplaceBack=function(t,e,r,o){var i=this.length;return this.resize(i+1),this.emplace(i,t,e,r,o)},e.prototype.emplace=function(t,e,r,o,i){var a=4*t;return this.float32[a+0]=e,this.float32[a+1]=r,this.float32[a+2]=o,this.float32[a+3]=i,t},e}(Eo);Ko.prototype.bytesPerElement=16,Oi("StructArrayLayout4f16",Ko);var Wo=function(t){function e(){t.apply(this,arguments)}t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e;var r={anchorPointX:{configurable:!0},anchorPointY:{configurable:!0},x1:{configurable:!0},y1:{configurable:!0},x2:{configurable:!0},y2:{configurable:!0},featureIndex:{configurable:!0},sourceLayerIndex:{configurable:!0},bucketIndex:{configurable:!0},anchorPoint:{configurable:!0}};return r.anchorPointX.get=function(){return this._structArray.int16[this._pos2+0]},r.anchorPointY.get=function(){return this._structArray.int16[this._pos2+1]},r.x1.get=function(){return this._structArray.int16[this._pos2+2]},r.y1.get=function(){return this._structArray.int16[this._pos2+3]},r.x2.get=function(){return this._structArray.int16[this._pos2+4]},r.y2.get=function(){return this._structArray.int16[this._pos2+5]},r.featureIndex.get=function(){return this._structArray.uint32[this._pos4+3]},r.sourceLayerIndex.get=function(){return this._structArray.uint16[this._pos2+8]},r.bucketIndex.get=function(){return this._structArray.uint16[this._pos2+9]},r.anchorPoint.get=function(){return new i(this.anchorPointX,this.anchorPointY)},Object.defineProperties(e.prototype,r),e}(wo);Wo.prototype.size=20;var Xo=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e,e.prototype.get=function(t){return new Wo(this,t)},e}(Ro);Oi("CollisionBoxArray",Xo);var $o=function(t){function e(){t.apply(this,arguments)}t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e;var r={anchorX:{configurable:!0},anchorY:{configurable:!0},glyphStartIndex:{configurable:!0},numGlyphs:{configurable:!0},vertexStartIndex:{configurable:!0},lineStartIndex:{configurable:!0},lineLength:{configurable:!0},segment:{configurable:!0},lowerSize:{configurable:!0},upperSize:{configurable:!0},lineOffsetX:{configurable:!0},lineOffsetY:{configurable:!0},writingMode:{configurable:!0},placedOrientation:{configurable:!0},hidden:{configurable:!0},crossTileID:{configurable:!0},associatedIconIndex:{configurable:!0}};return r.anchorX.get=function(){return this._structArray.int16[this._pos2+0]},r.anchorY.get=function(){return this._structArray.int16[this._pos2+1]},r.glyphStartIndex.get=function(){return this._structArray.uint16[this._pos2+2]},r.numGlyphs.get=function(){return this._structArray.uint16[this._pos2+3]},r.vertexStartIndex.get=function(){return this._structArray.uint32[this._pos4+2]},r.lineStartIndex.get=function(){return this._structArray.uint32[this._pos4+3]},r.lineLength.get=function(){return this._structArray.uint32[this._pos4+4]},r.segment.get=function(){return this._structArray.uint16[this._pos2+10]},r.lowerSize.get=function(){return this._structArray.uint16[this._pos2+11]},r.upperSize.get=function(){return this._structArray.uint16[this._pos2+12]},r.lineOffsetX.get=function(){return this._structArray.float32[this._pos4+7]},r.lineOffsetY.get=function(){return this._structArray.float32[this._pos4+8]},r.writingMode.get=function(){return this._structArray.uint8[this._pos1+36]},r.placedOrientation.get=function(){return this._structArray.uint8[this._pos1+37]},r.placedOrientation.set=function(t){this._structArray.uint8[this._pos1+37]=t},r.hidden.get=function(){return this._structArray.uint8[this._pos1+38]},r.hidden.set=function(t){this._structArray.uint8[this._pos1+38]=t},r.crossTileID.get=function(){return this._structArray.uint32[this._pos4+10]},r.crossTileID.set=function(t){this._structArray.uint32[this._pos4+10]=t},r.associatedIconIndex.get=function(){return this._structArray.int16[this._pos2+22]},Object.defineProperties(e.prototype,r),e}(wo);$o.prototype.size=48;var Jo=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e,e.prototype.get=function(t){return new $o(this,t)},e}(Uo);Oi("PlacedSymbolArray",Jo);var Yo=function(t){function e(){t.apply(this,arguments)}t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e;var r={anchorX:{configurable:!0},anchorY:{configurable:!0},rightJustifiedTextSymbolIndex:{configurable:!0},centerJustifiedTextSymbolIndex:{configurable:!0},leftJustifiedTextSymbolIndex:{configurable:!0},verticalPlacedTextSymbolIndex:{configurable:!0},placedIconSymbolIndex:{configurable:!0},verticalPlacedIconSymbolIndex:{configurable:!0},key:{configurable:!0},textBoxStartIndex:{configurable:!0},textBoxEndIndex:{configurable:!0},verticalTextBoxStartIndex:{configurable:!0},verticalTextBoxEndIndex:{configurable:!0},iconBoxStartIndex:{configurable:!0},iconBoxEndIndex:{configurable:!0},verticalIconBoxStartIndex:{configurable:!0},verticalIconBoxEndIndex:{configurable:!0},featureIndex:{configurable:!0},numHorizontalGlyphVertices:{configurable:!0},numVerticalGlyphVertices:{configurable:!0},numIconVertices:{configurable:!0},numVerticalIconVertices:{configurable:!0},useRuntimeCollisionCircles:{configurable:!0},crossTileID:{configurable:!0},textBoxScale:{configurable:!0},textOffset0:{configurable:!0},textOffset1:{configurable:!0},collisionCircleDiameter:{configurable:!0}};return r.anchorX.get=function(){return this._structArray.int16[this._pos2+0]},r.anchorY.get=function(){return this._structArray.int16[this._pos2+1]},r.rightJustifiedTextSymbolIndex.get=function(){return this._structArray.int16[this._pos2+2]},r.centerJustifiedTextSymbolIndex.get=function(){return this._structArray.int16[this._pos2+3]},r.leftJustifiedTextSymbolIndex.get=function(){return this._structArray.int16[this._pos2+4]},r.verticalPlacedTextSymbolIndex.get=function(){return this._structArray.int16[this._pos2+5]},r.placedIconSymbolIndex.get=function(){return this._structArray.int16[this._pos2+6]},r.verticalPlacedIconSymbolIndex.get=function(){return this._structArray.int16[this._pos2+7]},r.key.get=function(){return this._structArray.uint16[this._pos2+8]},r.textBoxStartIndex.get=function(){return this._structArray.uint16[this._pos2+9]},r.textBoxEndIndex.get=function(){return this._structArray.uint16[this._pos2+10]},r.verticalTextBoxStartIndex.get=function(){return this._structArray.uint16[this._pos2+11]},r.verticalTextBoxEndIndex.get=function(){return this._structArray.uint16[this._pos2+12]},r.iconBoxStartIndex.get=function(){return this._structArray.uint16[this._pos2+13]},r.iconBoxEndIndex.get=function(){return this._structArray.uint16[this._pos2+14]},r.verticalIconBoxStartIndex.get=function(){return this._structArray.uint16[this._pos2+15]},r.verticalIconBoxEndIndex.get=function(){return this._structArray.uint16[this._pos2+16]},r.featureIndex.get=function(){return this._structArray.uint16[this._pos2+17]},r.numHorizontalGlyphVertices.get=function(){return this._structArray.uint16[this._pos2+18]},r.numVerticalGlyphVertices.get=function(){return this._structArray.uint16[this._pos2+19]},r.numIconVertices.get=function(){return this._structArray.uint16[this._pos2+20]},r.numVerticalIconVertices.get=function(){return this._structArray.uint16[this._pos2+21]},r.useRuntimeCollisionCircles.get=function(){return this._structArray.uint16[this._pos2+22]},r.crossTileID.get=function(){return this._structArray.uint32[this._pos4+12]},r.crossTileID.set=function(t){this._structArray.uint32[this._pos4+12]=t},r.textBoxScale.get=function(){return this._structArray.float32[this._pos4+13]},r.textOffset0.get=function(){return this._structArray.float32[this._pos4+14]},r.textOffset1.get=function(){return this._structArray.float32[this._pos4+15]},r.collisionCircleDiameter.get=function(){return this._structArray.float32[this._pos4+16]},Object.defineProperties(e.prototype,r),e}(wo);Yo.prototype.size=68;var Qo=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e,e.prototype.get=function(t){return new Yo(this,t)},e}(No);Oi("SymbolInstanceArray",Qo);var tn=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e,e.prototype.getoffsetX=function(t){return this.float32[1*t+0]},e}(jo);Oi("GlyphOffsetArray",tn);var en=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e,e.prototype.getx=function(t){return this.int16[3*t+0]},e.prototype.gety=function(t){return this.int16[3*t+1]},e.prototype.gettileUnitDistanceFromAnchor=function(t){return this.int16[3*t+2]},e}(Vo);Oi("SymbolLineVertexArray",en);var rn=function(t){function e(){t.apply(this,arguments)}t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e;var r={featureIndex:{configurable:!0},sourceLayerIndex:{configurable:!0},bucketIndex:{configurable:!0}};return r.featureIndex.get=function(){return this._structArray.uint32[this._pos4+0]},r.sourceLayerIndex.get=function(){return this._structArray.uint16[this._pos2+2]},r.bucketIndex.get=function(){return this._structArray.uint16[this._pos2+3]},Object.defineProperties(e.prototype,r),e}(wo);rn.prototype.size=8;var on=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e,e.prototype.get=function(t){return new rn(this,t)},e}(qo);Oi("FeatureIndexArray",on);var nn=ko([{name:"a_pos",components:2,type:"Int16"}],4).members,an=function(t){void 0===t&&(t=[]),this.segments=t};function sn(t,e){return 256*(t=l(Math.floor(t),0,255))+l(Math.floor(e),0,255)}an.prototype.prepareSegment=function(t,e,r,o){var i=this.segments[this.segments.length-1];return t>an.MAX_VERTEX_ARRAY_LENGTH&&w("Max vertices per segment is "+an.MAX_VERTEX_ARRAY_LENGTH+": bucket requested "+t),(!i||i.vertexLength+t>an.MAX_VERTEX_ARRAY_LENGTH||i.sortKey!==o)&&(i={vertexOffset:e.length,primitiveOffset:r.length,vertexLength:0,primitiveLength:0},void 0!==o&&(i.sortKey=o),this.segments.push(i)),i},an.prototype.get=function(){return this.segments},an.prototype.destroy=function(){for(var t=0,e=this.segments;t<e.length;t+=1){var r=e[t];for(var o in r.vaos)r.vaos[o].destroy()}},an.simpleSegment=function(t,e,r,o){return new an([{vertexOffset:t,primitiveOffset:e,vertexLength:r,primitiveLength:o,vaos:{},sortKey:0}])},an.MAX_VERTEX_ARRAY_LENGTH=Math.pow(2,16)-1,Oi("SegmentVector",an);var ln=ko([{name:"a_pattern_from",components:4,type:"Uint16"},{name:"a_pattern_to",components:4,type:"Uint16"},{name:"a_pixel_ratio_from",components:1,type:"Uint16"},{name:"a_pixel_ratio_to",components:1,type:"Uint16"}]),un=e((function(t){t.exports=function(t,e){var r,o,i,a,n,s,u,l;for(o=t.length-(r=3&t.length),i=e,n=3432918353,s=461845907,l=0;l<o;)u=255&t.charCodeAt(l)|(255&t.charCodeAt(++l))<<8|(255&t.charCodeAt(++l))<<16|(255&t.charCodeAt(++l))<<24,++l,i=27492+(65535&(a=5*(65535&(i=(i^=u=(65535&(u=(u=(65535&u)*n+(((u>>>16)*n&65535)<<16)&4294967295)<<15|u>>>17))*s+(((u>>>16)*s&65535)<<16)&4294967295)<<13|i>>>19))+((5*(i>>>16)&65535)<<16)&4294967295))+((58964+(a>>>16)&65535)<<16);switch(u=0,r){case 3:u^=(255&t.charCodeAt(l+2))<<16;case 2:u^=(255&t.charCodeAt(l+1))<<8;case 1:i^=u=(65535&(u=(u=(65535&(u^=255&t.charCodeAt(l)))*n+(((u>>>16)*n&65535)<<16)&4294967295)<<15|u>>>17))*s+(((u>>>16)*s&65535)<<16)&4294967295}return i^=t.length,i=2246822507*(65535&(i^=i>>>16))+((2246822507*(i>>>16)&65535)<<16)&4294967295,i=3266489909*(65535&(i^=i>>>13))+((3266489909*(i>>>16)&65535)<<16)&4294967295,(i^=i>>>16)>>>0}})),cn=e((function(t){t.exports=function(t,e){for(var r,o=t.length,i=e^o,a=0;o>=4;)r=1540483477*(65535&(r=255&t.charCodeAt(a)|(255&t.charCodeAt(++a))<<8|(255&t.charCodeAt(++a))<<16|(255&t.charCodeAt(++a))<<24))+((1540483477*(r>>>16)&65535)<<16),i=1540483477*(65535&i)+((1540483477*(i>>>16)&65535)<<16)^(r=1540483477*(65535&(r^=r>>>24))+((1540483477*(r>>>16)&65535)<<16)),o-=4,++a;switch(o){case 3:i^=(255&t.charCodeAt(a+2))<<16;case 2:i^=(255&t.charCodeAt(a+1))<<8;case 1:i=1540483477*(65535&(i^=255&t.charCodeAt(a)))+((1540483477*(i>>>16)&65535)<<16)}return i=1540483477*(65535&(i^=i>>>13))+((1540483477*(i>>>16)&65535)<<16),(i^=i>>>15)>>>0}})),pn=un,hn=cn;pn.murmur3=un,pn.murmur2=hn;var dn=function(){this.ids=[],this.positions=[],this.indexed=!1};dn.prototype.add=function(t,e,r,o){this.ids.push(mn(t)),this.positions.push(e,r,o)},dn.prototype.getPositions=function(t){for(var e=mn(t),r=0,o=this.ids.length-1;r<o;){var i=r+o>>1;this.ids[i]>=e?o=i:r=i+1}for(var a=[];this.ids[r]===e;)a.push({index:this.positions[3*r],start:this.positions[3*r+1],end:this.positions[3*r+2]}),r++;return a},dn.serialize=function(t,e){var r=new Float64Array(t.ids),o=new Uint32Array(t.positions);return function t(e,r,o,i){for(;o<i;){for(var a=e[o+i>>1],n=o-1,s=i+1;;){do{n++}while(e[n]<a);do{s--}while(e[s]>a);if(n>=s)break;gn(e,n,s),gn(r,3*n,3*s),gn(r,3*n+1,3*s+1),gn(r,3*n+2,3*s+2)}s-o<i-s?(t(e,r,o,s),o=s+1):(t(e,r,s+1,i),i=s)}}(r,o,0,r.length-1),e&&e.push(r.buffer,o.buffer),{ids:r,positions:o}},dn.deserialize=function(t){var e=new dn;return e.ids=t.ids,e.positions=t.positions,e.indexed=!0,e};var fn=Math.pow(2,53)-1;function mn(t){var e=+t;return!isNaN(e)&&e<=fn?e:pn(String(t))}function gn(t,e,r){var o=t[e];t[e]=t[r],t[r]=o}Oi("FeaturePositionMap",dn);var yn=function(t,e){this.gl=t.gl,this.location=e},vn=function(t){function e(e,r){t.call(this,e,r),this.current=0}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e,e.prototype.set=function(t){this.current!==t&&(this.current=t,this.gl.uniform1i(this.location,t))},e}(yn),_n=function(t){function e(e,r){t.call(this,e,r),this.current=0}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e,e.prototype.set=function(t){this.current!==t&&(this.current=t,this.gl.uniform1f(this.location,t))},e}(yn),xn=function(t){function e(e,r){t.call(this,e,r),this.current=[0,0]}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e,e.prototype.set=function(t){t[0]===this.current[0]&&t[1]===this.current[1]||(this.current=t,this.gl.uniform2f(this.location,t[0],t[1]))},e}(yn),bn=function(t){function e(e,r){t.call(this,e,r),this.current=[0,0,0]}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e,e.prototype.set=function(t){t[0]===this.current[0]&&t[1]===this.current[1]&&t[2]===this.current[2]||(this.current=t,this.gl.uniform3f(this.location,t[0],t[1],t[2]))},e}(yn),wn=function(t){function e(e,r){t.call(this,e,r),this.current=[0,0,0,0]}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e,e.prototype.set=function(t){t[0]===this.current[0]&&t[1]===this.current[1]&&t[2]===this.current[2]&&t[3]===this.current[3]||(this.current=t,this.gl.uniform4f(this.location,t[0],t[1],t[2],t[3]))},e}(yn),En=function(t){function e(e,r){t.call(this,e,r),this.current=Yt.transparent}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e,e.prototype.set=function(t){t.r===this.current.r&&t.g===this.current.g&&t.b===this.current.b&&t.a===this.current.a||(this.current=t,this.gl.uniform4f(this.location,t.r,t.g,t.b,t.a))},e}(yn),kn=new Float32Array(16),Sn=function(t){function e(e,r){t.call(this,e,r),this.current=kn}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e,e.prototype.set=function(t){if(t[12]!==this.current[12]||t[0]!==this.current[0])return this.current=t,void this.gl.uniformMatrix4fv(this.location,!1,t);for(var e=1;e<16;e++)if(t[e]!==this.current[e]){this.current=t,this.gl.uniformMatrix4fv(this.location,!1,t);break}},e}(yn);function Tn(t){return[sn(255*t.r,255*t.g),sn(255*t.b,255*t.a)]}var In=function(t,e,r){this.value=t,this.uniformNames=e.map((function(t){return"u_"+t})),this.type=r};In.prototype.setUniform=function(t,e,r){t.set(r.constantOr(this.value))},In.prototype.getBinding=function(t,e,r){return"color"===this.type?new En(t,e):new _n(t,e)};var zn=function(t,e){this.uniformNames=e.map((function(t){return"u_"+t})),this.patternFrom=null,this.patternTo=null,this.pixelRatioFrom=1,this.pixelRatioTo=1};zn.prototype.setConstantPatternPositions=function(t,e){this.pixelRatioFrom=e.pixelRatio,this.pixelRatioTo=t.pixelRatio,this.patternFrom=e.tlbr,this.patternTo=t.tlbr},zn.prototype.setUniform=function(t,e,r,o){var i="u_pattern_to"===o?this.patternTo:"u_pattern_from"===o?this.patternFrom:"u_pixel_ratio_to"===o?this.pixelRatioTo:"u_pixel_ratio_from"===o?this.pixelRatioFrom:null;i&&t.set(i)},zn.prototype.getBinding=function(t,e,r){return"u_pattern"===r.substr(0,9)?new wn(t,e):new _n(t,e)};var Cn=function(t,e,r,o){this.expression=t,this.type=r,this.maxValue=0,this.paintVertexAttributes=e.map((function(t){return{name:"a_"+t,type:"Float32",components:"color"===r?2:1,offset:0}})),this.paintVertexArray=new o};Cn.prototype.populatePaintArray=function(t,e,r,o,i){var a=this.paintVertexArray.length,n=this.expression.evaluate(new no(0),e,{},o,[],i);this.paintVertexArray.resize(t),this._setPaintValue(a,t,n)},Cn.prototype.updatePaintArray=function(t,e,r,o){var i=this.expression.evaluate({zoom:0},r,o);this._setPaintValue(t,e,i)},Cn.prototype._setPaintValue=function(t,e,r){if("color"===this.type)for(var o=Tn(r),i=t;i<e;i++)this.paintVertexArray.emplace(i,o[0],o[1]);else{for(var a=t;a<e;a++)this.paintVertexArray.emplace(a,r);this.maxValue=Math.max(this.maxValue,Math.abs(r))}},Cn.prototype.upload=function(t){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=t.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))},Cn.prototype.destroy=function(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()};var Pn=function(t,e,r,o,i,a){this.expression=t,this.uniformNames=e.map((function(t){return"u_"+t+"_t"})),this.type=r,this.useIntegerZoom=o,this.zoom=i,this.maxValue=0,this.paintVertexAttributes=e.map((function(t){return{name:"a_"+t,type:"Float32",components:"color"===r?4:2,offset:0}})),this.paintVertexArray=new a};Pn.prototype.populatePaintArray=function(t,e,r,o,i){var a=this.expression.evaluate(new no(this.zoom),e,{},o,[],i),n=this.expression.evaluate(new no(this.zoom+1),e,{},o,[],i),s=this.paintVertexArray.length;this.paintVertexArray.resize(t),this._setPaintValue(s,t,a,n)},Pn.prototype.updatePaintArray=function(t,e,r,o){var i=this.expression.evaluate({zoom:this.zoom},r,o),a=this.expression.evaluate({zoom:this.zoom+1},r,o);this._setPaintValue(t,e,i,a)},Pn.prototype._setPaintValue=function(t,e,r,o){if("color"===this.type)for(var i=Tn(r),a=Tn(o),n=t;n<e;n++)this.paintVertexArray.emplace(n,i[0],i[1],a[0],a[1]);else{for(var s=t;s<e;s++)this.paintVertexArray.emplace(s,r,o);this.maxValue=Math.max(this.maxValue,Math.abs(r),Math.abs(o))}},Pn.prototype.upload=function(t){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=t.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))},Pn.prototype.destroy=function(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()},Pn.prototype.setUniform=function(t,e){var r=this.useIntegerZoom?Math.floor(e.zoom):e.zoom,o=l(this.expression.interpolationFactor(r,this.zoom,this.zoom+1),0,1);t.set(o)},Pn.prototype.getBinding=function(t,e,r){return new _n(t,e)};var An=function(t,e,r,o,i,a){this.expression=t,this.type=e,this.useIntegerZoom=r,this.zoom=o,this.layerId=a,this.zoomInPaintVertexArray=new i,this.zoomOutPaintVertexArray=new i};An.prototype.populatePaintArray=function(t,e,r){var o=this.zoomInPaintVertexArray.length;this.zoomInPaintVertexArray.resize(t),this.zoomOutPaintVertexArray.resize(t),this._setPaintValues(o,t,e.patterns&&e.patterns[this.layerId],r)},An.prototype.updatePaintArray=function(t,e,r,o,i){this._setPaintValues(t,e,r.patterns&&r.patterns[this.layerId],i)},An.prototype._setPaintValues=function(t,e,r,o){if(o&&r){var i=o[r.min],a=o[r.mid],n=o[r.max];if(i&&a&&n)for(var s=t;s<e;s++)this.zoomInPaintVertexArray.emplace(s,a.tl[0],a.tl[1],a.br[0],a.br[1],i.tl[0],i.tl[1],i.br[0],i.br[1],a.pixelRatio,i.pixelRatio),this.zoomOutPaintVertexArray.emplace(s,a.tl[0],a.tl[1],a.br[0],a.br[1],n.tl[0],n.tl[1],n.br[0],n.br[1],a.pixelRatio,n.pixelRatio)}},An.prototype.upload=function(t){this.zoomInPaintVertexArray&&this.zoomInPaintVertexArray.arrayBuffer&&this.zoomOutPaintVertexArray&&this.zoomOutPaintVertexArray.arrayBuffer&&(this.zoomInPaintVertexBuffer=t.createVertexBuffer(this.zoomInPaintVertexArray,ln.members,this.expression.isStateDependent),this.zoomOutPaintVertexBuffer=t.createVertexBuffer(this.zoomOutPaintVertexArray,ln.members,this.expression.isStateDependent))},An.prototype.destroy=function(){this.zoomOutPaintVertexBuffer&&this.zoomOutPaintVertexBuffer.destroy(),this.zoomInPaintVertexBuffer&&this.zoomInPaintVertexBuffer.destroy()};var Mn=function(t,e,r){this.binders={},this._buffers=[];var o=[];for(var i in t.paint._values)if(r(i)){var a=t.paint.get(i);if(a instanceof po&&Ar(a.property.specification)){var n=Rn(i,t.type),s=a.value,u=a.property.specification.type,l=a.property.useIntegerZoom,p=a.property.specification["property-type"],c="cross-faded"===p||"cross-faded-data-driven"===p;if("constant"===s.kind)this.binders[i]=c?new zn(s.value,n):new In(s.value,n,u),o.push("/u_"+i);else if("source"===s.kind||c){var h=Dn(i,u,"source");this.binders[i]=c?new An(s,u,l,e,h,t.id):new Cn(s,n,u,h),o.push("/a_"+i)}else{var d=Dn(i,u,"composite");this.binders[i]=new Pn(s,n,u,l,e,d),o.push("/z_"+i)}}}this.cacheKey=o.sort().join("")};Mn.prototype.getMaxValue=function(t){var e=this.binders[t];return e instanceof Cn||e instanceof Pn?e.maxValue:0},Mn.prototype.populatePaintArrays=function(t,e,r,o,i){for(var a in this.binders){var n=this.binders[a];(n instanceof Cn||n instanceof Pn||n instanceof An)&&n.populatePaintArray(t,e,r,o,i)}},Mn.prototype.setConstantPatternPositions=function(t,e){for(var r in this.binders){var o=this.binders[r];o instanceof zn&&o.setConstantPatternPositions(t,e)}},Mn.prototype.updatePaintArrays=function(t,e,r,o,i){var a=!1;for(var n in t)for(var s=0,u=e.getPositions(n);s<u.length;s+=1){var l=u[s],p=r.feature(l.index);for(var c in this.binders){var h=this.binders[c];if((h instanceof Cn||h instanceof Pn||h instanceof An)&&!0===h.expression.isStateDependent){var d=o.paint.get(c);h.expression=d.value,h.updatePaintArray(l.start,l.end,p,t[n],i),a=!0}}}return a},Mn.prototype.defines=function(){var t=[];for(var e in this.binders){var r=this.binders[e];(r instanceof In||r instanceof zn)&&t.push.apply(t,r.uniformNames.map((function(t){return"#define HAS_UNIFORM_"+t})))}return t},Mn.prototype.getBinderAttributes=function(){var t=[];for(var e in this.binders){var r=this.binders[e];if(r instanceof Cn||r instanceof Pn)for(var o=0;o<r.paintVertexAttributes.length;o++)t.push(r.paintVertexAttributes[o].name);else if(r instanceof An)for(var i=0;i<ln.members.length;i++)t.push(ln.members[i].name)}return t},Mn.prototype.getBinderUniforms=function(){var t=[];for(var e in this.binders){var r=this.binders[e];if(r instanceof In||r instanceof zn||r instanceof Pn)for(var o=0,i=r.uniformNames;o<i.length;o+=1)t.push(i[o])}return t},Mn.prototype.getPaintVertexBuffers=function(){return this._buffers},Mn.prototype.getUniforms=function(t,e){var r=[];for(var o in this.binders){var i=this.binders[o];if(i instanceof In||i instanceof zn||i instanceof Pn)for(var a=0,n=i.uniformNames;a<n.length;a+=1){var s=n[a];if(e[s]){var u=i.getBinding(t,e[s],s);r.push({name:s,property:o,binding:u})}}}return r},Mn.prototype.setUniforms=function(t,e,r,o){for(var i=0,a=e;i<a.length;i+=1){var n=a[i],s=n.name,u=n.property;this.binders[u].setUniform(n.binding,o,r.get(u),s)}},Mn.prototype.updatePaintBuffers=function(t){for(var e in this._buffers=[],this.binders){var r=this.binders[e];if(t&&r instanceof An){var o=2===t.fromScale?r.zoomInPaintVertexBuffer:r.zoomOutPaintVertexBuffer;o&&this._buffers.push(o)}else(r instanceof Cn||r instanceof Pn)&&r.paintVertexBuffer&&this._buffers.push(r.paintVertexBuffer)}},Mn.prototype.upload=function(t){for(var e in this.binders){var r=this.binders[e];(r instanceof Cn||r instanceof Pn||r instanceof An)&&r.upload(t)}this.updatePaintBuffers()},Mn.prototype.destroy=function(){for(var t in this.binders){var e=this.binders[t];(e instanceof Cn||e instanceof Pn||e instanceof An)&&e.destroy()}};var Ln=function(t,e,r){void 0===r&&(r=function(){return!0}),this.programConfigurations={};for(var o=0,i=t;o<i.length;o+=1){var a=i[o];this.programConfigurations[a.id]=new Mn(a,e,r)}this.needsUpload=!1,this._featureMap=new dn,this._bufferOffset=0};function Rn(t,e){return{"text-opacity":["opacity"],"icon-opacity":["opacity"],"text-color":["fill_color"],"icon-color":["fill_color"],"text-halo-color":["halo_color"],"icon-halo-color":["halo_color"],"text-halo-blur":["halo_blur"],"icon-halo-blur":["halo_blur"],"text-halo-width":["halo_width"],"icon-halo-width":["halo_width"],"line-gap-width":["gapwidth"],"line-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"],"fill-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"],"fill-extrusion-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"]}[t]||[t.replace(e+"-","").replace(/-/g,"_")]}function Dn(t,e,r){var o={color:{source:Ho,composite:Ko},number:{source:jo,composite:Ho}},i=function(t){return{"line-pattern":{source:Po,composite:Po},"fill-pattern":{source:Po,composite:Po},"fill-extrusion-pattern":{source:Po,composite:Po}}[t]}(t);return i&&i[r]||o[e][r]}Ln.prototype.populatePaintArrays=function(t,e,r,o,i,a){for(var n in this.programConfigurations)this.programConfigurations[n].populatePaintArrays(t,e,o,i,a);void 0!==e.id&&this._featureMap.add(e.id,r,this._bufferOffset,t),this._bufferOffset=t,this.needsUpload=!0},Ln.prototype.updatePaintArrays=function(t,e,r,o){for(var i=0,a=r;i<a.length;i+=1){var n=a[i];this.needsUpload=this.programConfigurations[n.id].updatePaintArrays(t,this._featureMap,e,n,o)||this.needsUpload}},Ln.prototype.get=function(t){return this.programConfigurations[t]},Ln.prototype.upload=function(t){if(this.needsUpload){for(var e in this.programConfigurations)this.programConfigurations[e].upload(t);this.needsUpload=!1}},Ln.prototype.destroy=function(){for(var t in this.programConfigurations)this.programConfigurations[t].destroy()},Oi("ConstantBinder",In),Oi("CrossFadedConstantBinder",zn),Oi("SourceExpressionBinder",Cn),Oi("CrossFadedCompositeBinder",An),Oi("CompositeExpressionBinder",Pn),Oi("ProgramConfiguration",Mn,{omit:["_buffers"]}),Oi("ProgramConfigurationSet",Ln);var On=Math.pow(2,14)-1,Bn=-On-1;function Fn(t){for(var e=8192/t.extent,r=t.loadGeometry(),o=0;o<r.length;o++)for(var i=r[o],a=0;a<i.length;a++){var n=i[a],s=Math.round(n.x*e),u=Math.round(n.y*e);n.x=l(s,Bn,On),n.y=l(u,Bn,On),(s<n.x||s>n.x+1||u<n.y||u>n.y+1)&&w("Geometry exceeds allowed extent, reduce your vector tile buffer size")}return r}function Un(t,e,r,o,i){t.emplaceBack(2*e+(o+1)/2,2*r+(i+1)/2)}var Nn=function(t){this.zoom=t.zoom,this.overscaling=t.overscaling,this.layers=t.layers,this.layerIds=this.layers.map((function(t){return t.id})),this.index=t.index,this.hasPattern=!1,this.layoutVertexArray=new To,this.indexArray=new Fo,this.segments=new an,this.programConfigurations=new Ln(t.layers,t.zoom),this.stateDependentLayerIds=this.layers.filter((function(t){return t.isStateDependent()})).map((function(t){return t.id}))};function jn(t,e){for(var r=0;r<t.length;r++)if($n(e,t[r]))return!0;for(var o=0;o<e.length;o++)if($n(t,e[o]))return!0;return!!Zn(t,e)}function Vn(t,e,r){return!!$n(t,e)||!!Kn(e,t,r)}function qn(t,e){if(1===t.length)return Xn(e,t[0]);for(var r=0;r<e.length;r++)for(var o=e[r],i=0;i<o.length;i++)if($n(t,o[i]))return!0;for(var a=0;a<t.length;a++)if(Xn(e,t[a]))return!0;for(var n=0;n<e.length;n++)if(Zn(t,e[n]))return!0;return!1}function Gn(t,e,r){if(t.length>1){if(Zn(t,e))return!0;for(var o=0;o<e.length;o++)if(Kn(e[o],t,r))return!0}for(var i=0;i<t.length;i++)if(Kn(t[i],e,r))return!0;return!1}function Zn(t,e){if(0===t.length||0===e.length)return!1;for(var r=0;r<t.length-1;r++)for(var o=t[r],i=t[r+1],a=0;a<e.length-1;a++)if(Hn(o,i,e[a],e[a+1]))return!0;return!1}function Hn(t,e,r,o){return E(t,r,o)!==E(e,r,o)&&E(t,e,r)!==E(t,e,o)}function Kn(t,e,r){var o=r*r;if(1===e.length)return t.distSqr(e[0])<o;for(var i=1;i<e.length;i++)if(Wn(t,e[i-1],e[i])<o)return!0;return!1}function Wn(t,e,r){var o=e.distSqr(r);if(0===o)return t.distSqr(e);var i=((t.x-e.x)*(r.x-e.x)+(t.y-e.y)*(r.y-e.y))/o;return t.distSqr(i<0?e:i>1?r:r.sub(e)._mult(i)._add(e))}function Xn(t,e){for(var r,o,i,a=!1,n=0;n<t.length;n++)for(var s=0,u=(r=t[n]).length-1;s<r.length;u=s++)(o=r[s]).y>e.y!=(i=r[u]).y>e.y&&e.x<(i.x-o.x)*(e.y-o.y)/(i.y-o.y)+o.x&&(a=!a);return a}function $n(t,e){for(var r=!1,o=0,i=t.length-1;o<t.length;i=o++){var a=t[o],n=t[i];a.y>e.y!=n.y>e.y&&e.x<(n.x-a.x)*(e.y-a.y)/(n.y-a.y)+a.x&&(r=!r)}return r}function Jn(t,e,r){var o=r[0],i=r[2];if(t.x<o.x&&e.x<o.x||t.x>i.x&&e.x>i.x||t.y<o.y&&e.y<o.y||t.y>i.y&&e.y>i.y)return!1;var a=E(t,e,r[0]);return a!==E(t,e,r[1])||a!==E(t,e,r[2])||a!==E(t,e,r[3])}function Yn(t,e,r){var o=e.paint.get(t).value;return"constant"===o.kind?o.value:r.programConfigurations.get(e.id).getMaxValue(t)}function Qn(t){return Math.sqrt(t[0]*t[0]+t[1]*t[1])}function ta(t,e,r,o,a){if(!e[0]&&!e[1])return t;var n=i.convert(e)._mult(a);"viewport"===r&&n._rotate(-o);for(var s=[],u=0;u<t.length;u++)s.push(t[u].sub(n));return s}Nn.prototype.populate=function(t,e,r){var o=this.layers[0],i=[],a=null;"circle"===o.type&&(a=o.layout.get("circle-sort-key"));for(var n=0,s=t;n<s.length;n+=1){var u=s[n],l=u.feature,p=u.id,c=u.index,h=u.sourceLayerIndex,d=this.layers[0]._featureFilter.needGeometry,f={type:l.type,id:p,properties:l.properties,geometry:d?Fn(l):[]};if(this.layers[0]._featureFilter.filter(new no(this.zoom),f,r)){d||(f.geometry=Fn(l));var m=a?a.evaluate(f,{},r):void 0;i.push({id:p,properties:l.properties,type:l.type,sourceLayerIndex:h,index:c,geometry:f.geometry,patterns:{},sortKey:m})}}a&&i.sort((function(t,e){return t.sortKey-e.sortKey}));for(var y=0,v=i;y<v.length;y+=1){var g=v[y],_=g.geometry,b=g.index,x=g.sourceLayerIndex,w=t[b].feature;this.addFeature(g,_,b,r),e.featureIndex.insert(w,_,b,x,this.index)}},Nn.prototype.update=function(t,e,r){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(t,e,this.stateDependentLayers,r)},Nn.prototype.isEmpty=function(){return 0===this.layoutVertexArray.length},Nn.prototype.uploadPending=function(){return!this.uploaded||this.programConfigurations.needsUpload},Nn.prototype.upload=function(t){this.uploaded||(this.layoutVertexBuffer=t.createVertexBuffer(this.layoutVertexArray,nn),this.indexBuffer=t.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(t),this.uploaded=!0},Nn.prototype.destroy=function(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())},Nn.prototype.addFeature=function(t,e,r,o){for(var i=0,a=e;i<a.length;i+=1)for(var n=0,s=a[i];n<s.length;n+=1){var u=s[n],l=u.x,p=u.y;if(!(l<0||l>=8192||p<0||p>=8192)){var c=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray,t.sortKey),h=c.vertexLength;Un(this.layoutVertexArray,l,p,-1,-1),Un(this.layoutVertexArray,l,p,1,-1),Un(this.layoutVertexArray,l,p,1,1),Un(this.layoutVertexArray,l,p,-1,1),this.indexArray.emplaceBack(h,h+1,h+2),this.indexArray.emplaceBack(h,h+3,h+2),c.vertexLength+=4,c.primitiveLength+=2}}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,t,r,{},o)},Oi("CircleBucket",Nn,{omit:["layers"]});var ea=new _o({"circle-sort-key":new mo(It.layout_circle["circle-sort-key"])}),ra={paint:new _o({"circle-radius":new mo(It.paint_circle["circle-radius"]),"circle-color":new mo(It.paint_circle["circle-color"]),"circle-blur":new mo(It.paint_circle["circle-blur"]),"circle-opacity":new mo(It.paint_circle["circle-opacity"]),"circle-translate":new fo(It.paint_circle["circle-translate"]),"circle-translate-anchor":new fo(It.paint_circle["circle-translate-anchor"]),"circle-pitch-scale":new fo(It.paint_circle["circle-pitch-scale"]),"circle-pitch-alignment":new fo(It.paint_circle["circle-pitch-alignment"]),"circle-stroke-width":new mo(It.paint_circle["circle-stroke-width"]),"circle-stroke-color":new mo(It.paint_circle["circle-stroke-color"]),"circle-stroke-opacity":new mo(It.paint_circle["circle-stroke-opacity"])}),layout:ea},ia="undefined"!=typeof Float32Array?Float32Array:Array;function oa(t){return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function na(t,e,r){var o=e[0],i=e[1],a=e[2],n=e[3],s=e[4],u=e[5],l=e[6],p=e[7],c=e[8],h=e[9],d=e[10],f=e[11],m=e[12],y=e[13],v=e[14],g=e[15],_=r[0],b=r[1],x=r[2],w=r[3];return t[0]=_*o+b*s+x*c+w*m,t[1]=_*i+b*u+x*h+w*y,t[2]=_*a+b*l+x*d+w*v,t[3]=_*n+b*p+x*f+w*g,t[4]=(_=r[4])*o+(b=r[5])*s+(x=r[6])*c+(w=r[7])*m,t[5]=_*i+b*u+x*h+w*y,t[6]=_*a+b*l+x*d+w*v,t[7]=_*n+b*p+x*f+w*g,t[8]=(_=r[8])*o+(b=r[9])*s+(x=r[10])*c+(w=r[11])*m,t[9]=_*i+b*u+x*h+w*y,t[10]=_*a+b*l+x*d+w*v,t[11]=_*n+b*p+x*f+w*g,t[12]=(_=r[12])*o+(b=r[13])*s+(x=r[14])*c+(w=r[15])*m,t[13]=_*i+b*u+x*h+w*y,t[14]=_*a+b*l+x*d+w*v,t[15]=_*n+b*p+x*f+w*g,t}Math.hypot||(Math.hypot=function(){for(var t=arguments,e=0,r=arguments.length;r--;)e+=t[r]*t[r];return Math.sqrt(e)});var aa,sa=na;function la(t,e,r){var o=e[0],i=e[1],a=e[2],n=e[3];return t[0]=r[0]*o+r[4]*i+r[8]*a+r[12]*n,t[1]=r[1]*o+r[5]*i+r[9]*a+r[13]*n,t[2]=r[2]*o+r[6]*i+r[10]*a+r[14]*n,t[3]=r[3]*o+r[7]*i+r[11]*a+r[15]*n,t}aa=new ia(3),ia!=Float32Array&&(aa[0]=0,aa[1]=0,aa[2]=0),function(){var t=new ia(4);ia!=Float32Array&&(t[0]=0,t[1]=0,t[2]=0,t[3]=0)}();var ua=(function(){var t=new ia(2);ia!=Float32Array&&(t[0]=0,t[1]=0)}(),function(t){function e(e){t.call(this,e,ra)}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e,e.prototype.createBucket=function(t){return new Nn(t)},e.prototype.queryRadius=function(t){var e=t;return Yn("circle-radius",this,e)+Yn("circle-stroke-width",this,e)+Qn(this.paint.get("circle-translate"))},e.prototype.queryIntersectsFeature=function(t,e,r,o,i,a,n,s){for(var u=ta(t,this.paint.get("circle-translate"),this.paint.get("circle-translate-anchor"),a.angle,n),l=this.paint.get("circle-radius").evaluate(e,r)+this.paint.get("circle-stroke-width").evaluate(e,r),p="map"===this.paint.get("circle-pitch-alignment"),c=p?u:function(t,e){return t.map((function(t){return ca(t,e)}))}(u,s),h=p?l*n:l,d=0,f=o;d<f.length;d+=1)for(var m=0,y=f[d];m<y.length;m+=1){var v=y[m],g=p?v:ca(v,s),_=h,b=la([],[v.x,v.y,0,1],s);if("viewport"===this.paint.get("circle-pitch-scale")&&"map"===this.paint.get("circle-pitch-alignment")?_*=b[3]/a.cameraToCenterDistance:"map"===this.paint.get("circle-pitch-scale")&&"viewport"===this.paint.get("circle-pitch-alignment")&&(_*=a.cameraToCenterDistance/b[3]),Vn(c,g,_))return!0}return!1},e}(xo));function ca(t,e){var r=la([],[t.x,t.y,0,1],e);return new i(r[0]/r[3],r[1]/r[3])}var pa=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e,e}(Nn);function ha(t,e,r,o){var i=e.width,a=e.height;if(o){if(o instanceof Uint8ClampedArray)o=new Uint8Array(o.buffer);else if(o.length!==i*a*r)throw new RangeError("mismatched image size")}else o=new Uint8Array(i*a*r);return t.width=i,t.height=a,t.data=o,t}function da(t,e,r){var o=e.width,i=e.height;if(o!==t.width||i!==t.height){var a=ha({},{width:o,height:i},r);fa(t,a,{x:0,y:0},{x:0,y:0},{width:Math.min(t.width,o),height:Math.min(t.height,i)},r),t.width=o,t.height=i,t.data=a.data}}function fa(t,e,r,o,i,a){if(0===i.width||0===i.height)return e;if(i.width>t.width||i.height>t.height||r.x>t.width-i.width||r.y>t.height-i.height)throw new RangeError("out of range source coordinates for image copy");if(i.width>e.width||i.height>e.height||o.x>e.width-i.width||o.y>e.height-i.height)throw new RangeError("out of range destination coordinates for image copy");for(var n=t.data,s=e.data,u=0;u<i.height;u++)for(var l=((r.y+u)*t.width+r.x)*a,p=((o.y+u)*e.width+o.x)*a,c=0;c<i.width*a;c++)s[p+c]=n[l+c];return e}Oi("HeatmapBucket",pa,{omit:["layers"]});var ma=function(t,e){ha(this,t,1,e)};ma.prototype.resize=function(t){da(this,t,1)},ma.prototype.clone=function(){return new ma({width:this.width,height:this.height},new Uint8Array(this.data))},ma.copy=function(t,e,r,o,i){fa(t,e,r,o,i,1)};var ga=function(t,e){ha(this,t,4,e)};ga.prototype.resize=function(t){da(this,t,4)},ga.prototype.replace=function(t,e){e?this.data.set(t):this.data=t instanceof Uint8ClampedArray?new Uint8Array(t.buffer):t},ga.prototype.clone=function(){return new ga({width:this.width,height:this.height},new Uint8Array(this.data))},ga.copy=function(t,e,r,o,i){fa(t,e,r,o,i,4)},Oi("AlphaImage",ma),Oi("RGBAImage",ga);var ya={paint:new _o({"heatmap-radius":new mo(It.paint_heatmap["heatmap-radius"]),"heatmap-weight":new mo(It.paint_heatmap["heatmap-weight"]),"heatmap-intensity":new fo(It.paint_heatmap["heatmap-intensity"]),"heatmap-color":new vo(It.paint_heatmap["heatmap-color"]),"heatmap-opacity":new fo(It.paint_heatmap["heatmap-opacity"])})};function va(t,e){for(var r=new Uint8Array(1024),o={},i=0,a=0;i<256;i++,a+=4){o[e]=i/255;var n=t.evaluate(o);r[a+0]=Math.floor(255*n.r/n.a),r[a+1]=Math.floor(255*n.g/n.a),r[a+2]=Math.floor(255*n.b/n.a),r[a+3]=Math.floor(255*n.a)}return new ga({width:256,height:1},r)}var _a=function(t){function e(e){t.call(this,e,ya),this._updateColorRamp()}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e,e.prototype.createBucket=function(t){return new pa(t)},e.prototype._handleSpecialPaintPropertyUpdate=function(t){"heatmap-color"===t&&this._updateColorRamp()},e.prototype._updateColorRamp=function(){this.colorRamp=va(this._transitionablePaint._values["heatmap-color"].value.expression,"heatmapDensity"),this.colorRampTexture=null},e.prototype.resize=function(){this.heatmapFbo&&(this.heatmapFbo.destroy(),this.heatmapFbo=null)},e.prototype.queryRadius=function(){return 0},e.prototype.queryIntersectsFeature=function(){return!1},e.prototype.hasOffscreenPass=function(){return 0!==this.paint.get("heatmap-opacity")&&"none"!==this.visibility},e}(xo),xa={paint:new _o({"hillshade-illumination-direction":new fo(It.paint_hillshade["hillshade-illumination-direction"]),"hillshade-illumination-anchor":new fo(It.paint_hillshade["hillshade-illumination-anchor"]),"hillshade-exaggeration":new fo(It.paint_hillshade["hillshade-exaggeration"]),"hillshade-shadow-color":new fo(It.paint_hillshade["hillshade-shadow-color"]),"hillshade-highlight-color":new fo(It.paint_hillshade["hillshade-highlight-color"]),"hillshade-accent-color":new fo(It.paint_hillshade["hillshade-accent-color"])})},ba=function(t){function e(e){t.call(this,e,xa)}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e,e.prototype.hasOffscreenPass=function(){return 0!==this.paint.get("hillshade-exaggeration")&&"none"!==this.visibility},e}(xo),wa=ko([{name:"a_pos",components:2,type:"Int16"}],4).members,Ea=Sa,ka=Sa;function Sa(t,e,r){r=r||2;var o,i,a,n,s,u,l,p=e&&e.length,c=p?e[0]*r:t.length,h=Ta(t,0,c,r,!0),d=[];if(!h||h.next===h.prev)return d;if(p&&(h=function(t,e,r,o){var i,a,n,s=[];for(i=0,a=e.length;i<a;i++)(n=Ta(t,e[i]*o,i<a-1?e[i+1]*o:t.length,o,!1))===n.next&&(n.steiner=!0),s.push(Ba(n));for(s.sort(La),i=0;i<s.length;i++)Ra(s[i],r),r=Ia(r,r.next);return r}(t,e,h,r)),t.length>80*r){o=a=t[0],i=n=t[1];for(var f=r;f<c;f+=r)(s=t[f])<o&&(o=s),(u=t[f+1])<i&&(i=u),s>a&&(a=s),u>n&&(n=u);l=0!==(l=Math.max(a-o,n-i))?1/l:0}return za(h,d,r,o,i,l),d}function Ta(t,e,r,o,i){var a,n;if(i===$a(t,e,r,o)>0)for(a=e;a<r;a+=o)n=Ka(a,t[a],t[a+1],n);else for(a=r-o;a>=e;a-=o)n=Ka(a,t[a],t[a+1],n);return n&&ja(n,n.next)&&(Wa(n),n=n.next),n}function Ia(t,e){if(!t)return t;e||(e=t);var r,o=t;do{if(r=!1,o.steiner||!ja(o,o.next)&&0!==Na(o.prev,o,o.next))o=o.next;else{if(Wa(o),(o=e=o.prev)===o.next)break;r=!0}}while(r||o!==e);return e}function za(t,e,r,o,i,a,n){if(t){!n&&a&&function(t,e,r,o){var i=t;do{null===i.z&&(i.z=Oa(i.x,i.y,e,r,o)),i.prevZ=i.prev,i.nextZ=i.next,i=i.next}while(i!==t);i.prevZ.nextZ=null,i.prevZ=null,function(t){var e,r,o,i,a,n,s,u,l=1;do{for(r=t,t=null,a=null,n=0;r;){for(n++,o=r,s=0,e=0;e<l&&(s++,o=o.nextZ);e++);for(u=l;s>0||u>0&&o;)0!==s&&(0===u||!o||r.z<=o.z)?(i=r,r=r.nextZ,s--):(i=o,o=o.nextZ,u--),a?a.nextZ=i:t=i,i.prevZ=a,a=i;r=o}a.nextZ=null,l*=2}while(n>1)}(i)}(t,o,i,a);for(var s,u,l=t;t.prev!==t.next;)if(s=t.prev,u=t.next,a?Pa(t,o,i,a):Ca(t))e.push(s.i/r),e.push(t.i/r),e.push(u.i/r),Wa(t),t=u.next,l=u.next;else if((t=u)===l){n?1===n?za(t=Aa(Ia(t),e,r),e,r,o,i,a,2):2===n&&Ma(t,e,r,o,i,a):za(Ia(t),e,r,o,i,a,1);break}}}function Ca(t){var e=t.prev,r=t,o=t.next;if(Na(e,r,o)>=0)return!1;for(var i=t.next.next;i!==t.prev;){if(Fa(e.x,e.y,r.x,r.y,o.x,o.y,i.x,i.y)&&Na(i.prev,i,i.next)>=0)return!1;i=i.next}return!0}function Pa(t,e,r,o){var i=t.prev,a=t,n=t.next;if(Na(i,a,n)>=0)return!1;for(var s=i.x>a.x?i.x>n.x?i.x:n.x:a.x>n.x?a.x:n.x,u=i.y>a.y?i.y>n.y?i.y:n.y:a.y>n.y?a.y:n.y,l=Oa(i.x<a.x?i.x<n.x?i.x:n.x:a.x<n.x?a.x:n.x,i.y<a.y?i.y<n.y?i.y:n.y:a.y<n.y?a.y:n.y,e,r,o),p=Oa(s,u,e,r,o),c=t.prevZ,h=t.nextZ;c&&c.z>=l&&h&&h.z<=p;){if(c!==t.prev&&c!==t.next&&Fa(i.x,i.y,a.x,a.y,n.x,n.y,c.x,c.y)&&Na(c.prev,c,c.next)>=0)return!1;if(c=c.prevZ,h!==t.prev&&h!==t.next&&Fa(i.x,i.y,a.x,a.y,n.x,n.y,h.x,h.y)&&Na(h.prev,h,h.next)>=0)return!1;h=h.nextZ}for(;c&&c.z>=l;){if(c!==t.prev&&c!==t.next&&Fa(i.x,i.y,a.x,a.y,n.x,n.y,c.x,c.y)&&Na(c.prev,c,c.next)>=0)return!1;c=c.prevZ}for(;h&&h.z<=p;){if(h!==t.prev&&h!==t.next&&Fa(i.x,i.y,a.x,a.y,n.x,n.y,h.x,h.y)&&Na(h.prev,h,h.next)>=0)return!1;h=h.nextZ}return!0}function Aa(t,e,r){var o=t;do{var i=o.prev,a=o.next.next;!ja(i,a)&&Va(i,o,o.next,a)&&Za(i,a)&&Za(a,i)&&(e.push(i.i/r),e.push(o.i/r),e.push(a.i/r),Wa(o),Wa(o.next),o=t=a),o=o.next}while(o!==t);return Ia(o)}function Ma(t,e,r,o,i,a){var n=t;do{for(var s=n.next.next;s!==n.prev;){if(n.i!==s.i&&Ua(n,s)){var u=Ha(n,s);return n=Ia(n,n.next),u=Ia(u,u.next),za(n,e,r,o,i,a),void za(u,e,r,o,i,a)}s=s.next}n=n.next}while(n!==t)}function La(t,e){return t.x-e.x}function Ra(t,e){if(e=function(t,e){var r,o=e,i=t.x,a=t.y,n=-1/0;do{if(a<=o.y&&a>=o.next.y&&o.next.y!==o.y){var s=o.x+(a-o.y)*(o.next.x-o.x)/(o.next.y-o.y);if(s<=i&&s>n){if(n=s,s===i){if(a===o.y)return o;if(a===o.next.y)return o.next}r=o.x<o.next.x?o:o.next}}o=o.next}while(o!==e);if(!r)return null;if(i===n)return r;var u,l=r,p=r.x,c=r.y,h=1/0;o=r;do{i>=o.x&&o.x>=p&&i!==o.x&&Fa(a<c?i:n,a,p,c,a<c?n:i,a,o.x,o.y)&&(u=Math.abs(a-o.y)/(i-o.x),Za(o,t)&&(u<h||u===h&&(o.x>r.x||o.x===r.x&&Da(r,o)))&&(r=o,h=u)),o=o.next}while(o!==l);return r}(t,e)){var r=Ha(e,t);Ia(e,e.next),Ia(r,r.next)}}function Da(t,e){return Na(t.prev,t,e.prev)<0&&Na(e.next,t,t.next)<0}function Oa(t,e,r,o,i){return(t=1431655765&((t=858993459&((t=252645135&((t=16711935&((t=32767*(t-r)*i)|t<<8))|t<<4))|t<<2))|t<<1))|(e=1431655765&((e=858993459&((e=252645135&((e=16711935&((e=32767*(e-o)*i)|e<<8))|e<<4))|e<<2))|e<<1))<<1}function Ba(t){var e=t,r=t;do{(e.x<r.x||e.x===r.x&&e.y<r.y)&&(r=e),e=e.next}while(e!==t);return r}function Fa(t,e,r,o,i,a,n,s){return(i-n)*(e-s)-(t-n)*(a-s)>=0&&(t-n)*(o-s)-(r-n)*(e-s)>=0&&(r-n)*(a-s)-(i-n)*(o-s)>=0}function Ua(t,e){return t.next.i!==e.i&&t.prev.i!==e.i&&!function(t,e){var r=t;do{if(r.i!==t.i&&r.next.i!==t.i&&r.i!==e.i&&r.next.i!==e.i&&Va(r,r.next,t,e))return!0;r=r.next}while(r!==t);return!1}(t,e)&&(Za(t,e)&&Za(e,t)&&function(t,e){var r=t,o=!1,i=(t.x+e.x)/2,a=(t.y+e.y)/2;do{r.y>a!=r.next.y>a&&r.next.y!==r.y&&i<(r.next.x-r.x)*(a-r.y)/(r.next.y-r.y)+r.x&&(o=!o),r=r.next}while(r!==t);return o}(t,e)&&(Na(t.prev,t,e.prev)||Na(t,e.prev,e))||ja(t,e)&&Na(t.prev,t,t.next)>0&&Na(e.prev,e,e.next)>0)}function Na(t,e,r){return(e.y-t.y)*(r.x-e.x)-(e.x-t.x)*(r.y-e.y)}function ja(t,e){return t.x===e.x&&t.y===e.y}function Va(t,e,r,o){var i=Ga(Na(t,e,r)),a=Ga(Na(t,e,o)),n=Ga(Na(r,o,t)),s=Ga(Na(r,o,e));return i!==a&&n!==s||!(0!==i||!qa(t,r,e))||!(0!==a||!qa(t,o,e))||!(0!==n||!qa(r,t,o))||!(0!==s||!qa(r,e,o))}function qa(t,e,r){return e.x<=Math.max(t.x,r.x)&&e.x>=Math.min(t.x,r.x)&&e.y<=Math.max(t.y,r.y)&&e.y>=Math.min(t.y,r.y)}function Ga(t){return t>0?1:t<0?-1:0}function Za(t,e){return Na(t.prev,t,t.next)<0?Na(t,e,t.next)>=0&&Na(t,t.prev,e)>=0:Na(t,e,t.prev)<0||Na(t,t.next,e)<0}function Ha(t,e){var r=new Xa(t.i,t.x,t.y),o=new Xa(e.i,e.x,e.y),i=t.next,a=e.prev;return t.next=e,e.prev=t,r.next=i,i.prev=r,o.next=r,r.prev=o,a.next=o,o.prev=a,o}function Ka(t,e,r,o){var i=new Xa(t,e,r);return o?(i.next=o.next,i.prev=o,o.next.prev=i,o.next=i):(i.prev=i,i.next=i),i}function Wa(t){t.next.prev=t.prev,t.prev.next=t.next,t.prevZ&&(t.prevZ.nextZ=t.nextZ),t.nextZ&&(t.nextZ.prevZ=t.prevZ)}function Xa(t,e,r){this.i=t,this.x=e,this.y=r,this.prev=null,this.next=null,this.z=null,this.prevZ=null,this.nextZ=null,this.steiner=!1}function $a(t,e,r,o){for(var i=0,a=e,n=r-o;a<r;a+=o)i+=(t[n]-t[a])*(t[a+1]+t[n+1]),n=a;return i}function Ja(t,e,r,o,i){!function t(e,r,o,i,a){for(;i>o;){if(i-o>600){var n=i-o+1,s=r-o+1,u=Math.log(n),l=.5*Math.exp(2*u/3),p=.5*Math.sqrt(u*l*(n-l)/n)*(s-n/2<0?-1:1);t(e,r,Math.max(o,Math.floor(r-s*l/n+p)),Math.min(i,Math.floor(r+(n-s)*l/n+p)),a)}var c=e[r],h=o,d=i;for(Ya(e,o,r),a(e[i],c)>0&&Ya(e,o,i);h<d;){for(Ya(e,h,d),h++,d--;a(e[h],c)<0;)h++;for(;a(e[d],c)>0;)d--}0===a(e[o],c)?Ya(e,o,d):Ya(e,++d,i),d<=r&&(o=d+1),r<=d&&(i=d-1)}}(t,e,r||0,o||t.length-1,i||Qa)}function Ya(t,e,r){var o=t[e];t[e]=t[r],t[r]=o}function Qa(t,e){return t<e?-1:t>e?1:0}function ts(t,e){var r=t.length;if(r<=1)return[t];for(var o,i,a=[],n=0;n<r;n++){var s=k(t[n]);0!==s&&(t[n].area=Math.abs(s),void 0===i&&(i=s<0),i===s<0?(o&&a.push(o),o=[t[n]]):o.push(t[n]))}if(o&&a.push(o),e>1)for(var u=0;u<a.length;u++)a[u].length<=e||(Ja(a[u],e,1,a[u].length-1,es),a[u]=a[u].slice(0,e));return a}function es(t,e){return e.area-t.area}function rs(t,e,r){for(var o=r.patternDependencies,i=!1,a=0,n=e;a<n.length;a+=1){var s=n[a].paint.get(t+"-pattern");s.isConstant()||(i=!0);var u=s.constantOr(null);u&&(i=!0,o[u.to]=!0,o[u.from]=!0)}return i}function is(t,e,r,o,i){for(var a=i.patternDependencies,n=0,s=e;n<s.length;n+=1){var u=s[n],l=u.paint.get(t+"-pattern").value;if("constant"!==l.kind){var p=l.evaluate({zoom:o-1},r,{},i.availableImages),c=l.evaluate({zoom:o},r,{},i.availableImages),h=l.evaluate({zoom:o+1},r,{},i.availableImages);c=c&&c.name?c.name:c,h=h&&h.name?h.name:h,a[p=p&&p.name?p.name:p]=!0,a[c]=!0,a[h]=!0,r.patterns[u.id]={min:p,mid:c,max:h}}}return r}Sa.deviation=function(t,e,r,o){var i=e&&e.length,a=Math.abs($a(t,0,i?e[0]*r:t.length,r));if(i)for(var n=0,s=e.length;n<s;n++)a-=Math.abs($a(t,e[n]*r,n<s-1?e[n+1]*r:t.length,r));var u=0;for(n=0;n<o.length;n+=3){var l=o[n]*r,p=o[n+1]*r,c=o[n+2]*r;u+=Math.abs((t[l]-t[c])*(t[p+1]-t[l+1])-(t[l]-t[p])*(t[c+1]-t[l+1]))}return 0===a&&0===u?0:Math.abs((u-a)/a)},Sa.flatten=function(t){for(var e=t[0][0].length,r={vertices:[],holes:[],dimensions:e},o=0,i=0;i<t.length;i++){for(var a=0;a<t[i].length;a++)for(var n=0;n<e;n++)r.vertices.push(t[i][a][n]);i>0&&r.holes.push(o+=t[i-1].length)}return r},Ea.default=ka;var os=function(t){this.zoom=t.zoom,this.overscaling=t.overscaling,this.layers=t.layers,this.layerIds=this.layers.map((function(t){return t.id})),this.index=t.index,this.hasPattern=!1,this.patternFeatures=[],this.layoutVertexArray=new To,this.indexArray=new Fo,this.indexArray2=new Go,this.programConfigurations=new Ln(t.layers,t.zoom),this.segments=new an,this.segments2=new an,this.stateDependentLayerIds=this.layers.filter((function(t){return t.isStateDependent()})).map((function(t){return t.id}))};os.prototype.populate=function(t,e,r){this.hasPattern=rs("fill",this.layers,e);for(var o=this.layers[0].layout.get("fill-sort-key"),i=[],a=0,n=t;a<n.length;a+=1){var s=n[a],u=s.feature,l=s.id,p=s.index,c=s.sourceLayerIndex,h=this.layers[0]._featureFilter.needGeometry,d={type:u.type,id:l,properties:u.properties,geometry:h?Fn(u):[]};if(this.layers[0]._featureFilter.filter(new no(this.zoom),d,r)){h||(d.geometry=Fn(u));var f=o?o.evaluate(d,{},r,e.availableImages):void 0;i.push({id:l,properties:u.properties,type:u.type,sourceLayerIndex:c,index:p,geometry:d.geometry,patterns:{},sortKey:f})}}o&&i.sort((function(t,e){return t.sortKey-e.sortKey}));for(var m=0,y=i;m<y.length;m+=1){var v=y[m],g=v.geometry,_=v.index,b=v.sourceLayerIndex;if(this.hasPattern){var x=is("fill",this.layers,v,this.zoom,e);this.patternFeatures.push(x)}else this.addFeature(v,g,_,r,{});e.featureIndex.insert(t[_].feature,g,_,b,this.index)}},os.prototype.update=function(t,e,r){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(t,e,this.stateDependentLayers,r)},os.prototype.addFeatures=function(t,e,r){for(var o=0,i=this.patternFeatures;o<i.length;o+=1){var a=i[o];this.addFeature(a,a.geometry,a.index,e,r)}},os.prototype.isEmpty=function(){return 0===this.layoutVertexArray.length},os.prototype.uploadPending=function(){return!this.uploaded||this.programConfigurations.needsUpload},os.prototype.upload=function(t){this.uploaded||(this.layoutVertexBuffer=t.createVertexBuffer(this.layoutVertexArray,wa),this.indexBuffer=t.createIndexBuffer(this.indexArray),this.indexBuffer2=t.createIndexBuffer(this.indexArray2)),this.programConfigurations.upload(t),this.uploaded=!0},os.prototype.destroy=function(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.indexBuffer2.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.segments2.destroy())},os.prototype.addFeature=function(t,e,r,o,i){for(var a=0,n=ts(e,500);a<n.length;a+=1){for(var s=n[a],u=0,l=0,p=s;l<p.length;l+=1)u+=p[l].length;for(var c=this.segments.prepareSegment(u,this.layoutVertexArray,this.indexArray),h=c.vertexLength,d=[],f=[],m=0,y=s;m<y.length;m+=1){var v=y[m];if(0!==v.length){v!==s[0]&&f.push(d.length/2);var g=this.segments2.prepareSegment(v.length,this.layoutVertexArray,this.indexArray2),_=g.vertexLength;this.layoutVertexArray.emplaceBack(v[0].x,v[0].y),this.indexArray2.emplaceBack(_+v.length-1,_),d.push(v[0].x),d.push(v[0].y);for(var b=1;b<v.length;b++)this.layoutVertexArray.emplaceBack(v[b].x,v[b].y),this.indexArray2.emplaceBack(_+b-1,_+b),d.push(v[b].x),d.push(v[b].y);g.vertexLength+=v.length,g.primitiveLength+=v.length}}for(var x=Ea(d,f),w=0;w<x.length;w+=3)this.indexArray.emplaceBack(h+x[w],h+x[w+1],h+x[w+2]);c.vertexLength+=u,c.primitiveLength+=x.length/3}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,t,r,i,o)},Oi("FillBucket",os,{omit:["layers","patternFeatures"]});var ns=new _o({"fill-sort-key":new mo(It.layout_fill["fill-sort-key"])}),as={paint:new _o({"fill-antialias":new fo(It.paint_fill["fill-antialias"]),"fill-opacity":new mo(It.paint_fill["fill-opacity"]),"fill-color":new mo(It.paint_fill["fill-color"]),"fill-outline-color":new mo(It.paint_fill["fill-outline-color"]),"fill-translate":new fo(It.paint_fill["fill-translate"]),"fill-translate-anchor":new fo(It.paint_fill["fill-translate-anchor"]),"fill-pattern":new go(It.paint_fill["fill-pattern"])}),layout:ns},ss=function(t){function e(e){t.call(this,e,as)}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e,e.prototype.recalculate=function(e,r){t.prototype.recalculate.call(this,e,r);var o=this.paint._values["fill-outline-color"];"constant"===o.value.kind&&void 0===o.value.value&&(this.paint._values["fill-outline-color"]=this.paint._values["fill-color"])},e.prototype.createBucket=function(t){return new os(t)},e.prototype.queryRadius=function(){return Qn(this.paint.get("fill-translate"))},e.prototype.queryIntersectsFeature=function(t,e,r,o,i,a,n){return qn(ta(t,this.paint.get("fill-translate"),this.paint.get("fill-translate-anchor"),a.angle,n),o)},e.prototype.isTileClipped=function(){return!0},e}(xo),ls=ko([{name:"a_pos",components:2,type:"Int16"},{name:"a_normal_ed",components:4,type:"Int16"}],4).members,us=cs;function cs(t,e,r,o,i){this.properties={},this.extent=r,this.type=0,this._pbf=t,this._geometry=-1,this._keys=o,this._values=i,t.readFields(ps,this,e)}function ps(t,e,r){1==t?e.id=r.readVarint():2==t?function(t,e){for(var r=t.readVarint()+t.pos;t.pos<r;){var o=e._keys[t.readVarint()],i=e._values[t.readVarint()];e.properties[o]=i}}(r,e):3==t?e.type=r.readVarint():4==t&&(e._geometry=r.pos)}function hs(t){for(var e,r,o=0,i=0,a=t.length,n=a-1;i<a;n=i++)o+=((r=t[n]).x-(e=t[i]).x)*(e.y+r.y);return o}cs.types=["Unknown","Point","LineString","Polygon"],cs.prototype.loadGeometry=function(){var t=this._pbf;t.pos=this._geometry;for(var e,r=t.readVarint()+t.pos,o=1,a=0,n=0,s=0,u=[];t.pos<r;){if(a<=0){var l=t.readVarint();o=7&l,a=l>>3}if(a--,1===o||2===o)n+=t.readSVarint(),s+=t.readSVarint(),1===o&&(e&&u.push(e),e=[]),e.push(new i(n,s));else{if(7!==o)throw new Error("unknown command "+o);e&&e.push(e[0].clone())}}return e&&u.push(e),u},cs.prototype.bbox=function(){var t=this._pbf;t.pos=this._geometry;for(var e=t.readVarint()+t.pos,r=1,o=0,i=0,a=0,n=1/0,s=-1/0,u=1/0,l=-1/0;t.pos<e;){if(o<=0){var p=t.readVarint();r=7&p,o=p>>3}if(o--,1===r||2===r)(i+=t.readSVarint())<n&&(n=i),i>s&&(s=i),(a+=t.readSVarint())<u&&(u=a),a>l&&(l=a);else if(7!==r)throw new Error("unknown command "+r)}return[n,u,s,l]},cs.prototype.toGeoJSON=function(t,e,r){var o,i,a=this.extent*Math.pow(2,r),n=this.extent*t,s=this.extent*e,u=this.loadGeometry(),l=cs.types[this.type];function p(t){for(var e=0;e<t.length;e++){var r=t[e];t[e]=[360*(r.x+n)/a-180,360/Math.PI*Math.atan(Math.exp((180-360*(r.y+s)/a)*Math.PI/180))-90]}}switch(this.type){case 1:var c=[];for(o=0;o<u.length;o++)c[o]=u[o][0];p(u=c);break;case 2:for(o=0;o<u.length;o++)p(u[o]);break;case 3:for(u=function(t){var e=t.length;if(e<=1)return[t];for(var r,o,i=[],a=0;a<e;a++){var n=hs(t[a]);0!==n&&(void 0===o&&(o=n<0),o===n<0?(r&&i.push(r),r=[t[a]]):r.push(t[a]))}return r&&i.push(r),i}(u),o=0;o<u.length;o++)for(i=0;i<u[o].length;i++)p(u[o][i])}1===u.length?u=u[0]:l="Multi"+l;var h={type:"Feature",geometry:{type:l,coordinates:u},properties:this.properties};return"id"in this&&(h.id=this.id),h};var ds=fs;function fs(t,e){this.version=1,this.name=null,this.extent=4096,this.length=0,this._pbf=t,this._keys=[],this._values=[],this._features=[],t.readFields(ms,this,e),this.length=this._features.length}function ms(t,e,r){15===t?e.version=r.readVarint():1===t?e.name=r.readString():5===t?e.extent=r.readVarint():2===t?e._features.push(r.pos):3===t?e._keys.push(r.readString()):4===t&&e._values.push(function(t){for(var e=null,r=t.readVarint()+t.pos;t.pos<r;){var o=t.readVarint()>>3;e=1===o?t.readString():2===o?t.readFloat():3===o?t.readDouble():4===o?t.readVarint64():5===o?t.readVarint():6===o?t.readSVarint():7===o?t.readBoolean():null}return e}(r))}function gs(t,e,r){if(3===t){var o=new ds(r,r.readVarint()+r.pos);o.length&&(e[o.name]=o)}}fs.prototype.feature=function(t){if(t<0||t>=this._features.length)throw new Error("feature index out of bounds");this._pbf.pos=this._features[t];var e=this._pbf.readVarint()+this._pbf.pos;return new us(this._pbf,e,this.extent,this._keys,this._values)};var ys={VectorTile:function(t,e){this.layers=t.readFields(gs,{},e)},VectorTileFeature:us,VectorTileLayer:ds},vs=ys.VectorTileFeature.types,_s=Math.pow(2,13);function xs(t,e,r,o,i,a,n,s){t.emplaceBack(e,r,2*Math.floor(o*_s)+n,i*_s*2,a*_s*2,Math.round(s))}var bs=function(t){this.zoom=t.zoom,this.overscaling=t.overscaling,this.layers=t.layers,this.layerIds=this.layers.map((function(t){return t.id})),this.index=t.index,this.hasPattern=!1,this.layoutVertexArray=new zo,this.indexArray=new Fo,this.programConfigurations=new Ln(t.layers,t.zoom),this.segments=new an,this.stateDependentLayerIds=this.layers.filter((function(t){return t.isStateDependent()})).map((function(t){return t.id}))};function ws(t,e){return t.x===e.x&&(t.x<0||t.x>8192)||t.y===e.y&&(t.y<0||t.y>8192)}bs.prototype.populate=function(t,e,r){this.features=[],this.hasPattern=rs("fill-extrusion",this.layers,e);for(var o=0,i=t;o<i.length;o+=1){var a=i[o],n=a.feature,s=a.id,u=a.index,l=a.sourceLayerIndex,p=this.layers[0]._featureFilter.needGeometry,c={type:n.type,id:s,properties:n.properties,geometry:p?Fn(n):[]};if(this.layers[0]._featureFilter.filter(new no(this.zoom),c,r)){var h={id:s,sourceLayerIndex:l,index:u,geometry:p?c.geometry:Fn(n),properties:n.properties,type:n.type,patterns:{}};void 0!==n.id&&(h.id=n.id),this.hasPattern?this.features.push(is("fill-extrusion",this.layers,h,this.zoom,e)):this.addFeature(h,h.geometry,u,r,{}),e.featureIndex.insert(n,h.geometry,u,l,this.index,!0)}}},bs.prototype.addFeatures=function(t,e,r){for(var o=0,i=this.features;o<i.length;o+=1){var a=i[o];this.addFeature(a,a.geometry,a.index,e,r)}},bs.prototype.update=function(t,e,r){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(t,e,this.stateDependentLayers,r)},bs.prototype.isEmpty=function(){return 0===this.layoutVertexArray.length},bs.prototype.uploadPending=function(){return!this.uploaded||this.programConfigurations.needsUpload},bs.prototype.upload=function(t){this.uploaded||(this.layoutVertexBuffer=t.createVertexBuffer(this.layoutVertexArray,ls),this.indexBuffer=t.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(t),this.uploaded=!0},bs.prototype.destroy=function(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())},bs.prototype.addFeature=function(t,e,r,o,i){for(var a=0,n=ts(e,500);a<n.length;a+=1){for(var s=n[a],u=0,l=0,p=s;l<p.length;l+=1)u+=p[l].length;for(var c=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray),h=0,d=s;h<d.length;h+=1){var f=d[h];if(0!==f.length&&!((M=f).every((function(t){return t.x<0}))||M.every((function(t){return t.x>8192}))||M.every((function(t){return t.y<0}))||M.every((function(t){return t.y>8192}))))for(var m=0,y=0;y<f.length;y++){var v=f[y];if(y>=1){var g=f[y-1];if(!ws(v,g)){c.vertexLength+4>an.MAX_VERTEX_ARRAY_LENGTH&&(c=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray));var _=v.sub(g)._perp()._unit(),b=g.dist(v);m+b>32768&&(m=0),xs(this.layoutVertexArray,v.x,v.y,_.x,_.y,0,0,m),xs(this.layoutVertexArray,v.x,v.y,_.x,_.y,0,1,m),xs(this.layoutVertexArray,g.x,g.y,_.x,_.y,0,0,m+=b),xs(this.layoutVertexArray,g.x,g.y,_.x,_.y,0,1,m);var x=c.vertexLength;this.indexArray.emplaceBack(x,x+2,x+1),this.indexArray.emplaceBack(x+1,x+2,x+3),c.vertexLength+=4,c.primitiveLength+=2}}}}if(c.vertexLength+u>an.MAX_VERTEX_ARRAY_LENGTH&&(c=this.segments.prepareSegment(u,this.layoutVertexArray,this.indexArray)),"Polygon"===vs[t.type]){for(var w=[],E=[],k=c.vertexLength,S=0,T=s;S<T.length;S+=1){var I=T[S];if(0!==I.length){I!==s[0]&&E.push(w.length/2);for(var z=0;z<I.length;z++){var C=I[z];xs(this.layoutVertexArray,C.x,C.y,0,0,1,1,0),w.push(C.x),w.push(C.y)}}}for(var P=Ea(w,E),A=0;A<P.length;A+=3)this.indexArray.emplaceBack(k+P[A],k+P[A+2],k+P[A+1]);c.primitiveLength+=P.length/3,c.vertexLength+=u}}var M;this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,t,r,i,o)},Oi("FillExtrusionBucket",bs,{omit:["layers","features"]});var Es={paint:new _o({"fill-extrusion-opacity":new fo(It["paint_fill-extrusion"]["fill-extrusion-opacity"]),"fill-extrusion-color":new mo(It["paint_fill-extrusion"]["fill-extrusion-color"]),"fill-extrusion-translate":new fo(It["paint_fill-extrusion"]["fill-extrusion-translate"]),"fill-extrusion-translate-anchor":new fo(It["paint_fill-extrusion"]["fill-extrusion-translate-anchor"]),"fill-extrusion-pattern":new go(It["paint_fill-extrusion"]["fill-extrusion-pattern"]),"fill-extrusion-height":new mo(It["paint_fill-extrusion"]["fill-extrusion-height"]),"fill-extrusion-base":new mo(It["paint_fill-extrusion"]["fill-extrusion-base"]),"fill-extrusion-vertical-gradient":new fo(It["paint_fill-extrusion"]["fill-extrusion-vertical-gradient"])})},ks=function(t){function e(e){t.call(this,e,Es)}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e,e.prototype.createBucket=function(t){return new bs(t)},e.prototype.queryRadius=function(){return Qn(this.paint.get("fill-extrusion-translate"))},e.prototype.is3D=function(){return!0},e.prototype.queryIntersectsFeature=function(t,e,r,o,a,n,s,u){var l=ta(t,this.paint.get("fill-extrusion-translate"),this.paint.get("fill-extrusion-translate-anchor"),n.angle,s),p=this.paint.get("fill-extrusion-height").evaluate(e,r),c=this.paint.get("fill-extrusion-base").evaluate(e,r),h=function(t,e,r,o){for(var a=[],n=0,s=t;n<s.length;n+=1){var u=s[n],l=[u.x,u.y,0,1];la(l,l,e),a.push(new i(l[0]/l[3],l[1]/l[3]))}return a}(l,u),d=function(t,e,r,o){for(var a=[],n=[],s=o[8]*e,u=o[9]*e,l=o[10]*e,p=o[11]*e,c=o[8]*r,h=o[9]*r,d=o[10]*r,f=o[11]*r,m=0,y=t;m<y.length;m+=1){for(var v=[],g=[],_=0,b=y[m];_<b.length;_+=1){var x=b[_],w=x.x,E=x.y,k=o[0]*w+o[4]*E+o[12],S=o[1]*w+o[5]*E+o[13],T=o[2]*w+o[6]*E+o[14],I=o[3]*w+o[7]*E+o[15],z=T+l,C=I+p,P=k+c,A=S+h,M=T+d,L=I+f,R=new i((k+s)/C,(S+u)/C);R.z=z/C,v.push(R);var D=new i(P/L,A/L);D.z=M/L,g.push(D)}a.push(v),n.push(g)}return[a,n]}(o,c,p,u);return function(t,e,r){var o=1/0;qn(r,e)&&(o=Ts(r,e[0]));for(var i=0;i<e.length;i++)for(var a=e[i],n=t[i],s=0;s<a.length-1;s++){var u=a[s],l=[u,a[s+1],n[s+1],n[s],u];jn(r,l)&&(o=Math.min(o,Ts(r,l)))}return o!==1/0&&o}(d[0],d[1],h)},e}(xo);function Ss(t,e){return t.x*e.x+t.y*e.y}function Ts(t,e){if(1===t.length){for(var r,o=0,i=e[o++];!r||i.equals(r);)if(!(r=e[o++]))return 1/0;for(;o<e.length;o++){var a=e[o],n=t[0],s=r.sub(i),u=a.sub(i),l=n.sub(i),p=Ss(s,s),c=Ss(s,u),h=Ss(u,u),d=Ss(l,s),f=Ss(l,u),m=p*h-c*c,y=(h*d-c*f)/m,v=(p*f-c*d)/m,g=i.z*(1-y-v)+r.z*y+a.z*v;if(isFinite(g))return g}return 1/0}for(var _=1/0,b=0,x=e;b<x.length;b+=1)_=Math.min(_,x[b].z);return _}var Is=ko([{name:"a_pos_normal",components:2,type:"Int16"},{name:"a_data",components:4,type:"Uint8"}],4).members,zs=ys.VectorTileFeature.types,Cs=Math.cos(Math.PI/180*37.5),Ps=Math.pow(2,14)/.5,As=function(t){this.zoom=t.zoom,this.overscaling=t.overscaling,this.layers=t.layers,this.layerIds=this.layers.map((function(t){return t.id})),this.index=t.index,this.hasPattern=!1,this.patternFeatures=[],this.layoutVertexArray=new Co,this.indexArray=new Fo,this.programConfigurations=new Ln(t.layers,t.zoom),this.segments=new an,this.stateDependentLayerIds=this.layers.filter((function(t){return t.isStateDependent()})).map((function(t){return t.id}))};As.prototype.populate=function(t,e,r){this.hasPattern=rs("line",this.layers,e);for(var o=this.layers[0].layout.get("line-sort-key"),i=[],a=0,n=t;a<n.length;a+=1){var s=n[a],u=s.feature,l=s.id,p=s.index,c=s.sourceLayerIndex,h=this.layers[0]._featureFilter.needGeometry,d={type:u.type,id:l,properties:u.properties,geometry:h?Fn(u):[]};if(this.layers[0]._featureFilter.filter(new no(this.zoom),d,r)){h||(d.geometry=Fn(u));var f=o?o.evaluate(d,{},r):void 0;i.push({id:l,properties:u.properties,type:u.type,sourceLayerIndex:c,index:p,geometry:d.geometry,patterns:{},sortKey:f})}}o&&i.sort((function(t,e){return t.sortKey-e.sortKey}));for(var m=0,y=i;m<y.length;m+=1){var v=y[m],g=v.geometry,_=v.index,b=v.sourceLayerIndex;if(this.hasPattern){var x=is("line",this.layers,v,this.zoom,e);this.patternFeatures.push(x)}else this.addFeature(v,g,_,r,{});e.featureIndex.insert(t[_].feature,g,_,b,this.index)}},As.prototype.update=function(t,e,r){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(t,e,this.stateDependentLayers,r)},As.prototype.addFeatures=function(t,e,r){for(var o=0,i=this.patternFeatures;o<i.length;o+=1){var a=i[o];this.addFeature(a,a.geometry,a.index,e,r)}},As.prototype.isEmpty=function(){return 0===this.layoutVertexArray.length},As.prototype.uploadPending=function(){return!this.uploaded||this.programConfigurations.needsUpload},As.prototype.upload=function(t){this.uploaded||(this.layoutVertexBuffer=t.createVertexBuffer(this.layoutVertexArray,Is),this.indexBuffer=t.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(t),this.uploaded=!0},As.prototype.destroy=function(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())},As.prototype.addFeature=function(t,e,r,o,i){for(var a=this.layers[0].layout,n=a.get("line-join").evaluate(t,{}),s=a.get("line-cap"),u=a.get("line-miter-limit"),l=a.get("line-round-limit"),p=0,c=e;p<c.length;p+=1)this.addLine(c[p],t,n,s,u,l);this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,t,r,i,o)},As.prototype.addLine=function(t,e,r,o,i,a){if(this.distance=0,this.scaledDistance=0,this.totalDistance=0,e.properties&&e.properties.hasOwnProperty("mapbox_clip_start")&&e.properties.hasOwnProperty("mapbox_clip_end")){this.clipStart=+e.properties.mapbox_clip_start,this.clipEnd=+e.properties.mapbox_clip_end;for(var n=0;n<t.length-1;n++)this.totalDistance+=t[n].dist(t[n+1]);this.updateScaledDistance()}for(var s="Polygon"===zs[e.type],u=t.length;u>=2&&t[u-1].equals(t[u-2]);)u--;for(var l=0;l<u-1&&t[l].equals(t[l+1]);)l++;if(!(u<(s?3:2))){"bevel"===r&&(i=1.05);var p,c=this.overscaling<=16?122880/(512*this.overscaling):0,h=this.segments.prepareSegment(10*u,this.layoutVertexArray,this.indexArray),d=void 0,f=void 0,m=void 0,y=void 0;this.e1=this.e2=-1,s&&(y=t[l].sub(p=t[u-2])._unit()._perp());for(var v=l;v<u;v++)if(!(f=v===u-1?s?t[l+1]:void 0:t[v+1])||!t[v].equals(f)){y&&(m=y),p&&(d=p),p=t[v],y=f?f.sub(p)._unit()._perp():m;var g=(m=m||y).add(y);0===g.x&&0===g.y||g._unit();var _=m.x*y.x+m.y*y.y,b=g.x*y.x+g.y*y.y,x=0!==b?1/b:1/0,w=2*Math.sqrt(2-2*b),E=b<Cs&&d&&f,k=m.x*y.y-m.y*y.x>0;if(E&&v>l){var S=p.dist(d);if(S>2*c){var T=p.sub(p.sub(d)._mult(c/S)._round());this.updateDistance(d,T),this.addCurrentVertex(T,m,0,0,h),d=T}}var I=d&&f,z=I?r:s?"butt":o;if(I&&"round"===z&&(x<a?z="miter":x<=2&&(z="fakeround")),"miter"===z&&x>i&&(z="bevel"),"bevel"===z&&(x>2&&(z="flipbevel"),x<i&&(z="miter")),d&&this.updateDistance(d,p),"miter"===z)g._mult(x),this.addCurrentVertex(p,g,0,0,h);else if("flipbevel"===z){if(x>100)g=y.mult(-1);else{var C=x*m.add(y).mag()/m.sub(y).mag();g._perp()._mult(C*(k?-1:1))}this.addCurrentVertex(p,g,0,0,h),this.addCurrentVertex(p,g.mult(-1),0,0,h)}else if("bevel"===z||"fakeround"===z){var P=-Math.sqrt(x*x-1),A=k?P:0,M=k?0:P;if(d&&this.addCurrentVertex(p,m,A,M,h),"fakeround"===z)for(var L=Math.round(180*w/Math.PI/20),R=1;R<L;R++){var D=R/L;if(.5!==D){var O=D-.5;D+=D*O*(D-1)*((1.0904+_*(_*(3.55645-1.43519*_)-3.2452))*O*O+(.848013+_*(.215638*_-1.06021)))}var B=y.sub(m)._mult(D)._add(m)._unit()._mult(k?-1:1);this.addHalfVertex(p,B.x,B.y,!1,k,0,h)}f&&this.addCurrentVertex(p,y,-A,-M,h)}else if("butt"===z)this.addCurrentVertex(p,g,0,0,h);else if("square"===z){var F=d?1:-1;this.addCurrentVertex(p,g,F,F,h)}else"round"===z&&(d&&(this.addCurrentVertex(p,m,0,0,h),this.addCurrentVertex(p,m,1,1,h,!0)),f&&(this.addCurrentVertex(p,y,-1,-1,h,!0),this.addCurrentVertex(p,y,0,0,h)));if(E&&v<u-1){var U=p.dist(f);if(U>2*c){var N=p.add(f.sub(p)._mult(c/U)._round());this.updateDistance(p,N),this.addCurrentVertex(N,y,0,0,h),p=N}}}}},As.prototype.addCurrentVertex=function(t,e,r,o,i,a){void 0===a&&(a=!1);var n=e.y*o-e.x,s=-e.y-e.x*o;this.addHalfVertex(t,e.x+e.y*r,e.y-e.x*r,a,!1,r,i),this.addHalfVertex(t,n,s,a,!0,-o,i),this.distance>Ps/2&&0===this.totalDistance&&(this.distance=0,this.addCurrentVertex(t,e,r,o,i,a))},As.prototype.addHalfVertex=function(t,e,r,o,i,a,n){var s=.5*this.scaledDistance;this.layoutVertexArray.emplaceBack((t.x<<1)+(o?1:0),(t.y<<1)+(i?1:0),Math.round(63*e)+128,Math.round(63*r)+128,1+(0===a?0:a<0?-1:1)|(63&s)<<2,s>>6);var u=n.vertexLength++;this.e1>=0&&this.e2>=0&&(this.indexArray.emplaceBack(this.e1,this.e2,u),n.primitiveLength++),i?this.e2=u:this.e1=u},As.prototype.updateScaledDistance=function(){this.scaledDistance=this.totalDistance>0?(this.clipStart+(this.clipEnd-this.clipStart)*this.distance/this.totalDistance)*(Ps-1):this.distance},As.prototype.updateDistance=function(t,e){this.distance+=t.dist(e),this.updateScaledDistance()},Oi("LineBucket",As,{omit:["layers","patternFeatures"]});var Ms=new _o({"line-cap":new fo(It.layout_line["line-cap"]),"line-join":new mo(It.layout_line["line-join"]),"line-miter-limit":new fo(It.layout_line["line-miter-limit"]),"line-round-limit":new fo(It.layout_line["line-round-limit"]),"line-sort-key":new mo(It.layout_line["line-sort-key"])}),Ls={paint:new _o({"line-opacity":new mo(It.paint_line["line-opacity"]),"line-color":new mo(It.paint_line["line-color"]),"line-translate":new fo(It.paint_line["line-translate"]),"line-translate-anchor":new fo(It.paint_line["line-translate-anchor"]),"line-width":new mo(It.paint_line["line-width"]),"line-gap-width":new mo(It.paint_line["line-gap-width"]),"line-offset":new mo(It.paint_line["line-offset"]),"line-blur":new mo(It.paint_line["line-blur"]),"line-dasharray":new yo(It.paint_line["line-dasharray"]),"line-pattern":new go(It.paint_line["line-pattern"]),"line-gradient":new vo(It.paint_line["line-gradient"])}),layout:Ms},Rs=new(function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e,e.prototype.possiblyEvaluate=function(e,r){return r=new no(Math.floor(r.zoom),{now:r.now,fadeDuration:r.fadeDuration,zoomHistory:r.zoomHistory,transition:r.transition}),t.prototype.possiblyEvaluate.call(this,e,r)},e.prototype.evaluate=function(e,r,o,i){return r=c({},r,{zoom:Math.floor(r.zoom)}),t.prototype.evaluate.call(this,e,r,o,i)},e}(mo))(Ls.paint.properties["line-width"].specification);Rs.useIntegerZoom=!0;var Ds=function(t){function e(e){t.call(this,e,Ls)}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e,e.prototype._handleSpecialPaintPropertyUpdate=function(t){"line-gradient"===t&&this._updateGradient()},e.prototype._updateGradient=function(){this.gradient=va(this._transitionablePaint._values["line-gradient"].value.expression,"lineProgress"),this.gradientTexture=null},e.prototype.recalculate=function(e,r){t.prototype.recalculate.call(this,e,r),this.paint._values["line-floorwidth"]=Rs.possiblyEvaluate(this._transitioningPaint._values["line-width"].value,e)},e.prototype.createBucket=function(t){return new As(t)},e.prototype.queryRadius=function(t){var e=t,r=Os(Yn("line-width",this,e),Yn("line-gap-width",this,e)),o=Yn("line-offset",this,e);return r/2+Math.abs(o)+Qn(this.paint.get("line-translate"))},e.prototype.queryIntersectsFeature=function(t,e,r,o,a,n,s){var u=ta(t,this.paint.get("line-translate"),this.paint.get("line-translate-anchor"),n.angle,s),l=s/2*Os(this.paint.get("line-width").evaluate(e,r),this.paint.get("line-gap-width").evaluate(e,r)),p=this.paint.get("line-offset").evaluate(e,r);return p&&(o=function(t,e){for(var r=[],o=new i(0,0),a=0;a<t.length;a++){for(var n=t[a],s=[],u=0;u<n.length;u++){var l=n[u],p=n[u+1],c=0===u?o:l.sub(n[u-1])._unit()._perp(),h=u===n.length-1?o:p.sub(l)._unit()._perp(),d=c._add(h)._unit();d._mult(1/(d.x*h.x+d.y*h.y)),s.push(d._mult(e)._add(l))}r.push(s)}return r}(o,p*s)),function(t,e,r){for(var o=0;o<e.length;o++){var i=e[o];if(t.length>=3)for(var a=0;a<i.length;a++)if($n(t,i[a]))return!0;if(Gn(t,i,r))return!0}return!1}(u,o,l)},e.prototype.isTileClipped=function(){return!0},e}(xo);function Os(t,e){return e>0?e+2*t:t}var Bs=ko([{name:"a_pos_offset",components:4,type:"Int16"},{name:"a_data",components:4,type:"Uint16"},{name:"a_pixeloffset",components:4,type:"Int16"}],4),Fs=ko([{name:"a_projected_pos",components:3,type:"Float32"}],4),Us=(ko([{name:"a_fade_opacity",components:1,type:"Uint32"}],4),ko([{name:"a_placed",components:2,type:"Uint8"},{name:"a_shift",components:2,type:"Float32"}])),Ns=(ko([{type:"Int16",name:"anchorPointX"},{type:"Int16",name:"anchorPointY"},{type:"Int16",name:"x1"},{type:"Int16",name:"y1"},{type:"Int16",name:"x2"},{type:"Int16",name:"y2"},{type:"Uint32",name:"featureIndex"},{type:"Uint16",name:"sourceLayerIndex"},{type:"Uint16",name:"bucketIndex"}]),ko([{name:"a_pos",components:2,type:"Int16"},{name:"a_anchor_pos",components:2,type:"Int16"},{name:"a_extrude",components:2,type:"Int16"}],4)),js=ko([{name:"a_pos",components:2,type:"Float32"},{name:"a_radius",components:1,type:"Float32"},{name:"a_flags",components:2,type:"Int16"}],4);function Vs(t,e,r){return t.sections.forEach((function(t){t.text=function(t,e,r){var o=e.layout.get("text-transform").evaluate(r,{});return"uppercase"===o?t=t.toLocaleUpperCase():"lowercase"===o&&(t=t.toLocaleLowerCase()),oo.applyArabicShaping&&(t=oo.applyArabicShaping(t)),t}(t.text,e,r)})),t}ko([{name:"triangle",components:3,type:"Uint16"}]),ko([{type:"Int16",name:"anchorX"},{type:"Int16",name:"anchorY"},{type:"Uint16",name:"glyphStartIndex"},{type:"Uint16",name:"numGlyphs"},{type:"Uint32",name:"vertexStartIndex"},{type:"Uint32",name:"lineStartIndex"},{type:"Uint32",name:"lineLength"},{type:"Uint16",name:"segment"},{type:"Uint16",name:"lowerSize"},{type:"Uint16",name:"upperSize"},{type:"Float32",name:"lineOffsetX"},{type:"Float32",name:"lineOffsetY"},{type:"Uint8",name:"writingMode"},{type:"Uint8",name:"placedOrientation"},{type:"Uint8",name:"hidden"},{type:"Uint32",name:"crossTileID"},{type:"Int16",name:"associatedIconIndex"}]),ko([{type:"Int16",name:"anchorX"},{type:"Int16",name:"anchorY"},{type:"Int16",name:"rightJustifiedTextSymbolIndex"},{type:"Int16",name:"centerJustifiedTextSymbolIndex"},{type:"Int16",name:"leftJustifiedTextSymbolIndex"},{type:"Int16",name:"verticalPlacedTextSymbolIndex"},{type:"Int16",name:"placedIconSymbolIndex"},{type:"Int16",name:"verticalPlacedIconSymbolIndex"},{type:"Uint16",name:"key"},{type:"Uint16",name:"textBoxStartIndex"},{type:"Uint16",name:"textBoxEndIndex"},{type:"Uint16",name:"verticalTextBoxStartIndex"},{type:"Uint16",name:"verticalTextBoxEndIndex"},{type:"Uint16",name:"iconBoxStartIndex"},{type:"Uint16",name:"iconBoxEndIndex"},{type:"Uint16",name:"verticalIconBoxStartIndex"},{type:"Uint16",name:"verticalIconBoxEndIndex"},{type:"Uint16",name:"featureIndex"},{type:"Uint16",name:"numHorizontalGlyphVertices"},{type:"Uint16",name:"numVerticalGlyphVertices"},{type:"Uint16",name:"numIconVertices"},{type:"Uint16",name:"numVerticalIconVertices"},{type:"Uint16",name:"useRuntimeCollisionCircles"},{type:"Uint32",name:"crossTileID"},{type:"Float32",name:"textBoxScale"},{type:"Float32",components:2,name:"textOffset"},{type:"Float32",name:"collisionCircleDiameter"}]),ko([{type:"Float32",name:"offsetX"}]),ko([{type:"Int16",name:"x"},{type:"Int16",name:"y"},{type:"Int16",name:"tileUnitDistanceFromAnchor"}]);var qs={"!":"︕","#":"＃",$:"＄","%":"％","&":"＆","(":"︵",")":"︶","*":"＊","+":"＋",",":"︐","-":"︲",".":"・","/":"／",":":"︓",";":"︔","<":"︿","=":"＝",">":"﹀","?":"︖","@":"＠","[":"﹇","\\":"＼","]":"﹈","^":"＾",_:"︳","`":"｀","{":"︷","|":"―","}":"︸","~":"～","¢":"￠","£":"￡","¥":"￥","¦":"￤","¬":"￢","¯":"￣","–":"︲","—":"︱","‘":"﹃","’":"﹄","“":"﹁","”":"﹂","…":"︙","‧":"・","₩":"￦","、":"︑","。":"︒","〈":"︿","〉":"﹀","《":"︽","》":"︾","「":"﹁","」":"﹂","『":"﹃","』":"﹄","【":"︻","】":"︼","〔":"︹","〕":"︺","〖":"︗","〗":"︘","！":"︕","（":"︵","）":"︶","，":"︐","－":"︲","．":"・","：":"︓","；":"︔","＜":"︿","＞":"﹀","？":"︖","［":"﹇","］":"﹈","＿":"︳","｛":"︷","｜":"―","｝":"︸","｟":"︵","｠":"︶","｡":"︒","｢":"﹁","｣":"﹂"},Gs=function(t,e,r,o,i){var a,n,s=8*i-o-1,u=(1<<s)-1,l=u>>1,p=-7,c=r?i-1:0,h=r?-1:1,d=t[e+c];for(c+=h,a=d&(1<<-p)-1,d>>=-p,p+=s;p>0;a=256*a+t[e+c],c+=h,p-=8);for(n=a&(1<<-p)-1,a>>=-p,p+=o;p>0;n=256*n+t[e+c],c+=h,p-=8);if(0===a)a=1-l;else{if(a===u)return n?NaN:1/0*(d?-1:1);n+=Math.pow(2,o),a-=l}return(d?-1:1)*n*Math.pow(2,a-o)},Zs=function(t,e,r,o,i,a){var n,s,u,l=8*a-i-1,p=(1<<l)-1,c=p>>1,h=23===i?Math.pow(2,-24)-Math.pow(2,-77):0,d=o?0:a-1,f=o?1:-1,m=e<0||0===e&&1/e<0?1:0;for(e=Math.abs(e),isNaN(e)||e===1/0?(s=isNaN(e)?1:0,n=p):(n=Math.floor(Math.log(e)/Math.LN2),e*(u=Math.pow(2,-n))<1&&(n--,u*=2),(e+=n+c>=1?h/u:h*Math.pow(2,1-c))*u>=2&&(n++,u/=2),n+c>=p?(s=0,n=p):n+c>=1?(s=(e*u-1)*Math.pow(2,i),n+=c):(s=e*Math.pow(2,c-1)*Math.pow(2,i),n=0));i>=8;t[r+d]=255&s,d+=f,s/=256,i-=8);for(n=n<<i|s,l+=i;l>0;t[r+d]=255&n,d+=f,n/=256,l-=8);t[r+d-f]|=128*m},Hs=Ks;function Ks(t){this.buf=ArrayBuffer.isView&&ArrayBuffer.isView(t)?t:new Uint8Array(t||0),this.pos=0,this.type=0,this.length=this.buf.length}Ks.Varint=0,Ks.Fixed64=1,Ks.Bytes=2,Ks.Fixed32=5;var Ws="undefined"==typeof TextDecoder?null:new TextDecoder("utf8");function Xs(t){return t.type===Ks.Bytes?t.readVarint()+t.pos:t.pos+1}function $s(t,e,r){return r?4294967296*e+(t>>>0):4294967296*(e>>>0)+(t>>>0)}function Js(t,e,r){var o=e<=16383?1:e<=2097151?2:e<=268435455?3:Math.floor(Math.log(e)/(7*Math.LN2));r.realloc(o);for(var i=r.pos-1;i>=t;i--)r.buf[i+o]=r.buf[i]}function Ys(t,e){for(var r=0;r<t.length;r++)e.writeVarint(t[r])}function Qs(t,e){for(var r=0;r<t.length;r++)e.writeSVarint(t[r])}function tl(t,e){for(var r=0;r<t.length;r++)e.writeFloat(t[r])}function el(t,e){for(var r=0;r<t.length;r++)e.writeDouble(t[r])}function rl(t,e){for(var r=0;r<t.length;r++)e.writeBoolean(t[r])}function il(t,e){for(var r=0;r<t.length;r++)e.writeFixed32(t[r])}function nl(t,e){for(var r=0;r<t.length;r++)e.writeSFixed32(t[r])}function al(t,e){for(var r=0;r<t.length;r++)e.writeFixed64(t[r])}function sl(t,e){for(var r=0;r<t.length;r++)e.writeSFixed64(t[r])}function ll(t,e){return(t[e]|t[e+1]<<8|t[e+2]<<16)+16777216*t[e+3]}function cl(t,e,r){t[r]=e,t[r+1]=e>>>8,t[r+2]=e>>>16,t[r+3]=e>>>24}function pl(t,e){return(t[e]|t[e+1]<<8|t[e+2]<<16)+(t[e+3]<<24)}function hl(t,e,r){1===t&&r.readMessage(fl,e)}function fl(t,e,r){if(3===t){var o=r.readMessage(ml,{}),i=o.width,a=o.height,n=o.left,s=o.top,u=o.advance;e.push({id:o.id,bitmap:new ma({width:i+6,height:a+6},o.bitmap),metrics:{width:i,height:a,left:n,top:s,advance:u}})}}function ml(t,e,r){1===t?e.id=r.readVarint():2===t?e.bitmap=r.readBytes():3===t?e.width=r.readVarint():4===t?e.height=r.readVarint():5===t?e.left=r.readSVarint():6===t?e.top=r.readSVarint():7===t&&(e.advance=r.readVarint())}function gl(t){for(var e=0,r=0,o=0,i=t;o<i.length;o+=1){var a=i[o];e+=a.w*a.h,r=Math.max(r,a.w)}t.sort((function(t,e){return e.h-t.h}));for(var n=[{x:0,y:0,w:Math.max(Math.ceil(Math.sqrt(e/.95)),r),h:1/0}],s=0,u=0,l=0,p=t;l<p.length;l+=1)for(var c=p[l],h=n.length-1;h>=0;h--){var d=n[h];if(!(c.w>d.w||c.h>d.h)){if(c.x=d.x,c.y=d.y,u=Math.max(u,c.y+c.h),s=Math.max(s,c.x+c.w),c.w===d.w&&c.h===d.h){var f=n.pop();h<n.length&&(n[h]=f)}else c.h===d.h?(d.x+=c.w,d.w-=c.w):c.w===d.w?(d.y+=c.h,d.h-=c.h):(n.push({x:d.x+c.w,y:d.y,w:d.w-c.w,h:c.h}),d.y+=c.h,d.h-=c.h);break}}return{w:s,h:u,fill:e/(s*u)||0}}Ks.prototype={destroy:function(){this.buf=null},readFields:function(t,e,r){for(r=r||this.length;this.pos<r;){var o=this.readVarint(),i=o>>3,a=this.pos;this.type=7&o,t(i,e,this),this.pos===a&&this.skip(o)}return e},readMessage:function(t,e){return this.readFields(t,e,this.readVarint()+this.pos)},readFixed32:function(){var t=ll(this.buf,this.pos);return this.pos+=4,t},readSFixed32:function(){var t=pl(this.buf,this.pos);return this.pos+=4,t},readFixed64:function(){var t=ll(this.buf,this.pos)+4294967296*ll(this.buf,this.pos+4);return this.pos+=8,t},readSFixed64:function(){var t=ll(this.buf,this.pos)+4294967296*pl(this.buf,this.pos+4);return this.pos+=8,t},readFloat:function(){var t=Gs(this.buf,this.pos,!0,23,4);return this.pos+=4,t},readDouble:function(){var t=Gs(this.buf,this.pos,!0,52,8);return this.pos+=8,t},readVarint:function(t){var e,r,o=this.buf;return e=127&(r=o[this.pos++]),r<128?e:(e|=(127&(r=o[this.pos++]))<<7,r<128?e:(e|=(127&(r=o[this.pos++]))<<14,r<128?e:(e|=(127&(r=o[this.pos++]))<<21,r<128?e:function(t,e,r){var o,i,a=r.buf;if(o=(112&(i=a[r.pos++]))>>4,i<128)return $s(t,o,e);if(o|=(127&(i=a[r.pos++]))<<3,i<128)return $s(t,o,e);if(o|=(127&(i=a[r.pos++]))<<10,i<128)return $s(t,o,e);if(o|=(127&(i=a[r.pos++]))<<17,i<128)return $s(t,o,e);if(o|=(127&(i=a[r.pos++]))<<24,i<128)return $s(t,o,e);if(o|=(1&(i=a[r.pos++]))<<31,i<128)return $s(t,o,e);throw new Error("Expected varint not more than 10 bytes")}(e|=(15&(r=o[this.pos]))<<28,t,this))))},readVarint64:function(){return this.readVarint(!0)},readSVarint:function(){var t=this.readVarint();return t%2==1?(t+1)/-2:t/2},readBoolean:function(){return Boolean(this.readVarint())},readString:function(){var t=this.readVarint()+this.pos,e=this.pos;return this.pos=t,t-e>=12&&Ws?function(t,e,r){return Ws.decode(t.subarray(e,r))}(this.buf,e,t):function(t,e,r){for(var o="",i=e;i<r;){var a,n,s,u=t[i],l=null,p=u>239?4:u>223?3:u>191?2:1;if(i+p>r)break;1===p?u<128&&(l=u):2===p?128==(192&(a=t[i+1]))&&(l=(31&u)<<6|63&a)<=127&&(l=null):3===p?(n=t[i+2],128==(192&(a=t[i+1]))&&128==(192&n)&&((l=(15&u)<<12|(63&a)<<6|63&n)<=2047||l>=55296&&l<=57343)&&(l=null)):4===p&&(n=t[i+2],s=t[i+3],128==(192&(a=t[i+1]))&&128==(192&n)&&128==(192&s)&&((l=(15&u)<<18|(63&a)<<12|(63&n)<<6|63&s)<=65535||l>=1114112)&&(l=null)),null===l?(l=65533,p=1):l>65535&&(l-=65536,o+=String.fromCharCode(l>>>10&1023|55296),l=56320|1023&l),o+=String.fromCharCode(l),i+=p}return o}(this.buf,e,t)},readBytes:function(){var t=this.readVarint()+this.pos,e=this.buf.subarray(this.pos,t);return this.pos=t,e},readPackedVarint:function(t,e){if(this.type!==Ks.Bytes)return t.push(this.readVarint(e));var r=Xs(this);for(t=t||[];this.pos<r;)t.push(this.readVarint(e));return t},readPackedSVarint:function(t){if(this.type!==Ks.Bytes)return t.push(this.readSVarint());var e=Xs(this);for(t=t||[];this.pos<e;)t.push(this.readSVarint());return t},readPackedBoolean:function(t){if(this.type!==Ks.Bytes)return t.push(this.readBoolean());var e=Xs(this);for(t=t||[];this.pos<e;)t.push(this.readBoolean());return t},readPackedFloat:function(t){if(this.type!==Ks.Bytes)return t.push(this.readFloat());var e=Xs(this);for(t=t||[];this.pos<e;)t.push(this.readFloat());return t},readPackedDouble:function(t){if(this.type!==Ks.Bytes)return t.push(this.readDouble());var e=Xs(this);for(t=t||[];this.pos<e;)t.push(this.readDouble());return t},readPackedFixed32:function(t){if(this.type!==Ks.Bytes)return t.push(this.readFixed32());var e=Xs(this);for(t=t||[];this.pos<e;)t.push(this.readFixed32());return t},readPackedSFixed32:function(t){if(this.type!==Ks.Bytes)return t.push(this.readSFixed32());var e=Xs(this);for(t=t||[];this.pos<e;)t.push(this.readSFixed32());return t},readPackedFixed64:function(t){if(this.type!==Ks.Bytes)return t.push(this.readFixed64());var e=Xs(this);for(t=t||[];this.pos<e;)t.push(this.readFixed64());return t},readPackedSFixed64:function(t){if(this.type!==Ks.Bytes)return t.push(this.readSFixed64());var e=Xs(this);for(t=t||[];this.pos<e;)t.push(this.readSFixed64());return t},skip:function(t){var e=7&t;if(e===Ks.Varint)for(;this.buf[this.pos++]>127;);else if(e===Ks.Bytes)this.pos=this.readVarint()+this.pos;else if(e===Ks.Fixed32)this.pos+=4;else{if(e!==Ks.Fixed64)throw new Error("Unimplemented type: "+e);this.pos+=8}},writeTag:function(t,e){this.writeVarint(t<<3|e)},realloc:function(t){for(var e=this.length||16;e<this.pos+t;)e*=2;if(e!==this.length){var r=new Uint8Array(e);r.set(this.buf),this.buf=r,this.length=e}},finish:function(){return this.length=this.pos,this.pos=0,this.buf.subarray(0,this.length)},writeFixed32:function(t){this.realloc(4),cl(this.buf,t,this.pos),this.pos+=4},writeSFixed32:function(t){this.realloc(4),cl(this.buf,t,this.pos),this.pos+=4},writeFixed64:function(t){this.realloc(8),cl(this.buf,-1&t,this.pos),cl(this.buf,Math.floor(t*(1/4294967296)),this.pos+4),this.pos+=8},writeSFixed64:function(t){this.realloc(8),cl(this.buf,-1&t,this.pos),cl(this.buf,Math.floor(t*(1/4294967296)),this.pos+4),this.pos+=8},writeVarint:function(t){(t=+t||0)>268435455||t<0?function(t,e){var r,o;if(t>=0?(r=t%4294967296|0,o=t/4294967296|0):(o=~(-t/4294967296),4294967295^(r=~(-t%4294967296))?r=r+1|0:(r=0,o=o+1|0)),t>=0x10000000000000000||t<-0x10000000000000000)throw new Error("Given varint doesn't fit into 10 bytes");e.realloc(10),function(t,e,r){r.buf[r.pos++]=127&t|128,t>>>=7,r.buf[r.pos++]=127&t|128,t>>>=7,r.buf[r.pos++]=127&t|128,t>>>=7,r.buf[r.pos++]=127&t|128,r.buf[r.pos]=127&(t>>>=7)}(r,0,e),function(t,e){var r=(7&t)<<4;e.buf[e.pos++]|=r|((t>>>=3)?128:0),t&&(e.buf[e.pos++]=127&t|((t>>>=7)?128:0),t&&(e.buf[e.pos++]=127&t|((t>>>=7)?128:0),t&&(e.buf[e.pos++]=127&t|((t>>>=7)?128:0),t&&(e.buf[e.pos++]=127&t|((t>>>=7)?128:0),t&&(e.buf[e.pos++]=127&t)))))}(o,e)}(t,this):(this.realloc(4),this.buf[this.pos++]=127&t|(t>127?128:0),t<=127||(this.buf[this.pos++]=127&(t>>>=7)|(t>127?128:0),t<=127||(this.buf[this.pos++]=127&(t>>>=7)|(t>127?128:0),t<=127||(this.buf[this.pos++]=t>>>7&127))))},writeSVarint:function(t){this.writeVarint(t<0?2*-t-1:2*t)},writeBoolean:function(t){this.writeVarint(Boolean(t))},writeString:function(t){t=String(t),this.realloc(4*t.length),this.pos++;var e=this.pos;this.pos=function(t,e,r){for(var o,i,a=0;a<e.length;a++){if((o=e.charCodeAt(a))>55295&&o<57344){if(!i){o>56319||a+1===e.length?(t[r++]=239,t[r++]=191,t[r++]=189):i=o;continue}if(o<56320){t[r++]=239,t[r++]=191,t[r++]=189,i=o;continue}o=i-55296<<10|o-56320|65536,i=null}else i&&(t[r++]=239,t[r++]=191,t[r++]=189,i=null);o<128?t[r++]=o:(o<2048?t[r++]=o>>6|192:(o<65536?t[r++]=o>>12|224:(t[r++]=o>>18|240,t[r++]=o>>12&63|128),t[r++]=o>>6&63|128),t[r++]=63&o|128)}return r}(this.buf,t,this.pos);var r=this.pos-e;r>=128&&Js(e,r,this),this.pos=e-1,this.writeVarint(r),this.pos+=r},writeFloat:function(t){this.realloc(4),Zs(this.buf,t,this.pos,!0,23,4),this.pos+=4},writeDouble:function(t){this.realloc(8),Zs(this.buf,t,this.pos,!0,52,8),this.pos+=8},writeBytes:function(t){var e=t.length;this.writeVarint(e),this.realloc(e);for(var r=0;r<e;r++)this.buf[this.pos++]=t[r]},writeRawMessage:function(t,e){this.pos++;var r=this.pos;t(e,this);var o=this.pos-r;o>=128&&Js(r,o,this),this.pos=r-1,this.writeVarint(o),this.pos+=o},writeMessage:function(t,e,r){this.writeTag(t,Ks.Bytes),this.writeRawMessage(e,r)},writePackedVarint:function(t,e){e.length&&this.writeMessage(t,Ys,e)},writePackedSVarint:function(t,e){e.length&&this.writeMessage(t,Qs,e)},writePackedBoolean:function(t,e){e.length&&this.writeMessage(t,rl,e)},writePackedFloat:function(t,e){e.length&&this.writeMessage(t,tl,e)},writePackedDouble:function(t,e){e.length&&this.writeMessage(t,el,e)},writePackedFixed32:function(t,e){e.length&&this.writeMessage(t,il,e)},writePackedSFixed32:function(t,e){e.length&&this.writeMessage(t,nl,e)},writePackedFixed64:function(t,e){e.length&&this.writeMessage(t,al,e)},writePackedSFixed64:function(t,e){e.length&&this.writeMessage(t,sl,e)},writeBytesField:function(t,e){this.writeTag(t,Ks.Bytes),this.writeBytes(e)},writeFixed32Field:function(t,e){this.writeTag(t,Ks.Fixed32),this.writeFixed32(e)},writeSFixed32Field:function(t,e){this.writeTag(t,Ks.Fixed32),this.writeSFixed32(e)},writeFixed64Field:function(t,e){this.writeTag(t,Ks.Fixed64),this.writeFixed64(e)},writeSFixed64Field:function(t,e){this.writeTag(t,Ks.Fixed64),this.writeSFixed64(e)},writeVarintField:function(t,e){this.writeTag(t,Ks.Varint),this.writeVarint(e)},writeSVarintField:function(t,e){this.writeTag(t,Ks.Varint),this.writeSVarint(e)},writeStringField:function(t,e){this.writeTag(t,Ks.Bytes),this.writeString(e)},writeFloatField:function(t,e){this.writeTag(t,Ks.Fixed32),this.writeFloat(e)},writeDoubleField:function(t,e){this.writeTag(t,Ks.Fixed64),this.writeDouble(e)},writeBooleanField:function(t,e){this.writeVarintField(t,Boolean(e))}};var yl=function(t,e){var r=e.pixelRatio,o=e.version,i=e.stretchX,a=e.stretchY,n=e.content;this.paddedRect=t,this.pixelRatio=r,this.stretchX=i,this.stretchY=a,this.content=n,this.version=o},vl={tl:{configurable:!0},br:{configurable:!0},tlbr:{configurable:!0},displaySize:{configurable:!0}};vl.tl.get=function(){return[this.paddedRect.x+1,this.paddedRect.y+1]},vl.br.get=function(){return[this.paddedRect.x+this.paddedRect.w-1,this.paddedRect.y+this.paddedRect.h-1]},vl.tlbr.get=function(){return this.tl.concat(this.br)},vl.displaySize.get=function(){return[(this.paddedRect.w-2)/this.pixelRatio,(this.paddedRect.h-2)/this.pixelRatio]},Object.defineProperties(yl.prototype,vl);var _l=function(t,e){var r={},o={};this.haveRenderCallbacks=[];var i=[];this.addImages(t,r,i),this.addImages(e,o,i);var a=gl(i),n=new ga({width:a.w||1,height:a.h||1});for(var s in t){var u=t[s],l=r[s].paddedRect;ga.copy(u.data,n,{x:0,y:0},{x:l.x+1,y:l.y+1},u.data)}for(var p in e){var c=e[p],h=o[p].paddedRect,d=h.x+1,f=h.y+1,m=c.data.width,y=c.data.height;ga.copy(c.data,n,{x:0,y:0},{x:d,y:f},c.data),ga.copy(c.data,n,{x:0,y:y-1},{x:d,y:f-1},{width:m,height:1}),ga.copy(c.data,n,{x:0,y:0},{x:d,y:f+y},{width:m,height:1}),ga.copy(c.data,n,{x:m-1,y:0},{x:d-1,y:f},{width:1,height:y}),ga.copy(c.data,n,{x:0,y:0},{x:d+m,y:f},{width:1,height:y})}this.image=n,this.iconPositions=r,this.patternPositions=o};_l.prototype.addImages=function(t,e,r){for(var o in t){var i=t[o],a={x:0,y:0,w:i.data.width+2,h:i.data.height+2};r.push(a),e[o]=new yl(a,i),i.hasRenderCallback&&this.haveRenderCallbacks.push(o)}},_l.prototype.patchUpdatedImages=function(t,e){for(var r in t.dispatchRenderCallbacks(this.haveRenderCallbacks),t.updatedImages)this.patchUpdatedImage(this.iconPositions[r],t.getImage(r),e),this.patchUpdatedImage(this.patternPositions[r],t.getImage(r),e)},_l.prototype.patchUpdatedImage=function(t,e,r){if(t&&e&&t.version!==e.version){t.version=e.version;var o=t.tl;r.update(e.data,void 0,{x:o[0],y:o[1]})}},Oi("ImagePosition",yl),Oi("ImageAtlas",_l);var xl={horizontal:1,vertical:2,horizontalOnly:3},bl=function(){this.scale=1,this.fontStack="",this.imageName=null};bl.forText=function(t,e){var r=new bl;return r.scale=t||1,r.fontStack=e,r},bl.forImage=function(t){var e=new bl;return e.imageName=t,e};var wl=function(){this.text="",this.sectionIndex=[],this.sections=[],this.imageSectionID=null};function El(t,e,r,o,i,a,n,s,u,l,p,c,h,d,f,m){var y,v=wl.fromFeature(t,i);c===xl.vertical&&v.verticalizePunctuation();var g=oo.processBidirectionalText,_=oo.processStyledBidirectionalText;if(g&&1===v.sections.length){y=[];for(var b=0,x=g(v.toString(),Pl(v,l,a,e,o,d,f));b<x.length;b+=1){var w=x[b],E=new wl;E.text=w,E.sections=v.sections;for(var k=0;k<w.length;k++)E.sectionIndex.push(0);y.push(E)}}else if(_){y=[];for(var S=0,T=_(v.text,v.sectionIndex,Pl(v,l,a,e,o,d,f));S<T.length;S+=1){var I=T[S],z=new wl;z.text=I[0],z.sectionIndex=I[1],z.sections=v.sections,y.push(z)}}else y=function(t,e){for(var r=[],o=t.text,i=0,a=0,n=e;a<n.length;a+=1){var s=n[a];r.push(t.substring(i,s)),i=s}return i<o.length&&r.push(t.substring(i,o.length)),r}(v,Pl(v,l,a,e,o,d,f));var C=[],P={positionedLines:C,text:v.toString(),top:p[1],bottom:p[1],left:p[0],right:p[0],writingMode:c,iconsInText:!1,verticalizable:!1};return function(t,e,r,o,i,a,n,s,u,l,p,c){for(var h=0,d=-17,f=0,m=0,y="right"===s?1:"left"===s?0:.5,v=0,g=0,_=i;g<_.length;g+=1){var b=_[g];b.trim();var x=b.getMaxScale(),w=24*(x-1),E={positionedGlyphs:[],lineOffset:0};t.positionedLines[v]=E;var k=E.positionedGlyphs,S=0;if(b.length()){for(var T=0;T<b.length();T++){var I=b.getSection(T),z=b.getSectionIndex(T),C=b.getCharCode(T),P=0,A=null,M=null,L=null,R=24,D=!(u===xl.horizontal||!p&&!Zi(C)||p&&(kl[C]||(G=C,qi.Arabic(G)||qi["Arabic Supplement"](G)||qi["Arabic Extended-A"](G)||qi["Arabic Presentation Forms-A"](G)||qi["Arabic Presentation Forms-B"](G))));if(I.imageName){var O=o[I.imageName];if(!O)continue;L=I.imageName,t.iconsInText=t.iconsInText||!0,M=O.paddedRect;var B=O.displaySize;I.scale=24*I.scale/c,P=w+(24-B[1]*I.scale),R=(A={width:B[0],height:B[1],left:1,top:-3,advance:D?B[1]:B[0]}).advance;var F=D?B[0]*I.scale-24*x:B[1]*I.scale-24*x;F>0&&F>S&&(S=F)}else{var U=r[I.fontStack],N=U&&U[C];if(N&&N.rect)M=N.rect,A=N.metrics;else{var j=e[I.fontStack],q=j&&j[C];if(!q)continue;A=q.metrics}P=24*(x-I.scale)}D?(t.verticalizable=!0,k.push({glyph:C,imageName:L,x:h,y:d+P,vertical:D,scale:I.scale,fontStack:I.fontStack,sectionIndex:z,metrics:A,rect:M}),h+=R*I.scale+l):(k.push({glyph:C,imageName:L,x:h,y:d+P,vertical:D,scale:I.scale,fontStack:I.fontStack,sectionIndex:z,metrics:A,rect:M}),h+=A.advance*I.scale+l)}0!==k.length&&(f=Math.max(h-l,f),Ml(k,0,k.length-1,y,S)),h=0;var V=a*x+S;E.lineOffset=Math.max(S,w),d+=V,m=Math.max(V,m),++v}else d+=a,++v}var G,Z=d- -17,H=Al(n),K=H.horizontalAlign,W=H.verticalAlign;(function(t,e,r,o,i,a,n,s,u){var l,p=(e-r)*i;l=a!==n?-s*o- -17:(-o*u+.5)*n;for(var c=0,h=t;c<h.length;c+=1)for(var d=0,f=h[c].positionedGlyphs;d<f.length;d+=1){var m=f[d];m.x+=p,m.y+=l}})(t.positionedLines,y,K,W,f,m,a,Z,i.length),t.top+=-W*Z,t.bottom=t.top+Z,t.left+=-K*f,t.right=t.left+f}(P,e,r,o,y,n,s,u,c,l,h,m),!function(t){for(var e=0,r=t;e<r.length;e+=1)if(0!==r[e].positionedGlyphs.length)return!1;return!0}(C)&&P}wl.fromFeature=function(t,e){for(var r=new wl,o=0;o<t.sections.length;o++){var i=t.sections[o];i.image?r.addImageSection(i):r.addTextSection(i,e)}return r},wl.prototype.length=function(){return this.text.length},wl.prototype.getSection=function(t){return this.sections[this.sectionIndex[t]]},wl.prototype.getSectionIndex=function(t){return this.sectionIndex[t]},wl.prototype.getCharCode=function(t){return this.text.charCodeAt(t)},wl.prototype.verticalizePunctuation=function(){this.text=function(t){for(var e="",r=0;r<t.length;r++){var o=t.charCodeAt(r+1)||null,i=t.charCodeAt(r-1)||null;e+=o&&Hi(o)&&!qs[t[r+1]]||i&&Hi(i)&&!qs[t[r-1]]||!qs[t[r]]?t[r]:qs[t[r]]}return e}(this.text)},wl.prototype.trim=function(){for(var t=0,e=0;e<this.text.length&&kl[this.text.charCodeAt(e)];e++)t++;for(var r=this.text.length,o=this.text.length-1;o>=0&&o>=t&&kl[this.text.charCodeAt(o)];o--)r--;this.text=this.text.substring(t,r),this.sectionIndex=this.sectionIndex.slice(t,r)},wl.prototype.substring=function(t,e){var r=new wl;return r.text=this.text.substring(t,e),r.sectionIndex=this.sectionIndex.slice(t,e),r.sections=this.sections,r},wl.prototype.toString=function(){return this.text},wl.prototype.getMaxScale=function(){var t=this;return this.sectionIndex.reduce((function(e,r){return Math.max(e,t.sections[r].scale)}),0)},wl.prototype.addTextSection=function(t,e){this.text+=t.text,this.sections.push(bl.forText(t.scale,t.fontStack||e));for(var r=this.sections.length-1,o=0;o<t.text.length;++o)this.sectionIndex.push(r)},wl.prototype.addImageSection=function(t){var e=t.image?t.image.name:"";if(0!==e.length){var r=this.getNextImageSectionCharCode();r?(this.text+=String.fromCharCode(r),this.sections.push(bl.forImage(e)),this.sectionIndex.push(this.sections.length-1)):w("Reached maximum number of images 6401")}else w("Can't add FormattedSection with an empty image.")},wl.prototype.getNextImageSectionCharCode=function(){return this.imageSectionID?this.imageSectionID>=63743?null:++this.imageSectionID:(this.imageSectionID=57344,this.imageSectionID)};var kl={9:!0,10:!0,11:!0,12:!0,13:!0,32:!0},Sl={};function Tl(t,e,r,o,i,a){if(e.imageName){var n=o[e.imageName];return n?n.displaySize[0]*e.scale*24/a+i:0}var s=r[e.fontStack],u=s&&s[t];return u?u.metrics.advance*e.scale+i:0}function Il(t,e,r,o){var i=Math.pow(t-e,2);return o?t<e?i/2:2*i:i+Math.abs(r)*r}function zl(t,e,r){var o=0;return 10===t&&(o-=1e4),r&&(o+=150),40!==t&&65288!==t||(o+=50),41!==e&&65289!==e||(o+=50),o}function Cl(t,e,r,o,i,a){for(var n=null,s=Il(e,r,i,a),u=0,l=o;u<l.length;u+=1){var p=l[u],c=Il(e-p.x,r,i,a)+p.badness;c<=s&&(n=p,s=c)}return{index:t,x:e,priorBreak:n,badness:s}}function Pl(t,e,r,o,i,a,n){if("point"!==a)return[];if(!t)return[];for(var s,u=[],l=function(t,e,r,o,i,a){for(var n=0,s=0;s<t.length();s++){var u=t.getSection(s);n+=Tl(t.getCharCode(s),u,o,i,e,a)}return n/Math.max(1,Math.ceil(n/r))}(t,e,r,o,i,n),p=t.text.indexOf("​")>=0,c=0,h=0;h<t.length();h++){var d=t.getSection(h),f=t.getCharCode(h);if(kl[f]||(c+=Tl(f,d,o,i,e,n)),h<t.length()-1){var m=!((s=f)<11904||!(qi["Bopomofo Extended"](s)||qi.Bopomofo(s)||qi["CJK Compatibility Forms"](s)||qi["CJK Compatibility Ideographs"](s)||qi["CJK Compatibility"](s)||qi["CJK Radicals Supplement"](s)||qi["CJK Strokes"](s)||qi["CJK Symbols and Punctuation"](s)||qi["CJK Unified Ideographs Extension A"](s)||qi["CJK Unified Ideographs"](s)||qi["Enclosed CJK Letters and Months"](s)||qi["Halfwidth and Fullwidth Forms"](s)||qi.Hiragana(s)||qi["Ideographic Description Characters"](s)||qi["Kangxi Radicals"](s)||qi["Katakana Phonetic Extensions"](s)||qi.Katakana(s)||qi["Vertical Forms"](s)||qi["Yi Radicals"](s)||qi["Yi Syllables"](s)));(Sl[f]||m||d.imageName)&&u.push(Cl(h+1,c,l,u,zl(f,t.getCharCode(h+1),m&&p),!1))}}return function t(e){return e?t(e.priorBreak).concat(e.index):[]}(Cl(t.length(),c,l,u,0,!0))}function Al(t){var e=.5,r=.5;switch(t){case"right":case"top-right":case"bottom-right":e=1;break;case"left":case"top-left":case"bottom-left":e=0}switch(t){case"bottom":case"bottom-right":case"bottom-left":r=1;break;case"top":case"top-right":case"top-left":r=0}return{horizontalAlign:e,verticalAlign:r}}function Ml(t,e,r,o,i){if(o||i)for(var a=t[r],n=(t[r].x+a.metrics.advance*a.scale)*o,s=e;s<=r;s++)t[s].x-=n,t[s].y+=i}function Ll(t,e,r,o,i,a){var n,s=t.image;if(s.content){var u=s.content,l=s.pixelRatio||1;n=[u[0]/l,u[1]/l,s.displaySize[0]-u[2]/l,s.displaySize[1]-u[3]/l]}var p,c,h,d,f=e.left*a,m=e.right*a;"width"===r||"both"===r?(d=i[0]+f-o[3],c=i[0]+m+o[1]):c=(d=i[0]+(f+m-s.displaySize[0])/2)+s.displaySize[0];var y=e.top*a,v=e.bottom*a;return"height"===r||"both"===r?(p=i[1]+y-o[0],h=i[1]+v+o[2]):h=(p=i[1]+(y+v-s.displaySize[1])/2)+s.displaySize[1],{image:s,top:p,right:c,bottom:h,left:d,collisionPadding:n}}Sl[10]=!0,Sl[32]=!0,Sl[38]=!0,Sl[40]=!0,Sl[41]=!0,Sl[43]=!0,Sl[45]=!0,Sl[47]=!0,Sl[173]=!0,Sl[183]=!0,Sl[8203]=!0,Sl[8208]=!0,Sl[8211]=!0,Sl[8231]=!0;var Rl=function(t){function e(e,r,o,i){t.call(this,e,r),this.angle=o,void 0!==i&&(this.segment=i)}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e,e.prototype.clone=function(){return new e(this.x,this.y,this.angle,this.segment)},e}(i);function Dl(t,e){var r=e.expression;if("constant"===r.kind)return{kind:"constant",layoutSize:r.evaluate(new no(t+1))};if("source"===r.kind)return{kind:"source"};for(var o=r.zoomStops,i=r.interpolationType,a=0;a<o.length&&o[a]<=t;)a++;for(var n=a=Math.max(0,a-1);n<o.length&&o[n]<t+1;)n++;n=Math.min(o.length-1,n);var s=o[a],u=o[n];return"composite"===r.kind?{kind:"composite",minZoom:s,maxZoom:u,interpolationType:i}:{kind:"camera",minZoom:s,maxZoom:u,minSize:r.evaluate(new no(s)),maxSize:r.evaluate(new no(u)),interpolationType:i}}function Ol(t,e,r){var o=e.uSize,i=r.lowerSize;return"source"===t.kind?i/128:"composite"===t.kind?Ve(i/128,r.upperSize/128,e.uSizeT):o}function Bl(t,e){var r=0,o=0;if("constant"===t.kind)o=t.layoutSize;else if("source"!==t.kind){var i=t.interpolationType,a=i?l(ir.interpolationFactor(i,e,t.minZoom,t.maxZoom),0,1):0;"camera"===t.kind?o=Ve(t.minSize,t.maxSize,a):r=a}return{uSizeT:r,uSize:o}}Oi("Anchor",Rl);var Fl=Object.freeze({__proto__:null,getSizeData:Dl,evaluateSizeForFeature:Ol,evaluateSizeForZoom:Bl,SIZE_PACK_FACTOR:128});function Ul(t,e,r,o,i){if(void 0===e.segment)return!0;for(var a=e,n=e.segment+1,s=0;s>-r/2;){if(--n<0)return!1;s-=t[n].dist(a),a=t[n]}s+=t[n].dist(t[n+1]),n++;for(var u=[],l=0;s<r/2;){var p=t[n],c=t[n+1];if(!c)return!1;var h=t[n-1].angleTo(p)-p.angleTo(c);for(h=Math.abs((h+3*Math.PI)%(2*Math.PI)-Math.PI),u.push({distance:s,angleDelta:h}),l+=h;s-u[0].distance>o;)l-=u.shift().angleDelta;if(l>i)return!1;n++,s+=p.dist(c)}return!0}function Nl(t){for(var e=0,r=0;r<t.length-1;r++)e+=t[r].dist(t[r+1]);return e}function jl(t,e,r){return t?.6*e*r:0}function Vl(t,e){return Math.max(t?t.right-t.left:0,e?e.right-e.left:0)}function ql(t,e,r,o,i,a){for(var n=jl(r,i,a),s=Vl(r,o)*a,u=0,l=Nl(t)/2,p=0;p<t.length-1;p++){var c=t[p],h=t[p+1],d=c.dist(h);if(u+d>l){var f=(l-u)/d,m=Ve(c.x,h.x,f),y=Ve(c.y,h.y,f),v=new Rl(m,y,h.angleTo(c),p);return v._round(),!n||Ul(t,v,s,n,e)?v:void 0}u+=d}}function Gl(t,e,r,o,i,a,n,s,u){var l=jl(o,a,n),p=Vl(o,i),c=p*n,h=0===t[0].x||t[0].x===u||0===t[0].y||t[0].y===u;return e-c<e/4&&(e=c+e/4),function t(e,r,o,i,a,n,s,u,l){for(var p=n/2,c=Nl(e),h=0,d=r-o,f=[],m=0;m<e.length-1;m++){for(var y=e[m],v=e[m+1],g=y.dist(v),_=v.angleTo(y);d+o<h+g;){var b=((d+=o)-h)/g,x=Ve(y.x,v.x,b),w=Ve(y.y,v.y,b);if(x>=0&&x<l&&w>=0&&w<l&&d-p>=0&&d+p<=c){var E=new Rl(x,w,_,m);E._round(),i&&!Ul(e,E,n,i,a)||f.push(E)}}h+=g}return u||f.length||s||(f=t(e,h/2,o,i,a,n,s,!0,l)),f}(t,h?e/2*s%e:(p/2+2*a)*n*s%e,e,l,r,c,h,!1,u)}function Zl(t,e,r,o,a){for(var n=[],s=0;s<t.length;s++)for(var u=t[s],l=void 0,p=0;p<u.length-1;p++){var c=u[p],h=u[p+1];c.x<e&&h.x<e||(c.x<e?c=new i(e,c.y+(e-c.x)/(h.x-c.x)*(h.y-c.y))._round():h.x<e&&(h=new i(e,c.y+(e-c.x)/(h.x-c.x)*(h.y-c.y))._round()),c.y<r&&h.y<r||(c.y<r?c=new i(c.x+(r-c.y)/(h.y-c.y)*(h.x-c.x),r)._round():h.y<r&&(h=new i(c.x+(r-c.y)/(h.y-c.y)*(h.x-c.x),r)._round()),c.x>=o&&h.x>=o||(c.x>=o?c=new i(o,c.y+(o-c.x)/(h.x-c.x)*(h.y-c.y))._round():h.x>=o&&(h=new i(o,c.y+(o-c.x)/(h.x-c.x)*(h.y-c.y))._round()),c.y>=a&&h.y>=a||(c.y>=a?c=new i(c.x+(a-c.y)/(h.y-c.y)*(h.x-c.x),a)._round():h.y>=a&&(h=new i(c.x+(a-c.y)/(h.y-c.y)*(h.x-c.x),a)._round()),l&&c.equals(l[l.length-1])||n.push(l=[c]),l.push(h)))))}return n}function Hl(t,e,r,o){var a=[],n=t.image,s=n.pixelRatio,u=n.paddedRect.w-2,l=n.paddedRect.h-2,p=t.right-t.left,c=t.bottom-t.top,h=n.stretchX||[[0,u]],d=n.stretchY||[[0,l]],f=function(t,e){return t+e[1]-e[0]},m=h.reduce(f,0),y=d.reduce(f,0),v=u-m,g=l-y,_=0,b=m,x=0,w=y,E=0,k=v,S=0,T=g;if(n.content&&o){var I=n.content;_=Kl(h,0,I[0]),x=Kl(d,0,I[1]),b=Kl(h,I[0],I[2]),w=Kl(d,I[1],I[3]),E=I[0]-_,S=I[1]-x,k=I[2]-I[0]-b,T=I[3]-I[1]-w}var z=function(o,a,u,l){var h=Xl(o.stretch-_,b,p,t.left),d=$l(o.fixed-E,k,o.stretch,m),f=Xl(a.stretch-x,w,c,t.top),v=$l(a.fixed-S,T,a.stretch,y),g=Xl(u.stretch-_,b,p,t.left),I=$l(u.fixed-E,k,u.stretch,m),z=Xl(l.stretch-x,w,c,t.top),C=$l(l.fixed-S,T,l.stretch,y),P=new i(h,f),A=new i(g,f),M=new i(g,z),L=new i(h,z),R=new i(d/s,v/s),D=new i(I/s,C/s),O=e*Math.PI/180;if(O){var B=Math.sin(O),F=Math.cos(O),U=[F,-B,B,F];P._matMult(U),A._matMult(U),L._matMult(U),M._matMult(U)}var N=o.stretch+o.fixed,j=a.stretch+a.fixed;return{tl:P,tr:A,bl:L,br:M,tex:{x:n.paddedRect.x+1+N,y:n.paddedRect.y+1+j,w:u.stretch+u.fixed-N,h:l.stretch+l.fixed-j},writingMode:void 0,glyphOffset:[0,0],sectionIndex:0,pixelOffsetTL:R,pixelOffsetBR:D,minFontScaleX:k/s/p,minFontScaleY:T/s/c,isSDF:r}};if(o&&(n.stretchX||n.stretchY))for(var C=Wl(h,v,m),P=Wl(d,g,y),A=0;A<C.length-1;A++)for(var M=C[A],L=C[A+1],R=0;R<P.length-1;R++)a.push(z(M,P[R],L,P[R+1]));else a.push(z({fixed:0,stretch:-1},{fixed:0,stretch:-1},{fixed:0,stretch:u+1},{fixed:0,stretch:l+1}));return a}function Kl(t,e,r){for(var o=0,i=0,a=t;i<a.length;i+=1){var n=a[i];o+=Math.max(e,Math.min(r,n[1]))-Math.max(e,Math.min(r,n[0]))}return o}function Wl(t,e,r){for(var o=[{fixed:-1,stretch:0}],i=0,a=t;i<a.length;i+=1){var n=a[i],s=n[0],u=n[1],l=o[o.length-1];o.push({fixed:s-l.stretch,stretch:l.stretch}),o.push({fixed:s-l.stretch,stretch:l.stretch+(u-s)})}return o.push({fixed:e+1,stretch:r}),o}function Xl(t,e,r,o){return t/e*r+o}function $l(t,e,r,o){return t-e*r/o}var Jl=function(t,e,r,o,a,n,s,u,l,p){if(this.boxStartIndex=t.length,l){var c=n.top,h=n.bottom,d=n.collisionPadding;d&&(c-=d[1],h+=d[3]);var f=h-c;f>0&&(f=Math.max(10,f),this.circleDiameter=f)}else{var m=n.top*s-u,y=n.bottom*s+u,v=n.left*s-u,g=n.right*s+u,_=n.collisionPadding;if(_&&(v-=_[0]*s,m-=_[1]*s,g+=_[2]*s,y+=_[3]*s),p){var b=new i(v,m),x=new i(g,m),w=new i(v,y),E=new i(g,y),k=p*Math.PI/180;b._rotate(k),x._rotate(k),w._rotate(k),E._rotate(k),v=Math.min(b.x,x.x,w.x,E.x),g=Math.max(b.x,x.x,w.x,E.x),m=Math.min(b.y,x.y,w.y,E.y),y=Math.max(b.y,x.y,w.y,E.y)}t.emplaceBack(e.x,e.y,v,m,g,y,r,o,a)}this.boxEndIndex=t.length},Yl=function(t,e){if(void 0===t&&(t=[]),void 0===e&&(e=Ql),this.data=t,this.length=this.data.length,this.compare=e,this.length>0)for(var r=(this.length>>1)-1;r>=0;r--)this._down(r)};function Ql(t,e){return t<e?-1:t>e?1:0}function tu(t,e,r){void 0===e&&(e=1),void 0===r&&(r=!1);for(var o=1/0,a=1/0,n=-1/0,s=-1/0,u=t[0],l=0;l<u.length;l++){var p=u[l];(!l||p.x<o)&&(o=p.x),(!l||p.y<a)&&(a=p.y),(!l||p.x>n)&&(n=p.x),(!l||p.y>s)&&(s=p.y)}var c=Math.min(n-o,s-a),h=c/2,d=new Yl([],eu);if(0===c)return new i(o,a);for(var f=o;f<n;f+=c)for(var m=a;m<s;m+=c)d.push(new ru(f+h,m+h,h,t));for(var y=function(t){for(var e=0,r=0,o=0,i=t[0],a=0,n=i.length,s=n-1;a<n;s=a++){var u=i[a],l=i[s],p=u.x*l.y-l.x*u.y;r+=(u.x+l.x)*p,o+=(u.y+l.y)*p,e+=3*p}return new ru(r/e,o/e,0,t)}(t),v=d.length;d.length;){var g=d.pop();(g.d>y.d||!y.d)&&(y=g,r&&console.log("found best %d after %d probes",Math.round(1e4*g.d)/1e4,v)),g.max-y.d<=e||(d.push(new ru(g.p.x-(h=g.h/2),g.p.y-h,h,t)),d.push(new ru(g.p.x+h,g.p.y-h,h,t)),d.push(new ru(g.p.x-h,g.p.y+h,h,t)),d.push(new ru(g.p.x+h,g.p.y+h,h,t)),v+=4)}return r&&(console.log("num probes: "+v),console.log("best distance: "+y.d)),y.p}function eu(t,e){return e.max-t.max}function ru(t,e,r,o){this.p=new i(t,e),this.h=r,this.d=function(t,e){for(var r=!1,o=1/0,i=0;i<e.length;i++)for(var a=e[i],n=0,s=a.length,u=s-1;n<s;u=n++){var l=a[n],p=a[u];l.y>t.y!=p.y>t.y&&t.x<(p.x-l.x)*(t.y-l.y)/(p.y-l.y)+l.x&&(r=!r),o=Math.min(o,Wn(t,l,p))}return(r?1:-1)*Math.sqrt(o)}(this.p,o),this.max=this.d+this.h*Math.SQRT2}Yl.prototype.push=function(t){this.data.push(t),this.length++,this._up(this.length-1)},Yl.prototype.pop=function(){if(0!==this.length){var t=this.data[0],e=this.data.pop();return this.length--,this.length>0&&(this.data[0]=e,this._down(0)),t}},Yl.prototype.peek=function(){return this.data[0]},Yl.prototype._up=function(t){for(var e=this.data,r=this.compare,o=e[t];t>0;){var i=t-1>>1,a=e[i];if(r(o,a)>=0)break;e[t]=a,t=i}e[t]=o},Yl.prototype._down=function(t){for(var e=this.data,r=this.compare,o=this.length>>1,i=e[t];t<o;){var a=1+(t<<1),n=e[a],s=a+1;if(s<this.length&&r(e[s],n)<0&&(a=s,n=e[s]),r(n,i)>=0)break;e[t]=n,t=a}e[t]=i};var iu=Number.POSITIVE_INFINITY;function ou(t,e){return e[1]!==iu?function(t,e,r){var o=0,i=0;switch(e=Math.abs(e),r=Math.abs(r),t){case"top-right":case"top-left":case"top":i=r-7;break;case"bottom-right":case"bottom-left":case"bottom":i=7-r}switch(t){case"top-right":case"bottom-right":case"right":o=-e;break;case"top-left":case"bottom-left":case"left":o=e}return[o,i]}(t,e[0],e[1]):function(t,e){var r=0,o=0;e<0&&(e=0);var i=e/Math.sqrt(2);switch(t){case"top-right":case"top-left":o=i-7;break;case"bottom-right":case"bottom-left":o=7-i;break;case"bottom":o=7-e;break;case"top":o=e-7}switch(t){case"top-right":case"bottom-right":r=-i;break;case"top-left":case"bottom-left":r=i;break;case"left":r=e;break;case"right":r=-e}return[r,o]}(t,e[0])}function nu(t){switch(t){case"right":case"top-right":case"bottom-right":return"right";case"left":case"top-left":case"bottom-left":return"left"}return"center"}function au(t,e,r,o,a,n,s,u,l,p,c,h,d,f,m){var y=function(t,e,r,o,a,n,s,u){for(var l=o.layout.get("text-rotate").evaluate(n,{})*Math.PI/180,p=[],c=0,h=e.positionedLines;c<h.length;c+=1)for(var d=h[c],f=0,m=d.positionedGlyphs;f<m.length;f+=1){var y=m[f];if(y.rect){var v=y.rect||{},g=4,_=!0,b=1,x=0,w=(a||u)&&y.vertical,E=y.metrics.advance*y.scale/2;if(u&&e.verticalizable&&(x=d.lineOffset/2-(y.imageName?-(24-y.metrics.width*y.scale)/2:24*(y.scale-1))),y.imageName){var k=s[y.imageName];_=k.sdf,g=1/(b=k.pixelRatio)}var S=a?[y.x+E,y.y]:[0,0],T=a?[0,0]:[y.x+E+r[0],y.y+r[1]-x],I=[0,0];w&&(I=T,T=[0,0]);var z=(y.metrics.left-g)*y.scale-E+T[0],C=(-y.metrics.top-g)*y.scale+T[1],P=z+v.w*y.scale/b,A=C+v.h*y.scale/b,M=new i(z,C),L=new i(P,C),R=new i(z,A),D=new i(P,A);if(w){var O=new i(-E,E- -17),B=-Math.PI/2,F=12-E,U=new i(22-F,-(y.imageName?F:0)),N=new(Function.prototype.bind.apply(i,[null].concat(I)));M._rotateAround(B,O)._add(U)._add(N),L._rotateAround(B,O)._add(U)._add(N),R._rotateAround(B,O)._add(U)._add(N),D._rotateAround(B,O)._add(U)._add(N)}if(l){var j=Math.sin(l),q=Math.cos(l),V=[q,-j,j,q];M._matMult(V),L._matMult(V),R._matMult(V),D._matMult(V)}var G=new i(0,0),Z=new i(0,0);p.push({tl:M,tr:L,bl:R,br:D,tex:v,writingMode:e.writingMode,glyphOffset:S,sectionIndex:y.sectionIndex,isSDF:_,pixelOffsetTL:G,pixelOffsetBR:Z,minFontScaleX:0,minFontScaleY:0})}}return p}(0,r,u,a,n,s,o,t.allowVerticalPlacement),v=t.textSizeData,g=null;"source"===v.kind?(g=[128*a.layout.get("text-size").evaluate(s,{})])[0]>32640&&w(t.layerIds[0]+': Value for "text-size" is >= 255. Reduce your "text-size".'):"composite"===v.kind&&((g=[128*f.compositeTextSizes[0].evaluate(s,{},m),128*f.compositeTextSizes[1].evaluate(s,{},m)])[0]>32640||g[1]>32640)&&w(t.layerIds[0]+': Value for "text-size" is >= 255. Reduce your "text-size".'),t.addSymbols(t.text,y,g,u,n,s,p,e,l.lineStartIndex,l.lineLength,d,m);for(var _=0,b=c;_<b.length;_+=1)h[b[_]]=t.text.placedSymbolArray.length-1;return 4*y.length}function su(t){for(var e in t)return t[e];return null}function lu(t,e,r,o){var i=t.compareText;if(e in i){for(var a=i[e],n=a.length-1;n>=0;n--)if(o.dist(a[n])<r)return!0}else i[e]=[];return i[e].push(o),!1}var ol=ys.VectorTileFeature.types,uu=[{name:"a_fade_opacity",components:1,type:"Uint8",offset:0}];function ul(t,e,r,o,i,a,n,s,u,l,p,c,h){var d=s?Math.min(32640,Math.round(s[0])):0,f=s?Math.min(32640,Math.round(s[1])):0;t.emplaceBack(e,r,Math.round(32*o),Math.round(32*i),a,n,(d<<1)+(u?1:0),f,16*l,16*p,256*c,256*h)}function cu(t,e,r){t.emplaceBack(e.x,e.y,r),t.emplaceBack(e.x,e.y,r),t.emplaceBack(e.x,e.y,r),t.emplaceBack(e.x,e.y,r)}function pu(t){for(var e=0,r=t.sections;e<r.length;e+=1)if(Xi(r[e].text))return!0;return!1}var hu=function(t){this.layoutVertexArray=new Ao,this.indexArray=new Fo,this.programConfigurations=t,this.segments=new an,this.dynamicLayoutVertexArray=new Mo,this.opacityVertexArray=new Lo,this.placedSymbolArray=new Jo};hu.prototype.isEmpty=function(){return 0===this.layoutVertexArray.length&&0===this.indexArray.length&&0===this.dynamicLayoutVertexArray.length&&0===this.opacityVertexArray.length},hu.prototype.upload=function(t,e,r,o){this.isEmpty()||(r&&(this.layoutVertexBuffer=t.createVertexBuffer(this.layoutVertexArray,Bs.members),this.indexBuffer=t.createIndexBuffer(this.indexArray,e),this.dynamicLayoutVertexBuffer=t.createVertexBuffer(this.dynamicLayoutVertexArray,Fs.members,!0),this.opacityVertexBuffer=t.createVertexBuffer(this.opacityVertexArray,uu,!0),this.opacityVertexBuffer.itemSize=1),(r||o)&&this.programConfigurations.upload(t))},hu.prototype.destroy=function(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.dynamicLayoutVertexBuffer.destroy(),this.opacityVertexBuffer.destroy())},Oi("SymbolBuffers",hu);var du=function(t,e,r){this.layoutVertexArray=new t,this.layoutAttributes=e,this.indexArray=new r,this.segments=new an,this.collisionVertexArray=new Bo};du.prototype.upload=function(t){this.layoutVertexBuffer=t.createVertexBuffer(this.layoutVertexArray,this.layoutAttributes),this.indexBuffer=t.createIndexBuffer(this.indexArray),this.collisionVertexBuffer=t.createVertexBuffer(this.collisionVertexArray,Us.members,!0)},du.prototype.destroy=function(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.segments.destroy(),this.collisionVertexBuffer.destroy())},Oi("CollisionBuffers",du);var fu=function(t){this.collisionBoxArray=t.collisionBoxArray,this.zoom=t.zoom,this.overscaling=t.overscaling,this.layers=t.layers,this.layerIds=this.layers.map((function(t){return t.id})),this.index=t.index,this.pixelRatio=t.pixelRatio,this.sourceLayerIndex=t.sourceLayerIndex,this.hasPattern=!1,this.hasRTLText=!1,this.sortKeyRanges=[],this.collisionCircleArray=[],this.placementInvProjMatrix=oa([]),this.placementViewportMatrix=oa([]);var e=this.layers[0]._unevaluatedLayout._values;this.textSizeData=Dl(this.zoom,e["text-size"]),this.iconSizeData=Dl(this.zoom,e["icon-size"]);var r=this.layers[0].layout,o=r.get("symbol-sort-key"),i=r.get("symbol-z-order");this.sortFeaturesByKey="viewport-y"!==i&&void 0!==o.constantOr(1),this.sortFeaturesByY=("viewport-y"===i||"auto"===i&&!this.sortFeaturesByKey)&&(r.get("text-allow-overlap")||r.get("icon-allow-overlap")||r.get("text-ignore-placement")||r.get("icon-ignore-placement")),"point"===r.get("symbol-placement")&&(this.writingModes=r.get("text-writing-mode").map((function(t){return xl[t]}))),this.stateDependentLayerIds=this.layers.filter((function(t){return t.isStateDependent()})).map((function(t){return t.id})),this.sourceID=t.sourceID};fu.prototype.createArrays=function(){this.text=new hu(new Ln(this.layers,this.zoom,(function(t){return/^text/.test(t)}))),this.icon=new hu(new Ln(this.layers,this.zoom,(function(t){return/^icon/.test(t)}))),this.glyphOffsetArray=new tn,this.lineVertexArray=new en,this.symbolInstances=new Qo},fu.prototype.calculateGlyphDependencies=function(t,e,r,o,i){for(var a=0;a<t.length;a++)if(e[t.charCodeAt(a)]=!0,(r||o)&&i){var n=qs[t.charAt(a)];n&&(e[n.charCodeAt(0)]=!0)}},fu.prototype.populate=function(t,e,r){var o=this.layers[0],i=o.layout,a=i.get("text-font"),n=i.get("text-field"),s=i.get("icon-image"),u=("constant"!==n.value.kind||n.value.value instanceof ee&&!n.value.value.isEmpty()||n.value.value.toString().length>0)&&("constant"!==a.value.kind||a.value.value.length>0),l="constant"!==s.value.kind||!!s.value.value||Object.keys(s.parameters).length>0,p=i.get("symbol-sort-key");if(this.features=[],u||l){for(var c=e.iconDependencies,h=e.glyphDependencies,d=e.availableImages,f=new no(this.zoom),m=0,y=t;m<y.length;m+=1){var v=y[m],g=v.feature,_=v.id,b=v.index,x=v.sourceLayerIndex,w=o._featureFilter.needGeometry,E={type:g.type,id:_,properties:g.properties,geometry:w?Fn(g):[]};if(o._featureFilter.filter(f,E,r)){w||(E.geometry=Fn(g));var k=void 0;if(u){var S=o.getValueAndResolveTokens("text-field",E,r,d),T=ee.factory(S);pu(T)&&(this.hasRTLText=!0),(!this.hasRTLText||"unavailable"===ro()||this.hasRTLText&&oo.isParsed())&&(k=Vs(T,o,E))}var I=void 0;if(l){var z=o.getValueAndResolveTokens("icon-image",E,r,d);I=z instanceof re?z:re.fromString(z)}if(k||I){var C=this.sortFeaturesByKey?p.evaluate(E,{},r):void 0,P={id:_,text:k,icon:I,index:b,sourceLayerIndex:x,geometry:Fn(g),properties:g.properties,type:ol[g.type],sortKey:C};if(this.features.push(P),I&&(c[I.name]=!0),k){var A=a.evaluate(E,{},r).join(","),M="map"===i.get("text-rotation-alignment")&&"point"!==i.get("symbol-placement");this.allowVerticalPlacement=this.writingModes&&this.writingModes.indexOf(xl.vertical)>=0;for(var L=0,R=k.sections;L<R.length;L+=1){var D=R[L];if(D.image)c[D.image.name]=!0;else{var O=Gi(k.toString()),B=D.fontStack||A,F=h[B]=h[B]||{};this.calculateGlyphDependencies(D.text,F,M,this.allowVerticalPlacement,O)}}}}}}"line"===i.get("symbol-placement")&&(this.features=function(t){var e={},r={},o=[],i=0;function a(e){o.push(t[e]),i++}function n(t,e,i){var a=r[t];return delete r[t],r[e]=a,o[a].geometry[0].pop(),o[a].geometry[0]=o[a].geometry[0].concat(i[0]),a}function s(t,r,i){var a=e[r];return delete e[r],e[t]=a,o[a].geometry[0].shift(),o[a].geometry[0]=i[0].concat(o[a].geometry[0]),a}function u(t,e,r){var o=r?e[0][e[0].length-1]:e[0][0];return t+":"+o.x+":"+o.y}for(var l=0;l<t.length;l++){var p=t[l],c=p.geometry,h=p.text?p.text.toString():null;if(h){var d=u(h,c),f=u(h,c,!0);if(d in r&&f in e&&r[d]!==e[f]){var m=s(d,f,c),y=n(d,f,o[m].geometry);delete e[d],delete r[f],r[u(h,o[y].geometry,!0)]=y,o[m].geometry=null}else d in r?n(d,f,c):f in e?s(d,f,c):(a(l),e[d]=i-1,r[f]=i-1)}else a(l)}return o.filter((function(t){return t.geometry}))}(this.features)),this.sortFeaturesByKey&&this.features.sort((function(t,e){return t.sortKey-e.sortKey}))}},fu.prototype.update=function(t,e,r){this.stateDependentLayers.length&&(this.text.programConfigurations.updatePaintArrays(t,e,this.layers,r),this.icon.programConfigurations.updatePaintArrays(t,e,this.layers,r))},fu.prototype.isEmpty=function(){return 0===this.symbolInstances.length&&!this.hasRTLText},fu.prototype.uploadPending=function(){return!this.uploaded||this.text.programConfigurations.needsUpload||this.icon.programConfigurations.needsUpload},fu.prototype.upload=function(t){!this.uploaded&&this.hasDebugData()&&(this.textCollisionBox.upload(t),this.iconCollisionBox.upload(t)),this.text.upload(t,this.sortFeaturesByY,!this.uploaded,this.text.programConfigurations.needsUpload),this.icon.upload(t,this.sortFeaturesByY,!this.uploaded,this.icon.programConfigurations.needsUpload),this.uploaded=!0},fu.prototype.destroyDebugData=function(){this.textCollisionBox.destroy(),this.iconCollisionBox.destroy()},fu.prototype.destroy=function(){this.text.destroy(),this.icon.destroy(),this.hasDebugData()&&this.destroyDebugData()},fu.prototype.addToLineVertexArray=function(t,e){var r=this.lineVertexArray.length;if(void 0!==t.segment){for(var o=t.dist(e[t.segment+1]),i=t.dist(e[t.segment]),a={},n=t.segment+1;n<e.length;n++)a[n]={x:e[n].x,y:e[n].y,tileUnitDistanceFromAnchor:o},n<e.length-1&&(o+=e[n+1].dist(e[n]));for(var s=t.segment||0;s>=0;s--)a[s]={x:e[s].x,y:e[s].y,tileUnitDistanceFromAnchor:i},s>0&&(i+=e[s-1].dist(e[s]));for(var u=0;u<e.length;u++){var l=a[u];this.lineVertexArray.emplaceBack(l.x,l.y,l.tileUnitDistanceFromAnchor)}}return{lineStartIndex:r,lineLength:this.lineVertexArray.length-r}},fu.prototype.addSymbols=function(t,e,r,o,i,a,n,s,u,l,p,c){for(var h=t.indexArray,d=t.layoutVertexArray,f=t.segments.prepareSegment(4*e.length,d,h,a.sortKey),m=this.glyphOffsetArray.length,y=f.vertexLength,v=this.allowVerticalPlacement&&n===xl.vertical?Math.PI/2:0,g=a.text&&a.text.sections,_=0;_<e.length;_++){var b=e[_],x=b.tl,w=b.tr,E=b.bl,k=b.br,S=b.tex,T=b.pixelOffsetTL,I=b.pixelOffsetBR,z=b.minFontScaleX,C=b.minFontScaleY,P=b.glyphOffset,A=b.isSDF,M=b.sectionIndex,L=f.vertexLength,R=P[1];ul(d,s.x,s.y,x.x,R+x.y,S.x,S.y,r,A,T.x,T.y,z,C),ul(d,s.x,s.y,w.x,R+w.y,S.x+S.w,S.y,r,A,I.x,T.y,z,C),ul(d,s.x,s.y,E.x,R+E.y,S.x,S.y+S.h,r,A,T.x,I.y,z,C),ul(d,s.x,s.y,k.x,R+k.y,S.x+S.w,S.y+S.h,r,A,I.x,I.y,z,C),cu(t.dynamicLayoutVertexArray,s,v),h.emplaceBack(L,L+1,L+2),h.emplaceBack(L+1,L+2,L+3),f.vertexLength+=4,f.primitiveLength+=2,this.glyphOffsetArray.emplaceBack(P[0]),_!==e.length-1&&M===e[_+1].sectionIndex||t.programConfigurations.populatePaintArrays(d.length,a,a.index,{},c,g&&g[M])}t.placedSymbolArray.emplaceBack(s.x,s.y,m,this.glyphOffsetArray.length-m,y,u,l,s.segment,r?r[0]:0,r?r[1]:0,o[0],o[1],n,0,!1,0,p)},fu.prototype._addCollisionDebugVertex=function(t,e,r,o,i,a){return e.emplaceBack(0,0),t.emplaceBack(r.x,r.y,o,i,Math.round(a.x),Math.round(a.y))},fu.prototype.addCollisionDebugVertices=function(t,e,r,o,a,n,s){var u=a.segments.prepareSegment(4,a.layoutVertexArray,a.indexArray),l=u.vertexLength,p=a.layoutVertexArray,c=a.collisionVertexArray,h=s.anchorX,d=s.anchorY;this._addCollisionDebugVertex(p,c,n,h,d,new i(t,e)),this._addCollisionDebugVertex(p,c,n,h,d,new i(r,e)),this._addCollisionDebugVertex(p,c,n,h,d,new i(r,o)),this._addCollisionDebugVertex(p,c,n,h,d,new i(t,o)),u.vertexLength+=4;var f=a.indexArray;f.emplaceBack(l,l+1),f.emplaceBack(l+1,l+2),f.emplaceBack(l+2,l+3),f.emplaceBack(l+3,l),u.primitiveLength+=4},fu.prototype.addDebugCollisionBoxes=function(t,e,r,o){for(var i=t;i<e;i++){var a=this.collisionBoxArray.get(i);this.addCollisionDebugVertices(a.x1,a.y1,a.x2,a.y2,o?this.textCollisionBox:this.iconCollisionBox,a.anchorPoint,r)}},fu.prototype.generateCollisionDebugBuffers=function(){this.hasDebugData()&&this.destroyDebugData(),this.textCollisionBox=new du(Do,Ns.members,Go),this.iconCollisionBox=new du(Do,Ns.members,Go);for(var t=0;t<this.symbolInstances.length;t++){var e=this.symbolInstances.get(t);this.addDebugCollisionBoxes(e.textBoxStartIndex,e.textBoxEndIndex,e,!0),this.addDebugCollisionBoxes(e.verticalTextBoxStartIndex,e.verticalTextBoxEndIndex,e,!0),this.addDebugCollisionBoxes(e.iconBoxStartIndex,e.iconBoxEndIndex,e,!1),this.addDebugCollisionBoxes(e.verticalIconBoxStartIndex,e.verticalIconBoxEndIndex,e,!1)}},fu.prototype._deserializeCollisionBoxesForSymbol=function(t,e,r,o,i,a,n,s,u){for(var l={},p=e;p<r;p++){var c=t.get(p);l.textBox={x1:c.x1,y1:c.y1,x2:c.x2,y2:c.y2,anchorPointX:c.anchorPointX,anchorPointY:c.anchorPointY},l.textFeatureIndex=c.featureIndex;break}for(var h=o;h<i;h++){var d=t.get(h);l.verticalTextBox={x1:d.x1,y1:d.y1,x2:d.x2,y2:d.y2,anchorPointX:d.anchorPointX,anchorPointY:d.anchorPointY},l.verticalTextFeatureIndex=d.featureIndex;break}for(var f=a;f<n;f++){var m=t.get(f);l.iconBox={x1:m.x1,y1:m.y1,x2:m.x2,y2:m.y2,anchorPointX:m.anchorPointX,anchorPointY:m.anchorPointY},l.iconFeatureIndex=m.featureIndex;break}for(var y=s;y<u;y++){var v=t.get(y);l.verticalIconBox={x1:v.x1,y1:v.y1,x2:v.x2,y2:v.y2,anchorPointX:v.anchorPointX,anchorPointY:v.anchorPointY},l.verticalIconFeatureIndex=v.featureIndex;break}return l},fu.prototype.deserializeCollisionBoxes=function(t){this.collisionArrays=[];for(var e=0;e<this.symbolInstances.length;e++){var r=this.symbolInstances.get(e);this.collisionArrays.push(this._deserializeCollisionBoxesForSymbol(t,r.textBoxStartIndex,r.textBoxEndIndex,r.verticalTextBoxStartIndex,r.verticalTextBoxEndIndex,r.iconBoxStartIndex,r.iconBoxEndIndex,r.verticalIconBoxStartIndex,r.verticalIconBoxEndIndex))}},fu.prototype.hasTextData=function(){return this.text.segments.get().length>0},fu.prototype.hasIconData=function(){return this.icon.segments.get().length>0},fu.prototype.hasDebugData=function(){return this.textCollisionBox&&this.iconCollisionBox},fu.prototype.hasTextCollisionBoxData=function(){return this.hasDebugData()&&this.textCollisionBox.segments.get().length>0},fu.prototype.hasIconCollisionBoxData=function(){return this.hasDebugData()&&this.iconCollisionBox.segments.get().length>0},fu.prototype.addIndicesForPlacedSymbol=function(t,e){for(var r=t.placedSymbolArray.get(e),o=r.vertexStartIndex+4*r.numGlyphs,i=r.vertexStartIndex;i<o;i+=4)t.indexArray.emplaceBack(i,i+1,i+2),t.indexArray.emplaceBack(i+1,i+2,i+3)},fu.prototype.getSortedSymbolIndexes=function(t){if(this.sortedAngle===t&&void 0!==this.symbolInstanceIndexes)return this.symbolInstanceIndexes;for(var e=Math.sin(t),r=Math.cos(t),o=[],i=[],a=[],n=0;n<this.symbolInstances.length;++n){a.push(n);var s=this.symbolInstances.get(n);o.push(0|Math.round(e*s.anchorX+r*s.anchorY)),i.push(s.featureIndex)}return a.sort((function(t,e){return o[t]-o[e]||i[e]-i[t]})),a},fu.prototype.addToSortKeyRanges=function(t,e){var r=this.sortKeyRanges[this.sortKeyRanges.length-1];r&&r.sortKey===e?r.symbolInstanceEnd=t+1:this.sortKeyRanges.push({sortKey:e,symbolInstanceStart:t,symbolInstanceEnd:t+1})},fu.prototype.sortFeatures=function(t){var e=this;if(this.sortFeaturesByY&&this.sortedAngle!==t&&!(this.text.segments.get().length>1||this.icon.segments.get().length>1)){this.symbolInstanceIndexes=this.getSortedSymbolIndexes(t),this.sortedAngle=t,this.text.indexArray.clear(),this.icon.indexArray.clear(),this.featureSortOrder=[];for(var r=0,o=this.symbolInstanceIndexes;r<o.length;r+=1){var i=this.symbolInstances.get(o[r]);this.featureSortOrder.push(i.featureIndex),[i.rightJustifiedTextSymbolIndex,i.centerJustifiedTextSymbolIndex,i.leftJustifiedTextSymbolIndex].forEach((function(t,r,o){t>=0&&o.indexOf(t)===r&&e.addIndicesForPlacedSymbol(e.text,t)})),i.verticalPlacedTextSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.text,i.verticalPlacedTextSymbolIndex),i.placedIconSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.icon,i.placedIconSymbolIndex),i.verticalPlacedIconSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.icon,i.verticalPlacedIconSymbolIndex)}this.text.indexBuffer&&this.text.indexBuffer.updateData(this.text.indexArray),this.icon.indexBuffer&&this.icon.indexBuffer.updateData(this.icon.indexArray)}},Oi("SymbolBucket",fu,{omit:["layers","collisionBoxArray","features","compareText"]}),fu.MAX_GLYPHS=65535,fu.addDynamicAttributes=cu;var mu=new _o({"symbol-placement":new fo(It.layout_symbol["symbol-placement"]),"symbol-spacing":new fo(It.layout_symbol["symbol-spacing"]),"symbol-avoid-edges":new fo(It.layout_symbol["symbol-avoid-edges"]),"symbol-sort-key":new mo(It.layout_symbol["symbol-sort-key"]),"symbol-z-order":new fo(It.layout_symbol["symbol-z-order"]),"icon-allow-overlap":new fo(It.layout_symbol["icon-allow-overlap"]),"icon-ignore-placement":new fo(It.layout_symbol["icon-ignore-placement"]),"icon-optional":new fo(It.layout_symbol["icon-optional"]),"icon-rotation-alignment":new fo(It.layout_symbol["icon-rotation-alignment"]),"icon-size":new mo(It.layout_symbol["icon-size"]),"icon-text-fit":new fo(It.layout_symbol["icon-text-fit"]),"icon-text-fit-padding":new fo(It.layout_symbol["icon-text-fit-padding"]),"icon-image":new mo(It.layout_symbol["icon-image"]),"icon-rotate":new mo(It.layout_symbol["icon-rotate"]),"icon-padding":new fo(It.layout_symbol["icon-padding"]),"icon-keep-upright":new fo(It.layout_symbol["icon-keep-upright"]),"icon-offset":new mo(It.layout_symbol["icon-offset"]),"icon-anchor":new mo(It.layout_symbol["icon-anchor"]),"icon-pitch-alignment":new fo(It.layout_symbol["icon-pitch-alignment"]),"text-pitch-alignment":new fo(It.layout_symbol["text-pitch-alignment"]),"text-rotation-alignment":new fo(It.layout_symbol["text-rotation-alignment"]),"text-field":new mo(It.layout_symbol["text-field"]),"text-font":new mo(It.layout_symbol["text-font"]),"text-size":new mo(It.layout_symbol["text-size"]),"text-max-width":new mo(It.layout_symbol["text-max-width"]),"text-line-height":new fo(It.layout_symbol["text-line-height"]),"text-letter-spacing":new mo(It.layout_symbol["text-letter-spacing"]),"text-justify":new mo(It.layout_symbol["text-justify"]),"text-radial-offset":new mo(It.layout_symbol["text-radial-offset"]),"text-variable-anchor":new fo(It.layout_symbol["text-variable-anchor"]),"text-anchor":new mo(It.layout_symbol["text-anchor"]),"text-max-angle":new fo(It.layout_symbol["text-max-angle"]),"text-writing-mode":new fo(It.layout_symbol["text-writing-mode"]),"text-rotate":new mo(It.layout_symbol["text-rotate"]),"text-padding":new fo(It.layout_symbol["text-padding"]),"text-keep-upright":new fo(It.layout_symbol["text-keep-upright"]),"text-transform":new mo(It.layout_symbol["text-transform"]),"text-offset":new mo(It.layout_symbol["text-offset"]),"text-allow-overlap":new fo(It.layout_symbol["text-allow-overlap"]),"text-ignore-placement":new fo(It.layout_symbol["text-ignore-placement"]),"text-optional":new fo(It.layout_symbol["text-optional"])}),dl={paint:new _o({"icon-opacity":new mo(It.paint_symbol["icon-opacity"]),"icon-color":new mo(It.paint_symbol["icon-color"]),"icon-halo-color":new mo(It.paint_symbol["icon-halo-color"]),"icon-halo-width":new mo(It.paint_symbol["icon-halo-width"]),"icon-halo-blur":new mo(It.paint_symbol["icon-halo-blur"]),"icon-translate":new fo(It.paint_symbol["icon-translate"]),"icon-translate-anchor":new fo(It.paint_symbol["icon-translate-anchor"]),"text-opacity":new mo(It.paint_symbol["text-opacity"]),"text-color":new mo(It.paint_symbol["text-color"],{runtimeType:Ut,getOverride:function(t){return t.textColor},hasOverride:function(t){return!!t.textColor}}),"text-halo-color":new mo(It.paint_symbol["text-halo-color"]),"text-halo-width":new mo(It.paint_symbol["text-halo-width"]),"text-halo-blur":new mo(It.paint_symbol["text-halo-blur"]),"text-translate":new fo(It.paint_symbol["text-translate"]),"text-translate-anchor":new fo(It.paint_symbol["text-translate-anchor"])}),layout:mu},gu=function(t){this.type=t.property.overrides?t.property.overrides.runtimeType:Dt,this.defaultValue=t};gu.prototype.evaluate=function(t){if(t.formattedSection){var e=this.defaultValue.property.overrides;if(e&&e.hasOverride(t.formattedSection))return e.getOverride(t.formattedSection)}return t.feature&&t.featureState?this.defaultValue.evaluate(t.feature,t.featureState):this.defaultValue.property.specification.default},gu.prototype.eachChild=function(t){this.defaultValue.isConstant()||t(this.defaultValue.value._styleExpression.expression)},gu.prototype.outputDefined=function(){return!1},gu.prototype.serialize=function(){return null},Oi("FormatSectionOverride",gu,{omit:["defaultValue"]});var yu=function(t){function e(e){t.call(this,e,dl)}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e,e.prototype.recalculate=function(e,r){if(t.prototype.recalculate.call(this,e,r),"auto"===this.layout.get("icon-rotation-alignment")&&(this.layout._values["icon-rotation-alignment"]="point"!==this.layout.get("symbol-placement")?"map":"viewport"),"auto"===this.layout.get("text-rotation-alignment")&&(this.layout._values["text-rotation-alignment"]="point"!==this.layout.get("symbol-placement")?"map":"viewport"),"auto"===this.layout.get("text-pitch-alignment")&&(this.layout._values["text-pitch-alignment"]=this.layout.get("text-rotation-alignment")),"auto"===this.layout.get("icon-pitch-alignment")&&(this.layout._values["icon-pitch-alignment"]=this.layout.get("icon-rotation-alignment")),"point"===this.layout.get("symbol-placement")){var o=this.layout.get("text-writing-mode");if(o){for(var i=[],a=0,n=o;a<n.length;a+=1){var s=n[a];i.indexOf(s)<0&&i.push(s)}this.layout._values["text-writing-mode"]=i}else this.layout._values["text-writing-mode"]=["horizontal"]}this._setPaintOverrides()},e.prototype.getValueAndResolveTokens=function(t,e,r,o){var i=this.layout.get(t).evaluate(e,{},r,o),a=this._unevaluatedLayout._values[t];return a.isDataDriven()||qr(a.value)||!i?i:function(t,e){return e.replace(/{([^{}]+)}/g,(function(e,r){return r in t?String(t[r]):""}))}(e.properties,i)},e.prototype.createBucket=function(t){return new fu(t)},e.prototype.queryRadius=function(){return 0},e.prototype.queryIntersectsFeature=function(){return!1},e.prototype._setPaintOverrides=function(){for(var t=0,r=dl.paint.overridableProperties;t<r.length;t+=1){var o=r[t];if(e.hasPaintOverride(this.layout,o)){var i,a=this.paint.get(o),n=new gu(a),s=new Vr(n,a.property.specification);i="constant"===a.value.kind||"source"===a.value.kind?new Zr("source",s):new Hr("composite",s,a.value.zoomStops,a.value._interpolationType),this.paint._values[o]=new po(a.property,i,a.parameters)}}},e.prototype._handleOverridablePaintPropertyUpdate=function(t,r,o){return!(!this.layout||r.isDataDriven()||o.isDataDriven())&&e.hasPaintOverride(this.layout,t)},e.hasPaintOverride=function(t,e){var r=t.get("text-field"),o=dl.paint.properties[e],i=!1,a=function(t){for(var e=0,r=t;e<r.length;e+=1)if(o.overrides&&o.overrides.hasOverride(r[e]))return void(i=!0)};if("constant"===r.value.kind&&r.value.value instanceof ee)a(r.value.value.sections);else if("source"===r.value.kind){var n=function(t){i||(t instanceof se&&ne(t.value)===qt?a(t.value.sections):t instanceof pe?a(t.sections):t.eachChild(n))},s=r.value;s._styleExpression&&n(s._styleExpression.expression)}return i},e}(xo),vu={paint:new _o({"background-color":new fo(It.paint_background["background-color"]),"background-pattern":new yo(It.paint_background["background-pattern"]),"background-opacity":new fo(It.paint_background["background-opacity"])})},_u=function(t){function e(e){t.call(this,e,vu)}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e,e}(xo),xu={paint:new _o({"raster-opacity":new fo(It.paint_raster["raster-opacity"]),"raster-hue-rotate":new fo(It.paint_raster["raster-hue-rotate"]),"raster-brightness-min":new fo(It.paint_raster["raster-brightness-min"]),"raster-brightness-max":new fo(It.paint_raster["raster-brightness-max"]),"raster-saturation":new fo(It.paint_raster["raster-saturation"]),"raster-contrast":new fo(It.paint_raster["raster-contrast"]),"raster-resampling":new fo(It.paint_raster["raster-resampling"]),"raster-fade-duration":new fo(It.paint_raster["raster-fade-duration"])})},bu=function(t){function e(e){t.call(this,e,xu)}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e,e}(xo),wu=function(t){function e(e){t.call(this,e,{}),this.implementation=e}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e,e.prototype.is3D=function(){return"3d"===this.implementation.renderingMode},e.prototype.hasOffscreenPass=function(){return void 0!==this.implementation.prerender},e.prototype.recalculate=function(){},e.prototype.updateTransitions=function(){},e.prototype.hasTransition=function(){},e.prototype.serialize=function(){},e.prototype.onAdd=function(t){this.implementation.onAdd&&this.implementation.onAdd(t,t.painter.context.gl)},e.prototype.onRemove=function(t){this.implementation.onRemove&&this.implementation.onRemove(t,t.painter.context.gl)},e}(xo),Eu={circle:ua,heatmap:_a,hillshade:ba,fill:ss,"fill-extrusion":ks,line:Ds,symbol:yu,background:_u,raster:bu},ku=n.HTMLImageElement,Su=n.HTMLCanvasElement,Tu=n.HTMLVideoElement,Iu=n.ImageData,zu=n.ImageBitmap,Cu=function(t,e,r,o){this.context=t,this.format=r,this.texture=t.gl.createTexture(),this.update(e,o)};Cu.prototype.update=function(t,e,r){var o=t.width,i=t.height,a=!(this.size&&this.size[0]===o&&this.size[1]===i||r),n=this.context,s=n.gl;if(this.useMipmap=Boolean(e&&e.useMipmap),s.bindTexture(s.TEXTURE_2D,this.texture),n.pixelStoreUnpackFlipY.set(!1),n.pixelStoreUnpack.set(1),n.pixelStoreUnpackPremultiplyAlpha.set(this.format===s.RGBA&&(!e||!1!==e.premultiply)),a)this.size=[o,i],t instanceof ku||t instanceof Su||t instanceof Tu||t instanceof Iu||zu&&t instanceof zu?s.texImage2D(s.TEXTURE_2D,0,this.format,this.format,s.UNSIGNED_BYTE,t):s.texImage2D(s.TEXTURE_2D,0,this.format,o,i,0,this.format,s.UNSIGNED_BYTE,t.data);else{var u=r||{x:0,y:0},l=u.x,p=u.y;t instanceof ku||t instanceof Su||t instanceof Tu||t instanceof Iu||zu&&t instanceof zu?s.texSubImage2D(s.TEXTURE_2D,0,l,p,s.RGBA,s.UNSIGNED_BYTE,t):s.texSubImage2D(s.TEXTURE_2D,0,l,p,o,i,s.RGBA,s.UNSIGNED_BYTE,t.data)}this.useMipmap&&this.isSizePowerOfTwo()&&s.generateMipmap(s.TEXTURE_2D)},Cu.prototype.bind=function(t,e,r){var o=this.context.gl;o.bindTexture(o.TEXTURE_2D,this.texture),r!==o.LINEAR_MIPMAP_NEAREST||this.isSizePowerOfTwo()||(r=o.LINEAR),t!==this.filter&&(o.texParameteri(o.TEXTURE_2D,o.TEXTURE_MAG_FILTER,t),o.texParameteri(o.TEXTURE_2D,o.TEXTURE_MIN_FILTER,r||t),this.filter=t),e!==this.wrap&&(o.texParameteri(o.TEXTURE_2D,o.TEXTURE_WRAP_S,e),o.texParameteri(o.TEXTURE_2D,o.TEXTURE_WRAP_T,e),this.wrap=e)},Cu.prototype.isSizePowerOfTwo=function(){return this.size[0]===this.size[1]&&Math.log(this.size[0])/Math.LN2%1==0},Cu.prototype.destroy=function(){this.context.gl.deleteTexture(this.texture),this.texture=null};var Pu=function(t){var e=this;this._callback=t,this._triggered=!1,"undefined"!=typeof MessageChannel&&(this._channel=new MessageChannel,this._channel.port2.onmessage=function(){e._triggered=!1,e._callback()})};Pu.prototype.trigger=function(){var t=this;this._triggered||(this._triggered=!0,this._channel?this._channel.port1.postMessage(!0):setTimeout((function(){t._triggered=!1,t._callback()}),0))},Pu.prototype.remove=function(){delete this._channel,this._callback=function(){}};var Au=function(t,e,r){this.target=t,this.parent=e,this.mapId=r,this.callbacks={},this.tasks={},this.taskQueue=[],this.cancelCallbacks={},y(["receive","process"],this),this.invoker=new Pu(this.process),this.target.addEventListener("message",this.receive,!1),this.globalScope=S()?t:n};function Mu(t,e,r){var o=2*Math.PI*6378137/256/Math.pow(2,r);return[t*o-2*Math.PI*6378137/2,e*o-2*Math.PI*6378137/2]}Au.prototype.send=function(t,e,r,o,i){var a=this;void 0===i&&(i=!1);var n=Math.round(1e18*Math.random()).toString(36).substring(0,10);r&&(this.callbacks[n]=r);var s=z(this.globalScope)?void 0:[];return this.target.postMessage({id:n,type:t,hasCallback:!!r,targetMapId:o,mustQueue:i,sourceMapId:this.mapId,data:Ni(e,s)},s),{cancel:function(){r&&delete a.callbacks[n],a.target.postMessage({id:n,type:"<cancel>",targetMapId:o,sourceMapId:a.mapId})}}},Au.prototype.receive=function(t){var e=t.data,r=e.id;if(r&&(!e.targetMapId||this.mapId===e.targetMapId))if("<cancel>"===e.type){delete this.tasks[r];var o=this.cancelCallbacks[r];delete this.cancelCallbacks[r],o&&o()}else S()||e.mustQueue?(this.tasks[r]=e,this.taskQueue.push(r),this.invoker.trigger()):this.processTask(r,e)},Au.prototype.process=function(){if(this.taskQueue.length){var t=this.taskQueue.shift(),e=this.tasks[t];delete this.tasks[t],this.taskQueue.length&&this.invoker.trigger(),e&&this.processTask(t,e)}},Au.prototype.processTask=function(t,e){var r=this;if("<response>"===e.type){var o=this.callbacks[t];delete this.callbacks[t],o&&(e.error?o(ji(e.error)):o(null,ji(e.data)))}else{var i=!1,a=z(this.globalScope)?void 0:[],n=e.hasCallback?function(e,o){i=!0,delete r.cancelCallbacks[t],r.target.postMessage({id:t,type:"<response>",sourceMapId:r.mapId,error:e?Ni(e):null,data:Ni(o,a)},a)}:function(t){i=!0},s=null,u=ji(e.data);if(this.parent[e.type])s=this.parent[e.type](e.sourceMapId,u,n);else if(this.parent.getWorkerSource){var l=e.type.split(".");s=this.parent.getWorkerSource(e.sourceMapId,l[0],u.source)[l[1]](u,n)}else n(new Error("Could not find function "+e.type));!i&&s&&s.cancel&&(this.cancelCallbacks[t]=s.cancel)}},Au.prototype.remove=function(){this.invoker.remove(),this.target.removeEventListener("message",this.receive,!1)};var Lu=function(t,e){t&&(e?this.setSouthWest(t).setNorthEast(e):4===t.length?this.setSouthWest([t[0],t[1]]).setNorthEast([t[2],t[3]]):this.setSouthWest(t[0]).setNorthEast(t[1]))};Lu.prototype.setNorthEast=function(t){return this._ne=t instanceof Ru?new Ru(t.lng,t.lat):Ru.convert(t),this},Lu.prototype.setSouthWest=function(t){return this._sw=t instanceof Ru?new Ru(t.lng,t.lat):Ru.convert(t),this},Lu.prototype.extend=function(t){var e,r,o=this._sw,i=this._ne;if(t instanceof Ru)e=t,r=t;else{if(!(t instanceof Lu))return Array.isArray(t)?4===t.length||t.every(Array.isArray)?this.extend(Lu.convert(t)):this.extend(Ru.convert(t)):this;if(r=t._ne,!(e=t._sw)||!r)return this}return o||i?(o.lng=Math.min(e.lng,o.lng),o.lat=Math.min(e.lat,o.lat),i.lng=Math.max(r.lng,i.lng),i.lat=Math.max(r.lat,i.lat)):(this._sw=new Ru(e.lng,e.lat),this._ne=new Ru(r.lng,r.lat)),this},Lu.prototype.getCenter=function(){return new Ru((this._sw.lng+this._ne.lng)/2,(this._sw.lat+this._ne.lat)/2)},Lu.prototype.getSouthWest=function(){return this._sw},Lu.prototype.getNorthEast=function(){return this._ne},Lu.prototype.getNorthWest=function(){return new Ru(this.getWest(),this.getNorth())},Lu.prototype.getSouthEast=function(){return new Ru(this.getEast(),this.getSouth())},Lu.prototype.getWest=function(){return this._sw.lng},Lu.prototype.getSouth=function(){return this._sw.lat},Lu.prototype.getEast=function(){return this._ne.lng},Lu.prototype.getNorth=function(){return this._ne.lat},Lu.prototype.toArray=function(){return[this._sw.toArray(),this._ne.toArray()]},Lu.prototype.toString=function(){return"LngLatBounds("+this._sw.toString()+", "+this._ne.toString()+")"},Lu.prototype.isEmpty=function(){return!(this._sw&&this._ne)},Lu.prototype.contains=function(t){var e=Ru.convert(t),r=e.lng,o=e.lat,i=this._sw.lng<=r&&r<=this._ne.lng;return this._sw.lng>this._ne.lng&&(i=this._sw.lng>=r&&r>=this._ne.lng),this._sw.lat<=o&&o<=this._ne.lat&&i},Lu.convert=function(t){return!t||t instanceof Lu?t:new Lu(t)};var Ru=function(t,e){if(isNaN(t)||isNaN(e))throw new Error("Invalid LngLat object: ("+t+", "+e+")");if(this.lng=+t,this.lat=+e,this.lat>90||this.lat<-90)throw new Error("Invalid LngLat latitude value: must be between -90 and 90")};Ru.prototype.wrap=function(){return new Ru(p(this.lng,-180,180),this.lat)},Ru.prototype.toArray=function(){return[this.lng,this.lat]},Ru.prototype.toString=function(){return"LngLat("+this.lng+", "+this.lat+")"},Ru.prototype.distanceTo=function(t){var e=Math.PI/180,r=this.lat*e,o=t.lat*e,i=Math.sin(r)*Math.sin(o)+Math.cos(r)*Math.cos(o)*Math.cos((t.lng-this.lng)*e);return 6371008.8*Math.acos(Math.min(i,1))},Ru.prototype.toBounds=function(t){void 0===t&&(t=0);var e=360*t/40075017,r=e/Math.cos(Math.PI/180*this.lat);return new Lu(new Ru(this.lng-r,this.lat-e),new Ru(this.lng+r,this.lat+e))},Ru.convert=function(t){if(t instanceof Ru)return t;if(Array.isArray(t)&&(2===t.length||3===t.length))return new Ru(Number(t[0]),Number(t[1]));if(!Array.isArray(t)&&"object"==typeof t&&null!==t)return new Ru(Number("lng"in t?t.lng:t.lon),Number(t.lat));throw new Error("`LngLatLike` argument must be specified as a LngLat instance, an object {lng: <lng>, lat: <lat>}, an object {lon: <lng>, lat: <lat>}, or an array of [<lng>, <lat>]")};var Du=2*Math.PI*6371008.8;function Ou(t){return Du*Math.cos(t*Math.PI/180)}function Bu(t){return(180+t)/360}function Fu(t){return(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+t*Math.PI/360)))/360}function Uu(t,e){return t/Ou(e)}function Nu(t){return 360/Math.PI*Math.atan(Math.exp((180-360*t)*Math.PI/180))-90}var ju=function(t,e,r){void 0===r&&(r=0),this.x=+t,this.y=+e,this.z=+r};ju.fromLngLat=function(t,e){void 0===e&&(e=0);var r=Ru.convert(t);return new ju(Bu(r.lng),Fu(r.lat),Uu(e,r.lat))},ju.prototype.toLngLat=function(){return new Ru(360*this.x-180,Nu(this.y))},ju.prototype.toAltitude=function(){return this.z*Ou(Nu(this.y))},ju.prototype.meterInMercatorCoordinateUnits=function(){return 1/Du*(t=Nu(this.y),1/Math.cos(t*Math.PI/180));var t};var Vu=function(t,e,r){this.z=t,this.x=e,this.y=r,this.key=Zu(0,t,t,e,r)};Vu.prototype.equals=function(t){return this.z===t.z&&this.x===t.x&&this.y===t.y},Vu.prototype.url=function(t,e){var r,o,i,a,n,s=(o=this.y,i=this.z,a=Mu(256*(r=this.x),256*(o=Math.pow(2,i)-o-1),i),n=Mu(256*(r+1),256*(o+1),i),a[0]+","+a[1]+","+n[0]+","+n[1]),u=function(t,e,r){for(var o,i="",a=t;a>0;a--)i+=(e&(o=1<<a-1)?1:0)+(r&o?2:0);return i}(this.z,this.x,this.y);return t[(this.x+this.y)%t.length].replace("{prefix}",(this.x%16).toString(16)+(this.y%16).toString(16)).replace("{z}",String(this.z)).replace("{x}",String(this.x)).replace("{y}",String("tms"===e?Math.pow(2,this.z)-this.y-1:this.y)).replace("{quadkey}",u).replace("{bbox-epsg-3857}",s)},Vu.prototype.getTilePoint=function(t){var e=Math.pow(2,this.z);return new i(8192*(t.x*e-this.x),8192*(t.y*e-this.y))},Vu.prototype.toString=function(){return this.z+"/"+this.x+"/"+this.y};var qu=function(t,e){this.wrap=t,this.canonical=e,this.key=Zu(t,e.z,e.z,e.x,e.y)},Gu=function(t,e,r,o,i){this.overscaledZ=t,this.wrap=e,this.canonical=new Vu(r,+o,+i),this.key=Zu(e,t,r,o,i)};function Zu(t,e,r,o,i){(t*=2)<0&&(t=-1*t-1);var a=1<<r;return(a*a*t+a*i+o).toString(36)+r.toString(36)+e.toString(36)}Gu.prototype.equals=function(t){return this.overscaledZ===t.overscaledZ&&this.wrap===t.wrap&&this.canonical.equals(t.canonical)},Gu.prototype.scaledTo=function(t){var e=this.canonical.z-t;return t>this.canonical.z?new Gu(t,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y):new Gu(t,this.wrap,t,this.canonical.x>>e,this.canonical.y>>e)},Gu.prototype.calculateScaledKey=function(t,e){var r=this.canonical.z-t;return t>this.canonical.z?Zu(this.wrap*+e,t,this.canonical.z,this.canonical.x,this.canonical.y):Zu(this.wrap*+e,t,t,this.canonical.x>>r,this.canonical.y>>r)},Gu.prototype.isChildOf=function(t){if(t.wrap!==this.wrap)return!1;var e=this.canonical.z-t.canonical.z;return 0===t.overscaledZ||t.overscaledZ<this.overscaledZ&&t.canonical.x===this.canonical.x>>e&&t.canonical.y===this.canonical.y>>e},Gu.prototype.children=function(t){if(this.overscaledZ>=t)return[new Gu(this.overscaledZ+1,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y)];var e=this.canonical.z+1,r=2*this.canonical.x,o=2*this.canonical.y;return[new Gu(e,this.wrap,e,r,o),new Gu(e,this.wrap,e,r+1,o),new Gu(e,this.wrap,e,r,o+1),new Gu(e,this.wrap,e,r+1,o+1)]},Gu.prototype.isLessThan=function(t){return this.wrap<t.wrap||!(this.wrap>t.wrap)&&(this.overscaledZ<t.overscaledZ||!(this.overscaledZ>t.overscaledZ)&&(this.canonical.x<t.canonical.x||!(this.canonical.x>t.canonical.x)&&this.canonical.y<t.canonical.y))},Gu.prototype.wrapped=function(){return new Gu(this.overscaledZ,0,this.canonical.z,this.canonical.x,this.canonical.y)},Gu.prototype.unwrapTo=function(t){return new Gu(this.overscaledZ,t,this.canonical.z,this.canonical.x,this.canonical.y)},Gu.prototype.overscaleFactor=function(){return Math.pow(2,this.overscaledZ-this.canonical.z)},Gu.prototype.toUnwrapped=function(){return new qu(this.wrap,this.canonical)},Gu.prototype.toString=function(){return this.overscaledZ+"/"+this.canonical.x+"/"+this.canonical.y},Gu.prototype.getTilePoint=function(t){return this.canonical.getTilePoint(new ju(t.x-this.wrap,t.y))},Oi("CanonicalTileID",Vu),Oi("OverscaledTileID",Gu,{omit:["posMatrix"]});var Hu=function(t,e,r){if(this.uid=t,e.height!==e.width)throw new RangeError("DEM tiles must be square");if(r&&"mapbox"!==r&&"terrarium"!==r)return w('"'+r+'" is not a valid encoding type. Valid types include "mapbox" and "terrarium".');this.stride=e.height;var o=this.dim=e.height-2;this.data=new Uint32Array(e.data.buffer),this.encoding=r||"mapbox";for(var i=0;i<o;i++)this.data[this._idx(-1,i)]=this.data[this._idx(0,i)],this.data[this._idx(o,i)]=this.data[this._idx(o-1,i)],this.data[this._idx(i,-1)]=this.data[this._idx(i,0)],this.data[this._idx(i,o)]=this.data[this._idx(i,o-1)];this.data[this._idx(-1,-1)]=this.data[this._idx(0,0)],this.data[this._idx(o,-1)]=this.data[this._idx(o-1,0)],this.data[this._idx(-1,o)]=this.data[this._idx(0,o-1)],this.data[this._idx(o,o)]=this.data[this._idx(o-1,o-1)]};Hu.prototype.get=function(t,e){var r=new Uint8Array(this.data.buffer),o=4*this._idx(t,e);return("terrarium"===this.encoding?this._unpackTerrarium:this._unpackMapbox)(r[o],r[o+1],r[o+2])},Hu.prototype.getUnpackVector=function(){return"terrarium"===this.encoding?[256,1,1/256,32768]:[6553.6,25.6,.1,1e4]},Hu.prototype._idx=function(t,e){if(t<-1||t>=this.dim+1||e<-1||e>=this.dim+1)throw new RangeError("out of range source coordinates for DEM data");return(e+1)*this.stride+(t+1)},Hu.prototype._unpackMapbox=function(t,e,r){return(256*t*256+256*e+r)/10-1e4},Hu.prototype._unpackTerrarium=function(t,e,r){return 256*t+e+r/256-32768},Hu.prototype.getPixels=function(){return new ga({width:this.stride,height:this.stride},new Uint8Array(this.data.buffer))},Hu.prototype.backfillBorder=function(t,e,r){if(this.dim!==t.dim)throw new Error("dem dimension mismatch");var o=e*this.dim,i=e*this.dim+this.dim,a=r*this.dim,n=r*this.dim+this.dim;switch(e){case-1:o=i-1;break;case 1:i=o+1}switch(r){case-1:a=n-1;break;case 1:n=a+1}for(var s=-e*this.dim,u=-r*this.dim,l=a;l<n;l++)for(var p=o;p<i;p++)this.data[this._idx(p,l)]=t.data[this._idx(p+s,l+u)]},Oi("DEMData",Hu);var Ku=function(t){this._stringToNumber={},this._numberToString=[];for(var e=0;e<t.length;e++){var r=t[e];this._stringToNumber[r]=e,this._numberToString[e]=r}};Ku.prototype.encode=function(t){return this._stringToNumber[t]},Ku.prototype.decode=function(t){return this._numberToString[t]};var Wu=function(t,e,r,o,i){this.type="Feature",this._vectorTileFeature=t,t._z=e,t._x=r,t._y=o,this.properties=t.properties,this.id=i},Xu={geometry:{configurable:!0}};Xu.geometry.get=function(){return void 0===this._geometry&&(this._geometry=this._vectorTileFeature.toGeoJSON(this._vectorTileFeature._x,this._vectorTileFeature._y,this._vectorTileFeature._z).geometry),this._geometry},Xu.geometry.set=function(t){this._geometry=t},Wu.prototype.toJSON=function(){var t={geometry:this.geometry};for(var e in this)"_geometry"!==e&&"_vectorTileFeature"!==e&&(t[e]=this[e]);return t},Object.defineProperties(Wu.prototype,Xu);var $u=function(){this.state={},this.stateChanges={},this.deletedStates={}};$u.prototype.updateState=function(t,e,r){var o=String(e);if(this.stateChanges[t]=this.stateChanges[t]||{},this.stateChanges[t][o]=this.stateChanges[t][o]||{},c(this.stateChanges[t][o],r),null===this.deletedStates[t])for(var i in this.deletedStates[t]={},this.state[t])i!==o&&(this.deletedStates[t][i]=null);else if(this.deletedStates[t]&&null===this.deletedStates[t][o])for(var a in this.deletedStates[t][o]={},this.state[t][o])r[a]||(this.deletedStates[t][o][a]=null);else for(var n in r)this.deletedStates[t]&&this.deletedStates[t][o]&&null===this.deletedStates[t][o][n]&&delete this.deletedStates[t][o][n]},$u.prototype.removeFeatureState=function(t,e,r){if(null!==this.deletedStates[t]){var o=String(e);if(this.deletedStates[t]=this.deletedStates[t]||{},r&&void 0!==e)null!==this.deletedStates[t][o]&&(this.deletedStates[t][o]=this.deletedStates[t][o]||{},this.deletedStates[t][o][r]=null);else if(void 0!==e)if(this.stateChanges[t]&&this.stateChanges[t][o])for(r in this.deletedStates[t][o]={},this.stateChanges[t][o])this.deletedStates[t][o][r]=null;else this.deletedStates[t][o]=null;else this.deletedStates[t]=null}},$u.prototype.getState=function(t,e){var r=String(e),o=c({},(this.state[t]||{})[r],(this.stateChanges[t]||{})[r]);if(null===this.deletedStates[t])return{};if(this.deletedStates[t]){var i=this.deletedStates[t][e];if(null===i)return{};for(var a in i)delete o[a]}return o},$u.prototype.initializeTileState=function(t,e){t.setFeatureState(this.state,e)},$u.prototype.coalesceChanges=function(t,e){var r={};for(var o in this.stateChanges){this.state[o]=this.state[o]||{};var i={};for(var a in this.stateChanges[o])this.state[o][a]||(this.state[o][a]={}),c(this.state[o][a],this.stateChanges[o][a]),i[a]=this.state[o][a];r[o]=i}for(var n in this.deletedStates){this.state[n]=this.state[n]||{};var s={};if(null===this.deletedStates[n])for(var u in this.state[n])s[u]={},this.state[n][u]={};else for(var l in this.deletedStates[n]){if(null===this.deletedStates[n][l])this.state[n][l]={};else for(var p=0,h=Object.keys(this.deletedStates[n][l]);p<h.length;p+=1)delete this.state[n][l][h[p]];s[l]=this.state[n][l]}r[n]=r[n]||{},c(r[n],s)}if(this.stateChanges={},this.deletedStates={},0!==Object.keys(r).length)for(var d in t)t[d].setFeatureState(r,e)};var Ju=function(t,e){this.tileID=t,this.x=t.canonical.x,this.y=t.canonical.y,this.z=t.canonical.z,this.grid=new Ai(8192,16,0),this.grid3D=new Ai(8192,16,0),this.featureIndexArray=new on,this.promoteId=e};function Yu(t,e,r,o,i){return g(t,(function(t,a){var n=e instanceof ho?e.get(a):null;return n&&n.evaluate?n.evaluate(r,o,i):n}))}function Qu(t){for(var e=1/0,r=1/0,o=-1/0,i=-1/0,a=0,n=t;a<n.length;a+=1){var s=n[a];e=Math.min(e,s.x),r=Math.min(r,s.y),o=Math.max(o,s.x),i=Math.max(i,s.y)}return{minX:e,minY:r,maxX:o,maxY:i}}function tc(t,e){return e-t}Ju.prototype.insert=function(t,e,r,o,i,a){var n=this.featureIndexArray.length;this.featureIndexArray.emplaceBack(r,o,i);for(var s=a?this.grid3D:this.grid,u=0;u<e.length;u++){for(var l=e[u],p=[1/0,1/0,-1/0,-1/0],c=0;c<l.length;c++){var h=l[c];p[0]=Math.min(p[0],h.x),p[1]=Math.min(p[1],h.y),p[2]=Math.max(p[2],h.x),p[3]=Math.max(p[3],h.y)}p[0]<8192&&p[1]<8192&&p[2]>=0&&p[3]>=0&&s.insert(n,p[0],p[1],p[2],p[3])}},Ju.prototype.loadVTLayers=function(){return this.vtLayers||(this.vtLayers=new ys.VectorTile(new Hs(this.rawTileData)).layers,this.sourceLayerCoder=new Ku(this.vtLayers?Object.keys(this.vtLayers).sort():["_geojsonTileLayer"])),this.vtLayers},Ju.prototype.query=function(t,e,r,o){var a=this;this.loadVTLayers();for(var n=t.params||{},s=8192/t.tileSize/t.scale,u=ii(n.filter),l=t.queryGeometry,p=t.queryPadding*s,c=Qu(l),h=this.grid.query(c.minX-p,c.minY-p,c.maxX+p,c.maxY+p),d=Qu(t.cameraQueryGeometry),f=0,m=this.grid3D.query(d.minX-p,d.minY-p,d.maxX+p,d.maxY+p,(function(e,r,o,a){return function(t,e,r,o,a){for(var n=0,s=t;n<s.length;n+=1){var u=s[n];if(e<=u.x&&r<=u.y&&o>=u.x&&a>=u.y)return!0}var l=[new i(e,r),new i(e,a),new i(o,a),new i(o,r)];if(t.length>2)for(var p=0,c=l;p<c.length;p+=1)if($n(t,c[p]))return!0;for(var h=0;h<t.length-1;h++)if(Jn(t[h],t[h+1],l))return!0;return!1}(t.cameraQueryGeometry,e-p,r-p,o+p,a+p)}));f<m.length;f+=1)h.push(m[f]);h.sort(tc);for(var y,g={},v=function(i){var p=h[i];if(p!==y){y=p;var c=a.featureIndexArray.get(p),d=null;a.loadMatchingFeature(g,c.bucketIndex,c.sourceLayerIndex,c.featureIndex,u,n.layers,n.availableImages,e,r,o,(function(e,r,o){return d||(d=Fn(e)),r.queryIntersectsFeature(l,e,o,d,a.z,t.transform,s,t.pixelPosMatrix)}))}},b=0;b<h.length;b++)v(b);return g},Ju.prototype.loadMatchingFeature=function(t,e,r,o,i,a,n,s,u,l,p){var c=this.bucketLayerIDs[e];if(!a||function(t,e){for(var r=0;r<t.length;r++)if(e.indexOf(t[r])>=0)return!0;return!1}(a,c)){var h=this.sourceLayerCoder.decode(r),d=this.vtLayers[h].feature(o);if(i.filter(new no(this.tileID.overscaledZ),d))for(var f=this.getId(d,h),m=0;m<c.length;m++){var y=c[m];if(!(a&&a.indexOf(y)<0)){var v=s[y];if(v){var g={};void 0!==f&&l&&(g=l.getState(v.sourceLayer||"_geojsonTileLayer",f));var _=u[y];_.paint=Yu(_.paint,v.paint,d,g,n),_.layout=Yu(_.layout,v.layout,d,g,n);var b=!p||p(d,v,g);if(b){var x=new Wu(d,this.z,this.x,this.y,f);x.layer=_;var w=t[y];void 0===w&&(w=t[y]=[]),w.push({featureIndex:o,feature:x,intersectionZ:b})}}}}}},Ju.prototype.lookupSymbolFeatures=function(t,e,r,o,i,a,n,s){var u={};this.loadVTLayers();for(var l=ii(i),p=0,c=t;p<c.length;p+=1)this.loadMatchingFeature(u,r,o,c[p],l,a,n,s,e);return u},Ju.prototype.hasLayer=function(t){for(var e=0,r=this.bucketLayerIDs;e<r.length;e+=1)for(var o=0,i=r[e];o<i.length;o+=1)if(t===i[o])return!0;return!1},Ju.prototype.getId=function(t,e){var r=t.id;return this.promoteId&&"boolean"==typeof(r=t.properties["string"==typeof this.promoteId?this.promoteId:this.promoteId[e]])&&(r=Number(r)),r},Oi("FeatureIndex",Ju,{omit:["rawTileData","sourceLayerCoder"]});var ec=function(t,e){this.tileID=t,this.uid=d(),this.uses=0,this.tileSize=e,this.buckets={},this.expirationTime=null,this.queryPadding=0,this.hasSymbolBuckets=!1,this.hasRTLText=!1,this.dependencies={},this.expiredRequestCount=0,this.state="loading"};ec.prototype.registerFadeDuration=function(t){var e=t+this.timeAdded;e<B.now()||this.fadeEndTime&&e<this.fadeEndTime||(this.fadeEndTime=e)},ec.prototype.wasRequested=function(){return"errored"===this.state||"loaded"===this.state||"reloading"===this.state},ec.prototype.loadVectorData=function(t,e,r){if(this.hasData()&&this.unloadVectorData(),this.state="loaded",t){for(var o in t.featureIndex&&(this.latestFeatureIndex=t.featureIndex,t.rawTileData?(this.latestRawTileData=t.rawTileData,this.latestFeatureIndex.rawTileData=t.rawTileData):this.latestRawTileData&&(this.latestFeatureIndex.rawTileData=this.latestRawTileData)),this.collisionBoxArray=t.collisionBoxArray,this.buckets=function(t,e){var r={};if(!e)return r;for(var o=function(){var t=a[i],o=t.layerIds.map((function(t){return e.getLayer(t)})).filter(Boolean);if(0!==o.length){t.layers=o,t.stateDependentLayerIds&&(t.stateDependentLayers=t.stateDependentLayerIds.map((function(t){return o.filter((function(e){return e.id===t}))[0]})));for(var n=0,s=o;n<s.length;n+=1)r[s[n].id]=t}},i=0,a=t;i<a.length;i+=1)o();return r}(t.buckets,e.style),this.hasSymbolBuckets=!1,this.buckets){var i=this.buckets[o];if(i instanceof fu){if(this.hasSymbolBuckets=!0,!r)break;i.justReloaded=!0}}if(this.hasRTLText=!1,this.hasSymbolBuckets)for(var a in this.buckets){var n=this.buckets[a];if(n instanceof fu&&n.hasRTLText){this.hasRTLText=!0,oo.isLoading()||oo.isLoaded()||"deferred"!==ro()||io();break}}for(var s in this.queryPadding=0,this.buckets){var u=this.buckets[s];this.queryPadding=Math.max(this.queryPadding,e.style.getLayer(s).queryRadius(u))}t.imageAtlas&&(this.imageAtlas=t.imageAtlas),t.glyphAtlasImage&&(this.glyphAtlasImage=t.glyphAtlasImage)}else this.collisionBoxArray=new Xo},ec.prototype.unloadVectorData=function(){for(var t in this.buckets)this.buckets[t].destroy();this.buckets={},this.imageAtlasTexture&&this.imageAtlasTexture.destroy(),this.imageAtlas&&(this.imageAtlas=null),this.glyphAtlasTexture&&this.glyphAtlasTexture.destroy(),this.latestFeatureIndex=null,this.state="unloaded"},ec.prototype.getBucket=function(t){return this.buckets[t.id]},ec.prototype.upload=function(t){for(var e in this.buckets){var r=this.buckets[e];r.uploadPending()&&r.upload(t)}var o=t.gl;this.imageAtlas&&!this.imageAtlas.uploaded&&(this.imageAtlasTexture=new Cu(t,this.imageAtlas.image,o.RGBA),this.imageAtlas.uploaded=!0),this.glyphAtlasImage&&(this.glyphAtlasTexture=new Cu(t,this.glyphAtlasImage,o.ALPHA),this.glyphAtlasImage=null)},ec.prototype.prepare=function(t){this.imageAtlas&&this.imageAtlas.patchUpdatedImages(t,this.imageAtlasTexture)},ec.prototype.queryRenderedFeatures=function(t,e,r,o,i,a,n,s,u,l){return this.latestFeatureIndex&&this.latestFeatureIndex.rawTileData?this.latestFeatureIndex.query({queryGeometry:o,cameraQueryGeometry:i,scale:a,tileSize:this.tileSize,pixelPosMatrix:l,transform:s,params:n,queryPadding:this.queryPadding*u},t,e,r):{}},ec.prototype.querySourceFeatures=function(t,e){var r=this.latestFeatureIndex;if(r&&r.rawTileData){var o=r.loadVTLayers(),i=e?e.sourceLayer:"",a=o._geojsonTileLayer||o[i];if(a)for(var n=ii(e&&e.filter),s=this.tileID.canonical,u=s.z,l=s.x,p=s.y,c={z:u,x:l,y:p},h=0;h<a.length;h++){var d=a.feature(h);if(n.filter(new no(this.tileID.overscaledZ),d)){var f=r.getId(d,i),m=new Wu(d,u,l,p,f);m.tile=c,t.push(m)}}}},ec.prototype.hasData=function(){return"loaded"===this.state||"reloading"===this.state||"expired"===this.state},ec.prototype.patternsLoaded=function(){return this.imageAtlas&&!!Object.keys(this.imageAtlas.patternPositions).length},ec.prototype.setExpiryData=function(t){var e=this.expirationTime;if(t.cacheControl){var r=T(t.cacheControl);r["max-age"]&&(this.expirationTime=Date.now()+1e3*r["max-age"])}else t.expires&&(this.expirationTime=new Date(t.expires).getTime());if(this.expirationTime){var o=Date.now(),i=!1;if(this.expirationTime>o)i=!1;else if(e)if(this.expirationTime<e)i=!0;else{var a=this.expirationTime-e;a?this.expirationTime=o+Math.max(a,3e4):i=!0}else i=!0;i?(this.expiredRequestCount++,this.state="expired"):this.expiredRequestCount=0}},ec.prototype.getExpiryTimeout=function(){if(this.expirationTime)return this.expiredRequestCount?1e3*(1<<Math.min(this.expiredRequestCount-1,31)):Math.min(this.expirationTime-(new Date).getTime(),Math.pow(2,31)-1)},ec.prototype.setFeatureState=function(t,e){if(this.latestFeatureIndex&&this.latestFeatureIndex.rawTileData&&0!==Object.keys(t).length){var r=this.latestFeatureIndex.loadVTLayers();for(var o in this.buckets)if(e.style.hasLayer(o)){var i=this.buckets[o],a=i.layers[0].sourceLayer||"_geojsonTileLayer",n=r[a],s=t[a];if(n&&s&&0!==Object.keys(s).length){i.update(s,n,this.imageAtlas&&this.imageAtlas.patternPositions||{});var u=e&&e.style&&e.style.getLayer(o);u&&(this.queryPadding=Math.max(this.queryPadding,u.queryRadius(i)))}}}},ec.prototype.holdingForFade=function(){return void 0!==this.symbolFadeHoldUntil},ec.prototype.symbolFadeFinished=function(){return!this.symbolFadeHoldUntil||this.symbolFadeHoldUntil<B.now()},ec.prototype.clearFadeHold=function(){this.symbolFadeHoldUntil=void 0},ec.prototype.setHoldDuration=function(t){this.symbolFadeHoldUntil=B.now()+t},ec.prototype.setDependencies=function(t,e){for(var r={},o=0,i=e;o<i.length;o+=1)r[i[o]]=!0;this.dependencies[t]=r},ec.prototype.hasDependency=function(t,e){for(var r=0,o=t;r<o.length;r+=1){var i=this.dependencies[o[r]];if(i)for(var a=0,n=e;a<n.length;a+=1)if(i[n[a]])return!0}return!1};var rp=n.performance,rc=function(t){this._marks={start:[t.url,"start"].join("#"),end:[t.url,"end"].join("#"),measure:t.url.toString()},rp.mark(this._marks.start)};rc.prototype.finish=function(){rp.mark(this._marks.end);var t=rp.getEntriesByName(this._marks.measure);return 0===t.length&&(rp.measure(this._marks.measure,this._marks.start,this._marks.end),t=rp.getEntriesByName(this._marks.measure),rp.clearMarks(this._marks.start),rp.clearMarks(this._marks.end),rp.clearMeasures(this._marks.measure)),t},t.Actor=Au,t.AlphaImage=ma,t.CanonicalTileID=Vu,t.CollisionBoxArray=Xo,t.Color=Yt,t.DEMData=Hu,t.DataConstantProperty=fo,t.DictionaryCoder=Ku,t.EXTENT=8192,t.ErrorEvent=St,t.EvaluationParameters=no,t.Event=kt,t.Evented=Tt,t.FeatureIndex=Ju,t.FillBucket=os,t.FillExtrusionBucket=bs,t.ImageAtlas=_l,t.ImagePosition=yl,t.LineBucket=As,t.LngLat=Ru,t.LngLatBounds=Lu,t.MercatorCoordinate=ju,t.ONE_EM=24,t.OverscaledTileID=Gu,t.Point=i,t.Point$1=i,t.Properties=_o,t.Protobuf=Hs,t.RGBAImage=ga,t.RequestManager=G,t.RequestPerformance=rc,t.ResourceType=ft,t.SegmentVector=an,t.SourceFeatureState=$u,t.StructArrayLayout1ui2=Zo,t.StructArrayLayout2f1f2i16=Oo,t.StructArrayLayout2i4=To,t.StructArrayLayout3ui6=Fo,t.StructArrayLayout4i8=Io,t.SymbolBucket=fu,t.Texture=Cu,t.Tile=ec,t.Transitionable=lo,t.Uniform1f=_n,t.Uniform1i=vn,t.Uniform2f=xn,t.Uniform3f=bn,t.Uniform4f=wn,t.UniformColor=En,t.UniformMatrix4f=Sn,t.UnwrappedTileID=qu,t.ValidationError=zt,t.WritingMode=xl,t.ZoomHistory=Vi,t.add=function(t,e,r){return t[0]=e[0]+r[0],t[1]=e[1]+r[1],t[2]=e[2]+r[2],t},t.addDynamicAttributes=cu,t.asyncAll=function(t,e,r){if(!t.length)return r(null,[]);var o=t.length,i=new Array(t.length),a=null;t.forEach((function(t,n){e(t,(function(t,e){t&&(a=t),i[n]=e,0==--o&&r(a,i)}))}))},t.bezier=s,t.bindAll=y,t.browser=B,t.cacheEntryPossiblyAdded=function(t){++pt>st&&(t.getActor().send("enforceCacheSizeLimit",at),pt=0)},t.clamp=l,t.clearTileCache=function(t){var e=n.caches.delete("mapbox-tiles");t&&e.catch(t).then((function(){return t()}))},t.clipLine=Zl,t.clone=function(t){var e=new ia(16);return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e[8]=t[8],e[9]=t[9],e[10]=t[10],e[11]=t[11],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15],e},t.clone$1=b,t.clone$2=function(t){var e=new ia(3);return e[0]=t[0],e[1]=t[1],e[2]=t[2],e},t.collisionCircleLayout=js,t.config=F,t.create=function(){var t=new ia(16);return ia!=Float32Array&&(t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[11]=0,t[12]=0,t[13]=0,t[14]=0),t[0]=1,t[5]=1,t[10]=1,t[15]=1,t},t.create$1=function(){var t=new ia(9);return ia!=Float32Array&&(t[1]=0,t[2]=0,t[3]=0,t[5]=0,t[6]=0,t[7]=0),t[0]=1,t[4]=1,t[8]=1,t},t.create$2=function(){var t=new ia(4);return ia!=Float32Array&&(t[1]=0,t[2]=0),t[0]=1,t[3]=1,t},t.createCommonjsModule=e,t.createExpression=Gr,t.createLayout=ko,t.createStyleLayer=function(t){return"custom"===t.type?new wu(t):new Eu[t.type](t)},t.cross=function(t,e,r){var o=e[0],i=e[1],a=e[2],n=r[0],s=r[1],u=r[2];return t[0]=i*u-a*s,t[1]=a*n-o*u,t[2]=o*s-i*n,t},t.deepEqual=function t(e,r){if(Array.isArray(e)){if(!Array.isArray(r)||e.length!==r.length)return!1;for(var o=0;o<e.length;o++)if(!t(e[o],r[o]))return!1;return!0}if("object"==typeof e&&null!==e&&null!==r){if("object"!=typeof r)return!1;if(Object.keys(e).length!==Object.keys(r).length)return!1;for(var i in e)if(!t(e[i],r[i]))return!1;return!0}return e===r},t.dot=function(t,e){return t[0]*e[0]+t[1]*e[1]+t[2]*e[2]},t.dot$1=function(t,e){return t[0]*e[0]+t[1]*e[1]+t[2]*e[2]+t[3]*e[3]},t.ease=u,t.emitValidationErrors=Pi,t.endsWith=v,t.enforceCacheSizeLimit=function(t){lt(),Q&&Q.then((function(e){e.keys().then((function(r){for(var o=0;o<r.length-t;o++)e.delete(r[o])}))}))},t.evaluateSizeForFeature=Ol,t.evaluateSizeForZoom=Bl,t.evaluateVariableOffset=ou,t.evented=eo,t.extend=c,t.featureFilter=ii,t.filterObject=_,t.fromRotation=function(t,e){var r=Math.sin(e),o=Math.cos(e);return t[0]=o,t[1]=r,t[2]=0,t[3]=-r,t[4]=o,t[5]=0,t[6]=0,t[7]=0,t[8]=1,t},t.getAnchorAlignment=Al,t.getAnchorJustification=nu,t.getArrayBuffer=_t,t.getImage=bt,t.getJSON=function(t,e){return vt(c(t,{type:"json"}),e)},t.getRTLTextPluginStatus=ro,t.getReferrer=dt,t.getVideo=function(t,e){var r,o,i=n.document.createElement("video");i.muted=!0,i.onloadstart=function(){e(null,i)};for(var a=0;a<t.length;a++){var s=n.document.createElement("source");r=t[a],o=void 0,(o=n.document.createElement("a")).href=r,(o.protocol!==n.document.location.protocol||o.host!==n.document.location.host)&&(i.crossOrigin="Anonymous"),s.src=t[a],i.appendChild(s)}return{cancel:function(){}}},t.identity=oa,t.invert=function(t,e){var r=e[0],o=e[1],i=e[2],a=e[3],n=e[4],s=e[5],u=e[6],l=e[7],p=e[8],c=e[9],h=e[10],d=e[11],f=e[12],m=e[13],y=e[14],v=e[15],g=r*s-o*n,_=r*u-i*n,b=r*l-a*n,x=o*u-i*s,w=o*l-a*s,E=i*l-a*u,k=p*m-c*f,S=p*y-h*f,T=p*v-d*f,I=c*y-h*m,z=c*v-d*m,C=h*v-d*y,P=g*C-_*z+b*I+x*T-w*S+E*k;return P?(t[0]=(s*C-u*z+l*I)*(P=1/P),t[1]=(i*z-o*C-a*I)*P,t[2]=(m*E-y*w+v*x)*P,t[3]=(h*w-c*E-d*x)*P,t[4]=(u*T-n*C-l*S)*P,t[5]=(r*C-i*T+a*S)*P,t[6]=(y*b-f*E-v*_)*P,t[7]=(p*E-h*b+d*_)*P,t[8]=(n*z-s*T+l*k)*P,t[9]=(o*T-r*z-a*k)*P,t[10]=(f*w-m*b+v*g)*P,t[11]=(c*b-p*w-d*g)*P,t[12]=(s*S-n*I-u*k)*P,t[13]=(r*I-o*S+i*k)*P,t[14]=(m*_-f*x-y*g)*P,t[15]=(p*x-c*_+h*g)*P,t):null},t.isChar=qi,t.isMapboxURL=Z,t.keysDifference=function(t,e){var r=[];for(var o in t)o in e||r.push(o);return r},t.makeRequest=vt,t.mapObject=g,t.mercatorXfromLng=Bu,t.mercatorYfromLat=Fu,t.mercatorZfromAltitude=Uu,t.mul=sa,t.multiply=na,t.mvt=ys,t.normalize=function(t,e){var r=e[0],o=e[1],i=e[2],a=r*r+o*o+i*i;return a>0&&(a=1/Math.sqrt(a)),t[0]=e[0]*a,t[1]=e[1]*a,t[2]=e[2]*a,t},t.number=Ve,t.offscreenCanvasSupported=ht,t.ortho=function(t,e,r,o,i,a,n){var s=1/(e-r),u=1/(o-i),l=1/(a-n);return t[0]=-2*s,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=-2*u,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=2*l,t[11]=0,t[12]=(e+r)*s,t[13]=(i+o)*u,t[14]=(n+a)*l,t[15]=1,t},t.parseGlyphPBF=function(t){return new Hs(t).readFields(hl,[])},t.pbf=Hs,t.performSymbolLayout=function(t,e,r,o,i,a,n){t.createArrays(),t.tilePixelRatio=8192/(512*t.overscaling),t.compareText={},t.iconsNeedLinear=!1;var s=t.layers[0].layout,u=t.layers[0]._unevaluatedLayout._values,l={};if("composite"===t.textSizeData.kind){var p=t.textSizeData,c=p.maxZoom;l.compositeTextSizes=[u["text-size"].possiblyEvaluate(new no(p.minZoom),n),u["text-size"].possiblyEvaluate(new no(c),n)]}if("composite"===t.iconSizeData.kind){var h=t.iconSizeData,d=h.maxZoom;l.compositeIconSizes=[u["icon-size"].possiblyEvaluate(new no(h.minZoom),n),u["icon-size"].possiblyEvaluate(new no(d),n)]}l.layoutTextSize=u["text-size"].possiblyEvaluate(new no(t.zoom+1),n),l.layoutIconSize=u["icon-size"].possiblyEvaluate(new no(t.zoom+1),n),l.textMaxSize=u["text-size"].possiblyEvaluate(new no(18));for(var f=24*s.get("text-line-height"),m="map"===s.get("text-rotation-alignment")&&"point"!==s.get("symbol-placement"),y=s.get("text-keep-upright"),v=s.get("text-size"),g=function(){var a=b[_],u=s.get("text-font").evaluate(a,{},n).join(","),p=v.evaluate(a,{},n),c=l.layoutTextSize.evaluate(a,{},n),h=l.layoutIconSize.evaluate(a,{},n),d={horizontal:{},vertical:void 0},g=a.text,x=[0,0];if(g){var E=g.toString(),k=24*s.get("text-letter-spacing").evaluate(a,{},n),S=function(t){for(var e=0,r=t;e<r.length;e+=1)if(o=r[e].charCodeAt(0),qi.Arabic(o)||qi["Arabic Supplement"](o)||qi["Arabic Extended-A"](o)||qi["Arabic Presentation Forms-A"](o)||qi["Arabic Presentation Forms-B"](o))return!1;var o;return!0}(E)?k:0,T=s.get("text-anchor").evaluate(a,{},n),I=s.get("text-variable-anchor");if(!I){var z=s.get("text-radial-offset").evaluate(a,{},n);x=z?ou(T,[24*z,iu]):s.get("text-offset").evaluate(a,{},n).map((function(t){return 24*t}))}var C=m?"center":s.get("text-justify").evaluate(a,{},n),P=s.get("symbol-placement"),A="point"===P?24*s.get("text-max-width").evaluate(a,{},n):0,M=function(){t.allowVerticalPlacement&&Gi(E)&&(d.vertical=El(g,e,r,i,u,A,f,T,"left",S,x,xl.vertical,!0,P,c,p))};if(!m&&I){for(var L="auto"===C?I.map((function(t){return nu(t)})):[C],R=!1,D=0;D<L.length;D++){var O=L[D];if(!d.horizontal[O])if(R)d.horizontal[O]=d.horizontal[0];else{var B=El(g,e,r,i,u,A,f,"center",O,S,x,xl.horizontal,!1,P,c,p);B&&(d.horizontal[O]=B,R=1===B.positionedLines.length)}}M()}else{"auto"===C&&(C=nu(T));var F=El(g,e,r,i,u,A,f,T,C,S,x,xl.horizontal,!1,P,c,p);F&&(d.horizontal[C]=F),M(),Gi(E)&&m&&y&&(d.vertical=El(g,e,r,i,u,A,f,T,C,S,x,xl.vertical,!1,P,c,p))}}var U=void 0,N=!1;if(a.icon&&a.icon.name){var j=o[a.icon.name];j&&(U=function(t,e,r){var o=Al(r),i=e[0]-t.displaySize[0]*o.horizontalAlign,a=e[1]-t.displaySize[1]*o.verticalAlign;return{image:t,top:a,bottom:a+t.displaySize[1],left:i,right:i+t.displaySize[0]}}(i[a.icon.name],s.get("icon-offset").evaluate(a,{},n),s.get("icon-anchor").evaluate(a,{},n)),N=j.sdf,void 0===t.sdfIcons?t.sdfIcons=j.sdf:t.sdfIcons!==j.sdf&&w("Style sheet warning: Cannot mix SDF and non-SDF icons in one buffer"),(j.pixelRatio!==t.pixelRatio||0!==s.get("icon-rotate").constantOr(1))&&(t.iconsNeedLinear=!0))}var q=su(d.horizontal)||d.vertical;t.iconsInText=!!q&&q.iconsInText,(q||U)&&function(t,e,r,o,i,a,n,s,u,l,p){var c=a.textMaxSize.evaluate(e,{});void 0===c&&(c=n);var h,d=t.layers[0].layout,f=d.get("icon-offset").evaluate(e,{},p),m=su(r.horizontal),y=n/24,v=t.tilePixelRatio*y,g=t.tilePixelRatio*c/24,_=t.tilePixelRatio*s,b=t.tilePixelRatio*d.get("symbol-spacing"),x=d.get("text-padding")*t.tilePixelRatio,E=d.get("icon-padding")*t.tilePixelRatio,k=d.get("text-max-angle")/180*Math.PI,S="map"===d.get("text-rotation-alignment")&&"point"!==d.get("symbol-placement"),T="map"===d.get("icon-rotation-alignment")&&"point"!==d.get("symbol-placement"),I=d.get("symbol-placement"),z=b/2,C=d.get("icon-text-fit");o&&"none"!==C&&(t.allowVerticalPlacement&&r.vertical&&(h=Ll(o,r.vertical,C,d.get("icon-text-fit-padding"),f,y)),m&&(o=Ll(o,m,C,d.get("icon-text-fit-padding"),f,y)));var P=function(s,c){c.x<0||c.x>=8192||c.y<0||c.y>=8192||function(t,e,r,o,i,a,n,s,u,l,p,c,h,d,f,m,y,v,g,_,b,x,E,k,S){var T,I,z,C,P,A=t.addToLineVertexArray(e,r),M=0,L=0,R=0,D=0,O=-1,B=-1,F={},U=pn(""),N=0,j=0;if(void 0===s._unevaluatedLayout.getValue("text-radial-offset")?(N=(T=s.layout.get("text-offset").evaluate(b,{},k).map((function(t){return 24*t})))[0],j=T[1]):(N=24*s.layout.get("text-radial-offset").evaluate(b,{},k),j=iu),t.allowVerticalPlacement&&o.vertical){var q=s.layout.get("text-rotate").evaluate(b,{},k)+90;C=new Jl(u,e,l,p,c,o.vertical,h,d,f,q),n&&(P=new Jl(u,e,l,p,c,n,y,v,f,q))}if(i){var V=s.layout.get("icon-rotate").evaluate(b,{}),G="none"!==s.layout.get("icon-text-fit"),Z=Hl(i,V,E,G),H=n?Hl(n,V,E,G):void 0;z=new Jl(u,e,l,p,c,i,y,v,!1,V),M=4*Z.length;var K=t.iconSizeData,W=null;"source"===K.kind?(W=[128*s.layout.get("icon-size").evaluate(b,{})])[0]>32640&&w(t.layerIds[0]+': Value for "icon-size" is >= 255. Reduce your "icon-size".'):"composite"===K.kind&&((W=[128*x.compositeIconSizes[0].evaluate(b,{},k),128*x.compositeIconSizes[1].evaluate(b,{},k)])[0]>32640||W[1]>32640)&&w(t.layerIds[0]+': Value for "icon-size" is >= 255. Reduce your "icon-size".'),t.addSymbols(t.icon,Z,W,_,g,b,!1,e,A.lineStartIndex,A.lineLength,-1,k),O=t.icon.placedSymbolArray.length-1,H&&(L=4*H.length,t.addSymbols(t.icon,H,W,_,g,b,xl.vertical,e,A.lineStartIndex,A.lineLength,-1,k),B=t.icon.placedSymbolArray.length-1)}for(var X in o.horizontal){var $=o.horizontal[X];if(!I){U=pn($.text);var J=s.layout.get("text-rotate").evaluate(b,{},k);I=new Jl(u,e,l,p,c,$,h,d,f,J)}var Y=1===$.positionedLines.length;if(R+=au(t,e,$,a,s,f,b,m,A,o.vertical?xl.horizontal:xl.horizontalOnly,Y?Object.keys(o.horizontal):[X],F,O,x,k),Y)break}o.vertical&&(D+=au(t,e,o.vertical,a,s,f,b,m,A,xl.vertical,["vertical"],F,B,x,k));var Q=I?I.boxStartIndex:t.collisionBoxArray.length,tt=I?I.boxEndIndex:t.collisionBoxArray.length,et=C?C.boxStartIndex:t.collisionBoxArray.length,rt=C?C.boxEndIndex:t.collisionBoxArray.length,it=z?z.boxStartIndex:t.collisionBoxArray.length,ot=z?z.boxEndIndex:t.collisionBoxArray.length,nt=P?P.boxStartIndex:t.collisionBoxArray.length,at=P?P.boxEndIndex:t.collisionBoxArray.length,st=-1,lt=function(t,e){return t&&t.circleDiameter?Math.max(t.circleDiameter,e):e};st=lt(I,st),st=lt(C,st),st=lt(z,st);var ut=(st=lt(P,st))>-1?1:0;ut&&(st*=S/24),t.glyphOffsetArray.length>=fu.MAX_GLYPHS&&w("Too many glyphs being rendered in a tile. See https://github.com/mapbox/mapbox-gl-js/issues/2907"),void 0!==b.sortKey&&t.addToSortKeyRanges(t.symbolInstances.length,b.sortKey),t.symbolInstances.emplaceBack(e.x,e.y,F.right>=0?F.right:-1,F.center>=0?F.center:-1,F.left>=0?F.left:-1,F.vertical||-1,O,B,U,Q,tt,et,rt,it,ot,nt,at,l,R,D,M,L,ut,0,h,N,j,st)}(t,c,s,r,o,i,h,t.layers[0],t.collisionBoxArray,e.index,e.sourceLayerIndex,t.index,v,x,S,u,_,E,T,f,e,a,l,p,n)};if("line"===I)for(var A=0,M=Zl(e.geometry,0,0,8192,8192);A<M.length;A+=1)for(var L=M[A],R=0,D=Gl(L,b,k,r.vertical||m,o,24,g,t.overscaling,8192);R<D.length;R+=1){var O=D[R];m&&lu(t,m.text,z,O)||P(L,O)}else if("line-center"===I)for(var B=0,F=e.geometry;B<F.length;B+=1){var U=F[B];if(U.length>1){var N=ql(U,k,r.vertical||m,o,24,g);N&&P(U,N)}}else if("Polygon"===e.type)for(var j=0,q=ts(e.geometry,0);j<q.length;j+=1){var V=q[j],G=tu(V,16);P(V[0],new Rl(G.x,G.y,0))}else if("LineString"===e.type)for(var Z=0,H=e.geometry;Z<H.length;Z+=1){var K=H[Z];P(K,new Rl(K[0].x,K[0].y,0))}else if("Point"===e.type)for(var W=0,X=e.geometry;W<X.length;W+=1)for(var $=0,J=X[W];$<J.length;$+=1){var Y=J[$];P([Y],new Rl(Y.x,Y.y,0))}}(t,a,d,U,o,l,c,h,x,N,n)},_=0,b=t.features;_<b.length;_+=1)g();a&&t.generateCollisionDebugBuffers()},t.perspective=function(t,e,r,o,i){var a,n=1/Math.tan(e/2);return t[0]=n/r,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=n,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[11]=-1,t[12]=0,t[13]=0,t[15]=0,null!=i&&i!==1/0?(t[10]=(i+o)*(a=1/(o-i)),t[14]=2*i*o*a):(t[10]=-1,t[14]=-2*o),t},t.pick=function(t,e){for(var r={},o=0;o<e.length;o++){var i=e[o];i in t&&(r[i]=t[i])}return r},t.plugin=oo,t.polygonIntersectsPolygon=jn,t.postMapLoadEvent=nt,t.postTurnstileEvent=it,t.potpack=gl,t.refProperties=["type","source","source-layer","minzoom","maxzoom","filter","layout"],t.register=Oi,t.registerForPluginStateChange=function(t){return t({pluginStatus:Ji,pluginURL:Yi}),eo.on("pluginStateChange",t),t},t.rotate=function(t,e,r){var o=e[0],i=e[1],a=e[2],n=e[3],s=Math.sin(r),u=Math.cos(r);return t[0]=o*u+a*s,t[1]=i*u+n*s,t[2]=o*-s+a*u,t[3]=i*-s+n*u,t},t.rotateX=function(t,e,r){var o=Math.sin(r),i=Math.cos(r),a=e[4],n=e[5],s=e[6],u=e[7],l=e[8],p=e[9],c=e[10],h=e[11];return e!==t&&(t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t[4]=a*i+l*o,t[5]=n*i+p*o,t[6]=s*i+c*o,t[7]=u*i+h*o,t[8]=l*i-a*o,t[9]=p*i-n*o,t[10]=c*i-s*o,t[11]=h*i-u*o,t},t.rotateZ=function(t,e,r){var o=Math.sin(r),i=Math.cos(r),a=e[0],n=e[1],s=e[2],u=e[3],l=e[4],p=e[5],c=e[6],h=e[7];return e!==t&&(t[8]=e[8],t[9]=e[9],t[10]=e[10],t[11]=e[11],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t[0]=a*i+l*o,t[1]=n*i+p*o,t[2]=s*i+c*o,t[3]=u*i+h*o,t[4]=l*i-a*o,t[5]=p*i-n*o,t[6]=c*i-s*o,t[7]=h*i-u*o,t},t.scale=function(t,e,r){var o=r[0],i=r[1],a=r[2];return t[0]=e[0]*o,t[1]=e[1]*o,t[2]=e[2]*o,t[3]=e[3]*o,t[4]=e[4]*i,t[5]=e[5]*i,t[6]=e[6]*i,t[7]=e[7]*i,t[8]=e[8]*a,t[9]=e[9]*a,t[10]=e[10]*a,t[11]=e[11]*a,t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15],t},t.scale$1=function(t,e,r){return t[0]=e[0]*r,t[1]=e[1]*r,t[2]=e[2]*r,t[3]=e[3]*r,t},t.scale$2=function(t,e,r){return t[0]=e[0]*r,t[1]=e[1]*r,t[2]=e[2]*r,t},t.setCacheLimits=function(t,e){at=t,st=e},t.setRTLTextPlugin=function(t,e,r){if(void 0===r&&(r=!1),"deferred"===Ji||"loading"===Ji||"loaded"===Ji)throw new Error("setRTLTextPlugin cannot be called multiple times.");Yi=B.resolveURL(t),Ji="deferred",$i=e,to(),r||io()},t.sphericalToCartesian=function(t){var e=t[0],r=t[1],o=t[2];return r+=90,r*=Math.PI/180,o*=Math.PI/180,{x:e*Math.cos(r)*Math.sin(o),y:e*Math.sin(r)*Math.sin(o),z:e*Math.cos(o)}},t.sqrLen=function(t){var e=t[0],r=t[1];return e*e+r*r},t.styleSpec=It,t.sub=function(t,e,r){return t[0]=e[0]-r[0],t[1]=e[1]-r[1],t[2]=e[2]-r[2],t},t.symbolSize=Fl,t.transformMat3=function(t,e,r){var o=e[0],i=e[1],a=e[2];return t[0]=o*r[0]+i*r[3]+a*r[6],t[1]=o*r[1]+i*r[4]+a*r[7],t[2]=o*r[2]+i*r[5]+a*r[8],t},t.transformMat4=la,t.translate=function(t,e,r){var o,i,a,n,s,u,l,p,c,h,d,f,m=r[0],y=r[1],v=r[2];return e===t?(t[12]=e[0]*m+e[4]*y+e[8]*v+e[12],t[13]=e[1]*m+e[5]*y+e[9]*v+e[13],t[14]=e[2]*m+e[6]*y+e[10]*v+e[14],t[15]=e[3]*m+e[7]*y+e[11]*v+e[15]):(i=e[1],a=e[2],n=e[3],s=e[4],u=e[5],l=e[6],p=e[7],c=e[8],h=e[9],d=e[10],f=e[11],t[0]=o=e[0],t[1]=i,t[2]=a,t[3]=n,t[4]=s,t[5]=u,t[6]=l,t[7]=p,t[8]=c,t[9]=h,t[10]=d,t[11]=f,t[12]=o*m+s*y+c*v+e[12],t[13]=i*m+u*y+h*v+e[13],t[14]=a*m+l*y+d*v+e[14],t[15]=n*m+p*y+f*v+e[15]),t},t.triggerPluginCompletionEvent=Qi,t.uniqueId=d,t.validateCustomStyleLayer=function(t){var e=[],r=t.id;return void 0===r&&e.push({message:"layers."+r+': missing required property "id"'}),void 0===t.render&&e.push({message:"layers."+r+': missing required method "render"'}),t.renderingMode&&"2d"!==t.renderingMode&&"3d"!==t.renderingMode&&e.push({message:"layers."+r+': property "renderingMode" must be either "2d" or "3d"'}),e},t.validateLight=Ii,t.validateStyle=Ti,t.values=function(t){var e=[];for(var r in t)e.push(t[r]);return e},t.vectorTile=ys,t.version="1.11.1",t.warnOnce=w,t.webpSupported=U,t.window=n,t.wrap=p})),o(0,(function(t){function e(t){var r=typeof t;if("number"===r||"boolean"===r||"string"===r||null==t)return JSON.stringify(t);if(Array.isArray(t)){for(var i="[",o=0,n=t;o<n.length;o+=1)i+=e(n[o])+",";return i+"]"}for(var s=Object.keys(t).sort(),a="{",l=0;l<s.length;l++)a+=JSON.stringify(s[l])+":"+e(t[s[l]])+",";return a+"}"}function r(r){for(var i="",o=0,n=t.refProperties;o<n.length;o+=1)i+="/"+e(r[n[o]]);return i}var i=function(t){this.keyCache={},t&&this.replace(t)};i.prototype.replace=function(t){this._layerConfigs={},this._layers={},this.update(t,[])},i.prototype.update=function(e,i){for(var o=this,n=0,s=e;n<s.length;n+=1){var a=s[n];this._layerConfigs[a.id]=a;var l=this._layers[a.id]=t.createStyleLayer(a);l._featureFilter=t.featureFilter(l.filter),this.keyCache[a.id]&&delete this.keyCache[a.id]}for(var u=0,c=i;u<c.length;u+=1){var h=c[u];delete this.keyCache[h],delete this._layerConfigs[h],delete this._layers[h]}this.familiesBySource={};for(var p=0,d=function(t,e){for(var i={},o=0;o<t.length;o++){var n=e&&e[t[o].id]||r(t[o]);e&&(e[t[o].id]=n);var s=i[n];s||(s=i[n]=[]),s.push(t[o])}var a=[];for(var l in i)a.push(i[l]);return a}(t.values(this._layerConfigs),this.keyCache);p<d.length;p+=1){var f=d[p].map((function(t){return o._layers[t.id]})),g=f[0];if("none"!==g.visibility){var m=g.source||"",y=this.familiesBySource[m];y||(y=this.familiesBySource[m]={});var v=g.sourceLayer||"_geojsonTileLayer",_=y[v];_||(_=y[v]=[]),_.push(f)}}};var o=function(e){var r={},i=[];for(var o in e){var n=e[o],s=r[o]={};for(var a in n){var l=n[+a];if(l&&0!==l.bitmap.width&&0!==l.bitmap.height){var u={x:0,y:0,w:l.bitmap.width+2,h:l.bitmap.height+2};i.push(u),s[a]={rect:u,metrics:l.metrics}}}}var c=t.potpack(i),h=new t.AlphaImage({width:c.w||1,height:c.h||1});for(var p in e){var d=e[p];for(var f in d){var g=d[+f];if(g&&0!==g.bitmap.width&&0!==g.bitmap.height){var m=r[p][f].rect;t.AlphaImage.copy(g.bitmap,h,{x:0,y:0},{x:m.x+1,y:m.y+1},g.bitmap)}}}this.image=h,this.positions=r};t.register("GlyphAtlas",o);var n=function(e){this.tileID=new t.OverscaledTileID(e.tileID.overscaledZ,e.tileID.wrap,e.tileID.canonical.z,e.tileID.canonical.x,e.tileID.canonical.y),this.uid=e.uid,this.zoom=e.zoom,this.pixelRatio=e.pixelRatio,this.tileSize=e.tileSize,this.source=e.source,this.overscaling=this.tileID.overscaleFactor(),this.showCollisionBoxes=e.showCollisionBoxes,this.collectResourceTiming=!!e.collectResourceTiming,this.returnDependencies=!!e.returnDependencies,this.promoteId=e.promoteId};function s(e,r,i){for(var o=new t.EvaluationParameters(r),n=0,s=e;n<s.length;n+=1)s[n].recalculate(o,i)}function a(e,r){var i=t.getArrayBuffer(e.request,(function(e,i,o,n){e?r(e):i&&r(null,{vectorTile:new t.vectorTile.VectorTile(new t.pbf(i)),rawData:i,cacheControl:o,expires:n})}));return function(){i.cancel(),r()}}n.prototype.parse=function(e,r,i,n,a){var l=this;this.status="parsing",this.data=e,this.collisionBoxArray=new t.CollisionBoxArray;var u=new t.DictionaryCoder(Object.keys(e.layers).sort()),c=new t.FeatureIndex(this.tileID,this.promoteId);c.bucketLayerIDs=[];var h,p,d,f,g={},m={featureIndex:c,iconDependencies:{},patternDependencies:{},glyphDependencies:{},availableImages:i},y=r.familiesBySource[this.source];for(var v in y){var _=e.layers[v];if(_){1===_.version&&t.warnOnce('Vector tile source "'+this.source+'" layer "'+v+'" does not use vector tile spec v2 and therefore may have some rendering errors.');for(var x=u.encode(v),w=[],E=0;E<_.length;E++){var k=_.feature(E),b=c.getId(k,v);w.push({feature:k,id:b,index:E,sourceLayerIndex:x})}for(var S=0,T=y[v];S<T.length;S+=1){var I=T[S],z=I[0];z.minzoom&&this.zoom<Math.floor(z.minzoom)||z.maxzoom&&this.zoom>=z.maxzoom||"none"!==z.visibility&&(s(I,this.zoom,i),(g[z.id]=z.createBucket({index:c.bucketLayerIDs.length,layers:I,zoom:this.zoom,pixelRatio:this.pixelRatio,overscaling:this.overscaling,collisionBoxArray:this.collisionBoxArray,sourceLayerIndex:x,sourceID:this.source})).populate(w,m,this.tileID.canonical),c.bucketLayerIDs.push(I.map((function(t){return t.id}))))}}}var C=t.mapObject(m.glyphDependencies,(function(t){return Object.keys(t).map(Number)}));Object.keys(C).length?n.send("getGlyphs",{uid:this.uid,stacks:C},(function(t,e){h||(h=t,p=e,M.call(l))})):p={};var P=Object.keys(m.iconDependencies);P.length?n.send("getImages",{icons:P,source:this.source,tileID:this.tileID,type:"icons"},(function(t,e){h||(h=t,d=e,M.call(l))})):d={};var A=Object.keys(m.patternDependencies);function M(){if(h)return a(h);if(p&&d&&f){var e=new o(p),r=new t.ImageAtlas(d,f);for(var n in g){var l=g[n];l instanceof t.SymbolBucket?(s(l.layers,this.zoom,i),t.performSymbolLayout(l,p,e.positions,d,r.iconPositions,this.showCollisionBoxes,this.tileID.canonical)):l.hasPattern&&(l instanceof t.LineBucket||l instanceof t.FillBucket||l instanceof t.FillExtrusionBucket)&&(s(l.layers,this.zoom,i),l.addFeatures(m,this.tileID.canonical,r.patternPositions))}this.status="done",a(null,{buckets:t.values(g).filter((function(t){return!t.isEmpty()})),featureIndex:c,collisionBoxArray:this.collisionBoxArray,glyphAtlasImage:e.image,imageAtlas:r,glyphMap:this.returnDependencies?p:null,iconMap:this.returnDependencies?d:null,glyphPositions:this.returnDependencies?e.positions:null})}}A.length?n.send("getImages",{icons:A,source:this.source,tileID:this.tileID,type:"patterns"},(function(t,e){h||(h=t,f=e,M.call(l))})):f={},M.call(this)};var l=function(t,e,r,i){this.actor=t,this.layerIndex=e,this.availableImages=r,this.loadVectorData=i||a,this.loading={},this.loaded={}};l.prototype.loadTile=function(e,r){var i=this,o=e.uid;this.loading||(this.loading={});var s=!!(e&&e.request&&e.request.collectResourceTiming)&&new t.RequestPerformance(e.request),a=this.loading[o]=new n(e);a.abort=this.loadVectorData(e,(function(e,n){if(delete i.loading[o],e||!n)return a.status="done",i.loaded[o]=a,r(e);var l=n.rawData,u={};n.expires&&(u.expires=n.expires),n.cacheControl&&(u.cacheControl=n.cacheControl);var c={};if(s){var h=s.finish();h&&(c.resourceTiming=JSON.parse(JSON.stringify(h)))}a.vectorTile=n.vectorTile,a.parse(n.vectorTile,i.layerIndex,i.availableImages,i.actor,(function(e,i){if(e||!i)return r(e);r(null,t.extend({rawTileData:l.slice(0)},i,u,c))})),i.loaded=i.loaded||{},i.loaded[o]=a}))},l.prototype.reloadTile=function(t,e){var r=this,i=this.loaded,o=t.uid,n=this;if(i&&i[o]){var s=i[o];s.showCollisionBoxes=t.showCollisionBoxes;var a=function(t,i){var o=s.reloadCallback;o&&(delete s.reloadCallback,s.parse(s.vectorTile,n.layerIndex,r.availableImages,n.actor,o)),e(t,i)};"parsing"===s.status?s.reloadCallback=a:"done"===s.status&&(s.vectorTile?s.parse(s.vectorTile,this.layerIndex,this.availableImages,this.actor,a):a())}},l.prototype.abortTile=function(t,e){var r=this.loading,i=t.uid;r&&r[i]&&r[i].abort&&(r[i].abort(),delete r[i]),e()},l.prototype.removeTile=function(t,e){var r=this.loaded,i=t.uid;r&&r[i]&&delete r[i],e()};var u=t.window.ImageBitmap,c=function(){this.loaded={}};function h(t,e){if(0!==t.length){p(t[0],e);for(var r=1;r<t.length;r++)p(t[r],!e)}}function p(t,e){for(var r=0,i=0,o=t.length,n=o-1;i<o;n=i++)r+=(t[i][0]-t[n][0])*(t[n][1]+t[i][1]);r>=0!=!!e&&t.reverse()}c.prototype.loadTile=function(e,r){var i=e.uid,o=e.encoding,n=e.rawImageData,s=u&&n instanceof u?this.getImageData(n):n,a=new t.DEMData(i,s,o);this.loaded=this.loaded||{},this.loaded[i]=a,r(null,a)},c.prototype.getImageData=function(e){this.offscreenCanvas&&this.offscreenCanvasContext||(this.offscreenCanvas=new OffscreenCanvas(e.width,e.height),this.offscreenCanvasContext=this.offscreenCanvas.getContext("2d")),this.offscreenCanvas.width=e.width,this.offscreenCanvas.height=e.height,this.offscreenCanvasContext.drawImage(e,0,0,e.width,e.height);var r=this.offscreenCanvasContext.getImageData(-1,-1,e.width+2,e.height+2);return this.offscreenCanvasContext.clearRect(0,0,this.offscreenCanvas.width,this.offscreenCanvas.height),new t.RGBAImage({width:r.width,height:r.height},r.data)},c.prototype.removeTile=function(t){var e=this.loaded,r=t.uid;e&&e[r]&&delete e[r]};var d=t.vectorTile.VectorTileFeature.prototype.toGeoJSON,f=function(e){this._feature=e,this.extent=t.EXTENT,this.type=e.type,this.properties=e.tags,"id"in e&&!isNaN(e.id)&&(this.id=parseInt(e.id,10))};f.prototype.loadGeometry=function(){if(1===this._feature.type){for(var e=[],r=0,i=this._feature.geometry;r<i.length;r+=1){var o=i[r];e.push([new t.Point$1(o[0],o[1])])}return e}for(var n=[],s=0,a=this._feature.geometry;s<a.length;s+=1){for(var l=[],u=0,c=a[s];u<c.length;u+=1){var h=c[u];l.push(new t.Point$1(h[0],h[1]))}n.push(l)}return n},f.prototype.toGeoJSON=function(t,e,r){return d.call(this,t,e,r)};var g=function(e){this.layers={_geojsonTileLayer:this},this.name="_geojsonTileLayer",this.extent=t.EXTENT,this.length=e.length,this._features=e};g.prototype.feature=function(t){return new f(this._features[t])};var m=t.vectorTile.VectorTileFeature,y=v;function v(t,e){this.options=e||{},this.features=t,this.length=t.length}function _(t,e){this.id="number"==typeof t.id?t.id:void 0,this.type=t.type,this.rawGeometry=1===t.type?[t.geometry]:t.geometry,this.properties=t.tags,this.extent=e||4096}v.prototype.feature=function(t){return new _(this.features[t],this.options.extent)},_.prototype.loadGeometry=function(){var e=this.rawGeometry;this.geometry=[];for(var r=0;r<e.length;r++){for(var i=e[r],o=[],n=0;n<i.length;n++)o.push(new t.Point$1(i[n][0],i[n][1]));this.geometry.push(o)}return this.geometry},_.prototype.bbox=function(){this.geometry||this.loadGeometry();for(var t=this.geometry,e=1/0,r=-1/0,i=1/0,o=-1/0,n=0;n<t.length;n++)for(var s=t[n],a=0;a<s.length;a++){var l=s[a];e=Math.min(e,l.x),r=Math.max(r,l.x),i=Math.min(i,l.y),o=Math.max(o,l.y)}return[e,i,r,o]},_.prototype.toGeoJSON=m.prototype.toGeoJSON;var x=E,w=y;function E(e){var r=new t.pbf;return function(t,e){for(var r in t.layers)e.writeMessage(3,k,t.layers[r])}(e,r),r.finish()}function k(t,e){var r;e.writeVarintField(15,t.version||1),e.writeStringField(1,t.name||""),e.writeVarintField(5,t.extent||4096);var i={keys:[],values:[],keycache:{},valuecache:{}};for(r=0;r<t.length;r++)i.feature=t.feature(r),e.writeMessage(2,b,i);var o=i.keys;for(r=0;r<o.length;r++)e.writeStringField(3,o[r]);var n=i.values;for(r=0;r<n.length;r++)e.writeMessage(4,C,n[r])}function b(t,e){var r=t.feature;void 0!==r.id&&e.writeVarintField(1,r.id),e.writeMessage(2,S,t),e.writeVarintField(3,r.type),e.writeMessage(4,z,r)}function S(t,e){var r=t.feature,i=t.keys,o=t.values,n=t.keycache,s=t.valuecache;for(var a in r.properties){var l=n[a];void 0===l&&(i.push(a),n[a]=l=i.length-1),e.writeVarint(l);var u=r.properties[a],c=typeof u;"string"!==c&&"boolean"!==c&&"number"!==c&&(u=JSON.stringify(u));var h=c+":"+u,p=s[h];void 0===p&&(o.push(u),s[h]=p=o.length-1),e.writeVarint(p)}}function T(t,e){return(e<<3)+(7&t)}function I(t){return t<<1^t>>31}function z(t,e){for(var r=t.loadGeometry(),i=t.type,o=0,n=0,s=r.length,a=0;a<s;a++){var l=r[a],u=1;1===i&&(u=l.length),e.writeVarint(T(1,u));for(var c=3===i?l.length-1:l.length,h=0;h<c;h++){1===h&&1!==i&&e.writeVarint(T(2,c-1));var p=l[h].x-o,d=l[h].y-n;e.writeVarint(I(p)),e.writeVarint(I(d)),o+=p,n+=d}3===i&&e.writeVarint(T(7,1))}}function C(t,e){var r=typeof t;"string"===r?e.writeStringField(1,t):"boolean"===r?e.writeBooleanField(7,t):"number"===r&&(t%1!=0?e.writeDoubleField(3,t):t<0?e.writeSVarintField(6,t):e.writeVarintField(5,t))}function P(t,e,r,i){A(t,r,i),A(e,2*r,2*i),A(e,2*r+1,2*i+1)}function A(t,e,r){var i=t[e];t[e]=t[r],t[r]=i}function M(t,e,r,i){var o=t-r,n=e-i;return o*o+n*n}x.fromVectorTileJs=E,x.fromGeojsonVt=function(t,e){e=e||{};var r={};for(var i in t)r[i]=new y(t[i].features,e),r[i].name=i,r[i].version=e.version,r[i].extent=e.extent;return E({layers:r})},x.GeoJSONWrapper=w;var L=function(t){return t[0]},R=function(t){return t[1]},D=function(t,e,r,i,o){void 0===e&&(e=L),void 0===r&&(r=R),void 0===i&&(i=64),void 0===o&&(o=Float64Array),this.nodeSize=i,this.points=t;for(var n=t.length<65536?Uint16Array:Uint32Array,s=this.ids=new n(t.length),a=this.coords=new o(2*t.length),l=0;l<t.length;l++)s[l]=l,a[2*l]=e(t[l]),a[2*l+1]=r(t[l]);!function t(e,r,i,o,n,s){if(!(n-o<=i)){var a=o+n>>1;!function t(e,r,i,o,n,s){for(;n>o;){if(n-o>600){var a=n-o+1,l=i-o+1,u=Math.log(a),c=.5*Math.exp(2*u/3),h=.5*Math.sqrt(u*c*(a-c)/a)*(l-a/2<0?-1:1);t(e,r,i,Math.max(o,Math.floor(i-l*c/a+h)),Math.min(n,Math.floor(i+(a-l)*c/a+h)),s)}var p=r[2*i+s],d=o,f=n;for(P(e,r,o,i),r[2*n+s]>p&&P(e,r,o,n);d<f;){for(P(e,r,d,f),d++,f--;r[2*d+s]<p;)d++;for(;r[2*f+s]>p;)f--}r[2*o+s]===p?P(e,r,o,f):P(e,r,++f,n),f<=i&&(o=f+1),i<=f&&(n=f-1)}}(e,r,a,o,n,s%2),t(e,r,i,o,a-1,s+1),t(e,r,i,a+1,n,s+1)}}(s,a,i,0,s.length-1,0)};D.prototype.range=function(t,e,r,i){return function(t,e,r,i,o,n,s){for(var a,l,u=[0,t.length-1,0],c=[];u.length;){var h=u.pop(),p=u.pop(),d=u.pop();if(p-d<=s)for(var f=d;f<=p;f++)l=e[2*f+1],(a=e[2*f])>=r&&a<=o&&l>=i&&l<=n&&c.push(t[f]);else{var g=Math.floor((d+p)/2);l=e[2*g+1],(a=e[2*g])>=r&&a<=o&&l>=i&&l<=n&&c.push(t[g]);var m=(h+1)%2;(0===h?r<=a:i<=l)&&(u.push(d),u.push(g-1),u.push(m)),(0===h?o>=a:n>=l)&&(u.push(g+1),u.push(p),u.push(m))}}return c}(this.ids,this.coords,t,e,r,i,this.nodeSize)},D.prototype.within=function(t,e,r){return function(t,e,r,i,o,n){for(var s=[0,t.length-1,0],a=[],l=o*o;s.length;){var u=s.pop(),c=s.pop(),h=s.pop();if(c-h<=n)for(var p=h;p<=c;p++)M(e[2*p],e[2*p+1],r,i)<=l&&a.push(t[p]);else{var d=Math.floor((h+c)/2),f=e[2*d],g=e[2*d+1];M(f,g,r,i)<=l&&a.push(t[d]);var m=(u+1)%2;(0===u?r-o<=f:i-o<=g)&&(s.push(h),s.push(d-1),s.push(m)),(0===u?r+o>=f:i+o>=g)&&(s.push(d+1),s.push(c),s.push(m))}}return a}(this.ids,this.coords,t,e,r,this.nodeSize)};var O={minZoom:0,maxZoom:16,minPoints:2,radius:40,extent:512,nodeSize:64,log:!1,generateId:!1,reduce:null,map:function(t){return t}},B=function(t){this.options=Z(Object.create(O),t),this.trees=new Array(this.options.maxZoom+1)};function F(t,e,r,i,o){return{x:t,y:e,zoom:1/0,id:r,parentId:-1,numPoints:i,properties:o}}function U(t,e){var r=t.geometry.coordinates,i=r[1];return{x:V(r[0]),y:G(i),zoom:1/0,index:e,parentId:-1}}function N(t){return{type:"Feature",id:t.id,properties:j(t),geometry:{type:"Point",coordinates:[(i=t.x,360*(i-.5)),(e=t.y,r=(180-360*e)*Math.PI/180,360*Math.atan(Math.exp(r))/Math.PI-90)]}};var e,r,i}function j(t){var e=t.numPoints,r=e>=1e4?Math.round(e/1e3)+"k":e>=1e3?Math.round(e/100)/10+"k":e;return Z(Z({},t.properties),{cluster:!0,cluster_id:t.id,point_count:e,point_count_abbreviated:r})}function V(t){return t/360+.5}function G(t){var e=Math.sin(t*Math.PI/180),r=.5-.25*Math.log((1+e)/(1-e))/Math.PI;return r<0?0:r>1?1:r}function Z(t,e){for(var r in e)t[r]=e[r];return t}function H(t){return t.x}function K(t){return t.y}function W(t,e,r,i,o,n){var s=o-r,a=n-i;if(0!==s||0!==a){var l=((t-r)*s+(e-i)*a)/(s*s+a*a);l>1?(r=o,i=n):l>0&&(r+=s*l,i+=a*l)}return(s=t-r)*s+(a=e-i)*a}function q(t,e,r,i){var o={id:void 0===t?null:t,type:e,geometry:r,tags:i,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0};return function(t){var e=t.geometry,r=t.type;if("Point"===r||"MultiPoint"===r||"LineString"===r)X(t,e);else if("Polygon"===r||"MultiLineString"===r)for(var i=0;i<e.length;i++)X(t,e[i]);else if("MultiPolygon"===r)for(i=0;i<e.length;i++)for(var o=0;o<e[i].length;o++)X(t,e[i][o])}(o),o}function X(t,e){for(var r=0;r<e.length;r+=3)t.minX=Math.min(t.minX,e[r]),t.minY=Math.min(t.minY,e[r+1]),t.maxX=Math.max(t.maxX,e[r]),t.maxY=Math.max(t.maxY,e[r+1])}function $(t,e,r,i){if(e.geometry){var o=e.geometry.coordinates,n=e.geometry.type,s=Math.pow(r.tolerance/((1<<r.maxZoom)*r.extent),2),a=[],l=e.id;if(r.promoteId?l=e.properties[r.promoteId]:r.generateId&&(l=i||0),"Point"===n)J(o,a);else if("MultiPoint"===n)for(var u=0;u<o.length;u++)J(o[u],a);else if("LineString"===n)Y(o,a,s,!1);else if("MultiLineString"===n){if(r.lineMetrics){for(u=0;u<o.length;u++)Y(o[u],a=[],s,!1),t.push(q(l,"LineString",a,e.properties));return}Q(o,a,s,!1)}else if("Polygon"===n)Q(o,a,s,!0);else{if("MultiPolygon"!==n){if("GeometryCollection"===n){for(u=0;u<e.geometry.geometries.length;u++)$(t,{id:l,geometry:e.geometry.geometries[u],properties:e.properties},r,i);return}throw new Error("Input data is not a valid GeoJSON object.")}for(u=0;u<o.length;u++){var c=[];Q(o[u],c,s,!0),a.push(c)}}t.push(q(l,n,a,e.properties))}}function J(t,e){e.push(tt(t[0])),e.push(et(t[1])),e.push(0)}function Y(t,e,r,i){for(var o,n,s=0,a=0;a<t.length;a++){var l=tt(t[a][0]),u=et(t[a][1]);e.push(l),e.push(u),e.push(0),a>0&&(s+=i?(o*u-l*n)/2:Math.sqrt(Math.pow(l-o,2)+Math.pow(u-n,2))),o=l,n=u}var c=e.length-3;e[2]=1,function t(e,r,i,o){for(var n,s=o,a=i-r>>1,l=i-r,u=e[r],c=e[r+1],h=e[i],p=e[i+1],d=r+3;d<i;d+=3){var f=W(e[d],e[d+1],u,c,h,p);if(f>s)n=d,s=f;else if(f===s){var g=Math.abs(d-a);g<l&&(n=d,l=g)}}s>o&&(n-r>3&&t(e,r,n,o),e[n+2]=s,i-n>3&&t(e,n,i,o))}(e,0,c,r),e[c+2]=1,e.size=Math.abs(s),e.start=0,e.end=e.size}function Q(t,e,r,i){for(var o=0;o<t.length;o++){var n=[];Y(t[o],n,r,i),e.push(n)}}function tt(t){return t/360+.5}function et(t){var e=Math.sin(t*Math.PI/180),r=.5-.25*Math.log((1+e)/(1-e))/Math.PI;return r<0?0:r>1?1:r}function it(t,e,r,i,o,n,s,a){if(i/=e,n>=(r/=e)&&s<i)return t;if(s<r||n>=i)return null;for(var l=[],u=0;u<t.length;u++){var c=t[u],h=c.geometry,p=c.type,d=0===o?c.minX:c.minY,f=0===o?c.maxX:c.maxY;if(d>=r&&f<i)l.push(c);else if(!(f<r||d>=i)){var g=[];if("Point"===p||"MultiPoint"===p)ot(h,g,r,i,o);else if("LineString"===p)nt(h,g,r,i,o,!1,a.lineMetrics);else if("MultiLineString"===p)st(h,g,r,i,o,!1);else if("Polygon"===p)st(h,g,r,i,o,!0);else if("MultiPolygon"===p)for(var m=0;m<h.length;m++){var y=[];st(h[m],y,r,i,o,!0),y.length&&g.push(y)}if(g.length){if(a.lineMetrics&&"LineString"===p){for(m=0;m<g.length;m++)l.push(q(c.id,p,g[m],c.tags));continue}"LineString"!==p&&"MultiLineString"!==p||(1===g.length?(p="LineString",g=g[0]):p="MultiLineString"),"Point"!==p&&"MultiPoint"!==p||(p=3===g.length?"Point":"MultiPoint"),l.push(q(c.id,p,g,c.tags))}}}return l.length?l:null}function ot(t,e,r,i,o){for(var n=0;n<t.length;n+=3){var s=t[n+o];s>=r&&s<=i&&(e.push(t[n]),e.push(t[n+1]),e.push(t[n+2]))}}function nt(t,e,r,i,o,n,s){for(var a,l,u=at(t),c=0===o?ut:ct,h=t.start,p=0;p<t.length-3;p+=3){var d=t[p],f=t[p+1],g=t[p+2],m=t[p+3],y=t[p+4],v=0===o?d:f,_=0===o?m:y,x=!1;s&&(a=Math.sqrt(Math.pow(d-m,2)+Math.pow(f-y,2))),v<r?_>r&&(l=c(u,d,f,m,y,r),s&&(u.start=h+a*l)):v>i?_<i&&(l=c(u,d,f,m,y,i),s&&(u.start=h+a*l)):lt(u,d,f,g),_<r&&v>=r&&(l=c(u,d,f,m,y,r),x=!0),_>i&&v<=i&&(l=c(u,d,f,m,y,i),x=!0),!n&&x&&(s&&(u.end=h+a*l),e.push(u),u=at(t)),s&&(h+=a)}var w=t.length-3;d=t[w],f=t[w+1],g=t[w+2],(v=0===o?d:f)>=r&&v<=i&&lt(u,d,f,g),w=u.length-3,n&&w>=3&&(u[w]!==u[0]||u[w+1]!==u[1])&&lt(u,u[0],u[1],u[2]),u.length&&e.push(u)}function at(t){var e=[];return e.size=t.size,e.start=t.start,e.end=t.end,e}function st(t,e,r,i,o,n){for(var s=0;s<t.length;s++)nt(t[s],e,r,i,o,n,!1)}function lt(t,e,r,i){t.push(e),t.push(r),t.push(i)}function ut(t,e,r,i,o,n){var s=(n-e)/(i-e);return t.push(n),t.push(r+(o-r)*s),t.push(1),s}function ct(t,e,r,i,o,n){var s=(n-r)/(o-r);return t.push(e+(i-e)*s),t.push(n),t.push(1),s}function pt(t,e){for(var r=[],i=0;i<t.length;i++){var o,n=t[i],s=n.type;if("Point"===s||"MultiPoint"===s||"LineString"===s)o=ht(n.geometry,e);else if("MultiLineString"===s||"Polygon"===s){o=[];for(var a=0;a<n.geometry.length;a++)o.push(ht(n.geometry[a],e))}else if("MultiPolygon"===s)for(o=[],a=0;a<n.geometry.length;a++){for(var l=[],u=0;u<n.geometry[a].length;u++)l.push(ht(n.geometry[a][u],e));o.push(l)}r.push(q(n.id,s,o,n.tags))}return r}function ht(t,e){var r=[];r.size=t.size,void 0!==t.start&&(r.start=t.start,r.end=t.end);for(var i=0;i<t.length;i+=3)r.push(t[i]+e,t[i+1],t[i+2]);return r}function ft(t,e){if(t.transformed)return t;var r,i,o,n=1<<t.z,s=t.x,a=t.y;for(r=0;r<t.features.length;r++){var l=t.features[r],u=l.geometry,c=l.type;if(l.geometry=[],1===c)for(i=0;i<u.length;i+=2)l.geometry.push(mt(u[i],u[i+1],e,n,s,a));else for(i=0;i<u.length;i++){var h=[];for(o=0;o<u[i].length;o+=2)h.push(mt(u[i][o],u[i][o+1],e,n,s,a));l.geometry.push(h)}}return t.transformed=!0,t}function mt(t,e,r,i,o,n){return[Math.round(r*(t*i-o)),Math.round(r*(e*i-n))]}function gt(t,e,r,i,o){for(var n=e===o.maxZoom?0:o.tolerance/((1<<e)*o.extent),s={features:[],numPoints:0,numSimplified:0,numFeatures:0,source:null,x:r,y:i,z:e,transformed:!1,minX:2,minY:1,maxX:-1,maxY:0},a=0;a<t.length;a++){s.numFeatures++,yt(s,t[a],n,o);var l=t[a].minX,u=t[a].minY,c=t[a].maxX,h=t[a].maxY;l<s.minX&&(s.minX=l),u<s.minY&&(s.minY=u),c>s.maxX&&(s.maxX=c),h>s.maxY&&(s.maxY=h)}return s}function yt(t,e,r,i){var o=e.geometry,n=e.type,s=[];if("Point"===n||"MultiPoint"===n)for(var a=0;a<o.length;a+=3)s.push(o[a]),s.push(o[a+1]),t.numPoints++,t.numSimplified++;else if("LineString"===n)vt(s,o,t,r,!1,!1);else if("MultiLineString"===n||"Polygon"===n)for(a=0;a<o.length;a++)vt(s,o[a],t,r,"Polygon"===n,0===a);else if("MultiPolygon"===n)for(var l=0;l<o.length;l++){var u=o[l];for(a=0;a<u.length;a++)vt(s,u[a],t,r,!0,0===a)}if(s.length){var c=e.tags||null;if("LineString"===n&&i.lineMetrics){for(var h in c={},e.tags)c[h]=e.tags[h];c.mapbox_clip_start=o.start/o.size,c.mapbox_clip_end=o.end/o.size}var p={geometry:s,type:"Polygon"===n||"MultiPolygon"===n?3:"LineString"===n||"MultiLineString"===n?2:1,tags:c};null!==e.id&&(p.id=e.id),t.features.push(p)}}function vt(t,e,r,i,o,n){var s=i*i;if(i>0&&e.size<(o?s:i))r.numPoints+=e.length/3;else{for(var a=[],l=0;l<e.length;l+=3)(0===i||e[l+2]>s)&&(r.numSimplified++,a.push(e[l]),a.push(e[l+1])),r.numPoints++;o&&function(t,e){for(var r=0,i=0,o=t.length,n=o-2;i<o;n=i,i+=2)r+=(t[i]-t[n])*(t[i+1]+t[n+1]);if(r>0===e)for(i=0,o=t.length;i<o/2;i+=2){var s=t[i],a=t[i+1];t[i]=t[o-2-i],t[i+1]=t[o-1-i],t[o-2-i]=s,t[o-1-i]=a}}(a,n),t.push(a)}}function _t(t,e){var r=(e=this.options=function(t,e){for(var r in e)t[r]=e[r];return t}(Object.create(this.options),e)).debug;if(r&&console.time("preprocess data"),e.maxZoom<0||e.maxZoom>24)throw new Error("maxZoom should be in the 0-24 range");if(e.promoteId&&e.generateId)throw new Error("promoteId and generateId cannot be used together.");var i=function(t,e){var r=[];if("FeatureCollection"===t.type)for(var i=0;i<t.features.length;i++)$(r,t.features[i],e,i);else $(r,"Feature"===t.type?t:{geometry:t},e);return r}(t,e);this.tiles={},this.tileCoords=[],r&&(console.timeEnd("preprocess data"),console.log("index: maxZoom: %d, maxPoints: %d",e.indexMaxZoom,e.indexMaxPoints),console.time("generate tiles"),this.stats={},this.total=0),(i=function(t,e){var r=e.buffer/e.extent,i=t,o=it(t,1,-1-r,r,0,-1,2,e),n=it(t,1,1-r,2+r,0,-1,2,e);return(o||n)&&(i=it(t,1,-r,1+r,0,-1,2,e)||[],o&&(i=pt(o,1).concat(i)),n&&(i=i.concat(pt(n,-1)))),i}(i,e)).length&&this.splitTile(i,0,0,0),r&&(i.length&&console.log("features: %d, points: %d",this.tiles[0].numFeatures,this.tiles[0].numPoints),console.timeEnd("generate tiles"),console.log("tiles generated:",this.total,JSON.stringify(this.stats)))}function xt(t,e,r){return 32*((1<<t)*r+e)+t}function bt(t,e){var r=t.tileID.canonical;if(!this._geoJSONIndex)return e(null,null);var i=this._geoJSONIndex.getTile(r.z,r.x,r.y);if(!i)return e(null,null);var o=new g(i.features),n=x(o);0===n.byteOffset&&n.byteLength===n.buffer.byteLength||(n=new Uint8Array(n)),e(null,{vectorTile:o,rawData:n.buffer})}B.prototype.load=function(t){var e=this.options,r=e.log,i=e.minZoom,o=e.maxZoom,n=e.nodeSize;r&&console.time("total time");var s="prepare "+t.length+" points";r&&console.time(s),this.points=t;for(var a=[],l=0;l<t.length;l++)t[l].geometry&&a.push(U(t[l],l));this.trees[o+1]=new D(a,H,K,n,Float32Array),r&&console.timeEnd(s);for(var u=o;u>=i;u--){var c=+Date.now();a=this._cluster(a,u),this.trees[u]=new D(a,H,K,n,Float32Array),r&&console.log("z%d: %d clusters in %dms",u,a.length,+Date.now()-c)}return r&&console.timeEnd("total time"),this},B.prototype.getClusters=function(t,e){var r=((t[0]+180)%360+360)%360-180,i=Math.max(-90,Math.min(90,t[1])),o=180===t[2]?180:((t[2]+180)%360+360)%360-180,n=Math.max(-90,Math.min(90,t[3]));if(t[2]-t[0]>=360)r=-180,o=180;else if(r>o){var s=this.getClusters([r,i,180,n],e),a=this.getClusters([-180,i,o,n],e);return s.concat(a)}for(var l=this.trees[this._limitZoom(e)],u=[],c=0,h=l.range(V(r),G(n),V(o),G(i));c<h.length;c+=1){var p=l.points[h[c]];u.push(p.numPoints?N(p):this.points[p.index])}return u},B.prototype.getChildren=function(t){var e=this._getOriginId(t),r=this._getOriginZoom(t),i="No cluster with the specified id.",o=this.trees[r];if(!o)throw new Error(i);var n=o.points[e];if(!n)throw new Error(i);for(var s=this.options.radius/(this.options.extent*Math.pow(2,r-1)),a=[],l=0,u=o.within(n.x,n.y,s);l<u.length;l+=1){var c=o.points[u[l]];c.parentId===t&&a.push(c.numPoints?N(c):this.points[c.index])}if(0===a.length)throw new Error(i);return a},B.prototype.getLeaves=function(t,e,r){var i=[];return this._appendLeaves(i,t,e=e||10,r=r||0,0),i},B.prototype.getTile=function(t,e,r){var i=this.trees[this._limitZoom(t)],o=Math.pow(2,t),n=this.options,s=n.radius/n.extent,a=(r-s)/o,l=(r+1+s)/o,u={features:[]};return this._addTileFeatures(i.range((e-s)/o,a,(e+1+s)/o,l),i.points,e,r,o,u),0===e&&this._addTileFeatures(i.range(1-s/o,a,1,l),i.points,o,r,o,u),e===o-1&&this._addTileFeatures(i.range(0,a,s/o,l),i.points,-1,r,o,u),u.features.length?u:null},B.prototype.getClusterExpansionZoom=function(t){for(var e=this._getOriginZoom(t)-1;e<=this.options.maxZoom;){var r=this.getChildren(t);if(e++,1!==r.length)break;t=r[0].properties.cluster_id}return e},B.prototype._appendLeaves=function(t,e,r,i,o){for(var n=0,s=this.getChildren(e);n<s.length;n+=1){var a=s[n],l=a.properties;if(l&&l.cluster?o+l.point_count<=i?o+=l.point_count:o=this._appendLeaves(t,l.cluster_id,r,i,o):o<i?o++:t.push(a),t.length===r)break}return o},B.prototype._addTileFeatures=function(t,e,r,i,o,n){for(var s=0,a=t;s<a.length;s+=1){var l=e[a[s]],u=l.numPoints,c={type:1,geometry:[[Math.round(this.options.extent*(l.x*o-r)),Math.round(this.options.extent*(l.y*o-i))]],tags:u?j(l):this.points[l.index].properties},h=void 0;u?h=l.id:this.options.generateId?h=l.index:this.points[l.index].id&&(h=this.points[l.index].id),void 0!==h&&(c.id=h),n.features.push(c)}},B.prototype._limitZoom=function(t){return Math.max(this.options.minZoom,Math.min(+t,this.options.maxZoom+1))},B.prototype._cluster=function(t,e){for(var r=[],i=this.options,o=i.reduce,n=i.minPoints,s=i.radius/(i.extent*Math.pow(2,e)),a=0;a<t.length;a++){var l=t[a];if(!(l.zoom<=e)){l.zoom=e;for(var u=this.trees[e+1],c=u.within(l.x,l.y,s),h=l.numPoints||1,p=h,d=0,f=c;d<f.length;d+=1){var g=u.points[f[d]];g.zoom>e&&(p+=g.numPoints||1)}if(p>=n){for(var m=l.x*h,y=l.y*h,v=o&&h>1?this._map(l,!0):null,_=(a<<5)+(e+1)+this.points.length,x=0,w=c;x<w.length;x+=1){var E=u.points[w[x]];if(!(E.zoom<=e)){E.zoom=e;var k=E.numPoints||1;m+=E.x*k,y+=E.y*k,E.parentId=_,o&&(v||(v=this._map(l,!0)),o(v,this._map(E)))}}l.parentId=_,r.push(F(m/p,y/p,_,p,v))}else if(r.push(l),p>1)for(var b=0,S=c;b<S.length;b+=1){var T=u.points[S[b]];T.zoom<=e||(T.zoom=e,r.push(T))}}}return r},B.prototype._getOriginId=function(t){return t-this.points.length>>5},B.prototype._getOriginZoom=function(t){return(t-this.points.length)%32},B.prototype._map=function(t,e){if(t.numPoints)return e?Z({},t.properties):t.properties;var r=this.points[t.index].properties,i=this.options.map(r);return e&&i===r?Z({},i):i},_t.prototype.options={maxZoom:14,indexMaxZoom:5,indexMaxPoints:1e5,tolerance:3,extent:4096,buffer:64,lineMetrics:!1,promoteId:null,generateId:!1,debug:0},_t.prototype.splitTile=function(t,e,r,i,o,n,s){for(var a=[t,e,r,i],l=this.options,u=l.debug;a.length;){i=a.pop(),r=a.pop(),e=a.pop(),t=a.pop();var c=1<<e,h=xt(e,r,i),p=this.tiles[h];if(!p&&(u>1&&console.time("creation"),p=this.tiles[h]=gt(t,e,r,i,l),this.tileCoords.push({z:e,x:r,y:i}),u)){u>1&&(console.log("tile z%d-%d-%d (features: %d, points: %d, simplified: %d)",e,r,i,p.numFeatures,p.numPoints,p.numSimplified),console.timeEnd("creation"));var d="z"+e;this.stats[d]=(this.stats[d]||0)+1,this.total++}if(p.source=t,o){if(e===l.maxZoom||e===o)continue;var f=1<<o-e;if(r!==Math.floor(n/f)||i!==Math.floor(s/f))continue}else if(e===l.indexMaxZoom||p.numPoints<=l.indexMaxPoints)continue;if(p.source=null,0!==t.length){u>1&&console.time("clipping");var g,m,y,v,_,x,w=.5*l.buffer/l.extent,E=.5-w,k=.5+w,b=1+w;g=m=y=v=null,_=it(t,c,r-w,r+k,0,p.minX,p.maxX,l),x=it(t,c,r+E,r+b,0,p.minX,p.maxX,l),t=null,_&&(g=it(_,c,i-w,i+k,1,p.minY,p.maxY,l),m=it(_,c,i+E,i+b,1,p.minY,p.maxY,l),_=null),x&&(y=it(x,c,i-w,i+k,1,p.minY,p.maxY,l),v=it(x,c,i+E,i+b,1,p.minY,p.maxY,l),x=null),u>1&&console.timeEnd("clipping"),a.push(g||[],e+1,2*r,2*i),a.push(m||[],e+1,2*r,2*i+1),a.push(y||[],e+1,2*r+1,2*i),a.push(v||[],e+1,2*r+1,2*i+1)}}},_t.prototype.getTile=function(t,e,r){var i=this.options,o=i.extent,n=i.debug;if(t<0||t>24)return null;var s=1<<t,a=xt(t,e=(e%s+s)%s,r);if(this.tiles[a])return ft(this.tiles[a],o);n>1&&console.log("drilling down to z%d-%d-%d",t,e,r);for(var l,u=t,c=e,h=r;!l&&u>0;)u--,c=Math.floor(c/2),h=Math.floor(h/2),l=this.tiles[xt(u,c,h)];return l&&l.source?(n>1&&console.log("found parent tile z%d-%d-%d",u,c,h),n>1&&console.time("drilling down"),this.splitTile(l.source,u,c,h,t,e,r),n>1&&console.timeEnd("drilling down"),this.tiles[a]?ft(this.tiles[a],o):null):null};var wt=function(e){function r(t,r,i,o){e.call(this,t,r,i,bt),o&&(this.loadGeoJSON=o)}return e&&(r.__proto__=e),(r.prototype=Object.create(e&&e.prototype)).constructor=r,r.prototype.loadData=function(t,e){this._pendingCallback&&this._pendingCallback(null,{abandoned:!0}),this._pendingCallback=e,this._pendingLoadDataParams=t,this._state&&"Idle"!==this._state?this._state="NeedsLoadData":(this._state="Coalescing",this._loadData())},r.prototype._loadData=function(){var e=this;if(this._pendingCallback&&this._pendingLoadDataParams){var r=this._pendingCallback,i=this._pendingLoadDataParams;delete this._pendingCallback,delete this._pendingLoadDataParams;var o=!!(i&&i.request&&i.request.collectResourceTiming)&&new t.RequestPerformance(i.request);this.loadGeoJSON(i,(function(n,s){if(n||!s)return r(n);if("object"!=typeof s)return r(new Error("Input data given to '"+i.source+"' is not a valid GeoJSON object."));!function t(e,r){var i,o=e&&e.type;if("FeatureCollection"===o)for(i=0;i<e.features.length;i++)t(e.features[i],r);else if("GeometryCollection"===o)for(i=0;i<e.geometries.length;i++)t(e.geometries[i],r);else if("Feature"===o)t(e.geometry,r);else if("Polygon"===o)h(e.coordinates,r);else if("MultiPolygon"===o)for(i=0;i<e.coordinates.length;i++)h(e.coordinates[i],r);return e}(s,!0);try{e._geoJSONIndex=i.cluster?new B(function(e){var r=e.superclusterOptions,i=e.clusterProperties;if(!i||!r)return r;for(var o={},n={},s={accumulated:null,zoom:0},a={properties:null},l=Object.keys(i),u=0,c=l;u<c.length;u+=1){var h=c[u],p=i[h],d=p[0],f=t.createExpression(p[1]),g=t.createExpression("string"==typeof d?[d,["accumulated"],["get",h]]:d);o[h]=f.value,n[h]=g.value}return r.map=function(t){a.properties=t;for(var e={},r=0,i=l;r<i.length;r+=1){var n=i[r];e[n]=o[n].evaluate(s,a)}return e},r.reduce=function(t,e){a.properties=e;for(var r=0,i=l;r<i.length;r+=1){var o=i[r];s.accumulated=t[o],t[o]=n[o].evaluate(s,a)}},r}(i)).load(s.features):function(t,e){return new _t(t,e)}(s,i.geojsonVtOptions)}catch(n){return r(n)}e.loaded={};var a={};if(o){var l=o.finish();l&&(a.resourceTiming={},a.resourceTiming[i.source]=JSON.parse(JSON.stringify(l)))}r(null,a)}))}},r.prototype.coalesce=function(){"Coalescing"===this._state?this._state="Idle":"NeedsLoadData"===this._state&&(this._state="Coalescing",this._loadData())},r.prototype.reloadTile=function(t,r){var i=this.loaded;return i&&i[t.uid]?e.prototype.reloadTile.call(this,t,r):this.loadTile(t,r)},r.prototype.loadGeoJSON=function(e,r){if(e.request)t.getJSON(e.request,r);else{if("string"!=typeof e.data)return r(new Error("Input data given to '"+e.source+"' is not a valid GeoJSON object."));try{return r(null,JSON.parse(e.data))}catch(t){return r(new Error("Input data given to '"+e.source+"' is not a valid GeoJSON object."))}}},r.prototype.removeSource=function(t,e){this._pendingCallback&&this._pendingCallback(null,{abandoned:!0}),e()},r.prototype.getClusterExpansionZoom=function(t,e){try{e(null,this._geoJSONIndex.getClusterExpansionZoom(t.clusterId))}catch(t){e(t)}},r.prototype.getClusterChildren=function(t,e){try{e(null,this._geoJSONIndex.getChildren(t.clusterId))}catch(t){e(t)}},r.prototype.getClusterLeaves=function(t,e){try{e(null,this._geoJSONIndex.getLeaves(t.clusterId,t.limit,t.offset))}catch(t){e(t)}},r}(l),Et=function(e){var r=this;this.self=e,this.actor=new t.Actor(e,this),this.layerIndexes={},this.availableImages={},this.workerSourceTypes={vector:l,geojson:wt},this.workerSources={},this.demWorkerSources={},this.self.registerWorkerSource=function(t,e){if(r.workerSourceTypes[t])throw new Error('Worker source with name "'+t+'" already registered.');r.workerSourceTypes[t]=e},this.self.registerRTLTextPlugin=function(e){if(t.plugin.isParsed())throw new Error("RTL text plugin already registered.");t.plugin.applyArabicShaping=e.applyArabicShaping,t.plugin.processBidirectionalText=e.processBidirectionalText,t.plugin.processStyledBidirectionalText=e.processStyledBidirectionalText}};return Et.prototype.setReferrer=function(t,e){this.referrer=e},Et.prototype.setImages=function(t,e,r){for(var i in this.availableImages[t]=e,this.workerSources[t]){var o=this.workerSources[t][i];for(var n in o)o[n].availableImages=e}r()},Et.prototype.setLayers=function(t,e,r){this.getLayerIndex(t).replace(e),r()},Et.prototype.updateLayers=function(t,e,r){this.getLayerIndex(t).update(e.layers,e.removedIds),r()},Et.prototype.loadTile=function(t,e,r){this.getWorkerSource(t,e.type,e.source).loadTile(e,r)},Et.prototype.loadDEMTile=function(t,e,r){this.getDEMWorkerSource(t,e.source).loadTile(e,r)},Et.prototype.reloadTile=function(t,e,r){this.getWorkerSource(t,e.type,e.source).reloadTile(e,r)},Et.prototype.abortTile=function(t,e,r){this.getWorkerSource(t,e.type,e.source).abortTile(e,r)},Et.prototype.removeTile=function(t,e,r){this.getWorkerSource(t,e.type,e.source).removeTile(e,r)},Et.prototype.removeDEMTile=function(t,e){this.getDEMWorkerSource(t,e.source).removeTile(e)},Et.prototype.removeSource=function(t,e,r){if(this.workerSources[t]&&this.workerSources[t][e.type]&&this.workerSources[t][e.type][e.source]){var i=this.workerSources[t][e.type][e.source];delete this.workerSources[t][e.type][e.source],void 0!==i.removeSource?i.removeSource(e,r):r()}},Et.prototype.loadWorkerSource=function(t,e,r){try{this.self.importScripts(e.url),r()}catch(t){r(t.toString())}},Et.prototype.syncRTLPluginState=function(e,r,i){try{t.plugin.setState(r);var o=t.plugin.getPluginURL();if(t.plugin.isLoaded()&&!t.plugin.isParsed()&&null!=o){this.self.importScripts(o);var n=t.plugin.isParsed();i(n?void 0:new Error("RTL Text Plugin failed to import scripts from "+o),n)}}catch(t){i(t.toString())}},Et.prototype.getAvailableImages=function(t){var e=this.availableImages[t];return e||(e=[]),e},Et.prototype.getLayerIndex=function(t){var e=this.layerIndexes[t];return e||(e=this.layerIndexes[t]=new i),e},Et.prototype.getWorkerSource=function(t,e,r){var i=this;return this.workerSources[t]||(this.workerSources[t]={}),this.workerSources[t][e]||(this.workerSources[t][e]={}),this.workerSources[t][e][r]||(this.workerSources[t][e][r]=new this.workerSourceTypes[e]({send:function(e,r,o){i.actor.send(e,r,o,t)}},this.getLayerIndex(t),this.getAvailableImages(t))),this.workerSources[t][e][r]},Et.prototype.getDEMWorkerSource=function(t,e){return this.demWorkerSources[t]||(this.demWorkerSources[t]={}),this.demWorkerSources[t][e]||(this.demWorkerSources[t][e]=new c),this.demWorkerSources[t][e]},Et.prototype.enforceCacheSizeLimit=function(e,r){t.enforceCacheSizeLimit(r)},"undefined"!=typeof WorkerGlobalScope&&"undefined"!=typeof self&&self instanceof WorkerGlobalScope&&(self.worker=new Et(self)),Et})),o(0,(function(t){var e=t.createCommonjsModule((function(t){function e(t){return!i(t)}function i(t){return"undefined"==typeof window||"undefined"==typeof document?"not a browser":Array.prototype&&Array.prototype.every&&Array.prototype.filter&&Array.prototype.forEach&&Array.prototype.indexOf&&Array.prototype.lastIndexOf&&Array.prototype.map&&Array.prototype.some&&Array.prototype.reduce&&Array.prototype.reduceRight&&Array.isArray?Function.prototype&&Function.prototype.bind?Object.keys&&Object.create&&Object.getPrototypeOf&&Object.getOwnPropertyNames&&Object.isSealed&&Object.isFrozen&&Object.isExtensible&&Object.getOwnPropertyDescriptor&&Object.defineProperty&&Object.defineProperties&&Object.seal&&Object.freeze&&Object.preventExtensions?"JSON"in window&&"parse"in JSON&&"stringify"in JSON?function(){if(!("Worker"in window&&"Blob"in window&&"URL"in window))return!1;var t,e,i=new Blob([""],{type:"text/javascript"}),r=URL.createObjectURL(i);try{e=new Worker(r),t=!0}catch(e){t=!1}return e&&e.terminate(),URL.revokeObjectURL(r),t}()?"Uint8ClampedArray"in window?ArrayBuffer.isView?function(){var t=document.createElement("canvas");t.width=t.height=1;var e=t.getContext("2d");if(!e)return!1;var i=e.getImageData(0,0,1,1);return i&&i.width===t.width}()?(void 0===r[i=t&&t.failIfMajorPerformanceCaveat]&&(r[i]=function(t){var i=function(t){var i=document.createElement("canvas"),r=Object.create(e.webGLContextAttributes);return r.failIfMajorPerformanceCaveat=t,i.probablySupportsContext?i.probablySupportsContext("webgl",r)||i.probablySupportsContext("experimental-webgl",r):i.supportsContext?i.supportsContext("webgl",r)||i.supportsContext("experimental-webgl",r):i.getContext("webgl",r)||i.getContext("experimental-webgl",r)}(t);if(!i)return!1;var r=i.createShader(i.VERTEX_SHADER);return!(!r||i.isContextLost())&&(i.shaderSource(r,"void main() {}"),i.compileShader(r),!0===i.getShaderParameter(r,i.COMPILE_STATUS))}(i)),r[i]?void 0:"insufficient WebGL support"):"insufficient Canvas/getImageData support":"insufficient ArrayBuffer support":"insufficient Uint8ClampedArray support":"insufficient worker support":"insufficient JSON support":"insufficient Object support":"insufficient Function support":"insufficent Array support";var i}t.exports?t.exports=e:window&&(window.mapboxgl=window.mapboxgl||{},window.mapboxgl.supported=e,window.mapboxgl.notSupportedReason=i);var r={};e.webGLContextAttributes={antialias:!1,alpha:!0,stencil:!0,depth:!0}})),i={create:function(e,i,r){var o=t.window.document.createElement(e);return void 0!==i&&(o.className=i),r&&r.appendChild(o),o},createNS:function(e,i){return t.window.document.createElementNS(e,i)}},r=t.window.document&&t.window.document.documentElement.style;function o(t){if(!r)return t[0];for(var e=0;e<t.length;e++)if(t[e]in r)return t[e];return t[0]}var a,n=o(["userSelect","MozUserSelect","WebkitUserSelect","msUserSelect"]);i.disableDrag=function(){r&&n&&(a=r[n],r[n]="none")},i.enableDrag=function(){r&&n&&(r[n]=a)};var s=o(["transform","WebkitTransform"]);i.setTransform=function(t,e){t.style[s]=e};var l=!1;try{var c=Object.defineProperty({},"passive",{get:function(){l=!0}});t.window.addEventListener("test",c,c),t.window.removeEventListener("test",c,c)}catch(t){l=!1}i.addEventListener=function(t,e,i,r){void 0===r&&(r={}),t.addEventListener(e,i,"passive"in r&&l?r:r.capture)},i.removeEventListener=function(t,e,i,r){void 0===r&&(r={}),t.removeEventListener(e,i,"passive"in r&&l?r:r.capture)};var u=function(e){e.preventDefault(),e.stopPropagation(),t.window.removeEventListener("click",u,!0)};function h(t){var e=t.userImage;return!!(e&&e.render&&e.render())&&(t.data.replace(new Uint8Array(e.data.buffer)),!0)}i.suppressClick=function(){t.window.addEventListener("click",u,!0),t.window.setTimeout((function(){t.window.removeEventListener("click",u,!0)}),0)},i.mousePos=function(e,i){var r=e.getBoundingClientRect();return new t.Point(i.clientX-r.left-e.clientLeft,i.clientY-r.top-e.clientTop)},i.touchPos=function(e,i){for(var r=e.getBoundingClientRect(),o=[],a=0;a<i.length;a++)o.push(new t.Point(i[a].clientX-r.left-e.clientLeft,i[a].clientY-r.top-e.clientTop));return o},i.mouseButton=function(e){return void 0!==t.window.InstallTrigger&&2===e.button&&e.ctrlKey&&t.window.navigator.platform.toUpperCase().indexOf("MAC")>=0?0:e.button},i.remove=function(t){t.parentNode&&t.parentNode.removeChild(t)};var p=function(e){function i(){e.call(this),this.images={},this.updatedImages={},this.callbackDispatchedThisFrame={},this.loaded=!1,this.requestors=[],this.patterns={},this.atlasImage=new t.RGBAImage({width:1,height:1}),this.dirty=!0}return e&&(i.__proto__=e),(i.prototype=Object.create(e&&e.prototype)).constructor=i,i.prototype.isLoaded=function(){return this.loaded},i.prototype.setLoaded=function(t){if(this.loaded!==t&&(this.loaded=t,t)){for(var e=0,i=this.requestors;e<i.length;e+=1){var r=i[e];this._notify(r.ids,r.callback)}this.requestors=[]}},i.prototype.getImage=function(t){return this.images[t]},i.prototype.addImage=function(t,e){this._validate(t,e)&&(this.images[t]=e)},i.prototype._validate=function(e,i){var r=!0;return this._validateStretch(i.stretchX,i.data&&i.data.width)||(this.fire(new t.ErrorEvent(new Error('Image "'+e+'" has invalid "stretchX" value'))),r=!1),this._validateStretch(i.stretchY,i.data&&i.data.height)||(this.fire(new t.ErrorEvent(new Error('Image "'+e+'" has invalid "stretchY" value'))),r=!1),this._validateContent(i.content,i)||(this.fire(new t.ErrorEvent(new Error('Image "'+e+'" has invalid "content" value'))),r=!1),r},i.prototype._validateStretch=function(t,e){if(!t)return!0;for(var i=0,r=0,o=t;r<o.length;r+=1){var a=o[r];if(a[0]<i||a[1]<a[0]||e<a[1])return!1;i=a[1]}return!0},i.prototype._validateContent=function(t,e){return!(t&&(4!==t.length||t[0]<0||e.data.width<t[0]||t[1]<0||e.data.height<t[1]||t[2]<0||e.data.width<t[2]||t[3]<0||e.data.height<t[3]||t[2]<t[0]||t[3]<t[1]))},i.prototype.updateImage=function(t,e){e.version=this.images[t].version+1,this.images[t]=e,this.updatedImages[t]=!0},i.prototype.removeImage=function(t){var e=this.images[t];delete this.images[t],delete this.patterns[t],e.userImage&&e.userImage.onRemove&&e.userImage.onRemove()},i.prototype.listImages=function(){return Object.keys(this.images)},i.prototype.getImages=function(t,e){var i=!0;if(!this.isLoaded())for(var r=0,o=t;r<o.length;r+=1)this.images[o[r]]||(i=!1);this.isLoaded()||i?this._notify(t,e):this.requestors.push({ids:t,callback:e})},i.prototype._notify=function(e,i){for(var r={},o=0,a=e;o<a.length;o+=1){var n=a[o];this.images[n]||this.fire(new t.Event("styleimagemissing",{id:n}));var s=this.images[n];s?r[n]={data:s.data.clone(),pixelRatio:s.pixelRatio,sdf:s.sdf,version:s.version,stretchX:s.stretchX,stretchY:s.stretchY,content:s.content,hasRenderCallback:Boolean(s.userImage&&s.userImage.render)}:t.warnOnce('Image "'+n+'" could not be loaded. Please make sure you have added the image with map.addImage() or a "sprite" property in your style. You can provide missing images by listening for the "styleimagemissing" map event.')}i(null,r)},i.prototype.getPixelSize=function(){var t=this.atlasImage;return{width:t.width,height:t.height}},i.prototype.getPattern=function(e){var i=this.patterns[e],r=this.getImage(e);if(!r)return null;if(i&&i.position.version===r.version)return i.position;if(i)i.position.version=r.version;else{var o={w:r.data.width+2,h:r.data.height+2,x:0,y:0},a=new t.ImagePosition(o,r);this.patterns[e]={bin:o,position:a}}return this._updatePatternAtlas(),this.patterns[e].position},i.prototype.bind=function(e){var i=e.gl;this.atlasTexture?this.dirty&&(this.atlasTexture.update(this.atlasImage),this.dirty=!1):this.atlasTexture=new t.Texture(e,this.atlasImage,i.RGBA),this.atlasTexture.bind(i.LINEAR,i.CLAMP_TO_EDGE)},i.prototype._updatePatternAtlas=function(){var e=[];for(var i in this.patterns)e.push(this.patterns[i].bin);var r=t.potpack(e),o=r.w,a=r.h,n=this.atlasImage;for(var s in n.resize({width:o||1,height:a||1}),this.patterns){var l=this.patterns[s].bin,c=l.x+1,u=l.y+1,h=this.images[s].data,p=h.width,d=h.height;t.RGBAImage.copy(h,n,{x:0,y:0},{x:c,y:u},{width:p,height:d}),t.RGBAImage.copy(h,n,{x:0,y:d-1},{x:c,y:u-1},{width:p,height:1}),t.RGBAImage.copy(h,n,{x:0,y:0},{x:c,y:u+d},{width:p,height:1}),t.RGBAImage.copy(h,n,{x:p-1,y:0},{x:c-1,y:u},{width:1,height:d}),t.RGBAImage.copy(h,n,{x:0,y:0},{x:c+p,y:u},{width:1,height:d})}this.dirty=!0},i.prototype.beginFrame=function(){this.callbackDispatchedThisFrame={}},i.prototype.dispatchRenderCallbacks=function(t){for(var e=0,i=t;e<i.length;e+=1){var r=i[e];if(!this.callbackDispatchedThisFrame[r]){this.callbackDispatchedThisFrame[r]=!0;var o=this.images[r];h(o)&&this.updateImage(r,o)}}},i}(t.Evented),d=y,f=y,m=1e20;function y(t,e,i,r,o,a){this.fontSize=t||24,this.buffer=void 0===e?3:e,this.cutoff=r||.25,this.fontFamily=o||"sans-serif",this.fontWeight=a||"normal",this.radius=i||8;var n=this.size=this.fontSize+2*this.buffer;this.canvas=document.createElement("canvas"),this.canvas.width=this.canvas.height=n,this.ctx=this.canvas.getContext("2d"),this.ctx.font=this.fontWeight+" "+this.fontSize+"px "+this.fontFamily,this.ctx.textBaseline="middle",this.ctx.fillStyle="black",this.gridOuter=new Float64Array(n*n),this.gridInner=new Float64Array(n*n),this.f=new Float64Array(n),this.d=new Float64Array(n),this.z=new Float64Array(n+1),this.v=new Int16Array(n),this.middle=Math.round(n/2*(navigator.userAgent.indexOf("Gecko/")>=0?1.2:1))}function g(t,e,i,r,o,a,n){for(var s=0;s<e;s++){for(var l=0;l<i;l++)r[l]=t[l*e+s];for(v(r,o,a,n,i),l=0;l<i;l++)t[l*e+s]=o[l]}for(l=0;l<i;l++){for(s=0;s<e;s++)r[s]=t[l*e+s];for(v(r,o,a,n,e),s=0;s<e;s++)t[l*e+s]=Math.sqrt(o[s])}}function v(t,e,i,r,o){i[0]=0,r[0]=-m,r[1]=+m;for(var a=1,n=0;a<o;a++){for(var s=(t[a]+a*a-(t[i[n]]+i[n]*i[n]))/(2*a-2*i[n]);s<=r[n];)n--,s=(t[a]+a*a-(t[i[n]]+i[n]*i[n]))/(2*a-2*i[n]);i[++n]=a,r[n]=s,r[n+1]=+m}for(a=0,n=0;a<o;a++){for(;r[n+1]<a;)n++;e[a]=(a-i[n])*(a-i[n])+t[i[n]]}}y.prototype.draw=function(t){this.ctx.clearRect(0,0,this.size,this.size),this.ctx.fillText(t,this.buffer,this.middle);for(var e=this.ctx.getImageData(0,0,this.size,this.size),i=new Uint8ClampedArray(this.size*this.size),r=0;r<this.size*this.size;r++){var o=e.data[4*r+3]/255;this.gridOuter[r]=1===o?0:0===o?m:Math.pow(Math.max(0,.5-o),2),this.gridInner[r]=1===o?m:0===o?0:Math.pow(Math.max(0,o-.5),2)}for(g(this.gridOuter,this.size,this.size,this.f,this.d,this.v,this.z),g(this.gridInner,this.size,this.size,this.f,this.d,this.v,this.z),r=0;r<this.size*this.size;r++)i[r]=Math.max(0,Math.min(255,Math.round(255-255*((this.gridOuter[r]-this.gridInner[r])/this.radius+this.cutoff))));return i},d.default=f;var _=function(t,e){this.requestManager=t,this.localIdeographFontFamily=e,this.entries={}};_.prototype.setURL=function(t){this.url=t},_.prototype.getGlyphs=function(e,i){var r=this,o=[];for(var a in e)for(var n=0,s=e[a];n<s.length;n+=1)o.push({stack:a,id:s[n]});t.asyncAll(o,(function(t,e){var i=t.stack,o=t.id,a=r.entries[i];a||(a=r.entries[i]={glyphs:{},requests:{},ranges:{}});var n=a.glyphs[o];if(void 0===n){if(n=r._tinySDF(a,i,o))return a.glyphs[o]=n,void e(null,{stack:i,id:o,glyph:n});var s=Math.floor(o/256);if(256*s>65535)e(new Error("glyphs > 65535 not supported"));else if(a.ranges[s])e(null,{stack:i,id:o,glyph:n});else{var l=a.requests[s];l||(l=a.requests[s]=[],_.loadGlyphRange(i,s,r.url,r.requestManager,(function(t,e){if(e){for(var i in e)r._doesCharSupportLocalGlyph(+i)||(a.glyphs[+i]=e[+i]);a.ranges[s]=!0}for(var o=0,n=l;o<n.length;o+=1)(0,n[o])(t,e);delete a.requests[s]}))),l.push((function(t,r){t?e(t):r&&e(null,{stack:i,id:o,glyph:r[o]||null})}))}}else e(null,{stack:i,id:o,glyph:n})}),(function(t,e){if(t)i(t);else if(e){for(var r={},o=0,a=e;o<a.length;o+=1){var n=a[o],s=n.stack,l=n.id,c=n.glyph;(r[s]||(r[s]={}))[l]=c&&{id:c.id,bitmap:c.bitmap.clone(),metrics:c.metrics}}i(null,r)}}))},_.prototype._doesCharSupportLocalGlyph=function(e){return!!this.localIdeographFontFamily&&(t.isChar["CJK Unified Ideographs"](e)||t.isChar["Hangul Syllables"](e)||t.isChar.Hiragana(e)||t.isChar.Katakana(e))},_.prototype._tinySDF=function(e,i,r){var o=this.localIdeographFontFamily;if(o&&this._doesCharSupportLocalGlyph(r)){var a=e.tinySDF;if(!a){var n="400";/bold/i.test(i)?n="900":/medium/i.test(i)?n="500":/light/i.test(i)&&(n="200"),a=e.tinySDF=new _.TinySDF(24,3,8,.25,o,n)}return{id:r,bitmap:new t.AlphaImage({width:30,height:30},a.draw(String.fromCharCode(r))),metrics:{width:24,height:24,left:0,top:-8,advance:24}}}},_.loadGlyphRange=function(e,i,r,o,a){var n=256*i,s=n+255,l=o.transformRequest(o.normalizeGlyphsURL(r).replace("{fontstack}",e).replace("{range}",n+"-"+s),t.ResourceType.Glyphs);t.getArrayBuffer(l,(function(e,i){if(e)a(e);else if(i){for(var r={},o=0,n=t.parseGlyphPBF(i);o<n.length;o+=1){var s=n[o];r[s.id]=s}a(null,r)}}))},_.TinySDF=d;var x=function(){this.specification=t.styleSpec.light.position};x.prototype.possiblyEvaluate=function(e,i){return t.sphericalToCartesian(e.expression.evaluate(i))},x.prototype.interpolate=function(e,i,r){return{x:t.number(e.x,i.x,r),y:t.number(e.y,i.y,r),z:t.number(e.z,i.z,r)}};var b=new t.Properties({anchor:new t.DataConstantProperty(t.styleSpec.light.anchor),position:new x,color:new t.DataConstantProperty(t.styleSpec.light.color),intensity:new t.DataConstantProperty(t.styleSpec.light.intensity)}),w=function(e){function i(i){e.call(this),this._transitionable=new t.Transitionable(b),this.setLight(i),this._transitioning=this._transitionable.untransitioned()}return e&&(i.__proto__=e),(i.prototype=Object.create(e&&e.prototype)).constructor=i,i.prototype.getLight=function(){return this._transitionable.serialize()},i.prototype.setLight=function(e,i){if(void 0===i&&(i={}),!this._validate(t.validateLight,e,i))for(var r in e){var o=e[r];t.endsWith(r,"-transition")?this._transitionable.setTransition(r.slice(0,-"-transition".length),o):this._transitionable.setValue(r,o)}},i.prototype.updateTransitions=function(t){this._transitioning=this._transitionable.transitioned(t,this._transitioning)},i.prototype.hasTransition=function(){return this._transitioning.hasTransition()},i.prototype.recalculate=function(t){this.properties=this._transitioning.possiblyEvaluate(t)},i.prototype._validate=function(e,i,r){return(!r||!1!==r.validate)&&t.emitValidationErrors(this,e.call(t.validateStyle,t.extend({value:i,style:{glyphs:!0,sprite:!0},styleSpec:t.styleSpec})))},i}(t.Evented),E=function(t,e){this.width=t,this.height=e,this.nextRow=0,this.data=new Uint8Array(this.width*this.height),this.dashEntry={}};E.prototype.getDash=function(t,e){var i=t.join(",")+String(e);return this.dashEntry[i]||(this.dashEntry[i]=this.addDash(t,e)),this.dashEntry[i]},E.prototype.getDashRanges=function(t,e,i){var r=[],o=t.length%2==1?-t[t.length-1]*i:0,a=t[0]*i,n=!0;r.push({left:o,right:a,isDash:n,zeroLength:0===t[0]});for(var s=t[0],l=1;l<t.length;l++){var c=t[l];r.push({left:o=s*i,right:a=(s+=c)*i,isDash:n=!n,zeroLength:0===c})}return r},E.prototype.addRoundDash=function(t,e,i){for(var r=e/2,o=-i;o<=i;o++)for(var a=this.width*(this.nextRow+i+o),n=0,s=t[n],l=0;l<this.width;l++){l/s.right>1&&(s=t[++n]);var c=Math.abs(l-s.left),u=Math.abs(l-s.right),h=Math.min(c,u),p=void 0,d=o/i*(r+1);if(s.isDash){var f=r-Math.abs(d);p=Math.sqrt(h*h+f*f)}else p=r-Math.sqrt(h*h+d*d);this.data[a+l]=Math.max(0,Math.min(255,p+128))}},E.prototype.addRegularDash=function(t){for(var e=t.length-1;e>=0;--e){var i=t[e],r=t[e+1];i.zeroLength?t.splice(e,1):r&&r.isDash===i.isDash&&(r.left=i.left,t.splice(e,1))}var o=t[0],a=t[t.length-1];o.isDash===a.isDash&&(o.left=a.left-this.width,a.right=o.right+this.width);for(var n=this.width*this.nextRow,s=0,l=t[s],c=0;c<this.width;c++){c/l.right>1&&(l=t[++s]);var u=Math.abs(c-l.left),h=Math.abs(c-l.right),p=Math.min(u,h);this.data[n+c]=Math.max(0,Math.min(255,(l.isDash?p:-p)+128))}},E.prototype.addDash=function(e,i){var r=i?7:0,o=2*r+1;if(this.nextRow+o>this.height)return t.warnOnce("LineAtlas out of space"),null;for(var a=0,n=0;n<e.length;n++)a+=e[n];if(0!==a){var s=this.width/a,l=this.getDashRanges(e,this.width,s);i?this.addRoundDash(l,s,r):this.addRegularDash(l)}var c={y:(this.nextRow+r+.5)/this.height,height:2*r/this.height,width:a};return this.nextRow+=o,this.dirty=!0,c},E.prototype.bind=function(t){var e=t.gl;this.texture?(e.bindTexture(e.TEXTURE_2D,this.texture),this.dirty&&(this.dirty=!1,e.texSubImage2D(e.TEXTURE_2D,0,0,0,this.width,this.height,e.ALPHA,e.UNSIGNED_BYTE,this.data))):(this.texture=e.createTexture(),e.bindTexture(e.TEXTURE_2D,this.texture),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_S,e.REPEAT),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_T,e.REPEAT),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MIN_FILTER,e.LINEAR),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MAG_FILTER,e.LINEAR),e.texImage2D(e.TEXTURE_2D,0,e.ALPHA,this.width,this.height,0,e.ALPHA,e.UNSIGNED_BYTE,this.data))};var k=function e(i,r){this.workerPool=i,this.actors=[],this.currentActor=0,this.id=t.uniqueId();for(var o=this.workerPool.acquire(this.id),a=0;a<o.length;a++){var n=new e.Actor(o[a],r,this.id);n.name="Worker "+a,this.actors.push(n)}};function S(e,i,r){var o=function(o,a){if(o)return r(o);if(a){var n=t.pick(t.extend(a,e),["tiles","minzoom","maxzoom","attribution","mapbox_logo","bounds","scheme","tileSize","encoding"]);a.vector_layers&&(n.vectorLayers=a.vector_layers,n.vectorLayerIds=n.vectorLayers.map((function(t){return t.id}))),n.tiles=i.canonicalizeTileset(n,e.url),r(null,n)}};return e.url?t.getJSON(i.transformRequest(i.normalizeSourceURL(e.url),t.ResourceType.Source),o):t.browser.frame((function(){return o(null,e)}))}k.prototype.broadcast=function(e,i,r){t.asyncAll(this.actors,(function(t,r){t.send(e,i,r)}),r=r||function(){})},k.prototype.getActor=function(){return this.currentActor=(this.currentActor+1)%this.actors.length,this.actors[this.currentActor]},k.prototype.remove=function(){this.actors.forEach((function(t){t.remove()})),this.actors=[],this.workerPool.release(this.id)},k.Actor=t.Actor;var T=function(e,i,r){this.bounds=t.LngLatBounds.convert(this.validateBounds(e)),this.minzoom=i||0,this.maxzoom=r||24};T.prototype.validateBounds=function(t){return Array.isArray(t)&&4===t.length?[Math.max(-180,t[0]),Math.max(-90,t[1]),Math.min(180,t[2]),Math.min(90,t[3])]:[-180,-90,180,90]},T.prototype.contains=function(e){var i=Math.pow(2,e.z),r=Math.floor(t.mercatorXfromLng(this.bounds.getWest())*i),o=Math.floor(t.mercatorYfromLat(this.bounds.getNorth())*i),a=Math.ceil(t.mercatorXfromLng(this.bounds.getEast())*i),n=Math.ceil(t.mercatorYfromLat(this.bounds.getSouth())*i);return e.x>=r&&e.x<a&&e.y>=o&&e.y<n};var I=function(e){function i(i,r,o,a){if(e.call(this),this.id=i,this.dispatcher=o,this.type="vector",this.minzoom=0,this.maxzoom=22,this.scheme="xyz",this.tileSize=512,this.reparseOverscaled=!0,this.isTileClipped=!0,this._loaded=!1,t.extend(this,t.pick(r,["url","scheme","tileSize","promoteId"])),this._options=t.extend({type:"vector"},r),this._collectResourceTiming=r.collectResourceTiming,512!==this.tileSize)throw new Error("vector tile sources must have a tileSize of 512");this.setEventedParent(a)}return e&&(i.__proto__=e),(i.prototype=Object.create(e&&e.prototype)).constructor=i,i.prototype.load=function(){var e=this;this._loaded=!1,this.fire(new t.Event("dataloading",{dataType:"source"})),this._tileJSONRequest=S(this._options,this.map._requestManager,(function(i,r){e._tileJSONRequest=null,e._loaded=!0,i?e.fire(new t.ErrorEvent(i)):r&&(t.extend(e,r),r.bounds&&(e.tileBounds=new T(r.bounds,e.minzoom,e.maxzoom)),t.postTurnstileEvent(r.tiles,e.map._requestManager._customAccessToken),t.postMapLoadEvent(r.tiles,e.map._getMapId(),e.map._requestManager._skuToken,e.map._requestManager._customAccessToken),e.fire(new t.Event("data",{dataType:"source",sourceDataType:"metadata"})),e.fire(new t.Event("data",{dataType:"source",sourceDataType:"content"})))}))},i.prototype.loaded=function(){return this._loaded},i.prototype.hasTile=function(t){return!this.tileBounds||this.tileBounds.contains(t.canonical)},i.prototype.onAdd=function(t){this.map=t,this.load()},i.prototype.onRemove=function(){this._tileJSONRequest&&(this._tileJSONRequest.cancel(),this._tileJSONRequest=null)},i.prototype.serialize=function(){return t.extend({},this._options)},i.prototype.loadTile=function(e,i){var r=this.map._requestManager.normalizeTileURL(e.tileID.canonical.url(this.tiles,this.scheme)),o={request:this.map._requestManager.transformRequest(r,t.ResourceType.Tile),uid:e.uid,tileID:e.tileID,zoom:e.tileID.overscaledZ,tileSize:this.tileSize*e.tileID.overscaleFactor(),type:this.type,source:this.id,pixelRatio:t.browser.devicePixelRatio,showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId};function a(r,o){return delete e.request,e.aborted?i(null):r&&404!==r.status?i(r):(o&&o.resourceTiming&&(e.resourceTiming=o.resourceTiming),this.map._refreshExpiredTiles&&o&&e.setExpiryData(o),e.loadVectorData(o,this.map.painter),t.cacheEntryPossiblyAdded(this.dispatcher),i(null),void(e.reloadCallback&&(this.loadTile(e,e.reloadCallback),e.reloadCallback=null)))}o.request.collectResourceTiming=this._collectResourceTiming,e.actor&&"expired"!==e.state?"loading"===e.state?e.reloadCallback=i:e.request=e.actor.send("reloadTile",o,a.bind(this)):(e.actor=this.dispatcher.getActor(),e.request=e.actor.send("loadTile",o,a.bind(this)))},i.prototype.abortTile=function(t){t.request&&(t.request.cancel(),delete t.request),t.actor&&t.actor.send("abortTile",{uid:t.uid,type:this.type,source:this.id},void 0)},i.prototype.unloadTile=function(t){t.unloadVectorData(),t.actor&&t.actor.send("removeTile",{uid:t.uid,type:this.type,source:this.id},void 0)},i.prototype.hasTransition=function(){return!1},i}(t.Evented),z=function(e){function i(i,r,o,a){e.call(this),this.id=i,this.dispatcher=o,this.setEventedParent(a),this.type="raster",this.minzoom=0,this.maxzoom=22,this.roundZoom=!0,this.scheme="xyz",this.tileSize=512,this._loaded=!1,this._options=t.extend({type:"raster"},r),t.extend(this,t.pick(r,["url","scheme","tileSize"]))}return e&&(i.__proto__=e),(i.prototype=Object.create(e&&e.prototype)).constructor=i,i.prototype.load=function(){var e=this;this._loaded=!1,this.fire(new t.Event("dataloading",{dataType:"source"})),this._tileJSONRequest=S(this._options,this.map._requestManager,(function(i,r){e._tileJSONRequest=null,e._loaded=!0,i?e.fire(new t.ErrorEvent(i)):r&&(t.extend(e,r),r.bounds&&(e.tileBounds=new T(r.bounds,e.minzoom,e.maxzoom)),t.postTurnstileEvent(r.tiles),t.postMapLoadEvent(r.tiles,e.map._getMapId(),e.map._requestManager._skuToken),e.fire(new t.Event("data",{dataType:"source",sourceDataType:"metadata"})),e.fire(new t.Event("data",{dataType:"source",sourceDataType:"content"})))}))},i.prototype.loaded=function(){return this._loaded},i.prototype.onAdd=function(t){this.map=t,this.load()},i.prototype.onRemove=function(){this._tileJSONRequest&&(this._tileJSONRequest.cancel(),this._tileJSONRequest=null)},i.prototype.serialize=function(){return t.extend({},this._options)},i.prototype.hasTile=function(t){return!this.tileBounds||this.tileBounds.contains(t.canonical)},i.prototype.loadTile=function(e,i){var r=this,o=this.map._requestManager.normalizeTileURL(e.tileID.canonical.url(this.tiles,this.scheme),this.tileSize);e.request=t.getImage(this.map._requestManager.transformRequest(o,t.ResourceType.Tile),(function(o,a){if(delete e.request,e.aborted)e.state="unloaded",i(null);else if(o)e.state="errored",i(o);else if(a){r.map._refreshExpiredTiles&&e.setExpiryData(a),delete a.cacheControl,delete a.expires;var n=r.map.painter.context,s=n.gl;e.texture=r.map.painter.getTileTexture(a.width),e.texture?e.texture.update(a,{useMipmap:!0}):(e.texture=new t.Texture(n,a,s.RGBA,{useMipmap:!0}),e.texture.bind(s.LINEAR,s.CLAMP_TO_EDGE,s.LINEAR_MIPMAP_NEAREST),n.extTextureFilterAnisotropic&&s.texParameterf(s.TEXTURE_2D,n.extTextureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT,n.extTextureFilterAnisotropicMax)),e.state="loaded",t.cacheEntryPossiblyAdded(r.dispatcher),i(null)}}))},i.prototype.abortTile=function(t,e){t.request&&(t.request.cancel(),delete t.request),e()},i.prototype.unloadTile=function(t,e){t.texture&&this.map.painter.saveTileTexture(t.texture),e()},i.prototype.hasTransition=function(){return!1},i}(t.Evented),C=function(e){function i(i,r,o,a){e.call(this,i,r,o,a),this.type="raster-dem",this.maxzoom=22,this._options=t.extend({type:"raster-dem"},r),this.encoding=r.encoding||"mapbox"}return e&&(i.__proto__=e),(i.prototype=Object.create(e&&e.prototype)).constructor=i,i.prototype.serialize=function(){return{type:"raster-dem",url:this.url,tileSize:this.tileSize,tiles:this.tiles,bounds:this.bounds,encoding:this.encoding}},i.prototype.loadTile=function(e,i){var r=this.map._requestManager.normalizeTileURL(e.tileID.canonical.url(this.tiles,this.scheme),this.tileSize);function o(t,r){t&&(e.state="errored",i(t)),r&&(e.dem=r,e.needsHillshadePrepare=!0,e.state="loaded",i(null))}e.request=t.getImage(this.map._requestManager.transformRequest(r,t.ResourceType.Tile),function(r,a){if(delete e.request,e.aborted)e.state="unloaded",i(null);else if(r)e.state="errored",i(r);else if(a){this.map._refreshExpiredTiles&&e.setExpiryData(a),delete a.cacheControl,delete a.expires;var n=t.window.ImageBitmap&&a instanceof t.window.ImageBitmap&&t.offscreenCanvasSupported()?a:t.browser.getImageData(a,1),s={uid:e.uid,coord:e.tileID,source:this.id,rawImageData:n,encoding:this.encoding};e.actor&&"expired"!==e.state||(e.actor=this.dispatcher.getActor(),e.actor.send("loadDEMTile",s,o.bind(this)))}}.bind(this)),e.neighboringTiles=this._getNeighboringTiles(e.tileID)},i.prototype._getNeighboringTiles=function(e){var i=e.canonical,r=Math.pow(2,i.z),o=(i.x-1+r)%r,a=0===i.x?e.wrap-1:e.wrap,n=(i.x+1+r)%r,s=i.x+1===r?e.wrap+1:e.wrap,l={};return l[new t.OverscaledTileID(e.overscaledZ,a,i.z,o,i.y).key]={backfilled:!1},l[new t.OverscaledTileID(e.overscaledZ,s,i.z,n,i.y).key]={backfilled:!1},i.y>0&&(l[new t.OverscaledTileID(e.overscaledZ,a,i.z,o,i.y-1).key]={backfilled:!1},l[new t.OverscaledTileID(e.overscaledZ,e.wrap,i.z,i.x,i.y-1).key]={backfilled:!1},l[new t.OverscaledTileID(e.overscaledZ,s,i.z,n,i.y-1).key]={backfilled:!1}),i.y+1<r&&(l[new t.OverscaledTileID(e.overscaledZ,a,i.z,o,i.y+1).key]={backfilled:!1},l[new t.OverscaledTileID(e.overscaledZ,e.wrap,i.z,i.x,i.y+1).key]={backfilled:!1},l[new t.OverscaledTileID(e.overscaledZ,s,i.z,n,i.y+1).key]={backfilled:!1}),l},i.prototype.unloadTile=function(t){t.demTexture&&this.map.painter.saveTileTexture(t.demTexture),t.fbo&&(t.fbo.destroy(),delete t.fbo),t.dem&&delete t.dem,delete t.neighboringTiles,t.state="unloaded",t.actor&&t.actor.send("removeDEMTile",{uid:t.uid,source:this.id})},i}(z),P=function(e){function i(i,r,o,a){e.call(this),this.id=i,this.type="geojson",this.minzoom=0,this.maxzoom=18,this.tileSize=512,this.isTileClipped=!0,this.reparseOverscaled=!0,this._removed=!1,this._loaded=!1,this.actor=o.getActor(),this.setEventedParent(a),this._data=r.data,this._options=t.extend({},r),this._collectResourceTiming=r.collectResourceTiming,this._resourceTiming=[],void 0!==r.maxzoom&&(this.maxzoom=r.maxzoom),r.type&&(this.type=r.type),r.attribution&&(this.attribution=r.attribution),this.promoteId=r.promoteId;var n=t.EXTENT/this.tileSize;this.workerOptions=t.extend({source:this.id,cluster:r.cluster||!1,geojsonVtOptions:{buffer:(void 0!==r.buffer?r.buffer:128)*n,tolerance:(void 0!==r.tolerance?r.tolerance:.375)*n,extent:t.EXTENT,maxZoom:this.maxzoom,lineMetrics:r.lineMetrics||!1,generateId:r.generateId||!1},superclusterOptions:{maxZoom:void 0!==r.clusterMaxZoom?Math.min(r.clusterMaxZoom,this.maxzoom-1):this.maxzoom-1,minPoints:Math.max(2,r.clusterMinPoints||2),extent:t.EXTENT,radius:(r.clusterRadius||50)*n,log:!1,generateId:r.generateId||!1},clusterProperties:r.clusterProperties},r.workerOptions)}return e&&(i.__proto__=e),(i.prototype=Object.create(e&&e.prototype)).constructor=i,i.prototype.load=function(){var e=this;this.fire(new t.Event("dataloading",{dataType:"source"})),this._updateWorkerData((function(i){if(i)e.fire(new t.ErrorEvent(i));else{var r={dataType:"source",sourceDataType:"metadata"};e._collectResourceTiming&&e._resourceTiming&&e._resourceTiming.length>0&&(r.resourceTiming=e._resourceTiming,e._resourceTiming=[]),e.fire(new t.Event("data",r))}}))},i.prototype.onAdd=function(t){this.map=t,this.load()},i.prototype.setData=function(e){var i=this;return this._data=e,this.fire(new t.Event("dataloading",{dataType:"source"})),this._updateWorkerData((function(e){if(e)i.fire(new t.ErrorEvent(e));else{var r={dataType:"source",sourceDataType:"content"};i._collectResourceTiming&&i._resourceTiming&&i._resourceTiming.length>0&&(r.resourceTiming=i._resourceTiming,i._resourceTiming=[]),i.fire(new t.Event("data",r))}})),this},i.prototype.getClusterExpansionZoom=function(t,e){return this.actor.send("geojson.getClusterExpansionZoom",{clusterId:t,source:this.id},e),this},i.prototype.getClusterChildren=function(t,e){return this.actor.send("geojson.getClusterChildren",{clusterId:t,source:this.id},e),this},i.prototype.getClusterLeaves=function(t,e,i,r){return this.actor.send("geojson.getClusterLeaves",{source:this.id,clusterId:t,limit:e,offset:i},r),this},i.prototype._updateWorkerData=function(e){var i=this;this._loaded=!1;var r=t.extend({},this.workerOptions),o=this._data;"string"==typeof o?(r.request=this.map._requestManager.transformRequest(t.browser.resolveURL(o),t.ResourceType.Source),r.request.collectResourceTiming=this._collectResourceTiming):r.data=JSON.stringify(o),this.actor.send(this.type+".loadData",r,(function(t,o){i._removed||o&&o.abandoned||(i._loaded=!0,o&&o.resourceTiming&&o.resourceTiming[i.id]&&(i._resourceTiming=o.resourceTiming[i.id].slice(0)),i.actor.send(i.type+".coalesce",{source:r.source},null),e(t))}))},i.prototype.loaded=function(){return this._loaded},i.prototype.loadTile=function(e,i){var r=this,o=e.actor?"reloadTile":"loadTile";e.actor=this.actor,e.request=this.actor.send(o,{type:this.type,uid:e.uid,tileID:e.tileID,zoom:e.tileID.overscaledZ,maxZoom:this.maxzoom,tileSize:this.tileSize,source:this.id,pixelRatio:t.browser.devicePixelRatio,showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId},(function(t,a){return delete e.request,e.unloadVectorData(),e.aborted?i(null):t?i(t):(e.loadVectorData(a,r.map.painter,"reloadTile"===o),i(null))}))},i.prototype.abortTile=function(t){t.request&&(t.request.cancel(),delete t.request),t.aborted=!0},i.prototype.unloadTile=function(t){t.unloadVectorData(),this.actor.send("removeTile",{uid:t.uid,type:this.type,source:this.id})},i.prototype.onRemove=function(){this._removed=!0,this.actor.send("removeSource",{type:this.type,source:this.id})},i.prototype.serialize=function(){return t.extend({},this._options,{type:this.type,data:this._data})},i.prototype.hasTransition=function(){return!1},i}(t.Evented),A=t.createLayout([{name:"a_pos",type:"Int16",components:2},{name:"a_texture_pos",type:"Int16",components:2}]),M=function(e){function i(t,i,r,o){e.call(this),this.id=t,this.dispatcher=r,this.coordinates=i.coordinates,this.type="image",this.minzoom=0,this.maxzoom=22,this.tileSize=512,this.tiles={},this._loaded=!1,this.setEventedParent(o),this.options=i}return e&&(i.__proto__=e),(i.prototype=Object.create(e&&e.prototype)).constructor=i,i.prototype.load=function(e,i){var r=this;this._loaded=!1,this.fire(new t.Event("dataloading",{dataType:"source"})),this.url=this.options.url,t.getImage(this.map._requestManager.transformRequest(this.url,t.ResourceType.Image),(function(o,a){r._loaded=!0,o?r.fire(new t.ErrorEvent(o)):a&&(r.image=a,e&&(r.coordinates=e),i&&i(),r._finishLoading())}))},i.prototype.loaded=function(){return this._loaded},i.prototype.updateImage=function(t){var e=this;return this.image&&t.url?(this.options.url=t.url,this.load(t.coordinates,(function(){e.texture=null})),this):this},i.prototype._finishLoading=function(){this.map&&(this.setCoordinates(this.coordinates),this.fire(new t.Event("data",{dataType:"source",sourceDataType:"metadata"})))},i.prototype.onAdd=function(t){this.map=t,this.load()},i.prototype.setCoordinates=function(e){var i=this;this.coordinates=e;var r=e.map(t.MercatorCoordinate.fromLngLat);this.tileID=function(e){for(var i=1/0,r=1/0,o=-1/0,a=-1/0,n=0,s=e;n<s.length;n+=1){var l=s[n];i=Math.min(i,l.x),r=Math.min(r,l.y),o=Math.max(o,l.x),a=Math.max(a,l.y)}var c=Math.max(o-i,a-r),u=Math.max(0,Math.floor(-Math.log(c)/Math.LN2)),h=Math.pow(2,u);return new t.CanonicalTileID(u,Math.floor((i+o)/2*h),Math.floor((r+a)/2*h))}(r),this.minzoom=this.maxzoom=this.tileID.z;var o=r.map((function(t){return i.tileID.getTilePoint(t)._round()}));return this._boundsArray=new t.StructArrayLayout4i8,this._boundsArray.emplaceBack(o[0].x,o[0].y,0,0),this._boundsArray.emplaceBack(o[1].x,o[1].y,t.EXTENT,0),this._boundsArray.emplaceBack(o[3].x,o[3].y,0,t.EXTENT),this._boundsArray.emplaceBack(o[2].x,o[2].y,t.EXTENT,t.EXTENT),this.boundsBuffer&&(this.boundsBuffer.destroy(),delete this.boundsBuffer),this.fire(new t.Event("data",{dataType:"source",sourceDataType:"content"})),this},i.prototype.prepare=function(){if(0!==Object.keys(this.tiles).length&&this.image){var e=this.map.painter.context,i=e.gl;for(var r in this.boundsBuffer||(this.boundsBuffer=e.createVertexBuffer(this._boundsArray,A.members)),this.boundsSegments||(this.boundsSegments=t.SegmentVector.simpleSegment(0,0,4,2)),this.texture||(this.texture=new t.Texture(e,this.image,i.RGBA),this.texture.bind(i.LINEAR,i.CLAMP_TO_EDGE)),this.tiles){var o=this.tiles[r];"loaded"!==o.state&&(o.state="loaded",o.texture=this.texture)}}},i.prototype.loadTile=function(t,e){this.tileID&&this.tileID.equals(t.tileID.canonical)?(this.tiles[String(t.tileID.wrap)]=t,t.buckets={},e(null)):(t.state="errored",e(null))},i.prototype.serialize=function(){return{type:"image",url:this.options.url,coordinates:this.coordinates}},i.prototype.hasTransition=function(){return!1},i}(t.Evented),L=function(e){function i(t,i,r,o){e.call(this,t,i,r,o),this.roundZoom=!0,this.type="video",this.options=i}return e&&(i.__proto__=e),(i.prototype=Object.create(e&&e.prototype)).constructor=i,i.prototype.load=function(){var e=this;this._loaded=!1;var i=this.options;this.urls=[];for(var r=0,o=i.urls;r<o.length;r+=1)this.urls.push(this.map._requestManager.transformRequest(o[r],t.ResourceType.Source).url);t.getVideo(this.urls,(function(i,r){e._loaded=!0,i?e.fire(new t.ErrorEvent(i)):r&&(e.video=r,e.video.loop=!0,e.video.addEventListener("playing",(function(){e.map.triggerRepaint()})),e.map&&e.video.play(),e._finishLoading())}))},i.prototype.pause=function(){this.video&&this.video.pause()},i.prototype.play=function(){this.video&&this.video.play()},i.prototype.seek=function(e){if(this.video){var i=this.video.seekable;e<i.start(0)||e>i.end(0)?this.fire(new t.ErrorEvent(new t.ValidationError("sources."+this.id,null,"Playback for this video can be set only between the "+i.start(0)+" and "+i.end(0)+"-second mark."))):this.video.currentTime=e}},i.prototype.getVideo=function(){return this.video},i.prototype.onAdd=function(t){this.map||(this.map=t,this.load(),this.video&&(this.video.play(),this.setCoordinates(this.coordinates)))},i.prototype.prepare=function(){if(!(0===Object.keys(this.tiles).length||this.video.readyState<2)){var e=this.map.painter.context,i=e.gl;for(var r in this.boundsBuffer||(this.boundsBuffer=e.createVertexBuffer(this._boundsArray,A.members)),this.boundsSegments||(this.boundsSegments=t.SegmentVector.simpleSegment(0,0,4,2)),this.texture?this.video.paused||(this.texture.bind(i.LINEAR,i.CLAMP_TO_EDGE),i.texSubImage2D(i.TEXTURE_2D,0,0,0,i.RGBA,i.UNSIGNED_BYTE,this.video)):(this.texture=new t.Texture(e,this.video,i.RGBA),this.texture.bind(i.LINEAR,i.CLAMP_TO_EDGE)),this.tiles){var o=this.tiles[r];"loaded"!==o.state&&(o.state="loaded",o.texture=this.texture)}}},i.prototype.serialize=function(){return{type:"video",urls:this.urls,coordinates:this.coordinates}},i.prototype.hasTransition=function(){return this.video&&!this.video.paused},i}(M),R=function(e){function i(i,r,o,a){e.call(this,i,r,o,a),r.coordinates?Array.isArray(r.coordinates)&&4===r.coordinates.length&&!r.coordinates.some((function(t){return!Array.isArray(t)||2!==t.length||t.some((function(t){return"number"!=typeof t}))}))||this.fire(new t.ErrorEvent(new t.ValidationError("sources."+i,null,'"coordinates" property must be an array of 4 longitude/latitude array pairs'))):this.fire(new t.ErrorEvent(new t.ValidationError("sources."+i,null,'missing required property "coordinates"'))),r.animate&&"boolean"!=typeof r.animate&&this.fire(new t.ErrorEvent(new t.ValidationError("sources."+i,null,'optional "animate" property must be a boolean value'))),r.canvas?"string"==typeof r.canvas||r.canvas instanceof t.window.HTMLCanvasElement||this.fire(new t.ErrorEvent(new t.ValidationError("sources."+i,null,'"canvas" must be either a string representing the ID of the canvas element from which to read, or an HTMLCanvasElement instance'))):this.fire(new t.ErrorEvent(new t.ValidationError("sources."+i,null,'missing required property "canvas"'))),this.options=r,this.animate=void 0===r.animate||r.animate}return e&&(i.__proto__=e),(i.prototype=Object.create(e&&e.prototype)).constructor=i,i.prototype.load=function(){this._loaded=!0,this.canvas||(this.canvas=this.options.canvas instanceof t.window.HTMLCanvasElement?this.options.canvas:t.window.document.getElementById(this.options.canvas)),this.width=this.canvas.width,this.height=this.canvas.height,this._hasInvalidDimensions()?this.fire(new t.ErrorEvent(new Error("Canvas dimensions cannot be less than or equal to zero."))):(this.play=function(){this._playing=!0,this.map.triggerRepaint()},this.pause=function(){this._playing&&(this.prepare(),this._playing=!1)},this._finishLoading())},i.prototype.getCanvas=function(){return this.canvas},i.prototype.onAdd=function(t){this.map=t,this.load(),this.canvas&&this.animate&&this.play()},i.prototype.onRemove=function(){this.pause()},i.prototype.prepare=function(){var e=!1;if(this.canvas.width!==this.width&&(this.width=this.canvas.width,e=!0),this.canvas.height!==this.height&&(this.height=this.canvas.height,e=!0),!this._hasInvalidDimensions()&&0!==Object.keys(this.tiles).length){var i=this.map.painter.context,r=i.gl;for(var o in this.boundsBuffer||(this.boundsBuffer=i.createVertexBuffer(this._boundsArray,A.members)),this.boundsSegments||(this.boundsSegments=t.SegmentVector.simpleSegment(0,0,4,2)),this.texture?(e||this._playing)&&this.texture.update(this.canvas,{premultiply:!0}):this.texture=new t.Texture(i,this.canvas,r.RGBA,{premultiply:!0}),this.tiles){var a=this.tiles[o];"loaded"!==a.state&&(a.state="loaded",a.texture=this.texture)}}},i.prototype.serialize=function(){return{type:"canvas",coordinates:this.coordinates}},i.prototype.hasTransition=function(){return this._playing},i.prototype._hasInvalidDimensions=function(){for(var t=0,e=[this.canvas.width,this.canvas.height];t<e.length;t+=1){var i=e[t];if(isNaN(i)||i<=0)return!0}return!1},i}(M),D={vector:I,raster:z,"raster-dem":C,geojson:P,video:L,image:M,canvas:R};function O(e,i){var r=t.identity([]);return t.translate(r,r,[1,1,0]),t.scale(r,r,[.5*e.width,.5*e.height,1]),t.multiply(r,r,e.calculatePosMatrix(i.toUnwrapped()))}function B(t,e,i,r,o,a){var n=function(t,e,i){if(t)for(var r=0,o=t;r<o.length;r+=1){var a=e[o[r]];if(a&&a.source===i&&"fill-extrusion"===a.type)return!0}else for(var n in e){var s=e[n];if(s.source===i&&"fill-extrusion"===s.type)return!0}return!1}(o&&o.layers,e,t.id),s=a.maxPitchScaleFactor(),l=t.tilesIn(r,s,n);l.sort(F);for(var c=[],u=0,h=l;u<h.length;u+=1){var p=h[u];c.push({wrappedTileID:p.tileID.wrapped().key,queryResults:p.tile.queryRenderedFeatures(e,i,t._state,p.queryGeometry,p.cameraQueryGeometry,p.scale,o,a,s,O(t.transform,p.tileID))})}var d=function(t){for(var e={},i={},r=0,o=t;r<o.length;r+=1){var a=o[r],n=a.queryResults,s=a.wrappedTileID,l=i[s]=i[s]||{};for(var c in n)for(var u=n[c],h=l[c]=l[c]||{},p=e[c]=e[c]||[],d=0,f=u;d<f.length;d+=1){var m=f[d];h[m.featureIndex]||(h[m.featureIndex]=!0,p.push(m))}}return e}(c);for(var f in d)d[f].forEach((function(e){var i=e.feature,r=t.getFeatureState(i.layer["source-layer"],i.id);i.source=i.layer.source,i.layer["source-layer"]&&(i.sourceLayer=i.layer["source-layer"]),i.state=r}));return d}function F(t,e){var i=t.tileID,r=e.tileID;return i.overscaledZ-r.overscaledZ||i.canonical.y-r.canonical.y||i.wrap-r.wrap||i.canonical.x-r.canonical.x}var U=function(t,e){this.max=t,this.onRemove=e,this.reset()};U.prototype.reset=function(){for(var t in this.data)for(var e=0,i=this.data[t];e<i.length;e+=1){var r=i[e];r.timeout&&clearTimeout(r.timeout),this.onRemove(r.value)}return this.data={},this.order=[],this},U.prototype.add=function(t,e,i){var r=this,o=t.wrapped().key;void 0===this.data[o]&&(this.data[o]=[]);var a={value:e,timeout:void 0};if(void 0!==i&&(a.timeout=setTimeout((function(){r.remove(t,a)}),i)),this.data[o].push(a),this.order.push(o),this.order.length>this.max){var n=this._getAndRemoveByKey(this.order[0]);n&&this.onRemove(n)}return this},U.prototype.has=function(t){return t.wrapped().key in this.data},U.prototype.getAndRemove=function(t){return this.has(t)?this._getAndRemoveByKey(t.wrapped().key):null},U.prototype._getAndRemoveByKey=function(t){var e=this.data[t].shift();return e.timeout&&clearTimeout(e.timeout),0===this.data[t].length&&delete this.data[t],this.order.splice(this.order.indexOf(t),1),e.value},U.prototype.getByKey=function(t){var e=this.data[t];return e?e[0].value:null},U.prototype.get=function(t){return this.has(t)?this.data[t.wrapped().key][0].value:null},U.prototype.remove=function(t,e){if(!this.has(t))return this;var i=t.wrapped().key,r=void 0===e?0:this.data[i].indexOf(e),o=this.data[i][r];return this.data[i].splice(r,1),o.timeout&&clearTimeout(o.timeout),0===this.data[i].length&&delete this.data[i],this.onRemove(o.value),this.order.splice(this.order.indexOf(i),1),this},U.prototype.setMaxSize=function(t){for(this.max=t;this.order.length>this.max;){var e=this._getAndRemoveByKey(this.order[0]);e&&this.onRemove(e)}return this},U.prototype.filter=function(t){var e=[];for(var i in this.data)for(var r=0,o=this.data[i];r<o.length;r+=1){var a=o[r];t(a.value)||e.push(a)}for(var n=0,s=e;n<s.length;n+=1){var l=s[n];this.remove(l.value.tileID,l)}};var N=function(t,e,i){this.context=t;var r=t.gl;this.buffer=r.createBuffer(),this.dynamicDraw=Boolean(i),this.context.unbindVAO(),t.bindElementBuffer.set(this.buffer),r.bufferData(r.ELEMENT_ARRAY_BUFFER,e.arrayBuffer,this.dynamicDraw?r.DYNAMIC_DRAW:r.STATIC_DRAW),this.dynamicDraw||delete e.arrayBuffer};N.prototype.bind=function(){this.context.bindElementBuffer.set(this.buffer)},N.prototype.updateData=function(t){var e=this.context.gl;this.context.unbindVAO(),this.bind(),e.bufferSubData(e.ELEMENT_ARRAY_BUFFER,0,t.arrayBuffer)},N.prototype.destroy=function(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)};var j={Int8:"BYTE",Uint8:"UNSIGNED_BYTE",Int16:"SHORT",Uint16:"UNSIGNED_SHORT",Int32:"INT",Uint32:"UNSIGNED_INT",Float32:"FLOAT"},V=function(t,e,i,r){this.length=e.length,this.attributes=i,this.itemSize=e.bytesPerElement,this.dynamicDraw=r,this.context=t;var o=t.gl;this.buffer=o.createBuffer(),t.bindVertexBuffer.set(this.buffer),o.bufferData(o.ARRAY_BUFFER,e.arrayBuffer,this.dynamicDraw?o.DYNAMIC_DRAW:o.STATIC_DRAW),this.dynamicDraw||delete e.arrayBuffer};V.prototype.bind=function(){this.context.bindVertexBuffer.set(this.buffer)},V.prototype.updateData=function(t){var e=this.context.gl;this.bind(),e.bufferSubData(e.ARRAY_BUFFER,0,t.arrayBuffer)},V.prototype.enableAttributes=function(t,e){for(var i=0;i<this.attributes.length;i++){var r=e.attributes[this.attributes[i].name];void 0!==r&&t.enableVertexAttribArray(r)}},V.prototype.setVertexAttribPointers=function(t,e,i){for(var r=0;r<this.attributes.length;r++){var o=this.attributes[r],a=e.attributes[o.name];void 0!==a&&t.vertexAttribPointer(a,o.components,t[j[o.type]],!1,this.itemSize,o.offset+this.itemSize*(i||0))}},V.prototype.destroy=function(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)};var q=function(t){this.gl=t.gl,this.default=this.getDefault(),this.current=this.default,this.dirty=!1};q.prototype.get=function(){return this.current},q.prototype.set=function(t){},q.prototype.getDefault=function(){return this.default},q.prototype.setDefault=function(){this.set(this.default)};var G=function(e){function i(){e.apply(this,arguments)}return e&&(i.__proto__=e),(i.prototype=Object.create(e&&e.prototype)).constructor=i,i.prototype.getDefault=function(){return t.Color.transparent},i.prototype.set=function(t){var e=this.current;(t.r!==e.r||t.g!==e.g||t.b!==e.b||t.a!==e.a||this.dirty)&&(this.gl.clearColor(t.r,t.g,t.b,t.a),this.current=t,this.dirty=!1)},i}(q),Z=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e,e.prototype.getDefault=function(){return 1},e.prototype.set=function(t){(t!==this.current||this.dirty)&&(this.gl.clearDepth(t),this.current=t,this.dirty=!1)},e}(q),H=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e,e.prototype.getDefault=function(){return 0},e.prototype.set=function(t){(t!==this.current||this.dirty)&&(this.gl.clearStencil(t),this.current=t,this.dirty=!1)},e}(q),K=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e,e.prototype.getDefault=function(){return[!0,!0,!0,!0]},e.prototype.set=function(t){var e=this.current;(t[0]!==e[0]||t[1]!==e[1]||t[2]!==e[2]||t[3]!==e[3]||this.dirty)&&(this.gl.colorMask(t[0],t[1],t[2],t[3]),this.current=t,this.dirty=!1)},e}(q),W=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e,e.prototype.getDefault=function(){return!0},e.prototype.set=function(t){(t!==this.current||this.dirty)&&(this.gl.depthMask(t),this.current=t,this.dirty=!1)},e}(q),X=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e,e.prototype.getDefault=function(){return 255},e.prototype.set=function(t){(t!==this.current||this.dirty)&&(this.gl.stencilMask(t),this.current=t,this.dirty=!1)},e}(q),$=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e,e.prototype.getDefault=function(){return{func:this.gl.ALWAYS,ref:0,mask:255}},e.prototype.set=function(t){var e=this.current;(t.func!==e.func||t.ref!==e.ref||t.mask!==e.mask||this.dirty)&&(this.gl.stencilFunc(t.func,t.ref,t.mask),this.current=t,this.dirty=!1)},e}(q),J=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e,e.prototype.getDefault=function(){var t=this.gl;return[t.KEEP,t.KEEP,t.KEEP]},e.prototype.set=function(t){var e=this.current;(t[0]!==e[0]||t[1]!==e[1]||t[2]!==e[2]||this.dirty)&&(this.gl.stencilOp(t[0],t[1],t[2]),this.current=t,this.dirty=!1)},e}(q),Y=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e,e.prototype.getDefault=function(){return!1},e.prototype.set=function(t){if(t!==this.current||this.dirty){var e=this.gl;t?e.enable(e.STENCIL_TEST):e.disable(e.STENCIL_TEST),this.current=t,this.dirty=!1}},e}(q),Q=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e,e.prototype.getDefault=function(){return[0,1]},e.prototype.set=function(t){var e=this.current;(t[0]!==e[0]||t[1]!==e[1]||this.dirty)&&(this.gl.depthRange(t[0],t[1]),this.current=t,this.dirty=!1)},e}(q),tt=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e,e.prototype.getDefault=function(){return!1},e.prototype.set=function(t){if(t!==this.current||this.dirty){var e=this.gl;t?e.enable(e.DEPTH_TEST):e.disable(e.DEPTH_TEST),this.current=t,this.dirty=!1}},e}(q),et=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e,e.prototype.getDefault=function(){return this.gl.LESS},e.prototype.set=function(t){(t!==this.current||this.dirty)&&(this.gl.depthFunc(t),this.current=t,this.dirty=!1)},e}(q),it=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e,e.prototype.getDefault=function(){return!1},e.prototype.set=function(t){if(t!==this.current||this.dirty){var e=this.gl;t?e.enable(e.BLEND):e.disable(e.BLEND),this.current=t,this.dirty=!1}},e}(q),ot=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e,e.prototype.getDefault=function(){var t=this.gl;return[t.ONE,t.ZERO]},e.prototype.set=function(t){var e=this.current;(t[0]!==e[0]||t[1]!==e[1]||this.dirty)&&(this.gl.blendFunc(t[0],t[1]),this.current=t,this.dirty=!1)},e}(q),rt=function(e){function i(){e.apply(this,arguments)}return e&&(i.__proto__=e),(i.prototype=Object.create(e&&e.prototype)).constructor=i,i.prototype.getDefault=function(){return t.Color.transparent},i.prototype.set=function(t){var e=this.current;(t.r!==e.r||t.g!==e.g||t.b!==e.b||t.a!==e.a||this.dirty)&&(this.gl.blendColor(t.r,t.g,t.b,t.a),this.current=t,this.dirty=!1)},i}(q),nt=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e,e.prototype.getDefault=function(){return this.gl.FUNC_ADD},e.prototype.set=function(t){(t!==this.current||this.dirty)&&(this.gl.blendEquation(t),this.current=t,this.dirty=!1)},e}(q),at=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e,e.prototype.getDefault=function(){return!1},e.prototype.set=function(t){if(t!==this.current||this.dirty){var e=this.gl;t?e.enable(e.CULL_FACE):e.disable(e.CULL_FACE),this.current=t,this.dirty=!1}},e}(q),st=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e,e.prototype.getDefault=function(){return this.gl.BACK},e.prototype.set=function(t){(t!==this.current||this.dirty)&&(this.gl.cullFace(t),this.current=t,this.dirty=!1)},e}(q),lt=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e,e.prototype.getDefault=function(){return this.gl.CCW},e.prototype.set=function(t){(t!==this.current||this.dirty)&&(this.gl.frontFace(t),this.current=t,this.dirty=!1)},e}(q),ut=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e,e.prototype.getDefault=function(){return null},e.prototype.set=function(t){(t!==this.current||this.dirty)&&(this.gl.useProgram(t),this.current=t,this.dirty=!1)},e}(q),ct=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e,e.prototype.getDefault=function(){return this.gl.TEXTURE0},e.prototype.set=function(t){(t!==this.current||this.dirty)&&(this.gl.activeTexture(t),this.current=t,this.dirty=!1)},e}(q),pt=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e,e.prototype.getDefault=function(){var t=this.gl;return[0,0,t.drawingBufferWidth,t.drawingBufferHeight]},e.prototype.set=function(t){var e=this.current;(t[0]!==e[0]||t[1]!==e[1]||t[2]!==e[2]||t[3]!==e[3]||this.dirty)&&(this.gl.viewport(t[0],t[1],t[2],t[3]),this.current=t,this.dirty=!1)},e}(q),ht=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e,e.prototype.getDefault=function(){return null},e.prototype.set=function(t){if(t!==this.current||this.dirty){var e=this.gl;e.bindFramebuffer(e.FRAMEBUFFER,t),this.current=t,this.dirty=!1}},e}(q),dt=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e,e.prototype.getDefault=function(){return null},e.prototype.set=function(t){if(t!==this.current||this.dirty){var e=this.gl;e.bindRenderbuffer(e.RENDERBUFFER,t),this.current=t,this.dirty=!1}},e}(q),ft=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e,e.prototype.getDefault=function(){return null},e.prototype.set=function(t){if(t!==this.current||this.dirty){var e=this.gl;e.bindTexture(e.TEXTURE_2D,t),this.current=t,this.dirty=!1}},e}(q),mt=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e,e.prototype.getDefault=function(){return null},e.prototype.set=function(t){if(t!==this.current||this.dirty){var e=this.gl;e.bindBuffer(e.ARRAY_BUFFER,t),this.current=t,this.dirty=!1}},e}(q),gt=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e,e.prototype.getDefault=function(){return null},e.prototype.set=function(t){var e=this.gl;e.bindBuffer(e.ELEMENT_ARRAY_BUFFER,t),this.current=t,this.dirty=!1},e}(q),yt=function(t){function e(e){t.call(this,e),this.vao=e.extVertexArrayObject}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e,e.prototype.getDefault=function(){return null},e.prototype.set=function(t){this.vao&&(t!==this.current||this.dirty)&&(this.vao.bindVertexArrayOES(t),this.current=t,this.dirty=!1)},e}(q),vt=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e,e.prototype.getDefault=function(){return 4},e.prototype.set=function(t){if(t!==this.current||this.dirty){var e=this.gl;e.pixelStorei(e.UNPACK_ALIGNMENT,t),this.current=t,this.dirty=!1}},e}(q),_t=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e,e.prototype.getDefault=function(){return!1},e.prototype.set=function(t){if(t!==this.current||this.dirty){var e=this.gl;e.pixelStorei(e.UNPACK_PREMULTIPLY_ALPHA_WEBGL,t),this.current=t,this.dirty=!1}},e}(q),xt=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e,e.prototype.getDefault=function(){return!1},e.prototype.set=function(t){if(t!==this.current||this.dirty){var e=this.gl;e.pixelStorei(e.UNPACK_FLIP_Y_WEBGL,t),this.current=t,this.dirty=!1}},e}(q),bt=function(t){function e(e,i){t.call(this,e),this.context=e,this.parent=i}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e,e.prototype.getDefault=function(){return null},e}(q),wt=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e,e.prototype.setDirty=function(){this.dirty=!0},e.prototype.set=function(t){if(t!==this.current||this.dirty){this.context.bindFramebuffer.set(this.parent);var e=this.gl;e.framebufferTexture2D(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0,e.TEXTURE_2D,t,0),this.current=t,this.dirty=!1}},e}(bt),Et=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e,e.prototype.set=function(t){if(t!==this.current||this.dirty){this.context.bindFramebuffer.set(this.parent);var e=this.gl;e.framebufferRenderbuffer(e.FRAMEBUFFER,e.DEPTH_ATTACHMENT,e.RENDERBUFFER,t),this.current=t,this.dirty=!1}},e}(bt),kt=function(t,e,i,r){this.context=t,this.width=e,this.height=i;var o=this.framebuffer=t.gl.createFramebuffer();this.colorAttachment=new wt(t,o),r&&(this.depthAttachment=new Et(t,o))};kt.prototype.destroy=function(){var t=this.context.gl,e=this.colorAttachment.get();if(e&&t.deleteTexture(e),this.depthAttachment){var i=this.depthAttachment.get();i&&t.deleteRenderbuffer(i)}t.deleteFramebuffer(this.framebuffer)};var St=function(t,e,i){this.func=t,this.mask=e,this.range=i};St.ReadOnly=!1,St.ReadWrite=!0,St.disabled=new St(519,St.ReadOnly,[0,1]);var Tt=function(t,e,i,r,o,a){this.test=t,this.ref=e,this.mask=i,this.fail=r,this.depthFail=o,this.pass=a};Tt.disabled=new Tt({func:519,mask:0},0,0,7680,7680,7680);var It=function(t,e,i){this.blendFunction=t,this.blendColor=e,this.mask=i};It.disabled=new It(It.Replace=[1,0],t.Color.transparent,[!1,!1,!1,!1]),It.unblended=new It(It.Replace,t.Color.transparent,[!0,!0,!0,!0]),It.alphaBlended=new It([1,771],t.Color.transparent,[!0,!0,!0,!0]);var zt=function(t,e,i){this.enable=t,this.mode=e,this.frontFace=i};zt.disabled=new zt(!1,1029,2305),zt.backCCW=new zt(!0,1029,2305);var Ct=function(t){this.gl=t,this.extVertexArrayObject=this.gl.getExtension("OES_vertex_array_object"),this.clearColor=new G(this),this.clearDepth=new Z(this),this.clearStencil=new H(this),this.colorMask=new K(this),this.depthMask=new W(this),this.stencilMask=new X(this),this.stencilFunc=new $(this),this.stencilOp=new J(this),this.stencilTest=new Y(this),this.depthRange=new Q(this),this.depthTest=new tt(this),this.depthFunc=new et(this),this.blend=new it(this),this.blendFunc=new ot(this),this.blendColor=new rt(this),this.blendEquation=new nt(this),this.cullFace=new at(this),this.cullFaceSide=new st(this),this.frontFace=new lt(this),this.program=new ut(this),this.activeTexture=new ct(this),this.viewport=new pt(this),this.bindFramebuffer=new ht(this),this.bindRenderbuffer=new dt(this),this.bindTexture=new ft(this),this.bindVertexBuffer=new mt(this),this.bindElementBuffer=new gt(this),this.bindVertexArrayOES=this.extVertexArrayObject&&new yt(this),this.pixelStoreUnpack=new vt(this),this.pixelStoreUnpackPremultiplyAlpha=new _t(this),this.pixelStoreUnpackFlipY=new xt(this),this.extTextureFilterAnisotropic=t.getExtension("EXT_texture_filter_anisotropic")||t.getExtension("MOZ_EXT_texture_filter_anisotropic")||t.getExtension("WEBKIT_EXT_texture_filter_anisotropic"),this.extTextureFilterAnisotropic&&(this.extTextureFilterAnisotropicMax=t.getParameter(this.extTextureFilterAnisotropic.MAX_TEXTURE_MAX_ANISOTROPY_EXT)),this.extTextureHalfFloat=t.getExtension("OES_texture_half_float"),this.extTextureHalfFloat&&(t.getExtension("OES_texture_half_float_linear"),this.extRenderToTextureHalfFloat=t.getExtension("EXT_color_buffer_half_float")),this.extTimerQuery=t.getExtension("EXT_disjoint_timer_query")};Ct.prototype.setDefault=function(){this.unbindVAO(),this.clearColor.setDefault(),this.clearDepth.setDefault(),this.clearStencil.setDefault(),this.colorMask.setDefault(),this.depthMask.setDefault(),this.stencilMask.setDefault(),this.stencilFunc.setDefault(),this.stencilOp.setDefault(),this.stencilTest.setDefault(),this.depthRange.setDefault(),this.depthTest.setDefault(),this.depthFunc.setDefault(),this.blend.setDefault(),this.blendFunc.setDefault(),this.blendColor.setDefault(),this.blendEquation.setDefault(),this.cullFace.setDefault(),this.cullFaceSide.setDefault(),this.frontFace.setDefault(),this.program.setDefault(),this.activeTexture.setDefault(),this.bindFramebuffer.setDefault(),this.pixelStoreUnpack.setDefault(),this.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.pixelStoreUnpackFlipY.setDefault()},Ct.prototype.setDirty=function(){this.clearColor.dirty=!0,this.clearDepth.dirty=!0,this.clearStencil.dirty=!0,this.colorMask.dirty=!0,this.depthMask.dirty=!0,this.stencilMask.dirty=!0,this.stencilFunc.dirty=!0,this.stencilOp.dirty=!0,this.stencilTest.dirty=!0,this.depthRange.dirty=!0,this.depthTest.dirty=!0,this.depthFunc.dirty=!0,this.blend.dirty=!0,this.blendFunc.dirty=!0,this.blendColor.dirty=!0,this.blendEquation.dirty=!0,this.cullFace.dirty=!0,this.cullFaceSide.dirty=!0,this.frontFace.dirty=!0,this.program.dirty=!0,this.activeTexture.dirty=!0,this.viewport.dirty=!0,this.bindFramebuffer.dirty=!0,this.bindRenderbuffer.dirty=!0,this.bindTexture.dirty=!0,this.bindVertexBuffer.dirty=!0,this.bindElementBuffer.dirty=!0,this.extVertexArrayObject&&(this.bindVertexArrayOES.dirty=!0),this.pixelStoreUnpack.dirty=!0,this.pixelStoreUnpackPremultiplyAlpha.dirty=!0,this.pixelStoreUnpackFlipY.dirty=!0},Ct.prototype.createIndexBuffer=function(t,e){return new N(this,t,e)},Ct.prototype.createVertexBuffer=function(t,e,i){return new V(this,t,e,i)},Ct.prototype.createRenderbuffer=function(t,e,i){var r=this.gl,o=r.createRenderbuffer();return this.bindRenderbuffer.set(o),r.renderbufferStorage(r.RENDERBUFFER,t,e,i),this.bindRenderbuffer.set(null),o},Ct.prototype.createFramebuffer=function(t,e,i){return new kt(this,t,e,i)},Ct.prototype.clear=function(t){var e=t.color,i=t.depth,r=this.gl,o=0;e&&(o|=r.COLOR_BUFFER_BIT,this.clearColor.set(e),this.colorMask.set([!0,!0,!0,!0])),void 0!==i&&(o|=r.DEPTH_BUFFER_BIT,this.depthRange.set([0,1]),this.clearDepth.set(i),this.depthMask.set(!0)),r.clear(o)},Ct.prototype.setCullFace=function(t){!1===t.enable?this.cullFace.set(!1):(this.cullFace.set(!0),this.cullFaceSide.set(t.mode),this.frontFace.set(t.frontFace))},Ct.prototype.setDepthMode=function(t){t.func!==this.gl.ALWAYS||t.mask?(this.depthTest.set(!0),this.depthFunc.set(t.func),this.depthMask.set(t.mask),this.depthRange.set(t.range)):this.depthTest.set(!1)},Ct.prototype.setStencilMode=function(t){t.test.func!==this.gl.ALWAYS||t.mask?(this.stencilTest.set(!0),this.stencilMask.set(t.mask),this.stencilOp.set([t.fail,t.depthFail,t.pass]),this.stencilFunc.set({func:t.test.func,ref:t.ref,mask:t.test.mask})):this.stencilTest.set(!1)},Ct.prototype.setColorMode=function(e){t.deepEqual(e.blendFunction,It.Replace)?this.blend.set(!1):(this.blend.set(!0),this.blendFunc.set(e.blendFunction),this.blendColor.set(e.blendColor)),this.colorMask.set(e.mask)},Ct.prototype.unbindVAO=function(){this.extVertexArrayObject&&this.bindVertexArrayOES.set(null)};var Pt=function(e){function i(i,r,o){var a=this;e.call(this),this.id=i,this.dispatcher=o,this.on("data",(function(t){"source"===t.dataType&&"metadata"===t.sourceDataType&&(a._sourceLoaded=!0),a._sourceLoaded&&!a._paused&&"source"===t.dataType&&"content"===t.sourceDataType&&(a.reload(),a.transform&&a.update(a.transform))})),this.on("error",(function(){a._sourceErrored=!0})),this._source=function(e,i,r,o){var a=new D[i.type](e,i,r,o);if(a.id!==e)throw new Error("Expected Source id to be "+e+" instead of "+a.id);return t.bindAll(["load","abort","unload","serialize","prepare"],a),a}(i,r,o,this),this._tiles={},this._cache=new U(0,this._unloadTile.bind(this)),this._timers={},this._cacheTimers={},this._maxTileCacheSize=null,this._loadedParentTiles={},this._coveredTiles={},this._state=new t.SourceFeatureState}return e&&(i.__proto__=e),(i.prototype=Object.create(e&&e.prototype)).constructor=i,i.prototype.onAdd=function(t){this.map=t,this._maxTileCacheSize=t?t._maxTileCacheSize:null,this._source&&this._source.onAdd&&this._source.onAdd(t)},i.prototype.onRemove=function(t){this._source&&this._source.onRemove&&this._source.onRemove(t)},i.prototype.loaded=function(){if(this._sourceErrored)return!0;if(!this._sourceLoaded)return!1;if(!this._source.loaded())return!1;for(var t in this._tiles){var e=this._tiles[t];if("loaded"!==e.state&&"errored"!==e.state)return!1}return!0},i.prototype.getSource=function(){return this._source},i.prototype.pause=function(){this._paused=!0},i.prototype.resume=function(){if(this._paused){var t=this._shouldReloadOnResume;this._paused=!1,this._shouldReloadOnResume=!1,t&&this.reload(),this.transform&&this.update(this.transform)}},i.prototype._loadTile=function(t,e){return this._source.loadTile(t,e)},i.prototype._unloadTile=function(t){if(this._source.unloadTile)return this._source.unloadTile(t,(function(){}))},i.prototype._abortTile=function(t){if(this._source.abortTile)return this._source.abortTile(t,(function(){}))},i.prototype.serialize=function(){return this._source.serialize()},i.prototype.prepare=function(t){for(var e in this._source.prepare&&this._source.prepare(),this._state.coalesceChanges(this._tiles,this.map?this.map.painter:null),this._tiles){var i=this._tiles[e];i.upload(t),i.prepare(this.map.style.imageManager)}},i.prototype.getIds=function(){return t.values(this._tiles).map((function(t){return t.tileID})).sort(At).map((function(t){return t.key}))},i.prototype.getRenderableIds=function(e){var i=this,r=[];for(var o in this._tiles)this._isIdRenderable(o,e)&&r.push(this._tiles[o]);return e?r.sort((function(e,r){var o=e.tileID,a=r.tileID,n=new t.Point(o.canonical.x,o.canonical.y)._rotate(i.transform.angle),s=new t.Point(a.canonical.x,a.canonical.y)._rotate(i.transform.angle);return o.overscaledZ-a.overscaledZ||s.y-n.y||s.x-n.x})).map((function(t){return t.tileID.key})):r.map((function(t){return t.tileID})).sort(At).map((function(t){return t.key}))},i.prototype.hasRenderableParent=function(t){var e=this.findLoadedParent(t,0);return!!e&&this._isIdRenderable(e.tileID.key)},i.prototype._isIdRenderable=function(t,e){return this._tiles[t]&&this._tiles[t].hasData()&&!this._coveredTiles[t]&&(e||!this._tiles[t].holdingForFade())},i.prototype.reload=function(){if(this._paused)this._shouldReloadOnResume=!0;else for(var t in this._cache.reset(),this._tiles)"errored"!==this._tiles[t].state&&this._reloadTile(t,"reloading")},i.prototype._reloadTile=function(t,e){var i=this._tiles[t];i&&("loading"!==i.state&&(i.state=e),this._loadTile(i,this._tileLoaded.bind(this,i,t,e)))},i.prototype._tileLoaded=function(e,i,r,o){if(o)return e.state="errored",void(404!==o.status?this._source.fire(new t.ErrorEvent(o,{tile:e})):this.update(this.transform));e.timeAdded=t.browser.now(),"expired"===r&&(e.refreshedUponExpiration=!0),this._setTileReloadTimer(i,e),"raster-dem"===this.getSource().type&&e.dem&&this._backfillDEM(e),this._state.initializeTileState(e,this.map?this.map.painter:null),this._source.fire(new t.Event("data",{dataType:"source",tile:e,coord:e.tileID}))},i.prototype._backfillDEM=function(t){for(var e=this.getRenderableIds(),i=0;i<e.length;i++){var r=e[i];if(t.neighboringTiles&&t.neighboringTiles[r]){var o=this.getTileByID(r);a(t,o),a(o,t)}}function a(t,e){t.needsHillshadePrepare=!0;var i=e.tileID.canonical.x-t.tileID.canonical.x,r=e.tileID.canonical.y-t.tileID.canonical.y,o=Math.pow(2,t.tileID.canonical.z),a=e.tileID.key;0===i&&0===r||Math.abs(r)>1||(Math.abs(i)>1&&(1===Math.abs(i+o)?i+=o:1===Math.abs(i-o)&&(i-=o)),e.dem&&t.dem&&(t.dem.backfillBorder(e.dem,i,r),t.neighboringTiles&&t.neighboringTiles[a]&&(t.neighboringTiles[a].backfilled=!0)))}},i.prototype.getTile=function(t){return this.getTileByID(t.key)},i.prototype.getTileByID=function(t){return this._tiles[t]},i.prototype._retainLoadedChildren=function(t,e,i,r){for(var o in this._tiles){var a=this._tiles[o];if(!(r[o]||!a.hasData()||a.tileID.overscaledZ<=e||a.tileID.overscaledZ>i)){for(var n=a.tileID;a&&a.tileID.overscaledZ>e+1;){var s=a.tileID.scaledTo(a.tileID.overscaledZ-1);(a=this._tiles[s.key])&&a.hasData()&&(n=s)}for(var l=n;l.overscaledZ>e;)if(t[(l=l.scaledTo(l.overscaledZ-1)).key]){r[n.key]=n;break}}}},i.prototype.findLoadedParent=function(t,e){if(t.key in this._loadedParentTiles){var i=this._loadedParentTiles[t.key];return i&&i.tileID.overscaledZ>=e?i:null}for(var r=t.overscaledZ-1;r>=e;r--){var o=t.scaledTo(r),a=this._getLoadedTile(o);if(a)return a}},i.prototype._getLoadedTile=function(t){var e=this._tiles[t.key];return e&&e.hasData()?e:this._cache.getByKey(t.wrapped().key)},i.prototype.updateCacheSize=function(t){var e=Math.ceil(t.width/this._source.tileSize)+1,i=Math.ceil(t.height/this._source.tileSize)+1,r=Math.floor(e*i*5),o="number"==typeof this._maxTileCacheSize?Math.min(this._maxTileCacheSize,r):r;this._cache.setMaxSize(o)},i.prototype.handleWrapJump=function(t){var e=Math.round((t-(void 0===this._prevLng?t:this._prevLng))/360);if(this._prevLng=t,e){var i={};for(var r in this._tiles){var o=this._tiles[r];o.tileID=o.tileID.unwrapTo(o.tileID.wrap+e),i[o.tileID.key]=o}for(var a in this._tiles=i,this._timers)clearTimeout(this._timers[a]),delete this._timers[a];for(var n in this._tiles)this._setTileReloadTimer(n,this._tiles[n])}},i.prototype.update=function(e){var r=this;if(this.transform=e,this._sourceLoaded&&!this._paused){var o;this.updateCacheSize(e),this.handleWrapJump(this.transform.center.lng),this._coveredTiles={},this.used?this._source.tileID?o=e.getVisibleUnwrappedCoordinates(this._source.tileID).map((function(e){return new t.OverscaledTileID(e.canonical.z,e.wrap,e.canonical.z,e.canonical.x,e.canonical.y)})):(o=e.coveringTiles({tileSize:this._source.tileSize,minzoom:this._source.minzoom,maxzoom:this._source.maxzoom,roundZoom:this._source.roundZoom,reparseOverscaled:this._source.reparseOverscaled}),this._source.hasTile&&(o=o.filter((function(t){return r._source.hasTile(t)})))):o=[];var a=e.coveringZoomLevel(this._source),n=Math.max(a-i.maxOverzooming,this._source.minzoom),s=Math.max(a+i.maxUnderzooming,this._source.minzoom),l=this._updateRetainedTiles(o,a);if(Mt(this._source.type)){for(var c={},u={},h=0,p=Object.keys(l);h<p.length;h+=1){var d=p[h],f=l[d],m=this._tiles[d];if(m&&!(m.fadeEndTime&&m.fadeEndTime<=t.browser.now())){var y=this.findLoadedParent(f,n);y&&(this._addTile(y.tileID),c[y.tileID.key]=y.tileID),u[d]=f}}for(var g in this._retainLoadedChildren(u,a,s,l),c)l[g]||(this._coveredTiles[g]=!0,l[g]=c[g])}for(var v in l)this._tiles[v].clearFadeHold();for(var _=0,x=t.keysDifference(this._tiles,l);_<x.length;_+=1){var b=x[_],w=this._tiles[b];w.hasSymbolBuckets&&!w.holdingForFade()?w.setHoldDuration(this.map._fadeDuration):w.hasSymbolBuckets&&!w.symbolFadeFinished()||this._removeTile(b)}this._updateLoadedParentTileCache()}},i.prototype.releaseSymbolFadeTiles=function(){for(var t in this._tiles)this._tiles[t].holdingForFade()&&this._removeTile(t)},i.prototype._updateRetainedTiles=function(t,e){for(var r={},o={},a=Math.max(e-i.maxOverzooming,this._source.minzoom),n=Math.max(e+i.maxUnderzooming,this._source.minzoom),s={},l=0,c=t;l<c.length;l+=1){var u=c[l],h=this._addTile(u);r[u.key]=u,h.hasData()||e<this._source.maxzoom&&(s[u.key]=u)}this._retainLoadedChildren(s,e,n,r);for(var p=0,d=t;p<d.length;p+=1){var f=d[p],m=this._tiles[f.key];if(!m.hasData()){if(e+1>this._source.maxzoom){var y=f.children(this._source.maxzoom)[0],g=this.getTile(y);if(g&&g.hasData()){r[y.key]=y;continue}}else{var v=f.children(this._source.maxzoom);if(r[v[0].key]&&r[v[1].key]&&r[v[2].key]&&r[v[3].key])continue}for(var _=m.wasRequested(),x=f.overscaledZ-1;x>=a;--x){var b=f.scaledTo(x);if(o[b.key])break;if(o[b.key]=!0,!(m=this.getTile(b))&&_&&(m=this._addTile(b)),m&&(r[b.key]=b,_=m.wasRequested(),m.hasData()))break}}}return r},i.prototype._updateLoadedParentTileCache=function(){for(var t in this._loadedParentTiles={},this._tiles){for(var e=[],i=void 0,r=this._tiles[t].tileID;r.overscaledZ>0;){if(r.key in this._loadedParentTiles){i=this._loadedParentTiles[r.key];break}e.push(r.key);var o=r.scaledTo(r.overscaledZ-1);if(i=this._getLoadedTile(o))break;r=o}for(var a=0,n=e;a<n.length;a+=1)this._loadedParentTiles[n[a]]=i}},i.prototype._addTile=function(e){var i=this._tiles[e.key];if(i)return i;(i=this._cache.getAndRemove(e))&&(this._setTileReloadTimer(e.key,i),i.tileID=e,this._state.initializeTileState(i,this.map?this.map.painter:null),this._cacheTimers[e.key]&&(clearTimeout(this._cacheTimers[e.key]),delete this._cacheTimers[e.key],this._setTileReloadTimer(e.key,i)));var r=Boolean(i);return r||(i=new t.Tile(e,this._source.tileSize*e.overscaleFactor()),this._loadTile(i,this._tileLoaded.bind(this,i,e.key,i.state))),i?(i.uses++,this._tiles[e.key]=i,r||this._source.fire(new t.Event("dataloading",{tile:i,coord:i.tileID,dataType:"source"})),i):null},i.prototype._setTileReloadTimer=function(t,e){var i=this;t in this._timers&&(clearTimeout(this._timers[t]),delete this._timers[t]);var r=e.getExpiryTimeout();r&&(this._timers[t]=setTimeout((function(){i._reloadTile(t,"expired"),delete i._timers[t]}),r))},i.prototype._removeTile=function(t){var e=this._tiles[t];e&&(e.uses--,delete this._tiles[t],this._timers[t]&&(clearTimeout(this._timers[t]),delete this._timers[t]),e.uses>0||(e.hasData()&&"reloading"!==e.state?this._cache.add(e.tileID,e,e.getExpiryTimeout()):(e.aborted=!0,this._abortTile(e),this._unloadTile(e))))},i.prototype.clearTiles=function(){for(var t in this._shouldReloadOnResume=!1,this._paused=!1,this._tiles)this._removeTile(t);this._cache.reset()},i.prototype.tilesIn=function(e,i,r){var o=this,a=[],n=this.transform;if(!n)return a;for(var s=r?n.getCameraQueryGeometry(e):e,l=e.map((function(t){return n.pointCoordinate(t)})),c=s.map((function(t){return n.pointCoordinate(t)})),u=this.getIds(),h=1/0,p=1/0,d=-1/0,f=-1/0,m=0,y=c;m<y.length;m+=1){var g=y[m];h=Math.min(h,g.x),p=Math.min(p,g.y),d=Math.max(d,g.x),f=Math.max(f,g.y)}for(var v=function(e){var r=o._tiles[u[e]];if(!r.holdingForFade()){var s=r.tileID,m=Math.pow(2,n.zoom-r.tileID.overscaledZ),y=i*r.queryPadding*t.EXTENT/r.tileSize/m,g=[s.getTilePoint(new t.MercatorCoordinate(h,p)),s.getTilePoint(new t.MercatorCoordinate(d,f))];if(g[0].x-y<t.EXTENT&&g[0].y-y<t.EXTENT&&g[1].x+y>=0&&g[1].y+y>=0){var v=l.map((function(t){return s.getTilePoint(t)})),_=c.map((function(t){return s.getTilePoint(t)}));a.push({tile:r,tileID:s,queryGeometry:v,cameraQueryGeometry:_,scale:m})}}},_=0;_<u.length;_++)v(_);return a},i.prototype.getVisibleCoordinates=function(t){for(var e=this,i=this.getRenderableIds(t).map((function(t){return e._tiles[t].tileID})),r=0,o=i;r<o.length;r+=1){var a=o[r];a.posMatrix=this.transform.calculatePosMatrix(a.toUnwrapped())}return i},i.prototype.hasTransition=function(){if(this._source.hasTransition())return!0;if(Mt(this._source.type))for(var e in this._tiles){var i=this._tiles[e];if(void 0!==i.fadeEndTime&&i.fadeEndTime>=t.browser.now())return!0}return!1},i.prototype.setFeatureState=function(t,e,i){this._state.updateState(t=t||"_geojsonTileLayer",e,i)},i.prototype.removeFeatureState=function(t,e,i){this._state.removeFeatureState(t=t||"_geojsonTileLayer",e,i)},i.prototype.getFeatureState=function(t,e){return this._state.getState(t=t||"_geojsonTileLayer",e)},i.prototype.setDependencies=function(t,e,i){var r=this._tiles[t];r&&r.setDependencies(e,i)},i.prototype.reloadTilesForDependencies=function(t,e){for(var i in this._tiles)this._tiles[i].hasDependency(t,e)&&this._reloadTile(i,"reloading");this._cache.filter((function(i){return!i.hasDependency(t,e)}))},i}(t.Evented);function At(t,e){var i=Math.abs(2*t.wrap)-+(t.wrap<0),r=Math.abs(2*e.wrap)-+(e.wrap<0);return t.overscaledZ-e.overscaledZ||r-i||e.canonical.y-t.canonical.y||e.canonical.x-t.canonical.x}function Mt(t){return"raster"===t||"image"===t||"video"===t}function Lt(){return new t.window.Worker(Wo.workerUrl)}Pt.maxOverzooming=10,Pt.maxUnderzooming=3;var Rt="mapboxgl_preloaded_worker_pool",Dt=function(){this.active={}};Dt.prototype.acquire=function(t){if(!this.workers)for(this.workers=[];this.workers.length<Dt.workerCount;)this.workers.push(new Lt);return this.active[t]=!0,this.workers.slice()},Dt.prototype.release=function(t){delete this.active[t],0===this.numActive()&&(this.workers.forEach((function(t){t.terminate()})),this.workers=null)},Dt.prototype.isPreloaded=function(){return!!this.active[Rt]},Dt.prototype.numActive=function(){return Object.keys(this.active).length};var Ot,Bt=Math.floor(t.browser.hardwareConcurrency/2);function Ft(){return Ot||(Ot=new Dt),Ot}function Ut(e,i){var r={};for(var o in e)"ref"!==o&&(r[o]=e[o]);return t.refProperties.forEach((function(t){t in i&&(r[t]=i[t])})),r}function Nt(t){t=t.slice();for(var e=Object.create(null),i=0;i<t.length;i++)e[t[i].id]=t[i];for(var r=0;r<t.length;r++)"ref"in t[r]&&(t[r]=Ut(t[r],e[t[r].ref]));return t}Dt.workerCount=Math.max(Math.min(Bt,6),1);var jt={setStyle:"setStyle",addLayer:"addLayer",removeLayer:"removeLayer",setPaintProperty:"setPaintProperty",setLayoutProperty:"setLayoutProperty",setFilter:"setFilter",addSource:"addSource",removeSource:"removeSource",setGeoJSONSourceData:"setGeoJSONSourceData",setLayerZoomRange:"setLayerZoomRange",setLayerProperty:"setLayerProperty",setCenter:"setCenter",setZoom:"setZoom",setBearing:"setBearing",setPitch:"setPitch",setSprite:"setSprite",setGlyphs:"setGlyphs",setTransition:"setTransition",setLight:"setLight"};function Vt(t,e,i){i.push({command:jt.addSource,args:[t,e[t]]})}function qt(t,e,i){e.push({command:jt.removeSource,args:[t]}),i[t]=!0}function Gt(t,e,i,r){qt(t,i,r),Vt(t,e,i)}function Zt(e,i,r){var o;for(o in e[r])if(e[r].hasOwnProperty(o)&&"data"!==o&&!t.deepEqual(e[r][o],i[r][o]))return!1;for(o in i[r])if(i[r].hasOwnProperty(o)&&"data"!==o&&!t.deepEqual(e[r][o],i[r][o]))return!1;return!0}function Ht(e,i,r,o,a,n){var s;for(s in i=i||{},e=e||{})e.hasOwnProperty(s)&&(t.deepEqual(e[s],i[s])||r.push({command:n,args:[o,s,i[s],a]}));for(s in i)i.hasOwnProperty(s)&&!e.hasOwnProperty(s)&&(t.deepEqual(e[s],i[s])||r.push({command:n,args:[o,s,i[s],a]}))}function Kt(t){return t.id}function Wt(t,e){return t[e.id]=e,t}var Xt=function(t,e){this.reset(t,e)};Xt.prototype.reset=function(t,e){this.points=t||[],this._distances=[0];for(var i=1;i<this.points.length;i++)this._distances[i]=this._distances[i-1]+this.points[i].dist(this.points[i-1]);this.length=this._distances[this._distances.length-1],this.padding=Math.min(e||0,.5*this.length),this.paddedLength=this.length-2*this.padding},Xt.prototype.lerp=function(e){if(1===this.points.length)return this.points[0];e=t.clamp(e,0,1);for(var i=1,r=this._distances[i],o=e*this.paddedLength+this.padding;r<o&&i<this._distances.length;)r=this._distances[++i];var a=i-1,n=this._distances[a],s=r-n,l=s>0?(o-n)/s:0;return this.points[a].mult(1-l).add(this.points[i].mult(l))};var $t=function(t,e,i){var r=this.boxCells=[],o=this.circleCells=[];this.xCellCount=Math.ceil(t/i),this.yCellCount=Math.ceil(e/i);for(var a=0;a<this.xCellCount*this.yCellCount;a++)r.push([]),o.push([]);this.circleKeys=[],this.boxKeys=[],this.bboxes=[],this.circles=[],this.width=t,this.height=e,this.xScale=this.xCellCount/t,this.yScale=this.yCellCount/e,this.boxUid=0,this.circleUid=0};function Jt(e,i,r,o,a){var n=t.create();return i?(t.scale(n,n,[1/a,1/a,1]),r||t.rotateZ(n,n,o.angle)):t.multiply(n,o.labelPlaneMatrix,e),n}function Yt(e,i,r,o,a){if(i){var n=t.clone(e);return t.scale(n,n,[a,a,1]),r||t.rotateZ(n,n,-o.angle),n}return o.glCoordMatrix}function Qt(e,i){var r=[e.x,e.y,0,1];ce(r,r,i);var o=r[3];return{point:new t.Point(r[0]/o,r[1]/o),signedDistanceFromCamera:o}}function te(t,e){return.5+t/e*.5}function ee(t,e){var i=t[0]/t[3],r=t[1]/t[3];return i>=-e[0]&&i<=e[0]&&r>=-e[1]&&r<=e[1]}function re(e,i,r,o,a,n,s,l){var c=o?e.textSizeData:e.iconSizeData,u=t.evaluateSizeForZoom(c,r.transform.zoom),h=[256/r.width*2+1,256/r.height*2+1],p=o?e.text.dynamicLayoutVertexArray:e.icon.dynamicLayoutVertexArray;p.clear();for(var d=e.lineVertexArray,f=o?e.text.placedSymbolArray:e.icon.placedSymbolArray,m=r.transform.width/r.transform.height,y=!1,g=0;g<f.length;g++){var v=f.get(g);if(v.hidden||v.writingMode===t.WritingMode.vertical&&!y)ue(v.numGlyphs,p);else{y=!1;var _=[v.anchorX,v.anchorY,0,1];if(t.transformMat4(_,_,i),ee(_,h)){var x=te(r.transform.cameraToCenterDistance,_[3]),b=t.evaluateSizeForFeature(c,u,v),w=s?b/x:b*x,E=new t.Point(v.anchorX,v.anchorY),k=Qt(E,a).point,S={},T=ne(v,w,!1,l,i,a,n,e.glyphOffsetArray,d,p,k,E,S,m);y=T.useVertical,(T.notEnoughRoom||y||T.needsFlipping&&ne(v,w,!0,l,i,a,n,e.glyphOffsetArray,d,p,k,E,S,m).notEnoughRoom)&&ue(v.numGlyphs,p)}else ue(v.numGlyphs,p)}}o?e.text.dynamicLayoutVertexBuffer.updateData(p):e.icon.dynamicLayoutVertexBuffer.updateData(p)}function ie(t,e,i,r,o,a,n,s,l,c,u){var h=s.glyphStartIndex+s.numGlyphs,p=s.lineStartIndex,d=s.lineStartIndex+s.lineLength,f=e.getoffsetX(s.glyphStartIndex),m=e.getoffsetX(h-1),y=se(t*f,i,r,o,a,n,s.segment,p,d,l,c,u);if(!y)return null;var g=se(t*m,i,r,o,a,n,s.segment,p,d,l,c,u);return g?{first:y,last:g}:null}function oe(e,i,r,o){return e===t.WritingMode.horizontal&&Math.abs(r.y-i.y)>Math.abs(r.x-i.x)*o?{useVertical:!0}:(e===t.WritingMode.vertical?i.y<r.y:i.x>r.x)?{needsFlipping:!0}:null}function ne(e,i,r,o,a,n,s,l,c,u,h,p,d,f){var m,y=i/24,g=e.lineOffsetX*y,v=e.lineOffsetY*y;if(e.numGlyphs>1){var _=e.glyphStartIndex+e.numGlyphs,x=e.lineStartIndex,b=e.lineStartIndex+e.lineLength,w=ie(y,l,g,v,r,h,p,e,c,n,d);if(!w)return{notEnoughRoom:!0};var E=Qt(w.first.point,s).point,k=Qt(w.last.point,s).point;if(o&&!r){var S=oe(e.writingMode,E,k,f);if(S)return S}m=[w.first];for(var T=e.glyphStartIndex+1;T<_-1;T++)m.push(se(y*l.getoffsetX(T),g,v,r,h,p,e.segment,x,b,c,n,d));m.push(w.last)}else{if(o&&!r){var I=Qt(p,a).point,z=e.lineStartIndex+e.segment+1,C=new t.Point(c.getx(z),c.gety(z)),P=Qt(C,a),A=P.signedDistanceFromCamera>0?P.point:ae(p,C,I,1,a),M=oe(e.writingMode,I,A,f);if(M)return M}var L=se(y*l.getoffsetX(e.glyphStartIndex),g,v,r,h,p,e.segment,e.lineStartIndex,e.lineStartIndex+e.lineLength,c,n,d);if(!L)return{notEnoughRoom:!0};m=[L]}for(var R=0,D=m;R<D.length;R+=1){var O=D[R];t.addDynamicAttributes(u,O.point,O.angle)}return{}}function ae(t,e,i,r,o){var a=Qt(t.add(t.sub(e)._unit()),o).point,n=i.sub(a);return i.add(n._mult(r/n.mag()))}function se(e,i,r,o,a,n,s,l,c,u,h,p){var d=o?e-i:e+i,f=d>0?1:-1,m=0;o&&(f*=-1,m=Math.PI),f<0&&(m+=Math.PI);for(var y=f>0?l+s:l+s+1,g=a,v=a,_=0,x=0,b=Math.abs(d),w=[];_+x<=b;){if((y+=f)<l||y>=c)return null;if(v=g,w.push(g),void 0===(g=p[y])){var E=new t.Point(u.getx(y),u.gety(y)),k=Qt(E,h);if(k.signedDistanceFromCamera>0)g=p[y]=k.point;else{var S=y-f;g=ae(0===_?n:new t.Point(u.getx(S),u.gety(S)),E,v,b-_+1,h)}}_+=x,x=v.dist(g)}var T=(b-_)/x,I=g.sub(v),z=I.mult(T)._add(v);z._add(I._unit()._perp()._mult(r*f));var C=m+Math.atan2(g.y-v.y,g.x-v.x);return w.push(z),{point:z,angle:C,path:w}}$t.prototype.keysLength=function(){return this.boxKeys.length+this.circleKeys.length},$t.prototype.insert=function(t,e,i,r,o){this._forEachCell(e,i,r,o,this._insertBoxCell,this.boxUid++),this.boxKeys.push(t),this.bboxes.push(e),this.bboxes.push(i),this.bboxes.push(r),this.bboxes.push(o)},$t.prototype.insertCircle=function(t,e,i,r){this._forEachCell(e-r,i-r,e+r,i+r,this._insertCircleCell,this.circleUid++),this.circleKeys.push(t),this.circles.push(e),this.circles.push(i),this.circles.push(r)},$t.prototype._insertBoxCell=function(t,e,i,r,o,a){this.boxCells[o].push(a)},$t.prototype._insertCircleCell=function(t,e,i,r,o,a){this.circleCells[o].push(a)},$t.prototype._query=function(t,e,i,r,o,a){if(i<0||t>this.width||r<0||e>this.height)return!o&&[];var n=[];if(t<=0&&e<=0&&this.width<=i&&this.height<=r){if(o)return!0;for(var s=0;s<this.boxKeys.length;s++)n.push({key:this.boxKeys[s],x1:this.bboxes[4*s],y1:this.bboxes[4*s+1],x2:this.bboxes[4*s+2],y2:this.bboxes[4*s+3]});for(var l=0;l<this.circleKeys.length;l++){var c=this.circles[3*l],u=this.circles[3*l+1],h=this.circles[3*l+2];n.push({key:this.circleKeys[l],x1:c-h,y1:u-h,x2:c+h,y2:u+h})}return a?n.filter(a):n}return this._forEachCell(t,e,i,r,this._queryCell,n,{hitTest:o,seenUids:{box:{},circle:{}}},a),o?n.length>0:n},$t.prototype._queryCircle=function(t,e,i,r,o){var a=t-i,n=t+i,s=e-i,l=e+i;if(n<0||a>this.width||l<0||s>this.height)return!r&&[];var c=[];return this._forEachCell(a,s,n,l,this._queryCellCircle,c,{hitTest:r,circle:{x:t,y:e,radius:i},seenUids:{box:{},circle:{}}},o),r?c.length>0:c},$t.prototype.query=function(t,e,i,r,o){return this._query(t,e,i,r,!1,o)},$t.prototype.hitTest=function(t,e,i,r,o){return this._query(t,e,i,r,!0,o)},$t.prototype.hitTestCircle=function(t,e,i,r){return this._queryCircle(t,e,i,!0,r)},$t.prototype._queryCell=function(t,e,i,r,o,a,n,s){var l=n.seenUids,c=this.boxCells[o];if(null!==c)for(var u=this.bboxes,h=0,p=c;h<p.length;h+=1){var d=p[h];if(!l.box[d]){l.box[d]=!0;var f=4*d;if(t<=u[f+2]&&e<=u[f+3]&&i>=u[f+0]&&r>=u[f+1]&&(!s||s(this.boxKeys[d]))){if(n.hitTest)return a.push(!0),!0;a.push({key:this.boxKeys[d],x1:u[f],y1:u[f+1],x2:u[f+2],y2:u[f+3]})}}}var m=this.circleCells[o];if(null!==m)for(var y=this.circles,g=0,v=m;g<v.length;g+=1){var _=v[g];if(!l.circle[_]){l.circle[_]=!0;var x=3*_;if(this._circleAndRectCollide(y[x],y[x+1],y[x+2],t,e,i,r)&&(!s||s(this.circleKeys[_]))){if(n.hitTest)return a.push(!0),!0;var b=y[x],w=y[x+1],E=y[x+2];a.push({key:this.circleKeys[_],x1:b-E,y1:w-E,x2:b+E,y2:w+E})}}}},$t.prototype._queryCellCircle=function(t,e,i,r,o,a,n,s){var l=n.circle,c=n.seenUids,u=this.boxCells[o];if(null!==u)for(var h=this.bboxes,p=0,d=u;p<d.length;p+=1){var f=d[p];if(!c.box[f]){c.box[f]=!0;var m=4*f;if(this._circleAndRectCollide(l.x,l.y,l.radius,h[m+0],h[m+1],h[m+2],h[m+3])&&(!s||s(this.boxKeys[f])))return a.push(!0),!0}}var y=this.circleCells[o];if(null!==y)for(var g=this.circles,v=0,_=y;v<_.length;v+=1){var x=_[v];if(!c.circle[x]){c.circle[x]=!0;var b=3*x;if(this._circlesCollide(g[b],g[b+1],g[b+2],l.x,l.y,l.radius)&&(!s||s(this.circleKeys[x])))return a.push(!0),!0}}},$t.prototype._forEachCell=function(t,e,i,r,o,a,n,s){for(var l=this._convertToXCellCoord(t),c=this._convertToYCellCoord(e),u=this._convertToXCellCoord(i),h=this._convertToYCellCoord(r),p=l;p<=u;p++)for(var d=c;d<=h;d++)if(o.call(this,t,e,i,r,this.xCellCount*d+p,a,n,s))return},$t.prototype._convertToXCellCoord=function(t){return Math.max(0,Math.min(this.xCellCount-1,Math.floor(t*this.xScale)))},$t.prototype._convertToYCellCoord=function(t){return Math.max(0,Math.min(this.yCellCount-1,Math.floor(t*this.yScale)))},$t.prototype._circlesCollide=function(t,e,i,r,o,a){var n=r-t,s=o-e,l=i+a;return l*l>n*n+s*s},$t.prototype._circleAndRectCollide=function(t,e,i,r,o,a,n){var s=(a-r)/2,l=Math.abs(t-(r+s));if(l>s+i)return!1;var c=(n-o)/2,u=Math.abs(e-(o+c));if(u>c+i)return!1;if(l<=s||u<=c)return!0;var h=l-s,p=u-c;return h*h+p*p<=i*i};var le=new Float32Array([-1/0,-1/0,0,-1/0,-1/0,0,-1/0,-1/0,0,-1/0,-1/0,0]);function ue(t,e){for(var i=0;i<t;i++){var r=e.length;e.resize(r+4),e.float32.set(le,3*r)}}function ce(t,e,i){var r=e[0],o=e[1];return t[0]=i[0]*r+i[4]*o+i[12],t[1]=i[1]*r+i[5]*o+i[13],t[3]=i[3]*r+i[7]*o+i[15],t}var pe=function(t,e,i){void 0===e&&(e=new $t(t.width+200,t.height+200,25)),void 0===i&&(i=new $t(t.width+200,t.height+200,25)),this.transform=t,this.grid=e,this.ignoredGrid=i,this.pitchfactor=Math.cos(t._pitch)*t.cameraToCenterDistance,this.screenRightBoundary=t.width+100,this.screenBottomBoundary=t.height+100,this.gridRightBoundary=t.width+200,this.gridBottomBoundary=t.height+200};function he(e,i,r){return i*(t.EXTENT/(e.tileSize*Math.pow(2,r-e.tileID.overscaledZ)))}pe.prototype.placeCollisionBox=function(t,e,i,r,o){var a=this.projectAndGetPerspectiveRatio(r,t.anchorPointX,t.anchorPointY),n=i*a.perspectiveRatio,s=t.x1*n+a.point.x,l=t.y1*n+a.point.y,c=t.x2*n+a.point.x,u=t.y2*n+a.point.y;return!this.isInsideGrid(s,l,c,u)||!e&&this.grid.hitTest(s,l,c,u,o)?{box:[],offscreen:!1}:{box:[s,l,c,u],offscreen:this.isOffscreen(s,l,c,u)}},pe.prototype.placeCollisionCircles=function(e,i,r,o,a,n,s,l,c,u,h,p,d){var f=[],m=new t.Point(i.anchorX,i.anchorY),y=Qt(m,n),g=te(this.transform.cameraToCenterDistance,y.signedDistanceFromCamera),v=(u?a/g:a*g)/t.ONE_EM,_=Qt(m,s).point,x=ie(v,o,i.lineOffsetX*v,i.lineOffsetY*v,!1,_,m,i,r,s,{}),b=!1,w=!1,E=!0;if(x){for(var k=.5*p*g+d,S=new t.Point(-100,-100),T=new t.Point(this.screenRightBoundary,this.screenBottomBoundary),I=new Xt,z=x.first,C=x.last,P=[],A=z.path.length-1;A>=1;A--)P.push(z.path[A]);for(var M=1;M<C.path.length;M++)P.push(C.path[M]);var L=2.5*k;if(l){var R=P.map((function(t){return Qt(t,l)}));P=R.some((function(t){return t.signedDistanceFromCamera<=0}))?[]:R.map((function(t){return t.point}))}var D=[];if(P.length>0){for(var O=P[0].clone(),B=P[0].clone(),F=1;F<P.length;F++)O.x=Math.min(O.x,P[F].x),O.y=Math.min(O.y,P[F].y),B.x=Math.max(B.x,P[F].x),B.y=Math.max(B.y,P[F].y);D=O.x>=S.x&&B.x<=T.x&&O.y>=S.y&&B.y<=T.y?[P]:B.x<S.x||O.x>T.x||B.y<S.y||O.y>T.y?[]:t.clipLine([P],S.x,S.y,T.x,T.y)}for(var U=0,N=D;U<N.length;U+=1){var j;I.reset(N[U],.25*k),j=I.length<=.5*k?1:Math.ceil(I.paddedLength/L)+1;for(var V=0;V<j;V++){var q=V/Math.max(j-1,1),G=I.lerp(q),Z=G.x+100,H=G.y+100;f.push(Z,H,k,0);var K=Z-k,W=H-k,X=Z+k,$=H+k;if(E=E&&this.isOffscreen(K,W,X,$),w=w||this.isInsideGrid(K,W,X,$),!e&&this.grid.hitTestCircle(Z,H,k,h)&&(b=!0,!c))return{circles:[],offscreen:!1,collisionDetected:b}}}}return{circles:!c&&b||!w?[]:f,offscreen:E,collisionDetected:b}},pe.prototype.queryRenderedSymbols=function(e){if(0===e.length||0===this.grid.keysLength()&&0===this.ignoredGrid.keysLength())return{};for(var i=[],r=1/0,o=1/0,a=-1/0,n=-1/0,s=0,l=e;s<l.length;s+=1){var c=l[s],u=new t.Point(c.x+100,c.y+100);r=Math.min(r,u.x),o=Math.min(o,u.y),a=Math.max(a,u.x),n=Math.max(n,u.y),i.push(u)}for(var h={},p={},d=0,f=this.grid.query(r,o,a,n).concat(this.ignoredGrid.query(r,o,a,n));d<f.length;d+=1){var m=f[d],y=m.key;if(void 0===h[y.bucketInstanceId]&&(h[y.bucketInstanceId]={}),!h[y.bucketInstanceId][y.featureIndex]){var g=[new t.Point(m.x1,m.y1),new t.Point(m.x2,m.y1),new t.Point(m.x2,m.y2),new t.Point(m.x1,m.y2)];t.polygonIntersectsPolygon(i,g)&&(h[y.bucketInstanceId][y.featureIndex]=!0,void 0===p[y.bucketInstanceId]&&(p[y.bucketInstanceId]=[]),p[y.bucketInstanceId].push(y.featureIndex))}}return p},pe.prototype.insertCollisionBox=function(t,e,i,r,o){(e?this.ignoredGrid:this.grid).insert({bucketInstanceId:i,featureIndex:r,collisionGroupID:o},t[0],t[1],t[2],t[3])},pe.prototype.insertCollisionCircles=function(t,e,i,r,o){for(var a=e?this.ignoredGrid:this.grid,n={bucketInstanceId:i,featureIndex:r,collisionGroupID:o},s=0;s<t.length;s+=4)a.insertCircle(n,t[s],t[s+1],t[s+2])},pe.prototype.projectAndGetPerspectiveRatio=function(e,i,r){var o=[i,r,0,1];return ce(o,o,e),{point:new t.Point((o[0]/o[3]+1)/2*this.transform.width+100,(-o[1]/o[3]+1)/2*this.transform.height+100),perspectiveRatio:.5+this.transform.cameraToCenterDistance/o[3]*.5}},pe.prototype.isOffscreen=function(t,e,i,r){return i<100||t>=this.screenRightBoundary||r<100||e>this.screenBottomBoundary},pe.prototype.isInsideGrid=function(t,e,i,r){return i>=0&&t<this.gridRightBoundary&&r>=0&&e<this.gridBottomBoundary},pe.prototype.getViewportMatrix=function(){var e=t.identity([]);return t.translate(e,e,[-100,-100,0]),e};var de=function(t,e,i,r){this.opacity=t?Math.max(0,Math.min(1,t.opacity+(t.placed?e:-e))):r&&i?1:0,this.placed=i};de.prototype.isHidden=function(){return 0===this.opacity&&!this.placed};var fe=function(t,e,i,r,o){this.text=new de(t?t.text:null,e,i,o),this.icon=new de(t?t.icon:null,e,r,o)};fe.prototype.isHidden=function(){return this.text.isHidden()&&this.icon.isHidden()};var me=function(t,e,i){this.text=t,this.icon=e,this.skipFade=i},ge=function(){this.invProjMatrix=t.create(),this.viewportMatrix=t.create(),this.circles=[]},ye=function(t,e,i,r,o){this.bucketInstanceId=t,this.featureIndex=e,this.sourceLayerIndex=i,this.bucketIndex=r,this.tileID=o},ve=function(t){this.crossSourceCollisions=t,this.maxGroupID=0,this.collisionGroups={}};function _e(e,i,r,o,a){var n=t.getAnchorAlignment(e),s=-(n.horizontalAlign-.5)*i,l=-(n.verticalAlign-.5)*r,c=t.evaluateVariableOffset(e,o);return new t.Point(s+c[0]*a,l+c[1]*a)}function xe(e,i,r,o,a,n){var s=e.x1,l=e.x2,c=e.y1,u=e.y2,h=e.anchorPointX,p=e.anchorPointY,d=new t.Point(i,r);return o&&d._rotate(a?n:-n),{x1:s+d.x,y1:c+d.y,x2:l+d.x,y2:u+d.y,anchorPointX:h,anchorPointY:p}}ve.prototype.get=function(t){if(this.crossSourceCollisions)return{ID:0,predicate:null};if(!this.collisionGroups[t]){var e=++this.maxGroupID;this.collisionGroups[t]={ID:e,predicate:function(t){return t.collisionGroupID===e}}}return this.collisionGroups[t]};var be=function(t,e,i,r){this.transform=t.clone(),this.collisionIndex=new pe(this.transform),this.placements={},this.opacities={},this.variableOffsets={},this.stale=!1,this.commitTime=0,this.fadeDuration=e,this.retainedQueryData={},this.collisionGroups=new ve(i),this.collisionCircleArrays={},this.prevPlacement=r,r&&(r.prevPlacement=void 0),this.placedOrientations={}};function we(t,e,i,r,o){t.emplaceBack(e?1:0,i?1:0,r||0,o||0),t.emplaceBack(e?1:0,i?1:0,r||0,o||0),t.emplaceBack(e?1:0,i?1:0,r||0,o||0),t.emplaceBack(e?1:0,i?1:0,r||0,o||0)}be.prototype.getBucketParts=function(e,i,r,o){var a=r.getBucket(i),n=r.latestFeatureIndex;if(a&&n&&i.id===a.layerIds[0]){var s=r.collisionBoxArray,l=a.layers[0].layout,c=Math.pow(2,this.transform.zoom-r.tileID.overscaledZ),u=r.tileSize/t.EXTENT,h=this.transform.calculatePosMatrix(r.tileID.toUnwrapped()),p="map"===l.get("text-pitch-alignment"),d="map"===l.get("text-rotation-alignment"),f=he(r,1,this.transform.zoom),m=Jt(h,p,d,this.transform,f),y=null;if(p){var g=Yt(h,p,d,this.transform,f);y=t.multiply([],this.transform.labelPlaneMatrix,g)}this.retainedQueryData[a.bucketInstanceId]=new ye(a.bucketInstanceId,n,a.sourceLayerIndex,a.index,r.tileID);var v={bucket:a,layout:l,posMatrix:h,textLabelPlaneMatrix:m,labelToScreenMatrix:y,scale:c,textPixelRatio:u,holdingForFade:r.holdingForFade(),collisionBoxArray:s,partiallyEvaluatedTextSize:t.evaluateSizeForZoom(a.textSizeData,this.transform.zoom),collisionGroup:this.collisionGroups.get(a.sourceID)};if(o)for(var _=0,x=a.sortKeyRanges;_<x.length;_+=1){var b=x[_];e.push({sortKey:b.sortKey,symbolInstanceStart:b.symbolInstanceStart,symbolInstanceEnd:b.symbolInstanceEnd,parameters:v})}else e.push({symbolInstanceStart:0,symbolInstanceEnd:a.symbolInstances.length,parameters:v})}},be.prototype.attemptAnchorPlacement=function(t,e,i,r,o,a,n,s,l,c,u,h,p,d,f){var m,y=[h.textOffset0,h.textOffset1],g=_e(t,i,r,y,o),v=this.collisionIndex.placeCollisionBox(xe(e,g.x,g.y,a,n,this.transform.angle),u,s,l,c.predicate);if(!f||0!==this.collisionIndex.placeCollisionBox(xe(f,g.x,g.y,a,n,this.transform.angle),u,s,l,c.predicate).box.length)return v.box.length>0?(this.prevPlacement&&this.prevPlacement.variableOffsets[h.crossTileID]&&this.prevPlacement.placements[h.crossTileID]&&this.prevPlacement.placements[h.crossTileID].text&&(m=this.prevPlacement.variableOffsets[h.crossTileID].anchor),this.variableOffsets[h.crossTileID]={textOffset:y,width:i,height:r,anchor:t,textBoxScale:o,prevAnchor:m},this.markUsedJustification(p,t,h,d),p.allowVerticalPlacement&&(this.markUsedOrientation(p,d,h),this.placedOrientations[h.crossTileID]=d),{shift:g,placedGlyphBoxes:v}):void 0},be.prototype.placeLayerBucketPart=function(e,i,r){var o=this,a=e.parameters,n=a.bucket,s=a.layout,l=a.posMatrix,c=a.textLabelPlaneMatrix,u=a.labelToScreenMatrix,h=a.textPixelRatio,p=a.holdingForFade,d=a.collisionBoxArray,f=a.partiallyEvaluatedTextSize,m=a.collisionGroup,y=s.get("text-optional"),g=s.get("icon-optional"),v=s.get("text-allow-overlap"),_=s.get("icon-allow-overlap"),x="map"===s.get("text-rotation-alignment"),b="map"===s.get("text-pitch-alignment"),w="none"!==s.get("icon-text-fit"),E="viewport-y"===s.get("symbol-z-order"),k=v&&(_||!n.hasIconData()||g),S=_&&(v||!n.hasTextData()||y);!n.collisionArrays&&d&&n.deserializeCollisionBoxes(d);var T=function(e,a){if(!i[e.crossTileID])if(p)o.placements[e.crossTileID]=new me(!1,!1,!1);else{var d,E=!1,T=!1,I=!0,z=null,C={box:null,offscreen:null},P={box:null,offscreen:null},A=null,M=null,L=0,R=0,D=0;a.textFeatureIndex?L=a.textFeatureIndex:e.useRuntimeCollisionCircles&&(L=e.featureIndex),a.verticalTextFeatureIndex&&(R=a.verticalTextFeatureIndex);var O=a.textBox;if(O){var B=function(i){var r=t.WritingMode.horizontal;if(n.allowVerticalPlacement&&!i&&o.prevPlacement){var a=o.prevPlacement.placedOrientations[e.crossTileID];a&&(o.placedOrientations[e.crossTileID]=a,o.markUsedOrientation(n,r=a,e))}return r},F=function(i,r){if(n.allowVerticalPlacement&&e.numVerticalGlyphVertices>0&&a.verticalTextBox)for(var o=0,s=n.writingModes;o<s.length&&(s[o]===t.WritingMode.vertical?(C=r(),P=C):C=i(),!(C&&C.box&&C.box.length));o+=1);else C=i()};if(s.get("text-variable-anchor")){var U=s.get("text-variable-anchor");if(o.prevPlacement&&o.prevPlacement.variableOffsets[e.crossTileID]){var N=o.prevPlacement.variableOffsets[e.crossTileID];U.indexOf(N.anchor)>0&&(U=U.filter((function(t){return t!==N.anchor}))).unshift(N.anchor)}var j=function(t,i,r){for(var a=t.x2-t.x1,s=t.y2-t.y1,c=e.textBoxScale,u=w&&!_?i:null,p={box:[],offscreen:!1},d=v?2*U.length:U.length,f=0;f<d;++f){var y=o.attemptAnchorPlacement(U[f%U.length],t,a,s,c,x,b,h,l,m,f>=U.length,e,n,r,u);if(y&&(p=y.placedGlyphBoxes)&&p.box&&p.box.length){E=!0,z=y.shift;break}}return p};F((function(){return j(O,a.iconBox,t.WritingMode.horizontal)}),(function(){var i=a.verticalTextBox;return n.allowVerticalPlacement&&!(C&&C.box&&C.box.length)&&e.numVerticalGlyphVertices>0&&i?j(i,a.verticalIconBox,t.WritingMode.vertical):{box:null,offscreen:null}})),C&&(E=C.box,I=C.offscreen);var V=B(C&&C.box);if(!E&&o.prevPlacement){var q=o.prevPlacement.variableOffsets[e.crossTileID];q&&(o.variableOffsets[e.crossTileID]=q,o.markUsedJustification(n,q.anchor,e,V))}}else{var G=function(t,i){var r=o.collisionIndex.placeCollisionBox(t,v,h,l,m.predicate);return r&&r.box&&r.box.length&&(o.markUsedOrientation(n,i,e),o.placedOrientations[e.crossTileID]=i),r};F((function(){return G(O,t.WritingMode.horizontal)}),(function(){var i=a.verticalTextBox;return n.allowVerticalPlacement&&e.numVerticalGlyphVertices>0&&i?G(i,t.WritingMode.vertical):{box:null,offscreen:null}})),B(C&&C.box&&C.box.length)}}if(E=(d=C)&&d.box&&d.box.length>0,I=d&&d.offscreen,e.useRuntimeCollisionCircles){var Z=n.text.placedSymbolArray.get(e.centerJustifiedTextSymbolIndex),H=t.evaluateSizeForFeature(n.textSizeData,f,Z),K=s.get("text-padding");A=o.collisionIndex.placeCollisionCircles(v,Z,n.lineVertexArray,n.glyphOffsetArray,H,l,c,u,r,b,m.predicate,e.collisionCircleDiameter,K),E=v||A.circles.length>0&&!A.collisionDetected,I=I&&A.offscreen}if(a.iconFeatureIndex&&(D=a.iconFeatureIndex),a.iconBox){var W=function(t){var e=w&&z?xe(t,z.x,z.y,x,b,o.transform.angle):t;return o.collisionIndex.placeCollisionBox(e,_,h,l,m.predicate)};T=P&&P.box&&P.box.length&&a.verticalIconBox?(M=W(a.verticalIconBox)).box.length>0:(M=W(a.iconBox)).box.length>0,I=I&&M.offscreen}var X=y||0===e.numHorizontalGlyphVertices&&0===e.numVerticalGlyphVertices,$=g||0===e.numIconVertices;if(X||$?$?X||(T=T&&E):E=T&&E:T=E=T&&E,E&&d&&d.box&&o.collisionIndex.insertCollisionBox(d.box,s.get("text-ignore-placement"),n.bucketInstanceId,P&&P.box&&R?R:L,m.ID),T&&M&&o.collisionIndex.insertCollisionBox(M.box,s.get("icon-ignore-placement"),n.bucketInstanceId,D,m.ID),A&&(E&&o.collisionIndex.insertCollisionCircles(A.circles,s.get("text-ignore-placement"),n.bucketInstanceId,L,m.ID),r)){var J=n.bucketInstanceId,Y=o.collisionCircleArrays[J];void 0===Y&&(Y=o.collisionCircleArrays[J]=new ge);for(var Q=0;Q<A.circles.length;Q+=4)Y.circles.push(A.circles[Q+0]),Y.circles.push(A.circles[Q+1]),Y.circles.push(A.circles[Q+2]),Y.circles.push(A.collisionDetected?1:0)}o.placements[e.crossTileID]=new me(E||k,T||S,I||n.justReloaded),i[e.crossTileID]=!0}};if(E)for(var I=n.getSortedSymbolIndexes(this.transform.angle),z=I.length-1;z>=0;--z){var C=I[z];T(n.symbolInstances.get(C),n.collisionArrays[C])}else for(var P=e.symbolInstanceStart;P<e.symbolInstanceEnd;P++)T(n.symbolInstances.get(P),n.collisionArrays[P]);if(r&&n.bucketInstanceId in this.collisionCircleArrays){var A=this.collisionCircleArrays[n.bucketInstanceId];t.invert(A.invProjMatrix,l),A.viewportMatrix=this.collisionIndex.getViewportMatrix()}n.justReloaded=!1},be.prototype.markUsedJustification=function(e,i,r,o){var a;a=o===t.WritingMode.vertical?r.verticalPlacedTextSymbolIndex:{left:r.leftJustifiedTextSymbolIndex,center:r.centerJustifiedTextSymbolIndex,right:r.rightJustifiedTextSymbolIndex}[t.getAnchorJustification(i)];for(var n=0,s=[r.leftJustifiedTextSymbolIndex,r.centerJustifiedTextSymbolIndex,r.rightJustifiedTextSymbolIndex,r.verticalPlacedTextSymbolIndex];n<s.length;n+=1){var l=s[n];l>=0&&(e.text.placedSymbolArray.get(l).crossTileID=a>=0&&l!==a?0:r.crossTileID)}},be.prototype.markUsedOrientation=function(e,i,r){for(var o=i===t.WritingMode.horizontal||i===t.WritingMode.horizontalOnly?i:0,a=i===t.WritingMode.vertical?i:0,n=0,s=[r.leftJustifiedTextSymbolIndex,r.centerJustifiedTextSymbolIndex,r.rightJustifiedTextSymbolIndex];n<s.length;n+=1)e.text.placedSymbolArray.get(s[n]).placedOrientation=o;r.verticalPlacedTextSymbolIndex&&(e.text.placedSymbolArray.get(r.verticalPlacedTextSymbolIndex).placedOrientation=a)},be.prototype.commit=function(t){this.commitTime=t,this.zoomAtLastRecencyCheck=this.transform.zoom;var e=this.prevPlacement,i=!1;this.prevZoomAdjustment=e?e.zoomAdjustment(this.transform.zoom):0;var r=e?e.symbolFadeChange(t):1,o=e?e.opacities:{},a=e?e.variableOffsets:{},n=e?e.placedOrientations:{};for(var s in this.placements){var l=this.placements[s],c=o[s];c?(this.opacities[s]=new fe(c,r,l.text,l.icon),i=i||l.text!==c.text.placed||l.icon!==c.icon.placed):(this.opacities[s]=new fe(null,r,l.text,l.icon,l.skipFade),i=i||l.text||l.icon)}for(var u in o){var h=o[u];if(!this.opacities[u]){var p=new fe(h,r,!1,!1);p.isHidden()||(this.opacities[u]=p,i=i||h.text.placed||h.icon.placed)}}for(var d in a)this.variableOffsets[d]||!this.opacities[d]||this.opacities[d].isHidden()||(this.variableOffsets[d]=a[d]);for(var f in n)this.placedOrientations[f]||!this.opacities[f]||this.opacities[f].isHidden()||(this.placedOrientations[f]=n[f]);i?this.lastPlacementChangeTime=t:"number"!=typeof this.lastPlacementChangeTime&&(this.lastPlacementChangeTime=e?e.lastPlacementChangeTime:t)},be.prototype.updateLayerOpacities=function(t,e){for(var i={},r=0,o=e;r<o.length;r+=1){var a=o[r],n=a.getBucket(t);n&&a.latestFeatureIndex&&t.id===n.layerIds[0]&&this.updateBucketOpacities(n,i,a.collisionBoxArray)}},be.prototype.updateBucketOpacities=function(e,i,r){var o=this;e.hasTextData()&&e.text.opacityVertexArray.clear(),e.hasIconData()&&e.icon.opacityVertexArray.clear(),e.hasIconCollisionBoxData()&&e.iconCollisionBox.collisionVertexArray.clear(),e.hasTextCollisionBoxData()&&e.textCollisionBox.collisionVertexArray.clear();var a=e.layers[0].layout,n=new fe(null,0,!1,!1,!0),s=a.get("text-allow-overlap"),l=a.get("icon-allow-overlap"),c=a.get("text-variable-anchor"),u="map"===a.get("text-rotation-alignment"),h="map"===a.get("text-pitch-alignment"),p="none"!==a.get("icon-text-fit"),d=new fe(null,0,s&&(l||!e.hasIconData()||a.get("icon-optional")),l&&(s||!e.hasTextData()||a.get("text-optional")),!0);!e.collisionArrays&&r&&(e.hasIconCollisionBoxData()||e.hasTextCollisionBoxData())&&e.deserializeCollisionBoxes(r);for(var f=function(t,e,i){for(var r=0;r<e/4;r++)t.opacityVertexArray.emplaceBack(i)},m=function(r){var a=e.symbolInstances.get(r),s=a.numHorizontalGlyphVertices,l=a.numVerticalGlyphVertices,m=a.crossTileID,y=o.opacities[m];i[m]?y=n:y||(o.opacities[m]=y=d),i[m]=!0;var g=a.numIconVertices>0,v=o.placedOrientations[a.crossTileID],_=v===t.WritingMode.vertical,x=v===t.WritingMode.horizontal||v===t.WritingMode.horizontalOnly;if(s>0||l>0){var b=Pe(y.text);f(e.text,s,_?Ae:b),f(e.text,l,x?Ae:b);var w=y.text.isHidden();[a.rightJustifiedTextSymbolIndex,a.centerJustifiedTextSymbolIndex,a.leftJustifiedTextSymbolIndex].forEach((function(t){t>=0&&(e.text.placedSymbolArray.get(t).hidden=w||_?1:0)})),a.verticalPlacedTextSymbolIndex>=0&&(e.text.placedSymbolArray.get(a.verticalPlacedTextSymbolIndex).hidden=w||x?1:0);var E=o.variableOffsets[a.crossTileID];E&&o.markUsedJustification(e,E.anchor,a,v);var k=o.placedOrientations[a.crossTileID];k&&(o.markUsedJustification(e,"left",a,k),o.markUsedOrientation(e,k,a))}if(g){var S=Pe(y.icon),T=!(p&&a.verticalPlacedIconSymbolIndex&&_);a.placedIconSymbolIndex>=0&&(f(e.icon,a.numIconVertices,T?S:Ae),e.icon.placedSymbolArray.get(a.placedIconSymbolIndex).hidden=y.icon.isHidden()),a.verticalPlacedIconSymbolIndex>=0&&(f(e.icon,a.numVerticalIconVertices,T?Ae:S),e.icon.placedSymbolArray.get(a.verticalPlacedIconSymbolIndex).hidden=y.icon.isHidden())}if(e.hasIconCollisionBoxData()||e.hasTextCollisionBoxData()){var I=e.collisionArrays[r];if(I){var z=new t.Point(0,0);if(I.textBox||I.verticalTextBox){var C=!0;if(c){var P=o.variableOffsets[m];P?(z=_e(P.anchor,P.width,P.height,P.textOffset,P.textBoxScale),u&&z._rotate(h?o.transform.angle:-o.transform.angle)):C=!1}I.textBox&&we(e.textCollisionBox.collisionVertexArray,y.text.placed,!C||_,z.x,z.y),I.verticalTextBox&&we(e.textCollisionBox.collisionVertexArray,y.text.placed,!C||x,z.x,z.y)}var A=Boolean(!x&&I.verticalIconBox);I.iconBox&&we(e.iconCollisionBox.collisionVertexArray,y.icon.placed,A,p?z.x:0,p?z.y:0),I.verticalIconBox&&we(e.iconCollisionBox.collisionVertexArray,y.icon.placed,!A,p?z.x:0,p?z.y:0)}}},y=0;y<e.symbolInstances.length;y++)m(y);if(e.sortFeatures(this.transform.angle),this.retainedQueryData[e.bucketInstanceId]&&(this.retainedQueryData[e.bucketInstanceId].featureSortOrder=e.featureSortOrder),e.hasTextData()&&e.text.opacityVertexBuffer&&e.text.opacityVertexBuffer.updateData(e.text.opacityVertexArray),e.hasIconData()&&e.icon.opacityVertexBuffer&&e.icon.opacityVertexBuffer.updateData(e.icon.opacityVertexArray),e.hasIconCollisionBoxData()&&e.iconCollisionBox.collisionVertexBuffer&&e.iconCollisionBox.collisionVertexBuffer.updateData(e.iconCollisionBox.collisionVertexArray),e.hasTextCollisionBoxData()&&e.textCollisionBox.collisionVertexBuffer&&e.textCollisionBox.collisionVertexBuffer.updateData(e.textCollisionBox.collisionVertexArray),e.bucketInstanceId in this.collisionCircleArrays){var g=this.collisionCircleArrays[e.bucketInstanceId];e.placementInvProjMatrix=g.invProjMatrix,e.placementViewportMatrix=g.viewportMatrix,e.collisionCircleArray=g.circles,delete this.collisionCircleArrays[e.bucketInstanceId]}},be.prototype.symbolFadeChange=function(t){return 0===this.fadeDuration?1:(t-this.commitTime)/this.fadeDuration+this.prevZoomAdjustment},be.prototype.zoomAdjustment=function(t){return Math.max(0,(this.transform.zoom-t)/1.5)},be.prototype.hasTransitions=function(t){return this.stale||t-this.lastPlacementChangeTime<this.fadeDuration},be.prototype.stillRecent=function(t,e){var i=this.zoomAtLastRecencyCheck===e?1-this.zoomAdjustment(e):1;return this.zoomAtLastRecencyCheck=e,this.commitTime+this.fadeDuration*i>t},be.prototype.setStale=function(){this.stale=!0};var Ee=Math.pow(2,25),ke=Math.pow(2,24),Se=Math.pow(2,17),Te=Math.pow(2,16),Ie=Math.pow(2,9),ze=Math.pow(2,8),Ce=Math.pow(2,1);function Pe(t){if(0===t.opacity&&!t.placed)return 0;if(1===t.opacity&&t.placed)return 4294967295;var e=t.placed?1:0,i=Math.floor(127*t.opacity);return i*Ee+e*ke+i*Se+e*Te+i*Ie+e*ze+i*Ce+e}var Ae=0,Me=function(t){this._sortAcrossTiles="viewport-y"!==t.layout.get("symbol-z-order")&&void 0!==t.layout.get("symbol-sort-key").constantOr(1),this._currentTileIndex=0,this._currentPartIndex=0,this._seenCrossTileIDs={},this._bucketParts=[]};Me.prototype.continuePlacement=function(t,e,i,r,o){for(var a=this._bucketParts;this._currentTileIndex<t.length;)if(e.getBucketParts(a,r,t[this._currentTileIndex],this._sortAcrossTiles),this._currentTileIndex++,o())return!0;for(this._sortAcrossTiles&&(this._sortAcrossTiles=!1,a.sort((function(t,e){return t.sortKey-e.sortKey})));this._currentPartIndex<a.length;)if(e.placeLayerBucketPart(a[this._currentPartIndex],this._seenCrossTileIDs,i),this._currentPartIndex++,o())return!0;return!1};var Le=function(t,e,i,r,o,a,n){this.placement=new be(t,o,a,n),this._currentPlacementIndex=e.length-1,this._forceFullPlacement=i,this._showCollisionBoxes=r,this._done=!1};Le.prototype.isDone=function(){return this._done},Le.prototype.continuePlacement=function(e,i,r){for(var o=this,a=t.browser.now(),n=function(){var e=t.browser.now()-a;return!o._forceFullPlacement&&e>2};this._currentPlacementIndex>=0;){var s=i[e[this._currentPlacementIndex]],l=this.placement.collisionIndex.transform.zoom;if("symbol"===s.type&&(!s.minzoom||s.minzoom<=l)&&(!s.maxzoom||s.maxzoom>l)){if(this._inProgressLayer||(this._inProgressLayer=new Me(s)),this._inProgressLayer.continuePlacement(r[s.source],this.placement,this._showCollisionBoxes,s,n))return;delete this._inProgressLayer}this._currentPlacementIndex--}this._done=!0},Le.prototype.commit=function(t){return this.placement.commit(t),this.placement};var Re=512/t.EXTENT/2,De=function(t,e,i){this.tileID=t,this.indexedSymbolInstances={},this.bucketInstanceId=i;for(var r=0;r<e.length;r++){var o=e.get(r),a=o.key;this.indexedSymbolInstances[a]||(this.indexedSymbolInstances[a]=[]),this.indexedSymbolInstances[a].push({crossTileID:o.crossTileID,coord:this.getScaledCoordinates(o,t)})}};De.prototype.getScaledCoordinates=function(e,i){var r=Re/Math.pow(2,i.canonical.z-this.tileID.canonical.z);return{x:Math.floor((i.canonical.x*t.EXTENT+e.anchorX)*r),y:Math.floor((i.canonical.y*t.EXTENT+e.anchorY)*r)}},De.prototype.findMatches=function(t,e,i){for(var r=this.tileID.canonical.z<e.canonical.z?1:Math.pow(2,this.tileID.canonical.z-e.canonical.z),o=0;o<t.length;o++){var a=t.get(o);if(!a.crossTileID){var n=this.indexedSymbolInstances[a.key];if(n)for(var s=this.getScaledCoordinates(a,e),l=0,c=n;l<c.length;l+=1){var u=c[l];if(Math.abs(u.coord.x-s.x)<=r&&Math.abs(u.coord.y-s.y)<=r&&!i[u.crossTileID]){i[u.crossTileID]=!0,a.crossTileID=u.crossTileID;break}}}}};var Oe=function(){this.maxCrossTileID=0};Oe.prototype.generate=function(){return++this.maxCrossTileID};var Be=function(){this.indexes={},this.usedCrossTileIDs={},this.lng=0};Be.prototype.handleWrapJump=function(t){var e=Math.round((t-this.lng)/360);if(0!==e)for(var i in this.indexes){var r=this.indexes[i],o={};for(var a in r){var n=r[a];n.tileID=n.tileID.unwrapTo(n.tileID.wrap+e),o[n.tileID.key]=n}this.indexes[i]=o}this.lng=t},Be.prototype.addBucket=function(t,e,i){if(this.indexes[t.overscaledZ]&&this.indexes[t.overscaledZ][t.key]){if(this.indexes[t.overscaledZ][t.key].bucketInstanceId===e.bucketInstanceId)return!1;this.removeBucketCrossTileIDs(t.overscaledZ,this.indexes[t.overscaledZ][t.key])}for(var r=0;r<e.symbolInstances.length;r++)e.symbolInstances.get(r).crossTileID=0;this.usedCrossTileIDs[t.overscaledZ]||(this.usedCrossTileIDs[t.overscaledZ]={});var o=this.usedCrossTileIDs[t.overscaledZ];for(var a in this.indexes){var n=this.indexes[a];if(Number(a)>t.overscaledZ)for(var s in n){var l=n[s];l.tileID.isChildOf(t)&&l.findMatches(e.symbolInstances,t,o)}else{var c=n[t.scaledTo(Number(a)).key];c&&c.findMatches(e.symbolInstances,t,o)}}for(var u=0;u<e.symbolInstances.length;u++){var h=e.symbolInstances.get(u);h.crossTileID||(h.crossTileID=i.generate(),o[h.crossTileID]=!0)}return void 0===this.indexes[t.overscaledZ]&&(this.indexes[t.overscaledZ]={}),this.indexes[t.overscaledZ][t.key]=new De(t,e.symbolInstances,e.bucketInstanceId),!0},Be.prototype.removeBucketCrossTileIDs=function(t,e){for(var i in e.indexedSymbolInstances)for(var r=0,o=e.indexedSymbolInstances[i];r<o.length;r+=1)delete this.usedCrossTileIDs[t][o[r].crossTileID]},Be.prototype.removeStaleBuckets=function(t){var e=!1;for(var i in this.indexes){var r=this.indexes[i];for(var o in r)t[r[o].bucketInstanceId]||(this.removeBucketCrossTileIDs(i,r[o]),delete r[o],e=!0)}return e};var Fe=function(){this.layerIndexes={},this.crossTileIDs=new Oe,this.maxBucketInstanceId=0,this.bucketsInCurrentPlacement={}};Fe.prototype.addLayer=function(t,e,i){var r=this.layerIndexes[t.id];void 0===r&&(r=this.layerIndexes[t.id]=new Be);var o=!1,a={};r.handleWrapJump(i);for(var n=0,s=e;n<s.length;n+=1){var l=s[n],c=l.getBucket(t);c&&t.id===c.layerIds[0]&&(c.bucketInstanceId||(c.bucketInstanceId=++this.maxBucketInstanceId),r.addBucket(l.tileID,c,this.crossTileIDs)&&(o=!0),a[c.bucketInstanceId]=!0)}return r.removeStaleBuckets(a)&&(o=!0),o},Fe.prototype.pruneUnusedLayers=function(t){var e={};for(var i in t.forEach((function(t){e[t]=!0})),this.layerIndexes)e[i]||delete this.layerIndexes[i]};var Ue=function(e,i){return t.emitValidationErrors(e,i&&i.filter((function(t){return"source.canvas"!==t.identifier})))},Ne=t.pick(jt,["addLayer","removeLayer","setPaintProperty","setLayoutProperty","setFilter","addSource","removeSource","setLayerZoomRange","setLight","setTransition","setGeoJSONSourceData"]),je=t.pick(jt,["setCenter","setZoom","setBearing","setPitch"]),Ve=function(){var e={},i=t.styleSpec.$version;for(var r in t.styleSpec.$root){var o,a=t.styleSpec.$root[r];a.required&&null!=(o="version"===r?i:"array"===a.type?[]:{})&&(e[r]=o)}return e}(),qe=function(e){function i(r,o){var a=this;void 0===o&&(o={}),e.call(this),this.map=r,this.dispatcher=new k(Ft(),this),this.imageManager=new p,this.imageManager.setEventedParent(this),this.glyphManager=new _(r._requestManager,o.localIdeographFontFamily),this.lineAtlas=new E(256,512),this.crossTileSymbolIndex=new Fe,this._layers={},this._serializedLayers={},this._order=[],this.sourceCaches={},this.zoomHistory=new t.ZoomHistory,this._loaded=!1,this._availableImages=[],this._resetUpdates(),this.dispatcher.broadcast("setReferrer",t.getReferrer());var n=this;this._rtlTextPluginCallback=i.registerForPluginStateChange((function(e){n.dispatcher.broadcast("syncRTLPluginState",{pluginStatus:e.pluginStatus,pluginURL:e.pluginURL},(function(e,i){if(t.triggerPluginCompletionEvent(e),i&&i.every((function(t){return t})))for(var r in n.sourceCaches)n.sourceCaches[r].reload()}))})),this.on("data",(function(t){if("source"===t.dataType&&"metadata"===t.sourceDataType){var e=a.sourceCaches[t.sourceId];if(e){var i=e.getSource();if(i&&i.vectorLayerIds)for(var r in a._layers){var o=a._layers[r];o.source===i.id&&a._validateLayer(o)}}}}))}return e&&(i.__proto__=e),(i.prototype=Object.create(e&&e.prototype)).constructor=i,i.prototype.loadURL=function(e,i){var r=this;void 0===i&&(i={}),this.fire(new t.Event("dataloading",{dataType:"style"}));var o="boolean"==typeof i.validate?i.validate:!t.isMapboxURL(e);e=this.map._requestManager.normalizeStyleURL(e,i.accessToken);var a=this.map._requestManager.transformRequest(e,t.ResourceType.Style);this._request=t.getJSON(a,(function(e,i){r._request=null,e?r.fire(new t.ErrorEvent(e)):i&&r._load(i,o)}))},i.prototype.loadJSON=function(e,i){var r=this;void 0===i&&(i={}),this.fire(new t.Event("dataloading",{dataType:"style"})),this._request=t.browser.frame((function(){r._request=null,r._load(e,!1!==i.validate)}))},i.prototype.loadEmpty=function(){this.fire(new t.Event("dataloading",{dataType:"style"})),this._load(Ve,!1)},i.prototype._load=function(e,i){if(!i||!Ue(this,t.validateStyle(e))){for(var r in this._loaded=!0,this.stylesheet=e,e.sources)this.addSource(r,e.sources[r],{validate:!1});e.sprite?this._loadSprite(e.sprite):this.imageManager.setLoaded(!0),this.glyphManager.setURL(e.glyphs);var o=Nt(this.stylesheet.layers);this._order=o.map((function(t){return t.id})),this._layers={},this._serializedLayers={};for(var a=0,n=o;a<n.length;a+=1){var s=n[a];(s=t.createStyleLayer(s)).setEventedParent(this,{layer:{id:s.id}}),this._layers[s.id]=s,this._serializedLayers[s.id]=s.serialize()}this.dispatcher.broadcast("setLayers",this._serializeLayers(this._order)),this.light=new w(this.stylesheet.light),this.fire(new t.Event("data",{dataType:"style"})),this.fire(new t.Event("style.load"))}},i.prototype._loadSprite=function(e){var i=this;this._spriteRequest=function(e,i,r){var o,a,n,s=t.browser.devicePixelRatio>1?"@2x":"",l=t.getJSON(i.transformRequest(i.normalizeSpriteURL(e,s,".json"),t.ResourceType.SpriteJSON),(function(t,e){l=null,n||(n=t,o=e,u())})),c=t.getImage(i.transformRequest(i.normalizeSpriteURL(e,s,".png"),t.ResourceType.SpriteImage),(function(t,e){c=null,n||(n=t,a=e,u())}));function u(){if(n)r(n);else if(o&&a){var e=t.browser.getImageData(a),i={};for(var s in o){var l=o[s],c=l.width,u=l.height,h=l.x,p=l.y,d=l.sdf,f=l.pixelRatio,m=l.stretchX,y=l.stretchY,g=l.content,v=new t.RGBAImage({width:c,height:u});t.RGBAImage.copy(e,v,{x:h,y:p},{x:0,y:0},{width:c,height:u}),i[s]={data:v,pixelRatio:f,sdf:d,stretchX:m,stretchY:y,content:g}}r(null,i)}}return{cancel:function(){l&&(l.cancel(),l=null),c&&(c.cancel(),c=null)}}}(e,this.map._requestManager,(function(e,r){if(i._spriteRequest=null,e)i.fire(new t.ErrorEvent(e));else if(r)for(var o in r)i.imageManager.addImage(o,r[o]);i.imageManager.setLoaded(!0),i._availableImages=i.imageManager.listImages(),i.dispatcher.broadcast("setImages",i._availableImages),i.fire(new t.Event("data",{dataType:"style"}))}))},i.prototype._validateLayer=function(e){var i=this.sourceCaches[e.source];if(i){var r=e.sourceLayer;if(r){var o=i.getSource();("geojson"===o.type||o.vectorLayerIds&&-1===o.vectorLayerIds.indexOf(r))&&this.fire(new t.ErrorEvent(new Error('Source layer "'+r+'" does not exist on source "'+o.id+'" as specified by style layer "'+e.id+'"')))}}},i.prototype.loaded=function(){if(!this._loaded)return!1;if(Object.keys(this._updatedSources).length)return!1;for(var t in this.sourceCaches)if(!this.sourceCaches[t].loaded())return!1;return!!this.imageManager.isLoaded()},i.prototype._serializeLayers=function(t){for(var e=[],i=0,r=t;i<r.length;i+=1){var o=this._layers[r[i]];"custom"!==o.type&&e.push(o.serialize())}return e},i.prototype.hasTransitions=function(){if(this.light&&this.light.hasTransition())return!0;for(var t in this.sourceCaches)if(this.sourceCaches[t].hasTransition())return!0;for(var e in this._layers)if(this._layers[e].hasTransition())return!0;return!1},i.prototype._checkLoaded=function(){if(!this._loaded)throw new Error("Style is not done loading")},i.prototype.update=function(e){if(this._loaded){var i=this._changed;if(this._changed){var r=Object.keys(this._updatedLayers),o=Object.keys(this._removedLayers);for(var a in(r.length||o.length)&&this._updateWorkerLayers(r,o),this._updatedSources){var n=this._updatedSources[a];"reload"===n?this._reloadSource(a):"clear"===n&&this._clearSource(a)}for(var s in this._updateTilesForChangedImages(),this._updatedPaintProps)this._layers[s].updateTransitions(e);this.light.updateTransitions(e),this._resetUpdates()}for(var l in this.sourceCaches)this.sourceCaches[l].used=!1;for(var c=0,u=this._order;c<u.length;c+=1){var h=this._layers[u[c]];h.recalculate(e,this._availableImages),!h.isHidden(e.zoom)&&h.source&&(this.sourceCaches[h.source].used=!0)}this.light.recalculate(e),this.z=e.zoom,i&&this.fire(new t.Event("data",{dataType:"style"}))}},i.prototype._updateTilesForChangedImages=function(){var t=Object.keys(this._changedImages);if(t.length){for(var e in this.sourceCaches)this.sourceCaches[e].reloadTilesForDependencies(["icons","patterns"],t);this._changedImages={}}},i.prototype._updateWorkerLayers=function(t,e){this.dispatcher.broadcast("updateLayers",{layers:this._serializeLayers(t),removedIds:e})},i.prototype._resetUpdates=function(){this._changed=!1,this._updatedLayers={},this._removedLayers={},this._updatedSources={},this._updatedPaintProps={},this._changedImages={}},i.prototype.setState=function(e){var i=this;if(this._checkLoaded(),Ue(this,t.validateStyle(e)))return!1;(e=t.clone$1(e)).layers=Nt(e.layers);var r=function(e,i){if(!e)return[{command:jt.setStyle,args:[i]}];var r=[];try{if(!t.deepEqual(e.version,i.version))return[{command:jt.setStyle,args:[i]}];t.deepEqual(e.center,i.center)||r.push({command:jt.setCenter,args:[i.center]}),t.deepEqual(e.zoom,i.zoom)||r.push({command:jt.setZoom,args:[i.zoom]}),t.deepEqual(e.bearing,i.bearing)||r.push({command:jt.setBearing,args:[i.bearing]}),t.deepEqual(e.pitch,i.pitch)||r.push({command:jt.setPitch,args:[i.pitch]}),t.deepEqual(e.sprite,i.sprite)||r.push({command:jt.setSprite,args:[i.sprite]}),t.deepEqual(e.glyphs,i.glyphs)||r.push({command:jt.setGlyphs,args:[i.glyphs]}),t.deepEqual(e.transition,i.transition)||r.push({command:jt.setTransition,args:[i.transition]}),t.deepEqual(e.light,i.light)||r.push({command:jt.setLight,args:[i.light]});var o={},a=[];!function(e,i,r,o){var a;for(a in i=i||{},e=e||{})e.hasOwnProperty(a)&&(i.hasOwnProperty(a)||qt(a,r,o));for(a in i)i.hasOwnProperty(a)&&(e.hasOwnProperty(a)?t.deepEqual(e[a],i[a])||("geojson"===e[a].type&&"geojson"===i[a].type&&Zt(e,i,a)?r.push({command:jt.setGeoJSONSourceData,args:[a,i[a].data]}):Gt(a,i,r,o)):Vt(a,i,r))}(e.sources,i.sources,a,o);var n=[];e.layers&&e.layers.forEach((function(t){o[t.source]?r.push({command:jt.removeLayer,args:[t.id]}):n.push(t)})),r=r.concat(a),function(e,i,r){i=i||[];var o,a,n,s,l,c,u,h=(e=e||[]).map(Kt),p=i.map(Kt),d=e.reduce(Wt,{}),f=i.reduce(Wt,{}),m=h.slice(),y=Object.create(null);for(o=0,a=0;o<h.length;o++)f.hasOwnProperty(n=h[o])?a++:(r.push({command:jt.removeLayer,args:[n]}),m.splice(m.indexOf(n,a),1));for(o=0,a=0;o<p.length;o++)m[m.length-1-o]!==(n=p[p.length-1-o])&&(d.hasOwnProperty(n)?(r.push({command:jt.removeLayer,args:[n]}),m.splice(m.lastIndexOf(n,m.length-a),1)):a++,r.push({command:jt.addLayer,args:[f[n],c=m[m.length-o]]}),m.splice(m.length-o,0,n),y[n]=!0);for(o=0;o<p.length;o++)if(s=d[n=p[o]],l=f[n],!y[n]&&!t.deepEqual(s,l))if(t.deepEqual(s.source,l.source)&&t.deepEqual(s["source-layer"],l["source-layer"])&&t.deepEqual(s.type,l.type)){for(u in Ht(s.layout,l.layout,r,n,null,jt.setLayoutProperty),Ht(s.paint,l.paint,r,n,null,jt.setPaintProperty),t.deepEqual(s.filter,l.filter)||r.push({command:jt.setFilter,args:[n,l.filter]}),t.deepEqual(s.minzoom,l.minzoom)&&t.deepEqual(s.maxzoom,l.maxzoom)||r.push({command:jt.setLayerZoomRange,args:[n,l.minzoom,l.maxzoom]}),s)s.hasOwnProperty(u)&&"layout"!==u&&"paint"!==u&&"filter"!==u&&"metadata"!==u&&"minzoom"!==u&&"maxzoom"!==u&&(0===u.indexOf("paint.")?Ht(s[u],l[u],r,n,u.slice(6),jt.setPaintProperty):t.deepEqual(s[u],l[u])||r.push({command:jt.setLayerProperty,args:[n,u,l[u]]}));for(u in l)l.hasOwnProperty(u)&&!s.hasOwnProperty(u)&&"layout"!==u&&"paint"!==u&&"filter"!==u&&"metadata"!==u&&"minzoom"!==u&&"maxzoom"!==u&&(0===u.indexOf("paint.")?Ht(s[u],l[u],r,n,u.slice(6),jt.setPaintProperty):t.deepEqual(s[u],l[u])||r.push({command:jt.setLayerProperty,args:[n,u,l[u]]}))}else r.push({command:jt.removeLayer,args:[n]}),c=m[m.lastIndexOf(n)+1],r.push({command:jt.addLayer,args:[l,c]})}(n,i.layers,r)}catch(t){console.warn("Unable to compute style diff:",t),r=[{command:jt.setStyle,args:[i]}]}return r}(this.serialize(),e).filter((function(t){return!(t.command in je)}));if(0===r.length)return!1;var o=r.filter((function(t){return!(t.command in Ne)}));if(o.length>0)throw new Error("Unimplemented: "+o.map((function(t){return t.command})).join(", ")+".");return r.forEach((function(t){"setTransition"!==t.command&&i[t.command].apply(i,t.args)})),this.stylesheet=e,!0},i.prototype.addImage=function(e,i){if(this.getImage(e))return this.fire(new t.ErrorEvent(new Error("An image with this name already exists.")));this.imageManager.addImage(e,i),this._availableImages=this.imageManager.listImages(),this._changedImages[e]=!0,this._changed=!0,this.fire(new t.Event("data",{dataType:"style"}))},i.prototype.updateImage=function(t,e){this.imageManager.updateImage(t,e)},i.prototype.getImage=function(t){return this.imageManager.getImage(t)},i.prototype.removeImage=function(e){if(!this.getImage(e))return this.fire(new t.ErrorEvent(new Error("No image with this name exists.")));this.imageManager.removeImage(e),this._availableImages=this.imageManager.listImages(),this._changedImages[e]=!0,this._changed=!0,this.fire(new t.Event("data",{dataType:"style"}))},i.prototype.listImages=function(){return this._checkLoaded(),this.imageManager.listImages()},i.prototype.addSource=function(e,i,r){var o=this;if(void 0===r&&(r={}),this._checkLoaded(),void 0!==this.sourceCaches[e])throw new Error("There is already a source with this ID");if(!i.type)throw new Error("The type property must be defined, but the only the following properties were given: "+Object.keys(i).join(", ")+".");if(!(["vector","raster","geojson","video","image"].indexOf(i.type)>=0&&this._validate(t.validateStyle.source,"sources."+e,i,null,r))){this.map&&this.map._collectResourceTiming&&(i.collectResourceTiming=!0);var a=this.sourceCaches[e]=new Pt(e,i,this.dispatcher);a.style=this,a.setEventedParent(this,(function(){return{isSourceLoaded:o.loaded(),source:a.serialize(),sourceId:e}})),a.onAdd(this.map),this._changed=!0}},i.prototype.removeSource=function(e){if(this._checkLoaded(),void 0===this.sourceCaches[e])throw new Error("There is no source with this ID");for(var i in this._layers)if(this._layers[i].source===e)return this.fire(new t.ErrorEvent(new Error('Source "'+e+'" cannot be removed while layer "'+i+'" is using it.')));var r=this.sourceCaches[e];delete this.sourceCaches[e],delete this._updatedSources[e],r.fire(new t.Event("data",{sourceDataType:"metadata",dataType:"source",sourceId:e})),r.setEventedParent(null),r.clearTiles(),r.onRemove&&r.onRemove(this.map),this._changed=!0},i.prototype.setGeoJSONSourceData=function(t,e){this._checkLoaded(),this.sourceCaches[t].getSource().setData(e),this._changed=!0},i.prototype.getSource=function(t){return this.sourceCaches[t]&&this.sourceCaches[t].getSource()},i.prototype.addLayer=function(e,i,r){void 0===r&&(r={}),this._checkLoaded();var o=e.id;if(this.getLayer(o))this.fire(new t.ErrorEvent(new Error('Layer with id "'+o+'" already exists on this map')));else{var a;if("custom"===e.type){if(Ue(this,t.validateCustomStyleLayer(e)))return;a=t.createStyleLayer(e)}else{if("object"==typeof e.source&&(this.addSource(o,e.source),e=t.clone$1(e),e=t.extend(e,{source:o})),this._validate(t.validateStyle.layer,"layers."+o,e,{arrayIndex:-1},r))return;a=t.createStyleLayer(e),this._validateLayer(a),a.setEventedParent(this,{layer:{id:o}}),this._serializedLayers[a.id]=a.serialize()}var n=i?this._order.indexOf(i):this._order.length;if(i&&-1===n)this.fire(new t.ErrorEvent(new Error('Layer with id "'+i+'" does not exist on this map.')));else{if(this._order.splice(n,0,o),this._layerOrderChanged=!0,this._layers[o]=a,this._removedLayers[o]&&a.source&&"custom"!==a.type){var s=this._removedLayers[o];delete this._removedLayers[o],s.type!==a.type?this._updatedSources[a.source]="clear":(this._updatedSources[a.source]="reload",this.sourceCaches[a.source].pause())}this._updateLayer(a),a.onAdd&&a.onAdd(this.map)}}},i.prototype.moveLayer=function(e,i){if(this._checkLoaded(),this._changed=!0,this._layers[e]){if(e!==i){var r=this._order.indexOf(e);this._order.splice(r,1);var o=i?this._order.indexOf(i):this._order.length;i&&-1===o?this.fire(new t.ErrorEvent(new Error('Layer with id "'+i+'" does not exist on this map.'))):(this._order.splice(o,0,e),this._layerOrderChanged=!0)}}else this.fire(new t.ErrorEvent(new Error("The layer '"+e+"' does not exist in the map's style and cannot be moved.")))},i.prototype.removeLayer=function(e){this._checkLoaded();var i=this._layers[e];if(i){i.setEventedParent(null);var r=this._order.indexOf(e);this._order.splice(r,1),this._layerOrderChanged=!0,this._changed=!0,this._removedLayers[e]=i,delete this._layers[e],delete this._serializedLayers[e],delete this._updatedLayers[e],delete this._updatedPaintProps[e],i.onRemove&&i.onRemove(this.map)}else this.fire(new t.ErrorEvent(new Error("The layer '"+e+"' does not exist in the map's style and cannot be removed.")))},i.prototype.getLayer=function(t){return this._layers[t]},i.prototype.hasLayer=function(t){return t in this._layers},i.prototype.setLayerZoomRange=function(e,i,r){this._checkLoaded();var o=this.getLayer(e);o?o.minzoom===i&&o.maxzoom===r||(null!=i&&(o.minzoom=i),null!=r&&(o.maxzoom=r),this._updateLayer(o)):this.fire(new t.ErrorEvent(new Error("The layer '"+e+"' does not exist in the map's style and cannot have zoom extent.")))},i.prototype.setFilter=function(e,i,r){void 0===r&&(r={}),this._checkLoaded();var o=this.getLayer(e);if(o){if(!t.deepEqual(o.filter,i))return null==i?(o.filter=void 0,void this._updateLayer(o)):void(this._validate(t.validateStyle.filter,"layers."+o.id+".filter",i,null,r)||(o.filter=t.clone$1(i),this._updateLayer(o)))}else this.fire(new t.ErrorEvent(new Error("The layer '"+e+"' does not exist in the map's style and cannot be filtered.")))},i.prototype.getFilter=function(e){return t.clone$1(this.getLayer(e).filter)},i.prototype.setLayoutProperty=function(e,i,r,o){void 0===o&&(o={}),this._checkLoaded();var a=this.getLayer(e);a?t.deepEqual(a.getLayoutProperty(i),r)||(a.setLayoutProperty(i,r,o),this._updateLayer(a)):this.fire(new t.ErrorEvent(new Error("The layer '"+e+"' does not exist in the map's style and cannot be styled.")))},i.prototype.getLayoutProperty=function(e,i){var r=this.getLayer(e);if(r)return r.getLayoutProperty(i);this.fire(new t.ErrorEvent(new Error("The layer '"+e+"' does not exist in the map's style.")))},i.prototype.setPaintProperty=function(e,i,r,o){void 0===o&&(o={}),this._checkLoaded();var a=this.getLayer(e);a?t.deepEqual(a.getPaintProperty(i),r)||(a.setPaintProperty(i,r,o)&&this._updateLayer(a),this._changed=!0,this._updatedPaintProps[e]=!0):this.fire(new t.ErrorEvent(new Error("The layer '"+e+"' does not exist in the map's style and cannot be styled.")))},i.prototype.getPaintProperty=function(t,e){return this.getLayer(t).getPaintProperty(e)},i.prototype.setFeatureState=function(e,i){this._checkLoaded();var r=e.source,o=e.sourceLayer,a=this.sourceCaches[r];if(void 0!==a){var n=a.getSource().type;"geojson"===n&&o?this.fire(new t.ErrorEvent(new Error("GeoJSON sources cannot have a sourceLayer parameter."))):"vector"!==n||o?(void 0===e.id&&this.fire(new t.ErrorEvent(new Error("The feature id parameter must be provided."))),a.setFeatureState(o,e.id,i)):this.fire(new t.ErrorEvent(new Error("The sourceLayer parameter must be provided for vector source types.")))}else this.fire(new t.ErrorEvent(new Error("The source '"+r+"' does not exist in the map's style.")))},i.prototype.removeFeatureState=function(e,i){this._checkLoaded();var r=e.source,o=this.sourceCaches[r];if(void 0!==o){var a=o.getSource().type,n="vector"===a?e.sourceLayer:void 0;"vector"!==a||n?i&&"string"!=typeof e.id&&"number"!=typeof e.id?this.fire(new t.ErrorEvent(new Error("A feature id is requred to remove its specific state property."))):o.removeFeatureState(n,e.id,i):this.fire(new t.ErrorEvent(new Error("The sourceLayer parameter must be provided for vector source types.")))}else this.fire(new t.ErrorEvent(new Error("The source '"+r+"' does not exist in the map's style.")))},i.prototype.getFeatureState=function(e){this._checkLoaded();var i=e.source,r=e.sourceLayer,o=this.sourceCaches[i];if(void 0!==o){if("vector"!==o.getSource().type||r)return void 0===e.id&&this.fire(new t.ErrorEvent(new Error("The feature id parameter must be provided."))),o.getFeatureState(r,e.id);this.fire(new t.ErrorEvent(new Error("The sourceLayer parameter must be provided for vector source types.")))}else this.fire(new t.ErrorEvent(new Error("The source '"+i+"' does not exist in the map's style.")))},i.prototype.getTransition=function(){return t.extend({duration:300,delay:0},this.stylesheet&&this.stylesheet.transition)},i.prototype.serialize=function(){return t.filterObject({version:this.stylesheet.version,name:this.stylesheet.name,metadata:this.stylesheet.metadata,light:this.stylesheet.light,center:this.stylesheet.center,zoom:this.stylesheet.zoom,bearing:this.stylesheet.bearing,pitch:this.stylesheet.pitch,sprite:this.stylesheet.sprite,glyphs:this.stylesheet.glyphs,transition:this.stylesheet.transition,sources:t.mapObject(this.sourceCaches,(function(t){return t.serialize()})),layers:this._serializeLayers(this._order)},(function(t){return void 0!==t}))},i.prototype._updateLayer=function(t){this._updatedLayers[t.id]=!0,t.source&&!this._updatedSources[t.source]&&"raster"!==this.sourceCaches[t.source].getSource().type&&(this._updatedSources[t.source]="reload",this.sourceCaches[t.source].pause()),this._changed=!0},i.prototype._flattenAndSortRenderedFeatures=function(t){for(var e=this,i=function(t){return"fill-extrusion"===e._layers[t].type},r={},o=[],a=this._order.length-1;a>=0;a--){var n=this._order[a];if(i(n)){r[n]=a;for(var s=0,l=t;s<l.length;s+=1){var c=l[s][n];if(c)for(var u=0,h=c;u<h.length;u+=1)o.push(h[u])}}}o.sort((function(t,e){return e.intersectionZ-t.intersectionZ}));for(var p=[],d=this._order.length-1;d>=0;d--){var f=this._order[d];if(i(f))for(var m=o.length-1;m>=0;m--){var y=o[m].feature;if(r[y.layer.id]<d)break;p.push(y),o.pop()}else for(var g=0,v=t;g<v.length;g+=1){var _=v[g][f];if(_)for(var x=0,b=_;x<b.length;x+=1)p.push(b[x].feature)}}return p},i.prototype.queryRenderedFeatures=function(e,i,r){i&&i.filter&&this._validate(t.validateStyle.filter,"queryRenderedFeatures.filter",i.filter,null,i);var o={};if(i&&i.layers){if(!Array.isArray(i.layers))return this.fire(new t.ErrorEvent(new Error("parameters.layers must be an Array."))),[];for(var a=0,n=i.layers;a<n.length;a+=1){var s=n[a],l=this._layers[s];if(!l)return this.fire(new t.ErrorEvent(new Error("The layer '"+s+"' does not exist in the map's style and cannot be queried for features."))),[];o[l.source]=!0}}var c=[];for(var u in i.availableImages=this._availableImages,this.sourceCaches)i.layers&&!o[u]||c.push(B(this.sourceCaches[u],this._layers,this._serializedLayers,e,i,r));return this.placement&&c.push(function(t,e,i,r,o,a,n){for(var s={},l=a.queryRenderedSymbols(r),c=[],u=0,h=Object.keys(l).map(Number);u<h.length;u+=1)c.push(n[h[u]]);c.sort(F);for(var p=function(){var i=f[d],r=i.featureIndex.lookupSymbolFeatures(l[i.bucketInstanceId],e,i.bucketIndex,i.sourceLayerIndex,o.filter,o.layers,o.availableImages,t);for(var a in r){var n=s[a]=s[a]||[],c=r[a];c.sort((function(t,e){var r=i.featureSortOrder;if(r){var o=r.indexOf(t.featureIndex);return r.indexOf(e.featureIndex)-o}return e.featureIndex-t.featureIndex}));for(var u=0,h=c;u<h.length;u+=1)n.push(h[u])}},d=0,f=c;d<f.length;d+=1)p();var m=function(e){s[e].forEach((function(r){var o=r.feature,a=i[t[e].source].getFeatureState(o.layer["source-layer"],o.id);o.source=o.layer.source,o.layer["source-layer"]&&(o.sourceLayer=o.layer["source-layer"]),o.state=a}))};for(var y in s)m(y);return s}(this._layers,this._serializedLayers,this.sourceCaches,e,i,this.placement.collisionIndex,this.placement.retainedQueryData)),this._flattenAndSortRenderedFeatures(c)},i.prototype.querySourceFeatures=function(e,i){i&&i.filter&&this._validate(t.validateStyle.filter,"querySourceFeatures.filter",i.filter,null,i);var r=this.sourceCaches[e];return r?function(t,e){for(var i=t.getRenderableIds().map((function(e){return t.getTileByID(e)})),r=[],o={},a=0;a<i.length;a++){var n=i[a],s=n.tileID.canonical.key;o[s]||(o[s]=!0,n.querySourceFeatures(r,e))}return r}(r,i):[]},i.prototype.addSourceType=function(t,e,r){return i.getSourceType(t)?r(new Error('A source type called "'+t+'" already exists.')):(i.setSourceType(t,e),e.workerSourceURL?void this.dispatcher.broadcast("loadWorkerSource",{name:t,url:e.workerSourceURL},r):r(null,null))},i.prototype.getLight=function(){return this.light.getLight()},i.prototype.setLight=function(e,i){void 0===i&&(i={}),this._checkLoaded();var r=this.light.getLight(),o=!1;for(var a in e)if(!t.deepEqual(e[a],r[a])){o=!0;break}if(o){var n={now:t.browser.now(),transition:t.extend({duration:300,delay:0},this.stylesheet.transition)};this.light.setLight(e,i),this.light.updateTransitions(n)}},i.prototype._validate=function(e,i,r,o,a){return void 0===a&&(a={}),(!a||!1!==a.validate)&&Ue(this,e.call(t.validateStyle,t.extend({key:i,style:this.serialize(),value:r,styleSpec:t.styleSpec},o)))},i.prototype._remove=function(){for(var e in this._request&&(this._request.cancel(),this._request=null),this._spriteRequest&&(this._spriteRequest.cancel(),this._spriteRequest=null),t.evented.off("pluginStateChange",this._rtlTextPluginCallback),this._layers)this._layers[e].setEventedParent(null);for(var i in this.sourceCaches)this.sourceCaches[i].clearTiles(),this.sourceCaches[i].setEventedParent(null);this.imageManager.setEventedParent(null),this.setEventedParent(null),this.dispatcher.remove()},i.prototype._clearSource=function(t){this.sourceCaches[t].clearTiles()},i.prototype._reloadSource=function(t){this.sourceCaches[t].resume(),this.sourceCaches[t].reload()},i.prototype._updateSources=function(t){for(var e in this.sourceCaches)this.sourceCaches[e].update(t)},i.prototype._generateCollisionBoxes=function(){for(var t in this.sourceCaches)this._reloadSource(t)},i.prototype._updatePlacement=function(e,i,r,o,a){void 0===a&&(a=!1);for(var n=!1,s=!1,l={},c=0,u=this._order;c<u.length;c+=1){var h=this._layers[u[c]];if("symbol"===h.type){if(!l[h.source]){var p=this.sourceCaches[h.source];l[h.source]=p.getRenderableIds(!0).map((function(t){return p.getTileByID(t)})).sort((function(t,e){return e.tileID.overscaledZ-t.tileID.overscaledZ||(t.tileID.isLessThan(e.tileID)?-1:1)}))}var d=this.crossTileSymbolIndex.addLayer(h,l[h.source],e.center.lng);n=n||d}}if(this.crossTileSymbolIndex.pruneUnusedLayers(this._order),((a=a||this._layerOrderChanged||0===r)||!this.pauseablePlacement||this.pauseablePlacement.isDone()&&!this.placement.stillRecent(t.browser.now(),e.zoom))&&(this.pauseablePlacement=new Le(e,this._order,a,i,r,o,this.placement),this._layerOrderChanged=!1),this.pauseablePlacement.isDone()?this.placement.setStale():(this.pauseablePlacement.continuePlacement(this._order,this._layers,l),this.pauseablePlacement.isDone()&&(this.placement=this.pauseablePlacement.commit(t.browser.now()),s=!0),n&&this.pauseablePlacement.placement.setStale()),s||n)for(var f=0,m=this._order;f<m.length;f+=1){var y=this._layers[m[f]];"symbol"===y.type&&this.placement.updateLayerOpacities(y,l[y.source])}return!this.pauseablePlacement.isDone()||this.placement.hasTransitions(t.browser.now())},i.prototype._releaseSymbolFadeTiles=function(){for(var t in this.sourceCaches)this.sourceCaches[t].releaseSymbolFadeTiles()},i.prototype.getImages=function(t,e,i){this.imageManager.getImages(e.icons,i),this._updateTilesForChangedImages();var r=this.sourceCaches[e.source];r&&r.setDependencies(e.tileID.key,e.type,e.icons)},i.prototype.getGlyphs=function(t,e,i){this.glyphManager.getGlyphs(e.stacks,i)},i.prototype.getResource=function(e,i,r){return t.makeRequest(i,r)},i}(t.Evented);qe.getSourceType=function(t){return D[t]},qe.setSourceType=function(t,e){D[t]=e},qe.registerForPluginStateChange=t.registerForPluginStateChange;var Ge=t.createLayout([{name:"a_pos",type:"Int16",components:2}]),Ze=vr("#ifdef GL_ES\nprecision mediump float;\n#else\n#if !defined(lowp)\n#define lowp\n#endif\n#if !defined(mediump)\n#define mediump\n#endif\n#if !defined(highp)\n#define highp\n#endif\n#endif","#ifdef GL_ES\nprecision highp float;\n#else\n#if !defined(lowp)\n#define lowp\n#endif\n#if !defined(mediump)\n#define mediump\n#endif\n#if !defined(highp)\n#define highp\n#endif\n#endif\nvec2 unpack_float(const float packedValue) {int packedIntValue=int(packedValue);int v0=packedIntValue/256;return vec2(v0,packedIntValue-v0*256);}vec2 unpack_opacity(const float packedOpacity) {int intOpacity=int(packedOpacity)/2;return vec2(float(intOpacity)/127.0,mod(packedOpacity,2.0));}vec4 decode_color(const vec2 encodedColor) {return vec4(unpack_float(encodedColor[0])/255.0,unpack_float(encodedColor[1])/255.0\n);}float unpack_mix_vec2(const vec2 packedValue,const float t) {return mix(packedValue[0],packedValue[1],t);}vec4 unpack_mix_color(const vec4 packedColors,const float t) {vec4 minColor=decode_color(vec2(packedColors[0],packedColors[1]));vec4 maxColor=decode_color(vec2(packedColors[2],packedColors[3]));return mix(minColor,maxColor,t);}vec2 get_pattern_pos(const vec2 pixel_coord_upper,const vec2 pixel_coord_lower,const vec2 pattern_size,const float tile_units_to_pixels,const vec2 pos) {vec2 offset=mod(mod(mod(pixel_coord_upper,pattern_size)*256.0,pattern_size)*256.0+pixel_coord_lower,pattern_size);return (tile_units_to_pixels*pos+offset)/pattern_size;}"),He=vr("uniform vec4 u_color;uniform float u_opacity;void main() {gl_FragColor=u_color*u_opacity;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","attribute vec2 a_pos;uniform mat4 u_matrix;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);}"),Ke=vr("uniform vec2 u_pattern_tl_a;uniform vec2 u_pattern_br_a;uniform vec2 u_pattern_tl_b;uniform vec2 u_pattern_br_b;uniform vec2 u_texsize;uniform float u_mix;uniform float u_opacity;uniform sampler2D u_image;varying vec2 v_pos_a;varying vec2 v_pos_b;void main() {vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(u_pattern_tl_a/u_texsize,u_pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(u_pattern_tl_b/u_texsize,u_pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);gl_FragColor=mix(color1,color2,u_mix)*u_opacity;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform vec2 u_pattern_size_a;uniform vec2 u_pattern_size_b;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_scale_a;uniform float u_scale_b;uniform float u_tile_units_to_pixels;attribute vec2 a_pos;varying vec2 v_pos_a;varying vec2 v_pos_b;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,u_scale_a*u_pattern_size_a,u_tile_units_to_pixels,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,u_scale_b*u_pattern_size_b,u_tile_units_to_pixels,a_pos);}"),We=vr("varying vec3 v_data;\n#pragma mapbox: define highp vec4 color\n#pragma mapbox: define mediump float radius\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define highp vec4 stroke_color\n#pragma mapbox: define mediump float stroke_width\n#pragma mapbox: define lowp float stroke_opacity\nvoid main() {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize mediump float radius\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize highp vec4 stroke_color\n#pragma mapbox: initialize mediump float stroke_width\n#pragma mapbox: initialize lowp float stroke_opacity\nvec2 extrude=v_data.xy;float extrude_length=length(extrude);lowp float antialiasblur=v_data.z;float antialiased_blur=-max(blur,antialiasblur);float opacity_t=smoothstep(0.0,antialiased_blur,extrude_length-1.0);float color_t=stroke_width < 0.01 ? 0.0 : smoothstep(antialiased_blur,0.0,extrude_length-radius/(radius+stroke_width));gl_FragColor=opacity_t*mix(color*opacity,stroke_color*stroke_opacity,color_t);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform bool u_scale_with_map;uniform bool u_pitch_with_map;uniform vec2 u_extrude_scale;uniform lowp float u_device_pixel_ratio;uniform highp float u_camera_to_center_distance;attribute vec2 a_pos;varying vec3 v_data;\n#pragma mapbox: define highp vec4 color\n#pragma mapbox: define mediump float radius\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define highp vec4 stroke_color\n#pragma mapbox: define mediump float stroke_width\n#pragma mapbox: define lowp float stroke_opacity\nvoid main(void) {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize mediump float radius\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize highp vec4 stroke_color\n#pragma mapbox: initialize mediump float stroke_width\n#pragma mapbox: initialize lowp float stroke_opacity\nvec2 extrude=vec2(mod(a_pos,2.0)*2.0-1.0);vec2 circle_center=floor(a_pos*0.5);if (u_pitch_with_map) {vec2 corner_position=circle_center;if (u_scale_with_map) {corner_position+=extrude*(radius+stroke_width)*u_extrude_scale;} else {vec4 projected_center=u_matrix*vec4(circle_center,0,1);corner_position+=extrude*(radius+stroke_width)*u_extrude_scale*(projected_center.w/u_camera_to_center_distance);}gl_Position=u_matrix*vec4(corner_position,0,1);} else {gl_Position=u_matrix*vec4(circle_center,0,1);if (u_scale_with_map) {gl_Position.xy+=extrude*(radius+stroke_width)*u_extrude_scale*u_camera_to_center_distance;} else {gl_Position.xy+=extrude*(radius+stroke_width)*u_extrude_scale*gl_Position.w;}}lowp float antialiasblur=1.0/u_device_pixel_ratio/(radius+stroke_width);v_data=vec3(extrude.x,extrude.y,antialiasblur);}"),Xe=vr("void main() {gl_FragColor=vec4(1.0);}","attribute vec2 a_pos;uniform mat4 u_matrix;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);}"),$e=vr("uniform highp float u_intensity;varying vec2 v_extrude;\n#pragma mapbox: define highp float weight\n#define GAUSS_COEF 0.3989422804014327\nvoid main() {\n#pragma mapbox: initialize highp float weight\nfloat d=-0.5*3.0*3.0*dot(v_extrude,v_extrude);float val=weight*u_intensity*GAUSS_COEF*exp(d);gl_FragColor=vec4(val,1.0,1.0,1.0);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform float u_extrude_scale;uniform float u_opacity;uniform float u_intensity;attribute vec2 a_pos;varying vec2 v_extrude;\n#pragma mapbox: define highp float weight\n#pragma mapbox: define mediump float radius\nconst highp float ZERO=1.0/255.0/16.0;\n#define GAUSS_COEF 0.3989422804014327\nvoid main(void) {\n#pragma mapbox: initialize highp float weight\n#pragma mapbox: initialize mediump float radius\nvec2 unscaled_extrude=vec2(mod(a_pos,2.0)*2.0-1.0);float S=sqrt(-2.0*log(ZERO/weight/u_intensity/GAUSS_COEF))/3.0;v_extrude=S*unscaled_extrude;vec2 extrude=v_extrude*radius*u_extrude_scale;vec4 pos=vec4(floor(a_pos*0.5)+extrude,0,1);gl_Position=u_matrix*pos;}"),Je=vr("uniform sampler2D u_image;uniform sampler2D u_color_ramp;uniform float u_opacity;varying vec2 v_pos;void main() {float t=texture2D(u_image,v_pos).r;vec4 color=texture2D(u_color_ramp,vec2(t,0.5));gl_FragColor=color*u_opacity;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(0.0);\n#endif\n}","uniform mat4 u_matrix;uniform vec2 u_world;attribute vec2 a_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos*u_world,0,1);v_pos.x=a_pos.x;v_pos.y=1.0-a_pos.y;}"),Ye=vr("varying float v_placed;varying float v_notUsed;void main() {float alpha=0.5;gl_FragColor=vec4(1.0,0.0,0.0,1.0)*alpha;if (v_placed > 0.5) {gl_FragColor=vec4(0.0,0.0,1.0,0.5)*alpha;}if (v_notUsed > 0.5) {gl_FragColor*=.1;}}","attribute vec2 a_pos;attribute vec2 a_anchor_pos;attribute vec2 a_extrude;attribute vec2 a_placed;attribute vec2 a_shift;uniform mat4 u_matrix;uniform vec2 u_extrude_scale;uniform float u_camera_to_center_distance;varying float v_placed;varying float v_notUsed;void main() {vec4 projectedPoint=u_matrix*vec4(a_anchor_pos,0,1);highp float camera_to_anchor_distance=projectedPoint.w;highp float collision_perspective_ratio=clamp(0.5+0.5*(u_camera_to_center_distance/camera_to_anchor_distance),0.0,4.0);gl_Position=u_matrix*vec4(a_pos,0.0,1.0);gl_Position.xy+=(a_extrude+a_shift)*u_extrude_scale*gl_Position.w*collision_perspective_ratio;v_placed=a_placed.x;v_notUsed=a_placed.y;}"),Qe=vr("varying float v_radius;varying vec2 v_extrude;varying float v_perspective_ratio;varying float v_collision;void main() {float alpha=0.5*min(v_perspective_ratio,1.0);float stroke_radius=0.9*max(v_perspective_ratio,1.0);float distance_to_center=length(v_extrude);float distance_to_edge=abs(distance_to_center-v_radius);float opacity_t=smoothstep(-stroke_radius,0.0,-distance_to_edge);vec4 color=mix(vec4(0.0,0.0,1.0,0.5),vec4(1.0,0.0,0.0,1.0),v_collision);gl_FragColor=color*alpha*opacity_t;}","attribute vec2 a_pos;attribute float a_radius;attribute vec2 a_flags;uniform mat4 u_matrix;uniform mat4 u_inv_matrix;uniform vec2 u_viewport_size;uniform float u_camera_to_center_distance;varying float v_radius;varying vec2 v_extrude;varying float v_perspective_ratio;varying float v_collision;vec3 toTilePosition(vec2 screenPos) {vec4 rayStart=u_inv_matrix*vec4(screenPos,-1.0,1.0);vec4 rayEnd  =u_inv_matrix*vec4(screenPos, 1.0,1.0);rayStart.xyz/=rayStart.w;rayEnd.xyz  /=rayEnd.w;highp float t=(0.0-rayStart.z)/(rayEnd.z-rayStart.z);return mix(rayStart.xyz,rayEnd.xyz,t);}void main() {vec2 quadCenterPos=a_pos;float radius=a_radius;float collision=a_flags.x;float vertexIdx=a_flags.y;vec2 quadVertexOffset=vec2(mix(-1.0,1.0,float(vertexIdx >=2.0)),mix(-1.0,1.0,float(vertexIdx >=1.0 && vertexIdx <=2.0)));vec2 quadVertexExtent=quadVertexOffset*radius;vec3 tilePos=toTilePosition(quadCenterPos);vec4 clipPos=u_matrix*vec4(tilePos,1.0);highp float camera_to_anchor_distance=clipPos.w;highp float collision_perspective_ratio=clamp(0.5+0.5*(u_camera_to_center_distance/camera_to_anchor_distance),0.0,4.0);float padding_factor=1.2;v_radius=radius;v_extrude=quadVertexExtent*padding_factor;v_perspective_ratio=collision_perspective_ratio;v_collision=collision;gl_Position=vec4(clipPos.xyz/clipPos.w,1.0)+vec4(quadVertexExtent*padding_factor/u_viewport_size*2.0,0.0,0.0);}"),er=vr("uniform highp vec4 u_color;uniform sampler2D u_overlay;varying vec2 v_uv;void main() {vec4 overlay_color=texture2D(u_overlay,v_uv);gl_FragColor=mix(u_color,overlay_color,overlay_color.a);}","attribute vec2 a_pos;varying vec2 v_uv;uniform mat4 u_matrix;uniform float u_overlay_scale;void main() {v_uv=a_pos/8192.0;gl_Position=u_matrix*vec4(a_pos*u_overlay_scale,0,1);}"),rr=vr("#pragma mapbox: define highp vec4 color\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize lowp float opacity\ngl_FragColor=color*opacity;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","attribute vec2 a_pos;uniform mat4 u_matrix;\n#pragma mapbox: define highp vec4 color\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize lowp float opacity\ngl_Position=u_matrix*vec4(a_pos,0,1);}"),ir=vr("varying vec2 v_pos;\n#pragma mapbox: define highp vec4 outline_color\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize highp vec4 outline_color\n#pragma mapbox: initialize lowp float opacity\nfloat dist=length(v_pos-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);gl_FragColor=outline_color*(alpha*opacity);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","attribute vec2 a_pos;uniform mat4 u_matrix;uniform vec2 u_world;varying vec2 v_pos;\n#pragma mapbox: define highp vec4 outline_color\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize highp vec4 outline_color\n#pragma mapbox: initialize lowp float opacity\ngl_Position=u_matrix*vec4(a_pos,0,1);v_pos=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;}"),or=vr("uniform vec2 u_texsize;uniform sampler2D u_image;uniform float u_fade;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec2 v_pos;\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp vec4 pattern_from\n#pragma mapbox: define lowp vec4 pattern_to\nvoid main() {\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize mediump vec4 pattern_from\n#pragma mapbox: initialize mediump vec4 pattern_to\nvec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);float dist=length(v_pos-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);gl_FragColor=mix(color1,color2,u_fade)*alpha*opacity;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform vec2 u_world;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform vec3 u_scale;attribute vec2 a_pos;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec2 v_pos;\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp vec4 pattern_from\n#pragma mapbox: define lowp vec4 pattern_to\n#pragma mapbox: define lowp float pixel_ratio_from\n#pragma mapbox: define lowp float pixel_ratio_to\nvoid main() {\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize mediump vec4 pattern_from\n#pragma mapbox: initialize mediump vec4 pattern_to\n#pragma mapbox: initialize lowp float pixel_ratio_from\n#pragma mapbox: initialize lowp float pixel_ratio_to\nvec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;gl_Position=u_matrix*vec4(a_pos,0,1);vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileRatio,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileRatio,a_pos);v_pos=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;}"),nr=vr("uniform vec2 u_texsize;uniform float u_fade;uniform sampler2D u_image;varying vec2 v_pos_a;varying vec2 v_pos_b;\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp vec4 pattern_from\n#pragma mapbox: define lowp vec4 pattern_to\nvoid main() {\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize mediump vec4 pattern_from\n#pragma mapbox: initialize mediump vec4 pattern_to\nvec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);gl_FragColor=mix(color1,color2,u_fade)*opacity;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform vec3 u_scale;attribute vec2 a_pos;varying vec2 v_pos_a;varying vec2 v_pos_b;\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp vec4 pattern_from\n#pragma mapbox: define lowp vec4 pattern_to\n#pragma mapbox: define lowp float pixel_ratio_from\n#pragma mapbox: define lowp float pixel_ratio_to\nvoid main() {\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize mediump vec4 pattern_from\n#pragma mapbox: initialize mediump vec4 pattern_to\n#pragma mapbox: initialize lowp float pixel_ratio_from\n#pragma mapbox: initialize lowp float pixel_ratio_to\nvec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileZoomRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;gl_Position=u_matrix*vec4(a_pos,0,1);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileZoomRatio,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileZoomRatio,a_pos);}"),ar=vr("varying vec4 v_color;void main() {gl_FragColor=v_color;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp float u_lightintensity;uniform float u_vertical_gradient;uniform lowp float u_opacity;attribute vec2 a_pos;attribute vec4 a_normal_ed;varying vec4 v_color;\n#pragma mapbox: define highp float base\n#pragma mapbox: define highp float height\n#pragma mapbox: define highp vec4 color\nvoid main() {\n#pragma mapbox: initialize highp float base\n#pragma mapbox: initialize highp float height\n#pragma mapbox: initialize highp vec4 color\nvec3 normal=a_normal_ed.xyz;base=max(0.0,base);height=max(0.0,height);float t=mod(normal.x,2.0);gl_Position=u_matrix*vec4(a_pos,t > 0.0 ? height : base,1);float colorvalue=color.r*0.2126+color.g*0.7152+color.b*0.0722;v_color=vec4(0.0,0.0,0.0,1.0);vec4 ambientlight=vec4(0.03,0.03,0.03,1.0);color+=ambientlight;float directional=clamp(dot(normal/16384.0,u_lightpos),0.0,1.0);directional=mix((1.0-u_lightintensity),max((1.0-colorvalue+u_lightintensity),1.0),directional);if (normal.y !=0.0) {directional*=((1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),mix(0.7,0.98,1.0-u_lightintensity),1.0)));}v_color.r+=clamp(color.r*directional*u_lightcolor.r,mix(0.0,0.3,1.0-u_lightcolor.r),1.0);v_color.g+=clamp(color.g*directional*u_lightcolor.g,mix(0.0,0.3,1.0-u_lightcolor.g),1.0);v_color.b+=clamp(color.b*directional*u_lightcolor.b,mix(0.0,0.3,1.0-u_lightcolor.b),1.0);v_color*=u_opacity;}"),sr=vr("uniform vec2 u_texsize;uniform float u_fade;uniform sampler2D u_image;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec4 v_lighting;\n#pragma mapbox: define lowp float base\n#pragma mapbox: define lowp float height\n#pragma mapbox: define lowp vec4 pattern_from\n#pragma mapbox: define lowp vec4 pattern_to\n#pragma mapbox: define lowp float pixel_ratio_from\n#pragma mapbox: define lowp float pixel_ratio_to\nvoid main() {\n#pragma mapbox: initialize lowp float base\n#pragma mapbox: initialize lowp float height\n#pragma mapbox: initialize mediump vec4 pattern_from\n#pragma mapbox: initialize mediump vec4 pattern_to\n#pragma mapbox: initialize lowp float pixel_ratio_from\n#pragma mapbox: initialize lowp float pixel_ratio_to\nvec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);vec4 mixedColor=mix(color1,color2,u_fade);gl_FragColor=mixedColor*v_lighting;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_height_factor;uniform vec3 u_scale;uniform float u_vertical_gradient;uniform lowp float u_opacity;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp float u_lightintensity;attribute vec2 a_pos;attribute vec4 a_normal_ed;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec4 v_lighting;\n#pragma mapbox: define lowp float base\n#pragma mapbox: define lowp float height\n#pragma mapbox: define lowp vec4 pattern_from\n#pragma mapbox: define lowp vec4 pattern_to\n#pragma mapbox: define lowp float pixel_ratio_from\n#pragma mapbox: define lowp float pixel_ratio_to\nvoid main() {\n#pragma mapbox: initialize lowp float base\n#pragma mapbox: initialize lowp float height\n#pragma mapbox: initialize mediump vec4 pattern_from\n#pragma mapbox: initialize mediump vec4 pattern_to\n#pragma mapbox: initialize lowp float pixel_ratio_from\n#pragma mapbox: initialize lowp float pixel_ratio_to\nvec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec3 normal=a_normal_ed.xyz;float edgedistance=a_normal_ed.w;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;base=max(0.0,base);height=max(0.0,height);float t=mod(normal.x,2.0);float z=t > 0.0 ? height : base;gl_Position=u_matrix*vec4(a_pos,z,1);vec2 pos=normal.x==1.0 && normal.y==0.0 && normal.z==16384.0\n? a_pos\n: vec2(edgedistance,z*u_height_factor);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileRatio,pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileRatio,pos);v_lighting=vec4(0.0,0.0,0.0,1.0);float directional=clamp(dot(normal/16383.0,u_lightpos),0.0,1.0);directional=mix((1.0-u_lightintensity),max((0.5+u_lightintensity),1.0),directional);if (normal.y !=0.0) {directional*=((1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),mix(0.7,0.98,1.0-u_lightintensity),1.0)));}v_lighting.rgb+=clamp(directional*u_lightcolor,mix(vec3(0.0),vec3(0.3),1.0-u_lightcolor),vec3(1.0));v_lighting*=u_opacity;}"),lr=vr("#ifdef GL_ES\nprecision highp float;\n#endif\nuniform sampler2D u_image;varying vec2 v_pos;uniform vec2 u_dimension;uniform float u_zoom;uniform float u_maxzoom;uniform vec4 u_unpack;float getElevation(vec2 coord,float bias) {vec4 data=texture2D(u_image,coord)*255.0;data.a=-1.0;return dot(data,u_unpack)/4.0;}void main() {vec2 epsilon=1.0/u_dimension;float a=getElevation(v_pos+vec2(-epsilon.x,-epsilon.y),0.0);float b=getElevation(v_pos+vec2(0,-epsilon.y),0.0);float c=getElevation(v_pos+vec2(epsilon.x,-epsilon.y),0.0);float d=getElevation(v_pos+vec2(-epsilon.x,0),0.0);float e=getElevation(v_pos,0.0);float f=getElevation(v_pos+vec2(epsilon.x,0),0.0);float g=getElevation(v_pos+vec2(-epsilon.x,epsilon.y),0.0);float h=getElevation(v_pos+vec2(0,epsilon.y),0.0);float i=getElevation(v_pos+vec2(epsilon.x,epsilon.y),0.0);float exaggeration=u_zoom < 2.0 ? 0.4 : u_zoom < 4.5 ? 0.35 : 0.3;vec2 deriv=vec2((c+f+f+i)-(a+d+d+g),(g+h+h+i)-(a+b+b+c))/ pow(2.0,(u_zoom-u_maxzoom)*exaggeration+19.2562-u_zoom);gl_FragColor=clamp(vec4(deriv.x/2.0+0.5,deriv.y/2.0+0.5,1.0,1.0),0.0,1.0);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform vec2 u_dimension;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);highp vec2 epsilon=1.0/u_dimension;float scale=(u_dimension.x-2.0)/u_dimension.x;v_pos=(a_texture_pos/8192.0)*scale+epsilon;}"),li=vr("uniform sampler2D u_image;varying vec2 v_pos;uniform vec2 u_latrange;uniform vec2 u_light;uniform vec4 u_shadow;uniform vec4 u_highlight;uniform vec4 u_accent;\n#define PI 3.141592653589793\nvoid main() {vec4 pixel=texture2D(u_image,v_pos);vec2 deriv=((pixel.rg*2.0)-1.0);float scaleFactor=cos(radians((u_latrange[0]-u_latrange[1])*(1.0-v_pos.y)+u_latrange[1]));float slope=atan(1.25*length(deriv)/scaleFactor);float aspect=deriv.x !=0.0 ? atan(deriv.y,-deriv.x) : PI/2.0*(deriv.y > 0.0 ? 1.0 :-1.0);float intensity=u_light.x;float azimuth=u_light.y+PI;float base=1.875-intensity*1.75;float maxValue=0.5*PI;float scaledSlope=intensity !=0.5 ? ((pow(base,slope)-1.0)/(pow(base,maxValue)-1.0))*maxValue : slope;float accent=cos(scaledSlope);vec4 accent_color=(1.0-accent)*u_accent*clamp(intensity*2.0,0.0,1.0);float shade=abs(mod((aspect+azimuth)/PI+0.5,2.0)-1.0);vec4 shade_color=mix(u_shadow,u_highlight,shade)*sin(scaledSlope)*clamp(intensity*2.0,0.0,1.0);gl_FragColor=accent_color*(1.0-shade_color.a)+shade_color;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=a_texture_pos/8192.0;}"),ur=vr("uniform lowp float u_device_pixel_ratio;varying vec2 v_width2;varying vec2 v_normal;varying float v_gamma_scale;\n#pragma mapbox: define highp vec4 color\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\nfloat dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);gl_FragColor=color*(alpha*opacity);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","\n#define scale 0.015873016\nattribute vec2 a_pos_normal;attribute vec4 a_data;uniform mat4 u_matrix;uniform mediump float u_ratio;uniform vec2 u_units_to_pixels;uniform lowp float u_device_pixel_ratio;varying vec2 v_normal;varying vec2 v_width2;varying float v_gamma_scale;varying highp float v_linesofar;\n#pragma mapbox: define highp vec4 color\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define mediump float gapwidth\n#pragma mapbox: define lowp float offset\n#pragma mapbox: define mediump float width\nvoid main() {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize mediump float gapwidth\n#pragma mapbox: initialize lowp float offset\n#pragma mapbox: initialize mediump float width\nfloat ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;v_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*2.0;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;v_width2=vec2(outset,inset);}"),cr=vr("uniform lowp float u_device_pixel_ratio;uniform sampler2D u_image;varying vec2 v_width2;varying vec2 v_normal;varying float v_gamma_scale;varying highp float v_lineprogress;\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\nfloat dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);vec4 color=texture2D(u_image,vec2(v_lineprogress,0.5));gl_FragColor=color*(alpha*opacity);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","\n#define MAX_LINE_DISTANCE 32767.0\n#define scale 0.015873016\nattribute vec2 a_pos_normal;attribute vec4 a_data;uniform mat4 u_matrix;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;uniform vec2 u_units_to_pixels;varying vec2 v_normal;varying vec2 v_width2;varying float v_gamma_scale;varying highp float v_lineprogress;\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define mediump float gapwidth\n#pragma mapbox: define lowp float offset\n#pragma mapbox: define mediump float width\nvoid main() {\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize mediump float gapwidth\n#pragma mapbox: initialize lowp float offset\n#pragma mapbox: initialize mediump float width\nfloat ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;v_lineprogress=(floor(a_data.z/4.0)+a_data.w*64.0)*2.0/MAX_LINE_DISTANCE;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;v_width2=vec2(outset,inset);}"),pr=vr("uniform lowp float u_device_pixel_ratio;uniform vec2 u_texsize;uniform float u_fade;uniform mediump vec3 u_scale;uniform sampler2D u_image;varying vec2 v_normal;varying vec2 v_width2;varying float v_linesofar;varying float v_gamma_scale;varying float v_width;\n#pragma mapbox: define lowp vec4 pattern_from\n#pragma mapbox: define lowp vec4 pattern_to\n#pragma mapbox: define lowp float pixel_ratio_from\n#pragma mapbox: define lowp float pixel_ratio_to\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize mediump vec4 pattern_from\n#pragma mapbox: initialize mediump vec4 pattern_to\n#pragma mapbox: initialize lowp float pixel_ratio_from\n#pragma mapbox: initialize lowp float pixel_ratio_to\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\nvec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileZoomRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;vec2 pattern_size_a=vec2(display_size_a.x*fromScale/tileZoomRatio,display_size_a.y);vec2 pattern_size_b=vec2(display_size_b.x*toScale/tileZoomRatio,display_size_b.y);float aspect_a=display_size_a.y/v_width;float aspect_b=display_size_b.y/v_width;float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);float x_a=mod(v_linesofar/pattern_size_a.x*aspect_a,1.0);float x_b=mod(v_linesofar/pattern_size_b.x*aspect_b,1.0);float y=0.5*v_normal.y+0.5;vec2 texel_size=1.0/u_texsize;vec2 pos_a=mix(pattern_tl_a*texel_size-texel_size,pattern_br_a*texel_size+texel_size,vec2(x_a,y));vec2 pos_b=mix(pattern_tl_b*texel_size-texel_size,pattern_br_b*texel_size+texel_size,vec2(x_b,y));vec4 color=mix(texture2D(u_image,pos_a),texture2D(u_image,pos_b),u_fade);gl_FragColor=color*alpha*opacity;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","\n#define scale 0.015873016\n#define LINE_DISTANCE_SCALE 2.0\nattribute vec2 a_pos_normal;attribute vec4 a_data;uniform mat4 u_matrix;uniform vec2 u_units_to_pixels;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;varying vec2 v_normal;varying vec2 v_width2;varying float v_linesofar;varying float v_gamma_scale;varying float v_width;\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp float offset\n#pragma mapbox: define mediump float gapwidth\n#pragma mapbox: define mediump float width\n#pragma mapbox: define lowp float floorwidth\n#pragma mapbox: define lowp vec4 pattern_from\n#pragma mapbox: define lowp vec4 pattern_to\n#pragma mapbox: define lowp float pixel_ratio_from\n#pragma mapbox: define lowp float pixel_ratio_to\nvoid main() {\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize lowp float offset\n#pragma mapbox: initialize mediump float gapwidth\n#pragma mapbox: initialize mediump float width\n#pragma mapbox: initialize lowp float floorwidth\n#pragma mapbox: initialize mediump vec4 pattern_from\n#pragma mapbox: initialize mediump vec4 pattern_to\n#pragma mapbox: initialize lowp float pixel_ratio_from\n#pragma mapbox: initialize lowp float pixel_ratio_to\nfloat ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;float a_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*LINE_DISTANCE_SCALE;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;v_linesofar=a_linesofar;v_width2=vec2(outset,inset);v_width=floorwidth;}"),dr=vr("uniform lowp float u_device_pixel_ratio;uniform sampler2D u_image;uniform float u_sdfgamma;uniform float u_mix;varying vec2 v_normal;varying vec2 v_width2;varying vec2 v_tex_a;varying vec2 v_tex_b;varying float v_gamma_scale;\n#pragma mapbox: define highp vec4 color\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define mediump float width\n#pragma mapbox: define lowp float floorwidth\nvoid main() {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize mediump float width\n#pragma mapbox: initialize lowp float floorwidth\nfloat dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);float sdfdist_a=texture2D(u_image,v_tex_a).a;float sdfdist_b=texture2D(u_image,v_tex_b).a;float sdfdist=mix(sdfdist_a,sdfdist_b,u_mix);alpha*=smoothstep(0.5-u_sdfgamma/floorwidth,0.5+u_sdfgamma/floorwidth,sdfdist);gl_FragColor=color*(alpha*opacity);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","\n#define scale 0.015873016\n#define LINE_DISTANCE_SCALE 2.0\nattribute vec2 a_pos_normal;attribute vec4 a_data;uniform mat4 u_matrix;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;uniform vec2 u_patternscale_a;uniform float u_tex_y_a;uniform vec2 u_patternscale_b;uniform float u_tex_y_b;uniform vec2 u_units_to_pixels;varying vec2 v_normal;varying vec2 v_width2;varying vec2 v_tex_a;varying vec2 v_tex_b;varying float v_gamma_scale;\n#pragma mapbox: define highp vec4 color\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define mediump float gapwidth\n#pragma mapbox: define lowp float offset\n#pragma mapbox: define mediump float width\n#pragma mapbox: define lowp float floorwidth\nvoid main() {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize mediump float gapwidth\n#pragma mapbox: initialize lowp float offset\n#pragma mapbox: initialize mediump float width\n#pragma mapbox: initialize lowp float floorwidth\nfloat ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;float a_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*LINE_DISTANCE_SCALE;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;v_tex_a=vec2(a_linesofar*u_patternscale_a.x/floorwidth,normal.y*u_patternscale_a.y+u_tex_y_a);v_tex_b=vec2(a_linesofar*u_patternscale_b.x/floorwidth,normal.y*u_patternscale_b.y+u_tex_y_b);v_width2=vec2(outset,inset);}"),fr=vr("uniform float u_fade_t;uniform float u_opacity;uniform sampler2D u_image0;uniform sampler2D u_image1;varying vec2 v_pos0;varying vec2 v_pos1;uniform float u_brightness_low;uniform float u_brightness_high;uniform float u_saturation_factor;uniform float u_contrast_factor;uniform vec3 u_spin_weights;void main() {vec4 color0=texture2D(u_image0,v_pos0);vec4 color1=texture2D(u_image1,v_pos1);if (color0.a > 0.0) {color0.rgb=color0.rgb/color0.a;}if (color1.a > 0.0) {color1.rgb=color1.rgb/color1.a;}vec4 color=mix(color0,color1,u_fade_t);color.a*=u_opacity;vec3 rgb=color.rgb;rgb=vec3(dot(rgb,u_spin_weights.xyz),dot(rgb,u_spin_weights.zxy),dot(rgb,u_spin_weights.yzx));float average=(color.r+color.g+color.b)/3.0;rgb+=(average-rgb)*u_saturation_factor;rgb=(rgb-0.5)*u_contrast_factor+0.5;vec3 u_high_vec=vec3(u_brightness_low,u_brightness_low,u_brightness_low);vec3 u_low_vec=vec3(u_brightness_high,u_brightness_high,u_brightness_high);gl_FragColor=vec4(mix(u_high_vec,u_low_vec,rgb)*color.a,color.a);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform vec2 u_tl_parent;uniform float u_scale_parent;uniform float u_buffer_scale;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos0;varying vec2 v_pos1;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos0=(((a_texture_pos/8192.0)-0.5)/u_buffer_scale )+0.5;v_pos1=(v_pos0*u_scale_parent)+u_tl_parent;}"),mr=vr("uniform sampler2D u_texture;varying vec2 v_tex;varying float v_fade_opacity;\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize lowp float opacity\nlowp float alpha=opacity*v_fade_opacity;gl_FragColor=texture2D(u_texture,v_tex)*alpha;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","const float PI=3.141592653589793;attribute vec4 a_pos_offset;attribute vec4 a_data;attribute vec4 a_pixeloffset;attribute vec3 a_projected_pos;attribute float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform highp float u_camera_to_center_distance;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform float u_fade_change;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform vec2 u_texsize;varying vec2 v_tex;varying float v_fade_opacity;\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize lowp float opacity\nvec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;vec2 a_minFontScale=a_pixeloffset.zw/256.0;highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec4 projectedPoint=u_matrix*vec4(a_pos,0,1);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?\ncamera_to_anchor_distance/u_camera_to_center_distance :\nu_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=u_matrix*vec4(a_pos+vec2(1,0),0,1);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,0.0,1.0);gl_Position=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*max(a_minFontScale,fontScale)+a_pxoffset/16.0),0.0,1.0);v_tex=a_tex/u_texsize;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;v_fade_opacity=max(0.0,min(1.0,fade_opacity[0]+fade_change));}"),gr=vr("#define SDF_PX 8.0\nuniform bool u_is_halo;uniform sampler2D u_texture;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;uniform bool u_is_text;varying vec2 v_data0;varying vec3 v_data1;\n#pragma mapbox: define highp vec4 fill_color\n#pragma mapbox: define highp vec4 halo_color\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp float halo_width\n#pragma mapbox: define lowp float halo_blur\nvoid main() {\n#pragma mapbox: initialize highp vec4 fill_color\n#pragma mapbox: initialize highp vec4 halo_color\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize lowp float halo_width\n#pragma mapbox: initialize lowp float halo_blur\nfloat EDGE_GAMMA=0.105/u_device_pixel_ratio;vec2 tex=v_data0.xy;float gamma_scale=v_data1.x;float size=v_data1.y;float fade_opacity=v_data1[2];float fontScale=u_is_text ? size/24.0 : size;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float buff=(256.0-64.0)/256.0;if (u_is_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);buff=(6.0-halo_width/fontScale)/SDF_PX;}lowp float dist=texture2D(u_texture,tex).a;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(buff-gamma_scaled,buff+gamma_scaled,dist);gl_FragColor=color*(alpha*opacity*fade_opacity);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","const float PI=3.141592653589793;attribute vec4 a_pos_offset;attribute vec4 a_data;attribute vec4 a_pixeloffset;attribute vec3 a_projected_pos;attribute float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;varying vec2 v_data0;varying vec3 v_data1;\n#pragma mapbox: define highp vec4 fill_color\n#pragma mapbox: define highp vec4 halo_color\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp float halo_width\n#pragma mapbox: define lowp float halo_blur\nvoid main() {\n#pragma mapbox: initialize highp vec4 fill_color\n#pragma mapbox: initialize highp vec4 halo_color\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize lowp float halo_width\n#pragma mapbox: initialize lowp float halo_blur\nvec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec4 projectedPoint=u_matrix*vec4(a_pos,0,1);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?\ncamera_to_anchor_distance/u_camera_to_center_distance :\nu_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=u_matrix*vec4(a_pos+vec2(1,0),0,1);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,0.0,1.0);gl_Position=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*fontScale+a_pxoffset),0.0,1.0);float gamma_scale=gl_Position.w;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(1.0,fade_opacity[0]+fade_change));v_data0=a_tex/u_texsize;v_data1=vec3(gamma_scale,size,interpolated_fade_opacity);}"),yr=vr("#define SDF_PX 8.0\n#define SDF 1.0\n#define ICON 0.0\nuniform bool u_is_halo;uniform sampler2D u_texture;uniform sampler2D u_texture_icon;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;varying vec4 v_data0;varying vec4 v_data1;\n#pragma mapbox: define highp vec4 fill_color\n#pragma mapbox: define highp vec4 halo_color\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp float halo_width\n#pragma mapbox: define lowp float halo_blur\nvoid main() {\n#pragma mapbox: initialize highp vec4 fill_color\n#pragma mapbox: initialize highp vec4 halo_color\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize lowp float halo_width\n#pragma mapbox: initialize lowp float halo_blur\nfloat fade_opacity=v_data1[2];if (v_data1.w==ICON) {vec2 tex_icon=v_data0.zw;lowp float alpha=opacity*fade_opacity;gl_FragColor=texture2D(u_texture_icon,tex_icon)*alpha;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\nreturn;}vec2 tex=v_data0.xy;float EDGE_GAMMA=0.105/u_device_pixel_ratio;float gamma_scale=v_data1.x;float size=v_data1.y;float fontScale=size/24.0;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float buff=(256.0-64.0)/256.0;if (u_is_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);buff=(6.0-halo_width/fontScale)/SDF_PX;}lowp float dist=texture2D(u_texture,tex).a;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(buff-gamma_scaled,buff+gamma_scaled,dist);gl_FragColor=color*(alpha*opacity*fade_opacity);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","const float PI=3.141592653589793;attribute vec4 a_pos_offset;attribute vec4 a_data;attribute vec3 a_projected_pos;attribute float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;uniform vec2 u_texsize_icon;varying vec4 v_data0;varying vec4 v_data1;\n#pragma mapbox: define highp vec4 fill_color\n#pragma mapbox: define highp vec4 halo_color\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp float halo_width\n#pragma mapbox: define lowp float halo_blur\nvoid main() {\n#pragma mapbox: initialize highp vec4 fill_color\n#pragma mapbox: initialize highp vec4 halo_color\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize lowp float halo_width\n#pragma mapbox: initialize lowp float halo_blur\nvec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);float is_sdf=a_size[0]-2.0*a_size_min;highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec4 projectedPoint=u_matrix*vec4(a_pos,0,1);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?\ncamera_to_anchor_distance/u_camera_to_center_distance :\nu_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=size/24.0;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=u_matrix*vec4(a_pos+vec2(1,0),0,1);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,0.0,1.0);gl_Position=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*fontScale),0.0,1.0);float gamma_scale=gl_Position.w;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(1.0,fade_opacity[0]+fade_change));v_data0.xy=a_tex/u_texsize;v_data0.zw=a_tex/u_texsize_icon;v_data1=vec4(gamma_scale,size,interpolated_fade_opacity,is_sdf);}");function vr(t,e){var i=/#pragma mapbox: ([\w]+) ([\w]+) ([\w]+) ([\w]+)/g,r=e.match(/attribute ([\w]+) ([\w]+)/g),o=t.match(/uniform ([\w]+) ([\w]+)([\s]*)([\w]*)/g),a=e.match(/uniform ([\w]+) ([\w]+)([\s]*)([\w]*)/g),n=a?a.concat(o):o,s={};return{fragmentSource:t=t.replace(i,(function(t,e,i,r,o){return s[o]=!0,"define"===e?"\n#ifndef HAS_UNIFORM_u_"+o+"\nvarying "+i+" "+r+" "+o+";\n#else\nuniform "+i+" "+r+" u_"+o+";\n#endif\n":"\n#ifdef HAS_UNIFORM_u_"+o+"\n    "+i+" "+r+" "+o+" = u_"+o+";\n#endif\n"})),vertexSource:e=e.replace(i,(function(t,e,i,r,o){var a="float"===r?"vec2":"vec4",n=o.match(/color/)?"color":a;return s[o]?"define"===e?"\n#ifndef HAS_UNIFORM_u_"+o+"\nuniform lowp float u_"+o+"_t;\nattribute "+i+" "+a+" a_"+o+";\nvarying "+i+" "+r+" "+o+";\n#else\nuniform "+i+" "+r+" u_"+o+";\n#endif\n":"vec4"===n?"\n#ifndef HAS_UNIFORM_u_"+o+"\n    "+o+" = a_"+o+";\n#else\n    "+i+" "+r+" "+o+" = u_"+o+";\n#endif\n":"\n#ifndef HAS_UNIFORM_u_"+o+"\n    "+o+" = unpack_mix_"+n+"(a_"+o+", u_"+o+"_t);\n#else\n    "+i+" "+r+" "+o+" = u_"+o+";\n#endif\n":"define"===e?"\n#ifndef HAS_UNIFORM_u_"+o+"\nuniform lowp float u_"+o+"_t;\nattribute "+i+" "+a+" a_"+o+";\n#else\nuniform "+i+" "+r+" u_"+o+";\n#endif\n":"vec4"===n?"\n#ifndef HAS_UNIFORM_u_"+o+"\n    "+i+" "+r+" "+o+" = a_"+o+";\n#else\n    "+i+" "+r+" "+o+" = u_"+o+";\n#endif\n":"\n#ifndef HAS_UNIFORM_u_"+o+"\n    "+i+" "+r+" "+o+" = unpack_mix_"+n+"(a_"+o+", u_"+o+"_t);\n#else\n    "+i+" "+r+" "+o+" = u_"+o+";\n#endif\n"})),staticAttributes:r,staticUniforms:n}}var _r=Object.freeze({__proto__:null,prelude:Ze,background:He,backgroundPattern:Ke,circle:We,clippingMask:Xe,heatmap:$e,heatmapTexture:Je,collisionBox:Ye,collisionCircle:Qe,debug:er,fill:rr,fillOutline:ir,fillOutlinePattern:or,fillPattern:nr,fillExtrusion:ar,fillExtrusionPattern:sr,hillshadePrepare:lr,hillshade:li,line:ur,lineGradient:cr,linePattern:pr,lineSDF:dr,raster:fr,symbolIcon:mr,symbolSDF:gr,symbolTextAndIcon:yr}),xr=function(){this.boundProgram=null,this.boundLayoutVertexBuffer=null,this.boundPaintVertexBuffers=[],this.boundIndexBuffer=null,this.boundVertexOffset=null,this.boundDynamicVertexBuffer=null,this.vao=null};function wr(t){for(var e=[],i=0;i<t.length;i++)if(null!==t[i]){var r=t[i].split(" ");e.push(r.pop())}return e}xr.prototype.bind=function(t,e,i,r,o,a,n,s){this.context=t;for(var l=this.boundPaintVertexBuffers.length!==r.length,c=0;!l&&c<r.length;c++)this.boundPaintVertexBuffers[c]!==r[c]&&(l=!0);t.extVertexArrayObject&&this.vao&&this.boundProgram===e&&this.boundLayoutVertexBuffer===i&&!l&&this.boundIndexBuffer===o&&this.boundVertexOffset===a&&this.boundDynamicVertexBuffer===n&&this.boundDynamicVertexBuffer2===s?(t.bindVertexArrayOES.set(this.vao),n&&n.bind(),o&&o.dynamicDraw&&o.bind(),s&&s.bind()):this.freshBind(e,i,r,o,a,n,s)},xr.prototype.freshBind=function(t,e,i,r,o,a,n){var s,l=t.numAttributes,c=this.context,u=c.gl;if(c.extVertexArrayObject)this.vao&&this.destroy(),this.vao=c.extVertexArrayObject.createVertexArrayOES(),c.bindVertexArrayOES.set(this.vao),s=0,this.boundProgram=t,this.boundLayoutVertexBuffer=e,this.boundPaintVertexBuffers=i,this.boundIndexBuffer=r,this.boundVertexOffset=o,this.boundDynamicVertexBuffer=a,this.boundDynamicVertexBuffer2=n;else{s=c.currentNumAttributes||0;for(var h=l;h<s;h++)u.disableVertexAttribArray(h)}e.enableAttributes(u,t);for(var p=0,d=i;p<d.length;p+=1)d[p].enableAttributes(u,t);a&&a.enableAttributes(u,t),n&&n.enableAttributes(u,t),e.bind(),e.setVertexAttribPointers(u,t,o);for(var f=0,m=i;f<m.length;f+=1){var y=m[f];y.bind(),y.setVertexAttribPointers(u,t,o)}a&&(a.bind(),a.setVertexAttribPointers(u,t,o)),r&&r.bind(),n&&(n.bind(),n.setVertexAttribPointers(u,t,o)),c.currentNumAttributes=l},xr.prototype.destroy=function(){this.vao&&(this.context.extVertexArrayObject.deleteVertexArrayOES(this.vao),this.vao=null)};var Er=function(t,e,i,r,o,a){var n=t.gl;this.program=n.createProgram();for(var s=wr(i.staticAttributes),l=r?r.getBinderAttributes():[],c=s.concat(l),u=i.staticUniforms?wr(i.staticUniforms):[],h=r?r.getBinderUniforms():[],p=[],d=0,f=u.concat(h);d<f.length;d+=1){var m=f[d];p.indexOf(m)<0&&p.push(m)}var y=r?r.defines():[];a&&y.push("#define OVERDRAW_INSPECTOR;");var g=y.concat(Ze.fragmentSource,i.fragmentSource).join("\n"),v=y.concat(Ze.vertexSource,i.vertexSource).join("\n"),_=n.createShader(n.FRAGMENT_SHADER);if(n.isContextLost())this.failedToCreate=!0;else{n.shaderSource(_,g),n.compileShader(_),n.attachShader(this.program,_);var x=n.createShader(n.VERTEX_SHADER);if(n.isContextLost())this.failedToCreate=!0;else{n.shaderSource(x,v),n.compileShader(x),n.attachShader(this.program,x),this.attributes={};var b={};this.numAttributes=c.length;for(var w=0;w<this.numAttributes;w++)c[w]&&(n.bindAttribLocation(this.program,w,c[w]),this.attributes[c[w]]=w);n.linkProgram(this.program),n.deleteShader(x),n.deleteShader(_);for(var E=0;E<p.length;E++){var k=p[E];if(k&&!b[k]){var S=n.getUniformLocation(this.program,k);S&&(b[k]=S)}}this.fixedUniforms=o(t,b),this.binderUniforms=r?r.getUniforms(t,b):[]}}};function kr(t,e,i){var r=1/he(i,1,e.transform.tileZoom),o=Math.pow(2,i.tileID.overscaledZ),a=i.tileSize*Math.pow(2,e.transform.tileZoom)/o,n=a*(i.tileID.canonical.x+i.tileID.wrap*o),s=a*i.tileID.canonical.y;return{u_image:0,u_texsize:i.imageAtlasTexture.size,u_scale:[r,t.fromScale,t.toScale],u_fade:t.t,u_pixel_coord_upper:[n>>16,s>>16],u_pixel_coord_lower:[65535&n,65535&s]}}Er.prototype.draw=function(t,e,i,r,o,a,n,s,l,c,u,h,p,d,f,m){var y,g=t.gl;if(!this.failedToCreate){for(var v in t.program.set(this.program),t.setDepthMode(i),t.setStencilMode(r),t.setColorMode(o),t.setCullFace(a),this.fixedUniforms)this.fixedUniforms[v].set(n[v]);d&&d.setUniforms(t,this.binderUniforms,h,{zoom:p});for(var _=(y={},y[g.LINES]=2,y[g.TRIANGLES]=3,y[g.LINE_STRIP]=1,y)[e],x=0,b=u.get();x<b.length;x+=1){var w=b[x],E=w.vaos||(w.vaos={});(E[s]||(E[s]=new xr)).bind(t,this,l,d?d.getPaintVertexBuffers():[],c,w.vertexOffset,f,m),g.drawElements(e,w.primitiveLength*_,g.UNSIGNED_SHORT,w.primitiveOffset*_*2)}}};var Sr=function(e,i,r,o){var a=i.style.light,n=a.properties.get("position"),s=[n.x,n.y,n.z],l=t.create$1();"viewport"===a.properties.get("anchor")&&t.fromRotation(l,-i.transform.angle),t.transformMat3(s,s,l);var c=a.properties.get("color");return{u_matrix:e,u_lightpos:s,u_lightintensity:a.properties.get("intensity"),u_lightcolor:[c.r,c.g,c.b],u_vertical_gradient:+r,u_opacity:o}},Tr=function(e,i,r,o,a,n,s){return t.extend(Sr(e,i,r,o),kr(n,i,s),{u_height_factor:-Math.pow(2,a.overscaledZ)/s.tileSize/8})},Ir=function(t){return{u_matrix:t}},zr=function(e,i,r,o){return t.extend(Ir(e),kr(r,i,o))},Cr=function(t,e){return{u_matrix:t,u_world:e}},Pr=function(e,i,r,o,a){return t.extend(zr(e,i,r,o),{u_world:a})},Ar=function(e,i,r,o){var a,n,s=e.transform;if("map"===o.paint.get("circle-pitch-alignment")){var l=he(r,1,s.zoom);a=!0,n=[l,l]}else a=!1,n=s.pixelsToGLUnits;return{u_camera_to_center_distance:s.cameraToCenterDistance,u_scale_with_map:+("map"===o.paint.get("circle-pitch-scale")),u_matrix:e.translatePosMatrix(i.posMatrix,r,o.paint.get("circle-translate"),o.paint.get("circle-translate-anchor")),u_pitch_with_map:+a,u_device_pixel_ratio:t.browser.devicePixelRatio,u_extrude_scale:n}},Mr=function(t,e,i){var r=he(i,1,e.zoom),o=Math.pow(2,e.zoom-i.tileID.overscaledZ),a=i.tileID.overscaleFactor();return{u_matrix:t,u_camera_to_center_distance:e.cameraToCenterDistance,u_pixels_to_tile_units:r,u_extrude_scale:[e.pixelsToGLUnits[0]/(r*o),e.pixelsToGLUnits[1]/(r*o)],u_overscale_factor:a}},Lr=function(t,e,i){return{u_matrix:t,u_inv_matrix:e,u_camera_to_center_distance:i.cameraToCenterDistance,u_viewport_size:[i.width,i.height]}},Rr=function(t,e,i){return void 0===i&&(i=1),{u_matrix:t,u_color:e,u_overlay:0,u_overlay_scale:i}},Dr=function(t){return{u_matrix:t}},Or=function(t,e,i,r){return{u_matrix:t,u_extrude_scale:he(e,1,i),u_intensity:r}},Br=function(e,i,r){var o=e.transform;return{u_matrix:Vr(e,i,r),u_ratio:1/he(i,1,o.zoom),u_device_pixel_ratio:t.browser.devicePixelRatio,u_units_to_pixels:[1/o.pixelsToGLUnits[0],1/o.pixelsToGLUnits[1]]}},Fr=function(e,i,r){return t.extend(Br(e,i,r),{u_image:0})},Ur=function(e,i,r,o){var a=e.transform,n=jr(i,a);return{u_matrix:Vr(e,i,r),u_texsize:i.imageAtlasTexture.size,u_ratio:1/he(i,1,a.zoom),u_device_pixel_ratio:t.browser.devicePixelRatio,u_image:0,u_scale:[n,o.fromScale,o.toScale],u_fade:o.t,u_units_to_pixels:[1/a.pixelsToGLUnits[0],1/a.pixelsToGLUnits[1]]}},Nr=function(e,i,r,o,a){var n=e.lineAtlas,s=jr(i,e.transform),l="round"===r.layout.get("line-cap"),c=n.getDash(o.from,l),u=n.getDash(o.to,l),h=c.width*a.fromScale,p=u.width*a.toScale;return t.extend(Br(e,i,r),{u_patternscale_a:[s/h,-c.height/2],u_patternscale_b:[s/p,-u.height/2],u_sdfgamma:n.width/(256*Math.min(h,p)*t.browser.devicePixelRatio)/2,u_image:0,u_tex_y_a:c.y,u_tex_y_b:u.y,u_mix:a.t})};function jr(t,e){return 1/he(t,1,e.tileZoom)}function Vr(t,e,i){return t.translatePosMatrix(e.tileID.posMatrix,e,i.paint.get("line-translate"),i.paint.get("line-translate-anchor"))}var qr=function(t,e,i,r,o){return{u_matrix:t,u_tl_parent:e,u_scale_parent:i,u_buffer_scale:1,u_fade_t:r.mix,u_opacity:r.opacity*o.paint.get("raster-opacity"),u_image0:0,u_image1:1,u_brightness_low:o.paint.get("raster-brightness-min"),u_brightness_high:o.paint.get("raster-brightness-max"),u_saturation_factor:(n=o.paint.get("raster-saturation"),n>0?1-1/(1.001-n):-n),u_contrast_factor:(a=o.paint.get("raster-contrast"),a>0?1/(1-a):1+a),u_spin_weights:Gr(o.paint.get("raster-hue-rotate"))};var a,n};function Gr(t){t*=Math.PI/180;var e=Math.sin(t),i=Math.cos(t);return[(2*i+1)/3,(-Math.sqrt(3)*e-i+1)/3,(Math.sqrt(3)*e-i+1)/3]}var Zr,Hr=function(t,e,i,r,o,a,n,s,l,c){var u=o.transform;return{u_is_size_zoom_constant:+("constant"===t||"source"===t),u_is_size_feature_constant:+("constant"===t||"camera"===t),u_size_t:e?e.uSizeT:0,u_size:e?e.uSize:0,u_camera_to_center_distance:u.cameraToCenterDistance,u_pitch:u.pitch/360*2*Math.PI,u_rotate_symbol:+i,u_aspect_ratio:u.width/u.height,u_fade_change:o.options.fadeDuration?o.symbolFadeChange:1,u_matrix:a,u_label_plane_matrix:n,u_coord_matrix:s,u_is_text:+l,u_pitch_with_map:+r,u_texsize:c,u_texture:0}},Kr=function(e,i,r,o,a,n,s,l,c,u,h){var p=a.transform;return t.extend(Hr(e,i,r,o,a,n,s,l,c,u),{u_gamma_scale:o?Math.cos(p._pitch)*p.cameraToCenterDistance:1,u_device_pixel_ratio:t.browser.devicePixelRatio,u_is_halo:+h})},Wr=function(e,i,r,o,a,n,s,l,c,u){return t.extend(Kr(e,i,r,o,a,n,s,l,!0,c,!0),{u_texsize_icon:u,u_texture_icon:1})},Xr=function(t,e,i){return{u_matrix:t,u_opacity:e,u_color:i}},$r=function(e,i,r,o,a,n){return t.extend(function(t,e,i,r){var o=i.imageManager.getPattern(t.from.toString()),a=i.imageManager.getPattern(t.to.toString()),n=i.imageManager.getPixelSize(),s=n.width,l=n.height,c=Math.pow(2,r.tileID.overscaledZ),u=r.tileSize*Math.pow(2,i.transform.tileZoom)/c,h=u*(r.tileID.canonical.x+r.tileID.wrap*c),p=u*r.tileID.canonical.y;return{u_image:0,u_pattern_tl_a:o.tl,u_pattern_br_a:o.br,u_pattern_tl_b:a.tl,u_pattern_br_b:a.br,u_texsize:[s,l],u_mix:e.t,u_pattern_size_a:o.displaySize,u_pattern_size_b:a.displaySize,u_scale_a:e.fromScale,u_scale_b:e.toScale,u_tile_units_to_pixels:1/he(r,1,i.transform.tileZoom),u_pixel_coord_upper:[h>>16,p>>16],u_pixel_coord_lower:[65535&h,65535&p]}}(o,n,r,a),{u_matrix:e,u_opacity:i})},Jr={fillExtrusion:function(e,i){return{u_matrix:new t.UniformMatrix4f(e,i.u_matrix),u_lightpos:new t.Uniform3f(e,i.u_lightpos),u_lightintensity:new t.Uniform1f(e,i.u_lightintensity),u_lightcolor:new t.Uniform3f(e,i.u_lightcolor),u_vertical_gradient:new t.Uniform1f(e,i.u_vertical_gradient),u_opacity:new t.Uniform1f(e,i.u_opacity)}},fillExtrusionPattern:function(e,i){return{u_matrix:new t.UniformMatrix4f(e,i.u_matrix),u_lightpos:new t.Uniform3f(e,i.u_lightpos),u_lightintensity:new t.Uniform1f(e,i.u_lightintensity),u_lightcolor:new t.Uniform3f(e,i.u_lightcolor),u_vertical_gradient:new t.Uniform1f(e,i.u_vertical_gradient),u_height_factor:new t.Uniform1f(e,i.u_height_factor),u_image:new t.Uniform1i(e,i.u_image),u_texsize:new t.Uniform2f(e,i.u_texsize),u_pixel_coord_upper:new t.Uniform2f(e,i.u_pixel_coord_upper),u_pixel_coord_lower:new t.Uniform2f(e,i.u_pixel_coord_lower),u_scale:new t.Uniform3f(e,i.u_scale),u_fade:new t.Uniform1f(e,i.u_fade),u_opacity:new t.Uniform1f(e,i.u_opacity)}},fill:function(e,i){return{u_matrix:new t.UniformMatrix4f(e,i.u_matrix)}},fillPattern:function(e,i){return{u_matrix:new t.UniformMatrix4f(e,i.u_matrix),u_image:new t.Uniform1i(e,i.u_image),u_texsize:new t.Uniform2f(e,i.u_texsize),u_pixel_coord_upper:new t.Uniform2f(e,i.u_pixel_coord_upper),u_pixel_coord_lower:new t.Uniform2f(e,i.u_pixel_coord_lower),u_scale:new t.Uniform3f(e,i.u_scale),u_fade:new t.Uniform1f(e,i.u_fade)}},fillOutline:function(e,i){return{u_matrix:new t.UniformMatrix4f(e,i.u_matrix),u_world:new t.Uniform2f(e,i.u_world)}},fillOutlinePattern:function(e,i){return{u_matrix:new t.UniformMatrix4f(e,i.u_matrix),u_world:new t.Uniform2f(e,i.u_world),u_image:new t.Uniform1i(e,i.u_image),u_texsize:new t.Uniform2f(e,i.u_texsize),u_pixel_coord_upper:new t.Uniform2f(e,i.u_pixel_coord_upper),u_pixel_coord_lower:new t.Uniform2f(e,i.u_pixel_coord_lower),u_scale:new t.Uniform3f(e,i.u_scale),u_fade:new t.Uniform1f(e,i.u_fade)}},circle:function(e,i){return{u_camera_to_center_distance:new t.Uniform1f(e,i.u_camera_to_center_distance),u_scale_with_map:new t.Uniform1i(e,i.u_scale_with_map),u_pitch_with_map:new t.Uniform1i(e,i.u_pitch_with_map),u_extrude_scale:new t.Uniform2f(e,i.u_extrude_scale),u_device_pixel_ratio:new t.Uniform1f(e,i.u_device_pixel_ratio),u_matrix:new t.UniformMatrix4f(e,i.u_matrix)}},collisionBox:function(e,i){return{u_matrix:new t.UniformMatrix4f(e,i.u_matrix),u_camera_to_center_distance:new t.Uniform1f(e,i.u_camera_to_center_distance),u_pixels_to_tile_units:new t.Uniform1f(e,i.u_pixels_to_tile_units),u_extrude_scale:new t.Uniform2f(e,i.u_extrude_scale),u_overscale_factor:new t.Uniform1f(e,i.u_overscale_factor)}},collisionCircle:function(e,i){return{u_matrix:new t.UniformMatrix4f(e,i.u_matrix),u_inv_matrix:new t.UniformMatrix4f(e,i.u_inv_matrix),u_camera_to_center_distance:new t.Uniform1f(e,i.u_camera_to_center_distance),u_viewport_size:new t.Uniform2f(e,i.u_viewport_size)}},debug:function(e,i){return{u_color:new t.UniformColor(e,i.u_color),u_matrix:new t.UniformMatrix4f(e,i.u_matrix),u_overlay:new t.Uniform1i(e,i.u_overlay),u_overlay_scale:new t.Uniform1f(e,i.u_overlay_scale)}},clippingMask:function(e,i){return{u_matrix:new t.UniformMatrix4f(e,i.u_matrix)}},heatmap:function(e,i){return{u_extrude_scale:new t.Uniform1f(e,i.u_extrude_scale),u_intensity:new t.Uniform1f(e,i.u_intensity),u_matrix:new t.UniformMatrix4f(e,i.u_matrix)}},heatmapTexture:function(e,i){return{u_matrix:new t.UniformMatrix4f(e,i.u_matrix),u_world:new t.Uniform2f(e,i.u_world),u_image:new t.Uniform1i(e,i.u_image),u_color_ramp:new t.Uniform1i(e,i.u_color_ramp),u_opacity:new t.Uniform1f(e,i.u_opacity)}},hillshade:function(e,i){return{u_matrix:new t.UniformMatrix4f(e,i.u_matrix),u_image:new t.Uniform1i(e,i.u_image),u_latrange:new t.Uniform2f(e,i.u_latrange),u_light:new t.Uniform2f(e,i.u_light),u_shadow:new t.UniformColor(e,i.u_shadow),u_highlight:new t.UniformColor(e,i.u_highlight),u_accent:new t.UniformColor(e,i.u_accent)}},hillshadePrepare:function(e,i){return{u_matrix:new t.UniformMatrix4f(e,i.u_matrix),u_image:new t.Uniform1i(e,i.u_image),u_dimension:new t.Uniform2f(e,i.u_dimension),u_zoom:new t.Uniform1f(e,i.u_zoom),u_maxzoom:new t.Uniform1f(e,i.u_maxzoom),u_unpack:new t.Uniform4f(e,i.u_unpack)}},line:function(e,i){return{u_matrix:new t.UniformMatrix4f(e,i.u_matrix),u_ratio:new t.Uniform1f(e,i.u_ratio),u_device_pixel_ratio:new t.Uniform1f(e,i.u_device_pixel_ratio),u_units_to_pixels:new t.Uniform2f(e,i.u_units_to_pixels)}},lineGradient:function(e,i){return{u_matrix:new t.UniformMatrix4f(e,i.u_matrix),u_ratio:new t.Uniform1f(e,i.u_ratio),u_device_pixel_ratio:new t.Uniform1f(e,i.u_device_pixel_ratio),u_units_to_pixels:new t.Uniform2f(e,i.u_units_to_pixels),u_image:new t.Uniform1i(e,i.u_image)}},linePattern:function(e,i){return{u_matrix:new t.UniformMatrix4f(e,i.u_matrix),u_texsize:new t.Uniform2f(e,i.u_texsize),u_ratio:new t.Uniform1f(e,i.u_ratio),u_device_pixel_ratio:new t.Uniform1f(e,i.u_device_pixel_ratio),u_image:new t.Uniform1i(e,i.u_image),u_units_to_pixels:new t.Uniform2f(e,i.u_units_to_pixels),u_scale:new t.Uniform3f(e,i.u_scale),u_fade:new t.Uniform1f(e,i.u_fade)}},lineSDF:function(e,i){return{u_matrix:new t.UniformMatrix4f(e,i.u_matrix),u_ratio:new t.Uniform1f(e,i.u_ratio),u_device_pixel_ratio:new t.Uniform1f(e,i.u_device_pixel_ratio),u_units_to_pixels:new t.Uniform2f(e,i.u_units_to_pixels),u_patternscale_a:new t.Uniform2f(e,i.u_patternscale_a),u_patternscale_b:new t.Uniform2f(e,i.u_patternscale_b),u_sdfgamma:new t.Uniform1f(e,i.u_sdfgamma),u_image:new t.Uniform1i(e,i.u_image),u_tex_y_a:new t.Uniform1f(e,i.u_tex_y_a),u_tex_y_b:new t.Uniform1f(e,i.u_tex_y_b),u_mix:new t.Uniform1f(e,i.u_mix)}},raster:function(e,i){return{u_matrix:new t.UniformMatrix4f(e,i.u_matrix),u_tl_parent:new t.Uniform2f(e,i.u_tl_parent),u_scale_parent:new t.Uniform1f(e,i.u_scale_parent),u_buffer_scale:new t.Uniform1f(e,i.u_buffer_scale),u_fade_t:new t.Uniform1f(e,i.u_fade_t),u_opacity:new t.Uniform1f(e,i.u_opacity),u_image0:new t.Uniform1i(e,i.u_image0),u_image1:new t.Uniform1i(e,i.u_image1),u_brightness_low:new t.Uniform1f(e,i.u_brightness_low),u_brightness_high:new t.Uniform1f(e,i.u_brightness_high),u_saturation_factor:new t.Uniform1f(e,i.u_saturation_factor),u_contrast_factor:new t.Uniform1f(e,i.u_contrast_factor),u_spin_weights:new t.Uniform3f(e,i.u_spin_weights)}},symbolIcon:function(e,i){return{u_is_size_zoom_constant:new t.Uniform1i(e,i.u_is_size_zoom_constant),u_is_size_feature_constant:new t.Uniform1i(e,i.u_is_size_feature_constant),u_size_t:new t.Uniform1f(e,i.u_size_t),u_size:new t.Uniform1f(e,i.u_size),u_camera_to_center_distance:new t.Uniform1f(e,i.u_camera_to_center_distance),u_pitch:new t.Uniform1f(e,i.u_pitch),u_rotate_symbol:new t.Uniform1i(e,i.u_rotate_symbol),u_aspect_ratio:new t.Uniform1f(e,i.u_aspect_ratio),u_fade_change:new t.Uniform1f(e,i.u_fade_change),u_matrix:new t.UniformMatrix4f(e,i.u_matrix),u_label_plane_matrix:new t.UniformMatrix4f(e,i.u_label_plane_matrix),u_coord_matrix:new t.UniformMatrix4f(e,i.u_coord_matrix),u_is_text:new t.Uniform1i(e,i.u_is_text),u_pitch_with_map:new t.Uniform1i(e,i.u_pitch_with_map),u_texsize:new t.Uniform2f(e,i.u_texsize),u_texture:new t.Uniform1i(e,i.u_texture)}},symbolSDF:function(e,i){return{u_is_size_zoom_constant:new t.Uniform1i(e,i.u_is_size_zoom_constant),u_is_size_feature_constant:new t.Uniform1i(e,i.u_is_size_feature_constant),u_size_t:new t.Uniform1f(e,i.u_size_t),u_size:new t.Uniform1f(e,i.u_size),u_camera_to_center_distance:new t.Uniform1f(e,i.u_camera_to_center_distance),u_pitch:new t.Uniform1f(e,i.u_pitch),u_rotate_symbol:new t.Uniform1i(e,i.u_rotate_symbol),u_aspect_ratio:new t.Uniform1f(e,i.u_aspect_ratio),u_fade_change:new t.Uniform1f(e,i.u_fade_change),u_matrix:new t.UniformMatrix4f(e,i.u_matrix),u_label_plane_matrix:new t.UniformMatrix4f(e,i.u_label_plane_matrix),u_coord_matrix:new t.UniformMatrix4f(e,i.u_coord_matrix),u_is_text:new t.Uniform1i(e,i.u_is_text),u_pitch_with_map:new t.Uniform1i(e,i.u_pitch_with_map),u_texsize:new t.Uniform2f(e,i.u_texsize),u_texture:new t.Uniform1i(e,i.u_texture),u_gamma_scale:new t.Uniform1f(e,i.u_gamma_scale),u_device_pixel_ratio:new t.Uniform1f(e,i.u_device_pixel_ratio),u_is_halo:new t.Uniform1i(e,i.u_is_halo)}},symbolTextAndIcon:function(e,i){return{u_is_size_zoom_constant:new t.Uniform1i(e,i.u_is_size_zoom_constant),u_is_size_feature_constant:new t.Uniform1i(e,i.u_is_size_feature_constant),u_size_t:new t.Uniform1f(e,i.u_size_t),u_size:new t.Uniform1f(e,i.u_size),u_camera_to_center_distance:new t.Uniform1f(e,i.u_camera_to_center_distance),u_pitch:new t.Uniform1f(e,i.u_pitch),u_rotate_symbol:new t.Uniform1i(e,i.u_rotate_symbol),u_aspect_ratio:new t.Uniform1f(e,i.u_aspect_ratio),u_fade_change:new t.Uniform1f(e,i.u_fade_change),u_matrix:new t.UniformMatrix4f(e,i.u_matrix),u_label_plane_matrix:new t.UniformMatrix4f(e,i.u_label_plane_matrix),u_coord_matrix:new t.UniformMatrix4f(e,i.u_coord_matrix),u_is_text:new t.Uniform1i(e,i.u_is_text),u_pitch_with_map:new t.Uniform1i(e,i.u_pitch_with_map),u_texsize:new t.Uniform2f(e,i.u_texsize),u_texsize_icon:new t.Uniform2f(e,i.u_texsize_icon),u_texture:new t.Uniform1i(e,i.u_texture),u_texture_icon:new t.Uniform1i(e,i.u_texture_icon),u_gamma_scale:new t.Uniform1f(e,i.u_gamma_scale),u_device_pixel_ratio:new t.Uniform1f(e,i.u_device_pixel_ratio),u_is_halo:new t.Uniform1i(e,i.u_is_halo)}},background:function(e,i){return{u_matrix:new t.UniformMatrix4f(e,i.u_matrix),u_opacity:new t.Uniform1f(e,i.u_opacity),u_color:new t.UniformColor(e,i.u_color)}},backgroundPattern:function(e,i){return{u_matrix:new t.UniformMatrix4f(e,i.u_matrix),u_opacity:new t.Uniform1f(e,i.u_opacity),u_image:new t.Uniform1i(e,i.u_image),u_pattern_tl_a:new t.Uniform2f(e,i.u_pattern_tl_a),u_pattern_br_a:new t.Uniform2f(e,i.u_pattern_br_a),u_pattern_tl_b:new t.Uniform2f(e,i.u_pattern_tl_b),u_pattern_br_b:new t.Uniform2f(e,i.u_pattern_br_b),u_texsize:new t.Uniform2f(e,i.u_texsize),u_mix:new t.Uniform1f(e,i.u_mix),u_pattern_size_a:new t.Uniform2f(e,i.u_pattern_size_a),u_pattern_size_b:new t.Uniform2f(e,i.u_pattern_size_b),u_scale_a:new t.Uniform1f(e,i.u_scale_a),u_scale_b:new t.Uniform1f(e,i.u_scale_b),u_pixel_coord_upper:new t.Uniform2f(e,i.u_pixel_coord_upper),u_pixel_coord_lower:new t.Uniform2f(e,i.u_pixel_coord_lower),u_tile_units_to_pixels:new t.Uniform1f(e,i.u_tile_units_to_pixels)}}};function Yr(e,i,r,o,a,n,s){for(var l=e.context,c=l.gl,u=e.useProgram("collisionBox"),h=[],p=0,d=0,f=0;f<o.length;f++){var m=o[f],y=i.getTile(m),g=y.getBucket(r);if(g){var v=m.posMatrix;0===a[0]&&0===a[1]||(v=e.translatePosMatrix(m.posMatrix,y,a,n));var _=s?g.textCollisionBox:g.iconCollisionBox,x=g.collisionCircleArray;if(x.length>0){var b=t.create(),w=v;t.mul(b,g.placementInvProjMatrix,e.transform.glCoordMatrix),t.mul(b,b,g.placementViewportMatrix),h.push({circleArray:x,circleOffset:d,transform:w,invTransform:b}),d=p+=x.length/4}_&&u.draw(l,c.LINES,St.disabled,Tt.disabled,e.colorModeForRenderPass(),zt.disabled,Mr(v,e.transform,y),r.id,_.layoutVertexBuffer,_.indexBuffer,_.segments,null,e.transform.zoom,null,null,_.collisionVertexBuffer)}}if(s&&h.length){var E=e.useProgram("collisionCircle"),k=new t.StructArrayLayout2f1f2i16;k.resize(4*p),k._trim();for(var S=0,T=0,I=h;T<I.length;T+=1)for(var z=I[T],C=0;C<z.circleArray.length/4;C++){var P=4*C,A=z.circleArray[P+0],M=z.circleArray[P+1],L=z.circleArray[P+2],R=z.circleArray[P+3];k.emplace(S++,A,M,L,R,0),k.emplace(S++,A,M,L,R,1),k.emplace(S++,A,M,L,R,2),k.emplace(S++,A,M,L,R,3)}(!Zr||Zr.length<2*p)&&(Zr=function(e){var i=2*e,r=new t.StructArrayLayout3ui6;r.resize(i),r._trim();for(var o=0;o<i;o++){var a=6*o;r.uint16[a+0]=4*o+0,r.uint16[a+1]=4*o+1,r.uint16[a+2]=4*o+2,r.uint16[a+3]=4*o+2,r.uint16[a+4]=4*o+3,r.uint16[a+5]=4*o+0}return r}(p));for(var D=l.createIndexBuffer(Zr,!0),O=l.createVertexBuffer(k,t.collisionCircleLayout.members,!0),B=0,F=h;B<F.length;B+=1){var U=F[B],N=Lr(U.transform,U.invTransform,e.transform);E.draw(l,c.TRIANGLES,St.disabled,Tt.disabled,e.colorModeForRenderPass(),zt.disabled,N,r.id,O,D,t.SegmentVector.simpleSegment(0,2*U.circleOffset,U.circleArray.length,U.circleArray.length/2),null,e.transform.zoom,null,null,null)}O.destroy(),D.destroy()}}var Qr=t.identity(new Float32Array(16));function ti(e,i,r,o,a,n){var s=t.getAnchorAlignment(e),l=-(s.horizontalAlign-.5)*i,c=-(s.verticalAlign-.5)*r,u=t.evaluateVariableOffset(e,o);return new t.Point((l/a+u[0])*n,(c/a+u[1])*n)}function ei(e,i,r,o,a,n,s,l,c,u,h){var p=e.text.placedSymbolArray,d=e.text.dynamicLayoutVertexArray,f=e.icon.dynamicLayoutVertexArray,m={};d.clear();for(var y=0;y<p.length;y++){var g=p.get(y),v=g.hidden||!g.crossTileID||e.allowVerticalPlacement&&!g.placedOrientation?null:o[g.crossTileID];if(v){var _=new t.Point(g.anchorX,g.anchorY),x=Qt(_,r?l:s),b=te(n.cameraToCenterDistance,x.signedDistanceFromCamera),w=a.evaluateSizeForFeature(e.textSizeData,u,g)*b/t.ONE_EM;r&&(w*=e.tilePixelRatio/c);for(var E=ti(v.anchor,v.width,v.height,v.textOffset,v.textBoxScale,w),k=r?Qt(_.add(E),s).point:x.point.add(i?E.rotate(-n.angle):E),S=e.allowVerticalPlacement&&g.placedOrientation===t.WritingMode.vertical?Math.PI/2:0,T=0;T<g.numGlyphs;T++)t.addDynamicAttributes(d,k,S);h&&g.associatedIconIndex>=0&&(m[g.associatedIconIndex]={shiftedAnchor:k,angle:S})}else ue(g.numGlyphs,d)}if(h){f.clear();for(var I=e.icon.placedSymbolArray,z=0;z<I.length;z++){var C=I.get(z);if(C.hidden)ue(C.numGlyphs,f);else{var P=m[z];if(P)for(var A=0;A<C.numGlyphs;A++)t.addDynamicAttributes(f,P.shiftedAnchor,P.angle);else ue(C.numGlyphs,f)}}e.icon.dynamicLayoutVertexBuffer.updateData(f)}e.text.dynamicLayoutVertexBuffer.updateData(d)}function ri(t,e,i){return i.iconsInText&&e?"symbolTextAndIcon":t?"symbolSDF":"symbolIcon"}function ii(e,i,r,o,a,n,s,l,c,u,h,p){for(var d=e.context,f=d.gl,m=e.transform,y="map"===l,g="map"===c,v=y&&"point"!==r.layout.get("symbol-placement"),_=y&&!g&&!v,x=void 0!==r.layout.get("symbol-sort-key").constantOr(1),b=e.depthModeForSublayer(0,St.ReadOnly),w=r.layout.get("text-variable-anchor"),E=[],k=0,S=o;k<S.length;k+=1){var T=S[k],I=i.getTile(T),z=I.getBucket(r);if(z){var C=a?z.text:z.icon;if(C&&C.segments.get().length){var P=C.programConfigurations.get(r.id),A=a||z.sdfIcons,M=a?z.textSizeData:z.iconSizeData,L=g||0!==m.pitch,R=e.useProgram(ri(A,a,z),P),D=t.evaluateSizeForZoom(M,m.zoom),O=void 0,B=[0,0],F=void 0,U=void 0,N=null,j=void 0;if(a)F=I.glyphAtlasTexture,U=f.LINEAR,O=I.glyphAtlasTexture.size,z.iconsInText&&(B=I.imageAtlasTexture.size,N=I.imageAtlasTexture,j=L||e.options.rotating||e.options.zooming||"composite"===M.kind||"camera"===M.kind?f.LINEAR:f.NEAREST);else{var V=1!==r.layout.get("icon-size").constantOr(0)||z.iconsNeedLinear;F=I.imageAtlasTexture,U=A||e.options.rotating||e.options.zooming||V||L?f.LINEAR:f.NEAREST,O=I.imageAtlasTexture.size}var q=he(I,1,e.transform.zoom),G=Jt(T.posMatrix,g,y,e.transform,q),Z=Yt(T.posMatrix,g,y,e.transform,q),H=w&&z.hasTextData(),K="none"!==r.layout.get("icon-text-fit")&&H&&z.hasIconData();v&&re(z,T.posMatrix,e,a,G,Z,g,u);var W=e.translatePosMatrix(T.posMatrix,I,n,s),X=v||a&&w||K?Qr:G,$=e.translatePosMatrix(Z,I,n,s,!0),J=A&&0!==r.paint.get(a?"text-halo-width":"icon-halo-width").constantOr(1),Y={program:R,buffers:C,uniformValues:A?z.iconsInText?Wr(M.kind,D,_,g,e,W,X,$,O,B):Kr(M.kind,D,_,g,e,W,X,$,a,O,!0):Hr(M.kind,D,_,g,e,W,X,$,a,O),atlasTexture:F,atlasTextureIcon:N,atlasInterpolation:U,atlasInterpolationIcon:j,isSDF:A,hasHalo:J};if(x)for(var Q=0,tt=C.segments.get();Q<tt.length;Q+=1){var et=tt[Q];E.push({segments:new t.SegmentVector([et]),sortKey:et.sortKey,state:Y})}else E.push({segments:C.segments,sortKey:0,state:Y})}}}x&&E.sort((function(t,e){return t.sortKey-e.sortKey}));for(var it=0,ot=E;it<ot.length;it+=1){var rt=ot[it],nt=rt.state;if(d.activeTexture.set(f.TEXTURE0),nt.atlasTexture.bind(nt.atlasInterpolation,f.CLAMP_TO_EDGE),nt.atlasTextureIcon&&(d.activeTexture.set(f.TEXTURE1),nt.atlasTextureIcon&&nt.atlasTextureIcon.bind(nt.atlasInterpolationIcon,f.CLAMP_TO_EDGE)),nt.isSDF){var at=nt.uniformValues;nt.hasHalo&&(at.u_is_halo=1,oi(nt.buffers,rt.segments,r,e,nt.program,b,h,p,at)),at.u_is_halo=0}oi(nt.buffers,rt.segments,r,e,nt.program,b,h,p,nt.uniformValues)}}function oi(t,e,i,r,o,a,n,s,l){var c=r.context;o.draw(c,c.gl.TRIANGLES,a,n,s,zt.disabled,l,i.id,t.layoutVertexBuffer,t.indexBuffer,e,i.paint,r.transform.zoom,t.programConfigurations.get(i.id),t.dynamicLayoutVertexBuffer,t.opacityVertexBuffer)}function ni(t,e,i,r,o,a,n){var s,l,c,u,h,p=t.context.gl,d=i.paint.get("fill-pattern"),f=d&&d.constantOr(1),m=i.getCrossfadeParameters();n?(l=f&&!i.getPaintProperty("fill-outline-color")?"fillOutlinePattern":"fillOutline",s=p.LINES):(l=f?"fillPattern":"fill",s=p.TRIANGLES);for(var y=0,g=r;y<g.length;y+=1){var v=g[y],_=e.getTile(v);if(!f||_.patternsLoaded()){var x=_.getBucket(i);if(x){var b=x.programConfigurations.get(i.id),w=t.useProgram(l,b);f&&(t.context.activeTexture.set(p.TEXTURE0),_.imageAtlasTexture.bind(p.LINEAR,p.CLAMP_TO_EDGE),b.updatePaintBuffers(m));var E=d.constantOr(null);if(E&&_.imageAtlas){var k=_.imageAtlas,S=k.patternPositions[E.to.toString()],T=k.patternPositions[E.from.toString()];S&&T&&b.setConstantPatternPositions(S,T)}var I=t.translatePosMatrix(v.posMatrix,_,i.paint.get("fill-translate"),i.paint.get("fill-translate-anchor"));if(n){u=x.indexBuffer2,h=x.segments2;var z=[p.drawingBufferWidth,p.drawingBufferHeight];c="fillOutlinePattern"===l&&f?Pr(I,t,m,_,z):Cr(I,z)}else u=x.indexBuffer,h=x.segments,c=f?zr(I,t,m,_):Ir(I);w.draw(t.context,s,o,t.stencilModeForClipping(v),a,zt.disabled,c,i.id,x.layoutVertexBuffer,u,h,i.paint,t.transform.zoom,b)}}}}function ai(t,e,i,r,o,a,n){for(var s=t.context,l=s.gl,c=i.paint.get("fill-extrusion-pattern"),u=c.constantOr(1),h=i.getCrossfadeParameters(),p=i.paint.get("fill-extrusion-opacity"),d=0,f=r;d<f.length;d+=1){var m=f[d],y=e.getTile(m),g=y.getBucket(i);if(g){var v=g.programConfigurations.get(i.id),_=t.useProgram(u?"fillExtrusionPattern":"fillExtrusion",v);u&&(t.context.activeTexture.set(l.TEXTURE0),y.imageAtlasTexture.bind(l.LINEAR,l.CLAMP_TO_EDGE),v.updatePaintBuffers(h));var x=c.constantOr(null);if(x&&y.imageAtlas){var b=y.imageAtlas,w=b.patternPositions[x.to.toString()],E=b.patternPositions[x.from.toString()];w&&E&&v.setConstantPatternPositions(w,E)}var k=t.translatePosMatrix(m.posMatrix,y,i.paint.get("fill-extrusion-translate"),i.paint.get("fill-extrusion-translate-anchor")),S=i.paint.get("fill-extrusion-vertical-gradient"),T=u?Tr(k,t,S,p,m,h,y):Sr(k,t,S,p);_.draw(s,s.gl.TRIANGLES,o,a,n,zt.backCCW,T,i.id,g.layoutVertexBuffer,g.indexBuffer,g.segments,i.paint,t.transform.zoom,v)}}}function si(e,i,r,o,a,n){var s=e.context,l=s.gl,c=i.fbo;if(c){var u=e.useProgram("hillshade");s.activeTexture.set(l.TEXTURE0),l.bindTexture(l.TEXTURE_2D,c.colorAttachment.get());var h=function(e,i,r){var o=r.paint.get("hillshade-shadow-color"),a=r.paint.get("hillshade-highlight-color"),n=r.paint.get("hillshade-accent-color"),s=r.paint.get("hillshade-illumination-direction")*(Math.PI/180);"viewport"===r.paint.get("hillshade-illumination-anchor")&&(s-=e.transform.angle);var l,c,u,h=!e.options.moving;return{u_matrix:e.transform.calculatePosMatrix(i.tileID.toUnwrapped(),h),u_image:0,u_latrange:(l=i.tileID,c=Math.pow(2,l.canonical.z),u=l.canonical.y,[new t.MercatorCoordinate(0,u/c).toLngLat().lat,new t.MercatorCoordinate(0,(u+1)/c).toLngLat().lat]),u_light:[r.paint.get("hillshade-exaggeration"),s],u_shadow:o,u_highlight:a,u_accent:n}}(e,i,r);u.draw(s,l.TRIANGLES,o,a,n,zt.disabled,h,r.id,e.rasterBoundsBuffer,e.quadTriangleIndexBuffer,e.rasterBoundsSegments)}}function ui(e,i,r,o,a,n,s){var l=e.context,c=l.gl,u=i.dem;if(u&&u.data){var h=u.dim,p=u.stride,d=u.getPixels();if(l.activeTexture.set(c.TEXTURE1),l.pixelStoreUnpackPremultiplyAlpha.set(!1),i.demTexture=i.demTexture||e.getTileTexture(p),i.demTexture){var f=i.demTexture;f.update(d,{premultiply:!1}),f.bind(c.NEAREST,c.CLAMP_TO_EDGE)}else i.demTexture=new t.Texture(l,d,c.RGBA,{premultiply:!1}),i.demTexture.bind(c.NEAREST,c.CLAMP_TO_EDGE);l.activeTexture.set(c.TEXTURE0);var m=i.fbo;if(!m){var y=new t.Texture(l,{width:h,height:h,data:null},c.RGBA);y.bind(c.LINEAR,c.CLAMP_TO_EDGE),(m=i.fbo=l.createFramebuffer(h,h,!0)).colorAttachment.set(y.texture)}l.bindFramebuffer.set(m.framebuffer),l.viewport.set([0,0,h,h]),e.useProgram("hillshadePrepare").draw(l,c.TRIANGLES,a,n,s,zt.disabled,function(e,i,r){var o=i.stride,a=t.create();return t.ortho(a,0,t.EXTENT,-t.EXTENT,0,0,1),t.translate(a,a,[0,-t.EXTENT,0]),{u_matrix:a,u_image:1,u_dimension:[o,o],u_zoom:e.overscaledZ,u_maxzoom:r,u_unpack:i.getUnpackVector()}}(i.tileID,u,o),r.id,e.rasterBoundsBuffer,e.quadTriangleIndexBuffer,e.rasterBoundsSegments),i.needsHillshadePrepare=!1}}function ci(e,i,r,o,a){var n=o.paint.get("raster-fade-duration");if(n>0){var s=t.browser.now(),l=(s-e.timeAdded)/n,c=i?(s-i.timeAdded)/n:-1,u=r.getSource(),h=a.coveringZoomLevel({tileSize:u.tileSize,roundZoom:u.roundZoom}),p=!i||Math.abs(i.tileID.overscaledZ-h)>Math.abs(e.tileID.overscaledZ-h),d=p&&e.refreshedUponExpiration?1:t.clamp(p?l:1-c,0,1);return e.refreshedUponExpiration&&l>=1&&(e.refreshedUponExpiration=!1),i?{opacity:1,mix:1-d}:{opacity:d,mix:0}}return{opacity:1,mix:0}}var pi=new t.Color(1,0,0,1),hi=new t.Color(0,1,0,1),di=new t.Color(0,0,1,1),fi=new t.Color(1,0,1,1),mi=new t.Color(0,1,1,1);function gi(t,e,i,r){vi(t,0,e+i/2,t.transform.width,i,r)}function yi(t,e,i,r){vi(t,e-i/2,0,i,t.transform.height,r)}function vi(e,i,r,o,a,n){var s=e.context,l=s.gl;l.enable(l.SCISSOR_TEST),l.scissor(i*t.browser.devicePixelRatio,r*t.browser.devicePixelRatio,o*t.browser.devicePixelRatio,a*t.browser.devicePixelRatio),s.clear({color:n}),l.disable(l.SCISSOR_TEST)}function _i(e,i,r){var o=e.context,a=o.gl,n=r.posMatrix,s=e.useProgram("debug"),l=St.disabled,c=Tt.disabled,u=e.colorModeForRenderPass();o.activeTexture.set(a.TEXTURE0),e.emptyTexture.bind(a.LINEAR,a.CLAMP_TO_EDGE),s.draw(o,a.LINE_STRIP,l,c,u,zt.disabled,Rr(n,t.Color.red),"$debug",e.debugBuffer,e.tileBorderIndexBuffer,e.debugSegments);var h=i.getTileByID(r.key).latestRawTileData,p=Math.floor((h&&h.byteLength||0)/1024),d=i.getTile(r).tileSize,f=512/Math.min(d,512)*(r.overscaledZ/e.transform.zoom)*.5,m=r.canonical.toString();r.overscaledZ!==r.canonical.z&&(m+=" => "+r.overscaledZ),function(t,e){t.initDebugOverlayCanvas();var i=t.debugOverlayCanvas,r=t.context.gl,o=t.debugOverlayCanvas.getContext("2d");o.clearRect(0,0,i.width,i.height),o.shadowColor="white",o.shadowBlur=2,o.lineWidth=1.5,o.strokeStyle="white",o.textBaseline="top",o.font="bold 36px Open Sans, sans-serif",o.fillText(e,5,5),o.strokeText(e,5,5),t.debugOverlayTexture.update(i),t.debugOverlayTexture.bind(r.LINEAR,r.CLAMP_TO_EDGE)}(e,m+" "+p+"kb"),s.draw(o,a.TRIANGLES,l,c,It.alphaBlended,zt.disabled,Rr(n,t.Color.transparent,f),"$debug",e.debugBuffer,e.quadTriangleIndexBuffer,e.debugSegments)}var xi={symbol:function(e,i,r,o,a){if("translucent"===e.renderPass){var n=Tt.disabled,s=e.colorModeForRenderPass();r.layout.get("text-variable-anchor")&&function(e,i,r,o,a,n,s){for(var l=i.transform,c="map"===a,u="map"===n,h=0,p=e;h<p.length;h+=1){var d=p[h],f=o.getTile(d),m=f.getBucket(r);if(m&&m.text&&m.text.segments.get().length){var y=t.evaluateSizeForZoom(m.textSizeData,l.zoom),g=he(f,1,i.transform.zoom),v=Jt(d.posMatrix,u,c,i.transform,g),_="none"!==r.layout.get("icon-text-fit")&&m.hasIconData();if(y){var x=Math.pow(2,l.zoom-f.tileID.overscaledZ);ei(m,c,u,s,t.symbolSize,l,v,d.posMatrix,x,y,_)}}}}(o,e,r,i,r.layout.get("text-rotation-alignment"),r.layout.get("text-pitch-alignment"),a),0!==r.paint.get("icon-opacity").constantOr(1)&&ii(e,i,r,o,!1,r.paint.get("icon-translate"),r.paint.get("icon-translate-anchor"),r.layout.get("icon-rotation-alignment"),r.layout.get("icon-pitch-alignment"),r.layout.get("icon-keep-upright"),n,s),0!==r.paint.get("text-opacity").constantOr(1)&&ii(e,i,r,o,!0,r.paint.get("text-translate"),r.paint.get("text-translate-anchor"),r.layout.get("text-rotation-alignment"),r.layout.get("text-pitch-alignment"),r.layout.get("text-keep-upright"),n,s),i.map.showCollisionBoxes&&(Yr(e,i,r,o,r.paint.get("text-translate"),r.paint.get("text-translate-anchor"),!0),Yr(e,i,r,o,r.paint.get("icon-translate"),r.paint.get("icon-translate-anchor"),!1))}},circle:function(e,i,r,o){if("translucent"===e.renderPass){var a=r.paint.get("circle-opacity"),n=r.paint.get("circle-stroke-width"),s=r.paint.get("circle-stroke-opacity"),l=void 0!==r.layout.get("circle-sort-key").constantOr(1);if(0!==a.constantOr(1)||0!==n.constantOr(1)&&0!==s.constantOr(1)){for(var c=e.context,u=c.gl,h=e.depthModeForSublayer(0,St.ReadOnly),p=Tt.disabled,d=e.colorModeForRenderPass(),f=[],m=0;m<o.length;m++){var y=o[m],g=i.getTile(y),v=g.getBucket(r);if(v){var _=v.programConfigurations.get(r.id),x={programConfiguration:_,program:e.useProgram("circle",_),layoutVertexBuffer:v.layoutVertexBuffer,indexBuffer:v.indexBuffer,uniformValues:Ar(e,y,g,r)};if(l)for(var b=0,w=v.segments.get();b<w.length;b+=1){var E=w[b];f.push({segments:new t.SegmentVector([E]),sortKey:E.sortKey,state:x})}else f.push({segments:v.segments,sortKey:0,state:x})}}l&&f.sort((function(t,e){return t.sortKey-e.sortKey}));for(var k=0,S=f;k<S.length;k+=1){var T=S[k],I=T.state;I.program.draw(c,u.TRIANGLES,h,p,d,zt.disabled,I.uniformValues,r.id,I.layoutVertexBuffer,I.indexBuffer,T.segments,r.paint,e.transform.zoom,I.programConfiguration)}}}},heatmap:function(e,i,r,o){if(0!==r.paint.get("heatmap-opacity"))if("offscreen"===e.renderPass){var a=e.context,n=a.gl,s=Tt.disabled,l=new It([n.ONE,n.ONE],t.Color.transparent,[!0,!0,!0,!0]);!function(t,e,i){var r=t.gl;t.activeTexture.set(r.TEXTURE1),t.viewport.set([0,0,e.width/4,e.height/4]);var o=i.heatmapFbo;if(o)r.bindTexture(r.TEXTURE_2D,o.colorAttachment.get()),t.bindFramebuffer.set(o.framebuffer);else{var a=r.createTexture();r.bindTexture(r.TEXTURE_2D,a),r.texParameteri(r.TEXTURE_2D,r.TEXTURE_WRAP_S,r.CLAMP_TO_EDGE),r.texParameteri(r.TEXTURE_2D,r.TEXTURE_WRAP_T,r.CLAMP_TO_EDGE),r.texParameteri(r.TEXTURE_2D,r.TEXTURE_MIN_FILTER,r.LINEAR),r.texParameteri(r.TEXTURE_2D,r.TEXTURE_MAG_FILTER,r.LINEAR),o=i.heatmapFbo=t.createFramebuffer(e.width/4,e.height/4,!1),function(t,e,i,r){var o=t.gl;o.texImage2D(o.TEXTURE_2D,0,o.RGBA,e.width/4,e.height/4,0,o.RGBA,t.extRenderToTextureHalfFloat?t.extTextureHalfFloat.HALF_FLOAT_OES:o.UNSIGNED_BYTE,null),r.colorAttachment.set(i)}(t,e,a,o)}}(a,e,r),a.clear({color:t.Color.transparent});for(var c=0;c<o.length;c++){var u=o[c];if(!i.hasRenderableParent(u)){var h=i.getTile(u),p=h.getBucket(r);if(p){var d=p.programConfigurations.get(r.id);e.useProgram("heatmap",d).draw(a,n.TRIANGLES,St.disabled,s,l,zt.disabled,Or(u.posMatrix,h,e.transform.zoom,r.paint.get("heatmap-intensity")),r.id,p.layoutVertexBuffer,p.indexBuffer,p.segments,r.paint,e.transform.zoom,d)}}}a.viewport.set([0,0,e.width,e.height])}else"translucent"===e.renderPass&&(e.context.setColorMode(e.colorModeForRenderPass()),function(e,i){var r=e.context,o=r.gl,a=i.heatmapFbo;if(a){r.activeTexture.set(o.TEXTURE0),o.bindTexture(o.TEXTURE_2D,a.colorAttachment.get()),r.activeTexture.set(o.TEXTURE1);var n=i.colorRampTexture;n||(n=i.colorRampTexture=new t.Texture(r,i.colorRamp,o.RGBA)),n.bind(o.LINEAR,o.CLAMP_TO_EDGE),e.useProgram("heatmapTexture").draw(r,o.TRIANGLES,St.disabled,Tt.disabled,e.colorModeForRenderPass(),zt.disabled,function(e,i,r,o){var a=t.create();t.ortho(a,0,e.width,e.height,0,0,1);var n=e.context.gl;return{u_matrix:a,u_world:[n.drawingBufferWidth,n.drawingBufferHeight],u_image:0,u_color_ramp:1,u_opacity:i.paint.get("heatmap-opacity")}}(e,i),i.id,e.viewportBuffer,e.quadTriangleIndexBuffer,e.viewportSegments,i.paint,e.transform.zoom)}}(e,r))},line:function(e,i,r,o){if("translucent"===e.renderPass){var a=r.paint.get("line-opacity"),n=r.paint.get("line-width");if(0!==a.constantOr(1)&&0!==n.constantOr(1)){var s=e.depthModeForSublayer(0,St.ReadOnly),l=e.colorModeForRenderPass(),c=r.paint.get("line-dasharray"),u=r.paint.get("line-pattern"),h=u.constantOr(1),p=r.paint.get("line-gradient"),d=r.getCrossfadeParameters(),f=h?"linePattern":c?"lineSDF":p?"lineGradient":"line",m=e.context,y=m.gl,g=!0;if(p){m.activeTexture.set(y.TEXTURE0);var v=r.gradientTexture;if(!r.gradient)return;v||(v=r.gradientTexture=new t.Texture(m,r.gradient,y.RGBA)),v.bind(y.LINEAR,y.CLAMP_TO_EDGE)}for(var _=0,x=o;_<x.length;_+=1){var b=x[_],w=i.getTile(b);if(!h||w.patternsLoaded()){var E=w.getBucket(r);if(E){var k=E.programConfigurations.get(r.id),S=e.context.program.get(),T=e.useProgram(f,k),I=g||T.program!==S,z=u.constantOr(null);if(z&&w.imageAtlas){var C=w.imageAtlas,P=C.patternPositions[z.to.toString()],A=C.patternPositions[z.from.toString()];P&&A&&k.setConstantPatternPositions(P,A)}var M=h?Ur(e,w,r,d):c?Nr(e,w,r,c,d):p?Fr(e,w,r):Br(e,w,r);h?(m.activeTexture.set(y.TEXTURE0),w.imageAtlasTexture.bind(y.LINEAR,y.CLAMP_TO_EDGE),k.updatePaintBuffers(d)):c&&(I||e.lineAtlas.dirty)&&(m.activeTexture.set(y.TEXTURE0),e.lineAtlas.bind(m)),T.draw(m,y.TRIANGLES,s,e.stencilModeForClipping(b),l,zt.disabled,M,r.id,E.layoutVertexBuffer,E.indexBuffer,E.segments,r.paint,e.transform.zoom,k),g=!1}}}}}},fill:function(e,i,r,o){var a=r.paint.get("fill-color"),n=r.paint.get("fill-opacity");if(0!==n.constantOr(1)){var s=e.colorModeForRenderPass(),l=r.paint.get("fill-pattern"),c=e.opaquePassEnabledForLayer()&&!l.constantOr(1)&&1===a.constantOr(t.Color.transparent).a&&1===n.constantOr(0)?"opaque":"translucent";if(e.renderPass===c){var u=e.depthModeForSublayer(1,"opaque"===e.renderPass?St.ReadWrite:St.ReadOnly);ni(e,i,r,o,u,s,!1)}if("translucent"===e.renderPass&&r.paint.get("fill-antialias")){var h=e.depthModeForSublayer(r.getPaintProperty("fill-outline-color")?2:0,St.ReadOnly);ni(e,i,r,o,h,s,!0)}}},"fill-extrusion":function(t,e,i,r){var o=i.paint.get("fill-extrusion-opacity");if(0!==o&&"translucent"===t.renderPass){var a=new St(t.context.gl.LEQUAL,St.ReadWrite,t.depthRangeFor3D);if(1!==o||i.paint.get("fill-extrusion-pattern").constantOr(1))ai(t,e,i,r,a,Tt.disabled,It.disabled),ai(t,e,i,r,a,t.stencilModeFor3D(),t.colorModeForRenderPass());else{var n=t.colorModeForRenderPass();ai(t,e,i,r,a,Tt.disabled,n)}}},hillshade:function(t,e,i,r){if("offscreen"===t.renderPass||"translucent"===t.renderPass){for(var o=t.context,a=e.getSource().maxzoom,n=t.depthModeForSublayer(0,St.ReadOnly),s=t.colorModeForRenderPass(),l="translucent"===t.renderPass?t.stencilConfigForOverlap(r):[{},r],c=l[0],u=0,h=l[1];u<h.length;u+=1){var p=h[u],d=e.getTile(p);d.needsHillshadePrepare&&"offscreen"===t.renderPass?ui(t,d,i,a,n,Tt.disabled,s):"translucent"===t.renderPass&&si(t,d,i,n,c[p.overscaledZ],s)}o.viewport.set([0,0,t.width,t.height])}},raster:function(t,e,i,r){if("translucent"===t.renderPass&&0!==i.paint.get("raster-opacity")&&r.length)for(var o=t.context,a=o.gl,n=e.getSource(),s=t.useProgram("raster"),l=t.colorModeForRenderPass(),c=n instanceof M?[{},r]:t.stencilConfigForOverlap(r),u=c[0],h=c[1],p=h[h.length-1].overscaledZ,d=!t.options.moving,f=0,m=h;f<m.length;f+=1){var y=m[f],g=t.depthModeForSublayer(y.overscaledZ-p,1===i.paint.get("raster-opacity")?St.ReadWrite:St.ReadOnly,a.LESS),v=e.getTile(y),_=t.transform.calculatePosMatrix(y.toUnwrapped(),d);v.registerFadeDuration(i.paint.get("raster-fade-duration"));var x=e.findLoadedParent(y,0),b=ci(v,x,e,i,t.transform),w=void 0,E=void 0,k="nearest"===i.paint.get("raster-resampling")?a.NEAREST:a.LINEAR;o.activeTexture.set(a.TEXTURE0),v.texture.bind(k,a.CLAMP_TO_EDGE,a.LINEAR_MIPMAP_NEAREST),o.activeTexture.set(a.TEXTURE1),x?(x.texture.bind(k,a.CLAMP_TO_EDGE,a.LINEAR_MIPMAP_NEAREST),w=Math.pow(2,x.tileID.overscaledZ-v.tileID.overscaledZ),E=[v.tileID.canonical.x*w%1,v.tileID.canonical.y*w%1]):v.texture.bind(k,a.CLAMP_TO_EDGE,a.LINEAR_MIPMAP_NEAREST);var S=qr(_,E||[0,0],w||1,b,i);n instanceof M?s.draw(o,a.TRIANGLES,g,Tt.disabled,l,zt.disabled,S,i.id,n.boundsBuffer,t.quadTriangleIndexBuffer,n.boundsSegments):s.draw(o,a.TRIANGLES,g,u[y.overscaledZ],l,zt.disabled,S,i.id,t.rasterBoundsBuffer,t.quadTriangleIndexBuffer,t.rasterBoundsSegments)}},background:function(t,e,i){var r=i.paint.get("background-color"),o=i.paint.get("background-opacity");if(0!==o){var a=t.context,n=a.gl,s=t.transform,l=s.tileSize,c=i.paint.get("background-pattern");if(!t.isPatternMissing(c)){var u=!c&&1===r.a&&1===o&&t.opaquePassEnabledForLayer()?"opaque":"translucent";if(t.renderPass===u){var h=Tt.disabled,p=t.depthModeForSublayer(0,"opaque"===u?St.ReadWrite:St.ReadOnly),d=t.colorModeForRenderPass(),f=t.useProgram(c?"backgroundPattern":"background"),m=s.coveringTiles({tileSize:l});c&&(a.activeTexture.set(n.TEXTURE0),t.imageManager.bind(t.context));for(var y=i.getCrossfadeParameters(),g=0,v=m;g<v.length;g+=1){var _=v[g],x=t.transform.calculatePosMatrix(_.toUnwrapped()),b=c?$r(x,o,t,c,{tileID:_,tileSize:l},y):Xr(x,o,r);f.draw(a,n.TRIANGLES,p,h,d,zt.disabled,b,i.id,t.tileExtentBuffer,t.quadTriangleIndexBuffer,t.tileExtentSegments)}}}}},debug:function(t,e,i){for(var r=0;r<i.length;r++)_i(t,e,i[r])},custom:function(t,e,i){var r=t.context,o=i.implementation;if("offscreen"===t.renderPass){var a=o.prerender;a&&(t.setCustomLayerDefaults(),r.setColorMode(t.colorModeForRenderPass()),a.call(o,r.gl,t.transform.customLayerMatrix()),r.setDirty(),t.setBaseState())}else if("translucent"===t.renderPass){t.setCustomLayerDefaults(),r.setColorMode(t.colorModeForRenderPass()),r.setStencilMode(Tt.disabled);var n="3d"===o.renderingMode?new St(t.context.gl.LEQUAL,St.ReadWrite,t.depthRangeFor3D):t.depthModeForSublayer(0,St.ReadOnly);r.setDepthMode(n),o.render(r.gl,t.transform.customLayerMatrix()),r.setDirty(),t.setBaseState(),r.bindFramebuffer.set(null)}}},bi=function(t,e){this.context=new Ct(t),this.transform=e,this._tileTextures={},this.setup(),this.numSublayers=Pt.maxUnderzooming+Pt.maxOverzooming+1,this.depthEpsilon=1/Math.pow(2,16),this.crossTileSymbolIndex=new Fe,this.gpuTimers={}};bi.prototype.resize=function(e,i){if(this.width=e*t.browser.devicePixelRatio,this.height=i*t.browser.devicePixelRatio,this.context.viewport.set([0,0,this.width,this.height]),this.style)for(var r=0,o=this.style._order;r<o.length;r+=1)this.style._layers[o[r]].resize()},bi.prototype.setup=function(){var e=this.context,i=new t.StructArrayLayout2i4;i.emplaceBack(0,0),i.emplaceBack(t.EXTENT,0),i.emplaceBack(0,t.EXTENT),i.emplaceBack(t.EXTENT,t.EXTENT),this.tileExtentBuffer=e.createVertexBuffer(i,Ge.members),this.tileExtentSegments=t.SegmentVector.simpleSegment(0,0,4,2);var r=new t.StructArrayLayout2i4;r.emplaceBack(0,0),r.emplaceBack(t.EXTENT,0),r.emplaceBack(0,t.EXTENT),r.emplaceBack(t.EXTENT,t.EXTENT),this.debugBuffer=e.createVertexBuffer(r,Ge.members),this.debugSegments=t.SegmentVector.simpleSegment(0,0,4,5);var o=new t.StructArrayLayout4i8;o.emplaceBack(0,0,0,0),o.emplaceBack(t.EXTENT,0,t.EXTENT,0),o.emplaceBack(0,t.EXTENT,0,t.EXTENT),o.emplaceBack(t.EXTENT,t.EXTENT,t.EXTENT,t.EXTENT),this.rasterBoundsBuffer=e.createVertexBuffer(o,A.members),this.rasterBoundsSegments=t.SegmentVector.simpleSegment(0,0,4,2);var a=new t.StructArrayLayout2i4;a.emplaceBack(0,0),a.emplaceBack(1,0),a.emplaceBack(0,1),a.emplaceBack(1,1),this.viewportBuffer=e.createVertexBuffer(a,Ge.members),this.viewportSegments=t.SegmentVector.simpleSegment(0,0,4,2);var n=new t.StructArrayLayout1ui2;n.emplaceBack(0),n.emplaceBack(1),n.emplaceBack(3),n.emplaceBack(2),n.emplaceBack(0),this.tileBorderIndexBuffer=e.createIndexBuffer(n);var s=new t.StructArrayLayout3ui6;s.emplaceBack(0,1,2),s.emplaceBack(2,1,3),this.quadTriangleIndexBuffer=e.createIndexBuffer(s),this.emptyTexture=new t.Texture(e,{width:1,height:1,data:new Uint8Array([0,0,0,0])},e.gl.RGBA);var l=this.context.gl;this.stencilClearMode=new Tt({func:l.ALWAYS,mask:0},0,255,l.ZERO,l.ZERO,l.ZERO)},bi.prototype.clearStencil=function(){var e=this.context,i=e.gl;this.nextStencilID=1,this.currentStencilSource=void 0;var r=t.create();t.ortho(r,0,this.width,this.height,0,0,1),t.scale(r,r,[i.drawingBufferWidth,i.drawingBufferHeight,0]),this.useProgram("clippingMask").draw(e,i.TRIANGLES,St.disabled,this.stencilClearMode,It.disabled,zt.disabled,Dr(r),"$clipping",this.viewportBuffer,this.quadTriangleIndexBuffer,this.viewportSegments)},bi.prototype._renderTileClippingMasks=function(t,e){if(this.currentStencilSource!==t.source&&t.isTileClipped()&&e&&e.length){this.currentStencilSource=t.source;var i=this.context,r=i.gl;this.nextStencilID+e.length>256&&this.clearStencil(),i.setColorMode(It.disabled),i.setDepthMode(St.disabled);var o=this.useProgram("clippingMask");this._tileClippingMaskIDs={};for(var a=0,n=e;a<n.length;a+=1){var s=n[a],l=this._tileClippingMaskIDs[s.key]=this.nextStencilID++;o.draw(i,r.TRIANGLES,St.disabled,new Tt({func:r.ALWAYS,mask:0},l,255,r.KEEP,r.KEEP,r.REPLACE),It.disabled,zt.disabled,Dr(s.posMatrix),"$clipping",this.tileExtentBuffer,this.quadTriangleIndexBuffer,this.tileExtentSegments)}}},bi.prototype.stencilModeFor3D=function(){this.currentStencilSource=void 0,this.nextStencilID+1>256&&this.clearStencil();var t=this.nextStencilID++,e=this.context.gl;return new Tt({func:e.NOTEQUAL,mask:255},t,255,e.KEEP,e.KEEP,e.REPLACE)},bi.prototype.stencilModeForClipping=function(t){var e=this.context.gl;return new Tt({func:e.EQUAL,mask:255},this._tileClippingMaskIDs[t.key],0,e.KEEP,e.KEEP,e.REPLACE)},bi.prototype.stencilConfigForOverlap=function(t){var e,i=this.context.gl,r=t.sort((function(t,e){return e.overscaledZ-t.overscaledZ})),o=r[r.length-1].overscaledZ,a=r[0].overscaledZ-o+1;if(a>1){this.currentStencilSource=void 0,this.nextStencilID+a>256&&this.clearStencil();for(var n={},s=0;s<a;s++)n[s+o]=new Tt({func:i.GEQUAL,mask:255},s+this.nextStencilID,255,i.KEEP,i.KEEP,i.REPLACE);return this.nextStencilID+=a,[n,r]}return[(e={},e[o]=Tt.disabled,e),r]},bi.prototype.colorModeForRenderPass=function(){var e=this.context.gl;return this._showOverdrawInspector?new It([e.CONSTANT_COLOR,e.ONE],new t.Color(1/8,1/8,1/8,0),[!0,!0,!0,!0]):"opaque"===this.renderPass?It.unblended:It.alphaBlended},bi.prototype.depthModeForSublayer=function(t,e,i){if(!this.opaquePassEnabledForLayer())return St.disabled;var r=1-((1+this.currentLayer)*this.numSublayers+t)*this.depthEpsilon;return new St(i||this.context.gl.LEQUAL,e,[r,r])},bi.prototype.opaquePassEnabledForLayer=function(){return this.currentLayer<this.opaquePassCutoff},bi.prototype.render=function(e,i){var r=this;this.style=e,this.options=i,this.lineAtlas=e.lineAtlas,this.imageManager=e.imageManager,this.glyphManager=e.glyphManager,this.symbolFadeChange=e.placement.symbolFadeChange(t.browser.now()),this.imageManager.beginFrame();var o=this.style._order,a=this.style.sourceCaches;for(var n in a){var s=a[n];s.used&&s.prepare(this.context)}var l,c,u={},h={},p={};for(var d in a){var f=a[d];u[d]=f.getVisibleCoordinates(),h[d]=u[d].slice().reverse(),p[d]=f.getVisibleCoordinates(!0).reverse()}this.opaquePassCutoff=1/0;for(var m=0;m<o.length;m++)if(this.style._layers[o[m]].is3D()){this.opaquePassCutoff=m;break}this.renderPass="offscreen";for(var y=0,g=o;y<g.length;y+=1){var v=this.style._layers[g[y]];if(v.hasOffscreenPass()&&!v.isHidden(this.transform.zoom)){var _=h[v.source];("custom"===v.type||_.length)&&this.renderLayer(this,a[v.source],v,_)}}for(this.context.bindFramebuffer.set(null),this.context.clear({color:i.showOverdrawInspector?t.Color.black:t.Color.transparent,depth:1}),this.clearStencil(),this._showOverdrawInspector=i.showOverdrawInspector,this.depthRangeFor3D=[0,1-(e._order.length+2)*this.numSublayers*this.depthEpsilon],this.renderPass="opaque",this.currentLayer=o.length-1;this.currentLayer>=0;this.currentLayer--){var x=this.style._layers[o[this.currentLayer]],b=a[x.source],w=u[x.source];this._renderTileClippingMasks(x,w),this.renderLayer(this,b,x,w)}for(this.renderPass="translucent",this.currentLayer=0;this.currentLayer<o.length;this.currentLayer++){var E=this.style._layers[o[this.currentLayer]],k=a[E.source],S=("symbol"===E.type?p:h)[E.source];this._renderTileClippingMasks(E,u[E.source]),this.renderLayer(this,k,E,S)}this.options.showTileBoundaries&&(t.values(this.style._layers).forEach((function(t){t.source&&!t.isHidden(r.transform.zoom)&&(t.source!==(c&&c.id)&&(c=r.style.sourceCaches[t.source]),(!l||l.getSource().maxzoom<c.getSource().maxzoom)&&(l=c))})),l&&xi.debug(this,l,l.getVisibleCoordinates())),this.options.showPadding&&function(t){var e=t.transform.padding;gi(t,t.transform.height-(e.top||0),3,pi),gi(t,e.bottom||0,3,hi),yi(t,e.left||0,3,di),yi(t,t.transform.width-(e.right||0),3,fi);var i=t.transform.centerPoint;!function(t,e,i,r){vi(t,e-1,i-10,2,20,r),vi(t,e-10,i-1,20,2,r)}(t,i.x,t.transform.height-i.y,mi)}(this),this.context.setDefault()},bi.prototype.renderLayer=function(t,e,i,r){i.isHidden(this.transform.zoom)||("background"===i.type||"custom"===i.type||r.length)&&(this.id=i.id,this.gpuTimingStart(i),xi[i.type](t,e,i,r,this.style.placement.variableOffsets),this.gpuTimingEnd())},bi.prototype.gpuTimingStart=function(t){if(this.options.gpuTiming){var e=this.context.extTimerQuery,i=this.gpuTimers[t.id];i||(i=this.gpuTimers[t.id]={calls:0,cpuTime:0,query:e.createQueryEXT()}),i.calls++,e.beginQueryEXT(e.TIME_ELAPSED_EXT,i.query)}},bi.prototype.gpuTimingEnd=function(){if(this.options.gpuTiming){var t=this.context.extTimerQuery;t.endQueryEXT(t.TIME_ELAPSED_EXT)}},bi.prototype.collectGpuTimers=function(){var t=this.gpuTimers;return this.gpuTimers={},t},bi.prototype.queryGpuTimers=function(t){var e={};for(var i in t){var r=t[i],o=this.context.extTimerQuery,a=o.getQueryObjectEXT(r.query,o.QUERY_RESULT_EXT)/1e6;o.deleteQueryEXT(r.query),e[i]=a}return e},bi.prototype.translatePosMatrix=function(e,i,r,o,a){if(!r[0]&&!r[1])return e;var n=a?"map"===o?this.transform.angle:0:"viewport"===o?-this.transform.angle:0;if(n){var s=Math.sin(n),l=Math.cos(n);r=[r[0]*l-r[1]*s,r[0]*s+r[1]*l]}var c=[a?r[0]:he(i,r[0],this.transform.zoom),a?r[1]:he(i,r[1],this.transform.zoom),0],u=new Float32Array(16);return t.translate(u,e,c),u},bi.prototype.saveTileTexture=function(t){var e=this._tileTextures[t.size[0]];e?e.push(t):this._tileTextures[t.size[0]]=[t]},bi.prototype.getTileTexture=function(t){var e=this._tileTextures[t];return e&&e.length>0?e.pop():null},bi.prototype.isPatternMissing=function(t){if(!t)return!1;if(!t.from||!t.to)return!0;var e=this.imageManager.getPattern(t.from.toString()),i=this.imageManager.getPattern(t.to.toString());return!e||!i},bi.prototype.useProgram=function(t,e){this.cache=this.cache||{};var i=""+t+(e?e.cacheKey:"")+(this._showOverdrawInspector?"/overdraw":"");return this.cache[i]||(this.cache[i]=new Er(this.context,t,_r[t],e,Jr[t],this._showOverdrawInspector)),this.cache[i]},bi.prototype.setCustomLayerDefaults=function(){this.context.unbindVAO(),this.context.cullFace.setDefault(),this.context.activeTexture.setDefault(),this.context.pixelStoreUnpack.setDefault(),this.context.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.context.pixelStoreUnpackFlipY.setDefault()},bi.prototype.setBaseState=function(){var t=this.context.gl;this.context.cullFace.set(!1),this.context.viewport.set([0,0,this.width,this.height]),this.context.blendEquation.set(t.FUNC_ADD)},bi.prototype.initDebugOverlayCanvas=function(){null==this.debugOverlayCanvas&&(this.debugOverlayCanvas=t.window.document.createElement("canvas"),this.debugOverlayCanvas.width=512,this.debugOverlayCanvas.height=512,this.debugOverlayTexture=new t.Texture(this.context,this.debugOverlayCanvas,this.context.gl.RGBA))},bi.prototype.destroy=function(){this.emptyTexture.destroy(),this.debugOverlayTexture&&this.debugOverlayTexture.destroy()};var wi=function(t,e){this.points=t,this.planes=e};wi.fromInvProjectionMatrix=function(e,i,r){var o=Math.pow(2,r),a=[[-1,1,-1,1],[1,1,-1,1],[1,-1,-1,1],[-1,-1,-1,1],[-1,1,1,1],[1,1,1,1],[1,-1,1,1],[-1,-1,1,1]].map((function(i){return t.transformMat4([],i,e)})).map((function(e){return t.scale$1([],e,1/e[3]/i*o)})),n=[[0,1,2],[6,5,4],[0,3,7],[2,1,5],[3,2,6],[0,4,5]].map((function(e){var i=t.sub([],a[e[0]],a[e[1]]),r=t.sub([],a[e[2]],a[e[1]]),o=t.normalize([],t.cross([],i,r)),n=-t.dot(o,a[e[1]]);return o.concat(n)}));return new wi(a,n)};var Ei=function(e,i){this.min=e,this.max=i,this.center=t.scale$2([],t.add([],this.min,this.max),.5)};Ei.prototype.quadrant=function(e){for(var i=[e%2==0,e<2],r=t.clone$2(this.min),o=t.clone$2(this.max),a=0;a<i.length;a++)r[a]=i[a]?this.min[a]:this.center[a],o[a]=i[a]?this.center[a]:this.max[a];return o[2]=this.max[2],new Ei(r,o)},Ei.prototype.distanceX=function(t){return Math.max(Math.min(this.max[0],t[0]),this.min[0])-t[0]},Ei.prototype.distanceY=function(t){return Math.max(Math.min(this.max[1],t[1]),this.min[1])-t[1]},Ei.prototype.intersects=function(e){for(var i=[[this.min[0],this.min[1],0,1],[this.max[0],this.min[1],0,1],[this.max[0],this.max[1],0,1],[this.min[0],this.max[1],0,1]],r=!0,o=0;o<e.planes.length;o++){for(var a=e.planes[o],n=0,s=0;s<i.length;s++)n+=t.dot$1(a,i[s])>=0;if(0===n)return 0;n!==i.length&&(r=!1)}if(r)return 2;for(var l=0;l<3;l++){for(var c=Number.MAX_VALUE,u=-Number.MAX_VALUE,h=0;h<e.points.length;h++){var p=e.points[h][l]-this.min[l];c=Math.min(c,p),u=Math.max(u,p)}if(u<0||c>this.max[l]-this.min[l])return 0}return 1};var ki=function(t,e,i,r){if(void 0===t&&(t=0),void 0===e&&(e=0),void 0===i&&(i=0),void 0===r&&(r=0),isNaN(t)||t<0||isNaN(e)||e<0||isNaN(i)||i<0||isNaN(r)||r<0)throw new Error("Invalid value for edge-insets, top, bottom, left and right must all be numbers");this.top=t,this.bottom=e,this.left=i,this.right=r};ki.prototype.interpolate=function(e,i,r){return null!=i.top&&null!=e.top&&(this.top=t.number(e.top,i.top,r)),null!=i.bottom&&null!=e.bottom&&(this.bottom=t.number(e.bottom,i.bottom,r)),null!=i.left&&null!=e.left&&(this.left=t.number(e.left,i.left,r)),null!=i.right&&null!=e.right&&(this.right=t.number(e.right,i.right,r)),this},ki.prototype.getCenter=function(e,i){var r=t.clamp((this.left+e-this.right)/2,0,e),o=t.clamp((this.top+i-this.bottom)/2,0,i);return new t.Point(r,o)},ki.prototype.equals=function(t){return this.top===t.top&&this.bottom===t.bottom&&this.left===t.left&&this.right===t.right},ki.prototype.clone=function(){return new ki(this.top,this.bottom,this.left,this.right)},ki.prototype.toJSON=function(){return{top:this.top,bottom:this.bottom,left:this.left,right:this.right}};var Si=function(e,i,r,o,a){this.tileSize=512,this.maxValidLatitude=85.051129,this._renderWorldCopies=void 0===a||a,this._minZoom=e||0,this._maxZoom=i||22,this._minPitch=null==r?0:r,this._maxPitch=null==o?60:o,this.setMaxBounds(),this.width=0,this.height=0,this._center=new t.LngLat(0,0),this.zoom=0,this.angle=0,this._fov=.6435011087932844,this._pitch=0,this._unmodified=!0,this._edgeInsets=new ki,this._posMatrixCache={},this._alignedPosMatrixCache={}},Ti={minZoom:{configurable:!0},maxZoom:{configurable:!0},minPitch:{configurable:!0},maxPitch:{configurable:!0},renderWorldCopies:{configurable:!0},worldSize:{configurable:!0},centerOffset:{configurable:!0},size:{configurable:!0},bearing:{configurable:!0},pitch:{configurable:!0},fov:{configurable:!0},zoom:{configurable:!0},center:{configurable:!0},padding:{configurable:!0},centerPoint:{configurable:!0},unmodified:{configurable:!0},point:{configurable:!0}};Si.prototype.clone=function(){var t=new Si(this._minZoom,this._maxZoom,this._minPitch,this.maxPitch,this._renderWorldCopies);return t.tileSize=this.tileSize,t.latRange=this.latRange,t.width=this.width,t.height=this.height,t._center=this._center,t.zoom=this.zoom,t.angle=this.angle,t._fov=this._fov,t._pitch=this._pitch,t._unmodified=this._unmodified,t._edgeInsets=this._edgeInsets.clone(),t._calcMatrices(),t},Ti.minZoom.get=function(){return this._minZoom},Ti.minZoom.set=function(t){this._minZoom!==t&&(this._minZoom=t,this.zoom=Math.max(this.zoom,t))},Ti.maxZoom.get=function(){return this._maxZoom},Ti.maxZoom.set=function(t){this._maxZoom!==t&&(this._maxZoom=t,this.zoom=Math.min(this.zoom,t))},Ti.minPitch.get=function(){return this._minPitch},Ti.minPitch.set=function(t){this._minPitch!==t&&(this._minPitch=t,this.pitch=Math.max(this.pitch,t))},Ti.maxPitch.get=function(){return this._maxPitch},Ti.maxPitch.set=function(t){this._maxPitch!==t&&(this._maxPitch=t,this.pitch=Math.min(this.pitch,t))},Ti.renderWorldCopies.get=function(){return this._renderWorldCopies},Ti.renderWorldCopies.set=function(t){void 0===t?t=!0:null===t&&(t=!1),this._renderWorldCopies=t},Ti.worldSize.get=function(){return this.tileSize*this.scale},Ti.centerOffset.get=function(){return this.centerPoint._sub(this.size._div(2))},Ti.size.get=function(){return new t.Point(this.width,this.height)},Ti.bearing.get=function(){return-this.angle/Math.PI*180},Ti.bearing.set=function(e){var i=-t.wrap(e,-180,180)*Math.PI/180;this.angle!==i&&(this._unmodified=!1,this.angle=i,this._calcMatrices(),this.rotationMatrix=t.create$2(),t.rotate(this.rotationMatrix,this.rotationMatrix,this.angle))},Ti.pitch.get=function(){return this._pitch/Math.PI*180},Ti.pitch.set=function(e){var i=t.clamp(e,this.minPitch,this.maxPitch)/180*Math.PI;this._pitch!==i&&(this._unmodified=!1,this._pitch=i,this._calcMatrices())},Ti.fov.get=function(){return this._fov/Math.PI*180},Ti.fov.set=function(t){t=Math.max(.01,Math.min(60,t)),this._fov!==t&&(this._unmodified=!1,this._fov=t/180*Math.PI,this._calcMatrices())},Ti.zoom.get=function(){return this._zoom},Ti.zoom.set=function(t){var e=Math.min(Math.max(t,this.minZoom),this.maxZoom);this._zoom!==e&&(this._unmodified=!1,this._zoom=e,this.scale=this.zoomScale(e),this.tileZoom=Math.floor(e),this.zoomFraction=e-this.tileZoom,this._constrain(),this._calcMatrices())},Ti.center.get=function(){return this._center},Ti.center.set=function(t){t.lat===this._center.lat&&t.lng===this._center.lng||(this._unmodified=!1,this._center=t,this._constrain(),this._calcMatrices())},Ti.padding.get=function(){return this._edgeInsets.toJSON()},Ti.padding.set=function(t){this._edgeInsets.equals(t)||(this._unmodified=!1,this._edgeInsets.interpolate(this._edgeInsets,t,1),this._calcMatrices())},Ti.centerPoint.get=function(){return this._edgeInsets.getCenter(this.width,this.height)},Si.prototype.isPaddingEqual=function(t){return this._edgeInsets.equals(t)},Si.prototype.interpolatePadding=function(t,e,i){this._unmodified=!1,this._edgeInsets.interpolate(t,e,i),this._constrain(),this._calcMatrices()},Si.prototype.coveringZoomLevel=function(t){var e=(t.roundZoom?Math.round:Math.floor)(this.zoom+this.scaleZoom(this.tileSize/t.tileSize));return Math.max(0,e)},Si.prototype.getVisibleUnwrappedCoordinates=function(e){var i=[new t.UnwrappedTileID(0,e)];if(this._renderWorldCopies)for(var r=this.pointCoordinate(new t.Point(0,0)),o=this.pointCoordinate(new t.Point(this.width,0)),a=this.pointCoordinate(new t.Point(this.width,this.height)),n=this.pointCoordinate(new t.Point(0,this.height)),s=Math.floor(Math.min(r.x,o.x,a.x,n.x)),l=Math.floor(Math.max(r.x,o.x,a.x,n.x)),c=s-1;c<=l+1;c++)0!==c&&i.push(new t.UnwrappedTileID(c,e));return i},Si.prototype.coveringTiles=function(e){var i=this.coveringZoomLevel(e),r=i;if(void 0!==e.minzoom&&i<e.minzoom)return[];void 0!==e.maxzoom&&i>e.maxzoom&&(i=e.maxzoom);var o=t.MercatorCoordinate.fromLngLat(this.center),a=Math.pow(2,i),n=[a*o.x,a*o.y,0],s=wi.fromInvProjectionMatrix(this.invProjMatrix,this.worldSize,i),l=e.minzoom||0;this.pitch<=60&&this._edgeInsets.top<.1&&(l=i);var c=function(t){return{aabb:new Ei([t*a,0,0],[(t+1)*a,a,0]),zoom:0,x:0,y:0,wrap:t,fullyVisible:!1}},u=[],h=[],p=i,d=e.reparseOverscaled?r:i;if(this._renderWorldCopies)for(var f=1;f<=3;f++)u.push(c(-f)),u.push(c(f));for(u.push(c(0));u.length>0;){var m=u.pop(),y=m.x,g=m.y,v=m.fullyVisible;if(!v){var _=m.aabb.intersects(s);if(0===_)continue;v=2===_}var x=m.aabb.distanceX(n),b=m.aabb.distanceY(n),w=Math.max(Math.abs(x),Math.abs(b));if(m.zoom===p||w>3+(1<<p-m.zoom)-2&&m.zoom>=l)h.push({tileID:new t.OverscaledTileID(m.zoom===p?d:m.zoom,m.wrap,m.zoom,y,g),distanceSq:t.sqrLen([n[0]-.5-y,n[1]-.5-g])});else for(var E=0;E<4;E++){var k=(y<<1)+E%2,S=(g<<1)+(E>>1);u.push({aabb:m.aabb.quadrant(E),zoom:m.zoom+1,x:k,y:S,wrap:m.wrap,fullyVisible:v})}}return h.sort((function(t,e){return t.distanceSq-e.distanceSq})).map((function(t){return t.tileID}))},Si.prototype.resize=function(t,e){this.width=t,this.height=e,this.pixelsToGLUnits=[2/t,-2/e],this._constrain(),this._calcMatrices()},Ti.unmodified.get=function(){return this._unmodified},Si.prototype.zoomScale=function(t){return Math.pow(2,t)},Si.prototype.scaleZoom=function(t){return Math.log(t)/Math.LN2},Si.prototype.project=function(e){var i=t.clamp(e.lat,-this.maxValidLatitude,this.maxValidLatitude);return new t.Point(t.mercatorXfromLng(e.lng)*this.worldSize,t.mercatorYfromLat(i)*this.worldSize)},Si.prototype.unproject=function(e){return new t.MercatorCoordinate(e.x/this.worldSize,e.y/this.worldSize).toLngLat()},Ti.point.get=function(){return this.project(this.center)},Si.prototype.setLocationAtPoint=function(e,i){var r=this.pointCoordinate(i),o=this.pointCoordinate(this.centerPoint),a=this.locationCoordinate(e),n=new t.MercatorCoordinate(a.x-(r.x-o.x),a.y-(r.y-o.y));this.center=this.coordinateLocation(n),this._renderWorldCopies&&(this.center=this.center.wrap())},Si.prototype.locationPoint=function(t){return this.coordinatePoint(this.locationCoordinate(t))},Si.prototype.pointLocation=function(t){return this.coordinateLocation(this.pointCoordinate(t))},Si.prototype.locationCoordinate=function(e){return t.MercatorCoordinate.fromLngLat(e)},Si.prototype.coordinateLocation=function(t){return t.toLngLat()},Si.prototype.pointCoordinate=function(e){var i=[e.x,e.y,0,1],r=[e.x,e.y,1,1];t.transformMat4(i,i,this.pixelMatrixInverse),t.transformMat4(r,r,this.pixelMatrixInverse);var o=i[3],a=r[3],n=i[1]/o,s=r[1]/a,l=i[2]/o,c=r[2]/a,u=l===c?0:(0-l)/(c-l);return new t.MercatorCoordinate(t.number(i[0]/o,r[0]/a,u)/this.worldSize,t.number(n,s,u)/this.worldSize)},Si.prototype.coordinatePoint=function(e){var i=[e.x*this.worldSize,e.y*this.worldSize,0,1];return t.transformMat4(i,i,this.pixelMatrix),new t.Point(i[0]/i[3],i[1]/i[3])},Si.prototype.getBounds=function(){return(new t.LngLatBounds).extend(this.pointLocation(new t.Point(0,0))).extend(this.pointLocation(new t.Point(this.width,0))).extend(this.pointLocation(new t.Point(this.width,this.height))).extend(this.pointLocation(new t.Point(0,this.height)))},Si.prototype.getMaxBounds=function(){return this.latRange&&2===this.latRange.length&&this.lngRange&&2===this.lngRange.length?new t.LngLatBounds([this.lngRange[0],this.latRange[0]],[this.lngRange[1],this.latRange[1]]):null},Si.prototype.setMaxBounds=function(t){t?(this.lngRange=[t.getWest(),t.getEast()],this.latRange=[t.getSouth(),t.getNorth()],this._constrain()):(this.lngRange=null,this.latRange=[-this.maxValidLatitude,this.maxValidLatitude])},Si.prototype.calculatePosMatrix=function(e,i){void 0===i&&(i=!1);var r=e.key,o=i?this._alignedPosMatrixCache:this._posMatrixCache;if(o[r])return o[r];var a=e.canonical,n=this.worldSize/this.zoomScale(a.z),s=a.x+Math.pow(2,a.z)*e.wrap,l=t.identity(new Float64Array(16));return t.translate(l,l,[s*n,a.y*n,0]),t.scale(l,l,[n/t.EXTENT,n/t.EXTENT,1]),t.multiply(l,i?this.alignedProjMatrix:this.projMatrix,l),o[r]=new Float32Array(l),o[r]},Si.prototype.customLayerMatrix=function(){return this.mercatorMatrix.slice()},Si.prototype._constrain=function(){if(this.center&&this.width&&this.height&&!this._constraining){this._constraining=!0;var e,i,r,o,a=-90,n=90,s=-180,l=180,c=this.size,u=this._unmodified;if(this.latRange){var h=this.latRange;a=t.mercatorYfromLat(h[1])*this.worldSize,e=(n=t.mercatorYfromLat(h[0])*this.worldSize)-a<c.y?c.y/(n-a):0}if(this.lngRange){var p=this.lngRange;s=t.mercatorXfromLng(p[0])*this.worldSize,i=(l=t.mercatorXfromLng(p[1])*this.worldSize)-s<c.x?c.x/(l-s):0}var d=this.point,f=Math.max(i||0,e||0);if(f)return this.center=this.unproject(new t.Point(i?(l+s)/2:d.x,e?(n+a)/2:d.y)),this.zoom+=this.scaleZoom(f),this._unmodified=u,void(this._constraining=!1);if(this.latRange){var m=d.y,y=c.y/2;m-y<a&&(o=a+y),m+y>n&&(o=n-y)}if(this.lngRange){var g=d.x,v=c.x/2;g-v<s&&(r=s+v),g+v>l&&(r=l-v)}void 0===r&&void 0===o||(this.center=this.unproject(new t.Point(void 0!==r?r:d.x,void 0!==o?o:d.y))),this._unmodified=u,this._constraining=!1}},Si.prototype._calcMatrices=function(){if(this.height){var e=this.centerOffset;this.cameraToCenterDistance=.5/Math.tan(this._fov/2)*this.height;var i=Math.PI/2+this._pitch,r=this._fov*(.5+e.y/this.height),o=Math.sin(r)*this.cameraToCenterDistance/Math.sin(t.clamp(Math.PI-i-r,.01,Math.PI-.01)),a=this.point,n=a.x,s=a.y,l=1.01*(Math.cos(Math.PI/2-this._pitch)*o+this.cameraToCenterDistance),c=this.height/50,u=new Float64Array(16);t.perspective(u,this._fov,this.width/this.height,c,l),u[8]=2*-e.x/this.width,u[9]=2*e.y/this.height,t.scale(u,u,[1,-1,1]),t.translate(u,u,[0,0,-this.cameraToCenterDistance]),t.rotateX(u,u,this._pitch),t.rotateZ(u,u,this.angle),t.translate(u,u,[-n,-s,0]),this.mercatorMatrix=t.scale([],u,[this.worldSize,this.worldSize,this.worldSize]),t.scale(u,u,[1,1,t.mercatorZfromAltitude(1,this.center.lat)*this.worldSize,1]),this.projMatrix=u,this.invProjMatrix=t.invert([],this.projMatrix);var h=this.width%2/2,p=this.height%2/2,d=Math.cos(this.angle),f=Math.sin(this.angle),m=n-Math.round(n)+d*h+f*p,y=s-Math.round(s)+d*p+f*h,g=new Float64Array(u);if(t.translate(g,g,[m>.5?m-1:m,y>.5?y-1:y,0]),this.alignedProjMatrix=g,u=t.create(),t.scale(u,u,[this.width/2,-this.height/2,1]),t.translate(u,u,[1,-1,0]),this.labelPlaneMatrix=u,u=t.create(),t.scale(u,u,[1,-1,1]),t.translate(u,u,[-1,-1,0]),t.scale(u,u,[2/this.width,2/this.height,1]),this.glCoordMatrix=u,this.pixelMatrix=t.multiply(new Float64Array(16),this.labelPlaneMatrix,this.projMatrix),!(u=t.invert(new Float64Array(16),this.pixelMatrix)))throw new Error("failed to invert matrix");this.pixelMatrixInverse=u,this._posMatrixCache={},this._alignedPosMatrixCache={}}},Si.prototype.maxPitchScaleFactor=function(){if(!this.pixelMatrixInverse)return 1;var e=this.pointCoordinate(new t.Point(0,0)),i=[e.x*this.worldSize,e.y*this.worldSize,0,1];return t.transformMat4(i,i,this.pixelMatrix)[3]/this.cameraToCenterDistance},Si.prototype.getCameraPoint=function(){var e=Math.tan(this._pitch)*(this.cameraToCenterDistance||1);return this.centerPoint.add(new t.Point(0,e))},Si.prototype.getCameraQueryGeometry=function(e){var i=this.getCameraPoint();if(1===e.length)return[e[0],i];for(var r=i.x,o=i.y,a=i.x,n=i.y,s=0,l=e;s<l.length;s+=1){var c=l[s];r=Math.min(r,c.x),o=Math.min(o,c.y),a=Math.max(a,c.x),n=Math.max(n,c.y)}return[new t.Point(r,o),new t.Point(a,o),new t.Point(a,n),new t.Point(r,n),new t.Point(r,o)]},Object.defineProperties(Si.prototype,Ti);var Ii=function(e){var i,r,o,a;this._hashName=e&&encodeURIComponent(e),t.bindAll(["_getCurrentHash","_onHashChange","_updateHash"],this),this._updateHash=(i=this._updateHashUnthrottled.bind(this),r=!1,o=null,a=function(){o=null,r&&(i(),o=setTimeout(a,300),r=!1)},function(){return r=!0,o||a(),o})};Ii.prototype.addTo=function(e){return this._map=e,t.window.addEventListener("hashchange",this._onHashChange,!1),this._map.on("moveend",this._updateHash),this},Ii.prototype.remove=function(){return t.window.removeEventListener("hashchange",this._onHashChange,!1),this._map.off("moveend",this._updateHash),clearTimeout(this._updateHash()),delete this._map,this},Ii.prototype.getHashString=function(e){var i=this._map.getCenter(),r=Math.round(100*this._map.getZoom())/100,o=Math.ceil((r*Math.LN2+Math.log(512/360/.5))/Math.LN10),a=Math.pow(10,o),n=Math.round(i.lng*a)/a,s=Math.round(i.lat*a)/a,l=this._map.getBearing(),c=this._map.getPitch(),u="";if(u+=e?"/"+n+"/"+s+"/"+r:r+"/"+s+"/"+n,(l||c)&&(u+="/"+Math.round(10*l)/10),c&&(u+="/"+Math.round(c)),this._hashName){var h=this._hashName,p=!1,d=t.window.location.hash.slice(1).split("&").map((function(t){var e=t.split("=")[0];return e===h?(p=!0,e+"="+u):t})).filter((function(t){return t}));return p||d.push(h+"="+u),"#"+d.join("&")}return"#"+u},Ii.prototype._getCurrentHash=function(){var e,i=this,r=t.window.location.hash.replace("#","");return this._hashName?(r.split("&").map((function(t){return t.split("=")})).forEach((function(t){t[0]===i._hashName&&(e=t)})),(e&&e[1]||"").split("/")):r.split("/")},Ii.prototype._onHashChange=function(){var t=this._getCurrentHash();if(t.length>=3&&!t.some((function(t){return isNaN(t)}))){var e=this._map.dragRotate.isEnabled()&&this._map.touchZoomRotate.isEnabled()?+(t[3]||0):this._map.getBearing();return this._map.jumpTo({center:[+t[2],+t[1]],zoom:+t[0],bearing:e,pitch:+(t[4]||0)}),!0}return!1},Ii.prototype._updateHashUnthrottled=function(){var e=this.getHashString();try{t.window.history.replaceState(t.window.history.state,"",e)}catch(t){}};var zi={linearity:.3,easing:t.bezier(0,0,.3,1)},Ci=t.extend({deceleration:2500,maxSpeed:1400},zi),Pi=t.extend({deceleration:20,maxSpeed:1400},zi),Ai=t.extend({deceleration:1e3,maxSpeed:360},zi),Mi=t.extend({deceleration:1e3,maxSpeed:90},zi),Li=function(t){this._map=t,this.clear()};function Ri(t,e){(!t.duration||t.duration<e.duration)&&(t.duration=e.duration,t.easing=e.easing)}function Di(e,i,r){var o=r.maxSpeed,a=r.linearity,n=r.deceleration,s=t.clamp(e*a/(i/1e3),-o,o),l=Math.abs(s)/(n*a);return{easing:r.easing,duration:1e3*l,amount:s*(l/2)}}Li.prototype.clear=function(){this._inertiaBuffer=[]},Li.prototype.record=function(e){this._drainInertiaBuffer(),this._inertiaBuffer.push({time:t.browser.now(),settings:e})},Li.prototype._drainInertiaBuffer=function(){for(var e=this._inertiaBuffer,i=t.browser.now();e.length>0&&i-e[0].time>160;)e.shift()},Li.prototype._onMoveEnd=function(e){if(this._drainInertiaBuffer(),!(this._inertiaBuffer.length<2)){for(var i={zoom:0,bearing:0,pitch:0,pan:new t.Point(0,0),pinchAround:void 0,around:void 0},r=0,o=this._inertiaBuffer;r<o.length;r+=1){var a=o[r].settings;i.zoom+=a.zoomDelta||0,i.bearing+=a.bearingDelta||0,i.pitch+=a.pitchDelta||0,a.panDelta&&i.pan._add(a.panDelta),a.around&&(i.around=a.around),a.pinchAround&&(i.pinchAround=a.pinchAround)}var n=this._inertiaBuffer[this._inertiaBuffer.length-1].time-this._inertiaBuffer[0].time,s={};if(i.pan.mag()){var l=Di(i.pan.mag(),n,t.extend({},Ci,e||{}));s.offset=i.pan.mult(l.amount/i.pan.mag()),s.center=this._map.transform.center,Ri(s,l)}if(i.zoom){var c=Di(i.zoom,n,Pi);s.zoom=this._map.transform.zoom+c.amount,Ri(s,c)}if(i.bearing){var u=Di(i.bearing,n,Ai);s.bearing=this._map.transform.bearing+t.clamp(u.amount,-179,179),Ri(s,u)}if(i.pitch){var h=Di(i.pitch,n,Mi);s.pitch=this._map.transform.pitch+h.amount,Ri(s,h)}if(s.zoom||s.bearing){var p=void 0===i.pinchAround?i.around:i.pinchAround;s.around=p?this._map.unproject(p):this._map.getCenter()}return this.clear(),t.extend(s,{noMoveStart:!0})}};var Oi=function(e){function r(r,o,a,n){void 0===n&&(n={});var s=i.mousePos(o.getCanvasContainer(),a),l=o.unproject(s);e.call(this,r,t.extend({point:s,lngLat:l,originalEvent:a},n)),this._defaultPrevented=!1,this.target=o}e&&(r.__proto__=e),(r.prototype=Object.create(e&&e.prototype)).constructor=r;var o={defaultPrevented:{configurable:!0}};return r.prototype.preventDefault=function(){this._defaultPrevented=!0},o.defaultPrevented.get=function(){return this._defaultPrevented},Object.defineProperties(r.prototype,o),r}(t.Event),Bi=function(e){function r(r,o,a){var n="touchend"===r?a.changedTouches:a.touches,s=i.touchPos(o.getCanvasContainer(),n),l=s.map((function(t){return o.unproject(t)})),c=s.reduce((function(t,e,i,r){return t.add(e.div(r.length))}),new t.Point(0,0)),u=o.unproject(c);e.call(this,r,{points:s,point:c,lngLats:l,lngLat:u,originalEvent:a}),this._defaultPrevented=!1}e&&(r.__proto__=e),(r.prototype=Object.create(e&&e.prototype)).constructor=r;var o={defaultPrevented:{configurable:!0}};return r.prototype.preventDefault=function(){this._defaultPrevented=!0},o.defaultPrevented.get=function(){return this._defaultPrevented},Object.defineProperties(r.prototype,o),r}(t.Event),Fi=function(t){function e(e,i,r){t.call(this,e,{originalEvent:r}),this._defaultPrevented=!1}t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e;var i={defaultPrevented:{configurable:!0}};return e.prototype.preventDefault=function(){this._defaultPrevented=!0},i.defaultPrevented.get=function(){return this._defaultPrevented},Object.defineProperties(e.prototype,i),e}(t.Event),Ui=function(t,e){this._map=t,this._clickTolerance=e.clickTolerance};Ui.prototype.reset=function(){delete this._mousedownPos},Ui.prototype.wheel=function(t){return this._firePreventable(new Fi(t.type,this._map,t))},Ui.prototype.mousedown=function(t,e){return this._mousedownPos=e,this._firePreventable(new Oi(t.type,this._map,t))},Ui.prototype.mouseup=function(t){this._map.fire(new Oi(t.type,this._map,t))},Ui.prototype.click=function(t,e){this._mousedownPos&&this._mousedownPos.dist(e)>=this._clickTolerance||this._map.fire(new Oi(t.type,this._map,t))},Ui.prototype.dblclick=function(t){return this._firePreventable(new Oi(t.type,this._map,t))},Ui.prototype.mouseover=function(t){this._map.fire(new Oi(t.type,this._map,t))},Ui.prototype.mouseout=function(t){this._map.fire(new Oi(t.type,this._map,t))},Ui.prototype.touchstart=function(t){return this._firePreventable(new Bi(t.type,this._map,t))},Ui.prototype.touchmove=function(t){this._map.fire(new Bi(t.type,this._map,t))},Ui.prototype.touchend=function(t){this._map.fire(new Bi(t.type,this._map,t))},Ui.prototype.touchcancel=function(t){this._map.fire(new Bi(t.type,this._map,t))},Ui.prototype._firePreventable=function(t){if(this._map.fire(t),t.defaultPrevented)return{}},Ui.prototype.isEnabled=function(){return!0},Ui.prototype.isActive=function(){return!1},Ui.prototype.enable=function(){},Ui.prototype.disable=function(){};var Ni=function(t){this._map=t};Ni.prototype.reset=function(){this._delayContextMenu=!1,delete this._contextMenuEvent},Ni.prototype.mousemove=function(t){this._map.fire(new Oi(t.type,this._map,t))},Ni.prototype.mousedown=function(){this._delayContextMenu=!0},Ni.prototype.mouseup=function(){this._delayContextMenu=!1,this._contextMenuEvent&&(this._map.fire(new Oi("contextmenu",this._map,this._contextMenuEvent)),delete this._contextMenuEvent)},Ni.prototype.contextmenu=function(t){this._delayContextMenu?this._contextMenuEvent=t:this._map.fire(new Oi(t.type,this._map,t)),this._map.listens("contextmenu")&&t.preventDefault()},Ni.prototype.isEnabled=function(){return!0},Ni.prototype.isActive=function(){return!1},Ni.prototype.enable=function(){},Ni.prototype.disable=function(){};var ji=function(t,e){this._map=t,this._el=t.getCanvasContainer(),this._container=t.getContainer(),this._clickTolerance=e.clickTolerance||1};function Vi(t,e){for(var i={},r=0;r<t.length;r++)i[t[r].identifier]=e[r];return i}ji.prototype.isEnabled=function(){return!!this._enabled},ji.prototype.isActive=function(){return!!this._active},ji.prototype.enable=function(){this.isEnabled()||(this._enabled=!0)},ji.prototype.disable=function(){this.isEnabled()&&(this._enabled=!1)},ji.prototype.mousedown=function(t,e){this.isEnabled()&&t.shiftKey&&0===t.button&&(i.disableDrag(),this._startPos=this._lastPos=e,this._active=!0)},ji.prototype.mousemoveWindow=function(t,e){if(this._active){var r=e;if(!(this._lastPos.equals(r)||!this._box&&r.dist(this._startPos)<this._clickTolerance)){var o=this._startPos;this._lastPos=r,this._box||(this._box=i.create("div","mapboxgl-boxzoom",this._container),this._container.classList.add("mapboxgl-crosshair"),this._fireEvent("boxzoomstart",t));var a=Math.min(o.x,r.x),n=Math.max(o.x,r.x),s=Math.min(o.y,r.y),l=Math.max(o.y,r.y);i.setTransform(this._box,"translate("+a+"px,"+s+"px)"),this._box.style.width=n-a+"px",this._box.style.height=l-s+"px"}}},ji.prototype.mouseupWindow=function(e,r){var o=this;if(this._active&&0===e.button){var a=this._startPos,n=r;if(this.reset(),i.suppressClick(),a.x!==n.x||a.y!==n.y)return this._map.fire(new t.Event("boxzoomend",{originalEvent:e})),{cameraAnimation:function(t){return t.fitScreenCoordinates(a,n,o._map.getBearing(),{linear:!0})}};this._fireEvent("boxzoomcancel",e)}},ji.prototype.keydown=function(t){this._active&&27===t.keyCode&&(this.reset(),this._fireEvent("boxzoomcancel",t))},ji.prototype.reset=function(){this._active=!1,this._container.classList.remove("mapboxgl-crosshair"),this._box&&(i.remove(this._box),this._box=null),i.enableDrag(),delete this._startPos,delete this._lastPos},ji.prototype._fireEvent=function(e,i){return this._map.fire(new t.Event(e,{originalEvent:i}))};var qi=function(t){this.reset(),this.numTouches=t.numTouches};qi.prototype.reset=function(){delete this.centroid,delete this.startTime,delete this.touches,this.aborted=!1},qi.prototype.touchstart=function(e,i,r){(this.centroid||r.length>this.numTouches)&&(this.aborted=!0),this.aborted||(void 0===this.startTime&&(this.startTime=e.timeStamp),r.length===this.numTouches&&(this.centroid=function(e){for(var i=new t.Point(0,0),r=0,o=e;r<o.length;r+=1)i._add(o[r]);return i.div(e.length)}(i),this.touches=Vi(r,i)))},qi.prototype.touchmove=function(t,e,i){if(!this.aborted&&this.centroid){var r=Vi(i,e);for(var o in this.touches){var a=r[o];(!a||a.dist(this.touches[o])>30)&&(this.aborted=!0)}}},qi.prototype.touchend=function(t,e,i){if((!this.centroid||t.timeStamp-this.startTime>500)&&(this.aborted=!0),0===i.length){var r=!this.aborted&&this.centroid;if(this.reset(),r)return r}};var Gi=function(t){this.singleTap=new qi(t),this.numTaps=t.numTaps,this.reset()};Gi.prototype.reset=function(){this.lastTime=1/0,delete this.lastTap,this.count=0,this.singleTap.reset()},Gi.prototype.touchstart=function(t,e,i){this.singleTap.touchstart(t,e,i)},Gi.prototype.touchmove=function(t,e,i){this.singleTap.touchmove(t,e,i)},Gi.prototype.touchend=function(t,e,i){var r=this.singleTap.touchend(t,e,i);if(r){var o=t.timeStamp-this.lastTime<500,a=!this.lastTap||this.lastTap.dist(r)<30;if(o&&a||this.reset(),this.count++,this.lastTime=t.timeStamp,this.lastTap=r,this.count===this.numTaps)return this.reset(),r}};var Zi=function(){this._zoomIn=new Gi({numTouches:1,numTaps:2}),this._zoomOut=new Gi({numTouches:2,numTaps:1}),this.reset()};Zi.prototype.reset=function(){this._active=!1,this._zoomIn.reset(),this._zoomOut.reset()},Zi.prototype.touchstart=function(t,e,i){this._zoomIn.touchstart(t,e,i),this._zoomOut.touchstart(t,e,i)},Zi.prototype.touchmove=function(t,e,i){this._zoomIn.touchmove(t,e,i),this._zoomOut.touchmove(t,e,i)},Zi.prototype.touchend=function(t,e,i){var r=this,o=this._zoomIn.touchend(t,e,i),a=this._zoomOut.touchend(t,e,i);return o?(this._active=!0,t.preventDefault(),setTimeout((function(){return r.reset()}),0),{cameraAnimation:function(e){return e.easeTo({duration:300,zoom:e.getZoom()+1,around:e.unproject(o)},{originalEvent:t})}}):a?(this._active=!0,t.preventDefault(),setTimeout((function(){return r.reset()}),0),{cameraAnimation:function(e){return e.easeTo({duration:300,zoom:e.getZoom()-1,around:e.unproject(a)},{originalEvent:t})}}):void 0},Zi.prototype.touchcancel=function(){this.reset()},Zi.prototype.enable=function(){this._enabled=!0},Zi.prototype.disable=function(){this._enabled=!1,this.reset()},Zi.prototype.isEnabled=function(){return this._enabled},Zi.prototype.isActive=function(){return this._active};var Hi={0:1,2:2},Ki=function(t){this.reset(),this._clickTolerance=t.clickTolerance||1};Ki.prototype.reset=function(){this._active=!1,this._moved=!1,delete this._lastPoint,delete this._eventButton},Ki.prototype._correctButton=function(t,e){return!1},Ki.prototype._move=function(t,e){return{}},Ki.prototype.mousedown=function(t,e){if(!this._lastPoint){var r=i.mouseButton(t);this._correctButton(t,r)&&(this._lastPoint=e,this._eventButton=r)}},Ki.prototype.mousemoveWindow=function(t,e){var i=this._lastPoint;if(i)if(t.preventDefault(),function(t,e){var i=Hi[e];return void 0===t.buttons||(t.buttons&i)!==i}(t,this._eventButton))this.reset();else if(this._moved||!(e.dist(i)<this._clickTolerance))return this._moved=!0,this._lastPoint=e,this._move(i,e)},Ki.prototype.mouseupWindow=function(t){this._lastPoint&&i.mouseButton(t)===this._eventButton&&(this._moved&&i.suppressClick(),this.reset())},Ki.prototype.enable=function(){this._enabled=!0},Ki.prototype.disable=function(){this._enabled=!1,this.reset()},Ki.prototype.isEnabled=function(){return this._enabled},Ki.prototype.isActive=function(){return this._active};var Wi=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e,e.prototype.mousedown=function(e,i){t.prototype.mousedown.call(this,e,i),this._lastPoint&&(this._active=!0)},e.prototype._correctButton=function(t,e){return 0===e&&!t.ctrlKey},e.prototype._move=function(t,e){return{around:e,panDelta:e.sub(t)}},e}(Ki),Xi=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e,e.prototype._correctButton=function(t,e){return 0===e&&t.ctrlKey||2===e},e.prototype._move=function(t,e){var i=.8*(e.x-t.x);if(i)return this._active=!0,{bearingDelta:i}},e.prototype.contextmenu=function(t){t.preventDefault()},e}(Ki),$i=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e,e.prototype._correctButton=function(t,e){return 0===e&&t.ctrlKey||2===e},e.prototype._move=function(t,e){var i=-.5*(e.y-t.y);if(i)return this._active=!0,{pitchDelta:i}},e.prototype.contextmenu=function(t){t.preventDefault()},e}(Ki),Ji=function(t){this._minTouches=1,this._clickTolerance=t.clickTolerance||1,this.reset()};Ji.prototype.reset=function(){this._active=!1,this._touches={},this._sum=new t.Point(0,0)},Ji.prototype.touchstart=function(t,e,i){return this._calculateTransform(t,e,i)},Ji.prototype.touchmove=function(t,e,i){if(this._active)return t.preventDefault(),this._calculateTransform(t,e,i)},Ji.prototype.touchend=function(t,e,i){this._calculateTransform(t,e,i),this._active&&i.length<this._minTouches&&this.reset()},Ji.prototype.touchcancel=function(){this.reset()},Ji.prototype._calculateTransform=function(e,i,r){r.length>0&&(this._active=!0);var o=Vi(r,i),a=new t.Point(0,0),n=new t.Point(0,0),s=0;for(var l in o){var c=o[l],u=this._touches[l];u&&(a._add(c),n._add(c.sub(u)),s++,o[l]=c)}if(this._touches=o,!(s<this._minTouches)&&n.mag()){var h=n.div(s);if(this._sum._add(h),!(this._sum.mag()<this._clickTolerance))return{around:a.div(s),panDelta:h}}},Ji.prototype.enable=function(){this._enabled=!0},Ji.prototype.disable=function(){this._enabled=!1,this.reset()},Ji.prototype.isEnabled=function(){return this._enabled},Ji.prototype.isActive=function(){return this._active};var Yi=function(){this.reset()};function Qi(t,e,i){for(var r=0;r<t.length;r++)if(t[r].identifier===i)return e[r]}function to(t,e){return Math.log(t/e)/Math.LN2}Yi.prototype.reset=function(){this._active=!1,delete this._firstTwoTouches},Yi.prototype._start=function(t){},Yi.prototype._move=function(t,e,i){return{}},Yi.prototype.touchstart=function(t,e,i){this._firstTwoTouches||i.length<2||(this._firstTwoTouches=[i[0].identifier,i[1].identifier],this._start([e[0],e[1]]))},Yi.prototype.touchmove=function(t,e,i){if(this._firstTwoTouches){t.preventDefault();var r=this._firstTwoTouches,o=r[1],a=Qi(i,e,r[0]),n=Qi(i,e,o);if(a&&n){var s=this._aroundCenter?null:a.add(n).div(2);return this._move([a,n],s,t)}}},Yi.prototype.touchend=function(t,e,r){if(this._firstTwoTouches){var o=this._firstTwoTouches,a=o[1],n=Qi(r,e,o[0]),s=Qi(r,e,a);n&&s||(this._active&&i.suppressClick(),this.reset())}},Yi.prototype.touchcancel=function(){this.reset()},Yi.prototype.enable=function(t){this._enabled=!0,this._aroundCenter=!!t&&"center"===t.around},Yi.prototype.disable=function(){this._enabled=!1,this.reset()},Yi.prototype.isEnabled=function(){return this._enabled},Yi.prototype.isActive=function(){return this._active};var eo=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e,e.prototype.reset=function(){t.prototype.reset.call(this),delete this._distance,delete this._startDistance},e.prototype._start=function(t){this._startDistance=this._distance=t[0].dist(t[1])},e.prototype._move=function(t,e){var i=this._distance;if(this._distance=t[0].dist(t[1]),this._active||!(Math.abs(to(this._distance,this._startDistance))<.1))return this._active=!0,{zoomDelta:to(this._distance,i),pinchAround:e}},e}(Yi);function tr(t,e){return 180*t.angleWith(e)/Math.PI}var ro=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e,e.prototype.reset=function(){t.prototype.reset.call(this),delete this._minDiameter,delete this._startVector,delete this._vector},e.prototype._start=function(t){this._startVector=this._vector=t[0].sub(t[1]),this._minDiameter=t[0].dist(t[1])},e.prototype._move=function(t,e){var i=this._vector;if(this._vector=t[0].sub(t[1]),this._active||!this._isBelowThreshold(this._vector))return this._active=!0,{bearingDelta:tr(this._vector,i),pinchAround:e}},e.prototype._isBelowThreshold=function(t){this._minDiameter=Math.min(this._minDiameter,t.mag());var e=25/(Math.PI*this._minDiameter)*360,i=tr(t,this._startVector);return Math.abs(i)<e},e}(Yi);function io(t){return Math.abs(t.y)>Math.abs(t.x)}var oo=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e,e.prototype.reset=function(){t.prototype.reset.call(this),this._valid=void 0,delete this._firstMove,delete this._lastPoints},e.prototype._start=function(t){this._lastPoints=t,io(t[0].sub(t[1]))&&(this._valid=!1)},e.prototype._move=function(t,e,i){var r=t[0].sub(this._lastPoints[0]),o=t[1].sub(this._lastPoints[1]);if(this._valid=this.gestureBeginsVertically(r,o,i.timeStamp),this._valid)return this._lastPoints=t,this._active=!0,{pitchDelta:(r.y+o.y)/2*-.5}},e.prototype.gestureBeginsVertically=function(t,e,i){if(void 0!==this._valid)return this._valid;var r=t.mag()>=2,o=e.mag()>=2;if(r||o){if(!r||!o)return void 0===this._firstMove&&(this._firstMove=i),i-this._firstMove<100&&void 0;var a=t.y>0==e.y>0;return io(t)&&io(e)&&a}},e}(Yi),no={panStep:100,bearingStep:15,pitchStep:10},ao=function(){var t=no;this._panStep=t.panStep,this._bearingStep=t.bearingStep,this._pitchStep=t.pitchStep};function so(t){return t*(2-t)}ao.prototype.reset=function(){this._active=!1},ao.prototype.keydown=function(t){var e=this;if(!(t.altKey||t.ctrlKey||t.metaKey)){var i=0,r=0,o=0,a=0,n=0;switch(t.keyCode){case 61:case 107:case 171:case 187:i=1;break;case 189:case 109:case 173:i=-1;break;case 37:t.shiftKey?r=-1:(t.preventDefault(),a=-1);break;case 39:t.shiftKey?r=1:(t.preventDefault(),a=1);break;case 38:t.shiftKey?o=1:(t.preventDefault(),n=-1);break;case 40:t.shiftKey?o=-1:(t.preventDefault(),n=1);break;default:return}return{cameraAnimation:function(s){var l=s.getZoom();s.easeTo({duration:300,easeId:"keyboardHandler",easing:so,zoom:i?Math.round(l)+i*(t.shiftKey?2:1):l,bearing:s.getBearing()+r*e._bearingStep,pitch:s.getPitch()+o*e._pitchStep,offset:[-a*e._panStep,-n*e._panStep],center:s.getCenter()},{originalEvent:t})}}}},ao.prototype.enable=function(){this._enabled=!0},ao.prototype.disable=function(){this._enabled=!1,this.reset()},ao.prototype.isEnabled=function(){return this._enabled},ao.prototype.isActive=function(){return this._active};var lo=function(e,i){this._map=e,this._el=e.getCanvasContainer(),this._handler=i,this._delta=0,this._defaultZoomRate=.01,this._wheelZoomRate=1/450,t.bindAll(["_onWheel","_onTimeout","_onScrollFrame","_onScrollFinished"],this)};lo.prototype.setZoomRate=function(t){this._defaultZoomRate=t},lo.prototype.setWheelZoomRate=function(t){this._wheelZoomRate=t},lo.prototype.isEnabled=function(){return!!this._enabled},lo.prototype.isActive=function(){return!!this._active||void 0!==this._finishTimeout},lo.prototype.isZooming=function(){return!!this._zooming},lo.prototype.enable=function(t){this.isEnabled()||(this._enabled=!0,this._aroundCenter=t&&"center"===t.around)},lo.prototype.disable=function(){this.isEnabled()&&(this._enabled=!1)},lo.prototype.wheel=function(e){if(this.isEnabled()){var i=e.deltaMode===t.window.WheelEvent.DOM_DELTA_LINE?40*e.deltaY:e.deltaY,r=t.browser.now(),o=r-(this._lastWheelEventTime||0);this._lastWheelEventTime=r,0!==i&&i%4.000244140625==0?this._type="wheel":0!==i&&Math.abs(i)<4?this._type="trackpad":o>400?(this._type=null,this._lastValue=i,this._timeout=setTimeout(this._onTimeout,40,e)):this._type||(this._type=Math.abs(o*i)<200?"trackpad":"wheel",this._timeout&&(clearTimeout(this._timeout),this._timeout=null,i+=this._lastValue)),e.shiftKey&&i&&(i/=4),this._type&&(this._lastWheelEvent=e,this._delta-=i,this._active||this._start(e)),e.preventDefault()}},lo.prototype._onTimeout=function(t){this._type="wheel",this._delta-=this._lastValue,this._active||this._start(t)},lo.prototype._start=function(e){if(this._delta){this._frameId&&(this._frameId=null),this._active=!0,this.isZooming()||(this._zooming=!0),this._finishTimeout&&(clearTimeout(this._finishTimeout),delete this._finishTimeout);var r=i.mousePos(this._el,e);this._around=t.LngLat.convert(this._aroundCenter?this._map.getCenter():this._map.unproject(r)),this._aroundPoint=this._map.transform.locationPoint(this._around),this._frameId||(this._frameId=!0,this._handler._triggerRenderFrame())}},lo.prototype.renderFrame=function(){return this._onScrollFrame()},lo.prototype._onScrollFrame=function(){var e=this;if(this._frameId&&(this._frameId=null,this.isActive())){var i=this._map.transform;if(0!==this._delta){var r="wheel"===this._type&&Math.abs(this._delta)>4.000244140625?this._wheelZoomRate:this._defaultZoomRate,o=2/(1+Math.exp(-Math.abs(this._delta*r)));this._delta<0&&0!==o&&(o=1/o);var a="number"==typeof this._targetZoom?i.zoomScale(this._targetZoom):i.scale;this._targetZoom=Math.min(i.maxZoom,Math.max(i.minZoom,i.scaleZoom(a*o))),"wheel"===this._type&&(this._startZoom=i.zoom,this._easing=this._smoothOutEasing(200)),this._delta=0}var n,s="number"==typeof this._targetZoom?this._targetZoom:i.zoom,l=this._startZoom,c=this._easing,u=!1;if("wheel"===this._type&&l&&c){var h=Math.min((t.browser.now()-this._lastWheelEventTime)/200,1),p=c(h);n=t.number(l,s,p),h<1?this._frameId||(this._frameId=!0):u=!0}else n=s,u=!0;return this._active=!0,u&&(this._active=!1,this._finishTimeout=setTimeout((function(){e._zooming=!1,e._handler._triggerRenderFrame(),delete e._targetZoom,delete e._finishTimeout}),200)),{noInertia:!0,needsRenderFrame:!u,zoomDelta:n-i.zoom,around:this._aroundPoint,originalEvent:this._lastWheelEvent}}},lo.prototype._smoothOutEasing=function(e){var i=t.ease;if(this._prevEase){var r=this._prevEase,o=(t.browser.now()-r.start)/r.duration,a=r.easing(o+.01)-r.easing(o),n=.27/Math.sqrt(a*a+1e-4)*.01,s=Math.sqrt(.0729-n*n);i=t.bezier(n,s,.25,1)}return this._prevEase={start:t.browser.now(),duration:e,easing:i},i},lo.prototype.reset=function(){this._active=!1};var uo=function(t,e){this._clickZoom=t,this._tapZoom=e};uo.prototype.enable=function(){this._clickZoom.enable(),this._tapZoom.enable()},uo.prototype.disable=function(){this._clickZoom.disable(),this._tapZoom.disable()},uo.prototype.isEnabled=function(){return this._clickZoom.isEnabled()&&this._tapZoom.isEnabled()},uo.prototype.isActive=function(){return this._clickZoom.isActive()||this._tapZoom.isActive()};var co=function(){this.reset()};co.prototype.reset=function(){this._active=!1},co.prototype.dblclick=function(t,e){return t.preventDefault(),{cameraAnimation:function(i){i.easeTo({duration:300,zoom:i.getZoom()+(t.shiftKey?-1:1),around:i.unproject(e)},{originalEvent:t})}}},co.prototype.enable=function(){this._enabled=!0},co.prototype.disable=function(){this._enabled=!1,this.reset()},co.prototype.isEnabled=function(){return this._enabled},co.prototype.isActive=function(){return this._active};var po=function(){this._tap=new Gi({numTouches:1,numTaps:1}),this.reset()};po.prototype.reset=function(){this._active=!1,delete this._swipePoint,delete this._swipeTouch,delete this._tapTime,this._tap.reset()},po.prototype.touchstart=function(t,e,i){this._swipePoint||(this._tapTime&&t.timeStamp-this._tapTime>500&&this.reset(),this._tapTime?i.length>0&&(this._swipePoint=e[0],this._swipeTouch=i[0].identifier):this._tap.touchstart(t,e,i))},po.prototype.touchmove=function(t,e,i){if(this._tapTime){if(this._swipePoint){if(i[0].identifier!==this._swipeTouch)return;var r=e[0],o=r.y-this._swipePoint.y;return this._swipePoint=r,t.preventDefault(),this._active=!0,{zoomDelta:o/128}}}else this._tap.touchmove(t,e,i)},po.prototype.touchend=function(t,e,i){this._tapTime?this._swipePoint&&0===i.length&&this.reset():this._tap.touchend(t,e,i)&&(this._tapTime=t.timeStamp)},po.prototype.touchcancel=function(){this.reset()},po.prototype.enable=function(){this._enabled=!0},po.prototype.disable=function(){this._enabled=!1,this.reset()},po.prototype.isEnabled=function(){return this._enabled},po.prototype.isActive=function(){return this._active};var hr=function(t,e,i){this._el=t,this._mousePan=e,this._touchPan=i};hr.prototype.enable=function(t){this._inertiaOptions=t||{},this._mousePan.enable(),this._touchPan.enable(),this._el.classList.add("mapboxgl-touch-drag-pan")},hr.prototype.disable=function(){this._mousePan.disable(),this._touchPan.disable(),this._el.classList.remove("mapboxgl-touch-drag-pan")},hr.prototype.isEnabled=function(){return this._mousePan.isEnabled()&&this._touchPan.isEnabled()},hr.prototype.isActive=function(){return this._mousePan.isActive()||this._touchPan.isActive()};var ho=function(t,e,i){this._pitchWithRotate=t.pitchWithRotate,this._mouseRotate=e,this._mousePitch=i};ho.prototype.enable=function(){this._mouseRotate.enable(),this._pitchWithRotate&&this._mousePitch.enable()},ho.prototype.disable=function(){this._mouseRotate.disable(),this._mousePitch.disable()},ho.prototype.isEnabled=function(){return this._mouseRotate.isEnabled()&&(!this._pitchWithRotate||this._mousePitch.isEnabled())},ho.prototype.isActive=function(){return this._mouseRotate.isActive()||this._mousePitch.isActive()};var fo=function(t,e,i,r){this._el=t,this._touchZoom=e,this._touchRotate=i,this._tapDragZoom=r,this._rotationDisabled=!1,this._enabled=!0};fo.prototype.enable=function(t){this._touchZoom.enable(t),this._rotationDisabled||this._touchRotate.enable(t),this._tapDragZoom.enable(),this._el.classList.add("mapboxgl-touch-zoom-rotate")},fo.prototype.disable=function(){this._touchZoom.disable(),this._touchRotate.disable(),this._tapDragZoom.disable(),this._el.classList.remove("mapboxgl-touch-zoom-rotate")},fo.prototype.isEnabled=function(){return this._touchZoom.isEnabled()&&(this._rotationDisabled||this._touchRotate.isEnabled())&&this._tapDragZoom.isEnabled()},fo.prototype.isActive=function(){return this._touchZoom.isActive()||this._touchRotate.isActive()||this._tapDragZoom.isActive()},fo.prototype.disableRotation=function(){this._rotationDisabled=!0,this._touchRotate.disable()},fo.prototype.enableRotation=function(){this._rotationDisabled=!1,this._touchZoom.isEnabled()&&this._touchRotate.enable()};var mo=function(t){return t.zoom||t.drag||t.pitch||t.rotate},go=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e,e}(t.Event);function yo(t){return t.panDelta&&t.panDelta.mag()||t.zoomDelta||t.bearingDelta||t.pitchDelta}var vo=function(e,r){this._map=e,this._el=this._map.getCanvasContainer(),this._handlers=[],this._handlersById={},this._changes=[],this._inertia=new Li(e),this._bearingSnap=r.bearingSnap,this._previousActiveHandlers={},this._eventsInProgress={},this._addDefaultHandlers(r),t.bindAll(["handleEvent","handleWindowEvent"],this);var o=this._el;this._listeners=[[o,"touchstart",{passive:!0}],[o,"touchmove",{passive:!1}],[o,"touchend",void 0],[o,"touchcancel",void 0],[o,"mousedown",void 0],[o,"mousemove",void 0],[o,"mouseup",void 0],[t.window.document,"mousemove",{capture:!0}],[t.window.document,"mouseup",void 0],[o,"mouseover",void 0],[o,"mouseout",void 0],[o,"dblclick",void 0],[o,"click",void 0],[o,"keydown",{capture:!1}],[o,"keyup",void 0],[o,"wheel",{passive:!1}],[o,"contextmenu",void 0],[t.window,"blur",void 0]];for(var a=0,n=this._listeners;a<n.length;a+=1){var s=n[a],l=s[0];i.addEventListener(l,s[1],l===t.window.document?this.handleWindowEvent:this.handleEvent,s[2])}};vo.prototype.destroy=function(){for(var e=0,r=this._listeners;e<r.length;e+=1){var o=r[e],a=o[0];i.removeEventListener(a,o[1],a===t.window.document?this.handleWindowEvent:this.handleEvent,o[2])}},vo.prototype._addDefaultHandlers=function(t){var e=this._map,i=e.getCanvasContainer();this._add("mapEvent",new Ui(e,t));var r=e.boxZoom=new ji(e,t);this._add("boxZoom",r);var o=new Zi,a=new co;e.doubleClickZoom=new uo(a,o),this._add("tapZoom",o),this._add("clickZoom",a);var n=new po;this._add("tapDragZoom",n);var s=e.touchPitch=new oo;this._add("touchPitch",s);var l=new Xi(t),c=new $i(t);e.dragRotate=new ho(t,l,c),this._add("mouseRotate",l,["mousePitch"]),this._add("mousePitch",c,["mouseRotate"]);var u=new Wi(t),h=new Ji(t);e.dragPan=new hr(i,u,h),this._add("mousePan",u),this._add("touchPan",h,["touchZoom","touchRotate"]);var p=new ro,d=new eo;e.touchZoomRotate=new fo(i,d,p,n),this._add("touchRotate",p,["touchPan","touchZoom"]),this._add("touchZoom",d,["touchPan","touchRotate"]);var f=e.scrollZoom=new lo(e,this);this._add("scrollZoom",f,["mousePan"]);var m=e.keyboard=new ao;this._add("keyboard",m),this._add("blockableMapEvent",new Ni(e));for(var y=0,g=["boxZoom","doubleClickZoom","tapDragZoom","touchPitch","dragRotate","dragPan","touchZoomRotate","scrollZoom","keyboard"];y<g.length;y+=1){var v=g[y];t.interactive&&t[v]&&e[v].enable(t[v])}},vo.prototype._add=function(t,e,i){this._handlers.push({handlerName:t,handler:e,allowed:i}),this._handlersById[t]=e},vo.prototype.stop=function(){if(!this._updatingCamera){for(var t=0,e=this._handlers;t<e.length;t+=1)e[t].handler.reset();this._inertia.clear(),this._fireEvents({},{}),this._changes=[]}},vo.prototype.isActive=function(){for(var t=0,e=this._handlers;t<e.length;t+=1)if(e[t].handler.isActive())return!0;return!1},vo.prototype.isZooming=function(){return!!this._eventsInProgress.zoom||this._map.scrollZoom.isZooming()},vo.prototype.isRotating=function(){return!!this._eventsInProgress.rotate},vo.prototype.isMoving=function(){return Boolean(mo(this._eventsInProgress))||this.isZooming()},vo.prototype._blockedByActive=function(t,e,i){for(var r in t)if(r!==i&&(!e||e.indexOf(r)<0))return!0;return!1},vo.prototype.handleWindowEvent=function(t){this.handleEvent(t,t.type+"Window")},vo.prototype._getMapTouches=function(t){for(var e=[],i=0,r=t;i<r.length;i+=1){var o=r[i];this._el.contains(o.target)&&e.push(o)}return e},vo.prototype.handleEvent=function(t,e){if("blur"!==t.type){this._updatingCamera=!0;for(var r="renderFrame"===t.type?void 0:t,o={needsRenderFrame:!1},a={},n={},s=t.touches?this._getMapTouches(t.touches):void 0,l=s?i.touchPos(this._el,s):i.mousePos(this._el,t),c=0,u=this._handlers;c<u.length;c+=1){var h=u[c],p=h.handlerName,d=h.handler,f=h.allowed;if(d.isEnabled()){var m=void 0;this._blockedByActive(n,f,p)?d.reset():d[e||t.type]&&(m=d[e||t.type](t,l,s),this.mergeHandlerResult(o,a,m,p,r),m&&m.needsRenderFrame&&this._triggerRenderFrame()),(m||d.isActive())&&(n[p]=d)}}var y={};for(var g in this._previousActiveHandlers)n[g]||(y[g]=r);this._previousActiveHandlers=n,(Object.keys(y).length||yo(o))&&(this._changes.push([o,a,y]),this._triggerRenderFrame()),(Object.keys(n).length||yo(o))&&this._map._stop(!0),this._updatingCamera=!1;var v=o.cameraAnimation;v&&(this._inertia.clear(),this._fireEvents({},{}),this._changes=[],v(this._map))}else this.stop()},vo.prototype.mergeHandlerResult=function(e,i,r,o,a){if(r){t.extend(e,r);var n={handlerName:o,originalEvent:r.originalEvent||a};void 0!==r.zoomDelta&&(i.zoom=n),void 0!==r.panDelta&&(i.drag=n),void 0!==r.pitchDelta&&(i.pitch=n),void 0!==r.bearingDelta&&(i.rotate=n)}},vo.prototype._applyChanges=function(){for(var e={},i={},r={},o=0,a=this._changes;o<a.length;o+=1){var n=a[o],s=n[0],l=n[1],c=n[2];s.panDelta&&(e.panDelta=(e.panDelta||new t.Point(0,0))._add(s.panDelta)),s.zoomDelta&&(e.zoomDelta=(e.zoomDelta||0)+s.zoomDelta),s.bearingDelta&&(e.bearingDelta=(e.bearingDelta||0)+s.bearingDelta),s.pitchDelta&&(e.pitchDelta=(e.pitchDelta||0)+s.pitchDelta),void 0!==s.around&&(e.around=s.around),void 0!==s.pinchAround&&(e.pinchAround=s.pinchAround),s.noInertia&&(e.noInertia=s.noInertia),t.extend(i,l),t.extend(r,c)}this._updateMapTransform(e,i,r),this._changes=[]},vo.prototype._updateMapTransform=function(t,e,i){var r=this._map,o=r.transform;if(!yo(t))return this._fireEvents(e,i);var a=t.panDelta,n=t.zoomDelta,s=t.bearingDelta,l=t.pitchDelta,c=t.around,u=t.pinchAround;void 0!==u&&(c=u),r._stop(!0),c=c||r.transform.centerPoint;var h=o.pointLocation(a?c.sub(a):c);s&&(o.bearing+=s),l&&(o.pitch+=l),n&&(o.zoom+=n),o.setLocationAtPoint(h,c),this._map._update(),t.noInertia||this._inertia.record(t),this._fireEvents(e,i)},vo.prototype._fireEvents=function(e,i){var r=this,o=mo(this._eventsInProgress),a=mo(e),n={};for(var s in e)this._eventsInProgress[s]||(n[s+"start"]=e[s].originalEvent),this._eventsInProgress[s]=e[s];for(var l in!o&&a&&this._fireEvent("movestart",a.originalEvent),n)this._fireEvent(l,n[l]);for(var c in e.rotate&&(this._bearingChanged=!0),a&&this._fireEvent("move",a.originalEvent),e)this._fireEvent(c,e[c].originalEvent);var u,h={};for(var p in this._eventsInProgress){var d=this._eventsInProgress[p],f=d.handlerName,m=d.originalEvent;this._handlersById[f].isActive()||(delete this._eventsInProgress[p],h[p+"end"]=u=i[f]||m)}for(var y in h)this._fireEvent(y,h[y]);var g=mo(this._eventsInProgress);if((o||a)&&!g){this._updatingCamera=!0;var v=this._inertia._onMoveEnd(this._map.dragPan._inertiaOptions),_=function(t){return 0!==t&&-r._bearingSnap<t&&t<r._bearingSnap};v?(_(v.bearing||this._map.getBearing())&&(v.bearing=0),this._map.easeTo(v,{originalEvent:u})):(this._map.fire(new t.Event("moveend",{originalEvent:u})),_(this._map.getBearing())&&this._map.resetNorth()),this._bearingChanged=!1,this._updatingCamera=!1}},vo.prototype._fireEvent=function(e,i){this._map.fire(new t.Event(e,i?{originalEvent:i}:{}))},vo.prototype._requestFrame=function(){var t=this;return this._map.triggerRepaint(),this._map._renderTaskQueue.add((function(e){delete t._frameId,t.handleEvent(new go("renderFrame",{timeStamp:e})),t._applyChanges()}))},vo.prototype._triggerRenderFrame=function(){void 0===this._frameId&&(this._frameId=this._requestFrame())};var _o=function(e){function i(i,r){e.call(this),this._moving=!1,this._zooming=!1,this.transform=i,this._bearingSnap=r.bearingSnap,t.bindAll(["_renderFrameCallback"],this)}return e&&(i.__proto__=e),(i.prototype=Object.create(e&&e.prototype)).constructor=i,i.prototype.getCenter=function(){return new t.LngLat(this.transform.center.lng,this.transform.center.lat)},i.prototype.setCenter=function(t,e){return this.jumpTo({center:t},e)},i.prototype.panBy=function(e,i,r){return e=t.Point.convert(e).mult(-1),this.panTo(this.transform.center,t.extend({offset:e},i),r)},i.prototype.panTo=function(e,i,r){return this.easeTo(t.extend({center:e},i),r)},i.prototype.getZoom=function(){return this.transform.zoom},i.prototype.setZoom=function(t,e){return this.jumpTo({zoom:t},e),this},i.prototype.zoomTo=function(e,i,r){return this.easeTo(t.extend({zoom:e},i),r)},i.prototype.zoomIn=function(t,e){return this.zoomTo(this.getZoom()+1,t,e),this},i.prototype.zoomOut=function(t,e){return this.zoomTo(this.getZoom()-1,t,e),this},i.prototype.getBearing=function(){return this.transform.bearing},i.prototype.setBearing=function(t,e){return this.jumpTo({bearing:t},e),this},i.prototype.getPadding=function(){return this.transform.padding},i.prototype.setPadding=function(t,e){return this.jumpTo({padding:t},e),this},i.prototype.rotateTo=function(e,i,r){return this.easeTo(t.extend({bearing:e},i),r)},i.prototype.resetNorth=function(e,i){return this.rotateTo(0,t.extend({duration:1e3},e),i),this},i.prototype.resetNorthPitch=function(e,i){return this.easeTo(t.extend({bearing:0,pitch:0,duration:1e3},e),i),this},i.prototype.snapToNorth=function(t,e){return Math.abs(this.getBearing())<this._bearingSnap?this.resetNorth(t,e):this},i.prototype.getPitch=function(){return this.transform.pitch},i.prototype.setPitch=function(t,e){return this.jumpTo({pitch:t},e),this},i.prototype.cameraForBounds=function(e,i){return e=t.LngLatBounds.convert(e),this._cameraForBoxAndBearing(e.getNorthWest(),e.getSouthEast(),0,i)},i.prototype._cameraForBoxAndBearing=function(e,i,r,o){var a={top:0,bottom:0,right:0,left:0};if("number"==typeof(o=t.extend({padding:a,offset:[0,0],maxZoom:this.transform.maxZoom},o)).padding){var n=o.padding;o.padding={top:n,bottom:n,right:n,left:n}}o.padding=t.extend(a,o.padding);var s=this.transform,l=s.padding,c=s.project(t.LngLat.convert(e)),u=s.project(t.LngLat.convert(i)),h=c.rotate(-r*Math.PI/180),p=u.rotate(-r*Math.PI/180),d=new t.Point(Math.max(h.x,p.x),Math.max(h.y,p.y)),f=new t.Point(Math.min(h.x,p.x),Math.min(h.y,p.y)),m=d.sub(f),y=(s.width-(l.left+l.right+o.padding.left+o.padding.right))/m.x,g=(s.height-(l.top+l.bottom+o.padding.top+o.padding.bottom))/m.y;if(!(g<0||y<0)){var v=Math.min(s.scaleZoom(s.scale*Math.min(y,g)),o.maxZoom),_=t.Point.convert(o.offset),x=new t.Point(_.x+(o.padding.left-o.padding.right)/2,_.y+(o.padding.top-o.padding.bottom)/2).mult(s.scale/s.zoomScale(v));return{center:s.unproject(c.add(u).div(2).sub(x)),zoom:v,bearing:r}}t.warnOnce("Map cannot fit within canvas with the given bounds, padding, and/or offset.")},i.prototype.fitBounds=function(t,e,i){return this._fitInternal(this.cameraForBounds(t,e),e,i)},i.prototype.fitScreenCoordinates=function(e,i,r,o,a){return this._fitInternal(this._cameraForBoxAndBearing(this.transform.pointLocation(t.Point.convert(e)),this.transform.pointLocation(t.Point.convert(i)),r,o),o,a)},i.prototype._fitInternal=function(e,i,r){return e?(delete(i=t.extend(e,i)).padding,i.linear?this.easeTo(i,r):this.flyTo(i,r)):this},i.prototype.jumpTo=function(e,i){this.stop();var r=this.transform,o=!1,a=!1,n=!1;return"zoom"in e&&r.zoom!==+e.zoom&&(o=!0,r.zoom=+e.zoom),void 0!==e.center&&(r.center=t.LngLat.convert(e.center)),"bearing"in e&&r.bearing!==+e.bearing&&(a=!0,r.bearing=+e.bearing),"pitch"in e&&r.pitch!==+e.pitch&&(n=!0,r.pitch=+e.pitch),null==e.padding||r.isPaddingEqual(e.padding)||(r.padding=e.padding),this.fire(new t.Event("movestart",i)).fire(new t.Event("move",i)),o&&this.fire(new t.Event("zoomstart",i)).fire(new t.Event("zoom",i)).fire(new t.Event("zoomend",i)),a&&this.fire(new t.Event("rotatestart",i)).fire(new t.Event("rotate",i)).fire(new t.Event("rotateend",i)),n&&this.fire(new t.Event("pitchstart",i)).fire(new t.Event("pitch",i)).fire(new t.Event("pitchend",i)),this.fire(new t.Event("moveend",i))},i.prototype.easeTo=function(e,i){var r=this;this._stop(!1,e.easeId),(!1===(e=t.extend({offset:[0,0],duration:500,easing:t.ease},e)).animate||!e.essential&&t.browser.prefersReducedMotion)&&(e.duration=0);var o=this.transform,a=this.getZoom(),n=this.getBearing(),s=this.getPitch(),l=this.getPadding(),c="zoom"in e?+e.zoom:a,u="bearing"in e?this._normalizeBearing(e.bearing,n):n,h="pitch"in e?+e.pitch:s,p="padding"in e?e.padding:o.padding,d=t.Point.convert(e.offset),f=o.centerPoint.add(d),m=o.pointLocation(f),y=t.LngLat.convert(e.center||m);this._normalizeCenter(y);var g,v,_=o.project(m),x=o.project(y).sub(_),b=o.zoomScale(c-a);e.around&&(g=t.LngLat.convert(e.around),v=o.locationPoint(g));var w={moving:this._moving,zooming:this._zooming,rotating:this._rotating,pitching:this._pitching};return this._zooming=this._zooming||c!==a,this._rotating=this._rotating||n!==u,this._pitching=this._pitching||h!==s,this._padding=!o.isPaddingEqual(p),this._easeId=e.easeId,this._prepareEase(i,e.noMoveStart,w),clearTimeout(this._easeEndTimeoutID),this._ease((function(e){if(r._zooming&&(o.zoom=t.number(a,c,e)),r._rotating&&(o.bearing=t.number(n,u,e)),r._pitching&&(o.pitch=t.number(s,h,e)),r._padding&&(o.interpolatePadding(l,p,e),f=o.centerPoint.add(d)),g)o.setLocationAtPoint(g,v);else{var m=o.zoomScale(o.zoom-a),y=c>a?Math.min(2,b):Math.max(.5,b),w=Math.pow(y,1-e),E=o.unproject(_.add(x.mult(e*w)).mult(m));o.setLocationAtPoint(o.renderWorldCopies?E.wrap():E,f)}r._fireMoveEvents(i)}),(function(t){r._afterEase(i,t)}),e),this},i.prototype._prepareEase=function(e,i,r){void 0===r&&(r={}),this._moving=!0,i||r.moving||this.fire(new t.Event("movestart",e)),this._zooming&&!r.zooming&&this.fire(new t.Event("zoomstart",e)),this._rotating&&!r.rotating&&this.fire(new t.Event("rotatestart",e)),this._pitching&&!r.pitching&&this.fire(new t.Event("pitchstart",e))},i.prototype._fireMoveEvents=function(e){this.fire(new t.Event("move",e)),this._zooming&&this.fire(new t.Event("zoom",e)),this._rotating&&this.fire(new t.Event("rotate",e)),this._pitching&&this.fire(new t.Event("pitch",e))},i.prototype._afterEase=function(e,i){if(!this._easeId||!i||this._easeId!==i){delete this._easeId;var r=this._zooming,o=this._rotating,a=this._pitching;this._moving=!1,this._zooming=!1,this._rotating=!1,this._pitching=!1,this._padding=!1,r&&this.fire(new t.Event("zoomend",e)),o&&this.fire(new t.Event("rotateend",e)),a&&this.fire(new t.Event("pitchend",e)),this.fire(new t.Event("moveend",e))}},i.prototype.flyTo=function(e,i){var r=this;if(!e.essential&&t.browser.prefersReducedMotion){var o=t.pick(e,["center","zoom","bearing","pitch","around"]);return this.jumpTo(o,i)}this.stop(),e=t.extend({offset:[0,0],speed:1.2,curve:1.42,easing:t.ease},e);var a=this.transform,n=this.getZoom(),s=this.getBearing(),l=this.getPitch(),c=this.getPadding(),u="zoom"in e?t.clamp(+e.zoom,a.minZoom,a.maxZoom):n,h="bearing"in e?this._normalizeBearing(e.bearing,s):s,p="pitch"in e?+e.pitch:l,d="padding"in e?e.padding:a.padding,f=a.zoomScale(u-n),m=t.Point.convert(e.offset),y=a.centerPoint.add(m),g=a.pointLocation(y),v=t.LngLat.convert(e.center||g);this._normalizeCenter(v);var _=a.project(g),x=a.project(v).sub(_),b=e.curve,w=Math.max(a.width,a.height),E=w/f,k=x.mag();if("minZoom"in e){var S=t.clamp(Math.min(e.minZoom,n,u),a.minZoom,a.maxZoom),T=w/a.zoomScale(S-n);b=Math.sqrt(T/k*2)}var I=b*b;function z(t){var e=(E*E-w*w+(t?-1:1)*I*I*k*k)/(2*(t?E:w)*I*k);return Math.log(Math.sqrt(e*e+1)-e)}function C(t){return(Math.exp(t)-Math.exp(-t))/2}function P(t){return(Math.exp(t)+Math.exp(-t))/2}var A=z(0),M=function(t){return P(A)/P(A+b*t)},L=function(t){return w*((P(A)*(C(e=A+b*t)/P(e))-C(A))/I)/k;var e},R=(z(1)-A)/b;if(Math.abs(k)<1e-6||!isFinite(R)){if(Math.abs(w-E)<1e-6)return this.easeTo(e,i);var D=E<w?-1:1;R=Math.abs(Math.log(E/w))/b,L=function(){return 0},M=function(t){return Math.exp(D*b*t)}}return e.duration="duration"in e?+e.duration:1e3*R/("screenSpeed"in e?+e.screenSpeed/b:+e.speed),e.maxDuration&&e.duration>e.maxDuration&&(e.duration=0),this._zooming=!0,this._rotating=s!==h,this._pitching=p!==l,this._padding=!a.isPaddingEqual(d),this._prepareEase(i,!1),this._ease((function(e){var o=e*R,f=1/M(o);a.zoom=1===e?u:n+a.scaleZoom(f),r._rotating&&(a.bearing=t.number(s,h,e)),r._pitching&&(a.pitch=t.number(l,p,e)),r._padding&&(a.interpolatePadding(c,d,e),y=a.centerPoint.add(m));var g=1===e?v:a.unproject(_.add(x.mult(L(o))).mult(f));a.setLocationAtPoint(a.renderWorldCopies?g.wrap():g,y),r._fireMoveEvents(i)}),(function(){return r._afterEase(i)}),e),this},i.prototype.isEasing=function(){return!!this._easeFrameId},i.prototype.stop=function(){return this._stop()},i.prototype._stop=function(t,e){if(this._easeFrameId&&(this._cancelRenderFrame(this._easeFrameId),delete this._easeFrameId,delete this._onEaseFrame),this._onEaseEnd){var i=this._onEaseEnd;delete this._onEaseEnd,i.call(this,e)}if(!t){var r=this.handlers;r&&r.stop()}return this},i.prototype._ease=function(e,i,r){!1===r.animate||0===r.duration?(e(1),i()):(this._easeStart=t.browser.now(),this._easeOptions=r,this._onEaseFrame=e,this._onEaseEnd=i,this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback))},i.prototype._renderFrameCallback=function(){var e=Math.min((t.browser.now()-this._easeStart)/this._easeOptions.duration,1);this._onEaseFrame(this._easeOptions.easing(e)),e<1?this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback):this.stop()},i.prototype._normalizeBearing=function(e,i){e=t.wrap(e,-180,180);var r=Math.abs(e-i);return Math.abs(e-360-i)<r&&(e-=360),Math.abs(e+360-i)<r&&(e+=360),e},i.prototype._normalizeCenter=function(t){var e=this.transform;if(e.renderWorldCopies&&!e.lngRange){var i=t.lng-e.center.lng;t.lng+=i>180?-360:i<-180?360:0}},i}(t.Evented),xo=function(e){void 0===e&&(e={}),this.options=e,t.bindAll(["_updateEditLink","_updateData","_updateCompact"],this)};xo.prototype.getDefaultPosition=function(){return"bottom-right"},xo.prototype.onAdd=function(t){var e=this.options&&this.options.compact;return this._map=t,this._container=i.create("div","mapboxgl-ctrl mapboxgl-ctrl-attrib"),this._innerContainer=i.create("div","mapboxgl-ctrl-attrib-inner",this._container),e&&this._container.classList.add("mapboxgl-compact"),this._updateAttributions(),this._updateEditLink(),this._map.on("styledata",this._updateData),this._map.on("sourcedata",this._updateData),this._map.on("moveend",this._updateEditLink),void 0===e&&(this._map.on("resize",this._updateCompact),this._updateCompact()),this._container},xo.prototype.onRemove=function(){i.remove(this._container),this._map.off("styledata",this._updateData),this._map.off("sourcedata",this._updateData),this._map.off("moveend",this._updateEditLink),this._map.off("resize",this._updateCompact),this._map=void 0,this._attribHTML=void 0},xo.prototype._updateEditLink=function(){var e=this._editLink;e||(e=this._editLink=this._container.querySelector(".mapbox-improve-map"));var i=[{key:"owner",value:this.styleOwner},{key:"id",value:this.styleId},{key:"access_token",value:this._map._requestManager._customAccessToken||t.config.ACCESS_TOKEN}];if(e){var r=i.reduce((function(t,e,r){return e.value&&(t+=e.key+"="+e.value+(r<i.length-1?"&":"")),t}),"?");e.href=t.config.FEEDBACK_URL+"/"+r+(this._map._hash?this._map._hash.getHashString(!0):""),e.rel="noopener nofollow"}},xo.prototype._updateData=function(t){!t||"metadata"!==t.sourceDataType&&"style"!==t.dataType||(this._updateAttributions(),this._updateEditLink())},xo.prototype._updateAttributions=function(){if(this._map.style){var t=[];if(this.options.customAttribution&&(Array.isArray(this.options.customAttribution)?t=t.concat(this.options.customAttribution.map((function(t){return"string"!=typeof t?"":t}))):"string"==typeof this.options.customAttribution&&t.push(this.options.customAttribution)),this._map.style.stylesheet){var e=this._map.style.stylesheet;this.styleOwner=e.owner,this.styleId=e.id}var i=this._map.style.sourceCaches;for(var r in i){var o=i[r];if(o.used){var a=o.getSource();a.attribution&&t.indexOf(a.attribution)<0&&t.push(a.attribution)}}t.sort((function(t,e){return t.length-e.length}));var n=(t=t.filter((function(e,i){for(var r=i+1;r<t.length;r++)if(t[r].indexOf(e)>=0)return!1;return!0}))).join(" | ");n!==this._attribHTML&&(this._attribHTML=n,t.length?(this._innerContainer.innerHTML=n,this._container.classList.remove("mapboxgl-attrib-empty")):this._container.classList.add("mapboxgl-attrib-empty"),this._editLink=null)}},xo.prototype._updateCompact=function(){this._map.getCanvasContainer().offsetWidth<=640?this._container.classList.add("mapboxgl-compact"):this._container.classList.remove("mapboxgl-compact")};var bo=function(){t.bindAll(["_updateLogo"],this),t.bindAll(["_updateCompact"],this)};bo.prototype.onAdd=function(t){this._map=t,this._container=i.create("div","mapboxgl-ctrl");var e=i.create("a","mapboxgl-ctrl-logo");return e.target="_blank",e.rel="noopener nofollow",e.href="https://www.mapbox.com/",e.setAttribute("aria-label",this._map._getUIString("LogoControl.Title")),e.setAttribute("rel","noopener nofollow"),this._container.appendChild(e),this._container.style.display="none",this._map.on("sourcedata",this._updateLogo),this._updateLogo(),this._map.on("resize",this._updateCompact),this._updateCompact(),this._container},bo.prototype.onRemove=function(){i.remove(this._container),this._map.off("sourcedata",this._updateLogo),this._map.off("resize",this._updateCompact)},bo.prototype.getDefaultPosition=function(){return"bottom-left"},bo.prototype._updateLogo=function(t){t&&"metadata"!==t.sourceDataType||(this._container.style.display=this._logoRequired()?"block":"none")},bo.prototype._logoRequired=function(){if(this._map.style){var t=this._map.style.sourceCaches;for(var e in t)if(t[e].getSource().mapbox_logo)return!0;return!1}},bo.prototype._updateCompact=function(){var t=this._container.children;if(t.length){var e=t[0];this._map.getCanvasContainer().offsetWidth<250?e.classList.add("mapboxgl-compact"):e.classList.remove("mapboxgl-compact")}};var br=function(){this._queue=[],this._id=0,this._cleared=!1,this._currentlyRunning=!1};br.prototype.add=function(t){var e=++this._id;return this._queue.push({callback:t,id:e,cancelled:!1}),e},br.prototype.remove=function(t){for(var e=this._currentlyRunning,i=0,r=e?this._queue.concat(e):this._queue;i<r.length;i+=1){var o=r[i];if(o.id===t)return void(o.cancelled=!0)}},br.prototype.run=function(t){void 0===t&&(t=0);var e=this._currentlyRunning=this._queue;this._queue=[];for(var i=0,r=e;i<r.length;i+=1){var o=r[i];if(!o.cancelled&&(o.callback(t),this._cleared))break}this._cleared=!1,this._currentlyRunning=!1},br.prototype.clear=function(){this._currentlyRunning&&(this._cleared=!0),this._queue=[]};var wo={"FullscreenControl.Enter":"Enter fullscreen","FullscreenControl.Exit":"Exit fullscreen","GeolocateControl.FindMyLocation":"Find my location","GeolocateControl.LocationNotAvailable":"Location not available","LogoControl.Title":"Mapbox logo","NavigationControl.ResetBearing":"Reset bearing to north","NavigationControl.ZoomIn":"Zoom in","NavigationControl.ZoomOut":"Zoom out","ScaleControl.Feet":"ft","ScaleControl.Meters":"m","ScaleControl.Kilometers":"km","ScaleControl.Miles":"mi","ScaleControl.NauticalMiles":"nm"},Eo=t.window.HTMLImageElement,ko=t.window.HTMLElement,So=t.window.ImageBitmap,To={center:[0,0],zoom:0,bearing:0,pitch:0,minZoom:-2,maxZoom:22,minPitch:0,maxPitch:60,interactive:!0,scrollZoom:!0,boxZoom:!0,dragRotate:!0,dragPan:!0,keyboard:!0,doubleClickZoom:!0,touchZoomRotate:!0,touchPitch:!0,bearingSnap:7,clickTolerance:3,pitchWithRotate:!0,hash:!1,attributionControl:!0,failIfMajorPerformanceCaveat:!1,preserveDrawingBuffer:!1,trackResize:!0,renderWorldCopies:!0,refreshExpiredTiles:!0,maxTileCacheSize:null,localIdeographFontFamily:"sans-serif",transformRequest:null,accessToken:null,fadeDuration:300,crossSourceCollisions:!0},Io=function(r){function o(e){var i=this;if(null!=(e=t.extend({},To,e)).minZoom&&null!=e.maxZoom&&e.minZoom>e.maxZoom)throw new Error("maxZoom must be greater than or equal to minZoom");if(null!=e.minPitch&&null!=e.maxPitch&&e.minPitch>e.maxPitch)throw new Error("maxPitch must be greater than or equal to minPitch");if(null!=e.minPitch&&e.minPitch<0)throw new Error("minPitch must be greater than or equal to 0");if(null!=e.maxPitch&&e.maxPitch>60)throw new Error("maxPitch must be less than or equal to 60");var o=new Si(e.minZoom,e.maxZoom,e.minPitch,e.maxPitch,e.renderWorldCopies);if(r.call(this,o,e),this._interactive=e.interactive,this._maxTileCacheSize=e.maxTileCacheSize,this._failIfMajorPerformanceCaveat=e.failIfMajorPerformanceCaveat,this._preserveDrawingBuffer=e.preserveDrawingBuffer,this._antialias=e.antialias,this._trackResize=e.trackResize,this._bearingSnap=e.bearingSnap,this._refreshExpiredTiles=e.refreshExpiredTiles,this._fadeDuration=e.fadeDuration,this._crossSourceCollisions=e.crossSourceCollisions,this._crossFadingFactor=1,this._collectResourceTiming=e.collectResourceTiming,this._renderTaskQueue=new br,this._controls=[],this._mapId=t.uniqueId(),this._locale=t.extend({},wo,e.locale),this._requestManager=new t.RequestManager(e.transformRequest,e.accessToken),"string"==typeof e.container){if(this._container=t.window.document.getElementById(e.container),!this._container)throw new Error("Container '"+e.container+"' not found.")}else{if(!(e.container instanceof ko))throw new Error("Invalid type: 'container' must be a String or HTMLElement.");this._container=e.container}if(e.maxBounds&&this.setMaxBounds(e.maxBounds),t.bindAll(["_onWindowOnline","_onWindowResize","_contextLost","_contextRestored"],this),this._setupContainer(),this._setupPainter(),void 0===this.painter)throw new Error("Failed to initialize WebGL.");this.on("move",(function(){return i._update(!1)})),this.on("moveend",(function(){return i._update(!1)})),this.on("zoom",(function(){return i._update(!0)})),void 0!==t.window&&(t.window.addEventListener("online",this._onWindowOnline,!1),t.window.addEventListener("resize",this._onWindowResize,!1)),this.handlers=new vo(this,e),this._hash=e.hash&&new Ii("string"==typeof e.hash&&e.hash||void 0).addTo(this),this._hash&&this._hash._onHashChange()||(this.jumpTo({center:e.center,zoom:e.zoom,bearing:e.bearing,pitch:e.pitch}),e.bounds&&(this.resize(),this.fitBounds(e.bounds,t.extend({},e.fitBoundsOptions,{duration:0})))),this.resize(),this._localIdeographFontFamily=e.localIdeographFontFamily,e.style&&this.setStyle(e.style,{localIdeographFontFamily:e.localIdeographFontFamily}),e.attributionControl&&this.addControl(new xo({customAttribution:e.customAttribution})),this.addControl(new bo,e.logoPosition),this.on("style.load",(function(){i.transform.unmodified&&i.jumpTo(i.style.stylesheet)})),this.on("data",(function(e){i._update("style"===e.dataType),i.fire(new t.Event(e.dataType+"data",e))})),this.on("dataloading",(function(e){i.fire(new t.Event(e.dataType+"dataloading",e))}))}r&&(o.__proto__=r),(o.prototype=Object.create(r&&r.prototype)).constructor=o;var a={showTileBoundaries:{configurable:!0},showPadding:{configurable:!0},showCollisionBoxes:{configurable:!0},showOverdrawInspector:{configurable:!0},repaint:{configurable:!0},vertices:{configurable:!0},version:{configurable:!0}};return o.prototype._getMapId=function(){return this._mapId},o.prototype.addControl=function(e,i){if(void 0===i&&e.getDefaultPosition&&(i=e.getDefaultPosition()),void 0===i&&(i="top-right"),!e||!e.onAdd)return this.fire(new t.ErrorEvent(new Error("Invalid argument to map.addControl(). Argument must be a control with onAdd and onRemove methods.")));var r=e.onAdd(this);this._controls.push(e);var o=this._controlPositions[i];return-1!==i.indexOf("bottom")?o.insertBefore(r,o.firstChild):o.appendChild(r),this},o.prototype.removeControl=function(e){if(!e||!e.onRemove)return this.fire(new t.ErrorEvent(new Error("Invalid argument to map.removeControl(). Argument must be a control with onAdd and onRemove methods.")));var i=this._controls.indexOf(e);return i>-1&&this._controls.splice(i,1),e.onRemove(this),this},o.prototype.resize=function(e){var i=this._containerDimensions(),r=i[0],o=i[1];this._resizeCanvas(r,o),this.transform.resize(r,o),this.painter.resize(r,o);var a=!this._moving;return a&&(this.stop(),this.fire(new t.Event("movestart",e)).fire(new t.Event("move",e))),this.fire(new t.Event("resize",e)),a&&this.fire(new t.Event("moveend",e)),this},o.prototype.getBounds=function(){return this.transform.getBounds()},o.prototype.getMaxBounds=function(){return this.transform.getMaxBounds()},o.prototype.setMaxBounds=function(e){return this.transform.setMaxBounds(t.LngLatBounds.convert(e)),this._update()},o.prototype.setMinZoom=function(t){if((t=null==t?-2:t)>=-2&&t<=this.transform.maxZoom)return this.transform.minZoom=t,this._update(),this.getZoom()<t&&this.setZoom(t),this;throw new Error("minZoom must be between -2 and the current maxZoom, inclusive")},o.prototype.getMinZoom=function(){return this.transform.minZoom},o.prototype.setMaxZoom=function(t){if((t=null==t?22:t)>=this.transform.minZoom)return this.transform.maxZoom=t,this._update(),this.getZoom()>t&&this.setZoom(t),this;throw new Error("maxZoom must be greater than the current minZoom")},o.prototype.getMaxZoom=function(){return this.transform.maxZoom},o.prototype.setMinPitch=function(t){if((t=null==t?0:t)<0)throw new Error("minPitch must be greater than or equal to 0");if(t>=0&&t<=this.transform.maxPitch)return this.transform.minPitch=t,this._update(),this.getPitch()<t&&this.setPitch(t),this;throw new Error("minPitch must be between 0 and the current maxPitch, inclusive")},o.prototype.getMinPitch=function(){return this.transform.minPitch},o.prototype.setMaxPitch=function(t){if((t=null==t?60:t)>60)throw new Error("maxPitch must be less than or equal to 60");if(t>=this.transform.minPitch)return this.transform.maxPitch=t,this._update(),this.getPitch()>t&&this.setPitch(t),this;throw new Error("maxPitch must be greater than the current minPitch")},o.prototype.getMaxPitch=function(){return this.transform.maxPitch},o.prototype.getRenderWorldCopies=function(){return this.transform.renderWorldCopies},o.prototype.setRenderWorldCopies=function(t){return this.transform.renderWorldCopies=t,this._update()},o.prototype.project=function(e){return this.transform.locationPoint(t.LngLat.convert(e))},o.prototype.unproject=function(e){return this.transform.pointLocation(t.Point.convert(e))},o.prototype.isMoving=function(){return this._moving||this.handlers.isMoving()},o.prototype.isZooming=function(){return this._zooming||this.handlers.isZooming()},o.prototype.isRotating=function(){return this._rotating||this.handlers.isRotating()},o.prototype._createDelegatedListener=function(t,e,i){var r,o=this;if("mouseenter"===t||"mouseover"===t){var a=!1;return{layer:e,listener:i,delegates:{mousemove:function(r){var n=o.getLayer(e)?o.queryRenderedFeatures(r.point,{layers:[e]}):[];n.length?a||(a=!0,i.call(o,new Oi(t,o,r.originalEvent,{features:n}))):a=!1},mouseout:function(){a=!1}}}}if("mouseleave"===t||"mouseout"===t){var n=!1;return{layer:e,listener:i,delegates:{mousemove:function(r){(o.getLayer(e)?o.queryRenderedFeatures(r.point,{layers:[e]}):[]).length?n=!0:n&&(n=!1,i.call(o,new Oi(t,o,r.originalEvent)))},mouseout:function(e){n&&(n=!1,i.call(o,new Oi(t,o,e.originalEvent)))}}}}return{layer:e,listener:i,delegates:(r={},r[t]=function(t){var r=o.getLayer(e)?o.queryRenderedFeatures(t.point,{layers:[e]}):[];r.length&&(t.features=r,i.call(o,t),delete t.features)},r)}},o.prototype.on=function(t,e,i){if(void 0===i)return r.prototype.on.call(this,t,e);var o=this._createDelegatedListener(t,e,i);for(var a in this._delegatedListeners=this._delegatedListeners||{},this._delegatedListeners[t]=this._delegatedListeners[t]||[],this._delegatedListeners[t].push(o),o.delegates)this.on(a,o.delegates[a]);return this},o.prototype.once=function(t,e,i){if(void 0===i)return r.prototype.once.call(this,t,e);var o=this._createDelegatedListener(t,e,i);for(var a in o.delegates)this.once(a,o.delegates[a]);return this},o.prototype.off=function(t,e,i){var o=this;return void 0===i?r.prototype.off.call(this,t,e):(this._delegatedListeners&&this._delegatedListeners[t]&&function(r){for(var a=r[t],n=0;n<a.length;n++){var s=a[n];if(s.layer===e&&s.listener===i){for(var l in s.delegates)o.off(l,s.delegates[l]);return a.splice(n,1),o}}}(this._delegatedListeners),this)},o.prototype.queryRenderedFeatures=function(e,i){if(!this.style)return[];var r;if(void 0!==i||void 0===e||e instanceof t.Point||Array.isArray(e)||(i=e,e=void 0),i=i||{},(e=e||[[0,0],[this.transform.width,this.transform.height]])instanceof t.Point||"number"==typeof e[0])r=[t.Point.convert(e)];else{var o=t.Point.convert(e[0]),a=t.Point.convert(e[1]);r=[o,new t.Point(a.x,o.y),a,new t.Point(o.x,a.y),o]}return this.style.queryRenderedFeatures(r,i,this.transform)},o.prototype.querySourceFeatures=function(t,e){return this.style.querySourceFeatures(t,e)},o.prototype.setStyle=function(e,i){return!1!==(i=t.extend({},{localIdeographFontFamily:this._localIdeographFontFamily},i)).diff&&i.localIdeographFontFamily===this._localIdeographFontFamily&&this.style&&e?(this._diffStyle(e,i),this):(this._localIdeographFontFamily=i.localIdeographFontFamily,this._updateStyle(e,i))},o.prototype._getUIString=function(t){var e=this._locale[t];if(null==e)throw new Error("Missing UI string '"+t+"'");return e},o.prototype._updateStyle=function(t,e){return this.style&&(this.style.setEventedParent(null),this.style._remove()),t?(this.style=new qe(this,e||{}),this.style.setEventedParent(this,{style:this.style}),"string"==typeof t?this.style.loadURL(t):this.style.loadJSON(t),this):(delete this.style,this)},o.prototype._lazyInitEmptyStyle=function(){this.style||(this.style=new qe(this,{}),this.style.setEventedParent(this,{style:this.style}),this.style.loadEmpty())},o.prototype._diffStyle=function(e,i){var r=this;if("string"==typeof e){var o=this._requestManager.normalizeStyleURL(e),a=this._requestManager.transformRequest(o,t.ResourceType.Style);t.getJSON(a,(function(e,o){e?r.fire(new t.ErrorEvent(e)):o&&r._updateDiff(o,i)}))}else"object"==typeof e&&this._updateDiff(e,i)},o.prototype._updateDiff=function(e,i){try{this.style.setState(e)&&this._update(!0)}catch(r){t.warnOnce("Unable to perform style diff: "+(r.message||r.error||r)+".  Rebuilding the style from scratch."),this._updateStyle(e,i)}},o.prototype.getStyle=function(){if(this.style)return this.style.serialize()},o.prototype.isStyleLoaded=function(){return this.style?this.style.loaded():t.warnOnce("There is no style added to the map.")},o.prototype.addSource=function(t,e){return this._lazyInitEmptyStyle(),this.style.addSource(t,e),this._update(!0)},o.prototype.isSourceLoaded=function(e){var i=this.style&&this.style.sourceCaches[e];if(void 0!==i)return i.loaded();this.fire(new t.ErrorEvent(new Error("There is no source with ID '"+e+"'")))},o.prototype.areTilesLoaded=function(){var t=this.style&&this.style.sourceCaches;for(var e in t){var i=t[e]._tiles;for(var r in i){var o=i[r];if("loaded"!==o.state&&"errored"!==o.state)return!1}}return!0},o.prototype.addSourceType=function(t,e,i){return this._lazyInitEmptyStyle(),this.style.addSourceType(t,e,i)},o.prototype.removeSource=function(t){return this.style.removeSource(t),this._update(!0)},o.prototype.getSource=function(t){return this.style.getSource(t)},o.prototype.addImage=function(e,i,r){void 0===r&&(r={});var o=r.pixelRatio;void 0===o&&(o=1);var a=r.sdf;void 0===a&&(a=!1);var n=r.stretchX,s=r.stretchY,l=r.content;if(this._lazyInitEmptyStyle(),i instanceof Eo||So&&i instanceof So){var c=t.browser.getImageData(i);this.style.addImage(e,{data:new t.RGBAImage({width:c.width,height:c.height},c.data),pixelRatio:o,stretchX:n,stretchY:s,content:l,sdf:a,version:0})}else{if(void 0===i.width||void 0===i.height)return this.fire(new t.ErrorEvent(new Error("Invalid arguments to map.addImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`")));var u=i;this.style.addImage(e,{data:new t.RGBAImage({width:i.width,height:i.height},new Uint8Array(i.data)),pixelRatio:o,stretchX:n,stretchY:s,content:l,sdf:a,version:0,userImage:u}),u.onAdd&&u.onAdd(this,e)}},o.prototype.updateImage=function(e,i){var r=this.style.getImage(e);if(!r)return this.fire(new t.ErrorEvent(new Error("The map has no image with that id. If you are adding a new image use `map.addImage(...)` instead.")));var o=i instanceof Eo||So&&i instanceof So?t.browser.getImageData(i):i,a=o.width,n=o.height,s=o.data;return void 0===a||void 0===n?this.fire(new t.ErrorEvent(new Error("Invalid arguments to map.updateImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`"))):a!==r.data.width||n!==r.data.height?this.fire(new t.ErrorEvent(new Error("The width and height of the updated image must be that same as the previous version of the image"))):(r.data.replace(s,!(i instanceof Eo||So&&i instanceof So)),void this.style.updateImage(e,r))},o.prototype.hasImage=function(e){return e?!!this.style.getImage(e):(this.fire(new t.ErrorEvent(new Error("Missing required image id"))),!1)},o.prototype.removeImage=function(t){this.style.removeImage(t)},o.prototype.loadImage=function(e,i){t.getImage(this._requestManager.transformRequest(e,t.ResourceType.Image),i)},o.prototype.listImages=function(){return this.style.listImages()},o.prototype.addLayer=function(t,e){return this._lazyInitEmptyStyle(),this.style.addLayer(t,e),this._update(!0)},o.prototype.moveLayer=function(t,e){return this.style.moveLayer(t,e),this._update(!0)},o.prototype.removeLayer=function(t){return this.style.removeLayer(t),this._update(!0)},o.prototype.getLayer=function(t){return this.style.getLayer(t)},o.prototype.setLayerZoomRange=function(t,e,i){return this.style.setLayerZoomRange(t,e,i),this._update(!0)},o.prototype.setFilter=function(t,e,i){return void 0===i&&(i={}),this.style.setFilter(t,e,i),this._update(!0)},o.prototype.getFilter=function(t){return this.style.getFilter(t)},o.prototype.setPaintProperty=function(t,e,i,r){return void 0===r&&(r={}),this.style.setPaintProperty(t,e,i,r),this._update(!0)},o.prototype.getPaintProperty=function(t,e){return this.style.getPaintProperty(t,e)},o.prototype.setLayoutProperty=function(t,e,i,r){return void 0===r&&(r={}),this.style.setLayoutProperty(t,e,i,r),this._update(!0)},o.prototype.getLayoutProperty=function(t,e){return this.style.getLayoutProperty(t,e)},o.prototype.setLight=function(t,e){return void 0===e&&(e={}),this._lazyInitEmptyStyle(),this.style.setLight(t,e),this._update(!0)},o.prototype.getLight=function(){return this.style.getLight()},o.prototype.setFeatureState=function(t,e){return this.style.setFeatureState(t,e),this._update()},o.prototype.removeFeatureState=function(t,e){return this.style.removeFeatureState(t,e),this._update()},o.prototype.getFeatureState=function(t){return this.style.getFeatureState(t)},o.prototype.getContainer=function(){return this._container},o.prototype.getCanvasContainer=function(){return this._canvasContainer},o.prototype.getCanvas=function(){return this._canvas},o.prototype._containerDimensions=function(){var t=0,e=0;return this._container&&(t=this._container.clientWidth||400,e=this._container.clientHeight||300),[t,e]},o.prototype._detectMissingCSS=function(){"rgb(250, 128, 114)"!==t.window.getComputedStyle(this._missingCSSCanary).getPropertyValue("background-color")&&t.warnOnce("This page appears to be missing CSS declarations for Mapbox GL JS, which may cause the map to display incorrectly. Please ensure your page includes mapbox-gl.css, as described in https://www.mapbox.com/mapbox-gl-js/api/.")},o.prototype._setupContainer=function(){var t=this._container;t.classList.add("mapboxgl-map"),(this._missingCSSCanary=i.create("div","mapboxgl-canary",t)).style.visibility="hidden",this._detectMissingCSS();var e=this._canvasContainer=i.create("div","mapboxgl-canvas-container",t);this._interactive&&e.classList.add("mapboxgl-interactive"),this._canvas=i.create("canvas","mapboxgl-canvas",e),this._canvas.addEventListener("webglcontextlost",this._contextLost,!1),this._canvas.addEventListener("webglcontextrestored",this._contextRestored,!1),this._canvas.setAttribute("tabindex","0"),this._canvas.setAttribute("aria-label","Map");var r=this._containerDimensions();this._resizeCanvas(r[0],r[1]);var o=this._controlContainer=i.create("div","mapboxgl-control-container",t),a=this._controlPositions={};["top-left","top-right","bottom-left","bottom-right"].forEach((function(t){a[t]=i.create("div","mapboxgl-ctrl-"+t,o)}))},o.prototype._resizeCanvas=function(e,i){var r=t.browser.devicePixelRatio||1;this._canvas.width=r*e,this._canvas.height=r*i,this._canvas.style.width=e+"px",this._canvas.style.height=i+"px"},o.prototype._setupPainter=function(){var i=t.extend({},e.webGLContextAttributes,{failIfMajorPerformanceCaveat:this._failIfMajorPerformanceCaveat,preserveDrawingBuffer:this._preserveDrawingBuffer,antialias:this._antialias||!1}),r=this._canvas.getContext("webgl",i)||this._canvas.getContext("experimental-webgl",i);r?(this.painter=new bi(r,this.transform),t.webpSupported.testSupport(r)):this.fire(new t.ErrorEvent(new Error("Failed to initialize WebGL")))},o.prototype._contextLost=function(e){e.preventDefault(),this._frame&&(this._frame.cancel(),this._frame=null),this.fire(new t.Event("webglcontextlost",{originalEvent:e}))},o.prototype._contextRestored=function(e){this._setupPainter(),this.resize(),this._update(),this.fire(new t.Event("webglcontextrestored",{originalEvent:e}))},o.prototype.loaded=function(){return!this._styleDirty&&!this._sourcesDirty&&!!this.style&&this.style.loaded()},o.prototype._update=function(t){return this.style?(this._styleDirty=this._styleDirty||t,this._sourcesDirty=!0,this.triggerRepaint(),this):this},o.prototype._requestRenderFrame=function(t){return this._update(),this._renderTaskQueue.add(t)},o.prototype._cancelRenderFrame=function(t){this._renderTaskQueue.remove(t)},o.prototype._render=function(e){var i,r=this,o=0,a=this.painter.context.extTimerQuery;if(this.listens("gpu-timing-frame")&&(i=a.createQueryEXT(),a.beginQueryEXT(a.TIME_ELAPSED_EXT,i),o=t.browser.now()),this.painter.context.setDirty(),this.painter.setBaseState(),this._renderTaskQueue.run(e),!this._removed){var n=!1;if(this.style&&this._styleDirty){this._styleDirty=!1;var s=this.transform.zoom,l=t.browser.now();this.style.zoomHistory.update(s,l);var c=new t.EvaluationParameters(s,{now:l,fadeDuration:this._fadeDuration,zoomHistory:this.style.zoomHistory,transition:this.style.getTransition()}),u=c.crossFadingFactor();1===u&&u===this._crossFadingFactor||(n=!0,this._crossFadingFactor=u),this.style.update(c)}if(this.style&&this._sourcesDirty&&(this._sourcesDirty=!1,this.style._updateSources(this.transform)),this._placementDirty=this.style&&this.style._updatePlacement(this.painter.transform,this.showCollisionBoxes,this._fadeDuration,this._crossSourceCollisions),this.painter.render(this.style,{showTileBoundaries:this.showTileBoundaries,showOverdrawInspector:this._showOverdrawInspector,rotating:this.isRotating(),zooming:this.isZooming(),moving:this.isMoving(),fadeDuration:this._fadeDuration,showPadding:this.showPadding,gpuTiming:!!this.listens("gpu-timing-layer")}),this.fire(new t.Event("render")),this.loaded()&&!this._loaded&&(this._loaded=!0,this.fire(new t.Event("load"))),this.style&&(this.style.hasTransitions()||n)&&(this._styleDirty=!0),this.style&&!this._placementDirty&&this.style._releaseSymbolFadeTiles(),this.listens("gpu-timing-frame")){var h=t.browser.now()-o;a.endQueryEXT(a.TIME_ELAPSED_EXT,i),setTimeout((function(){var e=a.getQueryObjectEXT(i,a.QUERY_RESULT_EXT)/1e6;a.deleteQueryEXT(i),r.fire(new t.Event("gpu-timing-frame",{cpuTime:h,gpuTime:e}))}),50)}if(this.listens("gpu-timing-layer")){var p=this.painter.collectGpuTimers();setTimeout((function(){var e=r.painter.queryGpuTimers(p);r.fire(new t.Event("gpu-timing-layer",{layerTimes:e}))}),50)}var d=this._sourcesDirty||this._styleDirty||this._placementDirty;return d||this._repaint?this.triggerRepaint():!this.isMoving()&&this.loaded()&&this.fire(new t.Event("idle")),!this._loaded||this._fullyLoaded||d||(this._fullyLoaded=!0),this}},o.prototype.remove=function(){this._hash&&this._hash.remove();for(var e=0,i=this._controls;e<i.length;e+=1)i[e].onRemove(this);this._controls=[],this._frame&&(this._frame.cancel(),this._frame=null),this._renderTaskQueue.clear(),this.painter.destroy(),this.handlers.destroy(),delete this.handlers,this.setStyle(null),void 0!==t.window&&(t.window.removeEventListener("resize",this._onWindowResize,!1),t.window.removeEventListener("online",this._onWindowOnline,!1));var r=this.painter.context.gl.getExtension("WEBGL_lose_context");r&&r.loseContext(),zo(this._canvasContainer),zo(this._controlContainer),zo(this._missingCSSCanary),this._container.classList.remove("mapboxgl-map"),this._removed=!0,this.fire(new t.Event("remove"))},o.prototype.triggerRepaint=function(){var e=this;this.style&&!this._frame&&(this._frame=t.browser.frame((function(t){e._frame=null,e._render(t)})))},o.prototype._onWindowOnline=function(){this._update()},o.prototype._onWindowResize=function(t){this._trackResize&&this.resize({originalEvent:t})._update()},a.showTileBoundaries.get=function(){return!!this._showTileBoundaries},a.showTileBoundaries.set=function(t){this._showTileBoundaries!==t&&(this._showTileBoundaries=t,this._update())},a.showPadding.get=function(){return!!this._showPadding},a.showPadding.set=function(t){this._showPadding!==t&&(this._showPadding=t,this._update())},a.showCollisionBoxes.get=function(){return!!this._showCollisionBoxes},a.showCollisionBoxes.set=function(t){this._showCollisionBoxes!==t&&(this._showCollisionBoxes=t,t?this.style._generateCollisionBoxes():this._update())},a.showOverdrawInspector.get=function(){return!!this._showOverdrawInspector},a.showOverdrawInspector.set=function(t){this._showOverdrawInspector!==t&&(this._showOverdrawInspector=t,this._update())},a.repaint.get=function(){return!!this._repaint},a.repaint.set=function(t){this._repaint!==t&&(this._repaint=t,this.triggerRepaint())},a.vertices.get=function(){return!!this._vertices},a.vertices.set=function(t){this._vertices=t,this._update()},o.prototype._setCacheLimits=function(e,i){t.setCacheLimits(e,i)},a.version.get=function(){return t.version},Object.defineProperties(o.prototype,a),o}(_o);function zo(t){t.parentNode&&t.parentNode.removeChild(t)}var Co={showCompass:!0,showZoom:!0,visualizePitch:!1},Po=function(e){var r=this;this.options=t.extend({},Co,e),this._container=i.create("div","mapboxgl-ctrl mapboxgl-ctrl-group"),this._container.addEventListener("contextmenu",(function(t){return t.preventDefault()})),this.options.showZoom&&(t.bindAll(["_setButtonTitle","_updateZoomButtons"],this),this._zoomInButton=this._createButton("mapboxgl-ctrl-zoom-in",(function(t){return r._map.zoomIn({},{originalEvent:t})})),i.create("span","mapboxgl-ctrl-icon",this._zoomInButton).setAttribute("aria-hidden",!0),this._zoomOutButton=this._createButton("mapboxgl-ctrl-zoom-out",(function(t){return r._map.zoomOut({},{originalEvent:t})})),i.create("span","mapboxgl-ctrl-icon",this._zoomOutButton).setAttribute("aria-hidden",!0)),this.options.showCompass&&(t.bindAll(["_rotateCompassArrow"],this),this._compass=this._createButton("mapboxgl-ctrl-compass",(function(t){r.options.visualizePitch?r._map.resetNorthPitch({},{originalEvent:t}):r._map.resetNorth({},{originalEvent:t})})),this._compassIcon=i.create("span","mapboxgl-ctrl-icon",this._compass),this._compassIcon.setAttribute("aria-hidden",!0))};Po.prototype._updateZoomButtons=function(){var t=this._map.getZoom();this._zoomInButton.disabled=t===this._map.getMaxZoom(),this._zoomOutButton.disabled=t===this._map.getMinZoom()},Po.prototype._rotateCompassArrow=function(){var t=this.options.visualizePitch?"scale("+1/Math.pow(Math.cos(this._map.transform.pitch*(Math.PI/180)),.5)+") rotateX("+this._map.transform.pitch+"deg) rotateZ("+this._map.transform.angle*(180/Math.PI)+"deg)":"rotate("+this._map.transform.angle*(180/Math.PI)+"deg)";this._compassIcon.style.transform=t},Po.prototype.onAdd=function(t){return this._map=t,this.options.showZoom&&(this._setButtonTitle(this._zoomInButton,"ZoomIn"),this._setButtonTitle(this._zoomOutButton,"ZoomOut"),this._map.on("zoom",this._updateZoomButtons),this._updateZoomButtons()),this.options.showCompass&&(this._setButtonTitle(this._compass,"ResetBearing"),this.options.visualizePitch&&this._map.on("pitch",this._rotateCompassArrow),this._map.on("rotate",this._rotateCompassArrow),this._rotateCompassArrow(),this._handler=new Ao(this._map,this._compass,this.options.visualizePitch)),this._container},Po.prototype.onRemove=function(){i.remove(this._container),this.options.showZoom&&this._map.off("zoom",this._updateZoomButtons),this.options.showCompass&&(this.options.visualizePitch&&this._map.off("pitch",this._rotateCompassArrow),this._map.off("rotate",this._rotateCompassArrow),this._handler.off(),delete this._handler),delete this._map},Po.prototype._createButton=function(t,e){var r=i.create("button",t,this._container);return r.type="button",r.addEventListener("click",e),r},Po.prototype._setButtonTitle=function(t,e){var i=this._map._getUIString("NavigationControl."+e);t.title=i,t.setAttribute("aria-label",i)};var Ao=function(e,r,o){void 0===o&&(o=!1),this._clickTolerance=10,this.element=r,this.mouseRotate=new Xi({clickTolerance:e.dragRotate._mouseRotate._clickTolerance}),this.map=e,o&&(this.mousePitch=new $i({clickTolerance:e.dragRotate._mousePitch._clickTolerance})),t.bindAll(["mousedown","mousemove","mouseup","touchstart","touchmove","touchend","reset"],this),i.addEventListener(r,"mousedown",this.mousedown),i.addEventListener(r,"touchstart",this.touchstart,{passive:!1}),i.addEventListener(r,"touchmove",this.touchmove),i.addEventListener(r,"touchend",this.touchend),i.addEventListener(r,"touchcancel",this.reset)};function Mo(e,i,r){if(e=new t.LngLat(e.lng,e.lat),i){var o=new t.LngLat(e.lng-360,e.lat),a=new t.LngLat(e.lng+360,e.lat),n=r.locationPoint(e).distSqr(i);r.locationPoint(o).distSqr(i)<n?e=o:r.locationPoint(a).distSqr(i)<n&&(e=a)}for(;Math.abs(e.lng-r.center.lng)>180;){var s=r.locationPoint(e);if(s.x>=0&&s.y>=0&&s.x<=r.width&&s.y<=r.height)break;e.lng>r.center.lng?e.lng-=360:e.lng+=360}return e}Ao.prototype.down=function(t,e){this.mouseRotate.mousedown(t,e),this.mousePitch&&this.mousePitch.mousedown(t,e),i.disableDrag()},Ao.prototype.move=function(t,e){var i=this.map,r=this.mouseRotate.mousemoveWindow(t,e);if(r&&r.bearingDelta&&i.setBearing(i.getBearing()+r.bearingDelta),this.mousePitch){var o=this.mousePitch.mousemoveWindow(t,e);o&&o.pitchDelta&&i.setPitch(i.getPitch()+o.pitchDelta)}},Ao.prototype.off=function(){var t=this.element;i.removeEventListener(t,"mousedown",this.mousedown),i.removeEventListener(t,"touchstart",this.touchstart,{passive:!1}),i.removeEventListener(t,"touchmove",this.touchmove),i.removeEventListener(t,"touchend",this.touchend),i.removeEventListener(t,"touchcancel",this.reset),this.offTemp()},Ao.prototype.offTemp=function(){i.enableDrag(),i.removeEventListener(t.window,"mousemove",this.mousemove),i.removeEventListener(t.window,"mouseup",this.mouseup)},Ao.prototype.mousedown=function(e){this.down(t.extend({},e,{ctrlKey:!0,preventDefault:function(){return e.preventDefault()}}),i.mousePos(this.element,e)),i.addEventListener(t.window,"mousemove",this.mousemove),i.addEventListener(t.window,"mouseup",this.mouseup)},Ao.prototype.mousemove=function(t){this.move(t,i.mousePos(this.element,t))},Ao.prototype.mouseup=function(t){this.mouseRotate.mouseupWindow(t),this.mousePitch&&this.mousePitch.mouseupWindow(t),this.offTemp()},Ao.prototype.touchstart=function(t){1!==t.targetTouches.length?this.reset():(this._startPos=this._lastPos=i.touchPos(this.element,t.targetTouches)[0],this.down({type:"mousedown",button:0,ctrlKey:!0,preventDefault:function(){return t.preventDefault()}},this._startPos))},Ao.prototype.touchmove=function(t){1!==t.targetTouches.length?this.reset():(this._lastPos=i.touchPos(this.element,t.targetTouches)[0],this.move({preventDefault:function(){return t.preventDefault()}},this._lastPos))},Ao.prototype.touchend=function(t){0===t.targetTouches.length&&this._startPos&&this._lastPos&&this._startPos.dist(this._lastPos)<this._clickTolerance&&this.element.click(),this.reset()},Ao.prototype.reset=function(){this.mouseRotate.reset(),this.mousePitch&&this.mousePitch.reset(),delete this._startPos,delete this._lastPos,this.offTemp()};var Lo={center:"translate(-50%,-50%)",top:"translate(-50%,0)","top-left":"translate(0,0)","top-right":"translate(-100%,0)",bottom:"translate(-50%,-100%)","bottom-left":"translate(0,-100%)","bottom-right":"translate(-100%,-100%)",left:"translate(0,-50%)",right:"translate(-100%,-50%)"};function Ro(t,e,i){var r=t.classList;for(var o in Lo)r.remove("mapboxgl-"+i+"-anchor-"+o);r.add("mapboxgl-"+i+"-anchor-"+e)}var Do,Oo=function(e){function r(r,o){var a=this;if(e.call(this),(r instanceof t.window.HTMLElement||o)&&(r=t.extend({element:r},o)),t.bindAll(["_update","_onMove","_onUp","_addDragHandler","_onMapClick","_onKeyPress"],this),this._anchor=r&&r.anchor||"center",this._color=r&&r.color||"#3FB1CE",this._scale=r&&r.scale||1,this._draggable=r&&r.draggable||!1,this._state="inactive",this._rotation=r&&r.rotation||0,this._rotationAlignment=r&&r.rotationAlignment||"auto",this._pitchAlignment=r&&r.pitchAlignment&&"auto"!==r.pitchAlignment?r.pitchAlignment:this._rotationAlignment,r&&r.element)this._element=r.element,this._offset=t.Point.convert(r&&r.offset||[0,0]);else{this._defaultMarker=!0,this._element=i.create("div"),this._element.setAttribute("aria-label","Map marker");var n=i.createNS("http://www.w3.org/2000/svg","svg");n.setAttributeNS(null,"display","block"),n.setAttributeNS(null,"height","41px"),n.setAttributeNS(null,"width","27px"),n.setAttributeNS(null,"viewBox","0 0 27 41");var s=i.createNS("http://www.w3.org/2000/svg","g");s.setAttributeNS(null,"stroke","none"),s.setAttributeNS(null,"stroke-width","1"),s.setAttributeNS(null,"fill","none"),s.setAttributeNS(null,"fill-rule","evenodd");var l=i.createNS("http://www.w3.org/2000/svg","g");l.setAttributeNS(null,"fill-rule","nonzero");var c=i.createNS("http://www.w3.org/2000/svg","g");c.setAttributeNS(null,"transform","translate(3.0, 29.0)"),c.setAttributeNS(null,"fill","#000000");for(var u=0,h=[{rx:"10.5",ry:"5.25002273"},{rx:"10.5",ry:"5.25002273"},{rx:"9.5",ry:"4.77275007"},{rx:"8.5",ry:"4.29549936"},{rx:"7.5",ry:"3.81822308"},{rx:"6.5",ry:"3.34094679"},{rx:"5.5",ry:"2.86367051"},{rx:"4.5",ry:"2.38636864"}];u<h.length;u+=1){var p=h[u],d=i.createNS("http://www.w3.org/2000/svg","ellipse");d.setAttributeNS(null,"opacity","0.04"),d.setAttributeNS(null,"cx","10.5"),d.setAttributeNS(null,"cy","5.80029008"),d.setAttributeNS(null,"rx",p.rx),d.setAttributeNS(null,"ry",p.ry),c.appendChild(d)}var f=i.createNS("http://www.w3.org/2000/svg","g");f.setAttributeNS(null,"fill",this._color);var m=i.createNS("http://www.w3.org/2000/svg","path");m.setAttributeNS(null,"d","M27,13.5 C27,19.074644 20.250001,27.000002 14.75,34.500002 C14.016665,35.500004 12.983335,35.500004 12.25,34.500002 C6.7499993,27.000002 0,19.222562 0,13.5 C0,6.0441559 6.0441559,0 13.5,0 C20.955844,0 27,6.0441559 27,13.5 Z"),f.appendChild(m);var y=i.createNS("http://www.w3.org/2000/svg","g");y.setAttributeNS(null,"opacity","0.25"),y.setAttributeNS(null,"fill","#000000");var g=i.createNS("http://www.w3.org/2000/svg","path");g.setAttributeNS(null,"d","M13.5,0 C6.0441559,0 0,6.0441559 0,13.5 C0,19.222562 6.7499993,27 12.25,34.5 C13,35.522727 14.016664,35.500004 14.75,34.5 C20.250001,27 27,19.074644 27,13.5 C27,6.0441559 20.955844,0 13.5,0 Z M13.5,1 C20.415404,1 26,6.584596 26,13.5 C26,15.898657 24.495584,19.181431 22.220703,22.738281 C19.945823,26.295132 16.705119,30.142167 13.943359,33.908203 C13.743445,34.180814 13.612715,34.322738 13.5,34.441406 C13.387285,34.322738 13.256555,34.180814 13.056641,33.908203 C10.284481,30.127985 7.4148684,26.314159 5.015625,22.773438 C2.6163816,19.232715 1,15.953538 1,13.5 C1,6.584596 6.584596,1 13.5,1 Z"),y.appendChild(g);var v=i.createNS("http://www.w3.org/2000/svg","g");v.setAttributeNS(null,"transform","translate(6.0, 7.0)"),v.setAttributeNS(null,"fill","#FFFFFF");var _=i.createNS("http://www.w3.org/2000/svg","g");_.setAttributeNS(null,"transform","translate(8.0, 8.0)");var x=i.createNS("http://www.w3.org/2000/svg","circle");x.setAttributeNS(null,"fill","#000000"),x.setAttributeNS(null,"opacity","0.25"),x.setAttributeNS(null,"cx","5.5"),x.setAttributeNS(null,"cy","5.5"),x.setAttributeNS(null,"r","5.4999962");var b=i.createNS("http://www.w3.org/2000/svg","circle");b.setAttributeNS(null,"fill","#FFFFFF"),b.setAttributeNS(null,"cx","5.5"),b.setAttributeNS(null,"cy","5.5"),b.setAttributeNS(null,"r","5.4999962"),_.appendChild(x),_.appendChild(b),l.appendChild(c),l.appendChild(f),l.appendChild(y),l.appendChild(v),l.appendChild(_),n.appendChild(l),n.setAttributeNS(null,"height",41*this._scale+"px"),n.setAttributeNS(null,"width",27*this._scale+"px"),this._element.appendChild(n),this._offset=t.Point.convert(r&&r.offset||[0,-14])}this._element.classList.add("mapboxgl-marker"),this._element.addEventListener("dragstart",(function(t){t.preventDefault()})),this._element.addEventListener("mousedown",(function(t){t.preventDefault()})),this._element.addEventListener("focus",(function(){var t=a._map.getContainer();t.scrollTop=0,t.scrollLeft=0})),Ro(this._element,this._anchor,"marker"),this._popup=null}return e&&(r.__proto__=e),(r.prototype=Object.create(e&&e.prototype)).constructor=r,r.prototype.addTo=function(t){return this.remove(),this._map=t,t.getCanvasContainer().appendChild(this._element),t.on("move",this._update),t.on("moveend",this._update),this.setDraggable(this._draggable),this._update(),this._map.on("click",this._onMapClick),this},r.prototype.remove=function(){return this._map&&(this._map.off("click",this._onMapClick),this._map.off("move",this._update),this._map.off("moveend",this._update),this._map.off("mousedown",this._addDragHandler),this._map.off("touchstart",this._addDragHandler),this._map.off("mouseup",this._onUp),this._map.off("touchend",this._onUp),this._map.off("mousemove",this._onMove),this._map.off("touchmove",this._onMove),delete this._map),i.remove(this._element),this._popup&&this._popup.remove(),this},r.prototype.getLngLat=function(){return this._lngLat},r.prototype.setLngLat=function(e){return this._lngLat=t.LngLat.convert(e),this._pos=null,this._popup&&this._popup.setLngLat(this._lngLat),this._update(),this},r.prototype.getElement=function(){return this._element},r.prototype.setPopup=function(t){if(this._popup&&(this._popup.remove(),this._popup=null,this._element.removeEventListener("keypress",this._onKeyPress),this._originalTabIndex||this._element.removeAttribute("tabindex")),t){if(!("offset"in t.options)){var e=Math.sqrt(Math.pow(13.5,2)/2);t.options.offset=this._defaultMarker?{top:[0,0],"top-left":[0,0],"top-right":[0,0],bottom:[0,-38.1],"bottom-left":[e,-1*(24.6+e)],"bottom-right":[-e,-1*(24.6+e)],left:[13.5,-24.6],right:[-13.5,-24.6]}:this._offset}this._popup=t,this._lngLat&&this._popup.setLngLat(this._lngLat),this._originalTabIndex=this._element.getAttribute("tabindex"),this._originalTabIndex||this._element.setAttribute("tabindex","0"),this._element.addEventListener("keypress",this._onKeyPress)}return this},r.prototype._onKeyPress=function(t){var e=t.code,i=t.charCode||t.keyCode;"Space"!==e&&"Enter"!==e&&32!==i&&13!==i||this.togglePopup()},r.prototype._onMapClick=function(t){var e=t.originalEvent.target,i=this._element;this._popup&&(e===i||i.contains(e))&&this.togglePopup()},r.prototype.getPopup=function(){return this._popup},r.prototype.togglePopup=function(){var t=this._popup;return t?(t.isOpen()?t.remove():t.addTo(this._map),this):this},r.prototype._update=function(t){if(this._map){this._map.transform.renderWorldCopies&&(this._lngLat=Mo(this._lngLat,this._pos,this._map.transform)),this._pos=this._map.project(this._lngLat)._add(this._offset);var e="";"viewport"===this._rotationAlignment||"auto"===this._rotationAlignment?e="rotateZ("+this._rotation+"deg)":"map"===this._rotationAlignment&&(e="rotateZ("+(this._rotation-this._map.getBearing())+"deg)");var r="";"viewport"===this._pitchAlignment||"auto"===this._pitchAlignment?r="rotateX(0deg)":"map"===this._pitchAlignment&&(r="rotateX("+this._map.getPitch()+"deg)"),t&&"moveend"!==t.type||(this._pos=this._pos.round()),i.setTransform(this._element,Lo[this._anchor]+" translate("+this._pos.x+"px, "+this._pos.y+"px) "+r+" "+e)}},r.prototype.getOffset=function(){return this._offset},r.prototype.setOffset=function(e){return this._offset=t.Point.convert(e),this._update(),this},r.prototype._onMove=function(e){this._pos=e.point.sub(this._positionDelta),this._lngLat=this._map.unproject(this._pos),this.setLngLat(this._lngLat),this._element.style.pointerEvents="none","pending"===this._state&&(this._state="active",this.fire(new t.Event("dragstart"))),this.fire(new t.Event("drag"))},r.prototype._onUp=function(){this._element.style.pointerEvents="auto",this._positionDelta=null,this._map.off("mousemove",this._onMove),this._map.off("touchmove",this._onMove),"active"===this._state&&this.fire(new t.Event("dragend")),this._state="inactive"},r.prototype._addDragHandler=function(t){this._element.contains(t.originalEvent.target)&&(t.preventDefault(),this._positionDelta=t.point.sub(this._pos).add(this._offset),this._state="pending",this._map.on("mousemove",this._onMove),this._map.on("touchmove",this._onMove),this._map.once("mouseup",this._onUp),this._map.once("touchend",this._onUp))},r.prototype.setDraggable=function(t){return this._draggable=!!t,this._map&&(t?(this._map.on("mousedown",this._addDragHandler),this._map.on("touchstart",this._addDragHandler)):(this._map.off("mousedown",this._addDragHandler),this._map.off("touchstart",this._addDragHandler))),this},r.prototype.isDraggable=function(){return this._draggable},r.prototype.setRotation=function(t){return this._rotation=t||0,this._update(),this},r.prototype.getRotation=function(){return this._rotation},r.prototype.setRotationAlignment=function(t){return this._rotationAlignment=t||"auto",this._update(),this},r.prototype.getRotationAlignment=function(){return this._rotationAlignment},r.prototype.setPitchAlignment=function(t){return this._pitchAlignment=t&&"auto"!==t?t:this._rotationAlignment,this._update(),this},r.prototype.getPitchAlignment=function(){return this._pitchAlignment},r}(t.Evented),Bo={positionOptions:{enableHighAccuracy:!1,maximumAge:0,timeout:6e3},fitBoundsOptions:{maxZoom:15},trackUserLocation:!1,showAccuracyCircle:!0,showUserLocation:!0},Fo=0,Uo=!1,No=function(e){function r(i){e.call(this),this.options=t.extend({},Bo,i),t.bindAll(["_onSuccess","_onError","_onZoom","_finish","_setupUI","_updateCamera","_updateMarker"],this)}return e&&(r.__proto__=e),(r.prototype=Object.create(e&&e.prototype)).constructor=r,r.prototype.onAdd=function(e){var r;return this._map=e,this._container=i.create("div","mapboxgl-ctrl mapboxgl-ctrl-group"),r=this._setupUI,void 0!==Do?r(Do):void 0!==t.window.navigator.permissions?t.window.navigator.permissions.query({name:"geolocation"}).then((function(t){r(Do="denied"!==t.state)})):r(Do=!!t.window.navigator.geolocation),this._container},r.prototype.onRemove=function(){void 0!==this._geolocationWatchID&&(t.window.navigator.geolocation.clearWatch(this._geolocationWatchID),this._geolocationWatchID=void 0),this.options.showUserLocation&&this._userLocationDotMarker&&this._userLocationDotMarker.remove(),this.options.showAccuracyCircle&&this._accuracyCircleMarker&&this._accuracyCircleMarker.remove(),i.remove(this._container),this._map.off("zoom",this._onZoom),this._map=void 0,Fo=0,Uo=!1},r.prototype._isOutOfMapMaxBounds=function(t){var e=this._map.getMaxBounds(),i=t.coords;return e&&(i.longitude<e.getWest()||i.longitude>e.getEast()||i.latitude<e.getSouth()||i.latitude>e.getNorth())},r.prototype._setErrorState=function(){switch(this._watchState){case"WAITING_ACTIVE":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active-error");break;case"ACTIVE_LOCK":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting");break;case"BACKGROUND":this._watchState="BACKGROUND_ERROR",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting")}},r.prototype._onSuccess=function(e){if(this._map){if(this._isOutOfMapMaxBounds(e))return this._setErrorState(),this.fire(new t.Event("outofmaxbounds",e)),this._updateMarker(),void this._finish();if(this.options.trackUserLocation)switch(this._lastKnownPosition=e,this._watchState){case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active");break;case"BACKGROUND":case"BACKGROUND_ERROR":this._watchState="BACKGROUND",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background")}this.options.showUserLocation&&"OFF"!==this._watchState&&this._updateMarker(e),this.options.trackUserLocation&&"ACTIVE_LOCK"!==this._watchState||this._updateCamera(e),this.options.showUserLocation&&this._dotElement.classList.remove("mapboxgl-user-location-dot-stale"),this.fire(new t.Event("geolocate",e)),this._finish()}},r.prototype._updateCamera=function(e){var i=new t.LngLat(e.coords.longitude,e.coords.latitude),r=e.coords.accuracy,o=this._map.getBearing(),a=t.extend({bearing:o},this.options.fitBoundsOptions);this._map.fitBounds(i.toBounds(r),a,{geolocateSource:!0})},r.prototype._updateMarker=function(e){if(e){var i=new t.LngLat(e.coords.longitude,e.coords.latitude);this._accuracyCircleMarker.setLngLat(i).addTo(this._map),this._userLocationDotMarker.setLngLat(i).addTo(this._map),this._accuracy=e.coords.accuracy,this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()}else this._userLocationDotMarker.remove(),this._accuracyCircleMarker.remove()},r.prototype._updateCircleRadius=function(){var t=this._map._container.clientHeight/2,e=this._map.unproject([0,t]),i=this._map.unproject([1,t]),r=e.distanceTo(i),o=Math.ceil(2*this._accuracy/r);this._circleElement.style.width=o+"px",this._circleElement.style.height=o+"px"},r.prototype._onZoom=function(){this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()},r.prototype._onError=function(e){if(this._map){if(this.options.trackUserLocation)if(1===e.code){this._watchState="OFF",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.disabled=!0;var i=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.title=i,this._geolocateButton.setAttribute("aria-label",i),void 0!==this._geolocationWatchID&&this._clearWatch()}else{if(3===e.code&&Uo)return;this._setErrorState()}"OFF"!==this._watchState&&this.options.showUserLocation&&this._dotElement.classList.add("mapboxgl-user-location-dot-stale"),this.fire(new t.Event("error",e)),this._finish()}},r.prototype._finish=function(){this._timeoutId&&clearTimeout(this._timeoutId),this._timeoutId=void 0},r.prototype._setupUI=function(e){var r=this;if(this._container.addEventListener("contextmenu",(function(t){return t.preventDefault()})),this._geolocateButton=i.create("button","mapboxgl-ctrl-geolocate",this._container),i.create("span","mapboxgl-ctrl-icon",this._geolocateButton).setAttribute("aria-hidden",!0),this._geolocateButton.type="button",!1===e){t.warnOnce("Geolocation support is not available so the GeolocateControl will be disabled.");var o=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.disabled=!0,this._geolocateButton.title=o,this._geolocateButton.setAttribute("aria-label",o)}else{var a=this._map._getUIString("GeolocateControl.FindMyLocation");this._geolocateButton.title=a,this._geolocateButton.setAttribute("aria-label",a)}this.options.trackUserLocation&&(this._geolocateButton.setAttribute("aria-pressed","false"),this._watchState="OFF"),this.options.showUserLocation&&(this._dotElement=i.create("div","mapboxgl-user-location-dot"),this._userLocationDotMarker=new Oo(this._dotElement),this._circleElement=i.create("div","mapboxgl-user-location-accuracy-circle"),this._accuracyCircleMarker=new Oo({element:this._circleElement,pitchAlignment:"map"}),this.options.trackUserLocation&&(this._watchState="OFF"),this._map.on("zoom",this._onZoom)),this._geolocateButton.addEventListener("click",this.trigger.bind(this)),this._setup=!0,this.options.trackUserLocation&&this._map.on("movestart",(function(e){e.geolocateSource||"ACTIVE_LOCK"!==r._watchState||e.originalEvent&&"resize"===e.originalEvent.type||(r._watchState="BACKGROUND",r._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background"),r._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),r.fire(new t.Event("trackuserlocationend")))}))},r.prototype.trigger=function(){if(!this._setup)return t.warnOnce("Geolocate control triggered before added to a map"),!1;if(this.options.trackUserLocation){switch(this._watchState){case"OFF":this._watchState="WAITING_ACTIVE",this.fire(new t.Event("trackuserlocationstart"));break;case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":case"BACKGROUND_ERROR":Fo--,Uo=!1,this._watchState="OFF",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background-error"),this.fire(new t.Event("trackuserlocationend"));break;case"BACKGROUND":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._lastKnownPosition&&this._updateCamera(this._lastKnownPosition),this.fire(new t.Event("trackuserlocationstart"))}switch(this._watchState){case"WAITING_ACTIVE":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active");break;case"ACTIVE_LOCK":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active");break;case"ACTIVE_ERROR":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active-error");break;case"BACKGROUND":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background");break;case"BACKGROUND_ERROR":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background-error")}if("OFF"===this._watchState&&void 0!==this._geolocationWatchID)this._clearWatch();else if(void 0===this._geolocationWatchID){var e;this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","true"),++Fo>1?(e={maximumAge:6e5,timeout:0},Uo=!0):(e=this.options.positionOptions,Uo=!1),this._geolocationWatchID=t.window.navigator.geolocation.watchPosition(this._onSuccess,this._onError,e)}}else t.window.navigator.geolocation.getCurrentPosition(this._onSuccess,this._onError,this.options.positionOptions),this._timeoutId=setTimeout(this._finish,1e4);return!0},r.prototype._clearWatch=function(){t.window.navigator.geolocation.clearWatch(this._geolocationWatchID),this._geolocationWatchID=void 0,this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","false"),this.options.showUserLocation&&this._updateMarker(null)},r}(t.Evented),jo={maxWidth:100,unit:"metric"},Vo=function(e){this.options=t.extend({},jo,e),t.bindAll(["_onMove","setUnit"],this)};function qo(t,e,i){var r=i&&i.maxWidth||100,o=t._container.clientHeight/2,a=t.unproject([0,o]),n=t.unproject([r,o]),s=a.distanceTo(n);if(i&&"imperial"===i.unit){var l=3.2808*s;l>5280?Go(e,r,l/5280,t._getUIString("ScaleControl.Miles")):Go(e,r,l,t._getUIString("ScaleControl.Feet"))}else i&&"nautical"===i.unit?Go(e,r,s/1852,t._getUIString("ScaleControl.NauticalMiles")):s>=1e3?Go(e,r,s/1e3,t._getUIString("ScaleControl.Kilometers")):Go(e,r,s,t._getUIString("ScaleControl.Meters"))}function Go(t,e,i,r){var o,a,n,s=(o=i,(a=Math.pow(10,(""+Math.floor(o)).length-1))*(n=(n=o/a)>=10?10:n>=5?5:n>=3?3:n>=2?2:n>=1?1:function(t){var e=Math.pow(10,Math.ceil(-Math.log(t)/Math.LN10));return Math.round(t*e)/e}(n)));t.style.width=e*(s/i)+"px",t.innerHTML=s+"&nbsp;"+r}Vo.prototype.getDefaultPosition=function(){return"bottom-left"},Vo.prototype._onMove=function(){qo(this._map,this._container,this.options)},Vo.prototype.onAdd=function(t){return this._map=t,this._container=i.create("div","mapboxgl-ctrl mapboxgl-ctrl-scale",t.getContainer()),this._map.on("move",this._onMove),this._onMove(),this._container},Vo.prototype.onRemove=function(){i.remove(this._container),this._map.off("move",this._onMove),this._map=void 0},Vo.prototype.setUnit=function(t){this.options.unit=t,qo(this._map,this._container,this.options)};var Zo=function(e){this._fullscreen=!1,e&&e.container&&(e.container instanceof t.window.HTMLElement?this._container=e.container:t.warnOnce("Full screen control 'container' must be a DOM element.")),t.bindAll(["_onClickFullscreen","_changeIcon"],this),"onfullscreenchange"in t.window.document?this._fullscreenchange="fullscreenchange":"onmozfullscreenchange"in t.window.document?this._fullscreenchange="mozfullscreenchange":"onwebkitfullscreenchange"in t.window.document?this._fullscreenchange="webkitfullscreenchange":"onmsfullscreenchange"in t.window.document&&(this._fullscreenchange="MSFullscreenChange")};Zo.prototype.onAdd=function(e){return this._map=e,this._container||(this._container=this._map.getContainer()),this._controlContainer=i.create("div","mapboxgl-ctrl mapboxgl-ctrl-group"),this._checkFullscreenSupport()?this._setupUI():(this._controlContainer.style.display="none",t.warnOnce("This device does not support fullscreen mode.")),this._controlContainer},Zo.prototype.onRemove=function(){i.remove(this._controlContainer),this._map=null,t.window.document.removeEventListener(this._fullscreenchange,this._changeIcon)},Zo.prototype._checkFullscreenSupport=function(){return!!(t.window.document.fullscreenEnabled||t.window.document.mozFullScreenEnabled||t.window.document.msFullscreenEnabled||t.window.document.webkitFullscreenEnabled)},Zo.prototype._setupUI=function(){var e=this._fullscreenButton=i.create("button","mapboxgl-ctrl-fullscreen",this._controlContainer);i.create("span","mapboxgl-ctrl-icon",e).setAttribute("aria-hidden",!0),e.type="button",this._updateTitle(),this._fullscreenButton.addEventListener("click",this._onClickFullscreen),t.window.document.addEventListener(this._fullscreenchange,this._changeIcon)},Zo.prototype._updateTitle=function(){var t=this._getTitle();this._fullscreenButton.setAttribute("aria-label",t),this._fullscreenButton.title=t},Zo.prototype._getTitle=function(){return this._map._getUIString(this._isFullscreen()?"FullscreenControl.Exit":"FullscreenControl.Enter")},Zo.prototype._isFullscreen=function(){return this._fullscreen},Zo.prototype._changeIcon=function(){(t.window.document.fullscreenElement||t.window.document.mozFullScreenElement||t.window.document.webkitFullscreenElement||t.window.document.msFullscreenElement)===this._container!==this._fullscreen&&(this._fullscreen=!this._fullscreen,this._fullscreenButton.classList.toggle("mapboxgl-ctrl-shrink"),this._fullscreenButton.classList.toggle("mapboxgl-ctrl-fullscreen"),this._updateTitle())},Zo.prototype._onClickFullscreen=function(){this._isFullscreen()?t.window.document.exitFullscreen?t.window.document.exitFullscreen():t.window.document.mozCancelFullScreen?t.window.document.mozCancelFullScreen():t.window.document.msExitFullscreen?t.window.document.msExitFullscreen():t.window.document.webkitCancelFullScreen&&t.window.document.webkitCancelFullScreen():this._container.requestFullscreen?this._container.requestFullscreen():this._container.mozRequestFullScreen?this._container.mozRequestFullScreen():this._container.msRequestFullscreen?this._container.msRequestFullscreen():this._container.webkitRequestFullscreen&&this._container.webkitRequestFullscreen()};var Ho={closeButton:!0,closeOnClick:!0,className:"",maxWidth:"240px"},Ko=function(e){function r(i){e.call(this),this.options=t.extend(Object.create(Ho),i),t.bindAll(["_update","_onClose","remove","_onMouseMove","_onMouseUp","_onDrag"],this)}return e&&(r.__proto__=e),(r.prototype=Object.create(e&&e.prototype)).constructor=r,r.prototype.addTo=function(e){return this._map&&this.remove(),this._map=e,this.options.closeOnClick&&this._map.on("click",this._onClose),this.options.closeOnMove&&this._map.on("move",this._onClose),this._map.on("remove",this.remove),this._update(),this._trackPointer?(this._map.on("mousemove",this._onMouseMove),this._map.on("mouseup",this._onMouseUp),this._container&&this._container.classList.add("mapboxgl-popup-track-pointer"),this._map._canvasContainer.classList.add("mapboxgl-track-pointer")):this._map.on("move",this._update),this.fire(new t.Event("open")),this},r.prototype.isOpen=function(){return!!this._map},r.prototype.remove=function(){return this._content&&i.remove(this._content),this._container&&(i.remove(this._container),delete this._container),this._map&&(this._map.off("move",this._update),this._map.off("move",this._onClose),this._map.off("click",this._onClose),this._map.off("remove",this.remove),this._map.off("mousemove",this._onMouseMove),this._map.off("mouseup",this._onMouseUp),this._map.off("drag",this._onDrag),delete this._map),this.fire(new t.Event("close")),this},r.prototype.getLngLat=function(){return this._lngLat},r.prototype.setLngLat=function(e){return this._lngLat=t.LngLat.convert(e),this._pos=null,this._trackPointer=!1,this._update(),this._map&&(this._map.on("move",this._update),this._map.off("mousemove",this._onMouseMove),this._container&&this._container.classList.remove("mapboxgl-popup-track-pointer"),this._map._canvasContainer.classList.remove("mapboxgl-track-pointer")),this},r.prototype.trackPointer=function(){return this._trackPointer=!0,this._pos=null,this._update(),this._map&&(this._map.off("move",this._update),this._map.on("mousemove",this._onMouseMove),this._map.on("drag",this._onDrag),this._container&&this._container.classList.add("mapboxgl-popup-track-pointer"),this._map._canvasContainer.classList.add("mapboxgl-track-pointer")),this},r.prototype.getElement=function(){return this._container},r.prototype.setText=function(e){return this.setDOMContent(t.window.document.createTextNode(e))},r.prototype.setHTML=function(e){var i,r=t.window.document.createDocumentFragment(),o=t.window.document.createElement("body");for(o.innerHTML=e;i=o.firstChild;)r.appendChild(i);return this.setDOMContent(r)},r.prototype.getMaxWidth=function(){return this._container&&this._container.style.maxWidth},r.prototype.setMaxWidth=function(t){return this.options.maxWidth=t,this._update(),this},r.prototype.setDOMContent=function(t){return this._createContent(),this._content.appendChild(t),this._update(),this},r.prototype.addClassName=function(t){this._container&&this._container.classList.add(t)},r.prototype.removeClassName=function(t){this._container&&this._container.classList.remove(t)},r.prototype.toggleClassName=function(t){if(this._container)return this._container.classList.toggle(t)},r.prototype._createContent=function(){this._content&&i.remove(this._content),this._content=i.create("div","mapboxgl-popup-content",this._container),this.options.closeButton&&(this._closeButton=i.create("button","mapboxgl-popup-close-button",this._content),this._closeButton.type="button",this._closeButton.setAttribute("aria-label","Close popup"),this._closeButton.innerHTML="&#215;",this._closeButton.addEventListener("click",this._onClose))},r.prototype._onMouseUp=function(t){this._update(t.point)},r.prototype._onMouseMove=function(t){this._update(t.point)},r.prototype._onDrag=function(t){this._update(t.point)},r.prototype._update=function(e){var r=this;if(this._map&&(this._lngLat||this._trackPointer)&&this._content&&(this._container||(this._container=i.create("div","mapboxgl-popup",this._map.getContainer()),this._tip=i.create("div","mapboxgl-popup-tip",this._container),this._container.appendChild(this._content),this.options.className&&this.options.className.split(" ").forEach((function(t){return r._container.classList.add(t)})),this._trackPointer&&this._container.classList.add("mapboxgl-popup-track-pointer")),this.options.maxWidth&&this._container.style.maxWidth!==this.options.maxWidth&&(this._container.style.maxWidth=this.options.maxWidth),this._map.transform.renderWorldCopies&&!this._trackPointer&&(this._lngLat=Mo(this._lngLat,this._pos,this._map.transform)),!this._trackPointer||e)){var o=this._pos=this._trackPointer&&e?e:this._map.project(this._lngLat),a=this.options.anchor,n=function e(i){if(i){if("number"==typeof i){var r=Math.round(Math.sqrt(.5*Math.pow(i,2)));return{center:new t.Point(0,0),top:new t.Point(0,i),"top-left":new t.Point(r,r),"top-right":new t.Point(-r,r),bottom:new t.Point(0,-i),"bottom-left":new t.Point(r,-r),"bottom-right":new t.Point(-r,-r),left:new t.Point(i,0),right:new t.Point(-i,0)}}if(i instanceof t.Point||Array.isArray(i)){var o=t.Point.convert(i);return{center:o,top:o,"top-left":o,"top-right":o,bottom:o,"bottom-left":o,"bottom-right":o,left:o,right:o}}return{center:t.Point.convert(i.center||[0,0]),top:t.Point.convert(i.top||[0,0]),"top-left":t.Point.convert(i["top-left"]||[0,0]),"top-right":t.Point.convert(i["top-right"]||[0,0]),bottom:t.Point.convert(i.bottom||[0,0]),"bottom-left":t.Point.convert(i["bottom-left"]||[0,0]),"bottom-right":t.Point.convert(i["bottom-right"]||[0,0]),left:t.Point.convert(i.left||[0,0]),right:t.Point.convert(i.right||[0,0])}}return e(new t.Point(0,0))}(this.options.offset);if(!a){var s,l=this._container.offsetWidth,c=this._container.offsetHeight;s=o.y+n.bottom.y<c?["top"]:o.y>this._map.transform.height-c?["bottom"]:[],o.x<l/2?s.push("left"):o.x>this._map.transform.width-l/2&&s.push("right"),a=0===s.length?"bottom":s.join("-")}var u=o.add(n[a]).round();i.setTransform(this._container,Lo[a]+" translate("+u.x+"px,"+u.y+"px)"),Ro(this._container,a,"popup")}},r.prototype._onClose=function(){this.remove()},r}(t.Evented),Wo={version:t.version,supported:e,setRTLTextPlugin:t.setRTLTextPlugin,getRTLTextPluginStatus:t.getRTLTextPluginStatus,Map:Io,NavigationControl:Po,GeolocateControl:No,AttributionControl:xo,ScaleControl:Vo,FullscreenControl:Zo,Popup:Ko,Marker:Oo,Style:qe,LngLat:t.LngLat,LngLatBounds:t.LngLatBounds,Point:t.Point,MercatorCoordinate:t.MercatorCoordinate,Evented:t.Evented,config:t.config,prewarm:function(){Ft().acquire(Rt)},clearPrewarmedResources:function(){var t=Ot;t&&(t.isPreloaded()&&1===t.numActive()?(t.release(Rt),Ot=null):console.warn("Could not clear WebWorkers since there are active Map instances that still reference it. The pre-warmed WebWorker pool can only be cleared when all map instances have been removed with map.remove()"))},get accessToken(){return t.config.ACCESS_TOKEN},set accessToken(e){t.config.ACCESS_TOKEN=e},get baseApiUrl(){return t.config.API_URL},set baseApiUrl(e){t.config.API_URL=e},get workerCount(){return Dt.workerCount},set workerCount(t){Dt.workerCount=t},get maxParallelImageRequests(){return t.config.MAX_PARALLEL_IMAGE_REQUESTS},set maxParallelImageRequests(e){t.config.MAX_PARALLEL_IMAGE_REQUESTS=e},clearStorage:function(e){t.clearTileCache(e)},workerUrl:""};return Wo})),r}()},365:function(t,e,r){var content=r(466);"string"==typeof content&&(content=[[t.i,content,""]]),content.locals&&(t.exports=content.locals);(0,r(8).default)("2b0a6097",content,!0,{sourceMap:!1})},366:function(t,e,r){var content=r(468);"string"==typeof content&&(content=[[t.i,content,""]]),content.locals&&(t.exports=content.locals);(0,r(8).default)("aed5bec2",content,!0,{sourceMap:!1})},367:function(t,e,r){var content=r(470);"string"==typeof content&&(content=[[t.i,content,""]]),content.locals&&(t.exports=content.locals);(0,r(8).default)("2740145a",content,!0,{sourceMap:!1})},368:function(t,e,r){var content=r(472);"string"==typeof content&&(content=[[t.i,content,""]]),content.locals&&(t.exports=content.locals);(0,r(8).default)("22f684de",content,!0,{sourceMap:!1})},369:function(t,e,r){var content=r(474);"string"==typeof content&&(content=[[t.i,content,""]]),content.locals&&(t.exports=content.locals);(0,r(8).default)("3f229f48",content,!0,{sourceMap:!1})},413:function(t,e,r){var content=r(528);"string"==typeof content&&(content=[[t.i,content,""]]),content.locals&&(t.exports=content.locals);(0,r(8).default)("37509250",content,!0,{sourceMap:!1})},417:function(t,e,r){var content=r(648);"string"==typeof content&&(content=[[t.i,content,""]]),content.locals&&(t.exports=content.locals);(0,r(8).default)("d7c7d64c",content,!0,{sourceMap:!1})},418:function(t,e,r){var content=r(650);"string"==typeof content&&(content=[[t.i,content,""]]),content.locals&&(t.exports=content.locals);(0,r(8).default)("3d7d4c46",content,!0,{sourceMap:!1})},428:function(t,e,r){"use strict";r.d(e,"c",(function(){return l})),r.d(e,"b",(function(){return c})),r.d(e,"a",(function(){return h})),r.d(e,"d",(function(){return d})),r.d(e,"e",(function(){return f}));var o=r(476),n=r(43);const l=(t="")=>{let e=n.defaultMaxLength;const r=Object(o.a)(t);r&&(e=r.maxLength);const l=t.replace(/\D/g,""),c=l.match(new RegExp("\\d{4,".concat(e,"}"),"g")),h=c&&c[0]||"",d=[];for(let t=0;t<h.length;t+=4)d.push(h.substring(t,t+4));return d.length?d.map(t=>4===t.length?t+" ":t).join(""):l},c=(t="")=>{const e=t.replace(/\D/gi,"").substring(0,4),r=e.slice(0,2),o=e.slice(2,4);let n=e;return n.length>=2&&(n=r+"/"+o),n},h=(t="")=>t.replace(/\D/gi,"").substring(0,n.cvcMaxLength),d=t=>l(t).trim().replace(/[^\s\\](?=.{4,}$)/g,"*"),f=t=>t.match(new RegExp(".{4}","g")).map((t,e)=>e<3?"**** ":t).join("")},433:function(t,e,r){"use strict";r(473);var o=r(5),component=Object(o.a)({},(function(t,e){e._c;return e._m(0)}),[function(t,e){var r=e._c;return r("span",{staticClass:"inline-loader"},[r("div",{staticClass:"pulse pulse-1"}),e._v(" "),r("div",{staticClass:"pulse pulse-2"}),e._v(" "),r("div",{staticClass:"pulse pulse-3"})])}],!0,null,"17c76915",null);e.a=component.exports},465:function(t,e,r){"use strict";var o=r(365);r.n(o).a},466:function(t,e,r){(e=r(7)(!1)).push([t.i,".container[data-v-166559dd],.wrapper[data-v-166559dd]{width:100%;height:100%}",""]),t.exports=e},467:function(t,e,r){"use strict";var o=r(366);r.n(o).a},468:function(t,e,r){(e=r(7)(!1)).push([t.i,".mapboxgl-map{font:12px/20px Helvetica Neue,Arial,Helvetica,sans-serif;overflow:hidden;position:relative;-webkit-tap-highlight-color:rgba(0,0,0,0)}.mapboxgl-canvas{position:absolute;left:0;top:0}.mapboxgl-map:-webkit-full-screen{width:100%;height:100%}.mapboxgl-canary{background-color:salmon}.mapboxgl-canvas-container.mapboxgl-interactive,.mapboxgl-ctrl-group button.mapboxgl-ctrl-compass{cursor:-webkit-grab;cursor:grab;-moz-user-select:none;-webkit-user-select:none;-ms-user-select:none;user-select:none}.mapboxgl-canvas-container.mapboxgl-interactive.mapboxgl-track-pointer{cursor:pointer}.mapboxgl-canvas-container.mapboxgl-interactive:active,.mapboxgl-ctrl-group button.mapboxgl-ctrl-compass:active{cursor:-webkit-grabbing;cursor:grabbing}.mapboxgl-canvas-container.mapboxgl-touch-zoom-rotate,.mapboxgl-canvas-container.mapboxgl-touch-zoom-rotate .mapboxgl-canvas{touch-action:pan-x pan-y}.mapboxgl-canvas-container.mapboxgl-touch-drag-pan,.mapboxgl-canvas-container.mapboxgl-touch-drag-pan .mapboxgl-canvas{touch-action:pinch-zoom}.mapboxgl-canvas-container.mapboxgl-touch-zoom-rotate.mapboxgl-touch-drag-pan,.mapboxgl-canvas-container.mapboxgl-touch-zoom-rotate.mapboxgl-touch-drag-pan .mapboxgl-canvas{touch-action:none}.mapboxgl-ctrl-bottom-left,.mapboxgl-ctrl-bottom-right,.mapboxgl-ctrl-top-left,.mapboxgl-ctrl-top-right{position:absolute;pointer-events:none;z-index:2}.mapboxgl-ctrl-top-left{top:0;left:0}.mapboxgl-ctrl-top-right{top:0;right:0}.mapboxgl-ctrl-bottom-left{bottom:0;left:0}.mapboxgl-ctrl-bottom-right{right:0;bottom:0}.mapboxgl-ctrl{clear:both;pointer-events:auto;transform:translate(0)}.mapboxgl-ctrl-top-left .mapboxgl-ctrl{margin:10px 0 0 10px;float:left}.mapboxgl-ctrl-top-right .mapboxgl-ctrl{margin:10px 10px 0 0;float:right}.mapboxgl-ctrl-bottom-left .mapboxgl-ctrl{margin:0 0 10px 10px;float:left}.mapboxgl-ctrl-bottom-right .mapboxgl-ctrl{margin:0 10px 10px 0;float:right}.mapboxgl-ctrl-group{border-radius:4px;background:#fff}.mapboxgl-ctrl-group:not(:empty){box-shadow:0 0 0 2px rgba(0,0,0,.1)}@media (-ms-high-contrast:active){.mapboxgl-ctrl-group:not(:empty){box-shadow:0 0 0 2px ButtonText}}.mapboxgl-ctrl-group button{width:29px;height:29px;display:block;padding:0;outline:none;border:0;box-sizing:border-box;background-color:transparent;cursor:pointer}.mapboxgl-ctrl-group button+button{border-top:1px solid #ddd}.mapboxgl-ctrl button .mapboxgl-ctrl-icon{display:block;width:100%;height:100%;background-repeat:no-repeat;background-position:50%}@media (-ms-high-contrast:active){.mapboxgl-ctrl-icon{background-color:transparent}.mapboxgl-ctrl-group button+button{border-top:1px solid ButtonText}}.mapboxgl-ctrl button::-moz-focus-inner{border:0;padding:0}.mapboxgl-ctrl-group button:focus{box-shadow:0 0 2px 2px #0096ff}.mapboxgl-ctrl button:disabled{cursor:not-allowed}.mapboxgl-ctrl button:disabled .mapboxgl-ctrl-icon{opacity:.25}.mapboxgl-ctrl button:not(:disabled):hover{background-color:rgba(0,0,0,.05)}.mapboxgl-ctrl-group button:focus.focus-visible,.mapboxgl-ctrl-group button:focus:focus-visible{box-shadow:0 0 2px 2px #0096ff}.mapboxgl-ctrl-group button:focus:not(.focus-visible),.mapboxgl-ctrl-group button:focus:not(:focus-visible){box-shadow:none}.mapboxgl-ctrl-group button:focus:first-child{border-radius:4px 4px 0 0}.mapboxgl-ctrl-group button:focus:last-child{border-radius:0 0 4px 4px}.mapboxgl-ctrl-group button:focus:only-child{border-radius:inherit}.mapboxgl-ctrl button.mapboxgl-ctrl-zoom-out .mapboxgl-ctrl-icon{background-image:url(\"data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' xmlns='http://www.w3.org/2000/svg' fill='%23333'%3E%3Cpath d='M10 13c-.75 0-1.5.75-1.5 1.5S9.25 16 10 16h9c.75 0 1.5-.75 1.5-1.5S19.75 13 19 13h-9z'/%3E%3C/svg%3E\")}.mapboxgl-ctrl button.mapboxgl-ctrl-zoom-in .mapboxgl-ctrl-icon{background-image:url(\"data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' xmlns='http://www.w3.org/2000/svg' fill='%23333'%3E%3Cpath d='M14.5 8.5c-.75 0-1.5.75-1.5 1.5v3h-3c-.75 0-1.5.75-1.5 1.5S9.25 16 10 16h3v3c0 .75.75 1.5 1.5 1.5S16 19.75 16 19v-3h3c.75 0 1.5-.75 1.5-1.5S19.75 13 19 13h-3v-3c0-.75-.75-1.5-1.5-1.5z'/%3E%3C/svg%3E\")}@media (-ms-high-contrast:active){.mapboxgl-ctrl button.mapboxgl-ctrl-zoom-out .mapboxgl-ctrl-icon{background-image:url(\"data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' xmlns='http://www.w3.org/2000/svg' fill='%23fff'%3E%3Cpath d='M10 13c-.75 0-1.5.75-1.5 1.5S9.25 16 10 16h9c.75 0 1.5-.75 1.5-1.5S19.75 13 19 13h-9z'/%3E%3C/svg%3E\")}.mapboxgl-ctrl button.mapboxgl-ctrl-zoom-in .mapboxgl-ctrl-icon{background-image:url(\"data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' xmlns='http://www.w3.org/2000/svg' fill='%23fff'%3E%3Cpath d='M14.5 8.5c-.75 0-1.5.75-1.5 1.5v3h-3c-.75 0-1.5.75-1.5 1.5S9.25 16 10 16h3v3c0 .75.75 1.5 1.5 1.5S16 19.75 16 19v-3h3c.75 0 1.5-.75 1.5-1.5S19.75 13 19 13h-3v-3c0-.75-.75-1.5-1.5-1.5z'/%3E%3C/svg%3E\")}}@media (-ms-high-contrast:black-on-white){.mapboxgl-ctrl button.mapboxgl-ctrl-zoom-out .mapboxgl-ctrl-icon{background-image:url(\"data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' xmlns='http://www.w3.org/2000/svg'%3E%3Cpath d='M10 13c-.75 0-1.5.75-1.5 1.5S9.25 16 10 16h9c.75 0 1.5-.75 1.5-1.5S19.75 13 19 13h-9z'/%3E%3C/svg%3E\")}.mapboxgl-ctrl button.mapboxgl-ctrl-zoom-in .mapboxgl-ctrl-icon{background-image:url(\"data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' xmlns='http://www.w3.org/2000/svg'%3E%3Cpath d='M14.5 8.5c-.75 0-1.5.75-1.5 1.5v3h-3c-.75 0-1.5.75-1.5 1.5S9.25 16 10 16h3v3c0 .75.75 1.5 1.5 1.5S16 19.75 16 19v-3h3c.75 0 1.5-.75 1.5-1.5S19.75 13 19 13h-3v-3c0-.75-.75-1.5-1.5-1.5z'/%3E%3C/svg%3E\")}}.mapboxgl-ctrl button.mapboxgl-ctrl-fullscreen .mapboxgl-ctrl-icon{background-image:url(\"data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' xmlns='http://www.w3.org/2000/svg' fill='%23333'%3E%3Cpath d='M24 16v5.5c0 1.75-.75 2.5-2.5 2.5H16v-1l3-1.5-4-5.5 1-1 5.5 4 1.5-3h1zM6 16l1.5 3 5.5-4 1 1-4 5.5 3 1.5v1H7.5C5.75 24 5 23.25 5 21.5V16h1zm7-11v1l-3 1.5 4 5.5-1 1-5.5-4L6 13H5V7.5C5 5.75 5.75 5 7.5 5H13zm11 2.5c0-1.75-.75-2.5-2.5-2.5H16v1l3 1.5-4 5.5 1 1 5.5-4 1.5 3h1V7.5z'/%3E%3C/svg%3E\")}.mapboxgl-ctrl button.mapboxgl-ctrl-shrink .mapboxgl-ctrl-icon{background-image:url(\"data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' xmlns='http://www.w3.org/2000/svg'%3E%3Cpath d='M18.5 16c-1.75 0-2.5.75-2.5 2.5V24h1l1.5-3 5.5 4 1-1-4-5.5 3-1.5v-1h-5.5zM13 18.5c0-1.75-.75-2.5-2.5-2.5H5v1l3 1.5L4 24l1 1 5.5-4 1.5 3h1v-5.5zm3-8c0 1.75.75 2.5 2.5 2.5H24v-1l-3-1.5L25 5l-1-1-5.5 4L17 5h-1v5.5zM10.5 13c1.75 0 2.5-.75 2.5-2.5V5h-1l-1.5 3L5 4 4 5l4 5.5L5 12v1h5.5z'/%3E%3C/svg%3E\")}@media (-ms-high-contrast:active){.mapboxgl-ctrl button.mapboxgl-ctrl-fullscreen .mapboxgl-ctrl-icon{background-image:url(\"data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' xmlns='http://www.w3.org/2000/svg' fill='%23fff'%3E%3Cpath d='M24 16v5.5c0 1.75-.75 2.5-2.5 2.5H16v-1l3-1.5-4-5.5 1-1 5.5 4 1.5-3h1zM6 16l1.5 3 5.5-4 1 1-4 5.5 3 1.5v1H7.5C5.75 24 5 23.25 5 21.5V16h1zm7-11v1l-3 1.5 4 5.5-1 1-5.5-4L6 13H5V7.5C5 5.75 5.75 5 7.5 5H13zm11 2.5c0-1.75-.75-2.5-2.5-2.5H16v1l3 1.5-4 5.5 1 1 5.5-4 1.5 3h1V7.5z'/%3E%3C/svg%3E\")}.mapboxgl-ctrl button.mapboxgl-ctrl-shrink .mapboxgl-ctrl-icon{background-image:url(\"data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' xmlns='http://www.w3.org/2000/svg' fill='%23fff'%3E%3Cpath d='M18.5 16c-1.75 0-2.5.75-2.5 2.5V24h1l1.5-3 5.5 4 1-1-4-5.5 3-1.5v-1h-5.5zM13 18.5c0-1.75-.75-2.5-2.5-2.5H5v1l3 1.5L4 24l1 1 5.5-4 1.5 3h1v-5.5zm3-8c0 1.75.75 2.5 2.5 2.5H24v-1l-3-1.5L25 5l-1-1-5.5 4L17 5h-1v5.5zM10.5 13c1.75 0 2.5-.75 2.5-2.5V5h-1l-1.5 3L5 4 4 5l4 5.5L5 12v1h5.5z'/%3E%3C/svg%3E\")}}@media (-ms-high-contrast:black-on-white){.mapboxgl-ctrl button.mapboxgl-ctrl-fullscreen .mapboxgl-ctrl-icon{background-image:url(\"data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' xmlns='http://www.w3.org/2000/svg'%3E%3Cpath d='M24 16v5.5c0 1.75-.75 2.5-2.5 2.5H16v-1l3-1.5-4-5.5 1-1 5.5 4 1.5-3h1zM6 16l1.5 3 5.5-4 1 1-4 5.5 3 1.5v1H7.5C5.75 24 5 23.25 5 21.5V16h1zm7-11v1l-3 1.5 4 5.5-1 1-5.5-4L6 13H5V7.5C5 5.75 5.75 5 7.5 5H13zm11 2.5c0-1.75-.75-2.5-2.5-2.5H16v1l3 1.5-4 5.5 1 1 5.5-4 1.5 3h1V7.5z'/%3E%3C/svg%3E\")}.mapboxgl-ctrl button.mapboxgl-ctrl-shrink .mapboxgl-ctrl-icon{background-image:url(\"data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' xmlns='http://www.w3.org/2000/svg'%3E%3Cpath d='M18.5 16c-1.75 0-2.5.75-2.5 2.5V24h1l1.5-3 5.5 4 1-1-4-5.5 3-1.5v-1h-5.5zM13 18.5c0-1.75-.75-2.5-2.5-2.5H5v1l3 1.5L4 24l1 1 5.5-4 1.5 3h1v-5.5zm3-8c0 1.75.75 2.5 2.5 2.5H24v-1l-3-1.5L25 5l-1-1-5.5 4L17 5h-1v5.5zM10.5 13c1.75 0 2.5-.75 2.5-2.5V5h-1l-1.5 3L5 4 4 5l4 5.5L5 12v1h5.5z'/%3E%3C/svg%3E\")}}.mapboxgl-ctrl button.mapboxgl-ctrl-compass .mapboxgl-ctrl-icon{background-image:url(\"data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' xmlns='http://www.w3.org/2000/svg' fill='%23333'%3E%3Cpath d='M10.5 14l4-8 4 8h-8z'/%3E%3Cpath d='M10.5 16l4 8 4-8h-8z' fill='%23ccc'/%3E%3C/svg%3E\")}@media (-ms-high-contrast:active){.mapboxgl-ctrl button.mapboxgl-ctrl-compass .mapboxgl-ctrl-icon{background-image:url(\"data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' xmlns='http://www.w3.org/2000/svg' fill='%23fff'%3E%3Cpath d='M10.5 14l4-8 4 8h-8z'/%3E%3Cpath d='M10.5 16l4 8 4-8h-8z' fill='%23999'/%3E%3C/svg%3E\")}}@media (-ms-high-contrast:black-on-white){.mapboxgl-ctrl button.mapboxgl-ctrl-compass .mapboxgl-ctrl-icon{background-image:url(\"data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' xmlns='http://www.w3.org/2000/svg'%3E%3Cpath d='M10.5 14l4-8 4 8h-8z'/%3E%3Cpath d='M10.5 16l4 8 4-8h-8z' fill='%23ccc'/%3E%3C/svg%3E\")}}.mapboxgl-ctrl button.mapboxgl-ctrl-geolocate .mapboxgl-ctrl-icon{background-image:url(\"data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 20 20' xmlns='http://www.w3.org/2000/svg' fill='%23333'%3E%3Cpath d='M10 4C9 4 9 5 9 5v.1A5 5 0 005.1 9H5s-1 0-1 1 1 1 1 1h.1A5 5 0 009 14.9v.1s0 1 1 1 1-1 1-1v-.1a5 5 0 003.9-3.9h.1s1 0 1-1-1-1-1-1h-.1A5 5 0 0011 5.1V5s0-1-1-1zm0 2.5a3.5 3.5 0 110 7 3.5 3.5 0 110-7z'/%3E%3Ccircle cx='10' cy='10' r='2'/%3E%3C/svg%3E\")}.mapboxgl-ctrl button.mapboxgl-ctrl-geolocate:disabled .mapboxgl-ctrl-icon{background-image:url(\"data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 20 20' xmlns='http://www.w3.org/2000/svg' fill='%23aaa'%3E%3Cpath d='M10 4C9 4 9 5 9 5v.1A5 5 0 005.1 9H5s-1 0-1 1 1 1 1 1h.1A5 5 0 009 14.9v.1s0 1 1 1 1-1 1-1v-.1a5 5 0 003.9-3.9h.1s1 0 1-1-1-1-1-1h-.1A5 5 0 0011 5.1V5s0-1-1-1zm0 2.5a3.5 3.5 0 110 7 3.5 3.5 0 110-7z'/%3E%3Ccircle cx='10' cy='10' r='2'/%3E%3Cpath d='M14 5l1 1-9 9-1-1 9-9z' fill='red'/%3E%3C/svg%3E\")}.mapboxgl-ctrl button.mapboxgl-ctrl-geolocate.mapboxgl-ctrl-geolocate-active .mapboxgl-ctrl-icon{background-image:url(\"data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 20 20' xmlns='http://www.w3.org/2000/svg' fill='%2333b5e5'%3E%3Cpath d='M10 4C9 4 9 5 9 5v.1A5 5 0 005.1 9H5s-1 0-1 1 1 1 1 1h.1A5 5 0 009 14.9v.1s0 1 1 1 1-1 1-1v-.1a5 5 0 003.9-3.9h.1s1 0 1-1-1-1-1-1h-.1A5 5 0 0011 5.1V5s0-1-1-1zm0 2.5a3.5 3.5 0 110 7 3.5 3.5 0 110-7z'/%3E%3Ccircle cx='10' cy='10' r='2'/%3E%3C/svg%3E\")}.mapboxgl-ctrl button.mapboxgl-ctrl-geolocate.mapboxgl-ctrl-geolocate-active-error .mapboxgl-ctrl-icon{background-image:url(\"data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 20 20' xmlns='http://www.w3.org/2000/svg' fill='%23e58978'%3E%3Cpath d='M10 4C9 4 9 5 9 5v.1A5 5 0 005.1 9H5s-1 0-1 1 1 1 1 1h.1A5 5 0 009 14.9v.1s0 1 1 1 1-1 1-1v-.1a5 5 0 003.9-3.9h.1s1 0 1-1-1-1-1-1h-.1A5 5 0 0011 5.1V5s0-1-1-1zm0 2.5a3.5 3.5 0 110 7 3.5 3.5 0 110-7z'/%3E%3Ccircle cx='10' cy='10' r='2'/%3E%3C/svg%3E\")}.mapboxgl-ctrl button.mapboxgl-ctrl-geolocate.mapboxgl-ctrl-geolocate-background .mapboxgl-ctrl-icon{background-image:url(\"data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 20 20' xmlns='http://www.w3.org/2000/svg' fill='%2333b5e5'%3E%3Cpath d='M10 4C9 4 9 5 9 5v.1A5 5 0 005.1 9H5s-1 0-1 1 1 1 1 1h.1A5 5 0 009 14.9v.1s0 1 1 1 1-1 1-1v-.1a5 5 0 003.9-3.9h.1s1 0 1-1-1-1-1-1h-.1A5 5 0 0011 5.1V5s0-1-1-1zm0 2.5a3.5 3.5 0 110 7 3.5 3.5 0 110-7z'/%3E%3C/svg%3E\")}.mapboxgl-ctrl button.mapboxgl-ctrl-geolocate.mapboxgl-ctrl-geolocate-background-error .mapboxgl-ctrl-icon{background-image:url(\"data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 20 20' xmlns='http://www.w3.org/2000/svg' fill='%23e54e33'%3E%3Cpath d='M10 4C9 4 9 5 9 5v.1A5 5 0 005.1 9H5s-1 0-1 1 1 1 1 1h.1A5 5 0 009 14.9v.1s0 1 1 1 1-1 1-1v-.1a5 5 0 003.9-3.9h.1s1 0 1-1-1-1-1-1h-.1A5 5 0 0011 5.1V5s0-1-1-1zm0 2.5a3.5 3.5 0 110 7 3.5 3.5 0 110-7z'/%3E%3C/svg%3E\")}.mapboxgl-ctrl button.mapboxgl-ctrl-geolocate.mapboxgl-ctrl-geolocate-waiting .mapboxgl-ctrl-icon{-webkit-animation:mapboxgl-spin 2s linear infinite;animation:mapboxgl-spin 2s linear infinite}@media (-ms-high-contrast:active){.mapboxgl-ctrl button.mapboxgl-ctrl-geolocate .mapboxgl-ctrl-icon{background-image:url(\"data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 20 20' xmlns='http://www.w3.org/2000/svg' fill='%23fff'%3E%3Cpath d='M10 4C9 4 9 5 9 5v.1A5 5 0 005.1 9H5s-1 0-1 1 1 1 1 1h.1A5 5 0 009 14.9v.1s0 1 1 1 1-1 1-1v-.1a5 5 0 003.9-3.9h.1s1 0 1-1-1-1-1-1h-.1A5 5 0 0011 5.1V5s0-1-1-1zm0 2.5a3.5 3.5 0 110 7 3.5 3.5 0 110-7z'/%3E%3Ccircle cx='10' cy='10' r='2'/%3E%3C/svg%3E\")}.mapboxgl-ctrl button.mapboxgl-ctrl-geolocate:disabled .mapboxgl-ctrl-icon{background-image:url(\"data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 20 20' xmlns='http://www.w3.org/2000/svg' fill='%23999'%3E%3Cpath d='M10 4C9 4 9 5 9 5v.1A5 5 0 005.1 9H5s-1 0-1 1 1 1 1 1h.1A5 5 0 009 14.9v.1s0 1 1 1 1-1 1-1v-.1a5 5 0 003.9-3.9h.1s1 0 1-1-1-1-1-1h-.1A5 5 0 0011 5.1V5s0-1-1-1zm0 2.5a3.5 3.5 0 110 7 3.5 3.5 0 110-7z'/%3E%3Ccircle cx='10' cy='10' r='2'/%3E%3Cpath d='M14 5l1 1-9 9-1-1 9-9z' fill='red'/%3E%3C/svg%3E\")}.mapboxgl-ctrl button.mapboxgl-ctrl-geolocate.mapboxgl-ctrl-geolocate-active .mapboxgl-ctrl-icon{background-image:url(\"data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 20 20' xmlns='http://www.w3.org/2000/svg' fill='%2333b5e5'%3E%3Cpath d='M10 4C9 4 9 5 9 5v.1A5 5 0 005.1 9H5s-1 0-1 1 1 1 1 1h.1A5 5 0 009 14.9v.1s0 1 1 1 1-1 1-1v-.1a5 5 0 003.9-3.9h.1s1 0 1-1-1-1-1-1h-.1A5 5 0 0011 5.1V5s0-1-1-1zm0 2.5a3.5 3.5 0 110 7 3.5 3.5 0 110-7z'/%3E%3Ccircle cx='10' cy='10' r='2'/%3E%3C/svg%3E\")}.mapboxgl-ctrl button.mapboxgl-ctrl-geolocate.mapboxgl-ctrl-geolocate-active-error .mapboxgl-ctrl-icon{background-image:url(\"data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 20 20' xmlns='http://www.w3.org/2000/svg' fill='%23e58978'%3E%3Cpath d='M10 4C9 4 9 5 9 5v.1A5 5 0 005.1 9H5s-1 0-1 1 1 1 1 1h.1A5 5 0 009 14.9v.1s0 1 1 1 1-1 1-1v-.1a5 5 0 003.9-3.9h.1s1 0 1-1-1-1-1-1h-.1A5 5 0 0011 5.1V5s0-1-1-1zm0 2.5a3.5 3.5 0 110 7 3.5 3.5 0 110-7z'/%3E%3Ccircle cx='10' cy='10' r='2'/%3E%3C/svg%3E\")}.mapboxgl-ctrl button.mapboxgl-ctrl-geolocate.mapboxgl-ctrl-geolocate-background .mapboxgl-ctrl-icon{background-image:url(\"data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 20 20' xmlns='http://www.w3.org/2000/svg' fill='%2333b5e5'%3E%3Cpath d='M10 4C9 4 9 5 9 5v.1A5 5 0 005.1 9H5s-1 0-1 1 1 1 1 1h.1A5 5 0 009 14.9v.1s0 1 1 1 1-1 1-1v-.1a5 5 0 003.9-3.9h.1s1 0 1-1-1-1-1-1h-.1A5 5 0 0011 5.1V5s0-1-1-1zm0 2.5a3.5 3.5 0 110 7 3.5 3.5 0 110-7z'/%3E%3C/svg%3E\")}.mapboxgl-ctrl button.mapboxgl-ctrl-geolocate.mapboxgl-ctrl-geolocate-background-error .mapboxgl-ctrl-icon{background-image:url(\"data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 20 20' xmlns='http://www.w3.org/2000/svg' fill='%23e54e33'%3E%3Cpath d='M10 4C9 4 9 5 9 5v.1A5 5 0 005.1 9H5s-1 0-1 1 1 1 1 1h.1A5 5 0 009 14.9v.1s0 1 1 1 1-1 1-1v-.1a5 5 0 003.9-3.9h.1s1 0 1-1-1-1-1-1h-.1A5 5 0 0011 5.1V5s0-1-1-1zm0 2.5a3.5 3.5 0 110 7 3.5 3.5 0 110-7z'/%3E%3C/svg%3E\")}}@media (-ms-high-contrast:black-on-white){.mapboxgl-ctrl button.mapboxgl-ctrl-geolocate .mapboxgl-ctrl-icon{background-image:url(\"data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 20 20' xmlns='http://www.w3.org/2000/svg'%3E%3Cpath d='M10 4C9 4 9 5 9 5v.1A5 5 0 005.1 9H5s-1 0-1 1 1 1 1 1h.1A5 5 0 009 14.9v.1s0 1 1 1 1-1 1-1v-.1a5 5 0 003.9-3.9h.1s1 0 1-1-1-1-1-1h-.1A5 5 0 0011 5.1V5s0-1-1-1zm0 2.5a3.5 3.5 0 110 7 3.5 3.5 0 110-7z'/%3E%3Ccircle cx='10' cy='10' r='2'/%3E%3C/svg%3E\")}.mapboxgl-ctrl button.mapboxgl-ctrl-geolocate:disabled .mapboxgl-ctrl-icon{background-image:url(\"data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 20 20' xmlns='http://www.w3.org/2000/svg' fill='%23666'%3E%3Cpath d='M10 4C9 4 9 5 9 5v.1A5 5 0 005.1 9H5s-1 0-1 1 1 1 1 1h.1A5 5 0 009 14.9v.1s0 1 1 1 1-1 1-1v-.1a5 5 0 003.9-3.9h.1s1 0 1-1-1-1-1-1h-.1A5 5 0 0011 5.1V5s0-1-1-1zm0 2.5a3.5 3.5 0 110 7 3.5 3.5 0 110-7z'/%3E%3Ccircle cx='10' cy='10' r='2'/%3E%3Cpath d='M14 5l1 1-9 9-1-1 9-9z' fill='red'/%3E%3C/svg%3E\")}}@-webkit-keyframes mapboxgl-spin{0%{-webkit-transform:rotate(0deg)}to{-webkit-transform:rotate(1turn)}}@keyframes mapboxgl-spin{0%{transform:rotate(0deg)}to{transform:rotate(1turn)}}a.mapboxgl-ctrl-logo{width:88px;height:23px;margin:0 0 -4px -4px;display:block;background-repeat:no-repeat;cursor:pointer;overflow:hidden;background-image:url(\"data:image/svg+xml;charset=utf-8,%3Csvg width='88' height='23' xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink' fill-rule='evenodd'%3E%3Cdefs%3E%3Cpath id='a' d='M11.5 2.25c5.105 0 9.25 4.145 9.25 9.25s-4.145 9.25-9.25 9.25-9.25-4.145-9.25-9.25 4.145-9.25 9.25-9.25zM6.997 15.983c-.051-.338-.828-5.802 2.233-8.873a4.395 4.395 0 013.13-1.28c1.27 0 2.49.51 3.39 1.42.91.9 1.42 2.12 1.42 3.39 0 1.18-.449 2.301-1.28 3.13C12.72 16.93 7 16 7 16l-.003-.017zM15.3 10.5l-2 .8-.8 2-.8-2-2-.8 2-.8.8-2 .8 2 2 .8z'/%3E%3Cpath id='b' d='M50.63 8c.13 0 .23.1.23.23V9c.7-.76 1.7-1.18 2.73-1.18 2.17 0 3.95 1.85 3.95 4.17s-1.77 4.19-3.94 4.19c-1.04 0-2.03-.43-2.74-1.18v3.77c0 .13-.1.23-.23.23h-1.4c-.13 0-.23-.1-.23-.23V8.23c0-.12.1-.23.23-.23h1.4zm-3.86.01c.01 0 .01 0 .01-.01.13 0 .22.1.22.22v7.55c0 .12-.1.23-.23.23h-1.4c-.13 0-.23-.1-.23-.23V15c-.7.76-1.69 1.19-2.73 1.19-2.17 0-3.94-1.87-3.94-4.19 0-2.32 1.77-4.19 3.94-4.19 1.03 0 2.02.43 2.73 1.18v-.75c0-.12.1-.23.23-.23h1.4zm26.375-.19a4.24 4.24 0 00-4.16 3.29c-.13.59-.13 1.19 0 1.77a4.233 4.233 0 004.17 3.3c2.35 0 4.26-1.87 4.26-4.19 0-2.32-1.9-4.17-4.27-4.17zM60.63 5c.13 0 .23.1.23.23v3.76c.7-.76 1.7-1.18 2.73-1.18 1.88 0 3.45 1.4 3.84 3.28.13.59.13 1.2 0 1.8-.39 1.88-1.96 3.29-3.84 3.29-1.03 0-2.02-.43-2.73-1.18v.77c0 .12-.1.23-.23.23h-1.4c-.13 0-.23-.1-.23-.23V5.23c0-.12.1-.23.23-.23h1.4zm-34 11h-1.4c-.13 0-.23-.11-.23-.23V8.22c.01-.13.1-.22.23-.22h1.4c.13 0 .22.11.23.22v.68c.5-.68 1.3-1.09 2.16-1.1h.03c1.09 0 2.09.6 2.6 1.55.45-.95 1.4-1.55 2.44-1.56 1.62 0 2.93 1.25 2.9 2.78l.03 5.2c0 .13-.1.23-.23.23h-1.41c-.13 0-.23-.11-.23-.23v-4.59c0-.98-.74-1.71-1.62-1.71-.8 0-1.46.7-1.59 1.62l.01 4.68c0 .13-.11.23-.23.23h-1.41c-.13 0-.23-.11-.23-.23v-4.59c0-.98-.74-1.71-1.62-1.71-.85 0-1.54.79-1.6 1.8v4.5c0 .13-.1.23-.23.23zm53.615 0h-1.61c-.04 0-.08-.01-.12-.03-.09-.06-.13-.19-.06-.28l2.43-3.71-2.39-3.65a.213.213 0 01-.03-.12c0-.12.09-.21.21-.21h1.61c.13 0 .24.06.3.17l1.41 2.37 1.4-2.37a.34.34 0 01.3-.17h1.6c.04 0 .08.01.12.03.09.06.13.19.06.28l-2.37 3.65 2.43 3.7c0 .05.01.09.01.13 0 .12-.09.21-.21.21h-1.61c-.13 0-.24-.06-.3-.17l-1.44-2.42-1.44 2.42a.34.34 0 01-.3.17zm-7.12-1.49c-1.33 0-2.42-1.12-2.42-2.51 0-1.39 1.08-2.52 2.42-2.52 1.33 0 2.42 1.12 2.42 2.51 0 1.39-1.08 2.51-2.42 2.52zm-19.865 0c-1.32 0-2.39-1.11-2.42-2.48v-.07c.02-1.38 1.09-2.49 2.4-2.49 1.32 0 2.41 1.12 2.41 2.51 0 1.39-1.07 2.52-2.39 2.53zm-8.11-2.48c-.01 1.37-1.09 2.47-2.41 2.47s-2.42-1.12-2.42-2.51c0-1.39 1.08-2.52 2.4-2.52 1.33 0 2.39 1.11 2.41 2.48l.02.08zm18.12 2.47c-1.32 0-2.39-1.11-2.41-2.48v-.06c.02-1.38 1.09-2.48 2.41-2.48s2.42 1.12 2.42 2.51c0 1.39-1.09 2.51-2.42 2.51z'/%3E%3C/defs%3E%3Cmask id='c'%3E%3Crect width='100%25' height='100%25' fill='%23fff'/%3E%3Cuse xlink:href='%23a'/%3E%3Cuse xlink:href='%23b'/%3E%3C/mask%3E%3Cg opacity='.3' stroke='%23000' stroke-width='3'%3E%3Ccircle mask='url(%23c)' cx='11.5' cy='11.5' r='9.25'/%3E%3Cuse xlink:href='%23b' mask='url(%23c)'/%3E%3C/g%3E%3Cg opacity='.9' fill='%23fff'%3E%3Cuse xlink:href='%23a'/%3E%3Cuse xlink:href='%23b'/%3E%3C/g%3E%3C/svg%3E\")}a.mapboxgl-ctrl-logo.mapboxgl-compact{width:23px}@media (-ms-high-contrast:active){a.mapboxgl-ctrl-logo{background-color:transparent;background-image:url(\"data:image/svg+xml;charset=utf-8,%3Csvg width='88' height='23' xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink' fill-rule='evenodd'%3E%3Cdefs%3E%3Cpath id='a' d='M11.5 2.25c5.105 0 9.25 4.145 9.25 9.25s-4.145 9.25-9.25 9.25-9.25-4.145-9.25-9.25 4.145-9.25 9.25-9.25zM6.997 15.983c-.051-.338-.828-5.802 2.233-8.873a4.395 4.395 0 013.13-1.28c1.27 0 2.49.51 3.39 1.42.91.9 1.42 2.12 1.42 3.39 0 1.18-.449 2.301-1.28 3.13C12.72 16.93 7 16 7 16l-.003-.017zM15.3 10.5l-2 .8-.8 2-.8-2-2-.8 2-.8.8-2 .8 2 2 .8z'/%3E%3Cpath id='b' d='M50.63 8c.13 0 .23.1.23.23V9c.7-.76 1.7-1.18 2.73-1.18 2.17 0 3.95 1.85 3.95 4.17s-1.77 4.19-3.94 4.19c-1.04 0-2.03-.43-2.74-1.18v3.77c0 .13-.1.23-.23.23h-1.4c-.13 0-.23-.1-.23-.23V8.23c0-.12.1-.23.23-.23h1.4zm-3.86.01c.01 0 .01 0 .01-.01.13 0 .22.1.22.22v7.55c0 .12-.1.23-.23.23h-1.4c-.13 0-.23-.1-.23-.23V15c-.7.76-1.69 1.19-2.73 1.19-2.17 0-3.94-1.87-3.94-4.19 0-2.32 1.77-4.19 3.94-4.19 1.03 0 2.02.43 2.73 1.18v-.75c0-.12.1-.23.23-.23h1.4zm26.375-.19a4.24 4.24 0 00-4.16 3.29c-.13.59-.13 1.19 0 1.77a4.233 4.233 0 004.17 3.3c2.35 0 4.26-1.87 4.26-4.19 0-2.32-1.9-4.17-4.27-4.17zM60.63 5c.13 0 .23.1.23.23v3.76c.7-.76 1.7-1.18 2.73-1.18 1.88 0 3.45 1.4 3.84 3.28.13.59.13 1.2 0 1.8-.39 1.88-1.96 3.29-3.84 3.29-1.03 0-2.02-.43-2.73-1.18v.77c0 .12-.1.23-.23.23h-1.4c-.13 0-.23-.1-.23-.23V5.23c0-.12.1-.23.23-.23h1.4zm-34 11h-1.4c-.13 0-.23-.11-.23-.23V8.22c.01-.13.1-.22.23-.22h1.4c.13 0 .22.11.23.22v.68c.5-.68 1.3-1.09 2.16-1.1h.03c1.09 0 2.09.6 2.6 1.55.45-.95 1.4-1.55 2.44-1.56 1.62 0 2.93 1.25 2.9 2.78l.03 5.2c0 .13-.1.23-.23.23h-1.41c-.13 0-.23-.11-.23-.23v-4.59c0-.98-.74-1.71-1.62-1.71-.8 0-1.46.7-1.59 1.62l.01 4.68c0 .13-.11.23-.23.23h-1.41c-.13 0-.23-.11-.23-.23v-4.59c0-.98-.74-1.71-1.62-1.71-.85 0-1.54.79-1.6 1.8v4.5c0 .13-.1.23-.23.23zm53.615 0h-1.61c-.04 0-.08-.01-.12-.03-.09-.06-.13-.19-.06-.28l2.43-3.71-2.39-3.65a.213.213 0 01-.03-.12c0-.12.09-.21.21-.21h1.61c.13 0 .24.06.3.17l1.41 2.37 1.4-2.37a.34.34 0 01.3-.17h1.6c.04 0 .08.01.12.03.09.06.13.19.06.28l-2.37 3.65 2.43 3.7c0 .05.01.09.01.13 0 .12-.09.21-.21.21h-1.61c-.13 0-.24-.06-.3-.17l-1.44-2.42-1.44 2.42a.34.34 0 01-.3.17zm-7.12-1.49c-1.33 0-2.42-1.12-2.42-2.51 0-1.39 1.08-2.52 2.42-2.52 1.33 0 2.42 1.12 2.42 2.51 0 1.39-1.08 2.51-2.42 2.52zm-19.865 0c-1.32 0-2.39-1.11-2.42-2.48v-.07c.02-1.38 1.09-2.49 2.4-2.49 1.32 0 2.41 1.12 2.41 2.51 0 1.39-1.07 2.52-2.39 2.53zm-8.11-2.48c-.01 1.37-1.09 2.47-2.41 2.47s-2.42-1.12-2.42-2.51c0-1.39 1.08-2.52 2.4-2.52 1.33 0 2.39 1.11 2.41 2.48l.02.08zm18.12 2.47c-1.32 0-2.39-1.11-2.41-2.48v-.06c.02-1.38 1.09-2.48 2.41-2.48s2.42 1.12 2.42 2.51c0 1.39-1.09 2.51-2.42 2.51z'/%3E%3C/defs%3E%3Cmask id='c'%3E%3Crect width='100%25' height='100%25' fill='%23fff'/%3E%3Cuse xlink:href='%23a'/%3E%3Cuse xlink:href='%23b'/%3E%3C/mask%3E%3Cg stroke='%23000' stroke-width='3'%3E%3Ccircle mask='url(%23c)' cx='11.5' cy='11.5' r='9.25'/%3E%3Cuse xlink:href='%23b' mask='url(%23c)'/%3E%3C/g%3E%3Cg fill='%23fff'%3E%3Cuse xlink:href='%23a'/%3E%3Cuse xlink:href='%23b'/%3E%3C/g%3E%3C/svg%3E\")}}@media (-ms-high-contrast:black-on-white){a.mapboxgl-ctrl-logo{background-image:url(\"data:image/svg+xml;charset=utf-8,%3Csvg width='88' height='23' xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink' fill-rule='evenodd'%3E%3Cdefs%3E%3Cpath id='a' d='M11.5 2.25c5.105 0 9.25 4.145 9.25 9.25s-4.145 9.25-9.25 9.25-9.25-4.145-9.25-9.25 4.145-9.25 9.25-9.25zM6.997 15.983c-.051-.338-.828-5.802 2.233-8.873a4.395 4.395 0 013.13-1.28c1.27 0 2.49.51 3.39 1.42.91.9 1.42 2.12 1.42 3.39 0 1.18-.449 2.301-1.28 3.13C12.72 16.93 7 16 7 16l-.003-.017zM15.3 10.5l-2 .8-.8 2-.8-2-2-.8 2-.8.8-2 .8 2 2 .8z'/%3E%3Cpath id='b' d='M50.63 8c.13 0 .23.1.23.23V9c.7-.76 1.7-1.18 2.73-1.18 2.17 0 3.95 1.85 3.95 4.17s-1.77 4.19-3.94 4.19c-1.04 0-2.03-.43-2.74-1.18v3.77c0 .13-.1.23-.23.23h-1.4c-.13 0-.23-.1-.23-.23V8.23c0-.12.1-.23.23-.23h1.4zm-3.86.01c.01 0 .01 0 .01-.01.13 0 .22.1.22.22v7.55c0 .12-.1.23-.23.23h-1.4c-.13 0-.23-.1-.23-.23V15c-.7.76-1.69 1.19-2.73 1.19-2.17 0-3.94-1.87-3.94-4.19 0-2.32 1.77-4.19 3.94-4.19 1.03 0 2.02.43 2.73 1.18v-.75c0-.12.1-.23.23-.23h1.4zm26.375-.19a4.24 4.24 0 00-4.16 3.29c-.13.59-.13 1.19 0 1.77a4.233 4.233 0 004.17 3.3c2.35 0 4.26-1.87 4.26-4.19 0-2.32-1.9-4.17-4.27-4.17zM60.63 5c.13 0 .23.1.23.23v3.76c.7-.76 1.7-1.18 2.73-1.18 1.88 0 3.45 1.4 3.84 3.28.13.59.13 1.2 0 1.8-.39 1.88-1.96 3.29-3.84 3.29-1.03 0-2.02-.43-2.73-1.18v.77c0 .12-.1.23-.23.23h-1.4c-.13 0-.23-.1-.23-.23V5.23c0-.12.1-.23.23-.23h1.4zm-34 11h-1.4c-.13 0-.23-.11-.23-.23V8.22c.01-.13.1-.22.23-.22h1.4c.13 0 .22.11.23.22v.68c.5-.68 1.3-1.09 2.16-1.1h.03c1.09 0 2.09.6 2.6 1.55.45-.95 1.4-1.55 2.44-1.56 1.62 0 2.93 1.25 2.9 2.78l.03 5.2c0 .13-.1.23-.23.23h-1.41c-.13 0-.23-.11-.23-.23v-4.59c0-.98-.74-1.71-1.62-1.71-.8 0-1.46.7-1.59 1.62l.01 4.68c0 .13-.11.23-.23.23h-1.41c-.13 0-.23-.11-.23-.23v-4.59c0-.98-.74-1.71-1.62-1.71-.85 0-1.54.79-1.6 1.8v4.5c0 .13-.1.23-.23.23zm53.615 0h-1.61c-.04 0-.08-.01-.12-.03-.09-.06-.13-.19-.06-.28l2.43-3.71-2.39-3.65a.213.213 0 01-.03-.12c0-.12.09-.21.21-.21h1.61c.13 0 .24.06.3.17l1.41 2.37 1.4-2.37a.34.34 0 01.3-.17h1.6c.04 0 .08.01.12.03.09.06.13.19.06.28l-2.37 3.65 2.43 3.7c0 .05.01.09.01.13 0 .12-.09.21-.21.21h-1.61c-.13 0-.24-.06-.3-.17l-1.44-2.42-1.44 2.42a.34.34 0 01-.3.17zm-7.12-1.49c-1.33 0-2.42-1.12-2.42-2.51 0-1.39 1.08-2.52 2.42-2.52 1.33 0 2.42 1.12 2.42 2.51 0 1.39-1.08 2.51-2.42 2.52zm-19.865 0c-1.32 0-2.39-1.11-2.42-2.48v-.07c.02-1.38 1.09-2.49 2.4-2.49 1.32 0 2.41 1.12 2.41 2.51 0 1.39-1.07 2.52-2.39 2.53zm-8.11-2.48c-.01 1.37-1.09 2.47-2.41 2.47s-2.42-1.12-2.42-2.51c0-1.39 1.08-2.52 2.4-2.52 1.33 0 2.39 1.11 2.41 2.48l.02.08zm18.12 2.47c-1.32 0-2.39-1.11-2.41-2.48v-.06c.02-1.38 1.09-2.48 2.41-2.48s2.42 1.12 2.42 2.51c0 1.39-1.09 2.51-2.42 2.51z'/%3E%3C/defs%3E%3Cmask id='c'%3E%3Crect width='100%25' height='100%25' fill='%23fff'/%3E%3Cuse xlink:href='%23a'/%3E%3Cuse xlink:href='%23b'/%3E%3C/mask%3E%3Cg stroke='%23fff' stroke-width='3' fill='%23fff'%3E%3Ccircle mask='url(%23c)' cx='11.5' cy='11.5' r='9.25'/%3E%3Cuse xlink:href='%23b' mask='url(%23c)'/%3E%3C/g%3E%3Cuse xlink:href='%23a'/%3E%3Cuse xlink:href='%23b'/%3E%3C/svg%3E\")}}.mapboxgl-ctrl.mapboxgl-ctrl-attrib{padding:0 5px;background-color:hsla(0,0%,100%,.5);margin:0}@media screen{.mapboxgl-ctrl-attrib.mapboxgl-compact{min-height:20px;padding:0;margin:10px;position:relative;background-color:#fff;border-radius:3px 12px 12px 3px}.mapboxgl-ctrl-attrib.mapboxgl-compact:hover{padding:2px 24px 2px 4px;visibility:visible;margin-top:6px}.mapboxgl-ctrl-bottom-left>.mapboxgl-ctrl-attrib.mapboxgl-compact:hover,.mapboxgl-ctrl-top-left>.mapboxgl-ctrl-attrib.mapboxgl-compact:hover{padding:2px 4px 2px 24px;border-radius:12px 3px 3px 12px}.mapboxgl-ctrl-attrib.mapboxgl-compact .mapboxgl-ctrl-attrib-inner{display:none}.mapboxgl-ctrl-attrib.mapboxgl-compact:hover .mapboxgl-ctrl-attrib-inner{display:block}.mapboxgl-ctrl-attrib.mapboxgl-compact:after{content:\"\";cursor:pointer;position:absolute;background-image:url(\"data:image/svg+xml;charset=utf-8,%3Csvg width='24' height='24' viewBox='0 0 20 20' xmlns='http://www.w3.org/2000/svg' fill-rule='evenodd'%3E%3Cpath d='M4 10a6 6 0 1012 0 6 6 0 10-12 0m5-3a1 1 0 102 0 1 1 0 10-2 0m0 3a1 1 0 112 0v3a1 1 0 11-2 0'/%3E%3C/svg%3E\");background-color:hsla(0,0%,100%,.5);width:24px;height:24px;box-sizing:border-box;border-radius:12px}.mapboxgl-ctrl-bottom-right>.mapboxgl-ctrl-attrib.mapboxgl-compact:after{bottom:0;right:0}.mapboxgl-ctrl-top-right>.mapboxgl-ctrl-attrib.mapboxgl-compact:after{top:0;right:0}.mapboxgl-ctrl-top-left>.mapboxgl-ctrl-attrib.mapboxgl-compact:after{top:0;left:0}.mapboxgl-ctrl-bottom-left>.mapboxgl-ctrl-attrib.mapboxgl-compact:after{bottom:0;left:0}}@media screen and (-ms-high-contrast:active){.mapboxgl-ctrl-attrib.mapboxgl-compact:after{background-image:url(\"data:image/svg+xml;charset=utf-8,%3Csvg width='24' height='24' viewBox='0 0 20 20' xmlns='http://www.w3.org/2000/svg' fill-rule='evenodd' fill='%23fff'%3E%3Cpath d='M4 10a6 6 0 1012 0 6 6 0 10-12 0m5-3a1 1 0 102 0 1 1 0 10-2 0m0 3a1 1 0 112 0v3a1 1 0 11-2 0'/%3E%3C/svg%3E\")}}@media screen and (-ms-high-contrast:black-on-white){.mapboxgl-ctrl-attrib.mapboxgl-compact:after{background-image:url(\"data:image/svg+xml;charset=utf-8,%3Csvg width='24' height='24' viewBox='0 0 20 20' xmlns='http://www.w3.org/2000/svg' fill-rule='evenodd'%3E%3Cpath d='M4 10a6 6 0 1012 0 6 6 0 10-12 0m5-3a1 1 0 102 0 1 1 0 10-2 0m0 3a1 1 0 112 0v3a1 1 0 11-2 0'/%3E%3C/svg%3E\")}}.mapboxgl-ctrl-attrib a{color:rgba(0,0,0,.75);text-decoration:none}.mapboxgl-ctrl-attrib a:hover{color:inherit;text-decoration:underline}.mapboxgl-ctrl-attrib .mapbox-improve-map{font-weight:700;margin-left:2px}.mapboxgl-attrib-empty{display:none}.mapboxgl-ctrl-scale{background-color:hsla(0,0%,100%,.75);font-size:10px;border:2px solid #333;border-top:#333;padding:0 5px;color:#333;box-sizing:border-box}.mapboxgl-popup{position:absolute;top:0;left:0;display:flex;will-change:transform;pointer-events:none}.mapboxgl-popup-anchor-top,.mapboxgl-popup-anchor-top-left,.mapboxgl-popup-anchor-top-right{flex-direction:column}.mapboxgl-popup-anchor-bottom,.mapboxgl-popup-anchor-bottom-left,.mapboxgl-popup-anchor-bottom-right{flex-direction:column-reverse}.mapboxgl-popup-anchor-left{flex-direction:row}.mapboxgl-popup-anchor-right{flex-direction:row-reverse}.mapboxgl-popup-tip{width:0;height:0;border:10px solid transparent;z-index:1}.mapboxgl-popup-anchor-top .mapboxgl-popup-tip{align-self:center;border-top:none;border-bottom-color:#fff}.mapboxgl-popup-anchor-top-left .mapboxgl-popup-tip{align-self:flex-start;border-top:none;border-left:none;border-bottom-color:#fff}.mapboxgl-popup-anchor-top-right .mapboxgl-popup-tip{align-self:flex-end;border-top:none;border-right:none;border-bottom-color:#fff}.mapboxgl-popup-anchor-bottom .mapboxgl-popup-tip{align-self:center;border-bottom:none;border-top-color:#fff}.mapboxgl-popup-anchor-bottom-left .mapboxgl-popup-tip{align-self:flex-start;border-bottom:none;border-left:none;border-top-color:#fff}.mapboxgl-popup-anchor-bottom-right .mapboxgl-popup-tip{align-self:flex-end;border-bottom:none;border-right:none;border-top-color:#fff}.mapboxgl-popup-anchor-left .mapboxgl-popup-tip{align-self:center;border-left:none;border-right-color:#fff}.mapboxgl-popup-anchor-right .mapboxgl-popup-tip{align-self:center;border-right:none;border-left-color:#fff}.mapboxgl-popup-close-button{position:absolute;right:0;top:0;border:0;border-radius:0 3px 0 0;cursor:pointer;background-color:transparent}.mapboxgl-popup-close-button:hover{background-color:rgba(0,0,0,.05)}.mapboxgl-popup-content{position:relative;background:#fff;border-radius:3px;box-shadow:0 1px 2px rgba(0,0,0,.1);padding:10px 10px 15px;pointer-events:auto}.mapboxgl-popup-anchor-top-left .mapboxgl-popup-content{border-top-left-radius:0}.mapboxgl-popup-anchor-top-right .mapboxgl-popup-content{border-top-right-radius:0}.mapboxgl-popup-anchor-bottom-left .mapboxgl-popup-content{border-bottom-left-radius:0}.mapboxgl-popup-anchor-bottom-right .mapboxgl-popup-content{border-bottom-right-radius:0}.mapboxgl-popup-track-pointer{display:none}.mapboxgl-popup-track-pointer *{pointer-events:none;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none}.mapboxgl-map:hover .mapboxgl-popup-track-pointer{display:flex}.mapboxgl-map:active .mapboxgl-popup-track-pointer{display:none}.mapboxgl-marker{position:absolute;top:0;left:0;will-change:transform}.mapboxgl-user-location-dot,.mapboxgl-user-location-dot:before{background-color:#1da1f2;width:15px;height:15px;border-radius:50%}.mapboxgl-user-location-dot:before{content:\"\";position:absolute;-webkit-animation:mapboxgl-user-location-dot-pulse 2s infinite;animation:mapboxgl-user-location-dot-pulse 2s infinite}.mapboxgl-user-location-dot:after{border-radius:50%;border:2px solid #fff;content:\"\";height:19px;left:-2px;position:absolute;top:-2px;width:19px;box-sizing:border-box;box-shadow:0 0 3px rgba(0,0,0,.35)}@-webkit-keyframes mapboxgl-user-location-dot-pulse{0%{-webkit-transform:scale(1);opacity:1}70%{-webkit-transform:scale(3);opacity:0}to{-webkit-transform:scale(1);opacity:0}}@keyframes mapboxgl-user-location-dot-pulse{0%{transform:scale(1);opacity:1}70%{transform:scale(3);opacity:0}to{transform:scale(1);opacity:0}}.mapboxgl-user-location-dot-stale{background-color:#aaa}.mapboxgl-user-location-dot-stale:after{display:none}.mapboxgl-user-location-accuracy-circle{background-color:rgba(29,161,242,.2);width:1px;height:1px;border-radius:100%}.mapboxgl-crosshair,.mapboxgl-crosshair .mapboxgl-interactive,.mapboxgl-crosshair .mapboxgl-interactive:active{cursor:crosshair}.mapboxgl-boxzoom{position:absolute;top:0;left:0;width:0;height:0;background:#fff;border:2px dotted #202020;opacity:.5}@media print{.mapbox-improve-map{display:none}}",""]),t.exports=e},469:function(t,e,r){"use strict";var o=r(367);r.n(o).a},470:function(t,e,r){(e=r(7)(!1)).push([t.i,".mapboxgl-marker:hover{z-index:1}.mapboxgl-marker.active{z-index:2}",""]),t.exports=e},471:function(t,e,r){"use strict";var o=r(368);r.n(o).a},472:function(t,e,r){(e=r(7)(!1)).push([t.i,".mapboxgl-popup-tip{display:none}.mapboxgl-popup-content{background:none;padding:0;box-shadow:none}",""]),t.exports=e},473:function(t,e,r){"use strict";var o=r(369);r.n(o).a},474:function(t,e,r){(e=r(7)(!1)).push([t.i,".inline-loader .pulse[data-v-17c76915]{background-color:#f25621;width:.9375rem;height:.9375rem;margin:.0625rem;border-radius:100%;display:inline-block;-webkit-animation-name:pulse-data-v-17c76915;animation-name:pulse-data-v-17c76915;-webkit-animation-duration:.75s;animation-duration:.75s;-webkit-animation-iteration-count:infinite;animation-iteration-count:infinite;-webkit-animation-timing-function:cubic-bezier(.2,.68,.18,1.08);animation-timing-function:cubic-bezier(.2,.68,.18,1.08);-webkit-animation-fill-mode:both;animation-fill-mode:both}.inline-loader .pulse-1[data-v-17c76915]{-webkit-animation-delay:.12s;animation-delay:.12s}.inline-loader .pulse-2[data-v-17c76915]{-webkit-animation-delay:.24s;animation-delay:.24s}.inline-loader .pulse-3[data-v-17c76915]{-webkit-animation-delay:.36s;animation-delay:.36s}@-webkit-keyframes pulse-data-v-17c76915{0%,80%{transform:scale(1);opacity:1}45%{transform:scale(.1);opacity:.7}}@keyframes pulse-data-v-17c76915{0%,80%{transform:scale(1);opacity:1}45%{transform:scale(.1);opacity:.7}}",""]),t.exports=e},476:function(t,e,r){"use strict";r.d(e,"a",(function(){return n})),r.d(e,"b",(function(){return l}));var o=r(43);function n(t){t=t||"";const e=o.creditCards.filter(e=>e.patterns.filter(pattern=>(pattern=String(pattern),t.slice(0,pattern.length)===pattern)).length>0);return e.length?e[0]:null}function l(t){const e=t.indexOf(" ");return e>0?{name:t.substr(0,e),surname:t.substr(e+1)}:{name:t,surname:""}}},493:function(t,e,r){"use strict";e.a={pt_BR:"Login",cs_CZ:"Přihlásit se",da_DK:"Log ind",de_DE:"Login",en_GB:"Log in",es_ES:"Inicio de sesión",fi_FI:"Kirjaudu sisään",fr_FR:"Se connecter",it_IT:"Accedi",ja_JP:"ログイン",ko_KR:"로그인",nb_NO:"Logg inn",nl_NL:"Inloggen",pl_PL:"Zaloguj się",pt_PT:"Entrar",ru_RU:"Войти",sv_SE:"Logga in",tr_TR:"Oturum aç",zh_CN:"登录"}},494:function(t,e,r){"use strict";r.d(e,"a",(function(){return h})),r.d(e,"b",(function(){return m})),r.d(e,"c",(function(){return _}));const o=r(364),n={maxZoom:16,padding:{top:30,bottom:30,left:30,right:30}};var l={name:"MapboxMap",props:{accessToken:{type:String,required:!0},longitude:{type:Number,required:!1,default:null},latitude:{type:Number,required:!1,default:null},zoom:{type:Number,required:!1,default:15},styleName:{type:String,required:!1,default:"mapbox://styles/mapbox/streets-v11"},scrollZoom:{type:Boolean,required:!1,default:!0},fitBounds:{type:Boolean,required:!1,default:!0},navigationControl:{type:Boolean,required:!1,default:!1}},data:()=>({map:null,markers:[]}),provide(){return{registerMarker:this.registerMarker,unregisterMarker:this.unregisterMarker}},computed:{center(){if("number"==typeof this.longitude&&"number"==typeof this.latitude)return[this.longitude,this.latitude]},markerBounds(){if(0===this.markers.length)return;const t=this.markers.map(t=>t.latitude),e=this.markers.map(t=>t.longitude);return[e.reduce((t,e)=>Math.min(t,e),180),t.reduce((t,e)=>Math.min(t,e),90),e.reduce((t,e)=>Math.max(t,e),-180),t.reduce((t,e)=>Math.max(t,e),-90)]}},watch:{markers(){this.updateMarkers(),this.fitBoundsToMarkers()},center(){this.flyToCenter()}},mounted(){this.initializeMap()},methods:{initializeMap(){const map=new o.Map({accessToken:this.accessToken,container:this.$refs.container,style:this.styleName,center:this.center,zoom:this.zoom,bounds:this.center?void 0:this.markerBounds,fitBoundsOptions:n,scrollZoom:this.scrollZoom,attributionControl:!1});map.on("load",t=>this.$emit("load",t)),this.navigationControl&&map.addControl(new o.NavigationControl),this.map=map},registerMarker(marker){this.markers.includes(marker)||this.markers.push(marker)},unregisterMarker(marker){this.markers.splice(this.markers.indexOf(marker),1)},updateMarkers(){this.map&&this.markers.forEach(marker=>{marker.addToMap(this.map)})},fitBoundsToMarkers(){this.markerBounds&&this.fitBounds&&this.map.fitBounds(this.markerBounds,n)},flyToCenter(){this.center&&this.map.flyTo({center:this.center})}}},c=(r(465),r(467),r(5)),h=Object(c.a)(l,(function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"wrapper"},[e("div",{ref:"container",staticClass:"container"}),this._v(" "),this._t("default")],2)}),[],!1,null,"166559dd",null).exports;const d=r(364);var f={name:"MapboxMarker",props:{longitude:{type:Number,required:!0},latitude:{type:Number,required:!0}},data:()=>({marker:null,popup:null,rendered:!1,active:!1}),provide(){return{registerPopup:this.registerPopup}},inject:["registerMarker","unregisterMarker"],computed:{center(){return[this.longitude,this.latitude]}},created(){this.register()},mounted(){this.initializeMarker()},destroyed(){this.unregister()},methods:{initializeMarker(){const marker=new d.Marker({element:this.$refs.marker,anchor:this.anchor}).setLngLat(this.center);this.popup&&(this.popup.addToMarker(marker),this.popup.$on("open",()=>this.active=!0),this.popup.$on("close",()=>this.active=!1)),this.marker=marker},register(){this.registerMarker(this)},unregister(){this.unregisterMarker(this),this.marker.remove()},addToMap(map){this.marker.addTo(map),this.popup&&this.popup.opened&&this.marker.togglePopup(),this.rendered=!0},registerPopup(t){this.popup=t}}},m=(r(469),Object(c.a)(f,(function(){var t=this.$createElement,e=this._self._c||t;return e("div",[e("div",{ref:"marker",staticClass:"mapboxgl-marker",class:{active:this.active}},[this.rendered?this._t("default",null,{active:this.active}):this._e()],2),this._v(" "),this._t("popup")],2)}),[],!1,null,null,null).exports);const y=r(364);var v={name:"MapboxPopup",props:{anchor:{type:String,required:!1,default:null,validator:t=>["center","top","bottom","left","right","top-left","top-right","bottom-left","bottom-right"].includes(t)},offset:{type:[Number,Array,Object],required:!1,default:null},opened:{type:Boolean,required:!1,default:!1}},inject:["registerPopup"],data:()=>({open:!1,popup:null}),created(){this.register()},mounted(){this.initializePopup()},methods:{initializePopup(){const t=new y.Popup({closeButton:!1,maxWidth:"none",className:"popup",offset:this.offset}).setDOMContent(this.$el);t.on("open",t=>{this.open=!0,this.$emit("open",t)}),t.on("close",t=>{this.open&&(this.open=!1,this.$emit("close",t))}),this.popup=t},register(){this.registerPopup(this)},addToMarker(marker){marker.setPopup(this.popup)}}},_=(r(471),Object(c.a)(v,(function(){var t=this.$createElement;return(this._self._c||t)("div",{staticClass:"popup"},[this.open?this._t("default"):this._e()],2)}),[],!1,null,null,null).exports)},495:function(t,e,r){"use strict";r.d(e,"a",(function(){return l})),r.d(e,"b",(function(){return h}));var o={name:"Navbar"},n=(r(647),r(5)),l=Object(n.a)(o,(function(t,e){var r=e._c;return r("nav",e._g(e._b({staticClass:"navbar"},"nav",e.data.attrs,!1),e.listeners),[r("ul",[e._t("default")],2)])}),[],!0,null,"7963a2e1",null).exports,c={name:"NavbarItem",props:{type:{type:String,required:!1,default:"a"},active:{type:Boolean,required:!1,default:!1}}},h=(r(649),Object(n.a)(c,(function(t,e){var r=e._c;return r("li",e._g({},e.listeners),[r(e.props.type,e._b({tag:"component",staticClass:"item",class:{active:e.props.active}},"component",e.data.attrs,!1),[r("div",{staticClass:"content"},[e._t("default")],2)])],1)}),[],!0,null,"41643053",null).exports)},527:function(t,e,r){"use strict";var o=r(413);r.n(o).a},528:function(t,e,r){(e=r(7)(!1)).push([t.i,".dropdown[data-v-e65a017e]{cursor:pointer;outline:none;white-space:normal;display:inline-flex;align-items:baseline;background:#fff;border-radius:.25rem;line-height:normal;color:#31363f;box-shadow:inset 0 0 0 1px #a9afbc;margin-right:1rem}.dropdown.small[data-v-e65a017e]{font-size:.875rem;letter-spacing:.1px;padding:.5rem 1rem}.dropdown.large[data-v-e65a017e]{font-size:1rem;letter-spacing:0;padding:.8125rem}.dropdown.full-width[data-v-e65a017e]{display:flex}.dropdown.success[data-v-e65a017e]{box-shadow:inset 0 0 0 1px #26a159}.dropdown.error[data-v-e65a017e]{box-shadow:inset 0 0 0 1px #d11a3b}.dropdown .label[data-v-e65a017e]{flex:1;white-space:nowrap;overflow:hidden;text-overflow:ellipsis;margin-right:1rem}.dropdown .icon[data-v-e65a017e]{line-height:1;align-self:center;display:grid;letter-spacing:normal;width:1rem;-webkit-tap-highlight-color:transparent}.dropdown .icon.left[data-v-e65a017e]{width:1rem;font-size:1rem;color:#f25621;margin-right:.5rem}.dropdown .icon.right[data-v-e65a017e]{width:.625rem;font-size:.625rem}",""]),t.exports=e},622:function(t,e,r){"use strict";e.a={pt_BR:"Criar conta",cs_CZ:"Vytvořit účet",da_DK:"Opret konto",de_DE:"Konto erstellen",en_GB:"Create account",es_ES:"Crear cuenta",fi_FI:"Luo tili",fr_FR:"Créez un compte.",it_IT:"Crea il tuo account qui",ja_JP:"アカウントを作成する",ko_KR:"계정을 만들어 보세요",nb_NO:"Opprett konto",nl_NL:"Account aanmaken",pl_PL:"Utwórz konto",pt_PT:"Criar Conta",ru_RU:"Создать аккаунт",sv_SE:"Skapa konto",tr_TR:"Hesap Oluştur",zh_CN:"创建账号"}},647:function(t,e,r){"use strict";var o=r(417);r.n(o).a},648:function(t,e,r){(e=r(7)(!1)).push([t.i,".navbar ul[data-v-7963a2e1]{display:flex;flex-wrap:nowrap;overflow-x:auto}",""]),t.exports=e},649:function(t,e,r){"use strict";var o=r(418);r.n(o).a},650:function(t,e,r){(e=r(7)(!1)).push([t.i,".item[data-v-41643053]{display:block;outline:0;text-decoration:none;flex:0 0 auto;padding:1rem 0;cursor:pointer;transition:box-shadow .15s ease-in-out;white-space:nowrap}.item[data-v-41643053]:hover{box-shadow:inset 0 -.25rem 0 #a9afbc}.item.active[data-v-41643053]{box-shadow:inset 0 -.25rem 0 #f25621}.item .content[data-v-41643053]{color:#31363f;font-size:1rem;line-height:1.38;letter-spacing:0;padding:0 1rem;border-right:.0625rem solid #dddfe4;text-transform:capitalize}",""]),t.exports=e},679:function(t,e,r){var content=r(979);"string"==typeof content&&(content=[[t.i,content,""]]),content.locals&&(t.exports=content.locals);(0,r(8).default)("3582ca62",content,!0,{sourceMap:!1})},680:function(t,e,r){var content=r(985);"string"==typeof content&&(content=[[t.i,content,""]]),content.locals&&(t.exports=content.locals);(0,r(8).default)("25a6f8e0",content,!0,{sourceMap:!1})},681:function(t,e,r){var content=r(987);"string"==typeof content&&(content=[[t.i,content,""]]),content.locals&&(t.exports=content.locals);(0,r(8).default)("40496c81",content,!0,{sourceMap:!1})},682:function(t,e,r){var content=r(989);"string"==typeof content&&(content=[[t.i,content,""]]),content.locals&&(t.exports=content.locals);(0,r(8).default)("99e8299a",content,!0,{sourceMap:!1})},688:function(t,e,r){var content=r(1001);"string"==typeof content&&(content=[[t.i,content,""]]),content.locals&&(t.exports=content.locals);(0,r(8).default)("2d3f51ae",content,!0,{sourceMap:!1})},689:function(t,e,r){var content=r(1003);"string"==typeof content&&(content=[[t.i,content,""]]),content.locals&&(t.exports=content.locals);(0,r(8).default)("3c791a5b",content,!0,{sourceMap:!1})},691:function(t,e,r){var content=r(1007);"string"==typeof content&&(content=[[t.i,content,""]]),content.locals&&(t.exports=content.locals);(0,r(8).default)("68cace94",content,!0,{sourceMap:!1})},692:function(t,e,r){var content=r(1009);"string"==typeof content&&(content=[[t.i,content,""]]),content.locals&&(t.exports=content.locals);(0,r(8).default)("3c22f4c8",content,!0,{sourceMap:!1})},709:function(t,e,r){var content=r(1045);"string"==typeof content&&(content=[[t.i,content,""]]),content.locals&&(t.exports=content.locals);(0,r(8).default)("2bddeeaa",content,!0,{sourceMap:!1})},724:function(t,e,r){"use strict";var o={name:"Dropdown",props:{text:{type:String,required:!0},size:{type:String,required:!1,default:"small",validator:t=>["small","large"].includes(t)},icon:{type:String,required:!1,default:null},fullWidth:{type:Boolean,required:!1,default:!1},state:{type:String,required:!1,default:null,validator:t=>["success","error"].includes(t)}}},n=(r(527),r(5)),component=Object(n.a)(o,(function(t,e){var r=e._c;return r("div",e._g(e._b({staticClass:"dropdown",class:{small:"small"===e.props.size,large:"large"===e.props.size,"full-width":e.props.fullWidth,success:"success"===e.props.state,error:"error"===e.props.state}},"div",e.data.attrs,!1),e.listeners),[e.props.icon?r("i",{staticClass:"icon left",class:["icon-"+e.props.icon]}):e._e(),e._v(" "),r("div",{staticClass:"label"},[e._v(e._s(e.props.text))]),e._v(" "),r("i",{staticClass:"icon right icon-core-chevron-down"})])}),[],!0,null,"e65a017e",null);e.a=component.exports},761:function(t,e,r){"use strict";r.d(e,"a",(function(){return o}));class o{constructor(t,e,r,n,l,image=null){this.id=t,this.name=e,this.country=r,this.urlFriendlyName=n,this.urlFriendlyCountry=l,this.url=o.generateCityUrl(n,l),this.image=image}static generateCityUrl(t,e){return"".concat(t,"/").concat(e)}get getMobileImage(){return this.image.mobile||null}get getTabletImage(){return this.image.tablet||null}get getDesktopImage(){return this.image.desktop||null}}},762:function(t,e,r){"use strict";r.d(e,"a",(function(){return o}));class o{constructor(t,e,r,o){this.type=t,this.mobile=e,this.tablet=r,this.desktop=o}}},763:function(t,e,r){"use strict";r(772);var o=r(727);r.d(e,"b",(function(){return o.a}));var n=r(725);r.d(e,"a",(function(){return n.a}))},764:function(t,e,r){"use strict";e.a={pt_BR:"Insira um nome de usuário válido",cs_CZ:"Zadejte prosím platné uživatelské jméno",da_DK:"Indtast venligst gyldigt brugernavn",de_DE:"Bitte gültigen Benutzernamen eingeben",en_GB:"Please enter a valid username",es_ES:"Introduzca un nombre de usuario válido",fi_FI:"Syötä kelvollinen käyttäjätunnus",fr_FR:"Veuillez entrer un nom d’utilisateur valide",it_IT:"Per favore, inserisci un nome utente valido",ja_JP:"有効なユーザー名を入力してください。",ko_KR:"유효한 사용자명을 입력하십시오",nb_NO:"Angi et gyldig brukernavn",nl_NL:"Voer een geldige gebruikersnaam in",pl_PL:"Podaj prawidłową nazwę użytkownika",pt_PT:"Introduza um nome de utilizador válido",ru_RU:"Пожалуйста, введите действующее имя пользователя",sv_SE:"Ange ett giltigt användarnamn",tr_TR:"Lütfen geçerli bir kullanıcı adı girin",zh_CN:"请输入有效用户名"}},765:function(t,e,r){"use strict";e.a={pt_BR:"Esqueceu sua senha?",cs_CZ:"Zapomněli jste heslo?",da_DK:"Glemt adgangskode?",de_DE:"Passwort vergessen?",en_GB:"Forgot password?",es_ES:"Ha olvidado su clave?",fi_FI:"Unohditko salasanan?",fr_FR:"Mot de passe oublié ?",it_IT:"Hai dimenticato la password?",ja_JP:"パスワードを忘れたか?",ko_KR:"비밀 번호가 기억 나지 않으세요?",nb_NO:"Glemt passord?",nl_NL:"Wachtwoord vergeten?",pl_PL:"Nie pamiętasz hasła?",pt_PT:"Esqueceu sua senha?",ru_RU:"Забыли пароль?",sv_SE:"Glömt lösenord?",tr_TR:"Şifrenizi mi unuttunuz?",zh_CN:"忘记密码？"}},766:function(t,e,r){"use strict";var o=r(765),n=r(493);const l={t_FORGOTTENPASSWORD:o.a,t_LOGIN:n.a};e.a=t=>Object.assign({},...Object.keys(l).map(e=>({[e]:l[e][t]||l[e].en_GB})))},767:function(t,e,r){"use strict";e.a={pt_BR:"Nacionalidade",cs_CZ:"Národnost",da_DK:"Nationalitet",de_DE:"Nationalität",en_GB:"Nationality",es_ES:"Nacionalidad",fi_FI:"Kansalaisuus",fr_FR:"Nationalité",it_IT:"Nazionalità",ja_JP:"国籍",ko_KR:"국적",nb_NO:"Nasjonalitet",nl_NL:"Nationaliteit",pl_PL:"Narodowość",pt_PT:"Nacionalidade",ru_RU:"Гражданство",sv_SE:"Nationalitet",tr_TR:"Uyruk",zh_CN:"国籍"}},768:function(t,e,r){"use strict";r.d(e,"a",(function(){return l}));var o=r(428),n=r(476);class l{constructor(t=null,e,r,l,c,h=""){const d=Object(n.a)(r);this.id=t,this.cardHolder=e,this.cardNumber=r,this.ExpiryMonth=l,this.ExpiryYear=c,this.brand=null==d?void 0:d.type,this.caseSensitiveBrand=null==d?void 0:d.caseSensitiveType,this.maskedNumber=Object(o.d)(r),this.type=h}}},769:function(t,e,r){"use strict";e.a={pt_BR:"Escolha os quartos novamente",cs_CZ:"Choose rooms again",da_DK:"Choose rooms again",de_DE:"Wähle erneut die Zimmer",en_GB:"Choose rooms again",es_ES:"Elija las habitaciones nuevamente",fi_FI:"Choose rooms again",fr_FR:"Choisissez à nouveau les chambres",it_IT:"Scegli di nuovo le stanze",ja_JP:"ルームタイプをもう一度選択してください。",ko_KR:"Choose rooms again",nb_NO:"Choose rooms again",nl_NL:"Choose rooms again",pl_PL:"Choose rooms again",pt_PT:"Escolhe os quartos outra vez",ru_RU:"Заново выбрать номера",sv_SE:"Choose rooms again",tr_TR:"Choose rooms again",zh_CN:"请选择房型"}},772:function(t,e,r){"use strict";r.r(e);var o=r(395),n=r(21),l=r(770),c=r(495),h={name:"Tab",inject:["tabs","activateTab"],components:{NavbarItem:c.b},props:{name:{type:String,required:!0}},computed:{active(){return this.tabs.active===this.name}},methods:{activate(){this.activateTab(this.name)}}},d=r(5),f=Object(d.a)(h,(function(){var t=this.$createElement;return(this._self._c||t)("NavbarItem",{attrs:{role:"tab",active:this.active,"aria-selected":this.active},on:{click:this.activate}},[this._t("default")],2)}),[],!1,null,null,null).exports,m={name:"Tabs",components:{Navbar:c.a},props:{value:{type:String,required:!1,default:null}},data(){return{tabs:{active:this.value}}},watch:{value(t){this.tabs.active=t}},provide(){return{tabs:this.tabs,activateTab:this.activateTab}},methods:{activateTab(t){this.tabs.active=t,this.$emit("input",t)}}},y=Object(d.a)(m,(function(){var t=this.$createElement;return(this._self._c||t)("Navbar",{attrs:{role:"tablist"}},[this._t("default")],2)}),[],!1,null,null,null).exports,v={name:"TabPanel",inject:["panels"],props:{name:{type:String,required:!0}},computed:{active(){return this.panels.activePanel===this.name}}},_=Object(d.a)(v,(function(){var t=this.$createElement,e=this._self._c||t;return this.active?e("div",{staticClass:"tab-panel",attrs:{role:"tabpanel"}},[this._t("default")],2):this._e()}),[],!1,null,null,null).exports,x={name:"TabPanels",props:{value:{type:String,required:!1,default:null}},provide(){return{panels:this.panels}},data(){return{panels:{activePanel:this.value}}},watch:{value(t){this.panels.activePanel=t}}},w=Object(d.a)(x,(function(){var t=this.$createElement;return(this._self._c||t)("div",{staticClass:"tab-panels"},[this._t("default")],2)}),[],!1,null,null,null).exports;function E(object,t){var e=Object.keys(object);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(object);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(object,t).enumerable}))),e.push.apply(e,r)}return e}function k(t){for(var i=1;i<arguments.length;i++){var source=null!=arguments[i]?arguments[i]:{};i%2?E(Object(source),!0).forEach((function(e){S(t,e,source[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(source)):E(Object(source)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(source,e))}))}return t}function S(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}var T={name:"TabbedFilterPanel",components:{PriceFilter:l.c,RatingFilter:l.e,RoomTypeFilter:l.f,FacilityFilter:l.b,PropertyTypeFilter:l.d,DistrictFilter:l.a,Tabs:y,Tab:f,TabPanels:w,TabPanel:_},data:()=>({tab:"priceTab"}),computed:k(k({},Object(n.e)("search",{properties:t=>t.properties,filter:t=>t.viewOptions.filter,city:t=>t.city.name})),Object(n.c)({filteredProperties:"search/filteredProperties",districts:"search/districts"})),created(){this.$setTranscodes(Object(o.a)(this.$store.state.session.language.code))}},I=(r(984),Object(d.a)(T,(function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("div",[r("Tabs",{staticClass:"page-inner",model:{value:t.tab,callback:function(e){t.tab=e},expression:"tab"}},[r("Tab",{attrs:{name:"priceTab"}},[t._v(t._s(t.$t("t_PRICE")))]),t._v(" "),r("Tab",{attrs:{name:"ratingTab"}},[t._v(t._s(t.$t("t_RATING")))]),t._v(" "),r("Tab",{attrs:{name:"roomTypeTab"}},[t._v(t._s(t.$t("t_ROOM")))]),t._v(" "),r("Tab",{attrs:{name:"facilitiesTab"}},[t._v(t._s(t.$t("t_FACILITIES")))]),t._v(" "),r("Tab",{attrs:{name:"propertyTypeTab"}},[t._v(t._s(t.$t("t_PROPERTYTYPE")))]),t._v(" "),t.districts&&t.districts.length>0?r("Tab",{attrs:{name:"districtTab"}},[t._v(t._s(t.$t("t_POPULARPLACEINCITY",{PLACEHOLDER:t.city})))]):t._e()],1),t._v(" "),r("TabPanels",{staticClass:"tab-panels",model:{value:t.tab,callback:function(e){t.tab=e},expression:"tab"}},[r("TabPanel",{staticClass:"filter-tab",attrs:{name:"priceTab"}},[r("PriceFilter",{attrs:{"no-label":""}})],1),t._v(" "),r("TabPanel",{staticClass:"filter-tab",attrs:{name:"ratingTab"}},[r("RatingFilter",{attrs:{"no-label":""}})],1),t._v(" "),r("TabPanel",{staticClass:"filter-tab",attrs:{name:"roomTypeTab"}},[r("RoomTypeFilter",{attrs:{horizontal:""}})],1),t._v(" "),r("TabPanel",{staticClass:"filter-tab",attrs:{name:"facilitiesTab"}},[r("FacilityFilter",{attrs:{horizontal:""}})],1),t._v(" "),r("TabPanel",{staticClass:"filter-tab",attrs:{name:"propertyTypeTab"}},[r("PropertyTypeFilter",{attrs:{horizontal:""}})],1),t._v(" "),t.districts&&t.districts.length>0?r("TabPanel",{staticClass:"filter-tab",attrs:{name:"districtTab"}},[r("DistrictFilter",{attrs:{horizontal:""}})],1):t._e()],1)],1)}),[],!1,null,"4b6073c6",null));e.default=I.exports},774:function(t,e,r){"use strict";var o=r(374),n=r(314),l=r(433),c=r(622),h=r(424);var d={pt_BR:"Usuario",cs_CZ:"Uživatelské jméno",da_DK:"Brugernavn",de_DE:"Benutzername",en_GB:"Username",es_ES:"Usuario",fi_FI:"Käyttäjätunnus",fr_FR:"Nom d'utilisateur",it_IT:"Nome utente",ja_JP:"ユーザーネーム",ko_KR:"사용자 이름",nb_NO:"Brukernavn",nl_NL:"Gebruikersnaam",pl_PL:"Nazwa użytkownika",pt_PT:"Usuario",ru_RU:"Имя пользователя",sv_SE:"Användarnamn",tr_TR:"Kullanıcı adı",zh_CN:"用户名"};var f={pt_BR:"Senha",cs_CZ:"Heslo",da_DK:"Adgangskode",de_DE:"Kennwort",en_GB:"Password",es_ES:"Contraseña",fi_FI:"Salasana",fr_FR:"Mot de passe",it_IT:"Password",ja_JP:"パスワード",ko_KR:"비밀 번호",nb_NO:"Passord",nl_NL:"Wachtwoord",pl_PL:"Hasło",pt_PT:"Palavra-passe",ru_RU:"Пароль",sv_SE:"Lösenord",tr_TR:"Şifre",zh_CN:"密码"},m=r(764);var y={pt_BR:"Insira uma senha válida.",cs_CZ:"Zadejte prosím platné heslo.",da_DK:"Indtast venligst en gyldig adgangskode.",de_DE:"Bitte gültiges Passwort eingeben.",en_GB:"Please enter a valid password.",es_ES:"Introduce una contraseña válida.",fi_FI:"Anna kelvollinen salasana.",fr_FR:"Veuillez entrer un mot de passe valide.",it_IT:"Inserisci una password valida.",ja_JP:"有効なパスワードを入力してください。",ko_KR:"유효한 비밀번호를 입력하십시오.",nb_NO:"Angi et gyldig passord.",nl_NL:"Voer een geldig wachtwoord in.",pl_PL:"Podaj prawidłowe hasło.",pt_PT:"Introduza uma palavra-passe válida.",ru_RU:"Укажите действительный пароль.",sv_SE:"Ange ett giltigt lösenord.",tr_TR:"Lütfen geçerli bir parola girin.",zh_CN:"请输入正确密码."},v=r(765),_=r(493);var x={pt_BR:"Invalid username or password",cs_CZ:"Invalid username or password",da_DK:"Invalid username or password",de_DE:"Invalid username or password",en_GB:"Invalid username or password",es_ES:"Invalid username or password",fi_FI:"Invalid username or password",fr_FR:"Invalid username or password",it_IT:"Nome utente o password non corretti",ja_JP:"Invalid username or password",ko_KR:"Invalid username or password",nb_NO:"Invalid username or password",nl_NL:"Invalid username or password",pl_PL:"Invalid username or password",pt_PT:"Invalid username or password",ru_RU:"Invalid username or password",sv_SE:"Invalid username or password",tr_TR:"Invalid username or password",zh_CN:"用户名或密码错误"};var w={pt_BR:"Seja bem-vindo(a) de volta! Você se conectou com sucesso.",cs_CZ:"Vítejte zpět! Úspěšně jste se přihlásili.",da_DK:"Velkommen tilbage! Du er nu logget på.",de_DE:"Willkommen zurück! Du hast dich erfolgreich angemeldet.",en_GB:"Welcome back! You logged in successfully.",es_ES:"¡Bienvenido/a de nuevo! Has iniciado sesión correctamente.",fi_FI:"Tervetuloa takaisin! Kirjauduit sisään onnistuneesti.",fr_FR:"Quel plaisir de vous revoir ! Vous vous êtes connecté avec succès.",it_IT:"Che piacere riverderti! La tua registrazione ha avuto successo.",ja_JP:"おかえりなさい！ログインしました。",ko_KR:"다시 찾아주셔서 감사합니다! 성공적으로 로그인하셨습니다.",nb_NO:"Velkommen tilbake! Du har logget inn.",nl_NL:"Welkom terug! U bent ingelogd.",pl_PL:"Witamy ponownie! Zalogowałeś się pomyślnie.",pt_PT:"Bem-vindo(a) de novo! A sessão foi iniciada com sucesso.",ru_RU:"Добро пожаловать! Вы успешно зашли на сайт.",sv_SE:"Välkommen tillbaka! Du har loggats in.",tr_TR:"Tekrar hoşgeldiniz! Başarılı bir şekilde giriş yaptınız.",zh_CN:"欢迎回来！ 您已成功登录。"};var E={pt_BR:"Não tem uma conta?",cs_CZ:"Nemáte účet?",da_DK:"Har du ikke en konto?",de_DE:"Sie haben kein Konto?",en_GB:"Don't have an account?",es_ES:"No tienes una cuenta?",fi_FI:"Eikö sinulla ole tiliä?",fr_FR:"Vous n'avez pas de compte?",it_IT:"Non hai un account?",ja_JP:"アカウントをお持ちでないですか？",ko_KR:"계정이 없으신가요?",nb_NO:"Har du ikke en konto?",nl_NL:"Heb je geen account?",pl_PL:"Nie masz konta?",pt_PT:"Não tem conta?",ru_RU:"У вас нет аккаунта?",sv_SE:"Har du inget konto?",tr_TR:"Hesabınız yok mu?",zh_CN:"没有账号？"},k=r(362);const S={t_CREATEACCOUNT:c.a,t_EMAILADDRESS:h.a,t_USERNAME:d,t_PASSWORD:f,t_ENTERVALIDUSERNAME:m.a,t_ENTERVALIDPASSWORD:y,t_FORGOTTENPASSWORD:v.a,t_LOGIN:_.a,t_ERRORINVALIDLOGINDETAILS:x,t_WELCOMELOGINSUCCESS:w,t_HAVENOACCOUNT:E,t_ERRORPROCESSINGREQUESTMESSAGE:k.a};var T=t=>Object.assign({},...Object.keys(S).map(e=>({[e]:S[e][t]||S[e].en_GB}))),I=r(100),z=r(376),C={name:"LoginForm",components:{SelfEfficacyInput:o.a,SelfEfficacyInputError:o.b,Button:n.a,InlineLoader:l.a},props:{initialEmail:{type:String,required:!1,default:null}},data(){return{email:this.initialEmail,password:null,dirty:!1,loading:!1}},computed:{isAuth(){return this.$store.state.session.auth},validation(){return{email:{invalid:!Object(I.a)(this.email)},password:{invalid:!Object(I.a)(this.password)}}},valid(){return!this.validation.email.invalid&&!this.validation.password.invalid}},created(){this.$setTranscodes(T(this.$store.state.session.language.code))},mounted(){this.authTracker=new z.a(this.$store,this.$device),this.$tracking(this.authTracker.onLoginClick())},methods:{handleForgotPassword(){this.$tracking(this.authTracker.onForgotPasswordClick()),this.$emit("forgot-password",this.email)},handleSignUp(){this.$tracking(this.authTracker.onCreateAccountClick())},async handleSubmit(){if(this.validate(),this.valid){this.loading=!0;try{await this.$store.dispatch("session/login",{username:this.email,password:this.password})}catch(t){return this.loading=!1,void this.$store.commit("toast/show",{message:this.$t("t_ERRORPROCESSINGREQUESTMESSAGE"),type:"error"})}if(this.loading=!1,!this.isAuth)return this.$device.isMobile&&this.$store.commit("toast/show",{message:this.$t("t_ERRORINVALIDLOGINDETAILS"),type:"error"}),void this.$emit("hasError",this.$t("t_ERRORINVALIDLOGINDETAILS"));this.$tracking(this.authTracker.onLoginSuccessful()),this.$store.commit("toast/show",{message:this.$t("t_WELCOMELOGINSUCCESS"),type:"success"}),this.$emit("login")}},validate(){this.dirty=!0}}},P=(r(1e3),r(5)),component=Object(P.a)(C,(function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("form",{staticClass:"body-2",attrs:{id:"login-form",novalidate:""},on:{submit:function(e){return e.preventDefault(),t.handleSubmit(e)}}},[r("SelfEfficacyInput",{attrs:{id:"login-email",type:"email",label:t.$t("t_EMAILADDRESS")+" / "+t.$t("t_USERNAME"),required:"",autocomplete:"username",invalid:t.dirty&&t.validation.email.invalid},model:{value:t.email,callback:function(e){t.email=e},expression:"email"}},[t.dirty&&t.validation.email.invalid?r("SelfEfficacyInputError",[t._v("\n      "+t._s(t.$t("t_ENTERVALIDUSERNAME"))+"\n    ")]):t._e()],1),t._v(" "),r("SelfEfficacyInput",{attrs:{id:"login-password",type:"password",label:t.$t("t_PASSWORD"),required:"",invalid:t.dirty&&t.validation.password.invalid,autocomplete:"current-password"},model:{value:t.password,callback:function(e){t.password=e},expression:"password"}},[t.dirty&&t.validation.password.invalid?r("SelfEfficacyInputError",[t._v("\n      "+t._s(t.$t("t_ENTERVALIDPASSWORD"))+"\n    ")]):t._e()],1),t._v(" "),t.loading?r("div",{staticClass:"loader"},[r("InlineLoader")],1):r("Button",{attrs:{id:"login-submit",size:"large","full-width":""}},[t._v("\n    "+t._s(t.$t("t_LOGIN"))+"\n  ")]),t._v(" "),r("div",{staticClass:"cta"},[r("a",{attrs:{id:"login-forgot-password",role:"button"},on:{click:t.handleForgotPassword}},[t._v(t._s(t.$t("t_FORGOTTENPASSWORD")))])]),t._v(" "),r("div",{staticClass:"cta"},[t._v("\n    "+t._s(t.$t("t_HAVENOACCOUNT"))+"\n    "),r("a",{attrs:{id:"login-signup",href:t.$langHwUrl+"/signup/",target:"_blank"},on:{click:t.handleSignUp}},[t._v(t._s(t.$t("t_CREATEACCOUNT")))])])],1)}),[],!1,null,"cdf77906",null);e.a=component.exports},775:function(t,e,r){"use strict";var o=r(374),n=r(314),l=r(41),c=r(433);var h={pt_BR:"Sucesso!",cs_CZ:"Úspěch!",da_DK:"Succes!",de_DE:"Erfolgreich versendet!",en_GB:"Success!",es_ES:"¡Éxito!",fi_FI:"Tehtävä suoritettu!",fr_FR:"Succès!",it_IT:"Successo!",ja_JP:"成功",ko_KR:"성공!",nb_NO:"Suksess!",nl_NL:"Gelukt!",pl_PL:"Udało się !",pt_PT:"Sucesso!",ru_RU:"Успешно",sv_SE:"Framgång!",tr_TR:"Başarılı!",zh_CN:"成功发送！"};var d={pt_BR:"Voltar para Login",cs_CZ:"Zpět k přihlášení",da_DK:"Tilbage til login",de_DE:"Zurück zum Login",en_GB:"Back to login",es_ES:"Volver a inicio de sesión",fi_FI:"Takaisin sisäänkirjautumiseen",fr_FR:"Retour à l’écran de connexion",it_IT:"Torna alla pagina di accesso",ja_JP:"ログインに戻る",ko_KR:"로그인으로 되돌아가기",nb_NO:"Tilbake til innlogging",nl_NL:"Terug naar login",pl_PL:"Wróć do logowania",pt_PT:"Voltar ao início de sessão",ru_RU:"Обратно к входу в систему",sv_SE:"Tillbaka till inloggning",tr_TR:"Oturuma geri dön",zh_CN:"返回登录"};var f={pt_BR:"Digite o endereço de e-mail associado à sua conta e enviaremos um link para redefinir sua senha.",cs_CZ:"Zadejte e-mailovou adresu spojenou s vaším účtem a zašleme vám odkaz na resetování hesla.",da_DK:"Indtast e-mailadressen, der er tilknyttet din konto, så sender vi dig et link til at nulstille din adgangskode.",de_DE:"Geben Sie die mit Ihrem Konto verbundene E-Mail-Adresse ein und wir senden Ihnen einen Link zum Zurücksetzen Ihres Passworts.",en_GB:"Enter the email address associated with your account, and we’ll send you a link to reset your password.",es_ES:"Introduce la dirección de correo asociada a tu cuenta y te enviaremos un link para que puedas resetear tu contraseña.",fi_FI:"Syötä tiliisi yhteydessä oleva sähköpostiosoite, ja lähetämme linkin salasanan vaihtamiseksi.",fr_FR:"Saisissez l'adresse e-mail associée à votre compte et nous vous enverrons un lien pour réinitialiser votre mot de passe.",it_IT:"Inserisci l'email associata al tuo account e ti manderemo un link per resettare la tua password.",ja_JP:"アカウントに関連付けられたeメールアドレスを入力します。パスワードをリセットするためのリンクが送信されます。",ko_KR:"계정에 등록된 이메일 주소를 입력하시면 비밀번호를 다시 설정할 수 있는 링크를 보내드리겠습니다.",nb_NO:"Angi e-postadressen som er tilknyttet kontoen din, så sender vi deg en lenke for å tilbakestille passordet.",nl_NL:"Voer het e-mailadres van je account in en we sturen je een link om je wachtwoord te resetten.",pl_PL:"Wpisz adres e-mail którego użyłeś do utworzenia konta a my wyślemy ci na niego link do zresetowania hasła.",pt_PT:"Introduza o endereço de e-mail associado à sua conta e enviaremos um link para redefinir sua senha.",ru_RU:"Введите адрес электронной почты, связанный с Вашим аккаунтом, и мы вышлем Вам ссылку для пересоздания пароля.",sv_SE:"Ange e-postadressen som är kopplad till ditt konto så skickar vi dig en länk för att återställa ditt lösenord.",tr_TR:"Hesabınızla ilişkili e-posta adresini girin; parolanızı sıfırlamanız için size bir bağlantı göndereceğiz.",zh_CN:"请输入账号关联邮箱，我们会向您发送重置密码链接"};var m={pt_BR:"Se uma conta com este endereço de e-mail existir, você receberá um e-mail nosso em breve para redefinir sua senha.",cs_CZ:"Pokud pro tuto e-mailovou adresu existuje účet, za chvíli od nás obdržíte e-mail k přenastavení hesla.",da_DK:"Hvis en konto er tilknyttet denne mailadresse, vil du om kort tid modtage en mail fra os for at nulstille din adgangskode.",de_DE:"Wenn für diese E-Mail-Adresse ein Konto existiert, erhältst du in Kürze eine E-Mail von uns, um dein Passwort zurückzusetzen.",en_GB:"If an account exists for this email address, you will receive an email from us shortly to reset your password.",es_ES:"Si existe una cuenta para este correo electrónico, recibirá un correo nuestro para que pueda cambiar la contraseña.",fi_FI:"Mikäli tätä sähköpostia vastaava tili on olemassa, saat meiltä pian sähköpostin salasanasi palauttamiseksi.",fr_FR:"Si cette adresse email correspond à votre compte, vous recevrez un email sous peu afin de réinitialiser votre mot de passe.",it_IT:"Se esiste un account per questo indirizzo email, riceverai una e-mail da noi a breve per reimpostare la password.",ja_JP:"このメールアドレスにアカウントが存在する場合は、パスワードをリセットするためのメールがGoogleから間もなく送信されます。",ko_KR:"만약 해당 이메일 주소로 호스텔월드 계정을 가지고 있으시면, 곧 이메일로 비밀번호 재설정 이메일을 받아보실 수 있습니다.",nb_NO:"Hvis det finnes en konto for denne e-postadressen, mottar du om kort tid en e-post fra oss for å tilbakestille passordet.",nl_NL:"Als er al een account bestaat voor dit e-mailadres, zul je spoedig van ons een e-mail ontvangen om je wachtwoord opnieuw in te stellen.",pl_PL:"Jeśli konto dla tego adresu e-mail istnieje, otrzymasz od nas e-mail z prośbą o zresetowanie hasła.",pt_PT:"Se existe uma conta associada a este e-mail, dentro de alguns instantes irá receber um e-mail nosso, para criar uma nova password.",ru_RU:"Если для этого адреса электронной почты существует учётная запись, вы вскоре получите ссылку, с помощью по которой вы сможете изменить пароль.",sv_SE:"Om ett konto finns för den här e-postadressen får du inom kort ett e-postmeddelande från oss för att återställa ditt lösenord.",tr_TR:"Bu e-posta adresi için bir hesap mevcut ise, kısa süre sonra parolanızı sıfırlamak üzere bizden bir e-posta alacaksınız.",zh_CN:"若该邮箱地址存在账户，则您将很快收到我们发给您的邮件来重置密码。"},y=r(764),v=r(423);var _={pt_BR:"Recuperar Senha",cs_CZ:"Obnovit heslo",da_DK:"Genskab adgangskode",de_DE:"Passwort wiederherstellen",en_GB:"Recover password",es_ES:"Recupera Contraseña",fi_FI:"Palauta salasana",fr_FR:"Récupérer mot de passe",it_IT:"Recupera la password",ja_JP:"パスワードを回復する",ko_KR:"비밀번호 재설정",nb_NO:"Gjenopprett passord",nl_NL:"Herstel wachtwoord",pl_PL:"Odzyskaj Hasło",pt_PT:"Recuperar Senha",ru_RU:"Восстановить Пароль",sv_SE:"Återställ lösenord",tr_TR:"Parolayı Kurtar",zh_CN:"找回密码"},x=r(362);const w={t_SUCCESS:h,t_BACKTOLOGIN:d,t_ENTEREMAILRESETPASSWORD:f,t_FORGOTTENPASSWORDTOKENHASBEEN:m,t_ENTERVALIDUSERNAME:y.a,t_ENTERVALIDEMAILADDRESS:v.a,t_RECOVERPASSWORD:_,t_ERRORPROCESSINGREQUESTMESSAGE:x.a};var E=t=>Object.assign({},...Object.keys(w).map(e=>({[e]:w[e][t]||w[e].en_GB}))),k=r(100),S=r(376),T={name:"ResetPasswordForm",components:{SelfEfficacyInput:o.a,SelfEfficacyInputError:o.b,Button:n.a,InlineLoader:c.a,Icon:l.a},props:{initialEmail:{type:String,required:!1,default:null}},data(){return{email:this.initialEmail,dirty:!1,loading:!1,success:!1}},computed:{validation(){return{email:{invalid:Object(k.a)(this.email)&&!Object(k.b)(this.email)||!this.email}}}},created(){this.$setTranscodes(E(this.$store.state.session.language.code))},methods:{handleBack(){this.$emit("back")},async handleSubmit(){if(this.validate(),!this.validation.email.invalid){this.loading=!0;try{await this.$store.dispatch("session/recoverPassword",this.email);const t=new S.a(this.$store,this.$device);this.$tracking(t.onRecoverPasswordClick()),this.loading=!1,this.success=!0}catch(t){return console.error("recover password failed",t),this.loading=!1,void this.$store.commit("toast/show",{message:this.$t("t_ERRORPROCESSINGREQUESTMESSAGE"),type:"error"})}}},validate(){this.dirty=!0}}},I=(r(1002),r(5)),component=Object(I.a)(T,(function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("div",{staticClass:"body-2"},[t.success?r("div",{staticClass:"success"},[r("div",{staticClass:"confirmation"},[r("Icon",{attrs:{name:"core-confirmation"}})],1),t._v(" "),r("h2",{staticClass:"title-3"},[t._v(t._s(t.$t("t_SUCCESS")))]),t._v(" "),r("p",[t._v(t._s(t.$t("t_FORGOTTENPASSWORDTOKENHASBEEN")))])]):r("form",{attrs:{id:"recoverpassword-form",novalidate:""},on:{submit:function(e){return e.preventDefault(),t.handleSubmit(e)}}},[r("p",[t._v(t._s(t.$t("t_ENTEREMAILRESETPASSWORD")))]),t._v(" "),r("SelfEfficacyInput",{attrs:{id:"recoverpassword-email",type:"email",label:t.$t("t_EMAILADDRESS"),required:"",autocomplete:"username",invalid:t.dirty&&t.validation.email.invalid},model:{value:t.email,callback:function(e){t.email=e},expression:"email"}},[t.dirty&&t.validation.email.invalid?r("SelfEfficacyInputError",[t._v("\n        "+t._s(t.$t("t_ENTERVALIDEMAILADDRESS"))+"\n      ")]):t._e()],1),t._v(" "),t.loading?r("div",{staticClass:"loader"},[r("InlineLoader")],1):r("Button",{attrs:{id:"recoverpassword-submit",size:"large","full-width":""}},[t._v("\n      "+t._s(t.$t("t_RECOVERPASSWORD"))+"\n    ")])],1),t._v(" "),r("div",{staticClass:"cta"},[r("a",{attrs:{id:"recoverpassword-login",role:"button"},on:{click:t.handleBack}},[t._v(t._s(t.$t("t_BACKTOLOGIN")))])])])}),[],!1,null,"a5a215fc",null);e.a=component.exports},776:function(t,e,r){"use strict";var o=r(494),n=r(717),l={name:"ListMapPin",props:{rating:{type:String,required:!0},price:{type:String,required:!0},active:{type:Boolean,required:!1,default:!1}}},c=(r(986),r(5)),h=Object(c.a)(l,(function(t,e){var r=e._c;return r("div",e._g({staticClass:"pin",class:{active:e.props.active}},e.listeners),[r("div",{staticClass:"rating body-2"},[e._v(e._s(e.props.rating))]),e._v(" "),r("div",{staticClass:"price body-2"},[e._v(e._s(e.props.price))])])}),[],!0,null,"ff1c039c",null).exports,d=r(82),f=r(162),m=r(19),y=r(158),v={name:"ListMap",components:{MapboxMap:o.a,MapboxMarker:o.b,MapboxPopup:o.c,PropertyCardBadge:n.a,ListMapPin:h},props:{properties:{type:[Array,d.a],required:!0},selected:{type:d.a,required:!1,default:null},popup:{type:Boolean,required:!1,default:!0}},data(){return{fitBounds:null===this.selected}},computed:{config:()=>y.default.search,priceFormat(){return Object(m.a)(this.$store.state.session.language.tag,this.$store.state.session.currency.code)},latitude(){return this.selected?this.selected.location.point.latitude:null},longitude(){return this.selected?this.selected.location.point.longitude:null}},methods:{handlePropertySelected:Object(f.b)((function(t){this.$emit("select",t)}),200,!0),isSelectedProperty(t){return this.selected===t},ratingLabel:t=>t.rating.scoreMessage,priceLabel(t){const e=t.prices.lowestAveragePricePerNight();return this.priceFormat.format(e)}}},_=Object(c.a)(v,(function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("MapboxMap",{attrs:{"access-token":t.config.token,"style-name":t.config.style,latitude:t.latitude,longitude:t.longitude,zoom:16,"fit-bounds":t.fitBounds,"navigation-control":t.$device.isDesktopOrTablet},on:{load:function(e){t.fitBounds=!0}}},t._l(t.properties,(function(p){return r("MapboxMarker",{key:p.id,attrs:{latitude:p.location.point.latitude,longitude:p.location.point.longitude},scopedSlots:t._u([{key:"default",fn:function(e){var o=e.active;return[r("ListMapPin",{attrs:{rating:t.ratingLabel(p),price:t.priceLabel(p),active:o}})]}},{key:"popup",fn:function(){return[r("MapboxPopup",{attrs:{anchor:"bottom",offset:30,opened:t.isSelectedProperty(p)},on:{open:function(e){return t.handlePropertySelected(p)},close:function(e){return t.handlePropertySelected(null)}}},[r("transition",{attrs:{appear:"",name:"scale"}},[t.popup?r("PropertyCardBadge",{attrs:{property:p}}):t._e()],1)],1)]},proxy:!0}],null,!0)})})),1)}),[],!1,null,null,null);e.a=_.exports},785:function(t,e,r){"use strict";var o=r(735),n=r(736);const l={t_NORESULTSFOUND:o.a,t_CHANGEDATESORREFINEFILTERS:n.a};var c=t=>Object.assign({},...Object.keys(l).map(e=>({[e]:l[e][t]||l[e].en_GB}))),h={name:"ListMapNoResults",created(){this.$setTranscodes(c(this.$store.state.session.language.code))}},d=(r(988),r(5)),component=Object(d.a)(h,(function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"no-results"},[e("div",{staticClass:"panel"},[e("div",{staticClass:"title title-6"},[this._v(this._s(this.$t("t_NORESULTSFOUND")))]),this._v(" "),e("div",{staticClass:"message body-2"},[this._v("\n      "+this._s(this.$t("t_CHANGEDATESORREFINEFILTERS"))+"\n    ")])])])}),[],!1,null,"61240b50",null);e.a=component.exports},978:function(t,e,r){"use strict";var o=r(679);r.n(o).a},979:function(t,e,r){(e=r(7)(!1)).push([t.i,".screen[data-v-24ff4d5f]{background:#31363f;position:fixed;width:100%;height:100%;top:0;left:0;display:grid;grid-template-rows:3.125rem 1fr;z-index:500;box-shadow:0 2px 8px rgba(0,0,0,.38)}@media screen and (min-width:40.063em){.screen[data-v-24ff4d5f]{width:18.75rem;right:0;left:auto}}.screen .modal[data-v-24ff4d5f]:focus{outline:none}.screen .scroll-wrapper[data-v-24ff4d5f]{height:100vh;overflow-y:scroll;overflow-x:hidden}.screen .scroll-wrapper>.navigation[data-v-24ff4d5f]{position:-webkit-sticky;position:sticky;height:3.125rem;align-items:center;display:grid;justify-content:end;color:#fff}.screen .scroll-wrapper>.navigation .icon[data-v-24ff4d5f]{font-size:1rem;padding:1rem;height:3.125rem;cursor:pointer}.screen .scroll-wrapper>.navigation .icon[data-v-24ff4d5f]:active,.screen .scroll-wrapper>.navigation .icon[data-v-24ff4d5f]:hover{color:#fff}.screen .scroll-wrapper>.content[data-v-24ff4d5f]{overflow:scroll;padding:0 2rem 2rem;font-size:1rem}.screen .scroll-wrapper>.content[data-v-24ff4d5f]:focus{outline:none}.screen .scroll-wrapper>.content .option[data-v-24ff4d5f]{margin-bottom:1.5rem}.screen .scroll-wrapper>.content ul[data-v-24ff4d5f]{list-style:none;margin:0;padding:0}.screen .scroll-wrapper>.content ul li[data-v-24ff4d5f]{padding:0 0 2rem;color:#f25621;cursor:pointer;font-size:.875rem;text-transform:uppercase}.screen .scroll-wrapper>.content ul li a[data-v-24ff4d5f]{display:block;padding:0 0 2rem;margin:0 0 -2rem;color:#f25621;text-decoration:none}.screen .scroll-wrapper>.content ul li.section[data-v-24ff4d5f]{font-weight:700;color:#fff;cursor:default;font-size:.75rem}",""]),t.exports=e},984:function(t,e,r){"use strict";var o=r(680);r.n(o).a},985:function(t,e,r){(e=r(7)(!1)).push([t.i,".filter-panel[data-v-4b6073c6]{padding-bottom:7.5rem}.filter-tab[data-v-4b6073c6]{padding:.5rem 0;width:100vw}.tab-panels[data-v-4b6073c6]{padding-top:1rem;background-color:#f1f2f4;border-top:.0625rem solid #a9afbc;border-bottom:.0625rem solid #a9afbc}",""]),t.exports=e},986:function(t,e,r){"use strict";var o=r(681);r.n(o).a},987:function(t,e,r){(e=r(7)(!1)).push([t.i,'.pin[data-v-ff1c039c]{background:#f25621;padding:.5rem;border-radius:.25rem;white-space:nowrap;display:flex;line-height:1;box-shadow:0 1px 4px rgba(0,0,0,.38);cursor:pointer}.pin[data-v-ff1c039c] :after{position:absolute;top:100%;left:50%;content:" ";height:0;width:0;border:16pxrem solid transparent;border-top-color:#f25621;margin-left:-.3125rem/16pxrem}.pin.active[data-v-ff1c039c],.pin[data-v-ff1c039c]:active,.pin[data-v-ff1c039c]:hover{background:#31363f}.pin.active[data-v-ff1c039c] :after,.pin[data-v-ff1c039c]:active :after,.pin[data-v-ff1c039c]:hover :after{border-top-color:#31363f}.pin .rating[data-v-ff1c039c]{background:#fff;padding:.25rem .5rem;color:#f25621;border-radius:.25rem;text-align:center;margin-right:.5rem}.pin .price[data-v-ff1c039c],.pin .rating[data-v-ff1c039c]{align-self:center;line-height:normal;font-weight:700}.pin .price[data-v-ff1c039c]{flex:1;color:#fff}',""]),t.exports=e},988:function(t,e,r){"use strict";var o=r(682);r.n(o).a},989:function(t,e,r){(e=r(7)(!1)).push([t.i,".no-results[data-v-61240b50]{flex:1;display:flex;justify-content:center;z-index:20}.no-results .panel[data-v-61240b50]{background:#fff;box-shadow:0 3px 12px rgba(0,0,0,.38);padding:2rem;border-radius:.5rem;text-align:center}.no-results .panel .title[data-v-61240b50]{color:#31363f;font-weight:700;margin-bottom:.5rem}.no-results .panel .message[data-v-61240b50]{color:#636c7e}",""]),t.exports=e}}]);