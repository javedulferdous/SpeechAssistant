var lazyLoadSearch=null,AsyncSkuList=function(e){this.clickedElem=null;return this.scrollBackUp=function(){if(performance&&window.requestAnimationFrame){var e=document.documentElement.scrollTop||document.body.scrollTop,i=.5*(e+0),n=e-i,s=performance.now();window.requestAnimationFrame(function e(){var t=(performance.now()-s)/300;1<t&&(t=1),window.scrollTo(0,i+n*Math.cos(t*Math.PI)),t<1&&window.requestAnimationFrame(e)})}else window.scrollTo(0)},this.updateContent=function(i,e){var t=this.generateEndpoint(i),n=this.cache.get(i);if(this.setLoadingState(!0),e||window.history.pushState({page:"current"},document.title,i),n)return setTimeout(function(){this.populateResults(n)}.bind(this),300);fetch(t,{credentials:"same-origin"}).then(function(e){e.text().then(function(e){var t=this.generateOrigin();return window.location.href.split(t)[1].split("#")[0]===(0==i.indexOf(t)?i.split(t)[1]:i)&&(-1==e.indexOf("productGroup")||0<e.indexOf("<head>")?(common_uielements.showAjaxLoadingOnBody({scrollTo:!1}),window.onpopstate=function(){},window.location.href=i):(this.populateResults(e),void this.cacheCurrentState()))}.bind(this))}.bind(this))},this.generateOrigin=function(){return window.location.protocol+"//"+window.location.hostname+(window.location.port?":"+window.location.port:"")},this.setLoadingState=function(e){e&&!this.el.classList.contains("is-loading")?(this.el.classList.add("is-loading"),common_uielements.showAjaxLoadingInsideElement(this.el)):e||(this.el.classList.remove("is-loading"),common_uielements.hideAjaxLoading()),this.scrollBackUp()},this.generateEndpoint=function(e){var t,i=e;return 0<e.indexOf("search.do")?i+"&async=true":(0<e.indexOf(";jsessionid")&&(t=";jsessionid"+i.split(";jsessionid")[1]),"/"==i[i.length-1]?i=i.replace(/.$/,"&async=true/"):t&&i.indexOf("?")<0?i=i.replace("?","?async=true&"):i+="&async=true",i)},this.clicksHandler=function(e){(e.target.classList.contains("js-refinement-link")||e.target.classList.contains("visual_refinement")||e.target.classList.contains("js-localBrowse-link")||e.target.classList.contains("js-refinement-checkbox"))&&this.refinementClick(e),e.target.classList.contains("js-refinement-toggle")&&this.toggleRefinementCollapse(e)},this.gtmEvent=function(){if(this.clickedElem&&this.clickedElem.nodeType){var e=this.clickedElem.closest("li");if(e&&window.dataLayer){var t=e.querySelector('input[name="cbxRefine"]'),i={refinementLink:"",refinementText:"",refinementCategory:"",refinementCbx:"",refinementCount:"",refinementChecked:!0,event:"refinementClick"};t&&(i.refinementLink=t.parentNode.href,i.refinementText=t.title,i.refinementCbx=t.value,i.refinementChecked=t.checked);var n=e.closest(".moduleStructContent");n&&(i.refinementCategory=n.previousElementSibling.textContent.trim());var s=e.querySelector(".refinement-label span");s&&(i.refinementCount=s.textContent.replace(/[()]/g,"").trim()),window.dataLayer.push(i)}}},this.refinementClick=function(e){var t=!1;e.target.classList.contains("js-refinement-checkbox")?(checkbox=e.target,link=e.target.parentNode,e.preventDefault(),t=!0):(e.target.classList.contains("js-refinement-link")||e.target.classList.contains("js-localBrowse-link")||e.target.classList.contains("js-async-paging"))&&(e.preventDefault(),link=e.target,checkbox=link.querySelector("input"),t=!0,checkbox&&(checkbox.checked=!checkbox.checked)),t&&(this.clickedElem=e.target,this.updateContent(link.href))},this.toggleRefinementCollapse=function(e){var t=e.target;t.classList.contains("accOpen")?(t.classList.remove("accOpen"),t.classList.add("accClosed")):t.classList.contains("accClosed")&&(t.classList.remove("accClosed"),t.classList.add("accOpen"))},this.populateResults=function(e){var t;return e?(this.el.innerHTML=e,this.el.dispatchEvent(this.events.contentUpdate),this.currentPath=window.location.href.indexOf("#")?window.location.href.split("#")[0]:window.location.href,this.gtmEvent(),appendAsyncSubscrbtionLightBox(),lazyLoadSearch.update(),"function"==typeof window.initializeReactAppProductsZone&&window.initializeReactAppProductsZone(),"function"==typeof window.initializeReactAppCriteoCarousel&&window.initializeReactAppCriteoCarousel(),this.setLoadingState(!1)):(t=this.cache.get(window.location.href))&&"false"!=t?(this.currentPath=window.location.href.indexOf("#")?window.location.href.split("#")[0]:window.location.href,this.el.innerHTML=t,this.el.dispatchEvent(this.events.contentUpdate),this.gtmEvent(),lazyLoadSearch.update(),this.setLoadingState(!1)):(lazyLoadSearch.update(),this.gtmEvent(),this.updateContent(window.location.href,!0))},this.switchPage=function(){if((window.location.href.indexOf("#")?window.location.href.split("#")[0]:window.location.href)==this.currentPath)return!1;this.setLoadingState(!0),this.populateResults()},this.bindEvents=function(){return this.el.addEventListener("click",this.clicksHandler.bind(this)),this.el.addEventListener("skuList.redirect",this.redirect.bind(this),!0),this.el.addEventListener("skuList.redefine",this.redefine.bind(this),!0),window.onpopstate=this.switchPage.bind(this),this},this.redefine=function(e){var t=this.el.querySelector("#refinementForm"),i=window.location.href,n=i.split("?")[0];if(-1!==i.indexOf("/a/browse/")){i=(i=i.replace(/lowerBound=(.*)&/,"")).replace(/upperBound=(.*)[&\/]/,"");var s="&lowerBound="+document.getElementById("lowerBound").value+"&upperBound="+document.getElementById("upperBound").value+"/";new RegExp(i+"$").test("/")&&(i=i.slice(0,-1)),this.redirect(i.slice(0,-1)+s)}else this.redirect(n+"?"+$(t).serialize())},this.redirect=function(e){var t="string"==typeof e?e:e.detail.target;return!!t&&(this.updateContent(t),this)},this.createCustomEvents=function(){return this.events={contentUpdate:new CustomEvent("skuList.contentUpdate")},this},this.cacheCurrentState=function(){this.cache.get(window.location.href)||(this.currentPath=window.location.href.indexOf("#")?window.location.href.split("#")[0]:window.location.href,this.settings.cache&&this.cache.set(window.location.href,this.el.parentNode.innerHTML))},this.init=function(e){return this.settings=e.el.getAttribute("data-settings")||{},this.el=e.el,this.settings.cache=void 0!==this.settings.cache&&this.cache.undefined,!(!window.history||!window.history.pushState)&&(this.id="asyncList",this.cache=new LocalStorageCache({id:this.id}),this.cacheCurrentState(),this.createCustomEvents().bindEvents())},this.init(e)};function appendAsyncSubscrbtionLightBox(){var e=document.getElementById("content"),t=document.createElement("script");t.type="text/javascript",t.innerText="var subscriptionLightbox = document.getElementById('SubscriptionLightbox');if (subscriptionLightbox) {$('[name$=\"].qty\"]').each(function(k,  v){$(v).on('change', function(){var addedSkus = 0;var qtyBoxes = document.querySelectorAll('[name$=\"].qty\"]');qtyBoxes.forEach(function(qtyBox) {if(qtyBox.value && qtyBox.value > 0) {addedSkus += 1;}});if(addedSkus != 1) {$('#SubscriptionLightbox').attr('id', 'SubscriptionLightboxDisabled')} else {$('#SubscriptionLightboxDisabled').attr('id', 'SubscriptionLightbox')}});});}",e.appendChild(t)}document.addEventListener("DOMContentLoaded",function(){lazyLoadSearch=new LazyLoad({elements_selector:".lazy-loading-js"});for(var e=document.querySelectorAll(".js-module-asyncSkuList"),t=0;t<e.length;t++)new AsyncSkuList({el:e[t].parentNode})});