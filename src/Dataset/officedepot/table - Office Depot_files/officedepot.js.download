(function(m,f){"object"===typeof module&&"object"===typeof module.exports?module.exports=m.document?f(m):function(v){if(!v.document)throw Error("TagDeliveryContent requires a window with a document");return f(v)}:f(m)})("undefined"!==typeof window?window:this,function(m){var f={GLOBAL_NAME:"TagDeliveryContent",HOST:"ad.tagdelivery.com",PROTOCOL:"https://",MAP_KEY:"_m",RETRY:1250,TIMEOUT:7E3,LOADED:!1,requestCount:0,requestMap:{},callbacks:{},isLoaded:function(){return f.LOADED},onLoadHandler:function(d){f.LOADED=
!0;f.log("Page Loaded")}};m.addEventListener?m.addEventListener("load",f.onLoadHandler):m.attachEvent("onload",f.onLoadHandler);f.log=function(){this.Log.add.apply(this.Log,[].slice.call(arguments))};f.request=function(d,a){var b=new this.Request(d,a);this.requestMap[b.id]=b;b.send();this.requestCount++;return b.id};f.Util=function(){var d={};d.head=document.head||document.getElementsByTagName("head")[0];d.generateUuid=function(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(a){var b=
16*Math.random()|0;return("x"==a?b:b&3|8).toString(16)})};d.attachScript=function(a,b){var c=document.createElement("script");"function"==typeof b&&(c.onerror=b);c.type="text/javascript";this.head.appendChild(c);c.src=a;return c};d.getType=function(a){var b=typeof a;"object"==b&&"[object Array]"===Object.prototype.toString.call(a)&&(b="array");return b};d.isArray=function(a){return"[object Array]"==Object.prototype.toString.call(a)};d.isObject=function(a){return"[object Object]"==Object.prototype.toString.call(a)};
d.isEmptyObject=function(a){for(var b in a)if(a.hasOwnProperty(b))return!1;return!0};d.arrayToQueryString=function(a){for(var b=[],c=0,e=a.length;c<e;c++){var g=a[c];"string"===typeof g?b.push(a[c].replace(/,/g,"%2C")):"number"===typeof g&&b.push(a[c])}return b.join(",")};d.objectToQueryString=function(a){var b=[],c;for(c in a)if(null!==a[c]){var e=this.getType(a[c]);e="array"==e&&0<a[c].length?this.arrayToQueryString(a[c]):"object"==e?encodeURIComponent(this.objectToQueryString(a[c])):encodeURIComponent(a[c]);
b.push(c+"="+e)}return b.join("&")};d.inArray=function(a,b){for(var c=0,e=a.length;c<e;c++)if(a[c]===b)return!0;return!1};d.getStyle=function(a){for(var b=document.styleSheets[0].rules||document.styleSheets[0].cssRules,c=0;c<b.length;c++)b[c].selectorText==a&&(b[c].cssText?alert(b[c].cssText):alert(b[c].style.cssText))};d.formatPrice=function(a,b,c){"string"!==typeof b&&(b="USD");return Number(a).toLocaleString(c,{style:"currency",currency:b})};d.shouldRender=function(a){for(var b=!1,c=0;c<a.length;c++)if(a[c].sponsored){b=
!0;break}return b};d.validateSponsoredCount=function(a){var b=0;if(f.Util.isArray(a))for(var c=0,e=a.length;c<e;c++)a[c].sponsored&&b++;else b+=a.sponsored?1:0;return b};d.decodeHtml=function(a){var b=document.createElement("textarea");b.innerHTML=a;return b.value};d.convertToTitleCase=function(a){return a.toLowerCase().replace(/^(.)|\s(.)/g,function(b){return b.toUpperCase()})};d.mergeObjects=function(){for(var a={},b=0;b<arguments.length;b+=1)for(var c=arguments[b],e=Object.keys(c),g=0;g<e.length;g+=
1)a[e[g]]=c[e[g]];return a};d.containsAny=function(a,b){return a.filter(function(c){return-1<b.indexOf(c)})};d.filterTargets=function(a,b){return a.filter(function(c){return 0>b.indexOf(c)})};d.crossTargetEach=function(a,b){var c=d.containsAny(a,b);if(0<c.length){c=d.filterTargets(a,c);for(var e=0;e<c.length;e++)b.push(c[e])}return b};d.deduplicateArray=function(a){var b=[];(new Set(a)).forEach(function(c){b.push(c)});return b};return d}();f.Log=function(){return{entries:[],toConsole:!1,add:function(){var d=
[].slice.call(arguments);d.unshift(new Date);this.entries.push(d);this.toConsole&&this.print(d)},print:function(d){d=d.slice(0);d[0]=d[0].toTimeString().substr(0,8)+"."+("000"+d[0].getMilliseconds()).substr(-3);d.unshift(f.GLOBAL_NAME);try{console.log.apply(console,d)}catch(a){}}}}();f.Template=function(){var d={templates:{},attachStylesheet:function(a){var b=document.createElement("link");b.rel="stylesheet";b.href=a;f.Util.head.appendChild(b)},attachCss:function(a){var b=document.createElement("style");
b.type="text/css";b.innerHTML=a;f.Util.head.appendChild(b)},apply:function(a,b){return d.templates.hasOwnProperty(a)?d.templates[a](b):""}};return d}();f.Template.templates.css=function(d){return".promote_desktop_product_label { color: darkorange; text-align: right;}.mobile_shelf_heading { color: black; margin: 10px 0px 0px 10px; font-size: 18px; font-weight: bold;}.prod-tile.rr_sku_details { margin: 10px 0px 10px 0px; text-align: center;}.mobile_in_grid_product_label { font-size: .875rem; color: darkorange; margin-bottom: 5px}.rr_zones_v2.promote-iq>form>ul { margin-left: 5%;}.rr_zones_v2.promote-iq>ul { margin-left: 4%;}#matrixBlocks>div.rr_zones_v2.promote-iq>form>ul { margin-left: 3%;}@media only screen and (max-width: 1210px) { .promote-iq>div.rr_zones_v2.promote-iq>ul>li:nth-child(3) { display: none; }}"};
f.Template.templates.headline_shelf=function(d){return'<div style="'+d.logoContainerStyle+'"> <img style="'+d.logoStyle+'" src="'+d.logo+'"> '+d.message+"</div>"};f.Pub=function(){var d={};f.Util.attachScript=function(a,b){var c=document.createElement("script"),e=document.body||document.getElementsByTagName("body")[0];"function"==typeof b&&(c.onerror=b);c.type="text/javascript";c.async=!0;e.appendChild(c);c.src=a;return c};d.prepareDefaultResponse=function(a){return{product_id:null,request_id:a.id,
sponsored:!1,impression_tracker:null,click_tracker:null,product:null}};d.modifyResponse=function(a,b){for(var c=[],e=0,g=b.length;e<g;e++)b[e].sponsored&&c.push(b[e]);return c};d.ctr={};d.utils={};d.pdpSpecialContractBrands=["HP","Canon","Epson","Brother"];d.utils.substituteOdAppSerialize=function(a){var b=[],c;for(c in a)a.hasOwnProperty(c)&&b.push(c+"="+a[c]);return b.join("&")};d.utils.substituteOdAppAppendSessionId=function(a,b){if("undefined"!==typeof a&&null!==a&&"undefined"!==typeof h&&!h){if("undefined"===
typeof b&&-1<a.indexOf("jsessionid")||!b&&-1<a.indexOf("jsessionid"))return a;var c=";jsessionid="+aI+":"+al;a=-1<a.indexOf("?")?a.replace("?",c+"?"):a+c}return a};d.utils.checkDuplicateCreatives=function(a){for(var b=[],c=[],e=0;e<a.length;e++)-1===b.indexOf(a[e].product_id)&&(c.push(a[e]),b.push(a[e].product_id));return c};getTotalResults=function(){if(m.totalResults){var a=3*Math.floor(m.totalResults/3);return 18<a?18:a}};getSearchCountFill=function(){if(m.totalResults){var a=Math.floor(m.totalResults/
3);return 6<a?6:a}};d.sizeMap={subCategoryShelfDesktop:{slot:1290,count:32,count_fill:4,attachTo:"#featuredMatrix"},browsePageShelfDesktop:{slot:1500,count:10,count_fill:4,attachTo:"#navSearch > div:nth-child(9)"},storelocatorShelfDesktop:{slot:1505,count:30,count_fill:5,attachTo:"#main-container > div > div:nth-child(2) > div.section-seo-content.od-section.mt--1.hide-on-print.hide-mobile"},inGridDesktop:{slot:1300,count:24,count_fill:12,interval:3},mobileHomepageShelf:{slot:1495,count:24,count_fill:3,
attachTo:"#mainContent > div.od-app-rr-zone"},inGridMobile:{slot:1315,count:16,count_fill:2},mobileShelf:{slot:1330,count:24,count_fill:3,attachTo:"#mainContent > div.od-app-rr-zone"},pdpMobileShelf:{slot:1325,count:24,count_fill:3,attachTo:"#skuInformation"},mobileDealsPage:{slot:1320,count_fill:6,count:24,attachTo:".mobileAdList.line_top"},pdpDesktopShelf:{slot:1295,count:40,count_fill:5,attachTo:"#od-app-bought-together"},home:{slot:1280,count:40,count_fill:5,attachTo:"#mccContainer > div:nth-child(2) > div > div:nth-child(2)"},
inGridSearchDesktop:{slot:1460,count:getTotalResults(),count_fill:getSearchCountFill()},desktopDealsPage:{slot:1475,count:32,count_fill:4,attachTo:"#cm-placement-main > div:nth-child(8)"},headline:{slot:1490,count:50,count_fill:3,attachTo:"#navSearch > div:nth-child(3)"},BTSDesktop:{slot:10010,count:10,count_fill:5,attachTo:".piq-pla-shelf"},BTSMobile:{slot:10015,count:10,count_fill:6,attachTo:".piq-pla-shelf"}};d.rendered={};d.desktopDevices=["Desktop","Tablet"];d.parentRefsToNotTarget="553234 1142339 603081 690288 697982 877323 905644 905760 966572 966592 967943 971469 1021727 1021700 1030636 1030616 1030627 1030654 1030663 1035667 1035693 1040420 1040474 1128084 1128055 1128071 1131221 1159740 1205527 1214621 1214632 362376 362410 362457 394774 876 6201 11332 527435 527637 533110 538744".split(" ");
d.ctr.render=function(a){if(!d.parentRefsToNotTarget.includes(a.nValue)){var b=d.evaluatePage(a),c=d.evaluateTargeting(b,a);if("headline"===b)d.apiRequest(c,"browsePageShelfDesktop");else if("inGridDesktop"===b){var e=d.evaluateTargeting("browsePageShelfDesktop",a);c&&d.apiRequest(c,b,a);d.apiRequest(e,"browsePageShelfDesktop",a)}else if("inGridMobile"===b)e=d.evaluateTargeting("mobileShelf",a),d.apiRequest(c,b,a),d.apiRequest(e,"mobileShelf",a);else return d.apiRequest(c,b,a)}};d.evaluatePage=function(a){var b=
a.siteType,c=a.pageName,e={"top-deals":{Desktop:"desktopDealsPage",Tablet:"desktopDealsPage"},home:{Desktop:"home",Tablet:"home"},basehome:{Mobile:"mobileHomepageShelf"},storelocator:{Desktop:"storelocatorShelfDesktop"},baseskupage:{Mobile:"pdpMobileShelf"},catalogcatalogSku:{Desktop:"pdpDesktopShelf",Tablet:"pdpDesktopShelf"},catalogsearch:{Desktop:"inGridDesktop",Tablet:"inGridDesktop"}};if(["/a/browse/school-supplies/N=5+502600/","/a/browse/teacher-resources/N=5+1186205/","/cm/marketing/learn-from-anywhere-solutions",
"/cm/school-supplies/quicklist","/cm/school-supplies/back-to-school"].includes(a.path))return"Desktop"===b?"BTSDesktop":"BTSMobile";if(c in e&&b in e[c]){if("catalogsearch"!==c||""!==a.department)return e[c][b]}else{if(d.desktopDevices.includes(b))return"subCategoryShelfDesktop";if("Mobile"===b)return 0<document.querySelectorAll(".sku_pricing_v2").length?"inGridMobile":"mobileShelf"}};d.evaluateTargeting=function(a,b){var c=b.pageName,e=b.path,g=b.nValue,k={category:[]};if(["home","storelocator"].includes(c))return{category:["home"]};
if("basehome"===c)return{category:["mobile_home"]};if("/a/browse/deal-center/N=5+549384/"===e||"desktopDealsPage"===a)return{category:["onSale"]};if("/catalog/search.do"===e){if("inGridDesktop"===a)return;if("browsePageShelfDesktop"===a)return{match_products:m.quickViewSkus[1]}}if("BTSDesktop"===a||"BTSMobile"===a)return k.category.push("1676","502600","530419"),k;"undefined"!==typeof g?k.category.push(g):["pdpMobileShelf","pdpDesktopShelf"].includes(a)||(c=e.split("N=")[1].replace(/\D/g,""),!1===
isNaN(parseInt(c))&&k.category.push(c));return["inGridDesktop","inGridMobile"].includes(a)?d.inGridCrossTargeting(k,b.category,b.department):d.getBreadcrumbTargeting(k,a,b)};d.inGridCrossTargeting=function(a,b,c){var e=[],g=a.category.slice(0);"Software"===b&&a.category.push("1462054");"Coffee & Coffee Supplies"===b&&a.category.push("1154872");(a.category.includes("1211750")||a.category.includes("1012437"))&&a.category.push("4009","1211748");"Laptop Computers"!==b&&"Desktop Computers"!==b||a.category.push("1462026",
"1461996","1461994","1462021","1462056");"Cleaning"===c&&a.category.push("1170285");(a.category.includes("509935")||a.category.includes("1462020")||a.category.includes("1462056"))&&a.category.push("1462064");a.category.includes("1462064")&&a.category.push("509935","1462056");(a.category.includes("1462020")||a.category.includes("1462056"))&&a.category.push("1462071");(a.category.includes("1677")||a.category.includes("1155045")||a.category.includes("516260"))&&a.category.push("1131206");a.category.includes("581718")||
a.category.includes("581709")||a.category.includes("1040455")?a.category.push("581709","590047"):(a.category.includes("581709")||a.category.includes("590047"))&&a.category.push("581718","581709","1040455");a.category.includes("509805")?a.category.push("509822","509829"):(a.category.includes("509822")||a.category.includes("509829"))&&a.category.push("509805");a.category.includes("509829")?a.category.push("509822","509805"):(a.category.includes("509822")||a.category.includes("509805"))&&a.category.push("509829");
a.category.includes("509806")?a.category.push("509822"):a.category.includes("509822")&&a.category.push("509806");a.category.includes("509806")?a.category.push("509807"):a.category.includes("509807")&&a.category.push("509806");a.category.includes("590502")?a.category.push("509806"):a.category.includes("509806")&&a.category.push("590502");a.category.includes("4546")||a.category.includes("4521")||a.category.includes("4561")||a.category.includes("4556")||a.category.includes("4566")||a.category.includes("1155088")||
a.category.includes("1155087")||a.category.includes("1155086")?a.category.push("4483","4510","4521","4561","4556","4566","1155083","1155086"):(a.category.includes("4483")||a.category.includes("4510")||a.category.includes("4521")||a.category.includes("4561")||a.category.includes("4556")||a.category.includes("4566")||a.category.includes("1155083")||a.category.includes("1155086"))&&a.category.push("4546","4521","4561","4556","4566","1155088","1155087","1155086");a.category.includes("1211740")||a.category.includes("1211741")||
a.category.includes("1211742")?a.category.push("593065","593063"):(a.category.includes("593065")||a.category.includes("593063"))&&a.category.push("1211740","1211741","1211742");0<f.Util.containsAny(a.category,["1170326","1170330","4420","4404","1155077"]).length&&a.category.push("4546","4521","4561","4556","4566","1155088","1155087","1155086");e.push("1155086 1155087 1155088 4521 4546 4556 4561 4566".split(" "));e.push("1461990 1461993 1461994 1461995 1462021 1462022 1462024 1462026 1462028".split(" "));
for(b=0;b<e.length;b++)a.category.push.apply(a.category,f.Util.crossTargetEach(e[b],g));a.category=f.Util.deduplicateArray(a.category);return a};d.getBreadcrumbTargeting=function(a,b,c){var e=c.category,g=c.department,k=[];var l=-1<d.desktopDevices.indexOf(c.siteType)?m.location.host.includes("www.")?document.querySelectorAll("#siteBreadcrumb > ol > li"):document.querySelectorAll("nav > ul > li"):document.querySelectorAll("#siteBreadcrumb > a");for(var n=0;n<l.length;n++)d.desktopDevices.includes(c.siteType)?
l[n].firstElementChild&&l[n].firstElementChild.href&&k.push(l[n]):k.push(l[n]);if(0<k.length)for(["pdpDesktopShelf","pdpMobileShelf"].includes(b)?l=1:["browsePageShelfDesktop"].includes(b)?(l=k.length-2,0>=l&&(l=1)):l=2;l<k.length;l++)a.category.push(d.parseTargetingReferenceFromBreadcrumb(k[l],c.siteType));return d.notInGridCrossTargeting(a,b,g,e)};d.parseTargetingReferenceFromBreadcrumb=function(a,b){if(d.desktopDevices.includes(b)){var c=a.firstElementChild.href.split("+")[1];return c.includes("/")?
c.split("/")[0]:c.split("&")[0]}return a.href.split("N=")[1].replace(/\D/g,"")};d.notInGridCrossTargeting=function(a,b,c,e){if("pdpDesktopShelf"===b||"pdpMobileShelf"===b||"subCategoryShelfDesktop"===b)"Office Supplies"===c&&a.category.push("668186","1418009","1123258","573494","536407","535970"),a.category.includes("593065")&&a.category.push("1302556"),"Office Machines"!==e&&"Electronics"!==c||a.category.push("553924","553925","654630","654631","509740","1176146"),"Laptop Computers"!==e&&"Desktop Computers"!==
e||a.category.push("1462056"),"Data Storage & Media"===e&&a.category.push("1123258"),a.category.includes("654426")&&a.category.push("1123258"),a.category.includes("1155081")&&a.category.push("1123258"),a.category.includes("1170314")&&a.category.push("1123258"),"Breakroom"===c&&a.category.push("1154874"),"Cleaning"===c&&a.category.push("1170285"),(a.category.includes("509935")||a.category.includes("1462020")||a.category.includes("1462056"))&&a.category.push("1462064"),a.category.includes("1462064")&&
a.category.push("509935","1462056"),(a.category.includes("1462020")||a.category.includes("1462056"))&&a.category.push("1462071"),(a.category.includes("1677")||a.category.includes("1155045")||a.category.includes("516260"))&&a.category.push("1131206"),a.category.includes("581718")||a.category.includes("581709")||a.category.includes("1040455")?a.category.push("581709","590047"):(a.category.includes("581709")||a.category.includes("590047"))&&a.category.push("581718","581709","1040455"),a.category.includes("4546")||
a.category.includes("4521")||a.category.includes("4561")||a.category.includes("4556")||a.category.includes("4566")||a.category.includes("1155088")||a.category.includes("1155087")||a.category.includes("1155086")?a.category.push("4483","4510","4521","4561","4556","4566","1155083","1155086"):(a.category.includes("4483")||a.category.includes("4510")||a.category.includes("4521")||a.category.includes("4561")||a.category.includes("4556")||a.category.includes("4566")||a.category.includes("1155083")||a.category.includes("1155086"))&&
a.category.push("4546","4521","4561","4556","4566","1155088","1155087","1155086"),a.category.includes("1211740")||a.category.includes("1211741")||a.category.includes("1211742")?a.category.push("593065","593063"):(a.category.includes("593065")||a.category.includes("593063"))&&a.category.push("1211740","1211741","1211742"),"School Supplies"===c&&a.category.push("4561","4566"),a.category.includes("509805")?a.category.push("509822","509829"):(a.category.includes("509822")||a.category.includes("509829"))&&
a.category.push("509805"),a.category.includes("509829")?a.category.push("509822","509805"):(a.category.includes("509822")||a.category.includes("509805"))&&a.category.push("509829"),a.category.includes("509806")?a.category.push("509822"):a.category.includes("509822")&&a.category.push("509806"),a.category.includes("509806")?a.category.push("509807"):a.category.includes("509807")&&a.category.push("509806"),a.category.includes("590502")?a.category.push("509806"):a.category.includes("509806")&&a.category.push("590502");
a.category=f.Util.deduplicateArray(a.category);return a};d.apiRequest=function(a,b,c){if(void 0!==b)return"inGridDesktop"===b&&d.determineCountAndCountFill(m.skuitem.length,b),f.request({slot:d.sizeMap[b].slot,targets:a,count:d.sizeMap[b].count,count_fill:d.sizeMap[b].count_fill},function(e){for(var g=[],k=0,l=e.length;k<l;k++)e[k].sponsored&&g.push(e[k].product_id);d.utils.checkPrices(g,e,b,c)})};d.determineCountAndCountFill=function(a,b){var c=d.sizeMap[b].count_fill,e=Math.floor(a/d.sizeMap[b].interval)+
1;e<c&&(e=c);d.sizeMap[b].count_fill=e;d.sizeMap[b].count=2*e};d.utils.checkPrices=function(a,b,c,e){if(0!==a.length){a={items:a,mapBySkuId:!0,pr:""};a=m.hasOwnProperty("odApp")&&Object.keys(odApp.utils).includes("appendSessionId")&&Object.keys(odApp.utils).includes("serialize")?odApp.utils.appendSessionId("/mobile/getAjaxPriceListFromService.do?"+odApp.utils.serialize(a)):d.utils.substituteOdAppAppendSessionId("/mobile/getAjaxPriceListFromService.do?"+d.utils.substituteOdAppSerialize(a));var g=new XMLHttpRequest;
g.open("GET",a);g.onload=function(){var k=JSON.parse(this.response).skuPriceList,l=[];if(!1===!!k)return null;var n=Object.keys(k),p=[];b.map(function(u){""!==u.product_id&&"sku"in e&&("undefined"===typeof e.sku||u.product_id!==e.sku)&&p.push(u.product_id)});b=b.filter(function(u){return-1!==p.indexOf(u.product_id)});var t=[];p.forEach(function(u){var x=!1;n=n.filter(function(y){if(x||y!==u)return!0;t.push(y);x=!0;return!1})});n=t;for(var r=0;r<n.length;r++)if(-1!==p.indexOf(n[r])){var q=k[n[r]],
w=b[p.indexOf(n[r])];q.impression_tracker=w.impression_tracker;q.click_tracker=w.click_tracker;q.sponsored=w.sponsored;q.landingPageUrl=w.product.landingPageUrl;q.taxonomy=w.product.taxonomy;q.shortDescription=f.Util.decodeHtml(q.shortDescription);q.brand=w.product.partnerRef;q.mediumImageUrl=q.mediumImageUrl.replace("t_medium","t_search");l.push(q)}d.triggerRender(l,c,e)};g.send(null)}};d.triggerRender=function(a,b,c){var e=a.length,g=a.filter(function(l){if("HP"===l.brand)return!0}),k="brand"in
c?c.brand:"";"headline"===b?2<=g.length&&d._render(g.splice(0,d.sizeMap[b].count_fill),b,c):["inGridMobile","inGridDesktop","inGridSearchDesktop"].includes(b)&&0<e?d.determineInGridResponseToRender(e,a,b,c,k):"home pdpMobileShelf mobileShelf desktopDealsPage mobileHomepageShelf BTSMobile".split(" ").includes(b)&&e>=d.sizeMap[b].count_fill?("pdpMobileShelf"===b&&d.pdpSpecialContractBrands.includes(k)&&(a=d.specialContractBrandCheck(k,a)),"desktopDealsPage"===b&&(a=d.checkSkuSaleStatus(a)),d._render(a.splice(0,
d.sizeMap[b].count_fill),b,c)):["subCategoryShelfDesktop","storelocatorShelfDesktop","browsePageShelfDesktop","pdpDesktopShelf","BTSDesktop"].includes(b)?d.determineShelfResponseToRender(e,a,b,k,c):"mobileDealsPage"===b&&3<=e&&(a=d.checkSkuSaleStatus(a),d._render(a.splice(0,e),b,c))};d.determineInGridResponseToRender=function(a,b,c,e,g){d.desktopDevices.includes(c)&&"Printers"===e.category&&""!==g&&(b=d.specialContractBrandCheck(m.dataLayer[1].product.brand,b),a=b.length);a>d.sizeMap[c].count_fill?
d._render(b.splice(0,d.sizeMap[c].count_fill),c,e):d._render(b,c,e)};d.determineShelfResponseToRender=function(a,b,c,e,g){"pdpDesktopShelf"===c&&d.pdpSpecialContractBrands.includes(e)&&(b=d.specialContractBrandCheck(m.dataLayer[0].brand,b),a=b.length);a>=d.sizeMap[c].count_fill?d._render(b.splice(0,d.sizeMap[c].count_fill),c,g):"pdpDesktopShelf"===c&&1<=a?d._render(b.splice(0,a),c,g):a===d.sizeMap[c].count_fill-1&&d._render(b.splice(0,d.sizeMap[c].count_fill-1),c,g)};d.specialContractBrandCheck=function(a,
b){var c=d.pdpSpecialContractBrands.indexOf(a),e=d.pdpSpecialContractBrands;e.splice(c,1);return b.filter(function(g){var k=g.brand;"HP"!==k&&(k=g.brand.toLowerCase(),k=k.charAt(0).toUpperCase()+k.slice(1));return!e.includes(k)})};d.reformatCreative=function(a,b,c){a.caption=null;a.product={};a.product.priceListFormatted=a.retailPrice;a.product.priceCurrentFormatted=a.sellPrice;"headline"===b&&(a.product.place=void 0===c?null:c,a.product.ratingPercent=parseInt(a.rating)/5/2*100);return a};d.applyCSS=
function(a){var b=m.location.pathname;"headline"===a&&($("#myOfficeBtn").click(function(){null===document.querySelector("#myOfficeToolbar")||document.querySelector("#myOfficeToolbar").className.includes("hide")?$(".promote-iq > div.rr_zones_v2.promote-iq > ul > li:nth-child(3)").hide():setTimeout(function(){$(".promote-iq > div.rr_zones_v2.promote-iq > ul > li:nth-child(3)").show()},400)}),f.Template.attachCss(".rr_zones_v2.promote-iq > ul > li {margin-right:auto;}"));"home"===a&&"/"===b&&f.Template.attachCss(".rr_zones_v2.promote-iq>form>ul {flex-direction: row;max-width: 1688px;display: flex; flex-wrap: nowrap; margin: 0 auto;}.rr_zones_v2.promote-iq>form>ul>li {width: 320px;}")};
d.checkSkuSaleStatus=function(a){return a.filter(function(b){return b.globalPrice.retailPrice>b.globalPrice.sellPrice})};d._render=function(a,b,c){if(0!==a.length&&!d.rendered.hasOwnProperty(b)){d.rendered[b]=!0;f.Util.isArray(a)||(a=[a]);f.Template.attachCss(f.Template.apply("css"));if(d.sizeMap[b].attachTo){var e=document.querySelectorAll(d.sizeMap[b].attachTo);if("mobileDealsPage"===b){var g=[];g.push(e[3]);g.push(e[7])}else if(void 0===e||null===e||0===e.length)if("headline"===b)var k=void 0;
else{f.log("Current attachment point does not exist");return}else k=e[0]}d.applyCSS(b);if("headline"===b)d.appendHeadlineTemplateToClient(a,k);else if("mobileDealsPage"===b)if(6>a.length)d.appendMobileTemplateToClient(a.splice(0,3),b,k[0]);else for(c=0;c<k.length;c++)d.appendMobileTemplateToClient(a.splice(0,3),b,k[c]);else b.includes("inGrid")?"Mobile"===c.siteType?d.appendInGridMobileToClient(a,b):d.desktopDevices.includes(c.siteType)&&d.appendInGridDeskTopToClient(a):"Mobile"===c.siteType?d.appendMobileTemplateToClient(a,
b,k):d.appendTemplateToClient(a,b,k)}};d.createDesktopHandlebarContext=function(a){for(var b=[],c={},e=0;e<a.length;e++){var g=a[e];b.push({sku:g.skuId,url:g.click_tracker+g.landingPageUrl});c[g.skuId]=g}return{skuList:b,priceList:c}};d.appendHeadlineTemplateToClient=function(a,b){b="#navSearch > div.section.ref_styleV2";var c=document.createElement("div");c.className="promote-iq";c.style="display: inline-flex;";c.innerHTML+=f.Template.apply("headline_shelf",{logo:void 0,message:void 0,logoStyle:"",
logoContainerStyle:void 0});var e=d.createDesktopHandlebarContext(a);e=odApp.utils.hbs("rrZoneItem",{priceList:e.priceList,skuList:e.skuList,direction:"horizontal",showAtc:!1,showSeedSku:!1,seedSku:!1,isBTG:!1,cmATCSource:"homepage",loggedIn:"undefined"!==typeof userIsLoggedIn&&userIsLoggedIn,matchesPresent:!1});var g=document.createElement("div");g.className="rr_zones_v2 promote-iq";g.append(document.createRange().createContextualFragment(e));c.append(g);$(b).append(c);odApp.ui.master.setStarRating();
new LazyLoad({elements_selector:".rr_zones_v2.promote-iq > ul > li > a > img"});c=document.querySelector(".promote-iq > div.rr_zones_v2.promote-iq > ul > li:nth-child(3) > a > img");null===document.querySelector("#myOfficeToolbar")||document.querySelector("#myOfficeToolbar").className.includes("hide")?null!=c&&(c.className+="b-loaded"):null!=c&&(c.className+="b-loaded",c.src=c.dataset.src)};d.appendMobileTemplateToClient=function(a,b,c){for(var e=0;e<a.length;e++)a[e].rating=50*Math.round(parseInt(a[e].rating)/
5/2*1E3/50),a[e].priceBeginning=a[e].sellPrice.slice(1,-3),a[e].priceEnd=a[e].sellPrice.slice(-2),a[e].skuUrl=a[e].landingPageUrl;a={priceList:a};e=$("#mProductListTpl").html();a=Handlebars.compile(e)(a);d.checkIfElementAlreadyAttachedToDom("promote-iq.rr_layout1",b)?f.log("Element already on DOM"):$(document.createRange().createContextualFragment(a)).insertAfter(c);if(["mobileHomepageShelf","mobileDealsPage"].includes(b))for(b=document.querySelectorAll(".promote-iq .prod-tile a"),c=0;c<b.length;c++)b[c].setAttribute("data-rrllink",
"https://data.tagdelivery.com/pixel.gif")};d.appendTemplateToClient=function(a,b,c){a=d.createDesktopHandlebarContext(a);a={priceList:a.priceList,skuList:a.skuList,rrHeading:"Sponsored Products",direction:"horizontal",showAtc:!0,showSeedSku:!1,seedSku:!1,isBTG:!1,cmATCSource:"homepage",loggedIn:"undefined"!==typeof userIsLoggedIn&&userIsLoggedIn,matchesPresent:!0};"subCategoryShelfDesktop pdpDesktopShelf browsePageShelfDesktop storelocatorShelfDesktop BTSDesktop BTSMobile".split(" ").includes(b)&&
(a.showAtc=!1);document.getElementById("unifiedPriceTpl")&&console.log("PIQ - template exists");b=odApp.utils.hbs("rrZoneItem",a);a=document.createElement("div");a.className="rr_zones_v2 promote-iq";$(a).insertAfter(c);a.append(document.createRange().createContextualFragment(b));odApp.ui.master.setStarRating();new LazyLoad({elements_selector:".promote-iq .rr_product.v3_buttons img"})};d.appendInGridMobileToClient=function(a,b){for(var c=document.querySelectorAll(".sku_column"),e=1,g=a.length,k=0,
l=0;l<a.length;l++)a[l].rating=50*Math.round(parseInt(a[l].rating)/5/2*1E3/50);for(;0!==g;){var n=c[e].dataset.skunumber,p=c[e+1].dataset.skunumber;l=a[k];l.skuUrl=l.landingPageUrl;l.skuId===n||l.skuId===p?k+=1:(l.tileTitle="Sponsored",n=$("#mProductTileTpl").html(),l=Handlebars.compile(n)(l),d.checkIfElementAlreadyAttachedToDom(".promote_mobile_grid",b)?f.log("Element already on DOM"):($(l).insertAfter(c[e]),l=$(".promote-iq-cart")[0],l.className.includes("promote-iq-cart")&&l.addEventListener("click",
function(t){var r=new Image;r.src=t.target.dataset.promoteClick+"https://cdn.tagdelivery.com/pixel.gif";r.style="display:none;";document.body.appendChild(r)},!1),e+=2,a.splice(k,1),--g,k=0))}};d.appendInGridDeskTopToClient=function(a){for(var b=0;b<a.length;b++)a[b].mediumImageUrl=a[b].mediumImageUrl.replace("Med","Search");b=document.querySelectorAll(".gw3.omega.sku_item");var c=a.shift();if(1<=a.length)for(var e=0,g=function(t){return 0< !!t.getElementsByClassName("item_sku").length?t.getElementsByClassName("item_sku")[0].children[0].value:
"noSku"};0<a.length;){var k=1+2*e,l=1*(e+1),n=g(b[l-1]);l=g(b[l]);var p=a.shift();(p.skuId===n||p.skuId===l)&&0<a.length?a.splice(1,0,p):(e<d.sizeMap.inGridDesktop.count_fill-1&&d.inGridDesktopInsert(b,p,k),e++)}d.inGridDesktopInsert(b,c,0);d.reflowInGridDesktop();$(m).bind("hashchange",function(t){f.log("Location hashchange detected");d.reflowInGridDesktop()})};d.inGridDesktopInsert=function(a,b,c){b.tileTitle="Sponsored";b.placeInGrid=c;b.rating=parseInt(10*b.rating);b.skuUrl=b.landingPageUrl;b=
odApp.utils.hbs("productTileTpl",b);b=(new DOMParser).parseFromString(b,"text/html").children[0].children[1].children[0];a=$(b).insertBefore(a[c]);odApp.ui.master.setStarRating();a.find(".promote-iq-cart").get(0).addEventListener("click",function(e){var g=new Image;g.src=e.target.dataset.promoteClick+"https://cdn.tagdelivery.com/pixel.gif";g.style="display:none;";document.body.appendChild(g)},!1)};d.reflowInGridDesktop=function(){for(var a=document.querySelectorAll(".gw3.omega.sku_item"),b=0;b<a.length;b++){var c=
a[b],e=c.className.match(/(^| )(n\d+)/);e&&$(c).removeClass(e[2]);$(c).addClass("n"+(b%24).toString())}a=document.querySelectorAll(".gw3.omega.sku_item:not(.result_ad_placement)");console.log(a);b=["id","name"];for(c=0;c<a.length;c++){e=a[c].getElementsByTagName("input");for(var g=0;g<e.length;g++)for(var k=0;k<b.length;k++){var l=b[k];""!==e[g][l]&&(e[g][l]=e[g][l].replace(/\d+/,c))}}};d.checkIfElementAlreadyAttachedToDom=function(a,b){var c=document.querySelectorAll(a);return["inGridDesktop","inGridSearchDesktop"].includes(b)&&
6<=c.length||"subCategoryShelfDesktop mobileShelf pdpMobileShelf pdpDesktopShelf home mobileDealsPage".split(" ").includes(b)&&1<=c.length||"inGridMobile"===b&&2<=c.length?!0:!1};return d}();f.Request=function(){return function(d,a){this.id=f.Util.generateUuid();this.inputs=null;this.parameters={targets:null,slot:null,deferred:null,batch:null,pos:null,format:null,width:null,height:null,callback:null,passthru:null,template:null,count:null,count_fill:null,attributes:null,url:null};this.callback=a;this.timeoutRef=
{};this.retryAfter=f.RETRY;this.timeLeft=f.TIMEOUT;this.numTries=0;this.locked=!1;this.active=!0;this.map=!1;this.baseUrl=f.PROTOCOL+f.HOST+"/request?";this.url=null;this.requestedAt=+new Date;this.renderedAt=this.returnedAt=this.receivedAt=this.sentAt=null;f.log("received request",this.id,this.inputs);this.applyInputs=function(b){if("object"==typeof b){this.inputs=f.Util.mergeObjects(b);for(var c in b)this.parameters.hasOwnProperty(c)&&(this.parameters[c]=b[c])}else this.inputs=b};this.applyInputs(d);
this.modifyForPub=function(){if("function"==typeof f.Pub.modifyRequest){var b=f.Pub.modifyRequest(this);if("object"==typeof b)for(var c in b)"inputs"!==c&&(this[c]=b[c])}};this.getCallbackKey=function(){return"_"+this.id.replace(/-/g,"_")};this.registerCallback=function(){var b=this.getCallbackKey();null===this.parameters.callback&&(this.parameters.callback=[f.GLOBAL_NAME,"callbacks",b].join("."));var c=this.id;f.callbacks[b]=function(e){f.requestMap[c].processResponse(e)}};this.setRetryTime=function(b){this.timeLeft=
b||f.TIMEOUT;this.retryAfter=Math.min(this.timeLeft||this.retryAfter,f.RETRY)};this.setRetry=function(){var b=this;this.timeoutRef=setTimeout(function(){0>=b.timeLeft?b.cancel():f.isLoaded()?(f.log("resending after",b.id,+new Date-b.requestedAt),b.numTries++,b.cancel()):(f.log("Pseudo timeout during loading",b.id,b.url),b.setRetry())},b.retryAfter||f.RETRY);f.isLoaded()&&(this.retryAfter=Math.min(this.retryAfter,this.timeLeft),this.timeLeft-=this.retryAfter)};this.noRetry=function(){clearTimeout(this.timeoutRef)};
this.setUrl=function(){"function"==typeof f.Pub.buildUrl?this.url=f.Pub.buildUrl(this):this.map&&!this.inputs.hasOwnProperty(f.MAP_KEY)?this.url="function"==typeof f.Pub.getMapRequest?f.Pub.getMapRequest(this):"https://tools.tagdelivery.com/requests/map?request="+encodeURIComponent(JSON.stringify({id:this.id,parameters:this.parameters})):this.url=this.baseUrl+f.Util.objectToQueryString(this.parameters)};this.send=function(){this.locked||(this.modifyForPub(),this.setRetryTime(),this.locked=!0);if(this.active){this.setRetry();
this.registerCallback();this.setUrl();this.sentAt=+new Date;var b=this,c=f.Util.attachScript(this.url,Function.prototype.bind?this.cancel.bind(this):function(){b.cancel()});c.parentNode.removeChild(c);f.log("url called after",this.id,this.sentAt-this.requestedAt,this.numTries,this.url)}};this.processResponse=function(b){0!==b.length&&b?(this.noRetry(),this.receivedAt=+new Date,"function"==typeof f.Pub.modifyResponse&&(b=f.Pub.modifyResponse(this,b))):(this.returnedAt=+new Date,this.renderedAt=+new Date,
f.log("empty/null/undefined response",this.id,this.returnedAt-this.returnedAt,b));this.respond(b)};this.cancel=function(){this.active=!1;clearTimeout(this.timeoutRef);f.log("cancelled request",this.id);var b=f.Pub.prepareDefaultResponse(this);if(null!==this.parameters.count&&1!=this.parameters.count){for(var c=[],e=0,g=this.parameters.count;e<g;e++)c.push(b);this.respond(c)}else this.respond(b)};this.respond=function(b){this.returnedAt=+new Date;f.log("closing request",this.id,this.returnedAt-this.receivedAt,
b);this.callback(b);this.renderedAt=+new Date;f.log("callback finished",this.id,this.renderedAt-this.receivedAt,this.renderedAt-this.returnedAt)};this.update=function(b){f.log("updating request",this.id);"function"==typeof f.Pub.applyMapResponse?(f.Pub.applyMapResponse(this,b),this.inputs[f.MAP_KEY]=1,this.map=!1,this.noRetry(),this.send()):this.applyInputs(b);this.locked=!1;this.map&&this.inputs.hasOwnProperty(f.MAP_KEY)&&(this.noRetry(),this.send())}}}();"function"===typeof define&&define.amd&&
define("tagDeliveryContent",[],function(){return f});m[f.GLOBAL_NAME]=f;f.hasOwnProperty("Pub")&&"object"===typeof f.Pub&&f.Pub.hasOwnProperty("GLOBAL_NAME")&&f.GLOBAL_NAME!=f.Pub.GLOBAL_NAME&&(m[f.Pub.GLOBAL_NAME]=f);if(m.hasOwnProperty("TagDeliveryQueue"))for(var v=0;v<m.TagDeliveryQueue.length;v++)"Pub.ctr.renderShelf"==m.TagDeliveryQueue[v]&&m[f.GLOBAL_NAME].Pub.ctr.renderShelf();String.prototype.includes||(String.prototype.includes=function(d,a){"number"!==typeof a&&(a=0);return a+d.length>this.length?
!1:-1!==this.indexOf(d,a)});Array.prototype.includes||Object.defineProperty(Array.prototype,"includes",{enumerable:!1,value:function(d){return 0<this.filter(function(a){return a==d}).length}});return f});