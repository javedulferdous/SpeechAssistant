!function(global,factory){"object"==typeof module&&"object"==typeof module.exports?module.exports=global.document?factory(global,!0):function(w){if(!w.document)throw new Error("jQuery requires a window with a document");return factory(w)}:factory(global)}("undefined"!=typeof window?window:this,function(window,noGlobal){function isArrayLike(obj){var length=!!obj&&"length"in obj&&obj.length,type=jQuery.type(obj);return"function"===type||jQuery.isWindow(obj)?!1:"array"===type||0===length||"number"==typeof length&&length>0&&length-1 in obj}function winnow(elements,qualifier,not){if(jQuery.isFunction(qualifier))return jQuery.grep(elements,function(elem,i){return!!qualifier.call(elem,i,elem)!==not});if(qualifier.nodeType)return jQuery.grep(elements,function(elem){return elem===qualifier!==not});if("string"==typeof qualifier){if(risSimple.test(qualifier))return jQuery.filter(qualifier,elements,not);qualifier=jQuery.filter(qualifier,elements)}return jQuery.grep(elements,function(elem){return indexOf.call(qualifier,elem)>-1!==not})}function sibling(cur,dir){for(;(cur=cur[dir])&&1!==cur.nodeType;);return cur}function createOptions(options){var object={};jQuery.each(options.match(rnotwhite)||[],function(_,flag){object[flag]=!0});return object}function completed(){document.removeEventListener("DOMContentLoaded",completed);window.removeEventListener("load",completed);jQuery.ready()}function Data(){this.expando=jQuery.expando+Data.uid++}function dataAttr(elem,key,data){var name;if(void 0===data&&1===elem.nodeType){name="data-"+key.replace(rmultiDash,"-$&").toLowerCase();data=elem.getAttribute(name);if("string"==typeof data){try{data="true"===data?!0:"false"===data?!1:"null"===data?null:+data+""===data?+data:rbrace.test(data)?jQuery.parseJSON(data):data}catch(e){}dataUser.set(elem,key,data)}else data=void 0}return data}function adjustCSS(elem,prop,valueParts,tween){var adjusted,scale=1,maxIterations=20,currentValue=tween?function(){return tween.cur()}:function(){return jQuery.css(elem,prop,"")},initial=currentValue(),unit=valueParts&&valueParts[3]||(jQuery.cssNumber[prop]?"":"px"),initialInUnit=(jQuery.cssNumber[prop]||"px"!==unit&&+initial)&&rcssNum.exec(jQuery.css(elem,prop));if(initialInUnit&&initialInUnit[3]!==unit){unit=unit||initialInUnit[3];valueParts=valueParts||[];initialInUnit=+initial||1;do{scale=scale||".5";initialInUnit/=scale;jQuery.style(elem,prop,initialInUnit+unit)}while(scale!==(scale=currentValue()/initial)&&1!==scale&&--maxIterations)}if(valueParts){initialInUnit=+initialInUnit||+initial||0;adjusted=valueParts[1]?initialInUnit+(valueParts[1]+1)*valueParts[2]:+valueParts[2];if(tween){tween.unit=unit;tween.start=initialInUnit;tween.end=adjusted}}return adjusted}function getAll(context,tag){var ret="undefined"!=typeof context.getElementsByTagName?context.getElementsByTagName(tag||"*"):"undefined"!=typeof context.querySelectorAll?context.querySelectorAll(tag||"*"):[];return void 0===tag||tag&&jQuery.nodeName(context,tag)?jQuery.merge([context],ret):ret}function setGlobalEval(elems,refElements){for(var i=0,l=elems.length;l>i;i++)dataPriv.set(elems[i],"globalEval",!refElements||dataPriv.get(refElements[i],"globalEval"))}function buildFragment(elems,context,scripts,selection,ignored){for(var elem,tmp,tag,wrap,contains,j,fragment=context.createDocumentFragment(),nodes=[],i=0,l=elems.length;l>i;i++){elem=elems[i];if(elem||0===elem)if("object"===jQuery.type(elem))jQuery.merge(nodes,elem.nodeType?[elem]:elem);else if(rhtml.test(elem)){tmp=tmp||fragment.appendChild(context.createElement("div"));tag=(rtagName.exec(elem)||["",""])[1].toLowerCase();wrap=wrapMap[tag]||wrapMap._default;tmp.innerHTML=wrap[1]+jQuery.htmlPrefilter(elem)+wrap[2];j=wrap[0];for(;j--;)tmp=tmp.lastChild;jQuery.merge(nodes,tmp.childNodes);tmp=fragment.firstChild;tmp.textContent=""}else nodes.push(context.createTextNode(elem))}fragment.textContent="";i=0;for(;elem=nodes[i++];)if(selection&&jQuery.inArray(elem,selection)>-1)ignored&&ignored.push(elem);else{contains=jQuery.contains(elem.ownerDocument,elem);tmp=getAll(fragment.appendChild(elem),"script");contains&&setGlobalEval(tmp);if(scripts){j=0;for(;elem=tmp[j++];)rscriptType.test(elem.type||"")&&scripts.push(elem)}}return fragment}function returnTrue(){return!0}function returnFalse(){return!1}function safeActiveElement(){try{return document.activeElement}catch(err){}}function on(elem,types,selector,data,fn,one){var origFn,type;if("object"==typeof types){if("string"!=typeof selector){data=data||selector;selector=void 0}for(type in types)on(elem,type,selector,data,types[type],one);return elem}if(null==data&&null==fn){fn=selector;data=selector=void 0}else if(null==fn)if("string"==typeof selector){fn=data;data=void 0}else{fn=data;data=selector;selector=void 0}if(fn===!1)fn=returnFalse;else if(!fn)return elem;if(1===one){origFn=fn;fn=function(event){jQuery().off(event);return origFn.apply(this,arguments)};fn.guid=origFn.guid||(origFn.guid=jQuery.guid++)}return elem.each(function(){jQuery.event.add(this,types,fn,data,selector)})}function manipulationTarget(elem,content){return jQuery.nodeName(elem,"table")&&jQuery.nodeName(11!==content.nodeType?content:content.firstChild,"tr")?elem.getElementsByTagName("tbody")[0]||elem.appendChild(elem.ownerDocument.createElement("tbody")):elem}function disableScript(elem){elem.type=(null!==elem.getAttribute("type"))+"/"+elem.type;return elem}function restoreScript(elem){var match=rscriptTypeMasked.exec(elem.type);match?elem.type=match[1]:elem.removeAttribute("type");return elem}function cloneCopyEvent(src,dest){var i,l,type,pdataOld,pdataCur,udataOld,udataCur,events;if(1===dest.nodeType){if(dataPriv.hasData(src)){pdataOld=dataPriv.access(src);pdataCur=dataPriv.set(dest,pdataOld);events=pdataOld.events;if(events){delete pdataCur.handle;pdataCur.events={};for(type in events)for(i=0,l=events[type].length;l>i;i++)jQuery.event.add(dest,type,events[type][i])}}if(dataUser.hasData(src)){udataOld=dataUser.access(src);udataCur=jQuery.extend({},udataOld);dataUser.set(dest,udataCur)}}}function fixInput(src,dest){var nodeName=dest.nodeName.toLowerCase();"input"===nodeName&&rcheckableType.test(src.type)?dest.checked=src.checked:("input"===nodeName||"textarea"===nodeName)&&(dest.defaultValue=src.defaultValue)}function domManip(collection,args,callback,ignored){args=concat.apply([],args);var fragment,first,scripts,hasScripts,node,doc,i=0,l=collection.length,iNoClone=l-1,value=args[0],isFunction=jQuery.isFunction(value);if(isFunction||l>1&&"string"==typeof value&&!support.checkClone&&rchecked.test(value))return collection.each(function(index){var self=collection.eq(index);isFunction&&(args[0]=value.call(this,index,self.html()));domManip(self,args,callback,ignored)});if(l){fragment=buildFragment(args,collection[0].ownerDocument,!1,collection,ignored);first=fragment.firstChild;1===fragment.childNodes.length&&(fragment=first);if(first||ignored){scripts=jQuery.map(getAll(fragment,"script"),disableScript);hasScripts=scripts.length;for(;l>i;i++){node=fragment;if(i!==iNoClone){node=jQuery.clone(node,!0,!0);hasScripts&&jQuery.merge(scripts,getAll(node,"script"))}callback.call(collection[i],node,i)}if(hasScripts){doc=scripts[scripts.length-1].ownerDocument;jQuery.map(scripts,restoreScript);for(i=0;hasScripts>i;i++){node=scripts[i];rscriptType.test(node.type||"")&&!dataPriv.access(node,"globalEval")&&jQuery.contains(doc,node)&&(node.src?jQuery._evalUrl&&jQuery._evalUrl(node.src):jQuery.globalEval(node.textContent.replace(rcleanScript,"")))}}}}return collection}function remove(elem,selector,keepData){for(var node,nodes=selector?jQuery.filter(selector,elem):elem,i=0;null!=(node=nodes[i]);i++){keepData||1!==node.nodeType||jQuery.cleanData(getAll(node));if(node.parentNode){keepData&&jQuery.contains(node.ownerDocument,node)&&setGlobalEval(getAll(node,"script"));node.parentNode.removeChild(node)}}return elem}function actualDisplay(name,doc){var elem=jQuery(doc.createElement(name)).appendTo(doc.body),display=jQuery.css(elem[0],"display");elem.detach();return display}function defaultDisplay(nodeName){var doc=document,display=elemdisplay[nodeName];if(!display){display=actualDisplay(nodeName,doc);if("none"===display||!display){iframe=(iframe||jQuery("<iframe frameborder='0' width='0' height='0'/>")).appendTo(doc.documentElement);doc=iframe[0].contentDocument;doc.write();doc.close();display=actualDisplay(nodeName,doc);iframe.detach()}elemdisplay[nodeName]=display}return display}function curCSS(elem,name,computed){var width,minWidth,maxWidth,ret,style=elem.style;computed=computed||getStyles(elem);ret=computed?computed.getPropertyValue(name)||computed[name]:void 0;""!==ret&&void 0!==ret||jQuery.contains(elem.ownerDocument,elem)||(ret=jQuery.style(elem,name));if(computed&&!support.pixelMarginRight()&&rnumnonpx.test(ret)&&rmargin.test(name)){width=style.width;minWidth=style.minWidth;maxWidth=style.maxWidth;style.minWidth=style.maxWidth=style.width=ret;ret=computed.width;style.width=width;style.minWidth=minWidth;style.maxWidth=maxWidth}return void 0!==ret?ret+"":ret}function addGetHookIf(conditionFn,hookFn){return{get:function(){if(!conditionFn())return(this.get=hookFn).apply(this,arguments);delete this.get}}}function vendorPropName(name){if(name in emptyStyle)return name;for(var capName=name[0].toUpperCase()+name.slice(1),i=cssPrefixes.length;i--;){name=cssPrefixes[i]+capName;if(name in emptyStyle)return name}}function setPositiveNumber(elem,value,subtract){var matches=rcssNum.exec(value);return matches?Math.max(0,matches[2]-(subtract||0))+(matches[3]||"px"):value}function augmentWidthOrHeight(elem,name,extra,isBorderBox,styles){for(var i=extra===(isBorderBox?"border":"content")?4:"width"===name?1:0,val=0;4>i;i+=2){"margin"===extra&&(val+=jQuery.css(elem,extra+cssExpand[i],!0,styles));if(isBorderBox){"content"===extra&&(val-=jQuery.css(elem,"padding"+cssExpand[i],!0,styles));"margin"!==extra&&(val-=jQuery.css(elem,"border"+cssExpand[i]+"Width",!0,styles))}else{val+=jQuery.css(elem,"padding"+cssExpand[i],!0,styles);"padding"!==extra&&(val+=jQuery.css(elem,"border"+cssExpand[i]+"Width",!0,styles))}}return val}function getWidthOrHeight(elem,name,extra){var valueIsBorderBox=!0,val="width"===name?elem.offsetWidth:elem.offsetHeight,styles=getStyles(elem),isBorderBox="border-box"===jQuery.css(elem,"boxSizing",!1,styles);if(0>=val||null==val){val=curCSS(elem,name,styles);(0>val||null==val)&&(val=elem.style[name]);if(rnumnonpx.test(val))return val;valueIsBorderBox=isBorderBox&&(support.boxSizingReliable()||val===elem.style[name]);val=parseFloat(val)||0}return val+augmentWidthOrHeight(elem,name,extra||(isBorderBox?"border":"content"),valueIsBorderBox,styles)+"px"}function showHide(elements,show){for(var display,elem,hidden,values=[],index=0,length=elements.length;length>index;index++){elem=elements[index];if(elem.style){values[index]=dataPriv.get(elem,"olddisplay");display=elem.style.display;if(show){values[index]||"none"!==display||(elem.style.display="");""===elem.style.display&&isHidden(elem)&&(values[index]=dataPriv.access(elem,"olddisplay",defaultDisplay(elem.nodeName)))}else{hidden=isHidden(elem);"none"===display&&hidden||dataPriv.set(elem,"olddisplay",hidden?display:jQuery.css(elem,"display"))}}}for(index=0;length>index;index++){elem=elements[index];elem.style&&(show&&"none"!==elem.style.display&&""!==elem.style.display||(elem.style.display=show?values[index]||"":"none"))}return elements}function Tween(elem,options,prop,end,easing){return new Tween.prototype.init(elem,options,prop,end,easing)}function createFxNow(){window.setTimeout(function(){fxNow=void 0});return fxNow=jQuery.now()}function genFx(type,includeWidth){var which,i=0,attrs={height:type};includeWidth=includeWidth?1:0;for(;4>i;i+=2-includeWidth){which=cssExpand[i];attrs["margin"+which]=attrs["padding"+which]=type}includeWidth&&(attrs.opacity=attrs.width=type);return attrs}function createTween(value,prop,animation){for(var tween,collection=(Animation.tweeners[prop]||[]).concat(Animation.tweeners["*"]),index=0,length=collection.length;length>index;index++)if(tween=collection[index].call(animation,prop,value))return tween}function defaultPrefilter(elem,props,opts){var prop,value,toggle,tween,hooks,oldfire,display,checkDisplay,anim=this,orig={},style=elem.style,hidden=elem.nodeType&&isHidden(elem),dataShow=dataPriv.get(elem,"fxshow");if(!opts.queue){hooks=jQuery._queueHooks(elem,"fx");if(null==hooks.unqueued){hooks.unqueued=0;oldfire=hooks.empty.fire;hooks.empty.fire=function(){hooks.unqueued||oldfire()}}hooks.unqueued++;anim.always(function(){anim.always(function(){hooks.unqueued--;jQuery.queue(elem,"fx").length||hooks.empty.fire()})})}if(1===elem.nodeType&&("height"in props||"width"in props)){opts.overflow=[style.overflow,style.overflowX,style.overflowY];display=jQuery.css(elem,"display");checkDisplay="none"===display?dataPriv.get(elem,"olddisplay")||defaultDisplay(elem.nodeName):display;"inline"===checkDisplay&&"none"===jQuery.css(elem,"float")&&(style.display="inline-block")}if(opts.overflow){style.overflow="hidden";anim.always(function(){style.overflow=opts.overflow[0];style.overflowX=opts.overflow[1];style.overflowY=opts.overflow[2]})}for(prop in props){value=props[prop];if(rfxtypes.exec(value)){delete props[prop];toggle=toggle||"toggle"===value;if(value===(hidden?"hide":"show")){if("show"!==value||!dataShow||void 0===dataShow[prop])continue;hidden=!0}orig[prop]=dataShow&&dataShow[prop]||jQuery.style(elem,prop)}else display=void 0}if(jQuery.isEmptyObject(orig))"inline"===("none"===display?defaultDisplay(elem.nodeName):display)&&(style.display=display);else{dataShow?"hidden"in dataShow&&(hidden=dataShow.hidden):dataShow=dataPriv.access(elem,"fxshow",{});toggle&&(dataShow.hidden=!hidden);hidden?jQuery(elem).show():anim.done(function(){jQuery(elem).hide()});anim.done(function(){var prop;dataPriv.remove(elem,"fxshow");for(prop in orig)jQuery.style(elem,prop,orig[prop])});for(prop in orig){tween=createTween(hidden?dataShow[prop]:0,prop,anim);if(!(prop in dataShow)){dataShow[prop]=tween.start;if(hidden){tween.end=tween.start;tween.start="width"===prop||"height"===prop?1:0}}}}}function propFilter(props,specialEasing){var index,name,easing,value,hooks;for(index in props){name=jQuery.camelCase(index);easing=specialEasing[name];value=props[index];if(jQuery.isArray(value)){easing=value[1];value=props[index]=value[0]}if(index!==name){props[name]=value;delete props[index]}hooks=jQuery.cssHooks[name];if(hooks&&"expand"in hooks){value=hooks.expand(value);delete props[name];for(index in value)if(!(index in props)){props[index]=value[index];specialEasing[index]=easing}}else specialEasing[name]=easing}}function Animation(elem,properties,options){var result,stopped,index=0,length=Animation.prefilters.length,deferred=jQuery.Deferred().always(function(){delete tick.elem}),tick=function(){if(stopped)return!1;for(var currentTime=fxNow||createFxNow(),remaining=Math.max(0,animation.startTime+animation.duration-currentTime),temp=remaining/animation.duration||0,percent=1-temp,index=0,length=animation.tweens.length;length>index;index++)animation.tweens[index].run(percent);deferred.notifyWith(elem,[animation,percent,remaining]);if(1>percent&&length)return remaining;deferred.resolveWith(elem,[animation]);return!1},animation=deferred.promise({elem:elem,props:jQuery.extend({},properties),opts:jQuery.extend(!0,{specialEasing:{},easing:jQuery.easing._default},options),originalProperties:properties,originalOptions:options,startTime:fxNow||createFxNow(),duration:options.duration,tweens:[],createTween:function(prop,end){var tween=jQuery.Tween(elem,animation.opts,prop,end,animation.opts.specialEasing[prop]||animation.opts.easing);animation.tweens.push(tween);return tween},stop:function(gotoEnd){var index=0,length=gotoEnd?animation.tweens.length:0;if(stopped)return this;stopped=!0;for(;length>index;index++)animation.tweens[index].run(1);if(gotoEnd){deferred.notifyWith(elem,[animation,1,0]);deferred.resolveWith(elem,[animation,gotoEnd])}else deferred.rejectWith(elem,[animation,gotoEnd]);return this}}),props=animation.props;propFilter(props,animation.opts.specialEasing);for(;length>index;index++){result=Animation.prefilters[index].call(animation,elem,props,animation.opts);if(result){jQuery.isFunction(result.stop)&&(jQuery._queueHooks(animation.elem,animation.opts.queue).stop=jQuery.proxy(result.stop,result));return result}}jQuery.map(props,createTween,animation);jQuery.isFunction(animation.opts.start)&&animation.opts.start.call(elem,animation);jQuery.fx.timer(jQuery.extend(tick,{elem:elem,anim:animation,queue:animation.opts.queue}));return animation.progress(animation.opts.progress).done(animation.opts.done,animation.opts.complete).fail(animation.opts.fail).always(animation.opts.always)}function getClass(elem){return elem.getAttribute&&elem.getAttribute("class")||""}function addToPrefiltersOrTransports(structure){return function(dataTypeExpression,func){if("string"!=typeof dataTypeExpression){func=dataTypeExpression;dataTypeExpression="*"}var dataType,i=0,dataTypes=dataTypeExpression.toLowerCase().match(rnotwhite)||[];if(jQuery.isFunction(func))for(;dataType=dataTypes[i++];)if("+"===dataType[0]){dataType=dataType.slice(1)||"*";(structure[dataType]=structure[dataType]||[]).unshift(func)}else(structure[dataType]=structure[dataType]||[]).push(func)}}function inspectPrefiltersOrTransports(structure,options,originalOptions,jqXHR){function inspect(dataType){var selected;inspected[dataType]=!0;jQuery.each(structure[dataType]||[],function(_,prefilterOrFactory){var dataTypeOrTransport=prefilterOrFactory(options,originalOptions,jqXHR);if("string"==typeof dataTypeOrTransport&&!seekingTransport&&!inspected[dataTypeOrTransport]){options.dataTypes.unshift(dataTypeOrTransport);inspect(dataTypeOrTransport);return!1}return seekingTransport?!(selected=dataTypeOrTransport):void 0});return selected}var inspected={},seekingTransport=structure===transports;return inspect(options.dataTypes[0])||!inspected["*"]&&inspect("*")}function ajaxExtend(target,src){var key,deep,flatOptions=jQuery.ajaxSettings.flatOptions||{};for(key in src)void 0!==src[key]&&((flatOptions[key]?target:deep||(deep={}))[key]=src[key]);deep&&jQuery.extend(!0,target,deep);return target}function ajaxHandleResponses(s,jqXHR,responses){for(var ct,type,finalDataType,firstDataType,contents=s.contents,dataTypes=s.dataTypes;"*"===dataTypes[0];){dataTypes.shift();void 0===ct&&(ct=s.mimeType||jqXHR.getResponseHeader("Content-Type"))}if(ct)for(type in contents)if(contents[type]&&contents[type].test(ct)){dataTypes.unshift(type);break}if(dataTypes[0]in responses)finalDataType=dataTypes[0];else{for(type in responses){if(!dataTypes[0]||s.converters[type+" "+dataTypes[0]]){finalDataType=type;break}firstDataType||(firstDataType=type)}finalDataType=finalDataType||firstDataType}if(finalDataType){finalDataType!==dataTypes[0]&&dataTypes.unshift(finalDataType);return responses[finalDataType]}}function ajaxConvert(s,response,jqXHR,isSuccess){var conv2,current,conv,tmp,prev,converters={},dataTypes=s.dataTypes.slice();if(dataTypes[1])for(conv in s.converters)converters[conv.toLowerCase()]=s.converters[conv];current=dataTypes.shift();for(;current;){s.responseFields[current]&&(jqXHR[s.responseFields[current]]=response);!prev&&isSuccess&&s.dataFilter&&(response=s.dataFilter(response,s.dataType));prev=current;current=dataTypes.shift();if(current)if("*"===current)current=prev;else if("*"!==prev&&prev!==current){conv=converters[prev+" "+current]||converters["* "+current];if(!conv)for(conv2 in converters){tmp=conv2.split(" ");if(tmp[1]===current){conv=converters[prev+" "+tmp[0]]||converters["* "+tmp[0]];if(conv){if(conv===!0)conv=converters[conv2];else if(converters[conv2]!==!0){current=tmp[0];dataTypes.unshift(tmp[1])}break}}}if(conv!==!0)if(conv&&s["throws"])response=conv(response);else try{response=conv(response)}catch(e){return{state:"parsererror",error:conv?e:"No conversion from "+prev+" to "+current}}}}return{state:"success",data:response}}function buildParams(prefix,obj,traditional,add){var name;if(jQuery.isArray(obj))jQuery.each(obj,function(i,v){traditional||rbracket.test(prefix)?add(prefix,v):buildParams(prefix+"["+("object"==typeof v&&null!=v?i:"")+"]",v,traditional,add)});else if(traditional||"object"!==jQuery.type(obj))add(prefix,obj);else for(name in obj)buildParams(prefix+"["+name+"]",obj[name],traditional,add)}function getWindow(elem){return jQuery.isWindow(elem)?elem:9===elem.nodeType&&elem.defaultView}var arr=[],document=window.document,slice=arr.slice,concat=arr.concat,push=arr.push,indexOf=arr.indexOf,class2type={},toString=class2type.toString,hasOwn=class2type.hasOwnProperty,support={},version="2.2.4",jQuery=function(selector,context){return new jQuery.fn.init(selector,context)},rtrim=/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,rmsPrefix=/^-ms-/,rdashAlpha=/-([\da-z])/gi,fcamelCase=function(all,letter){return letter.toUpperCase()};jQuery.fn=jQuery.prototype={jquery:version,constructor:jQuery,selector:"",length:0,toArray:function(){return slice.call(this)},get:function(num){return null!=num?0>num?this[num+this.length]:this[num]:slice.call(this)},pushStack:function(elems){var ret=jQuery.merge(this.constructor(),elems);ret.prevObject=this;ret.context=this.context;return ret},each:function(callback){return jQuery.each(this,callback)},map:function(callback){return this.pushStack(jQuery.map(this,function(elem,i){return callback.call(elem,i,elem)}))},slice:function(){return this.pushStack(slice.apply(this,arguments))},first:function(){return this.eq(0)},last:function(){return this.eq(-1)},eq:function(i){var len=this.length,j=+i+(0>i?len:0);return this.pushStack(j>=0&&len>j?[this[j]]:[])},end:function(){return this.prevObject||this.constructor()},push:push,sort:arr.sort,splice:arr.splice};jQuery.extend=jQuery.fn.extend=function(){var options,name,src,copy,copyIsArray,clone,target=arguments[0]||{},i=1,length=arguments.length,deep=!1;if("boolean"==typeof target){deep=target;target=arguments[i]||{};i++}"object"==typeof target||jQuery.isFunction(target)||(target={});if(i===length){target=this;i--}for(;length>i;i++)if(null!=(options=arguments[i]))for(name in options){src=target[name];copy=options[name];if(target!==copy)if(deep&&copy&&(jQuery.isPlainObject(copy)||(copyIsArray=jQuery.isArray(copy)))){if(copyIsArray){copyIsArray=!1;clone=src&&jQuery.isArray(src)?src:[]}else clone=src&&jQuery.isPlainObject(src)?src:{};target[name]=jQuery.extend(deep,clone,copy)}else void 0!==copy&&(target[name]=copy)}return target};jQuery.extend({expando:"jQuery"+(version+Math.random()).replace(/\D/g,""),isReady:!0,error:function(msg){throw new Error(msg)},noop:function(){},isFunction:function(obj){return"function"===jQuery.type(obj)},isArray:Array.isArray,isWindow:function(obj){return null!=obj&&obj===obj.window},isNumeric:function(obj){var realStringObj=obj&&obj.toString();return!jQuery.isArray(obj)&&realStringObj-parseFloat(realStringObj)+1>=0},isPlainObject:function(obj){var key;if("object"!==jQuery.type(obj)||obj.nodeType||jQuery.isWindow(obj))return!1;if(obj.constructor&&!hasOwn.call(obj,"constructor")&&!hasOwn.call(obj.constructor.prototype||{},"isPrototypeOf"))return!1;for(key in obj);return void 0===key||hasOwn.call(obj,key)},isEmptyObject:function(obj){var name;for(name in obj)return!1;return!0},type:function(obj){return null==obj?obj+"":"object"==typeof obj||"function"==typeof obj?class2type[toString.call(obj)]||"object":typeof obj},globalEval:function(code){var script,indirect=eval;code=jQuery.trim(code);if(code)if(1===code.indexOf("use strict")){script=document.createElement("script");script.text=code;document.head.appendChild(script).parentNode.removeChild(script)}else indirect(code)},camelCase:function(string){return string.replace(rmsPrefix,"ms-").replace(rdashAlpha,fcamelCase)},nodeName:function(elem,name){return elem.nodeName&&elem.nodeName.toLowerCase()===name.toLowerCase()},each:function(obj,callback){var length,i=0;if(isArrayLike(obj)){length=obj.length;for(;length>i&&callback.call(obj[i],i,obj[i])!==!1;i++);}else for(i in obj)if(callback.call(obj[i],i,obj[i])===!1)break;return obj},trim:function(text){return null==text?"":(text+"").replace(rtrim,"")},makeArray:function(arr,results){var ret=results||[];null!=arr&&(isArrayLike(Object(arr))?jQuery.merge(ret,"string"==typeof arr?[arr]:arr):push.call(ret,arr));return ret},inArray:function(elem,arr,i){return null==arr?-1:indexOf.call(arr,elem,i)},merge:function(first,second){for(var len=+second.length,j=0,i=first.length;len>j;j++)first[i++]=second[j];first.length=i;return first},grep:function(elems,callback,invert){for(var callbackInverse,matches=[],i=0,length=elems.length,callbackExpect=!invert;length>i;i++){callbackInverse=!callback(elems[i],i);callbackInverse!==callbackExpect&&matches.push(elems[i])}return matches},map:function(elems,callback,arg){var length,value,i=0,ret=[];if(isArrayLike(elems)){length=elems.length;for(;length>i;i++){value=callback(elems[i],i,arg);null!=value&&ret.push(value)}}else for(i in elems){value=callback(elems[i],i,arg);null!=value&&ret.push(value)}return concat.apply([],ret)},guid:1,proxy:function(fn,context){var tmp,args,proxy;if("string"==typeof context){tmp=fn[context];context=fn;fn=tmp}if(jQuery.isFunction(fn)){args=slice.call(arguments,2);proxy=function(){return fn.apply(context||this,args.concat(slice.call(arguments)))};proxy.guid=fn.guid=fn.guid||jQuery.guid++;return proxy}},now:Date.now,support:support});"function"==typeof Symbol&&(jQuery.fn[Symbol.iterator]=arr[Symbol.iterator]);jQuery.each("Boolean Number String Function Array Date RegExp Object Error Symbol".split(" "),function(i,name){class2type["[object "+name+"]"]=name.toLowerCase()});var Sizzle=function(window){function Sizzle(selector,context,results,seed){var m,i,elem,nid,nidselect,match,groups,newSelector,newContext=context&&context.ownerDocument,nodeType=context?context.nodeType:9;results=results||[];if("string"!=typeof selector||!selector||1!==nodeType&&9!==nodeType&&11!==nodeType)return results;if(!seed){(context?context.ownerDocument||context:preferredDoc)!==document&&setDocument(context);context=context||document;if(documentIsHTML){if(11!==nodeType&&(match=rquickExpr.exec(selector)))if(m=match[1]){if(9===nodeType){if(!(elem=context.getElementById(m)))return results;if(elem.id===m){results.push(elem);return results}}else if(newContext&&(elem=newContext.getElementById(m))&&contains(context,elem)&&elem.id===m){results.push(elem);return results}}else{if(match[2]){push.apply(results,context.getElementsByTagName(selector));return results}if((m=match[3])&&support.getElementsByClassName&&context.getElementsByClassName){push.apply(results,context.getElementsByClassName(m));return results}}if(support.qsa&&!compilerCache[selector+" "]&&(!rbuggyQSA||!rbuggyQSA.test(selector))){if(1!==nodeType){newContext=context;newSelector=selector}else if("object"!==context.nodeName.toLowerCase()){(nid=context.getAttribute("id"))?nid=nid.replace(rescape,"\\$&"):context.setAttribute("id",nid=expando);groups=tokenize(selector);i=groups.length;nidselect=ridentifier.test(nid)?"#"+nid:"[id='"+nid+"']";for(;i--;)groups[i]=nidselect+" "+toSelector(groups[i]);newSelector=groups.join(",");newContext=rsibling.test(selector)&&testContext(context.parentNode)||context}if(newSelector)try{push.apply(results,newContext.querySelectorAll(newSelector));return results}catch(qsaError){}finally{nid===expando&&context.removeAttribute("id")}}}}return select(selector.replace(rtrim,"$1"),context,results,seed)}function createCache(){function cache(key,value){keys.push(key+" ")>Expr.cacheLength&&delete cache[keys.shift()];return cache[key+" "]=value}var keys=[];return cache}function markFunction(fn){fn[expando]=!0;return fn}function assert(fn){var div=document.createElement("div");try{return!!fn(div)}catch(e){return!1}finally{div.parentNode&&div.parentNode.removeChild(div);div=null}}function addHandle(attrs,handler){for(var arr=attrs.split("|"),i=arr.length;i--;)Expr.attrHandle[arr[i]]=handler}function siblingCheck(a,b){var cur=b&&a,diff=cur&&1===a.nodeType&&1===b.nodeType&&(~b.sourceIndex||MAX_NEGATIVE)-(~a.sourceIndex||MAX_NEGATIVE);if(diff)return diff;if(cur)for(;cur=cur.nextSibling;)if(cur===b)return-1;return a?1:-1}function createInputPseudo(type){return function(elem){var name=elem.nodeName.toLowerCase();return"input"===name&&elem.type===type}}function createButtonPseudo(type){return function(elem){var name=elem.nodeName.toLowerCase();return("input"===name||"button"===name)&&elem.type===type}}function createPositionalPseudo(fn){return markFunction(function(argument){argument=+argument;return markFunction(function(seed,matches){for(var j,matchIndexes=fn([],seed.length,argument),i=matchIndexes.length;i--;)seed[j=matchIndexes[i]]&&(seed[j]=!(matches[j]=seed[j]))})})}function testContext(context){return context&&"undefined"!=typeof context.getElementsByTagName&&context}function setFilters(){}function toSelector(tokens){for(var i=0,len=tokens.length,selector="";len>i;i++)selector+=tokens[i].value;return selector}function addCombinator(matcher,combinator,base){var dir=combinator.dir,checkNonElements=base&&"parentNode"===dir,doneName=done++;return combinator.first?function(elem,context,xml){for(;elem=elem[dir];)if(1===elem.nodeType||checkNonElements)return matcher(elem,context,xml)}:function(elem,context,xml){var oldCache,uniqueCache,outerCache,newCache=[dirruns,doneName];if(xml){for(;elem=elem[dir];)if((1===elem.nodeType||checkNonElements)&&matcher(elem,context,xml))return!0}else for(;elem=elem[dir];)if(1===elem.nodeType||checkNonElements){outerCache=elem[expando]||(elem[expando]={});uniqueCache=outerCache[elem.uniqueID]||(outerCache[elem.uniqueID]={});if((oldCache=uniqueCache[dir])&&oldCache[0]===dirruns&&oldCache[1]===doneName)return newCache[2]=oldCache[2];uniqueCache[dir]=newCache;if(newCache[2]=matcher(elem,context,xml))return!0}}}function elementMatcher(matchers){return matchers.length>1?function(elem,context,xml){for(var i=matchers.length;i--;)if(!matchers[i](elem,context,xml))return!1;return!0}:matchers[0]}function multipleContexts(selector,contexts,results){for(var i=0,len=contexts.length;len>i;i++)Sizzle(selector,contexts[i],results);return results}function condense(unmatched,map,filter,context,xml){for(var elem,newUnmatched=[],i=0,len=unmatched.length,mapped=null!=map;len>i;i++)if((elem=unmatched[i])&&(!filter||filter(elem,context,xml))){newUnmatched.push(elem);mapped&&map.push(i)}return newUnmatched}function setMatcher(preFilter,selector,matcher,postFilter,postFinder,postSelector){postFilter&&!postFilter[expando]&&(postFilter=setMatcher(postFilter));postFinder&&!postFinder[expando]&&(postFinder=setMatcher(postFinder,postSelector));return markFunction(function(seed,results,context,xml){var temp,i,elem,preMap=[],postMap=[],preexisting=results.length,elems=seed||multipleContexts(selector||"*",context.nodeType?[context]:context,[]),matcherIn=!preFilter||!seed&&selector?elems:condense(elems,preMap,preFilter,context,xml),matcherOut=matcher?postFinder||(seed?preFilter:preexisting||postFilter)?[]:results:matcherIn;matcher&&matcher(matcherIn,matcherOut,context,xml);if(postFilter){temp=condense(matcherOut,postMap);postFilter(temp,[],context,xml);i=temp.length;for(;i--;)(elem=temp[i])&&(matcherOut[postMap[i]]=!(matcherIn[postMap[i]]=elem))}if(seed){if(postFinder||preFilter){if(postFinder){temp=[];i=matcherOut.length;for(;i--;)(elem=matcherOut[i])&&temp.push(matcherIn[i]=elem);postFinder(null,matcherOut=[],temp,xml)}i=matcherOut.length;for(;i--;)(elem=matcherOut[i])&&(temp=postFinder?indexOf(seed,elem):preMap[i])>-1&&(seed[temp]=!(results[temp]=elem))}}else{matcherOut=condense(matcherOut===results?matcherOut.splice(preexisting,matcherOut.length):matcherOut);postFinder?postFinder(null,results,matcherOut,xml):push.apply(results,matcherOut)}})}function matcherFromTokens(tokens){for(var checkContext,matcher,j,len=tokens.length,leadingRelative=Expr.relative[tokens[0].type],implicitRelative=leadingRelative||Expr.relative[" "],i=leadingRelative?1:0,matchContext=addCombinator(function(elem){
return elem===checkContext},implicitRelative,!0),matchAnyContext=addCombinator(function(elem){return indexOf(checkContext,elem)>-1},implicitRelative,!0),matchers=[function(elem,context,xml){var ret=!leadingRelative&&(xml||context!==outermostContext)||((checkContext=context).nodeType?matchContext(elem,context,xml):matchAnyContext(elem,context,xml));checkContext=null;return ret}];len>i;i++)if(matcher=Expr.relative[tokens[i].type])matchers=[addCombinator(elementMatcher(matchers),matcher)];else{matcher=Expr.filter[tokens[i].type].apply(null,tokens[i].matches);if(matcher[expando]){j=++i;for(;len>j&&!Expr.relative[tokens[j].type];j++);return setMatcher(i>1&&elementMatcher(matchers),i>1&&toSelector(tokens.slice(0,i-1).concat({value:" "===tokens[i-2].type?"*":""})).replace(rtrim,"$1"),matcher,j>i&&matcherFromTokens(tokens.slice(i,j)),len>j&&matcherFromTokens(tokens=tokens.slice(j)),len>j&&toSelector(tokens))}matchers.push(matcher)}return elementMatcher(matchers)}function matcherFromGroupMatchers(elementMatchers,setMatchers){var bySet=setMatchers.length>0,byElement=elementMatchers.length>0,superMatcher=function(seed,context,xml,results,outermost){var elem,j,matcher,matchedCount=0,i="0",unmatched=seed&&[],setMatched=[],contextBackup=outermostContext,elems=seed||byElement&&Expr.find.TAG("*",outermost),dirrunsUnique=dirruns+=null==contextBackup?1:Math.random()||.1,len=elems.length;outermost&&(outermostContext=context===document||context||outermost);for(;i!==len&&null!=(elem=elems[i]);i++){if(byElement&&elem){j=0;if(!context&&elem.ownerDocument!==document){setDocument(elem);xml=!documentIsHTML}for(;matcher=elementMatchers[j++];)if(matcher(elem,context||document,xml)){results.push(elem);break}outermost&&(dirruns=dirrunsUnique)}if(bySet){(elem=!matcher&&elem)&&matchedCount--;seed&&unmatched.push(elem)}}matchedCount+=i;if(bySet&&i!==matchedCount){j=0;for(;matcher=setMatchers[j++];)matcher(unmatched,setMatched,context,xml);if(seed){if(matchedCount>0)for(;i--;)unmatched[i]||setMatched[i]||(setMatched[i]=pop.call(results));setMatched=condense(setMatched)}push.apply(results,setMatched);outermost&&!seed&&setMatched.length>0&&matchedCount+setMatchers.length>1&&Sizzle.uniqueSort(results)}if(outermost){dirruns=dirrunsUnique;outermostContext=contextBackup}return unmatched};return bySet?markFunction(superMatcher):superMatcher}var i,support,Expr,getText,isXML,tokenize,compile,select,outermostContext,sortInput,hasDuplicate,setDocument,document,docElem,documentIsHTML,rbuggyQSA,rbuggyMatches,matches,contains,expando="sizzle"+1*new Date,preferredDoc=window.document,dirruns=0,done=0,classCache=createCache(),tokenCache=createCache(),compilerCache=createCache(),sortOrder=function(a,b){a===b&&(hasDuplicate=!0);return 0},MAX_NEGATIVE=1<<31,hasOwn={}.hasOwnProperty,arr=[],pop=arr.pop,push_native=arr.push,push=arr.push,slice=arr.slice,indexOf=function(list,elem){for(var i=0,len=list.length;len>i;i++)if(list[i]===elem)return i;return-1},booleans="checked|selected|async|autofocus|autoplay|controls|defer|disabled|hidden|ismap|loop|multiple|open|readonly|required|scoped",whitespace="[\\x20\\t\\r\\n\\f]",identifier="(?:\\\\.|[\\w-]|[^\\x00-\\xa0])+",attributes="\\["+whitespace+"*("+identifier+")(?:"+whitespace+"*([*^$|!~]?=)"+whitespace+"*(?:'((?:\\\\.|[^\\\\'])*)'|\"((?:\\\\.|[^\\\\\"])*)\"|("+identifier+"))|)"+whitespace+"*\\]",pseudos=":("+identifier+")(?:\\((('((?:\\\\.|[^\\\\'])*)'|\"((?:\\\\.|[^\\\\\"])*)\")|((?:\\\\.|[^\\\\()[\\]]|"+attributes+")*)|.*)\\)|)",rwhitespace=new RegExp(whitespace+"+","g"),rtrim=new RegExp("^"+whitespace+"+|((?:^|[^\\\\])(?:\\\\.)*)"+whitespace+"+$","g"),rcomma=new RegExp("^"+whitespace+"*,"+whitespace+"*"),rcombinators=new RegExp("^"+whitespace+"*([>+~]|"+whitespace+")"+whitespace+"*"),rattributeQuotes=new RegExp("="+whitespace+"*([^\\]'\"]*?)"+whitespace+"*\\]","g"),rpseudo=new RegExp(pseudos),ridentifier=new RegExp("^"+identifier+"$"),matchExpr={ID:new RegExp("^#("+identifier+")"),CLASS:new RegExp("^\\.("+identifier+")"),TAG:new RegExp("^("+identifier+"|[*])"),ATTR:new RegExp("^"+attributes),PSEUDO:new RegExp("^"+pseudos),CHILD:new RegExp("^:(only|first|last|nth|nth-last)-(child|of-type)(?:\\("+whitespace+"*(even|odd|(([+-]|)(\\d*)n|)"+whitespace+"*(?:([+-]|)"+whitespace+"*(\\d+)|))"+whitespace+"*\\)|)","i"),bool:new RegExp("^(?:"+booleans+")$","i"),needsContext:new RegExp("^"+whitespace+"*[>+~]|:(even|odd|eq|gt|lt|nth|first|last)(?:\\("+whitespace+"*((?:-\\d)?\\d*)"+whitespace+"*\\)|)(?=[^-]|$)","i")},rinputs=/^(?:input|select|textarea|button)$/i,rheader=/^h\d$/i,rnative=/^[^{]+\{\s*\[native \w/,rquickExpr=/^(?:#([\w-]+)|(\w+)|\.([\w-]+))$/,rsibling=/[+~]/,rescape=/'|\\/g,runescape=new RegExp("\\\\([\\da-f]{1,6}"+whitespace+"?|("+whitespace+")|.)","ig"),funescape=function(_,escaped,escapedWhitespace){var high="0x"+escaped-65536;return high!==high||escapedWhitespace?escaped:0>high?String.fromCharCode(high+65536):String.fromCharCode(high>>10|55296,1023&high|56320)},unloadHandler=function(){setDocument()};try{push.apply(arr=slice.call(preferredDoc.childNodes),preferredDoc.childNodes);arr[preferredDoc.childNodes.length].nodeType}catch(e){push={apply:arr.length?function(target,els){push_native.apply(target,slice.call(els))}:function(target,els){for(var j=target.length,i=0;target[j++]=els[i++];);target.length=j-1}}}support=Sizzle.support={};isXML=Sizzle.isXML=function(elem){var documentElement=elem&&(elem.ownerDocument||elem).documentElement;return documentElement?"HTML"!==documentElement.nodeName:!1};setDocument=Sizzle.setDocument=function(node){var hasCompare,parent,doc=node?node.ownerDocument||node:preferredDoc;if(doc===document||9!==doc.nodeType||!doc.documentElement)return document;document=doc;docElem=document.documentElement;documentIsHTML=!isXML(document);(parent=document.defaultView)&&parent.top!==parent&&(parent.addEventListener?parent.addEventListener("unload",unloadHandler,!1):parent.attachEvent&&parent.attachEvent("onunload",unloadHandler));support.attributes=assert(function(div){div.className="i";return!div.getAttribute("className")});support.getElementsByTagName=assert(function(div){div.appendChild(document.createComment(""));return!div.getElementsByTagName("*").length});support.getElementsByClassName=rnative.test(document.getElementsByClassName);support.getById=assert(function(div){docElem.appendChild(div).id=expando;return!document.getElementsByName||!document.getElementsByName(expando).length});if(support.getById){Expr.find.ID=function(id,context){if("undefined"!=typeof context.getElementById&&documentIsHTML){var m=context.getElementById(id);return m?[m]:[]}};Expr.filter.ID=function(id){var attrId=id.replace(runescape,funescape);return function(elem){return elem.getAttribute("id")===attrId}}}else{delete Expr.find.ID;Expr.filter.ID=function(id){var attrId=id.replace(runescape,funescape);return function(elem){var node="undefined"!=typeof elem.getAttributeNode&&elem.getAttributeNode("id");return node&&node.value===attrId}}}Expr.find.TAG=support.getElementsByTagName?function(tag,context){return"undefined"!=typeof context.getElementsByTagName?context.getElementsByTagName(tag):support.qsa?context.querySelectorAll(tag):void 0}:function(tag,context){var elem,tmp=[],i=0,results=context.getElementsByTagName(tag);if("*"===tag){for(;elem=results[i++];)1===elem.nodeType&&tmp.push(elem);return tmp}return results};Expr.find.CLASS=support.getElementsByClassName&&function(className,context){return"undefined"!=typeof context.getElementsByClassName&&documentIsHTML?context.getElementsByClassName(className):void 0};rbuggyMatches=[];rbuggyQSA=[];if(support.qsa=rnative.test(document.querySelectorAll)){assert(function(div){docElem.appendChild(div).innerHTML="<a id='"+expando+"'></a><select id='"+expando+"-\r\\' msallowcapture=''><option selected=''></option></select>";div.querySelectorAll("[msallowcapture^='']").length&&rbuggyQSA.push("[*^$]="+whitespace+"*(?:''|\"\")");div.querySelectorAll("[selected]").length||rbuggyQSA.push("\\["+whitespace+"*(?:value|"+booleans+")");div.querySelectorAll("[id~="+expando+"-]").length||rbuggyQSA.push("~=");div.querySelectorAll(":checked").length||rbuggyQSA.push(":checked");div.querySelectorAll("a#"+expando+"+*").length||rbuggyQSA.push(".#.+[+~]")});assert(function(div){var input=document.createElement("input");input.setAttribute("type","hidden");div.appendChild(input).setAttribute("name","D");div.querySelectorAll("[name=d]").length&&rbuggyQSA.push("name"+whitespace+"*[*^$|!~]?=");div.querySelectorAll(":enabled").length||rbuggyQSA.push(":enabled",":disabled");div.querySelectorAll("*,:x");rbuggyQSA.push(",.*:")})}(support.matchesSelector=rnative.test(matches=docElem.matches||docElem.webkitMatchesSelector||docElem.mozMatchesSelector||docElem.oMatchesSelector||docElem.msMatchesSelector))&&assert(function(div){support.disconnectedMatch=matches.call(div,"div");matches.call(div,"[s!='']:x");rbuggyMatches.push("!=",pseudos)});rbuggyQSA=rbuggyQSA.length&&new RegExp(rbuggyQSA.join("|"));rbuggyMatches=rbuggyMatches.length&&new RegExp(rbuggyMatches.join("|"));hasCompare=rnative.test(docElem.compareDocumentPosition);contains=hasCompare||rnative.test(docElem.contains)?function(a,b){var adown=9===a.nodeType?a.documentElement:a,bup=b&&b.parentNode;return a===bup||!(!bup||1!==bup.nodeType||!(adown.contains?adown.contains(bup):a.compareDocumentPosition&&16&a.compareDocumentPosition(bup)))}:function(a,b){if(b)for(;b=b.parentNode;)if(b===a)return!0;return!1};sortOrder=hasCompare?function(a,b){if(a===b){hasDuplicate=!0;return 0}var compare=!a.compareDocumentPosition-!b.compareDocumentPosition;if(compare)return compare;compare=(a.ownerDocument||a)===(b.ownerDocument||b)?a.compareDocumentPosition(b):1;return 1&compare||!support.sortDetached&&b.compareDocumentPosition(a)===compare?a===document||a.ownerDocument===preferredDoc&&contains(preferredDoc,a)?-1:b===document||b.ownerDocument===preferredDoc&&contains(preferredDoc,b)?1:sortInput?indexOf(sortInput,a)-indexOf(sortInput,b):0:4&compare?-1:1}:function(a,b){if(a===b){hasDuplicate=!0;return 0}var cur,i=0,aup=a.parentNode,bup=b.parentNode,ap=[a],bp=[b];if(!aup||!bup)return a===document?-1:b===document?1:aup?-1:bup?1:sortInput?indexOf(sortInput,a)-indexOf(sortInput,b):0;if(aup===bup)return siblingCheck(a,b);cur=a;for(;cur=cur.parentNode;)ap.unshift(cur);cur=b;for(;cur=cur.parentNode;)bp.unshift(cur);for(;ap[i]===bp[i];)i++;return i?siblingCheck(ap[i],bp[i]):ap[i]===preferredDoc?-1:bp[i]===preferredDoc?1:0};return document};Sizzle.matches=function(expr,elements){return Sizzle(expr,null,null,elements)};Sizzle.matchesSelector=function(elem,expr){(elem.ownerDocument||elem)!==document&&setDocument(elem);expr=expr.replace(rattributeQuotes,"='$1']");if(support.matchesSelector&&documentIsHTML&&!compilerCache[expr+" "]&&(!rbuggyMatches||!rbuggyMatches.test(expr))&&(!rbuggyQSA||!rbuggyQSA.test(expr)))try{var ret=matches.call(elem,expr);if(ret||support.disconnectedMatch||elem.document&&11!==elem.document.nodeType)return ret}catch(e){}return Sizzle(expr,document,null,[elem]).length>0};Sizzle.contains=function(context,elem){(context.ownerDocument||context)!==document&&setDocument(context);return contains(context,elem)};Sizzle.attr=function(elem,name){(elem.ownerDocument||elem)!==document&&setDocument(elem);var fn=Expr.attrHandle[name.toLowerCase()],val=fn&&hasOwn.call(Expr.attrHandle,name.toLowerCase())?fn(elem,name,!documentIsHTML):void 0;return void 0!==val?val:support.attributes||!documentIsHTML?elem.getAttribute(name):(val=elem.getAttributeNode(name))&&val.specified?val.value:null};Sizzle.error=function(msg){throw new Error("Syntax error, unrecognized expression: "+msg)};Sizzle.uniqueSort=function(results){var elem,duplicates=[],j=0,i=0;hasDuplicate=!support.detectDuplicates;sortInput=!support.sortStable&&results.slice(0);results.sort(sortOrder);if(hasDuplicate){for(;elem=results[i++];)elem===results[i]&&(j=duplicates.push(i));for(;j--;)results.splice(duplicates[j],1)}sortInput=null;return results};getText=Sizzle.getText=function(elem){var node,ret="",i=0,nodeType=elem.nodeType;if(nodeType){if(1===nodeType||9===nodeType||11===nodeType){if("string"==typeof elem.textContent)return elem.textContent;for(elem=elem.firstChild;elem;elem=elem.nextSibling)ret+=getText(elem)}else if(3===nodeType||4===nodeType)return elem.nodeValue}else for(;node=elem[i++];)ret+=getText(node);return ret};Expr=Sizzle.selectors={cacheLength:50,createPseudo:markFunction,match:matchExpr,attrHandle:{},find:{},relative:{">":{dir:"parentNode",first:!0}," ":{dir:"parentNode"},"+":{dir:"previousSibling",first:!0},"~":{dir:"previousSibling"}},preFilter:{ATTR:function(match){match[1]=match[1].replace(runescape,funescape);match[3]=(match[3]||match[4]||match[5]||"").replace(runescape,funescape);"~="===match[2]&&(match[3]=" "+match[3]+" ");return match.slice(0,4)},CHILD:function(match){match[1]=match[1].toLowerCase();if("nth"===match[1].slice(0,3)){match[3]||Sizzle.error(match[0]);match[4]=+(match[4]?match[5]+(match[6]||1):2*("even"===match[3]||"odd"===match[3]));match[5]=+(match[7]+match[8]||"odd"===match[3])}else match[3]&&Sizzle.error(match[0]);return match},PSEUDO:function(match){var excess,unquoted=!match[6]&&match[2];if(matchExpr.CHILD.test(match[0]))return null;if(match[3])match[2]=match[4]||match[5]||"";else if(unquoted&&rpseudo.test(unquoted)&&(excess=tokenize(unquoted,!0))&&(excess=unquoted.indexOf(")",unquoted.length-excess)-unquoted.length)){match[0]=match[0].slice(0,excess);match[2]=unquoted.slice(0,excess)}return match.slice(0,3)}},filter:{TAG:function(nodeNameSelector){var nodeName=nodeNameSelector.replace(runescape,funescape).toLowerCase();return"*"===nodeNameSelector?function(){return!0}:function(elem){return elem.nodeName&&elem.nodeName.toLowerCase()===nodeName}},CLASS:function(className){var pattern=classCache[className+" "];return pattern||(pattern=new RegExp("(^|"+whitespace+")"+className+"("+whitespace+"|$)"))&&classCache(className,function(elem){return pattern.test("string"==typeof elem.className&&elem.className||"undefined"!=typeof elem.getAttribute&&elem.getAttribute("class")||"")})},ATTR:function(name,operator,check){return function(elem){var result=Sizzle.attr(elem,name);if(null==result)return"!="===operator;if(!operator)return!0;result+="";return"="===operator?result===check:"!="===operator?result!==check:"^="===operator?check&&0===result.indexOf(check):"*="===operator?check&&result.indexOf(check)>-1:"$="===operator?check&&result.slice(-check.length)===check:"~="===operator?(" "+result.replace(rwhitespace," ")+" ").indexOf(check)>-1:"|="===operator?result===check||result.slice(0,check.length+1)===check+"-":!1}},CHILD:function(type,what,argument,first,last){var simple="nth"!==type.slice(0,3),forward="last"!==type.slice(-4),ofType="of-type"===what;return 1===first&&0===last?function(elem){return!!elem.parentNode}:function(elem,context,xml){var cache,uniqueCache,outerCache,node,nodeIndex,start,dir=simple!==forward?"nextSibling":"previousSibling",parent=elem.parentNode,name=ofType&&elem.nodeName.toLowerCase(),useCache=!xml&&!ofType,diff=!1;if(parent){if(simple){for(;dir;){node=elem;for(;node=node[dir];)if(ofType?node.nodeName.toLowerCase()===name:1===node.nodeType)return!1;start=dir="only"===type&&!start&&"nextSibling"}return!0}start=[forward?parent.firstChild:parent.lastChild];if(forward&&useCache){node=parent;outerCache=node[expando]||(node[expando]={});uniqueCache=outerCache[node.uniqueID]||(outerCache[node.uniqueID]={});cache=uniqueCache[type]||[];nodeIndex=cache[0]===dirruns&&cache[1];diff=nodeIndex&&cache[2];node=nodeIndex&&parent.childNodes[nodeIndex];for(;node=++nodeIndex&&node&&node[dir]||(diff=nodeIndex=0)||start.pop();)if(1===node.nodeType&&++diff&&node===elem){uniqueCache[type]=[dirruns,nodeIndex,diff];break}}else{if(useCache){node=elem;outerCache=node[expando]||(node[expando]={});uniqueCache=outerCache[node.uniqueID]||(outerCache[node.uniqueID]={});cache=uniqueCache[type]||[];nodeIndex=cache[0]===dirruns&&cache[1];diff=nodeIndex}if(diff===!1)for(;node=++nodeIndex&&node&&node[dir]||(diff=nodeIndex=0)||start.pop();)if((ofType?node.nodeName.toLowerCase()===name:1===node.nodeType)&&++diff){if(useCache){outerCache=node[expando]||(node[expando]={});uniqueCache=outerCache[node.uniqueID]||(outerCache[node.uniqueID]={});uniqueCache[type]=[dirruns,diff]}if(node===elem)break}}diff-=last;return diff===first||diff%first===0&&diff/first>=0}}},PSEUDO:function(pseudo,argument){var args,fn=Expr.pseudos[pseudo]||Expr.setFilters[pseudo.toLowerCase()]||Sizzle.error("unsupported pseudo: "+pseudo);if(fn[expando])return fn(argument);if(fn.length>1){args=[pseudo,pseudo,"",argument];return Expr.setFilters.hasOwnProperty(pseudo.toLowerCase())?markFunction(function(seed,matches){for(var idx,matched=fn(seed,argument),i=matched.length;i--;){idx=indexOf(seed,matched[i]);seed[idx]=!(matches[idx]=matched[i])}}):function(elem){return fn(elem,0,args)}}return fn}},pseudos:{not:markFunction(function(selector){var input=[],results=[],matcher=compile(selector.replace(rtrim,"$1"));return matcher[expando]?markFunction(function(seed,matches,context,xml){for(var elem,unmatched=matcher(seed,null,xml,[]),i=seed.length;i--;)(elem=unmatched[i])&&(seed[i]=!(matches[i]=elem))}):function(elem,context,xml){input[0]=elem;matcher(input,null,xml,results);input[0]=null;return!results.pop()}}),has:markFunction(function(selector){return function(elem){return Sizzle(selector,elem).length>0}}),contains:markFunction(function(text){text=text.replace(runescape,funescape);return function(elem){return(elem.textContent||elem.innerText||getText(elem)).indexOf(text)>-1}}),lang:markFunction(function(lang){ridentifier.test(lang||"")||Sizzle.error("unsupported lang: "+lang);lang=lang.replace(runescape,funescape).toLowerCase();return function(elem){var elemLang;do if(elemLang=documentIsHTML?elem.lang:elem.getAttribute("xml:lang")||elem.getAttribute("lang")){elemLang=elemLang.toLowerCase();return elemLang===lang||0===elemLang.indexOf(lang+"-")}while((elem=elem.parentNode)&&1===elem.nodeType);return!1}}),target:function(elem){var hash=window.location&&window.location.hash;return hash&&hash.slice(1)===elem.id},root:function(elem){return elem===docElem},focus:function(elem){return elem===document.activeElement&&(!document.hasFocus||document.hasFocus())&&!!(elem.type||elem.href||~elem.tabIndex)},enabled:function(elem){return elem.disabled===!1},disabled:function(elem){return elem.disabled===!0},checked:function(elem){var nodeName=elem.nodeName.toLowerCase();return"input"===nodeName&&!!elem.checked||"option"===nodeName&&!!elem.selected},selected:function(elem){elem.parentNode&&elem.parentNode.selectedIndex;return elem.selected===!0},empty:function(elem){for(elem=elem.firstChild;elem;elem=elem.nextSibling)if(elem.nodeType<6)return!1;return!0},parent:function(elem){return!Expr.pseudos.empty(elem)},header:function(elem){return rheader.test(elem.nodeName)},input:function(elem){return rinputs.test(elem.nodeName)},button:function(elem){var name=elem.nodeName.toLowerCase();return"input"===name&&"button"===elem.type||"button"===name},text:function(elem){var attr;return"input"===elem.nodeName.toLowerCase()&&"text"===elem.type&&(null==(attr=elem.getAttribute("type"))||"text"===attr.toLowerCase())},first:createPositionalPseudo(function(){return[0]}),last:createPositionalPseudo(function(matchIndexes,length){return[length-1]}),eq:createPositionalPseudo(function(matchIndexes,length,argument){return[0>argument?argument+length:argument]}),even:createPositionalPseudo(function(matchIndexes,length){for(var i=0;length>i;i+=2)matchIndexes.push(i);return matchIndexes}),odd:createPositionalPseudo(function(matchIndexes,length){for(var i=1;length>i;i+=2)matchIndexes.push(i);return matchIndexes}),lt:createPositionalPseudo(function(matchIndexes,length,argument){for(var i=0>argument?argument+length:argument;--i>=0;)matchIndexes.push(i);return matchIndexes}),gt:createPositionalPseudo(function(matchIndexes,length,argument){for(var i=0>argument?argument+length:argument;++i<length;)matchIndexes.push(i);return matchIndexes})}};Expr.pseudos.nth=Expr.pseudos.eq;for(i in{radio:!0,checkbox:!0,file:!0,password:!0,image:!0})Expr.pseudos[i]=createInputPseudo(i);for(i in{submit:!0,reset:!0})Expr.pseudos[i]=createButtonPseudo(i);setFilters.prototype=Expr.filters=Expr.pseudos;Expr.setFilters=new setFilters;tokenize=Sizzle.tokenize=function(selector,parseOnly){var matched,match,tokens,type,soFar,groups,preFilters,cached=tokenCache[selector+" "];if(cached)return parseOnly?0:cached.slice(0);soFar=selector;groups=[];preFilters=Expr.preFilter;for(;soFar;){if(!matched||(match=rcomma.exec(soFar))){match&&(soFar=soFar.slice(match[0].length)||soFar);groups.push(tokens=[])}matched=!1;if(match=rcombinators.exec(soFar)){matched=match.shift();tokens.push({value:matched,type:match[0].replace(rtrim," ")});soFar=soFar.slice(matched.length)}for(type in Expr.filter)if((match=matchExpr[type].exec(soFar))&&(!preFilters[type]||(match=preFilters[type](match)))){matched=match.shift();tokens.push({value:matched,type:type,matches:match});soFar=soFar.slice(matched.length)}if(!matched)break}return parseOnly?soFar.length:soFar?Sizzle.error(selector):tokenCache(selector,groups).slice(0)};compile=Sizzle.compile=function(selector,match){var i,setMatchers=[],elementMatchers=[],cached=compilerCache[selector+" "];if(!cached){match||(match=tokenize(selector));i=match.length;for(;i--;){cached=matcherFromTokens(match[i]);cached[expando]?setMatchers.push(cached):elementMatchers.push(cached)}cached=compilerCache(selector,matcherFromGroupMatchers(elementMatchers,setMatchers));cached.selector=selector}return cached};select=Sizzle.select=function(selector,context,results,seed){var i,tokens,token,type,find,compiled="function"==typeof selector&&selector,match=!seed&&tokenize(selector=compiled.selector||selector);results=results||[];if(1===match.length){tokens=match[0]=match[0].slice(0);if(tokens.length>2&&"ID"===(token=tokens[0]).type&&support.getById&&9===context.nodeType&&documentIsHTML&&Expr.relative[tokens[1].type]){context=(Expr.find.ID(token.matches[0].replace(runescape,funescape),context)||[])[0];if(!context)return results;compiled&&(context=context.parentNode);selector=selector.slice(tokens.shift().value.length)}i=matchExpr.needsContext.test(selector)?0:tokens.length;for(;i--;){token=tokens[i];if(Expr.relative[type=token.type])break;if((find=Expr.find[type])&&(seed=find(token.matches[0].replace(runescape,funescape),rsibling.test(tokens[0].type)&&testContext(context.parentNode)||context))){tokens.splice(i,1);selector=seed.length&&toSelector(tokens);if(!selector){push.apply(results,seed);return results}break}}}(compiled||compile(selector,match))(seed,context,!documentIsHTML,results,!context||rsibling.test(selector)&&testContext(context.parentNode)||context);return results};support.sortStable=expando.split("").sort(sortOrder).join("")===expando;support.detectDuplicates=!!hasDuplicate;setDocument();support.sortDetached=assert(function(div1){return 1&div1.compareDocumentPosition(document.createElement("div"))});assert(function(div){div.innerHTML="<a href='#'></a>";return"#"===div.firstChild.getAttribute("href")})||addHandle("type|href|height|width",function(elem,name,isXML){return isXML?void 0:elem.getAttribute(name,"type"===name.toLowerCase()?1:2)});support.attributes&&assert(function(div){div.innerHTML="<input/>";div.firstChild.setAttribute("value","");return""===div.firstChild.getAttribute("value")})||addHandle("value",function(elem,name,isXML){return isXML||"input"!==elem.nodeName.toLowerCase()?void 0:elem.defaultValue});assert(function(div){return null==div.getAttribute("disabled")})||addHandle(booleans,function(elem,name,isXML){var val;return isXML?void 0:elem[name]===!0?name.toLowerCase():(val=elem.getAttributeNode(name))&&val.specified?val.value:null});return Sizzle}(window);jQuery.find=Sizzle;jQuery.expr=Sizzle.selectors;jQuery.expr[":"]=jQuery.expr.pseudos;jQuery.uniqueSort=jQuery.unique=Sizzle.uniqueSort;jQuery.text=Sizzle.getText;jQuery.isXMLDoc=Sizzle.isXML;jQuery.contains=Sizzle.contains;var dir=function(elem,dir,until){for(var matched=[],truncate=void 0!==until;(elem=elem[dir])&&9!==elem.nodeType;)if(1===elem.nodeType){if(truncate&&jQuery(elem).is(until))break;matched.push(elem)}return matched},siblings=function(n,elem){for(var matched=[];n;n=n.nextSibling)1===n.nodeType&&n!==elem&&matched.push(n);return matched},rneedsContext=jQuery.expr.match.needsContext,rsingleTag=/^<([\w-]+)\s*\/?>(?:<\/\1>|)$/,risSimple=/^.[^:#\[\.,]*$/;jQuery.filter=function(expr,elems,not){var elem=elems[0];not&&(expr=":not("+expr+")");return 1===elems.length&&1===elem.nodeType?jQuery.find.matchesSelector(elem,expr)?[elem]:[]:jQuery.find.matches(expr,jQuery.grep(elems,function(elem){return 1===elem.nodeType}))};jQuery.fn.extend({find:function(selector){var i,len=this.length,ret=[],self=this;if("string"!=typeof selector)return this.pushStack(jQuery(selector).filter(function(){for(i=0;len>i;i++)if(jQuery.contains(self[i],this))return!0}));for(i=0;len>i;i++)jQuery.find(selector,self[i],ret);ret=this.pushStack(len>1?jQuery.unique(ret):ret);ret.selector=this.selector?this.selector+" "+selector:selector;return ret},filter:function(selector){return this.pushStack(winnow(this,selector||[],!1))},not:function(selector){return this.pushStack(winnow(this,selector||[],!0))},is:function(selector){return!!winnow(this,"string"==typeof selector&&rneedsContext.test(selector)?jQuery(selector):selector||[],!1).length}});var rootjQuery,rquickExpr=/^(?:\s*(<[\w\W]+>)[^>]*|#([\w-]*))$/,init=jQuery.fn.init=function(selector,context,root){var match,elem;if(!selector)return this;root=root||rootjQuery;if("string"==typeof selector){match="<"===selector[0]&&">"===selector[selector.length-1]&&selector.length>=3?[null,selector,null]:rquickExpr.exec(selector);if(!match||!match[1]&&context)return!context||context.jquery?(context||root).find(selector):this.constructor(context).find(selector);if(match[1]){context=context instanceof jQuery?context[0]:context;jQuery.merge(this,jQuery.parseHTML(match[1],context&&context.nodeType?context.ownerDocument||context:document,!0));if(rsingleTag.test(match[1])&&jQuery.isPlainObject(context))for(match in context)jQuery.isFunction(this[match])?this[match](context[match]):this.attr(match,context[match]);return this}elem=document.getElementById(match[2]);if(elem&&elem.parentNode){this.length=1;this[0]=elem}this.context=document;this.selector=selector;return this}if(selector.nodeType){this.context=this[0]=selector;this.length=1;return this}if(jQuery.isFunction(selector))return void 0!==root.ready?root.ready(selector):selector(jQuery);if(void 0!==selector.selector){this.selector=selector.selector;this.context=selector.context}return jQuery.makeArray(selector,this)};init.prototype=jQuery.fn;rootjQuery=jQuery(document);var rparentsprev=/^(?:parents|prev(?:Until|All))/,guaranteedUnique={children:!0,contents:!0,next:!0,prev:!0};jQuery.fn.extend({has:function(target){var targets=jQuery(target,this),l=targets.length;return this.filter(function(){for(var i=0;l>i;i++)if(jQuery.contains(this,targets[i]))return!0})},closest:function(selectors,context){for(var cur,i=0,l=this.length,matched=[],pos=rneedsContext.test(selectors)||"string"!=typeof selectors?jQuery(selectors,context||this.context):0;l>i;i++)for(cur=this[i];cur&&cur!==context;cur=cur.parentNode)if(cur.nodeType<11&&(pos?pos.index(cur)>-1:1===cur.nodeType&&jQuery.find.matchesSelector(cur,selectors))){matched.push(cur);break}return this.pushStack(matched.length>1?jQuery.uniqueSort(matched):matched)},index:function(elem){return elem?"string"==typeof elem?indexOf.call(jQuery(elem),this[0]):indexOf.call(this,elem.jquery?elem[0]:elem):this[0]&&this[0].parentNode?this.first().prevAll().length:-1},add:function(selector,context){return this.pushStack(jQuery.uniqueSort(jQuery.merge(this.get(),jQuery(selector,context))))},addBack:function(selector){return this.add(null==selector?this.prevObject:this.prevObject.filter(selector))}});jQuery.each({parent:function(elem){var parent=elem.parentNode;return parent&&11!==parent.nodeType?parent:null},parents:function(elem){return dir(elem,"parentNode")},parentsUntil:function(elem,i,until){return dir(elem,"parentNode",until)},next:function(elem){return sibling(elem,"nextSibling")},prev:function(elem){return sibling(elem,"previousSibling")},nextAll:function(elem){return dir(elem,"nextSibling")},prevAll:function(elem){return dir(elem,"previousSibling")},nextUntil:function(elem,i,until){return dir(elem,"nextSibling",until)},prevUntil:function(elem,i,until){return dir(elem,"previousSibling",until)},siblings:function(elem){return siblings((elem.parentNode||{}).firstChild,elem)},children:function(elem){return siblings(elem.firstChild)},contents:function(elem){return elem.contentDocument||jQuery.merge([],elem.childNodes)}},function(name,fn){jQuery.fn[name]=function(until,selector){var matched=jQuery.map(this,fn,until);"Until"!==name.slice(-5)&&(selector=until);selector&&"string"==typeof selector&&(matched=jQuery.filter(selector,matched));if(this.length>1){guaranteedUnique[name]||jQuery.uniqueSort(matched);rparentsprev.test(name)&&matched.reverse()}return this.pushStack(matched)}});var rnotwhite=/\S+/g;jQuery.Callbacks=function(options){options="string"==typeof options?createOptions(options):jQuery.extend({},options);var firing,memory,fired,locked,list=[],queue=[],firingIndex=-1,fire=function(){locked=options.once;fired=firing=!0;for(;queue.length;firingIndex=-1){memory=queue.shift();for(;++firingIndex<list.length;)if(list[firingIndex].apply(memory[0],memory[1])===!1&&options.stopOnFalse){firingIndex=list.length;memory=!1}}options.memory||(memory=!1);firing=!1;locked&&(list=memory?[]:"")},self={add:function(){if(list){if(memory&&!firing){firingIndex=list.length-1;queue.push(memory)}!function add(args){jQuery.each(args,function(_,arg){jQuery.isFunction(arg)?options.unique&&self.has(arg)||list.push(arg):arg&&arg.length&&"string"!==jQuery.type(arg)&&add(arg)})}(arguments);memory&&!firing&&fire()}return this},remove:function(){jQuery.each(arguments,function(_,arg){for(var index;(index=jQuery.inArray(arg,list,index))>-1;){list.splice(index,1);firingIndex>=index&&firingIndex--}});return this},has:function(fn){return fn?jQuery.inArray(fn,list)>-1:list.length>0},empty:function(){list&&(list=[]);return this},disable:function(){locked=queue=[];list=memory="";return this},disabled:function(){return!list},lock:function(){locked=queue=[];memory||(list=memory="");return this},locked:function(){return!!locked},fireWith:function(context,args){if(!locked){args=args||[];args=[context,args.slice?args.slice():args];queue.push(args);firing||fire()}return this},fire:function(){self.fireWith(this,arguments);return this},fired:function(){return!!fired}};return self};jQuery.extend({Deferred:function(func){var tuples=[["resolve","done",jQuery.Callbacks("once memory"),"resolved"],["reject","fail",jQuery.Callbacks("once memory"),"rejected"],["notify","progress",jQuery.Callbacks("memory")]],state="pending",promise={state:function(){return state},always:function(){deferred.done(arguments).fail(arguments);return this},then:function(){var fns=arguments;return jQuery.Deferred(function(newDefer){jQuery.each(tuples,function(i,tuple){var fn=jQuery.isFunction(fns[i])&&fns[i];deferred[tuple[1]](function(){var returned=fn&&fn.apply(this,arguments);returned&&jQuery.isFunction(returned.promise)?returned.promise().progress(newDefer.notify).done(newDefer.resolve).fail(newDefer.reject):newDefer[tuple[0]+"With"](this===promise?newDefer.promise():this,fn?[returned]:arguments)})});fns=null}).promise()},promise:function(obj){return null!=obj?jQuery.extend(obj,promise):promise}},deferred={};promise.pipe=promise.then;jQuery.each(tuples,function(i,tuple){var list=tuple[2],stateString=tuple[3];promise[tuple[1]]=list.add;stateString&&list.add(function(){state=stateString},tuples[1^i][2].disable,tuples[2][2].lock);deferred[tuple[0]]=function(){deferred[tuple[0]+"With"](this===deferred?promise:this,arguments);
return this};deferred[tuple[0]+"With"]=list.fireWith});promise.promise(deferred);func&&func.call(deferred,deferred);return deferred},when:function(subordinate){var progressValues,progressContexts,resolveContexts,i=0,resolveValues=slice.call(arguments),length=resolveValues.length,remaining=1!==length||subordinate&&jQuery.isFunction(subordinate.promise)?length:0,deferred=1===remaining?subordinate:jQuery.Deferred(),updateFunc=function(i,contexts,values){return function(value){contexts[i]=this;values[i]=arguments.length>1?slice.call(arguments):value;values===progressValues?deferred.notifyWith(contexts,values):--remaining||deferred.resolveWith(contexts,values)}};if(length>1){progressValues=new Array(length);progressContexts=new Array(length);resolveContexts=new Array(length);for(;length>i;i++)resolveValues[i]&&jQuery.isFunction(resolveValues[i].promise)?resolveValues[i].promise().progress(updateFunc(i,progressContexts,progressValues)).done(updateFunc(i,resolveContexts,resolveValues)).fail(deferred.reject):--remaining}remaining||deferred.resolveWith(resolveContexts,resolveValues);return deferred.promise()}});var readyList;jQuery.fn.ready=function(fn){jQuery.ready.promise().done(fn);return this};jQuery.extend({isReady:!1,readyWait:1,holdReady:function(hold){hold?jQuery.readyWait++:jQuery.ready(!0)},ready:function(wait){if(wait===!0?!--jQuery.readyWait:!jQuery.isReady){jQuery.isReady=!0;if(!(wait!==!0&&--jQuery.readyWait>0)){readyList.resolveWith(document,[jQuery]);if(jQuery.fn.triggerHandler){jQuery(document).triggerHandler("ready");jQuery(document).off("ready")}}}}});jQuery.ready.promise=function(obj){if(!readyList){readyList=jQuery.Deferred();if("complete"===document.readyState||"loading"!==document.readyState&&!document.documentElement.doScroll)window.setTimeout(jQuery.ready);else{document.addEventListener("DOMContentLoaded",completed);window.addEventListener("load",completed)}}return readyList.promise(obj)};jQuery.ready.promise();var access=function(elems,fn,key,value,chainable,emptyGet,raw){var i=0,len=elems.length,bulk=null==key;if("object"===jQuery.type(key)){chainable=!0;for(i in key)access(elems,fn,i,key[i],!0,emptyGet,raw)}else if(void 0!==value){chainable=!0;jQuery.isFunction(value)||(raw=!0);if(bulk)if(raw){fn.call(elems,value);fn=null}else{bulk=fn;fn=function(elem,key,value){return bulk.call(jQuery(elem),value)}}if(fn)for(;len>i;i++)fn(elems[i],key,raw?value:value.call(elems[i],i,fn(elems[i],key)))}return chainable?elems:bulk?fn.call(elems):len?fn(elems[0],key):emptyGet},acceptData=function(owner){return 1===owner.nodeType||9===owner.nodeType||!+owner.nodeType};Data.uid=1;Data.prototype={register:function(owner,initial){var value=initial||{};owner.nodeType?owner[this.expando]=value:Object.defineProperty(owner,this.expando,{value:value,writable:!0,configurable:!0});return owner[this.expando]},cache:function(owner){if(!acceptData(owner))return{};var value=owner[this.expando];if(!value){value={};acceptData(owner)&&(owner.nodeType?owner[this.expando]=value:Object.defineProperty(owner,this.expando,{value:value,configurable:!0}))}return value},set:function(owner,data,value){var prop,cache=this.cache(owner);if("string"==typeof data)cache[data]=value;else for(prop in data)cache[prop]=data[prop];return cache},get:function(owner,key){return void 0===key?this.cache(owner):owner[this.expando]&&owner[this.expando][key]},access:function(owner,key,value){var stored;if(void 0===key||key&&"string"==typeof key&&void 0===value){stored=this.get(owner,key);return void 0!==stored?stored:this.get(owner,jQuery.camelCase(key))}this.set(owner,key,value);return void 0!==value?value:key},remove:function(owner,key){var i,name,camel,cache=owner[this.expando];if(void 0!==cache){if(void 0===key)this.register(owner);else{if(jQuery.isArray(key))name=key.concat(key.map(jQuery.camelCase));else{camel=jQuery.camelCase(key);if(key in cache)name=[key,camel];else{name=camel;name=name in cache?[name]:name.match(rnotwhite)||[]}}i=name.length;for(;i--;)delete cache[name[i]]}(void 0===key||jQuery.isEmptyObject(cache))&&(owner.nodeType?owner[this.expando]=void 0:delete owner[this.expando])}},hasData:function(owner){var cache=owner[this.expando];return void 0!==cache&&!jQuery.isEmptyObject(cache)}};var dataPriv=new Data,dataUser=new Data,rbrace=/^(?:\{[\w\W]*\}|\[[\w\W]*\])$/,rmultiDash=/[A-Z]/g;jQuery.extend({hasData:function(elem){return dataUser.hasData(elem)||dataPriv.hasData(elem)},data:function(elem,name,data){return dataUser.access(elem,name,data)},removeData:function(elem,name){dataUser.remove(elem,name)},_data:function(elem,name,data){return dataPriv.access(elem,name,data)},_removeData:function(elem,name){dataPriv.remove(elem,name)}});jQuery.fn.extend({data:function(key,value){var i,name,data,elem=this[0],attrs=elem&&elem.attributes;if(void 0===key){if(this.length){data=dataUser.get(elem);if(1===elem.nodeType&&!dataPriv.get(elem,"hasDataAttrs")){i=attrs.length;for(;i--;)if(attrs[i]){name=attrs[i].name;if(0===name.indexOf("data-")){name=jQuery.camelCase(name.slice(5));dataAttr(elem,name,data[name])}}dataPriv.set(elem,"hasDataAttrs",!0)}}return data}return"object"==typeof key?this.each(function(){dataUser.set(this,key)}):access(this,function(value){var data,camelKey;if(elem&&void 0===value){data=dataUser.get(elem,key)||dataUser.get(elem,key.replace(rmultiDash,"-$&").toLowerCase());if(void 0!==data)return data;camelKey=jQuery.camelCase(key);data=dataUser.get(elem,camelKey);if(void 0!==data)return data;data=dataAttr(elem,camelKey,void 0);if(void 0!==data)return data}else{camelKey=jQuery.camelCase(key);this.each(function(){var data=dataUser.get(this,camelKey);dataUser.set(this,camelKey,value);key.indexOf("-")>-1&&void 0!==data&&dataUser.set(this,key,value)})}},null,value,arguments.length>1,null,!0)},removeData:function(key){return this.each(function(){dataUser.remove(this,key)})}});jQuery.extend({queue:function(elem,type,data){var queue;if(elem){type=(type||"fx")+"queue";queue=dataPriv.get(elem,type);data&&(!queue||jQuery.isArray(data)?queue=dataPriv.access(elem,type,jQuery.makeArray(data)):queue.push(data));return queue||[]}},dequeue:function(elem,type){type=type||"fx";var queue=jQuery.queue(elem,type),startLength=queue.length,fn=queue.shift(),hooks=jQuery._queueHooks(elem,type),next=function(){jQuery.dequeue(elem,type)};if("inprogress"===fn){fn=queue.shift();startLength--}if(fn){"fx"===type&&queue.unshift("inprogress");delete hooks.stop;fn.call(elem,next,hooks)}!startLength&&hooks&&hooks.empty.fire()},_queueHooks:function(elem,type){var key=type+"queueHooks";return dataPriv.get(elem,key)||dataPriv.access(elem,key,{empty:jQuery.Callbacks("once memory").add(function(){dataPriv.remove(elem,[type+"queue",key])})})}});jQuery.fn.extend({queue:function(type,data){var setter=2;if("string"!=typeof type){data=type;type="fx";setter--}return arguments.length<setter?jQuery.queue(this[0],type):void 0===data?this:this.each(function(){var queue=jQuery.queue(this,type,data);jQuery._queueHooks(this,type);"fx"===type&&"inprogress"!==queue[0]&&jQuery.dequeue(this,type)})},dequeue:function(type){return this.each(function(){jQuery.dequeue(this,type)})},clearQueue:function(type){return this.queue(type||"fx",[])},promise:function(type,obj){var tmp,count=1,defer=jQuery.Deferred(),elements=this,i=this.length,resolve=function(){--count||defer.resolveWith(elements,[elements])};if("string"!=typeof type){obj=type;type=void 0}type=type||"fx";for(;i--;){tmp=dataPriv.get(elements[i],type+"queueHooks");if(tmp&&tmp.empty){count++;tmp.empty.add(resolve)}}resolve();return defer.promise(obj)}});var pnum=/[+-]?(?:\d*\.|)\d+(?:[eE][+-]?\d+|)/.source,rcssNum=new RegExp("^(?:([+-])=|)("+pnum+")([a-z%]*)$","i"),cssExpand=["Top","Right","Bottom","Left"],isHidden=function(elem,el){elem=el||elem;return"none"===jQuery.css(elem,"display")||!jQuery.contains(elem.ownerDocument,elem)},rcheckableType=/^(?:checkbox|radio)$/i,rtagName=/<([\w:-]+)/,rscriptType=/^$|\/(?:java|ecma)script/i,wrapMap={option:[1,"<select multiple='multiple'>","</select>"],thead:[1,"<table>","</table>"],col:[2,"<table><colgroup>","</colgroup></table>"],tr:[2,"<table><tbody>","</tbody></table>"],td:[3,"<table><tbody><tr>","</tr></tbody></table>"],_default:[0,"",""]};wrapMap.optgroup=wrapMap.option;wrapMap.tbody=wrapMap.tfoot=wrapMap.colgroup=wrapMap.caption=wrapMap.thead;wrapMap.th=wrapMap.td;var rhtml=/<|&#?\w+;/;!function(){var fragment=document.createDocumentFragment(),div=fragment.appendChild(document.createElement("div")),input=document.createElement("input");input.setAttribute("type","radio");input.setAttribute("checked","checked");input.setAttribute("name","t");div.appendChild(input);support.checkClone=div.cloneNode(!0).cloneNode(!0).lastChild.checked;div.innerHTML="<textarea>x</textarea>";support.noCloneChecked=!!div.cloneNode(!0).lastChild.defaultValue}();var rkeyEvent=/^key/,rmouseEvent=/^(?:mouse|pointer|contextmenu|drag|drop)|click/,rtypenamespace=/^([^.]*)(?:\.(.+)|)/;jQuery.event={global:{},add:function(elem,types,handler,data,selector){var handleObjIn,eventHandle,tmp,events,t,handleObj,special,handlers,type,namespaces,origType,elemData=dataPriv.get(elem);if(elemData){if(handler.handler){handleObjIn=handler;handler=handleObjIn.handler;selector=handleObjIn.selector}handler.guid||(handler.guid=jQuery.guid++);(events=elemData.events)||(events=elemData.events={});(eventHandle=elemData.handle)||(eventHandle=elemData.handle=function(e){return"undefined"!=typeof jQuery&&jQuery.event.triggered!==e.type?jQuery.event.dispatch.apply(elem,arguments):void 0});types=(types||"").match(rnotwhite)||[""];t=types.length;for(;t--;){tmp=rtypenamespace.exec(types[t])||[];type=origType=tmp[1];namespaces=(tmp[2]||"").split(".").sort();if(type){special=jQuery.event.special[type]||{};type=(selector?special.delegateType:special.bindType)||type;special=jQuery.event.special[type]||{};handleObj=jQuery.extend({type:type,origType:origType,data:data,handler:handler,guid:handler.guid,selector:selector,needsContext:selector&&jQuery.expr.match.needsContext.test(selector),namespace:namespaces.join(".")},handleObjIn);if(!(handlers=events[type])){handlers=events[type]=[];handlers.delegateCount=0;special.setup&&special.setup.call(elem,data,namespaces,eventHandle)!==!1||elem.addEventListener&&elem.addEventListener(type,eventHandle)}if(special.add){special.add.call(elem,handleObj);handleObj.handler.guid||(handleObj.handler.guid=handler.guid)}selector?handlers.splice(handlers.delegateCount++,0,handleObj):handlers.push(handleObj);jQuery.event.global[type]=!0}}}},remove:function(elem,types,handler,selector,mappedTypes){var j,origCount,tmp,events,t,handleObj,special,handlers,type,namespaces,origType,elemData=dataPriv.hasData(elem)&&dataPriv.get(elem);if(elemData&&(events=elemData.events)){types=(types||"").match(rnotwhite)||[""];t=types.length;for(;t--;){tmp=rtypenamespace.exec(types[t])||[];type=origType=tmp[1];namespaces=(tmp[2]||"").split(".").sort();if(type){special=jQuery.event.special[type]||{};type=(selector?special.delegateType:special.bindType)||type;handlers=events[type]||[];tmp=tmp[2]&&new RegExp("(^|\\.)"+namespaces.join("\\.(?:.*\\.|)")+"(\\.|$)");origCount=j=handlers.length;for(;j--;){handleObj=handlers[j];if((mappedTypes||origType===handleObj.origType)&&(!handler||handler.guid===handleObj.guid)&&(!tmp||tmp.test(handleObj.namespace))&&(!selector||selector===handleObj.selector||"**"===selector&&handleObj.selector)){handlers.splice(j,1);handleObj.selector&&handlers.delegateCount--;special.remove&&special.remove.call(elem,handleObj)}}if(origCount&&!handlers.length){special.teardown&&special.teardown.call(elem,namespaces,elemData.handle)!==!1||jQuery.removeEvent(elem,type,elemData.handle);delete events[type]}}else for(type in events)jQuery.event.remove(elem,type+types[t],handler,selector,!0)}jQuery.isEmptyObject(events)&&dataPriv.remove(elem,"handle events")}},dispatch:function(event){event=jQuery.event.fix(event);var i,j,ret,matched,handleObj,handlerQueue=[],args=slice.call(arguments),handlers=(dataPriv.get(this,"events")||{})[event.type]||[],special=jQuery.event.special[event.type]||{};args[0]=event;event.delegateTarget=this;if(!special.preDispatch||special.preDispatch.call(this,event)!==!1){handlerQueue=jQuery.event.handlers.call(this,event,handlers);i=0;for(;(matched=handlerQueue[i++])&&!event.isPropagationStopped();){event.currentTarget=matched.elem;j=0;for(;(handleObj=matched.handlers[j++])&&!event.isImmediatePropagationStopped();)if(!event.rnamespace||event.rnamespace.test(handleObj.namespace)){event.handleObj=handleObj;event.data=handleObj.data;ret=((jQuery.event.special[handleObj.origType]||{}).handle||handleObj.handler).apply(matched.elem,args);if(void 0!==ret&&(event.result=ret)===!1){event.preventDefault();event.stopPropagation()}}}special.postDispatch&&special.postDispatch.call(this,event);return event.result}},handlers:function(event,handlers){var i,matches,sel,handleObj,handlerQueue=[],delegateCount=handlers.delegateCount,cur=event.target;if(delegateCount&&cur.nodeType&&("click"!==event.type||isNaN(event.button)||event.button<1))for(;cur!==this;cur=cur.parentNode||this)if(1===cur.nodeType&&(cur.disabled!==!0||"click"!==event.type)){matches=[];for(i=0;delegateCount>i;i++){handleObj=handlers[i];sel=handleObj.selector+" ";void 0===matches[sel]&&(matches[sel]=handleObj.needsContext?jQuery(sel,this).index(cur)>-1:jQuery.find(sel,this,null,[cur]).length);matches[sel]&&matches.push(handleObj)}matches.length&&handlerQueue.push({elem:cur,handlers:matches})}delegateCount<handlers.length&&handlerQueue.push({elem:this,handlers:handlers.slice(delegateCount)});return handlerQueue},props:"altKey bubbles cancelable ctrlKey currentTarget detail eventPhase metaKey relatedTarget shiftKey target timeStamp view which".split(" "),fixHooks:{},keyHooks:{props:"char charCode key keyCode".split(" "),filter:function(event,original){null==event.which&&(event.which=null!=original.charCode?original.charCode:original.keyCode);return event}},mouseHooks:{props:"button buttons clientX clientY offsetX offsetY pageX pageY screenX screenY toElement".split(" "),filter:function(event,original){var eventDoc,doc,body,button=original.button;if(null==event.pageX&&null!=original.clientX){eventDoc=event.target.ownerDocument||document;doc=eventDoc.documentElement;body=eventDoc.body;event.pageX=original.clientX+(doc&&doc.scrollLeft||body&&body.scrollLeft||0)-(doc&&doc.clientLeft||body&&body.clientLeft||0);event.pageY=original.clientY+(doc&&doc.scrollTop||body&&body.scrollTop||0)-(doc&&doc.clientTop||body&&body.clientTop||0)}event.which||void 0===button||(event.which=1&button?1:2&button?3:4&button?2:0);return event}},fix:function(event){if(event[jQuery.expando])return event;var i,prop,copy,type=event.type,originalEvent=event,fixHook=this.fixHooks[type];fixHook||(this.fixHooks[type]=fixHook=rmouseEvent.test(type)?this.mouseHooks:rkeyEvent.test(type)?this.keyHooks:{});copy=fixHook.props?this.props.concat(fixHook.props):this.props;event=new jQuery.Event(originalEvent);i=copy.length;for(;i--;){prop=copy[i];event[prop]=originalEvent[prop]}event.target||(event.target=document);3===event.target.nodeType&&(event.target=event.target.parentNode);return fixHook.filter?fixHook.filter(event,originalEvent):event},special:{load:{noBubble:!0},focus:{trigger:function(){if(this!==safeActiveElement()&&this.focus){this.focus();return!1}},delegateType:"focusin"},blur:{trigger:function(){if(this===safeActiveElement()&&this.blur){this.blur();return!1}},delegateType:"focusout"},click:{trigger:function(){if("checkbox"===this.type&&this.click&&jQuery.nodeName(this,"input")){this.click();return!1}},_default:function(event){return jQuery.nodeName(event.target,"a")}},beforeunload:{postDispatch:function(event){void 0!==event.result&&event.originalEvent&&(event.originalEvent.returnValue=event.result)}}}};jQuery.removeEvent=function(elem,type,handle){elem.removeEventListener&&elem.removeEventListener(type,handle)};jQuery.Event=function(src,props){if(!(this instanceof jQuery.Event))return new jQuery.Event(src,props);if(src&&src.type){this.originalEvent=src;this.type=src.type;this.isDefaultPrevented=src.defaultPrevented||void 0===src.defaultPrevented&&src.returnValue===!1?returnTrue:returnFalse}else this.type=src;props&&jQuery.extend(this,props);this.timeStamp=src&&src.timeStamp||jQuery.now();this[jQuery.expando]=!0};jQuery.Event.prototype={constructor:jQuery.Event,isDefaultPrevented:returnFalse,isPropagationStopped:returnFalse,isImmediatePropagationStopped:returnFalse,isSimulated:!1,preventDefault:function(){var e=this.originalEvent;this.isDefaultPrevented=returnTrue;e&&!this.isSimulated&&e.preventDefault()},stopPropagation:function(){var e=this.originalEvent;this.isPropagationStopped=returnTrue;e&&!this.isSimulated&&e.stopPropagation()},stopImmediatePropagation:function(){var e=this.originalEvent;this.isImmediatePropagationStopped=returnTrue;e&&!this.isSimulated&&e.stopImmediatePropagation();this.stopPropagation()}};jQuery.each({mouseenter:"mouseover",mouseleave:"mouseout",pointerenter:"pointerover",pointerleave:"pointerout"},function(orig,fix){jQuery.event.special[orig]={delegateType:fix,bindType:fix,handle:function(event){var ret,target=this,related=event.relatedTarget,handleObj=event.handleObj;if(!related||related!==target&&!jQuery.contains(target,related)){event.type=handleObj.origType;ret=handleObj.handler.apply(this,arguments);event.type=fix}return ret}}});jQuery.fn.extend({on:function(types,selector,data,fn){return on(this,types,selector,data,fn)},one:function(types,selector,data,fn){return on(this,types,selector,data,fn,1)},off:function(types,selector,fn){var handleObj,type;if(types&&types.preventDefault&&types.handleObj){handleObj=types.handleObj;jQuery(types.delegateTarget).off(handleObj.namespace?handleObj.origType+"."+handleObj.namespace:handleObj.origType,handleObj.selector,handleObj.handler);return this}if("object"==typeof types){for(type in types)this.off(type,selector,types[type]);return this}if(selector===!1||"function"==typeof selector){fn=selector;selector=void 0}fn===!1&&(fn=returnFalse);return this.each(function(){jQuery.event.remove(this,types,fn,selector)})}});var rxhtmlTag=/<(?!area|br|col|embed|hr|img|input|link|meta|param)(([\w:-]+)[^>]*)\/>/gi,rnoInnerhtml=/<script|<style|<link/i,rchecked=/checked\s*(?:[^=]|=\s*.checked.)/i,rscriptTypeMasked=/^true\/(.*)/,rcleanScript=/^\s*<!(?:\[CDATA\[|--)|(?:\]\]|--)>\s*$/g;jQuery.extend({htmlPrefilter:function(html){return html.replace(rxhtmlTag,"<$1></$2>")},clone:function(elem,dataAndEvents,deepDataAndEvents){var i,l,srcElements,destElements,clone=elem.cloneNode(!0),inPage=jQuery.contains(elem.ownerDocument,elem);if(!(support.noCloneChecked||1!==elem.nodeType&&11!==elem.nodeType||jQuery.isXMLDoc(elem))){destElements=getAll(clone);srcElements=getAll(elem);for(i=0,l=srcElements.length;l>i;i++)fixInput(srcElements[i],destElements[i])}if(dataAndEvents)if(deepDataAndEvents){srcElements=srcElements||getAll(elem);destElements=destElements||getAll(clone);for(i=0,l=srcElements.length;l>i;i++)cloneCopyEvent(srcElements[i],destElements[i])}else cloneCopyEvent(elem,clone);destElements=getAll(clone,"script");destElements.length>0&&setGlobalEval(destElements,!inPage&&getAll(elem,"script"));return clone},cleanData:function(elems){for(var data,elem,type,special=jQuery.event.special,i=0;void 0!==(elem=elems[i]);i++)if(acceptData(elem)){if(data=elem[dataPriv.expando]){if(data.events)for(type in data.events)special[type]?jQuery.event.remove(elem,type):jQuery.removeEvent(elem,type,data.handle);elem[dataPriv.expando]=void 0}elem[dataUser.expando]&&(elem[dataUser.expando]=void 0)}}});jQuery.fn.extend({domManip:domManip,detach:function(selector){return remove(this,selector,!0)},remove:function(selector){return remove(this,selector)},text:function(value){return access(this,function(value){return void 0===value?jQuery.text(this):this.empty().each(function(){(1===this.nodeType||11===this.nodeType||9===this.nodeType)&&(this.textContent=value)})},null,value,arguments.length)},append:function(){return domManip(this,arguments,function(elem){if(1===this.nodeType||11===this.nodeType||9===this.nodeType){var target=manipulationTarget(this,elem);target.appendChild(elem)}})},prepend:function(){return domManip(this,arguments,function(elem){if(1===this.nodeType||11===this.nodeType||9===this.nodeType){var target=manipulationTarget(this,elem);target.insertBefore(elem,target.firstChild)}})},before:function(){return domManip(this,arguments,function(elem){this.parentNode&&this.parentNode.insertBefore(elem,this)})},after:function(){return domManip(this,arguments,function(elem){this.parentNode&&this.parentNode.insertBefore(elem,this.nextSibling)})},empty:function(){for(var elem,i=0;null!=(elem=this[i]);i++)if(1===elem.nodeType){jQuery.cleanData(getAll(elem,!1));elem.textContent=""}return this},clone:function(dataAndEvents,deepDataAndEvents){dataAndEvents=null==dataAndEvents?!1:dataAndEvents;deepDataAndEvents=null==deepDataAndEvents?dataAndEvents:deepDataAndEvents;return this.map(function(){return jQuery.clone(this,dataAndEvents,deepDataAndEvents)})},html:function(value){return access(this,function(value){var elem=this[0]||{},i=0,l=this.length;if(void 0===value&&1===elem.nodeType)return elem.innerHTML;if("string"==typeof value&&!rnoInnerhtml.test(value)&&!wrapMap[(rtagName.exec(value)||["",""])[1].toLowerCase()]){value=jQuery.htmlPrefilter(value);try{for(;l>i;i++){elem=this[i]||{};if(1===elem.nodeType){jQuery.cleanData(getAll(elem,!1));elem.innerHTML=value}}elem=0}catch(e){}}elem&&this.empty().append(value)},null,value,arguments.length)},replaceWith:function(){var ignored=[];return domManip(this,arguments,function(elem){var parent=this.parentNode;if(jQuery.inArray(this,ignored)<0){jQuery.cleanData(getAll(this));parent&&parent.replaceChild(elem,this)}},ignored)}});jQuery.each({appendTo:"append",prependTo:"prepend",insertBefore:"before",insertAfter:"after",replaceAll:"replaceWith"},function(name,original){jQuery.fn[name]=function(selector){for(var elems,ret=[],insert=jQuery(selector),last=insert.length-1,i=0;last>=i;i++){elems=i===last?this:this.clone(!0);jQuery(insert[i])[original](elems);push.apply(ret,elems.get())}return this.pushStack(ret)}});var iframe,elemdisplay={HTML:"block",BODY:"block"},rmargin=/^margin/,rnumnonpx=new RegExp("^("+pnum+")(?!px)[a-z%]+$","i"),getStyles=function(elem){var view=elem.ownerDocument.defaultView;view&&view.opener||(view=window);return view.getComputedStyle(elem)},swap=function(elem,options,callback,args){var ret,name,old={};for(name in options){old[name]=elem.style[name];elem.style[name]=options[name]}ret=callback.apply(elem,args||[]);for(name in options)elem.style[name]=old[name];return ret},documentElement=document.documentElement;!function(){function computeStyleTests(){div.style.cssText="-webkit-box-sizing:border-box;-moz-box-sizing:border-box;box-sizing:border-box;position:relative;display:block;margin:auto;border:1px;padding:1px;top:1%;width:50%";div.innerHTML="";documentElement.appendChild(container);var divStyle=window.getComputedStyle(div);pixelPositionVal="1%"!==divStyle.top;reliableMarginLeftVal="2px"===divStyle.marginLeft;boxSizingReliableVal="4px"===divStyle.width;div.style.marginRight="50%";pixelMarginRightVal="4px"===divStyle.marginRight;documentElement.removeChild(container)}var pixelPositionVal,boxSizingReliableVal,pixelMarginRightVal,reliableMarginLeftVal,container=document.createElement("div"),div=document.createElement("div");if(div.style){div.style.backgroundClip="content-box";div.cloneNode(!0).style.backgroundClip="";support.clearCloneStyle="content-box"===div.style.backgroundClip;container.style.cssText="border:0;width:8px;height:0;top:0;left:-9999px;padding:0;margin-top:1px;position:absolute";container.appendChild(div);jQuery.extend(support,{pixelPosition:function(){computeStyleTests();return pixelPositionVal},boxSizingReliable:function(){null==boxSizingReliableVal&&computeStyleTests();return boxSizingReliableVal},pixelMarginRight:function(){null==boxSizingReliableVal&&computeStyleTests();return pixelMarginRightVal},reliableMarginLeft:function(){null==boxSizingReliableVal&&computeStyleTests();return reliableMarginLeftVal},reliableMarginRight:function(){var ret,marginDiv=div.appendChild(document.createElement("div"));marginDiv.style.cssText=div.style.cssText="-webkit-box-sizing:content-box;box-sizing:content-box;display:block;margin:0;border:0;padding:0";marginDiv.style.marginRight=marginDiv.style.width="0";div.style.width="1px";documentElement.appendChild(container);ret=!parseFloat(window.getComputedStyle(marginDiv).marginRight);documentElement.removeChild(container);div.removeChild(marginDiv);return ret}})}}();var rdisplayswap=/^(none|table(?!-c[ea]).+)/,cssShow={position:"absolute",visibility:"hidden",display:"block"},cssNormalTransform={letterSpacing:"0",fontWeight:"400"},cssPrefixes=["Webkit","O","Moz","ms"],emptyStyle=document.createElement("div").style;jQuery.extend({cssHooks:{opacity:{get:function(elem,computed){if(computed){var ret=curCSS(elem,"opacity");return""===ret?"1":ret}}}},cssNumber:{animationIterationCount:!0,columnCount:!0,fillOpacity:!0,flexGrow:!0,flexShrink:!0,fontWeight:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,widows:!0,zIndex:!0,zoom:!0},cssProps:{"float":"cssFloat"},style:function(elem,name,value,extra){if(elem&&3!==elem.nodeType&&8!==elem.nodeType&&elem.style){var ret,type,hooks,origName=jQuery.camelCase(name),style=elem.style;name=jQuery.cssProps[origName]||(jQuery.cssProps[origName]=vendorPropName(origName)||origName);hooks=jQuery.cssHooks[name]||jQuery.cssHooks[origName];if(void 0===value)return hooks&&"get"in hooks&&void 0!==(ret=hooks.get(elem,!1,extra))?ret:style[name];type=typeof value;if("string"===type&&(ret=rcssNum.exec(value))&&ret[1]){value=adjustCSS(elem,name,ret);type="number"}if(null!=value&&value===value){"number"===type&&(value+=ret&&ret[3]||(jQuery.cssNumber[origName]?"":"px"));support.clearCloneStyle||""!==value||0!==name.indexOf("background")||(style[name]="inherit");hooks&&"set"in hooks&&void 0===(value=hooks.set(elem,value,extra))||(style[name]=value)}}},css:function(elem,name,extra,styles){var val,num,hooks,origName=jQuery.camelCase(name);name=jQuery.cssProps[origName]||(jQuery.cssProps[origName]=vendorPropName(origName)||origName);hooks=jQuery.cssHooks[name]||jQuery.cssHooks[origName];hooks&&"get"in hooks&&(val=hooks.get(elem,!0,extra));void 0===val&&(val=curCSS(elem,name,styles));"normal"===val&&name in cssNormalTransform&&(val=cssNormalTransform[name]);if(""===extra||extra){num=parseFloat(val);return extra===!0||isFinite(num)?num||0:val}return val}});jQuery.each(["height","width"],function(i,name){jQuery.cssHooks[name]={get:function(elem,computed,extra){return computed?rdisplayswap.test(jQuery.css(elem,"display"))&&0===elem.offsetWidth?swap(elem,cssShow,function(){return getWidthOrHeight(elem,name,extra)}):getWidthOrHeight(elem,name,extra):void 0},set:function(elem,value,extra){var matches,styles=extra&&getStyles(elem),subtract=extra&&augmentWidthOrHeight(elem,name,extra,"border-box"===jQuery.css(elem,"boxSizing",!1,styles),styles);if(subtract&&(matches=rcssNum.exec(value))&&"px"!==(matches[3]||"px")){elem.style[name]=value;value=jQuery.css(elem,name)}return setPositiveNumber(elem,value,subtract)}}});jQuery.cssHooks.marginLeft=addGetHookIf(support.reliableMarginLeft,function(elem,computed){return computed?(parseFloat(curCSS(elem,"marginLeft"))||elem.getBoundingClientRect().left-swap(elem,{marginLeft:0},function(){return elem.getBoundingClientRect().left}))+"px":void 0});jQuery.cssHooks.marginRight=addGetHookIf(support.reliableMarginRight,function(elem,computed){return computed?swap(elem,{display:"inline-block"},curCSS,[elem,"marginRight"]):void 0});jQuery.each({margin:"",padding:"",border:"Width"},function(prefix,suffix){jQuery.cssHooks[prefix+suffix]={expand:function(value){for(var i=0,expanded={},parts="string"==typeof value?value.split(" "):[value];4>i;i++)expanded[prefix+cssExpand[i]+suffix]=parts[i]||parts[i-2]||parts[0];return expanded}};rmargin.test(prefix)||(jQuery.cssHooks[prefix+suffix].set=setPositiveNumber)});jQuery.fn.extend({css:function(name,value){return access(this,function(elem,name,value){var styles,len,map={},i=0;if(jQuery.isArray(name)){styles=getStyles(elem);len=name.length;for(;len>i;i++)map[name[i]]=jQuery.css(elem,name[i],!1,styles);return map}return void 0!==value?jQuery.style(elem,name,value):jQuery.css(elem,name)},name,value,arguments.length>1)},show:function(){return showHide(this,!0)},hide:function(){return showHide(this)},toggle:function(state){return"boolean"==typeof state?state?this.show():this.hide():this.each(function(){isHidden(this)?jQuery(this).show():jQuery(this).hide()})}});jQuery.Tween=Tween;Tween.prototype={constructor:Tween,init:function(elem,options,prop,end,easing,unit){this.elem=elem;this.prop=prop;this.easing=easing||jQuery.easing._default;this.options=options;this.start=this.now=this.cur();this.end=end;this.unit=unit||(jQuery.cssNumber[prop]?"":"px")},cur:function(){var hooks=Tween.propHooks[this.prop];return hooks&&hooks.get?hooks.get(this):Tween.propHooks._default.get(this)},run:function(percent){var eased,hooks=Tween.propHooks[this.prop];this.options.duration?this.pos=eased=jQuery.easing[this.easing](percent,this.options.duration*percent,0,1,this.options.duration):this.pos=eased=percent;this.now=(this.end-this.start)*eased+this.start;this.options.step&&this.options.step.call(this.elem,this.now,this);hooks&&hooks.set?hooks.set(this):Tween.propHooks._default.set(this);return this}};Tween.prototype.init.prototype=Tween.prototype;Tween.propHooks={_default:{get:function(tween){var result;if(1!==tween.elem.nodeType||null!=tween.elem[tween.prop]&&null==tween.elem.style[tween.prop])return tween.elem[tween.prop];result=jQuery.css(tween.elem,tween.prop,"");return result&&"auto"!==result?result:0},set:function(tween){jQuery.fx.step[tween.prop]?jQuery.fx.step[tween.prop](tween):1!==tween.elem.nodeType||null==tween.elem.style[jQuery.cssProps[tween.prop]]&&!jQuery.cssHooks[tween.prop]?tween.elem[tween.prop]=tween.now:jQuery.style(tween.elem,tween.prop,tween.now+tween.unit)}}};Tween.propHooks.scrollTop=Tween.propHooks.scrollLeft={set:function(tween){tween.elem.nodeType&&tween.elem.parentNode&&(tween.elem[tween.prop]=tween.now)}};jQuery.easing={linear:function(p){return p},swing:function(p){return.5-Math.cos(p*Math.PI)/2},_default:"swing"};jQuery.fx=Tween.prototype.init;jQuery.fx.step={};var fxNow,timerId,rfxtypes=/^(?:toggle|show|hide)$/,rrun=/queueHooks$/;jQuery.Animation=jQuery.extend(Animation,{tweeners:{"*":[function(prop,value){var tween=this.createTween(prop,value);adjustCSS(tween.elem,prop,rcssNum.exec(value),tween);return tween}]},tweener:function(props,callback){if(jQuery.isFunction(props)){callback=props;props=["*"]}else props=props.match(rnotwhite);for(var prop,index=0,length=props.length;length>index;index++){prop=props[index];Animation.tweeners[prop]=Animation.tweeners[prop]||[];Animation.tweeners[prop].unshift(callback)}},prefilters:[defaultPrefilter],prefilter:function(callback,prepend){prepend?Animation.prefilters.unshift(callback):Animation.prefilters.push(callback)}});jQuery.speed=function(speed,easing,fn){var opt=speed&&"object"==typeof speed?jQuery.extend({},speed):{complete:fn||!fn&&easing||jQuery.isFunction(speed)&&speed,duration:speed,easing:fn&&easing||easing&&!jQuery.isFunction(easing)&&easing};opt.duration=jQuery.fx.off?0:"number"==typeof opt.duration?opt.duration:opt.duration in jQuery.fx.speeds?jQuery.fx.speeds[opt.duration]:jQuery.fx.speeds._default;(null==opt.queue||opt.queue===!0)&&(opt.queue="fx");opt.old=opt.complete;opt.complete=function(){jQuery.isFunction(opt.old)&&opt.old.call(this);opt.queue&&jQuery.dequeue(this,opt.queue)};return opt};jQuery.fn.extend({fadeTo:function(speed,to,easing,callback){return this.filter(isHidden).css("opacity",0).show().end().animate({opacity:to},speed,easing,callback)},animate:function(prop,speed,easing,callback){var empty=jQuery.isEmptyObject(prop),optall=jQuery.speed(speed,easing,callback),doAnimation=function(){
var anim=Animation(this,jQuery.extend({},prop),optall);(empty||dataPriv.get(this,"finish"))&&anim.stop(!0)};doAnimation.finish=doAnimation;return empty||optall.queue===!1?this.each(doAnimation):this.queue(optall.queue,doAnimation)},stop:function(type,clearQueue,gotoEnd){var stopQueue=function(hooks){var stop=hooks.stop;delete hooks.stop;stop(gotoEnd)};if("string"!=typeof type){gotoEnd=clearQueue;clearQueue=type;type=void 0}clearQueue&&type!==!1&&this.queue(type||"fx",[]);return this.each(function(){var dequeue=!0,index=null!=type&&type+"queueHooks",timers=jQuery.timers,data=dataPriv.get(this);if(index)data[index]&&data[index].stop&&stopQueue(data[index]);else for(index in data)data[index]&&data[index].stop&&rrun.test(index)&&stopQueue(data[index]);for(index=timers.length;index--;)if(timers[index].elem===this&&(null==type||timers[index].queue===type)){timers[index].anim.stop(gotoEnd);dequeue=!1;timers.splice(index,1)}(dequeue||!gotoEnd)&&jQuery.dequeue(this,type)})},finish:function(type){type!==!1&&(type=type||"fx");return this.each(function(){var index,data=dataPriv.get(this),queue=data[type+"queue"],hooks=data[type+"queueHooks"],timers=jQuery.timers,length=queue?queue.length:0;data.finish=!0;jQuery.queue(this,type,[]);hooks&&hooks.stop&&hooks.stop.call(this,!0);for(index=timers.length;index--;)if(timers[index].elem===this&&timers[index].queue===type){timers[index].anim.stop(!0);timers.splice(index,1)}for(index=0;length>index;index++)queue[index]&&queue[index].finish&&queue[index].finish.call(this);delete data.finish})}});jQuery.each(["toggle","show","hide"],function(i,name){var cssFn=jQuery.fn[name];jQuery.fn[name]=function(speed,easing,callback){return null==speed||"boolean"==typeof speed?cssFn.apply(this,arguments):this.animate(genFx(name,!0),speed,easing,callback)}});jQuery.each({slideDown:genFx("show"),slideUp:genFx("hide"),slideToggle:genFx("toggle"),fadeIn:{opacity:"show"},fadeOut:{opacity:"hide"},fadeToggle:{opacity:"toggle"}},function(name,props){jQuery.fn[name]=function(speed,easing,callback){return this.animate(props,speed,easing,callback)}});jQuery.timers=[];jQuery.fx.tick=function(){var timer,i=0,timers=jQuery.timers;fxNow=jQuery.now();for(;i<timers.length;i++){timer=timers[i];timer()||timers[i]!==timer||timers.splice(i--,1)}timers.length||jQuery.fx.stop();fxNow=void 0};jQuery.fx.timer=function(timer){jQuery.timers.push(timer);timer()?jQuery.fx.start():jQuery.timers.pop()};jQuery.fx.interval=13;jQuery.fx.start=function(){timerId||(timerId=window.setInterval(jQuery.fx.tick,jQuery.fx.interval))};jQuery.fx.stop=function(){window.clearInterval(timerId);timerId=null};jQuery.fx.speeds={slow:600,fast:200,_default:400};jQuery.fn.delay=function(time,type){time=jQuery.fx?jQuery.fx.speeds[time]||time:time;type=type||"fx";return this.queue(type,function(next,hooks){var timeout=window.setTimeout(next,time);hooks.stop=function(){window.clearTimeout(timeout)}})};!function(){var input=document.createElement("input"),select=document.createElement("select"),opt=select.appendChild(document.createElement("option"));input.type="checkbox";support.checkOn=""!==input.value;support.optSelected=opt.selected;select.disabled=!0;support.optDisabled=!opt.disabled;input=document.createElement("input");input.value="t";input.type="radio";support.radioValue="t"===input.value}();var boolHook,attrHandle=jQuery.expr.attrHandle;jQuery.fn.extend({attr:function(name,value){return access(this,jQuery.attr,name,value,arguments.length>1)},removeAttr:function(name){return this.each(function(){jQuery.removeAttr(this,name)})}});jQuery.extend({attr:function(elem,name,value){var ret,hooks,nType=elem.nodeType;if(3!==nType&&8!==nType&&2!==nType){if("undefined"==typeof elem.getAttribute)return jQuery.prop(elem,name,value);if(1!==nType||!jQuery.isXMLDoc(elem)){name=name.toLowerCase();hooks=jQuery.attrHooks[name]||(jQuery.expr.match.bool.test(name)?boolHook:void 0)}if(void 0!==value){if(null===value){jQuery.removeAttr(elem,name);return}if(hooks&&"set"in hooks&&void 0!==(ret=hooks.set(elem,value,name)))return ret;elem.setAttribute(name,value+"");return value}if(hooks&&"get"in hooks&&null!==(ret=hooks.get(elem,name)))return ret;ret=jQuery.find.attr(elem,name);return null==ret?void 0:ret}},attrHooks:{type:{set:function(elem,value){if(!support.radioValue&&"radio"===value&&jQuery.nodeName(elem,"input")){var val=elem.value;elem.setAttribute("type",value);val&&(elem.value=val);return value}}}},removeAttr:function(elem,value){var name,propName,i=0,attrNames=value&&value.match(rnotwhite);if(attrNames&&1===elem.nodeType)for(;name=attrNames[i++];){propName=jQuery.propFix[name]||name;jQuery.expr.match.bool.test(name)&&(elem[propName]=!1);elem.removeAttribute(name)}}});boolHook={set:function(elem,value,name){value===!1?jQuery.removeAttr(elem,name):elem.setAttribute(name,name);return name}};jQuery.each(jQuery.expr.match.bool.source.match(/\w+/g),function(i,name){var getter=attrHandle[name]||jQuery.find.attr;attrHandle[name]=function(elem,name,isXML){var ret,handle;if(!isXML){handle=attrHandle[name];attrHandle[name]=ret;ret=null!=getter(elem,name,isXML)?name.toLowerCase():null;attrHandle[name]=handle}return ret}});var rfocusable=/^(?:input|select|textarea|button)$/i,rclickable=/^(?:a|area)$/i;jQuery.fn.extend({prop:function(name,value){return access(this,jQuery.prop,name,value,arguments.length>1)},removeProp:function(name){return this.each(function(){delete this[jQuery.propFix[name]||name]})}});jQuery.extend({prop:function(elem,name,value){var ret,hooks,nType=elem.nodeType;if(3!==nType&&8!==nType&&2!==nType){if(1!==nType||!jQuery.isXMLDoc(elem)){name=jQuery.propFix[name]||name;hooks=jQuery.propHooks[name]}return void 0!==value?hooks&&"set"in hooks&&void 0!==(ret=hooks.set(elem,value,name))?ret:elem[name]=value:hooks&&"get"in hooks&&null!==(ret=hooks.get(elem,name))?ret:elem[name]}},propHooks:{tabIndex:{get:function(elem){var tabindex=jQuery.find.attr(elem,"tabindex");return tabindex?parseInt(tabindex,10):rfocusable.test(elem.nodeName)||rclickable.test(elem.nodeName)&&elem.href?0:-1}}},propFix:{"for":"htmlFor","class":"className"}});support.optSelected||(jQuery.propHooks.selected={get:function(elem){var parent=elem.parentNode;parent&&parent.parentNode&&parent.parentNode.selectedIndex;return null},set:function(elem){var parent=elem.parentNode;if(parent){parent.selectedIndex;parent.parentNode&&parent.parentNode.selectedIndex}}});jQuery.each(["tabIndex","readOnly","maxLength","cellSpacing","cellPadding","rowSpan","colSpan","useMap","frameBorder","contentEditable"],function(){jQuery.propFix[this.toLowerCase()]=this});var rclass=/[\t\r\n\f]/g;jQuery.fn.extend({addClass:function(value){var classes,elem,cur,curValue,clazz,j,finalValue,i=0;if(jQuery.isFunction(value))return this.each(function(j){jQuery(this).addClass(value.call(this,j,getClass(this)))});if("string"==typeof value&&value){classes=value.match(rnotwhite)||[];for(;elem=this[i++];){curValue=getClass(elem);cur=1===elem.nodeType&&(" "+curValue+" ").replace(rclass," ");if(cur){j=0;for(;clazz=classes[j++];)cur.indexOf(" "+clazz+" ")<0&&(cur+=clazz+" ");finalValue=jQuery.trim(cur);curValue!==finalValue&&elem.setAttribute("class",finalValue)}}}return this},removeClass:function(value){var classes,elem,cur,curValue,clazz,j,finalValue,i=0;if(jQuery.isFunction(value))return this.each(function(j){jQuery(this).removeClass(value.call(this,j,getClass(this)))});if(!arguments.length)return this.attr("class","");if("string"==typeof value&&value){classes=value.match(rnotwhite)||[];for(;elem=this[i++];){curValue=getClass(elem);cur=1===elem.nodeType&&(" "+curValue+" ").replace(rclass," ");if(cur){j=0;for(;clazz=classes[j++];)for(;cur.indexOf(" "+clazz+" ")>-1;)cur=cur.replace(" "+clazz+" "," ");finalValue=jQuery.trim(cur);curValue!==finalValue&&elem.setAttribute("class",finalValue)}}}return this},toggleClass:function(value,stateVal){var type=typeof value;return"boolean"==typeof stateVal&&"string"===type?stateVal?this.addClass(value):this.removeClass(value):jQuery.isFunction(value)?this.each(function(i){jQuery(this).toggleClass(value.call(this,i,getClass(this),stateVal),stateVal)}):this.each(function(){var className,i,self,classNames;if("string"===type){i=0;self=jQuery(this);classNames=value.match(rnotwhite)||[];for(;className=classNames[i++];)self.hasClass(className)?self.removeClass(className):self.addClass(className)}else if(void 0===value||"boolean"===type){className=getClass(this);className&&dataPriv.set(this,"__className__",className);this.setAttribute&&this.setAttribute("class",className||value===!1?"":dataPriv.get(this,"__className__")||"")}})},hasClass:function(selector){var className,elem,i=0;className=" "+selector+" ";for(;elem=this[i++];)if(1===elem.nodeType&&(" "+getClass(elem)+" ").replace(rclass," ").indexOf(className)>-1)return!0;return!1}});var rreturn=/\r/g,rspaces=/[\x20\t\r\n\f]+/g;jQuery.fn.extend({val:function(value){var hooks,ret,isFunction,elem=this[0];if(arguments.length){isFunction=jQuery.isFunction(value);return this.each(function(i){var val;if(1===this.nodeType){val=isFunction?value.call(this,i,jQuery(this).val()):value;null==val?val="":"number"==typeof val?val+="":jQuery.isArray(val)&&(val=jQuery.map(val,function(value){return null==value?"":value+""}));hooks=jQuery.valHooks[this.type]||jQuery.valHooks[this.nodeName.toLowerCase()];hooks&&"set"in hooks&&void 0!==hooks.set(this,val,"value")||(this.value=val)}})}if(elem){hooks=jQuery.valHooks[elem.type]||jQuery.valHooks[elem.nodeName.toLowerCase()];if(hooks&&"get"in hooks&&void 0!==(ret=hooks.get(elem,"value")))return ret;ret=elem.value;return"string"==typeof ret?ret.replace(rreturn,""):null==ret?"":ret}}});jQuery.extend({valHooks:{option:{get:function(elem){var val=jQuery.find.attr(elem,"value");return null!=val?val:jQuery.trim(jQuery.text(elem)).replace(rspaces," ")}},select:{get:function(elem){for(var value,option,options=elem.options,index=elem.selectedIndex,one="select-one"===elem.type||0>index,values=one?null:[],max=one?index+1:options.length,i=0>index?max:one?index:0;max>i;i++){option=options[i];if((option.selected||i===index)&&(support.optDisabled?!option.disabled:null===option.getAttribute("disabled"))&&(!option.parentNode.disabled||!jQuery.nodeName(option.parentNode,"optgroup"))){value=jQuery(option).val();if(one)return value;values.push(value)}}return values},set:function(elem,value){for(var optionSet,option,options=elem.options,values=jQuery.makeArray(value),i=options.length;i--;){option=options[i];(option.selected=jQuery.inArray(jQuery.valHooks.option.get(option),values)>-1)&&(optionSet=!0)}optionSet||(elem.selectedIndex=-1);return values}}}});jQuery.each(["radio","checkbox"],function(){jQuery.valHooks[this]={set:function(elem,value){return jQuery.isArray(value)?elem.checked=jQuery.inArray(jQuery(elem).val(),value)>-1:void 0}};support.checkOn||(jQuery.valHooks[this].get=function(elem){return null===elem.getAttribute("value")?"on":elem.value})});var rfocusMorph=/^(?:focusinfocus|focusoutblur)$/;jQuery.extend(jQuery.event,{trigger:function(event,data,elem,onlyHandlers){var i,cur,tmp,bubbleType,ontype,handle,special,eventPath=[elem||document],type=hasOwn.call(event,"type")?event.type:event,namespaces=hasOwn.call(event,"namespace")?event.namespace.split("."):[];cur=tmp=elem=elem||document;if(3!==elem.nodeType&&8!==elem.nodeType&&!rfocusMorph.test(type+jQuery.event.triggered)){if(type.indexOf(".")>-1){namespaces=type.split(".");type=namespaces.shift();namespaces.sort()}ontype=type.indexOf(":")<0&&"on"+type;event=event[jQuery.expando]?event:new jQuery.Event(type,"object"==typeof event&&event);event.isTrigger=onlyHandlers?2:3;event.namespace=namespaces.join(".");event.rnamespace=event.namespace?new RegExp("(^|\\.)"+namespaces.join("\\.(?:.*\\.|)")+"(\\.|$)"):null;event.result=void 0;event.target||(event.target=elem);data=null==data?[event]:jQuery.makeArray(data,[event]);special=jQuery.event.special[type]||{};if(onlyHandlers||!special.trigger||special.trigger.apply(elem,data)!==!1){if(!onlyHandlers&&!special.noBubble&&!jQuery.isWindow(elem)){bubbleType=special.delegateType||type;rfocusMorph.test(bubbleType+type)||(cur=cur.parentNode);for(;cur;cur=cur.parentNode){eventPath.push(cur);tmp=cur}tmp===(elem.ownerDocument||document)&&eventPath.push(tmp.defaultView||tmp.parentWindow||window)}i=0;for(;(cur=eventPath[i++])&&!event.isPropagationStopped();){event.type=i>1?bubbleType:special.bindType||type;handle=(dataPriv.get(cur,"events")||{})[event.type]&&dataPriv.get(cur,"handle");handle&&handle.apply(cur,data);handle=ontype&&cur[ontype];if(handle&&handle.apply&&acceptData(cur)){event.result=handle.apply(cur,data);event.result===!1&&event.preventDefault()}}event.type=type;if(!onlyHandlers&&!event.isDefaultPrevented()&&(!special._default||special._default.apply(eventPath.pop(),data)===!1)&&acceptData(elem)&&ontype&&jQuery.isFunction(elem[type])&&!jQuery.isWindow(elem)){tmp=elem[ontype];tmp&&(elem[ontype]=null);jQuery.event.triggered=type;elem[type]();jQuery.event.triggered=void 0;tmp&&(elem[ontype]=tmp)}return event.result}}},simulate:function(type,elem,event){var e=jQuery.extend(new jQuery.Event,event,{type:type,isSimulated:!0});jQuery.event.trigger(e,null,elem)}});jQuery.fn.extend({trigger:function(type,data){return this.each(function(){jQuery.event.trigger(type,data,this)})},triggerHandler:function(type,data){var elem=this[0];return elem?jQuery.event.trigger(type,data,elem,!0):void 0}});jQuery.each("blur focus focusin focusout load resize scroll unload click dblclick mousedown mouseup mousemove mouseover mouseout mouseenter mouseleave change select submit keydown keypress keyup error contextmenu".split(" "),function(i,name){jQuery.fn[name]=function(data,fn){return arguments.length>0?this.on(name,null,data,fn):this.trigger(name)}});jQuery.fn.extend({hover:function(fnOver,fnOut){return this.mouseenter(fnOver).mouseleave(fnOut||fnOver)}});support.focusin="onfocusin"in window;support.focusin||jQuery.each({focus:"focusin",blur:"focusout"},function(orig,fix){var handler=function(event){jQuery.event.simulate(fix,event.target,jQuery.event.fix(event))};jQuery.event.special[fix]={setup:function(){var doc=this.ownerDocument||this,attaches=dataPriv.access(doc,fix);attaches||doc.addEventListener(orig,handler,!0);dataPriv.access(doc,fix,(attaches||0)+1)},teardown:function(){var doc=this.ownerDocument||this,attaches=dataPriv.access(doc,fix)-1;if(attaches)dataPriv.access(doc,fix,attaches);else{doc.removeEventListener(orig,handler,!0);dataPriv.remove(doc,fix)}}}});var location=window.location,nonce=jQuery.now(),rquery=/\?/;jQuery.parseJSON=function(data){return JSON.parse(data+"")};jQuery.parseXML=function(data){var xml;if(!data||"string"!=typeof data)return null;try{xml=(new window.DOMParser).parseFromString(data,"text/xml")}catch(e){xml=void 0}(!xml||xml.getElementsByTagName("parsererror").length)&&jQuery.error("Invalid XML: "+data);return xml};var rhash=/#.*$/,rts=/([?&])_=[^&]*/,rheaders=/^(.*?):[ \t]*([^\r\n]*)$/gm,rlocalProtocol=/^(?:about|app|app-storage|.+-extension|file|res|widget):$/,rnoContent=/^(?:GET|HEAD)$/,rprotocol=/^\/\//,prefilters={},transports={},allTypes="*/".concat("*"),originAnchor=document.createElement("a");originAnchor.href=location.href;jQuery.extend({active:0,lastModified:{},etag:{},ajaxSettings:{url:location.href,type:"GET",isLocal:rlocalProtocol.test(location.protocol),global:!0,processData:!0,async:!0,contentType:"application/x-www-form-urlencoded; charset=UTF-8",accepts:{"*":allTypes,text:"text/plain",html:"text/html",xml:"application/xml, text/xml",json:"application/json, text/javascript"},contents:{xml:/\bxml\b/,html:/\bhtml/,json:/\bjson\b/},responseFields:{xml:"responseXML",text:"responseText",json:"responseJSON"},converters:{"* text":String,"text html":!0,"text json":jQuery.parseJSON,"text xml":jQuery.parseXML},flatOptions:{url:!0,context:!0}},ajaxSetup:function(target,settings){return settings?ajaxExtend(ajaxExtend(target,jQuery.ajaxSettings),settings):ajaxExtend(jQuery.ajaxSettings,target)},ajaxPrefilter:addToPrefiltersOrTransports(prefilters),ajaxTransport:addToPrefiltersOrTransports(transports),ajax:function(url,options){function done(status,nativeStatusText,responses,headers){var isSuccess,success,error,response,modified,statusText=nativeStatusText;if(2!==state){state=2;timeoutTimer&&window.clearTimeout(timeoutTimer);transport=void 0;responseHeadersString=headers||"";jqXHR.readyState=status>0?4:0;isSuccess=status>=200&&300>status||304===status;responses&&(response=ajaxHandleResponses(s,jqXHR,responses));response=ajaxConvert(s,response,jqXHR,isSuccess);if(isSuccess){if(s.ifModified){modified=jqXHR.getResponseHeader("Last-Modified");modified&&(jQuery.lastModified[cacheURL]=modified);modified=jqXHR.getResponseHeader("etag");modified&&(jQuery.etag[cacheURL]=modified)}if(204===status||"HEAD"===s.type)statusText="nocontent";else if(304===status)statusText="notmodified";else{statusText=response.state;success=response.data;error=response.error;isSuccess=!error}}else{error=statusText;if(status||!statusText){statusText="error";0>status&&(status=0)}}jqXHR.status=status;jqXHR.statusText=(nativeStatusText||statusText)+"";isSuccess?deferred.resolveWith(callbackContext,[success,statusText,jqXHR]):deferred.rejectWith(callbackContext,[jqXHR,statusText,error]);jqXHR.statusCode(statusCode);statusCode=void 0;fireGlobals&&globalEventContext.trigger(isSuccess?"ajaxSuccess":"ajaxError",[jqXHR,s,isSuccess?success:error]);completeDeferred.fireWith(callbackContext,[jqXHR,statusText]);if(fireGlobals){globalEventContext.trigger("ajaxComplete",[jqXHR,s]);--jQuery.active||jQuery.event.trigger("ajaxStop")}}}if("object"==typeof url){options=url;url=void 0}options=options||{};var transport,cacheURL,responseHeadersString,responseHeaders,timeoutTimer,urlAnchor,fireGlobals,i,s=jQuery.ajaxSetup({},options),callbackContext=s.context||s,globalEventContext=s.context&&(callbackContext.nodeType||callbackContext.jquery)?jQuery(callbackContext):jQuery.event,deferred=jQuery.Deferred(),completeDeferred=jQuery.Callbacks("once memory"),statusCode=s.statusCode||{},requestHeaders={},requestHeadersNames={},state=0,strAbort="canceled",jqXHR={readyState:0,getResponseHeader:function(key){var match;if(2===state){if(!responseHeaders){responseHeaders={};for(;match=rheaders.exec(responseHeadersString);)responseHeaders[match[1].toLowerCase()]=match[2]}match=responseHeaders[key.toLowerCase()]}return null==match?null:match},getAllResponseHeaders:function(){return 2===state?responseHeadersString:null},setRequestHeader:function(name,value){var lname=name.toLowerCase();if(!state){name=requestHeadersNames[lname]=requestHeadersNames[lname]||name;requestHeaders[name]=value}return this},overrideMimeType:function(type){state||(s.mimeType=type);return this},statusCode:function(map){var code;if(map)if(2>state)for(code in map)statusCode[code]=[statusCode[code],map[code]];else jqXHR.always(map[jqXHR.status]);return this},abort:function(statusText){var finalText=statusText||strAbort;transport&&transport.abort(finalText);done(0,finalText);return this}};deferred.promise(jqXHR).complete=completeDeferred.add;jqXHR.success=jqXHR.done;jqXHR.error=jqXHR.fail;s.url=((url||s.url||location.href)+"").replace(rhash,"").replace(rprotocol,location.protocol+"//");s.type=options.method||options.type||s.method||s.type;s.dataTypes=jQuery.trim(s.dataType||"*").toLowerCase().match(rnotwhite)||[""];if(null==s.crossDomain){urlAnchor=document.createElement("a");try{urlAnchor.href=s.url;urlAnchor.href=urlAnchor.href;s.crossDomain=originAnchor.protocol+"//"+originAnchor.host!=urlAnchor.protocol+"//"+urlAnchor.host}catch(e){s.crossDomain=!0}}s.data&&s.processData&&"string"!=typeof s.data&&(s.data=jQuery.param(s.data,s.traditional));inspectPrefiltersOrTransports(prefilters,s,options,jqXHR);if(2===state)return jqXHR;fireGlobals=jQuery.event&&s.global;fireGlobals&&0===jQuery.active++&&jQuery.event.trigger("ajaxStart");s.type=s.type.toUpperCase();s.hasContent=!rnoContent.test(s.type);cacheURL=s.url;if(!s.hasContent){if(s.data){cacheURL=s.url+=(rquery.test(cacheURL)?"&":"?")+s.data;delete s.data}s.cache===!1&&(s.url=rts.test(cacheURL)?cacheURL.replace(rts,"$1_="+nonce++):cacheURL+(rquery.test(cacheURL)?"&":"?")+"_="+nonce++)}if(s.ifModified){jQuery.lastModified[cacheURL]&&jqXHR.setRequestHeader("If-Modified-Since",jQuery.lastModified[cacheURL]);jQuery.etag[cacheURL]&&jqXHR.setRequestHeader("If-None-Match",jQuery.etag[cacheURL])}(s.data&&s.hasContent&&s.contentType!==!1||options.contentType)&&jqXHR.setRequestHeader("Content-Type",s.contentType);jqXHR.setRequestHeader("Accept",s.dataTypes[0]&&s.accepts[s.dataTypes[0]]?s.accepts[s.dataTypes[0]]+("*"!==s.dataTypes[0]?", "+allTypes+"; q=0.01":""):s.accepts["*"]);for(i in s.headers)jqXHR.setRequestHeader(i,s.headers[i]);if(s.beforeSend&&(s.beforeSend.call(callbackContext,jqXHR,s)===!1||2===state))return jqXHR.abort();strAbort="abort";for(i in{success:1,error:1,complete:1})jqXHR[i](s[i]);transport=inspectPrefiltersOrTransports(transports,s,options,jqXHR);if(transport){jqXHR.readyState=1;fireGlobals&&globalEventContext.trigger("ajaxSend",[jqXHR,s]);if(2===state)return jqXHR;s.async&&s.timeout>0&&(timeoutTimer=window.setTimeout(function(){jqXHR.abort("timeout")},s.timeout));try{state=1;transport.send(requestHeaders,done)}catch(e){if(!(2>state))throw e;done(-1,e)}}else done(-1,"No Transport");return jqXHR},getJSON:function(url,data,callback){return jQuery.get(url,data,callback,"json")},getScript:function(url,callback){return jQuery.get(url,void 0,callback,"script")}});jQuery.each(["get","post"],function(i,method){jQuery[method]=function(url,data,callback,type){if(jQuery.isFunction(data)){type=type||callback;callback=data;data=void 0}return jQuery.ajax(jQuery.extend({url:url,type:method,dataType:type,data:data,success:callback},jQuery.isPlainObject(url)&&url))}});jQuery._evalUrl=function(url){return jQuery.ajax({url:url,type:"GET",dataType:"script",async:!1,global:!1,"throws":!0})};jQuery.fn.extend({wrapAll:function(html){var wrap;if(jQuery.isFunction(html))return this.each(function(i){jQuery(this).wrapAll(html.call(this,i))});if(this[0]){wrap=jQuery(html,this[0].ownerDocument).eq(0).clone(!0);this[0].parentNode&&wrap.insertBefore(this[0]);wrap.map(function(){for(var elem=this;elem.firstElementChild;)elem=elem.firstElementChild;return elem}).append(this)}return this},wrapInner:function(html){return jQuery.isFunction(html)?this.each(function(i){jQuery(this).wrapInner(html.call(this,i))}):this.each(function(){var self=jQuery(this),contents=self.contents();contents.length?contents.wrapAll(html):self.append(html)})},wrap:function(html){var isFunction=jQuery.isFunction(html);return this.each(function(i){jQuery(this).wrapAll(isFunction?html.call(this,i):html)})},unwrap:function(){return this.parent().each(function(){jQuery.nodeName(this,"body")||jQuery(this).replaceWith(this.childNodes)}).end()}});jQuery.expr.filters.hidden=function(elem){return!jQuery.expr.filters.visible(elem)};jQuery.expr.filters.visible=function(elem){return elem.offsetWidth>0||elem.offsetHeight>0||elem.getClientRects().length>0};var r20=/%20/g,rbracket=/\[\]$/,rCRLF=/\r?\n/g,rsubmitterTypes=/^(?:submit|button|image|reset|file)$/i,rsubmittable=/^(?:input|select|textarea|keygen)/i;jQuery.param=function(a,traditional){var prefix,s=[],add=function(key,value){value=jQuery.isFunction(value)?value():null==value?"":value;s[s.length]=encodeURIComponent(key)+"="+encodeURIComponent(value)};void 0===traditional&&(traditional=jQuery.ajaxSettings&&jQuery.ajaxSettings.traditional);if(jQuery.isArray(a)||a.jquery&&!jQuery.isPlainObject(a))jQuery.each(a,function(){add(this.name,this.value)});else for(prefix in a)buildParams(prefix,a[prefix],traditional,add);return s.join("&").replace(r20,"+")};jQuery.fn.extend({serialize:function(){return jQuery.param(this.serializeArray())},serializeArray:function(){return this.map(function(){var elements=jQuery.prop(this,"elements");return elements?jQuery.makeArray(elements):this}).filter(function(){var type=this.type;return this.name&&!jQuery(this).is(":disabled")&&rsubmittable.test(this.nodeName)&&!rsubmitterTypes.test(type)&&(this.checked||!rcheckableType.test(type))}).map(function(i,elem){var val=jQuery(this).val();return null==val?null:jQuery.isArray(val)?jQuery.map(val,function(val){return{name:elem.name,value:val.replace(rCRLF,"\r\n")}}):{name:elem.name,value:val.replace(rCRLF,"\r\n")}}).get()}});jQuery.ajaxSettings.xhr=function(){try{return new window.XMLHttpRequest}catch(e){}};var xhrSuccessStatus={0:200,1223:204},xhrSupported=jQuery.ajaxSettings.xhr();support.cors=!!xhrSupported&&"withCredentials"in xhrSupported;support.ajax=xhrSupported=!!xhrSupported;jQuery.ajaxTransport(function(options){var callback,errorCallback;return support.cors||xhrSupported&&!options.crossDomain?{send:function(headers,complete){var i,xhr=options.xhr();xhr.open(options.type,options.url,options.async,options.username,options.password);if(options.xhrFields)for(i in options.xhrFields)xhr[i]=options.xhrFields[i];options.mimeType&&xhr.overrideMimeType&&xhr.overrideMimeType(options.mimeType);options.crossDomain||headers["X-Requested-With"]||(headers["X-Requested-With"]="XMLHttpRequest");for(i in headers)xhr.setRequestHeader(i,headers[i]);callback=function(type){return function(){if(callback){callback=errorCallback=xhr.onload=xhr.onerror=xhr.onabort=xhr.onreadystatechange=null;"abort"===type?xhr.abort():"error"===type?"number"!=typeof xhr.status?complete(0,"error"):complete(xhr.status,xhr.statusText):complete(xhrSuccessStatus[xhr.status]||xhr.status,xhr.statusText,"text"!==(xhr.responseType||"text")||"string"!=typeof xhr.responseText?{binary:xhr.response}:{text:xhr.responseText},xhr.getAllResponseHeaders())}}};xhr.onload=callback();errorCallback=xhr.onerror=callback("error");void 0!==xhr.onabort?xhr.onabort=errorCallback:xhr.onreadystatechange=function(){4===xhr.readyState&&window.setTimeout(function(){callback&&errorCallback()})};callback=callback("abort");try{xhr.send(options.hasContent&&options.data||null)}catch(e){if(callback)throw e}},abort:function(){callback&&callback()}}:void 0});jQuery.ajaxSetup({accepts:{script:"text/javascript, application/javascript, application/ecmascript, application/x-ecmascript"},contents:{script:/\b(?:java|ecma)script\b/},converters:{"text script":function(text){jQuery.globalEval(text);return text}}});jQuery.ajaxPrefilter("script",function(s){void 0===s.cache&&(s.cache=!1);s.crossDomain&&(s.type="GET")});jQuery.ajaxTransport("script",function(s){if(s.crossDomain){var script,callback;return{send:function(_,complete){script=jQuery("<script>").prop({charset:s.scriptCharset,src:s.url}).on("load error",callback=function(evt){script.remove();callback=null;evt&&complete("error"===evt.type?404:200,evt.type)});document.head.appendChild(script[0])},abort:function(){callback&&callback()}}}});var oldCallbacks=[],rjsonp=/(=)\?(?=&|$)|\?\?/;jQuery.ajaxSetup({jsonp:"callback",jsonpCallback:function(){var callback=oldCallbacks.pop()||jQuery.expando+"_"+nonce++;this[callback]=!0;return callback}});jQuery.ajaxPrefilter("json jsonp",function(s,originalSettings,jqXHR){var callbackName,overwritten,responseContainer,jsonProp=s.jsonp!==!1&&(rjsonp.test(s.url)?"url":"string"==typeof s.data&&0===(s.contentType||"").indexOf("application/x-www-form-urlencoded")&&rjsonp.test(s.data)&&"data");if(jsonProp||"jsonp"===s.dataTypes[0]){callbackName=s.jsonpCallback=jQuery.isFunction(s.jsonpCallback)?s.jsonpCallback():s.jsonpCallback;jsonProp?s[jsonProp]=s[jsonProp].replace(rjsonp,"$1"+callbackName):s.jsonp!==!1&&(s.url+=(rquery.test(s.url)?"&":"?")+s.jsonp+"="+callbackName);s.converters["script json"]=function(){responseContainer||jQuery.error(callbackName+" was not called");return responseContainer[0]};s.dataTypes[0]="json";overwritten=window[callbackName];window[callbackName]=function(){responseContainer=arguments};jqXHR.always(function(){void 0===overwritten?jQuery(window).removeProp(callbackName):window[callbackName]=overwritten;if(s[callbackName]){s.jsonpCallback=originalSettings.jsonpCallback;oldCallbacks.push(callbackName)}responseContainer&&jQuery.isFunction(overwritten)&&overwritten(responseContainer[0]);responseContainer=overwritten=void 0});return"script"}});jQuery.parseHTML=function(data,context,keepScripts){if(!data||"string"!=typeof data)return null;if("boolean"==typeof context){keepScripts=context;context=!1}context=context||document;var parsed=rsingleTag.exec(data),scripts=!keepScripts&&[];if(parsed)return[context.createElement(parsed[1])];parsed=buildFragment([data],context,scripts);scripts&&scripts.length&&jQuery(scripts).remove();return jQuery.merge([],parsed.childNodes)};var _load=jQuery.fn.load;jQuery.fn.load=function(url,params,callback){if("string"!=typeof url&&_load)return _load.apply(this,arguments);var selector,type,response,self=this,off=url.indexOf(" ");if(off>-1){selector=jQuery.trim(url.slice(off));url=url.slice(0,off)}if(jQuery.isFunction(params)){callback=params;params=void 0}else params&&"object"==typeof params&&(type="POST");self.length>0&&jQuery.ajax({url:url,type:type||"GET",dataType:"html",data:params}).done(function(responseText){response=arguments;self.html(selector?jQuery("<div>").append(jQuery.parseHTML(responseText)).find(selector):responseText)}).always(callback&&function(jqXHR,status){self.each(function(){callback.apply(this,response||[jqXHR.responseText,status,jqXHR])})});return this};jQuery.each(["ajaxStart","ajaxStop","ajaxComplete","ajaxError","ajaxSuccess","ajaxSend"],function(i,type){jQuery.fn[type]=function(fn){return this.on(type,fn)}});jQuery.expr.filters.animated=function(elem){return jQuery.grep(jQuery.timers,function(fn){return elem===fn.elem}).length};jQuery.offset={setOffset:function(elem,options,i){var curPosition,curLeft,curCSSTop,curTop,curOffset,curCSSLeft,calculatePosition,position=jQuery.css(elem,"position"),curElem=jQuery(elem),props={};"static"===position&&(elem.style.position="relative");curOffset=curElem.offset();curCSSTop=jQuery.css(elem,"top");curCSSLeft=jQuery.css(elem,"left");calculatePosition=("absolute"===position||"fixed"===position)&&(curCSSTop+curCSSLeft).indexOf("auto")>-1;if(calculatePosition){curPosition=curElem.position();curTop=curPosition.top;curLeft=curPosition.left}else{curTop=parseFloat(curCSSTop)||0;curLeft=parseFloat(curCSSLeft)||0}jQuery.isFunction(options)&&(options=options.call(elem,i,jQuery.extend({},curOffset)));null!=options.top&&(props.top=options.top-curOffset.top+curTop);null!=options.left&&(props.left=options.left-curOffset.left+curLeft);"using"in options?options.using.call(elem,props):curElem.css(props)}};jQuery.fn.extend({offset:function(options){if(arguments.length)return void 0===options?this:this.each(function(i){jQuery.offset.setOffset(this,options,i)});var docElem,win,elem=this[0],box={top:0,left:0},doc=elem&&elem.ownerDocument;if(doc){docElem=doc.documentElement;if(!jQuery.contains(docElem,elem))return box;box=elem.getBoundingClientRect();win=getWindow(doc);return{top:box.top+win.pageYOffset-docElem.clientTop,left:box.left+win.pageXOffset-docElem.clientLeft}}},position:function(){if(this[0]){var offsetParent,offset,elem=this[0],parentOffset={top:0,left:0};if("fixed"===jQuery.css(elem,"position"))offset=elem.getBoundingClientRect();else{offsetParent=this.offsetParent();offset=this.offset();jQuery.nodeName(offsetParent[0],"html")||(parentOffset=offsetParent.offset());parentOffset.top+=jQuery.css(offsetParent[0],"borderTopWidth",!0);parentOffset.left+=jQuery.css(offsetParent[0],"borderLeftWidth",!0)}return{top:offset.top-parentOffset.top-jQuery.css(elem,"marginTop",!0),left:offset.left-parentOffset.left-jQuery.css(elem,"marginLeft",!0)}}},offsetParent:function(){return this.map(function(){for(var offsetParent=this.offsetParent;offsetParent&&"static"===jQuery.css(offsetParent,"position");)offsetParent=offsetParent.offsetParent;return offsetParent||documentElement})}});jQuery.each({scrollLeft:"pageXOffset",scrollTop:"pageYOffset"},function(method,prop){var top="pageYOffset"===prop;jQuery.fn[method]=function(val){
return access(this,function(elem,method,val){var win=getWindow(elem);if(void 0===val)return win?win[prop]:elem[method];win?win.scrollTo(top?win.pageXOffset:val,top?val:win.pageYOffset):elem[method]=val},method,val,arguments.length)}});jQuery.each(["top","left"],function(i,prop){jQuery.cssHooks[prop]=addGetHookIf(support.pixelPosition,function(elem,computed){if(computed){computed=curCSS(elem,prop);return rnumnonpx.test(computed)?jQuery(elem).position()[prop]+"px":computed}})});jQuery.each({Height:"height",Width:"width"},function(name,type){jQuery.each({padding:"inner"+name,content:type,"":"outer"+name},function(defaultExtra,funcName){jQuery.fn[funcName]=function(margin,value){var chainable=arguments.length&&(defaultExtra||"boolean"!=typeof margin),extra=defaultExtra||(margin===!0||value===!0?"margin":"border");return access(this,function(elem,type,value){var doc;if(jQuery.isWindow(elem))return elem.document.documentElement["client"+name];if(9===elem.nodeType){doc=elem.documentElement;return Math.max(elem.body["scroll"+name],doc["scroll"+name],elem.body["offset"+name],doc["offset"+name],doc["client"+name])}return void 0===value?jQuery.css(elem,type,extra):jQuery.style(elem,type,value,extra)},type,chainable?margin:void 0,chainable,null)}})});jQuery.fn.extend({bind:function(types,data,fn){return this.on(types,null,data,fn)},unbind:function(types,fn){return this.off(types,null,fn)},delegate:function(selector,types,data,fn){return this.on(types,selector,data,fn)},undelegate:function(selector,types,fn){return 1===arguments.length?this.off(selector,"**"):this.off(types,selector||"**",fn)},size:function(){return this.length}});jQuery.fn.andSelf=jQuery.fn.addBack;"function"==typeof define&&define.amd&&define("jquery",[],function(){return jQuery});var _jQuery=window.jQuery,_$=window.$;jQuery.noConflict=function(deep){window.$===jQuery&&(window.$=_$);deep&&window.jQuery===jQuery&&(window.jQuery=_jQuery);return jQuery};noGlobal||(window.jQuery=window.$=jQuery);return jQuery});define("jquery_loader",["jquery"],function(cvjq){window.cvjq=cvjq.noConflict(!0);return window.cvjq});if("undefined"==typeof jQuery)throw new Error("Bootstrap's JavaScript requires jQuery");+function($){"use strict";var version=$.fn.jquery.split(" ")[0].split(".");if(version[0]<2&&version[1]<9||1==version[0]&&9==version[1]&&version[2]<1||version[0]>3)throw new Error("Bootstrap's JavaScript requires jQuery version 1.9.1 or higher, but lower than version 4")}(jQuery);+function($){"use strict";function Plugin(option,_relatedTarget){return this.each(function(){var $this=$(this),data=$this.data("bs.modal"),options=$.extend({},Modal.DEFAULTS,$this.data(),"object"==typeof option&&option);data||$this.data("bs.modal",data=new Modal(this,options));"string"==typeof option?data[option](_relatedTarget):options.show&&data.show(_relatedTarget)})}var Modal=function(element,options){this.options=options;this.$body=$(document.body);this.$element=$(element);this.$dialog=this.$element.find(".modal-dialog");this.$backdrop=null;this.isShown=null;this.originalBodyPad=null;this.scrollbarWidth=0;this.ignoreBackdropClick=!1;this.options.remote&&this.$element.find(".cv-modal-content").load(this.options.remote,$.proxy(function(){this.$element.trigger("loaded.bs.modal")},this))};Modal.VERSION="3.3.7";Modal.TRANSITION_DURATION=300;Modal.BACKDROP_TRANSITION_DURATION=150;Modal.DEFAULTS={backdrop:!0,keyboard:!0,show:!0};Modal.prototype.toggle=function(_relatedTarget){return this.isShown?this.hide():this.show(_relatedTarget)};Modal.prototype.show=function(_relatedTarget){var that=this,e=$.Event("show.bs.modal",{relatedTarget:_relatedTarget});this.$element.trigger(e);if(!this.isShown&&!e.isDefaultPrevented()){this.isShown=!0;this.checkScrollbar();this.setScrollbar();this.escape();this.resize();this.$element.on("click.dismiss.bs.modal",'[data-cv-dismiss="modal"]',$.proxy(this.hide,this));this.$dialog.on("mousedown.dismiss.bs.modal",function(){that.$element.one("mouseup.dismiss.bs.modal",function(e){$(e.target).is(that.$element)&&(that.ignoreBackdropClick=!0)})});this.backdrop(function(){var transition=$.support.transition&&that.$element.hasClass("fade");that.$element.parent().length||that.$element.appendTo(that.$body);that.$element.show().scrollTop(0);that.adjustDialog();transition&&that.$element[0].offsetWidth;that.$element.addClass("in");that.enforceFocus();var e=$.Event("shown.bs.modal",{relatedTarget:_relatedTarget});transition?that.$dialog.one("bsTransitionEnd",function(){that.$element.trigger("focus").trigger(e)}).emulateTransitionEnd(Modal.TRANSITION_DURATION):that.$element.trigger("focus").trigger(e)})}};Modal.prototype.hide=function(e){e&&e.preventDefault();e=$.Event("hide.bs.modal");this.$element.trigger(e);if(this.isShown&&!e.isDefaultPrevented()){this.isShown=!1;this.escape();this.resize();$(document).off("focusin.bs.modal");this.$element.removeClass("in").off("click.dismiss.bs.modal").off("mouseup.dismiss.bs.modal");this.$dialog.off("mousedown.dismiss.bs.modal");$.support.transition&&this.$element.hasClass("fade")?this.$element.one("bsTransitionEnd",$.proxy(this.hideModal,this)).emulateTransitionEnd(Modal.TRANSITION_DURATION):this.hideModal()}};Modal.prototype.enforceFocus=function(){};Modal.prototype.escape=function(){this.isShown&&this.options.keyboard?this.$element.on("keydown.dismiss.bs.modal",$.proxy(function(e){27==e.which&&this.hide()},this)):this.isShown||this.$element.off("keydown.dismiss.bs.modal")};Modal.prototype.resize=function(){this.isShown?$(window).on("resize.bs.modal",$.proxy(this.handleUpdate,this)):$(window).off("resize.bs.modal")};Modal.prototype.hideModal=function(){var that=this;this.$element.hide();this.backdrop(function(){that.resetAdjustments();that.resetScrollbar();that.$element.trigger("hidden.bs.modal")})};Modal.prototype.removeBackdrop=function(){this.$backdrop&&this.$backdrop.remove();this.$backdrop=null};Modal.prototype.backdrop=function(callback){var that=this,animate=this.$element.hasClass("fade")?"fade":"";if(this.isShown&&this.options.backdrop){var doAnimate=$.support.transition&&animate;this.$backdrop=$(document.createElement("div")).addClass("modal-backdrop "+animate).appendTo(this.$body);this.$element.on("click.dismiss.bs.modal",$.proxy(function(e){this.ignoreBackdropClick?this.ignoreBackdropClick=!1:e.target===e.currentTarget&&("static"==this.options.backdrop?this.$element[0].focus():this.hide())},this));doAnimate&&this.$backdrop[0].offsetWidth;this.$backdrop.addClass("in");if(!callback)return;doAnimate?this.$backdrop.one("bsTransitionEnd",callback).emulateTransitionEnd(Modal.BACKDROP_TRANSITION_DURATION):callback()}else if(!this.isShown&&this.$backdrop){this.$backdrop.removeClass("in");var callbackRemove=function(){that.removeBackdrop();callback&&callback()};$.support.transition&&this.$element.hasClass("fade")?this.$backdrop.one("bsTransitionEnd",callbackRemove).emulateTransitionEnd(Modal.BACKDROP_TRANSITION_DURATION):callbackRemove()}else callback&&callback()};Modal.prototype.handleUpdate=function(){this.adjustDialog()};Modal.prototype.adjustDialog=function(){var modalIsOverflowing=this.$element[0].scrollHeight>document.documentElement.clientHeight;this.$element.css({paddingLeft:!this.bodyIsOverflowing&&modalIsOverflowing?this.scrollbarWidth:"",paddingRight:this.bodyIsOverflowing&&!modalIsOverflowing?this.scrollbarWidth:""})};Modal.prototype.resetAdjustments=function(){this.$element.css({paddingLeft:"",paddingRight:""})};Modal.prototype.checkScrollbar=function(){};Modal.prototype.setScrollbar=function(){};Modal.prototype.resetScrollbar=function(){};Modal.prototype.measureScrollbar=function(){};var old=$.fn.modal;$.fn.modal=Plugin;$.fn.modal.Constructor=Modal;$.fn.modal.noConflict=function(){$.fn.modal=old;return this};$(document).on("click.bs.modal.data-cv-api",'[data-cv-toggle="modal"]',function(e){var $this=$(this),href=$this.attr("href"),$target=$($this.attr("data-cv-target")||href&&href.replace(/.*(?=#[^\s]+$)/,"")),option=$target.data("bs.modal")?"toggle":$.extend({remote:!/#/.test(href)&&href},$target.data(),$this.data());$this.is("a")&&e.preventDefault();$target.one("show.bs.modal",function(showEvent){showEvent.isDefaultPrevented()||$target.one("hidden.bs.modal",function(){$this.is(":visible")&&$this.trigger("focus")})});Plugin.call($target,option,this)})}(jQuery);+function($){"use strict";function getTargetFromTrigger($trigger){var href,target=$trigger.attr("data-cv-target")||(href=$trigger.attr("href"))&&href.replace(/.*(?=#[^\s]+$)/,"");return $(target)}function Plugin(option){return this.each(function(){var $this=$(this),data=$this.data("bs.collapse"),options=$.extend({},Collapse.DEFAULTS,$this.data(),"object"==typeof option&&option);!data&&options.toggle&&/show|hide/.test(option)&&(options.toggle=!1);data||$this.data("bs.collapse",data=new Collapse(this,options));"string"==typeof option&&data[option]()})}var Collapse=function(element,options){this.$element=$(element);this.options=$.extend({},Collapse.DEFAULTS,options);this.$trigger=$('[data-cv-toggle="collapse"][href="#'+element.id+'"],[data-cv-toggle="collapse"][data-cv-target="#'+element.id+'"]');this.transitioning=null;this.options.parent?this.$parent=this.getParent():this.addAriaAndCollapsedClass(this.$element,this.$trigger);this.options.toggle&&this.toggle()};Collapse.VERSION="3.3.6";Collapse.TRANSITION_DURATION=350;Collapse.DEFAULTS={toggle:!0};Collapse.prototype.dimension=function(){var hasWidth=this.$element.hasClass("width");return hasWidth?"width":"height"};Collapse.prototype.show=function(){if(!this.transitioning&&!this.$element.hasClass("in")){var activesData,actives=this.$parent&&this.$parent.children(".panel").children(".in, .collapsing");if(actives&&actives.length){activesData=actives.data("bs.collapse");if(activesData&&activesData.transitioning)return}var startEvent=$.Event("show.bs.collapse");this.$element.trigger(startEvent);if(!startEvent.isDefaultPrevented()){if(actives&&actives.length){Plugin.call(actives,"hide");activesData||actives.data("bs.collapse",null)}var dimension=this.dimension();this.$element.removeClass("collapse").addClass("collapsing")[dimension](0).attr("aria-expanded",!0);this.$trigger.removeClass("collapsed").attr("aria-expanded",!0);this.transitioning=1;var complete=function(){this.$element.removeClass("collapsing").addClass("collapse in")[dimension]("");this.transitioning=0;this.$element.trigger("shown.bs.collapse")};if(!$.support.transition)return complete.call(this);var scrollSize=$.camelCase(["scroll",dimension].join("-"));this.$element.one("bsTransitionEnd",$.proxy(complete,this)).emulateTransitionEnd(Collapse.TRANSITION_DURATION)[dimension](this.$element[0][scrollSize])}}};Collapse.prototype.hide=function(){if(!this.transitioning&&this.$element.hasClass("in")){var startEvent=$.Event("hide.bs.collapse");this.$element.trigger(startEvent);if(!startEvent.isDefaultPrevented()){var dimension=this.dimension();this.$element[dimension](this.$element[dimension]())[0].offsetHeight;this.$element.addClass("collapsing").removeClass("collapse in").attr("aria-expanded",!1);this.$trigger.addClass("collapsed").attr("aria-expanded",!1);this.transitioning=1;var complete=function(){this.transitioning=0;this.$element.removeClass("collapsing").addClass("collapse").trigger("hidden.bs.collapse")};if(!$.support.transition)return complete.call(this);this.$element[dimension](0).one("bsTransitionEnd",$.proxy(complete,this)).emulateTransitionEnd(Collapse.TRANSITION_DURATION)}}};Collapse.prototype.toggle=function(){this[this.$element.hasClass("in")?"hide":"show"]()};Collapse.prototype.getParent=function(){return $(this.options.parent).find('[data-cv-toggle="collapse"][data-cv-parent="'+this.options.parent+'"]').each($.proxy(function(i,element){var $element=$(element);this.addAriaAndCollapsedClass(getTargetFromTrigger($element),$element)},this)).end()};Collapse.prototype.addAriaAndCollapsedClass=function($element,$trigger){var isOpen=$element.hasClass("in");$element.attr("aria-expanded",isOpen);$trigger.toggleClass("collapsed",!isOpen).attr("aria-expanded",isOpen)};var old=$.fn.collapse;$.fn.collapse=Plugin;$.fn.collapse.Constructor=Collapse;$.fn.collapse.noConflict=function(){$.fn.collapse=old;return this};$(document).on("click.bs.collapse.data-cv-api",'[data-cv-toggle="collapse"]',function(e){var $this=$(this);$this.attr("data-cv-target")||e.preventDefault();var $target=getTargetFromTrigger($this),data=$target.data("bs.collapse"),option=data?"toggle":$this.data();Plugin.call($target,option)})}(jQuery);define("bootstrap",["jquery_loader"],function(){});define("underscore_loader",[],function(){function createReduce(dir){function iterator(obj,iteratee,memo,keys,index,length){for(;index>=0&&length>index;index+=dir){var currentKey=keys?keys[index]:index;memo=iteratee(memo,obj[currentKey],currentKey,obj)}return memo}return function(obj,iteratee,memo,context){iteratee=optimizeCb(iteratee,context,4);var keys=!isArrayLike(obj)&&cv_.keys(obj),length=(keys||obj).length,index=dir>0?0:length-1;if(arguments.length<3){memo=obj[keys?keys[index]:index];index+=dir}return iterator(obj,iteratee,memo,keys,index,length)}}function createPredicateIndexFinder(dir){return function(array,predicate,context){predicate=cb(predicate,context);for(var length=getLength(array),index=dir>0?0:length-1;index>=0&&length>index;index+=dir)if(predicate(array[index],index,array))return index;return-1}}function createIndexFinder(dir,predicateFind,sortedIndex){return function(array,item,idx){var i=0,length=getLength(array);if("number"==typeof idx)dir>0?i=idx>=0?idx:Math.max(idx+length,i):length=idx>=0?Math.min(idx+1,length):idx+length+1;else if(sortedIndex&&idx&&length){idx=sortedIndex(array,item);return array[idx]===item?idx:-1}if(item!==item){idx=predicateFind(slice.call(array,i,length),cv_.isNaN);return idx>=0?idx+i:-1}for(idx=dir>0?i:length-1;idx>=0&&length>idx;idx+=dir)if(array[idx]===item)return idx;return-1}}function collectNonEnumProps(obj,keys){var nonEnumIdx=nonEnumerableProps.length,constructor=obj.constructor,proto=cv_.isFunction(constructor)&&constructor.prototype||ObjProto,prop="constructor";cv_.has(obj,prop)&&!cv_.contains(keys,prop)&&keys.push(prop);for(;nonEnumIdx--;){prop=nonEnumerableProps[nonEnumIdx];prop in obj&&obj[prop]!==proto[prop]&&!cv_.contains(keys,prop)&&keys.push(prop)}}var root=this,previousUnderscore=root.cv_,ArrayProto=Array.prototype,ObjProto=Object.prototype,FuncProto=Function.prototype,push=ArrayProto.push,slice=ArrayProto.slice,toString=ObjProto.toString,hasOwnProperty=ObjProto.hasOwnProperty,nativeIsArray=Array.isArray,nativeKeys=Object.keys,nativeBind=FuncProto.bind,nativeCreate=Object.create,Ctor=function(){},cv_=function(obj){if(obj instanceof cv_)return obj;if(!(this instanceof cv_))return new cv_(obj);this._wrapped=obj};if("undefined"!=typeof exports){"undefined"!=typeof module&&module.exports&&(exports=module.exports=cv_);exports.cv_=cv_}else root.cv_=cv_;cv_.VERSION="1.8.3";var optimizeCb=function(func,context,argCount){if(void 0===context)return func;switch(null==argCount?3:argCount){case 1:return function(value){return func.call(context,value)};case 2:return function(value,other){return func.call(context,value,other)};case 3:return function(value,index,collection){return func.call(context,value,index,collection)};case 4:return function(accumulator,value,index,collection){return func.call(context,accumulator,value,index,collection)}}return function(){return func.apply(context,arguments)}},cb=function(value,context,argCount){return null==value?cv_.identity:cv_.isFunction(value)?optimizeCb(value,context,argCount):cv_.isObject(value)?cv_.matcher(value):cv_.property(value)};cv_.iteratee=function(value,context){return cb(value,context,1/0)};var createAssigner=function(keysFunc,undefinedOnly){return function(obj){var length=arguments.length;if(2>length||null==obj)return obj;for(var index=1;length>index;index++)for(var source=arguments[index],keys=keysFunc(source),l=keys.length,i=0;l>i;i++){var key=keys[i];undefinedOnly&&void 0!==obj[key]||(obj[key]=source[key])}return obj}},baseCreate=function(prototype){if(!cv_.isObject(prototype))return{};if(nativeCreate)return nativeCreate(prototype);Ctor.prototype=prototype;var result=new Ctor;Ctor.prototype=null;return result},property=function(key){return function(obj){return null==obj?void 0:obj[key]}},MAX_ARRAY_INDEX=Math.pow(2,53)-1,getLength=property("length"),isArrayLike=function(collection){var length=getLength(collection);return"number"==typeof length&&length>=0&&MAX_ARRAY_INDEX>=length};cv_.each=cv_.forEach=function(obj,iteratee,context){iteratee=optimizeCb(iteratee,context);var i,length;if(isArrayLike(obj))for(i=0,length=obj.length;length>i;i++)iteratee(obj[i],i,obj);else{var keys=cv_.keys(obj);for(i=0,length=keys.length;length>i;i++)iteratee(obj[keys[i]],keys[i],obj)}return obj};cv_.map=cv_.collect=function(obj,iteratee,context){iteratee=cb(iteratee,context);for(var keys=!isArrayLike(obj)&&cv_.keys(obj),length=(keys||obj).length,results=Array(length),index=0;length>index;index++){var currentKey=keys?keys[index]:index;results[index]=iteratee(obj[currentKey],currentKey,obj)}return results};cv_.reduce=cv_.foldl=cv_.inject=createReduce(1);cv_.reduceRight=cv_.foldr=createReduce(-1);cv_.find=cv_.detect=function(obj,predicate,context){var key;key=isArrayLike(obj)?cv_.findIndex(obj,predicate,context):cv_.findKey(obj,predicate,context);return void 0!==key&&-1!==key?obj[key]:void 0};cv_.filter=cv_.select=function(obj,predicate,context){var results=[];predicate=cb(predicate,context);cv_.each(obj,function(value,index,list){predicate(value,index,list)&&results.push(value)});return results};cv_.reject=function(obj,predicate,context){return cv_.filter(obj,cv_.negate(cb(predicate)),context)};cv_.every=cv_.all=function(obj,predicate,context){predicate=cb(predicate,context);for(var keys=!isArrayLike(obj)&&cv_.keys(obj),length=(keys||obj).length,index=0;length>index;index++){var currentKey=keys?keys[index]:index;if(!predicate(obj[currentKey],currentKey,obj))return!1}return!0};cv_.some=cv_.any=function(obj,predicate,context){predicate=cb(predicate,context);for(var keys=!isArrayLike(obj)&&cv_.keys(obj),length=(keys||obj).length,index=0;length>index;index++){var currentKey=keys?keys[index]:index;if(predicate(obj[currentKey],currentKey,obj))return!0}return!1};cv_.contains=cv_.includes=cv_.include=function(obj,item,fromIndex,guard){isArrayLike(obj)||(obj=cv_.values(obj));("number"!=typeof fromIndex||guard)&&(fromIndex=0);return cv_.indexOf(obj,item,fromIndex)>=0};cv_.invoke=function(obj,method){var args=slice.call(arguments,2),isFunc=cv_.isFunction(method);return cv_.map(obj,function(value){var func=isFunc?method:value[method];return null==func?func:func.apply(value,args)})};cv_.pluck=function(obj,key){return cv_.map(obj,cv_.property(key))};cv_.where=function(obj,attrs){return cv_.filter(obj,cv_.matcher(attrs))};cv_.findWhere=function(obj,attrs){return cv_.find(obj,cv_.matcher(attrs))};cv_.max=function(obj,iteratee,context){var value,computed,result=-(1/0),lastComputed=-(1/0);if(null==iteratee&&null!=obj){obj=isArrayLike(obj)?obj:cv_.values(obj);for(var i=0,length=obj.length;length>i;i++){value=obj[i];value>result&&(result=value)}}else{iteratee=cb(iteratee,context);cv_.each(obj,function(value,index,list){computed=iteratee(value,index,list);if(computed>lastComputed||computed===-(1/0)&&result===-(1/0)){result=value;lastComputed=computed}})}return result};cv_.min=function(obj,iteratee,context){var value,computed,result=1/0,lastComputed=1/0;if(null==iteratee&&null!=obj){obj=isArrayLike(obj)?obj:cv_.values(obj);for(var i=0,length=obj.length;length>i;i++){value=obj[i];result>value&&(result=value)}}else{iteratee=cb(iteratee,context);cv_.each(obj,function(value,index,list){computed=iteratee(value,index,list);if(lastComputed>computed||computed===1/0&&result===1/0){result=value;lastComputed=computed}})}return result};cv_.shuffle=function(obj){for(var rand,set=isArrayLike(obj)?obj:cv_.values(obj),length=set.length,shuffled=Array(length),index=0;length>index;index++){rand=cv_.random(0,index);rand!==index&&(shuffled[index]=shuffled[rand]);shuffled[rand]=set[index]}return shuffled};cv_.sample=function(obj,n,guard){if(null==n||guard){isArrayLike(obj)||(obj=cv_.values(obj));return obj[cv_.random(obj.length-1)]}return cv_.shuffle(obj).slice(0,Math.max(0,n))};cv_.sortBy=function(obj,iteratee,context){iteratee=cb(iteratee,context);return cv_.pluck(cv_.map(obj,function(value,index,list){return{value:value,index:index,criteria:iteratee(value,index,list)}}).sort(function(left,right){var a=left.criteria,b=right.criteria;if(a!==b){if(a>b||void 0===a)return 1;if(b>a||void 0===b)return-1}return left.index-right.index}),"value")};var group=function(behavior){return function(obj,iteratee,context){var result={};iteratee=cb(iteratee,context);cv_.each(obj,function(value,index){var key=iteratee(value,index,obj);behavior(result,value,key)});return result}};cv_.groupBy=group(function(result,value,key){cv_.has(result,key)?result[key].push(value):result[key]=[value]});cv_.indexBy=group(function(result,value,key){result[key]=value});cv_.countBy=group(function(result,value,key){cv_.has(result,key)?result[key]++:result[key]=1});cv_.toArray=function(obj){return obj?cv_.isArray(obj)?slice.call(obj):isArrayLike(obj)?cv_.map(obj,cv_.identity):cv_.values(obj):[]};cv_.size=function(obj){return null==obj?0:isArrayLike(obj)?obj.length:cv_.keys(obj).length};cv_.partition=function(obj,predicate,context){predicate=cb(predicate,context);var pass=[],fail=[];cv_.each(obj,function(value,key,obj){(predicate(value,key,obj)?pass:fail).push(value)});return[pass,fail]};cv_.first=cv_.head=cv_.take=function(array,n,guard){return null!=array?null==n||guard?array[0]:cv_.initial(array,array.length-n):void 0};cv_.initial=function(array,n,guard){return slice.call(array,0,Math.max(0,array.length-(null==n||guard?1:n)))};cv_.last=function(array,n,guard){return null!=array?null==n||guard?array[array.length-1]:cv_.rest(array,Math.max(0,array.length-n)):void 0};cv_.rest=cv_.tail=cv_.drop=function(array,n,guard){return slice.call(array,null==n||guard?1:n)};cv_.compact=function(array){return cv_.filter(array,cv_.identity)};var flatten=function(input,shallow,strict,startIndex){for(var output=[],idx=0,i=startIndex||0,length=getLength(input);length>i;i++){var value=input[i];if(isArrayLike(value)&&(cv_.isArray(value)||cv_.isArguments(value))){shallow||(value=flatten(value,shallow,strict));var j=0,len=value.length;output.length+=len;for(;len>j;)output[idx++]=value[j++]}else strict||(output[idx++]=value)}return output};cv_.flatten=function(array,shallow){return flatten(array,shallow,!1)};cv_.without=function(array){return cv_.difference(array,slice.call(arguments,1))};cv_.uniq=cv_.unique=function(array,isSorted,iteratee,context){if(!cv_.isBoolean(isSorted)){context=iteratee;iteratee=isSorted;isSorted=!1}null!=iteratee&&(iteratee=cb(iteratee,context));for(var result=[],seen=[],i=0,length=getLength(array);length>i;i++){var value=array[i],computed=iteratee?iteratee(value,i,array):value;if(isSorted){i&&seen===computed||result.push(value);seen=computed}else if(iteratee){if(!cv_.contains(seen,computed)){seen.push(computed);result.push(value)}}else cv_.contains(result,value)||result.push(value)}return result};cv_.union=function(){return cv_.uniq(flatten(arguments,!0,!0))};cv_.intersection=function(array){for(var result=[],argsLength=arguments.length,i=0,length=getLength(array);length>i;i++){var item=array[i];if(!cv_.contains(result,item)){for(var j=1;argsLength>j&&cv_.contains(arguments[j],item);j++);j===argsLength&&result.push(item)}}return result};cv_.difference=function(array){var rest=flatten(arguments,!0,!0,1);return cv_.filter(array,function(value){return!cv_.contains(rest,value)})};cv_.zip=function(){return cv_.unzip(arguments)};cv_.unzip=function(array){for(var length=array&&cv_.max(array,getLength).length||0,result=Array(length),index=0;length>index;index++)result[index]=cv_.pluck(array,index);return result};cv_.object=function(list,values){for(var result={},i=0,length=getLength(list);length>i;i++)values?result[list[i]]=values[i]:result[list[i][0]]=list[i][1];return result};cv_.findIndex=createPredicateIndexFinder(1);cv_.findLastIndex=createPredicateIndexFinder(-1);cv_.sortedIndex=function(array,obj,iteratee,context){iteratee=cb(iteratee,context,1);for(var value=iteratee(obj),low=0,high=getLength(array);high>low;){var mid=Math.floor((low+high)/2);iteratee(array[mid])<value?low=mid+1:high=mid}return low};cv_.indexOf=createIndexFinder(1,cv_.findIndex,cv_.sortedIndex);cv_.lastIndexOf=createIndexFinder(-1,cv_.findLastIndex);cv_.range=function(start,stop,step){if(null==stop){stop=start||0;start=0}step=step||1;for(var length=Math.max(Math.ceil((stop-start)/step),0),range=Array(length),idx=0;length>idx;idx++,start+=step)range[idx]=start;return range};var executeBound=function(sourceFunc,boundFunc,context,callingContext,args){if(!(callingContext instanceof boundFunc))return sourceFunc.apply(context,args);var self=baseCreate(sourceFunc.prototype),result=sourceFunc.apply(self,args);return cv_.isObject(result)?result:self};cv_.bind=function(func,context){if(nativeBind&&func.bind===nativeBind)return nativeBind.apply(func,slice.call(arguments,1));if(!cv_.isFunction(func))throw new TypeError("Bind must be called on a function");var args=slice.call(arguments,2),bound=function(){return executeBound(func,bound,context,this,args.concat(slice.call(arguments)))};return bound};cv_.partial=function(func){var boundArgs=slice.call(arguments,1),bound=function(){for(var position=0,length=boundArgs.length,args=Array(length),i=0;length>i;i++)args[i]=boundArgs[i]===cv_?arguments[position++]:boundArgs[i];for(;position<arguments.length;)args.push(arguments[position++]);return executeBound(func,bound,this,this,args)};return bound};cv_.bindAll=function(obj){var i,key,length=arguments.length;if(1>=length)throw new Error("bindAll must be passed function names");for(i=1;length>i;i++){key=arguments[i];obj[key]=cv_.bind(obj[key],obj)}return obj};cv_.memoize=function(func,hasher){var memoize=function(key){var cache=memoize.cache,address=""+(hasher?hasher.apply(this,arguments):key);cv_.has(cache,address)||(cache[address]=func.apply(this,arguments));return cache[address]};memoize.cache={};return memoize};cv_.delay=function(func,wait){var args=slice.call(arguments,2);return setTimeout(function(){return func.apply(null,args)},wait)};cv_.defer=cv_.partial(cv_.delay,cv_,1);cv_.throttle=function(func,wait,options){var context,args,result,timeout=null,previous=0;options||(options={});var later=function(){previous=options.leading===!1?0:cv_.now();timeout=null;result=func.apply(context,args);timeout||(context=args=null)};return function(){var now=cv_.now();previous||options.leading!==!1||(previous=now);var remaining=wait-(now-previous);context=this;args=arguments;if(0>=remaining||remaining>wait){if(timeout){clearTimeout(timeout);timeout=null}previous=now;result=func.apply(context,args);timeout||(context=args=null)}else timeout||options.trailing===!1||(timeout=setTimeout(later,remaining));return result}};cv_.debounce=function(func,wait,immediate){var timeout,args,context,timestamp,result,later=function(){var last=cv_.now()-timestamp;if(wait>last&&last>=0)timeout=setTimeout(later,wait-last);else{timeout=null;if(!immediate){result=func.apply(context,args);timeout||(context=args=null)}}};return function(){context=this;args=arguments;timestamp=cv_.now();var callNow=immediate&&!timeout;timeout||(timeout=setTimeout(later,wait));if(callNow){result=func.apply(context,args);context=args=null}return result}};cv_.wrap=function(func,wrapper){return cv_.partial(wrapper,func)};cv_.negate=function(predicate){return function(){return!predicate.apply(this,arguments)}};cv_.compose=function(){var args=arguments,start=args.length-1;return function(){for(var i=start,result=args[start].apply(this,arguments);i--;)result=args[i].call(this,result);return result}};cv_.after=function(times,func){return function(){return--times<1?func.apply(this,arguments):void 0}};cv_.before=function(times,func){var memo;return function(){--times>0&&(memo=func.apply(this,arguments));1>=times&&(func=null);return memo}};cv_.once=cv_.partial(cv_.before,2);var hasEnumBug=!{toString:null}.propertyIsEnumerable("toString"),nonEnumerableProps=["valueOf","isPrototypeOf","toString","propertyIsEnumerable","hasOwnProperty","toLocaleString"];cv_.keys=function(obj){if(!cv_.isObject(obj))return[];if(nativeKeys)return nativeKeys(obj);var keys=[];for(var key in obj)cv_.has(obj,key)&&keys.push(key);hasEnumBug&&collectNonEnumProps(obj,keys);return keys};cv_.allKeys=function(obj){if(!cv_.isObject(obj))return[];var keys=[];for(var key in obj)keys.push(key);hasEnumBug&&collectNonEnumProps(obj,keys);return keys};cv_.values=function(obj){for(var keys=cv_.keys(obj),length=keys.length,values=Array(length),i=0;length>i;i++)values[i]=obj[keys[i]];return values};cv_.mapObject=function(obj,iteratee,context){iteratee=cb(iteratee,context);for(var currentKey,keys=cv_.keys(obj),length=keys.length,results={},index=0;length>index;index++){currentKey=keys[index];results[currentKey]=iteratee(obj[currentKey],currentKey,obj)}return results};cv_.pairs=function(obj){for(var keys=cv_.keys(obj),length=keys.length,pairs=Array(length),i=0;length>i;i++)pairs[i]=[keys[i],obj[keys[i]]];return pairs};cv_.invert=function(obj){for(var result={},keys=cv_.keys(obj),i=0,length=keys.length;length>i;i++)result[obj[keys[i]]]=keys[i];return result};cv_.functions=cv_.methods=function(obj){var names=[];for(var key in obj)cv_.isFunction(obj[key])&&names.push(key);return names.sort()};cv_.extend=createAssigner(cv_.allKeys);cv_.extendOwn=cv_.assign=createAssigner(cv_.keys);cv_.findKey=function(obj,predicate,context){predicate=cb(predicate,context);for(var key,keys=cv_.keys(obj),i=0,length=keys.length;length>i;i++){key=keys[i];if(predicate(obj[key],key,obj))return key}};cv_.pick=function(object,oiteratee,context){var iteratee,keys,result={},obj=object;if(null==obj)return result;if(cv_.isFunction(oiteratee)){keys=cv_.allKeys(obj);iteratee=optimizeCb(oiteratee,context)}else{keys=flatten(arguments,!1,!1,1);iteratee=function(value,key,obj){return key in obj};obj=Object(obj)}for(var i=0,length=keys.length;length>i;i++){var key=keys[i],value=obj[key];iteratee(value,key,obj)&&(result[key]=value)}return result};cv_.omit=function(obj,iteratee,context){if(cv_.isFunction(iteratee))iteratee=cv_.negate(iteratee);else{var keys=cv_.map(flatten(arguments,!1,!1,1),String);iteratee=function(value,key){return!cv_.contains(keys,key)}}return cv_.pick(obj,iteratee,context)};cv_.defaults=createAssigner(cv_.allKeys,!0);cv_.create=function(prototype,props){var result=baseCreate(prototype);props&&cv_.extendOwn(result,props);return result};cv_.clone=function(obj){return cv_.isObject(obj)?cv_.isArray(obj)?obj.slice():cv_.extend({},obj):obj};cv_.tap=function(obj,interceptor){interceptor(obj);return obj};cv_.isMatch=function(object,attrs){var keys=cv_.keys(attrs),length=keys.length;if(null==object)return!length;for(var obj=Object(object),i=0;length>i;i++){var key=keys[i];if(attrs[key]!==obj[key]||!(key in obj))return!1}return!0};var eq=function(a,b,aStack,bStack){if(a===b)return 0!==a||1/a===1/b;if(null==a||null==b)return a===b;a instanceof cv_&&(a=a._wrapped);b instanceof cv_&&(b=b._wrapped);var className=toString.call(a);if(className!==toString.call(b))return!1;switch(className){case"[object RegExp]":case"[object String]":return""+a==""+b;case"[object Number]":return+a!==+a?+b!==+b:0===+a?1/+a===1/b:+a===+b;case"[object Date]":case"[object Boolean]":return+a===+b}var areArrays="[object Array]"===className;if(!areArrays){if("object"!=typeof a||"object"!=typeof b)return!1;var aCtor=a.constructor,bCtor=b.constructor;if(aCtor!==bCtor&&!(cv_.isFunction(aCtor)&&aCtor instanceof aCtor&&cv_.isFunction(bCtor)&&bCtor instanceof bCtor)&&"constructor"in a&&"constructor"in b)return!1}aStack=aStack||[];bStack=bStack||[];for(var length=aStack.length;length--;)if(aStack[length]===a)return bStack[length]===b;
aStack.push(a);bStack.push(b);if(areArrays){length=a.length;if(length!==b.length)return!1;for(;length--;)if(!eq(a[length],b[length],aStack,bStack))return!1}else{var key,keys=cv_.keys(a);length=keys.length;if(cv_.keys(b).length!==length)return!1;for(;length--;){key=keys[length];if(!cv_.has(b,key)||!eq(a[key],b[key],aStack,bStack))return!1}}aStack.pop();bStack.pop();return!0};cv_.isEqual=function(a,b){return eq(a,b)};cv_.isEmpty=function(obj){return null==obj?!0:isArrayLike(obj)&&(cv_.isArray(obj)||cv_.isString(obj)||cv_.isArguments(obj))?0===obj.length:0===cv_.keys(obj).length};cv_.isElement=function(obj){return!(!obj||1!==obj.nodeType)};cv_.isArray=nativeIsArray||function(obj){return"[object Array]"===toString.call(obj)};cv_.isObject=function(obj){var type=typeof obj;return"function"===type||"object"===type&&!!obj};cv_.each(["Arguments","Function","String","Number","Date","RegExp","Error"],function(name){cv_["is"+name]=function(obj){return toString.call(obj)==="[object "+name+"]"}});cv_.isArguments(arguments)||(cv_.isArguments=function(obj){return cv_.has(obj,"callee")});"function"!=typeof/./&&"object"!=typeof Int8Array&&(cv_.isFunction=function(obj){return"function"==typeof obj||!1});cv_.isFinite=function(obj){return isFinite(obj)&&!isNaN(parseFloat(obj))};cv_.isNaN=function(obj){return cv_.isNumber(obj)&&obj!==+obj};cv_.isBoolean=function(obj){return obj===!0||obj===!1||"[object Boolean]"===toString.call(obj)};cv_.isNull=function(obj){return null===obj};cv_.isUndefined=function(obj){return void 0===obj};cv_.has=function(obj,key){return null!=obj&&hasOwnProperty.call(obj,key)};cv_.noConflict=function(){root.cv_=previousUnderscore;return this};cv_.identity=function(value){return value};cv_.constant=function(value){return function(){return value}};cv_.noop=function(){};cv_.property=property;cv_.propertyOf=function(obj){return null==obj?function(){}:function(key){return obj[key]}};cv_.matcher=cv_.matches=function(attrs){attrs=cv_.extendOwn({},attrs);return function(obj){return cv_.isMatch(obj,attrs)}};cv_.times=function(n,iteratee,context){var accum=Array(Math.max(0,n));iteratee=optimizeCb(iteratee,context,1);for(var i=0;n>i;i++)accum[i]=iteratee(i);return accum};cv_.random=function(min,max){if(null==max){max=min;min=0}return min+Math.floor(Math.random()*(max-min+1))};cv_.now=Date.now||function(){return(new Date).getTime()};var escapeMap={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#x27;","`":"&#x60;"},unescapeMap=cv_.invert(escapeMap),createEscaper=function(map){var escaper=function(match){return map[match]},source="(?:"+cv_.keys(map).join("|")+")",testRegexp=RegExp(source),replaceRegexp=RegExp(source,"g");return function(string){string=null==string?"":""+string;return testRegexp.test(string)?string.replace(replaceRegexp,escaper):string}};cv_.escape=createEscaper(escapeMap);cv_.unescape=createEscaper(unescapeMap);cv_.result=function(object,property,fallback){var value=null==object?void 0:object[property];void 0===value&&(value=fallback);return cv_.isFunction(value)?value.call(object):value};var idCounter=0;cv_.uniqueId=function(prefix){var id=++idCounter+"";return prefix?prefix+id:id};cv_.templateSettings={evaluate:/<%([\s\S]+?)%>/g,interpolate:/<%=([\s\S]+?)%>/g,escape:/<%-([\s\S]+?)%>/g};var noMatch=/(.)^/,escapes={"'":"'","\\":"\\","\r":"r","\n":"n","\u2028":"u2028","\u2029":"u2029"},escaper=/\\|'|\r|\n|\u2028|\u2029/g,escapeChar=function(match){return"\\"+escapes[match]};cv_.template=function(text,settings,oldSettings){!settings&&oldSettings&&(settings=oldSettings);settings=cv_.defaults({},settings,cv_.templateSettings);var matcher=RegExp([(settings.escape||noMatch).source,(settings.interpolate||noMatch).source,(settings.evaluate||noMatch).source].join("|")+"|$","g"),index=0,source="__p+='";text.replace(matcher,function(match,escape,interpolate,evaluate,offset){source+=text.slice(index,offset).replace(escaper,escapeChar);index=offset+match.length;escape?source+="'+\n((__t=("+escape+"))==null?'':cv_.escape(__t))+\n'":interpolate?source+="'+\n((__t=("+interpolate+"))==null?'':__t)+\n'":evaluate&&(source+="';\n"+evaluate+"\n__p+='");return match});source+="';\n";settings.variable||(source="with(obj||{}){\n"+source+"}\n");source="var __t,__p='',__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,'');};\n"+source+"return __p;\n";try{var render=new Function(settings.variable||"obj","cv_",source)}catch(e){e.source=source;throw e}var template=function(data){return render.call(this,data,cv_)},argument=settings.variable||"obj";template.source="function("+argument+"){\n"+source+"}";return template};cv_.chain=function(obj){var instance=cv_(obj);instance._chain=!0;return instance};var result=function(instance,obj){return instance._chain?cv_(obj).chain():obj};cv_.mixin=function(obj){cv_.each(cv_.functions(obj),function(name){var func=cv_[name]=obj[name];cv_.prototype[name]=function(){var args=[this._wrapped];push.apply(args,arguments);return result(this,func.apply(cv_,args))}})};cv_.mixin(cv_);cv_.each(["pop","push","reverse","shift","sort","splice","unshift"],function(name){var method=ArrayProto[name];cv_.prototype[name]=function(){var obj=this._wrapped;method.apply(obj,arguments);"shift"!==name&&"splice"!==name||0!==obj.length||delete obj[0];return result(this,obj)}});cv_.each(["concat","join","slice"],function(name){var method=ArrayProto[name];cv_.prototype[name]=function(){return result(this,method.apply(this._wrapped,arguments))}});cv_.prototype.value=function(){return this._wrapped};cv_.prototype.valueOf=cv_.prototype.toJSON=cv_.prototype.value;cv_.prototype.toString=function(){return""+this._wrapped};"function"==typeof define&&define.amd&&define("underscore_loader",[],function(){return cv_});return cv_});window.jQuery&&function($){$.extend({xml2json:function(xml,extended){function parseXML(node,simple){if(!node)return null;var txt="",obj=null,att=null;node.nodeType,jsVar(node.localName||node.nodeName),node.text||node.nodeValue||"";node.childNodes&&node.childNodes.length>0&&$.each(node.childNodes,function(n,cn){var cnt=cn.nodeType,cnn=jsVar(cn.localName||cn.nodeName),cnv=cn.text||cn.nodeValue||"";if(8!=cnt)if(3!=cnt&&4!=cnt&&cnn){obj=obj||{};if(obj[cnn]){obj[cnn].length||(obj[cnn]=myArr(obj[cnn]));obj[cnn]=myArr(obj[cnn]);obj[cnn][obj[cnn].length]=parseXML(cn,!0);obj[cnn].length=obj[cnn].length}else obj[cnn]=parseXML(cn)}else{if(cnv.match(/^\s+$/))return;txt+=cnv.replace(/^\s+/,"").replace(/\s+$/,"")}});if(node.attributes&&node.attributes.length>0){att={};obj=obj||{};$.each(node.attributes,function(a,at){var atn=jsVar(at.name),atv=at.value;att[atn]=atv;if(obj[atn]){obj[cnn]=myArr(obj[cnn]);obj[atn][obj[atn].length]=atv;obj[atn].length=obj[atn].length}else obj[atn]=atv})}if(obj){obj=$.extend(""!=txt?new String(txt):{},obj||{});txt=obj.text?("object"==typeof obj.text?obj.text:[obj.text||""]).concat([txt]):txt;txt&&(obj.text=txt);txt=""}var out=obj||txt;if(extended){txt&&(out={});txt=out.text||txt||"";txt&&(out.text=txt);simple||(out=myArr(out))}return out}if(!xml)return{};var jsVar=function(s){return String(s||"").replace(/-/g,"_")},myArr=function(o){$.isArray(o)||(o=[o]);o.length=o.length;return o};"string"==typeof xml&&(xml=$.text2xml(xml));if(xml.nodeType){if(3==xml.nodeType||4==xml.nodeType)return xml.nodeValue;var root=9==xml.nodeType?xml.documentElement:xml,out=parseXML(root,!0);xml=null;root=null;return out}},text2xml:function(str){var out;try{var xml=$.support.opacity||$.support.style?new DOMParser:new ActiveXObject("Microsoft.XMLDOM");xml.async=!1}catch(e){throw new Error("XML Parser could not be instantiated")}try{out=$.support.opacity||$.support.style?xml.parseFromString(str,"text/xml"):xml.loadXML(str)?xml:!1}catch(e){throw new Error("Error parsing XML string")}return out}})}(jQuery);define("xml2json",["jquery_loader"],function(global){return function(){var ret;return ret||global.window.cvjq.fn.xml2json}}(this));define("underscore-loader",[],function(){function createReduce(dir){function iterator(obj,iteratee,memo,keys,index,length){for(;index>=0&&length>index;index+=dir){var currentKey=keys?keys[index]:index;memo=iteratee(memo,obj[currentKey],currentKey,obj)}return memo}return function(obj,iteratee,memo,context){iteratee=optimizeCb(iteratee,context,4);var keys=!isArrayLike(obj)&&cv_.keys(obj),length=(keys||obj).length,index=dir>0?0:length-1;if(arguments.length<3){memo=obj[keys?keys[index]:index];index+=dir}return iterator(obj,iteratee,memo,keys,index,length)}}function createPredicateIndexFinder(dir){return function(array,predicate,context){predicate=cb(predicate,context);for(var length=getLength(array),index=dir>0?0:length-1;index>=0&&length>index;index+=dir)if(predicate(array[index],index,array))return index;return-1}}function createIndexFinder(dir,predicateFind,sortedIndex){return function(array,item,idx){var i=0,length=getLength(array);if("number"==typeof idx)dir>0?i=idx>=0?idx:Math.max(idx+length,i):length=idx>=0?Math.min(idx+1,length):idx+length+1;else if(sortedIndex&&idx&&length){idx=sortedIndex(array,item);return array[idx]===item?idx:-1}if(item!==item){idx=predicateFind(slice.call(array,i,length),cv_.isNaN);return idx>=0?idx+i:-1}for(idx=dir>0?i:length-1;idx>=0&&length>idx;idx+=dir)if(array[idx]===item)return idx;return-1}}function collectNonEnumProps(obj,keys){var nonEnumIdx=nonEnumerableProps.length,constructor=obj.constructor,proto=cv_.isFunction(constructor)&&constructor.prototype||ObjProto,prop="constructor";cv_.has(obj,prop)&&!cv_.contains(keys,prop)&&keys.push(prop);for(;nonEnumIdx--;){prop=nonEnumerableProps[nonEnumIdx];prop in obj&&obj[prop]!==proto[prop]&&!cv_.contains(keys,prop)&&keys.push(prop)}}var root=this,previousUnderscore=root.cv_,ArrayProto=Array.prototype,ObjProto=Object.prototype,FuncProto=Function.prototype,push=ArrayProto.push,slice=ArrayProto.slice,toString=ObjProto.toString,hasOwnProperty=ObjProto.hasOwnProperty,nativeIsArray=Array.isArray,nativeKeys=Object.keys,nativeBind=FuncProto.bind,nativeCreate=Object.create,Ctor=function(){},cv_=function(obj){if(obj instanceof cv_)return obj;if(!(this instanceof cv_))return new cv_(obj);this._wrapped=obj};if("undefined"!=typeof exports){"undefined"!=typeof module&&module.exports&&(exports=module.exports=cv_);exports.cv_=cv_}else root.cv_=cv_;cv_.VERSION="1.8.3";var optimizeCb=function(func,context,argCount){if(void 0===context)return func;switch(null==argCount?3:argCount){case 1:return function(value){return func.call(context,value)};case 2:return function(value,other){return func.call(context,value,other)};case 3:return function(value,index,collection){return func.call(context,value,index,collection)};case 4:return function(accumulator,value,index,collection){return func.call(context,accumulator,value,index,collection)}}return function(){return func.apply(context,arguments)}},cb=function(value,context,argCount){return null==value?cv_.identity:cv_.isFunction(value)?optimizeCb(value,context,argCount):cv_.isObject(value)?cv_.matcher(value):cv_.property(value)};cv_.iteratee=function(value,context){return cb(value,context,1/0)};var createAssigner=function(keysFunc,undefinedOnly){return function(obj){var length=arguments.length;if(2>length||null==obj)return obj;for(var index=1;length>index;index++)for(var source=arguments[index],keys=keysFunc(source),l=keys.length,i=0;l>i;i++){var key=keys[i];undefinedOnly&&void 0!==obj[key]||(obj[key]=source[key])}return obj}},baseCreate=function(prototype){if(!cv_.isObject(prototype))return{};if(nativeCreate)return nativeCreate(prototype);Ctor.prototype=prototype;var result=new Ctor;Ctor.prototype=null;return result},property=function(key){return function(obj){return null==obj?void 0:obj[key]}},MAX_ARRAY_INDEX=Math.pow(2,53)-1,getLength=property("length"),isArrayLike=function(collection){var length=getLength(collection);return"number"==typeof length&&length>=0&&MAX_ARRAY_INDEX>=length};cv_.each=cv_.forEach=function(obj,iteratee,context){iteratee=optimizeCb(iteratee,context);var i,length;if(isArrayLike(obj))for(i=0,length=obj.length;length>i;i++)iteratee(obj[i],i,obj);else{var keys=cv_.keys(obj);for(i=0,length=keys.length;length>i;i++)iteratee(obj[keys[i]],keys[i],obj)}return obj};cv_.map=cv_.collect=function(obj,iteratee,context){iteratee=cb(iteratee,context);for(var keys=!isArrayLike(obj)&&cv_.keys(obj),length=(keys||obj).length,results=Array(length),index=0;length>index;index++){var currentKey=keys?keys[index]:index;results[index]=iteratee(obj[currentKey],currentKey,obj)}return results};cv_.reduce=cv_.foldl=cv_.inject=createReduce(1);cv_.reduceRight=cv_.foldr=createReduce(-1);cv_.find=cv_.detect=function(obj,predicate,context){var key;key=isArrayLike(obj)?cv_.findIndex(obj,predicate,context):cv_.findKey(obj,predicate,context);return void 0!==key&&-1!==key?obj[key]:void 0};cv_.filter=cv_.select=function(obj,predicate,context){var results=[];predicate=cb(predicate,context);cv_.each(obj,function(value,index,list){predicate(value,index,list)&&results.push(value)});return results};cv_.reject=function(obj,predicate,context){return cv_.filter(obj,cv_.negate(cb(predicate)),context)};cv_.every=cv_.all=function(obj,predicate,context){predicate=cb(predicate,context);for(var keys=!isArrayLike(obj)&&cv_.keys(obj),length=(keys||obj).length,index=0;length>index;index++){var currentKey=keys?keys[index]:index;if(!predicate(obj[currentKey],currentKey,obj))return!1}return!0};cv_.some=cv_.any=function(obj,predicate,context){predicate=cb(predicate,context);for(var keys=!isArrayLike(obj)&&cv_.keys(obj),length=(keys||obj).length,index=0;length>index;index++){var currentKey=keys?keys[index]:index;if(predicate(obj[currentKey],currentKey,obj))return!0}return!1};cv_.contains=cv_.includes=cv_.include=function(obj,item,fromIndex,guard){isArrayLike(obj)||(obj=cv_.values(obj));("number"!=typeof fromIndex||guard)&&(fromIndex=0);return cv_.indexOf(obj,item,fromIndex)>=0};cv_.invoke=function(obj,method){var args=slice.call(arguments,2),isFunc=cv_.isFunction(method);return cv_.map(obj,function(value){var func=isFunc?method:value[method];return null==func?func:func.apply(value,args)})};cv_.pluck=function(obj,key){return cv_.map(obj,cv_.property(key))};cv_.where=function(obj,attrs){return cv_.filter(obj,cv_.matcher(attrs))};cv_.findWhere=function(obj,attrs){return cv_.find(obj,cv_.matcher(attrs))};cv_.max=function(obj,iteratee,context){var value,computed,result=-(1/0),lastComputed=-(1/0);if(null==iteratee&&null!=obj){obj=isArrayLike(obj)?obj:cv_.values(obj);for(var i=0,length=obj.length;length>i;i++){value=obj[i];value>result&&(result=value)}}else{iteratee=cb(iteratee,context);cv_.each(obj,function(value,index,list){computed=iteratee(value,index,list);if(computed>lastComputed||computed===-(1/0)&&result===-(1/0)){result=value;lastComputed=computed}})}return result};cv_.min=function(obj,iteratee,context){var value,computed,result=1/0,lastComputed=1/0;if(null==iteratee&&null!=obj){obj=isArrayLike(obj)?obj:cv_.values(obj);for(var i=0,length=obj.length;length>i;i++){value=obj[i];result>value&&(result=value)}}else{iteratee=cb(iteratee,context);cv_.each(obj,function(value,index,list){computed=iteratee(value,index,list);if(lastComputed>computed||computed===1/0&&result===1/0){result=value;lastComputed=computed}})}return result};cv_.shuffle=function(obj){for(var rand,set=isArrayLike(obj)?obj:cv_.values(obj),length=set.length,shuffled=Array(length),index=0;length>index;index++){rand=cv_.random(0,index);rand!==index&&(shuffled[index]=shuffled[rand]);shuffled[rand]=set[index]}return shuffled};cv_.sample=function(obj,n,guard){if(null==n||guard){isArrayLike(obj)||(obj=cv_.values(obj));return obj[cv_.random(obj.length-1)]}return cv_.shuffle(obj).slice(0,Math.max(0,n))};cv_.sortBy=function(obj,iteratee,context){iteratee=cb(iteratee,context);return cv_.pluck(cv_.map(obj,function(value,index,list){return{value:value,index:index,criteria:iteratee(value,index,list)}}).sort(function(left,right){var a=left.criteria,b=right.criteria;if(a!==b){if(a>b||void 0===a)return 1;if(b>a||void 0===b)return-1}return left.index-right.index}),"value")};var group=function(behavior){return function(obj,iteratee,context){var result={};iteratee=cb(iteratee,context);cv_.each(obj,function(value,index){var key=iteratee(value,index,obj);behavior(result,value,key)});return result}};cv_.groupBy=group(function(result,value,key){cv_.has(result,key)?result[key].push(value):result[key]=[value]});cv_.indexBy=group(function(result,value,key){result[key]=value});cv_.countBy=group(function(result,value,key){cv_.has(result,key)?result[key]++:result[key]=1});cv_.toArray=function(obj){return obj?cv_.isArray(obj)?slice.call(obj):isArrayLike(obj)?cv_.map(obj,cv_.identity):cv_.values(obj):[]};cv_.size=function(obj){return null==obj?0:isArrayLike(obj)?obj.length:cv_.keys(obj).length};cv_.partition=function(obj,predicate,context){predicate=cb(predicate,context);var pass=[],fail=[];cv_.each(obj,function(value,key,obj){(predicate(value,key,obj)?pass:fail).push(value)});return[pass,fail]};cv_.first=cv_.head=cv_.take=function(array,n,guard){return null!=array?null==n||guard?array[0]:cv_.initial(array,array.length-n):void 0};cv_.initial=function(array,n,guard){return slice.call(array,0,Math.max(0,array.length-(null==n||guard?1:n)))};cv_.last=function(array,n,guard){return null!=array?null==n||guard?array[array.length-1]:cv_.rest(array,Math.max(0,array.length-n)):void 0};cv_.rest=cv_.tail=cv_.drop=function(array,n,guard){return slice.call(array,null==n||guard?1:n)};cv_.compact=function(array){return cv_.filter(array,cv_.identity)};var flatten=function(input,shallow,strict,startIndex){for(var output=[],idx=0,i=startIndex||0,length=getLength(input);length>i;i++){var value=input[i];if(isArrayLike(value)&&(cv_.isArray(value)||cv_.isArguments(value))){shallow||(value=flatten(value,shallow,strict));var j=0,len=value.length;output.length+=len;for(;len>j;)output[idx++]=value[j++]}else strict||(output[idx++]=value)}return output};cv_.flatten=function(array,shallow){return flatten(array,shallow,!1)};cv_.without=function(array){return cv_.difference(array,slice.call(arguments,1))};cv_.uniq=cv_.unique=function(array,isSorted,iteratee,context){if(!cv_.isBoolean(isSorted)){context=iteratee;iteratee=isSorted;isSorted=!1}null!=iteratee&&(iteratee=cb(iteratee,context));for(var result=[],seen=[],i=0,length=getLength(array);length>i;i++){var value=array[i],computed=iteratee?iteratee(value,i,array):value;if(isSorted){i&&seen===computed||result.push(value);seen=computed}else if(iteratee){if(!cv_.contains(seen,computed)){seen.push(computed);result.push(value)}}else cv_.contains(result,value)||result.push(value)}return result};cv_.union=function(){return cv_.uniq(flatten(arguments,!0,!0))};cv_.intersection=function(array){for(var result=[],argsLength=arguments.length,i=0,length=getLength(array);length>i;i++){var item=array[i];if(!cv_.contains(result,item)){for(var j=1;argsLength>j&&cv_.contains(arguments[j],item);j++);j===argsLength&&result.push(item)}}return result};cv_.difference=function(array){var rest=flatten(arguments,!0,!0,1);return cv_.filter(array,function(value){return!cv_.contains(rest,value)})};cv_.zip=function(){return cv_.unzip(arguments)};cv_.unzip=function(array){for(var length=array&&cv_.max(array,getLength).length||0,result=Array(length),index=0;length>index;index++)result[index]=cv_.pluck(array,index);return result};cv_.object=function(list,values){for(var result={},i=0,length=getLength(list);length>i;i++)values?result[list[i]]=values[i]:result[list[i][0]]=list[i][1];return result};cv_.findIndex=createPredicateIndexFinder(1);cv_.findLastIndex=createPredicateIndexFinder(-1);cv_.sortedIndex=function(array,obj,iteratee,context){iteratee=cb(iteratee,context,1);for(var value=iteratee(obj),low=0,high=getLength(array);high>low;){var mid=Math.floor((low+high)/2);iteratee(array[mid])<value?low=mid+1:high=mid}return low};cv_.indexOf=createIndexFinder(1,cv_.findIndex,cv_.sortedIndex);cv_.lastIndexOf=createIndexFinder(-1,cv_.findLastIndex);cv_.range=function(start,stop,step){if(null==stop){stop=start||0;start=0}step=step||1;for(var length=Math.max(Math.ceil((stop-start)/step),0),range=Array(length),idx=0;length>idx;idx++,start+=step)range[idx]=start;return range};var executeBound=function(sourceFunc,boundFunc,context,callingContext,args){if(!(callingContext instanceof boundFunc))return sourceFunc.apply(context,args);var self=baseCreate(sourceFunc.prototype),result=sourceFunc.apply(self,args);return cv_.isObject(result)?result:self};cv_.bind=function(func,context){if(nativeBind&&func.bind===nativeBind)return nativeBind.apply(func,slice.call(arguments,1));if(!cv_.isFunction(func))throw new TypeError("Bind must be called on a function");var args=slice.call(arguments,2),bound=function(){return executeBound(func,bound,context,this,args.concat(slice.call(arguments)))};return bound};cv_.partial=function(func){var boundArgs=slice.call(arguments,1),bound=function(){for(var position=0,length=boundArgs.length,args=Array(length),i=0;length>i;i++)args[i]=boundArgs[i]===cv_?arguments[position++]:boundArgs[i];for(;position<arguments.length;)args.push(arguments[position++]);return executeBound(func,bound,this,this,args)};return bound};cv_.bindAll=function(obj){var i,key,length=arguments.length;if(1>=length)throw new Error("bindAll must be passed function names");for(i=1;length>i;i++){key=arguments[i];obj[key]=cv_.bind(obj[key],obj)}return obj};cv_.memoize=function(func,hasher){var memoize=function(key){var cache=memoize.cache,address=""+(hasher?hasher.apply(this,arguments):key);cv_.has(cache,address)||(cache[address]=func.apply(this,arguments));return cache[address]};memoize.cache={};return memoize};cv_.delay=function(func,wait){var args=slice.call(arguments,2);return setTimeout(function(){return func.apply(null,args)},wait)};cv_.defer=cv_.partial(cv_.delay,cv_,1);cv_.throttle=function(func,wait,options){var context,args,result,timeout=null,previous=0;options||(options={});var later=function(){previous=options.leading===!1?0:cv_.now();timeout=null;result=func.apply(context,args);timeout||(context=args=null)};return function(){var now=cv_.now();previous||options.leading!==!1||(previous=now);var remaining=wait-(now-previous);context=this;args=arguments;if(0>=remaining||remaining>wait){if(timeout){clearTimeout(timeout);timeout=null}previous=now;result=func.apply(context,args);timeout||(context=args=null)}else timeout||options.trailing===!1||(timeout=setTimeout(later,remaining));return result}};cv_.debounce=function(func,wait,immediate){var timeout,args,context,timestamp,result,later=function(){var last=cv_.now()-timestamp;if(wait>last&&last>=0)timeout=setTimeout(later,wait-last);else{timeout=null;if(!immediate){result=func.apply(context,args);timeout||(context=args=null)}}};return function(){context=this;args=arguments;timestamp=cv_.now();var callNow=immediate&&!timeout;timeout||(timeout=setTimeout(later,wait));if(callNow){result=func.apply(context,args);context=args=null}return result}};cv_.wrap=function(func,wrapper){return cv_.partial(wrapper,func)};cv_.negate=function(predicate){return function(){return!predicate.apply(this,arguments)}};cv_.compose=function(){var args=arguments,start=args.length-1;return function(){for(var i=start,result=args[start].apply(this,arguments);i--;)result=args[i].call(this,result);return result}};cv_.after=function(times,func){return function(){return--times<1?func.apply(this,arguments):void 0}};cv_.before=function(times,func){var memo;return function(){--times>0&&(memo=func.apply(this,arguments));1>=times&&(func=null);return memo}};cv_.once=cv_.partial(cv_.before,2);var hasEnumBug=!{toString:null}.propertyIsEnumerable("toString"),nonEnumerableProps=["valueOf","isPrototypeOf","toString","propertyIsEnumerable","hasOwnProperty","toLocaleString"];cv_.keys=function(obj){if(!cv_.isObject(obj))return[];if(nativeKeys)return nativeKeys(obj);var keys=[];for(var key in obj)cv_.has(obj,key)&&keys.push(key);hasEnumBug&&collectNonEnumProps(obj,keys);return keys};cv_.allKeys=function(obj){if(!cv_.isObject(obj))return[];var keys=[];for(var key in obj)keys.push(key);hasEnumBug&&collectNonEnumProps(obj,keys);return keys};cv_.values=function(obj){for(var keys=cv_.keys(obj),length=keys.length,values=Array(length),i=0;length>i;i++)values[i]=obj[keys[i]];return values};cv_.mapObject=function(obj,iteratee,context){iteratee=cb(iteratee,context);for(var currentKey,keys=cv_.keys(obj),length=keys.length,results={},index=0;length>index;index++){currentKey=keys[index];results[currentKey]=iteratee(obj[currentKey],currentKey,obj)}return results};cv_.pairs=function(obj){for(var keys=cv_.keys(obj),length=keys.length,pairs=Array(length),i=0;length>i;i++)pairs[i]=[keys[i],obj[keys[i]]];return pairs};cv_.invert=function(obj){for(var result={},keys=cv_.keys(obj),i=0,length=keys.length;length>i;i++)result[obj[keys[i]]]=keys[i];return result};cv_.functions=cv_.methods=function(obj){var names=[];for(var key in obj)cv_.isFunction(obj[key])&&names.push(key);return names.sort()};cv_.extend=createAssigner(cv_.allKeys);cv_.extendOwn=cv_.assign=createAssigner(cv_.keys);cv_.findKey=function(obj,predicate,context){predicate=cb(predicate,context);for(var key,keys=cv_.keys(obj),i=0,length=keys.length;length>i;i++){key=keys[i];if(predicate(obj[key],key,obj))return key}};cv_.pick=function(object,oiteratee,context){var iteratee,keys,result={},obj=object;if(null==obj)return result;if(cv_.isFunction(oiteratee)){keys=cv_.allKeys(obj);iteratee=optimizeCb(oiteratee,context)}else{keys=flatten(arguments,!1,!1,1);iteratee=function(value,key,obj){return key in obj};obj=Object(obj)}for(var i=0,length=keys.length;length>i;i++){var key=keys[i],value=obj[key];iteratee(value,key,obj)&&(result[key]=value)}return result};cv_.omit=function(obj,iteratee,context){if(cv_.isFunction(iteratee))iteratee=cv_.negate(iteratee);else{var keys=cv_.map(flatten(arguments,!1,!1,1),String);iteratee=function(value,key){return!cv_.contains(keys,key)}}return cv_.pick(obj,iteratee,context)};cv_.defaults=createAssigner(cv_.allKeys,!0);cv_.create=function(prototype,props){var result=baseCreate(prototype);props&&cv_.extendOwn(result,props);return result};cv_.clone=function(obj){return cv_.isObject(obj)?cv_.isArray(obj)?obj.slice():cv_.extend({},obj):obj};cv_.tap=function(obj,interceptor){interceptor(obj);return obj};cv_.isMatch=function(object,attrs){var keys=cv_.keys(attrs),length=keys.length;if(null==object)return!length;for(var obj=Object(object),i=0;length>i;i++){var key=keys[i];if(attrs[key]!==obj[key]||!(key in obj))return!1}return!0};var eq=function(a,b,aStack,bStack){if(a===b)return 0!==a||1/a===1/b;if(null==a||null==b)return a===b;a instanceof cv_&&(a=a._wrapped);b instanceof cv_&&(b=b._wrapped);var className=toString.call(a);if(className!==toString.call(b))return!1;switch(className){case"[object RegExp]":case"[object String]":return""+a==""+b;case"[object Number]":return+a!==+a?+b!==+b:0===+a?1/+a===1/b:+a===+b;case"[object Date]":case"[object Boolean]":return+a===+b}var areArrays="[object Array]"===className;if(!areArrays){if("object"!=typeof a||"object"!=typeof b)return!1;var aCtor=a.constructor,bCtor=b.constructor;if(aCtor!==bCtor&&!(cv_.isFunction(aCtor)&&aCtor instanceof aCtor&&cv_.isFunction(bCtor)&&bCtor instanceof bCtor)&&"constructor"in a&&"constructor"in b)return!1}aStack=aStack||[];bStack=bStack||[];for(var length=aStack.length;length--;)if(aStack[length]===a)return bStack[length]===b;aStack.push(a);bStack.push(b);if(areArrays){length=a.length;if(length!==b.length)return!1;for(;length--;)if(!eq(a[length],b[length],aStack,bStack))return!1}else{var key,keys=cv_.keys(a);length=keys.length;if(cv_.keys(b).length!==length)return!1;for(;length--;){key=keys[length];if(!cv_.has(b,key)||!eq(a[key],b[key],aStack,bStack))return!1}}aStack.pop();bStack.pop();return!0};cv_.isEqual=function(a,b){return eq(a,b)};cv_.isEmpty=function(obj){return null==obj?!0:isArrayLike(obj)&&(cv_.isArray(obj)||cv_.isString(obj)||cv_.isArguments(obj))?0===obj.length:0===cv_.keys(obj).length};cv_.isElement=function(obj){return!(!obj||1!==obj.nodeType)};cv_.isArray=nativeIsArray||function(obj){return"[object Array]"===toString.call(obj)};cv_.isObject=function(obj){var type=typeof obj;return"function"===type||"object"===type&&!!obj};cv_.each(["Arguments","Function","String","Number","Date","RegExp","Error"],function(name){cv_["is"+name]=function(obj){return toString.call(obj)==="[object "+name+"]"}});cv_.isArguments(arguments)||(cv_.isArguments=function(obj){return cv_.has(obj,"callee")});"function"!=typeof/./&&"object"!=typeof Int8Array&&(cv_.isFunction=function(obj){return"function"==typeof obj||!1});cv_.isFinite=function(obj){return isFinite(obj)&&!isNaN(parseFloat(obj))};cv_.isNaN=function(obj){return cv_.isNumber(obj)&&obj!==+obj};cv_.isBoolean=function(obj){return obj===!0||obj===!1||"[object Boolean]"===toString.call(obj)};cv_.isNull=function(obj){return null===obj};cv_.isUndefined=function(obj){return void 0===obj};cv_.has=function(obj,key){return null!=obj&&hasOwnProperty.call(obj,key)};cv_.noConflict=function(){root.cv_=previousUnderscore;return this};cv_.identity=function(value){return value};cv_.constant=function(value){return function(){return value}};cv_.noop=function(){};cv_.property=property;cv_.propertyOf=function(obj){return null==obj?function(){}:function(key){return obj[key]}};cv_.matcher=cv_.matches=function(attrs){attrs=cv_.extendOwn({},attrs);return function(obj){return cv_.isMatch(obj,attrs)}};cv_.times=function(n,iteratee,context){var accum=Array(Math.max(0,n));iteratee=optimizeCb(iteratee,context,1);for(var i=0;n>i;i++)accum[i]=iteratee(i);return accum};cv_.random=function(min,max){if(null==max){max=min;min=0}return min+Math.floor(Math.random()*(max-min+1))};cv_.now=Date.now||function(){return(new Date).getTime()};var escapeMap={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#x27;","`":"&#x60;"},unescapeMap=cv_.invert(escapeMap),createEscaper=function(map){var escaper=function(match){return map[match]},source="(?:"+cv_.keys(map).join("|")+")",testRegexp=RegExp(source),replaceRegexp=RegExp(source,"g");return function(string){string=null==string?"":""+string;return testRegexp.test(string)?string.replace(replaceRegexp,escaper):string}};cv_.escape=createEscaper(escapeMap);cv_.unescape=createEscaper(unescapeMap);cv_.result=function(object,property,fallback){var value=null==object?void 0:object[property];void 0===value&&(value=fallback);return cv_.isFunction(value)?value.call(object):value};var idCounter=0;cv_.uniqueId=function(prefix){var id=++idCounter+"";return prefix?prefix+id:id};cv_.templateSettings={evaluate:/<%([\s\S]+?)%>/g,interpolate:/<%=([\s\S]+?)%>/g,escape:/<%-([\s\S]+?)%>/g};var noMatch=/(.)^/,escapes={"'":"'","\\":"\\","\r":"r","\n":"n","\u2028":"u2028","\u2029":"u2029"},escaper=/\\|'|\r|\n|\u2028|\u2029/g,escapeChar=function(match){return"\\"+escapes[match]};cv_.template=function(text,settings,oldSettings){!settings&&oldSettings&&(settings=oldSettings);settings=cv_.defaults({},settings,cv_.templateSettings);var matcher=RegExp([(settings.escape||noMatch).source,(settings.interpolate||noMatch).source,(settings.evaluate||noMatch).source].join("|")+"|$","g"),index=0,source="__p+='";text.replace(matcher,function(match,escape,interpolate,evaluate,offset){source+=text.slice(index,offset).replace(escaper,escapeChar);index=offset+match.length;escape?source+="'+\n((__t=("+escape+"))==null?'':cv_.escape(__t))+\n'":interpolate?source+="'+\n((__t=("+interpolate+"))==null?'':__t)+\n'":evaluate&&(source+="';\n"+evaluate+"\n__p+='");return match});source+="';\n";settings.variable||(source="with(obj||{}){\n"+source+"}\n");source="var __t,__p='',__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,'');};\n"+source+"return __p;\n";try{var render=new Function(settings.variable||"obj","cv_",source)}catch(e){e.source=source;throw e}var template=function(data){return render.call(this,data,cv_)},argument=settings.variable||"obj";template.source="function("+argument+"){\n"+source+"}";return template};cv_.chain=function(obj){var instance=cv_(obj);
instance._chain=!0;return instance};var result=function(instance,obj){return instance._chain?cv_(obj).chain():obj};cv_.mixin=function(obj){cv_.each(cv_.functions(obj),function(name){var func=cv_[name]=obj[name];cv_.prototype[name]=function(){var args=[this._wrapped];push.apply(args,arguments);return result(this,func.apply(cv_,args))}})};cv_.mixin(cv_);cv_.each(["pop","push","reverse","shift","sort","splice","unshift"],function(name){var method=ArrayProto[name];cv_.prototype[name]=function(){var obj=this._wrapped;method.apply(obj,arguments);"shift"!==name&&"splice"!==name||0!==obj.length||delete obj[0];return result(this,obj)}});cv_.each(["concat","join","slice"],function(name){var method=ArrayProto[name];cv_.prototype[name]=function(){return result(this,method.apply(this._wrapped,arguments))}});cv_.prototype.value=function(){return this._wrapped};cv_.prototype.valueOf=cv_.prototype.toJSON=cv_.prototype.value;cv_.prototype.toString=function(){return""+this._wrapped};"function"==typeof define&&define.amd&&define("underscore_loader",[],function(){return cv_});return cv_});!function(factory){var root="object"==typeof self&&self.self===self&&self||"object"==typeof global&&global.global===global&&global;if("function"==typeof define&&define.amd)define("backbone",["underscore-loader","jquery","exports"],function(_,$,exports){root.Backbone=factory(root,exports,_,$)});else if("undefined"!=typeof exports){var $,_=require("underscore-loader");try{$=require("jquery")}catch(e){}factory(root,exports,_,$)}else root.Backbone=factory(root,{},root._,root.jQuery||root.Zepto||root.ender||root.$)}(function(root,Backbone,_,$){var previousBackbone=root.Backbone,slice=Array.prototype.slice;Backbone.VERSION="1.3.3";Backbone.$=$;Backbone.noConflict=function(){root.Backbone=previousBackbone;return this};Backbone.emulateHTTP=!1;Backbone.emulateJSON=!1;var addMethod=function(length,method,attribute){switch(length){case 1:return function(){return _[method](this[attribute])};case 2:return function(value){return _[method](this[attribute],value)};case 3:return function(iteratee,context){return _[method](this[attribute],cb(iteratee,this),context)};case 4:return function(iteratee,defaultVal,context){return _[method](this[attribute],cb(iteratee,this),defaultVal,context)};default:return function(){var args=slice.call(arguments);args.unshift(this[attribute]);return _[method].apply(_,args)}}},addUnderscoreMethods=function(Class,methods,attribute){_.each(methods,function(length,method){_[method]&&(Class.prototype[method]=addMethod(length,method,attribute))})},cb=function(iteratee,instance){return _.isFunction(iteratee)?iteratee:_.isObject(iteratee)&&!instance._isModel(iteratee)?modelMatcher(iteratee):_.isString(iteratee)?function(model){return model.get(iteratee)}:iteratee},modelMatcher=function(attrs){var matcher=_.matches(attrs);return function(model){return matcher(model.attributes)}},Events=Backbone.Events={},eventSplitter=/\s+/,eventsApi=function(iteratee,events,name,callback,opts){var names,i=0;if(name&&"object"==typeof name){void 0!==callback&&"context"in opts&&void 0===opts.context&&(opts.context=callback);for(names=_.keys(name);i<names.length;i++)events=eventsApi(iteratee,events,names[i],name[names[i]],opts)}else if(name&&eventSplitter.test(name))for(names=name.split(eventSplitter);i<names.length;i++)events=iteratee(events,names[i],callback,opts);else events=iteratee(events,name,callback,opts);return events};Events.on=function(name,callback,context){return internalOn(this,name,callback,context)};var internalOn=function(obj,name,callback,context,listening){obj._events=eventsApi(onApi,obj._events||{},name,callback,{context:context,ctx:obj,listening:listening});if(listening){var listeners=obj._listeners||(obj._listeners={});listeners[listening.id]=listening}return obj};Events.listenTo=function(obj,name,callback){if(!obj)return this;var id=obj._listenId||(obj._listenId=_.uniqueId("l")),listeningTo=this._listeningTo||(this._listeningTo={}),listening=listeningTo[id];if(!listening){var thisId=this._listenId||(this._listenId=_.uniqueId("l"));listening=listeningTo[id]={obj:obj,objId:id,id:thisId,listeningTo:listeningTo,count:0}}internalOn(obj,name,callback,this,listening);return this};var onApi=function(events,name,callback,options){if(callback){var handlers=events[name]||(events[name]=[]),context=options.context,ctx=options.ctx,listening=options.listening;listening&&listening.count++;handlers.push({callback:callback,context:context,ctx:context||ctx,listening:listening})}return events};Events.off=function(name,callback,context){if(!this._events)return this;this._events=eventsApi(offApi,this._events,name,callback,{context:context,listeners:this._listeners});return this};Events.stopListening=function(obj,name,callback){var listeningTo=this._listeningTo;if(!listeningTo)return this;for(var ids=obj?[obj._listenId]:_.keys(listeningTo),i=0;i<ids.length;i++){var listening=listeningTo[ids[i]];if(!listening)break;listening.obj.off(name,callback,this)}return this};var offApi=function(events,name,callback,options){if(events){var listening,i=0,context=options.context,listeners=options.listeners;if(name||callback||context){for(var names=name?[name]:_.keys(events);i<names.length;i++){name=names[i];var handlers=events[name];if(!handlers)break;for(var remaining=[],j=0;j<handlers.length;j++){var handler=handlers[j];if(callback&&callback!==handler.callback&&callback!==handler.callback._callback||context&&context!==handler.context)remaining.push(handler);else{listening=handler.listening;if(listening&&0===--listening.count){delete listeners[listening.id];delete listening.listeningTo[listening.objId]}}}remaining.length?events[name]=remaining:delete events[name]}return events}for(var ids=_.keys(listeners);i<ids.length;i++){listening=listeners[ids[i]];delete listeners[listening.id];delete listening.listeningTo[listening.objId]}}};Events.once=function(name,callback,context){var events=eventsApi(onceMap,{},name,callback,_.bind(this.off,this));"string"==typeof name&&null==context&&(callback=void 0);return this.on(events,callback,context)};Events.listenToOnce=function(obj,name,callback){var events=eventsApi(onceMap,{},name,callback,_.bind(this.stopListening,this,obj));return this.listenTo(obj,events)};var onceMap=function(map,name,callback,offer){if(callback){var once=map[name]=_.once(function(){offer(name,once);callback.apply(this,arguments)});once._callback=callback}return map};Events.trigger=function(name){if(!this._events)return this;for(var length=Math.max(0,arguments.length-1),args=Array(length),i=0;length>i;i++)args[i]=arguments[i+1];eventsApi(triggerApi,this._events,name,void 0,args);return this};var triggerApi=function(objEvents,name,callback,args){if(objEvents){var events=objEvents[name],allEvents=objEvents.all;events&&allEvents&&(allEvents=allEvents.slice());events&&triggerEvents(events,args);allEvents&&triggerEvents(allEvents,[name].concat(args))}return objEvents},triggerEvents=function(events,args){var ev,i=-1,l=events.length,a1=args[0],a2=args[1],a3=args[2];switch(args.length){case 0:for(;++i<l;)(ev=events[i]).callback.call(ev.ctx);return;case 1:for(;++i<l;)(ev=events[i]).callback.call(ev.ctx,a1);return;case 2:for(;++i<l;)(ev=events[i]).callback.call(ev.ctx,a1,a2);return;case 3:for(;++i<l;)(ev=events[i]).callback.call(ev.ctx,a1,a2,a3);return;default:for(;++i<l;)(ev=events[i]).callback.apply(ev.ctx,args);return}};Events.bind=Events.on;Events.unbind=Events.off;_.extend(Backbone,Events);var Model=Backbone.Model=function(attributes,options){var attrs=attributes||{};options||(options={});this.cid=_.uniqueId(this.cidPrefix);this.attributes={};options.collection&&(this.collection=options.collection);options.parse&&(attrs=this.parse(attrs,options)||{});var defaults=_.result(this,"defaults");attrs=_.defaults(_.extend({},defaults,attrs),defaults);this.set(attrs,options);this.changed={};this.initialize.apply(this,arguments)};_.extend(Model.prototype,Events,{changed:null,validationError:null,idAttribute:"id",cidPrefix:"c",initialize:function(){},toJSON:function(options){return _.clone(this.attributes)},sync:function(){return Backbone.sync.apply(this,arguments)},get:function(attr){return this.attributes[attr]},escape:function(attr){return _.escape(this.get(attr))},has:function(attr){return null!=this.get(attr)},matches:function(attrs){return!!_.iteratee(attrs,this)(this.attributes)},set:function(key,val,options){if(null==key)return this;var attrs;if("object"==typeof key){attrs=key;options=val}else(attrs={})[key]=val;options||(options={});if(!this._validate(attrs,options))return!1;var unset=options.unset,silent=options.silent,changes=[],changing=this._changing;this._changing=!0;if(!changing){this._previousAttributes=_.clone(this.attributes);this.changed={}}var current=this.attributes,changed=this.changed,prev=this._previousAttributes;for(var attr in attrs){val=attrs[attr];_.isEqual(current[attr],val)||changes.push(attr);_.isEqual(prev[attr],val)?delete changed[attr]:changed[attr]=val;unset?delete current[attr]:current[attr]=val}this.idAttribute in attrs&&(this.id=this.get(this.idAttribute));if(!silent){changes.length&&(this._pending=options);for(var i=0;i<changes.length;i++)this.trigger("change:"+changes[i],this,current[changes[i]],options)}if(changing)return this;if(!silent)for(;this._pending;){options=this._pending;this._pending=!1;this.trigger("change",this,options)}this._pending=!1;this._changing=!1;return this},unset:function(attr,options){return this.set(attr,void 0,_.extend({},options,{unset:!0}))},clear:function(options){var attrs={};for(var key in this.attributes)attrs[key]=void 0;return this.set(attrs,_.extend({},options,{unset:!0}))},hasChanged:function(attr){return null==attr?!_.isEmpty(this.changed):_.has(this.changed,attr)},changedAttributes:function(diff){if(!diff)return this.hasChanged()?_.clone(this.changed):!1;var old=this._changing?this._previousAttributes:this.attributes,changed={};for(var attr in diff){var val=diff[attr];_.isEqual(old[attr],val)||(changed[attr]=val)}return _.size(changed)?changed:!1},previous:function(attr){return null!=attr&&this._previousAttributes?this._previousAttributes[attr]:null},previousAttributes:function(){return _.clone(this._previousAttributes)},fetch:function(options){options=_.extend({parse:!0},options);var model=this,success=options.success;options.success=function(resp){var serverAttrs=options.parse?model.parse(resp,options):resp;if(!model.set(serverAttrs,options))return!1;success&&success.call(options.context,model,resp,options);model.trigger("sync",model,resp,options)};wrapError(this,options);return this.sync("read",this,options)},save:function(key,val,options){var attrs;if(null==key||"object"==typeof key){attrs=key;options=val}else(attrs={})[key]=val;options=_.extend({validate:!0,parse:!0},options);var wait=options.wait;if(attrs&&!wait){if(!this.set(attrs,options))return!1}else if(!this._validate(attrs,options))return!1;var model=this,success=options.success,attributes=this.attributes;options.success=function(resp){model.attributes=attributes;var serverAttrs=options.parse?model.parse(resp,options):resp;wait&&(serverAttrs=_.extend({},attrs,serverAttrs));if(serverAttrs&&!model.set(serverAttrs,options))return!1;success&&success.call(options.context,model,resp,options);model.trigger("sync",model,resp,options)};wrapError(this,options);attrs&&wait&&(this.attributes=_.extend({},attributes,attrs));var method=this.isNew()?"create":options.patch?"patch":"update";"patch"!==method||options.attrs||(options.attrs=attrs);var xhr=this.sync(method,this,options);this.attributes=attributes;return xhr},destroy:function(options){options=options?_.clone(options):{};var model=this,success=options.success,wait=options.wait,destroy=function(){model.stopListening();model.trigger("destroy",model,model.collection,options)};options.success=function(resp){wait&&destroy();success&&success.call(options.context,model,resp,options);model.isNew()||model.trigger("sync",model,resp,options)};var xhr=!1;if(this.isNew())_.defer(options.success);else{wrapError(this,options);xhr=this.sync("delete",this,options)}wait||destroy();return xhr},url:function(){var base=_.result(this,"urlRoot")||_.result(this.collection,"url")||urlError();if(this.isNew())return base;var id=this.get(this.idAttribute);return base.replace(/[^\/]$/,"$&/")+encodeURIComponent(id)},parse:function(resp,options){return resp},clone:function(){return new this.constructor(this.attributes)},isNew:function(){return!this.has(this.idAttribute)},isValid:function(options){return this._validate({},_.extend({},options,{validate:!0}))},_validate:function(attrs,options){if(!options.validate||!this.validate)return!0;attrs=_.extend({},this.attributes,attrs);var error=this.validationError=this.validate(attrs,options)||null;if(!error)return!0;this.trigger("invalid",this,error,_.extend(options,{validationError:error}));return!1}});var modelMethods={keys:1,values:1,pairs:1,invert:1,pick:0,omit:0,chain:1,isEmpty:1};addUnderscoreMethods(Model,modelMethods,"attributes");var Collection=Backbone.Collection=function(models,options){options||(options={});options.model&&(this.model=options.model);void 0!==options.comparator&&(this.comparator=options.comparator);this._reset();this.initialize.apply(this,arguments);models&&this.reset(models,_.extend({silent:!0},options))},setOptions={add:!0,remove:!0,merge:!0},addOptions={add:!0,remove:!1},splice=function(array,insert,at){at=Math.min(Math.max(at,0),array.length);var i,tail=Array(array.length-at),length=insert.length;for(i=0;i<tail.length;i++)tail[i]=array[i+at];for(i=0;length>i;i++)array[i+at]=insert[i];for(i=0;i<tail.length;i++)array[i+length+at]=tail[i]};_.extend(Collection.prototype,Events,{model:Model,initialize:function(){},toJSON:function(options){return this.map(function(model){return model.toJSON(options)})},sync:function(){return Backbone.sync.apply(this,arguments)},add:function(models,options){return this.set(models,_.extend({merge:!1},options,addOptions))},remove:function(models,options){options=_.extend({},options);var singular=!_.isArray(models);models=singular?[models]:models.slice();var removed=this._removeModels(models,options);if(!options.silent&&removed.length){options.changes={added:[],merged:[],removed:removed};this.trigger("update",this,options)}return singular?removed[0]:removed},set:function(models,options){if(null!=models){options=_.extend({},setOptions,options);options.parse&&!this._isModel(models)&&(models=this.parse(models,options)||[]);var singular=!_.isArray(models);models=singular?[models]:models.slice();var at=options.at;null!=at&&(at=+at);at>this.length&&(at=this.length);0>at&&(at+=this.length+1);var model,i,set=[],toAdd=[],toMerge=[],toRemove=[],modelMap={},add=options.add,merge=options.merge,remove=options.remove,sort=!1,sortable=this.comparator&&null==at&&options.sort!==!1,sortAttr=_.isString(this.comparator)?this.comparator:null;for(i=0;i<models.length;i++){model=models[i];var existing=this.get(model);if(existing){if(merge&&model!==existing){var attrs=this._isModel(model)?model.attributes:model;options.parse&&(attrs=existing.parse(attrs,options));existing.set(attrs,options);toMerge.push(existing);sortable&&!sort&&(sort=existing.hasChanged(sortAttr))}if(!modelMap[existing.cid]){modelMap[existing.cid]=!0;set.push(existing)}models[i]=existing}else if(add){model=models[i]=this._prepareModel(model,options);if(model){toAdd.push(model);this._addReference(model,options);modelMap[model.cid]=!0;set.push(model)}}}if(remove){for(i=0;i<this.length;i++){model=this.models[i];modelMap[model.cid]||toRemove.push(model)}toRemove.length&&this._removeModels(toRemove,options)}var orderChanged=!1,replace=!sortable&&add&&remove;if(set.length&&replace){orderChanged=this.length!==set.length||_.some(this.models,function(m,index){return m!==set[index]});this.models.length=0;splice(this.models,set,0);this.length=this.models.length}else if(toAdd.length){sortable&&(sort=!0);splice(this.models,toAdd,null==at?this.length:at);this.length=this.models.length}sort&&this.sort({silent:!0});if(!options.silent){for(i=0;i<toAdd.length;i++){null!=at&&(options.index=at+i);model=toAdd[i];model.trigger("add",model,this,options)}(sort||orderChanged)&&this.trigger("sort",this,options);if(toAdd.length||toRemove.length||toMerge.length){options.changes={added:toAdd,removed:toRemove,merged:toMerge};this.trigger("update",this,options)}}return singular?models[0]:models}},reset:function(models,options){options=options?_.clone(options):{};for(var i=0;i<this.models.length;i++)this._removeReference(this.models[i],options);options.previousModels=this.models;this._reset();models=this.add(models,_.extend({silent:!0},options));options.silent||this.trigger("reset",this,options);return models},push:function(model,options){return this.add(model,_.extend({at:this.length},options))},pop:function(options){var model=this.at(this.length-1);return this.remove(model,options)},unshift:function(model,options){return this.add(model,_.extend({at:0},options))},shift:function(options){var model=this.at(0);return this.remove(model,options)},slice:function(){return slice.apply(this.models,arguments)},get:function(obj){return null!=obj?this._byId[obj]||this._byId[this.modelId(obj.attributes||obj)]||obj.cid&&this._byId[obj.cid]:void 0},has:function(obj){return null!=this.get(obj)},at:function(index){0>index&&(index+=this.length);return this.models[index]},where:function(attrs,first){return this[first?"find":"filter"](attrs)},findWhere:function(attrs){return this.where(attrs,!0)},sort:function(options){var comparator=this.comparator;if(!comparator)throw new Error("Cannot sort a set without a comparator");options||(options={});var length=comparator.length;_.isFunction(comparator)&&(comparator=_.bind(comparator,this));1===length||_.isString(comparator)?this.models=this.sortBy(comparator):this.models.sort(comparator);options.silent||this.trigger("sort",this,options);return this},pluck:function(attr){return this.map(attr+"")},fetch:function(options){options=_.extend({parse:!0},options);var success=options.success,collection=this;options.success=function(resp){var method=options.reset?"reset":"set";collection[method](resp,options);success&&success.call(options.context,collection,resp,options);collection.trigger("sync",collection,resp,options)};wrapError(this,options);return this.sync("read",this,options)},create:function(model,options){options=options?_.clone(options):{};var wait=options.wait;model=this._prepareModel(model,options);if(!model)return!1;wait||this.add(model,options);var collection=this,success=options.success;options.success=function(m,resp,callbackOpts){wait&&collection.add(m,callbackOpts);success&&success.call(callbackOpts.context,m,resp,callbackOpts)};model.save(null,options);return model},parse:function(resp,options){return resp},clone:function(){return new this.constructor(this.models,{model:this.model,comparator:this.comparator})},modelId:function(attrs){return attrs[this.model.prototype.idAttribute||"id"]},_reset:function(){this.length=0;this.models=[];this._byId={}},_prepareModel:function(attrs,options){if(this._isModel(attrs)){attrs.collection||(attrs.collection=this);return attrs}options=options?_.clone(options):{};options.collection=this;var model=new this.model(attrs,options);if(!model.validationError)return model;this.trigger("invalid",this,model.validationError,options);return!1},_removeModels:function(models,options){for(var removed=[],i=0;i<models.length;i++){var model=this.get(models[i]);if(model){var index=this.indexOf(model);this.models.splice(index,1);this.length--;delete this._byId[model.cid];var id=this.modelId(model.attributes);null!=id&&delete this._byId[id];if(!options.silent){options.index=index;model.trigger("remove",model,this,options)}removed.push(model);this._removeReference(model,options)}}return removed},_isModel:function(model){return model instanceof Model},_addReference:function(model,options){this._byId[model.cid]=model;var id=this.modelId(model.attributes);null!=id&&(this._byId[id]=model);model.on("all",this._onModelEvent,this)},_removeReference:function(model,options){delete this._byId[model.cid];var id=this.modelId(model.attributes);null!=id&&delete this._byId[id];this===model.collection&&delete model.collection;model.off("all",this._onModelEvent,this)},_onModelEvent:function(event,model,collection,options){if(model){if(("add"===event||"remove"===event)&&collection!==this)return;"destroy"===event&&this.remove(model,options);if("change"===event){var prevId=this.modelId(model.previousAttributes()),id=this.modelId(model.attributes);if(prevId!==id){null!=prevId&&delete this._byId[prevId];null!=id&&(this._byId[id]=model)}}}this.trigger.apply(this,arguments)}});var collectionMethods={forEach:3,each:3,map:3,collect:3,reduce:0,foldl:0,inject:0,reduceRight:0,foldr:0,find:3,detect:3,filter:3,select:3,reject:3,every:3,all:3,some:3,any:3,include:3,includes:3,contains:3,invoke:0,max:3,min:3,toArray:1,size:1,first:3,head:3,take:3,initial:3,rest:3,tail:3,drop:3,last:3,without:0,difference:0,indexOf:3,shuffle:1,lastIndexOf:3,isEmpty:1,chain:1,sample:3,partition:3,groupBy:3,countBy:3,sortBy:3,indexBy:3,findIndex:3,findLastIndex:3};addUnderscoreMethods(Collection,collectionMethods,"models");var View=Backbone.View=function(options){this.cid=_.uniqueId("view");_.extend(this,_.pick(options,viewOptions));this._ensureElement();this.initialize.apply(this,arguments)},delegateEventSplitter=/^(\S+)\s*(.*)$/,viewOptions=["model","collection","el","id","attributes","className","tagName","events"];_.extend(View.prototype,Events,{tagName:"div",$:function(selector){return this.$el.find(selector)},initialize:function(){},render:function(){return this},remove:function(){this._removeElement();this.stopListening();return this},_removeElement:function(){this.$el.remove()},setElement:function(element){this.undelegateEvents();this._setElement(element);this.delegateEvents();return this},_setElement:function(el){this.$el=el instanceof Backbone.$?el:Backbone.$(el);this.el=this.$el[0]},delegateEvents:function(events){events||(events=_.result(this,"events"));if(!events)return this;this.undelegateEvents();for(var key in events){var method=events[key];_.isFunction(method)||(method=this[method]);if(method){var match=key.match(delegateEventSplitter);this.delegate(match[1],match[2],_.bind(method,this))}}return this},delegate:function(eventName,selector,listener){this.$el.on(eventName+".delegateEvents"+this.cid,selector,listener);return this},undelegateEvents:function(){this.$el&&this.$el.off(".delegateEvents"+this.cid);return this},undelegate:function(eventName,selector,listener){this.$el.off(eventName+".delegateEvents"+this.cid,selector,listener);return this},_createElement:function(tagName){return document.createElement(tagName)},_ensureElement:function(){if(this.el)this.setElement(_.result(this,"el"));else{var attrs=_.extend({},_.result(this,"attributes"));this.id&&(attrs.id=_.result(this,"id"));this.className&&(attrs["class"]=_.result(this,"className"));this.setElement(this._createElement(_.result(this,"tagName")));this._setAttributes(attrs)}},_setAttributes:function(attributes){this.$el.attr(attributes)}});Backbone.sync=function(method,model,options){var type=methodMap[method];_.defaults(options||(options={}),{emulateHTTP:Backbone.emulateHTTP,emulateJSON:Backbone.emulateJSON});var params={type:type,dataType:"json"};options.url||(params.url=_.result(model,"url")||urlError());if(null==options.data&&model&&("create"===method||"update"===method||"patch"===method)){params.contentType="application/json";params.data=JSON.stringify(options.attrs||model.toJSON(options))}if(options.emulateJSON){params.contentType="application/x-www-form-urlencoded";params.data=params.data?{model:params.data}:{}}if(options.emulateHTTP&&("PUT"===type||"DELETE"===type||"PATCH"===type)){params.type="POST";options.emulateJSON&&(params.data._method=type);var beforeSend=options.beforeSend;options.beforeSend=function(xhr){xhr.setRequestHeader("X-HTTP-Method-Override",type);return beforeSend?beforeSend.apply(this,arguments):void 0}}"GET"===params.type||options.emulateJSON||(params.processData=!1);var error=options.error;options.error=function(xhr,textStatus,errorThrown){options.textStatus=textStatus;options.errorThrown=errorThrown;error&&error.call(options.context,xhr,textStatus,errorThrown)};var xhr=options.xhr=Backbone.ajax(_.extend(params,options));model.trigger("request",model,xhr,options);return xhr};var methodMap={create:"POST",update:"PUT",patch:"PATCH","delete":"DELETE",read:"GET"};Backbone.ajax=function(){return Backbone.$.ajax.apply(Backbone.$,arguments)};var Router=Backbone.Router=function(options){options||(options={});options.routes&&(this.routes=options.routes);this._bindRoutes();this.initialize.apply(this,arguments)},optionalParam=/\((.*?)\)/g,namedParam=/(\(\?)?:\w+/g,splatParam=/\*\w+/g,escapeRegExp=/[\-{}\[\]+?.,\\\^$|#\s]/g;_.extend(Router.prototype,Events,{initialize:function(){},route:function(route,name,callback){_.isRegExp(route)||(route=this._routeToRegExp(route));if(_.isFunction(name)){callback=name;name=""}callback||(callback=this[name]);var router=this;Backbone.history.route(route,function(fragment){var args=router._extractParameters(route,fragment);if(router.execute(callback,args,name)!==!1){router.trigger.apply(router,["route:"+name].concat(args));router.trigger("route",name,args);Backbone.history.trigger("route",router,name,args)}});return this},execute:function(callback,args,name){callback&&callback.apply(this,args)},navigate:function(fragment,options){Backbone.history.navigate(fragment,options);return this},_bindRoutes:function(){if(this.routes){this.routes=_.result(this,"routes");for(var route,routes=_.keys(this.routes);null!=(route=routes.pop());)this.route(route,this.routes[route])}},_routeToRegExp:function(route){route=route.replace(escapeRegExp,"\\$&").replace(optionalParam,"(?:$1)?").replace(namedParam,function(match,optional){return optional?match:"([^/?]+)"}).replace(splatParam,"([^?]*?)");return new RegExp("^"+route+"(?:\\?([\\s\\S]*))?$")},_extractParameters:function(route,fragment){var params=route.exec(fragment).slice(1);return _.map(params,function(param,i){return i===params.length-1?param||null:param?decodeURIComponent(param):null})}});var History=Backbone.History=function(){this.handlers=[];this.checkUrl=_.bind(this.checkUrl,this);if("undefined"!=typeof window){this.location=window.location;this.history=window.history}},routeStripper=/^[#\/]|\s+$/g,rootStripper=/^\/+|\/+$/g,pathStripper=/#.*$/;History.started=!1;_.extend(History.prototype,Events,{interval:50,atRoot:function(){var path=this.location.pathname.replace(/[^\/]$/,"$&/");return path===this.root&&!this.getSearch()},matchRoot:function(){var path=this.decodeFragment(this.location.pathname),rootPath=path.slice(0,this.root.length-1)+"/";return rootPath===this.root},decodeFragment:function(fragment){return decodeURI(fragment.replace(/%25/g,"%2525"))},getSearch:function(){var match=this.location.href.replace(/#.*/,"").match(/\?.+/);return match?match[0]:""},getHash:function(window){var match=(window||this).location.href.match(/#(.*)$/);return match?match[1]:""},getPath:function(){var path=this.decodeFragment(this.location.pathname+this.getSearch()).slice(this.root.length-1);return"/"===path.charAt(0)?path.slice(1):path},getFragment:function(fragment){null==fragment&&(fragment=this._usePushState||!this._wantsHashChange?this.getPath():this.getHash());return fragment.replace(routeStripper,"")},start:function(options){if(History.started)throw new Error("Backbone.history has already been started");History.started=!0;this.options=_.extend({root:"/"},this.options,options);this.root=this.options.root;this._wantsHashChange=this.options.hashChange!==!1;this._hasHashChange="onhashchange"in window&&(void 0===document.documentMode||document.documentMode>7);this._useHashChange=this._wantsHashChange&&this._hasHashChange;this._wantsPushState=!!this.options.pushState;this._hasPushState=!(!this.history||!this.history.pushState);this._usePushState=this._wantsPushState&&this._hasPushState;this.fragment=this.getFragment();this.root=("/"+this.root+"/").replace(rootStripper,"/");if(this._wantsHashChange&&this._wantsPushState){if(!this._hasPushState&&!this.atRoot()){var rootPath=this.root.slice(0,-1)||"/";this.location.replace(rootPath+"#"+this.getPath());return!0}this._hasPushState&&this.atRoot()&&this.navigate(this.getHash(),{replace:!0})}if(!this._hasHashChange&&this._wantsHashChange&&!this._usePushState){this.iframe=document.createElement("iframe");this.iframe.src="javascript:0";this.iframe.style.display="none";this.iframe.tabIndex=-1;var body=document.body,iWindow=body.insertBefore(this.iframe,body.firstChild).contentWindow;iWindow.document.open();iWindow.document.close();iWindow.location.hash="#"+this.fragment}var addEventListener=window.addEventListener||function(eventName,listener){return attachEvent("on"+eventName,listener)};this._usePushState?addEventListener("popstate",this.checkUrl,!1):this._useHashChange&&!this.iframe?addEventListener("hashchange",this.checkUrl,!1):this._wantsHashChange&&(this._checkUrlInterval=setInterval(this.checkUrl,this.interval));return this.options.silent?void 0:this.loadUrl()},stop:function(){var removeEventListener=window.removeEventListener||function(eventName,listener){return detachEvent("on"+eventName,listener)};this._usePushState?removeEventListener("popstate",this.checkUrl,!1):this._useHashChange&&!this.iframe&&removeEventListener("hashchange",this.checkUrl,!1);if(this.iframe){document.body.removeChild(this.iframe);this.iframe=null}this._checkUrlInterval&&clearInterval(this._checkUrlInterval);History.started=!1},route:function(route,callback){this.handlers.unshift({route:route,callback:callback})},checkUrl:function(e){var current=this.getFragment();current===this.fragment&&this.iframe&&(current=this.getHash(this.iframe.contentWindow));if(current===this.fragment)return!1;this.iframe&&this.navigate(current);this.loadUrl()},loadUrl:function(fragment){if(!this.matchRoot())return!1;fragment=this.fragment=this.getFragment(fragment);return _.some(this.handlers,function(handler){if(handler.route.test(fragment)){handler.callback(fragment);return!0}})},navigate:function(fragment,options){if(!History.started)return!1;options&&options!==!0||(options={trigger:!!options});fragment=this.getFragment(fragment||"");var rootPath=this.root;(""===fragment||"?"===fragment.charAt(0))&&(rootPath=rootPath.slice(0,-1)||"/");var url=rootPath+fragment;fragment=this.decodeFragment(fragment.replace(pathStripper,""));if(this.fragment!==fragment){this.fragment=fragment;if(this._usePushState)this.history[options.replace?"replaceState":"pushState"]({},document.title,url);else{if(!this._wantsHashChange)return this.location.assign(url);this._updateHash(this.location,fragment,options.replace);if(this.iframe&&fragment!==this.getHash(this.iframe.contentWindow)){var iWindow=this.iframe.contentWindow;if(!options.replace){iWindow.document.open();iWindow.document.close()}this._updateHash(iWindow.location,fragment,options.replace)}}return options.trigger?this.loadUrl(fragment):void 0}},_updateHash:function(location,fragment,replace){if(replace){var href=location.href.replace(/(javascript:|#).*$/,"");location.replace(href+"#"+fragment)}else location.hash="#"+fragment}});Backbone.history=new History;var extend=function(protoProps,staticProps){var child,parent=this;child=protoProps&&_.has(protoProps,"constructor")?protoProps.constructor:function(){return parent.apply(this,arguments)};_.extend(child,parent,staticProps);child.prototype=_.create(parent.prototype,protoProps);child.prototype.constructor=child;child.__super__=parent.prototype;return child};Model.extend=Collection.extend=Router.extend=View.extend=History.extend=extend;var urlError=function(){throw new Error('A "url" property or function must be specified')},wrapError=function(model,options){var error=options.error;options.error=function(resp){error&&error.call(options.context,model,resp,options);
model.trigger("error",model,resp,options)}};return Backbone});define("models/request",["jquery","underscore_loader","backbone","settings"],function($,_,Backbone,Settings){$.ajaxSetup({cache:!1});var Request=Backbone.Model.extend({url:null,initialize:function(options){_this=this;options=options||{};this.url=options.url||this.url;this.extra_params=options.extra_params||{};Backbone.Model.prototype.initialize.call(this,options);if(!this.url)throw new Error("A Url must be defined for the request model");void 0!==localStorage.getItem(Settings.businessName+"-cvVaBusinessArea")&&null!==localStorage.getItem(Settings.businessName+"-cvVaBusinessArea")&&(_this.extra_params.businessArea=localStorage.getItem(Settings.businessName+"-cvVaBusinessArea"));window.CVVA.methods.switchBA=function(newBA){if("string"==typeof newBA){window.cvCrossStorage.onConnect().then(function(){return window.cvCrossStorage.set(Settings.businessName+"-cvVaBusinessArea",newBA)});localStorage.setItem(Settings.businessName+"-cvVaBusinessArea",newBA);Settings.businessArea=newBA;_this.extra_params.businessArea=newBA;window.CVSaveAttributes()}};window.CVVA.methods.sendPersAttrs=function(data){_this.extra_params.customParams=JSON.stringify(data)};window.CVVA.methods.loginData=function(option1,option2){_this.extra_params.logged_in=option1;_this.extra_params.brand=option2}},defaultRequestData:function(){try{window.coxCIDM=utag.data.cidm}catch(error){}return{entry:"",startentry:"",ident:this.get("ident")||"",userlogid:this.get("userlogid")||"",uid:this.uid,context:"",navcontext:"",businessArea:"",channel:"",siteContext:"",FAQ:"",RECOGNITION_ID:"",ANSWER_ID:"",ButtonRequest:"",FAQRequest:"",faqID:"",mainCat:"",mainCatDesc:"",isCookieEnabled:1,isJSEnabled:1,DTreeRequestType:"",connector_ID:"",DTREE_OBJECT_ID:"",DTREE_NODE_ID:"",ICS_SOURCE_ANSWER_ID:"",liveChatStatus:window.liveChatStatus||"",leEngagementButtons:encodeURIComponent(JSON.stringify(window.leEngagementButtons)),previousAnalysisCategory:window.previousAnalysisCategory||"",pagename:window.location.pathname,CIDM:window.coxCIDM||"",searchBar:!1,subtype:"",t:"",logged_in:"",brand:"",host:""}},makeRequest:function(data){Settings.initMessage.keepInChatHistory===!1&&$(".cv-va-bootstrap .cv-init-wrapper").hide();$(".cv-va-bootstrap .back_link").hide();var dt=new Date,mer=dt.getHours()>12?"p":"a",hh=dt.getHours()>12?dt.getHours()%12:dt.getHours(),mm=dt.getMinutes()<10?"0"+dt.getMinutes():dt.getMinutes(),time=hh+":"+mm+mer,autoSubmission=!1;if(window.cvVaCollectionLength>0&&data.data.entry){for(var piipatterns=[[/6(?:011|5[0-9]{2})[0-9]{12}/g,"****************"],[/\b\d{12,20}\b/g,"*******************"],[/\b(\d{4}[\s\-\_\|\.]*){4,5}\b/gm,"*******************"],[/\b(\d{4}[\s\-\_\|\.]*)(\d{6}[\s\-\_\|\.]*)(\d{5})\b/gm,"*****************"],[/\b(\d{6}[\s\-\_\|\.]*)(\d{4}[\s\-\_\|\.]*){2}(\d{3})\b/gm,"********************"],[/\b(\d{4}[\s\-\_\|\.]*){3}(\d{3,5})\b/gm,"********************"],[/\b(3[\s\-\_\|\.]*1[\s\-\_\|\.]*2[\s\-\_\|\.]*4[\s\-\_\|\.]*0[\s\-\_\|\.]*1[\s\-\_\|\.]*)(\d[\s\-\_\|\.]*){0,19}\b/gm,"********************"],[/\b\d{5}(?:-\d{4})?\b/g,"*****"],[/\b[a-z]\d[a-z]\s?\d[a-z]\d\b/g,"*****"],[/\S+@\S+\.\S+/g,"******************"],[/\b(\d{6}[\s\-\_\|\.]*)(\d{4}[\s\-\_\|\.]*){2}(\d{3})\b/g,"********************"],[/\b(3[\s\-\_\|\.]*1[\s\-\_\|\.]*2[\s\-\_\|\.]*4[\s\-\_\|\.]*0[\s\-\_\|\.]*1[\s\-\_\|\.]*)(\d[\s\-\_\|\.]*){0,19}\b/gm,"********************"],[/(?!000|666)[0-9]{3}([ -]?)(?!00)[0-9]{2}\1(?!0000)[0-9]{4}/g,"*********"],[/\b(?:\+?\d+?-?)?\(?\d{3}[).\s]?\s?-?\d{3}[.\-\s]?\d{4}/g,"**********"],[/\b\d{4}([\ \-]?)\d{4,6}\1\d{3,4}\1?\d{,4}\b/g,"**** **** **** ****"]],question=data.data.entry,a=0,b=piipatterns.length;b>a;a++){var e=piipatterns[a];question=question.replace(e[0],e[1])}$transaction=$("<div>").addClass("panel panel-default cv-chat-transaction-panel");if("normal"===Settings.vaCaption.type){if(data.data.entry.indexOf(Settings.proactiveEndSessionCommand)<0||data.data.entry.indexOf("cvvadata")<0){$transaction.html('<div class="col-xs-12" aria-hidden="true"><div class="panel-heading cv-chat-transaction-heading">'+question+'</div><span class="user-cv-time-stamp" aria-hidden="true">You&nbsp'+time+"</span></div>");$("#cv-chat-answer-history").append($transaction)}}else if("iMessage"===Settings.vaCaption.type){data.data.entry.indexOf(Settings.proactiveEndSessionCommand)>-1||data.data.entry.indexOf("cvvadata")>-1?$transaction.html('<div class="col-xs-12"><div class="cv-va-bubble"><span class="cv-chat-va-imessage">'+Settings.vaCaption.text+"<span>.</span><span>.</span><span>.</span></span></div></div>"):$transaction.html('<div class="col-xs-12" aria-hidden="true"><div class="panel-heading cv-chat-transaction-heading">'+question+'</div><span class="user-cv-time-stamp" aria-hidden="true">You at&nbsp'+time+'</span></div><div class="col-xs-12"><div class="cv-va-bubble"><span class="cv-chat-va-imessage">'+Settings.vaCaption.text+"<span>.</span><span>.</span><span>.</span></span></div></div>");$("#cv-chat-answer-history").append($transaction)}$("#cv-chat-img-avatar").remove()}else $transaction=$("<div>");if(window.CVMobile===!1)if(Settings.shrunkenUI===!0){if(Settings.avatar.enabled===!0)if($("#cv-toggle-avatar").is(":visible"))if($("#cv-toggle-avatar").is(":checked"))$transaction.find(".cv-va-bubble").before('<img class="cv-avatar" src="'+Settings.libEndpoint+"images/titles/"+Settings.avatar.name+'">');else{$transaction.find(".cv-va-bubble").css("margin-left","0px");$transaction.find(".va-time-stamp").css("left","6px");$transaction.find(".cv-va-bubble.va-time-stamp-shim").addClass("va-time-stamp-shim-avatar")}else $transaction.find(".cv-va-bubble").before('<img class="cv-avatar" src="'+Settings.libEndpoint+"images/titles/"+Settings.avatar.name+'">');$transaction.find(".cv-va-bubble").addClass("va-time-stamp-shim");$transaction.find(".panel-heading").addClass("va-time-stamp-shim")}else{$transaction.find(".va-time-stamp").addClass("va-time-stamp-shim");$transaction.find(".user-cv-time-stamp").addClass("va-time-stamp-shim")}else{$transaction.find(".cv-va-bubble").addClass("va-time-stamp-shim");$transaction.find(".panel-heading").addClass("va-time-stamp-shim")}autoSubmission===!0&&$("#cv-chat-answer-history").scrollTo($transaction,500);$(".cv-va-bootstrap #cv-chat-submit.btn").addClass("disabled").prop("disabled",!0);$(".cv-va-bootstrap #cv-chat-submit.disabled").css({"background-color":Settings.submitBtn.disabled.backgroundColor,"border-color":Settings.submitBtn.disabled.backgroundColor});if($(".cv-va-bootstrap #cv-chat-submit").is(":disabled")){$(".cv-va-bootstrap .cv-button-text-image").hide();$(".cv-va-bootstrap .cv-disabled-button-text-image").show()}else{$(".cv-va-bootstrap .cv-button-text-image").show();$(".cv-va-bootstrap .cv-disabled-button-text-image").hide()}var options={dataType:Settings.responseType||"xml",processData:!0,wait:!0,data:$.extend(this.defaultRequestData(),this.extra_params),cookies:[Settings.libEndpointDomain]};options=$.extend(!0,options,data);_.each(options.data,this.sanitiseData,options.data);window.CVVA.events.makeRequest(options.data);$.ajax({type:"POST",url:Settings.logEndpoint+"log",data:{level:"info",metadata:{options:options,libEndpointDomain:Settings.libEndpointDomain}}});return this.fetch(options)},sanitiseData:function(val,key){},getRequestMethod:function(){var method="create";Settings.request_method&&"get"==Settings.request_method.toLowerCase()&&(method="read");return method},sync:function(method,model,options){var successCallbacks=[],_this=this;options.crossDomain=!0;options.xhrFields={withCredentials:!0};localStorage.getItem("cv-tserverid")&&(options.headers={"cv-tserverid":localStorage.getItem("cv-tserverid")});var currentIdent=_this.get("ident");successCallbacks.push(options.success);successCallbacks.push(function(data,status,jqXHR){var tserverid=jqXHR.getResponseHeader("x-cv-tserverid");if(tserverid){window.cvCrossStorage.onConnect().then(function(){window.cvCrossStorage.set("cv-tserverid",tserverid)});localStorage.setItem("cv-tserverid",tserverid)}if(window.CVVA.closeSessionSent)window.CVVA.closeSessionSent=!1;else{window.CVVA.initCompleted=!0;"cox"===Settings.businessName&&window.utag&&window.utag.link&&currentIdent&&_this.get("ident")!==currentIdent&&window.utag.link({eventNames:"cvQuestionAfterTimeOut"})}});options.success=successCallbacks;method=this.getRequestMethod();Backbone.Model.prototype.sync.call(this,method,model,options)},init:function(data){if(Settings.inputLauncher.enabled===!0){$(".cv-va-input-launcher-form input").attr("disabled",!0);$(".cv-va-input-launcher-form button").attr("disabled",!0)}if(localStorage.getItem(Settings.businessName+"-cvVaData")){data.data.t=localStorage.getItem(Settings.businessName+"-cvVaData");data.data.RECOGNITION_ID="88";data.data.ANSWER_ID="89";data.data.FAQ="1"}this.makeRequest(data);$.ajax({type:"POST",url:Settings.logEndpoint+"log",data:{level:"info",metadata:{init:!0}}})},askQuestion:function(question){void 0!==window.placeHolderRotationReset&&window.placeHolderRotationReset();this.makeRequest({data:{entry:question,FAQ:"",ButtonRequest:""}})},askInputLauncherQuestion:function(question){void 0!==window.placeHolderRotationReset&&window.placeHolderRotationReset();"cox"===Settings.businessName&&window.utag&&window.utag.link&&window.utag.link({eventNames:"cvChatInteractive",cvSessionID:this.get("ident"),cvEngagementName:question});this.makeRequest({data:{entry:question,FAQ:"",ButtonRequest:"",searchBar:!0}})},disambiguationRequest:function(question,answerID){void 0!==window.placeHolderRotationReset&&window.placeHolderRotationReset();this.makeRequest({data:{entry:question,disambiguationOption:answerID,FAQ:"",ButtonRequest:""}})},backnavRequest:function(connector_id){void 0!==window.placeHolderRotationReset&&window.placeHolderRotationReset();this.makeRequest({data:{entry:this.get("question"),FAQ:"0",DTreeRequestType:3,FAQRequest:"Go Back",mainCat:this.get("maincat"),DTREE_OBJECT_ID:this.get("dtreeobjectid"),DTREE_NODE_ID:this.get("dtreenodeid")}})},dtreeConnectorRequest:function(connector_id,answer_id,question){void 0!==window.placeHolderRotationReset&&window.placeHolderRotationReset();this.makeRequest({data:{entry:question,DTreeRequestType:2,connector_ID:connector_id,DTREE_OBJECT_ID:this.get("dtreeobjectid"),DTREE_NODE_ID:this.get("dtreenodeid"),ICS_SOURCE_ANSWER_ID:answer_id}})},faqRequest:function(recognitionID,answerID,question,subtype,customData){void 0!==window.placeHolderRotationReset&&window.placeHolderRotationReset();this.makeRequest({data:{RECOGNITION_ID:recognitionID,ANSWER_ID:answerID,FAQ:"1",FAQRequest:question,entry:question,subtype:subtype,t:customData}})},changeContext:function(context){var _this=this;this.makeRequest({data:{context:"",navcontext:context,ButtonRequest:"change_Context",mainCat:this.get("maincat"),DTreeRequestType:"0",FAQ:"1"},silent:!0,success:function(model,response,options){_this.trigger("change:faqitems",_this)}})},closeSession:function(){window.CVVA.closeSessionSent=!0;this.makeRequest({data:{sessionclosed:"1"}})}});return Request});define("models/transaction",["jquery","xml2json","underscore_loader","backbone","settings","models/request"],function($,Xml2Json,_,Backbone,Settings,RequestModel){var Transaction=RequestModel.extend({uid:null,initialize:function(options){RequestModel.prototype.initialize.call(this,options);this.uid=(new Date).getTime()+Math.floor(100*Math.random())},parse:function(response,options){var dataType=Settings.responseType||"xml",parsed=this.attributes;if("xml"==dataType){try{parsed=this.parseXML(response,options);void 0!==parsed.responseurl&&this.trigger("error","Engine did not return a response!")}catch(err){this.trigger("error","Could not parse response!")}return parsed}return RequestModel.prototype.parse.call(this,response,options)},parseXML:function(response,options){var tmp=$.xml2json(response),cleanse=function(data,recurse){_.each(data,function(val,key){$.isPlainObject(val)||$.isArray(val)?data[key]=val:data[key]=unescape(val)})};void 0!==tmp.connectors&&($.isArray(tmp.connectors.Connector)?tmp.connectors=tmp.connectors.Connector:$.isPlainObject(tmp.connectors.Connector)&&(tmp.connectors=[tmp.connectors.Connector]));cleanse(tmp);return tmp}});return Transaction});define("collections/transactions",["jquery","underscore-loader","backbone","models/transaction"],function($,_,Backbone,Transaction){var Transactions=Backbone.Collection.extend({url:"",addTransaction:function(model){this.add(model.clone())},subscribe:function(model){model.on("change",this.addTransaction,this)}});return Transactions});!function(factory){"function"==typeof define&&define.amd?define("jquery_ui",["jquery"],factory):factory(jQuery)}(function($){$.ui=$.ui||{};var widgetUuid=($.ui.version="1.12.1",0),widgetSlice=Array.prototype.slice;$.cleanData=function(orig){return function(elems){var events,elem,i;for(i=0;null!=(elem=elems[i]);i++)try{events=$._data(elem,"events");events&&events.remove&&$(elem).triggerHandler("remove")}catch(e){}orig(elems)}}($.cleanData);$.widget=function(name,base,prototype){var existingConstructor,constructor,basePrototype,proxiedPrototype={},namespace=name.split(".")[0];name=name.split(".")[1];var fullName=namespace+"-"+name;if(!prototype){prototype=base;base=$.Widget}$.isArray(prototype)&&(prototype=$.extend.apply(null,[{}].concat(prototype)));$.expr[":"][fullName.toLowerCase()]=function(elem){return!!$.data(elem,fullName)};$[namespace]=$[namespace]||{};existingConstructor=$[namespace][name];constructor=$[namespace][name]=function(options,element){if(!this._createWidget)return new constructor(options,element);arguments.length&&this._createWidget(options,element)};$.extend(constructor,existingConstructor,{version:prototype.version,_proto:$.extend({},prototype),_childConstructors:[]});basePrototype=new base;basePrototype.options=$.widget.extend({},basePrototype.options);$.each(prototype,function(prop,value){$.isFunction(value)?proxiedPrototype[prop]=function(){function _super(){return base.prototype[prop].apply(this,arguments)}function _superApply(args){return base.prototype[prop].apply(this,args)}return function(){var returnValue,__super=this._super,__superApply=this._superApply;this._super=_super;this._superApply=_superApply;returnValue=value.apply(this,arguments);this._super=__super;this._superApply=__superApply;return returnValue}}():proxiedPrototype[prop]=value});constructor.prototype=$.widget.extend(basePrototype,{widgetEventPrefix:existingConstructor?basePrototype.widgetEventPrefix||name:name},proxiedPrototype,{constructor:constructor,namespace:namespace,widgetName:name,widgetFullName:fullName});if(existingConstructor){$.each(existingConstructor._childConstructors,function(i,child){var childPrototype=child.prototype;$.widget(childPrototype.namespace+"."+childPrototype.widgetName,constructor,child._proto)});delete existingConstructor._childConstructors}else base._childConstructors.push(constructor);$.widget.bridge(name,constructor);return constructor};$.widget.extend=function(target){for(var key,value,input=widgetSlice.call(arguments,1),inputIndex=0,inputLength=input.length;inputLength>inputIndex;inputIndex++)for(key in input[inputIndex]){value=input[inputIndex][key];input[inputIndex].hasOwnProperty(key)&&void 0!==value&&($.isPlainObject(value)?target[key]=$.isPlainObject(target[key])?$.widget.extend({},target[key],value):$.widget.extend({},value):target[key]=value)}return target};$.widget.bridge=function(name,object){var fullName=object.prototype.widgetFullName||name;$.fn[name]=function(options){var isMethodCall="string"==typeof options,args=widgetSlice.call(arguments,1),returnValue=this;if(isMethodCall)this.length||"instance"!==options?this.each(function(){var methodValue,instance=$.data(this,fullName);if("instance"===options){returnValue=instance;return!1}if(!instance)return $.error("cannot call methods on "+name+" prior to initialization; attempted to call method '"+options+"'");if(!$.isFunction(instance[options])||"_"===options.charAt(0))return $.error("no such method '"+options+"' for "+name+" widget instance");methodValue=instance[options].apply(instance,args);if(methodValue!==instance&&void 0!==methodValue){returnValue=methodValue&&methodValue.jquery?returnValue.pushStack(methodValue.get()):methodValue;return!1}}):returnValue=void 0;else{args.length&&(options=$.widget.extend.apply(null,[options].concat(args)));this.each(function(){var instance=$.data(this,fullName);if(instance){instance.option(options||{});instance._init&&instance._init()}else $.data(this,fullName,new object(options,this))})}return returnValue}};$.Widget=function(){};$.Widget._childConstructors=[];$.Widget.prototype={widgetName:"widget",widgetEventPrefix:"",defaultElement:"<div>",options:{classes:{},disabled:!1,create:null},_createWidget:function(options,element){element=$(element||this.defaultElement||this)[0];this.element=$(element);this.uuid=widgetUuid++;this.eventNamespace="."+this.widgetName+this.uuid;this.bindings=$();this.hoverable=$();this.focusable=$();this.classesElementLookup={};if(element!==this){$.data(element,this.widgetFullName,this);this._on(!0,this.element,{remove:function(event){event.target===element&&this.destroy()}});this.document=$(element.style?element.ownerDocument:element.document||element);this.window=$(this.document[0].defaultView||this.document[0].parentWindow)}this.options=$.widget.extend({},this.options,this._getCreateOptions(),options);this._create();this.options.disabled&&this._setOptionDisabled(this.options.disabled);this._trigger("create",null,this._getCreateEventData());this._init()},_getCreateOptions:function(){return{}},_getCreateEventData:$.noop,_create:$.noop,_init:$.noop,destroy:function(){var that=this;this._destroy();$.each(this.classesElementLookup,function(key,value){that._removeClass(value,key)});this.element.off(this.eventNamespace).removeData(this.widgetFullName);this.widget().off(this.eventNamespace).removeAttr("aria-disabled");this.bindings.off(this.eventNamespace)},_destroy:$.noop,widget:function(){return this.element},option:function(key,value){var parts,curOption,i,options=key;if(0===arguments.length)return $.widget.extend({},this.options);if("string"==typeof key){options={};parts=key.split(".");key=parts.shift();if(parts.length){curOption=options[key]=$.widget.extend({},this.options[key]);for(i=0;i<parts.length-1;i++){curOption[parts[i]]=curOption[parts[i]]||{};curOption=curOption[parts[i]]}key=parts.pop();if(1===arguments.length)return void 0===curOption[key]?null:curOption[key];curOption[key]=value}else{if(1===arguments.length)return void 0===this.options[key]?null:this.options[key];options[key]=value}}this._setOptions(options);return this},_setOptions:function(options){var key;for(key in options)this._setOption(key,options[key]);return this},_setOption:function(key,value){"classes"===key&&this._setOptionClasses(value);this.options[key]=value;"disabled"===key&&this._setOptionDisabled(value);return this},_setOptionClasses:function(value){var classKey,elements,currentElements;for(classKey in value){currentElements=this.classesElementLookup[classKey];if(value[classKey]!==this.options.classes[classKey]&&currentElements&&currentElements.length){elements=$(currentElements.get());this._removeClass(currentElements,classKey);elements.addClass(this._classes({element:elements,keys:classKey,classes:value,add:!0}))}}},_setOptionDisabled:function(value){this._toggleClass(this.widget(),this.widgetFullName+"-disabled",null,!!value);if(value){this._removeClass(this.hoverable,null,"cv-ui-state-hover");this._removeClass(this.focusable,null,"cv-ui-state-focus")}},enable:function(){return this._setOptions({disabled:!1})},disable:function(){return this._setOptions({disabled:!0})},_classes:function(options){function processClassString(classes,checkOption){var current,i;for(i=0;i<classes.length;i++){current=that.classesElementLookup[classes[i]]||$();current=$(options.add?$.unique(current.get().concat(options.element.get())):current.not(options.element).get());that.classesElementLookup[classes[i]]=current;full.push(classes[i]);checkOption&&options.classes[classes[i]]&&full.push(options.classes[classes[i]])}}var full=[],that=this;options=$.extend({element:this.element,classes:this.options.classes||{}},options);this._on(options.element,{remove:"_untrackClassesElement"});options.keys&&processClassString(options.keys.match(/\S+/g)||[],!0);options.extra&&processClassString(options.extra.match(/\S+/g)||[]);return full.join(" ")},_untrackClassesElement:function(event){var that=this;$.each(that.classesElementLookup,function(key,value){-1!==$.inArray(event.target,value)&&(that.classesElementLookup[key]=$(value.not(event.target).get()))})},_removeClass:function(element,keys,extra){return this._toggleClass(element,keys,extra,!1)},_addClass:function(element,keys,extra){return this._toggleClass(element,keys,extra,!0)},_toggleClass:function(element,keys,extra,add){add="boolean"==typeof add?add:extra;var shift="string"==typeof element||null===element,options={extra:shift?keys:extra,keys:shift?element:keys,element:shift?this.element:element,add:add};options.element.toggleClass(this._classes(options),add);return this},_on:function(suppressDisabledCheck,element,handlers){var delegateElement,instance=this;if("boolean"!=typeof suppressDisabledCheck){handlers=element;element=suppressDisabledCheck;suppressDisabledCheck=!1}if(handlers){element=delegateElement=$(element);this.bindings=this.bindings.add(element)}else{handlers=element;element=this.element;delegateElement=this.widget()}$.each(handlers,function(event,handler){function handlerProxy(){return suppressDisabledCheck||instance.options.disabled!==!0&&!$(this).hasClass("cv-ui-state-disabled")?("string"==typeof handler?instance[handler]:handler).apply(instance,arguments):void 0}"string"!=typeof handler&&(handlerProxy.guid=handler.guid=handler.guid||handlerProxy.guid||$.guid++);var match=event.match(/^([\w:-]*)\s*(.*)$/),eventName=match[1]+instance.eventNamespace,selector=match[2];selector?delegateElement.on(eventName,selector,handlerProxy):element.on(eventName,handlerProxy)})},_off:function(element,eventName){eventName=(eventName||"").split(" ").join(this.eventNamespace+" ")+this.eventNamespace;element.off(eventName).off(eventName);this.bindings=$(this.bindings.not(element).get());this.focusable=$(this.focusable.not(element).get());this.hoverable=$(this.hoverable.not(element).get())},_delay:function(handler,delay){function handlerProxy(){return("string"==typeof handler?instance[handler]:handler).apply(instance,arguments)}var instance=this;return setTimeout(handlerProxy,delay||0)},_hoverable:function(element){this.hoverable=this.hoverable.add(element);this._on(element,{mouseenter:function(event){this._addClass($(event.currentTarget),null,"cv-ui-state-hover")},mouseleave:function(event){this._removeClass($(event.currentTarget),null,"cv-ui-state-hover")}})},_focusable:function(element){this.focusable=this.focusable.add(element);this._on(element,{focusin:function(event){this._addClass($(event.currentTarget),null,"cv-ui-state-focus")},focusout:function(event){this._removeClass($(event.currentTarget),null,"cv-ui-state-focus")}})},_trigger:function(type,event,data){var prop,orig,callback=this.options[type];data=data||{};event=$.Event(event);event.type=(type===this.widgetEventPrefix?type:this.widgetEventPrefix+type).toLowerCase();event.target=this.element[0];orig=event.originalEvent;if(orig)for(prop in orig)prop in event||(event[prop]=orig[prop]);this.element.trigger(event,data);return!($.isFunction(callback)&&callback.apply(this.element[0],[event].concat(data))===!1||event.isDefaultPrevented())}};$.each({show:"fadeIn",hide:"fadeOut"},function(method,defaultEffect){$.Widget.prototype["_"+method]=function(element,options,callback){"string"==typeof options&&(options={effect:options});var hasOptions,effectName=options?options===!0||"number"==typeof options?defaultEffect:options.effect||defaultEffect:method;options=options||{};"number"==typeof options&&(options={duration:options});hasOptions=!$.isEmptyObject(options);options.complete=callback;options.delay&&element.delay(options.delay);hasOptions&&$.effects&&$.effects.effect[effectName]?element[method](options):effectName!==method&&element[effectName]?element[effectName](options.duration,options.easing,callback):element.queue(function(next){$(this)[method]();callback&&callback.call(element[0]);next()})}});$.widget;!function(){function getOffsets(offsets,width,height){return[parseFloat(offsets[0])*(rpercent.test(offsets[0])?width/100:1),parseFloat(offsets[1])*(rpercent.test(offsets[1])?height/100:1)]}function parseCss(element,property){return parseInt($.css(element,property),10)||0}function getDimensions(elem){var raw=elem[0];return 9===raw.nodeType?{width:elem.width(),height:elem.height(),offset:{top:0,left:0}}:$.isWindow(raw)?{width:elem.width(),height:elem.height(),offset:{top:elem.scrollTop(),left:elem.scrollLeft()}}:raw.preventDefault?{width:0,height:0,offset:{top:raw.pageY,left:raw.pageX}}:{width:elem.outerWidth(),height:elem.outerHeight(),offset:elem.offset()}}var cachedScrollbarWidth,max=Math.max,abs=Math.abs,rhorizontal=/left|center|right/,rvertical=/top|center|bottom/,roffset=/[\+\-]\d+(\.[\d]+)?%?/,rposition=/^\w+/,rpercent=/%$/,_position=$.fn.position;$.position={scrollbarWidth:function(){if(void 0!==cachedScrollbarWidth)return cachedScrollbarWidth;var w1,w2,div=$("<div style='display:block;position:absolute;width:50px;height:50px;overflow:hidden;'><div style='height:100px;width:auto;'></div></div>"),innerDiv=div.children()[0];$("body").append(div);w1=innerDiv.offsetWidth;div.css("overflow","scroll");w2=innerDiv.offsetWidth;w1===w2&&(w2=div[0].clientWidth);div.remove();return cachedScrollbarWidth=w1-w2},getScrollInfo:function(within){var overflowX=within.isWindow||within.isDocument?"":within.element.css("overflow-x"),overflowY=within.isWindow||within.isDocument?"":within.element.css("overflow-y"),hasOverflowX="scroll"===overflowX||"auto"===overflowX&&within.width<within.element[0].scrollWidth,hasOverflowY="scroll"===overflowY||"auto"===overflowY&&within.height<within.element[0].scrollHeight;return{width:hasOverflowY?$.position.scrollbarWidth():0,height:hasOverflowX?$.position.scrollbarWidth():0}},getWithinInfo:function(element){var withinElement=$(element||window),isWindow=$.isWindow(withinElement[0]),isDocument=!!withinElement[0]&&9===withinElement[0].nodeType,hasOffset=!isWindow&&!isDocument;return{element:withinElement,isWindow:isWindow,isDocument:isDocument,offset:hasOffset?$(element).offset():{left:0,top:0},scrollLeft:withinElement.scrollLeft(),scrollTop:withinElement.scrollTop(),width:withinElement.outerWidth(),height:withinElement.outerHeight()}}};$.fn.position=function(options){if(!options||!options.of)return _position.apply(this,arguments);options=$.extend({},options);var atOffset,targetWidth,targetHeight,targetOffset,basePosition,dimensions,target=$(options.of),within=$.position.getWithinInfo(options.within),scrollInfo=$.position.getScrollInfo(within),collision=(options.collision||"flip").split(" "),offsets={};dimensions=getDimensions(target);target[0].preventDefault&&(options.at="left top");targetWidth=dimensions.width;targetHeight=dimensions.height;targetOffset=dimensions.offset;basePosition=$.extend({},targetOffset);$.each(["my","at"],function(){var horizontalOffset,verticalOffset,pos=(options[this]||"").split(" ");1===pos.length&&(pos=rhorizontal.test(pos[0])?pos.concat(["center"]):rvertical.test(pos[0])?["center"].concat(pos):["center","center"]);pos[0]=rhorizontal.test(pos[0])?pos[0]:"center";pos[1]=rvertical.test(pos[1])?pos[1]:"center";horizontalOffset=roffset.exec(pos[0]);verticalOffset=roffset.exec(pos[1]);offsets[this]=[horizontalOffset?horizontalOffset[0]:0,verticalOffset?verticalOffset[0]:0];options[this]=[rposition.exec(pos[0])[0],rposition.exec(pos[1])[0]]});1===collision.length&&(collision[1]=collision[0]);"right"===options.at[0]?basePosition.left+=targetWidth:"center"===options.at[0]&&(basePosition.left+=targetWidth/2);"bottom"===options.at[1]?basePosition.top+=targetHeight:"center"===options.at[1]&&(basePosition.top+=targetHeight/2);atOffset=getOffsets(offsets.at,targetWidth,targetHeight);basePosition.left+=atOffset[0];basePosition.top+=atOffset[1];return this.each(function(){var collisionPosition,using,elem=$(this),elemWidth=elem.outerWidth(),elemHeight=elem.outerHeight(),marginLeft=parseCss(this,"marginLeft"),marginTop=parseCss(this,"marginTop"),collisionWidth=elemWidth+marginLeft+parseCss(this,"marginRight")+scrollInfo.width,collisionHeight=elemHeight+marginTop+parseCss(this,"marginBottom")+scrollInfo.height,position=$.extend({},basePosition),myOffset=getOffsets(offsets.my,elem.outerWidth(),elem.outerHeight());"right"===options.my[0]?position.left-=elemWidth:"center"===options.my[0]&&(position.left-=elemWidth/2);"bottom"===options.my[1]?position.top-=elemHeight:"center"===options.my[1]&&(position.top-=elemHeight/2);position.left+=myOffset[0];position.top+=myOffset[1];collisionPosition={marginLeft:marginLeft,marginTop:marginTop};$.each(["left","top"],function(i,dir){$.ui.position[collision[i]]&&$.ui.position[collision[i]][dir](position,{targetWidth:targetWidth,targetHeight:targetHeight,elemWidth:elemWidth,elemHeight:elemHeight,collisionPosition:collisionPosition,collisionWidth:collisionWidth,collisionHeight:collisionHeight,offset:[atOffset[0]+myOffset[0],atOffset[1]+myOffset[1]],my:options.my,at:options.at,within:within,elem:elem})});options.using&&(using=function(props){var left=targetOffset.left-position.left,right=left+targetWidth-elemWidth,top=targetOffset.top-position.top,bottom=top+targetHeight-elemHeight,feedback={target:{element:target,left:targetOffset.left,top:targetOffset.top,width:targetWidth,height:targetHeight},element:{element:elem,left:position.left,top:position.top,width:elemWidth,height:elemHeight},horizontal:0>right?"left":left>0?"right":"center",vertical:0>bottom?"top":top>0?"bottom":"middle"};elemWidth>targetWidth&&abs(left+right)<targetWidth&&(feedback.horizontal="center");elemHeight>targetHeight&&abs(top+bottom)<targetHeight&&(feedback.vertical="middle");max(abs(left),abs(right))>max(abs(top),abs(bottom))?feedback.important="horizontal":feedback.important="vertical";options.using.call(this,props,feedback)});elem.offset($.extend(position,{using:using}))})};$.ui.position={fit:{left:function(position,data){var newOverRight,within=data.within,withinOffset=within.isWindow?within.scrollLeft:within.offset.left,outerWidth=within.width,collisionPosLeft=position.left-data.collisionPosition.marginLeft,overLeft=withinOffset-collisionPosLeft,overRight=collisionPosLeft+data.collisionWidth-outerWidth-withinOffset;if(data.collisionWidth>outerWidth)if(overLeft>0&&0>=overRight){newOverRight=position.left+overLeft+data.collisionWidth-outerWidth-withinOffset;position.left+=overLeft-newOverRight}else overRight>0&&0>=overLeft?position.left=withinOffset:overLeft>overRight?position.left=withinOffset+outerWidth-data.collisionWidth:position.left=withinOffset;else overLeft>0?position.left+=overLeft:overRight>0?position.left-=overRight:position.left=max(position.left-collisionPosLeft,position.left)},top:function(position,data){var newOverBottom,within=data.within,withinOffset=within.isWindow?within.scrollTop:within.offset.top,outerHeight=data.within.height,collisionPosTop=position.top-data.collisionPosition.marginTop,overTop=withinOffset-collisionPosTop,overBottom=collisionPosTop+data.collisionHeight-outerHeight-withinOffset;if(data.collisionHeight>outerHeight)if(overTop>0&&0>=overBottom){newOverBottom=position.top+overTop+data.collisionHeight-outerHeight-withinOffset;position.top+=overTop-newOverBottom}else overBottom>0&&0>=overTop?position.top=withinOffset:overTop>overBottom?position.top=withinOffset+outerHeight-data.collisionHeight:position.top=withinOffset;else overTop>0?position.top+=overTop:overBottom>0?position.top-=overBottom:position.top=max(position.top-collisionPosTop,position.top)}},flip:{left:function(position,data){
var newOverRight,newOverLeft,within=data.within,withinOffset=within.offset.left+within.scrollLeft,outerWidth=within.width,offsetLeft=within.isWindow?within.scrollLeft:within.offset.left,collisionPosLeft=position.left-data.collisionPosition.marginLeft,overLeft=collisionPosLeft-offsetLeft,overRight=collisionPosLeft+data.collisionWidth-outerWidth-offsetLeft,myOffset="left"===data.my[0]?-data.elemWidth:"right"===data.my[0]?data.elemWidth:0,atOffset="left"===data.at[0]?data.targetWidth:"right"===data.at[0]?-data.targetWidth:0,offset=-2*data.offset[0];if(0>overLeft){newOverRight=position.left+myOffset+atOffset+offset+data.collisionWidth-outerWidth-withinOffset;(0>newOverRight||newOverRight<abs(overLeft))&&(position.left+=myOffset+atOffset+offset)}else if(overRight>0){newOverLeft=position.left-data.collisionPosition.marginLeft+myOffset+atOffset+offset-offsetLeft;(newOverLeft>0||abs(newOverLeft)<overRight)&&(position.left+=myOffset+atOffset+offset)}},top:function(position,data){var newOverTop,newOverBottom,within=data.within,withinOffset=within.offset.top+within.scrollTop,outerHeight=within.height,offsetTop=within.isWindow?within.scrollTop:within.offset.top,collisionPosTop=position.top-data.collisionPosition.marginTop,overTop=collisionPosTop-offsetTop,overBottom=collisionPosTop+data.collisionHeight-outerHeight-offsetTop,top="top"===data.my[1],myOffset=top?-data.elemHeight:"bottom"===data.my[1]?data.elemHeight:0,atOffset="top"===data.at[1]?data.targetHeight:"bottom"===data.at[1]?-data.targetHeight:0,offset=-2*data.offset[1];if(0>overTop){newOverBottom=position.top+myOffset+atOffset+offset+data.collisionHeight-outerHeight-withinOffset;(0>newOverBottom||newOverBottom<abs(overTop))&&(position.top+=myOffset+atOffset+offset)}else if(overBottom>0){newOverTop=position.top-data.collisionPosition.marginTop+myOffset+atOffset+offset-offsetTop;(newOverTop>0||abs(newOverTop)<overBottom)&&(position.top+=myOffset+atOffset+offset)}}},flipfit:{left:function(){$.ui.position.flip.left.apply(this,arguments);$.ui.position.fit.left.apply(this,arguments)},top:function(){$.ui.position.flip.top.apply(this,arguments);$.ui.position.fit.top.apply(this,arguments)}}}}();var mouseHandled=($.ui.position,$.extend($.expr[":"],{data:$.expr.createPseudo?$.expr.createPseudo(function(dataName){return function(elem){return!!$.data(elem,dataName)}}):function(elem,i,match){return!!$.data(elem,match[3])}}),$.fn.extend({disableSelection:function(){var eventType="onselectstart"in document.createElement("div")?"selectstart":"mousedown";return function(){return this.on(eventType+".cv-ui-disableSelection",function(event){event.preventDefault()})}}(),enableSelection:function(){return this.off(".cv-ui-disableSelection")}}),$.ui.keyCode={BACKSPACE:8,COMMA:188,DELETE:46,DOWN:40,END:35,ENTER:13,ESCAPE:27,HOME:36,LEFT:37,PAGE_DOWN:34,PAGE_UP:33,PERIOD:190,RIGHT:39,SPACE:32,TAB:9,UP:38},$.fn.scrollParent=function(includeHidden){var position=this.css("position"),excludeStaticParent="absolute"===position,overflowRegex=includeHidden?/(auto|scroll|hidden)/:/(auto|scroll)/,scrollParent=this.parents().filter(function(){var parent=$(this);return excludeStaticParent&&"static"===parent.css("position")?!1:overflowRegex.test(parent.css("overflow")+parent.css("overflow-y")+parent.css("overflow-x"))}).eq(0);return"fixed"!==position&&scrollParent.length?scrollParent:$(this[0].ownerDocument||document)},$.fn.extend({uniqueId:function(){var uuid=0;return function(){return this.each(function(){this.id||(this.id="cv-ui-id-"+ ++uuid)})}}(),removeUniqueId:function(){return this.each(function(){/^cv-ui-id-\d+$/.test(this.id)&&$(this).removeAttr("id")})}}),$.ui.ie=!!/msie [\w.]+/.exec(navigator.userAgent.toLowerCase()),!1);$(document).on("mouseup",function(){mouseHandled=!1});$.widget("ui.mouse",{version:"1.12.1",options:{cancel:"input, textarea, button, select, option",distance:1,delay:0},_mouseInit:function(){var that=this;this.element.on("mousedown."+this.widgetName,function(event){return that._mouseDown(event)}).on("click."+this.widgetName,function(event){if(!0===$.data(event.target,that.widgetName+".preventClickEvent")){$.removeData(event.target,that.widgetName+".preventClickEvent");event.stopImmediatePropagation();return!1}});this.started=!1},_mouseDestroy:function(){this.element.off("."+this.widgetName);this._mouseMoveDelegate&&this.document.off("mousemove."+this.widgetName,this._mouseMoveDelegate).off("mouseup."+this.widgetName,this._mouseUpDelegate)},_mouseDown:function(event){if(!mouseHandled){this._mouseMoved=!1;this._mouseStarted&&this._mouseUp(event);this._mouseDownEvent=event;var that=this,btnIsLeft=1===event.which,elIsCancel="string"==typeof this.options.cancel&&event.target.nodeName?$(event.target).closest(this.options.cancel).length:!1;if(!btnIsLeft||elIsCancel||!this._mouseCapture(event))return!0;this.mouseDelayMet=!this.options.delay;this.mouseDelayMet||(this._mouseDelayTimer=setTimeout(function(){that.mouseDelayMet=!0},this.options.delay));if(this._mouseDistanceMet(event)&&this._mouseDelayMet(event)){this._mouseStarted=this._mouseStart(event)!==!1;if(!this._mouseStarted){event.preventDefault();return!0}}!0===$.data(event.target,this.widgetName+".preventClickEvent")&&$.removeData(event.target,this.widgetName+".preventClickEvent");this._mouseMoveDelegate=function(event){return that._mouseMove(event)};this._mouseUpDelegate=function(event){return that._mouseUp(event)};this.document.on("mousemove."+this.widgetName,this._mouseMoveDelegate).on("mouseup."+this.widgetName,this._mouseUpDelegate);event.preventDefault();mouseHandled=!0;return!0}},_mouseMove:function(event){if(this._mouseMoved){if($.ui.ie&&(!document.documentMode||document.documentMode<9)&&!event.button)return this._mouseUp(event);if(!event.which)if(event.originalEvent.altKey||event.originalEvent.ctrlKey||event.originalEvent.metaKey||event.originalEvent.shiftKey)this.ignoreMissingWhich=!0;else if(!this.ignoreMissingWhich)return this._mouseUp(event)}(event.which||event.button)&&(this._mouseMoved=!0);if(this._mouseStarted){this._mouseDrag(event);return event.preventDefault()}if(this._mouseDistanceMet(event)&&this._mouseDelayMet(event)){this._mouseStarted=this._mouseStart(this._mouseDownEvent,event)!==!1;this._mouseStarted?this._mouseDrag(event):this._mouseUp(event)}return!this._mouseStarted},_mouseUp:function(event){this.document.off("mousemove."+this.widgetName,this._mouseMoveDelegate).off("mouseup."+this.widgetName,this._mouseUpDelegate);if(this._mouseStarted){this._mouseStarted=!1;event.target===this._mouseDownEvent.target&&$.data(event.target,this.widgetName+".preventClickEvent",!0);this._mouseStop(event)}if(this._mouseDelayTimer){clearTimeout(this._mouseDelayTimer);delete this._mouseDelayTimer}this.ignoreMissingWhich=!1;mouseHandled=!1;event.preventDefault()},_mouseDistanceMet:function(event){return Math.max(Math.abs(this._mouseDownEvent.pageX-event.pageX),Math.abs(this._mouseDownEvent.pageY-event.pageY))>=this.options.distance},_mouseDelayMet:function(){return this.mouseDelayMet},_mouseStart:function(){},_mouseDrag:function(){},_mouseStop:function(){},_mouseCapture:function(){return!0}}),$.ui.plugin={add:function(module,option,set){var i,proto=$.ui[module].prototype;for(i in set){proto.plugins[i]=proto.plugins[i]||[];proto.plugins[i].push([option,set[i]])}},call:function(instance,name,args,allowDisconnected){var i,set=instance.plugins[name];if(set&&(allowDisconnected||instance.element[0].parentNode&&11!==instance.element[0].parentNode.nodeType))for(i=0;i<set.length;i++)instance.options[set[i][0]]&&set[i][1].apply(instance.element,args)}},$.ui.safeActiveElement=function(document){var activeElement;try{activeElement=document.activeElement}catch(error){activeElement=document.body}activeElement||(activeElement=document.body);activeElement.nodeName||(activeElement=document.body);return activeElement},$.ui.safeBlur=function(element){element&&"body"!==element.nodeName.toLowerCase()&&$(element).trigger("blur")};$.widget("ui.draggable",$.ui.mouse,{version:"1.12.1",widgetEventPrefix:"drag",options:{addClasses:!0,appendTo:"parent",axis:!1,connectToSortable:!1,containment:!1,cursor:"auto",cursorAt:!1,grid:!1,handle:!1,helper:"original",iframeFix:!1,opacity:!1,refreshPositions:!1,revert:!1,revertDuration:500,scope:"default",scroll:!0,scrollSensitivity:20,scrollSpeed:20,snap:!1,snapMode:"both",snapTolerance:20,stack:!1,zIndex:!1,drag:null,start:null,stop:null},_create:function(){"original"===this.options.helper&&this._setPositionRelative();this.options.addClasses&&this._addClass("cv-ui-draggable");this._setHandleClassName();this._mouseInit()},_setOption:function(key,value){this._super(key,value);if("handle"===key){this._removeHandleClassName();this._setHandleClassName()}},_destroy:function(){if((this.helper||this.element).is(".cv-ui-draggable-dragging"))this.destroyOnClear=!0;else{this._removeHandleClassName();this._mouseDestroy()}},_mouseCapture:function(event){var o=this.options;if(this.helper||o.disabled||$(event.target).closest(".cv-ui-resizable-handle").length>0)return!1;this.handle=this._getHandle(event);if(!this.handle)return!1;this._blurActiveElement(event);this._blockFrames(o.iframeFix===!0?"iframe":o.iframeFix);return!0},_blockFrames:function(selector){this.iframeBlocks=this.document.find(selector).map(function(){var iframe=$(this);return $("<div>").css("position","absolute").appendTo(iframe.parent()).outerWidth(iframe.outerWidth()).outerHeight(iframe.outerHeight()).offset(iframe.offset())[0]})},_unblockFrames:function(){if(this.iframeBlocks){this.iframeBlocks.remove();delete this.iframeBlocks}},_blurActiveElement:function(event){var activeElement=$.ui.safeActiveElement(this.document[0]),target=$(event.target);target.closest(activeElement).length||$.ui.safeBlur(activeElement)},_mouseStart:function(event){var o=this.options;this.helper=this._createHelper(event);this._addClass(this.helper,"cv-ui-draggable-dragging");this._cacheHelperProportions();$.ui.ddmanager&&($.ui.ddmanager.current=this);this._cacheMargins();this.cssPosition=this.helper.css("position");this.scrollParent=this.helper.scrollParent(!0);this.offsetParent=this.helper.offsetParent();this.hasFixedAncestor=this.helper.parents().filter(function(){return"fixed"===$(this).css("position")}).length>0;this.positionAbs=this.element.offset();this._refreshOffsets(event);this.originalPosition=this.position=this._generatePosition(event,!1);this.originalPageX=event.pageX;this.originalPageY=event.pageY;o.cursorAt&&this._adjustOffsetFromHelper(o.cursorAt);this._setContainment();if(this._trigger("start",event)===!1){this._clear();return!1}this._cacheHelperProportions();$.ui.ddmanager&&!o.dropBehaviour&&$.ui.ddmanager.prepareOffsets(this,event);this._mouseDrag(event,!0);$.ui.ddmanager&&$.ui.ddmanager.dragStart(this,event);return!0},_refreshOffsets:function(event){this.offset={top:this.positionAbs.top-this.margins.top,left:this.positionAbs.left-this.margins.left,scroll:!1,parent:this._getParentOffset(),relative:this._getRelativeOffset()};this.offset.click={left:event.pageX-this.offset.left,top:event.pageY-this.offset.top}},_mouseDrag:function(event,noPropagation){this.hasFixedAncestor&&(this.offset.parent=this._getParentOffset());this.position=this._generatePosition(event,!0);this.positionAbs=this._convertPositionTo("absolute");if(!noPropagation){var ui=this._uiHash();if(this._trigger("drag",event,ui)===!1){this._mouseUp(new $.Event("mouseup",event));return!1}this.position=ui.position}this.helper[0].style.left=this.position.left+"px";this.helper[0].style.top=this.position.top+"px";$.ui.ddmanager&&$.ui.ddmanager.drag(this,event);return!1},_mouseStop:function(event){var that=this,dropped=!1;$.ui.ddmanager&&!this.options.dropBehaviour&&(dropped=$.ui.ddmanager.drop(this,event));if(this.dropped){dropped=this.dropped;this.dropped=!1}"invalid"===this.options.revert&&!dropped||"valid"===this.options.revert&&dropped||this.options.revert===!0||$.isFunction(this.options.revert)&&this.options.revert.call(this.element,dropped)?$(this.helper).animate(this.originalPosition,parseInt(this.options.revertDuration,10),function(){that._trigger("stop",event)!==!1&&that._clear()}):this._trigger("stop",event)!==!1&&this._clear();return!1},_mouseUp:function(event){this._unblockFrames();$.ui.ddmanager&&$.ui.ddmanager.dragStop(this,event);this.handleElement.is(event.target)&&this.element.trigger("focus");return $.ui.mouse.prototype._mouseUp.call(this,event)},cancel:function(){this.helper.is(".cv-ui-draggable-dragging")?this._mouseUp(new $.Event("mouseup",{target:this.element[0]})):this._clear();return this},_getHandle:function(event){return this.options.handle?!!$(event.target).closest(this.element.find(this.options.handle)).length:!0},_setHandleClassName:function(){this.handleElement=this.options.handle?this.element.find(this.options.handle):this.element;this._addClass(this.handleElement,"cv-ui-draggable-handle")},_removeHandleClassName:function(){this._removeClass(this.handleElement,"cv-ui-draggable-handle")},_createHelper:function(event){var o=this.options,helperIsFunction=$.isFunction(o.helper),helper=helperIsFunction?$(o.helper.apply(this.element[0],[event])):"clone"===o.helper?this.element.clone().removeAttr("id"):this.element;helper.parents("body").length||helper.appendTo("parent"===o.appendTo?this.element[0].parentNode:o.appendTo);helperIsFunction&&helper[0]===this.element[0]&&this._setPositionRelative();helper[0]===this.element[0]||/(fixed|absolute)/.test(helper.css("position"))||helper.css("position","absolute");return helper},_setPositionRelative:function(){/^(?:r|a|f)/.test(this.element.css("position"))||(this.element[0].style.position="relative")},_adjustOffsetFromHelper:function(obj){"string"==typeof obj&&(obj=obj.split(" "));$.isArray(obj)&&(obj={left:+obj[0],top:+obj[1]||0});"left"in obj&&(this.offset.click.left=obj.left+this.margins.left);"right"in obj&&(this.offset.click.left=this.helperProportions.width-obj.right+this.margins.left);"top"in obj&&(this.offset.click.top=obj.top+this.margins.top);"bottom"in obj&&(this.offset.click.top=this.helperProportions.height-obj.bottom+this.margins.top)},_isRootNode:function(element){return/(html|body)/i.test(element.tagName)||element===this.document[0]},_getParentOffset:function(){var po=this.offsetParent.offset(),document=this.document[0];if("absolute"===this.cssPosition&&this.scrollParent[0]!==document&&$.contains(this.scrollParent[0],this.offsetParent[0])){po.left+=this.scrollParent.scrollLeft();po.top+=this.scrollParent.scrollTop()}this._isRootNode(this.offsetParent[0])&&(po={top:0,left:0});return{top:po.top+(parseInt(this.offsetParent.css("borderTopWidth"),10)||0),left:po.left+(parseInt(this.offsetParent.css("borderLeftWidth"),10)||0)}},_getRelativeOffset:function(){if("relative"!==this.cssPosition)return{top:0,left:0};var p=this.element.position(),scrollIsRootNode=this._isRootNode(this.scrollParent[0]);return{top:p.top-(parseInt(this.helper.css("top"),10)||0)+(scrollIsRootNode?0:this.scrollParent.scrollTop()),left:p.left-(parseInt(this.helper.css("left"),10)||0)+(scrollIsRootNode?0:this.scrollParent.scrollLeft())}},_cacheMargins:function(){this.margins={left:parseInt(this.element.css("marginLeft"),10)||0,top:parseInt(this.element.css("marginTop"),10)||0,right:parseInt(this.element.css("marginRight"),10)||0,bottom:parseInt(this.element.css("marginBottom"),10)||0}},_cacheHelperProportions:function(){this.helperProportions={width:this.helper.outerWidth(),height:this.helper.outerHeight()}},_setContainment:function(){var isUserScrollable,c,ce,o=this.options,document=this.document[0];this.relativeContainer=null;if(o.containment)if("window"!==o.containment)if("document"!==o.containment)if(o.containment.constructor!==Array){"parent"===o.containment&&(o.containment=this.helper[0].parentNode);c=$(o.containment);ce=c[0];if(ce){isUserScrollable=/(scroll|auto)/.test(c.css("overflow"));this.containment=[(parseInt(c.css("borderLeftWidth"),10)||0)+(parseInt(c.css("paddingLeft"),10)||0),(parseInt(c.css("borderTopWidth"),10)||0)+(parseInt(c.css("paddingTop"),10)||0),(isUserScrollable?Math.max(ce.scrollWidth,ce.offsetWidth):ce.offsetWidth)-(parseInt(c.css("borderRightWidth"),10)||0)-(parseInt(c.css("paddingRight"),10)||0)-this.helperProportions.width-this.margins.left-this.margins.right,(isUserScrollable?Math.max(ce.scrollHeight,ce.offsetHeight):ce.offsetHeight)-(parseInt(c.css("borderBottomWidth"),10)||0)-(parseInt(c.css("paddingBottom"),10)||0)-this.helperProportions.height-this.margins.top-this.margins.bottom];this.relativeContainer=c}}else this.containment=o.containment;else this.containment=[0,0,$(document).width()-this.helperProportions.width-this.margins.left,($(document).height()||document.body.parentNode.scrollHeight)-this.helperProportions.height-this.margins.top];else this.containment=[$(window).scrollLeft()-this.offset.relative.left-this.offset.parent.left,$(window).scrollTop()-this.offset.relative.top-this.offset.parent.top,$(window).scrollLeft()+$(window).width()-this.helperProportions.width-this.margins.left,$(window).scrollTop()+($(window).height()||document.body.parentNode.scrollHeight)-this.helperProportions.height-this.margins.top];else this.containment=null},_convertPositionTo:function(d,pos){pos||(pos=this.position);var mod="absolute"===d?1:-1,scrollIsRootNode=this._isRootNode(this.scrollParent[0]);return{top:pos.top+this.offset.relative.top*mod+this.offset.parent.top*mod-("fixed"===this.cssPosition?-this.offset.scroll.top:scrollIsRootNode?0:this.offset.scroll.top)*mod,left:pos.left+this.offset.relative.left*mod+this.offset.parent.left*mod-("fixed"===this.cssPosition?-this.offset.scroll.left:scrollIsRootNode?0:this.offset.scroll.left)*mod}},_generatePosition:function(event,constrainPosition){var containment,co,top,left,o=this.options,scrollIsRootNode=this._isRootNode(this.scrollParent[0]),pageX=event.pageX,pageY=event.pageY;scrollIsRootNode&&this.offset.scroll||(this.offset.scroll={top:this.scrollParent.scrollTop(),left:this.scrollParent.scrollLeft()});if(constrainPosition){if(this.containment){if(this.relativeContainer){co=this.relativeContainer.offset();containment=[this.containment[0]+co.left,this.containment[1]+co.top,this.containment[2]+co.left,this.containment[3]+co.top]}else containment=this.containment;event.pageX-this.offset.click.left<containment[0]&&(pageX=containment[0]+this.offset.click.left);event.pageY-this.offset.click.top<containment[1]&&(pageY=containment[1]+this.offset.click.top);event.pageX-this.offset.click.left>containment[2]&&(pageX=containment[2]+this.offset.click.left);event.pageY-this.offset.click.top>containment[3]&&(pageY=containment[3]+this.offset.click.top)}if(o.grid){top=o.grid[1]?this.originalPageY+Math.round((pageY-this.originalPageY)/o.grid[1])*o.grid[1]:this.originalPageY;pageY=containment?top-this.offset.click.top>=containment[1]||top-this.offset.click.top>containment[3]?top:top-this.offset.click.top>=containment[1]?top-o.grid[1]:top+o.grid[1]:top;left=o.grid[0]?this.originalPageX+Math.round((pageX-this.originalPageX)/o.grid[0])*o.grid[0]:this.originalPageX;pageX=containment?left-this.offset.click.left>=containment[0]||left-this.offset.click.left>containment[2]?left:left-this.offset.click.left>=containment[0]?left-o.grid[0]:left+o.grid[0]:left}"y"===o.axis&&(pageX=this.originalPageX);"x"===o.axis&&(pageY=this.originalPageY)}return{top:pageY-this.offset.click.top-this.offset.relative.top-this.offset.parent.top+("fixed"===this.cssPosition?-this.offset.scroll.top:scrollIsRootNode?0:this.offset.scroll.top),left:pageX-this.offset.click.left-this.offset.relative.left-this.offset.parent.left+("fixed"===this.cssPosition?-this.offset.scroll.left:scrollIsRootNode?0:this.offset.scroll.left)}},_clear:function(){this._removeClass(this.helper,"cv-ui-draggable-dragging");this.helper[0]===this.element[0]||this.cancelHelperRemoval||this.helper.remove();this.helper=null;this.cancelHelperRemoval=!1;this.destroyOnClear&&this.destroy()},_trigger:function(type,event,ui){ui=ui||this._uiHash();$.ui.plugin.call(this,type,[event,ui,this],!0);if(/^(drag|start|stop)/.test(type)){this.positionAbs=this._convertPositionTo("absolute");ui.offset=this.positionAbs}return $.Widget.prototype._trigger.call(this,type,event,ui)},plugins:{},_uiHash:function(){return{helper:this.helper,position:this.position,originalPosition:this.originalPosition,offset:this.positionAbs}}});$.ui.plugin.add("draggable","connectToSortable",{start:function(event,ui,draggable){var uiSortable=$.extend({},ui,{item:draggable.element});draggable.sortables=[];$(draggable.options.connectToSortable).each(function(){var sortable=$(this).sortable("instance");if(sortable&&!sortable.options.disabled){draggable.sortables.push(sortable);sortable.refreshPositions();sortable._trigger("activate",event,uiSortable)}})},stop:function(event,ui,draggable){var uiSortable=$.extend({},ui,{item:draggable.element});draggable.cancelHelperRemoval=!1;$.each(draggable.sortables,function(){var sortable=this;if(sortable.isOver){sortable.isOver=0;draggable.cancelHelperRemoval=!0;sortable.cancelHelperRemoval=!1;sortable._storedCSS={position:sortable.placeholder.css("position"),top:sortable.placeholder.css("top"),left:sortable.placeholder.css("left")};sortable._mouseStop(event);sortable.options.helper=sortable.options._helper}else{sortable.cancelHelperRemoval=!0;sortable._trigger("deactivate",event,uiSortable)}})},drag:function(event,ui,draggable){$.each(draggable.sortables,function(){var innermostIntersecting=!1,sortable=this;sortable.positionAbs=draggable.positionAbs;sortable.helperProportions=draggable.helperProportions;sortable.offset.click=draggable.offset.click;if(sortable._intersectsWith(sortable.containerCache)){innermostIntersecting=!0;$.each(draggable.sortables,function(){this.positionAbs=draggable.positionAbs;this.helperProportions=draggable.helperProportions;this.offset.click=draggable.offset.click;this!==sortable&&this._intersectsWith(this.containerCache)&&$.contains(sortable.element[0],this.element[0])&&(innermostIntersecting=!1);return innermostIntersecting})}if(innermostIntersecting){if(!sortable.isOver){sortable.isOver=1;draggable._parent=ui.helper.parent();sortable.currentItem=ui.helper.appendTo(sortable.element).data("cv-ui-sortable-item",!0);sortable.options._helper=sortable.options.helper;sortable.options.helper=function(){return ui.helper[0]};event.target=sortable.currentItem[0];sortable._mouseCapture(event,!0);sortable._mouseStart(event,!0,!0);sortable.offset.click.top=draggable.offset.click.top;sortable.offset.click.left=draggable.offset.click.left;sortable.offset.parent.left-=draggable.offset.parent.left-sortable.offset.parent.left;sortable.offset.parent.top-=draggable.offset.parent.top-sortable.offset.parent.top;draggable._trigger("toSortable",event);draggable.dropped=sortable.element;$.each(draggable.sortables,function(){this.refreshPositions()});draggable.currentItem=draggable.element;sortable.fromOutside=draggable}if(sortable.currentItem){sortable._mouseDrag(event);ui.position=sortable.position}}else if(sortable.isOver){sortable.isOver=0;sortable.cancelHelperRemoval=!0;sortable.options._revert=sortable.options.revert;sortable.options.revert=!1;sortable._trigger("out",event,sortable._uiHash(sortable));sortable._mouseStop(event,!0);sortable.options.revert=sortable.options._revert;sortable.options.helper=sortable.options._helper;sortable.placeholder&&sortable.placeholder.remove();ui.helper.appendTo(draggable._parent);draggable._refreshOffsets(event);ui.position=draggable._generatePosition(event,!0);draggable._trigger("fromSortable",event);draggable.dropped=!1;$.each(draggable.sortables,function(){this.refreshPositions()})}})}});$.ui.plugin.add("draggable","cursor",{start:function(event,ui,instance){var t=$("body"),o=instance.options;t.css("cursor")&&(o._cursor=t.css("cursor"));t.css("cursor",o.cursor)},stop:function(event,ui,instance){var o=instance.options;o._cursor&&$("body").css("cursor",o._cursor)}});$.ui.plugin.add("draggable","opacity",{start:function(event,ui,instance){var t=$(ui.helper),o=instance.options;t.css("opacity")&&(o._opacity=t.css("opacity"));t.css("opacity",o.opacity)},stop:function(event,ui,instance){var o=instance.options;o._opacity&&$(ui.helper).css("opacity",o._opacity)}});$.ui.plugin.add("draggable","scroll",{start:function(event,ui,i){i.scrollParentNotHidden||(i.scrollParentNotHidden=i.helper.scrollParent(!1));i.scrollParentNotHidden[0]!==i.document[0]&&"HTML"!==i.scrollParentNotHidden[0].tagName&&(i.overflowOffset=i.scrollParentNotHidden.offset())},drag:function(event,ui,i){var o=i.options,scrolled=!1,scrollParent=i.scrollParentNotHidden[0],document=i.document[0];if(scrollParent!==document&&"HTML"!==scrollParent.tagName){o.axis&&"x"===o.axis||(i.overflowOffset.top+scrollParent.offsetHeight-event.pageY<o.scrollSensitivity?scrollParent.scrollTop=scrolled=scrollParent.scrollTop+o.scrollSpeed:event.pageY-i.overflowOffset.top<o.scrollSensitivity&&(scrollParent.scrollTop=scrolled=scrollParent.scrollTop-o.scrollSpeed));o.axis&&"y"===o.axis||(i.overflowOffset.left+scrollParent.offsetWidth-event.pageX<o.scrollSensitivity?scrollParent.scrollLeft=scrolled=scrollParent.scrollLeft+o.scrollSpeed:event.pageX-i.overflowOffset.left<o.scrollSensitivity&&(scrollParent.scrollLeft=scrolled=scrollParent.scrollLeft-o.scrollSpeed))}else{o.axis&&"x"===o.axis||(event.pageY-$(document).scrollTop()<o.scrollSensitivity?scrolled=$(document).scrollTop($(document).scrollTop()-o.scrollSpeed):$(window).height()-(event.pageY-$(document).scrollTop())<o.scrollSensitivity&&(scrolled=$(document).scrollTop($(document).scrollTop()+o.scrollSpeed)));o.axis&&"y"===o.axis||(event.pageX-$(document).scrollLeft()<o.scrollSensitivity?scrolled=$(document).scrollLeft($(document).scrollLeft()-o.scrollSpeed):$(window).width()-(event.pageX-$(document).scrollLeft())<o.scrollSensitivity&&(scrolled=$(document).scrollLeft($(document).scrollLeft()+o.scrollSpeed)))}scrolled!==!1&&$.ui.ddmanager&&!o.dropBehaviour&&$.ui.ddmanager.prepareOffsets(i,event)}});$.ui.plugin.add("draggable","snap",{start:function(event,ui,i){var o=i.options;i.snapElements=[];$(o.snap.constructor!==String?o.snap.items||":data(cv-ui-draggable)":o.snap).each(function(){var $t=$(this),$o=$t.offset();this!==i.element[0]&&i.snapElements.push({item:this,width:$t.outerWidth(),height:$t.outerHeight(),top:$o.top,left:$o.left})})},drag:function(event,ui,inst){var ts,bs,ls,rs,l,r,t,b,i,first,o=inst.options,d=o.snapTolerance,x1=ui.offset.left,x2=x1+inst.helperProportions.width,y1=ui.offset.top,y2=y1+inst.helperProportions.height;for(i=inst.snapElements.length-1;i>=0;i--){l=inst.snapElements[i].left-inst.margins.left;r=l+inst.snapElements[i].width;t=inst.snapElements[i].top-inst.margins.top;b=t+inst.snapElements[i].height;if(l-d>x2||x1>r+d||t-d>y2||y1>b+d||!$.contains(inst.snapElements[i].item.ownerDocument,inst.snapElements[i].item)){inst.snapElements[i].snapping&&inst.options.snap.release&&inst.options.snap.release.call(inst.element,event,$.extend(inst._uiHash(),{snapItem:inst.snapElements[i].item}));inst.snapElements[i].snapping=!1}else{if("inner"!==o.snapMode){ts=Math.abs(t-y2)<=d;bs=Math.abs(b-y1)<=d;ls=Math.abs(l-x2)<=d;rs=Math.abs(r-x1)<=d;ts&&(ui.position.top=inst._convertPositionTo("relative",{top:t-inst.helperProportions.height,left:0}).top);bs&&(ui.position.top=inst._convertPositionTo("relative",{top:b,left:0}).top);ls&&(ui.position.left=inst._convertPositionTo("relative",{top:0,left:l-inst.helperProportions.width}).left);rs&&(ui.position.left=inst._convertPositionTo("relative",{top:0,left:r}).left)}first=ts||bs||ls||rs;if("outer"!==o.snapMode){ts=Math.abs(t-y1)<=d;bs=Math.abs(b-y2)<=d;ls=Math.abs(l-x1)<=d;rs=Math.abs(r-x2)<=d;ts&&(ui.position.top=inst._convertPositionTo("relative",{top:t,left:0}).top);bs&&(ui.position.top=inst._convertPositionTo("relative",{top:b-inst.helperProportions.height,left:0}).top);ls&&(ui.position.left=inst._convertPositionTo("relative",{top:0,left:l}).left);rs&&(ui.position.left=inst._convertPositionTo("relative",{top:0,left:r-inst.helperProportions.width}).left)}!inst.snapElements[i].snapping&&(ts||bs||ls||rs||first)&&inst.options.snap.snap&&inst.options.snap.snap.call(inst.element,event,$.extend(inst._uiHash(),{snapItem:inst.snapElements[i].item}));inst.snapElements[i].snapping=ts||bs||ls||rs||first}}}});$.ui.plugin.add("draggable","stack",{start:function(event,ui,instance){var min,o=instance.options,group=$.makeArray($(o.stack)).sort(function(a,b){return(parseInt($(a).css("zIndex"),10)||0)-(parseInt($(b).css("zIndex"),10)||0)});if(group.length){min=parseInt($(group[0]).css("zIndex"),10)||0;$(group).each(function(i){$(this).css("zIndex",min+i)});this.css("zIndex",min+group.length)}}});$.ui.plugin.add("draggable","zIndex",{start:function(event,ui,instance){var t=$(ui.helper),o=instance.options;t.css("zIndex")&&(o._zIndex=t.css("zIndex"));t.css("zIndex",o.zIndex)},stop:function(event,ui,instance){var o=instance.options;o._zIndex&&$(ui.helper).css("zIndex",o._zIndex)}});$.ui.draggable;$.widget("ui.resizable",$.ui.mouse,{version:"1.12.1",widgetEventPrefix:"resize",options:{alsoResize:!1,animate:!1,animateDuration:"slow",animateEasing:"swing",aspectRatio:!1,autoHide:!1,classes:{"cv-ui-resizable-se":"cv-ui-icon cv-ui-icon-gripsmall-diagonal-se"},containment:!1,ghost:!1,grid:!1,handles:"e,s,se",helper:!1,maxHeight:null,maxWidth:null,minHeight:10,minWidth:10,zIndex:90,resize:null,start:null,stop:null},_num:function(value){return parseFloat(value)||0},_isNumber:function(value){return!isNaN(parseFloat(value))},_hasScroll:function(el,a){if("hidden"===$(el).css("overflow"))return!1;var scroll=a&&"left"===a?"scrollLeft":"scrollTop",has=!1;if(el[scroll]>0)return!0;el[scroll]=1;has=el[scroll]>0;el[scroll]=0;return has},_create:function(){var margins,o=this.options,that=this;this._addClass("cv-ui-resizable");$.extend(this,{_aspectRatio:!!o.aspectRatio,aspectRatio:o.aspectRatio,originalElement:this.element,_proportionallyResizeElements:[],_helper:o.helper||o.ghost||o.animate?o.helper||"cv-ui-resizable-helper":null});if(this.element[0].nodeName.match(/^(canvas|textarea|input|select|button|img)$/i)){this.element.wrap($("<div class='cv-ui-wrapper' style='overflow: hidden;'></div>").css({position:this.element.css("position"),width:this.element.outerWidth(),height:this.element.outerHeight(),top:this.element.css("top"),left:this.element.css("left")}));this.element=this.element.parent().data("cv-ui-resizable",this.element.resizable("instance"));this.elementIsWrapper=!0;margins={marginTop:this.originalElement.css("marginTop"),marginRight:this.originalElement.css("marginRight"),marginBottom:this.originalElement.css("marginBottom"),marginLeft:this.originalElement.css("marginLeft")};this.element.css(margins);this.originalElement.css("margin",0);this.originalResizeStyle=this.originalElement.css("resize");this.originalElement.css("resize","none");this._proportionallyResizeElements.push(this.originalElement.css({position:"static",zoom:1,display:"block"}));this.originalElement.css(margins);this._proportionallyResize()}this._setupHandles();o.autoHide&&$(this.element).on("mouseenter",function(){if(!o.disabled){that._removeClass("cv-ui-resizable-autohide");that._handles.show()}}).on("mouseleave",function(){if(!o.disabled&&!that.resizing){that._addClass("cv-ui-resizable-autohide");that._handles.hide()}});this._mouseInit()},_destroy:function(){this._mouseDestroy();var wrapper,_destroy=function(exp){$(exp).removeData("resizable").removeData("cv-ui-resizable").off(".resizable").find(".cv-ui-resizable-handle").remove()};if(this.elementIsWrapper){_destroy(this.element);wrapper=this.element;this.originalElement.css({position:wrapper.css("position"),width:wrapper.outerWidth(),height:wrapper.outerHeight(),top:wrapper.css("top"),left:wrapper.css("left")}).insertAfter(wrapper);wrapper.remove()}this.originalElement.css("resize",this.originalResizeStyle);_destroy(this.originalElement);return this},_setOption:function(key,value){this._super(key,value);switch(key){case"handles":this._removeHandles();this._setupHandles()}},_setupHandles:function(){
var handle,i,n,hname,axis,o=this.options,that=this;this.handles=o.handles||($(".cv-ui-resizable-handle",this.element).length?{n:".cv-ui-resizable-n",e:".cv-ui-resizable-e",s:".cv-ui-resizable-s",w:".cv-ui-resizable-w",se:".cv-ui-resizable-se",sw:".cv-ui-resizable-sw",ne:".cv-ui-resizable-ne",nw:".cv-ui-resizable-nw"}:"e,s,se");this._handles=$();if(this.handles.constructor===String){"all"===this.handles&&(this.handles="n,e,s,w,se,sw,ne,nw");n=this.handles.split(",");this.handles={};for(i=0;i<n.length;i++){handle=$.trim(n[i]);hname="cv-ui-resizable-"+handle;axis=$("<div>");this._addClass(axis,"cv-ui-resizable-handle "+hname);axis.css({zIndex:o.zIndex});this.handles[handle]=".cv-ui-resizable-"+handle;this.element.append(axis)}}this._renderAxis=function(target){var i,axis,padPos,padWrapper;target=target||this.element;for(i in this.handles){if(this.handles[i].constructor===String)this.handles[i]=this.element.children(this.handles[i]).first().show();else if(this.handles[i].jquery||this.handles[i].nodeType){this.handles[i]=$(this.handles[i]);this._on(this.handles[i],{mousedown:that._mouseDown})}if(this.elementIsWrapper&&this.originalElement[0].nodeName.match(/^(textarea|input|select|button)$/i)){axis=$(this.handles[i],this.element);padWrapper=/sw|ne|nw|se|n|s/.test(i)?axis.outerHeight():axis.outerWidth();padPos=["padding",/ne|nw|n/.test(i)?"Top":/se|sw|s/.test(i)?"Bottom":/^e$/.test(i)?"Right":"Left"].join("");target.css(padPos,padWrapper);this._proportionallyResize()}this._handles=this._handles.add(this.handles[i])}};this._renderAxis(this.element);this._handles=this._handles.add(this.element.find(".cv-ui-resizable-handle"));this._handles.disableSelection();this._handles.on("mouseover",function(){if(!that.resizing){this.className&&(axis=this.className.match(/cv-ui-resizable-(se|sw|ne|nw|n|e|s|w)/i));that.axis=axis&&axis[1]?axis[1]:"se"}});if(o.autoHide){this._handles.hide();this._addClass("cv-ui-resizable-autohide")}},_removeHandles:function(){this._handles.remove()},_mouseCapture:function(event){var i,handle,capture=!1;for(i in this.handles){handle=$(this.handles[i])[0];(handle===event.target||$.contains(handle,event.target))&&(capture=!0)}return!this.options.disabled&&capture},_mouseStart:function(event){var curleft,curtop,cursor,o=this.options,el=this.element;this.resizing=!0;this._renderProxy();curleft=this._num(this.helper.css("left"));curtop=this._num(this.helper.css("top"));if(o.containment){curleft+=$(o.containment).scrollLeft()||0;curtop+=$(o.containment).scrollTop()||0}this.offset=this.helper.offset();this.position={left:curleft,top:curtop};this.size=this._helper?{width:this.helper.width(),height:this.helper.height()}:{width:el.width(),height:el.height()};this.originalSize=this._helper?{width:el.outerWidth(),height:el.outerHeight()}:{width:el.width(),height:el.height()};this.sizeDiff={width:el.outerWidth()-el.width(),height:el.outerHeight()-el.height()};this.originalPosition={left:curleft,top:curtop};this.originalMousePosition={left:event.pageX,top:event.pageY};this.aspectRatio="number"==typeof o.aspectRatio?o.aspectRatio:this.originalSize.width/this.originalSize.height||1;cursor=$(".cv-ui-resizable-"+this.axis).css("cursor");$("body").css("cursor","auto"===cursor?this.axis+"-resize":cursor);this._addClass("cv-ui-resizable-resizing");this._propagate("start",event);return!0},_mouseDrag:function(event){var data,props,smp=this.originalMousePosition,a=this.axis,dx=event.pageX-smp.left||0,dy=event.pageY-smp.top||0,trigger=this._change[a];this._updatePrevProperties();if(!trigger)return!1;data=trigger.apply(this,[event,dx,dy]);this._updateVirtualBoundaries(event.shiftKey);(this._aspectRatio||event.shiftKey)&&(data=this._updateRatio(data,event));data=this._respectSize(data,event);this._updateCache(data);this._propagate("resize",event);props=this._applyChanges();!this._helper&&this._proportionallyResizeElements.length&&this._proportionallyResize();if(!$.isEmptyObject(props)){this._updatePrevProperties();this._trigger("resize",event,this.ui());this._applyChanges()}return!1},_mouseStop:function(event){this.resizing=!1;var pr,ista,soffseth,soffsetw,s,left,top,o=this.options,that=this;if(this._helper){pr=this._proportionallyResizeElements;ista=pr.length&&/textarea/i.test(pr[0].nodeName);soffseth=ista&&this._hasScroll(pr[0],"left")?0:that.sizeDiff.height;soffsetw=ista?0:that.sizeDiff.width;s={width:that.helper.width()-soffsetw,height:that.helper.height()-soffseth};left=parseFloat(that.element.css("left"))+(that.position.left-that.originalPosition.left)||null;top=parseFloat(that.element.css("top"))+(that.position.top-that.originalPosition.top)||null;o.animate||this.element.css($.extend(s,{top:top,left:left}));that.helper.height(that.size.height);that.helper.width(that.size.width);this._helper&&!o.animate&&this._proportionallyResize()}$("body").css("cursor","auto");this._removeClass("cv-ui-resizable-resizing");this._propagate("stop",event);this._helper&&this.helper.remove();return!1},_updatePrevProperties:function(){this.prevPosition={top:this.position.top,left:this.position.left};this.prevSize={width:this.size.width,height:this.size.height}},_applyChanges:function(){var props={};this.position.top!==this.prevPosition.top&&(props.top=this.position.top+"px");this.position.left!==this.prevPosition.left&&(props.left=this.position.left+"px");this.size.width!==this.prevSize.width&&(props.width=this.size.width+"px");this.size.height!==this.prevSize.height&&(props.height=this.size.height+"px");this.helper.css(props);return props},_updateVirtualBoundaries:function(forceAspectRatio){var pMinWidth,pMaxWidth,pMinHeight,pMaxHeight,b,o=this.options;b={minWidth:this._isNumber(o.minWidth)?o.minWidth:0,maxWidth:this._isNumber(o.maxWidth)?o.maxWidth:1/0,minHeight:this._isNumber(o.minHeight)?o.minHeight:0,maxHeight:this._isNumber(o.maxHeight)?o.maxHeight:1/0};if(this._aspectRatio||forceAspectRatio){pMinWidth=b.minHeight*this.aspectRatio;pMinHeight=b.minWidth/this.aspectRatio;pMaxWidth=b.maxHeight*this.aspectRatio;pMaxHeight=b.maxWidth/this.aspectRatio;pMinWidth>b.minWidth&&(b.minWidth=pMinWidth);pMinHeight>b.minHeight&&(b.minHeight=pMinHeight);pMaxWidth<b.maxWidth&&(b.maxWidth=pMaxWidth);pMaxHeight<b.maxHeight&&(b.maxHeight=pMaxHeight)}this._vBoundaries=b},_updateCache:function(data){this.offset=this.helper.offset();this._isNumber(data.left)&&(this.position.left=data.left);this._isNumber(data.top)&&(this.position.top=data.top);this._isNumber(data.height)&&(this.size.height=data.height);this._isNumber(data.width)&&(this.size.width=data.width)},_updateRatio:function(data){var cpos=this.position,csize=this.size,a=this.axis;this._isNumber(data.height)?data.width=data.height*this.aspectRatio:this._isNumber(data.width)&&(data.height=data.width/this.aspectRatio);if("sw"===a){data.left=cpos.left+(csize.width-data.width);data.top=null}if("nw"===a){data.top=cpos.top+(csize.height-data.height);data.left=cpos.left+(csize.width-data.width)}return data},_respectSize:function(data){var o=this._vBoundaries,a=this.axis,ismaxw=this._isNumber(data.width)&&o.maxWidth&&o.maxWidth<data.width,ismaxh=this._isNumber(data.height)&&o.maxHeight&&o.maxHeight<data.height,isminw=this._isNumber(data.width)&&o.minWidth&&o.minWidth>data.width,isminh=this._isNumber(data.height)&&o.minHeight&&o.minHeight>data.height,dw=this.originalPosition.left+this.originalSize.width,dh=this.originalPosition.top+this.originalSize.height,cw=/sw|nw|w/.test(a),ch=/nw|ne|n/.test(a);isminw&&(data.width=o.minWidth);isminh&&(data.height=o.minHeight);ismaxw&&(data.width=o.maxWidth);ismaxh&&(data.height=o.maxHeight);isminw&&cw&&(data.left=dw-o.minWidth);ismaxw&&cw&&(data.left=dw-o.maxWidth);isminh&&ch&&(data.top=dh-o.minHeight);ismaxh&&ch&&(data.top=dh-o.maxHeight);data.width||data.height||data.left||!data.top?data.width||data.height||data.top||!data.left||(data.left=null):data.top=null;return data},_getPaddingPlusBorderDimensions:function(element){for(var i=0,widths=[],borders=[element.css("borderTopWidth"),element.css("borderRightWidth"),element.css("borderBottomWidth"),element.css("borderLeftWidth")],paddings=[element.css("paddingTop"),element.css("paddingRight"),element.css("paddingBottom"),element.css("paddingLeft")];4>i;i++){widths[i]=parseFloat(borders[i])||0;widths[i]+=parseFloat(paddings[i])||0}return{height:widths[0]+widths[2],width:widths[1]+widths[3]}},_proportionallyResize:function(){if(this._proportionallyResizeElements.length)for(var prel,i=0,element=this.helper||this.element;i<this._proportionallyResizeElements.length;i++){prel=this._proportionallyResizeElements[i];this.outerDimensions||(this.outerDimensions=this._getPaddingPlusBorderDimensions(prel));prel.css({height:element.height()-this.outerDimensions.height||0,width:element.width()-this.outerDimensions.width||0})}},_renderProxy:function(){var el=this.element,o=this.options;this.elementOffset=el.offset();if(this._helper){this.helper=this.helper||$("<div style='overflow:hidden;'></div>");this._addClass(this.helper,this._helper);this.helper.css({width:this.element.outerWidth(),height:this.element.outerHeight(),position:"absolute",left:this.elementOffset.left+"px",top:this.elementOffset.top+"px",zIndex:++o.zIndex});this.helper.appendTo("body").disableSelection()}else this.helper=this.element},_change:{e:function(event,dx){return{width:this.originalSize.width+dx}},w:function(event,dx){var cs=this.originalSize,sp=this.originalPosition;return{left:sp.left+dx,width:cs.width-dx}},n:function(event,dx,dy){var cs=this.originalSize,sp=this.originalPosition;return{top:sp.top+dy,height:cs.height-dy}},s:function(event,dx,dy){return{height:this.originalSize.height+dy}},se:function(event,dx,dy){return $.extend(this._change.s.apply(this,arguments),this._change.e.apply(this,[event,dx,dy]))},sw:function(event,dx,dy){return $.extend(this._change.s.apply(this,arguments),this._change.w.apply(this,[event,dx,dy]))},ne:function(event,dx,dy){return $.extend(this._change.n.apply(this,arguments),this._change.e.apply(this,[event,dx,dy]))},nw:function(event,dx,dy){return $.extend(this._change.n.apply(this,arguments),this._change.w.apply(this,[event,dx,dy]))}},_propagate:function(n,event){$.ui.plugin.call(this,n,[event,this.ui()]);"resize"!==n&&this._trigger(n,event,this.ui())},plugins:{},ui:function(){return{originalElement:this.originalElement,element:this.element,helper:this.helper,position:this.position,size:this.size,originalSize:this.originalSize,originalPosition:this.originalPosition}}});$.ui.plugin.add("resizable","animate",{stop:function(event){var that=$(this).resizable("instance"),o=that.options,pr=that._proportionallyResizeElements,ista=pr.length&&/textarea/i.test(pr[0].nodeName),soffseth=ista&&that._hasScroll(pr[0],"left")?0:that.sizeDiff.height,soffsetw=ista?0:that.sizeDiff.width,style={width:that.size.width-soffsetw,height:that.size.height-soffseth},left=parseFloat(that.element.css("left"))+(that.position.left-that.originalPosition.left)||null,top=parseFloat(that.element.css("top"))+(that.position.top-that.originalPosition.top)||null;that.element.animate($.extend(style,top&&left?{top:top,left:left}:{}),{duration:o.animateDuration,easing:o.animateEasing,step:function(){var data={width:parseFloat(that.element.css("width")),height:parseFloat(that.element.css("height")),top:parseFloat(that.element.css("top")),left:parseFloat(that.element.css("left"))};pr&&pr.length&&$(pr[0]).css({width:data.width,height:data.height});that._updateCache(data);that._propagate("resize",event)}})}});$.ui.plugin.add("resizable","containment",{start:function(){var element,p,co,ch,cw,width,height,that=$(this).resizable("instance"),o=that.options,el=that.element,oc=o.containment,ce=oc instanceof $?oc.get(0):/parent/.test(oc)?el.parent().get(0):oc;if(ce){that.containerElement=$(ce);if(/document/.test(oc)||oc===document){that.containerOffset={left:0,top:0};that.containerPosition={left:0,top:0};that.parentData={element:$(document),left:0,top:0,width:$(document).width(),height:$(document).height()||document.body.parentNode.scrollHeight}}else{element=$(ce);p=[];$(["Top","Right","Left","Bottom"]).each(function(i,name){p[i]=that._num(element.css("padding"+name))});that.containerOffset=element.offset();that.containerPosition=element.position();that.containerSize={height:element.innerHeight()-p[3],width:element.innerWidth()-p[1]};co=that.containerOffset;ch=that.containerSize.height;cw=that.containerSize.width;width=that._hasScroll(ce,"left")?ce.scrollWidth:cw;height=that._hasScroll(ce)?ce.scrollHeight:ch;that.parentData={element:ce,left:co.left,top:co.top,width:width,height:height}}}},resize:function(event){var woset,hoset,isParent,isOffsetRelative,that=$(this).resizable("instance"),o=that.options,co=that.containerOffset,cp=that.position,pRatio=that._aspectRatio||event.shiftKey,cop={top:0,left:0},ce=that.containerElement,continueResize=!0;ce[0]!==document&&/static/.test(ce.css("position"))&&(cop=co);if(cp.left<(that._helper?co.left:0)){that.size.width=that.size.width+(that._helper?that.position.left-co.left:that.position.left-cop.left);if(pRatio){that.size.height=that.size.width/that.aspectRatio;continueResize=!1}that.position.left=o.helper?co.left:0}if(cp.top<(that._helper?co.top:0)){that.size.height=that.size.height+(that._helper?that.position.top-co.top:that.position.top);if(pRatio){that.size.width=that.size.height*that.aspectRatio;continueResize=!1}that.position.top=that._helper?co.top:0}isParent=that.containerElement.get(0)===that.element.parent().get(0);isOffsetRelative=/relative|absolute/.test(that.containerElement.css("position"));if(isParent&&isOffsetRelative){that.offset.left=that.parentData.left+that.position.left;that.offset.top=that.parentData.top+that.position.top}else{that.offset.left=that.element.offset().left;that.offset.top=that.element.offset().top}woset=Math.abs(that.sizeDiff.width+(that._helper?that.offset.left-cop.left:that.offset.left-co.left));hoset=Math.abs(that.sizeDiff.height+(that._helper?that.offset.top-cop.top:that.offset.top-co.top));if(woset+that.size.width>=that.parentData.width){that.size.width=that.parentData.width-woset;if(pRatio){that.size.height=that.size.width/that.aspectRatio;continueResize=!1}}if(hoset+that.size.height>=that.parentData.height){that.size.height=that.parentData.height-hoset;if(pRatio){that.size.width=that.size.height*that.aspectRatio;continueResize=!1}}if(!continueResize){that.position.left=that.prevPosition.left;that.position.top=that.prevPosition.top;that.size.width=that.prevSize.width;that.size.height=that.prevSize.height}},stop:function(){var that=$(this).resizable("instance"),o=that.options,co=that.containerOffset,cop=that.containerPosition,ce=that.containerElement,helper=$(that.helper),ho=helper.offset(),w=helper.outerWidth()-that.sizeDiff.width,h=helper.outerHeight()-that.sizeDiff.height;that._helper&&!o.animate&&/relative/.test(ce.css("position"))&&$(this).css({left:ho.left-cop.left-co.left,width:w,height:h});that._helper&&!o.animate&&/static/.test(ce.css("position"))&&$(this).css({left:ho.left-cop.left-co.left,width:w,height:h})}});$.ui.plugin.add("resizable","alsoResize",{start:function(){var that=$(this).resizable("instance"),o=that.options;$(o.alsoResize).each(function(){var el=$(this);el.data("cv-ui-resizable-alsoresize",{width:parseFloat(el.width()),height:parseFloat(el.height()),left:parseFloat(el.css("left")),top:parseFloat(el.css("top"))})})},resize:function(event,ui){var that=$(this).resizable("instance"),o=that.options,os=that.originalSize,op=that.originalPosition,delta={height:that.size.height-os.height||0,width:that.size.width-os.width||0,top:that.position.top-op.top||0,left:that.position.left-op.left||0};$(o.alsoResize).each(function(){var el=$(this),start=$(this).data("cv-ui-resizable-alsoresize"),style={},css=el.parents(ui.originalElement[0]).length?["width","height"]:["width","height","top","left"];$.each(css,function(i,prop){var sum=(start[prop]||0)+(delta[prop]||0);sum&&sum>=0&&(style[prop]=sum||null)});el.css(style)})},stop:function(){$(this).removeData("cv-ui-resizable-alsoresize")}});$.ui.plugin.add("resizable","ghost",{start:function(){var that=$(this).resizable("instance"),cs=that.size;that.ghost=that.originalElement.clone();that.ghost.css({opacity:.25,display:"block",position:"relative",height:cs.height,width:cs.width,margin:0,left:0,top:0});that._addClass(that.ghost,"cv-ui-resizable-ghost");$.uiBackCompat!==!1&&"string"==typeof that.options.ghost&&that.ghost.addClass(this.options.ghost);that.ghost.appendTo(that.helper)},resize:function(){var that=$(this).resizable("instance");that.ghost&&that.ghost.css({position:"relative",height:that.size.height,width:that.size.width})},stop:function(){var that=$(this).resizable("instance");that.ghost&&that.helper&&that.helper.get(0).removeChild(that.ghost.get(0))}});$.ui.plugin.add("resizable","grid",{resize:function(){var outerDimensions,that=$(this).resizable("instance"),o=that.options,cs=that.size,os=that.originalSize,op=that.originalPosition,a=that.axis,grid="number"==typeof o.grid?[o.grid,o.grid]:o.grid,gridX=grid[0]||1,gridY=grid[1]||1,ox=Math.round((cs.width-os.width)/gridX)*gridX,oy=Math.round((cs.height-os.height)/gridY)*gridY,newWidth=os.width+ox,newHeight=os.height+oy,isMaxWidth=o.maxWidth&&o.maxWidth<newWidth,isMaxHeight=o.maxHeight&&o.maxHeight<newHeight,isMinWidth=o.minWidth&&o.minWidth>newWidth,isMinHeight=o.minHeight&&o.minHeight>newHeight;o.grid=grid;isMinWidth&&(newWidth+=gridX);isMinHeight&&(newHeight+=gridY);isMaxWidth&&(newWidth-=gridX);isMaxHeight&&(newHeight-=gridY);if(/^(se|s|e)$/.test(a)){that.size.width=newWidth;that.size.height=newHeight}else if(/^(ne)$/.test(a)){that.size.width=newWidth;that.size.height=newHeight;that.position.top=op.top-oy}else if(/^(sw)$/.test(a)){that.size.width=newWidth;that.size.height=newHeight;that.position.left=op.left-ox}else{(0>=newHeight-gridY||0>=newWidth-gridX)&&(outerDimensions=that._getPaddingPlusBorderDimensions(this));if(newHeight-gridY>0){that.size.height=newHeight;that.position.top=op.top-oy}else{newHeight=gridY-outerDimensions.height;that.size.height=newHeight;that.position.top=op.top+os.height-newHeight}if(newWidth-gridX>0){that.size.width=newWidth;that.position.left=op.left-ox}else{newWidth=gridX-outerDimensions.width;that.size.width=newWidth;that.position.left=op.left+os.width-newWidth}}}});$.ui.resizable,$.widget("ui.menu",{version:"1.12.1",defaultElement:"<ul>",delay:300,options:{icons:{submenu:"cv-ui-icon-caret-1-e"},items:"> *",menus:"ul",position:{my:"left top",at:"right top"},role:"menu",blur:null,focus:null,select:null},_create:function(){this.activeMenu=this.element;this.mouseHandled=!1;this.element.uniqueId().attr({role:this.options.role,tabIndex:0});this._addClass("cv-ui-menu","cv-ui-widget cv-ui-widget-content");this._on({"mousedown .cv-ui-menu-item":function(event){event.preventDefault()},"click .cv-ui-menu-item":function(event){var target=$(event.target),active=$($.ui.safeActiveElement(this.document[0]));if(!this.mouseHandled&&target.not(".cv-ui-state-disabled").length){this.select(event);event.isPropagationStopped()||(this.mouseHandled=!0);if(target.has(".cv-ui-menu").length)this.expand(event);else if(!this.element.is(":focus")&&active.closest(".cv-ui-menu").length){this.element.trigger("focus",[!0]);this.active&&1===this.active.parents(".cv-ui-menu").length&&clearTimeout(this.timer)}}},"mouseenter .cv-ui-menu-item":function(event){if(!this.previousFilter){var actualTarget=$(event.target).closest(".cv-ui-menu-item"),target=$(event.currentTarget);if(actualTarget[0]===target[0]){this._removeClass(target.siblings().children(".cv-ui-state-active"),null,"cv-ui-state-active");this.focus(event,target)}}},mouseleave:"collapseAll","mouseleave .cv-ui-menu":"collapseAll",focus:function(event,keepActiveItem){var item=this.active||this.element.find(this.options.items).eq(0);keepActiveItem||this.focus(event,item)},blur:function(event){this._delay(function(){var notContained=!$.contains(this.element[0],$.ui.safeActiveElement(this.document[0]));notContained&&this.collapseAll(event)})},keydown:"_keydown"});this.refresh();this._on(this.document,{click:function(event){this._closeOnDocumentClick(event)&&this.collapseAll(event);this.mouseHandled=!1}})},_destroy:function(){var items=this.element.find(".cv-ui-menu-item").removeAttr("role aria-disabled"),submenus=items.children(".cv-ui-menu-item-wrapper").removeUniqueId().removeAttr("tabIndex role aria-haspopup");this.element.removeAttr("aria-activedescendant").find(".cv-ui-menu").addBack().removeAttr("role aria-labelledby aria-expanded aria-hidden aria-disabled tabIndex").removeUniqueId().show();submenus.children().each(function(){var elem=$(this);elem.data("cv-ui-menu-submenu-caret")&&elem.remove()})},_keydown:function(event){var match,prev,character,skip,preventDefault=!0;switch(event.keyCode){case $.ui.keyCode.PAGE_UP:this.previousPage(event);break;case $.ui.keyCode.PAGE_DOWN:this.nextPage(event);break;case $.ui.keyCode.HOME:this._move("first","first",event);break;case $.ui.keyCode.END:this._move("last","last",event);break;case $.ui.keyCode.UP:this.previous(event);break;case $.ui.keyCode.DOWN:this.next(event);break;case $.ui.keyCode.LEFT:this.collapse(event);break;case $.ui.keyCode.RIGHT:this.active&&!this.active.is(".cv-ui-state-disabled")&&this.expand(event);break;case $.ui.keyCode.ENTER:case $.ui.keyCode.SPACE:this._activate(event);break;case $.ui.keyCode.ESCAPE:this.collapse(event);break;default:preventDefault=!1;prev=this.previousFilter||"";skip=!1;character=event.keyCode>=96&&event.keyCode<=105?(event.keyCode-96).toString():String.fromCharCode(event.keyCode);clearTimeout(this.filterTimer);character===prev?skip=!0:character=prev+character;match=this._filterMenuItems(character);match=skip&&-1!==match.index(this.active.next())?this.active.nextAll(".cv-ui-menu-item"):match;if(!match.length){character=String.fromCharCode(event.keyCode);match=this._filterMenuItems(character)}if(match.length){this.focus(event,match);this.previousFilter=character;this.filterTimer=this._delay(function(){delete this.previousFilter},1e3)}else delete this.previousFilter}preventDefault&&event.preventDefault()},_activate:function(event){this.active&&!this.active.is(".cv-ui-state-disabled")&&(this.active.children("[aria-haspopup='true']").length?this.expand(event):this.select(event))},refresh:function(){var menus,items,newSubmenus,newItems,newWrappers,that=this,icon=this.options.icons.submenu,submenus=this.element.find(this.options.menus);this._toggleClass("cv-ui-menu-icons",null,!!this.element.find(".cv-ui-icon").length);newSubmenus=submenus.filter(":not(.cv-ui-menu)").hide().attr({role:this.options.role,"aria-hidden":"true","aria-expanded":"false"}).each(function(){var menu=$(this),item=menu.prev(),submenuCaret=$("<span>").data("cv-ui-menu-submenu-caret",!0);that._addClass(submenuCaret,"cv-ui-menu-icon","cv-ui-icon "+icon);item.attr("aria-haspopup","true").prepend(submenuCaret);menu.attr("aria-labelledby",item.attr("id"))});this._addClass(newSubmenus,"cv-ui-menu","cv-ui-widget cv-ui-widget-content cv-ui-front");menus=submenus.add(this.element);items=menus.find(this.options.items);items.not(".cv-ui-menu-item").each(function(){var item=$(this);that._isDivider(item)&&that._addClass(item,"cv-ui-menu-divider","cv-ui-widget-content")});newItems=items.not(".cv-ui-menu-item, .cv-ui-menu-divider");newWrappers=newItems.children().not(".cv-ui-menu").uniqueId().attr({tabIndex:-1,role:this._itemRole()});this._addClass(newItems,"cv-ui-menu-item")._addClass(newWrappers,"cv-ui-menu-item-wrapper");items.filter(".cv-ui-state-disabled").attr("aria-disabled","true");this.active&&!$.contains(this.element[0],this.active[0])&&this.blur()},_itemRole:function(){return{menu:"menuitem",listbox:"option"}[this.options.role]},_setOption:function(key,value){if("icons"===key){var icons=this.element.find(".cv-ui-menu-icon");this._removeClass(icons,null,this.options.icons.submenu)._addClass(icons,null,value.submenu)}this._super(key,value)},_setOptionDisabled:function(value){this._super(value);this.element.attr("aria-disabled",String(value));this._toggleClass(null,"cv-ui-state-disabled",!!value)},focus:function(event,item){var nested,focused,activeParent;this.blur(event,event&&"focus"===event.type);this._scrollIntoView(item);this.active=item.first();focused=this.active.children(".cv-ui-menu-item-wrapper");this._addClass(focused,null,"cv-ui-state-active");this.options.role&&this.element.attr("aria-activedescendant",focused.attr("id"));activeParent=this.active.parent().closest(".cv-ui-menu-item").children(".cv-ui-menu-item-wrapper");this._addClass(activeParent,null,"cv-ui-state-active");event&&"keydown"===event.type?this._close():this.timer=this._delay(function(){this._close()},this.delay);nested=item.children(".cv-ui-menu");nested.length&&event&&/^mouse/.test(event.type)&&this._startOpening(nested);this.activeMenu=item.parent();this._trigger("focus",event,{item:item})},_scrollIntoView:function(item){var borderTop,paddingTop,offset,scroll,elementHeight,itemHeight;if(this._hasScroll()){borderTop=parseFloat($.css(this.activeMenu[0],"borderTopWidth"))||0;paddingTop=parseFloat($.css(this.activeMenu[0],"paddingTop"))||0;offset=item.offset().top-this.activeMenu.offset().top-borderTop-paddingTop;scroll=this.activeMenu.scrollTop();elementHeight=this.activeMenu.height();itemHeight=item.outerHeight();0>offset?this.activeMenu.scrollTop(scroll+offset):offset+itemHeight>elementHeight&&this.activeMenu.scrollTop(scroll+offset-elementHeight+itemHeight)}},blur:function(event,fromFocus){fromFocus||clearTimeout(this.timer);if(this.active){this._removeClass(this.active.children(".cv-ui-menu-item-wrapper"),null,"cv-ui-state-active");this._trigger("blur",event,{item:this.active});this.active=null}},_startOpening:function(submenu){clearTimeout(this.timer);"true"===submenu.attr("aria-hidden")&&(this.timer=this._delay(function(){this._close();this._open(submenu)},this.delay))},_open:function(submenu){var position=$.extend({of:this.active},this.options.position);clearTimeout(this.timer);this.element.find(".cv-ui-menu").not(submenu.parents(".cv-ui-menu")).hide().attr("aria-hidden","true");submenu.show().removeAttr("aria-hidden").attr("aria-expanded","true").position(position)},collapseAll:function(event,all){clearTimeout(this.timer);this.timer=this._delay(function(){var currentMenu=all?this.element:$(event&&event.target).closest(this.element.find(".cv-ui-menu"));currentMenu.length||(currentMenu=this.element);this._close(currentMenu);this.blur(event);this._removeClass(currentMenu.find(".cv-ui-state-active"),null,"cv-ui-state-active");this.activeMenu=currentMenu},this.delay)},_close:function(startMenu){startMenu||(startMenu=this.active?this.active.parent():this.element);startMenu.find(".cv-ui-menu").hide().attr("aria-hidden","true").attr("aria-expanded","false")},_closeOnDocumentClick:function(event){return!$(event.target).closest(".cv-ui-menu").length},_isDivider:function(item){return!/[^\-\u2014\u2013\s]/.test(item.text())},collapse:function(event){var newItem=this.active&&this.active.parent().closest(".cv-ui-menu-item",this.element);if(newItem&&newItem.length){this._close();this.focus(event,newItem)}},expand:function(event){var newItem=this.active&&this.active.children(".cv-ui-menu ").find(this.options.items).first();if(newItem&&newItem.length){this._open(newItem.parent());this._delay(function(){this.focus(event,newItem)})}},next:function(event){this._move("next","first",event)},previous:function(event){this._move("prev","last",event)},isFirstItem:function(){return this.active&&!this.active.prevAll(".cv-ui-menu-item").length},isLastItem:function(){return this.active&&!this.active.nextAll(".cv-ui-menu-item").length},_move:function(direction,filter,event){var next;this.active&&(next="first"===direction||"last"===direction?this.active["first"===direction?"prevAll":"nextAll"](".cv-ui-menu-item").eq(-1):this.active[direction+"All"](".cv-ui-menu-item").eq(0));next&&next.length&&this.active||(next=this.activeMenu.find(this.options.items)[filter]());this.focus(event,next)},nextPage:function(event){var item,base,height;if(this.active){if(!this.isLastItem())if(this._hasScroll()){base=this.active.offset().top;height=this.element.height();this.active.nextAll(".cv-ui-menu-item").each(function(){item=$(this);return item.offset().top-base-height<0});this.focus(event,item)}else this.focus(event,this.activeMenu.find(this.options.items)[this.active?"last":"first"]())}else this.next(event)},previousPage:function(event){var item,base,height;if(this.active){if(!this.isFirstItem())if(this._hasScroll()){base=this.active.offset().top;height=this.element.height();this.active.prevAll(".cv-ui-menu-item").each(function(){item=$(this);return item.offset().top-base+height>0});this.focus(event,item)}else this.focus(event,this.activeMenu.find(this.options.items).first())}else this.next(event)},_hasScroll:function(){return this.element.outerHeight()<this.element.prop("scrollHeight")},select:function(event){this.active=this.active||$(event.target).closest(".cv-ui-menu-item");var ui={item:this.active};this.active.has(".cv-ui-menu").length||this.collapseAll(event,!0);this._trigger("select",event,ui)},_filterMenuItems:function(character){var escapedCharacter=character.replace(/[\-\[\]{}()*+?.,\\\^$|#\s]/g,"\\$&"),regex=new RegExp("^"+escapedCharacter,"i");return this.activeMenu.find(this.options.items).filter(".cv-ui-menu-item").filter(function(){return regex.test($.trim($(this).children(".cv-ui-menu-item-wrapper").text()))})}});$.widget("ui.autocomplete",{version:"1.12.1",defaultElement:"<input>",options:{appendTo:null,autoFocus:!1,delay:300,minLength:1,position:{my:"left top",at:"left bottom",collision:"none"},source:null,change:null,close:null,focus:null,open:null,response:null,search:null,select:null},requestIndex:0,pending:0,_create:function(){var suppressKeyPress,suppressKeyPressRepeat,suppressInput,nodeName=this.element[0].nodeName.toLowerCase(),isTextarea="textarea"===nodeName,isInput="input"===nodeName;this.isMultiLine=isTextarea||!isInput&&this._isContentEditable(this.element);this.valueMethod=this.element[isTextarea||isInput?"val":"text"];this.isNewMenu=!0;this._addClass("cv-ui-autocomplete-input");this.element.attr("autocomplete","off");this._on(this.element,{keydown:function(event){if(this.element.prop("readOnly")){suppressKeyPress=!0;suppressInput=!0;suppressKeyPressRepeat=!0}else{suppressKeyPress=!1;suppressInput=!1;suppressKeyPressRepeat=!1;var keyCode=$.ui.keyCode;switch(event.keyCode){case keyCode.PAGE_UP:suppressKeyPress=!0;this._move("previousPage",event);break;case keyCode.PAGE_DOWN:suppressKeyPress=!0;this._move("nextPage",event);break;case keyCode.UP:suppressKeyPress=!0;this._keyEvent("previous",event);break;case keyCode.DOWN:suppressKeyPress=!0;this._keyEvent("next",event);break;case keyCode.ENTER:if(this.menu.active){suppressKeyPress=!0;event.preventDefault();this.menu.select(event)}break;case keyCode.TAB:this.menu.active&&this.menu.select(event);break;case keyCode.ESCAPE:if(this.menu.element.is(":visible")){this.isMultiLine||this._value(this.term);this.close(event);event.preventDefault()}break;default:suppressKeyPressRepeat=!0;this._searchTimeout(event)}}},keypress:function(event){if(suppressKeyPress){suppressKeyPress=!1;(!this.isMultiLine||this.menu.element.is(":visible"))&&event.preventDefault()}else if(!suppressKeyPressRepeat){var keyCode=$.ui.keyCode;switch(event.keyCode){case keyCode.PAGE_UP:this._move("previousPage",event);break;case keyCode.PAGE_DOWN:this._move("nextPage",event);break;case keyCode.UP:this._keyEvent("previous",event);break;case keyCode.DOWN:this._keyEvent("next",event)}}},input:function(event){if(suppressInput){suppressInput=!1;event.preventDefault()}else this._searchTimeout(event)},focus:function(){this.selectedItem=null;this.previous=this._value()},blur:function(event){if(this.cancelBlur)delete this.cancelBlur;else{clearTimeout(this.searching);this.close(event);this._change(event)}}});this._initSource();this.menu=$("<ul>").appendTo(this._appendTo()).menu({role:null}).hide().menu("instance");this._addClass(this.menu.element,"cv-ui-autocomplete","cv-ui-front");
this._on(this.menu.element,{mousedown:function(event){event.preventDefault();this.cancelBlur=!0;this._delay(function(){delete this.cancelBlur;this.element[0]!==$.ui.safeActiveElement(this.document[0])&&this.element.trigger("focus")})},menufocus:function(event,ui){var label,item;if(this.isNewMenu){this.isNewMenu=!1;if(event.originalEvent&&/^mouse/.test(event.originalEvent.type)){this.menu.blur();this.document.one("mousemove",function(){$(event.target).trigger(event.originalEvent)});return}}item=ui.item.data("cv-ui-autocomplete-item");!1!==this._trigger("focus",event,{item:item})&&event.originalEvent&&/^key/.test(event.originalEvent.type)&&this._value(item.value);label=ui.item.attr("aria-label")||item.value;if(label&&$.trim(label).length){this.liveRegion.children().hide();$("<div>").text(label).appendTo(this.liveRegion)}},menuselect:function(event,ui){var item=ui.item.data("cv-ui-autocomplete-item"),previous=this.previous;if(this.element[0]!==$.ui.safeActiveElement(this.document[0])){this.element.trigger("focus");this.previous=previous;this._delay(function(){this.previous=previous;this.selectedItem=item})}!1!==this._trigger("select",event,{item:item})&&this._value(item.value);this.term=this._value();this.close(event);this.selectedItem=item}});this.liveRegion=$("<div>",{role:"status","aria-live":"assertive","aria-relevant":"additions"}).appendTo(this.document[0].body);this._addClass(this.liveRegion,null,"cv-ui-helper-hidden-accessible");this._on(this.window,{beforeunload:function(){this.element.removeAttr("autocomplete")}})},_destroy:function(){clearTimeout(this.searching);this.element.removeAttr("autocomplete");this.menu.element.remove();this.liveRegion.remove()},_setOption:function(key,value){this._super(key,value);"source"===key&&this._initSource();"appendTo"===key&&this.menu.element.appendTo(this._appendTo());"disabled"===key&&value&&this.xhr&&this.xhr.abort()},_isEventTargetInWidget:function(event){var menuElement=this.menu.element[0];return event.target===this.element[0]||event.target===menuElement||$.contains(menuElement,event.target)},_closeOnClickOutside:function(event){this._isEventTargetInWidget(event)||this.close()},_appendTo:function(){var element=this.options.appendTo;element&&(element=element.jquery||element.nodeType?$(element):this.document.find(element).eq(0));element&&element[0]||(element=this.element.closest(".cv-ui-front, dialog"));element.length||(element=this.document[0].body);return element},_initSource:function(){var array,url,that=this;if($.isArray(this.options.source)){array=this.options.source;this.source=function(request,response){response($.ui.autocomplete.filter(array,request.term))}}else if("string"==typeof this.options.source){url=this.options.source;this.source=function(request,response){that.xhr&&that.xhr.abort();that.xhr=$.ajax({url:url,data:request,dataType:"json",success:function(data){response(data)},error:function(){response([])}})}}else this.source=this.options.source},_searchTimeout:function(event){clearTimeout(this.searching);this.searching=this._delay(function(){var equalValues=this.term===this._value(),menuVisible=this.menu.element.is(":visible"),modifierKey=event.altKey||event.ctrlKey||event.metaKey||event.shiftKey;if(!equalValues||equalValues&&!menuVisible&&!modifierKey){this.selectedItem=null;this.search(null,event)}},this.options.delay)},search:function(value,event){value=null!=value?value:this._value();this.term=this._value();return value.length<this.options.minLength?this.close(event):this._trigger("search",event)!==!1?this._search(value):void 0},_search:function(value){this.pending++;this._addClass("cv-ui-autocomplete-loading");this.cancelSearch=!1;this.source({term:value},this._response())},_response:function(){var index=++this.requestIndex;return $.proxy(function(content){index===this.requestIndex&&this.__response(content);this.pending--;this.pending||this._removeClass("cv-ui-autocomplete-loading")},this)},__response:function(content){content&&(content=this._normalize(content));this._trigger("response",null,{content:content});if(!this.options.disabled&&content&&content.length&&!this.cancelSearch){this._suggest(content);this._trigger("open")}else this._close()},close:function(event){this.cancelSearch=!0;this._close(event)},_close:function(event){this._off(this.document,"mousedown");if(this.menu.element.is(":visible")){this.menu.element.hide();this.menu.blur();this.isNewMenu=!0;this._trigger("close",event)}},_change:function(event){this.previous!==this._value()&&this._trigger("change",event,{item:this.selectedItem})},_normalize:function(items){return items.length&&items[0].label&&items[0].value?items:$.map(items,function(item){return"string"==typeof item?{label:item,value:item}:$.extend({},item,{label:item.label||item.value,value:item.value||item.label})})},_suggest:function(items){var ul=this.menu.element.empty();this._renderMenu(ul,items);this.isNewMenu=!0;this.menu.refresh();ul.show();this._resizeMenu();ul.position($.extend({of:this.element},this.options.position));this.options.autoFocus&&this.menu.next();this._on(this.document,{mousedown:"_closeOnClickOutside"})},_resizeMenu:function(){var ul=this.menu.element;ul.outerWidth(Math.max(ul.width("").outerWidth()+1,this.element.outerWidth()))},_renderMenu:function(ul,items){var that=this;$.each(items,function(index,item){that._renderItemData(ul,item)})},_renderItemData:function(ul,item){return this._renderItem(ul,item).data("cv-ui-autocomplete-item",item)},_renderItem:function(ul,item){return $("<li>").append($("<div>").text(item.label)).appendTo(ul)},_move:function(direction,event){if(this.menu.element.is(":visible"))if(this.menu.isFirstItem()&&/^previous/.test(direction)||this.menu.isLastItem()&&/^next/.test(direction)){this.isMultiLine||this._value(this.term);this.menu.blur()}else this.menu[direction](event);else this.search(null,event)},widget:function(){return this.menu.element},_value:function(){return this.valueMethod.apply(this.element,arguments)},_keyEvent:function(keyEvent,event){if(!this.isMultiLine||this.menu.element.is(":visible")){this._move(keyEvent,event);event.preventDefault()}},_isContentEditable:function(element){if(!element.length)return!1;var editable=element.prop("contentEditable");return"inherit"===editable?this._isContentEditable(element.parent()):"true"===editable}});$.extend($.ui.autocomplete,{escapeRegex:function(value){return value.replace(/[\-\[\]{}()*+?.,\\\^$|#\s]/g,"\\$&")},filter:function(array,term){var matcher=new RegExp($.ui.autocomplete.escapeRegex(term),"i");return $.grep(array,function(value){return matcher.test(value.label||value.value||value)})}});$.widget("ui.autocomplete",$.ui.autocomplete,{options:{messages:{noResults:"No search results.",results:function(amount){return amount+(amount>1?" results are":" result is")+" available, use up and down arrow keys to navigate."}}},__response:function(content){var message;this._superApply(arguments);if(!this.options.disabled&&!this.cancelSearch){message=content&&content.length?this.options.messages.results(content.length):this.options.messages.noResults;this.liveRegion.children().hide();$("<div>").text(message).appendTo(this.liveRegion)}}});$.ui.autocomplete});!function(factory){"function"==typeof define&&define.amd?define("jquery_ui_touch_punch",["jquery","jquery_ui"],factory):factory(jQuery)}(function($){function fixTouch(touch){var winPageX=window.pageXOffset,winPageY=window.pageYOffset,x=touch.clientX,y=touch.clientY;if(0===touch.pageY&&Math.floor(y)>Math.floor(touch.pageY)||0===touch.pageX&&Math.floor(x)>Math.floor(touch.pageX)){x-=winPageX;y-=winPageY}else if(y<touch.pageY-winPageY||x<touch.pageX-winPageX){x=touch.pageX-winPageX;y=touch.pageY-winPageY}return{clientX:x,clientY:y}}function simulateMouseEvent(event,simulatedType){if(!(!pointerEnabled&&event.originalEvent.touches.length>1||pointerEnabled&&!event.isPrimary)){var touch=pointerEnabled?event.originalEvent:event.originalEvent.changedTouches[0],simulatedEvent=document.createEvent("MouseEvents"),coord=fixTouch(touch);$(touch.target).is("input")||$(touch.target).is("textarea")?event.stopPropagation():event.preventDefault();simulatedEvent.initMouseEvent(simulatedType,!0,!0,window,1,event.screenX||touch.screenX,event.screenY||touch.screenY,event.clientX||coord.clientX,event.clientY||coord.clientY,!1,!1,!1,!1,0,null);event.target.dispatchEvent(simulatedEvent)}}var pointerEnabled=window.navigator.pointerEnabled||window.navigator.msPointerEnabled;$.support.touch="ontouchend"in document||pointerEnabled;if($.support.touch&&$.ui.mouse){var touchHandled,mouseProto=$.ui.mouse.prototype,_mouseInit=mouseProto._mouseInit;mouseProto._touchStart=function(event){var self=this;if(!touchHandled&&(pointerEnabled||self._mouseCapture(event.originalEvent.changedTouches[0]))){touchHandled=!0;self._touchMoved=!1;simulateMouseEvent(event,"mouseover");simulateMouseEvent(event,"mousemove");simulateMouseEvent(event,"mousedown")}};mouseProto._touchMove=function(event){if(touchHandled){this._touchMoved=!0;simulateMouseEvent(event,"mousemove")}};mouseProto._touchEnd=function(event){if(touchHandled){simulateMouseEvent(event,"mouseup");simulateMouseEvent(event,"mouseout");this._touchMoved||simulateMouseEvent(event,"click");touchHandled=!1}};mouseProto._mouseInit=function(){var self=this;self.element.on({touchstart:$.proxy(self,"_touchStart"),touchmove:$.proxy(self,"_touchMove"),touchend:$.proxy(self,"_touchEnd"),pointerDown:$.proxy(self,"_touchStart"),pointerMove:$.proxy(self,"_touchMove"),pointerUp:$.proxy(self,"_touchEnd"),MSPointerDown:$.proxy(self,"_touchStart"),MSPointerMove:$.proxy(self,"_touchMove"),MSPointerUp:$.proxy(self,"_touchEnd")});_mouseInit.call(self)}}});define("views/virtual_assistant/components/container",["jquery","jquery_ui","bootstrap","underscore_loader","backbone","jquery_ui_touch_punch","settings"],function($,ui,Bootstrap,_,Backbone,$ui_touch_punch,Settings){var Container=Backbone.View.extend({el:"#cv-chat-container",events:{"click .minimize-va":"minimizeMaximize","click .minimized-mobile-content":"minimizeMaximize"},minimized:!1,processingMinimizeMaximize:!1,contentWidth:"480px",contentHeight:"445px",initialize:function(options){if(Settings.persistenceEnabled===!0){this.contentWidth=localStorage.getItem(Settings.businessName+"-cvVaContentWidth");(void 0===this.contentWidth||null===this.contentWidth||"undefined"===this.contentWidth||"null"===this.contentWidth||""===this.contentWidth)&&(Settings.shrunkenUI===!0?this.contentWidth="350px":this.contentWidth="480px");this.contentHeight=localStorage.getItem(Settings.businessName+"-cvVaContentHeight");(void 0===this.contentHeight||null===this.contentHeight||"undefined"===this.contentHeight||"null"===this.contentHeight||""===this.contentHeight)&&(Settings.shrunkenUI===!0?this.contentHeight="560px":this.contentHeight="550px")}void 0!==window.cvVaMinimized&&(this.minimized=window.cvVaMinimized);Backbone.View.prototype.initialize.call(this,options);var self=this;if(window.CVMobile===!1){this.$(".modal-dialog").css({position:"absolute",top:"0",right:"0",bottom:"0",left:"0",margin:"0px",width:"100%"});null===localStorage.getItem(Settings.businessName+"-cvVaModel")&&this.$("#cv-chat-content").css({position:Settings.anchoredContainer.position,top:Settings.anchoredContainer.top,bottom:Settings.anchoredContainer.bottom,left:Settings.anchoredContainer.left,right:Settings.anchoredContainer.right});if(Settings.iframeEvents===!1&&Settings.anchoredContainer.axisX===!0){Settings.iframeEvents===!1&&$(window).resize(function(){self.$("#cv-chat-content").css({left:"auto",top:"auto"})});self.$("#cv-chat-content").draggable({containment:"parent",axis:"x",handle:"#cv-chat-header, .cv-chat-footer",scroll:!1,start:function(){self.$("#cv-chat-content").css({top:"auto"})},drag:function(event,ui){ui.position.top="auto";self.$("#cv-chat-content").css({top:"auto"})},stop:function(){self.$("#cv-chat-content").css({top:"auto"});window.CVSaveAttributes()}})}else if(window.cvVaMinimized===!0){self.$("#cv-chat-content").css({position:"absolute",top:"auto",bottom:"0"}).draggable({axis:"x",disabled:Settings.desktopAnchoredMinimizedContainer.disabled,containment:"parent",scroll:!1,handle:"#cv-chat-header, .cv-chat-footer",stop:function(){window.CVSaveAttributes()}});Settings.desktopAnchoredMinimizedContainer.disabled===!0&&self.$("#cv-chat-content").css({left:Settings.desktopAnchoredMinimizedContainer.left,right:Settings.desktopAnchoredMinimizedContainer.right})}else self.$("#cv-chat-content").draggable({containment:"parent",scroll:!1,handle:"#cv-chat-header, .cv-chat-footer",stop:function(){window.CVSaveAttributes()},drag:function(event,ui){if($(window).width()-($(" #cv-chat-content").offset().left+$(".cv-va-bootstrap #cv-chat-content").outerWidth())<335){$(".cv-va-bootstrap #cv-lp-secure-form-container").removeClass("cv-lp-secure-form-right-position");$(".cv-va-bootstrap #cv-lp-secure-form-panel").removeClass("cv-lp-secure-form-panel-right-position");$(".cv-va-bootstrap #cv-lp-secure-form-header a").removeClass("cv-lp-secure-form-header-icon").find("i").removeClass("fa-arrow-circle-left").addClass("fa-arrow-circle-right")}else if($(".cv-va-bootstrap #cv-chat-content").offset().left<335){$(".cv-va-bootstrap #cv-lp-secure-form-container").addClass("cv-lp-secure-form-right-position");$(".cv-va-bootstrap #cv-lp-secure-form-panel").addClass("cv-lp-secure-form-panel-right-position");$(".cv-va-bootstrap #cv-lp-secure-form-header a").addClass("cv-lp-secure-form-header-icon").find("i").removeClass("fa-arrow-circle-right").addClass("fa-arrow-circle-left")}}})}this.$("#cv-chat-answer-history").on("mousewheel DOMMouseScroll",function(event){var eventOriginal=event.originalEvent,delta=eventOriginal.wheelDelta||-eventOriginal.detail;this.scrollTop+=30*(0>delta?1:-1);event.preventDefault()});$(".cv-va-bootstrap .close.container-control.mobile-close").click(function(){$("#cv-chat-container").modal({show:!1,keyboard:!0,backdrop:!1});if(window.CVMobile===!0){$("body > *").not("body > .cv-va-bootstrap").removeClass("cv-va-hide-external-engagements");$("meta[name=viewport]").remove();void 0!==window.originalViewport&&$("head").append('<meta name="viewport" content="'+window.originalViewport+'"/>')}})},minimizeMaximize:function(){var cvChatContentCSS;if(window.livechatTriggered!==!0){var _this=this;if(window.CVMobile===!1){_this.$("#cv-chat-content").css({position:"absolute",top:"auto",bottom:"0"}).draggable({axis:Settings.desktopAnchoredMinimizedContainer.axis,disabled:Settings.desktopAnchoredMinimizedContainer.disabled});Settings.desktopAnchoredMinimizedContainer.disabled===!0&&_this.$("#cv-chat-content").css({left:Settings.desktopAnchoredMinimizedContainer.left,right:Settings.desktopAnchoredMinimizedContainer.right})}if(this.processingMinimizeMaximize===!1&&null==window.CVVA.iframeMode){this.processingMinimizeMaximize=!0;if(this.minimized===!1){window.cvMaximized=!0;$(".cv-va-bootstrap #cv-lp-secure-form-panel").collapse("hide");$(".cv-va-bootstrap #cv-faq-panel").collapse("hide");$(".cv-va-bootstrap .cv-overlays").hide();var cvChatHeaderCSS={height:"100%","border-bottom-color":Settings.modalHeader.backgroundColor,"border-radius":parseInt(Settings.modalContent.borderRadius,10)-1+"px"};"default"!==Settings.modalContent.minimizeBorderRadius&&window.CVMobile===!1&&(cvChatHeaderCSS["border-radius"]=parseInt(Settings.modalContent.minimizeBorderRadius,10)-1+"px");if(window.CVMobile===!0){clearInterval(window.CVVA.contentMobileInterval);$(".cv-va-bootstrap.cv-mobile-floating").addClass("hidden");window.CVSaveAttributes();$("body > *").not("body > .cv-va-bootstrap").removeClass("cv-va-hide-external-engagements");$("meta[name=viewport]").remove();void 0!==window.originalViewport&&$("head").append('<meta name="viewport" content="'+window.originalViewport+'"/>');$(".cv-va-bootstrap #cv-chat-content").addClass("minimized-mobile-content").css({top:Settings.minimizedContentMobile.top,bottom:Settings.minimizedContentMobile.bottom,left:Settings.minimizedContentMobile.left,right:Settings.minimizedContentMobile.right,"border-radius":Settings.minimizedContentMobile.borderRadius,border:Settings.minimizedContentMobile.border||"none","box-shadow":Settings.minimizedContentMobile.enabledShadow!==!0?Settings.modalContent.boxShadow:Settings.minimizedContentMobile.boxShadow,"-webkit-box-shadow":Settings.minimizedContentMobile.enabledShadow!==!0?Settings.modalContent.boxShadow:Settings.minimizedContentMobile.boxShadow,"-moz-box-shadow":Settings.minimizedContentMobile.enabledShadow!==!0?Settings.modalContent.boxShadow:Settings.minimizedContentMobile.boxShadow});Settings.minimizedContentMobile.minimizedButtonsOutline===!1&&$(".cv-va-bootstrap #cv-chat-content #cv-chat-header").addClass("cv-no-outline");cvChatContentCSS={width:Settings.minimizedContentMobile.width,height:Settings.minimizedContentMobile.height,"min-height":Settings.minimizedContentMobile.height,"max-height":Settings.minimizedContentMobile.height};this.$(".minimize-va i").toggleClass(Settings.minimizedContentMobile.fontAwesome).toggleClass(Settings.modalHeader.btnIcons.minimize).css("margin-bottom","4px");Settings.minimizedContentMobile.flipMinimizedIcon===!0&&this.$(".minimize-va i").addClass("fa-flip-horizontal");Settings.minimizedContentMobile.absolutePositionIcon&&this.$el.find(".minimize-va i").addClass(Settings.minimizedContentMobile.absolutePositionIcon);this.$(".minimize-va").toggleClass("minimize-va").toggleClass("minimize-mobile-icon");this.$("#cv-close-btn").hide();Settings.minimizedContentMobile.addShim===!0&&$(".cv-va-bootstrap #cv-chat-content").addClass("minimize-shim");cvChatHeaderCSS["border-radius"]=Settings.minimizedContentMobile.enabledHeaderBorderRadius!==!0?Settings.minimizedContentMobile.borderRadius:Settings.minimizedContentMobile.headerBorderRadius;this.$("#cv-btn-group").css("margin-right","auto");this.$("#cv-lc-chat-logo").hide();this.$(".cv-chat-title").hide();this.$("#cv-minimize-btn i").css("font-size",Settings.minimizedContentMobile.iconFontSize);this.$("#cv-chat-header").append('<div id="cv-va-minimize-mobile-title">'+Settings.minimizedContentMobile.text+"</div>").addClass("cv-minimize-chat-header");Settings.minimizedContentMobile.absolutePositionText&&this.$el.find("#cv-va-minimize-mobile-title").addClass(Settings.minimizedContentMobile.absolutePositionText);Settings.slideLauncherOnMobile.enabled===!0&&setInterval(function(){$(Settings.slideLauncherOnMobile.selector).is(":visible")?$(Settings.slideLauncherOnMobile.selector).offset().top>=$("#lozengeTagline").offset().top?$(".cv-va-bootstrap .minimized-mobile-content").css({bottom:$(Settings.slideLauncherOnMobile.selector).outerHeight()+200+"px",top:"auto"}):$(".cv-va-bootstrap .minimized-mobile-content").css({bottom:$(Settings.slideLauncherOnMobile.selector).outerHeight()+40+"px",top:"auto"}):$(".cv-va-bootstrap .minimized-mobile-content").css({bottom:Settings.minimizedContentMobile.bottom,top:"auto"})},0)}window.CVMobile===!1&&Settings.fullScreen.enabled===!0&&clearInterval(window.CVVA.fullscreenInterval);this.$(".cv-ui-resizable-handle").hide();this.$(".cv-va-tabs-container, #cv-faq-container").hide();_this.contentWidth=_this.$("#cv-chat-content").outerWidth();_this.contentHeight=_this.$("#cv-chat-content").outerHeight();if(Settings.vaShim===!0&&window.CVMobile===!1){this.$("#cv-chat-content").toggleClass("front-shim");this.$("#cv-chat-content").toggleClass("back-shim")}window.CVMobile===!1&&this.$(".minimize-va i").toggleClass(Settings.modalHeader.btnIcons.maximize).toggleClass(Settings.modalHeader.btnIcons.minimize);this.$(".cv-print-icon").hide();this.$("#cv-chat-img-avatar").hide();Settings.modalHeader.logo.enabled===!0&&this.$(".cv-chat-logo, .cv-chat-extra-logo").fadeOut(0,function(){Settings.modalHeader.title.disabled===!0&&_this.$(".cv-chat-title").show()});if(Settings.modalHeader.minimizedLogo.enabled===!0&&window.CVMobile===!1){this.$(".cv-chat-logo, .cv-chat-extra-logo").fadeOut(0,function(){Settings.modalHeader.title.disabled===!0&&_this.$(".cv-chat-title").hide();_this.$(".cv-chat-minimized-logo").show();_this.$(".minimize-va").attr("aria-label",Settings.ariaLabel.maximizeBtn)});this.$("#cv-lc-chat-logo").parent().find(".minimize-va").attr("aria-label",Settings.ariaLabel.maximizeBtn)}$("#cv-chat-body, .cv-chat-footer").is(":hidden")?this.$("#cv-chat-body, .cv-chat-footer").hide():this.$("#cv-chat-body, .cv-chat-footer").toggle();Settings.avatar.enabled===!0&&this.$("#cv-chat-header").css("padding-top","15px");window.CVMobile===!1;if(Settings.shrunkenUI===!1&&window.CVMobile===!1){this.$(".container-control").css({top:"20px"});cvChatContentCSS={"min-height":"60px","max-height":"60px",height:"60px",width:Settings.minimizedContainerWidth}}else if(Settings.shrunkenUI===!0&&window.CVMobile===!1){Settings.avatar.enabled===!1&&this.$(".container-control").css({top:"16px"});cvChatContentCSS={"min-height":Settings.modalHeader.height,"max-height":Settings.modalHeader.height,height:Settings.modalHeader.height,width:Settings.minimizedContainerWidth};if("default"!==Settings.modalContent.minimizeHeight){cvChatContentCSS["min-height"]=Settings.modalContent.minimizeHeight;cvChatContentCSS["max-height"]=Settings.modalContent.minimizeHeight;cvChatContentCSS.height=Settings.modalContent.minimizeHeight}"default"!==Settings.modalContent.minimizeBorderRadius&&(cvChatContentCSS["border-radius"]=Settings.modalContent.minimizeBorderRadius);if(Settings.modalContent.minimizeCloseBtnHide){this.$("#cv-close-btn").hide();this.$("#cv-btn-group").css("margin","auto");this.$("#cv-minimize-btn i").css("font-size",Settings.modalContent.minimizeMaximizeIconFontSize);cvChatHeaderCSS.padding="0px"}}_this.$("#cv-chat-header").css(cvChatHeaderCSS);this.$("#cv-chat-content").animate(cvChatContentCSS,0,function(){Settings.persistenceEnabled!==!0||window.forcesessionclose!==!1&&void 0!==window.forcesessionclose||window.CVSaveAttributes();parent.postMessage("minimize","*");_this.minimized=!0;window.cvVaMinimized=_this.minimized;window.cvCrossStorage.onConnect().then(function(){return window.cvCrossStorage.set(Settings.businessName+"-cvVaMinimized",window.cvVaMinimized)});localStorage.setItem(Settings.businessName+"-cvVaMinimized",window.cvVaMinimized);window.cvCrossStorage.onConnect().then(function(){return window.cvCrossStorage.set(Settings.businessName+"-cvVaContentWidth",_this.contentWidth)});localStorage.setItem(Settings.businessName+"-cvVaContentWidth",_this.contentWidth);window.cvCrossStorage.onConnect().then(function(){return window.cvCrossStorage.set(Settings.businessName+"-cvVaContentHeight",_this.contentHeight)});localStorage.setItem(Settings.businessName+"-cvVaContentHeight",_this.contentHeight);_this.processingMinimizeMaximize=!1})}else if(this.minimized===!0){var cvChatHeaderCSS={height:Settings.modalHeader.height,"border-bottom-color":"#e5e5e5","border-top-left-radius":parseInt(Settings.modalContent.borderRadius,10)-1+"px","border-top-right-radius":parseInt(Settings.modalContent.borderRadius,10)-1+"px","border-bottom-left-radius":"0px","border-bottom-right-radius":"0px"};if(Settings.modalContent.minimizeCloseBtnHide){this.$("#cv-close-btn").show();this.$("#cv-btn-group").css("margin",Settings.modalHeader.btnGroupMargin);this.$("#cv-minimize-btn i").css("font-size",Settings.modalHeader.iconFontSize);cvChatHeaderCSS.padding=Settings.modalHeader.padding}$(".cv-va-bootstrap .cv-overlays").show();if(window.CVMobile===!0){window.CVVA.contentMobileCallInterval();window.CVVA.mobileMetaTag();clearInterval(window.CVVA.hideMobileLauncherInterval);$(".cv-va-bootstrap.cv-mobile-floating").removeClass("hidden");window.CVSaveAttributes();$(".cv-va-bootstrap #cv-chat-content").removeClass("minimized-mobile-content");$(".cv-va-bootstrap #cv-chat-header").removeClass("cv-minimize-chat-header");cvChatHeaderCSS.height=Settings.modalHeader.mobile.height;this.$("#cv-close-btn").show();this.$("#cv-chat-content").removeClass("minimize-shim").css({top:"0",bottom:"0",left:"0",right:"0","border-radius":"0px",border:"1px solid rgba(0, 0, 0, 0.2)"});this.$("#cv-btn-group").css("margin-right","0");this.$("#cv-lc-chat-logo").show();this.$(".cv-chat-title").show();this.$("#cv-va-minimize-mobile-title").remove();this.$(".minimize-mobile-icon").toggleClass("minimize-mobile-icon").toggleClass("minimize-va");this.$("#cv-minimize-btn i").css("font-size",Settings.modalHeader.mobileIconFontSize);cvChatHeaderCSS["border-top-left-radius"]="0px";cvChatHeaderCSS["border-top-right-radius"]="0px";Settings.minimizedContentMobile.minimizedButtonsOutline===!1&&$(".cv-va-bootstrap #cv-chat-content #cv-chat-header").removeClass("cv-no-outline");Settings.minimizedContentMobile.flipMinimizedIcon===!0&&this.$el.find(".minimize-va i").removeClass("fa-flip-horizontal");Settings.minimizedContentMobile.absolutePositionIcon&&this.$el.find(".minimize-va i").removeClass(Settings.minimizedContentMobile.absolutePositionIcon)}window.CVMobile===!1&&Settings.fullScreen.enabled===!0&&window.CVVA.fullscreen();parent.postMessage("maximize","*");if(window.CVMobile===!1&&window.CVVA.popupMode===!1){$(".cv-va-bootstrap #cv-lp-secure-form-container").show();$("#cv-chat-content").draggable({axis:!1,disabled:!1})}var minHeight,maxHeight;if(window.CVMobile===!1&&void 0!==window.cvVaCollectionLength&&window.cvVaCollectionLength>1&&void 0===window.resizableAttached&&Settings.anchoredContainer.enabled===!0){window.resizableAttached=!0;window.CVVA.resizable()}if(Settings.shrunkenUI===!0){minHeight="560px";maxHeight="600px"}else{minHeight="445px";maxHeight="600px"}cvChatContentCSS={"min-height":minHeight,"max-height":maxHeight,width:_this.contentWidth,height:_this.contentHeight};if(window.CVMobile===!0){cvChatContentCSS.height=minHeight;cvChatContentCSS["box-shadow"]="none";cvChatContentCSS.width="100%"}"default"!==Settings.modalContent.minimizeBorderRadius&&window.CVMobile===!1&&(cvChatContentCSS["border-radius"]=Settings.modalContent.borderRadius);if(Settings.iframeEvents===!1&&$(window).width()-($(".cv-va-bootstrap #cv-chat-content").offset().left+$(".cv-va-bootstrap #cv-chat-content").outerWidth())<282){$(".cv-va-bootstrap #cv-chat-content").css({left:"auto"});$("#cv-chat-content").css({right:"0"})}this.$("#cv-chat-content").animate(cvChatContentCSS,0,function(){if(window.loadFromStorage===!0&&void 0===window.cvMaximized){window.loadFromStorage=!1;setTimeout(function(){$(".cv-va-bootstrap").show();$(".cv-va-bootstrap #cv-chat-answer-history").length&&_this.$("#cv-chat-answer-history").scrollTop(_this.$("#cv-chat-answer-history")[0].scrollHeight)},500)}Settings.modalHeader.logo.enabled===!0&&_this.$(".cv-chat-title, .cv-chat-minimized-logo").fadeOut(0,function(){_this.$(".cv-chat-logo, .cv-chat-extra-logo").show();_this.$(".minimize-va").attr("aria-label",Settings.ariaLabel.minimizedBtn);Settings.modalHeader.title.disabled===!1&&_this.$(".cv-chat-title").show()});_this.$("#cv-chat-img-avatar").show();_this.$("#cv-chat-body, .cv-chat-footer").toggle();_this.$("#cv-chat-header").css(cvChatHeaderCSS);window.CVMobile===!1||window.CVMobile===!0;var topContainerControl="0px";Settings.avatar.enabled===!0&&(topContainerControl="-8px");_this.$(".container-control").animate({top:topContainerControl},0,function(){window.cvCrossStorage.onConnect().then(function(){return window.cvCrossStorage.set(Settings.businessName+"-cvVaMinimized",window.cvVaMinimized)});localStorage.setItem(Settings.businessName+"-cvVaMinimized",window.cvVaMinimized);window.cvCrossStorage.onConnect().then(function(){return window.cvCrossStorage.set(Settings.businessName+"-cvVaContentWidth",_this.contentWidth)});localStorage.setItem(Settings.businessName+"-cvVaContentWidth",_this.contentWidth);window.cvCrossStorage.onConnect().then(function(){return window.cvCrossStorage.set(Settings.businessName+"-cvVaContentHeight",_this.contentHeight)});localStorage.setItem(Settings.businessName+"-cvVaContentHeight",_this.contentHeight);_this.$(".cv-ui-resizable-handle").show();_this.$(".cv-va-tabs-container, #cv-faq-container").show();if(Settings.persistenceEnabled===!0&&(window.forcesessionclose===!1||void 0===window.forcesessionclose)){window.cvCrossStorage.onConnect().then(function(){return window.cvCrossStorage.set(Settings.businessName+"-cvVaCollectionLength",window.cvVaCollectionLength)}).then(function(){return window.cvCrossStorage.set(Settings.businessName+"-cvVaModel",JSON.stringify(window.cvVaModel))}).then(function(){return window.cvCrossStorage.set(Settings.businessName+"-cvVaBootstrapState",JSON.stringify($("div.cv-va-bootstrap:first").html()))}).then(function(){return window.cvCrossStorage.set(Settings.businessName+"-cvVaStyles",JSON.stringify($("#cv-va-styles").html()))});localStorage.setItem(Settings.businessName+"-cvVaCollectionLength",window.cvVaCollectionLength);localStorage.setItem(Settings.businessName+"-cvVaModel",JSON.stringify(window.cvVaModel));localStorage.setItem(Settings.businessName+"-cvVaBootstrapState",JSON.stringify($("div.cv-va-bootstrap:first").html()));localStorage.setItem(Settings.businessName+"-cvVaStyles",JSON.stringify($("#cv-va-styles").html()))}_this.minimized=!1;window.cvVaMinimized=_this.minimized;_this.processingMinimizeMaximize=!1});if(Settings.vaShim===!0&&window.CVMobile===!1){_this.$("#cv-chat-content").toggleClass("front-shim");_this.$("#cv-chat-content").toggleClass("back-shim")}window.CVMobile===!1?_this.$(".minimize-va i").toggleClass(Settings.modalHeader.btnIcons.maximize).toggleClass(Settings.modalHeader.btnIcons.minimize):_this.$(".minimize-va i").toggleClass(Settings.minimizedContentMobile.fontAwesome).toggleClass(Settings.modalHeader.btnIcons.minimize).css("margin-bottom","0px");_this.$(".cv-chat-transaction-panel").is(":visible")&&_this.$(".cv-print-icon").show()})}}else if(window.CVVA.iframeMode===!0&&(this.minimized===!1||window.cvVaMinimized===!1)){window.cvVaMinimized=!0;parent.postMessage("minimize","*");window.cvCrossStorage.onConnect().then(function(){return window.cvCrossStorage.set(Settings.businessName+"-cvVaMinimized",window.cvVaMinimized)})}}}});return Container});define("views/virtual_assistant/components/ask_form",["jquery","underscore_loader","backbone","settings"],function($,_,Backbone,Settings){var AskForm=Backbone.View.extend({prevent_empty_submissions:!0,el:"#cv-chat-form",input_el:"#cv-chat-user-entry",events:{submit:"handleSubmit"},initialize:function(args){var that=this;Backbone.View.prototype.initialize.call(that,args);that.input_el=args.input_el||that.input_el;that.$input_el=$(that.input_el);that.$submit_btn=that.getSubmitButton();that.prevent_empty_submissions="boolean"==typeof args.prevent_empty_submissions?args.prevent_empty_submissions:!0;that.prevent_empty_submissions&&that.$input_el.bind("input keyup",function(){that.setButtonState();if(Settings.proactiveEndOnLastKeystroke===!0){clearInterval(window.proactiveEndSessionInterval);var proactiveEndSessionWaitTime=1e3*parseInt(that.model.get("autosubmitwaittime"))||Settings.proactiveEndSessionWaitTime||1e4;window.proactiveEndSessionTriggered===!0&&window.cvVaCollectionLength>0&&(window.proactiveEndSessionInterval=setInterval(function(){that.model.askQuestion(Settings.proactiveEndSessionCommand);clearInterval(window.proactiveEndSessionInterval)},proactiveEndSessionWaitTime))}});if(window.CVMobile===!0){window.CVVA.contentMobileCallInterval=function(){window.CVVA.contentMobileInterval=setInterval(function(){(window.cvVaMinimized===!1||void 0===window.cvVaMinimized)&&$(".cv-va-bootstrap #cv-chat-content").css({"min-height":$(window).outerHeight()+"px","max-height":$(window).outerHeight()+"px",height:$(window).outerHeight()+"px"})},0)};window.CVVA.contentMobileCallInterval()}if(window.CVMobile===!1&&Settings.fullScreen.enabled===!0){setInterval(function(){$(".cv-ui-resizable-handle").remove()},0);window.CVVA.fullscreen=function(){window.CVVA.fullscreenInterval=setInterval(function(){$(".cv-va-bootstrap #cv-chat-content").css({"min-width":$(window).outerWidth()+"px","max-width":$(window).outerWidth()+"px",width:$(window).outerWidth()+"px","min-height":$(window).outerHeight()+"px",
"max-height":$(window).outerHeight()+"px",height:$(window).outerHeight()+"px",border:"none"});$(".cv-va-bootstrap #cv-chat-body, .cv-va-bootstrap .cv-chat-history, .cv-va-bootstrap .cv-live-chat-info, .cv-va-bootstrap .cv-live-chat-user, .cv-va-bootstrap .cv-ui-autocomplete, .cv-va-bootstrap .cv-live-chat-agent, .cv-va-bootstrap .cv-live-chat-user, #cv-eocs-overlay, .cv-va-bootstrap .cv-chat-transaction-title").addClass("font-size-vw-unit")},0)};window.CVVA.fullscreen();$(".cv-va-bootstrap #cv-compress-expand-btn").on("click",function(){if($(this).find("i").hasClass("fa-compress")){clearInterval(window.CVVA.fullscreenInterval);$(this).find("i").removeClass("fa-compress").addClass("fa-expand");$(".cv-va-bootstrap #cv-chat-content").css({width:"350px","min-width":"350px","max-width":"350px","min-height":"560px","min-height":"560px",height:"560px","border-radius":"6px"});$(".cv-va-bootstrap #cv-chat-header").css("border-radius","5px 5px 0 0");$(".cv-va-bootstrap #cv-chat-body, .cv-va-bootstrap .cv-chat-history, .cv-va-bootstrap .cv-live-chat-info, .cv-va-bootstrap .cv-live-chat-user, .cv-va-bootstrap .cv-ui-autocomplete, .cv-va-bootstrap .cv-live-chat-agent, .cv-va-bootstrap .cv-live-chat-user, #cv-eocs-overlay, .cv-va-bootstrap .cv-chat-transaction-title").removeClass("font-size-vw-unit")}else{window.CVVA.fullscreen();$(this).find("i").removeClass("fa-expand").addClass("fa-compress");$(".cv-va-bootstrap #cv-chat-content").css({left:"auto",right:"0",top:"0"})}})}void 0===window.placeholderSuggestions&&(window.placeholderSuggestions=Settings.placeholderSuggestions);if(_.isArray(window.placeholderSuggestions)&&window.placeholderSuggestions.length){var generateSuggestionIndex=function(){return Math.floor(Math.random()*window.placeholderSuggestions.length)+1-1};window.placeholderRotating=!1;window.placeHolderRotationCount=0;var placeHolderRotation=function(){if((0===Settings.placeHolderRotationTicks||window.placeHolderRotationCount<=Settings.placeHolderRotationTicks)&&window.placeholderRotating===!1){window.placeholderRotating=!0;window.suggestionIndex=generateSuggestionIndex();for(;window.previousSuggestionIndex==window.suggestionIndex&&1!==window.placeholderSuggestions.length;)window.suggestionIndex=generateSuggestionIndex();var suggestion=window.placeholderSuggestions[window.suggestionIndex];window.previousSuggestionIndex=window.suggestionIndex;var placeholderTimeout,placeholderSuggestionLength=suggestion.length,placeholderSuggestionCharPosition=0,initialChar=0;that.$input_el.attr("placeholder","|");!function typePlaceholderSuggestion(){placeholderTimeout=setTimeout(function(){if(!that.$input_el.is(":focus")||window.restartPlaceholderRotationTimeout){placeholderSuggestionCharPosition++;var typeplaceholderSuggestionChar=suggestion.substring(initialChar,placeholderSuggestionCharPosition);that.$input_el.attr("placeholder",typeplaceholderSuggestionChar+"|");placeholderSuggestionCharPosition>37&&initialChar++;typePlaceholderSuggestion();if(placeholderSuggestionCharPosition==placeholderSuggestionLength){that.$input_el.length&&that.$input_el.attr("placeholder",that.$input_el.attr("placeholder").slice(0,-1));clearTimeout(placeholderTimeout);if(!that.$input_el.is(":focus")||window.restartPlaceholderRotationTimeout)window.placeholderRotating=!1;else{window.placeholderRotating=!0;that.$input_el.attr("placeholder","")}}}else{window.placeholderRotating=!0;that.$input_el.attr("placeholder","")}},Settings.placeholderTimeoutMilliseconds)}();if(Settings.placeholderSuggestionOptions.disabled===!0&&window.cvVaCollectionLength>Settings.placeholderSuggestionOptions.collectionLength){clearTimeout(placeholderTimeout);that.$input_el.attr("placeholder","")}}window.placeHolderRotationCount++};window.setInterval(placeHolderRotation,3e3);window.placeHolderRotationReset=function(){clearTimeout(window.restartPlaceholderRotation);window.restartPlaceholderRotation=setTimeout(function(){window.restartPlaceholderRotationTimeout=!0;window.placeholderRotating=!1},Settings.placeHolderRotationResetMilliseconds);window.restartPlaceholderRotationTimeout=!1;window.placeholderRotating=!0;that.$input_el.attr("placeholder","")};that.$input_el.click(function(){window.placeHolderRotationReset()}).focus(function(){window.placeHolderRotationReset()}).blur(function(){window.setTimeout(function(){},100);window.placeholderRotating=!1})}else window.placeHolderRotationReset=function(){}},getSubmitButton:function(){var that=this,$btn=this.$el.find("button:not(#cv-live-chat-submit)");$btn.length||($btn=this.$el.find("input[type='submit']"));$btn.length||($btn=this.$el.find("input[type='image']"));$btn.click(function(evt){that.$input_el.prop("disabled",!0);evt.preventDefault();that.handleSubmit(evt);Settings.inputTextArea===!0&&that.$input_el.css("height",Settings.submitBtn.height)});return $btn},setButtonState:function(){var that=this,field_val=that.$input_el.val();if($.trim(field_val).length>0){that.$el.parent().find("#cv-maxlength-counter").show();Settings.input.counter.enable===!0&&setInterval(function(){var length=$("#cv-chat-user-entry").val().length;that.$el.parent().find("#cv-maxlength-counter").text(length+"/"+Settings.input.maxlength)},0);that.$submit_btn.removeClass("disabled").removeAttr("disabled");void 0==Settings.submitBtn.border?$(".cv-va-bootstrap #cv-chat-submit.btn, .cv-va-bootstrap #cv-live-chat-submit.btn").css({"background-color":Settings.submitBtn.backgroundColor,"border-color":Settings.submitBtn.backgroundColor,color:Settings.submitBtn.color}):$(".cv-va-bootstrap #cv-chat-submit.btn, .cv-va-bootstrap #cv-live-chat-submit.btn").css({"background-color":Settings.submitBtn.backgroundColor,border:Settings.submitBtn.border,"border-width":Settings.submitBtn.borderWidth,color:Settings.submitBtn.color});$(".cv-va-bootstrap .cv-button-text-image").show();$(".cv-va-bootstrap .cv-disabled-button-text-image").hide()}else{that.$el.parent().find("#cv-maxlength-counter").hide();that.$submit_btn.addClass("disabled").prop("disabled","true");void 0==Settings.submitBtn.border?$(".cv-va-bootstrap #cv-chat-submit.disabled, .cv-va-bootstrap #cv-live-chat-submit.disabled").css({"background-color":Settings.submitBtn.disabled.backgroundColor,"border-color":Settings.submitBtn.disabled.backgroundColor,color:Settings.submitBtn.disabled.color}):$(".cv-va-bootstrap #cv-chat-submit.disabled, .cv-va-bootstrap #cv-live-chat-submit.disabled").css({"background-color":Settings.submitBtn.disabled.backgroundColor,border:Settings.submitBtn.border,"border-width":Settings.submitBtn.borderWidth,color:Settings.submitBtn.disabled.color});$(".cv-va-bootstrap .cv-button-text-image").hide();$(".cv-va-bootstrap .cv-disabled-button-text-image").show()}},handleSubmit:function(evt){if($("#cv-chat-answer-history").is(":visible")){evt.preventDefault();evt.stopPropagation();$(this).unbind("submit");var that=this,question=that.$input_el.val()||"";$(".cv-va-bootstrap .cv-ui-autocomplete").hide();if(!that.$input_el.is(":visible")){var chatHistory=that.$el.parent().parent().children("#cv-chat-body").children("#cv-chat-answer-history");chatHistory.scrollTop(chatHistory[0].scrollHeight)}that.$input_el.show();that.$input_el.val("").focus();that.prevent_empty_submissions&&that.setButtonState();if(that.prevent_empty_submissions&!$.trim(question).length)return!1;this.model.askQuestion(question)}}});return AskForm});define("views/virtual_assistant/components/base",["jquery","underscore_loader","backbone"],function($,_,Backbone){var Base=Backbone.View.extend({bindEvent:"change",initialize:function(opts){Backbone.View.prototype.initialize.call(this,opts);"string"==typeof opts.bindEvent&&(this.bindEvent=opts.bindEvent);if(!this.model)throw new Error("Views that extend 'base' (js_source/views/virtual_assistant/components/base) must define a model instance");$.trim(this.bindEvent).length&&this.model.on(this.bindEvent,this.render,this)}});return Base});define("views/virtual_assistant/components/answer",["jquery","underscore_loader","backbone","views/virtual_assistant/components/base"],function($,_,Backbone,Base){var Answer=Base.extend({bindEvent:"change:botanswer",el:"#cv-chat-answer-history",navwin:null,use_removestyles:!0,initialize:function(args){Base.prototype.initialize.call(this,args);this.use_removestyles="boolean"==typeof args.use_removestyles?args.use_removestyles:!0},removeStyles:function($transaction){$transaction.find("[style]").removeAttr("style");$transaction.find("font").each(function(){$(this).replaceWith(this.childNodes)});return $transaction},render:function(model){this.$el.html(model.get("botanswer"));this.use_removestyles&&this.removeStyles(this.$el);var connectors=model.get("connectors");_.isArray(connectors)&&connectors.length&&this.renderConnectors(connectors);return this},renderConnectors:function(connectors){var $li,_this=this,$el=$("<ul>");_.each(connectors,function(connector){if($.trim(connector.DefaultClickText).length){$li=$("<li>").append(_this.renderConnector(connector));$el.append($li)}});this.$el.append($el)},renderConnector:function(connector){this.model;return $("<a>").attr("href","#").text(connector.DefaultClickText)},renderSemanticFAQ:function(semanticFAQ){this.model;return $("<a>").attr({href:"#","data-recognition-id":semanticFAQ.RecognitionId,"data-answer-id":semanticFAQ.AnswerId,"data-subtype":semanticFAQ.subtype}).text(semanticFAQ.QuestionText)},renderDisambiguationOptions:function(disambiguationOption){this.model;return $("<a>").attr("href","#").text(disambiguationOption.clicktext)},openNavwin:function(url,name,properties){null!=this.navwin?this.navwin.closed?this.navwin=window.open(url,name,properties):this.navwin.location.href=url:this.navwin=window.open(url,name,properties)},botNav:function(event,url,target,width,height){var properties=["fullscreen=no","toolbar=1","scrollbars=1","location=1","statusbar=1","menubar=1","resizable=1"].join(",");if("string"!=typeof event){event.stopPropagation();event.preventDefault();if("_blank"===target||""===target.trim())if(window.screen&&""!==width&&""!==height&&void 0!==width&&void 0!==height){var w=window.screen.availWidth*parseInt(width.substr(0,width.indexOf("%")))/100,h=window.screen.availHeight*parseInt(height.substr(0,height.indexOf("%")))/100;window.open(url,target,"width="+w+",height="+h+","+properties)}else window.open(url,target);else if("_top"===target){window.CVMobile&&this.$el.parent().parent().find("#cv-minimize-btn").trigger("click");window.parent.location.href=url}}else window.open(event,"_blank")}});return Answer});!function(factory){"use strict";"function"==typeof define&&define.amd?define("scrollto",["jquery"],factory):"undefined"!=typeof module&&module.exports?module.exports=factory(require("jquery")):factory(jQuery)}(function($){"use strict";function isWin(elem){return!elem.nodeName||-1!==$.inArray(elem.nodeName.toLowerCase(),["iframe","#document","html","body"])}function both(val){return $.isFunction(val)||$.isPlainObject(val)?val:{top:val,left:val}}var $scrollTo=$.scrollTo=function(target,duration,settings){return $(window).scrollTo(target,duration,settings)};$scrollTo.defaults={axis:"xy",duration:0,limit:!0};$.fn.scrollTo=function(target,duration,settings){if("object"==typeof duration){settings=duration;duration=0}"function"==typeof settings&&(settings={onAfter:settings});"max"===target&&(target=9e9);settings=$.extend({},$scrollTo.defaults,settings);duration=duration||settings.duration;var queue=settings.queue&&settings.axis.length>1;queue&&(duration/=2);settings.offset=both(settings.offset);settings.over=both(settings.over);return this.each(function(){function animate(callback){var opts=$.extend({},settings,{queue:!0,duration:duration,complete:callback&&function(){callback.call(elem,targ,settings)}});$elem.animate(attr,opts)}if(null!==target){var toff,win=isWin(this),elem=win?this.contentWindow||window:this,$elem=$(elem),targ=target,attr={};switch(typeof targ){case"number":case"string":if(/^([+-]=?)?\d+(\.\d+)?(px|%)?$/.test(targ)){targ=both(targ);break}targ=win?$(targ):$(targ,elem);case"object":if(0===targ.length)return;(targ.is||targ.style)&&(toff=(targ=$(targ)).offset())}var offset=$.isFunction(settings.offset)&&settings.offset(elem,targ)||settings.offset;$.each(settings.axis.split(""),function(i,axis){var Pos="x"===axis?"Left":"Top",pos=Pos.toLowerCase(),key="scroll"+Pos,prev=$elem[key](),max=$scrollTo.max(elem,axis);if(toff){attr[key]=toff[pos]+(win?0:prev-$elem.offset()[pos]);if(settings.margin){attr[key]-=parseInt(targ.css("margin"+Pos),10)||0;attr[key]-=parseInt(targ.css("border"+Pos+"Width"),10)||0}attr[key]+=offset[pos]||0;settings.over[pos]&&(attr[key]+=targ["x"===axis?"width":"height"]()*settings.over[pos])}else{var val=targ[pos];attr[key]=val.slice&&"%"===val.slice(-1)?parseFloat(val)/100*max:val}settings.limit&&/^\d+$/.test(attr[key])&&(attr[key]=attr[key]<=0?0:Math.min(attr[key],max));if(!i&&settings.axis.length>1)if(prev===attr[key])attr={};else if(queue){animate(settings.onAfterFirst);attr={}}});animate(settings.onAfter)}})};$scrollTo.max=function(elem,axis){var Dim="x"===axis?"Width":"Height",scroll="scroll"+Dim;if(!isWin(elem))return elem[scroll]-$(elem)[Dim.toLowerCase()]();var size="client"+Dim,doc=elem.ownerDocument||elem.document,html=doc.documentElement,body=doc.body;return Math.max(html[scroll],body[scroll])-Math.min(html[size],body[size])};$.Tween.propHooks.scrollLeft=$.Tween.propHooks.scrollTop={get:function(t){return $(t.elem)[t.prop]()},set:function(t){var curr=this.get(t);if(t.options.interrupt&&t._last&&t._last!==curr)return $(t.elem).stop();var next=Math.round(t.now);if(curr!==next){$(t.elem)[t.prop](next);t._last=this.get(t)}}};return $scrollTo});!function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a="function"==typeof require&&require;if(!u&&a)return a(o,!0);if(i)return i(o,!0);var f=new Error("Cannot find module '"+o+"'");throw f.code="MODULE_NOT_FOUND",f}var l=n[o]={exports:{}};t[o][0].call(l.exports,function(e){var n=t[o][1][e];return s(n?n:e)},l,l.exports,e,t,n,r)}return n[o].exports}for(var i="function"==typeof require&&require,o=0;o<r.length;o++)s(r[o]);return s}({1:[function(require,module,exports){"use strict";function mountJQuery(jQuery){jQuery.fn.perfectScrollbar=function(settingOrCommand){return this.each(function(){if("object"==typeof settingOrCommand||"undefined"==typeof settingOrCommand){var settings=settingOrCommand;psInstances.get(this)||ps.initialize(this,settings)}else{var command=settingOrCommand;"update"===command?ps.update(this):"destroy"===command&&ps.destroy(this)}})}}var ps=require("../main"),psInstances=require("../plugin/instances");if("function"==typeof define&&define.amd)define("perfectScrollbar",["jquery"],mountJQuery);else{var jq=window.jQuery?window.jQuery:window.$;"undefined"!=typeof jq&&mountJQuery(jq)}module.exports=mountJQuery},{"../main":7,"../plugin/instances":18}],2:[function(require,module,exports){"use strict";function oldAdd(element,className){var classes=element.className.split(" ");classes.indexOf(className)<0&&classes.push(className);element.className=classes.join(" ")}function oldRemove(element,className){var classes=element.className.split(" "),idx=classes.indexOf(className);idx>=0&&classes.splice(idx,1);element.className=classes.join(" ")}exports.add=function(element,className){element.classList?element.classList.add(className):oldAdd(element,className)};exports.remove=function(element,className){element.classList?element.classList.remove(className):oldRemove(element,className)};exports.list=function(element){return element.classList?Array.prototype.slice.apply(element.classList):element.className.split(" ")}},{}],3:[function(require,module,exports){"use strict";function cssGet(element,styleName){return window.getComputedStyle(element)[styleName]}function cssSet(element,styleName,styleValue){"number"==typeof styleValue&&(styleValue=styleValue.toString()+"px");element.style[styleName]=styleValue;return element}function cssMultiSet(element,obj){for(var key in obj){var val=obj[key];"number"==typeof val&&(val=val.toString()+"px");element.style[key]=val}return element}var DOM={};DOM.e=function(tagName,className){var element=document.createElement(tagName);element.className=className;return element};DOM.appendTo=function(child,parent){parent.appendChild(child);return child};DOM.css=function(element,styleNameOrObject,styleValue){return"object"==typeof styleNameOrObject?cssMultiSet(element,styleNameOrObject):"undefined"==typeof styleValue?cssGet(element,styleNameOrObject):cssSet(element,styleNameOrObject,styleValue)};DOM.matches=function(element,query){return"undefined"!=typeof element.matches?element.matches(query):"undefined"!=typeof element.matchesSelector?element.matchesSelector(query):"undefined"!=typeof element.webkitMatchesSelector?element.webkitMatchesSelector(query):"undefined"!=typeof element.mozMatchesSelector?element.mozMatchesSelector(query):"undefined"!=typeof element.msMatchesSelector?element.msMatchesSelector(query):void 0};DOM.remove=function(element){"undefined"!=typeof element.remove?element.remove():element.parentNode&&element.parentNode.removeChild(element)};DOM.queryChildren=function(element,selector){return Array.prototype.filter.call(element.childNodes,function(child){return DOM.matches(child,selector)})};module.exports=DOM},{}],4:[function(require,module,exports){"use strict";var EventElement=function(element){this.element=element;this.events={}};EventElement.prototype.bind=function(eventName,handler){"undefined"==typeof this.events[eventName]&&(this.events[eventName]=[]);this.events[eventName].push(handler);this.element.addEventListener(eventName,handler,!1)};EventElement.prototype.unbind=function(eventName,handler){var isHandlerProvided="undefined"!=typeof handler;this.events[eventName]=this.events[eventName].filter(function(hdlr){if(isHandlerProvided&&hdlr!==handler)return!0;this.element.removeEventListener(eventName,hdlr,!1);return!1},this)};EventElement.prototype.unbindAll=function(){for(var name in this.events)this.unbind(name)};var EventManager=function(){this.eventElements=[]};EventManager.prototype.eventElement=function(element){var ee=this.eventElements.filter(function(eventElement){return eventElement.element===element})[0];if("undefined"==typeof ee){ee=new EventElement(element);this.eventElements.push(ee)}return ee};EventManager.prototype.bind=function(element,eventName,handler){this.eventElement(element).bind(eventName,handler)};EventManager.prototype.unbind=function(element,eventName,handler){this.eventElement(element).unbind(eventName,handler)};EventManager.prototype.unbindAll=function(){for(var i=0;i<this.eventElements.length;i++)this.eventElements[i].unbindAll()};EventManager.prototype.once=function(element,eventName,handler){var ee=this.eventElement(element),onceHandler=function(e){ee.unbind(eventName,onceHandler);handler(e)};ee.bind(eventName,onceHandler)};module.exports=EventManager},{}],5:[function(require,module,exports){"use strict";module.exports=function(){function s4(){return Math.floor(65536*(1+Math.random())).toString(16).substring(1)}return function(){return s4()+s4()+"-"+s4()+"-"+s4()+"-"+s4()+"-"+s4()+s4()+s4()}}()},{}],6:[function(require,module,exports){"use strict";function toggleScrolling(handler){return function(element,axis){handler(element,"ps--in-scrolling");if("undefined"!=typeof axis)handler(element,"ps--"+axis);else{handler(element,"ps--x");handler(element,"ps--y")}}}var cls=require("./class"),dom=require("./dom"),toInt=exports.toInt=function(x){return parseInt(x,10)||0},clone=exports.clone=function(obj){if(obj){if(Array.isArray(obj))return obj.map(clone);if("object"==typeof obj){var result={};for(var key in obj)result[key]=clone(obj[key]);return result}return obj}return null};exports.extend=function(original,source){var result=clone(original);for(var key in source)result[key]=clone(source[key]);return result};exports.isEditable=function(el){return dom.matches(el,"input,[contenteditable]")||dom.matches(el,"select,[contenteditable]")||dom.matches(el,"textarea,[contenteditable]")||dom.matches(el,"button,[contenteditable]")};exports.removePsClasses=function(element){for(var clsList=cls.list(element),i=0;i<clsList.length;i++){var className=clsList[i];0===className.indexOf("ps-")&&cls.remove(element,className)}};exports.outerWidth=function(element){return toInt(dom.css(element,"width"))+toInt(dom.css(element,"paddingLeft"))+toInt(dom.css(element,"paddingRight"))+toInt(dom.css(element,"borderLeftWidth"))+toInt(dom.css(element,"borderRightWidth"))};exports.startScrolling=toggleScrolling(cls.add);exports.stopScrolling=toggleScrolling(cls.remove);exports.env={isWebKit:"undefined"!=typeof document&&"WebkitAppearance"in document.documentElement.style,supportsTouch:"undefined"!=typeof window&&("ontouchstart"in window||window.DocumentTouch&&document instanceof window.DocumentTouch),supportsIePointer:"undefined"!=typeof window&&null!==window.navigator.msMaxTouchPoints}},{"./class":2,"./dom":3}],7:[function(require,module,exports){"use strict";var destroy=require("./plugin/destroy"),initialize=require("./plugin/initialize"),update=require("./plugin/update");module.exports={initialize:initialize,update:update,destroy:destroy}},{"./plugin/destroy":9,"./plugin/initialize":17,"./plugin/update":21}],8:[function(require,module,exports){"use strict";module.exports={handlers:["click-rail","drag-scrollbar","keyboard","wheel","touch"],maxScrollbarLength:null,minScrollbarLength:null,scrollXMarginOffset:0,scrollYMarginOffset:0,suppressScrollX:!1,suppressScrollY:!1,swipePropagation:!0,swipeEasing:!0,useBothWheelAxes:!1,wheelPropagation:!1,wheelSpeed:1,theme:"default"}},{}],9:[function(require,module,exports){"use strict";var _=require("../lib/helper"),dom=require("../lib/dom"),instances=require("./instances");module.exports=function(element){var i=instances.get(element);if(i){i.event.unbindAll();dom.remove(i.scrollbarX);dom.remove(i.scrollbarY);dom.remove(i.scrollbarXRail);dom.remove(i.scrollbarYRail);_.removePsClasses(element);instances.remove(element)}}},{"../lib/dom":3,"../lib/helper":6,"./instances":18}],10:[function(require,module,exports){"use strict";function bindClickRailHandler(element,i){function pageOffset(el){return el.getBoundingClientRect()}var stopPropagation=function(e){e.stopPropagation()};i.event.bind(i.scrollbarY,"click",stopPropagation);i.event.bind(i.scrollbarYRail,"click",function(e){var positionTop=e.pageY-window.pageYOffset-pageOffset(i.scrollbarYRail).top,direction=positionTop>i.scrollbarYTop?1:-1;updateScroll(element,"top",element.scrollTop+direction*i.containerHeight);updateGeometry(element);e.stopPropagation()});i.event.bind(i.scrollbarX,"click",stopPropagation);i.event.bind(i.scrollbarXRail,"click",function(e){var positionLeft=e.pageX-window.pageXOffset-pageOffset(i.scrollbarXRail).left,direction=positionLeft>i.scrollbarXLeft?1:-1;updateScroll(element,"left",element.scrollLeft+direction*i.containerWidth);updateGeometry(element);e.stopPropagation()})}var instances=require("../instances"),updateGeometry=require("../update-geometry"),updateScroll=require("../update-scroll");module.exports=function(element){var i=instances.get(element);bindClickRailHandler(element,i)}},{"../instances":18,"../update-geometry":19,"../update-scroll":20}],11:[function(require,module,exports){"use strict";function bindMouseScrollXHandler(element,i){function updateScrollLeft(deltaX){var newLeft=currentLeft+deltaX*i.railXRatio,maxLeft=Math.max(0,i.scrollbarXRail.getBoundingClientRect().left)+i.railXRatio*(i.railXWidth-i.scrollbarXWidth);0>newLeft?i.scrollbarXLeft=0:newLeft>maxLeft?i.scrollbarXLeft=maxLeft:i.scrollbarXLeft=newLeft;var scrollLeft=_.toInt(i.scrollbarXLeft*(i.contentWidth-i.containerWidth)/(i.containerWidth-i.railXRatio*i.scrollbarXWidth))-i.negativeScrollAdjustment;updateScroll(element,"left",scrollLeft)}var currentLeft=null,currentPageX=null,mouseMoveHandler=function(e){updateScrollLeft(e.pageX-currentPageX);updateGeometry(element);e.stopPropagation();e.preventDefault()},mouseUpHandler=function(){_.stopScrolling(element,"x");i.event.unbind(i.ownerDocument,"mousemove",mouseMoveHandler)};i.event.bind(i.scrollbarX,"mousedown",function(e){currentPageX=e.pageX;currentLeft=_.toInt(dom.css(i.scrollbarX,"left"))*i.railXRatio;_.startScrolling(element,"x");i.event.bind(i.ownerDocument,"mousemove",mouseMoveHandler);i.event.once(i.ownerDocument,"mouseup",mouseUpHandler);e.stopPropagation();e.preventDefault()})}function bindMouseScrollYHandler(element,i){function updateScrollTop(deltaY){var newTop=currentTop+deltaY*i.railYRatio,maxTop=Math.max(0,i.scrollbarYRail.getBoundingClientRect().top)+i.railYRatio*(i.railYHeight-i.scrollbarYHeight);0>newTop?i.scrollbarYTop=0:newTop>maxTop?i.scrollbarYTop=maxTop:i.scrollbarYTop=newTop;var scrollTop=_.toInt(i.scrollbarYTop*(i.contentHeight-i.containerHeight)/(i.containerHeight-i.railYRatio*i.scrollbarYHeight));updateScroll(element,"top",scrollTop)}var currentTop=null,currentPageY=null,mouseMoveHandler=function(e){updateScrollTop(e.pageY-currentPageY);updateGeometry(element);e.stopPropagation();e.preventDefault()},mouseUpHandler=function(){_.stopScrolling(element,"y");i.event.unbind(i.ownerDocument,"mousemove",mouseMoveHandler)};i.event.bind(i.scrollbarY,"mousedown",function(e){currentPageY=e.pageY;currentTop=_.toInt(dom.css(i.scrollbarY,"top"))*i.railYRatio;_.startScrolling(element,"y");i.event.bind(i.ownerDocument,"mousemove",mouseMoveHandler);i.event.once(i.ownerDocument,"mouseup",mouseUpHandler);e.stopPropagation();e.preventDefault()})}var _=require("../../lib/helper"),dom=require("../../lib/dom"),instances=require("../instances"),updateGeometry=require("../update-geometry"),updateScroll=require("../update-scroll");module.exports=function(element){var i=instances.get(element);bindMouseScrollXHandler(element,i);bindMouseScrollYHandler(element,i)}},{"../../lib/dom":3,"../../lib/helper":6,"../instances":18,"../update-geometry":19,"../update-scroll":20}],12:[function(require,module,exports){"use strict";function bindKeyboardHandler(element,i){function shouldPreventDefault(deltaX,deltaY){var scrollTop=element.scrollTop;if(0===deltaX){if(!i.scrollbarYActive)return!1;if(0===scrollTop&&deltaY>0||scrollTop>=i.contentHeight-i.containerHeight&&0>deltaY)return!i.settings.wheelPropagation}var scrollLeft=element.scrollLeft;if(0===deltaY){if(!i.scrollbarXActive)return!1;if(0===scrollLeft&&0>deltaX||scrollLeft>=i.contentWidth-i.containerWidth&&deltaX>0)return!i.settings.wheelPropagation}return!0}var hovered=!1;i.event.bind(element,"mouseenter",function(){hovered=!0});i.event.bind(element,"mouseleave",function(){hovered=!1});var shouldPrevent=!1;i.event.bind(i.ownerDocument,"keydown",function(e){if(!(e.isDefaultPrevented&&e.isDefaultPrevented()||e.defaultPrevented)){var focused=dom.matches(i.scrollbarX,":focus")||dom.matches(i.scrollbarY,":focus");if(hovered||focused){var activeElement=document.activeElement?document.activeElement:i.ownerDocument.activeElement;if(activeElement){if("IFRAME"===activeElement.tagName)activeElement=activeElement.contentDocument.activeElement;else for(;activeElement.shadowRoot;)activeElement=activeElement.shadowRoot.activeElement;if(_.isEditable(activeElement))return}var deltaX=0,deltaY=0;switch(e.which){case 37:deltaX=e.metaKey?-i.contentWidth:e.altKey?-i.containerWidth:-30;break;case 38:deltaY=e.metaKey?i.contentHeight:e.altKey?i.containerHeight:30;break;case 39:deltaX=e.metaKey?i.contentWidth:e.altKey?i.containerWidth:30;break;case 40:deltaY=e.metaKey?-i.contentHeight:e.altKey?-i.containerHeight:-30;break;case 33:deltaY=90;break;case 32:deltaY=e.shiftKey?90:-90;break;case 34:deltaY=-90;break;case 35:deltaY=e.ctrlKey?-i.contentHeight:-i.containerHeight;break;case 36:deltaY=e.ctrlKey?element.scrollTop:i.containerHeight;break;default:return}updateScroll(element,"top",element.scrollTop-deltaY);updateScroll(element,"left",element.scrollLeft+deltaX);updateGeometry(element);shouldPrevent=shouldPreventDefault(deltaX,deltaY);shouldPrevent&&e.preventDefault()}}})}var _=require("../../lib/helper"),dom=require("../../lib/dom"),instances=require("../instances"),updateGeometry=require("../update-geometry"),updateScroll=require("../update-scroll");module.exports=function(element){var i=instances.get(element);bindKeyboardHandler(element,i)}},{"../../lib/dom":3,"../../lib/helper":6,"../instances":18,"../update-geometry":19,"../update-scroll":20}],13:[function(require,module,exports){"use strict";function bindMouseWheelHandler(element,i){function shouldPreventDefault(deltaX,deltaY){var scrollTop=element.scrollTop;if(0===deltaX){if(!i.scrollbarYActive)return!1;if(0===scrollTop&&deltaY>0||scrollTop>=i.contentHeight-i.containerHeight&&0>deltaY)return!i.settings.wheelPropagation}var scrollLeft=element.scrollLeft;if(0===deltaY){if(!i.scrollbarXActive)return!1;if(0===scrollLeft&&0>deltaX||scrollLeft>=i.contentWidth-i.containerWidth&&deltaX>0)return!i.settings.wheelPropagation}return!0}function getDeltaFromEvent(e){var deltaX=e.deltaX,deltaY=-1*e.deltaY;if("undefined"==typeof deltaX||"undefined"==typeof deltaY){deltaX=-1*e.wheelDeltaX/6;deltaY=e.wheelDeltaY/6}if(e.deltaMode&&1===e.deltaMode){deltaX*=10;deltaY*=10}if(deltaX!==deltaX&&deltaY!==deltaY){deltaX=0;deltaY=e.wheelDelta}return e.shiftKey?[-deltaY,-deltaX]:[deltaX,deltaY]}function shouldBeConsumedByChild(deltaX,deltaY){var child=element.querySelector("textarea:hover, select[multiple]:hover, .ps-child:hover");if(child){var style=window.getComputedStyle(child),overflow=[style.overflow,style.overflowX,style.overflowY].join("");if(!overflow.match(/(scroll|auto)/))return!1;var maxScrollTop=child.scrollHeight-child.clientHeight;if(maxScrollTop>0&&!(0===child.scrollTop&&deltaY>0||child.scrollTop===maxScrollTop&&0>deltaY))return!0;var maxScrollLeft=child.scrollLeft-child.clientWidth;if(maxScrollLeft>0&&!(0===child.scrollLeft&&0>deltaX||child.scrollLeft===maxScrollLeft&&deltaX>0))return!0}return!1}function mousewheelHandler(e){var delta=getDeltaFromEvent(e),deltaX=delta[0],deltaY=delta[1];if(!shouldBeConsumedByChild(deltaX,deltaY)){shouldPrevent=!1;if(i.settings.useBothWheelAxes){if(i.scrollbarYActive&&!i.scrollbarXActive){deltaY?updateScroll(element,"top",element.scrollTop-deltaY*i.settings.wheelSpeed):updateScroll(element,"top",element.scrollTop+deltaX*i.settings.wheelSpeed);shouldPrevent=!0}else if(i.scrollbarXActive&&!i.scrollbarYActive){deltaX?updateScroll(element,"left",element.scrollLeft+deltaX*i.settings.wheelSpeed):updateScroll(element,"left",element.scrollLeft-deltaY*i.settings.wheelSpeed);shouldPrevent=!0}}else{updateScroll(element,"top",element.scrollTop-deltaY*i.settings.wheelSpeed);updateScroll(element,"left",element.scrollLeft+deltaX*i.settings.wheelSpeed)}updateGeometry(element);shouldPrevent=shouldPrevent||shouldPreventDefault(deltaX,deltaY);if(shouldPrevent){e.stopPropagation();e.preventDefault()}}}var shouldPrevent=!1;"undefined"!=typeof window.onwheel?i.event.bind(element,"wheel",mousewheelHandler):"undefined"!=typeof window.onmousewheel&&i.event.bind(element,"mousewheel",mousewheelHandler)}var instances=require("../instances"),updateGeometry=require("../update-geometry"),updateScroll=require("../update-scroll");module.exports=function(element){var i=instances.get(element);bindMouseWheelHandler(element,i)}},{"../instances":18,"../update-geometry":19,"../update-scroll":20}],14:[function(require,module,exports){"use strict";function bindNativeScrollHandler(element,i){i.event.bind(element,"scroll",function(){updateGeometry(element)})}var instances=require("../instances"),updateGeometry=require("../update-geometry");module.exports=function(element){var i=instances.get(element);bindNativeScrollHandler(element,i)}},{"../instances":18,"../update-geometry":19}],15:[function(require,module,exports){"use strict";function bindSelectionHandler(element,i){function getRangeNode(){var selection=window.getSelection?window.getSelection():document.getSelection?document.getSelection():"";return 0===selection.toString().length?null:selection.getRangeAt(0).commonAncestorContainer}function startScrolling(){
scrollingLoop||(scrollingLoop=setInterval(function(){if(instances.get(element)){updateScroll(element,"top",element.scrollTop+scrollDiff.top);updateScroll(element,"left",element.scrollLeft+scrollDiff.left);updateGeometry(element)}else clearInterval(scrollingLoop)},50))}function stopScrolling(){if(scrollingLoop){clearInterval(scrollingLoop);scrollingLoop=null}_.stopScrolling(element)}var scrollingLoop=null,scrollDiff={top:0,left:0},isSelected=!1;i.event.bind(i.ownerDocument,"selectionchange",function(){if(element.contains(getRangeNode()))isSelected=!0;else{isSelected=!1;stopScrolling()}});i.event.bind(window,"mouseup",function(){if(isSelected){isSelected=!1;stopScrolling()}});i.event.bind(window,"keyup",function(){if(isSelected){isSelected=!1;stopScrolling()}});i.event.bind(window,"mousemove",function(e){if(isSelected){var mousePosition={x:e.pageX,y:e.pageY},containerGeometry={left:element.offsetLeft,right:element.offsetLeft+element.offsetWidth,top:element.offsetTop,bottom:element.offsetTop+element.offsetHeight};if(mousePosition.x<containerGeometry.left+3){scrollDiff.left=-5;_.startScrolling(element,"x")}else if(mousePosition.x>containerGeometry.right-3){scrollDiff.left=5;_.startScrolling(element,"x")}else scrollDiff.left=0;if(mousePosition.y<containerGeometry.top+3){containerGeometry.top+3-mousePosition.y<5?scrollDiff.top=-5:scrollDiff.top=-20;_.startScrolling(element,"y")}else if(mousePosition.y>containerGeometry.bottom-3){mousePosition.y-containerGeometry.bottom+3<5?scrollDiff.top=5:scrollDiff.top=20;_.startScrolling(element,"y")}else scrollDiff.top=0;0===scrollDiff.top&&0===scrollDiff.left?stopScrolling():startScrolling()}})}var _=require("../../lib/helper"),instances=require("../instances"),updateGeometry=require("../update-geometry"),updateScroll=require("../update-scroll");module.exports=function(element){var i=instances.get(element);bindSelectionHandler(element,i)}},{"../../lib/helper":6,"../instances":18,"../update-geometry":19,"../update-scroll":20}],16:[function(require,module,exports){"use strict";function bindTouchHandler(element,i,supportsTouch,supportsIePointer){function shouldPreventDefault(deltaX,deltaY){var scrollTop=element.scrollTop,scrollLeft=element.scrollLeft,magnitudeX=Math.abs(deltaX),magnitudeY=Math.abs(deltaY);if(magnitudeY>magnitudeX){if(0>deltaY&&scrollTop===i.contentHeight-i.containerHeight||deltaY>0&&0===scrollTop)return!i.settings.swipePropagation}else if(magnitudeX>magnitudeY&&(0>deltaX&&scrollLeft===i.contentWidth-i.containerWidth||deltaX>0&&0===scrollLeft))return!i.settings.swipePropagation;return!0}function applyTouchMove(differenceX,differenceY){updateScroll(element,"top",element.scrollTop-differenceY);updateScroll(element,"left",element.scrollLeft-differenceX);updateGeometry(element)}function globalTouchStart(){inGlobalTouch=!0}function globalTouchEnd(){inGlobalTouch=!1}function getTouch(e){return e.targetTouches?e.targetTouches[0]:e}function shouldHandle(e){return e.targetTouches&&1===e.targetTouches.length?!0:e.pointerType&&"mouse"!==e.pointerType&&e.pointerType!==e.MSPOINTER_TYPE_MOUSE?!0:!1}function touchStart(e){if(shouldHandle(e)){inLocalTouch=!0;var touch=getTouch(e);startOffset.pageX=touch.pageX;startOffset.pageY=touch.pageY;startTime=(new Date).getTime();null!==easingLoop&&clearInterval(easingLoop);e.stopPropagation()}}function touchMove(e){!inLocalTouch&&i.settings.swipePropagation&&touchStart(e);if(!inGlobalTouch&&inLocalTouch&&shouldHandle(e)){var touch=getTouch(e),currentOffset={pageX:touch.pageX,pageY:touch.pageY},differenceX=currentOffset.pageX-startOffset.pageX,differenceY=currentOffset.pageY-startOffset.pageY;applyTouchMove(differenceX,differenceY);startOffset=currentOffset;var currentTime=(new Date).getTime(),timeGap=currentTime-startTime;if(timeGap>0){speed.x=differenceX/timeGap;speed.y=differenceY/timeGap;startTime=currentTime}if(shouldPreventDefault(differenceX,differenceY)){e.stopPropagation();e.preventDefault()}}}function touchEnd(){if(!inGlobalTouch&&inLocalTouch){inLocalTouch=!1;if(i.settings.swipeEasing){clearInterval(easingLoop);easingLoop=setInterval(function(){if(instances.get(element))if(speed.x||speed.y)if(Math.abs(speed.x)<.01&&Math.abs(speed.y)<.01)clearInterval(easingLoop);else{applyTouchMove(30*speed.x,30*speed.y);speed.x*=.8;speed.y*=.8}else clearInterval(easingLoop);else clearInterval(easingLoop)},10)}}}var startOffset={},startTime=0,speed={},easingLoop=null,inGlobalTouch=!1,inLocalTouch=!1;if(supportsTouch){i.event.bind(window,"touchstart",globalTouchStart);i.event.bind(window,"touchend",globalTouchEnd);i.event.bind(element,"touchstart",touchStart);i.event.bind(element,"touchmove",touchMove);i.event.bind(element,"touchend",touchEnd)}else if(supportsIePointer)if(window.PointerEvent){i.event.bind(window,"pointerdown",globalTouchStart);i.event.bind(window,"pointerup",globalTouchEnd);i.event.bind(element,"pointerdown",touchStart);i.event.bind(element,"pointermove",touchMove);i.event.bind(element,"pointerup",touchEnd)}else if(window.MSPointerEvent){i.event.bind(window,"MSPointerDown",globalTouchStart);i.event.bind(window,"MSPointerUp",globalTouchEnd);i.event.bind(element,"MSPointerDown",touchStart);i.event.bind(element,"MSPointerMove",touchMove);i.event.bind(element,"MSPointerUp",touchEnd)}}var _=require("../../lib/helper"),instances=require("../instances"),updateGeometry=require("../update-geometry"),updateScroll=require("../update-scroll");module.exports=function(element){if(_.env.supportsTouch||_.env.supportsIePointer){var i=instances.get(element);bindTouchHandler(element,i,_.env.supportsTouch,_.env.supportsIePointer)}}},{"../../lib/helper":6,"../instances":18,"../update-geometry":19,"../update-scroll":20}],17:[function(require,module,exports){"use strict";var _=require("../lib/helper"),cls=require("../lib/class"),instances=require("./instances"),updateGeometry=require("./update-geometry"),handlers={"click-rail":require("./handler/click-rail"),"drag-scrollbar":require("./handler/drag-scrollbar"),keyboard:require("./handler/keyboard"),wheel:require("./handler/mouse-wheel"),touch:require("./handler/touch"),selection:require("./handler/selection")},nativeScrollHandler=require("./handler/native-scroll");module.exports=function(element,userSettings){userSettings="object"==typeof userSettings?userSettings:{};cls.add(element,"ps");var i=instances.add(element);i.settings=_.extend(i.settings,userSettings);cls.add(element,"ps--theme_"+i.settings.theme);i.settings.handlers.forEach(function(handlerName){handlers[handlerName](element)});nativeScrollHandler(element);updateGeometry(element)}},{"../lib/class":2,"../lib/helper":6,"./handler/click-rail":10,"./handler/drag-scrollbar":11,"./handler/keyboard":12,"./handler/mouse-wheel":13,"./handler/native-scroll":14,"./handler/selection":15,"./handler/touch":16,"./instances":18,"./update-geometry":19}],18:[function(require,module,exports){"use strict";function Instance(element){function focus(){cls.add(element,"ps--focus")}function blur(){cls.remove(element,"ps--focus")}var i=this;i.settings=_.clone(defaultSettings);i.containerWidth=null;i.containerHeight=null;i.contentWidth=null;i.contentHeight=null;i.isRtl="rtl"===dom.css(element,"direction");i.isNegativeScroll=function(){var originalScrollLeft=element.scrollLeft,result=null;element.scrollLeft=-1;result=element.scrollLeft<0;element.scrollLeft=originalScrollLeft;return result}();i.negativeScrollAdjustment=i.isNegativeScroll?element.scrollWidth-element.clientWidth:0;i.event=new EventManager;i.ownerDocument=element.ownerDocument||document;i.scrollbarXRail=dom.appendTo(dom.e("div","ps__scrollbar-x-rail"),element);i.scrollbarX=dom.appendTo(dom.e("div","ps__scrollbar-x"),i.scrollbarXRail);i.scrollbarX.setAttribute("tabindex",0);i.event.bind(i.scrollbarX,"focus",focus);i.event.bind(i.scrollbarX,"blur",blur);i.scrollbarXActive=null;i.scrollbarXWidth=null;i.scrollbarXLeft=null;i.scrollbarXBottom=_.toInt(dom.css(i.scrollbarXRail,"bottom"));i.isScrollbarXUsingBottom=i.scrollbarXBottom===i.scrollbarXBottom;i.scrollbarXTop=i.isScrollbarXUsingBottom?null:_.toInt(dom.css(i.scrollbarXRail,"top"));i.railBorderXWidth=_.toInt(dom.css(i.scrollbarXRail,"borderLeftWidth"))+_.toInt(dom.css(i.scrollbarXRail,"borderRightWidth"));dom.css(i.scrollbarXRail,"display","block");i.railXMarginWidth=_.toInt(dom.css(i.scrollbarXRail,"marginLeft"))+_.toInt(dom.css(i.scrollbarXRail,"marginRight"));dom.css(i.scrollbarXRail,"display","");i.railXWidth=null;i.railXRatio=null;i.scrollbarYRail=dom.appendTo(dom.e("div","ps__scrollbar-y-rail"),element);i.scrollbarY=dom.appendTo(dom.e("div","ps__scrollbar-y"),i.scrollbarYRail);i.scrollbarY.setAttribute("tabindex",0);i.scrollbarY.setAttribute("aria-hidden","true");i.event.bind(i.scrollbarY,"focus",focus);i.event.bind(i.scrollbarY,"blur",blur);i.scrollbarYActive=null;i.scrollbarYHeight=null;i.scrollbarYTop=null;i.scrollbarYRight=_.toInt(dom.css(i.scrollbarYRail,"right"));i.isScrollbarYUsingRight=i.scrollbarYRight===i.scrollbarYRight;i.scrollbarYLeft=i.isScrollbarYUsingRight?null:_.toInt(dom.css(i.scrollbarYRail,"left"));i.scrollbarYOuterWidth=i.isRtl?_.outerWidth(i.scrollbarY):null;i.railBorderYWidth=_.toInt(dom.css(i.scrollbarYRail,"borderTopWidth"))+_.toInt(dom.css(i.scrollbarYRail,"borderBottomWidth"));dom.css(i.scrollbarYRail,"display","block");i.railYMarginHeight=_.toInt(dom.css(i.scrollbarYRail,"marginTop"))+_.toInt(dom.css(i.scrollbarYRail,"marginBottom"));dom.css(i.scrollbarYRail,"display","");i.railYHeight=null;i.railYRatio=null}function getId(element){return element.getAttribute("data-ps-id")}function setId(element,id){element.setAttribute("data-ps-id",id)}function removeId(element){element.removeAttribute("data-ps-id")}var _=require("../lib/helper"),cls=require("../lib/class"),defaultSettings=require("./default-setting"),dom=require("../lib/dom"),EventManager=require("../lib/event-manager"),guid=require("../lib/guid"),instances={};exports.add=function(element){var newId=guid();setId(element,newId);instances[newId]=new Instance(element);return instances[newId]};exports.remove=function(element){delete instances[getId(element)];removeId(element)};exports.get=function(element){return instances[getId(element)]}},{"../lib/class":2,"../lib/dom":3,"../lib/event-manager":4,"../lib/guid":5,"../lib/helper":6,"./default-setting":8}],19:[function(require,module,exports){"use strict";function getThumbSize(i,thumbSize){i.settings.minScrollbarLength&&(thumbSize=Math.max(thumbSize,i.settings.minScrollbarLength));i.settings.maxScrollbarLength&&(thumbSize=Math.min(thumbSize,i.settings.maxScrollbarLength));return thumbSize}function updateCss(element,i){var xRailOffset={width:i.railXWidth};i.isRtl?xRailOffset.left=i.negativeScrollAdjustment+element.scrollLeft+i.containerWidth-i.contentWidth:xRailOffset.left=element.scrollLeft;i.isScrollbarXUsingBottom?xRailOffset.bottom=i.scrollbarXBottom-element.scrollTop:xRailOffset.top=i.scrollbarXTop+element.scrollTop;dom.css(i.scrollbarXRail,xRailOffset);var yRailOffset={top:element.scrollTop,height:i.railYHeight};i.isScrollbarYUsingRight?i.isRtl?yRailOffset.right=i.contentWidth-(i.negativeScrollAdjustment+element.scrollLeft)-i.scrollbarYRight-i.scrollbarYOuterWidth:yRailOffset.right=i.scrollbarYRight-element.scrollLeft:i.isRtl?yRailOffset.left=i.negativeScrollAdjustment+element.scrollLeft+2*i.containerWidth-i.contentWidth-i.scrollbarYLeft-i.scrollbarYOuterWidth:yRailOffset.left=i.scrollbarYLeft+element.scrollLeft;dom.css(i.scrollbarYRail,yRailOffset);dom.css(i.scrollbarX,{left:i.scrollbarXLeft,width:i.scrollbarXWidth-i.railBorderXWidth});dom.css(i.scrollbarY,{top:i.scrollbarYTop,height:i.scrollbarYHeight-i.railBorderYWidth})}var _=require("../lib/helper"),cls=require("../lib/class"),dom=require("../lib/dom"),instances=require("./instances"),updateScroll=require("./update-scroll");module.exports=function(element){var i=instances.get(element);i.containerWidth=element.clientWidth;i.containerHeight=element.clientHeight;i.contentWidth=element.scrollWidth;i.contentHeight=element.scrollHeight;var existingRails;if(!element.contains(i.scrollbarXRail)){existingRails=dom.queryChildren(element,".ps__scrollbar-x-rail");existingRails.length>0&&existingRails.forEach(function(rail){dom.remove(rail)});dom.appendTo(i.scrollbarXRail,element)}if(!element.contains(i.scrollbarYRail)){existingRails=dom.queryChildren(element,".ps__scrollbar-y-rail");existingRails.length>0&&existingRails.forEach(function(rail){dom.remove(rail)});dom.appendTo(i.scrollbarYRail,element)}if(!i.settings.suppressScrollX&&i.containerWidth+i.settings.scrollXMarginOffset<i.contentWidth){i.scrollbarXActive=!0;i.railXWidth=i.containerWidth-i.railXMarginWidth;i.railXRatio=i.containerWidth/i.railXWidth;i.scrollbarXWidth=getThumbSize(i,_.toInt(i.railXWidth*i.containerWidth/i.contentWidth));i.scrollbarXLeft=_.toInt((i.negativeScrollAdjustment+element.scrollLeft)*(i.railXWidth-i.scrollbarXWidth)/(i.contentWidth-i.containerWidth))}else i.scrollbarXActive=!1;if(!i.settings.suppressScrollY&&i.containerHeight+i.settings.scrollYMarginOffset<i.contentHeight){i.scrollbarYActive=!0;i.railYHeight=i.containerHeight-i.railYMarginHeight;i.railYRatio=i.containerHeight/i.railYHeight;i.scrollbarYHeight=getThumbSize(i,_.toInt(i.railYHeight*i.containerHeight/i.contentHeight));i.scrollbarYTop=_.toInt(element.scrollTop*(i.railYHeight-i.scrollbarYHeight)/(i.contentHeight-i.containerHeight))}else i.scrollbarYActive=!1;i.scrollbarXLeft>=i.railXWidth-i.scrollbarXWidth&&(i.scrollbarXLeft=i.railXWidth-i.scrollbarXWidth);i.scrollbarYTop>=i.railYHeight-i.scrollbarYHeight&&(i.scrollbarYTop=i.railYHeight-i.scrollbarYHeight);updateCss(element,i);if(i.scrollbarXActive)cls.add(element,"ps--active-x");else{cls.remove(element,"ps--active-x");i.scrollbarXWidth=0;i.scrollbarXLeft=0;updateScroll(element,"left",0)}if(i.scrollbarYActive)cls.add(element,"ps--active-y");else{cls.remove(element,"ps--active-y");i.scrollbarYHeight=0;i.scrollbarYTop=0;updateScroll(element,"top",0)}}},{"../lib/class":2,"../lib/dom":3,"../lib/helper":6,"./instances":18,"./update-scroll":20}],20:[function(require,module,exports){"use strict";var instances=require("./instances"),createDOMEvent=function(name){var event=document.createEvent("Event");event.initEvent(name,!0,!0);return event};module.exports=function(element,axis,value){if("undefined"==typeof element)throw"You must provide an element to the update-scroll function";if("undefined"==typeof axis)throw"You must provide an axis to the update-scroll function";if("undefined"==typeof value)throw"You must provide a value to the update-scroll function";if("top"===axis&&0>=value){element.scrollTop=value=0;element.dispatchEvent(createDOMEvent("ps-y-reach-start"))}if("left"===axis&&0>=value){element.scrollLeft=value=0;element.dispatchEvent(createDOMEvent("ps-x-reach-start"))}var i=instances.get(element);if("top"===axis&&value>=i.contentHeight-i.containerHeight){value=i.contentHeight-i.containerHeight;value-element.scrollTop<=1?value=element.scrollTop:element.scrollTop=value;element.dispatchEvent(createDOMEvent("ps-y-reach-end"))}if("left"===axis&&value>=i.contentWidth-i.containerWidth){value=i.contentWidth-i.containerWidth;value-element.scrollLeft<=1?value=element.scrollLeft:element.scrollLeft=value;element.dispatchEvent(createDOMEvent("ps-x-reach-end"))}void 0===i.lastTop&&(i.lastTop=element.scrollTop);void 0===i.lastLeft&&(i.lastLeft=element.scrollLeft);"top"===axis&&value<i.lastTop&&element.dispatchEvent(createDOMEvent("ps-scroll-up"));"top"===axis&&value>i.lastTop&&element.dispatchEvent(createDOMEvent("ps-scroll-down"));"left"===axis&&value<i.lastLeft&&element.dispatchEvent(createDOMEvent("ps-scroll-left"));"left"===axis&&value>i.lastLeft&&element.dispatchEvent(createDOMEvent("ps-scroll-right"));if("top"===axis&&value!==i.lastTop){element.scrollTop=i.lastTop=value;element.dispatchEvent(createDOMEvent("ps-scroll-y"))}if("left"===axis&&value!==i.lastLeft){element.scrollLeft=i.lastLeft=value;element.dispatchEvent(createDOMEvent("ps-scroll-x"))}}},{"./instances":18}],21:[function(require,module,exports){"use strict";var _=require("../lib/helper"),dom=require("../lib/dom"),instances=require("./instances"),updateGeometry=require("./update-geometry"),updateScroll=require("./update-scroll");module.exports=function(element){var i=instances.get(element);if(i){i.negativeScrollAdjustment=i.isNegativeScroll?element.scrollWidth-element.clientWidth:0;dom.css(i.scrollbarXRail,"display","block");dom.css(i.scrollbarYRail,"display","block");i.railXMarginWidth=_.toInt(dom.css(i.scrollbarXRail,"marginLeft"))+_.toInt(dom.css(i.scrollbarXRail,"marginRight"));i.railYMarginHeight=_.toInt(dom.css(i.scrollbarYRail,"marginTop"))+_.toInt(dom.css(i.scrollbarYRail,"marginBottom"));dom.css(i.scrollbarXRail,"display","none");dom.css(i.scrollbarYRail,"display","none");updateGeometry(element);updateScroll(element,"top",element.scrollTop);updateScroll(element,"left",element.scrollLeft);dom.css(i.scrollbarXRail,"display","");dom.css(i.scrollbarYRail,"display","")}}},{"../lib/dom":3,"../lib/helper":6,"./instances":18,"./update-geometry":19,"./update-scroll":20}]},{},[1]);define("views/virtual_assistant/components/answer_inline",["jquery","jquery_ui","underscore_loader","backbone","views/virtual_assistant/components/answer","settings","scrollto","perfectScrollbar"],function($,$ui,_,Backbone,Answer,Settings,ScrollTo,perfectScrollbar){var AnswerInline=Answer.extend({use_unwraplinks:!0,initialize:function(args){Answer.prototype.initialize.call(this,args);this.launcher=args.launcher;this.use_unwraplinks="boolean"==typeof args.use_unwraplinks?args.use_unwraplinks:!0;this.append_to=args.append_to||"bottom";this.backlink_text=args.backlink_text||"Back";this.backlink_classes=args.backlink_classes||"back_link btn btn-mini";this.$scrollable_el=$(args.scrollable_el||"#answer");var _this=this;if(void 0!==window.cvVaCollectionLength&&window.cvVaCollectionLength>1&&null!==localStorage.getItem(Settings.businessName+"-cvVaSemanticsFAQs")){_this.$el.parent().parent().find(".cv-chat-va-typing").remove();_this.$el.parent().find(".suggestions").hide();_this.$el.parent().parent().find("#cv-chat-user-entry").prop("disabled",!1)}_this.$el.parent().parent().find("#cv-lc-btn").on("click",function(evt){evt.preventDefault();_this.model.extra_params.lcBtnClicked=!0;window.ask_question("livechat")})},unwrapLinks:function(){console.log("unwrapLinks");this.$el.find("a").each(function(){var $el=$(this);$el.hasClass("back_link")?$el.remove():(!$el.parent(".cv-chat-connector").hasClass("cv-sematic-connector")||Settings.unwrapAllLinks)&&$el.replaceWith($(this).text())});this.$el.find(".cv-chat-connector").each(function(){var $el=$(this);(!$el.hasClass("cv-sematic-connector")||Settings.unwrapAllLinks)&&$el.removeClass("cv-chat-connector").addClass("cv-chat-connector-disabled").unbind("click mouseenter mouseleave").add($(this).children("span")).css({"background-color":Settings.connectorsBackgroundColor,color:Settings.connectorsFontColor,"pointer-events":"none"})});"default"===Settings.icsStyle?this.$el.find(".cv-chat-connector-ics").each(function(){var $el=$(this);$el.unbind("click").attr("disabled",!0).addClass("cv-chat-connector-ics-disabled")}):"thumbs"===Settings.icsStyle&&this.$el.find(".thumbs-ics").each(function(){var $el=$(this);$el.hide()});window.processingRequest=!1},addTransaction:function($transaction,model){var _this=this,dt=new Date;dt.getHours()>12?"p":"a",dt.getHours()>12?dt.getHours()%12:dt.getHours(),dt.getMinutes()<10?"0"+dt.getMinutes():dt.getMinutes();"bottom"==_this.append_to?_this.$el.append($transaction):_this.$el.prepend($transaction);if("conversational"===Settings.vaChatView&&_this.collection.length>0){window.CVMobile===!1&&_this.collection.length>1?Settings.shrunkenUI===!0?$transaction.find(".cv-va-bubble").addClass("va-time-stamp-shim"):$transaction.find(".va-time-stamp").addClass("va-time-stamp-shim"):$transaction.find(".cv-va-bubble").addClass("va-time-stamp-shim");$transaction.find(".cv-question-link-connector").wrap('<li class="list-group-item cv-chat-connector"></li>');$transaction.find(".cv-question-link-connector").after('<span class="pull-right"><i class="'+Settings.connectorCSS.icon+'"></i></span>')}},addBackLink:function(model,$el){var _this=this;if($.trim(model.get("dtreenodeid")).length&&"1"==$.trim(model.get("backnavflag"))&&"false"===$.trim(model.get("backnavdisabled"))){$back=$("<a>").attr("href","#").addClass(_this.backlink_classes).text(_this.backlink_text).click(function(e){e.preventDefault();e.stopPropagation();if(window.processingRequest===!1||void 0===window.processingRequest){window.processingRequest=!0;_this.$el.parent().parent().find("#cv-chat-user-entry").prop("disabled",!0);_this.model.backnavRequest()}});$back.prepend('<i class="fa fa-arrow-left" aria-hidden="true"></i>');"normal"===Settings.vaCaption.type?$el.find(".cv-va-bubble").append($back):"iMessage"===Settings.vaCaption.type&&setTimeout(function(){_this.$el.parent().parent().find("#cv-chat-user-entry").prop("disabled",!1);window.CVMobile===!1&&_this.$el.parent().parent().find("#cv-chat-user-entry").focus();$el.find(".cv-va-bubble").last().append($back)},1500)}},render:function(model){console.log("render answer inline");var _this=this;_this.$el.parent().parent().find("#cv-chat-loader-layer").hide();if(window.CVVA.inputLauncher&&window.CVVA.inputLauncher.trigger===!0){window.CVVA.inputLauncher.trigger=!1;_this.$el.parent().parent().find("#cv-chat-user-entry").prop("disabled",!0);!function initCheck(){window.CVVA.initCompleted===!0?window.CVVA.inputLauncher.userQuestion&&model.askInputLauncherQuestion(window.CVVA.inputLauncher.userQuestion):setTimeout(function(){initCheck()},0)}()}window.CVVA.model.ident=model.get("ident");model.get("entrysuggestions")&&"string"==typeof model.get("entrysuggestions")&&(window.placeholderSuggestions=model.get("entrysuggestions").replace(/[\[\]]|"+/g,"").split(","));window.CVSaveAttributes();if("true"===model.get("livechatavailable")&&Settings.cvLCbtn.enabled===!0){_this.$el.parent().parent().find("#cv-lc-btn").show();_this.$el.parent().parent().find("#cv-font-size").css("bottom","118px")}else"false"===model.get("livechatavailable")&&_this.$el.parent().parent().find("#cv-lc-btn").hide();clearInterval(window.proactiveEndSessionInterval);var enableProactiveEndSession=model.get("autosubmitmode")||Settings.enableProactiveEndSession||!1,proactiveEndSessionWaitTime=1e3*parseInt(model.get("autosubmitwaittime"))||Settings.proactiveEndSessionWaitTime||1e4;if("true"===enableProactiveEndSession&&window.cvVaCollectionLength>0){window.proactiveEndSessionTriggered=!0;window.proactiveEndSessionInterval=setInterval(function(){model.askQuestion(Settings.proactiveEndSessionCommand)},proactiveEndSessionWaitTime)}else window.proactiveEndSessionTriggered=!1;if(Settings.persistenceEnabled===!0){window.cvCrossStorage.onConnect().then(function(){return window.cvCrossStorage.set(Settings.businessName+"-cvVaTimestamp",Date.now())});localStorage.setItem(Settings.businessName+"-cvVaTimestamp",Date.now())}if(void 0!==window.cvVaCollectionLength&&1==_this.collection.length){1===window.cvVaCollectionLength&&(window.cvVaCollectionLength=2);_this.collection.length=window.cvVaCollectionLength}window.cvVaCollectionLength=_this.collection.length;_this.$el.css("pointer-events","all");Settings.avatar.enabled===!0&&window.cvVaCollectionLength<2&&_this.$el.parent().parent().find("#cv-chat-img-avatar").show();window.CVMobile===!0&&$(".cv-va-bootstrap #cv-chat-user-entry").blur();var livechatOffer="false";void 0!==model.get(Settings.livechatOfferETV)&&(livechatOffer=model.get(Settings.livechatOfferETV).toLowerCase());"true"===livechatOffer&&this.$el.fadeOut("fast",function(){_this.$el.parent().parent().find("#cv-chat-loader-layer").show()});var semanticFAQs=model.get("faqitems").suggestedfaqlist.semanticfaqs.semanticfaq,connectors=model.get("connectors"),emptyConnector=!1;_.isArray(connectors)&&connectors.forEach(function(connector){""===connector.DefaultClickText&&(emptyConnector=!0)});if(_this.collection.length>1&&"false"===livechatOffer&&_.isArray(semanticFAQs)){Settings.vaCaption.enabled===!0&&"normal"===Settings.vaCaption.type&&_this.$el.parent().parent().find("#cv-chat-form").before('<span class="cv-chat-va-typing">'+Settings.vaCaption.text+"<span>.</span><span>.</span><span>.</span></span>");_this.$el.parent().parent().find("#cv-chat-user-entry").prop("disabled",!0);_this.$el.parent().find(".suggestions").show()}var startChat=function(){window.CVSaveAttributes();window.cvCrossStorage.onConnect().then(function(){return window.cvCrossStorage.del(Settings.businessName+"-cvVaSemanticsFAQs",JSON.stringify(semanticFAQs))});localStorage.removeItem(Settings.businessName+"-cvVaSemanticsFAQs");if(_this.collection.length>1){_this.$el.parent().parent().find(".cv-chat-va-typing").remove();_this.$el.parent().find(".suggestions").hide();_this.$el.parent().parent().find("#cv-chat-user-entry").prop("disabled",!1);window.CVMobile===!1&&_this.$el.parent().parent().find("#cv-chat-user-entry").focus()}if(model.get("botanswer").trim().length>0){window.cvCrossStorage.onConnect().then(function(){return window.cvCrossStorage.set(Settings.businessName+"-cvVaInitCall",!0)});localStorage.setItem(Settings.businessName+"-cvVaInitCall",!0);_this.use_unwraplinks&&_this.unwrapLinks();var $transaction,$agentfeedback="";if("Root.Agent"===model.get("currentChannel")){$agentfeedback='<span style="margin-left:10px"><a class="agent_survey_overlay" href="#">Help improve this answer</a></span>';$(".agent_survey_overlay").on("click",function(){$("#cv-agent-survey-modal textarea").val("");$("#cv-agent-survey-modal input:checked").prop("checked",!1);$("#cv-agent-survey-modal").show()});if(window.CVVA&&window.CVVA.model){window.CVVA.model.answerID=model.get("answerID");window.CVVA.model.answerLinkID=model.get("answerLinkID");window.CVVA.model.recognitionID=model.get("recognitionID");window.CVVA.model.conditionLinkID=model.get("conditionLinkID");window.CVVA.model.conditionID=model.get("conditionID");window.CVVA.model.transactionID=model.get("transactionID")}}if(_this.collection.length>1){$transaction=_this.$el.find(".cv-chat-transaction-panel").last();"normal"===Settings.vaCaption.type?$transaction=$("<div>").addClass("panel panel-defaXult cv-chat-transaction-panel"):"iMessage"===Settings.vaCaption.type&&($transaction=_this.$el.find(".cv-chat-transaction-panel").last())}else $transaction=$("<div>").addClass("cv-init-wrapper");var cvChatUserEntryCSS;if(2==_this.collection.length){cvChatUserEntryCSS={fontSize:Settings.inputFontSize,height:Settings.submitBtn.height};window.CVMobile===!0&&(cvChatUserEntryCSS={fontSize:Settings.input.mobileFontSize,height:"50px"});_this.$el.parent().parent().find("#cv-chat-user-entry").css(cvChatUserEntryCSS);Settings.useImageButton===!1&&_this.$el.parent().parent().find("#cv-chat-submit").empty().append('<i class="cv-submit-icon fa '+Settings.submitBtn.fontAwesome+'" aria-hidden="true"></i>'+Settings.submitBtn.interactionText);_this.$el.parent().parent().find(".cv-print-icon").show();if(window.CVMobile===!1&&void 0===window.resizableAttached){window.resizableAttached=!0;window.CVVA.resizable()}}var userinputtitle=model.get("userinputtitle")||"We found an answer for...",userQuestion="";model.get("relatedlistprompttext");userQuestion=""!==$.trim(model.get("question"))?model.get("question").substr(0,1).toUpperCase()+model.get("question").substr(1):previousQuestion.substr(0,1).toUpperCase()+previousQuestion.substr(1);var dt=new Date,mer=dt.getHours()>12?"p":"a",hh=dt.getHours()>12?dt.getHours()%12:dt.getHours(),mm=dt.getMinutes()<10?"0"+dt.getMinutes():dt.getMinutes(),time=hh+":"+mm+mer;if(""===$.trim(model.get("question"))&&""===previousQuestion||_.isArray(semanticFAQs)||_.isArray(connectors)&&emptyConnector!==!0)_.isArray(semanticFAQs)||_.isArray(connectors)&&emptyConnector!==!0||(Settings.bubbleInit===!0?$transaction.html('<div class="cv-init-message">'+model.get("botanswer")+"</div>"):$transaction.html(model.get("botanswer")));else if("conversational"===Settings.vaChatView){if(void 0!==model.get("hideuserentry")&&"true"==model.get("hideuserentry"))_this.$el.find(".cv-va-bubble").last().html(model.get("botanswer")).after($('<span class="va-time-stamp">'+Settings.virtualAgentName+"&nbspat&nbsp"+time+"</span>").append($agentfeedback));else if(void 0!==model.get("hideuserentry")&&"true"==model.get("hideuserentry"))_this.$el.find(".cv-va-bubble").last().html(model.get("botanswer")).after($('<span class="va-time-stamp">'+Settings.virtualAgentName+"&nbspat&nbsp"+time+"</span>").append($agentfeedback));else if("normal"===Settings.vaCaption.type)$transaction.html('<div class="col-xs-12"><div class="cv-va-bubble">'+model.get("botanswer")+'</div><span class="va-time-stamp">'+Settings.virtualAgentName+"&nbspat&nbsp"+time+"</span></div>");else if("iMessage"===Settings.vaCaption.type){_this.$el.parent().parent().find("#cv-chat-user-entry").prop("disabled",!0);var answer_parts=!1;void 0!==model.get("answerparts")&&""!=model.get("answerparts")&&Settings.answerparts&&(answer_parts=!0);void 0===semanticFAQs&&setTimeout(function(){if(answer_parts===!1){_this.$el.parent().parent().find("#cv-chat-user-entry").prop("disabled",!1);window.CVMobile===!1&&_this.$el.parent().parent().find("#cv-chat-user-entry").focus();_this.$el.find(".cv-va-bubble").last().html(model.get("botanswer")).after($('<span class="va-time-stamp">'+Settings.virtualAgentName+"&nbspat&nbsp"+time+"</span>").append($agentfeedback))}else if(model.get("answerparts")){var answerparts=model.get("answerparts");_.each(answerparts,function(answerpart){if(void 0===answerpart[0]){_this.$el.parent().parent().find("#cv-chat-user-entry").prop("disabled",!1);window.CVMobile===!1&&_this.$el.parent().parent().find("#cv-chat-user-entry").focus();_this.$el.find(".cv-va-bubble").last().html(answerpart.text[0]).after($('<span class="va-time-stamp">'+Settings.virtualAgentName+"&nbspat&nbsp"+time+"</span>").append($agentfeedback))}else{_this.$el.find(".cv-va-bubble").last().html(answerpart[0].text[0]).after($('<span class="va-time-stamp">'+Settings.virtualAgentName+"&nbspat&nbsp"+time+"</span>").append($agentfeedback));answerpart.splice(0,1);var offset=0,answerpartLength=answerpart.length;$.each(answerpart,function(index,answer){setTimeout(function(){_this.$el.find(".cv-chat-transaction-panel").last().append('<div class="col-xs-12"><div class="cv-va-bubble cv-va-answerpart"><span class="cv-chat-va-imessage">'+Settings.vaCaption.text+"<span>.</span><span>.</span><span>.</span></span></div></div>");setTimeout(function(){_this.$el.find(".cv-va-bubble").last().html(answer.text).after($('<span class="va-time-stamp">'+Settings.virtualAgentName+"&nbspat&nbsp"+time+"</span>").append($agentfeedback));if(index===answerpartLength-1){_this.$el.parent().parent().find("#cv-chat-user-entry").prop("disabled",!1);window.CVMobile===!1&&_this.$el.parent().parent().find("#cv-chat-user-entry").focus();_this.$el.scrollTo($transaction,500)}window.CVSaveAttributes()},500);_this.$el.find(".va-time-stamp").last().remove();_this.$el.find(".col-xs-12").eq(-2).css("margin-bottom","2px");_this.$el.scrollTo($transaction,500)},1e3+offset);offset+=1500})}})}Settings.avatar.enabled===!0&&$(".cv-va-bootstrap #cv-toggle-avatar").is(":visible")&&($("#cv-toggle-avatar").is(":checked")||$transaction.find(".va-time-stamp").css("left","6px"));window.CVSaveAttributes()},1500)}if(window.CVMobile===!1)if(Settings.shrunkenUI===!0){$transaction.find(".cv-va-bubble").addClass("va-time-stamp-shim");$transaction.find(".panel-heading").addClass("va-time-stamp-shim")}else{$transaction.find(".va-time-stamp").addClass("va-time-stamp-shim");$transaction.find(".user-cv-time-stamp").addClass("va-time-stamp-shim")}else{$transaction.find(".cv-va-bubble").addClass("va-time-stamp-shim");$transaction.find(".panel-heading").addClass("va-time-stamp-shim")}}else void 0!==model.get("hideuserentry")&&"true"==model.get("hideuserentry")?$transaction.html('<div class="clearfix"></div></div><div class="cv-va-bubble">'+model.get("botanswer")+"</div>"):$transaction.html('<div class="panel-heading cv-chat-transaction-heading"><div class="panel-title pull-left cv-chat-transaction-title"><span>'+userinputtitle+' </span><span class="cv-chat-transaction-entry">'+userQuestion+'</span></div><div class="clearfix"></div></div><div class="cv-va-bubble">'+model.get("botanswer")+"</div>");
if(_.isArray(semanticFAQs))if("conversational"===Settings.vaChatView)if(window.CVMobile===!1)if(Settings.shrunkenUI===!0){$transaction.find(".cv-va-bubble").addClass("va-time-stamp-shim");$transaction.find(".panel-heading").addClass("va-time-stamp-shim")}else{$transaction.find(".va-time-stamp").addClass("va-time-stamp-shim");$transaction.find(".user-cv-time-stamp").addClass("va-time-stamp-shim")}else{$transaction.find(".cv-va-bubble").addClass("va-time-stamp-shim");$transaction.find(".panel-heading").addClass("va-time-stamp-shim")}else $transaction.html('<div class="panel-heading cv-chat-transaction-heading"><div class="panel-title pull-left cv-chat-transaction-title"><span>'+userinputtitle+' </span><span class="cv-chat-transaction-entry">'+model.get("question")+'</span></div><div class="clearfix"></div></div>');_this.use_removestyles&&($transaction=_this.removeStyles($transaction));_this.renderConnectors(model,$transaction);_this.addBackLink(model,$transaction);_this.addTransaction($transaction);_this.$el.scrollTo($transaction,500);"iMessage"===Settings.vaCaption.type&&setTimeout(function(){_this.$el.scrollTo($transaction,500);window.CVSaveAttributes()},1500);return _this}window.CVSaveAttributes();window.CVSaveAttributes()},previousQuestion="";_this.collection.length>1&&void 0!==_this.collection.models[_this.collection.length-2]&&(previousQuestion=$.trim(_this.collection.models[_this.collection.length-2].get("question")));1==_this.collection.length&&startChat();if(_this.collection.length>1&&_.isArray(semanticFAQs)&&(""!==$.trim(model.get("question"))||""!==previousQuestion)){window.cvCrossStorage.onConnect().then(function(){return window.cvCrossStorage.set(Settings.businessName+"-cvVaSemanticsFAQs",JSON.stringify(semanticFAQs))});localStorage.setItem(Settings.businessName+"-cvVaSemanticsFAQs",JSON.stringify(semanticFAQs));"normal"===Settings.vaCaption.type?window.setTimeout(function(){startChat()},2500):startChat()}else _this.collection.length>1&&!_.isArray(semanticFAQs)&&(""!==$.trim(model.get("question"))||""!==previousQuestion)&&startChat();if(void 0!==model.get("userentryallowed")&&"false"==model.get("userentryallowed")){this.$el.parent().parent().find("#cv-chat-user-entry").hide();this.$el.parent().parent().find(".cv-chat-footer #cv-chat-submit").removeClass("disabled").removeProp("disabled")}else if(void 0!==model.get("userentryallowed")&&"true"==model.get("userentryallowed")){this.$el.parent().parent().find("#cv-chat-answer-history").is(":visible")&&this.$el.parent().parent().find("#cv-chat-user-entry").show();this.$el.parent().parent().find(".cv-chat-footer #cv-chat-submit").addClass("disabled").prop("disabled",!0)}if("true"===model.get("forcesessionclose")){if("cox"===Settings.businessName&&window.utag&&window.utag.link){window.utag.link({eventNames:"cvEndNoEscalation"});window.CVVA.activeCloseTracked=!0}if("true"!==model.get(Settings.livechatOfferETV).toLowerCase()){void 0!==_this.launcher&&_this.launcher.remove();clearInterval(window.proactiveEndSessionInterval);clearInterval(window.cvVaSaveState);localStorage.removeItem(Settings.businessName+"-cvVaBootstrapState");localStorage.removeItem(Settings.businessName+"-cvVaModel");localStorage.removeItem(Settings.businessName+"-cvVaStyles");localStorage.removeItem(Settings.businessName+"-cvVaInitCall");window.forcesessionclose=!0;window.cvVaCollectionLength=void 0;window.cvVaModel=void 0;window.cvVaMinimized=void 0;window.resizableAttached=void 0;window.sessionFlushInterval=setInterval(function(){clearInterval(window.proactiveEndSessionInterval);clearInterval(window.cvVaSaveState);localStorage.removeItem(Settings.businessName+"-cvVaBootstrapState");localStorage.removeItem(Settings.businessName+"-cvVaModel");localStorage.removeItem(Settings.businessName+"-cvVaStyles");localStorage.removeItem(Settings.businessName+"-cvVaInitCall");window.forcesessionclose=!0;window.cvVaCollectionLength=void 0;window.cvVaModel=void 0;window.cvVaMinimized=void 0;window.resizableAttached=void 0;window.localInitCall=void 0},0);setTimeout(function(){window.cvCrossStorage.onConnect().then(function(){return window.cvCrossStorage.del(Settings.businessName+"-cvVaBootstrapState",Settings.businessName+"-cvVaModel",Settings.businessName+"-cvVaStyles",Settings.businessName+"-cvVaInitCall")}).then(function(res){window.loadFromStorage=!1;_this.$el.parent().parent().find("#cv-chat-user-entry").hide();_this.$el.parent().parent().find(".cv-chat-footer #cv-chat-submit").removeClass("disabled").removeProp("disabled");"mainFrame"==model.get("linktarget")&&(window.location.href=model.get("linkurl"));model.closeSession();clearInterval(window.sessionFlushInterval)})},150)}else{clearInterval(window.proactiveEndSessionInterval);clearInterval(window.cvVaSaveState);model.closeSession()}}else if("true"===model.get("forceescalate")){if("true"!==model.get(Settings.livechatOfferETV).toLowerCase()){clearInterval(window.proactiveEndSessionInterval);clearInterval(window.cvVaSaveState);window.cvCrossStorage.onConnect().then(function(){window.cvCrossStorage.set("cvSessionEndedExternal_VA","true")});localStorage.setItem("cvSessionEndedExternal_VA","true")}}else"mainFrame"===model.get("linktarget")?window.location.href=model.get("linkurl"):"newTab"===model.get("linktarget")?window.open(model.get("linkurl"),"_blank"):"parent"===model.get("linktarget")&&(window.opener?window.opener.location.href=model.get("linkurl"):window.open(model.get("linkurl"),"_blank"));_this.autoAskQuestion(model)},renderConnectors:function(model,$transaction){var livechatOffer="false";void 0!==model.get(Settings.livechatOfferETV)&&(livechatOffer=model.get(Settings.livechatOfferETV).toLowerCase());var connectors=model.get("connectors"),ICSappended=model.get("icsappended")||"false";if(_.isArray(connectors)&&connectors.length&&"false"==ICSappended){if("false"==livechatOffer&&void 0!==model.get("userentryallowed")&&"false"==model.get("userentryallowed")){this.$el.parent().parent().find("#cv-chat-user-entry").hide();this.$el.parent().parent().find(".cv-chat-footer #cv-chat-submit").removeClass("disabled").removeProp("disabled")}}else if("false"==livechatOffer){this.$el.parent().parent().find(".cv-chat-footer #cv-chat-submit").addClass("disabled").prop("disabled","disabled");this.$el.parent().parent().find("#cv-chat-answer-history").is(":visible")&&this.$el.parent().parent().find("#cv-chat-user-entry").show()}var $li,_this=this,$el=$("<ul>").addClass("list-group"),semanticFAQs=model.get("faqitems").suggestedfaqlist.semanticfaqs.semanticfaq,semanticFAQsLimit=model.get("maxsemanticfaqs")||3,relatedlistprompttext=model.get("relatedlistprompttext");if(_.isArray(semanticFAQs)&&semanticFAQs.length){$el.append(relatedlistprompttext);semanticFAQs=semanticFAQs.slice(0,semanticFAQsLimit);_.each(semanticFAQs,function(semanticFAQ){if($.trim(semanticFAQ.QuestionText).length){$li=$("<li>").addClass("list-group-item cv-chat-connector cv-sematic-connector").append(_this.renderSemanticFAQ(semanticFAQ)).click(function(evt){evt.preventDefault();_this.$el.parent().parent().find("#cv-chat-user-entry").prop("disabled",!0);model.faqRequest(semanticFAQ.RecognitionId,semanticFAQ.AnswerId,semanticFAQ.QuestionText,semanticFAQ.subtype,"")});$li.append('<span class="pull-right"><i class="'+Settings.connectorCSS.icon+'"></i></span>');$li.find(".pull-right").css({color:Settings.connectorsFontColor});Settings.semanticTextAlignRight===!0&&$li.css("text-align","right");$el.append($li)}})}else if(void 0!==semanticFAQs){$el.append(relatedlistprompttext);$el.addClass("connector-follow-on");if($.trim(semanticFAQs.QuestionText).length){$li=$("<li>").addClass("list-group-item cv-chat-connector cv-sematic-connector").append(_this.renderSemanticFAQ(semanticFAQs)).click(function(evt){evt.preventDefault();_this.$el.parent().parent().find("#cv-chat-user-entry").prop("disabled",!0);model.faqRequest(semanticFAQs.RecognitionId,semanticFAQs.AnswerId,semanticFAQs.QuestionText,semanticFAQs.subtype,"")});$li.append('<span class="pull-right"><i class="'+Settings.connectorCSS.icon+'"></i></span>');$li.find(".pull-right").css({color:Settings.connectorsFontColor});Settings.semanticTextAlignRight===!0&&$li.css("text-align","right");$el.append($li)}}else $el.removeClass("list-group");if("default"===Settings.icsStyle){var BkgColors=[Settings.firstIcsBtnBkgColor,Settings.secondIcsBtnBkgColor,Settings.thirdIcsBtnBkgColor],FontColors=[Settings.firstIcsBtnFontColor,Settings.secondIcsBtnFontColor,Settings.thirdIcsBtnFontColor],ibkgColor=0,iColor=0;if(_.isArray(connectors)&&connectors.length&&"true"==ICSappended){$el.addClass("ics-btn-group");_.each(connectors,function(connector){if($.trim(connector.DefaultClickText).length){$button=$("<li>").addClass("btn cv-chat-connector-ics").append(_this.renderConnector(connector)).click(function(evt){evt.preventDefault();evt.stopPropagation();if(window.processingRequest===!1||void 0===window.processingRequest){window.processingRequest=!0;model.dtreeConnectorRequest(connector.ConnectorId,model.get("answerID"),connector.DefaultClickText)}});$button.css({"background-color":BkgColors[ibkgColor],color:FontColors[iColor],"font-weight":"bold"});ibkgColor=(ibkgColor+1)%BkgColors.length;$button.children(":first").css("color",FontColors[iColor]);iColor=(iColor+1)%FontColors.length;$button.addClass("cv-ics-option");$el.append($button)}})}else if(_.isArray(connectors)&&connectors.length){$el.addClass("list-group connector-follow-on");_.each(connectors,function(connector){if($.trim(connector.DefaultClickText).length){$li=$("<li>").addClass("list-group-item cv-chat-connector cv-connector").append(_this.renderConnector(connector)).click(function(evt){evt.preventDefault();evt.stopPropagation();if(window.processingRequest===!1||void 0===window.processingRequest){window.processingRequest=!0;_this.$el.parent().parent().find("#cv-chat-user-entry").prop("disabled",!0);model.dtreeConnectorRequest(connector.ConnectorId,model.get("answerID"),connector.DefaultClickText)}});$li.append('<span class="pull-right"><i class="'+Settings.connectorCSS.icon+'"></i></span>');$li.find(".pull-right").css({color:Settings.connectorsFontColor});Settings.semanticTextAlignRight===!0&&$li.css("text-align","right");$el.append($li)}})}}else if("thumbs"===Settings.icsStyle){nameICSclass=["fa fa-thumbs-up","fa fa-thumbs-down","fa fa-phone"];classICS=0;if(_.isArray(connectors)&&connectors.length&&"true"==ICSappended){$el.addClass("btn-group ics-thumb-btn-group");_.each(connectors,function(connector){if($.trim(connector.DefaultClickText).length){$i=$("<i>").addClass("btn btn-default thumbs-ics").append(_this.renderConnector(connector)).click(function(evt){evt.preventDefault();evt.stopPropagation();if(window.processingRequest===!1||void 0===window.processingRequest){window.processingRequest=!0;model.dtreeConnectorRequest(connector.ConnectorId,model.get("answerID"),connector.DefaultClickText)}});$i.addClass(nameICSclass[classICS]);classICS=(classICS+1)%nameICSclass.length;$el.append($i).find("a").text("")}})}else if(_.isArray(connectors)&&connectors.length&&window.cvVaCollectionLength>1){$el.addClass("list-group connector-follow-on");_.each(connectors,function(connector){if($.trim(connector.DefaultClickText).length){$li=$("<li>").addClass("list-group-item cv-chat-connector cv-connector").append(_this.renderConnector(connector)).click(function(evt){evt.preventDefault();evt.stopPropagation();if(window.processingRequest===!1||void 0===window.processingRequest){window.processingRequest=!0;model.dtreeConnectorRequest(connector.ConnectorId,model.get("answerID"),connector.DefaultClickText)}});$li.append('<span class="pull-right"><i class="'+Settings.connectorCSS.icon+'"></i></span>');$li.find(".pull-right").css({color:Settings.connectorsFontColor});Settings.semanticTextAlignRight===!0&&$li.css("text-align","right");$el.append($li)}})}}if(void 0!==model.get("disambiguationoptions")){var disambiguationoptions=model.get("disambiguationoptions").option;if(_.isArray(disambiguationoptions)&&disambiguationoptions.length){$el.addClass("list-group");_.each(disambiguationoptions,function(disambiguationoption){if($.trim(disambiguationoption.clicktext).length){$li=$("<li>").addClass("list-group-item cv-chat-connector cv-disambiguation-connector").append(_this.renderDisambiguationOptions(disambiguationoption)).click(function(evt){evt.preventDefault();evt.stopPropagation();if(window.processingRequest===!1||void 0===window.processingRequest){window.processingRequest=!0;_this.$el.parent().parent().find("#cv-chat-user-entry").prop("disabled",!0);model.disambiguationRequest(disambiguationoption.clicktext,disambiguationoption.answerid)}});$li.append('<span class="pull-right"><i class="'+Settings.connectorCSS.icon+'"></i></span>');$li.find(".pull-right").css({color:Settings.connectorsFontColor});Settings.semanticTextAlignRight===!0&&$li.css("text-align","right");$el.append($li)}})}}var dt=(model.get("autosubmitmode")||Settings.enableProactiveEndSession||!1,new Date),mer=dt.getHours()>12?"p":"a",hh=dt.getHours()>12?dt.getHours()%12:dt.getHours(),mm=dt.getMinutes()<10?"0"+dt.getMinutes():dt.getMinutes(),time=hh+":"+mm+mer;if($el.children("li").length>0)if($transaction.find(".cv-va-bubble").length>0){if("normal"===Settings.vaCaption.type)$transaction.find(".cv-va-bubble").append($el);else if("iMessage"===Settings.vaCaption.type){_this.$el.parent().parent().find("#cv-chat-user-entry").prop("disabled",!0);var answer_parts=!1;void 0!==model.get("answerparts")&&""!=model.get("answerparts")&&Settings.answerparts&&(answer_parts=!0);var $agentfeedback=$agentfeedback||"";setTimeout(function(){if(answer_parts===!1){_this.$el.parent().parent().find("#cv-chat-user-entry").prop("disabled",!1);window.CVMobile===!1&&_this.$el.parent().parent().find("#cv-chat-user-entry").focus();_this.$el.parent().find(".cv-va-bubble").last().html(model.get("botanswer")).append($el).after($('<span class="va-time-stamp">'+Settings.virtualAgentName+"&nbspat&nbsp"+time+"</span>").append($agentfeedback))}else if(model.get("answerparts")){var answerparts=model.get("answerparts");_.each(answerparts,function(answerpart){if(void 0===answerpart[0]){_this.$el.parent().parent().find("#cv-chat-user-entry").prop("disabled",!1);window.CVMobile===!1&&_this.$el.parent().parent().find("#cv-chat-user-entry").focus();_this.$el.parent().find(".cv-va-bubble").last().html(answerpart.text[0]).append($el).after($('<span class="va-time-stamp">'+Settings.virtualAgentName+"&nbspat&nbsp"+time+"</span>").append($agentfeedback))}else{_this.$el.parent().find(".cv-va-bubble").last().html(answerpart[0].text[0]).after($('<span class="va-time-stamp">'+Settings.virtualAgentName+"&nbspat&nbsp"+time+"</span>").append($agentfeedback));answerpart.splice(0,1);var offset=0,answerpartLength=answerpart.length;$.each(answerpart,function(index,answer){setTimeout(function(){_this.$el.find(".cv-chat-transaction-panel").last().append('<div class="col-xs-12"><div class="cv-va-bubble cv-va-answerpart"><span class="cv-chat-va-imessage">'+Settings.vaCaption.text+"<span>.</span><span>.</span><span>.</span></span></div></div>");setTimeout(function(){_this.$el.find(".cv-va-bubble").last().html(answer.text).after($('<span class="va-time-stamp">'+Settings.virtualAgentName+"&nbspat&nbsp"+time+"</span>").append($agentfeedback));if(index===answerpartLength-1){_this.$el.parent().parent().find("#cv-chat-user-entry").prop("disabled",!1);window.CVMobile===!1&&_this.$el.parent().parent().find("#cv-chat-user-entry").focus();_this.$el.find(".cv-va-bubble").last().append($el);_this.$el.scrollTo($transaction,500)}window.CVSaveAttributes()},500);_this.$el.find(".va-time-stamp").last().remove();_this.$el.find(".col-xs-12").eq(-2).css("margin-bottom","2px");_this.$el.scrollTo($transaction,500)},1e3+offset);offset+=1500})}})}},1500)}}else{if("conversational"===Settings.vaChatView&&window.cvVaCollectionLength>1)Settings.semanticAppendBotAnswer===!0?"normal"===Settings.vaCaption.type?$transaction.append('<div class="col-xs-12"><div class="cv-va-bubble">'+model.get("botanswer")+'</div><span class="va-time-stamp">'+Settings.virtualAgentName+"&nbspat&nbsp"+time+"</span></div>"):"iMessage"===Settings.vaCaption.type:$transaction.append('<div class="col-xs-12"><div class="cv-va-bubble"></div></div>');else if(_.isArray(connectors)&&connectors.length&&window.cvVaCollectionLength<2)if(1===window.cvVaCollectionLength){$transaction.append('<div class="col-xs-12"><div class="cv-init-message">'+model.get("botanswer")+"</div></div>");$transaction.find(".cv-init-message").append($el)}else{$transaction.append('<div class="col-xs-12"><div class="cv-va-bubble">'+model.get("botanswer")+"</div></div>");$transaction.find(".cv-va-bubble").append($el)}else $transaction.append('<div class="col-xs-12"><div class="cv-va-bubble"></div></div>');"normal"===Settings.vaCaption.type?$transaction.find(".cv-va-bubble").append($el):"iMessage"===Settings.vaCaption.type&&(1==window.cvVaCollectionLength?_this.$el.parent().find(".cv-va-bubble").last().append($el):setTimeout(function(){_this.$el.parent().find(".cv-va-bubble").last().html(model.get("botanswer")).append($el).after('<span class="va-time-stamp">'+Settings.virtualAgentName+"&nbspat&nbsp"+time+"</span>").after('<a href="#">test</a>')},1500))}},autoAskQuestion:function(model){var _this=this;if("altice"===Settings.businessName&&1===_this.collection.length)if(localStorage.getItem(Settings.businessName+"-pcsData_genesys")){var escalationData=JSON.parse(localStorage.getItem(Settings.businessName+"-pcsData_genesys"));!function initCheck(){window.CVVA.initCompleted===!0?model.askQuestion(escalationData.subject):setTimeout(function(){initCheck()},0)}()}else console.log("empty PCS data")}});return AnswerInline});define("views/virtual_assistant/components/autocomplete",["jquery","jquery_ui","underscore_loader","backbone","xml2json","settings"],function($,ui,_,Backbone,XmlToJson,Settings){var AutoComplete=Backbone.View.extend({el:"#cv-chat-user-entry",request_method:"POST",threshold:3,maxRows:12,jsonp:!1,events:{keyup:"render"},initialize:function(options){Backbone.View.prototype.initialize.call(this,options);this.jsonp=options.jsonp||this.jsonp;this.endpoint=options.endpoint||this.endpoint;this.maxRows=options.maxRows||this.maxRows;this.threshold=options.threshold||this.threshold;if(null===this.endpoint)throw"You must define an endpoint for your autocomplete results";var _this=this;this.$el.autocomplete({classes:{"cv-ui-autocomplete":Settings.autocompleteClass},messages:{noResults:Settings.ariaLabel.acNoResultsMsg,results:function(amount){return amount+(amount>1?Settings.ariaLabel.acResultsPlural:Settings.ariaLabel.acResultSingular)+Settings.ariaLabel.acAvailableResultsNav}},minLength:options.threshold||this.threshold,position:{my:Settings.autocompletePosition+" bottom",at:Settings.autocompletePosition+" top-5",collision:"none"},appendTo:_this.$el.parent(),select:function(event,ui){event.preventDefault();if("Enter"===event.key){_this.$el.val("");_this.model.askQuestion(ui.item.value);_this.$el.autocomplete("close");_this.$el.prop("disabled",!0);_this.$el.submit()}},source:function(req,res){_this.getResults(req.term,res)},open:function(event,ui){for(var i=0;i<$(".cv-va-bootstrap .cv-ui-menu-item").length;i++){$($(".cv-va-bootstrap .cv-ui-menu-item")[i]).on("click",function(){_this.model.askQuestion($(this).find("div").text());_this.$el.val("");_this.$el.autocomplete("close");_this.$el.prop("disabled",!0)});$($(".cv-va-bootstrap .cv-ui-menu-item")[i]).keypress(function(e){var key=e.which;if(13==key){_this.model.askQuestion($(this).find("div").text());_this.$el.val("");_this.$el.autocomplete("close");_this.$el.prop("disabled",!0);return!1}})}}})},render:function(){void 0!==window.placeHolderRotationReset&&window.placeHolderRotationReset()},parseResponse:function(data,callback){try{var response=$.parseJSON(data);callback(response.suggestions)}catch(err){var retval=[],$nodes=$(data).find("AutoComplete:lt(3)");$nodes.each(function(){var $node=$(this),tmp={label:$node.find("QuestionText").text(),value:$node.find("QuestionText").text()};retval.push(tmp)});callback(retval)}},getParams:function(term,callback){var _this=this,paramsObject={};paramsObject=Settings.useLegacyAC===!0?{url:this.endpoint,type:this.request_method,cookies:[Settings.libEndpointDomain],crossDomain:!0,xhrFields:{withCredentials:!0},data:{jsin:1,AUTOCOMPLETE_REQUEST_TYPE:2,AUTO_COMPLETE:1,FAQ:0,entry:term,ident:this.model.get("ident"),businessArea:this.model.get("currentBA"),channel:this.model.get("currentChannel")},success:function(data,status,jqXHR){_this.parseResponse(data,callback);var tserverid=jqXHR.getResponseHeader("x-cv-tserverid");if(tserverid){window.cvCrossStorage.onConnect().then(function(){window.cvCrossStorage.set("cv-tserverid",tserverid)});localStorage.setItem("cv-tserverid",tserverid)}},error:function(){callback([])}}:{url:this.endpoint,type:this.request_method,cookies:[Settings.libEndpointDomain],crossDomain:!0,xhrFields:{withCredentials:!0},data:{jsin:1,AUTO_COMPLETE:1,AUTOCOMPLETE_REQUEST_TYPE:2,FAQ:0,entry:term,ident:this.model.get("ident"),businessArea:this.model.get("currentBA"),channel:this.model.get("currentChannel")},success:function(data,status,jqXHR){_this.parseResponse(data,callback);var tserverid=jqXHR.getResponseHeader("x-cv-tserverid");if(tserverid){window.cvCrossStorage.onConnect().then(function(){window.cvCrossStorage.set("cv-tserverid",tserverid)});localStorage.setItem("cv-tserverid",tserverid)}},error:function(){callback([])}};localStorage.getItem("cv-tserverid")&&(paramsObject.headers={"cv-tserverid":localStorage.getItem("cv-tserverid")});return paramsObject},getAjax:function(term,callback){$.ajax(this.getParams(term,callback))},getJsonp:function(term,callback){var params=$.extend(this.getParams(term,callback),{dataType:"jsonp",success:function(data,status,jqXHR){callback(data.suggestions)}});$.ajax(params)},getResults:function(term,callback){this.jsonp?this.getJsonp(term,callback):this.getAjax(term,callback)}});return AutoComplete});define("views/virtual_assistant/components/eocs_view",["jquery","underscore_loader","backbone","settings"],function($,_,Backbone,Settings){var EOCS=Backbone.View.extend({tagName:"div",attributes:{id:"eocs"},eocs_submit_text:"cv log eocs data",header:function(){var $wrapper=$("<div>").attr({id:"feedbackheader"}),$inner=$("<div>").attr({id:"headertext"}).text(Settings.eocs.header_text);$wrapper.append($inner);return $wrapper},body:function(){var $wrapper=$("<div>").attr({id:"feedback"}).addClass("feedback");$wrapper.append(this.eocs_form());return $wrapper},eocs_form:function(){var that=this;return $("<form>").attr({action:".",method:"POST"}).append([this.eocs_question_list(),this.feedback(),this.submit_button()]).submit(function(e){e.preventDefault();var $el=$(this),useful=$el.find("input:radio[name=useful]:checked").val(),recommend=$el.find("input:radio[name=recommend]:checked").val(),comment=$el.find("#comments").val();that.model,that.collection;useful&&recommend?that.submit_data({useful:useful,recommend:recommend,comments:comment}):alert("You must select at least 2 radio fields before submitting the survey")})},eocs_question_list:function(){var $div=$("<div>").addClass("form-group");$div.append(this.eocs_question);return $div},eocs_question:function(){for(var questions=Settings.eocs.questions.text,$input_name=Settings.eocs.questions.input_name,rating_inputs=0,$wrapper=$("<div>"),index=0;index<questions.length;index++){var $div_question_text=$("<div>"),$div_rating=$("<div>").addClass("rating");$div_question_text.text(Settings.eocs.questions.text[index]).append($div_rating);for(var i=5;i>rating_inputs;i--){var $label=$("<label>");$("<input />").attr({type:"radio",name:$input_name[index],value:i}).appendTo($label);$div_rating.append($label)}$wrapper.append($div_question_text)}return $($wrapper)},eocs_form_table:function(){var $table=$("<table>").attr({border:0,cellspacing:5,cellpadding:5,width:"98%"}).addClass("tblstyle"),$tbody=$("<tbody>");$tbody.append(this.header_rows());$tbody.append(this.field_rows());$table.append($tbody);return $table},field_rows:function(){var html='<tr><td width="200">This session resolved your issue.</td><td align="center"><input type="radio" name="useful" id="useful1" value="1"></td><td align="center"><input type="radio" name="useful" id="useful2" value="2"></td><td align="center"><input type="radio" name="useful" id="useful3" value="3"></td><td align="center"><input type="radio" name="useful" id="useful4" value="4"></td><td align="center"><input type="radio" name="useful" id="useful5" value="5"></td></tr><tr><td colspan="6">&nbsp;</td></tr><tr><td width="200">I would recommend the <br> Virtual Assistant <br>to a friend or colleague.</td><td align="center"><input type="radio" name="recommend" id="recommend1" value="1"></td><td align="center"><input type="radio" name="recommend" id="recommend2" value="2"></td><td align="center"><input type="radio" name="recommend" id="recommend3" value="3"></td><td align="center"><input type="radio" name="recommend" id="recommend4" value="4"></td><td align="center"><input type="radio" name="recommend" id="recommend5" value="5"></td></tr><tr><td colspan="6">&nbsp;</td></tr>';return $(html)},header_rows:function(){var html='<tr class="header"><td width="200">&nbsp;</td><td>Strongly <br>&nbsp;&nbsp;&nbsp;Agree&nbsp;</td><td>Somewhat <br>&nbsp;&nbsp;&nbsp;Agree&nbsp;</td><td>&nbsp;&nbsp;&nbsp;No <br>&nbsp;Opinion&nbsp;</td><td>Somewhat <br>&nbsp;&nbsp;&nbsp;Disagree&nbsp;</td><td>&nbsp;Strongly <br>&nbsp;&nbsp;Disagree&nbsp;</td></tr><tr><td colspan="6">&nbsp;</td></tr>';return $(html)},hr:function(){var $wrapper=$("<div>").attr({id:"hrline2"}),$hr=$("<hr/>").attr({id:"hrline"});$wrapper.append($hr);return $wrapper},feedback:function(){var $wrapper=$("<div>").addClass("form-group").attr({id:"tellus"}),$label=$("<label>").attr({"for":"comments","class":"textclass"}).text(Settings.eocs.textarea_label),$textarea=$("<textarea>").addClass("form-control").attr({name:"comments",id:"comments"}),$charcount=$("<div>").attr({id:"ofbContainer"}).html('<span id="ofbCounter">0</span>/500');$textarea.keyup(function(e){var text=$.trim($(this).val());$charcount.find("#ofbCounter").text(text.length)});$wrapper.append([$label,$textarea,$charcount]);return $wrapper},submit_button:function(){var $wrapper=$("<div>").attr({id:"submit-button"}),$btn=$("<input />").addClass("btn").attr({id:"feedbackSend",type:"submit",value:Settings.eocs.submit_btn_text});$wrapper.append($btn);return $wrapper},render:function(){this.$el.append(this.header());this.$el.append(this.body());return this},submit_data:function(args){var that=this,data=_.extend(args,{entry:that.eocs_submit_text,FAQ:"0",ButtonRequest:""});that.model.once("change",function(model){alert(model.get("botanswer"));window.close()});that.model.makeRequest({data:data})}});return EOCS});define("views/virtual_assistant/components/eocs",["jquery","underscore_loader","backbone","views/virtual_assistant/components/eocs_view","settings"],function($,_,Backbone,EocsView,Settings){var EOCS=Backbone.View.extend({el:"#cv-chat-body",min_transactions:2,eocs_completed:!1,eocs_data:{},initialize:function(options){window.eocsDataGlobal=this.eocs_data;var that=this;Backbone.View.prototype.initialize.call(this,options);that.min_transactions="number"==typeof options.min_transactions?options.min_transactions:2;this.eocs_data.questions=[];void 0!==Settings.eocs&&void 0!==Settings.eocs.questions&&Settings.eocs.questions.forEach(function(question){question.id="cv-eocs-question-"+Math.round((new Date).getTime()+100*Math.random());question.value=null;that.eocs_data.questions.push(question)});window.render_eocs=function(){if("true"!==localStorage.getItem(Settings.businessName+"-cvVaEOCSRendered")){$("#cv-live-chat-answer-history").hide();window.cvCrossStorage.onConnect().then(function(){return window.cvCrossStorage.set(Settings.businessName+"-cvVaEOCSRendered","true")});localStorage.setItem(Settings.businessName+"-cvVaEOCSRendered","true");window.CVSaveAttributes();that.render()}}},render:function(model){var that=this,$eocs_view=$("<div>").attr("id","cv-eocs-overlay"),eocs_header=that.createHeader();$eocs_view.append(eocs_header);var surveyForm=that.createForm();$eocs_view.append(surveyForm);this.$el.append($eocs_view);!function($){$.fn.starRating=function(){return this.each(function(){var $widget=$(this),isChecked=($widget.find("input"),$widget.find("input:checked").length>0);$widget.one("click",function(){$(this).removeClass("starrating--unselected")});isChecked===!1&&$widget.addClass("starrating--unselected")})};$(".starrating").starRating()}(jQuery);$(".form-group.survey-question.starrating input").click(function(){that.handleValue($(this).attr("id"))})},createForm:function(){var that=this;return $("<form>").attr({action:".",method:"POST"}).append([this.createQuestionList(Settings.eocs.questions),this.feedback(),this.submit_button()]).submit(function(e){e.preventDefault();that.eocs_data.ident=that.model.get("ident");that.eocs_data.comments=that.$el.find("#comments").val();that.eocs_data.queueId=localStorage.getItem("cvlc_queueId");console.log("that.eocs_data",that.eocs_data);console.log("url",Settings.libEndpoint+Settings.businessName+"eocs");$.ajax({url:Settings.libEndpoint+Settings.businessName+"eocs",type:"POST",data:that.eocs_data,success:function(result){that.$el.empty().css("line-height",that.$el.height()+"px");that.$el.append('<div style=" position: absolute; top: 50%; left: 50%; transform: translate(-50%,-50%); display: inline-table; ">'+Settings.eocs.postEOCSMessage+"</div>")}})})},createHeader:function(){var $div=$("<div>").attr({id:"headertext"}).text(Settings.eocs.header_text);return $div},createQuestionList:function(questions){var that=this,$wrapper=$("<div>").addClass("form-group");questions.forEach(function(question){var buildQuestion=that.buildQuestion(question.id,question.text,question.input_name,question.type,question.rating_labels);$wrapper.append(buildQuestion)});return $wrapper},buildQuestion:function(id,text,name,type,labels){var $div_question_text=$("<div>").addClass("form-group survey-question starrating").attr("id",id),input=6,$fieldset=$("<fieldset>");$fieldset.append("<legend>"+text+"</legend>");$div_question_text.append($fieldset);for(var i=1;input>i;i++){var $input=$("<input />").attr({type:type,name:name,value:i,id:id+"_nodefault_"+i}),$label=$("<label>").attr({"for":id+"_nodefault_"+i,"aria-label":i+Settings.ariaLabel.eocsRatingStarNum+"5"});$fieldset.append($input);$fieldset.append($label)}$div_question_text.append($fieldset);var $rating_labels=$(labels);$rating_labels.attr("id","cv-eocs-rating-labels");$div_question_text.append($rating_labels);return $div_question_text},handleValue:function(id){for(var that=this,$el=that.$el.find("#"+id),n=0;n<that.eocs_data.questions.length;n++)that.eocs_data.questions[n].id===id.substr(0,id.indexOf("_"))&&(that.eocs_data.questions[n].value=$el.val())},feedback:function(){var $wrapper=$("<div>").addClass("form-group").attr({id:"tellus"}),$label=$("<label>").attr({"for":"comments","class":"textclass"}).text(Settings.eocs.textarea_label),$textarea=$("<textarea>").addClass("form-control").attr({name:"comments",id:"comments",rows:"3",maxlength:"1000"}),$charcount=$("<div>").attr({id:"ofbContainer"}).html('<span id="ofbCounter">0</span>/1000');$textarea.keyup(function(e){var text=$.trim($(this).val());$charcount.find("#ofbCounter").text(text.length)});$wrapper.append([$label,$textarea,$charcount]);return $wrapper},submit_button:function(){var $wrapper=$("<div>").attr({id:"submit-button"}),$btn=$("<button>").addClass("btn").attr({id:"feedbackSend",type:"submit"}).html('<i id="cv-submit-icon" class="fa fa-paper-plane" aria-hidden="true"></i>'+Settings.eocs.submit_btn_text).css({"border-radius":Settings.inputBorderRadius,"background-color":Settings.submitBtn.backgroundColor,color:"#fff"});$wrapper.append($btn);return $wrapper}});return EOCS});!function(n){var h="";screen.width&&(width=screen.width?screen.width:"",
height=screen.height?screen.height:"",h+=""+width+" x "+height);var a,g,k=navigator.appVersion,b=navigator.userAgent,d=navigator.appName,c=""+parseFloat(navigator.appVersion),f=parseInt(navigator.appVersion,10);-1!=(a=b.indexOf("Opera"))?(d="Opera",c=b.substring(a+6),-1!=(a=b.indexOf("Version"))&&(c=b.substring(a+8))):-1!=(a=b.indexOf("MSIE"))?(d="Microsoft Internet Explorer",c=b.substring(a+5)):"Netscape"==d&&-1!=b.indexOf("Trident/")?(d="Microsoft Internet Explorer",c=b.substring(a+5),-1!=(a=b.indexOf("rv:"))&&(c=b.substring(a+3))):-1!=(a=b.indexOf("Chrome"))?(d="Chrome",c=b.substring(a+7)):-1!=(a=b.indexOf("Safari"))?(d="Safari",c=b.substring(a+7),-1!=(a=b.indexOf("Version"))&&(c=b.substring(a+8)),-1!=b.indexOf("CriOS")&&(d="Chrome")):-1!=(a=b.indexOf("Firefox"))?(d="Firefox",c=b.substring(a+8)):(f=b.lastIndexOf(" ")+1)<(a=b.lastIndexOf("/"))&&(d=b.substring(f,a),c=b.substring(a+1),d.toLowerCase()==d.toUpperCase()&&(d=navigator.appName));-1!=(g=c.indexOf(";"))&&(c=c.substring(0,g));-1!=(g=c.indexOf(" "))&&(c=c.substring(0,g));-1!=(g=c.indexOf(")"))&&(c=c.substring(0,g));f=parseInt(""+c,10);isNaN(f)&&(c=""+parseFloat(navigator.appVersion),parseInt(navigator.appVersion,10));g=/Mobile|mini|Fennec|Android|iP(ad|od|hone)/.test(k);f=navigator.cookieEnabled?!0:!1;"undefined"!=typeof navigator.cookieEnabled||f||(document.cookie="testcookie",f=-1!=document.cookie.indexOf("testcookie")?!0:!1);a="Unknown";var e,l=[{s:"Windows 3.11",r:/Win16/},{s:"Windows 95",r:/(Windows 95|Win95|Windows_95)/},{s:"Windows ME",r:/(Win 9x 4.90|Windows ME)/},{s:"Windows 98",r:/(Windows 98|Win98)/},{s:"Windows CE",r:/Windows CE/},{s:"Windows 2000",r:/(Windows NT 5.0|Windows 2000)/},{s:"Windows XP",r:/(Windows NT 5.1|Windows XP)/},{s:"Windows Server 2003",r:/Windows NT 5.2/},{s:"Windows Vista",r:/Windows NT 6.0/},{s:"Windows 7",r:/(Windows 7|Windows NT 6.1)/},{s:"Windows 8.1",r:/(Windows 8.1|Windows NT 6.3)/},{s:"Windows 8",r:/(Windows 8|Windows NT 6.2)/},{s:"Windows NT 4.0",r:/(Windows NT 4.0|WinNT4.0|WinNT|Windows NT)/},{s:"Windows ME",r:/Windows ME/},{s:"Android",r:/Android/},{s:"Open BSD",r:/OpenBSD/},{s:"Sun OS",r:/SunOS/},{s:"Linux",r:/(Linux|X11)/},{s:"iOS",r:/(iPhone|iPad|iPod)/},{s:"Mac OS X",r:/Mac OS X/},{s:"Mac OS",r:/(MacPPC|MacIntel|Mac_PowerPC|Macintosh)/},{s:"QNX",r:/QNX/},{s:"UNIX",r:/UNIX/},{s:"BeOS",r:/BeOS/},{s:"OS/2",r:/OS\/2/},{s:"Search Bot",r:/(nuhk|Googlebot|Yammybot|Openbot|Slurp|MSNBot|Ask Jeeves\/Teoma|ia_archiver)/}];for(e in l){var m=l[e];if(m.r.test(b)){a=m.s;break}}e="Unknown";/Windows/.test(a)&&(e=/Windows (.*)/.exec(a)[1],a="Windows");switch(a){case"Mac OS X":e=/Mac OS X (10[\.\_\d]+)/.exec(b)[1];break;case"Android":e=/Android ([\.\_\d]+)/.exec(b)[1];break;case"iOS":e=/OS (\d+)_(\d+)_?(\d+)?/.exec(k),e=e[1]+"."+e[2]+"."+(0|e[3])}n.browserInfo={screen:h,browser:d,browserVersion:c,mobile:g,os:a,osVersion:e,cookies:f}}(this.CVVA);define("browserinfo",function(global){return function(){var ret;return ret||global.CVVA.browserInfo}}(this));!function(e){var t=function(){"use strict";var e="s",n=function(e){var t=-e.getTimezoneOffset();return null!==t?t:0},r=function(e,t,n){var r=new Date;return void 0!==e&&r.setFullYear(e),r.setDate(n),r.setMonth(t),r},i=function(e){return n(r(e,0,2))},s=function(e){return n(r(e,5,2))},o=function(e){var t=e.getMonth()>7?s(e.getFullYear()):i(e.getFullYear()),r=n(e);return t-r!==0},u=function(){var t=i(),n=s(),r=i()-s();return 0>r?t+",1":r>0?n+",1,"+e:t+",0"},a=function(){var e=u();return new t.TimeZone(t.olson.timezones[e])};return{determine:a,date_is_dst:o}}();t.TimeZone=function(e){"use strict";var n=null,r=function(){return n},i=function(){for(var e=t.olson.ambiguity_list[n],r=e.length,i=0,s=e[0];r>i;i+=1){s=e[i];if(t.date_is_dst(t.olson.dst_start_dates[s])){n=s;return}}},s=function(){return"undefined"!=typeof t.olson.ambiguity_list[n]};return n=e,s()&&i(),{name:r}},t.olson={},t.olson.timezones={"-720,0":"Etc/GMT+12","-660,0":"Pacific/Pago_Pago","-600,1":"America/Adak","-600,0":"Pacific/Honolulu","-570,0":"Pacific/Marquesas","-540,0":"Pacific/Gambier","-540,1":"America/Anchorage","-480,1":"America/Los_Angeles","-480,0":"Pacific/Pitcairn","-420,0":"America/Phoenix","-420,1":"America/Denver","-360,0":"America/Guatemala","-360,1":"America/Chicago","-360,1,s":"Pacific/Easter","-300,0":"America/Bogota","-300,1":"America/New_York","-270,0":"America/Caracas","-240,1":"America/Halifax","-240,0":"America/Santo_Domingo","-240,1,s":"America/Santiago","-210,1":"America/St_Johns","-180,1":"America/Godthab","-180,0":"America/Argentina/Buenos_Aires","-180,1,s":"America/Montevideo","-120,0":"Etc/GMT+2","-120,1":"Etc/GMT+2","-60,1":"Atlantic/Azores","-60,0":"Atlantic/Cape_Verde","0,0":"Etc/UTC","0,1":"Europe/London","60,1":"Europe/Berlin","60,0":"Africa/Lagos","60,1,s":"Africa/Windhoek","120,1":"Asia/Beirut","120,0":"Africa/Johannesburg","180,0":"Asia/Baghdad","180,1":"Europe/Moscow","210,1":"Asia/Tehran","240,0":"Asia/Dubai","240,1":"Asia/Baku","270,0":"Asia/Kabul","300,1":"Asia/Yekaterinburg","300,0":"Asia/Karachi","330,0":"Asia/Kolkata","345,0":"Asia/Kathmandu","360,0":"Asia/Dhaka","360,1":"Asia/Omsk","390,0":"Asia/Rangoon","420,1":"Asia/Krasnoyarsk","420,0":"Asia/Jakarta","480,0":"Asia/Shanghai","480,1":"Asia/Irkutsk","525,0":"Australia/Eucla","525,1,s":"Australia/Eucla","540,1":"Asia/Yakutsk","540,0":"Asia/Tokyo","570,0":"Australia/Darwin","570,1,s":"Australia/Adelaide","600,0":"Australia/Brisbane","600,1":"Asia/Vladivostok","600,1,s":"Australia/Sydney","630,1,s":"Australia/Lord_Howe","660,1":"Asia/Kamchatka","660,0":"Pacific/Noumea","690,0":"Pacific/Norfolk","720,1,s":"Pacific/Auckland","720,0":"Pacific/Tarawa","765,1,s":"Pacific/Chatham","780,0":"Pacific/Tongatapu","780,1,s":"Pacific/Apia","840,0":"Pacific/Kiritimati"},t.olson.dst_start_dates=function(){"use strict";var e=new Date(2010,6,15,1,0,0,0);return{"America/Denver":new Date(2011,2,13,3,0,0,0),"America/Mazatlan":new Date(2011,3,3,3,0,0,0),"America/Chicago":new Date(2011,2,13,3,0,0,0),"America/Mexico_City":new Date(2011,3,3,3,0,0,0),"America/Asuncion":new Date(2012,9,7,3,0,0,0),"America/Santiago":new Date(2012,9,3,3,0,0,0),"America/Campo_Grande":new Date(2012,9,21,5,0,0,0),"America/Montevideo":new Date(2011,9,2,3,0,0,0),"America/Sao_Paulo":new Date(2011,9,16,5,0,0,0),"America/Los_Angeles":new Date(2011,2,13,8,0,0,0),"America/Santa_Isabel":new Date(2011,3,5,8,0,0,0),"America/Havana":new Date(2012,2,10,2,0,0,0),"America/New_York":new Date(2012,2,10,7,0,0,0),"Asia/Beirut":new Date(2011,2,27,1,0,0,0),"Europe/Helsinki":new Date(2011,2,27,4,0,0,0),"Europe/Istanbul":new Date(2011,2,28,5,0,0,0),"Asia/Damascus":new Date(2011,3,1,2,0,0,0),"Asia/Jerusalem":new Date(2011,3,1,6,0,0,0),"Asia/Gaza":new Date(2009,2,28,0,30,0,0),"Africa/Cairo":new Date(2009,3,25,0,30,0,0),"Pacific/Auckland":new Date(2011,8,26,7,0,0,0),"Pacific/Fiji":new Date(2010,11,29,23,0,0,0),"America/Halifax":new Date(2011,2,13,6,0,0,0),"America/Goose_Bay":new Date(2011,2,13,2,1,0,0),"America/Miquelon":new Date(2011,2,13,5,0,0,0),"America/Godthab":new Date(2011,2,27,1,0,0,0),"Europe/Moscow":e,"Asia/Yekaterinburg":e,"Asia/Omsk":e,"Asia/Krasnoyarsk":e,"Asia/Irkutsk":e,"Asia/Yakutsk":e,"Asia/Vladivostok":e,"Asia/Kamchatka":e,"Europe/Minsk":e,"Australia/Perth":new Date(2008,10,1,1,0,0,0)}}(),t.olson.ambiguity_list={"America/Denver":["America/Denver","America/Mazatlan"],"America/Chicago":["America/Chicago","America/Mexico_City"],"America/Santiago":["America/Santiago","America/Asuncion","America/Campo_Grande"],"America/Montevideo":["America/Montevideo","America/Sao_Paulo"],"Asia/Beirut":["Asia/Beirut","Europe/Helsinki","Europe/Istanbul","Asia/Damascus","Asia/Jerusalem","Asia/Gaza"],"Pacific/Auckland":["Pacific/Auckland","Pacific/Fiji"],"America/Los_Angeles":["America/Los_Angeles","America/Santa_Isabel"],"America/New_York":["America/Havana","America/New_York"],"America/Halifax":["America/Goose_Bay","America/Halifax"],"America/Godthab":["America/Miquelon","America/Godthab"],"Asia/Dubai":["Europe/Moscow"],"Asia/Dhaka":["Asia/Yekaterinburg"],"Asia/Jakarta":["Asia/Omsk"],"Asia/Shanghai":["Asia/Krasnoyarsk","Australia/Perth"],"Asia/Tokyo":["Asia/Irkutsk"],"Australia/Brisbane":["Asia/Yakutsk"],"Pacific/Noumea":["Asia/Vladivostok"],"Pacific/Tarawa":["Asia/Kamchatka"],"Africa/Johannesburg":["Asia/Gaza","Africa/Cairo"],"Asia/Baghdad":["Europe/Minsk"]},"undefined"!=typeof exports?exports.jstz=t:e.jstz=t}(this.CVVA);define("jstz",function(global){return function(){var ret;return ret||global.CVVA.jstz}}(this));define("views/virtual_assistant/components/cv_livechat",["jquery","jquery_ui","backbone","settings","scrollto","views/virtual_assistant/components/eocs","browserinfo","jstz"],function($,$ui,Backbone,Settings,ScrollTo,EOCS,browserInfo,jstz){var LiveChat=Backbone.View.extend({token:"",el:".cv-va-bootstrap #cv-chat-content",submitID:"cv-live-chat-submit",entryID:"cv-live-chat-user-entry",activeChatSession:!1,bindEvent:"change:transactioncount",events:{"click #cv-live-chat-submit":"addLine"},customerList:null,queueList:null,captcha:null,lcAttributes:{firstName:"",lastName:"",userName:"",emailId:"",queueId:3,queueName:"Les Cartes",customData:"{}",customerId:3,ip:"",city:"",region:"",country:"",org:"",os:browserInfo.os+" "+browserInfo.osVersion,browser:browserInfo.browser+" "+browserInfo.browserVersion,mobile:browserInfo.mobile,timeZone:jstz.determine().name(),contextQueueId:3,isPriority:!1,endUserId:1,originId:1,userSessionId:"",vaSessionId:""},reconnecting:!1,closeDuplicate:0,messages:Settings.cvlivechat.session.messages,userSessionTimeout:300,lastPingTime:0,initialize:function(options){var _this=this;Backbone.Model.prototype.initialize.call(this,options);this.model.on(this.bindEvent,this.render,this);$("#cv-chat-container").on("hidden.bs.modal",function(){if(localStorage.getItem("cvlc_userSessionId")||_this.$el.find("#cv-lc-pcs").length>0||"ended"===localStorage.getItem("cvlc_chatStatus")){_this.clearLocalStorage();clearInterval(window.proactiveEndSessionInterval);clearInterval(window.cvVaSaveState);localStorage.removeItem(Settings.businessName+"-cvVaBootstrapState");localStorage.removeItem(Settings.businessName+"-cvVaModel");localStorage.removeItem(Settings.businessName+"-cvVaStyles");localStorage.removeItem(Settings.businessName+"-cvVaInitCall");localStorage.removeItem(Settings.businessName+"-cvVaCollectionLength");localStorage.removeItem(Settings.businessName+"-cvVaTimestamp");localStorage.removeItem(Settings.businessName+"-cvVaEOCSRendered");localStorage.removeItem(Settings.businessName+"-cvVaBusinessArea");localStorage.removeItem(Settings.businessName+"-cvVaIdent");window.cvVaCollectionLength=void 0;window.cvVaModel=void 0;window.cvVaMinimized=void 0;window.resizableAttached=void 0;window.localInitCall=void 0;window.sessionFlushInterval=setInterval(function(){clearInterval(window.proactiveEndSessionInterval);clearInterval(window.cvVaSaveState);localStorage.removeItem(Settings.businessName+"-cvVaBootstrapState");localStorage.removeItem(Settings.businessName+"-cvVaModel");localStorage.removeItem(Settings.businessName+"-cvVaStyles");localStorage.removeItem(Settings.businessName+"-cvVaInitCall");localStorage.removeItem(Settings.businessName+"-cvVaCollectionLength");localStorage.removeItem(Settings.businessName+"-cvVaTimestamp");localStorage.removeItem(Settings.businessName+"-cvVaEOCSRendered");localStorage.removeItem(Settings.businessName+"-cvVaBusinessArea");localStorage.removeItem(Settings.businessName+"-cvVaIdent");window.cvVaCollectionLength=void 0;window.cvVaModel=void 0;window.cvVaMinimized=void 0;window.resizableAttached=void 0;window.localInitCall=void 0},0);setTimeout(function(){window.cvCrossStorage.onConnect().then(function(){return window.cvCrossStorage.del(Settings.businessName+"-cvVaBootstrapState",Settings.businessName+"-cvVaModel",Settings.businessName+"-cvVaStyles",Settings.businessName+"-cvVaInitCall",Settings.businessName+"-cvVaCollectionLength",Settings.businessName+"-cvVaTimestamp",Settings.businessName+"-cvVaEOCSRendered",Settings.businessName+"-cvVaBusinessArea")}).then(function(res){window.loadFromStorage=!1;_this.model.closeSession();clearInterval(window.sessionFlushInterval);window.resetVA()})},150)}});$(".cv-va-bootstrap .close.container-control.mobile-close").click(function(event){if(("creative virtual"===Settings.livechatVendor&&localStorage.getItem("cvlc_userSessionId")&&"true"!==localStorage.getItem(Settings.businessName+"-cvVaEOCSRendered")&&Settings.vaLcTabs===!1||"ended"===localStorage.getItem("cvlc_chatStatus")&&"true"!==localStorage.getItem(Settings.businessName+"-cvVaEOCSRendered"))&&(localStorage.getItem("cvlc_userSessionId")||_this.$el.find("#cv-lc-pcs").length>0||"ended"===localStorage.getItem("cvlc_chatStatus"))){clearInterval(_this.pingInterval);clearInterval(_this.netDetInterval);var url="",chatRequestModel={};if(_this.lcAttributes.roomId){url=Settings.creativeVirtual.livechatUrl+"chatEnd.html";chatRequestModel={customerId:_this.lcAttributes.customerId,roomId:_this.lcAttributes.roomId,userName:_this.lcAttributes.userName,userSessionId:_this.lcAttributes.userSessionId,endUserId:_this.lcAttributes.endUserId,queueId:_this.lcAttributes.queueId}}else{url=Settings.creativeVirtual.livechatUrl+"chatAbandon.html";chatRequestModel={customerId:_this.lcAttributes.customerId,userName:_this.lcAttributes.userName,userSessionId:_this.lcAttributes.userSessionId,endUserId:_this.lcAttributes.endUserId,queueId:_this.lcAttributes.queueId}}(-1===_this.lcAttributes.endUserId||localStorage.getItem("cvlc_userSessionId"))&&_this.makePostRequest(url,chatRequestModel,function(response){if(0===response){localStorage.setItem("cvlc_chatStatus","ended");window.cvCrossStorage.onConnect().then(function(){window.cvCrossStorage.set("cvlc_chatStatus","ended")});null!=_this.websocket&&_this.websocket.close()}else console.log("error ending session")})}});if(null!=localStorage.getItem("cvlc_roomId")&&""!=localStorage.getItem("cvlc_roomId")){_this.lcStarted=!0;_this.resumeWsConnection();_this.$el.find("#"+_this.entryID).keyup(function(event){_this.keyPress(event,_this)});console.log(_this.$el.find("#cv-live-chat-answer-history").scrollTo);console.log(_this.$el.find("#cv-live-chat-answer-history").is(":visible"));setTimeout(function(){_this.$el.find("#cv-live-chat-answer-history").scrollTo("max",{duration:0})},500)}else if(null!=localStorage.getItem("cvlc_userSessionId")&&""!=localStorage.getItem("cvlc_userSessionId")&&null!=localStorage.getItem("cvlc_chatStatus")&&"waiting"==localStorage.getItem("cvlc_chatStatus")){_this.lcAttributes.endUserId=localStorage.getItem("cvlc_endUserId");_this.lcAttributes.userSessionId=localStorage.getItem("cvlc_userSessionId");_this.lcAttributes.firstName=localStorage.getItem("cvlc_firstName");_this.lcAttributes.lastName=localStorage.getItem("cvlc_lastName");_this.lcAttributes.userName=localStorage.getItem("cvlc_username");_this.lcAttributes.emailId=localStorage.getItem("cvlc_emailId");_this.lcAttributes.queueId=localStorage.getItem("cvlc_queueId");_this.lcAttributes.queueName=localStorage.getItem("cvlc_queueName");_this.lcAttributes.vaSessionId=localStorage.getItem(Settings.businessName+"-cvVaIdent");_this.lcAttributes.contextQueueId=_this.lcAttributes.queueId;_this.makeGetRequest(Settings.creativeVirtual.livechatUrl+"checkUserSession.html?userSessionId="+_this.lcAttributes.userSessionId,function(response){if(response&&response>-1){_this.openWsConnection(0);console.log("reconnect to user session")}else{_this.startChat();console.log("recreated user session")}});_this.$el.find("#"+_this.entryID).keyup(function(event){_this.keyPress(event,_this)});setTimeout(function(){_this.$el.find("#cv-live-chat-answer-history").scrollTo("max",{duration:0})},500)}else if(_this.$el.find("#cv-lc-pcs").length>0){_this.$el.find("#cv-lc-pcs-queueId").empty();_this.$el.find("#cv-lc-pcs-queueId").append('<option value="0" selected>Choose...</option>');_this.getQueueList(this.value,function(queueList){if(!queueList.error){_this.queueList=queueList;_this.queueList.forEach(function(item,index){var $option;$option="presto"===Settings.businessName&&item.engineConnectionUrl.search("frlc")<0?$("<option>").attr("value",item.queueId).html(item.queueName):"prestofr"===Settings.businessName&&item.engineConnectionUrl.search("frlc")>-1?$("<option>").attr("value",item.queueId).html(item.queueName):$("<option>").attr("value",item.queueId).html(item.queueName);_this.$el.find("#cv-lc-pcs-queueId").append($option)});_this.$el.find("#cv-lc-pcs button").on("click",function(evt){evt.preventDefault();_this.requestLC()})}})}$(".cv-va-bootstrap .cv-live-chat-agent").find("a").on("click",function(event){event.preventDefault();var targetHostname=event.target.hostname;targetHostname===window.location.hostname?$(this).attr("target","_self"):$(this).attr("target","_blank");window.open($(this).attr("href"),$(this).attr("target"))});$.ajax({type:"GET",dataType:"html",url:Settings.creativeVirtual.livechatUrl+"refreshToken.html",crossDomain:!0,xhrFields:{withCredentials:!0},success:function(token){$("#cv-chat-content").find("#_csrf").html(token)}})},render:function(model){console.log("render cv lc");var livechatOffer,_this=this;if(void 0!==model.get(Settings.livechatOfferETV)){livechatOffer=model.get(Settings.livechatOfferETV).toLowerCase();if("true"===livechatOffer&&this.activeChatSession===!1){_this.livechatrendered=!0;_this.$el.find("#cv-chat-form").hide();_this.$el.find("#cv-lc-btn").remove();_this.$el.find("#cv-chat-body").append('<div id="cv-live-chat-answer-history" class="cv-chat-history"></div>');_this.$el.find(".cv-chat-minimized-logo").remove();_this.$el.find("#cv-va-title").html("Welcome to "+Settings.businessName+" Live Chat.");_this.$el.find(".cv-chat-logo").fadeOut(0,function(){var lc_logo=$("<img>").attr({id:"cv-lc-chat-logo",src:Settings.libEndpoint+"images/titles/"+Settings.lcMinimizedLogo,alt:Settings.businessName+" Live Chat Logo"});_this.$el.find("#cv-chat-header").prepend(lc_logo);_this.$el.find(".cv-chat-logo").remove()});_this.getPCSForm();clearInterval(window.proactiveEndSessionInterval)}}},getPCSForm:function(){var _this=this,pcsForm='<form id="cv-lc-pcs" method="post" style="display: none;">';pcsForm+='<div class="form-group">';pcsForm=pcsForm+'<label for="cv-lc-pcs-first-name">'+Settings.cvlivechat.pcs.label.firstName+"</label>";pcsForm=pcsForm+'<span class="cv-lc-require-input" style="display: none;">'+Settings.cvlivechat.pcs.requireText+"</span>";pcsForm=pcsForm+'<input type="text" class="form-control" id="cv-lc-pcs-first-name" name="firstName" maxlength="30" placeholder="'+Settings.cvlivechat.pcs.placeholder.firstName+'" aria-required="true" required>';pcsForm+="</div>";pcsForm+='<div class="form-group">';pcsForm=pcsForm+'<label for="cv-lc-pcs-last-name">'+Settings.cvlivechat.pcs.label.lastName+"</label>";pcsForm=pcsForm+'<span class="cv-lc-require-input" style="display: none;">'+Settings.cvlivechat.pcs.requireText+"</span>";pcsForm=pcsForm+'<input type="text" class="form-control" id="cv-lc-pcs-last-name" name="lastName" maxlength="30" placeholder="'+Settings.cvlivechat.pcs.placeholder.lastName+'" aria-required="true" required>';pcsForm+="</div>";pcsForm+='<div class="form-group">';pcsForm=pcsForm+'<label for="cv-lc-pcs-email">'+Settings.cvlivechat.pcs.label.email+"</label>";pcsForm=pcsForm+'<input type="email" class="form-control" id="cv-lc-pcs-email" placeholder="'+Settings.cvlivechat.pcs.placeholder.email+'">';pcsForm+="</div>";pcsForm+='<div class="form-group">';pcsForm=pcsForm+'<label for="cv-lc-pcs-queueId">'+Settings.cvlivechat.pcs.label.topic+"</label>";pcsForm=pcsForm+'<span class="cv-lc-require-input" style="display: none;">'+Settings.cvlivechat.pcs.requireText+"</span>";pcsForm+='<select id="cv-lc-pcs-queueId" name="queueId" class="form-control" aria-required="true" required>';pcsForm=pcsForm+'<option value="0" selected>'+Settings.cvlivechat.pcs.label.option+"</option>";pcsForm+="</select>";pcsForm+="</div>";pcsForm+='<div class="text-right">';pcsForm=pcsForm+'<button type="submit" class="btn btn-primary"><i class="fa fa-comments"></i>'+Settings.cvlivechat.pcs.label.submitBtn+"</button>";pcsForm+="</div>";_this.$el.find("#cv-live-chat-answer-history").append(pcsForm);_this.getQueueList(this.value,function(queueList){if(!queueList.error){_this.queueList=queueList;_this.queueList.forEach(function(item,index){var $option;$option="presto"===Settings.businessName&&item.engineConnectionUrl.search("frlc")<0?$("<option>").attr("value",item.queueId).html(item.queueName):"prestofr"===Settings.businessName&&item.engineConnectionUrl.search("frlc")>-1?$("<option>").attr("value",item.queueId).html(item.queueName):$("<option>").attr("value",item.queueId).html(item.queueName);_this.$el.find("#cv-lc-pcs-queueId").append($option)})}});setTimeout(function(){_this.$el.find("#cv-chat-loader-layer").hide();_this.$el.find("#cv-lc-pcs").fadeIn();setTimeout(function(){_this.refreshTimeout();window.CVSaveAttributes()},500)},1e3);_this.$el.find("#cv-lc-pcs button").on("click",function(evt){evt.preventDefault();_this.requestLC()})},requestLC:function(){var _this=this;if(_this.validatePCS()){_this.lcAttributes.firstName=$("#cv-lc-pcs-first-name").val()||"Undefined";_this.lcAttributes.lastName=$("#cv-lc-pcs-last-name").val()||"Undefined";_this.lcAttributes.userName=_this.lcAttributes.firstName+" "+_this.lcAttributes.lastName;_this.lcAttributes.emailId=$("#cv-lc-pcs-email").val()||Math.floor(1e16*Math.random())+"@creativevirtual.com";_this.lcAttributes.queueId=$("#cv-lc-pcs-queueId").val();window.cvLCQueueId=_this.lcAttributes.queueId;console.log(_this.lcAttributes.queueId);_this.lcAttributes.queueName=$("#cv-lc-pcs-queueId option:selected").text();_this.lcAttributes.contextQueueId=_this.lcAttributes.queueId;_this.lcAttributes.vaSessionId=localStorage.getItem(Settings.businessName+"-cvVaIdent");_this.makeGetRequest(Settings.creativeVirtual.livechatUrl+"localUserData.html?emaiId="+_this.lcAttributes.emailId+"&custId="+_this.lcAttributes.customerId,function(response){_this.$el.find("#cv-lc-pcs").remove();_this.refreshTimeout();window.CVSaveAttributes();_this.lcAttributes.endUserId=response;if(-1===_this.lcAttributes.endUserId){_this.addSystemMessage("An existing session already exists for your user");_this.addSystemMessage(_this.messages.msg1)}else if(0===_this.lcAttributes.endUserId){var endUserJson={emailId:_this.lcAttributes.emailId,isDeleted:0,isPriority:0,firstName:_this.lcAttributes.firstName,lastName:_this.lcAttributes.lastName,mobileNumber:"",systemUserId:"",customerId:3};_this.makePostRequest(Settings.creativeVirtual.livechatUrl+"localUserData.html",endUserJson,function(response){console.log("end user id: "+response);_this.lcAttributes.endUserId=response;0===_this.lcAttributes.endUserId?console.log("Error while creating end user"):_this.startChat()})}else _this.startChat()})}else{console.log("PCS validation failed");$(_this.$el.find(".slideUp").next("input, select").get(0)).focus()}},resumeWsConnection:function(){var _this=this;_this.lcAttributes.userSessionId=localStorage.getItem("cvlc_userSessionId");_this.lcAttributes.customerId=localStorage.getItem("cvlc_customerId");_this.lcAttributes.userName=localStorage.getItem("cvlc_username");_this.lcAttributes.queueId=localStorage.getItem("cvlc_queueId");_this.lcAttributes.roomId=localStorage.getItem("cvlc_roomId");_this.openWsConnection(1);console.log("resume WS connection")},openWsConnection:function(connectionType){var _this=this,wsUri=Settings.creativeVirtual.wsUri+"userConnection?"+_this.lcAttributes.customerId+":"+_this.lcAttributes.userSessionId+":"+connectionType;_this.websocket=new WebSocket(wsUri);_this.websocket.onopen=function(ev){console.log("onopen");console.log(ev);if(null==localStorage.getItem("cvlc_chatStatus")||null!=localStorage.getItem("cvlc_chatStatus")&&"ended"==localStorage.getItem("cvlc_chatStatus")){localStorage.setItem("cvlc_customerId",_this.lcAttributes.customerId);localStorage.setItem("cvlc_username",_this.lcAttributes.userName);localStorage.setItem("cvlc_firstName",_this.lcAttributes.firstName);localStorage.setItem("cvlc_lastName",_this.lcAttributes.lastName);localStorage.setItem("cvlc_emailId",_this.lcAttributes.emailId);localStorage.setItem("cvlc_chatStatus","waiting");localStorage.setItem("cvlc_userSessionId",_this.lcAttributes.userSessionId);localStorage.setItem("cvlc_endUserId",_this.lcAttributes.endUserId);localStorage.setItem("cvlc_queueName",_this.lcAttributes.queueName);localStorage.setItem("cvlc_queueId",_this.lcAttributes.queueId);window.cvCrossStorage.onConnect().then(function(){window.cvCrossStorage.set("cvlc_customerId",_this.lcAttributes.customerId);window.cvCrossStorage.set("cvlc_username",_this.lcAttributes.userName);window.cvCrossStorage.set("cvlc_firstName",_this.lcAttributes.firstName);window.cvCrossStorage.set("cvlc_lastName",_this.lcAttributes.lastName);window.cvCrossStorage.set("cvlc_emailId",_this.lcAttributes.emailId);window.cvCrossStorage.set("cvlc_chatStatus","waiting");window.cvCrossStorage.set("cvlc_userSessionId",_this.lcAttributes.userSessionId);window.cvCrossStorage.set("cvlc_endUserId",_this.lcAttributes.endUserId);window.cvCrossStorage.set("cvlc_queueName",_this.lcAttributes.queueName);window.cvCrossStorage.set("cvlc_queueId",_this.lcAttributes.queueId)})}var responseDataWS={messageCode:24,customerId:_this.lcAttributes.customerId,fromId:_this.lcAttributes.userSessionId};if(_this.reconnecting===!0){_this.addSystemMessage(_this.messages.msg3);_this.setButtonState();_this.$el.find("#cv-live-chat-user-entry").show()}_this.reconnecting=!1;_this.lastPingTime=new Date;_this.pingInterval=setInterval(function(){_this.websocket.send(JSON.stringify(responseDataWS));_this.lastPingTime=new Date},2e4);_this.monitorNetworkLoss()};_this.websocket.onclose=function(ev){clearInterval(_this.pingInterval);clearInterval(_this.netDetInterval);_this.websocket=null;if(0===_this.closeDuplicate){console.log(415);var timeElapsedSinceLastPing=new Date-_this.lastPingTime;if("ended"!==localStorage.getItem("cvlc_chatStatus")&&27e4>timeElapsedSinceLastPing){_this.$el.find("#"+_this.submitID).addClass("disabled").prop("disabled","true");$(".cv-va-bootstrap #cv-live-chat-submit.disabled").css({"background-color":Settings.submitBtn.disabled.backgroundColor,"border-color":Settings.submitBtn.disabled.backgroundColor});_this.$el.find("#cv-live-chat-user-entry").hide();var timeToResume;if(_this.reconnecting===!0)timeToResume=1e3;else{_this.addSystemMessage(_this.messages.msg4);var discountTimeElapsed=timeElapsedSinceLastPing;timeElapsedSinceLastPing>2e4&&(discountTimeElapsed=2e4);timeToResume=1e4+(2e4-discountTimeElapsed)+4e3}setTimeout(function(){_this.reconnecting=!0;if(null!=localStorage.getItem("cvlc_roomId")&&""!=localStorage.getItem("cvlc_roomId")){_this.lcStarted=!0;_this.resumeWsConnection()}else if(null!=localStorage.getItem("cvlc_userSessionId")&&""!=localStorage.getItem("cvlc_userSessionId")&&null!=localStorage.getItem("cvlc_chatStatus")&&"waiting"==localStorage.getItem("cvlc_chatStatus")){_this.lcAttributes.endUserId=localStorage.getItem("cvlc_endUserId");_this.lcAttributes.userSessionId=localStorage.getItem("cvlc_userSessionId");_this.lcAttributes.firstName=localStorage.getItem("cvlc_firstName");_this.lcAttributes.lastName=localStorage.getItem("cvlc_lastName");_this.lcAttributes.userName=localStorage.getItem("cvlc_username");_this.lcAttributes.emailId=localStorage.getItem("cvlc_emailId");_this.lcAttributes.queueId=localStorage.getItem("cvlc_queueId");_this.lcAttributes.queueName=localStorage.getItem("cvlc_queueName");_this.lcAttributes.vaSessionId=localStorage.getItem(Settings.businessName+"-cvVaIdent");_this.lcAttributes.contextQueueId=_this.lcAttributes.queueId;_this.makeGetRequest(Settings.creativeVirtual.livechatUrl+"checkUserSession.html?userSessionId="+_this.lcAttributes.userSessionId,function(response){if(response&&response>-1){_this.openWsConnection(0);console.log("reconnect to user session")}else{_this.startChat();console.log("recreated user session")}})}},timeToResume)}else if(timeElapsedSinceLastPing>=27e4){_this.addSystemMessage(_this.messages.msg5);_this.clearLocalStorage();_this.$el.find("#cv-live-chat-user-entry").remove();_this.$el.find("#"+_this.submitID).addClass("disabled").prop("disabled","true");$(".cv-va-bootstrap #cv-live-chat-submit.disabled").css({"background-color":Settings.submitBtn.disabled.backgroundColor,"border-color":Settings.submitBtn.disabled.backgroundColor});window.CVSaveAttributes();localStorage.setItem("cvlc_chatStatus","ended");window.cvCrossStorage.onConnect().then(function(){window.cvCrossStorage.set("cvlc_chatStatus","ended")})}}};_this.websocket.onmessage=function(ev){_this.wsOnMessage(ev.data,"agent")};_this.websocket.onerror=function(ev){console.log("ws error");console.log(ev)}},getCustomerList:function(customerListCallback){this.makeGetRequest(Settings.creativeVirtual.livechatUrl+"customerList.html",customerListCallback)},getQueueList:function(customerID,queueListCallback){this.makeGetRequest(Settings.creativeVirtual.livechatUrl+"queueList.html?customerId=3",queueListCallback)},submitPCS:function(){},validatePCS:function(){var _this=this,queueId=_this.$el.find("#cv-lc-pcs-queueId").val(),firstName=_this.$el.find("#cv-lc-pcs-first-name").val(),lastName=_this.$el.find("#cv-lc-pcs-last-name").val();if("0"===queueId||""===firstName||""===lastName){"0"===queueId&&$("#cv-lc-pcs-queueId").parent().find(".cv-lc-require-input").show().addClass("slideUp");""===firstName&&$("#cv-lc-pcs-first-name").parent().find(".cv-lc-require-input").show().addClass("slideUp");""===lastName&&$("#cv-lc-pcs-last-name").parent().find(".cv-lc-require-input").show().addClass("slideUp");_this.$el.find("input").on("input",function(){$(this).parent().find(".cv-lc-require-input").hide().removeClass("slideUp")});_this.$el.find("#cv-lc-pcs-queueId").on("change",function(){$(this).parent().find(".cv-lc-require-input").hide().removeClass("slideUp")});return!1}return!0},makeGetRequest:function(url,requestCallback){$.ajax({type:"GET",dataType:"json",url:url,beforeSend:function(xhr){console.log($("#_csrf").text());xhr.setRequestHeader("X-CSRF-TOKEN",$("#_csrf").text())},success:function(response){console.log(url);console.log(response);requestCallback(response)},error:function(jqXHR,textStatus,errorThrown){requestCallback({error:textStatus})}})},makePostRequest:function(url,data,requestCallback){$.ajax({type:"POST",dataType:"json",contentType:"application/json",mimeType:"application/json",url:url,crossDomain:!0,xhrFields:{withCredentials:!0},processData:!1,data:JSON.stringify(data),beforeSend:function(xhr){xhr.setRequestHeader("X-CSRF-TOKEN",$("#_csrf").text())},success:function(response){requestCallback(response)},error:function(jqXHR,textStatus,errorThrown){requestCallback({error:textStatus})}})},startChat:function(){var _this=this;_this.makeGetRequest(Settings.creativeVirtual.livechatUrl+"globalSettingTimeouts.html?customerId=3",function(response){response&&response.userSessionTimeout&&(_this.userSessionTimeout=response.userSessionTimeout);var initParams={firstName:_this.lcAttributes.firstName,lastName:_this.lcAttributes.lastName,userName:_this.lcAttributes.userName,emailId:_this.lcAttributes.emailId,queueId:_this.lcAttributes.queueId,queueName:_this.lcAttributes.queueName,customData:_this.lcAttributes.customData,customerId:_this.lcAttributes.customerId,ip:_this.lcAttributes.ip,city:_this.lcAttributes.city,region:_this.lcAttributes.region,country:_this.lcAttributes.country,org:_this.lcAttributes.org,os:_this.lcAttributes.os,browser:_this.lcAttributes.browser,mobile:_this.lcAttributes.mobile,timeZone:_this.lcAttributes.timeZone,userLocalTime:_this.getCurrentTime(),contextQueueId:_this.lcAttributes.contextQueueId,isPriority:_this.lcAttributes.isPriority,endUserId:_this.lcAttributes.endUserId,originId:_this.lcAttributes.originId,userSessionId:_this.lcAttributes.userSessionId,vaSessionId:_this.lcAttributes.vaSessionId};_this.makePostRequest(Settings.creativeVirtual.livechatUrl+"userSession.html",initParams,function(response){
_this.lcAttributes.userSessionId=response;_this.openWsConnection(0)})})},wsOnMessage:function(message,source){var _this=this,msg=JSON.parse(message);switch(msg.messageCode){case 1:localStorage.setItem("cvlc_userSessionId",_this.lcAttributes.userSessionId);localStorage.setItem("cvlc_chatStatus","waiting");localStorage.removeItem("cvlc_roomId");localStorage.removeItem("cvlc_agentName");window.cvCrossStorage.onConnect().then(function(){window.cvCrossStorage.del("cvlc_roomId","cvlc_agentName");window.cvCrossStorage.set("cvlc_userSessionId",_this.lcAttributes.userSessionId);window.cvCrossStorage.set("cvlc_chatStatus","waiting")});_this.addUserToQueue(msg);break;case 2:break;case 3:break;case 4:break;case 5:break;case 6:localStorage.setItem("cvlc_chatStatus","waiting");localStorage.removeItem("cvlc_roomId");localStorage.removeItem("cvlc_agentName");window.cvCrossStorage.onConnect().then(function(){window.cvCrossStorage.del("cvlc_roomId","cvlc_agentName");window.cvCrossStorage.set("cvlc_chatStatus","waiting")});_this.chatTransfered(msg);break;case 7:break;case 8:localStorage.setItem("cvlc_chatStatus","waiting");localStorage.removeItem("cvlc_roomId");localStorage.removeItem("cvlc_agentName");window.cvCrossStorage.onConnect().then(function(){window.cvCrossStorage.del("cvlc_roomId","cvlc_agentName");window.cvCrossStorage.set("cvlc_chatStatus","waiting")});_this.chatTransferedToPersonal(msg);break;case 9:localStorage.setItem("cvlc_chatStatus","waiting");localStorage.removeItem("cvlc_roomId");localStorage.removeItem("cvlc_agentName");window.cvCrossStorage.onConnect().then(function(){window.cvCrossStorage.del("cvlc_roomId","cvlc_agentName");window.cvCrossStorage.set("cvlc_chatStatus","waiting")});_this.userNotWaitingInQueue(msg);break;case 10:localStorage.setItem("cvlc_chatStatus","chatting");window.cvCrossStorage.onConnect().then(function(){window.cvCrossStorage.set("cvlc_chatStatus","chatting")});_this.userPickedUpFromQueue(msg);break;case 11:break;case 12:break;case 13:localStorage.setItem("cvlc_chatStatus","ended");localStorage.removeItem("cvlc_agentName");localStorage.removeItem("cvlc_roomId");localStorage.removeItem("cvlc_userSessionId");window.cvCrossStorage.onConnect().then(function(){window.cvCrossStorage.del("cvlc_agentName","cvlc_roomId","cvlc_userSessionId");window.cvCrossStorage.set("cvlc_chatStatus","ended")});_this.chatEnded(msg);break;case 14:break;case 15:break;case 16:localStorage.setItem("cvlc_chatStatus","chatting");window.cvCrossStorage.onConnect().then(function(){window.cvCrossStorage.set("cvlc_chatStatus","chatting")});_this.agentComposingMessage(msg);break;case 17:localStorage.setItem("cvlc_chatStatus","chatting");window.cvCrossStorage.onConnect().then(function(){window.cvCrossStorage.set("cvlc_chatStatus","chatting")});_this.agentNotComposingMessage(msg);break;case 18:break;case 19:break;case 20:break;case 21:break;case 22:break;case 23:break;case 24:break;case 25:localStorage.setItem("cvlc_chatStatus","chatting");window.cvCrossStorage.onConnect().then(function(){window.cvCrossStorage.set("cvlc_chatStatus","chatting")});_this.onLine(msg,source);_this.refreshTimeout();window.CVSaveAttributes();break;case 31:localStorage.setItem("cvlc_chatStatus","chatting");window.cvCrossStorage.onConnect().then(function(){window.cvCrossStorage.set("cvlc_chatStatus","chatting")});_this.agentUnavailable(msg);break;case 33:localStorage.setItem("cvlc_chatStatus","chatting");window.cvCrossStorage.onConnect().then(function(){window.cvCrossStorage.set("cvlc_chatStatus","chatting")});_this.resumeChat(msg);break;case 35:localStorage.setItem("cvlc_chatStatus","ended");localStorage.removeItem("cvlc_roomId");localStorage.removeItem("cvlc_userSessionId");localStorage.removeItem("cvlc_agentName");window.cvCrossStorage.onConnect().then(function(){window.cvCrossStorage.del("cvlc_roomId","cvlc_userSessionId","cvlc_agentName");window.cvCrossStorage.set("cvlc_chatStatus","ended")});clearInterval(_this.pingInterval);_this.closeDuplicate=1;_this.websocket.close();_this.makeGetRequest(Settings.creativeVirtual.livechatUrl+"invalidateUserSession.html",function(){});break;case 36:_this.closeDuplicate=1;clearInterval(_this.pingInterval);_this.resumeSuspend(msg);break;case 37:_this.closeDuplicate=1;break;case 38:_this.systemUnavailable(msg);break;case 40:localStorage.setItem("cvlc_chatStatus","chatting");window.cvCrossStorage.onConnect().then(function(){window.cvCrossStorage.set("cvlc_chatStatus","chatting")});_this.onLine(msg,source);_this.refreshTimeout();window.CVSaveAttributes()}},createChatRequestModel:function(){var _this=this,chatRequestModel={customerId:_this.lcAttributes.customerId,userName:_this.lcAttributes.userName,userSessionId:_this.lcAttributes.userSessionId,endUserId:_this.lcAttributes.endUserId,queueId:_this.lcAttributes.queueId};return chatRequestModel},resumeChat:function(msg){var _this=this;_this.lcAttributes.queueId=localStorage.getItem("cvlc_queueId");_this.lcAttributes.roomJid=localStorage.getItem("cvlc_roomId");_this.lcAttributes.chatFrom=localStorage.getItem("cvlc_agentName");_this.lcAttributes.agent=localStorage.getItem("cvlc_agentName");localStorage.setItem("cvlc_chatStatus","chatting");window.cvCrossStorage.onConnect().then(function(){window.cvCrossStorage.set("cvlc_chatStatus","chatting")});_this.setButtonState();_this.$el.find("#cv-live-chat-user-entry").show();if(_this.isAgentUnavailable===!0){_this.addSystemMessage(_this.messages.msg6);_this.isAgentUnavailable=!1}console.log("resume chat")},resumeSuspend:function(msg){var _this=this;_this.lcAttributes.queueId=localStorage.getItem("cvlc_queueId");console.log("resume suspend")},systemUnavailable:function(msg){var _this=this;clearInterval(_this.pingInterval);clearInterval(_this.netDetInterval)},addUserToQueue:function(msg){var _this=this;_this.lcAttributes.queueId=msg.queueId;_this.lcAttributes.roomId=null;_this.lcAttributes.roomJid=null;_this.lcAttributes.agent=null;_this.makePostRequest(Settings.creativeVirtual.livechatUrl+"endUserStatus.html",_this.createChatRequestModel(),function(){});var user_count=msg.queuePosition,show_position=msg.showPosition,queue_announcement=msg.queueAnnoucement,display_string="";if(msg.showWaitTime)var total_load=msg.totalLoad,active_sessions=msg.activeSessions,show_wait_time=msg.showWaitTime,expected_wait_time=msg.expectedWaitTime;queue_announcement&&(display_string+="<span>"+queue_announcement+"</span> ");_this.lcAttributes.position=user_count;show_position&&(display_string+="<span>"+_this.messages.msg10+'</span> <span class="va-strong">'+user_count+"</span> ");if(msg.showWaitTime&&1===Number(show_wait_time))if(Number(active_sessions)+Number(user_count)<Number(total_load))display_string+="<span>"+_this.messages.msg11+'</span> <span class="va-strong">60 '+_this.messages.msg12+"</span> ";else{expected_wait_time=expected_wait_time*parseInt(user_count)/parseInt(total_load);display_string+=Math.round(100*expected_wait_time)/100<60?"<span>"+_this.messages.msg11+'</span> <span class="va-strong">60 '+_this.messages.msg12+"</span> ":"<span>"+_this.messages.msg11+'</span> <span class="va-strong">'+Math.round(expected_wait_time)+" "+_this.messages.msg12+"</span> "}_this.addSystemMessage(display_string);console.log("addUserToQueue");console.log(msg);_this.refreshTimeout();window.CVSaveAttributes()},userPickedUpFromQueue:function(msg){var _this=this,topic_id=(msg.queueName,msg.queueId);_this.lcAttributes.queueId=topic_id;_this.lcAttributes.roomJid=msg.roomId;_this.lcAttributes.roomId=msg.roomId;_this.lcAttributes.chatFrom=msg.agentName;_this.isAgentUnavailable=!1;localStorage.setItem("cvlc_userSessionId",_this.lcAttributes.userSessionId);localStorage.setItem("cvlc_roomId",msg.roomId);localStorage.setItem("cvlc_agentName",msg.agentName);localStorage.setItem("cvlc_queueId",msg.queueId);localStorage.setItem("cvlc_chatStatus","chatting");window.cvCrossStorage.onConnect().then(function(){window.cvCrossStorage.set("cvlc_userSessionId",_this.lcAttributes.userSessionId);window.cvCrossStorage.set("cvlc_roomId",msg.roomId);window.cvCrossStorage.set("cvlc_agentName",msg.agentName);window.cvCrossStorage.set("cvlc_chatStatus","chatting");window.cvCrossStorage.set("cvlc_queueId",msg.queueId)});_this.chatStarted(msg);_this.addSystemMessage(_this.messages.msg15+msg.agentName);_this.refreshTimeout();window.CVSaveAttributes();console.log("userPickedUpFromQueue");console.log(msg)},userNotWaitingInQueue:function(msg){var _this=this,position=_this.lcAttributes.position,user_count=msg.queuePosition,display_string="",currentPosition=0;if(msg.showWaitTime)var total_load=msg.totalLoad,active_sessions=msg.activeSessions,show_wait_time=msg.showWaitTime,expected_wait_time=msg.expectedWaitTime;if(position&&position>1){currentPosition=position-1;_this.lcAttributes.position=currentPosition;msg.showPosition&&(display_string+="<span>"+_this.messages.msg10+'</span> <span class="va-strong">'+currentPosition+"</span> ");if(msg.showWaitTime&&1===Number(show_wait_time))if(Number(active_sessions)+Number(user_count)<Number(total_load))display_string+="<span>"+_this.messages.msg11+'</span> <span class="va-strong">60 '+msessages.msg12+"</span> ";else{expected_wait_time=expected_wait_time*parseInt(user_count)/parseInt(total_load);display_string+=Math.round(100*expected_wait_time)/100<60?"<span>"+_this.messages.msg11+'</span> <span class="va-strong">60 '+msessages.msg12+"</span> ":"<span>"+_this.messages.msg11+'</span> <span class="va-strong">'+Math.round(expected_wait_time)+" "+msessages.msg12+"</span> "}_this.addSystemMessage(display_string);_this.refreshTimeout();window.CVSaveAttributes()}console.log("userNotWaitingInQueue");console.log(msg)},chatEnded:function(msg){var _this=this;clearInterval(_this.pingInterval);_this.makePostRequest(Settings.creativeVirtual.livechatUrl+"endUserStatus.html",_this.createChatRequestModel(),function(){});_this.clearLocalStorage();_this.websocket.close();_this.makeGetRequest(Settings.creativeVirtual.livechatUrl+"invalidateUserSession.html",function(){});_this.addSystemMessage(_this.messages.msg7);_this.$el.find("#cv-live-chat-user-entry").remove();_this.$el.find("#"+_this.submitID).addClass("disabled").prop("disabled","true");$(".cv-va-bootstrap #cv-live-chat-submit.disabled").css({"background-color":Settings.submitBtn.disabled.backgroundColor,"border-color":Settings.submitBtn.disabled.backgroundColor});window.CVSaveAttributes();localStorage.setItem("cvlc_chatStatus","ended");window.cvCrossStorage.onConnect().then(function(){window.cvCrossStorage.set("cvlc_chatStatus","ended")});console.log("chat ended")},addSystemMessage:function(msg){var $transaction,_this=this;$transaction=$("<div>").addClass("cv-live-chat-info");$transaction.html(msg.replace("<div","<span").replace("</div>","</span>"));_this.$el.find("#cv-live-chat-answer-history").append($transaction);$transaction.addClass("cv-live-chat-system");_this.$el.find("#cv-live-chat-answer-history").scrollTo("max",{duration:500})},agentUnavailable:function(msg){var _this=this;_this.isAgentUnavailable=!0;_this.$el.find("#"+_this.submitID).addClass("disabled").prop("disabled","true");$(".cv-va-bootstrap #cv-live-chat-submit.disabled").css({"background-color":Settings.submitBtn.disabled.backgroundColor,"border-color":Settings.submitBtn.disabled.backgroundColor});_this.$el.find("#cv-live-chat-user-entry").hide();_this.addSystemMessage(_this.messages.msg2);console.log("agent unavailable")},agentComposingMessage:function(msg){var _this=this,who=msg.fromName;_this.$el.find("#cv-chat-form").before('<span class="cv-live-chat-agent-typing">'+who+_this.messages.msg18+"</span>");_this.$el.find(".cv-live-chat-agent-typing").show();window.CVSaveAttributes()},agentNotComposingMessage:function(msg){var _this=this;_this.$el.find(".cv-live-chat-agent-typing").remove()},chatStarted:function(msg){var _this=this,who=msg.agentName;_this.lcAttributes.agent=who;_this.$el.find("#cv-chat-user-entry").remove();_this.$el.find("#cv-chat-submit").remove();_this.makePostRequest(Settings.creativeVirtual.livechatUrl+"endUserStatus.html",_this.createChatRequestModel(),function(){});if(_this.lcStarted!==!0){_this.$el.find("#cv-chat-form .form-group").first().append('<input id="cv-live-chat-user-entry" type="text" name="entry" autocomplete="off" class="form-control cv-chat-user-entry" placeholder="'+Settings.defaultPlaceholderText+'">');_this.$el.find(".cv-chat-footer").parent().attr("aria-live","polite");0===_this.$el.find("#cv-live-chat-submit").length?$(_this.$el.find("#cv-chat-form .form-group")[1]).append('<button id="cv-live-chat-submit" type="submit" class="btn btn-primary btn-lg btn-block small-border-radius" disabled="disabled" style="padding: 0px !important:"><i class="fa fa-paper-plane"></i>'+_this.messages.msg22+"</button>"):_this.$el.find("#cv-live-chat-submit").show();_this.$el.find("#cv-chat-form").show();_this.$el.find("#"+_this.entryID).keyup(function(event){_this.keyPress(event,_this)});_this.$el.find("#"+_this.entryID).css({"font-size":Settings.inputFontSize,"border-radius":Settings.inputBorderRadius})}_this.lcStarted=!0;console.log("chat started")},keyPress:function(event,that){var _this=this;console.log(event);event.preventDefault();event.stopPropagation();that.setButtonState();13==event.keyCode&&that.addLine(event);clearTimeout(_this.userTypingTimeout);if(!_this.userTyping){_this.userTyping=!0;_this.notifyState("16")}_this.userTypingTimeout=setTimeout(function(){_this.notifyState("17");_this.userTyping=!1},2e3)},notifyState:function(msgCode){var _this=this,responseDataWS={messageCode:msgCode,customerId:_this.lcAttributes.customerId,roomId:_this.lcAttributes.roomId,fromId:_this.lcAttributes.userSessionId,fromName:_this.lcAttributes.userName,queueId:_this.lcAttributes.queueId};_this.websocket.send(JSON.stringify(responseDataWS))},setButtonState:function(){var _this=this,field_val=_this.$el.find("#"+_this.entryID).val();if($.trim(field_val).length>0&&_this.isAgentUnavailable!==!0){_this.$el.find("#"+_this.submitID).removeClass("disabled").removeAttr("disabled");$(".cv-va-bootstrap #cv-live-chat-submit.btn").css({"background-color":Settings.submitBtn.backgroundColor,"border-color":Settings.submitBtn.backgroundColor})}else{_this.$el.find("#"+_this.submitID).addClass("disabled").prop("disabled","true");$(".cv-va-bootstrap #cv-live-chat-submit.disabled").css({"background-color":Settings.submitBtn.disabled.backgroundColor,"border-color":Settings.submitBtn.disabled.backgroundColor})}},chatTransfered:function(msg){var _this=this;_this.makePostRequest(Settings.creativeVirtual.livechatUrl+"endUserStatus.html",_this.createChatRequestModel(),function(){});_this.lcAttributes.roomId=null;localStorage.setItem("cvlc_queueId",msg.queueId);window.cvCrossStorage.onConnect().then(function(){window.cvCrossStorage.set("cvlc_queueId",msg.queueId)});_this.lcStarted=!1;_this.$el.find("#cv-live-chat-user-entry").remove();_this.$el.find("#"+_this.submitID).addClass("disabled").prop("disabled","true");$(".cv-va-bootstrap #cv-live-chat-submit.disabled").css({"background-color":Settings.submitBtn.disabled.backgroundColor,"border-color":Settings.submitBtn.disabled.backgroundColor});_this.lcAttributes.queueId=msg.queueId;_this.addSystemMessage(_this.messages.msg13);_this.refreshTimeout();window.CVSaveAttributes();console.log("chat transfered")},chatTransferedToPersonal:function(msg){var _this=this;_this.makePostRequest(Settings.creativeVirtual.livechatUrl+"endUserStatus.html",_this.createChatRequestModel(),function(){});_this.lcAttributes.roomId=null;localStorage.setItem("cvlc_queueId",msg.queueId);window.cvCrossStorage.onConnect().then(function(){window.cvCrossStorage.set("cvlc_queueId",msg.queueId)});_this.lcStarted=!1;_this.$el.find("#cv-live-chat-user-entry").remove();_this.$el.find("#"+_this.submitID).addClass("disabled").prop("disabled","true");$(".cv-va-bootstrap #cv-live-chat-submit.disabled").css({"background-color":Settings.submitBtn.disabled.backgroundColor,"border-color":Settings.submitBtn.disabled.backgroundColor});_this.lcAttributes.queueId=msg.queueId;_this.addSystemMessage(_this.messages.msg13);_this.refreshTimeout();window.CVSaveAttributes();console.log("chat transfered to personal")},onLine:function(msg,source){var $transaction,dt,time,timestamp,_this=this,who=msg.fromName,body=msg.messageText;if(who&&body){if(msg.messageTimestamp){timestamp=new Date(msg.messageTimestamp);time=timestamp.getHours()+":"+(timestamp.getMinutes()<10?"0":"")+timestamp.getMinutes()}else{dt=new Date;time=dt.getHours()+":"+(dt.getMinutes()<10?"0":"")+dt.getMinutes()}if("agent"===source){_this.$el.find(".cv-live-chat-agent-typing").remove();$transaction=$("<div>").addClass("cv-live-chat-info");$transaction.html(body.replace("<p","<div").replace("</p>","</div>"));this.$el.find("#cv-live-chat-answer-history").append($transaction);$transaction.addClass("cv-live-chat-agent");$transaction.find("a").on("click",function(event){event.preventDefault();var targetHostname=event.target.hostname;targetHostname===window.location.hostname?$(this).attr("target","_self"):$(this).attr("target","_blank");window.open($(this).attr("href"),$(this).attr("target"))});this.$el.find(".cv-live-chat-agent").last().wrap('<div class="panel panel-default cv-chat-transaction-panel"><div class="col-xs-12"></div></div>');this.$el.find(".cv-live-chat-agent").last().after('<span class="time-stamp-info">'+msg.fromName.split(" ")[0]+"&nbsp"+time+"</span>");this.$el.find(".cv-live-chat-agent").addClass("ts-shim")}else{$transaction=$("<div>").addClass("cv-live-chat-user").attr("aria-hidden",!0);$transaction.html(body);this.$el.find("#cv-live-chat-answer-history").append($transaction);this.$el.find(".cv-live-chat-user").last().wrap('<div class="panel panel-default cv-chat-transaction-panel"><div class="col-xs-12"></div></div>');this.$el.find(".cv-live-chat-user").last().after('<span class="time-stamp-user" aria-hidden="true">You '+time+"</span>");this.$el.find(".cv-live-chat-user").addClass("ts-shim")}_this.$el.find("#cv-live-chat-answer-history").scrollTo("max",{duration:500});console.log("user message");console.log(msg)}},addLine:function(event){event.preventDefault();event.stopPropagation();for(var _this=this,piipatterns=[[/6(?:011|5[0-9]{2})[0-9]{12}/g,"****************"],[/\b\d{12,20}\b/g,"*******************"],[/\b(\d{4}[\s\-\_\|\.]*){4,5}\b/gm,"*******************"],[/\b(\d{4}[\s\-\_\|\.]*)(\d{6}[\s\-\_\|\.]*)(\d{5})\b/gm,"*****************"],[/\b(\d{6}[\s\-\_\|\.]*)(\d{4}[\s\-\_\|\.]*){2}(\d{3})\b/gm,"********************"],[/\b(\d{4}[\s\-\_\|\.]*){3}(\d{3,5})\b/gm,"********************"],[/\b(3[\s\-\_\|\.]*1[\s\-\_\|\.]*2[\s\-\_\|\.]*4[\s\-\_\|\.]*0[\s\-\_\|\.]*1[\s\-\_\|\.]*)(\d[\s\-\_\|\.]*){0,19}\b/gm,"********************"],[/\b\d{5}(?:-\d{4})?\b/g,"*****"],[/\b[a-z]\d[a-z]\s?\d[a-z]\d\b/g,"*****"],[/\S+@\S+\.\S+/g,"******************"]],inputText=_this.$el.find("#"+_this.entryID).val(),a=0,b=piipatterns.length;b>a;a++){var e=piipatterns[a];inputText=inputText.replace(e[0],e[1])}if(inputText&&null!=inputText&&inputText.length>0&&""!=inputText.trim()&&_this.isAgentUnavailable!==!0){var responseDataWS={customerId:_this.lcAttributes.customerId,queueId:_this.lcAttributes.queueId,fromId:_this.lcAttributes.userSessionId,fromName:_this.lcAttributes.userName,roomId:_this.lcAttributes.roomId,messageTimestamp:new Date,messageText:inputText,messageCode:25};_this.websocket.send(JSON.stringify(responseDataWS));_this.$el.find("#"+_this.entryID).val("");_this.wsOnMessage(JSON.stringify(responseDataWS),"enduser")}},monitorNetworkLoss:function(){var _this=this;_this.netDetInterval=setInterval(function(){Settings.creativeVirtual.livechatUrl+"resources/livechatui/assets/img/favicon.ico"},3e3)},getCurrentTime:function(){var currentTime=new Date,Hours=currentTime.getHours(),Minutes=currentTime.getMinutes(),time_of_day=(currentTime.getSeconds(),12>Hours?"AM":"PM");Minutes=(10>Minutes?"0":"")+Minutes;Hours=Hours>12?Hours-12:Hours;Hours=0===Hours?12:Hours;return Hours+":"+Minutes+" "+time_of_day},refreshTimeout:function(){window.cvCrossStorage.onConnect().then(function(){return window.cvCrossStorage.set(Settings.businessName+"-cvVaTimestamp",Date.now())});localStorage.setItem(Settings.businessName+"-cvVaTimestamp",Date.now())},clearLocalStorage:function(){localStorage.removeItem("cvlc_customerId");localStorage.removeItem("cvlc_username");localStorage.removeItem("cvlc_firstName");localStorage.removeItem("cvlc_lastName");localStorage.removeItem("cvlc_emailId");localStorage.removeItem("cvlc_chatStatus");localStorage.removeItem("cvlc_userSessionId");localStorage.removeItem("cvlc_endUserId");localStorage.removeItem("cvlc_roomId");localStorage.removeItem("cvlc_agentName");localStorage.removeItem("cvlc_queueId");localStorage.removeItem("cvlc_queueName");window.cvCrossStorage.onConnect().then(function(){window.cvCrossStorage.del("cvlc_customerId","cvlc_username","cvlc_firstName","cvlc_lastName","cvlc_emailId","cvlc_chatStatus","cvlc_userSessionId","cvlc_endUserId","cvlc_roomId","cvlc_agentName","cvlc_queueId","cvlc_queueName")})}});return LiveChat});window.lpTag=window.lpTag||{};lpTag.cookieMethods=lpTag.cookieMethods||function(){"use strict";function a(){var a="lpTestCookie"+(new Date).getTime(),b="testValue";f({name:a,value:b});h=b===c(a);g(a);i=!1;return h}function b(){return h}function c(a){var b,c,d="; ",e="";if(i||h){if("string"!=typeof a)return"";a=encodeURIComponent(a);try{c=d+document.cookie}catch(f){}b=c.split(d+a+"=");e=1==b.length?"":decodeURIComponent(b[1].split(";")[0])}return e}function d(a,b,c){c="number"==typeof c?c:2592e3;"object"==typeof a&&(a.seconds=c);return e(a,b,c)}function e(a,b,c,d,e,g){return f("object"==typeof a?a:{name:a,value:b,seconds:c,path:d,domain:e,secure:g})}function f(a){var b,c,d=!1;if(i||h){if("string"!=typeof a.name||""===a.name)return!1;null!==a.value&&void 0!==a.value||(a.seconds=-1);if("number"==typeof a.seconds){c=(new Date).getTime();b=new Date(c+1e3*a.seconds)}a.value=a.value?encodeURIComponent(a.value):"";try{document.cookie=[encodeURIComponent(a.name),"=",a.value,b?"; expires="+b.toUTCString():"",a.path?"; path="+a.path:"",a.domain?"; domain="+a.domain:"",a.secure?"; secure":""].join("");d=!0}catch(e){}}return d}function g(a,b,c){return f({name:a,path:b,domain:c})}var h=!1,i=!0;a();return{clearCookie:g,writeSessionCookie:e,writePersistentCookie:d,readCookie:c,isCookieEnabled:b}}();window.lpTag=window.lpTag||{};lpTag.storageMethods=lpTag.storageMethods||function(){"use strict";function a(){return l&&m}function b(){return l}function c(){return m}function d(a,c){if(b()){sessionStorage.setItem(a,c);return!0}}function e(a){return b()?sessionStorage.getItem(a)||"":void 0}function f(a){if(b()&&e(a)){sessionStorage.removeItem(a);return!0}return!1}function g(a,b){if(c()){localStorage.setItem(a,b);return!0}}function h(a){return c()?localStorage.getItem(a)||"":void 0}function i(a){if(c()&&h(a)){localStorage.removeItem(a);return!0}return!1}function j(){try{l=k(sessionStorage);m=k(localStorage)}catch(a){}}function k(a){var b=!1,c="lpTestCase",d="abc";try{if("undefined"!=typeof Storage){a.setItem(c,d);b=a.getItem(c)===d;a.removeItem(c)}}catch(e){}return b}var l=!1,m=!1;j();return{isStorageEnabled:a,isSessionStorageEnabled:b,isLocalStorageEnabled:c,setSessionData:d,getSessionData:e,removeSessionData:f,setPersistentData:g,getPersistentData:h,removePersistentData:i}}();window.lpTag=window.lpTag||{};lpTag.SessionDataManager=lpTag.SessionDataManager||function(a){"use strict";function b(a){lpTag&&lpTag.log&&lpTag.log(a,"ERROR","SessionData")}function c(a,c,d){var e=!1;if("object"!=typeof c)try{var f=d?g.getPersistentSessionData(a):g.getSessionData(a),h=""!==f?f.split(i):[];h.push(c);f=h.join(i);e=d?g.setPersistentData(a,f,d):g.setSessionData(a,f)}catch(j){b((d?"appendToPersistentData ":"appendToSessionData ")+" failed, key: "+a)}return e}function d(a,c,d){var e=!1;if("object"!=typeof c)try{for(var f=d?g.getPersistentSessionData(a):g.getSessionData(a),h=""!==f?f.split(i):[],j=[],k=0;k<h.length;k++)h[k]!==c&&j.push(h[k]);f=j.join(i);e=""!==f?d?g.setPersistentData(a,f,d):g.setSessionData(a,f):d?g.removePersistentData(a):g.removeSessionData(a)}catch(l){b((d?"removePartialPersistentData ":"removePartialSessionData ")+" failed, key: "+a)}return e}var e,f,g,h,i="::",j={},k={},l="object"==typeof a?a:{};if(this!==window){e=lpTag.storageMethods;f=lpTag.cookieMethods;h=!0!==l.disableStorage&&e.isStorageEnabled();g=this;this.readCookie=function(a){return f.readCookie(a)};this.setSessionData=function(a,c){c=this.stringifyValue(c);try{j[a]||(j[a]=a);h?e.setSessionData(a,c):f.writeSessionCookie(a,c)}catch(d){b("Error in setSessionData, data: "+a)}};this.getSessionData=function(a){try{return this.parseValue(h?e.getSessionData(a):f.readCookie(a))}catch(c){b("Error in getSessionData, data: "+a)}};this.stringifyValue=function(a){try{"object"==typeof a&&(a=JSON.stringify(a))}catch(b){}return a};this.parseValue=function(a){try{a=JSON.parse(a)}catch(b){}return a};this.getPersistentSessionData=function(a){try{return this.parseValue(h?e.getPersistentData(a):f.readCookie(a))}catch(c){b("Error in getPersistentSessionData, data: "+a)}};this.appendToSessionData=function(a,b){c(a,b,!1)};this.appendToPersistentData=function(a,b,d){c(a,b,!0,d)};this.removePartialPersistentData=function(a,b){d(a,b,!0)};this.removeSessionData=function(a){h?e.removeSessionData(a):f.clearCookie(a)};this.removePersistentData=function(a){h?e.removePersistentData(a):f.clearCookie(a)};this.removePartialSessionData=function(a,b){d(a,b,!1)};this.setPersistentData=function(a,c,d){c=this.stringifyValue(c);try{k[a]||(k[a]=a);h?e.setPersistentData(a,c):f.writePersistentCookie(a,c,d)}catch(g){b("Error in setPersistentData, data: "+a)}};this.clearPersistentData=function(a){a=a||k;for(var c in a)try{h?e.removePersistentData(a[c]):f.clearCookie(a[c])}catch(d){b("Error in clearPersistentData, key: "+a[c])}};this.clearSessionData=function(a){a=a||j;for(var c in a)try{h?e.removeSessionData(a[c]):f.clearCookie(a[c])}catch(d){b("Error in SessionData in clearSessionData, key:"+a[c])}}}};window.lpTag=window.lpTag||{};lpTag.taglets=lpTag.taglets||{};lpTag.utils=lpTag.utils||{};lpTag.utils.SessionDataAsyncWrapper=lpTag.utils.SessionDataAsyncWrapper||function(a){"use strict";function b(a,b,c,d){var j;if(l)h.getValue({key:a,appName:g,site:k,success:e(a,b,d),error:e(a,c,d),context:d,domain:i});else{j=m.getSessionData(a);void 0!==j?f(b,j,d):f(c,j,d)}}function c(a,b,c,d,j){l?h.setValue({key:a,appName:g,value:b,site:k,success:e(a,c,j),error:e(a,d,j),context:j,domain:i}):m.setSessionData(a,b)?f(c,!0,j):f(d,!1,j)}function d(a,b,c,d){l?h.setValue({key:a,appName:g,site:k,success:e(a,b,d),error:e(a,c,d),context:d,domain:i,expires:-1}):m.removeSessionData(a)?f(b,!0,d):f(c,!1,d)}function e(a,b,c){return function(a){f(b,a,c)}}function f(a,b,c){try{a&&"function"==typeof a&&a.call(c,b)}catch(d){}}if(this===window)return null;a=a||{};var g,h,i,j=a.useSecureStorage,k=a.lpNumber,l=!1;if(j){g=a.appName;h=lpTag.taglets&&lpTag.taglets.lpSecureStorage;i=a.secureStorageLocation;l=!!(j&&i&&h&&g)}lpTag.SessionDataManager&&(lpTag.utils.sessionDataManager=lpTag.utils.sessionDataManager||new lpTag.SessionDataManager(a));var m=lpTag.utils.sessionDataManager||null;return{setSessionData:c,getSessionData:b,removeSessionData:d,readCookie:lpTag.utils.sessionDataManager&&lpTag.utils.sessionDataManager.readCookie,usingSecureStorage:l}};window.lpTag=window.lpTag||{};lpTag.RelManager=lpTag.RelManager||function(a){"use strict";function b(a,b){var c;for(var d in b.data)if(b.data.hasOwnProperty(d)){c=k.getURI(a,{type:d,id:b.data[d]});if(c)break}return c}function c(a){if(a.indexOf("v=1")<0){a+=a.indexOf("?")>-1?"&":"?";a+="v=1"}a.indexOf("&NC=true")<0&&(a+="&NC=true");return a}function d(a){j&&a.toLowerCase().indexOf(".json")<0&&(a.indexOf("?")>0?a=a.replace("?",".json?"):a+=".json");return a}function e(a){var b="";for(var c in a)if(a.hasOwnProperty(c)&&void 0!==a[c]&&null!==a[c])if(a[c].constructor===Array)for(var d=0;d<a[c].length;d++)b+="&"+encodeURIComponent(c)+"="+encodeURIComponent(a[c][d]);else b+="&"+encodeURIComponent(c)+"="+encodeURIComponent(a[c]);return b}function f(a){return"PUT"===a||"DELETE"===a?"POST":a||"GET"}function g(a){var b={AUTHORIZATION:"LivePerson appKey="+n.appKey};n.accessToken&&(b={AUTHORIZATION:"Bearer "+n.accessToken});"PUT"!==a&&"DELETE"!==a||(b["X-HTTP-Method-Override"]=a);return b}function h(a,b){a?a=b.url:b&&b.rel||!n.domain||!n.lpNumber?b&&b.rel&&(a=k.getURI(b.rel,{type:b.type,id:b.id,needAuth:b.needAuth})):a="https://"+n.domain+"/api/account/"+n.lpNumber;if(a){a=d(a);a=c(a)}return a}function i(a,b,c){lpTag&&lpTag.utils&&lpTag.utils.log&&lpTag.utils.log(a,b,c)}var j=!0,k=this,l=null,m="",n={domain:"",lpNumber:"",appKey:"",accessToken:""},o=["xhr","postmessage","rest2jsonp"];if(this===window){i("RelManager called without new","DEBUG","lpTag.RelManager");return new lpTag.RelManager(a)}a&&a.constructor===Array&&(o=a);this.clearData=function(){for(var a in n)n.hasOwnProperty(a)&&(n[a]="");l=null;m=""};this.setData=function(a){l={};m="";if(a){for(var b in a)a.hasOwnProperty(b)&&(n[b]=a[b]);"boolean"==typeof a.useJSON&&(j=a.useJSON);a.transportOrder&&(o=a.transportOrder)}};this.addRels=function(a,b){var c,d,e,f;if(b){f=this.extractRels(a);c=l[b.type]=l[b.type]||{};b.id&&(c=c[b.id]=c[b.id]||{});for(var g in f)if(f.hasOwnProperty(g)){d=f[g].rel||f[g]["@rel"];e=f[g].href||f[g]["@href"];c[d]=e}if(b.data){c.data=c.data||{};for(var h in b.data)b.data.hasOwnProperty(h)&&(c.data[h]=b.data[h])}}};this.removeRels=function(a){var b=!1;if(a&&void 0!==a.type&&l[a.type])if(a.id){if(l[a.type][a.id]){l[a.type][a.id]=null;delete l[a.type][a.id];b=!0}}else{l[a.type]=null;delete l[a.type];b=!0}return b};this.hasRel=function(a,b){return!!this.getURI(a,b)};this.buildRequestObj=function(a){var b={url:"",method:"",headers:"",data:""};b.url=h(a&&a.url,a);a&&a.queryParams&&b.url&&(b.url+=e(a.queryParams));b.headers=g(a&&a.requestType);b.method=f(a&&a.requestType);b.transportOrder=a&&a.transportOrder||o.slice(0);a&&a.data&&(b.data=a.data);return b.url?b:null};this.extractRels=function(a){var b=[];for(var c in a)if(a.hasOwnProperty(c)&&0===b.length){if("link"===c){b=a[c].constructor===Array?a[c]:[a[c]];break}null!==a[c]&&void 0!==a[c]&&"object"==typeof a[c]&&a[c].constructor!==Array&&(b=this.extractRels(a[c]))}return b};this.getURI=function(a,c){var d,e=null;if(c&&l){d=l[c.type];d&&c.id&&d[c.id]&&(d=d[c.id]);if(d){e=d[a]||null;!e&&d.data&&(e=b(a,d))}}return e}};!function(a){"use strict";function b(a,b,c){lpTag&&lpTag.log&&lpTag.log(a,b,c)}function c(a,b,c){return d.getPropertyFromObject(a,"body",{error:{message:b,time:new Date,originalRequest:c}})}a.lpTag=a.lpTag||{};lpTag.taglets=lpTag.taglets||{};lpTag.utils=lpTag.utils||{};var d=lpTag.utils;d.runErrorCallback=function(a,b){a&&a.error&&lpTag.utils.runCallback(a.error,a,b);b=null;a=null};d.runSuccessCallback=function(a,b){a&&a.success&&lpTag.utils.runCallback(a.success,a,b)};d.runCallback=function(a,c,d){if(a&&"function"==typeof a)try{a.call(c.context||c,d)}catch(e){b("Failed to run callback, callback: "+a+" data: "+d,"error","lpTag.utils.runCallback")}};d.validateAndExtendConfigs=function(a,b,c){for(var e=0;e<a.length;e++){b=d.validateAndExtend(a[e],b);if(c&&b.hasOwnProperty(a[e].prop))break}return b};d.validateAndExtend=function(a,b){var c,e=!0;b=b||{};if(a&&d.validateType("object",a)){c=d.getPropertyFromObject(a.obj,a.path,a.defaultValue);if(void 0!==c&&null!==c){a.type&&(e=d.validateType(a.type,c));e&&(b[a.prop]=c)}}return b};d.validateType=function(a,b){var c=!1;c="number"===a?!isNaN(b):"array"===a?b.constructor===Array:typeof b===a;return c};d.getPropertyFromObject=function(a,b,c){var d,e=a;if("string"==typeof b){d=b.split(".");for(var f=0;f<d.length;f++){if(void 0===e||null===e||void 0===e[d[f]]||null===e[d[f]]){e=void 0!==c?c:void 0;break}e=e[d[f]]}}return e};d.trim=function(a){"string"==typeof a&&""!==a&&(a=a.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,""));return a};d.getErrorData=function(a,b,d,e){a=c(a,b,d);for(var f in e)e.hasOwnProperty(f)&&!a[f]&&(a[f]=e[f]);
e=null;return a};d.getResponseData=function(a,b,c,e){var f,g,h,i=d.getPropertyFromObject(a,"body",{});if(b){h=b.split(".");g=h.length;for(var j=0;g>j;j++){f=h[j];if(void 0===i[f])break;i=i[f]}if(!0===c){var k={};k[h[g-1]]=i;i=k}}i=d.removeRels(i);for(var l in e)e.hasOwnProperty(l)&&void 0===i[l]&&(i[l]=e[l]);return i};d.removeRels=function(a){for(var b in a)if(a.hasOwnProperty(b))if("link"==b){a[b]=null;delete a[b]}else"object"==typeof a[b]&&(a[b]=lpTag.utils.removeRels(a[b]));return a};d.deleteProps=function(a,b){for(var c=0;c<b.length;c++)if(a.hasOwnProperty(b[c]))try{a[b[c]]=null;delete a[b[c]]}catch(d){}};d.hasProperties=function(a){var b=!1;if(a&&"object"==typeof a)for(var c in a)if(a.hasOwnProperty(c)){b=!0;break}return b}}(window);window.lpTag=window.lpTag||{};lpTag.taglets=lpTag.taglets||{};lpTag.taglets.lpajax_utils={_name:"lpajax_utils",_v:"0.1",each:function(a,b,c){if(null!=a){var d=Array.prototype.forEach;if(d&&a.forEach===d)a.forEach(b,c);else if(a.length===+a.length){for(var e=0,f=a.length;f>e;e++)if(e in a&&b.call(c,a[e],e,a)==={})return}else for(var g in a)if(Object.prototype.hasOwnProperty.call(a,g)&&b.call(c,a[g],g,a)==={})return}},extend:function(a){this.each(Array.prototype.slice.call(arguments,1),function(b){for(var c in b)a[c]=b[c]});return a},isEmptyObj:function(a){for(var b in a)return!1;return!0},init:function(){}};window.lpTag=window.lpTag||{};lpTag.taglets=lpTag.taglets||{};lpTag.taglets.lpAjax=lpTag.taglets.lpAjax||function(a){function b(){o=!0}function c(b,c){a.lpTag&&lpTag.log&&lpTag.log(b,c,l)}function d(a,b){if(n[a])c("Existing transport: "+a+" tried to register",p.DEBUG);else{n[a]=b;c("Added transport: "+a,p.DEBUG)}}function e(a){o||b();var d="unknown";try{var e=h(a);if(e){e.issueCall(a);return!0}c("No Transport found to issueCall",p.ERROR);k(p.ERROR,a.error,{responseCode:601,error:"No Transport found to issueCall, request: "+a.url,body:"ERROR"},a.context)}catch(f){e&&e.getName&&(d=e.getName());c("Transport - "+d+" - unknown exception while issueCall",p.ERROR);k(p.ERROR,a.error,{responseCode:600,error:"Transport - "+d+" - unknown exception while issueCall: "+a.url+" e="+f,body:"ERROR"},a.context)}}function f(a){o||b();for(var c in a){var d=n[c];d&&d.configure(a[c])}}function g(a){if(a&&"object"==typeof a){a.appName=m;a.ts=(new Date).getTime();a.tags&&a.tags.constructor===Array&&a.tags.push({pageId:q});c(a,p.METRICS)}}function h(a){for(var b,c=!1,d=-1,e=0;e<a.transportOrder.length;e++)if(!c){b=j({},a);var f=n[b.transportOrder[e]];if(f&&f.isValidRequest&&f.isValidRequest(b)){c=!0;d=e}}return c?n[b.transportOrder[d]]:null}function i(a,b,c){if(null!=a){var d=Array.prototype.forEach;if(d&&a.forEach===d)a.forEach(b,c);else if(a.length===+a.length){for(var e=0,f=a.length;f>e;e++)if(e in a&&b.call(c,a[e],e,a)==={})return}else for(var g in a)if(Object.prototype.hasOwnProperty.call(a,g)&&b.call(c,a[g],g,a)==={})return}}function j(a){i(Array.prototype.slice.call(arguments,1),function(b){for(var c in b)a[c]=b[c]});return a}function k(a,b,d,e){if("function"==typeof b)try{b.call(e||null,d);b=null}catch(f){c("runCallback: Exception in execution of callback, type :"+a+" e=["+f.message+"]",p.ERROR)}else c("runCallBack: No callback, of type :"+a,p.INFO)}var l="lpAjax",m="lpTransporter",n={},o=!1,p={ERROR:"ERROR",DEBUG:"DEBUG",INFO:"INFO",METRICS:"METRICS"},q="lpT"+Math.floor(1e5*Math.random())+"_"+Math.floor(1e6*Math.random());return{getVersion:function(){return"1.1.3"},getName:function(){return l},init:b,publishMetrics:g,issueCall:e,configureTransports:f,addTransport:d}}(window);window.lpTag=window.lpTag||{};lpTag.taglets=lpTag.taglets||{};lpTag.taglets.jsonp=lpTag.taglets.jsonp||function(a){function b(){if(lpTag&&lpTag.taglets&&lpTag.taglets.lpAjax)try{lpTag.taglets.lpAjax.addTransport(W,X)}catch(a){}x()}function c(a){if(a)for(var c in a)H.hasOwnProperty(c)&&a.hasOwnProperty(c)&&(H[c]=a[c]);b()}function d(b){var c=!1;if(J&&b&&b.url){var d=!1;b.callbackName&&"string"==typeof b.callbackName&&(T[b.callbackName]||a[b.callbackName])&&(d=!0);var e;try{e=k(b)}catch(f){E("Could not evaluate the length  of the request, e="+f,I.ERROR,"isValidRequest");c=!1}void 0!==e&&K>e&&!d&&(c=!0)}return c}function e(a){var b;if(!d(a)){E("URL request was too long or static callback name already exists, url: "+b,I.ERROR,"issueCall");s();a&&a.error&&B(I.ERROR,a.error,i(600,"Transport - JSONP - unable to run request: "+a.url),a.context);return!1}a=g(a);a.callbackName&&"string"==typeof a.callbackName?a.retries=0:a.callbackName=L+h();b=a.url+(a.url.indexOf("?")>-1?"&":"?")+a.callback+"="+a.callbackName;a.data&&(b+="&"+l(a.data));a.query&&(b+="&"+l(a.query));a.callUrl=b;if(n(a)){D(a);o()}else E("URL request was too long and was not sent, url: "+b,I.ERROR,"issueCall");return!0}function f(){var a={};for(var b in H)H.hasOwnProperty(b)&&(a[b]=H[b]);return a}function g(a){"string"==typeof a&&(a={url:a});if(!a.url)return!1;a.encoding=a.encoding||H.encoding;a.callback=a.callback||H.callback;a.retries="number"==typeof a.retries?a.retries:H.retries;a.timeout=a.timeout?a.timeout:H.timeout;return a}function h(a){var b,c=99999,d="x";b=a?c+d+c:Math.round(Math.random()*c)+d+Math.round(Math.random()*c);return b}function i(a,b){return{statusCode:a,responseCode:a,error:b,body:"ERROR"}}function j(){return"scr"+Math.round(999999999*Math.random())+"_"+Math.round(999999999*Math.random())}function k(a){var b=U;a.callbackName&&"string"==typeof a.callbackName&&(b=a.callbackName.length);return 4+(a.callback||H.callback).length+a.url.length+b+l(a.data).length+l(a.query).length}function l(a){var b="";if("string"==typeof a)b+=a;else{var c=!0;for(var d in a){var e;"object"==typeof a[d]?e=m(a[d]):"function"!=typeof a[d]&&(e=a[d]);if(void 0!==e){c||(b+="&");b+=encodeURIComponent(d)+"="+encodeURIComponent(e);c=!1}}}return b}function m(a){var b;if("function"==typeof Array.prototype.toJSON){var c=Array.prototype.toJSON;delete Array.prototype.toJSON;try{b=JSON.stringify(a)}catch(d){Array.prototype.toJSON=c;throw d}Array.prototype.toJSON=c}else b=JSON.stringify(a);return b}function n(b){var c,d=!1,e=new RegExp(/(http{1}s{0,1}?:\/\/)([^\/\?]+)(\/?)/gi);c=0===b.callUrl.indexOf("http")?e.exec(b.callUrl):e.exec(a.location.href);if(c&&c.length>=3&&""!==c[2]){var f=c[2].toLowerCase();b.domainMatch=f;M[f]=M[f]||[];M[f].inFlight=M[f].inFlight||0;M[f].push(b);d=!0;O+=1;E("buffered URL: "+b.callUrl,I.DEBUG,"lpTag.taglets.jsonp.bufferRequest")}else E("NO MATCH for URL: "+b.callUrl,I.ERROR,"lpTag.taglets.jsonp.bufferRequest");return d}function o(){var a;for(var b in M)if(M.hasOwnProperty(b)){a=M[b];for(var c=!1;!c&&a.inFlight<6&&a.length>0;){var d=a.shift();if(d){E("Sent URL: "+d.callUrl,I.DEBUG,"lpTag.taglets.jsonp.sendRequests");d.scriptId=q(d.callUrl,d.encoding,d.callbackName);d.startTime=(new Date).getTime();r(b,d.callbackName,d.timeout);O-=1}else c=!0}}a=null}function p(){clearTimeout(F);F=null;var b=new Date;for(var c in T)if(T.hasOwnProperty(c)&&T[c].launchTime){var d=b-T[c].launchTime;(T[c].loadTime||d>T[c].timeout)&&a[c].apply(null,[i(408,{message:"Request timed out",name:"timeout"}),!0])}P>0&&(F=setTimeout(p,1e3))}function q(b,c,d){var e=j(),f=document.createElement("script");f.setAttribute("type","text/javascript");f.setAttribute("charset",c);f.onload=function(){T[d]&&(T[d].loadTime=new Date);this.onload=this.onerror=this.onreadystatechange=null};a.addEventListener?f.onerror=function(){T[d]&&(T[d].loadTime=new Date);this.onload=this.onerror=this.onreadystatechange=null}:f.onreadystatechange=function(){if(this.readyState&&("loaded"===this.readyState||"complete"===this.readyState)){T[d]&&(T[d].loadTime=new Date);this.onload=this.onerror=this.onreadystatechange=null}};f.setAttribute("src",b);f.setAttribute("id",e);document.getElementsByTagName("head")[0].appendChild(f);F||(F=setTimeout(p,1e3));f=null;return e}function r(a,b,c){M[a].inFlight=M[a].inFlight+1;T[b]={launchTime:new Date,timeout:c};P+=1;N+=1}function s(){Q+=1}function t(a){var b=document.getElementById(a);if(b)try{b.parentNode.removeChild(b)}catch(c){E("error when removing script",I.ERROR,"removeScript")}}function u(a){M[a].inFlight=M[a].inFlight-1;P-=1}function v(a,b,c){y(b.startTime,b.url,c);t(b.scriptId);u(b.domainMatch);C(b.callbackName,c);if(c){if(b.callbackName){b.callbackName=null;delete b.callbackName}z(a,b)}else{A(b);B("callback",b.success,a,b.context);b=null;o()}}function w(){var a;if(lpTag.taglets.lpAjax&&lpTag.taglets.lpAjax.publishMetrics&&S.length>0){a={tags:[{transport:W}],metrics:S};lpTag.taglets.lpAjax.publishMetrics(a);S.length=0}x()}function x(){G&&clearTimeout(G);G=setTimeout(w,H.metricsTimeout)}function y(a,b,c){var d,e;if(a){e=(new Date).getTime();d=e-a;S.push({rd:d,ts:a,url:b,method:"GET",statusCode:c?400:200});S.length>=H.metricsCount&&w()}}function z(a,b){R+=1;if(b.retries>0){b.retries=b.retries-1;e(b)}else{A(b);B(I.ERROR,b.error,a||i(408,{id:408,name:"TIMEOUT",message:"Request has timed out on all retries"}),b.context);b=null;o()}}function A(a){for(var b=["callUrl","retries","id","requestTimeout","type","encoding","launchTime","callbackName","domainMatch","startTime"],c=0;c<b.length;c++)if(a.hasOwnProperty(b[c])){a[b[c]]=null;delete a[b[c]]}}function B(a,b,c,d){if("function"==typeof b)try{b.call(d||null,c);b=null}catch(e){E("Exception in execution of callback, type :"+a+" e=["+e.message+"]",I.ERROR,"runCallback")}else E("No callback, of type :"+a,I.INFO,"runCallback")}function C(b,c){T[b]=null;delete T[b];if(!0===c)a[b]=function(){a[b]=null;try{delete a[b]}catch(c){}};else{a[b]=null;try{delete a[b]}catch(d){}}}function D(b){if(T[b.callbackName]){s();z(i(409,{message:"This callbackName is already in a pending request and can't be serviced",id:409,name:"CONFLICT"}),b)}else a[b.callbackName]=function(a,c){v(a,b,c)}}function E(b,c,d){if(a.lpTag&&lpTag.log){"string"==typeof b&&d&&(b=d+": "+b);lpTag.log(b,c,W)}}var F,G,H={callback:"cb",encoding:"UTF-8",timeout:1e4,retries:2,metricsCount:100,metricsTimeout:6e4},I={ERROR:"ERROR",DEBUG:"DEBUG",INFO:"INFO"},J=!0,K=2083,L="lpCb",M={},N=0,O=0,P=0,Q=0,R=0,S=[],T={},U=h(!0).length,V="1.1.7",W="jsonp",X={init:b,configure:c,issueCall:e,isValidRequest:d,getVersion:function(){return V},getName:function(){return W},getDefaults:f,inspect:function(){return{name:W,version:V,callsMade:N,errorsFound:R,pending:P,buffered:O,refused:Q,defaults:f()}}};b();return X}(window);window.lpTag=window.lpTag||{};lpTag.taglets=lpTag.taglets||{};lpTag.taglets.rest2jsonp=lpTag.taglets.rest2jsonp||function(){function a(){if(lpTag&&lpTag.taglets&&lpTag.taglets.lpAjax)try{lpTag.taglets.lpAjax.addTransport(G,D)}catch(a){}}function b(a){for(var b in a)a.hasOwnProperty(b)&&(K.hasOwnProperty(b)?K[b]=a[b]:N.hasOwnProperty(b)&&(N[b]=a[b]));N.domain&&N.site&&(M=L.prefix+N.domain+L.middle+N.site+L.suffix)}function c(a){var b=!1;a&&"string"==typeof a.url&&"function"==typeof a.success&&N.site&&N.domain&&M&&(b=!0);return b}function d(a){if(c(a)){a=f(a);return p(a)?s(a):u(a)}return!1}function e(){return{name:G,version:E,callsMade:H,errorsFound:I,pending:J,baseUrl:M,defaults:JSON.parse(l(K))}}function f(a){for(var b in K)K.hasOwnProperty(b)&&(a[b]=a[b]||K[b]);a.data=g(a);a.url=M+C(a.data.u);return a}function g(a){return{u:h(a.url),m:a.method||K.method,b:a.data||"",h:a.headers||""}}function h(a){a&&a.indexOf(".json?")&&(a=a.replace(".json?","?"));return a}function i(a,b,c){lpTag&&lpTag.log&&lpTag.log(a,b,c)}function j(){return Math.round(9999999999*Math.random())+"-"+Math.round(9999999999*Math.random())}function k(a){return a?encodeURIComponent(l(a)):""}function l(a){var b;if("function"==typeof Array.prototype.toJSON){var c=Array.prototype.toJSON;delete Array.prototype.toJSON;try{b=JSON.stringify(a)}catch(d){Array.prototype.toJSON=c;throw d}Array.prototype.toJSON=c}else b=JSON.stringify(a);return b}function m(){var a=0;for(var b in R)R.hasOwnProperty(b)&&(a+=("&"+R[b]+"=99").length);a+=E.length+K.callback.length+O.length+S;return a}function n(){var a=0;for(var b in Q)Q.hasOwnProperty(b)&&(a+=("&"+Q[b]+"=99").length);a+=3;a+=P;return a}function o(a,b){var c=a.url+(a.url.indexOf("?")>-1?"&":"?")+R.VERSION_PARAM+"="+F+"&"+R.JSON+"="+O;if(b){var d=k(a.data);d&&(c+="&"+R.BODY_PARAM+"="+d)}return c}function p(a){return a.url.length+U+k(a.data).length>T}function q(a,b,c,d){if("function"==typeof b)try{b.call(d||null,c)}catch(e){i("Exception in execution of callback, type :"+a+" e=["+e.message+"]","ERROR","lpTag.JSONP.runCallback")}else i("No callback, of type :"+a,"INFO","lpTag.JSONP.runCallback")}function r(a,b){var c={};c.encoding=a.encoding;c.timeout=a.timeout||K.timeout;c.callback=a.callback||K.callback;c.retries="number"==typeof b?b:0;return c}function s(a){a.id=j();W[a.id]={originalRequest:a,index:0,baseUrl:o(a,!1),urls:x(a.url,k(a.data),a.id),interimObj:r(a)};t(W[a.id].interimObj,W[a.id])}function t(a,b){a.url=w(b);a.id=b.id+"!"+b.index;a.success=function(c){if(!c||200!==c.responseCode&&201!==c.responseCode){b.originalRequest.error.apply(null,[c]);v(b.id);B()}else{c&&c.lpMeta&&c.lpMeta.lpS&&(b.secureId=c.lpMeta.lpS);if(b.index+1<b.urls.length){b.index++;t(a,b)}else{b.originalRequest.success.apply(null,[c]);v(b.id)}}A()};a.error=a.success;lpTag.taglets.jsonp.issueCall(a);z()}function u(a){var b=r(a,a.retries||K.retries);b.id=j();b.url=o(a,!0);b.success=function(c){if(c.responseCode&&200===c.responseCode||201===c.responseCode)q("CALLBACK",a.success,c,a.context);else{q("ERROR",a.error,c,a.context);B()}b=null;a=null;A()};b.error=function(c){q("ERROR",a.error,c,a.context);b=null;a=null;A();B()};lpTag.taglets.jsonp.issueCall(b);z()}function v(a){W[a]=null;delete W[a]}function w(a){return a.baseUrl+"&"+Q.PART_PARAM+"="+(a.index+1)+"&"+Q.OUTOF_PARAM+"="+a.urls.length+(a.secureId?"&"+Q.SECURE_IDENTIFIER+"="+a.secureId:"")+"&"+R.BODY_PARAM+"="+a.urls[a.index]}function x(a,b,c){a+="&"+R.CALLID+"="+c;return y(T-a.length-V-U,b)}function y(a,b){function c(a,b,c,d,e){a+=d>0?"%":"";var f=e-a.length;a+=b.substring(0,f);c.push(a);b=b.substring(f,b.length);return b}function d(a,b,c){for(var d,e=Math.ceil(a.length/b),f=0;e>f;f++){d=a.substring(f*b,(f+1)*b);e>f+1&&c.push(d)}return d}function e(a,b,c,d,e){var f=(a+b).length;f+=e>0?1:0;if(f>c){d.push(a);a=""}a+=e>0?"%":"";a+=b;return a}var f,g="",h=[],i=b.split("%");for(f=0;f<i.length;f++)if(i[f].length>a){i[f]=c(g,i[f],h,f,a);g="";g=d(i[f],a,h)}else g=e(g,i[f],a,h,f);""!==g&&h.push(g);return h}function z(){H+=1;J+=1}function A(){J=J>0?J-1:0}function B(){I+=1}function C(a){var b="";if(-1!=a.indexOf("/agentSession"))b="/agentSession";else if(-1!=a.indexOf("/chat"))b="/chat";else if(-1!=a.indexOf("/visit")){b="/visit";-1!=a.indexOf("/keepAlive")&&(b+="/keepAlive")}else-1!=a.indexOf("/configuration")&&(b="/configuration");return b}var D,E="1.2",F="1",G="rest2jsonp",H=0,I=0,J=0,K={retries:3,method:"GET",timeout:3e4,encoding:"UTF-8",callback:"cb"},L={prefix:"https://",middle:"/api/account/",suffix:"/js2rest"},M="",N={site:"",domain:""},O="1",P=32,Q={PART_PARAM:"lpP",OUTOF_PARAM:"lpO",SECURE_IDENTIFIER:"lpS"},R={VERSION_PARAM:"lpV",BODY_PARAM:"lpB",JSON:"lpjson",CALLID:"lpCallId"},S=j().length,T=2083,U=m(),V=n(),W={};D={name:G,version:E,init:a,configure:b,issueCall:d,isValidRequest:c,inspect:e};a();return D}();window.lpTag=window.lpTag||{};lpTag.taglets=lpTag.taglets||{};lpTag.taglets.postmessage=lpTag.taglets.postmessage||function(a){function b(a){var b=0===location.protocol.indexOf("https");if(a){if(a.frames){a.frames=a.frames.constructor===Array?a.frames:[a.frames];for(var c=0;c<a.frames.length;c++)o(a.frames[c],b)}if(a.defaults)for(var d in a.defaults)sa.hasOwnProperty(d)&&a.defaults.hasOwnProperty(d)&&(sa[d]=a.defaults[d])}ca=!0}function c(){if(lpTag&&lpTag.taglets&&lpTag.taglets.lpAjax)try{lpTag.taglets.lpAjax.addTransport(ba,va)}catch(a){}}function d(b){var c=!1;if(a.postMessage&&a.JSON&&b&&b.success&&(b.domain&&b.validation||b.url)){b.domain=b.domain||n(b.url);(da[b.domain]||ja[b.domain])&&(c=!0)}return c}function e(a){var b=!1;if(ca&&d(a))if(da[a.domain])if(da[a.domain].validated!==ua.PENDING||a.validation){b=I(a);b?u(a.domain):ea[a.callId].timeout=0}else b=v(a.domain,a);else{Z("Adding iFrame to DOM - first request: "+a.domain,ma.INFO,"issueCall");b=v(a.domain,a);p(ja[a.domain]);delete ja[a.domain]}else b=H(a.domain,a.error,a.context);return b}function f(a){return a&&da[a]?{url:da[a].url,validated:da[a].validated,requestCount:da[a].requestCount,defaults:N(da[a].defaults),started:da[a].validated===ua.VALIDATED}:{}}function g(){var a={};for(var b in da)da.hasOwnProperty(b)&&(a[b]=f(b));return a}function h(a,b,c){a.addEventListener?a.addEventListener(b,c,!1):a.attachEvent("on"+b,c)}function i(a,b){return{callId:a,responseType:b.responseType,responseCode:b.responseCode,error:{message:b.message,id:b.responseCode,name:b.name}}}function j(a,b,c){a.removeEventListener?a.removeEventListener(b,c,!1):a.detachEvent&&a.detachEvent("on"+b,c)}function k(){if(document.body){ka=!0;l()}else setTimeout(k,5)}function l(){for(;la.length>0;)try{la.shift().call(null)}catch(a){Z("Unable to execute queued callbacks for window interactive state: "+a,ma.ERROR,"_attachPendingIFrames")}}function m(a){return a+"_"+Math.floor(1e5*Math.random())+"_"+Math.floor(1e5*Math.random())}function n(a){var b,c=new RegExp(/(http{1}s{0,1}?:\/\/)([^\/\?]+)(\/?)/gi),d=null;if(0!==a.indexOf("http"))return location.protocol+"//"+location.host;b=c.exec(a);b&&b.length>=3&&""!==b[2]&&(d=b[1].toLowerCase()+b[2].toLowerCase());return d}function o(a,b){var c,d,e=!1;if(!a||!a.url||"string"!=typeof a.url){Z("iFrame configuration empty or missing url parameter",ma.ERROR,"_queueFrame");return e}c=n(a.url);d=0===a.url.toLowerCase().indexOf("https");if(!(da[c]||ja[c]||b&&d!==b)){ja[c]=a;e=!0}return e}function p(a){var b=n(a.url);if(da[b])return w(b,a.callback||a.success,a.context);var c=m("fr");da[b]={elem:x(c),url:a.url,validated:ua.PENDING,defaults:a.defaults||{},delayLoad:isNaN(a.delayLoad)?0:a.delayLoad,requestCount:0,success:a.callback||a.success,error:a.error,maxReloadRetries:a.maxReloadRetries||3,reloadInterval:1e3*a.reloadInterval||3e4};setTimeout(function(){r(a.url,b)},da[b].delayLoad);Z("iFrame Queued to load "+b,ma.INFO,"_addFrame");return ua.PENDING}function q(a){var b=n(a.url);ja[b]={url:a.url,defaults:a.defaults||{},delayLoad:a.delayLoad,success:a.success,error:a.error,maxReloadRetries:a.maxReloadRetries,reloadInterval:a.reloadInterval/1e3}}function r(a,b){ka?s(a,b):la.push(function(){s(a,b)})}function s(a,b){da[b].loadCallback=da[b].loadCallback||t(b);S(da[b].elem,a);h(da[b].elem,"load",da[b].loadCallback);da[b].iFrameOnloadTimeout=setTimeout(da[b].loadCallback,ta);da[b].attachTime=(new Date).getTime();document.body.appendChild(da[b].elem)}function t(a){return function(b){if(da[a].iFrameOnloadTimeout){clearTimeout(da[a].iFrameOnloadTimeout);delete da[a].iFrameOnloadTimeout}da[a].loadTime=(new Date).getTime()-da[a].attachTime;A(a,b)}}function u(a){ga+=1;ia+=1;da[a].requestCount=da[a].requestCount+1}function v(a,b){fa[a]=fa[a]||[];fa[a].push(b);return!0}function w(a,b,c){W(b,c,f(a));return da[a].validated}function x(a){var b=document.createElement("IFRAME");b.setAttribute("id",a);b.setAttribute("name",a);b.setAttribute("tabindex","-1");b.setAttribute("aria-hidden","true");b.setAttribute("title","");b.setAttribute("role","presentation");b.style.width="0px";b.style.height="0px";b.style.position="absolute";b.style.top="-1000px";b.style.left="-1000px";return b}function y(a,b,c,d,e,f){var g=!1;if(a&&b&&"function"==typeof b){ea[a]={success:b,error:c,progress:d,ctx:e,launchTime:new Date,timeout:isNaN(f)?sa.timeout:f+1e3};g=!0}return g}function z(a){if(ea[a]){ea[a]=null;delete ea[a];return!0}return!1}function A(a,b){Z("onLoad validation called "+a,ma.INFO,"_validateFrame");var c=function(b){B(b,a)};b&&b.error?B(b,a):setTimeout(function(){e({domain:a,success:c,error:c,validation:!0,timeout:100,retries:-1,defaults:da[a].defaults})},10);return!0}function B(a,b){var c,d=da[b];Z("running validation of domain "+b,ma.INFO,"_validateFrameCallback");if(d){da[b].validated=a&&a.error?ua.FAILED:ua.VALIDATED;c=da[b].validated===ua.VALIDATED;c?C(b,a):da[b].reloadObj&&da[b].reloadObj.retriesLeft>0?E(b):D(b)}d=null;return c}function C(a,b){var c;Z("FrameLoaded "+a,ma.INFO,"_runFrameValidated");c=N(qa);for(var d in b)b.hasOwnProperty(d)&&(c[d]=b[d]);W(da[a].success,da[a].context,c);U(a);F(a,!0)}function D(a){Z("iFrame is a teapot "+a,ma.ERROR,"_runFrameFailedToLoad");if(da[a].error){var b=i(0,ra);b.domain=a;W(da[a].error,da[a].context,b)}G(a);F(a,!1)}function E(a){Z("Retry loading domain: "+a,"info","_runReloadAttempt");F(a,!1);P(a)}function F(a,b){Z("Running buffer queue : "+a+" loaded: "+b,ma.INFO,"_runQueuedRequests");if(fa[a]&&fa[a].length>0){do{var c=fa[a].shift();b?e(c):W(c.error,c.context,{responseCode:600,error:"Transport - postmessage - unable to run request: "+a,body:"ERROR"})}while(fa[a].length>0);fa[a]=null;delete fa[a]}}function G(a){Z("Cleaning up failed iFrame: "+a,ma.INFO,"_cleanupIFrame");if(da[a]){j(da[a].elem,"load",da[a].loadCallback);da[a].elem.parentNode.removeChild(da[a].elem);var b=N(ra);b.domain=a;b.url=da[a].url;W(da[a].error,da[a].context,b);q(da[a]);da[a]=null;delete da[a]}}function H(a,b,c){Z("Frame not found for domain: "+a,ma.ERROR,"_noFrameFound");W(b,{responseCode:600,error:"Transport - postmessage - unable to run request: "+a,body:"ERROR"},c);return!1}function I(a){var b,c=!1;a=K(a);b=N(a);try{b=J(b)}catch(e){Z("Error trying to _stringify message",ma.ERROR,"sendMessageToFrame");return!1}Z("sending msg to domain "+a.domain,ma.DEBUG,"sendMessageToFrame");var d;isNaN(a.timeout)||isNaN(a.retries)||(d=a.timeout*(a.retries+1)+2e3);y(a.callId,a.success,a.error,a.progress,a.context,d);try{c=L(a.domain,b);_=setTimeout(M,1e3)}catch(e){Z("Error trying to send message: "+e,ma.ERROR,"sendMessageToFrame");c=!1}return c}function J(a){var b;if("function"==typeof Array.prototype.toJSON){var c=Array.prototype.toJSON;delete Array.prototype.toJSON;try{b=JSON.stringify(a)}catch(d){Array.prototype.toJSON=c;throw d}Array.prototype.toJSON=c}else b=JSON.stringify(a);return b}function K(b){var c=da[b.domain]&&da[b.domain].defaults;b.callId=m("call");b.returnDomain=na;void 0===b.timeout&&(b.timeout=c&&c.timeout||sa.timeout);void 0===b.retries&&(b.retries=c&&void 0!==c.retries?c.retries:sa.retries);b.progress&&(b.fireProgress=!0);b.headers=b.headers||{};b.headers["LP-URL"]=a.location.href;return b}function L(a,b){var c=!1;try{da[a].elem.contentWindow.postMessage(b,a);c=!0}catch(d){Z("Error trying to send message: "+d,ma.ERROR,"_postTheMessage")}return c}function M(){_&&clearTimeout(_);_=null;var a=new Date,b=0,c=[];for(var d in ea)if(ea.hasOwnProperty(d)&&ea[d].launchTime){var e=a-ea[d].launchTime;e>ea[d].timeout?c.push(d):b+=1}if(c.length){Z("Checking errors found "+c.length+" timeout callbacks to call",ma.DEBUG,"_checkForErrors");for(var f=0;f<c.length;f++)O(i(c[f],pa))}b>0&&(_=setTimeout(M,1e3));return!0}function N(a){var b=a;try{b=JSON.parse(J(a))}catch(c){}return b}function O(a,b){var c,d=ea[a.callId],e=a.responseType,f=!1;if(a.callId&&ea[a.callId]||a.responseType===oa.reloading||a.responseType===oa.stats)try{switch(e){case oa.completed:c=d.success;f=!0;break;case oa.error:c=d.error;f=!0;ha+=1;break;case oa.progress:c=d.progress;break;case oa.reloading:a=b;c=P;break;case oa.stats:c=$;a=a.rawData}if(f){z(a.callId);V(a);ia=ia>=0?0:ia-1}c&&"function"==typeof c&&W(c,d&&d.ctx||null,a);c=null;d=null}catch(g){Z("Error in executing callback: "+g,ma.ERROR,"_executeMessageCallback");return!1}return!0}function P(a){Z("Got reload request from "+a,ma.INFO,"_handleReload");da[a].validated=ua.PENDING;if(!da[a].reloadObj){Z("Creating reloadObj"+a,ma.DEBUG,"_handleReload");da[a].reloadObj=T(a)}Q(a)}function Q(a){Z("Reload try for domain "+a+" ,retries left "+da[a].reloadObj.retriesLeft,ma.INFO,"_reloadIFrame");da[a].reloadObj.retriesLeft=da[a].reloadObj.retriesLeft-1;da[a].reloadObj.setLocationTimeout&&clearTimeout(da[a].reloadObj.setLocationTimeout);if(da[a].reloadObj.retry)da[a].reloadObj.setLocationTimeout=setTimeout(R(a),da[a].reloadInterval);else{da[a].reloadObj.retry=!0;R(a)()}}function R(a){return function(){da[a].iFrameOnloadTimeout=setTimeout(function(){A(a,{error:{code:404,message:"Frame did not trigger load"}})},ta);S(da[a].elem,da[a].url)}}function S(a,b){b+=b.indexOf("?")>0?"&bust=":"?bust=";b+=(new Date).getTime();b+="&loc="+encodeURIComponent(location.protocol+"//"+location.host);Z("Setting iFrame to URL: "+b,ma.INFO,"_setIFrameLocation");a.setAttribute("src",b)}function T(a){Z("Creating reload object "+a,ma.INFO,"_createReloadObject");return{retriesLeft:da[a].maxReloadRetries}}function U(a){Z("Cleaning up reload object for this instance"+a,ma.INFO,"_cleanUpReloadObject");if(da[a].reloadObj){da[a].reloadObj.setLocationTimeout&&clearTimeout(da[a].reloadObj.setLocationTimeout);da[a].reloadObj=null;delete da[a].reloadObj}}function V(a){for(var b=["callId","responseType"],c=0;c<b.length;c++){a[b[c]]=null;delete a[b[c]]}}function W(a,b,c){if(a&&"function"==typeof a)try{a.call(b||null,c)}catch(d){Z("Error in executing callback: "+d,ma.ERROR,"runCallback")}}function X(a){var b,c;try{c=a.origin;if(!da[c])return;b=Y(a.data);b.body=Y(b.body)}catch(d){b=null;Z("Error in handling message from frame:"+d+" origin: "+c,ma.ERROR,"_handleMessage")}b&&"object"==typeof b&&O(b,c)}function Y(a){var b=a;if("string"==typeof a)try{b=JSON.parse(a)}catch(c){Z("Error in parsing string: "+a,ma.DEBUG,"_parseJSONString")}return b}function Z(b,c,d){if(a.lpTag&&lpTag.log){"string"==typeof b&&d&&(b=d+": "+b);lpTag.log(b,c,ba)}}function $(a){if(lpTag.taglets.lpAjax&&lpTag.taglets.lpAjax.publishMetrics){a.tags&&a.tags.constructor===Array&&a.tags.push({transport:ba});lpTag.taglets.lpAjax.publishMetrics(a)}}var _,aa="1.1.8",ba="postmessage",ca=!0,da={},ea={},fa={},ga=0,ha=0,ia=0,ja={},ka=!1,la=[],ma={DEBUG:"DEBUG",INFO:"INFO",ERROR:"ERROR"},na=n(document.location.href),oa={progress:"progressLoad",completed:"completeLoad",success:"success",error:"errorLoad",reloading:"reloading",stats:"statData"},pa={responseType:oa.error,responseCode:404,message:"Request timed out on parent postMessage layer",name:"TIMEOUT"},qa={responseType:oa.success,responseCode:200,message:"iFrame has successfully loaded",name:"OK"},ra={responseType:oa.error,responseCode:418,message:"This iFrame is a teapot, not very useful for communication but lovely for earl grey",name:"TEAPOT"},sa={timeout:6e4,metricsCount:1e3},ta=1e4,ua={VALIDATED:"valid",PENDING:"pending",FAILED:"failed"};k();h(a,"message",X);var va={v:aa,name:ba,init:c,issueCall:e,isValidRequest:d,getVersion:function(){return aa},getName:function(){return ba},configure:b,getFrameData:f,inspect:function(){return{name:ba,version:aa,callsMade:ga,errorsFound:ha,pending:ia,defaults:sa,iFrameList:N(ja),activeFrames:g()}}};c();return va}(window);window.lpTag=window.lpTag||{};lpTag.taglets=lpTag.taglets||{};lpTag.taglets.LPWebSocketWrapper=lpTag.taglets.LPWebSocketWrapper||function(a){function b(){}function c(a){if(a){Q||"string"!=typeof a.server||0===a.server.indexOf("ws")&&(K=a.server);"function"==typeof a.created&&R.push({cb:a.created,context:a.context});"function"==typeof a.message&&S.push({cb:a.message,context:a.context});"function"==typeof a.closed&&T.push({cb:a.closed,context:a.context});"object"==typeof a.ping&&h(a.ping);if(K){for(var b in Y)Y.hasOwnProperty(b)&&typeof a[b]==typeof Y[b]&&(Y[b]=a[b]);return!!Q||m(Y)}}}function d(){var a=!1;if(H)a=Q;else{V=0;a=m()}return a}function e(){return Q}function f(a){try{if(e()){y();H.send(x(a))}else j("Socket not connected","send")}catch(b){j("unable to send request","send")}}function g(){clearTimeout(J);clearTimeout(I);K="";t();R.length=0;S.length=0;T.length=0;U.length=0}function h(a){if("object"==typeof a&&a.request){X.request=JSON.parse(x(a.request));O=!0;if(a.response)X.response=a.response;else if("object"==typeof a.keys&&"object"==typeof X.request&&"string"==typeof a.keys.request&&"string"==typeof a.keys.response){X.reqKey=a.keys.request;X.resKey=a.keys.response}"function"==typeof a.callback&&U.push({cb:a.callback});(X.response||X.reqKey&&X.resKey)&&(X.timeout=a.timeout||Y.pingTimeout);X.idleBeforePing=a.idleBeforePing||Y.idleBeforePing}}function i(a,b,c){if(window.lpTag&&lpTag.log){"string"==typeof a&&c&&(a=c+": "+a);lpTag.log(a,b,L)}}function j(a,b){i(a,Z.ERROR,b)}function k(){if(V>=Y.maxReconnectAttempt)v("cb",T,{state:"TERMINAL",code:503,message:"Socket terminal, will not reconnect"});else if(Y.autoReconnect&&K){J&&clearTimeout(J);J=setTimeout(function(){if(!m()){V+=1;k()}},l())}}function l(){var a;a=V<W[0].count?Y.reconnectTimeout||W[0].timeout:V<W[1].count?W[1].timeout:W[2].timeout;return a}function m(a){var b=!1;K=a&&a.server||K;if(!H&&K&&!0===navigator.onLine){try{H=new WebSocket(K)}catch(c){j("Exception creating WebSocket: "+c.message,"_createSocket");H=null}if(H&&H.readyState<=3){n();b=!0}}return b}function n(){if(H&&"function"!=typeof H.onopen){H.onopen=p;H.onclose=s;H.onerror=E;H.onmessage=q}}function o(){if(H){H.onopen=null;H.onclose=null;H.onerror=null;H.onmessage=null}}function p(a){Q=!0;V=0;v("cb",R,u(a)||{state:"OPEN",code:200})}function q(a){var b=!1;if(a)try{var c=r(a.data);P&&(b=D(c));y();b||v("cb",S,c)}catch(d){j("failed to process message","_socketMessage")}}function r(a){var b=a;try{b=JSON.parse(a)}catch(c){j("Unable to parse message","transformToJSON")}return b}function s(a,b){Q=!1;F();v("cb",T,u(a,b)||{state:"CLOSED",code:500});k()}function t(){Y.autoReconnect=!1;Q&&H.close();F()}function u(a,b){return a?{name:L,state:a.type,code:a.code,statusCode:a.code>1e3||b?500:200,reason:a.reason||"",domain:a.srcElement&&a.srcElement.url?a.srcElement.url:""}:null}function v(a,b,c){var d;if(b){d=b.constructor===Array?b:[b];for(var e=0;e<d.length;e++)w(d[e][a],c,d[e].context)}d=null}function w(a,b,c){if("function"==typeof a)try{a.call(c||null,b)}catch(d){j("Error executing callback","_runCallback")}}function x(a){var b;if("function"==typeof Array.prototype.toJSON){var c=Array.prototype.toJSON;delete Array.prototype.toJSON;try{b=JSON.stringify(a)}catch(d){Array.prototype.toJSON=c;throw d}Array.prototype.toJSON=c}else b=JSON.stringify(a);return b}function y(){if(O&&!P){z();X.timeoutId=setTimeout(A,X.idleBeforePing)}}function z(){if(X.timeoutId){clearTimeout(X.timeoutId);X.timeoutId=null}}function A(){if(O&&!P){P=!0;f(C(),!0);X.timeout&&(I=setTimeout(B,X.timeout))}}function B(){P=!1;v("cb",U,{state:"TIMEOUT",code:404,message:"No Ping Response from Service"});delete X.timeoutId;y()}function C(){var a;if(X.request){a=JSON.parse(x(X.request));if(X.reqKey&&"object"==typeof a){X.lastKey="pingKey_"+Math.floor(99999999*Math.random());a[X.reqKey]=X.lastKey}}return a}function D(a){if(X.response||X.reqKey&&X.resKey){X.response?a===X.response&&(P=!1):"object"==typeof a&&a[X.resKey]===X.lastKey&&(P=!1);if(!P&&I){clearTimeout(I);I=null}v("cb",U,{state:"PING_SUCCESS",code:200,message:"Ping Response"})}return!P}function E(a){s(a,!0);V+=1}function F(){o();z();H=null}function G(){var a="WebSocket is not supported here.";j(a,"socketNotSupported");return a}var H,I,J,K,L="LPWebSocketWrapper",M="0.9.7",N=void 0!==window.WebSocket&&((""+window.WebSocket).indexOf("[native")>-1||(""+window.WebSocket).indexOf("WebSocketConstructor")>-1),O=!1,P=!1,Q=!1,R=[],S=[],T=[],U=[],V=0,W=[{count:5,timeout:2e3},{count:20,timeout:5e3},{timeout:1e4}],X={},Y={autoReconnect:!0,reconnectTimeout:2e3,maxReconnectAttempt:100,idleBeforePing:1e4,pingTimeout:3e4},Z={DEBUG:"DEBUG",INFO:"INFO",ERROR:"ERROR"};c(a);return{name:L,v:M,init:b,dispose:g,supported:N,connected:e,configure:N?c:G,send:N?f:G,restartSocket:N?d:G}};window.lpTag=window.lpTag||{};lpTag.taglets=lpTag.taglets||{};lpTag.taglets.websocket2http=lpTag.taglets.websocket2http||function(a){function b(){K||(K=new lpTag.taglets.LPWebSocketWrapper);K.supported||k("WebSockets not supported","init")}function c(a){var b;if(!K.supported||!a||"object"!=typeof a)return!1;if("string"==typeof a.server){b={server:a.server,idleBeforePing:3e4,closed:u,created:a.created,message:t,autoReconnect:"boolean"!=typeof a.autoReconnect||a.autoReconnect,
reconnectTimeout:isNaN(a.reconnectTimeout)?2e3:a.reconnectTimeout,maxReconnectAttempt:isNaN(a.maxReconnectAttempt)?30:a.maxReconnectAttempt};a&&!isNaN(a.timeout)&&(P.timeout=a.timeout);return K.configure(b)}h("No server set for WebSocket","configure")}function d(a){var b=!1;if(K.connected())for(var c=a&&a.constructor!==Array?[a]:a,d=0;d<c.length;d++){if(!l(c[d])){b=!1;break}b=!0}return b}function e(a){d(a)?m(a):a&&K.connected()?D("error",a,W):D("error",a,X)}function f(a){var b=!1,c=[];if(a){"string"==typeof a?c=[a]:a&&a.constructor===Array&&(c=a);for(var d=0;d<c.length;d++)if(T[c[d]]){B(T[c[d]]);b=!0}n(c)}return b}function g(b,c,d){if(a.lpTag&&lpTag.log){"string"==typeof b&&d&&(b=d+": "+b);lpTag.log(b,c,N)}}function h(a,b){g(a,O.ERROR,b)}function i(a,b){g(a,O.DEBUG,b)}function j(a,b){g(a,O.TRACE,b||"")}function k(a,b){g(a,O.INFO,b)}function l(a){return!(!a||"string"!=typeof a.url||0!==a.url.indexOf("http")||!r(a.url)||"function"!=typeof a.success)}function m(a){var b;Q+=1;try{b=p(a);K.send(b);L=(new Date).getTime()}catch(c){b&&o(b);h("Failed to run request, exc "+c.message,"_runRequest");R+=1}}function n(a){var b={cancelId:a};K.connected()&&K.send(b)}function o(a){D("error",a,V);for(var b=0;b<a.length;b++)B(a[b].name)}function p(a){for(var b=a&&a.constructor===Array?a:a?[a]:[],c=[],d=0;d<b.length;d++)c.push(q(b[d]));return c}function q(a){var b,c=E(),d=(new Date).getTime();b=I(a);b=H(b);b.name=c;a.launchTime=d;S[c]=a;return b}function r(a){if(!(U.length>0))return!0;var b,c=!1,d=/https{0,1}:\/\/([^\/|\s]+)/gi.exec(a);b=2===d.length?d[1]:"";if(b)for(var e=0;e<U.length;e++){c=s(b,U[e]);if(c)return c}}function s(a,b){var c=!0,d=a.split(".");if(d.length>2)for(var e=d.length-1,f=b.split("."),g=f.length-1;g>=0;g--){if(d[e]!==f[g]&&"*"!==f[g]){c=!1;break}if(!(e-1>0))break;e-=1}else c=!1;return c}function t(a){if("object"==typeof a)for(var b in a)a.hasOwnProperty(b)&&b&&(S[b]?w(b,S[b],a[b]):"config"===b&&a[b].allowDomain?A(a[b].allowDomain):h("Callback not found for key:"+b+" response:"+JSON.stringify(a[b]),"_handleMessage"));else h("Message response not an object: "+a,"_handleMessage")}function u(a){D("error",S,X);h("Socket closed: "+JSON.stringify(a))}function v(a){void 0===a.responseCode&&(void 0!==a.statusCode?a.responseCode=a.statusCode:void 0!==a.HTTPStatus&&(a.responseCode=a.HTTPStatus));return a}function w(a,b,c){var d;if(c){c=v(c);if(c.responseCode<400||c.statusCode&&c.statusCode<400)d=b.success;else{d=b.error;R+=1}if(z(a)){"object"==typeof c&&(c.requestName=a);y(a,c.cancelId)}else B(a);j(x(b,c),"_runMessageResponse");C(d,c,b.context);i("Ran response for key: "+a,"_runMessageResponse")}}function x(a,b){var c={},d=(new Date).getTime();c[a.url]={duration:d-a.launchTime,request:I(a),response:I(b)};return c}function y(a,b){if(b&&S[a]){S[a].cancelId=b;T[b]=a}}function z(a){return S[a]&&!0===S[a].persistent}function A(a){U=a;U&&U.constructor===Array&&1===U.length&&"*"===U[0]&&(U.length=0);i("Allowed Domains: "+JSON.stringify(a),"_setAllowedDomains")}function B(a){S[a]=null;delete S[a]}function C(a,b,c){if("function"==typeof a)try{a.call(c||null,b)}catch(d){h("Error executing callback","_runCallback")}}function D(a,b,c){var d;if(b){d=b.constructor===Array?b:[b];for(var e=0;e<d.length;e++)C(d[e][a],I(c),d[e].context)}d=null}function E(){return"ws"+(Math.abs(Math.round(9999999999*Math.random()))+(new Date).getTime())}function F(a){var b="";if("string"==typeof a)b+=a;else{var c=!0;for(var d in a){var e;"object"==typeof a[d]?e=JSON.stringify(a[d]):"function"!=typeof a[d]&&(e=a[d]);if(void 0!==e){c||(b+="&");b+=encodeURIComponent(d)+"="+encodeURIComponent(e);c=!1}}}return b}function G(a,b){var c=F(b);if(c){a+=a.indexOf("?")<0?"?":"&";a+=c}return a}function H(a){a.method||(a.method="GET");isNaN(a.timeout)&&(a.timeout=P.timeout);a.caseSensitiveHeaders=!1!==a.caseSensitiveHeaders;if(a.query){a.url=G(a.url,a.query);a.query=null}return a}function I(a){try{return JSON.parse(J(a))}catch(b){h("Failed to clone object","_cloneSimpleObj");return new Error("Failed to clone object")}}function J(a){var b;if("function"==typeof Array.prototype.toJSON){var c=Array.prototype.toJSON;delete Array.prototype.toJSON;try{b=JSON.stringify(a)}catch(d){Array.prototype.toJSON=c;throw d}Array.prototype.toJSON=c}else b=JSON.stringify(a);return b}var K,L,M="0.9.4",N="websocket2http",O={DEBUG:"DEBUG",INFO:"INFO",ERROR:"ERROR",TRACE:"TRACE"},P={timeout:3e4},Q=0,R=0,S={},T={},U=[],V={statusCode:400,responseCode:400,message:"Malformed/Bad request, unable to service it",name:"BADREQUEST"},W={statusCode:401,responseCode:401,message:"Batch(elor) WS can't service this request.",name:"FORBIDDEN"},X={statusCode:500,responseCode:500,message:"WebSocket is not connected",name:"NOCONNECTION"};b();var Y={init:b,configure:c,name:N,version:M,issueCall:e,cancelPersistentRequest:f,isValidRequest:d,inspect:function(){return{name:N,version:M,callsMade:Q,errorsFound:R}}};if(K&&K.supported&&lpTag.taglets.lpAjax)try{lpTag.taglets.lpAjax.addTransport(N,Y)}catch(Z){}return Y}(window);!function(a,b){"use strict";if("object"==typeof exports)b(a,exports);else{a.Chronos=a.Chronos||{};b(a,a.Chronos)}}(void 0===window.lpTag?this:window.lpTag,function(a,b,c){"use strict";function d(a,b,c){var d=[];if(a[b]&&a[b].length)for(var e=0;e<a[b].length;e++)c&&"*"!==a[b][e].appName&&a[b][e].appName!==c||d.push(a[b][e]);if(a["*"])for(var f=0;f<a["*"].length;f++)c&&"*"!==a["*"][f].appName&&a["*"][f].appName!==c||d.push(a["*"][f]);return d}function e(b,c,d){a&&"function"==typeof a.log&&a.log(b,c,d)}function f(a){var b,c=a.unbindObj[a.attrName],d=!1;if(!a.unbindObj){e("CMD listen id not spec for unbind","ERROR",a.loggerName);return null}if("string"==typeof a.unbindObj)return j(a.lstnrs,a.unbindObj);if(!a.unbindObj.func&&!a.unbindObj.context&&!a.unbindObj.appName)return!1;var f=a.lstnrs;if(c){f={};f[c]=a.lstnrs[c]}for(var g in f)if(f.hasOwnProperty(g)&&f[g]&&f[g].length){b=k(f[g],a.unbindObj.func,a.unbindObj.context,a.unbindObj.appName);if(b.length!==f[g].length){a.lstnrs[g]=b;d=!0}}return d}function g(a){var b={};if(a.constructor===Object)for(var c in a)a.hasOwnProperty(c)&&null!==a[c]&&void 0!==a[c]&&("object"==typeof a[c]&&a[c].constructor!==Array?b[c]=g(a[c]):a[c].constructor===Array?b[c]=a[c].slice(0)||[]:"function"!=typeof a[c]&&(b[c]=null!==a[c]&&void 0!==a[c]?a[c]:""));else a.constructor===Array?b=a.slice(0)||[]:"function"!=typeof a&&(b=a);return b}function h(a,b,c){if((void 0===c||"*"===c)&&"*"===b)return a;for(var d=[],e=0;e<a.length;e++)a[e].eventName!==c&&"*"!==c||(b&&b===a[e].appName||!a[e].appName||"*"===a[e].appName||"*"===b)&&d.push(a[e]);return d}function i(a){if(0===a.eventBufferLimit||a.triggerData.data&&a.triggerData.data.doNotStore)a=null;else{var b={eventName:a.triggerData[a.attrName],appName:a.triggerData.appName};b.data=a.triggerData.passDataByRef?a.triggerData.data:g(a.triggerData.data);if(a.eventBufferLimit>0){a.index>=a.eventBufferLimit&&(a.index=0);a.fired[a.index]=b;a.index++}else a.fired.push(b);a=null}}function j(a,b){var c=!1;if(!b){e("Ev listen id not spec for unregister","ERROR","Events");return null}for(var d in a)if(a.hasOwnProperty(d))for(var f=0;f<a[d].length;f++)if(a[d][f].id==b){a[d].splice(f,1);e("Ev listen="+b+" and name="+d+" unregister","DEBUG","Events");c=!0;break}c||e("Ev listen not found "+b+" unregister","DEBUG","Events");return c}function k(a,b,c,d){var f=[];if(a&&a.length)for(var g=0;g<a.length;g++)try{var h=!c&&a[g].func===b,i=!b&&c&&a[g].context===c,j=b&&c&&a[g].func===b&&a[g].context===c,k=d&&d===a[g].appName,l="*"===a[g].appName;if(h||i||j){if(k||l)continue;if(i)continue}else if(!b&&!c&&k)continue;f.push(a[g])}catch(m){e("Error in unbind e="+m.message,"ERROR","Events")}return f}var l={getListeners:d,log:e,unbind:f,hasFired:h,cloneEventData:g,storeEventData:i};c||(b.EventsUtil=b.EventsUtil||l);return l});!function(a,b){"use strict";if("object"==typeof exports)b(a,exports,require("./util/EventsUtil").EventsUtil);else{a.Chronos=a.Chronos||{};b(a,a.Chronos,a.Chronos.EventsUtil)}}(void 0===window.lpTag?this:window.lpTag,function(a,b,c,d){"use strict";function e(a){function b(a){if(a){a.triggerOnce=!0;return d(a)}return null}function d(a,b,e){var f=a;"string"==typeof a&&(f={appName:a,eventName:b,func:e});f.appName=f.appName||l;"*"!==l&&("string"!=typeof a||"function"!=typeof b&&void 0!==b||(f.eventName=a));if(!f.eventName||!f.func||"function"!=typeof f.func&&f.func.constructor!==Array){c.log("Ev listen has invalid params: evName=["+f.eventName+"]","ERROR","Events");return null}if(f.func.constructor===Array){for(var g,h,i=[],j=0;j<f.func.length;j++){g=c.cloneEventData(f);g.func=f.func[j];h=d(g);i.push(h)}return i}var k=r+o++,m={id:k,func:f.func,context:f.context||null,aSync:!!f.aSync,appName:f.appName,triggerOnce:f.triggerOnce||!1};p[f.eventName]=p[f.eventName]||[];p[f.eventName].push(m);c.log("Ev listen rgstr: evName=["+f.eventName+"] aSync="+m.aSync+" appName="+m.name,"DEBUG","Events");f=null;a=null;return k}function e(a){"*"!==l&&(a.appName=a.appName||l);return c.unbind({unbindObj:a,attrName:n,loggerName:m,lstnrs:p})}function f(a,b){if(void 0===b){b=a;a=l}return c.hasFired(q,a,b)}function g(a,b,d){var e=a;"string"==typeof a&&(e={eventName:b,appName:a,data:d});if("*"!==l){e.appName=e.appName||l;"string"!=typeof a||"object"!=typeof b&&void 0!==b||(e.eventName=a)}if(!e||void 0===e.eventName){c.log("Ev name not spec for publish","ERROR","Events");e=null;return null}e.passDataByRef=e.passDataByRef||!j;i(e);var f=c.getListeners(p,e.eventName,e.appName);if(f.length>0)for(var g=0;g<f.length;g++){var k=e.passDataByRef?e.data:c.cloneEventData(e.data),m={appName:e.appName,eventName:e.eventName},n=f[g];n.aSync||k&&k.aSync?setTimeout(h(n,k,m),0):h(n,k,m)()}e=null;return f.length>0}function h(a,b,d){return function(){try{a.func.call(a.context,b,d);b=null;a.triggerOnce&&e(a);a=null}catch(f){c.log("Error executing "+d.eventName+" eventId: "+a.id+"e="+f.message,"ERROR","Events")}}}function i(a){c.storeEventData({triggerData:a,eventBufferLimit:k,attrName:n,fired:q,index:s})}var j,k,l,m="Events",n="eventName",o=0,p={},q=[],r="evId_",s=0;l=a&&a.appName||"*";j=!(!a||"boolean"!=typeof a.cloneEventData)&&a.cloneEventData;k=a&&!isNaN(a.eventBufferLimit)?a.eventBufferLimit:-1;this.once=b;this.hasFired=f;this.trigger=g;this.publish=g;this.bind=d;this.register=d;this.unbind=e;this.unregister=e}d||(b.Events=b.Events||e);return e});window.lpTag=window.lpTag||{};lpTag.taglets=lpTag.taglets||{};lpTag.utils=lpTag.utils||{};lpTag.utils.log=lpTag.utils.log||function(){};lpTag.utils.log.debug=!1;lpTag.taglets.ChatOverRestAPI=lpTag.taglets.ChatOverRestAPI||function(a){function b(a,b){var c,d,f=e(a,b);if(f&&"string"==typeof f&&a&&a.data){c=ga.validateAndExtendConfigs([{obj:a.data,type:ta.STR,path:pa.pageId,prop:pa.pageId},{obj:a.data,type:ta.ARR,path:pa.impAttributes,prop:pa.impAttributes}],{});d={data:c,transportOrder:ja,method:"PUT",XMLHTTPOverride:!1,url:f,success:function(b){b=b||{};v(na.DEBUG,{originalRequest:a,sentRequest:d,response:b});ga.runSuccessCallback(a,{responseCode:b.responseCode,body:b.body});d=null},error:function(b){b=b||{};v(na.ERROR,{originalRequest:a,sentRequest:d,response:b});ga.runErrorCallback(a,{responseCode:b.responseCode,body:b.body});d=null}};try{return ia.issueCall(U(d))}catch(g){v(na.ERROR,{request:d,message:"Failed to send request"});ga.runErrorCallback(a)}}else{v(na.ERROR,{originalRequest:a,message:"Invalid input"});ga.runErrorCallback(a)}}function c(a,b){var c=a.filter(function(a){return a.service===b});return c[0]&&c[0].baseURI}function d(b,c){b=b||{};c=c||{};if(!a.engagementDomain)return u({error:"missing engagementDomain - cannot get engagement"},"","","");var d=e(b,c),f={};f=ga.validateAndExtendConfigs([{obj:b,type:ta.OBJ,path:pa.appDetails,prop:pa.appDetails},{obj:b,type:ta.STR,path:pa.appDetails,prop:pa.appVersion},{obj:b,type:ta.STR,path:pa.appDetails,prop:pa.deviceFamily},{obj:b,type:ta.STR,path:pa.appDetails,prop:pa.os},{obj:b,type:ta.STR,path:pa.appDetails,prop:pa.osVersion},{obj:b,type:ta.STR,path:pa.appDetails,prop:pa.ipAddress},{obj:b,type:ta.ARR,path:pa.consumerSections,prop:pa.consumerSections},{obj:b,type:ta.ARR,path:pa.engagementAttributes,prop:pa.engagementAttributes}],f);f.appType=f.appType||oa.EXTERNAL;var g={data:f,transportOrder:ja,method:"POST",url:d};g=U(g);g.success=function(a){var d;v(na.INFO,{originalRequest:b||"",sentRequest:g,response:a});if(a){d=ga.getResponseData(a);if(d&&d[pa.vId]&&d[pa.sId]){c[pa.sId]=d[pa.sId];c[pa.vId]=d[pa.vId];_.setSessionData(t(ka.engagementData),c)}aa.publish({eventName:ra.onEngagement,data:d});ga.runSuccessCallback(b,d)}g=null};g.error=function(a){D(b,g,a,ra.onEngagement,"getEngagement - server error")};v(na.INFO,{originalRequest:b||"",sentRequest:g,response:"SENDING REQUEST"});return ia.issueCall(g)}function e(b,c){var d,e,f;if(a&&b&&c&&a.engagementDomain&&a.lpNumber){d=b.sid||o(c[pa.sId])||"";e=b.vid||p(c[pa.vId])||"";f="?v=1.0"+(d?"&sid="+d:"");return"https://"+a.engagementDomain+"/api/account/"+a.lpNumber+"/app/engagement/visitors/"+e+f}}function f(){function b(){if(e){clearTimeout(e);e=null}}function c(){P({success:d,error:d});f=(new Date).valueOf()}function d(){if(g){b();var a=(new Date).valueOf()-f;a=i-a;a>0?e=setTimeout(c,a):c()}}var e,f,g,h={inChat:2e3,exitSurvey:15e3},i=h.inChat,j=this;j.changeKeepAliveState=function(){b();g=!Ha&&(sa.chatInProgress||sa.exitSurveyOn);if(g){i=sa.chatInProgress?h.inChat:h.exitSurvey;c()}};j.stopKeepAliveRequests=function(){if(sa.exitSurveyOn){sa.exitSurveyOn=!1;g=!1;b()}};j.storeChatLocationURI=function(b,c){var d=t(ka.chat);a.sessionUID&&(d=t(a.sessionUID));var e={chatRel:b,location:window.location.href};if(c){e.overRides={};for(var f in c)c.hasOwnProperty(f)&&(e.overRides[f]=c[f])}_.setSessionData(d,e)};j.sessionEnded=function(){_.removeSessionData(t(ka.sessionVars));_.removeSessionData(t(ka.chat));_.removeSessionData(t(ka.resumeMode));a.sessionUID&&_.removeSessionData(t(a.sessionUID))}}function g(a,b){return ga.validateAndExtendConfigs([{obj:b,type:ta.STR,path:pa.leVid,prop:pa.leVid},{obj:b,type:ta.STR,path:pa.leSid,prop:pa.leSid},{obj:b,type:ta.STR,path:pa.leCid,prop:pa.leCid},{obj:b,type:ta.STR,path:pa.skill,prop:pa.skill}],a,!1)}function h(b){if(lpTag.Chronos.Events&&lpTag.RelManager&&lpTag.SessionDataManager){aa=new lpTag.Chronos.Events({cloneEventData:!0,eventBufferLimit:50});ba=new f;ca=new lpTag.RelManager(b&&b.transportOrder||ja);a=a||{};a.appName=ea;_=new window.lpTag.utils.SessionDataAsyncWrapper(a);m()}else 20>Ga&&setTimeout(h,500);Ga++}function i(){for(var a in ra)ra.hasOwnProperty(a)&&(da[a]=j(a))}function j(a){return function(b,c,d){return r(a,b,c||"",d)}}function k(){return!!(va.lpNumber&&va.appKey&&va.domain)}function l(b,c){if(b){b.clearDomain?va.domain=ga.trim(b.domain):va.domain=ga.trim(b.domain)||ga.trim(va.domain)||"";va.lpNumber=ga.trim(b.lpNumber)||ga.trim(va.lpNumber)||"";va.appKey=ga.trim(b.appKey)||ga.trim(va.appKey)||"";a.sessionUID&&(va.sessionUID=a.sessionUID);if(va.lpNumber&&va.appKey&&va.domain){ca.setData(va);typeof c===ta.BOOL&&!c||_.usingSecureStorage||_.setSessionData(t(ka.sessionVars),va)}ma=b&&b.environment&&la[b.environment]?b.environment:ma;a.engagementDomain=a.engagementDomain||ga.trim(b.engagementDomain);x()}}function m(){function b(a){var b;for(var c in a)if(a.hasOwnProperty(c)&&0===String(c).indexOf("on")&&da.hasOwnProperty(c)){a[c]=a[c].constructor===Array?a[c]:[a[c]];for(var e=0;e<a[c].length;e++){b=d(c,a[c][e]);da[c](b.callback,b.appName,b.context)}}}function c(a){var b;for(var c in qa)if(a.hasOwnProperty(c)){b=d(c,a[c]);r(b.eventName,b.callback,b.appName,b.context)}}function d(a,b){var c=null;b=typeof b===ta.OBJ?b:{callback:b};"function"==typeof b.callback&&(c={eventName:a,callback:b.callback,context:b.context||null,appName:b.appName||""});return c}function e(){document.body?q():setTimeout(e,5)}function f(a){var b={};if(a)for(var c in a)if(a.hasOwnProperty(c)){var d=void 0!==b[c],e=0===c.indexOf("on");if(d)if(b[c]===a[c]||e){b[c]=b[c].constructor===Array?b[c]:[b[c]];b[c].push(a[c])}else b[c]=a[c];else b[c]=a[c]}return b}da.onInit(function(a){a.error||(sa.initialised=!0)});da.onStart(function(a){a.error||(sa.chatInProgress=!0)});da.onState(function(a){if(!a.error){sa.state=a.state;switch(sa.state){case da.chatStates.RESUMING:sa.chatInProgress=!0;break;case da.chatStates.CHATTING:case da.chatStates.WAITING:_.usingSecureStorage||_.setSessionData(t(ka.resumeMode),!0,null,null,null,!1);sa.chatInProgress=!0;sa.agentName="";sa.agentId="";sa.agentPictureUrl="";ba.changeKeepAliveState();break;case da.chatStates.INITIALISED:sa.chatInProgress=!!Fa;break;case da.chatStates.ENDED:case da.chatStates.UNINITIALISED:sa.chatInProgress=!1;ba.changeKeepAliveState();break;case da.chatStates.NOTFOUND:sa.chatInProgress=!1;sa.exitSurveyOn=!1;ba.changeKeepAliveState()}}});da.onVisitorName(function(a){a.error||(sa.visitorName=a.visitorName)});da.onSetVisitorTyping(function(a){a.error||(sa.typing=a.typing)});ua=f(a);l(ua,!1);b(ua);c(ua);typeof ua.debug===ta.BOOL&&da.setDebugMode(ua.debug);e()}function n(a){return a||window.lpMTagConfig&&window.lpMTagConfig.FPC_CONT||_.readCookie("HumanClickSiteContainerID_"+ua.lpNumber)||null}function o(a){return a||window.lpMTagConfig&&window.lpMTagConfig.LPSID_VAR||_.readCookie(ua.lpNumber+"-SKEY")||null}function p(a){return a||window.lpMTagConfig&&window.lpMTagConfig.FPC_VID||_.readCookie(ua.lpNumber+"-VID")||null}function q(){Da=!0;if(a.doNotResume&&ma!==la.PRODUCTION){if(k()){G();aa.publish({eventName:ra.onLoad,data:{API:"Chat API SDK Loaded",version:fa,state:Fa?da.chatStates.RESUMING:da.chatStates.UNINITIALISED}});sa.chatInProgress=!1}}else a.sessionUID?_.getSessionData(t(a.sessionUID),B,B,null):_.getSessionData(t(ka.resumeMode),y,y,null)}function r(a,b,c,d){if(!aa)return!1;var e={eventName:a,appName:c||"",aSync:!1,func:b,context:d||null};return aa.register(e)}function s(a,b,c,d){if(!aa)return!1;if(typeof a===ta.FUN){c=a;a=""}else if(typeof a===ta.OBJ){d=a;a=""}var e={eventName:a,appName:b||"",func:c,context:d||null};return aa.unbind(e)}function t(b){if(!a.lpNumber)return"";if(typeof b===ta.OBJ){var c=[];for(var d in b)b.hasOwnProperty(d)&&c.push(b[d]+a.lpNumber);return c}return b+a.lpNumber}function u(a,b,c,d){v(na.ERROR,{error:a,originalRequest:b,sentRequest:c,response:d});b=null;c=null;d=null;return a}function v(a,b){var c={eventName:ra.onLog};a&&typeof a===ta.STR?c.appName=a:typeof a===ta.OBJ&&(b=a);c.data=b;if(!c.appName||c.appName===na.ERROR||Ea){aa.publish(c);c=null}else c=null}function w(){return ma!=la.PRODUCTION?"/hcp/html/lpsunco/postmessage.html":"/hcp/html/postmessage.min.html"}function x(){if(va.domain&&va.lpNumber){var b={rest2jsonp:{domain:va.domain,site:va.lpNumber},postmessage:{frames:[{url:"https://"+va.domain+w(),delayLoad:0}]}};a.engagementDomain&&b.postmessage.frames.push({url:"https://"+a.engagementDomain+"/postmessage/postmessage.min.html",delayLoad:0});ua&&ua.batchelor&&(b.websocket2http={idleBeforePing:15e3,server:ua.batchelor});ia.configureTransports(b)}}function y(a){1==a?_.getSessionData(t(ka.sessionVars),A,A,null):z()}function z(){sa.chatInProgress=!1;Fa=!1;aa.publish({eventName:ra.onLoad,data:{API:"Chat API SDK Loaded",version:fa,state:Fa?da.chatStates.RESUMING:da.chatStates.UNINITIALISED}});G()}function A(b){if(b&&typeof b===ta.OBJ&&!b.error){if(C(a,b)){l(b);Fa=!0;_.getSessionData(t(ka.chat),B,B,null)}}else z()}function B(a){if(!a||a&&!a.chatRel)z();else{sa.chatInProgress=!0;aa.publish({eventName:ra.onLoad,data:{API:"Chat API SDK Loaded",version:fa,state:Fa?da.chatStates.RESUMING:da.chatStates.UNINITIALISED}});a.overRides&&l(a.overRides);G({success:function(){ca.addRels({link:[{rel:"location",href:a.chatRel}]},{type:"chat"});Y(W(da.chatStates.RESUMING,new Date));M(null,a.overRides)},error:function(){ba.sessionEnded()}})}}function C(a,b){for(var c=["lpNumber","appKey","sessionUID"],d=!0,e=0;e<c.length;e++){var f=c[e];a[f]!=b[f]&&("sessionUID"===f?a[f]&&b[f]&&(d=!1):d=!1);if(!d)break}return d}function D(a,b,c,d,e,f){v(na.ERROR,{originalRequest:a,sentRequest:b,response:c});c=ga.getErrorData(c,e,a);E(d,c,f);ga.runErrorCallback(a,c);b=null;return c}function E(a,b,c){a=a.constructor===Array?a:[a];for(var d=0;d<a.length;d++)aa.publish({eventName:a[d],appName:c||"",data:b})}function F(b){var c={site:b.lpNumber};c.success=function(c){a.engagementDomain=c.engagementDomain;b.domain=c.domain;G(b)};c.error=function(a){u({error:"unable to resolve site domain"},b,"",a);D({},{},{},ra.onInit,"unable to initiate session");ga.runErrorCallback(b)};da.getSiteDomain(c)}function G(a){a=a||{};l(a);a.lpNumber=va.lpNumber;a.appKey=va.appKey;a.domain=va.domain;if(!a.lpNumber)return u({error:"missing site configuration data, cannot _init"},a,"","");if(!a.domain){F(a);return!1}if(!k())return!1;ca.setData(a);var b=ca.buildRequestObj({rel:"",data:{lpNumber:va.lpNumber,appKey:va.appKey,domain:va.domain}});b=U(b);b.success=function(c){v(na.INFO,{originalRequest:a,sentRequest:b,response:c});if(c){ca.addRels(c,{type:"chat"});J("self",{type:"chat",ignoreParameters:!0},[{rel:"OTK",href:"chat/resumeWithOTK"}]);aa.publish({eventName:ra.onInit,data:{account:a.lpNumber,domain:a.domain,init:!0}});Y(W(da.chatStates.INITIALISED))}a.requestChat?da.requestChat(a):ga.runSuccessCallback(a,{});b=null};b.error=function(c){var d=[ra.onInit];a.requestChat&&d.push(ra.onRequestChat);D(a,b,c,d,"unable to initiate session");ca.clearData()};v(na.INFO,{originalRequest:a,sentRequest:b,response:"SENDING REQUEST"});return ia.issueCall(b)}function H(a){var b,c,d,e={};a=a||{};d=o(a.visitorSessionId);c=p(a.visitorId);b=da.getRtSessionId();e=ga.validateAndExtendConfigs([{obj:a,type:ta.STR,path:pa.agent,prop:pa.agent},{obj:a,type:ta.STR,path:pa.skill,prop:pa.skill},{obj:a,type:ta.STR,path:pa.sQueue,prop:pa.sQueue}],e,!0);ga.validateAndExtendConfigs([{obj:a,type:ta.NUM,path:"interactionTimeout",prop:"interactionTimeout"},{obj:navigator,type:ta.STR,path:pa.UA,prop:pa.UA},{obj:a,type:ta.STR,path:pa.leVid,prop:pa.leVid},{obj:a,type:ta.STR,path:pa.leSid,prop:pa.leSid},{obj:a,path:pa.leCid,prop:pa.leCid},{obj:a,type:ta.STR,path:"ssoKey",prop:"ssoKey"},{obj:a,type:ta.OBJ,path:"survey",prop:"survey"},{obj:a,path:"participantId",prop:"participantId"},{obj:a,path:"conversationId",prop:"conversationId"},{obj:a,path:"a2aSourceSiteId",prop:"a2aSourceSiteId"},{obj:a,path:"a2aSourceSessionId",prop:"a2aSourceSessionId"},{obj:a,path:"a2aEventId",prop:"a2aEventId"},{obj:a,type:ta.BOOL,path:"runWithRules",prop:"runWithRules"},{obj:a,type:ta.STR,path:"ssoServiceExtraParams",prop:"ssoServiceExtraParams"},{obj:a,type:ta.STR,path:"ssoServiceKey",prop:"ssoServiceKey"},{obj:a,path:"engagementId",prop:"engagementId"},{obj:a,path:"campaignId",prop:"campaignId"},{obj:a,path:"language",prop:"language"},{obj:a,type:ta.STR,path:"capChallenge",prop:"capChallenge"},{obj:a,type:ta.STR,path:"capResponse",prop:"capResponse"},{obj:a,type:ta.NUM,path:pa.availabilityPolicy,prop:pa.availabilityPolicy},{obj:c,prop:pa.vId},{obj:d,prop:"visitorSessionId"},{obj:b,prop:"rtSessionId"}],e);!isNaN(a.maxWaitTime)&&a.maxWaitTime>=0&&a.maxWaitTime<86400&&(e.maxWaitTime=a.maxWaitTime);typeof a.buttonName===ta.STR?e.chatReferrer="(button dynamic-button:"+a.buttonName+"()) "+document.location.href:!0===a.invitation?e.chatReferrer="(engage) "+document.location.href:(a.chatReferrer||document.referrer)&&(e.chatReferrer=a.chatReferrer||document.referrer);if(typeof a.customVariables===ta.OBJ)if(a.customVariables.customVariable&&a.customVariables.customVariable.constructor===Array)e.customVariables=a.customVariables;else{var f=I(a.customVariables);f&&(e.customVariables=f)}a.preChatLines&&a.preChatLines.constructor===Array&&(e.preChatLines={line:a.preChatLines});return ga.hasProperties(e)?{request:e}:{}}function I(a){var b=[];for(var c in a)a.hasOwnProperty(c)&&b.push({name:c,value:a[c]});return b.length>0?{customVariable:b}:null}function J(a,b,c){for(var d=ca.getURI(a,b),e={link:[]},f=0;f<c.length;f++)e.link.push({href:d+"/"+c[f].href,rel:""+c[f].rel});ca.addRels(e,b)}function K(a,b){if(sa.chatInProgress||Ca)return!1;var c={},d=n(a.siteContainer);d&&(c.siteContainer=d);var e=ca.buildRequestObj({rel:"chat-request",type:"chat",needAuth:!0,requestType:"POST",data:H(a),queryParams:c});if(!e)return u({error:"requestChat - unable to find rel for request"},"","","");L(a.sessionUID);Ca=!0;e=U(e);e.success=function(c){var d;v(na.INFO,{originalRequest:a||"",sentRequest:e,response:c});d=c&&c.headers&&(c.headers.Location||c.headers.location);if(d){ca.addRels({link:[{"@rel":"location","@href":d}]},{type:"chat"});ba.storeChatLocationURI(d,b);b&&(sa.initialised=!1);M(a)}e=null};e.error=function(b){D(a,e,b,[ra.onRequestChat],"requestChat  - server error");Ca=!1};v(na.INFO,{originalRequest:a||"",sentRequest:e,response:"SENDING REQUEST"});return ia.issueCall(e)}function L(b){if(b){a=a||{};a.sessionUID&&da.clearSessionData(a.sessionUID);a.sessionUID=b}}function M(a,b){var c=ca.buildRequestObj({rel:"location",type:"chat",needAuth:!0,requestType:"GET"});if(!c)return u({error:"_getSessionData - unable to find rel for request"},"","","");Ca=!0;c=U(c);c.success=function(d){v(na.INFO,{originalRequest:a||"",sentRequest:c,response:d});N(c,a,d);b&&(sa.initialised=!1);za=0;Ca=!1;c=null};c.error=function(d){var e=d&&d.responseCode,f=ga.getErrorData(d,"_getSessionData  - server error",a);if(503===e&&27===f.error.internalCode&&ya>za){setTimeout(function(){M(a,b)},xa);za+=1}else{if(sa.chatState===da.chatStates.RESUMING){Y(W(da.chatStates.NOTFOUND));ba.sessionEnded()}D(a,c,d,ra.onRequestChat,"_getSessionData  - server error");za=0;Ca=!1}};v(na.INFO,{originalRequest:"",sentRequest:c,response:"SENDING REQUEST"});aa.publish({eventName:qa.onSessionData,data:c,cloneEventData:!0});return ia.issueCall(c)}function N(a,b,c){if(c){ca.addRels({link:c.body.chat.link},{type:"chat"});ca.addRels(c.body.chat.info,{type:"visitor"});var d=ga.getResponseData(c,"chat",!1);aa.publish({eventName:ra.onRequestChat,data:d});X(d.info);d.events=Q(d.events,d.info);var e=Z(d.events);e&&R(e,d.events);ga.runSuccessCallback(b,d);Fa=!1}}function O(a){for(var b={},c=0;c<a.length;c++)b[a[c].skill]=a[c].isAvailable;return b}function P(a){var b=ca.buildRequestObj({rel:"next",type:"chat",needAuth:!0,requestType:"GET"});if(!b)return u({error:"_getEvents - unable to find rel for request"},"","","");b=U(b);b.timeout=1e4;b.retries=0;b.success=function(c){Aa=0;$&&clearTimeout($);var d,e;v(na.INFO,{originalRequest:"",sentRequest:b,response:c});if(c){ca.addRels({link:c.body.chat.link},{type:"chat"});ca.addRels(c.body.chat.info,{type:"visitor"});d=ga.getResponseData(c,"chat");d.events=Q(d.events,d.info);e=Z(d.events);e&&R(e,d.events);d.info&&X(d.info)}ga.runSuccessCallback(a,e);b=null};b.error=function(c){var d=c&&c.responseCode;Aa+=1;c=D(a,b,c,[],"");!$&&Ba&&($=setTimeout(function(){Y(W(da.chatStates.NOTFOUND))},Ba));503===d&&27===c.error.internalCode&&wa>Aa?D(a,b,c,[ra.onEvents],"_getEvents - server error"):!$&&Aa>wa||c&&c.error&&12===c.error.internalCode?Y(W(da.chatStates.NOTFOUND)):E([ra.onLine,ra.onAgentTyping,ra.onInfo,ra.onEvents],c)};v(na.INFO,{originalRequest:"",sentRequest:b,response:"SENDING REQUEST"});return ia.issueCall(b)}function Q(a,b){var c=a&&a.event;c=c&&c.constructor===Array?c:[c];if(c&&b&&b.agentPictureUrl)for(var d=0;d<c.length;d++)c[d]&&c[d].by&&c[d].by===b.agentName&&(c[d].agentPictureUrl=b.agentPictureUrl);return a}function R(a,b){b&&aa.publish({eventName:ra.onEventList,data:b.event});a.line&&aa.publish({eventName:ra.onLine,data:{lines:a.line}});if(a["a2a-transfer"]){var c=V(a["a2a-transfer"]);aa.publish({eventName:ra.onAccountToAccountTransfer,data:c})}a.leCollaboration&&aa.publish({eventName:ra.onCollaboration,data:{collaboration:a.leCollaboration}});if(a.state){a.state=a.state.constructor===Array?a.state.pop():a.state;Y(W(a.state.state,a.state.time))}aa.publish({eventName:ra.onEvents,data:a})}function S(a){var b=!1;a=a.constructor===Array?a:[a];for(var c={},d=0;d<a.length;d++)if("object"==typeof a[d]&&a[d]["@name"]){c[a[d]["@name"]]=a[d].$;b=!0}return b?c:a}function T(a){if(a){var b={"@type":"leCollaboration",subType:a.subType,command:a.command};if("object"==typeof a.info){var c=[];for(var d in a.info)a.info.hasOwnProperty(d)&&c.push({"@name":d,$:a.info[d]});c.length>0&&(b.info=c)}return b}}function U(a){a.headers=a.headers||{};a.headers.Pragma="no-cache";a.headers["Cache-Control"]="private, max-age=0, no-cache, no-store";return a}function V(a){return a.length>1?a[a.length-1]:a[0]}function W(a,b){return{state:a,time:b||(new Date).toTimeString()}}function X(a){if("typing"===a.agentTyping!=sa.agentTyping){sa.agentTyping="typing"===a.agentTyping;aa.publish({eventName:ra.onAgentTyping,data:{agentTyping:sa.agentTyping}});a.agentTyping=null;delete a.agentTyping}var b=!1;for(var c in a)if(a.hasOwnProperty(c)&&sa.hasOwnProperty(c)&&a[c]!=sa[c]&&"lastUpdate"!==c&&"agentTyping"!==c&&"visitorTyping"!==c&&"state"!==c){sa[c]=a[c];b=!0}sa.state==da.chatStates.RESUMEPAUSEDCHAT&&a.state!==sa.state&&Y(W(a.state));sa.lastUpdate=a.lastUpdate;b&&aa.publish({eventName:ra.onInfo,data:sa,cloneEventData:!0})}function Y(a){if(sa.chatState!==a.state){sa.chatState=a.state;switch(a.state){case da.chatStates.ENDED:aa.publish({eventName:ra.onStop,data:a});break;case da.chatStates.CHATTING:aa.publish({eventName:ra.onStart,data:a})}aa.publish({eventName:ra.onState,data:a})}}function Z(a){if(!a.event)return null;a=a.event;a=a.constructor===Array?a:[a];for(var b={},c=!1,d=0;d<a.length;d++){var e=a[d].type||a[d]["@type"];"leCollaboration"===e&&a[d].info&&(a[d].info=S(a[d].info));if(a[d].channelID){var f=a[d].channelID;b[e]=b[e]||{};b[e][f]=b[e][f]||[];b[e][f].push(a[d])}else{b[e]=b[e]||[];b[e].push(a[d])}c=!0}return c?b:null}if(this===window)return!1;var $,_,aa,ba,ca,da=this,ea="ChatOverRestAPI",fa="3.1.0",ga=lpTag.utils,ha=lpTag&&lpTag.taglets&&lpTag.taglets.jsonp,ia=lpTag&&lpTag.taglets&&lpTag.taglets.lpAjax,ja=a.batchelor?["websocket2http","postmessage","rest2jsonp"]:["postmessage","rest2jsonp"],ka={resumeMode:"lpVisitorResumeMode",sessionVars:"lpVisitorSessionVars",chat:"lpVisitorChatRels",sessionUID:"lpSessionUID",engagementData:"lpEngagementData"},la={QA:"QA",DEV:"DEV",PRODUCTION:"PRODUCTION",CI:"CI",CLOUD:"CLOUD"},ma=la.PRODUCTION,na={ERROR:"ERROR",INFO:"INFO",DEBUG:"DEBUG"},oa={EXTERNAL:"EXTERNAL"},pa={skill:"skill",sQueue:"serviceQueue",agent:"agent",mWaitTime:"maxWaitTime",sAPIId:"surveyApiId",subject:"subject",sName:"surveyName",vProfile:"visitorProfile",sId:"sessionId",vId:"visitorId",vIp:"visitorIp",leVid:"LETagVisitorId",leSid:"LETagSessionId",leCid:"LETagContextId",UA:"userAgent",appType:"appType",appDetails:"appDetails",windowSurveyEnabled:"windowSurveyEnabled",engSkillId:"engSkillId",availabilityPolicy:"availabilityPolicy",deviceFamily:"deviceFamily",os:"os",ipAddress:"ipAddress",osVersion:"osVersion",consumerSections:"consumerSections",engagementAttributes:"engagementAttributes",impAttributes:"impAttributes",pageId:"pageId"},qa={onSessionData:"onSessionData"},ra={onLoad:"onLoad",onInit:"onInit",onEngagement:"onEngagement",onStart:"onStart",onRequestChat:"onRequestChat",onAvailability:"onAvailability",onEstimatedWaitTime:"onEstimatedWaitTime",onAgentTyping:"onAgentTyping",onLine:"onLine",onInfo:"onInfo",onEvents:"onEvents",onEventList:"onEventList",onState:"onState",onStop:"onStop",onAccountToAccountTransfer:"onAccountToAccountTransfer",onAddLine:"onAddLine",onCollaboration:"onCollaboration",onSendCollaboration:"onSendCollaboration",onVisitorName:"onVisitorName",onSetVisitorTyping:"onSetVisitorTyping",onTranscript:"onTranscript",onPreChatSurvey:"onPreChatSurvey",onOfflineSurvey:"onOfflineSurvey",onSubmitOfflineSurvey:"onSubmitOfflineSurvey",onExitSurvey:"onExitSurvey",onLog:"onLog",onVisitorDisposed:"onVisitorDisposed",onSetCustomVariable:"onSetCustomVariable",onSubmitExitSurvey:"onSubmitExitSurvey"},sa={typing:null,visitorName:"",agentName:"",rtSessionId:"",initialised:!1,agentTyping:!1,chatInProgress:!1,visitorId:"",agentId:"",agentPictureUrl:"",skillName:"",timeout:"",chatSessionKey:"",chatState:"",exitSurveyOn:!1},ta={STR:"string",
BOOL:"boolean",ARR:"array",OBJ:"object",NUM:"number",FUN:"function"},ua={},va={},wa=a&&a.failureTolerance||45,xa=a&&a.moveToPrimaryInterval||2e3,ya=a&&a.moveToPrimaryRetry||15,za=0,Aa=0,Ba=a&&a.reconnectTimeout,Ca=!1,Da=!1,Ea=!1,Fa=!1,Ga=0,Ha=!1;da.getSiteDomain=function(a){var b="https://api.liveperson.net/csdr/account/",d="/service/baseURI.lpCsds?version=1.0";if(typeof a.success!==ta.FUN||!a.site)return u({error:"missing callback or site - cannot lookup domain"},"","","");var e={url:b+a.site+d};e=U(e);e.success=function(b){var d,f;v(na.INFO,{originalRequest:{site:a.site},sentRequest:e,response:b});if(b&&b.ResultSet&&b.ResultSet.lpData){d=c(b.ResultSet.lpData.baseURIs,"conversationVep");f=c(b.ResultSet.lpData.baseURIs,"smt")}e=null;d&&f?ga.runSuccessCallback(a,{domain:d,engagementDomain:f,site:a.site}):ga.runErrorCallback(a,{error:"unable to resolve site domain",response:b,site:a.site})};e.error=e.success;v(na.INFO,{originalRequest:{site:a.site},sentRequest:e,response:"SENDING REQUEST"});return ha.issueCall(e)};da.updateSdes=function(a){var c=t(ka.engagementData),d=b.bind(this,a);_.getSessionData(c,d,d,null)};da.getEngagement=function(a){var b,c;a=a||{};if(a.sid&&a.vid)d(a);else{b=d.bind(this,a);c=t(ka.engagementData);_.getSessionData(c,b,b,null)}};da.requestChat=function(b){if(sa.initialised)K(b);else{b=b||{};b.requestChat=!0;b.lpNumber=a.lpNumber;b.appKey=a.appKey;b.domain=a.domain||null;b.clearDomain=!0;G(b)}};da.startChat=da.requestChat;da.reInit=function(b){sa={typing:null,visitorName:"",agentName:"",rtSessionId:"",initialised:!1,agentTyping:!1,chatInProgress:!1,visitorId:"",agentId:"",agentPictureUrl:"",skillName:"",timeout:"",chatSessionKey:"",chatState:"",exitSurveyOn:!1};if(b){!0===b.disposeVisitor&&da.disposeVisitor();if(b.sessionUID){a=a||{};a.sessionUID=b.sessionUID}}ca.clearData();q()};da.getEstimatedWaitTime=function(a){var b={};a&&(b=ga.validateAndExtendConfigs([{obj:a,type:ta.STR,path:pa.skill,prop:pa.skill},{obj:a,type:ta.STR,path:pa.sQueue,prop:pa.sQueue}],b));var c=ca.buildRequestObj({rel:"chat-estimatedWaitTime",type:"chat",needAuth:!0,requestType:"GET",queryParams:b});if(!c)return u({error:"getEstimatedWaitTime - unable to find rel for request"},"","","");c=U(c);c.success=function(b){v(na.INFO,{originalRequest:"",sentRequest:c,response:b});if(b){var d=ga.getResponseData(b,"estimatedWaitTime",!0);aa.publish({eventName:ra.onEstimatedWaitTime,data:d});ga.runSuccessCallback(a,d)}c=null};c.error=function(b){D(a,c,b,ra.onEstimatedWaitTime,"getEstimatedWaitTime - server error")};v(na.INFO,{originalRequest:"",sentRequest:c,response:"SENDING REQUEST"});return ia.issueCall(c)};da.getAvailabilty=function(a){var b={};a&&(a.agent&&typeof a.agent===ta.STR?b.agent=a.agent:b=ga.validateAndExtendConfigs([{obj:a,path:pa.skill,prop:pa.skill},{obj:a,path:pa.mWaitTime,prop:pa.mWaitTime},{obj:a,type:ta.STR,path:pa.sQueue,prop:pa.sQueue}],b));var c=ca.buildRequestObj({rel:"chat-availability",type:"chat",needAuth:!0,requestType:"GET",queryParams:b});if(!c)return u({error:"getAvailability - unable to find rel for request"},"","","");c=U(c);c.success=function(b){var d,e;v(na.INFO,{originalRequest:a||"",sentRequest:c,response:b});if(b){d=ga.getResponseData(b,"availability",!0);e=ga.getPropertyFromObject(d,"availability.AvailabilityForSkills.skillAvailability");e&&(d=O(e));aa.publish({eventName:ra.onAvailability,data:d});ga.runSuccessCallback(a,d)}c=null};c.error=function(b){D(a,c,b,ra.onAvailability,"getAvailabilty - server error")};v(na.INFO,{originalRequest:a||"",sentRequest:c,response:"SENDING REQUEST"});return ia.issueCall(c)};da.getAvailability=da.getAvailabilty;da.disposeVisitor=function(){ba.sessionEnded();aa.publish({eventName:ra.onVisitorDisposed,data:{visitorDisposed:!0,aSync:!0}})};da.clearSessionData=function(a){if(a){_.removeSessionData(t(a));return!0}return!1};da.getPreChatSurvey=function(a){var b={};if(a){b=ga.validateAndExtendConfigs([{obj:a,type:ta.STR,path:pa.vProfile,prop:pa.vProfile}],b,!0);b=ga.validateAndExtend({obj:a,type:ta.STR,path:pa.vIp,prop:pa.vIp},b);b=ga.validateAndExtendConfigs([{obj:a,path:pa.sAPIId,prop:pa.sAPIId},{obj:a,type:ta.STR,path:pa.sName,prop:pa.sName}],b,!0);b=g(b,a)}var c=ca.buildRequestObj({rel:"prechat-survey",type:"chat",needAuth:!0,requestType:"GET",queryParams:b});if(!c)return u({error:"getPreChatSurvey - unable to find rel for request"},"","","");c=U(c);c.success=function(b){v(na.INFO,{originalRequest:a||"",sentRequest:c,response:b});if(b){var d=ga.getResponseData(b,"survey",!0);aa.publish({eventName:ra.onPreChatSurvey,data:d});ga.runSuccessCallback(a,d)}c=null};c.error=function(b){D(a,c,b,ra.onPreChatSurvey,"getPreChatSurvey - server error")};v(na.INFO,{originalRequest:a||"",sentRequest:c,response:"SENDING REQUEST"});return ia.issueCall(c)};da.getOfflineSurvey=function(a){var b={};if(a){b=ga.validateAndExtendConfigs([{obj:a,path:pa.sAPIId,prop:pa.sAPIId},{obj:a,type:ta.STR,path:pa.vProfile,prop:pa.vProfile},{obj:a,type:ta.STR,path:pa.vId,prop:pa.vId},{obj:a,type:ta.STR,path:pa.sName,prop:pa.sName}],b,!0);b=ga.validateAndExtendConfigs([{obj:a,path:pa.engSkillId,prop:pa.engSkillId},{obj:a,type:ta.BOOL,path:pa.windowSurveyEnabled,prop:pa.windowSurveyEnabled}],b);b=g(b,a)}var c=ca.buildRequestObj({rel:"chat-offline-survey",type:"chat",needAuth:!0,requestType:"GET",queryParams:b});if(!c)return u({error:"getOfflineSurvey - unable to find rel for request"},"","","");c=U(c);c.success=function(b){v(na.INFO,{originalRequest:a||"",sentRequest:c,response:b});if(b){var d=ga.getResponseData(b,"survey",!0);aa.publish({eventName:ra.onOfflineSurvey,data:d});ga.runSuccessCallback(a,d)}c=null};c.error=function(b){D(a,c,b,ra.onOfflineSurvey,"getOfflineSurvey - server error")};v(na.INFO,{originalRequest:a||"",sentRequest:c,response:"SENDING REQUEST"});return ia.issueCall(c)};da.submitOfflineSurvey=function(a){var b,c,d={};if(!a.survey)return u({error:"Survey must be present in order to submit"},"","","");d.survey=a.survey;var e={},f=n(a.siteContainer);f&&(e.siteContainer=f);b=o(a.visitorSessionId);c=p(a.visitorId);d.survey=lpTag.utils.validateAndExtendConfigs([{obj:b,prop:"visitorSessionId"},{obj:c,prop:pa.vId},{obj:a,type:ta.STR,path:pa.leVid,prop:pa.leVid},{obj:a,type:ta.STR,path:pa.leSid,prop:pa.leSid},{obj:a,path:pa.leCid,prop:pa.leCid},{obj:a,path:"offsiteEngContext",prop:"offsiteEngContext"},{obj:a,type:ta.STR,path:"chatRefferer",prop:"chatRefferer"},{obj:a,type:ta.STR,path:pa.skill,prop:pa.skill},{obj:a,type:ta.STR,path:"capChallenge",prop:"capChallenge"},{obj:a,type:ta.STR,path:"capResponse",prop:"capResponse"},{obj:a,path:pa.vIp,prop:pa.vIp},{obj:navigator,path:pa.UA,prop:pa.UA}],d.survey);var g=ca.buildRequestObj({rel:"chat-offline-survey",type:"chat",needAuth:!0,requestType:"PUT",data:d,queryParams:e});if(!g)return u({error:"submitOfflineSurvey - unable to find rel for request"},"","","");g=U(g);g.success=function(b){v(na.INFO,{originalRequest:a||"",sentRequest:g,response:b});if(b){var c=ga.getResponseData(b);aa.publish({eventName:ra.onSubmitOfflineSurvey,data:c});ga.runSuccessCallback(a,c)}g=null};g.error=function(b){D(a,g,b,ra.onSubmitOfflineSurvey,"submitOfflineSurvey - server error")};v(na.INFO,{originalRequest:a||"",sentRequest:g,response:"SENDING REQUEST"});return ia.issueCall(g)};da.pauseChat=function(){Ha=!0;Y(W(da.chatStates.PAUSECHAT));ba.changeKeepAliveState()};da.resumePausedChat=function(){Ha=!1;Y(W(da.chatStates.RESUMEPAUSEDCHAT));ba.changeKeepAliveState()};da.setCustomVariable=function(a){if(!a.customVariable)return u({error:"setCustomVariable - no variables passed in"},"","","");var b=I(a.customVariable);if(!b||!b.customVariable)return u({error:"setCustomVariable - unable to find any custom variables to set"},"","","");a.customVariable=b.customVariable;var c=ca.buildRequestObj({rel:"custom-variables",type:"chat",needAuth:!0,requestType:"PUT",data:{customVariables:{customVariable:a.customVariable}}});if(!c)return u({error:"setCustomVariable - unable to find rel for request"},"","","");c=U(c);c.success=function(b){v(na.INFO,{originalRequest:a||"",sentRequest:c,response:b});if(b){var d={customVariable:a.customVariable};aa.publish({eventName:ra.onSetCustomVariable,data:d});ga.runSuccessCallback(a,d)}c=null};c.error=function(b){D(a,c,b,ra.onSetCustomVariable,"setCustomVariable  - server error")};v(na.INFO,{originalRequest:a||"",sentRequest:c,response:"SENDING REQUEST"});return ia.issueCall(c)};da.requestTranscript=function(a){var b,c=new RegExp(/[a-zA-Z0-9.-_]+@[a-zA-Z0-9.-]+\.[a-zA-Z]{2,4}$/i);b=typeof a===ta.STR?a:a.email;var d={transcriptRequest:{email:b}};a[pa.subject]&&(d.transcriptRequest[pa.subject]=a[pa.subject]);if(typeof b!==ta.STR||!c.test(a.email))return u({error:"requestTranscriptEmail - no variables passed in or invalid email"},"","","");var e=ca.buildRequestObj({rel:"transcript-with-subject-request",type:"chat",needAuth:!0,requestType:"PUT",data:d});if(!e){d={email:b};e=ca.buildRequestObj({rel:"transcript-request",type:"chat",needAuth:!0,requestType:"PUT",data:d})}if(!e)return u({error:"requestTranscript - unable to find rel for request"},"","","");e=U(e);e.success=function(b){v(na.INFO,{originalRequest:a||"",sentRequest:e,response:b});if(b){var c={email:a.email};aa.publish({eventName:ra.onTranscript,data:c});ga.runSuccessCallback(a,c)}e=null};e.error=function(b){D(a,e,b,ra.onTranscript,"requestTranscriptEmail  - server error")};v(na.INFO,{originalRequest:a||"",sentRequest:e,response:"SENDING REQUEST"});return ia.issueCall(e)};da.getExitSurvey=function(a){var b={};b=lpTag.utils.validateAndExtendConfigs([{obj:a,path:pa.sAPIId,prop:pa.sAPIId},{obj:a,type:ta.STR,path:pa.sName,prop:pa.sName}],b,!0);b=lpTag.utils.validateAndExtendConfigs([{obj:a,path:pa.engSkillId,prop:pa.engSkillId},{obj:a,type:ta.BOOL,path:pa.windowSurveyEnabled,prop:pa.windowSurveyEnabled}],b);var c=ca.buildRequestObj({rel:"exit-survey",type:"chat",needAuth:!0,requestType:"GET",queryParams:b});if(!c)return u({error:"getExitSurvey - unable to find rel for request"},"","","");c=U(c);c.success=function(b){v(na.INFO,{originalRequest:a||"",sentRequest:c,response:b});var d,e=ga.getPropertyFromObject(b,"body.survey");if(e){sa.exitSurveyOn=!0;ba.changeKeepAliveState();d={survey:e};aa.publish({eventName:ra.onExitSurvey,data:d});ga.runSuccessCallback(a,d)}c=null};c.error=function(b){sa.exitSurveyOn=!1;ba.changeKeepAliveState();D(a,c,b,ra.onExitSurvey,"getExitSurvey  - server error")};v(na.INFO,{originalRequest:a||"",sentRequest:c,response:"SENDING REQUEST"});return ia.issueCall(c)};da.submitExitSurvey=function(a){var b;b=a.survey&&a.survey.survey?a.survey.survey:a.survey;if(!b)return u({error:"submitExitSurvey - no survey passed in"},"","","");b=lpTag.utils.validateAndExtendConfigs([{obj:document,type:ta.STR,path:"referrer",prop:"chatReferrer"},{obj:navigator,path:pa.UA,prop:pa.UA}],b,!0);var c=ca.buildRequestObj({rel:"exit-survey",type:"chat",needAuth:!0,requestType:"PUT",data:{survey:b}});if(!c)return u({error:"submitExitSurvey - unable to find rel for request"},"","","");c=U(c);c.success=function(b){v(na.INFO,{originalRequest:a||"",sentRequest:c,response:b});sa.exitSurveyOn=!1;ba.changeKeepAliveState();if(b){var d=ga.getResponseData(b);aa.publish({eventName:ra.onSubmitExitSurvey,data:d});ga.runSuccessCallback(a,d)}c=null};c.error=function(b){D(a,c,b,ra.onSubmitExitSurvey,"submitExitSurvey  - server error")};v(na.INFO,{originalRequest:a||"",sentRequest:c,response:"SENDING REQUEST"});return ia.issueCall(c)};da.cancelSurvey=function(){ba.stopKeepAliveRequests()};da.addLine=function(a){if(!a||!a.text)return u({error:"No text to send"},a,"","");var b=ca.buildRequestObj({rel:"events",needAuth:!0,type:"chat",requestType:"POST",data:{event:{"@type":"line",text:a.text}}});if(!b)return u({error:"addLine - unable to find rel for request"},a,"","");b=U(b);b.success=function(c){v(na.INFO,{originalRequest:a,sentRequest:b,response:c});if(c){var d={text:a.text};aa.publish({eventName:ra.onAddLine,data:d});ga.runSuccessCallback(a,d)}b=null};b.error=function(c){D(a,b,c,ra.onAddLine,"addLine  - server error")};v(na.INFO,{originalRequest:a,sentRequest:b,response:"SENDING REQUEST"});return ia.issueCall(b)};da.sendCollaboration=function(a){if(!a||"string"!=typeof a.command||"string"!=typeof a.subType)return u({error:"Missing collaboration events parameters"},a,"","");var b=T(a),c=ca.buildRequestObj({rel:"events",needAuth:!0,type:"chat",requestType:"POST",data:{event:b}});if(!c)return u({error:"sendCollaboration - unable to find rel for request"},a,"","");c=U(c);c.success=function(d){v(na.INFO,{originalRequest:a,sentRequest:c,response:d});if(d){b.info&&(b.info=S(b.info));aa.publish({eventName:ra.onSendCollaboration,data:b});ga.runSuccessCallback(a,b)}c=null};c.error=function(b){D(a,c,b,ra.onSendCollaboration,"sendCollaboration  - server error")};v(na.INFO,{originalRequest:a,sentRequest:c,response:"SENDING REQUEST"});return ia.issueCall(c)};da.setVisitorTyping=function(a){if(!a)return u({error:"No object data passed"},"","","");if(typeof a.typing!==ta.BOOL||a.typing===sa.typing)return u({error:"setVisitorTyping typing status missing, not a boolean or unchanged from previous update"},a,"","");sa.typing=a.typing;var b=ca.buildRequestObj({rel:"visitor-typing",needAuth:!0,type:"visitor",requestType:"PUT",data:{visitorTyping:a.typing?"typing":"not-typing"}});if(!b)return u({error:"setVisitorTyping - unable to find rel for request"},a,"","");b=U(b);b.success=function(c){v(na.INFO,{originalRequest:a,sentRequest:b,response:c});if(c){var d={typing:a.typing};aa.publish({eventName:ra.onSetVisitorTyping,data:d});ga.runSuccessCallback(a,d)}b=null};b.error=function(c){D(a,b,c,ra.onSetVisitorTyping,"setVisitorTyping  - server error")};v(na.INFO,{originalRequest:a,sentRequest:b,response:"SENDING REQUEST"});return ia.issueCall(b)};da.endChat=function(a){var b=ca.buildRequestObj({rel:"events",type:"chat",needAuth:!0,requestType:"POST",data:{event:{"@type":"state",state:da.chatStates.ENDED}}});if(!b||!sa.chatInProgress)return u({error:"endChat - unable to find rel for request, or chat not active"},a,"","");b=U(b);b.success=function(c){v(na.INFO,{originalRequest:a,sentRequest:b,response:c});if(c){var d=W(da.chatStates.ENDED);Y(d);ga.runSuccessCallback(a,d)}b=null};b.error=function(c){D(a,b,c,[ra.onState],"endChat - server error")};a&&a.disposeVisitor&&da.disposeVisitor();v(na.INFO,{originalRequest:a,sentRequest:b,response:"SENDING REQUEST"});return ia.issueCall(b)};da.setVisitorName=function(a){if(!a)return u({error:"No object data passed"},"","","");var b="";if(typeof a.visitorName!==ta.STR||a.visitorName===sa.visitorName)return u({error:"setVisitorName missing visitorName or unchanged from previous update"},a,"","");b=sa.visitorName;sa.visitorName=a.visitorName;var c=ca.buildRequestObj({rel:"visitor-name",needAuth:!0,type:"visitor",requestType:"PUT",data:{visitorName:a.visitorName}});if(!c)return u({error:"setVisitorName - unable to find rel for request"},a,"","");c=U(c);c.success=function(b){v(na.INFO,{originalRequest:a,sentRequest:c,response:b});if(b){var d={visitorName:a.visitorName};aa.publish({eventName:ra.onVisitorName,data:d});ga.runSuccessCallback(a,d)}c=null};c.error=function(d){sa.visitorName=b;D(a,c,d,ra.onVisitorName,"setVisitorName  - server error")};v(na.INFO,{originalRequest:a,sentRequest:c,response:"SENDING REQUEST"});return ia.issueCall(c)};da.getAgentTyping=function(){return sa.agentTyping};da.getVisitorName=function(){return sa.visitorName};da.getState=function(){return sa.state};da.getAgentLoginName=function(){return sa.agentName};da.getAgentId=function(){return sa.agentId};da.agentPictureUrl=function(){return sa.agentPictureUrl};da.getRtSessionId=function(){return sa.rtSessionId||null};da.getConfig=function(){var a={};for(var b in ua)ua.hasOwnProperty(b)&&(a[b]=ua[b]);return a};da.getSessionKey=function(){return sa.chatSessionKey};da.setDebugMode=function(a){if(typeof a===ta.BOOL){Ea=a;lpTag.utils.log.debug=a}};da.unbind=function(a,b,c,d){return s(a,b,c,d)};i();h(a)};lpTag.taglets.ChatOverRestAPI.prototype.chatStates={CHATTING:"chatting",WAITING:"waiting",ENDED:"ended",RESUMING:"resume",UNINITIALISED:"uninitialised",INITIALISED:"initialised",NOTFOUND:"notfound",PAUSECHAT:"paused",RESUMEPAUSEDCHAT:"resumepaused"};lpTag.taglets.ChatOverRestAPI.prototype.connectionStates={ACTIVE:"active",INACTIVE:"inactive"};define("lpChatV3",function(){});define("leTagConfiguration",["settings"],function(Settings){if(Settings.liveperson.leTag.enabled===!0&&Settings.liveperson.leTag.loadedOnHost===!1){window.lpTag={};window.lpTag.autoStart=!1}});define("leTag",["settings"],function(Settings){if(Settings.liveperson.leTag.enabled===!0&&Settings.liveperson.leTag.loadedOnHost===!1){window.lpTag=window.lpTag||{};if("undefined"==typeof window.lpTag._tagCount){window.lpTag={site:Settings.liveperson.accountNumber||"",section:lpTag.section||"",autoStart:lpTag.autoStart===!1?!1:!0,ovr:lpTag.ovr||{domain:"lptag-a.liveperson.net",tagjs:"tags-a.liveperson.net"},_v:"1.6.0",_tagCount:1,protocol:"https:",events:{bind:function(app,ev,fn){lpTag.defer(function(){lpTag.events.bind(app,ev,fn)},0)},trigger:function(app,ev,json){lpTag.defer(function(){lpTag.events.trigger(app,ev,json)},1)}},defer:function(fn,fnType){if(0==fnType){this._defB=this._defB||[];this._defB.push(fn)}else if(1==fnType){this._defT=this._defT||[];this._defT.push(fn)}else{this._defL=this._defL||[];this._defL.push(fn)}},load:function(src,chr,id){var t=this;setTimeout(function(){t._load(src,chr,id)},0)},_load:function(src,chr,id){var url=src;src||(url=this.protocol+"//"+(this.ovr&&this.ovr.domain?this.ovr.domain:"lptag.liveperson.net")+"/tag/tag.js?site="+this.site);var s=document.createElement("script");s.setAttribute("charset",chr?chr:"UTF-8");id&&s.setAttribute("id",id);s.setAttribute("src",url);document.getElementsByTagName("head").item(0).appendChild(s)},init:function(){this._timing=this._timing||{};this._timing.start=(new Date).getTime();var that=this;if(window.attachEvent)window.attachEvent("onload",function(){that._domReady("domReady")});else{window.addEventListener("DOMContentLoaded",function(){that._domReady("contReady")},!1);window.addEventListener("load",function(){that._domReady("domReady")},!1)}"undefined"==typeof window._lptStop&&this.load()},start:function(){this.autoStart=!0},_domReady:function(n){if(!this.isDom){this.isDom=!0;this.events.trigger("LPT","DOM_READY",{t:n})}this._timing[n]=(new Date).getTime()},vars:lpTag.vars||[],dbs:lpTag.dbs||[],ctn:lpTag.ctn||[],sdes:lpTag.sdes||[],ev:lpTag.ev||[]};lpTag.init()}else window.lpTag._tagCount+=1}});define("views/virtual_assistant/components/liveperson",["jquery","jquery_ui","backbone","lpChatV3","leTagConfiguration","leTag","settings","scrollto"],function($,$ui,Backbone,LpChatV3,LeTagConfiguration,LeTag,Settings,ScrollTo){var LiveChat=Backbone.View.extend({el:".cv-va-bootstrap #cv-chat-content",submitID:"cv-live-chat-submit",entryID:"cv-live-chat-user-entry",bindEvent:"change:transactioncount",newLines:0,agentName:"Agent",activeChatSession:!1,launcherAppended:!1,proactiveLauncherAppended:!1,events:{"click #cv-live-chat-submit":"addLine"},surveyPrefixes:{question:"q_",checkbox:"cb_",radioButton:"rb_"},initialize:function(options){if("liveperson"===Settings.livechatVendor){this.pciSecureFormListener=function(){};this.$el.find("#lc-tab, #cv-live-chat-answer-history, #cv-live-chat-submit, #cv-live-chat-user-entry").remove();(Settings.vaLcTabs===!1&&"true"===localStorage.getItem(Settings.businessName+"-cvVaActiveSession_lp")||"true"===localStorage.getItem(Settings.businessName+"-requestingChat_lp"))&&this.$el.find("#cv-chat-answer-history").remove();this.$el.find(".cv-va-tabs-container").remove();Backbone.Model.prototype.initialize.call(this,options);this.model.on(this.bindEvent,this.render,this);window.leEngagementButtons=[];var allowLauncherInjection=!1,_this=this;if(Settings.selectiveLauncherInjection.enabled===!0){if(Settings.selectiveLauncherInjection.url.length>0)for(var i=0;i<Settings.selectiveLauncherInjection.url.length;i++)window.location.href.indexOf(Settings.selectiveLauncherInjection.url[i])>-1&&(allowLauncherInjection=!0)}else allowLauncherInjection=!0;if(Settings.lcAvailabilityLauncher===!0&&Settings.liveperson.leTag.enabled===!1){this.launcher=options.launcher;this.configureLiveChat()}else if(Settings.lcAvailabilityLauncher===!0&&Settings.liveperson.leTag.enabled===!0&&allowLauncherInjection===!0){this.launcher=options.launcher;setInterval(function(){var updatedSavedEngagement=!1;if(Settings.liveperson.leTag.injectOnLauncher===!1){for(var i=0;i<Settings.liveperson.leTag.engagementButtons.length;i++)if($(Settings.liveperson.leTag.engagementButtons[i]).length>0){if($(Settings.liveperson.leTag.engagementButtons[i]+" .LPMcontainer").length>0){window.liveChatStatus="online";if(_this.launcherAppended===!1){_this.launcherAppended=!0;_this.launcher.render(Settings.liveperson.leTag.engagementButtons[i])}else _this.launcherAppended===!0&&_this.launcher.show()}else if(0===$(Settings.liveperson.leTag.engagementButtons[i]+" .LPMcontainer").length){window.liveChatStatus="offline";_this.launcherAppended===!0&&_this.launcher.hide()}break}}else if(Settings.liveperson.leTag.injectOnLauncher===!0){for(var j=0;j<Settings.liveperson.leTag.engagementButtons.length;j++)if($(Settings.liveperson.leTag.engagementButtons[j]).length>0)if($(Settings.liveperson.leTag.engagementButtons[j]+" .LPMcontainer").length>0){updatedSavedEngagement=!1;window.leEngagementButtons.forEach(function(engagementButton){if(engagementButton.engagementId===Settings.liveperson.leTag.engagementButtons[j]){engagementButton.status="online";updatedSavedEngagement=!0}});updatedSavedEngagement===!1&&window.leEngagementButtons.push({engagementId:Settings.liveperson.leTag.engagementButtons[j],status:"online",rendered:!1})}else if(0===$(Settings.liveperson.leTag.engagementButtons[j]+" .LPMcontainer").length){updatedSavedEngagement=!1;window.leEngagementButtons.forEach(function(engagementButton){if(engagementButton.engagementId===Settings.liveperson.leTag.engagementButtons[j]){engagementButton.status="offline";updatedSavedEngagement=!0}});updatedSavedEngagement===!1&&window.leEngagementButtons.push({engagementId:Settings.liveperson.leTag.engagementButtons[j],status:"offline",rendered:!1})}for(var x=0;x<window.leEngagementButtons.length;x++)if(window.leEngagementButtons[x].rendered===!1&&"online"===window.leEngagementButtons[x].status&&$(window.leEngagementButtons[x].engagementId+" .LPMcontainer img").length>0){window.leEngagementButtons[x].rendered=!0;_this.launcher.render($(window.leEngagementButtons[x].engagementId+" .LPMcontainer"),!0)}$(".LPMimage").each(function(index){if($(this).attr("src").indexOf("invitation/need_help_on.gif")>-1&&_this.proactiveLauncherAppended===!1){_this.proactiveLauncherAppended=!0;_this.launcher.render($(this).parent().parent(),!0,{height:$(this).height()+"px"})}})}},0)}else Settings.liveperson.leTag.enabled===!0&&allowLauncherInjection===!0&&setInterval(function(){var updatedSavedEngagement=!1;if(Settings.liveperson.leTag.injectOnLauncher===!1){for(var i=0;i<Settings.liveperson.leTag.engagementButtons.length;i++)if($(Settings.liveperson.leTag.engagementButtons[i]).length>0){$(Settings.liveperson.leTag.engagementButtons[i]+" .LPMcontainer").length>0?window.liveChatStatus="online":0===$(Settings.liveperson.leTag.engagementButtons[i]+" .LPMcontainer").length&&(window.liveChatStatus="offline");break}for(var k=0;k<Settings.liveperson.leTag.engagementButtons.length;k++)if($(Settings.liveperson.leTag.engagementButtons[k]).length>0)if($(Settings.liveperson.leTag.engagementButtons[k]+" .LPMcontainer").length>0){updatedSavedEngagement=!1;window.leEngagementButtons.forEach(function(engagementButton){if(engagementButton.engagementId===Settings.liveperson.leTag.engagementButtons[k]){engagementButton.status="online";updatedSavedEngagement=!0}});updatedSavedEngagement===!1&&window.leEngagementButtons.push({engagementId:Settings.liveperson.leTag.engagementButtons[k],status:"online",rendered:!1})}else if(0===$(Settings.liveperson.leTag.engagementButtons[k]+" .LPMcontainer").length){updatedSavedEngagement=!1;window.leEngagementButtons.forEach(function(engagementButton){if(engagementButton.engagementId===Settings.liveperson.leTag.engagementButtons[k]){engagementButton.status="offline";updatedSavedEngagement=!0}});updatedSavedEngagement===!1&&window.leEngagementButtons.push({engagementId:Settings.liveperson.leTag.engagementButtons[k],status:"offline",rendered:!1})}}},0);Settings.liveperson.leTag.showLauncher===!1&&setInterval(function(){for(var i=0;i<Settings.liveperson.leTag.engagementButtons.length;i++){$(Settings.liveperson.leTag.engagementButtons[i]+" .LPMcontainer img").hide();$(Settings.liveperson.leTag.engagementButtons[i]+" .LPMcontainer").css({background:"none"})}},0);if(window.CVMobile===!0||window.CVVA.popupMode===!0){$(".cv-va-bootstrap #cv-lp-secure-form-container").hide();$(".cv-va-bootstrap #cv-lp-secure-form-panel").removeClass("collapse width");$(".cv-va-bootstrap #cv-lp-secure-form-header a i").removeClass("fa-arrow-circle-right").addClass("fa-arrow-circle-left");$(".cv-va-bootstrap #cv-lp-secure-form-header a").addClass("cv-lp-secure-form-header-icon").on("click",function(e){e.preventDefault();$(".cv-va-bootstrap #cv-lp-secure-form-container").hide()})}else $(".cv-va-bootstrap #cv-lp-secure-form-header a").attr({"data-cv-toggle":"collapse","data-cv-target":"#cv-lp-secure-form-panel","aria-expanded":"false"}).on("click",function(e){e.preventDefault()});$('.cv-va-bootstrap #cv-lp-end-chat-confirmation input[value="Yes"]').on("click",function(){if(Settings.liveperson.surveys.exitSurveysEnabled&&_this.model.get("exitsurvey")){_this.$el.find("#cv-live-chat-user-entry").hide();_this.$el.find("#cv-live-chat-submit").hide();_this.$el.find("#cv-live-chat-answer-history").hide();_this.$el.find("#cv-lp-end-chat-confirmation").hide();_this.$el.find("#cv-chat-loader-layer").show();_this.lpChat.getExitSurvey({surveyName:_this.model.get("exitsurvey"),success:_this.lpChat.handleExitSurvey,error:_this.lpChat.noSurveyRecieved,context:_this.lpChat});_this.lpChat.endChat({success:function(){console.log("ended chat")},disposeVisitor:!0})}else _this.endChat()});$('.cv-va-bootstrap #cv-lp-end-chat-confirmation input[value="No"]').on("click",function(){$(".cv-va-bootstrap #cv-lp-end-chat-confirmation").hide()})}if("true"===localStorage.getItem(Settings.businessName+"-cvVaActiveSession_lp")||"true"===localStorage.getItem(Settings.businessName+"-requestingChat_lp")){setTimeout(function(){_this.configureLiveChat()},1e3);this.render(this.model)}else Settings.lcAvailabilityLauncher===!1&&Settings.liveperson.leTag.enabled===!1&&_this.configureLiveChat();1===_this.$el.find("#cv-lp-survey").length&&_this.rebindSurveyEvents()},configureLiveChat:function(){this.lpChat=new lpTag.taglets.ChatOverRestAPI({lpNumber:Settings.liveperson.accountNumber,appKey:Settings.liveperson.APIKey,onAvailability:$.proxy(this._onAvailability,this),onInfo:$.proxy(this._onInfo,this),onLoad:$.proxy(this._onLoad,this),onInit:$.proxy(this._onInit,this),onLine:$.proxy(this._onLine,this),onState:$.proxy(this._onState,this),onStart:$.proxy(this._onStart,this),onStop:$.proxy(this._onStop,this),onAgentTyping:$.proxy(this._onAgentTyping,this),onRequestChat:$.proxy(this._onRequestChat,this),onCollaboration:$.proxy(this._onCollaboration,this),onPreChatSurvey:$.proxy(this._onPreChatSurvey,this),onOfflineSurvey:$.proxy(this._onOfflineSurvey,this),onExitSurvey:$.proxy(this._onExitSurvey,this)})},render:function(model){var _this=this;_this.model=model;if("true"===localStorage.getItem(Settings.businessName+"-cvVaActiveSession_lp")&&this.activeChatSession===!1||"true"===localStorage.getItem(Settings.businessName+"-requestingChat_lp")){this.activeChatSession=!0;_this.launchLC()}else{var livechatOffer,lpEngagementIDs=model.get(Settings.liveperson.leTag.lpEngagementIdETV)||"",pcsName=(model.get("conversationhistory"),model.get("pcs")),livechatAvailable=!0;""!==lpEngagementIDs&&(lpEngagementIDs=JSON.parse(lpEngagementIDs));if(void 0!==model.get(Settings.livechatOfferETV)&&Settings.liveperson.leTag.enabled===!1){livechatOffer=model.get(Settings.livechatOfferETV).toLowerCase();if("true"===livechatOffer&&this.activeChatSession===!1){"cox"===Settings.businessName&&window.utag&&window.utag.link&&utag.link({eventNames:"cvToChatEscalation"});window.cvCrossStorage.onConnect().then(function(){window.cvCrossStorage.del("cvSessionEndedExternal_VA");localStorage.removeItem("cvSessionEndedExternal_VA");Settings.liveperson.monitoring&&Settings.liveperson.surveys.offlineSurveysEnabled&&model.get("offlinesurvey")&&0===$("#cv-va-le-api-engagement-button").length&&(livechatAvailable=!1);_this.onEstimatedWaitTimeSuccess=function(data){-1===data.estimatedWaitTime&&(livechatAvailable=!1);if(!livechatAvailable&&Settings.liveperson.surveys.offlineSurveysEnabled&&model.get("offlinesurvey"))_this.showOfflineSurvey();else if(Settings.liveperson.surveys.pcsEnabled&&pcsName&&livechatAvailable){_this.$el.find("#cv-chat-user-entry").hide();_this.$el.find("#cv-chat-submit").hide();_this.$el.find("#cv-chat-answer-history").hide();_this.lpChat.getPreChatSurvey({surveyName:pcsName,success:_this.lpChat.populateSurvey,error:_this.lpChat.noSurvey,context:_this.lpChat})}else{window.cvCrossStorage.del(Settings.businessName+"-lpSessionEndedExternal");window.cvCrossStorage.set(Settings.businessName+"-requestingChat_lp","true");localStorage.removeItem(Settings.businessName+"-lpSessionEndedExternal");localStorage.setItem(Settings.businessName+"-requestingChat_lp","true");_this.launchLC()}};_this.onEstimatedWaitTimeError=function(error){console.log(error);window.cvCrossStorage.del(Settings.businessName+"-lpSessionEndedExternal");window.cvCrossStorage.set(Settings.businessName+"-requestingChat_lp","true");localStorage.removeItem(Settings.businessName+"-lpSessionEndedExternal");localStorage.setItem(Settings.businessName+"-requestingChat_lp","true");_this.launchLC()};if(Settings.liveperson.surveys.pcsEnabled&&model.get("pcs"))if(Settings.liveperson.surveys.pcsEnabled&&pcsName){_this.$el.find("#cv-chat-user-entry").hide();_this.$el.find("#cv-chat-submit").hide();_this.$el.find("#cv-chat-answer-history").hide();_this.lpChat.getPreChatSurvey({surveyName:pcsName,success:_this.lpChat.populateSurvey,error:_this.lpChat.noSurvey,context:_this.lpChat})}else{window.cvCrossStorage.del(Settings.businessName+"-lpSessionEndedExternal");window.cvCrossStorage.set(Settings.businessName+"-requestingChat_lp","true");localStorage.removeItem(Settings.businessName+"-lpSessionEndedExternal");localStorage.setItem(Settings.businessName+"-requestingChat_lp","true");_this.launchLC()}else _this.lpChat.getEstimatedWaitTime({skill:model.get("livechatskill"),success:_this.onEstimatedWaitTimeSuccess,error:_this.onEstimatedWaitTimeError,context:_this})})}}else if(void 0!==model.get(Settings.livechatOfferETV)&&Settings.liveperson.leTag.enabled===!0&&("online"===window.liveChatStatus||void 0===window.liveChatStatus)){livechatOffer=model.get(Settings.livechatOfferETV).toLowerCase();_this=this;if("true"===livechatOffer&&this.activeChatSession===!1){var launchLETag=function(){Settings.liveperson.leTag.loadedOnHost===!1&&window.lpTag.start();if(window.lpTag.loaded===!0&&window.lpTag.started===!0&&_this.activeChatSession===!1&&$(".lp_desktop").is(":visible")===!1)setTimeout(function(){_this.activeChatSession=!0;window.leTagContainerInterval=setInterval(function(){for(var i=0;i<lpEngagementIDs.length;i++)if($(lpEngagementIDs[i]).length>0&&$(lpEngagementIDs[i]+" .LPMcontainer").length>0){$(lpEngagementIDs[i]+" .LPMcontainer").trigger("click");break}},0);window.leTagClearInterval=setInterval(function(){if($(".lp_desktop").is(":visible")===!0){window.clearInterval(window.leTagContainerInterval);if(Settings.liveperson.leTag.closeVAOnLaunch===!0){$("#cv-chat-container").modal("hide");void 0!==_this.launcher&&_this.launcher.hide();if(window.forcesessionclose===!0){window.resetVA();
window.forcesessionclose=void 0}}window.clearInterval(window.leTagClearInterval)}},0)},500);else if(_this.activeChatSession===!1&&$(".lp_desktop").is(":visible")===!1)setTimeout(function(){launchLETag()},0);else if($(".lp_desktop").is(":visible")===!0&&Settings.liveperson.leTag.closeVAOnLaunch===!0){_this.launcher.remove();$("#cv-chat-container").modal("hide");setTimeout(function(){if(window.forcesessionclose===!0){window.resetVA();window.forcesessionclose=void 0}},500)}};launchLETag()}}}},_onAvailability:function(data){if(data.availability===!0&&this.launcherAppended===!1&&Settings.lcAvailabilityLauncher===!0){this.launcherAppended=!0;this.launcher.render(Settings.appendLauncherTo)}},_onLoad:function(data){},_onInit:function(data){var _this=this;Settings.launcherInjection===!0&&Settings.lcAvailabilityLauncher===!0&&setInterval(function(){_this.lpChat.getAvailabilty({maxWaitTime:0})},Settings.availabiltyInterval)},_onInfo:function(data){this.refreshTimeout();void 0!==data.agentName&&""!==data.agentName.trim()&&(this.agentName=data.agentName)},_onLine:function(data){console.log(data);var _this=this;this.refreshTimeout();this.saveLpSessionVariables();for(var i=0;i<data.lines.length;i++){var $transaction,dt,time,lpTimestamp,line=data.lines[i];if(0!==line.systemMessageId&&"0"!==line.systemMessageId&&line.text&&0!==line.text.length){if(line.time){lpTimestamp=new Date(line.time);time=lpTimestamp.getHours()+":"+(lpTimestamp.getMinutes()<10?"0":"")+lpTimestamp.getMinutes()}else{dt=new Date;time=dt.getHours()+":"+(dt.getMinutes()<10?"0":"")+dt.getMinutes()}if("visitor"!==line.source){$transaction=$("<div>").addClass("cv-live-chat-info");$transaction.html(line.text.replace("<div","<span").replace("</div>","</span>"));this.$el.find("#cv-live-chat-answer-history").append($transaction);if("system"==line.source){$transaction.addClass("cv-live-chat-system");Settings.lcTimeStamp!==!0&&(time="");$transaction.after('<span class="time-stamp-system">Info&nbsp'+time+"</span>")}if("agent"==line.source){$transaction.addClass("cv-live-chat-agent");this.$el.find(".cv-live-chat-agent").last().wrap('<div class="col-xs-12"></div>');this.$el.find(".cv-live-chat-agent").last().after('<span class="time-stamp-info">'+line.by+"&nbsp"+time+"</span>");this.$el.find(".cv-live-chat-agent").addClass("ts-shim")}if(!this.$el.find("#cv-live-chat-answer-history").is(":visible")){this.newLines++;this.$el.find(".cv-live-chat-active-title").html('<i class="fa fa-arrow-left" aria-hidden="true"></i> <span style="margin-right:10px;">Back to Live Chat </span>'+this.newLines+' <i class="fa fa-comment lc-fa-comment" aria-hidden="true"></i>');Settings.vaLcTabs===!0&&this.$el.find("#lc-tab a").html("Live Chat "+this.newLines+' <i class="fa fa-comment" aria-hidden="true"></i><i class="fa fa-times lc-close-btn"></i></a>')}}else{$transaction=$("<div>").addClass("cv-live-chat-user");$transaction.html(line.text);this.$el.find("#cv-live-chat-answer-history").append($transaction);this.$el.find(".cv-live-chat-user").last().wrap('<div class="col-xs-12"></div>');if("visitor"==line.source){this.$el.find(".cv-live-chat-user").last().after('<span class="time-stamp-user">You '+time+"</span>");this.$el.find(".cv-live-chat-user").addClass("ts-shim")}}}}"none"===_this.$el.find("#cv-live-chat-answer-history").css("display")?setTimeout(function(){_this.$el.find("#cv-live-chat-answer-history").show();_this.$el.find("#cv-live-chat-answer-history").scrollTo("max",{duration:0,onAfter:function(){_this.$el.find("#cv-chat-loader-layer").hide()}})},300):_this.$el.find("#cv-live-chat-answer-history").scrollTo("max",{duration:500})},_onState:function(data){this.chatState=data.state;this.saveLpSessionVariables()},_onStart:function(data){var _this=this;this.$el.find("#cv-chat-user-entry").parent().append('<input id="'+this.entryID+'" type="text" name="entry" autocomplete="off" class="form-control cv-chat-user-entry" style="display: none;" placeholder="'+Settings.defaultPlaceholderText+'">');Settings.liveperson.cursorAtEndOnFocus===!0&&_this.$el.find("#cv-live-chat-user-entry").focus(function(event){var that=this;if(_this.$el.find("#cv-live-chat-user-entry")[0].scrollWidth>_this.$el.find("#cv-live-chat-user-entry").innerWidth()){setTimeout(function(){that.setSelectionRange(that.value.length,that.value.length)},0);$(this).scrollLeft(1e4)}});(this.$el.find("#cv-live-chat-answer-history").is(":visible")||Settings.vaLcTabs===!1)&&this.$el.find("#"+this.entryID).show();this.$el.find("#"+this.entryID).css({"font-size":Settings.inputFontSize,"border-radius":Settings.inputBorderRadius});this.$el.find("#"+this.entryID).keyup(function(event){_this.keyPress(event,_this)});$(".lc-close-btn").on("click",function(e){e.preventDefault();_this.endChat()})},_onStop:function(data){console.log("onstop");var _this=this;this.activeChatSession=!1;window.cvCrossStorage.onConnect().then(function(){return window.cvCrossStorage.del(Settings.businessName+"-cvVaActiveSession_lp",Settings.businessName+"-cvLpVisitorChatRels",Settings.businessName+"-cvLpVisitorResumeMode",Settings.businessName+"-cvLpVisitorSessionVars")}).then(function(){localStorage.removeItem(Settings.businessName+"-cvVaActiveSession_lp");sessionStorage.removeItem("lpVisitorChatRels"+Settings.liveperson.accountNumber);sessionStorage.removeItem("lpVisitorResumeMode"+Settings.liveperson.accountNumber);sessionStorage.removeItem("lpVisitorSessionVars"+Settings.liveperson.accountNumber);if(_this.userCloseLC!==!0){window.cvCrossStorage.onConnect().then(function(){return window.cvCrossStorage.set(Settings.businessName+"-lpSessionEndedExternal","true")});localStorage.setItem(Settings.businessName+"-lpSessionEndedExternal","true")}_this.saveLpSessionVariables()});this.$el.find("#cv-live-chat-submit").prop("disabled",!0);this.$el.find("#cv-live-chat-user-entry").remove()},_onAgentTyping:function(data){this.$el.find("#cv-chat-form").before('<span class="cv-live-chat-agent-typing">'+this.agentName+" is typing...</span>");data.agentTyping===!0&&this.$el.find("#cv-live-chat-user-entry").is(":visible")?this.$el.find(".cv-live-chat-agent-typing").show():this.$el.find(".cv-live-chat-agent-typing").remove()},_onRequestChat:function(data){var $transaction,dt,time,previous,current,lastLine,_this=this;if(data.error){if(Settings.liveperson.surveys.offlineSurveysEnabled&&_this.model.get("offlinesurvey"))_this.showOfflineSurvey();else{$transaction=$("<div>").addClass("cv-live-chat-info");$transaction.html(decodeURIComponent(Settings.liveperson.unavailableMessage));$transaction.addClass("cv-live-chat-system");_this.$el.find("#cv-live-chat-answer-history").show();this.$el.find("#cv-live-chat-answer-history").append($transaction);dt=new Date;time="";Settings.lcTimeStamp===!0&&(time=dt.getHours()+":"+(dt.getMinutes()<10?"0":"")+dt.getMinutes());$transaction.after('<span class="time-stamp-system">Info&nbsp'+time+"</span>");previous=this.$el.find(".cv-live-chat-info").get(-2);current=$(previous).next(".cv-live-chat-info");$(current).remove("div");lastLine=$(current).text();$(previous).append('<br><span dir="ltr">'+lastLine+"</span>")}window.cvCrossStorage.onConnect().then(function(){window.cvCrossStorage.del(Settings.businessName+"-requestingChat_lp",Settings.businessName+"-cvVaActiveSession_lp",Settings.businessName+"-cvLpVisitorChatRels",Settings.businessName+"-cvLpVisitorResumeMode",Settings.businessName+"-cvLpVisitorSessionVars");return window.cvCrossStorage.set(Settings.businessName+"-lpSessionEndedExternal","true")});localStorage.removeItem(Settings.businessName+"-requestingChat_lp");localStorage.removeItem(Settings.businessName+"-cvVaActiveSession_lp");sessionStorage.removeItem("lpVisitorChatRels"+Settings.liveperson.accountNumber);sessionStorage.removeItem("lpVisitorResumeMode"+Settings.liveperson.accountNumber);sessionStorage.removeItem("lpVisitorSessionVars"+Settings.liveperson.accountNumber);localStorage.setItem(Settings.businessName+"-lpSessionEndedExternal","true")}else{_this.activeChatSession=!0;window.cvCrossStorage.onConnect().then(function(){window.cvCrossStorage.del(Settings.businessName+"-requestingChat_lp");return window.cvCrossStorage.set(Settings.businessName+"-cvVaActiveSession_lp","true")});localStorage.removeItem(Settings.businessName+"-requestingChat_lp");localStorage.setItem(Settings.businessName+"-cvVaActiveSession_lp","true");Settings.vaLcTabs===!1&&this.$el.find("#cv-chat-answer-history").hide()}this.$el.find("#cv-chat-loader-layer").hide();console.log(data)},_onCollaboration:function(data){var _this=this;console.log(data);if("leSecureForm"===data.collaboration[0].subType&&"send"===data.collaboration[0].command){window.CVMobile===!0||window.CVVA.popupMode===!0?_this.$el.find("#cv-lp-secure-form-container").hide():_this.$el.find("#cv-lp-secure-form-panel").collapse("hide");_this.$el.find("#cv-lp-secure-form-body").empty();var $transaction,dt,time,eventId=data.collaboration[0]["@id"],siteId=Settings.liveperson.accountNumber,chatId=data.collaboration[0].info.chatId,submitOtk=data.collaboration[0].info.submitOtk,formOtk=data.collaboration[0].info.getOtk,uniqueId=data.collaboration[0].info.uniqueId,secureFormName=data.collaboration[0].info.secureFormName,secureFormId=data.collaboration[0].info.secureFormId,secureFormIframe='<iframe class="lp_secure_form_iframe" src="https://tokenizer.liveperson.net/pcigw/pci_dynamic_le.jsp?siteid=SITEIDVAR&amp;redirect=https%3A%2F%2Ftokenizer.liveperson.net%2Fpcigw%2Fpci_dynamic_submitted_le.html&amp;css=%257B%25221%2522%253A%257B%2522bc%2522%253A%2522%2523FFFFFF%2522%252C%2522f%2522%253A%2522Arial%252CHelvetica%252Csans-serif%2522%252C%2522c%2522%253A%2522%25236D6E70%2522%257D%252C%25222%2522%253A%257B%2522bc%2522%253A%2522%25230363ad%2522%252C%2522c%2522%253A%2522%2523FFFFFF%2522%257D%257D&amp;hideLogo=false&amp;otkJson={&quot;siteId&quot;:&quot;SITEIDVAR&quot;,&quot;chatId&quot;:&quot;CHATIDVAR&quot;}&amp;lang=en-US&amp;otk=SUBMITOTKVAR&amp;formOtk=FORMOTKVAR" aria-label="Credit Card Information" style="width: 100%; height: 100%; display: block;" frameBorder="0"></iframe>';secureFormIframe=secureFormIframe.replace(/SITEIDVAR/g,siteId).replace("CHATIDVAR",chatId).replace("SUBMITOTKVAR",submitOtk).replace("FORMOTKVAR",formOtk);_this.$el.find("#cv-lp-secure-form-body").append(secureFormIframe);_this.lpChat.sendCollaboration({command:"received",subType:"leSecureForm",info:{uniqueId:uniqueId,secureFormName:secureFormName,secureFormId:secureFormId,sequenceId:eventId}});$transaction=$("<div>").addClass("cv-live-chat-info");var $atag=$("<a>").attr("href","#").text(data.collaboration[0].info.secureFormName);window.CVMobile===!1&&window.CVVA.popupMode===!1&&$atag.attr({"data-cv-toggle":"collapse","data-cv-target":"#cv-lp-secure-form-panel","aria-expanded":"false"});$transaction.html(data.collaboration[0].by+" has sent you a Secure Form: ").append($atag);$transaction.find("a").on("click",function(e){e.preventDefault();if($(this).data("loaded"))(window.CVMobile===!0||window.CVVA.popupMode===!0)&&$("#cv-lp-secure-form-container").show();else{$(this).data("loaded","true");(window.CVMobile===!0||window.CVVA.popupMode===!0)&&$("#cv-lp-secure-form-container").show();window.removeEventListener("message",_this.pciSecureFormListener,!1);_this.pciSecureFormListener=function(event){var data;"object"==typeof event.data?data=event.data:"string"==typeof event.data&&(data=JSON.parse(event.data));"https://tokenizer.liveperson.net"===event.origin&&console.log(data);if("https://tokenizer.liveperson.net"===event.origin&&data.state)if("viewed"===data.state)_this.lpChat.sendCollaboration({command:"viewed",subType:"leSecureForm",info:{uniqueId:uniqueId,secureFormName:secureFormName,secureFormId:secureFormId,sequenceId:eventId}});else if("submit"===data.state&&data.token){_this.lpChat.sendCollaboration({command:"submit",subType:"leSecureForm",info:{uniqueId:uniqueId,secureFormName:secureFormName,secureFormId:secureFormId,sequenceId:eventId,formUuid:data.token,gatewayDomain:data.gatewayDomain}});window.removeEventListener("message",_this.pciSecureFormListener,!1);_this.$el.find("#cv-lp-secure-form-body").empty().append('<div style="text-align: center;position: relative;top: 43%;transform: translateY(-50%);"><i class="fa fa-lock" aria-hidden="true"style="font-size: 38px;"></i><p>The form has been submitted successfully. </br> To protect your information, submitted forms cannot be reopened.</p></div>');setTimeout(function(){window.CVMobile===!0||window.CVVA.popupMode===!0?_this.$el.find("#cv-lp-secure-form-container").hide():_this.$el.find("#cv-lp-secure-form-panel").collapse("hide")},2e3)}};window.addEventListener("message",_this.pciSecureFormListener,!1)}});_this.$el.find("#cv-live-chat-answer-history").append($transaction);$transaction.addClass("cv-live-chat-agent");_this.$el.find(".cv-live-chat-agent").last().wrap('<div class="col-xs-12"></div>');dt=new Date;time="";time=dt.getHours()+":"+(dt.getMinutes()<10?"0":"")+dt.getMinutes();_this.$el.find(".cv-live-chat-agent").last().after('<span class="time-stamp-info">'+data.collaboration[0].by+"&nbsp"+time+"</span>");_this.$el.find(".cv-live-chat-agent").addClass("ts-shim");if(!_this.$el.find("#cv-live-chat-answer-history").is(":visible")){_this.newLines++;_this.$el.find(".cv-live-chat-active-title").html('<i class="fa fa-arrow-left" aria-hidden="true"></i> <span style="margin-right:10px;">Back to Live Chat </span>'+_this.newLines+' <i class="fa fa-comment lc-fa-comment" aria-hidden="true"></i>');Settings.vaLcTabs===!0&&_this.$el.find("#lc-tab a").html("Live Chat "+_this.newLines+' <i class="fa fa-comment" aria-hidden="true"></i><i class="fa fa-times lc-close-btn"></i></a>')}_this.$el.find("#cv-live-chat-answer-history").scrollTo(_this.$el.find("#cv-live-chat-answer-history").children().get(-1),500)}},_onPreChatSurvey:function(data){var _this=this;console.log(data);_this.$el.find("#cv-lp-survey").remove();_this.$el.find("#cv-chat-body").append('<div id="cv-lp-survey" data-survey-type="pcs" data-survey-id="'+data.survey.id+'" class="cv-chat-history"></div>');_this.renderQuestions(data.survey.questions||{},"pcs",data.survey.header,data.survey.id)},_onOfflineSurvey:function(data){var _this=this;console.log(data);_this.$el.find("#cv-lp-survey").remove();_this.$el.find("#cv-chat-body").append('<div id="cv-lp-survey" data-survey-type="offlinesurvey" data-survey-id="'+data.survey.id+'" class="cv-chat-history"></div>');_this.renderQuestions(data.survey.questions||{},"offlineSurvey",data.survey.header,data.survey.id)},_onExitSurvey:function(data){var _this=this;console.log(data);_this.$el.find("#cv-chat-loader-layer").hide();_this.$el.find("#cv-lp-survey").remove();_this.$el.find("#cv-chat-body").append('<div id="cv-lp-survey" data-survey-type="exitsurvey" data-survey-id="'+data.survey.id+'" class="cv-chat-history"></div>');_this.renderQuestions(data.survey.questions||{},"exitSurvey",data.survey.header,data.survey.id)},launchLC:function(surveyData){var _this=this,vaTranscript=(_this.model.get(Settings.liveperson.leTag.lpEngagementIdETV)||"",_this.model.get("conversationhistory"));if(window.livechatTriggered!==!0){_this.livechatrendered=!0;_this.$el.find("#cv-chat-user-entry").hide();_this.$el.find("#cv-chat-submit").hide();_this.$el.find("#cv-chat-submit").parent().append('<button id="'+_this.submitID+'" type="submit" class="btn btn-primary btn-lg btn-block small-border-radius" disabled="disabled">'+Settings.submitBtn.text+"</button>");_this.$el.find("#"+_this.submitID).css({"background-color":Settings.submitBtn.backgroundColor,"border-color":Settings.submitBtn.backgroundColor,"border-radius":Settings.inputBorderRadius,"font-weight":Settings.submitBtn.fontWeight,"font-size":Settings.submitBtn.fontSize});Settings.submitBtn.disabled.opacity===!0&&_this.$el.find("#"+_this.submitID+"[disabled]").css({opacity:1});_this.$el.find(".cv-chat-title").animate({color:Settings.modalHeader.backgroundColor},"fast");setTimeout(function(){var lpOverlay=function(){var that=_this;_this.$el.find("#cv-chat-answer-history").hide();console.log("added cv live chat");_this.$el.find("#cv-chat-loader-layer").show();_this.$el.find("#cv-chat-body").append('<div id="cv-live-chat-answer-history" style="display:none;" class="cv-chat-history"></div>');if(Settings.vaLcTabs===!0){that.$el.find("#cv-chat-header").after('<ul class="row cv-va-tabs-container nav nav-tabs"></ul>');that.$el.find(".cv-va-tabs-container").append('<li id="va-tab" class="col-xs-6"><span>Virtual Agent</span></li>');that.$el.find(".cv-va-tabs-container").append('<li id="lc-tab" class="active col-xs-6"><span>Live Chat<i class="fa fa-times lc-close-btn"></i></span></li>');var terminateLCsessionCloseTab=function(){_this.endChat();that.$el.find("#va-tab").trigger("click");that.$el.find("#lc-tab, #cv-live-chat-answer-history, #cv-live-chat-submit, #cv-live-chat-user-entry").remove();_this.$el.find(".cv-va-tabs-container").hide(100);_this.$el.find(".cv-va-tabs-container").remove()};that.$el.find(".lc-close-btn").on("click",function(e){e.preventDefault();terminateLCsessionCloseTab()});that.$el.find("#va-tab").click(function(){that.newLines=0;that.$el.find("#va-tab").addClass("active");that.$el.find("#lc-tab").removeClass("active");that.$el.find("#cv-chat-user-entry").show();that.$el.find("#cv-chat-submit").show();that.$el.find("#cv-chat-submit").removeClass("disabled").addClass("enabled");that.$el.find("#"+_this.entryID).hide();that.$el.find("#"+_this.submitID).hide();that.$el.find(".cv-chat-va-typing").show();that.$el.find(".cv-live-chat-agent-typing").hide();that.$el.find("#cv-live-chat-answer-history").hide();that.$el.find("#cv-chat-answer-history").show();that.$el.find(".lc-close-btn").on("click",function(e){e.preventDefault();terminateLCsessionCloseTab()})});that.$el.find("#lc-tab").click(function(e){e.preventDefault();that.newLines=0;that.$el.find("#lc-tab a").html('Live Chat<i class="fa fa-times lc-close-btn"></i>');that.$el.find(".lc-close-btn").on("click",function(e){e.preventDefault();terminateLCsessionCloseTab()});that.$el.find("#lc-tab").addClass("active");that.$el.find("#va-tab").removeClass("active");that.$el.find("#"+_this.entryID).show();that.$el.find("#"+_this.submitID).show();that.$el.find("#cv-chat-submit").removeClass("enabled").addClass("disabled").prop("disabled","true");that.$el.find("#cv-chat-submit").hide();that.$el.find("#cv-chat-user-entry").hide();that.$el.find(".cv-chat-va-typing").hide();that.$el.find(".cv-live-chat-agent-typing").show();that.$el.find("#cv-live-chat-answer-history").show();that.$el.find("#cv-chat-answer-history").hide()})}else if(Settings.vaLcTabs===!1&&Settings.terminateVASession===!1){that.$el.find(".cv-chat-title").removeClass("cv-chat-title").addClass("cv-live-chat-active-title").html('<i class="fa fa-arrow-left" aria-hidden="true"></i> Back to Virtual Assistant');that.$el.find(".cv-live-chat-active-title").css({color:Settings.modalHeader.color});that.$el.find("#cv-chat-header .close").css({color:Settings.modalHeader.color,opacity:1});that.$el.find("#cv-chat-header").css({"background-color":Settings.modalHeader.backgroundColor});that.$el.find(".cv-live-chat-active-title").fadeIn();that.$el.find(".cv-live-chat-active-title").click(function(){that.newLines=0;if(that.livechatrendered){that.$el.find(".cv-live-chat-active-title").html('<i class="fa fa-arrow-left" aria-hidden="true"></i> Back to Live Chat');var connectors=_this.model.get("connectors");if(_.isArray(connectors)&&connectors.length){that.$el.find("#cv-chat-user-entry").hide();that.$el.find("#cv-chat-submit").removeClass("disabled").removeAttr("disabled")}else{that.$el.find("#cv-chat-submit").addClass("disabled").prop("disabled","true");that.$el.find("#cv-chat-user-entry").show()}that.$el.find("#cv-chat-submit").show();that.$el.find("#cv-chat-user-entry").val().trim().length>0||!that.$el.find("#cv-chat-user-entry").is(":visible")?that.$el.find("#cv-chat-submit").removeClass("disabled").addClass("enabled"):that.$el.find("#cv-chat-submit").removeClass("enabled").addClass("disabled");that.$el.find("#"+_this.entryID).hide();that.$el.find("#"+_this.submitID).hide()}else{that.$el.find(".cv-live-chat-active-title").html('<i class="fa fa-arrow-left" aria-hidden="true"></i> Back to Virtual Assistant');that.$el.find("#cv-chat-user-entry").hide();that.$el.find("#cv-chat-submit").hide();that.$el.find("#cv-chat-submit").removeClass("enabled").addClass("disabled").prop("disabled","true");that.activeChatSession?that.$el.find("#"+_this.entryID).show():that.$el.find("#"+_this.entryID).hide();that.$el.find("#"+_this.submitID).show()}that.$el.find(".cv-chat-va-typing").toggle();that.$el.find(".cv-live-chat-agent-typing").toggle();that.$el.find("#cv-live-chat-answer-history").animate({opacity:"toggle"},"fast",function(){that.$el.find("#cv-chat-answer-history").animate({opacity:"toggle"},"fast")});that.livechatrendered=!that.livechatrendered})}else if(Settings.vaLcTabs===!1&&Settings.terminateVASession===!0){clearInterval(window.proactiveEndSessionInterval);if(that.activeChatSession)var showLCinput=setInterval(function(){if(that.$el.find("#"+that.entryID).length>0){that.$el.find("#"+that.entryID).show();clearInterval(showLCinput)}},20)}var preChatLinesArr=[];if(vaTranscript){var parseS;parseS=JSON.parse(vaTranscript);preChatLinesArr.push("-----VA Transcript begins-----<br>");for(var trans in parseS){if(parseS[trans].user_entry){preChatLinesArr.push("Visitor");preChatLinesArr.push("<p>"+parseS[trans].user_entry+"</p>")}if(parseS[trans].response_text){preChatLinesArr.push("Virtual Agent");var vaResponse=parseS[trans].response_text.replace(/<p>/g,"").replace(/<\/p>/g,"");preChatLinesArr.push("<p>"+vaResponse+"</p>")}}preChatLinesArr.push("-----VA Transcript ends-----")}if("true"!==localStorage.getItem(Settings.businessName+"-cvVaActiveSession_lp"))if(Settings.liveperson.monitoring===!0){window.initializeEngagementData=function(engagementData){console.log(engagementData);var chatVariables;chatVariables=preChatLinesArr.length>0?{preChatLines:preChatLinesArr,skill:_this.model.get("livechatskill"),LETagVisitorId:engagementData.svid,LETagSessionId:engagementData.ssid,LETagContextId:engagementData.scid}:{skill:_this.model.get("livechatskill"),LETagVisitorId:engagementData.svid,LETagSessionId:engagementData.ssid,LETagContextId:engagementData.scid};Settings.liveperson.surveys.pcsEnabled&&surveyData&&(chatVariables.survey=surveyData);_this.lpChat.requestChat(chatVariables)};if($("#cv-va-le-api-engagement-button").length>0)$("#cv-va-le-api-engagement-button").trigger("click");else{_this.$el.find("#cv-chat-loader-layer").hide();_this.$el.find("#cv-live-chat-answer-history").show();if(Settings.liveperson.surveys.offlineSurveysEnabled&&_this.model.get("offlinesurvey"))_this.showOfflineSurvey();else{var agentUnavailableMsg=$("<div>").addClass("cv-live-chat-info");agentUnavailableMsg.html(decodeURIComponent(Settings.liveperson.unavailableMessage));agentUnavailableMsg.addClass("cv-live-chat-system");_this.$el.find("#cv-live-chat-answer-history").append(agentUnavailableMsg);dt=new Date;time="";Settings.lcTimeStamp===!0&&(time=dt.getHours()+":"+(dt.getMinutes()<10?"0":"")+dt.getMinutes());agentUnavailableMsg.after('<span class="time-stamp-system">Info&nbsp'+time+"</span>");previous=_this.$el.find(".cv-live-chat-info").get(-2);current=$(previous).next(".cv-live-chat-info");$(current).remove("div");lastLine=$(current).text();$(previous).append('<br><span dir="ltr">'+lastLine+"</span>")}window.cvCrossStorage.onConnect().then(function(){window.cvCrossStorage.del(Settings.businessName+"-requestingChat_lp",Settings.businessName+"-cvVaActiveSession_lp",Settings.businessName+"-cvLpVisitorChatRels",Settings.businessName+"-cvLpVisitorResumeMode",Settings.businessName+"-cvLpVisitorSessionVars");return window.cvCrossStorage.set(Settings.businessName+"-lpSessionEndedExternal","true")});localStorage.removeItem(Settings.businessName+"-requestingChat_lp");localStorage.removeItem(Settings.businessName+"-cvVaActiveSession_lp");sessionStorage.removeItem("lpVisitorChatRels"+Settings.liveperson.accountNumber);sessionStorage.removeItem("lpVisitorResumeMode"+Settings.liveperson.accountNumber);sessionStorage.removeItem("lpVisitorSessionVars"+Settings.liveperson.accountNumber);localStorage.setItem(Settings.businessName+"-lpSessionEndedExternal","true")}}else{var chatVariables;chatVariables=preChatLinesArr.length>0?{preChatLines:preChatLinesArr,skill:_this.model.get("livechatskill")}:{skill:_this.model.get("livechatskill")};Settings.liveperson.surveys.pcsEnabled&&surveyData&&(chatVariables.survey=surveyData);_this.lpChat.requestChat(chatVariables)}};lpOverlay()},1e3)}},createDivWrapper:function(question){var questionType,divWrapper=document.createElement("DIV");divWrapper.className="lp_question form-group";divWrapper.setAttribute("id",this.surveyPrefixes.question+question.id);divWrapper.dataset.validationType=question.validationType;var label=document.createElement("DIV");questionType="Text Field"===question.type?"textfield":"Text Area"===question.type?"textarea":"Dropdown Box"===question.type?"dropdownbox":"Radio Button"===question.type?"radiobutton":"Radio Button (side by side)"===question.type?"radiobuttonh":"checkbox";divWrapper.dataset.questionType=questionType;if(question.mandatory){var sp=document.createElement("SPAN");sp.innerHTML="*";sp.className="mandatory";label.appendChild(sp);divWrapper.className+=" cv-lp-required";var $requireDiv=document.createElement("DIV");$requireDiv.className="cv-lp-required-input";$requireDiv.innerHTML="Required!";$requireDiv.style.display="none";divWrapper.insertBefore($requireDiv,divWrapper.childNodes[0])}label.appendChild(document.createTextNode(question.label));divWrapper.appendChild(label);return divWrapper},bindEventElement:function(element,eventName,callback){element.addEventListener?element.addEventListener(eventName,callback,!1):element.attachEvent("on"+eventName,callback)},selectBind:function(e,selectElement,id){$("#"+this.surveyPrefixes.question+id).find(".cv-lp-required-input").hide()},renderSelect:function(question){var _this=this,selectElement=document.createElement("SELECT");selectElement.className="form-control";var answerArray=[{value:"Choose one..."}];answerArray=answerArray.concat(question.entry);for(var i=0;i<answerArray.length;i++){var entry=answerArray[i],option=document.createElement("OPTION");option.setAttribute("value",entry.value);option.innerHTML=entry.value;(entry.checked===!0||"true"==entry.checked)&&option.setAttribute("selected","selected");selectElement.appendChild(option)}_this.bindEventElement(selectElement,"change",function(e){_this.selectBind(e,selectElement,question.id)});return selectElement},createRandomId:function(prefix){return prefix+Math.floor(1e4*Math.random())+"_"+Math.floor(1e4*Math.random())},renderCheckbox:function(question,container){for(var _this=this,i=0;i<question.entry.length;i++){var entry=question.entry[i],id=_this.createRandomId("cb"),$wrapper=document.createElement("DIV");$wrapper.className="form-check checkbox-wrapper";var cb=document.createElement("input");cb.setAttribute("type","checkbox");cb.setAttribute("value",entry.value);cb.setAttribute("name",_this.surveyPrefixes.checkbox+question.id);cb.setAttribute("id",id);(entry.checked===!0||"true"==entry.checked)&&cb.setAttribute("checked","checked");$wrapper.appendChild(cb);var lbl=document.createElement("LABEL");lbl.innerHTML=entry.value;lbl.setAttribute("for",id);$wrapper.appendChild(lbl);container.appendChild($wrapper)}_this.bindEventElement(container,"click",function(e){_this.bindCheckboxes(question.id)});return container},bindCheckboxes:function(id){for(var _this=this,values=[],elements=document.getElementsByName(_this.surveyPrefixes.checkbox+id),i=0;i<elements.length;i++)(elements[i].checked||1==elements[i].getAttribute("checked")||"checked"==elements[i].getAttribute("checked"))&&values.push(elements[i].value);$("#"+_this.surveyPrefixes.question+id).find(".cv-lp-required-input").hide()},renderRadioButtons:function(question,container){console.log("renderRadioButtons");for(var _this=this,i=0;i<question.entry.length;i++){var entry=question.entry[i],id=_this.createRandomId("rb"),$wrapper=document.createElement("DIV");$wrapper.className="form-check checkbox-wrapper";var rb=document.createElement("input");rb.setAttribute("type","radio");rb.setAttribute("value",entry.value);rb.setAttribute("name",_this.surveyPrefixes.radioButton+question.id);rb.setAttribute("id",id);(entry.checked===!0||"true"==entry.checked)&&rb.setAttribute("checked","checked");$wrapper.appendChild(rb);var lbl=document.createElement("LABEL");lbl.innerHTML=entry.value;lbl.setAttribute("for",id);$wrapper.appendChild(lbl);container.appendChild($wrapper)}_this.bindEventElement(container,"click",function(e){_this.bindRadioButtons(e,question.id)});return container},bindRadioButtons:function(e,id){console.log("bindRadioButtons");var _this=this;e=e||event;var value,src=e.target||e.srcElement;src.value?value=src.value:"LABEL"===src.nodeName&&(value=document.getElementById(src.getAttribute("for")).value);value&&$("#"+_this.surveyPrefixes.question+id).find(".cv-lp-required-input").hide()},renderTextArea:function(question){console.log("renderTextArea");var _this=this,textArea=document.createElement("TEXTAREA");textArea.className="form-control";question.lastKnownValue&&(textArea.value=question.lastKnownValue);_this.bindEventElement(textArea,"keyup",function(){$("#"+_this.surveyPrefixes.question+question.id).find(".cv-lp-required-input").hide()});return textArea},renderInputText:function(question){console.log("renderInputText");var _this=this,input=document.createElement("INPUT");"email"===question.validationType?input.setAttribute("type","email"):input.setAttribute("type","text");question.lastKnownValue&&(input.value=question.lastKnownValue);_this.bindEventElement(input,"keyup",function(){$("#"+_this.surveyPrefixes.question+question.id).find(".cv-lp-required-input").hide()});return input},addSubmitButtonPCS:function(surveyId){var _this=this,btn=document.createElement("BUTTON");btn.innerHTML="Submit";_this.bindEventElement(btn,"click",function(){_this.bindSubmitButtonPCS(surveyId)});btn.className="surveyBtn btn";_this.$el.find("#cv-lp-btn-group").append(btn)},bindSubmitButtonPCS:function(surveyId){var _this=this;_this.validateSurvey()&&window.cvCrossStorage.onConnect().then(function(){var surveyData=_this.getSurveyDataJSON("pcs",surveyId);window.cvCrossStorage.del(Settings.businessName+"-lpSessionEndedExternal");window.cvCrossStorage.set(Settings.businessName+"-requestingChat_lp","true");localStorage.removeItem(Settings.businessName+"-lpSessionEndedExternal");localStorage.setItem(Settings.businessName+"-requestingChat_lp","true");_this.$el.find("#cv-chat-loader-layer").show();_this.$el.find("#cv-lp-survey").remove();window.CVSaveAttributes();_this.launchLC(surveyData)})},rebindSurveyEvents:function(){var _this=this,survey=_this.$el.find("#cv-lp-survey"),surveyType=survey.data("survey-type"),surveyId=survey.data("survey-id"),submitButton=_this.$el.find("#cv-lp-survey .surveyBtn").get(0);_this.bindEventElement(submitButton,"click",function(){1===survey.length&&("pcs"===surveyType?_this.bindSubmitButtonPCS(surveyId):"offlinesurvey"===surveyType?_this.bindSubmitButtonOfflineSurvey(surveyId):"exitsurvey"===surveyType&&_this.bindSubmitButtonExitSurvey(surveyId))});survey.find("input, textarea, select").on("change keyup",function(){$(this).closest(".lp_question").find(".cv-lp-required-input").hide()})},addCancelButtonPCS:function(text){},addSubmitButtonOfflineSurvey:function(surveyId){var _this=this,btn=document.createElement("BUTTON");btn.innerHTML="Submit";this.bindEventElement(btn,"click",function(){_this.bindSubmitButtonOfflineSurvey(surveyId)});btn.className="surveyBtn btn";_this.$el.find("#cv-lp-btn-group").append(btn)},bindSubmitButtonOfflineSurvey:function(surveyId){var _this=this;if(_this.validateSurvey()){_this.lpChat.submitOfflineSurvey({survey:_this.getSurveyDataJSON("offlineSurvey",surveyId),success:_this.lpChat.offlineSurveySubmitted,
error:_this.lpChat.offlineSubmitFailed,context:_this.lpChat});_this.$el.find("#cv-lp-survey").html("<p>"+Settings.liveperson.surveys.submittedSurveyMsg+"<p>").css({"text-align":"center",display:"flex",display:"-webkit-flex","justify-content":"center","flex-direction":"column","-webkit-flex-direction":"column"})}},addCancelButtonOfflineSurvey:function(text){},addSubmitButtonExitSurvey:function(surveyId){var _this=this,btn=document.createElement("BUTTON");btn.innerHTML="Submit";this.bindEventElement(btn,"click",function(){_this.bindSubmitButtonExitSurvey(surveyId)});btn.className="surveyBtn btn";_this.$el.find("#cv-lp-btn-group").append(btn)},bindSubmitButtonExitSurvey:function(surveyId){var _this=this;if(_this.validateSurvey()){_this.lpChat.submitExitSurvey({survey:_this.getSurveyDataJSON("exitSurvey",surveyId),success:_this.lpChat.exitSurveySubmitted,error:_this.lpChat.exitSurveyFailed,context:_this.lpChat});_this.$el.find("#cv-lp-survey").html("<p>"+Settings.liveperson.surveys.submittedSurveyMsg+"<p>").css({"text-align":"center",display:"flex",display:"-webkit-flex","justify-content":"center","flex-direction":"column","-webkit-flex-direction":"column"})}},addCancelButtonExitSurvey:function(text){},renderQuestions:function(data,surveyType,surveyHeader,surveyId){var questions;questions=!Array.isArray(data.question)&&data.question?[data.question]:data.question||[];console.log(questions);var questionsDom=document.createDocumentFragment();console.log("document frag"+questionsDom);for(var question,divWrapper,_this=this,i=0;i<questions.length;i++){question=questions[i];console.log("create div wrapper");divWrapper=_this.createDivWrapper(question);switch(question.type){case"Dropdown Box":divWrapper.appendChild(_this.renderSelect(question));$(divWrapper).find(".cv-lp-required-input").css("margin-top","-4px");break;case"Checkbox":_this.renderCheckbox(question,divWrapper);break;case"Radio Button":case"Radio Button (side by side)":_this.renderRadioButtons(question,divWrapper);break;case"Text Area":divWrapper.appendChild(_this.renderTextArea(question));break;case"Text Field":divWrapper.appendChild(_this.renderInputText(question));$(divWrapper).find("input").attr({"aria-label":question.label}).addClass("form-control")}questionsDom.appendChild(divWrapper)}setTimeout(function(){_this.$el.find("#cv-chat-loader-layer").hide();_this.$el.find("#cv-lp-survey").append('<div id="cv-lp-survey-header">'+surveyHeader+"</div>");_this.$el.find("#cv-lp-survey").append(questionsDom);_this.$el.find("#cv-lp-survey").append('<div id="cv-lp-btn-group"></div>');"pcs"===surveyType?_this.addSubmitButtonPCS(surveyId):"offlineSurvey"===surveyType?questions.length>0&&_this.addSubmitButtonOfflineSurvey(surveyId):"exitSurvey"===surveyType&&questions.length>0&&_this.addSubmitButtonExitSurvey(surveyId);window.CVSaveAttributes()},1e3)},validateSurvey:function(){var filter,_this=this,requiredQuestions=_this.$el.find(".lp_question.cv-lp-required"),passed=!0;requiredQuestions.each(function(i,element){var question=$(this);if("checkbox"===question.data("question-type")||"radiobutton"===question.data("question-type")||"radiobuttonh"===question.data("question-type")){if(0===question.find("input:checked").length){question.find(".cv-lp-required-input").show();passed=!1}}else if("dropdownbox"===question.data("question-type")){if("Choose one..."===question.find("option:selected").val()){question.find(".cv-lp-required-input").show();passed=!1}}else if("textfield"===question.data("question-type")||"textarea"===question.data("question-type"))if("numeric"===question.data("validation-type")){filter=/[0-9]/g;if(!filter.test(question.find("input, textarea").val())){question.find(".cv-lp-required-input").show();passed=!1}}else if("email"===question.data("validation-type")||question.find('input[aria-label="Please enter your email address:"]').length>0){filter=/^([a-zA-Z0-9_\.\-])+\@(([a-zA-Z0-9\-])+\.)+([a-zA-Z0-9]{2,4})+$/;if(!filter.test(question.find("input, textarea").val())){question.find(".cv-lp-required-input").show();passed=!1}}else if(!question.find("input, textarea").val()){question.find(".cv-lp-required-input").show();passed=!1}});return passed},getSurveyDataJSON:function(surveyType,surveyId){var _this=this,questions=_this.$el.find(".lp_question");console.log(questions);var answerKey,surveyData={id:surveyId},answers=[];answerKey="answer";questions.each(function(i,element){var question=$(this),answer={},checkboxValues=[];if("checkbox"===question.data("question-type")||"radiobutton"===question.data("question-type")||"radiobuttonh"===question.data("question-type")){if(1===question.find("input:checked").length){answer.id=question.attr("id").replace(_this.surveyPrefixes.question,"");answer[answerKey]=question.find("input:checked").val()}else if(question.find("input:checked").length>1){answer.id=question.attr("id").replace(_this.surveyPrefixes.question,"");question.find("input:checked").each(function(i,element){checkboxValues.push($(this).val())});answer[answerKey]=checkboxValues}}else if("dropdownbox"===question.data("question-type")){answer.id=question.attr("id").replace(_this.surveyPrefixes.question,"");answer[answerKey]=question.find("option:selected").val();"Choose one..."===answer[answerKey]&&(answer[answerKey]=void 0)}else if("textfield"===question.data("question-type")||"textarea"===question.data("question-type")){answer.id=question.attr("id").replace(_this.surveyPrefixes.question,"");answer[answerKey]=question.find("input, textarea").val()}void 0!==answer[answerKey]&&answers.push(answer)});1===answers.length?surveyData.question=answers[0]:answers.length>1&&(surveyData.question=answers);return surveyData},showOfflineSurvey:function(){var _this=this;setTimeout(function(){_this.$el.find("#cv-chat-user-entry").hide();_this.$el.find("#cv-chat-submit").hide();_this.$el.find("#cv-chat-answer-history").hide();_this.$el.find("#cv-live-chat-user-entry").hide();_this.$el.find("#cv-live-chat-submit").hide();window.cvCrossStorage.onConnect().then(function(){return window.cvCrossStorage.set(Settings.businessName+"-lpSessionEndedExternal","true")});localStorage.setItem(Settings.businessName+"-lpSessionEndedExternal","true");_this.lpChat.getOfflineSurvey({surveyName:_this.model.get("offlinesurvey"),success:_this.lpChat.handleOfflineSurvey,error:_this.lpChat.errorGettingOfflineSurvey,context:_this.lpChat})},1e3)},setButtonState:function(){var _this=this,field_val=_this.$el.find("#"+_this.entryID).val();$.trim(field_val).length>0?_this.$el.find("#"+_this.submitID).removeClass("disabled").removeAttr("disabled"):_this.$el.find("#"+_this.submitID).addClass("disabled").prop("disabled","true")},addLine:function(event){event.preventDefault();event.stopPropagation();var _this=this;_this.$el.find("#"+_this.submitID).addClass("disabled").prop("disabled","true");if(""!==this.$el.find("#"+this.entryID).val().trim()){var text=this.$el.find("#"+_this.entryID).val();_this.$el.find("#"+_this.entryID).val("");window.CVMobile!==!0&&_this.$el.find("#"+_this.entryID).focus();this.lpChat.addLine({text:text,error:function(error){console.log(error)},success:function(){}})}},keyPress:function(event,that){event.preventDefault();that.setButtonState();13==event.keyCode&&that.addLine(event)},endChat:function(context){console.log("endchat");window.livechatTriggered=!1;var _this=this;context&&(_this=context);if(_this.activeChatSession||"true"===localStorage.getItem(Settings.businessName+"-lpSessionEndedExternal")){if(Settings.liveperson.removeLPengagements===!0){clearInterval(window.CVVA.removeExternalEngagementsInterval);$(".LPMcontainer").each(function(i,element){$(this).removeClass("cv-va-hide-external-engagements")})}_this.userCloseLC=!0;this.activeChatSession=!1;window.cvCrossStorage.onConnect().then(function(){return window.cvCrossStorage.del(Settings.businessName+"-cvVaBootstrapState",Settings.businessName+"-cvVaModel",Settings.businessName+"-cvVaStyles",Settings.businessName+"-cvVaInitCall",Settings.businessName+"-cvVaCollectionLength",Settings.businessName+"-cvVaTimestamp",Settings.businessName+"-lpSessionEndedExternal",Settings.businessName+"-cvVaActiveSession_lp",Settings.businessName+"-requestingChat_lp",Settings.businessName+"-cvLpVisitorChatRels",Settings.businessName+"-cvLpVisitorResumeMode",Settings.businessName+"-cvLpVisitorSessionVars")}).then(function(){localStorage.removeItem(Settings.businessName+"-cvVaActiveSession_lp");localStorage.removeItem(Settings.businessName+"-requestingChat_lp");sessionStorage.removeItem("lpVisitorChatRels"+Settings.liveperson.accountNumber);sessionStorage.removeItem("lpVisitorResumeMode"+Settings.liveperson.accountNumber);sessionStorage.removeItem("lpVisitorSessionVars"+Settings.liveperson.accountNumber);window.calledResetVAOnLP=!0;_this.model.closeSession();window.resetVA()});this.$el.find("#cv-live-chat-user-entry").remove();_this.lpChat.endChat({success:function(){console.log("ended chat")},disposeVisitor:!0})}if(Settings.terminateVASession===!0){console.log("terminate session");clearInterval(window.proactiveEndSessionInterval);clearInterval(window.cvVaSaveState);localStorage.removeItem(Settings.businessName+"-cvVaBootstrapState");localStorage.removeItem(Settings.businessName+"-cvVaModel");localStorage.removeItem(Settings.businessName+"-cvVaStyles");localStorage.removeItem(Settings.businessName+"-cvVaInitCall");localStorage.removeItem(Settings.businessName+"-cvVaCollectionLength");localStorage.removeItem(Settings.businessName+"-cvVaTimestamp");window.cvVaCollectionLength=void 0;window.cvVaModel=void 0;window.cvVaMinimized=void 0;window.resizableAttached=void 0;window.localInitCall=void 0;window.sessionFlushInterval=setInterval(function(){clearInterval(window.proactiveEndSessionInterval);clearInterval(window.cvVaSaveState);localStorage.removeItem(Settings.businessName+"-cvVaBootstrapState");localStorage.removeItem(Settings.businessName+"-cvVaModel");localStorage.removeItem(Settings.businessName+"-cvVaStyles");localStorage.removeItem(Settings.businessName+"-cvVaInitCall");localStorage.removeItem(Settings.businessName+"-cvVaCollectionLength");localStorage.removeItem(Settings.businessName+"-cvVaTimestamp");window.cvVaCollectionLength=void 0;window.cvVaModel=void 0;window.cvVaMinimized=void 0;window.resizableAttached=void 0;window.localInitCall=void 0},0);setTimeout(function(){window.cvCrossStorage.onConnect().then(function(){return window.cvCrossStorage.del(Settings.businessName+"-cvVaBootstrapState",Settings.businessName+"-cvVaModel",Settings.businessName+"-cvVaStyles",Settings.businessName+"-cvVaInitCall",Settings.businessName+"-cvVaCollectionLength",Settings.businessName+"-cvVaTimestamp",Settings.businessName+"-lpSessionEndedExternal")}).then(function(res){window.loadFromStorage=!1;clearInterval(window.sessionFlushInterval)})},150)}},refreshTimeout:function(){window.cvCrossStorage.onConnect().then(function(){return window.cvCrossStorage.set(Settings.businessName+"-cvVaTimestamp",Date.now())});localStorage.setItem(Settings.businessName+"-cvVaTimestamp",Date.now())},saveLpSessionVariables:function(){var cvLpVisitorChatRels,cvLpVisitorResumeMode,cvLpVisitorSessionVars;if(sessionStorage.getItem("lpVisitorSessionVars"+Settings.liveperson.accountNumber)){cvLpVisitorChatRels=sessionStorage.getItem("lpVisitorChatRels"+Settings.liveperson.accountNumber);cvLpVisitorResumeMode=sessionStorage.getItem("lpVisitorResumeMode"+Settings.liveperson.accountNumber);cvLpVisitorSessionVars=sessionStorage.getItem("lpVisitorSessionVars"+Settings.liveperson.accountNumber);window.cvCrossStorage.onConnect().then(function(){window.cvCrossStorage.set(Settings.businessName+"-cvLpVisitorChatRels",cvLpVisitorChatRels);window.cvCrossStorage.set(Settings.businessName+"-cvLpVisitorResumeMode",cvLpVisitorResumeMode);window.cvCrossStorage.set(Settings.businessName+"-cvLpVisitorSessionVars",cvLpVisitorSessionVars)})}else window.cvCrossStorage.onConnect().then(function(){window.cvCrossStorage.del(Settings.businessName+"-cvLpVisitorChatRels",Settings.businessName+"-cvLpVisitorResumeMode",Settings.businessName+"-cvLpVisitorSessionVars")})},removeExternalEngagements:function(){$(".LPMcontainer").each(function(i,element){for(var removeEngagement=!0,i=0;i<Settings.liveperson.removeLPengagementExceptions.length;i++)$(this).parent().attr("id")===Settings.liveperson.removeLPengagementExceptions[i]&&(removeEngagement=!1);removeEngagement&&$(this).remove()})}});return LiveChat});!function(n,t,i){function w(t,i){var u,f;if(n.isArray(t)){for(u=t.length-1;u>=0;u--)f=t[u],"string"===n.type(f)&&r.transports[f]||(i.log("Invalid transport: "+f+", removing it from the transports list."),t.splice(u,1));0===t.length&&(i.log("No transports remain within the specified transport array."),t=null)}else if(r.transports[t]||"auto"===t){if("auto"===t&&r._.ieVersion<=8)return["longPolling"]}else i.log("Invalid transport: "+t.toString()+"."),t=null;return t}function b(n){return"http:"===n?80:"https:"===n?443:void 0}function a(n,t){return t.match(/:\d+$/)?t:t+":"+b(n)}function k(t,i){var u=this,r=[];u.tryBuffer=function(i){return t.state===n.signalR.connectionState.connecting?(r.push(i),!0):!1};u.drain=function(){if(t.state===n.signalR.connectionState.connected)for(;r.length>0;)i(r.shift())};u.clear=function(){r=[]}}var f={nojQuery:"jQuery was not found. Please ensure jQuery is referenced before the SignalR client JavaScript file.",noTransportOnInit:"No transport could be initialized successfully. Try specifying a different transport or none at all for auto initialization.",errorOnNegotiate:"Error during negotiation request.",stoppedWhileLoading:"The connection was stopped during page load.",stoppedWhileNegotiating:"The connection was stopped during the negotiate request.",errorParsingNegotiateResponse:"Error parsing negotiate response.",errorDuringStartRequest:"Error during start request. Stopping the connection.",stoppedDuringStartRequest:"The connection was stopped during the start request.",errorParsingStartResponse:"Error parsing start response: '{0}'. Stopping the connection.",invalidStartResponse:"Invalid start response: '{0}'. Stopping the connection.",protocolIncompatible:"You are using a version of the client that isn't compatible with the server. Client version {0}, server version {1}.",sendFailed:"Send failed.",parseFailed:"Failed at parsing response: {0}",longPollFailed:"Long polling request failed.",eventSourceFailedToConnect:"EventSource failed to connect.",eventSourceError:"Error raised by EventSource",webSocketClosed:"WebSocket closed.",pingServerFailedInvalidResponse:"Invalid ping response when pinging server: '{0}'.",pingServerFailed:"Failed to ping server.",pingServerFailedStatusCode:"Failed to ping server.  Server responded with status code {0}, stopping the connection.",pingServerFailedParse:"Failed to parse ping server response, stopping the connection.",noConnectionTransport:"Connection is in an invalid state, there is no transport active.",webSocketsInvalidState:"The Web Socket transport is in an invalid state, transitioning into reconnecting.",reconnectTimeout:"Couldn't reconnect within the configured timeout of {0} ms, disconnecting.",reconnectWindowTimeout:"The client has been inactive since {0} and it has exceeded the inactivity timeout of {1} ms. Stopping the connection."};if("function"!=typeof n)throw new Error(f.nojQuery);var r,h,s="complete"===t.document.readyState,e=n(t),c="__Negotiate Aborted__",u={onStart:"onStart",onStarting:"onStarting",onReceived:"onReceived",onError:"onError",onConnectionSlow:"onConnectionSlow",onReconnecting:"onReconnecting",onReconnect:"onReconnect",onStateChanged:"onStateChanged",onDisconnect:"onDisconnect"},v=function(n,i){if(i!==!1){var r;"undefined"!=typeof t.console&&(r="["+(new Date).toTimeString()+"] SignalR: "+n,t.console.debug?t.console.debug(r):t.console.log&&t.console.log(r))}},o=function(t,i,r){return i===t.state?(t.state=r,n(t).triggerHandler(u.onStateChanged,[{oldState:i,newState:r}]),!0):!1},y=function(n){return n.state===r.connectionState.disconnected},l=function(n){return n._.keepAliveData.activated&&n.transport.supportsKeepAlive(n)},p=function(i){var f,e;i._.configuredStopReconnectingTimeout||(e=function(t){var i=r._.format(r.resources.reconnectTimeout,t.disconnectTimeout);t.log(i);n(t).triggerHandler(u.onError,[r._.error(i,"TimeoutException")]);t.stop(!1,!1)},i.reconnecting(function(){var n=this;n.state===r.connectionState.reconnecting&&(f=t.setTimeout(function(){e(n)},n.disconnectTimeout))}),i.stateChanged(function(n){n.oldState===r.connectionState.reconnecting&&t.clearTimeout(f)}),i._.configuredStopReconnectingTimeout=!0)};r=function(n,t,i){return new r.fn.init(n,t,i)};r._={defaultContentType:"application/x-www-form-urlencoded; charset=UTF-8",ieVersion:function(){var i,n;return"Microsoft Internet Explorer"===t.navigator.appName&&(n=/MSIE ([0-9]+\.[0-9]+)/.exec(t.navigator.userAgent),n&&(i=t.parseFloat(n[1]))),i}(),error:function(n,t,i){var r=new Error(n);return r.source=t,"undefined"!=typeof i&&(r.context=i),r},transportError:function(n,t,r,u){var f=this.error(n,r,u);return f.transport=t?t.name:i,f},format:function(){for(var t=arguments[0],n=0;n<arguments.length-1;n++)t=t.replace("{"+n+"}",arguments[n+1]);return t},firefoxMajorVersion:function(n){var t=n.match(/Firefox\/(\d+)/);return!t||!t.length||t.length<2?0:parseInt(t[1],10)},configurePingInterval:function(i){var f=i._.config,e=function(t){n(i).triggerHandler(u.onError,[t])};f&&!i._.pingIntervalId&&f.pingInterval&&(i._.pingIntervalId=t.setInterval(function(){r.transports._logic.pingServer(i).fail(e)},f.pingInterval))}};r.events=u;r.resources=f;r.ajaxDefaults={processData:!0,timeout:null,async:!0,global:!1,cache:!1};r.changeState=o;r.isDisconnecting=y;r.connectionState={connecting:0,connected:1,reconnecting:2,disconnected:4};r.hub={start:function(){throw new Error("SignalR: Error loading hubs. Ensure your hubs reference is correct, e.g. <script src='/signalr/js'></script>.")}};e.load(function(){s=!0});r.fn=r.prototype={init:function(t,i,r){var f=n(this);this.url=t;this.qs=i;this.lastError=null;this._={keepAliveData:{},connectingMessageBuffer:new k(this,function(n){f.triggerHandler(u.onReceived,[n])}),onFailedTimeoutHandle:null,lastMessageAt:(new Date).getTime(),lastActiveAt:(new Date).getTime(),beatInterval:5e3,beatHandle:null,totalTransportConnectTimeout:0};"boolean"==typeof r&&(this.logging=r)},_parseResponse:function(n){var t=this;return n&&"string"==typeof n?t.json.parse(n):n},_originalJson:t.JSON,json:t.JSON,isCrossDomain:function(i,r){var u;return i=n.trim(i),r=r||t.location,0!==i.indexOf("http")?!1:(u=t.document.createElement("a"),u.href=i,u.protocol+a(u.protocol,u.host)!==r.protocol+a(r.protocol,r.host))},ajaxDataType:"text",contentType:"application/json; charset=UTF-8",logging:!1,state:r.connectionState.disconnected,clientProtocol:"1.4",reconnectDelay:2e3,transportConnectTimeout:0,disconnectTimeout:18e4,reconnectWindow:3e4,keepAliveWarnAt:2/3,start:function(i,h){var d,k,g,a=this,v={pingInterval:3e5,waitForPageLoad:!0,transport:"auto",jsonp:!1},y=a._deferral||n.Deferred(),b=t.document.createElement("a");if(a.lastError=null,a._deferral=y,!a.json)throw new Error("SignalR: No JSON parser found. Please ensure json2.js is referenced before the SignalR.js file if you need to support clients without native JSON parsing support, e.g. IE<8.");if("function"===n.type(i)?h=i:"object"===n.type(i)&&(n.extend(v,i),"function"===n.type(v.callback)&&(h=v.callback)),v.transport=w(v.transport,a),!v.transport)throw new Error("SignalR: Invalid transport(s) specified, aborting start.");return a._.config=v,s||v.waitForPageLoad!==!0?a.state===r.connectionState.connecting?y.promise():o(a,r.connectionState.disconnected,r.connectionState.connecting)===!1?(y.resolve(a),y.promise()):(p(a),b.href=a.url,b.protocol&&":"!==b.protocol?(a.protocol=b.protocol,a.host=b.host):(a.protocol=t.document.location.protocol,a.host=b.host||t.document.location.host),a.baseUrl=a.protocol+"//"+a.host,a.wsProtocol="https:"===a.protocol?"wss://":"ws://","auto"===v.transport&&v.jsonp===!0&&(v.transport="longPolling"),0===a.url.indexOf("//")&&(a.url=t.location.protocol+a.url,a.log("Protocol relative URL detected, normalizing it to '"+a.url+"'.")),this.isCrossDomain(a.url)&&(a.log("Auto detected cross domain url."),"auto"===v.transport&&(v.transport=["webSockets","serverSentEvents","longPolling"]),"undefined"==typeof v.withCredentials&&(v.withCredentials=!0),v.jsonp||(v.jsonp=!n.support.cors,v.jsonp&&a.log("Using jsonp because this browser doesn't support CORS.")),a.contentType=r._.defaultContentType),a.withCredentials=v.withCredentials,a.ajaxDataType=v.jsonp?"jsonp":"text",n(a).bind(u.onStart,function(){"function"===n.type(h)&&h.call(a);y.resolve(a)}),d=function(i,s){var p=r._.error(f.noTransportOnInit);if(s=s||0,s>=i.length){n(a).triggerHandler(u.onError,[p]);y.reject(p);a.stop()}else if(a.state!==r.connectionState.disconnected){var w=i[s],h=r.transports[w],c=!1,v=function(){c||(c=!0,t.clearTimeout(a._.onFailedTimeoutHandle),h.stop(a),d(i,s+1))};a.transport=h;try{a._.onFailedTimeoutHandle=t.setTimeout(function(){a.log(h.name+" timed out when trying to connect.");v()},a._.totalTransportConnectTimeout);h.start(a,function(){var i=function(){var i=r._.firefoxMajorVersion(t.navigator.userAgent)>=11,f=!!a.withCredentials&&i;a.log("The start request succeeded. Transitioning to the connected state.");l(a)&&r.transports._logic.monitorKeepAlive(a);r.transports._logic.startHeartbeat(a);r._.configurePingInterval(a);o(a,r.connectionState.connecting,r.connectionState.connected)||a.log("WARNING! The connection was not in the connecting state.");a._.connectingMessageBuffer.drain();n(a).triggerHandler(u.onStart);e.bind("unload",function(){a.log("Window unloading, stopping the connection.");a.stop(f)});i&&e.bind("beforeunload",function(){t.setTimeout(function(){a.stop(f)},0)})};if(!c){if(c=!0,t.clearTimeout(a._.onFailedTimeoutHandle),a.state===r.connectionState.disconnected)return;a.log(h.name+" transport selected. Initiating start request.");r.transports._logic.ajaxStart(a,i)}},v)}catch(b){a.log(h.name+" transport threw '"+b.message+"' when attempting to start.");v()}}},k=a.url+"/negotiate",g=function(t,i){var e=r._.error(f.errorOnNegotiate,t,i._.negotiateRequest);n(i).triggerHandler(u.onError,e);y.reject(e);i.stop()},n(a).triggerHandler(u.onStarting),k=r.transports._logic.prepareQueryString(a,k),a.log("Negotiating with '"+k+"'."),a._.negotiateRequest=r.transports._logic.ajax(a,{url:k,error:function(n,t){t!==c?g(n,a):y.reject(r._.error(f.stoppedWhileNegotiating,null,a._.negotiateRequest))},success:function(t){var i,e,h,o=[],s=[];try{i=a._parseResponse(t)}catch(c){g(r._.error(f.errorParsingNegotiateResponse,c),a);return}if(e=a._.keepAliveData,a.appRelativeUrl=i.Url,a.id=i.ConnectionId,a.token=i.ConnectionToken,a.webSocketServerUrl=i.WebSocketServerUrl,a._.longPollDelay=1e3*i.LongPollDelay,a.disconnectTimeout=1e3*i.DisconnectTimeout,a._.totalTransportConnectTimeout=a.transportConnectTimeout+1e3*i.TransportConnectTimeout,i.KeepAliveTimeout?(e.activated=!0,e.timeout=1e3*i.KeepAliveTimeout,e.timeoutWarning=e.timeout*a.keepAliveWarnAt,a._.beatInterval=(e.timeout-e.timeoutWarning)/3):e.activated=!1,a.reconnectWindow=a.disconnectTimeout+(e.timeout||0),i.ProtocolVersion&&i.ProtocolVersion===a.clientProtocol){n.each(r.transports,function(n){if(0===n.indexOf("_")||"webSockets"===n&&!i.TryWebSockets)return!0;s.push(n)});n.isArray(v.transport)?n.each(v.transport,function(t,i){n.inArray(i,s)>=0&&o.push(i)}):"auto"===v.transport?o=s:n.inArray(v.transport,s)>=0&&o.push(v.transport);d(o)}else{h=r._.error(r._.format(f.protocolIncompatible,a.clientProtocol,i.ProtocolVersion));n(a).triggerHandler(u.onError,[h]);y.reject(h)}}}),y.promise()):(a._.deferredStartHandler=function(){a.start(i,h)},e.bind("load",a._.deferredStartHandler),y.promise())},starting:function(t){var i=this;return n(i).bind(u.onStarting,function(){t.call(i)}),i},send:function(n){var t=this;if(t.state===r.connectionState.disconnected)throw new Error("SignalR: Connection must be started before data can be sent. Call .start() before .send()");if(t.state===r.connectionState.connecting)throw new Error("SignalR: Connection has not been fully initialized. Use .start().done() or .start().fail() to run logic after the connection has started.");return t.transport.send(t,n),t},received:function(t){var i=this;return n(i).bind(u.onReceived,function(n,r){t.call(i,r)}),i},stateChanged:function(t){var i=this;return n(i).bind(u.onStateChanged,function(n,r){t.call(i,r)}),i},error:function(t){var i=this;return n(i).bind(u.onError,function(n,r,u){i.lastError=r;t.call(i,r,u)}),i},disconnected:function(t){var i=this;return n(i).bind(u.onDisconnect,function(){t.call(i)}),i},connectionSlow:function(t){var i=this;return n(i).bind(u.onConnectionSlow,function(){t.call(i)}),i},reconnecting:function(t){var i=this;return n(i).bind(u.onReconnecting,function(){t.call(i)}),i},reconnected:function(t){var i=this;return n(i).bind(u.onReconnect,function(){t.call(i)}),i},stop:function(i,h){var a=this,v=a._deferral;if(a._.deferredStartHandler&&e.unbind("load",a._.deferredStartHandler),delete a._.config,delete a._.deferredStartHandler,s||a._.config&&a._.config.waitForPageLoad!==!0)return a.state!==r.connectionState.disconnected?(a.log("Stopping connection."),o(a,a.state,r.connectionState.disconnected),t.clearTimeout(a._.beatHandle),t.clearTimeout(a._.onFailedTimeoutHandle),t.clearInterval(a._.pingIntervalId),a.transport&&(a.transport.stop(a),h!==!1&&a.transport.abort(a,i),l(a)&&r.transports._logic.stopMonitoringKeepAlive(a),a.transport=null),a._.negotiateRequest&&(a._.negotiateRequest.abort(c),delete a._.negotiateRequest),r.transports._logic.tryAbortStartRequest(a),n(a).triggerHandler(u.onDisconnect),delete a._deferral,delete a.messageId,delete a.groupsToken,delete a.id,delete a._.pingIntervalId,delete a._.lastMessageAt,delete a._.lastActiveAt,delete a._.longPollDelay,a._.connectingMessageBuffer.clear(),a):void 0;a.log("Stopping connection prior to negotiate.");v&&v.reject(r._.error(f.stoppedWhileLoading))},log:function(n){v(n,this.logging)}};r.fn.init.prototype=r.fn;r.noConflict=function(){return n.connection===r&&(n.connection=h),r};n.connection&&(h=n.connection);n.connection=n.signalR=r}(window.jQuery,window),function(n,t){function o(n){n._.keepAliveData.monitoring&&h(n);r.markActive(n)&&(n._.beatHandle=t.setTimeout(function(){o(n)},n._.beatInterval))}function h(t){var f,r=t._.keepAliveData;t.state===i.connectionState.connected&&(f=(new Date).getTime()-t._.lastMessageAt,f>=r.timeout?(t.log("Keep alive timed out.  Notifying transport that connection has been lost."),t.transport.lostConnection(t)):f>=r.timeoutWarning?r.userNotified||(t.log("Keep alive has been missed, connection may be dead/slow."),n(t).triggerHandler(u.onConnectionSlow),r.userNotified=!0):r.userNotified=!1)}function f(n,t){var i=n.url+t;return n.transport&&(i+="?transport="+n.transport.name),r.prepareQueryString(n,i)}var r,i=n.signalR,u=n.signalR.events,s=n.signalR.changeState,e="__Start Aborted__";i.transports={};r=i.transports._logic={ajax:function(t,i){return n.ajax(n.extend(!0,{},n.signalR.ajaxDefaults,{type:"GET",data:{},xhrFields:{withCredentials:t.withCredentials},contentType:t.contentType,dataType:t.ajaxDataType},i))},pingServer:function(t){var e,f,u=n.Deferred();return t.transport?(e=t.url+"/ping",e=r.addQs(e,t.qs),f=r.ajax(t,{url:e,success:function(n){var r;try{r=t._parseResponse(n)}catch(e){u.reject(i._.transportError(i.resources.pingServerFailedParse,t.transport,e,f));t.stop();return}"pong"===r.Response?u.resolve():u.reject(i._.transportError(i._.format(i.resources.pingServerFailedInvalidResponse,n),t.transport,null,f))},error:function(n){401===n.status||403===n.status?(u.reject(i._.transportError(i._.format(i.resources.pingServerFailedStatusCode,n.status),t.transport,n,f)),t.stop()):u.reject(i._.transportError(i.resources.pingServerFailed,t.transport,n,f))}})):u.reject(i._.transportError(i.resources.noConnectionTransport,t.transport)),u.promise()},prepareQueryString:function(n,i){var u;return u=r.addQs(i,"clientProtocol="+n.clientProtocol),u=r.addQs(u,n.qs),n.token&&(u+="&connectionToken="+t.encodeURIComponent(n.token)),n.data&&(u+="&connectionData="+t.encodeURIComponent(n.data)),u},addQs:function(t,i){var u,r=-1!==t.indexOf("?")?"&":"?";if(!i)return t;if("object"==typeof i)return t+r+n.param(i);if("string"==typeof i)return u=i.charAt(0),("?"===u||"&"===u)&&(r=""),t+r+i;throw new Error("Query string property must be either a string or object.")},getUrl:function(n,i,u,f){var s="webSockets"===i?"":n.baseUrl,e=s+n.appRelativeUrl,o="transport="+i;return n.groupsToken&&(o+="&groupsToken="+t.encodeURIComponent(n.groupsToken)),u?(e+=f?"/poll":"/reconnect",n.messageId&&(o+="&messageId="+t.encodeURIComponent(n.messageId))):e+="/connect",e+="?"+o,e=r.prepareQueryString(n,e),e+("&tid="+Math.floor(11*Math.random()))},maximizePersistentResponse:function(n){return{MessageId:n.C,Messages:n.M,Initialized:"undefined"!=typeof n.S?!0:!1,Disconnect:"undefined"!=typeof n.D?!0:!1,ShouldReconnect:"undefined"!=typeof n.T?!0:!1,LongPollDelay:n.L,GroupsToken:n.G}},updateGroups:function(n,t){t&&(n.groupsToken=t)},stringifySend:function(n,t){return"string"==typeof t||"undefined"==typeof t||null===t?t:n.json.stringify(t)},ajaxSend:function(t,e){var o,h=r.stringifySend(t,e),c=f(t,"/send"),s=function(t,r){n(r).triggerHandler(u.onError,[i._.transportError(i.resources.sendFailed,r.transport,t,o),e])};return o=r.ajax(t,{url:c,type:"jsonp"===t.ajaxDataType?"GET":"POST",contentType:i._.defaultContentType,data:{data:h},success:function(n){var i;if(n){try{i=t._parseResponse(n)}catch(u){s(u,t);t.stop();return}r.triggerReceived(t,i)}},error:function(n,i){"abort"!==i&&"parsererror"!==i&&s(n,t)}})},ajaxAbort:function(n,t){if("undefined"!=typeof n.transport){t="undefined"==typeof t?!0:t;var i=f(n,"/abort");r.ajax(n,{url:i,async:t,timeout:1e3,type:"POST"});n.log("Fired ajax abort async = "+t+".")}},ajaxStart:function(t,o){var h=function(n){var i=t._deferral;i&&i.reject(n)},s=function(i){t.log("The start request failed. Stopping the connection.");n(t).triggerHandler(u.onError,[i]);h(i);t.stop()};t._.startRequest=r.ajax(t,{url:f(t,"/start"),success:function(n,r,u){var f;try{f=t._parseResponse(n)}catch(e){s(i._.error(i._.format(i.resources.errorParsingStartResponse,n),e,u));return}"started"===f.Response?o():s(i._.error(i._.format(i.resources.invalidStartResponse,n),null,u))},error:function(n,r,u){r!==e?s(i._.error(i.resources.errorDuringStartRequest,u,n)):(t.log("The start request aborted because connection.stop() was called."),h(i._.error(i.resources.stoppedDuringStartRequest,null,n)))}})},tryAbortStartRequest:function(n){n._.startRequest&&(n._.startRequest.abort(e),delete n._.startRequest)},tryInitialize:function(n,t){n.Initialized&&t()},triggerReceived:function(t,i){t._.connectingMessageBuffer.tryBuffer(i)||n(t).triggerHandler(u.onReceived,[i])},processMessages:function(t,i,u){var f;r.markLastMessage(t);i&&(f=r.maximizePersistentResponse(i),r.updateGroups(t,f.GroupsToken),f.MessageId&&(t.messageId=f.MessageId),f.Messages&&(n.each(f.Messages,function(n,i){r.triggerReceived(t,i)}),r.tryInitialize(f,u)))},monitorKeepAlive:function(t){var i=t._.keepAliveData;i.monitoring?t.log("Tried to monitor keep alive but it's already being monitored."):(i.monitoring=!0,r.markLastMessage(t),t._.keepAliveData.reconnectKeepAliveUpdate=function(){r.markLastMessage(t)},n(t).bind(u.onReconnect,t._.keepAliveData.reconnectKeepAliveUpdate),t.log("Now monitoring keep alive with a warning timeout of "+i.timeoutWarning+" and a connection lost timeout of "+i.timeout+"."))},stopMonitoringKeepAlive:function(t){var i=t._.keepAliveData;i.monitoring&&(i.monitoring=!1,n(t).unbind(u.onReconnect,t._.keepAliveData.reconnectKeepAliveUpdate),t._.keepAliveData={},t.log("Stopping the monitoring of the keep alive."))},startHeartbeat:function(n){n._.lastActiveAt=(new Date).getTime();o(n)},markLastMessage:function(n){n._.lastMessageAt=(new Date).getTime();
},markActive:function(n){return r.verifyLastActive(n)?(n._.lastActiveAt=(new Date).getTime(),!0):!1},isConnectedOrReconnecting:function(n){return n.state===i.connectionState.connected||n.state===i.connectionState.reconnecting},ensureReconnectingState:function(t){return s(t,i.connectionState.connected,i.connectionState.reconnecting)===!0&&n(t).triggerHandler(u.onReconnecting),t.state===i.connectionState.reconnecting},clearReconnectTimeout:function(n){n&&n._.reconnectTimeout&&(t.clearTimeout(n._.reconnectTimeout),delete n._.reconnectTimeout)},verifyLastActive:function(t){if((new Date).getTime()-t._.lastActiveAt>=t.reconnectWindow){var r=i._.format(i.resources.reconnectWindowTimeout,new Date(t._.lastActiveAt),t.reconnectWindow);return t.log(r),n(t).triggerHandler(u.onError,[i._.error(r,"TimeoutException")]),t.stop(!1,!1),!1}return!0},reconnect:function(n,u){var f=i.transports[u];if(r.isConnectedOrReconnecting(n)&&!n._.reconnectTimeout){if(!r.verifyLastActive(n))return;n._.reconnectTimeout=t.setTimeout(function(){r.verifyLastActive(n)&&(f.stop(n),r.ensureReconnectingState(n)&&(n.log(u+" reconnecting."),f.start(n)))},n.reconnectDelay)}},handleParseFailure:function(t,r,f,e,o){t.state===i.connectionState.connecting?(t.log("Failed to parse server response while attempting to connect."),e()):(n(t).triggerHandler(u.onError,[i._.transportError(i._.format(i.resources.parseFailed,r),t.transport,f,o)]),t.stop())},foreverFrame:{count:0,connections:{}}}}(window.jQuery,window),function(n,t){var r=n.signalR,u=n.signalR.events,f=n.signalR.changeState,i=r.transports._logic;r.transports.webSockets={name:"webSockets",supportsKeepAlive:function(){return!0},send:function(t,f){var e=i.stringifySend(t,f);try{t.socket.send(e)}catch(o){n(t).triggerHandler(u.onError,[r._.transportError(r.resources.webSocketsInvalidState,t.transport,o,t.socket),f])}},start:function(e,o,s){var h,c=!1,l=this,a=!o,v=n(e);t.WebSocket?e.socket||(h=e.webSocketServerUrl?e.webSocketServerUrl:e.wsProtocol+e.host,h+=i.getUrl(e,this.name,a),e.log("Connecting to websocket endpoint '"+h+"'."),e.socket=new t.WebSocket(h),e.socket.onopen=function(){c=!0;e.log("Websocket opened.");i.clearReconnectTimeout(e);f(e,r.connectionState.reconnecting,r.connectionState.connected)===!0&&v.triggerHandler(u.onReconnect)},e.socket.onclose=function(t){if(this===e.socket){if(!c){s?s():a&&l.reconnect(e);return}"undefined"!=typeof t.wasClean&&t.wasClean===!1?(n(e).triggerHandler(u.onError,[r._.transportError(r.resources.webSocketClosed,e.transport,t)]),e.log("Unclean disconnect from websocket: "+t.reason||"[no reason given].")):e.log("Websocket closed.");l.reconnect(e)}},e.socket.onmessage=function(t){var r;try{r=e._parseResponse(t.data)}catch(u){i.handleParseFailure(e,t.data,u,s,t);return}r&&(n.isEmptyObject(r)||r.M?i.processMessages(e,r,o):i.triggerReceived(e,r))}):s()},reconnect:function(n){i.reconnect(n,this.name)},lostConnection:function(n){this.reconnect(n)},stop:function(n){i.clearReconnectTimeout(n);n.socket&&(n.log("Closing the Websocket."),n.socket.close(),n.socket=null)},abort:function(n,t){i.ajaxAbort(n,t)}}}(window.jQuery,window),function(n,t){var i=n.signalR,u=n.signalR.events,e=n.signalR.changeState,r=i.transports._logic,f=function(n){t.clearTimeout(n._.reconnectAttemptTimeoutHandle);delete n._.reconnectAttemptTimeoutHandle};i.transports.serverSentEvents={name:"serverSentEvents",supportsKeepAlive:function(){return!0},timeOut:3e3,start:function(o,s,h){var y,c=this,l=!1,a=n(o),v=!s;if(o.eventSource&&(o.log("The connection already has an event source. Stopping it."),o.stop()),t.EventSource){y=r.getUrl(o,this.name,v);try{o.log("Attempting to connect to SSE endpoint '"+y+"'.");o.eventSource=new t.EventSource(y,{withCredentials:o.withCredentials})}catch(p){o.log("EventSource failed trying to connect with error "+p.Message+".");h?h():(a.triggerHandler(u.onError,[i._.transportError(i.resources.eventSourceFailedToConnect,o.transport,p)]),v&&c.reconnect(o));return}v&&(o._.reconnectAttemptTimeoutHandle=t.setTimeout(function(){l===!1&&o.eventSource.readyState!==t.EventSource.OPEN&&c.reconnect(o)},c.timeOut));o.eventSource.addEventListener("open",function(){o.log("EventSource connected.");f(o);r.clearReconnectTimeout(o);l===!1&&(l=!0,e(o,i.connectionState.reconnecting,i.connectionState.connected)===!0&&a.triggerHandler(u.onReconnect))},!1);o.eventSource.addEventListener("message",function(n){var t;if("initialized"!==n.data){try{t=o._parseResponse(n.data)}catch(i){r.handleParseFailure(o,n.data,i,h,n);return}r.processMessages(o,t,s)}},!1);o.eventSource.addEventListener("error",function(n){if(this===o.eventSource){if(!l){h&&h();return}o.log("EventSource readyState: "+o.eventSource.readyState+".");n.eventPhase===t.EventSource.CLOSED?(o.log("EventSource reconnecting due to the server connection ending."),c.reconnect(o)):(o.log("EventSource error."),a.triggerHandler(u.onError,[i._.transportError(i.resources.eventSourceError,o.transport,n)]))}},!1)}else h&&(o.log("This browser doesn't support SSE."),h())},reconnect:function(n){r.reconnect(n,this.name)},lostConnection:function(n){this.reconnect(n)},send:function(n,t){r.ajaxSend(n,t)},stop:function(n){f(n);r.clearReconnectTimeout(n);n&&n.eventSource&&(n.log("EventSource calling close()."),n.eventSource.close(),n.eventSource=null,delete n.eventSource)},abort:function(n,t){r.ajaxAbort(n,t)}}}(window.jQuery,window),function(n,t){var r=n.signalR,e=n.signalR.events,o=n.signalR.changeState,i=r.transports._logic,u=function(){var n=t.document.createElement("iframe");return n.setAttribute("style","position:absolute;top:0;left:0;width:0;height:0;visibility:hidden;"),n},f=function(){var i=null,f=1e3,n=0;return{prevent:function(){r._.ieVersion<=8&&(0===n&&(i=t.setInterval(function(){var n=u();t.document.body.appendChild(n);t.document.body.removeChild(n);n=null},f)),n++)},cancel:function(){1===n&&t.clearInterval(i);n>0&&n--}}}();r.transports.foreverFrame={name:"foreverFrame",supportsKeepAlive:function(){return!0},iframeClearThreshold:50,start:function(n,r,e){var h,l=this,s=i.foreverFrame.count+=1,o=u(),c=function(){n.log("Forever frame iframe finished loading and is no longer receiving messages.");l.reconnect(n)};if(t.EventSource)e&&(n.log("This browser supports SSE, skipping Forever Frame."),e());else{o.setAttribute("data-signalr-connection-id",n.id);f.prevent();h=i.getUrl(n,this.name);h+="&frameId="+s;t.document.body.appendChild(o);n.log("Binding to iframe's load event.");o.addEventListener?o.addEventListener("load",c,!1):o.attachEvent&&o.attachEvent("onload",c);o.src=h;i.foreverFrame.connections[s]=n;n.frame=o;n.frameId=s;r&&(n.onSuccess=function(){n.log("Iframe transport started.");r()})}},reconnect:function(n){var r=this;i.isConnectedOrReconnecting(n)&&i.verifyLastActive(n)&&t.setTimeout(function(){if(i.verifyLastActive(n)&&n.frame&&i.ensureReconnectingState(n)){var u=n.frame,t=i.getUrl(n,r.name,!0)+"&frameId="+n.frameId;n.log("Updating iframe src to '"+t+"'.");u.src=t}},n.reconnectDelay)},lostConnection:function(n){this.reconnect(n)},send:function(n,t){i.ajaxSend(n,t)},receive:function(t,u){var f,e,o;if(t.json!==t._originalJson&&(u=t._originalJson.stringify(u)),o=t._parseResponse(u),i.processMessages(t,o,t.onSuccess),t.state===n.signalR.connectionState.connected&&(t.frameMessageCount=(t.frameMessageCount||0)+1,t.frameMessageCount>r.transports.foreverFrame.iframeClearThreshold&&(t.frameMessageCount=0,f=t.frame.contentWindow||t.frame.contentDocument,f&&f.document&&f.document.body)))for(e=f.document.body;e.firstChild;)e.removeChild(e.firstChild)},stop:function(n){var r=null;if(f.cancel(),n.frame){if(n.frame.stop)n.frame.stop();else try{r=n.frame.contentWindow||n.frame.contentDocument;r.document&&r.document.execCommand&&r.document.execCommand("Stop")}catch(u){n.log("Error occured when stopping foreverFrame transport. Message = "+u.message+".")}n.frame.parentNode===t.document.body&&t.document.body.removeChild(n.frame);delete i.foreverFrame.connections[n.frameId];n.frame=null;n.frameId=null;delete n.frame;delete n.frameId;delete n.onSuccess;delete n.frameMessageCount;n.log("Stopping forever frame.")}},abort:function(n,t){i.ajaxAbort(n,t)},getConnection:function(n){return i.foreverFrame.connections[n]},started:function(t){o(t,r.connectionState.reconnecting,r.connectionState.connected)===!0&&n(t).triggerHandler(e.onReconnect)}}}(window.jQuery,window),function(n,t){var r=n.signalR,u=n.signalR.events,e=n.signalR.changeState,f=n.signalR.isDisconnecting,i=r.transports._logic,o=function(){try{return"onprogress"in new t.XMLHttpRequest}catch(n){return!1}}();r.transports.longPolling={name:"longPolling",supportsKeepAlive:function(n){return o&&"jsonp"!==n.ajaxDataType&&0===n._.longPollDelay},reconnectDelay:3e3,start:function(o,s,h){var a=this,v=function(){v=n.noop;h=null;o.log("LongPolling connected.");s()},y=function(){return h?(h(),h=null,o.log("LongPolling failed to connect."),!0):!1},c=o._,l=0,p=function(i){t.clearTimeout(c.reconnectTimeoutId);c.reconnectTimeoutId=null;e(i,r.connectionState.reconnecting,r.connectionState.connected)===!0&&(i.log("Raising the reconnect event"),n(i).triggerHandler(u.onReconnect))},w=36e5;o.pollXhr&&(o.log("Polling xhr requests already exists, aborting."),o.stop());o.messageId=null;c.reconnectTimeoutId=null;c.pollTimeoutId=t.setTimeout(function(){!function e(s,h){var d=s.messageId,g=null===d,b=!g,nt=!h,k=i.getUrl(s,a.name,b,nt);f(s)!==!0&&(o.log("Opening long polling request to '"+k+"'."),s.pollXhr=i.ajax(o,{xhrFields:{onprogress:function(){i.markLastMessage(o)}},url:k,success:function(r){var h,u,a,w=0;o.log("Long poll complete.");l=0;try{h=o._parseResponse(r)}catch(b){i.handleParseFailure(s,r,b,y,s.pollXhr);return}(null!==c.reconnectTimeoutId&&p(s),h&&(u=i.maximizePersistentResponse(h)),i.processMessages(s,h,v),u&&"number"===n.type(u.LongPollDelay)&&(w=u.LongPollDelay),u&&u.Disconnect)||f(s)!==!0&&(a=u&&u.ShouldReconnect,!a||i.ensureReconnectingState(s))&&(w>0?c.pollTimeoutId=t.setTimeout(function(){e(s,a)},w):e(s,a))},error:function(f,h){if(t.clearTimeout(c.reconnectTimeoutId),c.reconnectTimeoutId=null,"abort"!==h){if(!y()){if(l++,o.state!==r.connectionState.reconnecting&&(o.log("An error occurred using longPolling. Status = "+h+".  Response = "+f.responseText+"."),n(s).triggerHandler(u.onError,[r._.transportError(r.resources.longPollFailed,o.transport,f,s.pollXhr)])),(o.state===r.connectionState.connected||o.state===r.connectionState.reconnecting)&&!i.verifyLastActive(o))return;if(!i.ensureReconnectingState(s))return;c.pollTimeoutId=t.setTimeout(function(){e(s,!0)},a.reconnectDelay)}}else o.log("Aborted xhr request.")}}),b&&h===!0&&(c.reconnectTimeoutId=t.setTimeout(function(){p(s)},Math.min(1e3*(Math.pow(2,l)-1),w))))}(o)},250)},lostConnection:function(n){n.pollXhr&&n.pollXhr.abort("lostConnection")},send:function(n,t){i.ajaxSend(n,t)},stop:function(n){t.clearTimeout(n._.pollTimeoutId);t.clearTimeout(n._.reconnectTimeoutId);delete n._.pollTimeoutId;delete n._.reconnectTimeoutId;n.pollXhr&&(n.pollXhr.abort(),n.pollXhr=null,delete n.pollXhr)},abort:function(n,t){i.ajaxAbort(n,t)}}}(window.jQuery,window),function(n){function r(n){return n+e}function s(n,t,i){for(var f=n.length,u=[],r=0;f>r;r+=1)n.hasOwnProperty(r)&&(u[r]=t.call(i,n[r],r,n));return u}function h(t){return n.isFunction(t)?null:"undefined"===n.type(t)?null:t}function u(n){for(var t in n)if(n.hasOwnProperty(t))return!0;return!1}function f(n,t){var r,f,i=n._.invocationCallbacks;u(i)&&n.log("Clearing hub invocation callbacks with error: "+t+".");n._.invocationCallbackId=0;delete n._.invocationCallbacks;n._.invocationCallbacks={};for(f in i)r=i[f],r.method.call(r.scope,{E:t})}function i(n,t){return new i.fn.init(n,t)}function t(i,r){var u={qs:null,logging:!1,useDefaultPath:!0};return n.extend(u,r),(!i||u.useDefaultPath)&&(i=(i||"")+"/signalr"),new t.fn.init(i,u)}var e=".hubProxy",o=n.signalR;i.fn=i.prototype={init:function(n,t){this.state={};this.connection=n;this.hubName=t;this._={callbackMap:{}}},hasSubscriptions:function(){return u(this._.callbackMap)},on:function(t,i){var u=this,f=u._.callbackMap;return t=t.toLowerCase(),f[t]||(f[t]={}),f[t][i]=function(n,t){i.apply(u,t)},n(u).bind(r(t),f[t][i]),u},off:function(t,i){var f,e=this,o=e._.callbackMap;return t=t.toLowerCase(),f=o[t],f&&(f[i]?(n(e).unbind(r(t),f[i]),delete f[i],u(f)||delete o[t]):i||(n(e).unbind(r(t)),delete o[t])),e},invoke:function(t){var i=this,r=i.connection,e=n.makeArray(arguments).slice(1),c=s(e,h),f={H:i.hubName,M:t,A:c,I:r._.invocationCallbackId},u=n.Deferred(),l=function(f){var h,s,e=i._maximizeHubResponse(f);n.extend(i.state,e.State);e.Progress?u.notifyWith?u.notifyWith(i,[e.Progress.Data]):r._.progressjQueryVersionLogged||(r.log("A hub method invocation progress update was received but the version of jQuery in use ("+n.prototype.jquery+") does not support progress updates. Upgrade to jQuery 1.7+ to receive progress notifications."),r._.progressjQueryVersionLogged=!0):e.Error?(e.StackTrace&&r.log(e.Error+"\n"+e.StackTrace+"."),h=e.IsHubException?"HubException":"Exception",s=o._.error(e.Error,h),s.data=e.ErrorData,r.log(i.hubName+"."+t+" failed to execute. Error: "+s.message),u.rejectWith(i,[s])):(r.log("Invoked "+i.hubName+"."+t),u.resolveWith(i,[e.Result]))};return r._.invocationCallbacks[r._.invocationCallbackId.toString()]={scope:i,method:l},r._.invocationCallbackId+=1,n.isEmptyObject(i.state)||(f.S=i.state),r.log("Invoking "+i.hubName+"."+t),r.send(f),u.promise()},_maximizeHubResponse:function(n){return{State:n.S,Result:n.R,Progress:n.P?{Id:n.P.I,Data:n.P.D}:null,Id:n.I,IsHubException:n.H,Error:n.E,StackTrace:n.T,ErrorData:n.D}}};i.fn.init.prototype=i.fn;t.fn=t.prototype=n.connection();t.fn.init=function(t,i){var e={qs:null,logging:!1,useDefaultPath:!0},u=this;n.extend(e,i);n.signalR.fn.init.call(u,t,e.qs,e.logging);u.proxies={};u._.invocationCallbackId=0;u._.invocationCallbacks={};u.received(function(t){var f,o,e,i,s,h;t&&("undefined"!=typeof t.P?(e=t.P.I.toString(),i=u._.invocationCallbacks[e],i&&i.method.call(i.scope,t)):"undefined"!=typeof t.I?(e=t.I.toString(),i=u._.invocationCallbacks[e],i&&(u._.invocationCallbacks[e]=null,delete u._.invocationCallbacks[e],i.method.call(i.scope,t))):(f=this._maximizeClientHubInvocation(t),u.log("Triggering client hub event '"+f.Method+"' on hub '"+f.Hub+"'."),s=f.Hub.toLowerCase(),h=f.Method.toLowerCase(),o=this.proxies[s],n.extend(o.state,f.State),n(o).triggerHandler(r(h),[f.Args])))});u.error(function(n,t){var i,r;t&&(i=t.I,r=u._.invocationCallbacks[i],r&&(u._.invocationCallbacks[i]=null,delete u._.invocationCallbacks[i],r.method.call(r.scope,{E:n})))});u.reconnecting(function(){u.transport&&"webSockets"===u.transport.name&&f(u,"Connection started reconnecting before invocation result was received.")});u.disconnected(function(){f(u,"Connection was disconnected before invocation result was received.")})};t.fn._maximizeClientHubInvocation=function(n){return{Hub:n.H,Method:n.M,Args:n.A,State:n.S}};t.fn._registerSubscribedHubs=function(){var t=this;t._subscribedToHubs||(t._subscribedToHubs=!0,t.starting(function(){var i=[];n.each(t.proxies,function(n){this.hasSubscriptions()&&(i.push({name:n}),t.log("Client subscribed to hub '"+n+"'."))});0===i.length&&t.log("No hubs have been subscribed to.  The client will not receive data from hubs.  To fix, declare at least one client side function prior to connection start for each hub you wish to subscribe to.");t.data=t.json.stringify(i)}))};t.fn.createHubProxy=function(n){n=n.toLowerCase();var t=this.proxies[n];return t||(t=i(this,n),this.proxies[n]=t),this._registerSubscribedHubs(),t};t.fn.init.prototype=t.fn;n.hubConnection=t}(window.jQuery,window),function(n){n.signalR.version="2.1.1"}(window.jQuery);define("jquery_signalR",function(){});define("views/virtual_assistant/components/linkR",["jquery","jquery_ui","jquery_signalR","backbone","settings","scrollto"],function($,$ui,SignalR,Backbone,Settings,ScrollTo){var LiveChat=Backbone.View.extend({el:".cv-va-bootstrap #cv-chat-content",submitID:"cv-live-chat-submit",entryID:"cv-live-chat-user-entry",bindEvent:"change:transactioncount",newLines:0,agentName:"Agent",activeChatSession:!1,launcherAppended:!1,proactiveLauncherAppended:!1,events:{"click #cv-live-chat-submit":"addLine"},instId:0,callId:0,tenant:"",initialize:function(options){console.log("init linkR");if("linkR"===Settings.livechatVendor){Backbone.Model.prototype.initialize.call(this,options);this.model.on(this.bindEvent,this.render,this)}},render:function(model){console.log("render linkR");var _this=this;if("true"===window.liveChatOffer&&_this.activeChatSession!==!0){window.liveChatOffer="false";var tenantskill="https://chat-am.asus.com/ChatService/info/skill?tenant=VA&channel=web";$.getJSON(tenantskill,function(skills){console.log("skills.length"+skills.length);0==skills.length?console.log("live chat service not available"):_this.launchPCS(skills)})}},keyPress:function(event,that){event.preventDefault();that.setButtonState();13==event.keyCode&&that.addLine()},setButtonState:function(){var _this=this,field_val=_this.$el.find("#"+_this.entryID).val();$.trim(field_val).length>0?_this.$el.find("#"+_this.submitID).removeClass("disabled").removeAttr("disabled"):_this.$el.find("#"+_this.submitID).addClass("disabled").prop("disabled","true")},addLine:function(){var _this=this;_this.$el.find("#"+_this.submitID).addClass("disabled").prop("disabled","true");if(""!==_this.$el.find("#"+_this.entryID).val().trim()){proxy.invoke("message",_this.callId,"text","",_this.$el.find("#"+_this.entryID).val());_this.$el.find("#"+_this.entryID).val("");window.CVMobile===!0&&$(".cv-va-bootstrap #cv-live-chat-user-entry").blur()}},launchPCS:function(skills){var _this=this;_this.livechatrendered=!0;_this.$el.find("#cv-chat-user-entry").hide();_this.$el.find("#cv-chat-submit").hide();_this.$el.find("#cv-chat-body>div:first-child").hide();_this.$el.css("top","5px");_this.previousMaxHeight=_this.$el.css("max-height");_this.previousHeight=_this.$el.css("height");_this.$el.css("max-height","925px");_this.$el.css("height","98%");_this.$el.find("#"+_this.submitID).css({"background-color":Settings.submitBtn.backgroundColor,"border-color":Settings.submitBtn.backgroundColor,"border-radius":Settings.inputBorderRadius,"font-weight":Settings.submitBtn.fontWeight,"font-size":Settings.submitBtn.fontSize});Settings.submitBtn.disabled.opacity===!0&&_this.$el.find("#"+_this.submitID+"[disabled]").css({opacity:1});_this.$el.find(".cv-chat-title").animate({color:Settings.modalHeader.backgroundColor},"fast");_this.$el.find("#cv-chat-answer-history").animate({opacity:"toggle"},"fast");setTimeout(function(){var heightModifier=Settings.modalHeader.height;window.CVMobile===!0&&(heightModifier=Settings.modalHeader.mobile.height);window.cvVaMinimized===!0&&(heightModifier="100%");_this.$el.find("#cv-chat-user-entry").hide();_this.$el.find("#cv-chat-header").animate({height:heightModifier},500,function(){var that=_this;if(Settings.vaLcTabs===!0){that.$el.find("#cv-chat-header").after('<ul class="row cv-va-tabs-container nav nav-tabs"></ul>');that.$el.find(".cv-va-tabs-container").append('<li id="va-tab" class="col-xs-6"><span>Virtual Agent</span></li>');that.$el.find(".cv-va-tabs-container").append('<li id="lc-tab" class="active col-xs-6"><span>Live Chat<i class="fa fa-times lc-close-btn"></i></span></li>');var terminateLCsessionCloseTab=function(){_this.endChat();that.$el.find("#va-tab").trigger("click");that.$el.find("#lc-tab, #cv-live-chat-answer-history, #cv-live-chat-submit, #cv-live-chat-user-entry").remove();_this.$el.find(".cv-va-tabs-container").hide(100);_this.$el.find(".cv-va-tabs-container").remove()};that.$el.find(".lc-close-btn").on("click",function(e){e.preventDefault();terminateLCsessionCloseTab()});that.$el.find("#va-tab").click(function(){that.newLines=0;that.$el.find("#va-tab").addClass("active");that.$el.find("#lc-tab").removeClass("active");that.$el.find("#cv-chat-user-entry").show();that.$el.find("#cv-chat-submit").show();that.$el.find("#cv-chat-submit").removeClass("disabled").addClass("enabled");that.$el.find("#"+_this.entryID).hide();that.$el.find("#"+_this.submitID).hide();that.$el.find(".cv-chat-va-typing").show();that.$el.find(".cv-live-chat-agent-typing").hide();that.$el.find("#cv-live-chat-answer-history").hide();that.$el.find("#cv-chat-answer-history").show();that.$el.find(".lc-close-btn").on("click",function(e){e.preventDefault();terminateLCsessionCloseTab()})});that.$el.find("#lc-tab").click(function(e){e.preventDefault();that.newLines=0;that.$el.find("#lc-tab a").html('Live Chat<i class="fa fa-times lc-close-btn"></i>');that.$el.find(".lc-close-btn").on("click",function(e){e.preventDefault();terminateLCsessionCloseTab()});that.$el.find("#lc-tab").addClass("active");that.$el.find("#va-tab").removeClass("active");that.$el.find("#"+_this.entryID).show();that.$el.find("#"+_this.submitID).show();that.$el.find("#cv-chat-submit").removeClass("enabled").addClass("disabled").prop("disabled","true");that.$el.find("#cv-chat-submit").hide();that.$el.find("#cv-chat-user-entry").hide();that.$el.find(".cv-chat-va-typing").hide();that.$el.find(".cv-live-chat-agent-typing").show();that.$el.find("#cv-live-chat-answer-history").show();that.$el.find("#cv-chat-answer-history").hide()})}else if(Settings.vaLcTabs===!1&&Settings.terminateVASession===!1){that.$el.find(".cv-chat-title").removeClass("cv-chat-title").addClass("cv-live-chat-active-title").html('<i class="fa fa-arrow-left" aria-hidden="true"></i> Back to Virtual Assistant');that.$el.find(".cv-live-chat-active-title").css({color:Settings.modalHeader.color});that.$el.find("#cv-chat-header .close").css({color:Settings.modalHeader.color,opacity:1});that.$el.find("#cv-chat-header").css({"background-color":Settings.modalHeader.backgroundColor});that.$el.find(".cv-live-chat-active-title").fadeIn();that.$el.find(".cv-live-chat-active-title").click(function(){that.newLines=0;if(that.livechatrendered){that.$el.find(".cv-live-chat-active-title").html('<i class="fa fa-arrow-left" aria-hidden="true"></i> Back to Live Chat');var connectors=model.get("connectors");if(_.isArray(connectors)&&connectors.length){that.$el.find("#cv-chat-user-entry").hide();that.$el.find("#cv-chat-submit").removeClass("disabled").removeAttr("disabled")}else{that.$el.find("#cv-chat-submit").addClass("disabled").prop("disabled","true");that.$el.find("#cv-chat-user-entry").show()}that.$el.find("#cv-chat-submit").show();that.$el.find("#cv-chat-user-entry").val().trim().length>0||!that.$el.find("#cv-chat-user-entry").is(":visible")?that.$el.find("#cv-chat-submit").removeClass("disabled").addClass("enabled"):that.$el.find("#cv-chat-submit").removeClass("enabled").addClass("disabled");that.$el.find("#"+_this.entryID).hide();that.$el.find("#"+_this.submitID).hide()}else{that.$el.find(".cv-live-chat-active-title").html('<i class="fa fa-arrow-left" aria-hidden="true"></i> Back to Virtual Assistant');that.$el.find("#cv-chat-user-entry").hide();that.$el.find("#cv-chat-submit").hide();that.$el.find("#cv-chat-submit").removeClass("enabled").addClass("disabled").prop("disabled","true");that.activeChatSession?that.$el.find("#"+_this.entryID).show():that.$el.find("#"+_this.entryID).hide();that.$el.find("#"+_this.submitID).show()}that.$el.find(".cv-chat-va-typing").toggle();that.$el.find(".cv-live-chat-agent-typing").toggle();that.$el.find("#cv-live-chat-answer-history").animate({opacity:"toggle"},"fast",function(){that.$el.find("#cv-chat-answer-history").animate({opacity:"toggle"},"fast")});that.livechatrendered=!that.livechatrendered})}else if(Settings.vaLcTabs===!1&&Settings.terminateVASession===!0){clearInterval(window.proactiveEndSessionInterval);if(that.activeChatSession)var showLCinput=setInterval(function(){if(that.$el.find("#"+that.entryID).length>0){that.$el.find("#"+that.entryID).show();clearInterval(showLCinput)}},20)}$.get(Settings.libEndpoint+"linkR-pcs",function(preChatSurvey){$("#cv-chat-body").append(preChatSurvey);$("#cv-product-line-menu").append('<option value="0">Product Line</option>');$.each(skills,function(key,val){var option=$('<option value="'+val.Id+'">'+val.Name+"</option>");$("#cv-product-line-menu").append(option)});$("#request-chat").on("click",function(){if(_this.validatePCS()){$("#linkR-pcs").hide();_this.launchLC()}})})})},500)},launchLC:function(){var _this=this;_this.$el.css("max-height",_this.previousMaxHeight);_this.$el.css("height",_this.previousHeight);_this.$el.find("#cv-close-btn").on("click",function(){_this.endChat()});_this.$el.find("#cv-chat-body").append('<div id="cv-live-chat-answer-history" class="cv-chat-history"></div>');_this.$el.find("#cv-chat-submit").parent().append('<button id="'+_this.submitID+'" type="submit" class="btn btn-primary btn-lg btn-block small-border-radius" disabled="disabled">Send Your Question</button>');window.liveChatOffer=null;var connection=$.hubConnection("signalr",{useDefaultPath:!1});connection.url="https://chat-am.asus.com/ChatService/signalr";proxy=connection.createHubProxy("entityHub");_this.proxy=proxy;proxy.on("login",function(inst){_this.instId=inst;console.log("logged in")});proxy.on("move",function(inst){_this.instId=inst});proxy.on("enqueue",function(cid,pos){var $transaction,dt,time,previous,current,lastLine;$transaction=$("<div>").addClass("cv-live-chat-info");$transaction.html("There are currently "+(pos+1)+" people waiting on this queue.");_this.$el.find("#cv-live-chat-answer-history").append($transaction);$transaction.addClass("cv-live-chat-system");dt=new Date;time="";Settings.lcTimeStamp===!0&&(time=dt.getHours()+":"+(dt.getMinutes()<10?"0":"")+dt.getMinutes());$transaction.after('<span class="time-stamp-system">Info&nbsp'+time+"</span>");previous=_this.$el.find(".cv-live-chat-user").has("span").get(-2);current=$(previous).next(".cv-live-chat-user");$(current).remove("div");lastLine=$(current).text();$(previous).append('<br><span dir="ltr">'+lastLine+"</span>");_this.$el.find("#cv-live-chat-answer-history").scrollTo(_this.$el.find("#cv-live-chat-answer-history").children().get(-1),500)});proxy.on("join",function(cid,e){_this.callId=cid;console.log(e.InstId+" , "+_this.instId);_this.activeChatSession=!0;if(e.InstId!=_this.instId){var $transaction,dt,time,previous,current,lastLine;$transaction=$("<div>").addClass("cv-live-chat-info");$transaction.html("Hi, This is ASUS Online Service Center, my name is "+e.Name+", how can I help you?");_this.$el.find("#cv-live-chat-answer-history").append($transaction);$transaction.addClass("cv-live-chat-system");dt=new Date;time="";Settings.lcTimeStamp===!0&&(time=dt.getHours()+":"+(dt.getMinutes()<10?"0":"")+dt.getMinutes());$transaction.after('<span class="time-stamp-system">Info&nbsp'+time+"</span>");previous=_this.$el.find(".cv-live-chat-user").has("span").get(-2);current=$(previous).next(".cv-live-chat-user");$(current).remove("div");lastLine=$(current).text();$(previous).append('<br><span dir="ltr">'+lastLine+"</span>");_this.$el.find("#cv-live-chat-answer-history").scrollTo(_this.$el.find("#cv-live-chat-answer-history").children().get(-1),500);_this.$el.find("#cv-chat-user-entry").parent().append('<input id="'+_this.entryID+'" type="text" name="entry" autocomplete="off" class="form-control cv-chat-user-entry" style="display: none;" placeholder="'+Settings.defaultPlaceholderText+'">');_this.$el.find("#cv-live-chat-answer-history").is(":visible")&&_this.$el.find("#"+_this.entryID).show();_this.$el.find("#"+_this.entryID).css({"font-size":Settings.inputFontSize,"border-radius":Settings.inputBorderRadius});_this.$el.find("#"+_this.entryID).keyup(function(event){_this.keyPress(event,_this)})}});proxy.on("leave",function(cid,e,l){console.log(e.InstId+" // "+_this.instId);if(e.InstId==_this.instId&&"LeaveChat"==l){$("#pretyping").empty();proxy.invoke("logout");var $transaction,dt,time,previous,current,lastLine;$transaction=$("<div>").addClass("cv-live-chat-info");$transaction.html("The conversation ended.");_this.$el.find("#cv-live-chat-answer-history").append($transaction);$transaction.addClass("cv-live-chat-system");dt=new Date;time="";Settings.lcTimeStamp===!0&&(time=dt.getHours()+":"+(dt.getMinutes()<10?"0":"")+dt.getMinutes());$transaction.after('<span class="time-stamp-system">Info&nbsp'+time+"</span>");previous=_this.$el.find(".cv-live-chat-user").has("span").get(-2);current=$(previous).next(".cv-live-chat-user");$(current).remove("div");lastLine=$(current).text();$(previous).append('<br><span dir="ltr">'+lastLine+"</span>");_this.$el.find("#"+_this.submitID).addClass("disabled").prop("disabled","true");_this.$el.find("#cv-live-chat-user-entry").hide();_this.$el.find("#cv-live-chat-answer-history").scrollTo(_this.$el.find("#cv-live-chat-answer-history").children().get(-1),500)}});proxy.on("message",function(cid,m){var $transaction,dt,time;if("User"===m.SenderType){$transaction=$("<div>").addClass("cv-live-chat-user");$transaction.html(m.Content).wrapInner("<span></span>");_this.$el.find("#cv-live-chat-answer-history").append($transaction);_this.$el.find(".cv-live-chat-user").last().wrap('<div class="col-xs-12"></div>');dt=new Date;time="";time=dt.getHours()+":"+(dt.getMinutes()<10?"0":"")+dt.getMinutes();_this.$el.find(".cv-live-chat-user").last().after('<span class="time-stamp-user">You '+time+"</span>");_this.$el.find(".cv-live-chat-user").addClass("ts-shim")}else{$transaction=$("<div>").addClass("cv-live-chat-info");$transaction.html(m.Content.replace("<div","<span").replace("</div>","</span>"));_this.$el.find("#cv-live-chat-answer-history").append($transaction);$transaction.addClass("cv-live-chat-agent");_this.$el.find(".cv-live-chat-agent").last().wrap('<div class="col-xs-12"></div>');dt=new Date;time="";time=dt.getHours()+":"+(dt.getMinutes()<10?"0":"")+dt.getMinutes();_this.$el.find(".cv-live-chat-agent").last().after('<span class="time-stamp-info">'+m.SenderName+"&nbsp"+time+"</span>");_this.$el.find(".cv-live-chat-agent").addClass("ts-shim");if(!_this.$el.find("#cv-live-chat-answer-history").is(":visible")){_this.newLines++;_this.$el.find(".cv-live-chat-active-title").html('<i class="fa fa-arrow-left" aria-hidden="true"></i> <span style="margin-right:10px;">Back to Live Chat </span>'+_this.newLines+' <i class="fa fa-comment lc-fa-comment" aria-hidden="true"></i>');Settings.vaLcTabs===!0&&_this.$el.find("#lc-tab a").html("Live Chat "+_this.newLines+' <i class="fa fa-comment" aria-hidden="true"></i><i class="fa fa-times lc-close-btn"></i></a>')}}_this.$el.find("#cv-live-chat-answer-history").scrollTo(_this.$el.find("#cv-live-chat-answer-history").children().get(-1),500)});proxy.on("timeout",function(cid){});proxy.on("typing",function(cid,instId,content){});connection.stateChanged(function(state){if(0==state.oldState&&1==state.newState){console.log(_this.instId+"///"+_this.instId.length);window.cvInstId&&proxy.invoke("move",_this.tenant,window.cvInstId)}console.log(state)});connection.disconnected(function(){setTimeout(function(){connection.start()},5e3)});connection.qs={tenant:"VA"};connection.start().done(function(){$(window).on("unload",function(){proxy.invoke("logout")});_this.tenant="VA";var o=new Object;o.PhoneNo=_this.$el.find("#cv-pnum").val();o.EMail=_this.$el.find("#cv-email").val();o.Inquiry="0"!==_this.$el.find("#cv-problem-type-menu").val()?_this.$el.find("#cv-problem-type-menu").val():"Other";o.Attr1=_this.$el.find("#cv-pnum").val();o.Attr2=_this.$el.find("#cv-email").val();o.Attr4=_this.$el.find("#cv-product-line-menu").val();o.Attr3="0"!==_this.$el.find("#cv-problem-type-menu").val()?_this.$el.find("#cv-problem-type-menu").val():"Other";o.Attr5=_this.$el.find("#cv-fname").val();o.Attr6=_this.$el.find("#cv-lname").val();o.Attr7=_this.$el.find("#cv-case").val();o.Attr8=_this.$el.find("#cv-serial-n").val();o.Attr9=_this.$el.find("#cv-question").val();o.Attr10=_this.$el.find('input[name="cv-country"]:checked').val();var fullname=o.Attr6+" "+o.Attr5;o.Name=fullname;proxy.invoke("userLogin","VA","web","",fullname,o.PhoneNo,o.EMail,o.Attr4,o)}).fail(function(){alert("Could not connect");
})},endChat:function(context){console.log("endchat");var _this=this;context&&(_this=context);if(_this.activeChatSession){console.log("logout sent");_this.proxy.invoke("logout")}if(Settings.terminateVASession===!0){clearInterval(window.proactiveEndSessionInterval);clearInterval(window.cvVaSaveState);localStorage.removeItem(Settings.businessName+"-cvVaBootstrapState");localStorage.removeItem(Settings.businessName+"-cvVaModel");localStorage.removeItem(Settings.businessName+"-cvVaStyles");localStorage.removeItem(Settings.businessName+"-cvVaInitCall");localStorage.removeItem(Settings.businessName+"-cvVaCollectionLength");localStorage.removeItem(Settings.businessName+"-cvVaTimestamp");window.cvVaCollectionLength=void 0;window.cvVaModel=void 0;window.cvVaMinimized=void 0;window.resizableAttached=void 0;window.localInitCall=void 0;window.sessionFlushInterval=setInterval(function(){clearInterval(window.proactiveEndSessionInterval);clearInterval(window.cvVaSaveState);localStorage.removeItem(Settings.businessName+"-cvVaBootstrapState");localStorage.removeItem(Settings.businessName+"-cvVaModel");localStorage.removeItem(Settings.businessName+"-cvVaStyles");localStorage.removeItem(Settings.businessName+"-cvVaInitCall");localStorage.removeItem(Settings.businessName+"-cvVaCollectionLength");localStorage.removeItem(Settings.businessName+"-cvVaTimestamp");window.cvVaCollectionLength=void 0;window.cvVaModel=void 0;window.cvVaMinimized=void 0;window.resizableAttached=void 0;window.localInitCall=void 0},0);setTimeout(function(){window.cvCrossStorage.onConnect().then(function(){return window.cvCrossStorage.del(Settings.businessName+"-cvVaBootstrapState",Settings.businessName+"-cvVaModel",Settings.businessName+"-cvVaStyles",Settings.businessName+"-cvVaInitCall",Settings.businessName+"-cvVaCollectionLength",Settings.businessName+"-cvVaTimestamp",Settings.businessName+"-lpSessionEndedExternal")}).then(function(res){window.loadFromStorage=!1;_this.model.closeSession();clearInterval(window.sessionFlushInterval);window.resetVA()})},150)}},validatePCS:function(){var _this=this,passedValidation=!0;_this.$el.find(".pcs-field-error").removeClass("pcs-field-error");if("0"===$("#cv-product-line-menu").val()){$("#cv-product-line-menu").addClass("pcs-field-error");passedValidation=!1}if(0===$("#cv-fname").val().length){$("#cv-fname").focus();$("#cv-fname").addClass("pcs-field-error");passedValidation=!1}if(0==$("#cv-lname").val().length){$("#cv-lname").focus();$("#cv-lname").addClass("pcs-field-error");passedValidation=!1}if(0==$("#cv-serial-n").val().length){$("#cv-serial-n").focus();$("#cv-serial-n").addClass("pcs-field-error");passedValidation=!1}if(0==$("#cv-question").val().length){$("#cv-question").focus();$("#cv-question").addClass("pcs-field-error");passedValidation=!1}if(0===$("#cv-email").val().length||!_this.validateEmail($("#cv-email").val())){$("#cv-email").focus();$("#cv-email").addClass("pcs-field-error");passedValidation=!1}if(0===$("#cv-pnum").val().length||!_this.validatePhone($("#cv-pnum").val())){$("#cv-pnum").focus();$("#cv-pnum").addClass("pcs-field-error");passedValidation=!1}if(!$("#cv-privacy").prop("checked")){alert("You need to accept the Terms of Use and Privacy Policy to continue.");$("#cv-privacy").focus();passedValidation=!1}return passedValidation},validateEmail:function(mail){var filter=(document.getElementById("txtEmail"),/^([a-zA-Z0-9_\.\-])+\@(([a-zA-Z0-9\-])+\.)+([a-zA-Z0-9]{2,4})+$/);return filter.test(mail)?!0:!1},validatePhone:function(phone){var filter=/[0-9]/g;return filter.test(phone)?!0:!1}});return LiveChat});define("views/virtual_assistant/components/genesys",["jquery","jquery_ui","backbone","settings","scrollto"],function($,$ui,Backbone,Settings,ScrollTo){var LiveChat=Backbone.View.extend({el:".cv-va-bootstrap #cv-chat-content",submitID:"cv-live-chat-submit",entryID:"cv-live-chat-user-entry",bindEvent:"change:transactioncount",newLines:0,agentName:"Agent",launcherAppended:!1,proactiveLauncherAppended:!1,events:{"click #cv-live-chat-submit":"addLine"},chatSessionData:{},userTypingTimeoutId:null,initialize:function(options){var _this=this;if("genesys"===Settings.livechatVendor){Backbone.Model.prototype.initialize.call(this,options);_this.model.on(this.bindEvent,this.render,this);window.CVVA.methods.sendEscalationData=function(data){console.log(data);window.cvCrossStorage.onConnect().then(function(){return window.cvCrossStorage.set(Settings.businessName+"-pcsData_genesys",JSON.stringify(data))});localStorage.setItem(Settings.businessName+"-pcsData_genesys",JSON.stringify(data))};if(window.CVVA.iframeMode){var pcsListener=function(event){if(event.data&&event.data.hasOwnProperty("custFirstName")){console.log(event);window.cvCrossStorage.onConnect().then(function(){return window.cvCrossStorage.set(Settings.businessName+"-pcsData_genesys",JSON.stringify(event.data))});localStorage.setItem(Settings.businessName+"-pcsData_genesys",JSON.stringify(event.data))}};window.addEventListener("message",pcsListener,!1)}if(localStorage.getItem(Settings.businessName+"-chatSessionData_genesys")){_this.chatSessionData=JSON.parse(localStorage.getItem(Settings.businessName+"-chatSessionData_genesys"));$("#cv-close-btn").on("click",function(e){_this.endChat()});localStorage.getItem(Settings.businessName+"-agentPickedUp_genesys")&&_this.$el.find("#"+_this.entryID).keyup(function(event){_this.keyPress(event,_this)});_this.startChatSession()}else if(localStorage.getItem(Settings.businessName+"-requestingChat_genesys")){$("#cv-close-btn").on("click",function(e){_this.endChat()});_this.requestChat()}else localStorage.getItem(Settings.businessName+"-genesysSessionEnded_external")&&$("#cv-close-btn").on("click",function(e){_this.endChat()})}},render:function(model){console.log("render genesys");var livechatOffer,_this=this,launchLC=function(){if(window.livechatTriggered!==!0){_this.livechatrendered=!0;_this.$el.find("#cv-chat-user-entry").hide();_this.$el.find("#cv-chat-submit").hide();_this.$el.find("#cv-chat-submit").parent().append('<button id="'+_this.submitID+'" type="submit" class="btn btn-primary btn-lg btn-block small-border-radius" disabled="disabled">'+Settings.submitBtn.text+"</button>");_this.$el.find("#"+_this.submitID).css({"background-color":Settings.submitBtn.backgroundColor,"border-color":Settings.submitBtn.backgroundColor,"border-radius":Settings.inputBorderRadius,"font-weight":Settings.submitBtn.fontWeight,"font-size":Settings.submitBtn.fontSize});Settings.submitBtn.disabled.opacity===!0&&_this.$el.find("#"+_this.submitID+"[disabled]").css({opacity:1});_this.$el.find(".cv-chat-title").animate({color:Settings.modalHeader.backgroundColor},"fast");_this.$el.find("#cv-chat-answer-history").animate({opacity:"toggle"},"fast");setTimeout(function(){var heightModifier=Settings.modalHeader.height;window.CVMobile===!0&&(heightModifier=Settings.modalHeader.mobile.height);window.cvVaMinimized===!0&&(heightModifier="100%");_this.$el.find("#cv-chat-user-entry").hide();_this.$el.find("#cv-chat-header").animate({height:heightModifier},500,function(){var that=_this;if(Settings.vaLcTabs===!0){that.$el.find("#cv-chat-header").after('<ul class="row cv-va-tabs-container nav nav-tabs"></ul>');that.$el.find(".cv-va-tabs-container").append('<li id="va-tab" class="col-xs-6"><span>Virtual Agent</span></li>');that.$el.find(".cv-va-tabs-container").append('<li id="lc-tab" class="active col-xs-6"><span>Live Chat<i class="fa fa-times lc-close-btn"></i></span></li>');var terminateLCsessionCloseTab=function(){_this.endChat();that.$el.find("#va-tab").trigger("click");that.$el.find("#lc-tab, #cv-live-chat-answer-history, #cv-live-chat-submit, #cv-live-chat-user-entry").remove();_this.$el.find(".cv-va-tabs-container").hide(100);_this.$el.find(".cv-va-tabs-container").remove()};that.$el.find(".lc-close-btn").on("click",function(e){e.preventDefault();terminateLCsessionCloseTab()});that.$el.find("#va-tab").click(function(){that.newLines=0;that.$el.find("#va-tab").addClass("active");that.$el.find("#lc-tab").removeClass("active");that.$el.find("#cv-chat-user-entry").show();that.$el.find("#cv-chat-submit").show();that.$el.find("#cv-chat-submit").removeClass("disabled").addClass("enabled");that.$el.find("#"+_this.entryID).hide();that.$el.find("#"+_this.submitID).hide();that.$el.find(".cv-chat-va-typing").show();that.$el.find(".cv-live-chat-agent-typing").hide();that.$el.find("#cv-live-chat-answer-history").hide();that.$el.find("#cv-chat-answer-history").show();that.$el.find(".lc-close-btn").on("click",function(e){e.preventDefault();terminateLCsessionCloseTab()})});that.$el.find("#lc-tab").click(function(e){e.preventDefault();that.newLines=0;that.$el.find("#lc-tab a").html('Live Chat<i class="fa fa-times lc-close-btn"></i>');that.$el.find(".lc-close-btn").on("click",function(e){e.preventDefault();terminateLCsessionCloseTab()});that.$el.find("#lc-tab").addClass("active");that.$el.find("#va-tab").removeClass("active");that.$el.find("#"+_this.entryID).show();that.$el.find("#"+_this.submitID).show();that.$el.find("#cv-chat-submit").removeClass("enabled").addClass("disabled").prop("disabled","true");that.$el.find("#cv-chat-submit").hide();that.$el.find("#cv-chat-user-entry").hide();that.$el.find(".cv-chat-va-typing").hide();that.$el.find(".cv-live-chat-agent-typing").show();that.$el.find("#cv-live-chat-answer-history").show();that.$el.find("#cv-chat-answer-history").hide()})}else if(Settings.vaLcTabs===!1&&Settings.terminateVASession===!1){that.$el.find(".cv-chat-title").removeClass("cv-chat-title").addClass("cv-live-chat-active-title").html('<i class="fa fa-arrow-left" aria-hidden="true"></i> Back to Virtual Assistant');that.$el.find(".cv-live-chat-active-title").css({color:Settings.modalHeader.color});that.$el.find("#cv-chat-header .close").css({color:Settings.modalHeader.color,opacity:1});that.$el.find("#cv-chat-header").css({"background-color":Settings.modalHeader.backgroundColor});that.$el.find(".cv-live-chat-active-title").fadeIn();that.$el.find(".cv-live-chat-active-title").click(function(){that.newLines=0;if(that.livechatrendered){that.$el.find(".cv-live-chat-active-title").html('<i class="fa fa-arrow-left" aria-hidden="true"></i> Back to Live Chat');var connectors=model.get("connectors");if(_.isArray(connectors)&&connectors.length){that.$el.find("#cv-chat-user-entry").hide();that.$el.find("#cv-chat-submit").removeClass("disabled").removeAttr("disabled")}else{that.$el.find("#cv-chat-submit").addClass("disabled").prop("disabled","true");that.$el.find("#cv-chat-user-entry").show()}that.$el.find("#cv-chat-submit").show();that.$el.find("#cv-chat-user-entry").val().trim().length>0||!that.$el.find("#cv-chat-user-entry").is(":visible")?that.$el.find("#cv-chat-submit").removeClass("disabled").addClass("enabled"):that.$el.find("#cv-chat-submit").removeClass("enabled").addClass("disabled");that.$el.find("#"+_this.entryID).hide();that.$el.find("#"+_this.submitID).hide()}else{that.$el.find(".cv-live-chat-active-title").html('<i class="fa fa-arrow-left" aria-hidden="true"></i> Back to Virtual Assistant');that.$el.find("#cv-chat-user-entry").hide();that.$el.find("#cv-chat-submit").hide();that.$el.find("#cv-chat-submit").removeClass("enabled").addClass("disabled").prop("disabled","true");localStorage.getItem(Settings.businessName+"-chatSessionData_genesys")?that.$el.find("#"+_this.entryID).show():that.$el.find("#"+_this.entryID).hide();that.$el.find("#"+_this.submitID).show()}that.$el.find(".cv-chat-va-typing").toggle();that.$el.find(".cv-live-chat-agent-typing").toggle();that.$el.find("#cv-live-chat-answer-history").animate({opacity:"toggle"},"fast",function(){that.$el.find("#cv-chat-answer-history").animate({opacity:"toggle"},"fast")});that.livechatrendered=!that.livechatrendered})}else if(Settings.vaLcTabs===!1&&Settings.terminateVASession===!0){clearInterval(window.proactiveEndSessionInterval);if(localStorage.getItem(Settings.businessName+"-chatSessionData_genesys"))var showLCinput=setInterval(function(){if(that.$el.find("#"+that.entryID).length>0){that.$el.find("#"+that.entryID).show();clearInterval(showLCinput)}},20)}_this.$el.find("#cv-chat-body").append('<div id="cv-live-chat-answer-history" class="cv-chat-history"></div>');_this.requestChat()})},500)}};if(void 0!==model.get(Settings.livechatOfferETV)&&Settings.liveperson.leTag.enabled===!1){livechatOffer=model.get(Settings.livechatOfferETV).toLowerCase();if("true"===livechatOffer&&!localStorage.getItem(Settings.businessName+"-chatSessionData_genesys")){$("#cv-close-btn").on("click",function(e){_this.endChat()});launchLC()}}},requestChat:function(){var _this=this,chatData={headers:{appName:"chatBot.resi",accessKey:"chatBot.resi",channel:"chat",lang:"en-us"},chatData:{},kvpUserData:{InitiationDate:(new Date).toString(),Source:"chatBot.resi"}},escalationData=JSON.parse(localStorage.getItem(Settings.businessName+"-pcsData_genesys"));chatData.headers.transactionId=_this.model.get("ident").substring(0,8);chatData.chatData.custFirstName=escalationData.custFirstName;chatData.chatData.custLastName=escalationData.custLastName;chatData.chatData.emailAddress=escalationData.emailAddress;chatData.kvpUserData.optId=escalationData.optId;chatData.kvpUserData.ServiceSubType=_this.model.get("livechatskillsubtype");chatData.kvpUserData.CustProd=_this.model.get("livechatskill");chatData.kvpUserData.subject=_this.model.get("userintent");chatData.kvpUserData.PhoneNumber=escalationData.PhoneNumber;window.CVSaveAttributes&&window.CVSaveAttributes();window.cvCrossStorage.onConnect().then(function(){console.log("requesting livechat");window.cvCrossStorage.set(Settings.businessName+"-requestingChat_genesys","true");localStorage.setItem(Settings.businessName+"-requestingChat_genesys","true");window.cvCrossStorage.del(Settings.businessName+"-genesysSessionEnded_external");localStorage.removeItem(Settings.businessName+"-genesysSessionEnded_external");$.ajax({type:"POST",url:Settings.genesys.hashingEndpoint,dataType:"json",data:{chatData:chatData,ident:_this.model.get("ident")}}).done(function(data){if(data.error){window.cvCrossStorage.onConnect().then(function(){return window.cvCrossStorage.set(Settings.businessName+"-genesysSessionEnded_external","true")});localStorage.setItem(Settings.businessName+"-genesysSessionEnded_external","true");_this.addUnavailableMessage();_this.$el.find("#cv-chat-loader-layer").hide();console.log("no LC service available");console.log(data.error)}else{_this.chatSessionData=data.genesysResponse.chatData;window.cvCrossStorage.onConnect().then(function(){window.cvCrossStorage.del(Settings.businessName+"-requestingChat_genesys");return window.cvCrossStorage.set(Settings.businessName+"-chatSessionData_genesys",JSON.stringify(data.genesysResponse.chatData))});localStorage.removeItem(Settings.businessName+"-requestingChat_genesys");localStorage.setItem(Settings.businessName+"-chatSessionData_genesys",JSON.stringify(data.genesysResponse.chatData));console.log(data.genesysResponse.chatData);_this.startChatSession()}}).fail(function(jqXHR,status,error){window.cvCrossStorage.onConnect().then(function(){return window.cvCrossStorage.set(Settings.businessName+"-genesysSessionEnded_external","true")});localStorage.setItem(Settings.businessName+"-genesysSessionEnded_external","true");_this.addUnavailableMessage();_this.$el.find("#cv-chat-loader-layer").hide();console.log(status+" - "+error)})})},startChatSession:function(){var _this=this,requesting=!1,refreshChat=function(){if(requesting===!1){requesting=!0;$.ajax({type:"GET",url:Settings.genesys.lcEndpoint+"/cvContactUs/rest/chat/refresh",data:_this.chatSessionData}).done(function(data){requesting=!1;if(data.status.success===!0){console.log(data);_this.chatSessionData.scriptPos=data.chatUserSessionData.scriptPos;window.cvCrossStorage.onConnect().then(function(){return window.cvCrossStorage.set(Settings.businessName+"-chatSessionData_genesys",JSON.stringify(_this.chatSessionData))});localStorage.setItem(Settings.businessName+"-chatSessionData_genesys",JSON.stringify(_this.chatSessionData));_this.updateConnectionStatus(data);_this.updateAgentTypingStatus(data);_this.renderMessages(data)}else{_this.chatSessionData={};window.cvCrossStorage.onConnect().then(function(){return window.cvCrossStorage.del(Settings.businessName+"-chatSessionData_genesys",Settings.businessName+"-agentPickedUp_genesys")}).then(function(){return window.cvCrossStorage.set(Settings.businessName+"-genesysSessionEnded_external","true")});localStorage.setItem(Settings.businessName+"-genesysSessionEnded_external","true");localStorage.removeItem(Settings.businessName+"-chatSessionData_genesys");localStorage.removeItem(Settings.businessName+"-agentPickedUp_genesys");clearInterval(_this.refreshInterval);_this.$el.find("#cv-live-chat-submit").prop("disabled",!0);_this.$el.find("#cv-live-chat-user-entry").remove();_this.addSessionEndedMessage();console.log("chat session ended");console.log(data)}}).fail(function(jqXHR,status,error){requesting=!1;console.log(status+" - "+error)})}};refreshChat();_this.refreshInterval=setInterval(refreshChat,1e3)},updateConnectionStatus:function(data){var _this=this;localStorage.getItem(Settings.businessName+"-agentPickedUp_genesys")||data.chatUserSessionData.messages.some(function(message){if("AGENT"===message.userTypeCode){_this.$el.find("#cv-chat-user-entry").parent().append('<input id="'+_this.entryID+'" type="text" name="entry" autocomplete="off" class="form-control cv-chat-user-entry" style="display: none;" placeholder="'+Settings.defaultPlaceholderText+'">');(_this.$el.find("#cv-live-chat-answer-history").is(":visible")||Settings.vaLcTabs===!1)&&_this.$el.find("#"+_this.entryID).show();_this.$el.find("#"+_this.entryID).css({"font-size":Settings.inputFontSize,"border-radius":Settings.inputBorderRadius});_this.$el.find("#"+_this.entryID).keyup(function(event){_this.keyPress(event,_this)});$(".lc-close-btn").on("click",function(e){e.preventDefault();_this.endChat()});Settings.vaLcTabs===!1&&_this.$el.find("#cv-chat-answer-history").hide();window.cvCrossStorage.onConnect().then(function(){return window.cvCrossStorage.set(Settings.businessName+"-agentPickedUp_genesys","true")});localStorage.setItem(Settings.businessName+"-agentPickedUp_genesys","true");_this.$el.find("#cv-chat-loader-layer").hide();return!0}return!1})},updateAgentTypingStatus:function(data){var _this=this,agentTyping=data.chatUserSessionData.messages.some(function(message){if("AGENT"===message.userTypeCode&&message.text===message.userNickName+" is typing."){_this.$el.find("#cv-chat-form").before('<span class="cv-live-chat-agent-typing">'+message.userNickName+" is typing...</span>");return!0}return!1});agentTyping||_this.$el.find(".cv-live-chat-agent-typing").remove()},renderMessages:function(data){var _this=this;data.chatUserSessionData.messages.forEach(function(message){var $transaction,dt,time;if("EXTERNAL"===message.userTypeCode||"AGENT"===message.userTypeCode){if(message.text===message.userNickName+" is typing."||message.text===message.userNickName+" has stopped typing."||message.text==="Party ('"+message.userNickName+"') has left the session.")return;if(message.text==="New party ('"+message.userNickName+"') has joined the session"){message.text="You are now connected with "+message.userNickName;message.userTypeCode="EXTERNAL"}$transaction=$("<div>").addClass("cv-live-chat-info");$transaction.html(message.text.replace("<div","<span").replace("</div>","</span>").replace("Genesys Chat: ","").replace(message.userNickName+": ",""));_this.$el.find("#cv-live-chat-answer-history").append($transaction);if("EXTERNAL"===message.userTypeCode){$transaction.addClass("cv-live-chat-system");dt=new Date;time="";Settings.lcTimeStamp===!0&&(time=dt.getHours()+":"+(dt.getMinutes()<10?"0":"")+dt.getMinutes());$transaction.after('<span class="time-stamp-system">Info&nbsp'+time+"</span>")}if("AGENT"===message.userTypeCode){$transaction.addClass("cv-live-chat-agent");_this.$el.find(".cv-live-chat-agent").last().wrap('<div class="col-xs-12"></div>');dt=new Date;time="";time=dt.getHours()+":"+(dt.getMinutes()<10?"0":"")+dt.getMinutes();_this.$el.find(".cv-live-chat-agent").last().after('<span class="time-stamp-info">'+message.userNickName+"&nbsp"+time+"</span>");_this.$el.find(".cv-live-chat-agent").addClass("ts-shim")}if(!_this.$el.find("#cv-live-chat-answer-history").is(":visible")){_this.newLines++;_this.$el.find(".cv-live-chat-active-title").html('<i class="fa fa-arrow-left" aria-hidden="true"></i> <span style="margin-right:10px;">Back to Live Chat </span>'+_this.newLines+' <i class="fa fa-comment lc-fa-comment" aria-hidden="true"></i>');Settings.vaLcTabs===!0&&_this.$el.find("#lc-tab a").html("Live Chat "+_this.newLines+' <i class="fa fa-comment" aria-hidden="true"></i><i class="fa fa-times lc-close-btn"></i></a>')}}else if("CLIENT"===message.userTypeCode){if(message.text==="Party ('"+message.userNickName+"') has left the session.")return;$transaction=$("<div>").addClass("cv-live-chat-user");$transaction.html(message.text.replace(message.userNickName+": ",""));_this.$el.find("#cv-live-chat-answer-history").append($transaction);_this.$el.find(".cv-live-chat-user").last().wrap('<div class="col-xs-12"></div>');dt=new Date;time="";time=dt.getHours()+":"+(dt.getMinutes()<10?"0":"")+dt.getMinutes();_this.$el.find(".cv-live-chat-user").last().after('<span class="time-stamp-user">You '+time+"</span>");_this.$el.find(".cv-live-chat-user").addClass("ts-shim")}_this.$el.find("#cv-live-chat-answer-history").scrollTo(_this.$el.find("#cv-live-chat-answer-history").children().get(-1),500)});window.CVSaveAttributes();window.cvCrossStorage.onConnect().then(function(){return window.cvCrossStorage.set(Settings.businessName+"-cvVaTimestamp",Date.now())});localStorage.setItem(Settings.businessName+"-cvVaTimestamp",Date.now())},keyPress:function(event,that){var _this=this;event.preventDefault();that.setButtonState();13==event.keyCode&&that.addLine(event);clearTimeout(_this.userTypingTimeout);if(!_this.userTyping){_this.userTyping=!0;$.ajax({type:"GET",url:Settings.genesys.lcEndpoint+"/cvContactUs/rest/chat/userTyping",dataType:"json",data:_this.chatSessionData})}_this.userTypingTimeout=setTimeout(function(){$.ajax({type:"GET",url:Settings.genesys.lcEndpoint+"/cvContactUs/rest/chat/userStoppedTyping",dataType:"json",data:_this.chatSessionData});_this.userTyping=!1},2e3)},setButtonState:function(){var _this=this,field_val=_this.$el.find("#"+_this.entryID).val();$.trim(field_val).length>0?_this.$el.find("#"+_this.submitID).removeClass("disabled").removeAttr("disabled"):_this.$el.find("#"+_this.submitID).addClass("disabled").prop("disabled","true")},addLine:function(event){var _this=this;event.stopPropagation();event.preventDefault();_this.$el.find("#"+_this.submitID).addClass("disabled").prop("disabled","true");if(""!==_this.$el.find("#"+_this.entryID).val().trim()){_this.chatSessionData.clientMessage=this.$el.find("#"+_this.entryID).val();$.ajax({type:"GET",url:Settings.genesys.lcEndpoint+"/cvContactUs/rest/chat/send",dataType:"json",data:_this.chatSessionData});_this.$el.find("#"+_this.entryID).val("");window.CVMobile===!0&&$(".cv-va-bootstrap #cv-live-chat-user-entry").blur()}},addUnavailableMessage:function(){var $transaction,dt,time,previous,current,lastLine,_this=this;$transaction=$("<div>").addClass("cv-live-chat-info");$transaction.html(decodeURIComponent(Settings.genesys.unavailableMessage));$transaction.addClass("cv-live-chat-system");_this.$el.find("#cv-live-chat-answer-history").append($transaction);dt=new Date;time="";Settings.lcTimeStamp===!0&&(time=dt.getHours()+":"+(dt.getMinutes()<10?"0":"")+dt.getMinutes());$transaction.after('<span class="time-stamp-system">Info&nbsp'+time+"</span>");previous=_this.$el.find(".cv-live-chat-info").get(-2);current=$(previous).next(".cv-live-chat-info");$(current).remove("div");lastLine=$(current).text();$(previous).append('<br><span dir="ltr">'+lastLine+"</span>")},addSessionEndedMessage:function(){var $transaction,dt,time,previous,current,lastLine,_this=this;$transaction=$("<div>").addClass("cv-live-chat-info");$transaction.html(decodeURIComponent("Chat session ended."));$transaction.addClass("cv-live-chat-system");_this.$el.find("#cv-live-chat-answer-history").append($transaction);dt=new Date;time="";Settings.lcTimeStamp===!0&&(time=dt.getHours()+":"+(dt.getMinutes()<10?"0":"")+dt.getMinutes());$transaction.after('<span class="time-stamp-system">Info&nbsp'+time+"</span>");previous=_this.$el.find(".cv-live-chat-info").get(-2);current=$(previous).next(".cv-live-chat-info");$(current).remove("div");lastLine=$(current).text();$(previous).append('<br><span dir="ltr">'+lastLine+"</span>");_this.$el.find("#cv-chat-loader-layer").hide()},endChat:function(context){var _this=this;if(localStorage.getItem(Settings.businessName+"-chatSessionData_genesys")||localStorage.getItem(Settings.businessName+"-genesysSessionEnded_external")){if(localStorage.getItem(Settings.businessName+"-chatSessionData_genesys")){$.ajax({type:"GET",url:Settings.genesys.lcEndpoint+"/cvContactUs/rest/chat/disconnect",dataType:"json",data:_this.chatSessionData});clearInterval(_this.refreshInterval)}setTimeout(function(){_this.chatSessionData={};window.cvCrossStorage.onConnect().then(function(){return window.cvCrossStorage.del(Settings.businessName+"-chatSessionData_genesys",Settings.businessName+"-agentPickedUp_genesys",Settings.businessName+"-genesysSessionEnded_external")}).then(function(){localStorage.removeItem(Settings.businessName+"-chatSessionData_genesys");localStorage.removeItem(Settings.businessName+"-agentPickedUp_genesys");localStorage.removeItem(Settings.businessName+"-genesysSessionEnded_external");_this.model.closeSession();window.resetVA()});if(Settings.terminateVASession===!0){clearInterval(window.proactiveEndSessionInterval);clearInterval(window.cvVaSaveState);localStorage.removeItem(Settings.businessName+"-cvVaBootstrapState");localStorage.removeItem(Settings.businessName+"-cvVaModel");localStorage.removeItem(Settings.businessName+"-cvVaStyles");localStorage.removeItem(Settings.businessName+"-cvVaInitCall");localStorage.removeItem(Settings.businessName+"-cvVaCollectionLength");localStorage.removeItem(Settings.businessName+"-cvVaTimestamp");window.cvVaCollectionLength=void 0;window.cvVaModel=void 0;window.cvVaMinimized=void 0;window.resizableAttached=void 0;window.localInitCall=void 0;window.sessionFlushInterval=setInterval(function(){clearInterval(window.proactiveEndSessionInterval);clearInterval(window.cvVaSaveState);localStorage.removeItem(Settings.businessName+"-cvVaBootstrapState");localStorage.removeItem(Settings.businessName+"-cvVaModel");localStorage.removeItem(Settings.businessName+"-cvVaStyles");localStorage.removeItem(Settings.businessName+"-cvVaInitCall");localStorage.removeItem(Settings.businessName+"-cvVaCollectionLength");localStorage.removeItem(Settings.businessName+"-cvVaTimestamp");window.cvVaCollectionLength=void 0;window.cvVaModel=void 0;window.cvVaMinimized=void 0;window.resizableAttached=void 0;window.localInitCall=void 0},0);setTimeout(function(){window.cvCrossStorage.onConnect().then(function(){return window.cvCrossStorage.del(Settings.businessName+"-cvVaBootstrapState",Settings.businessName+"-cvVaModel",Settings.businessName+"-cvVaStyles",Settings.businessName+"-cvVaInitCall",Settings.businessName+"-cvVaCollectionLength",Settings.businessName+"-cvVaTimestamp")}).then(function(res){window.loadFromStorage=!1;clearInterval(window.sessionFlushInterval)})},150)}},500)}}});return LiveChat});define("views/virtual_assistant/components/print_transcript",["jquery","underscore_loader","backbone"],function($,_,Backbone){var PrintTranscript=Backbone.View.extend({el:"#print_transcript",min_transactions:2,events:{click:"handle"},initialize:function(options){Backbone.View.prototype.initialize.call(this,options);this.render(this.model,this.collection);this.min_transactions=options.min_transactions||this.min_transactions;this.collection.on("add remove reset",this.render,this)},render:function(model,collection){this.collection.length<this.min_transactions?this.$el.addClass("disabled"):this.$el.removeClass("disabled");return this},handle:function(evt){evt.preventDefault();$(evt.target).hasClass("disabled")||window.print()}});return PrintTranscript});define("views/virtual_assistant/components/launcher",["jquery","jquery_ui","backbone","settings"],function($,$ui,Backbone,Settings){var Launcher=Backbone.View.extend({el:"cv-va-opener",customLauncherInjectedIndex:-1,initialize:function(options){Backbone.View.prototype.initialize.call(this,options);var i,j,renderedCustomLauncher,launcherStyleTags='<style class="cv-va-launcher-styles">';for(i=0;i<Settings.customLaunchers.length;i++){renderedCustomLauncher=!1;if(window.CVMobile===!1){for(j=0;j<Settings.customLaunchers[i].url.length;j++)if(Settings.customLaunchers[i].desktop===!0&&window.location.href.indexOf(Settings.customLaunchers[i].url[j])>-1&&$(Settings.customLaunchers[i].elementSelector).length>0){launcherStyleTags=Settings.customLaunchers[i].launcherStyle.replace(/QUOTES/g,'"').replace("LIBENDPOINT",Settings.libEndpoint);this.customLauncherInjectedIndex=i;if(!renderedCustomLauncher){$(launcherStyleTags).appendTo("head");this.render(Settings.customLaunchers[i].elementSelector,!0)}renderedCustomLauncher=!0}}else if(window.CVMobile===!0)for(j=0;j<Settings.customLaunchers[i].url.length;j++)if(Settings.customLaunchers[i].mobile===!0&&window.location.href.indexOf(Settings.customLaunchers[i].url[j])>-1&&$(Settings.customLaunchers[i].elementSelector).length>0){launcherStyleTags=Settings.customLaunchers[i].launcherStyle.replace(/QUOTES/g,'"').replace("LIBENDPOINT",Settings.libEndpoint);this.customLauncherInjectedIndex=i;if(!renderedCustomLauncher){$(launcherStyleTags).appendTo("head");this.render(Settings.customLaunchers[i].elementSelector,!0)}renderedCustomLauncher=!0}}if(this.customLauncherInjectedIndex<0){launcherStyleTags+=".cv-va-opener, .cv-va-opener:hover {";if("liveperson"!==Settings.livechatVendor||Settings.liveperson.leTag.injectOnLauncher===!1){launcherStyleTags+="position: fixed !important;";launcherStyleTags+="pointer-events: all;";launcherStyleTags=launcherStyleTags+"left: "+Settings.launcherCSS.left+";";launcherStyleTags=launcherStyleTags+"right: "+Settings.launcherCSS.right+";";launcherStyleTags=launcherStyleTags+"top:"+Settings.launcherCSS.top+";";launcherStyleTags=launcherStyleTags+"bottom:"+Settings.launcherCSS.bottom+";";launcherStyleTags=launcherStyleTags+"background-color: "+Settings.launcherCSS.backgroundColor+";";launcherStyleTags=launcherStyleTags+"border: "+(Settings.launcherCSS.border||"none")+";";launcherStyleTags=launcherStyleTags+"color: "+Settings.launcherCSS.color+";";launcherStyleTags+="text-align: center;";launcherStyleTags+="text-decoration: none;";launcherStyleTags+="display: inline-block;";launcherStyleTags+="cursor: pointer;";launcherStyleTags=launcherStyleTags+"z-index: "+(Settings.launcherCSS.zIndex||"9999999")+";";launcherStyleTags=launcherStyleTags+"-webkit-box-shadow: "+(Settings.launcherCSS.boxShadow||"none")+";";launcherStyleTags=launcherStyleTags+"-moz-box-shadow: "+(Settings.launcherCSS.boxShadow||"none")+";";launcherStyleTags=launcherStyleTags+"box-shadow: "+(Settings.launcherCSS.boxShadow||"none")+";";launcherStyleTags+="padding: 10px;";launcherStyleTags=launcherStyleTags+"width: "+Settings.launcherCSS.width+";";launcherStyleTags=launcherStyleTags+"border-radius: "+Settings.launcherCSS.borderRadius+";";launcherStyleTags=launcherStyleTags+"height: "+(Settings.launcherCSS.height||"initial")+";";launcherStyleTags+="outline: none;";launcherStyleTags=launcherStyleTags+"filter: "+Settings.launcherCSS.filter+";";launcherStyleTags=launcherStyleTags+"margin: "+Settings.launcherCSS.margin+";";launcherStyleTags+="}";launcherStyleTags+=".cv-va-opener i {";launcherStyleTags+="font-size: 38px !important;";launcherStyleTags+="}";launcherStyleTags+=".cv-va-opener div:first-child {";launcherStyleTags+="margin-top: -7px;";
launcherStyleTags=launcherStyleTags+"display: "+Settings.launcherCSS.displayChildren+";";launcherStyleTags+="}";launcherStyleTags+=".cv-va-opener div:nth-child(2) {";launcherStyleTags+="line-height: 10px;";launcherStyleTags=launcherStyleTags+"font-family: "+Settings.fontfamily+";";launcherStyleTags+="font-weight: bold;";launcherStyleTags=launcherStyleTags+"font-size: "+Settings.launcherCSS.fontSize+";";launcherStyleTags+="margin-top: 4px;";launcherStyleTags+="margin-bottom: -2px;";launcherStyleTags+="letter-spacing: 0.6px;";launcherStyleTags=launcherStyleTags+"display: "+Settings.launcherCSS.displayChildren+";";launcherStyleTags+="}"}else if("liveperson"===Settings.livechatVendor||Settings.liveperson.leTag.injectOnLauncher===!0){launcherStyleTags+="position: absolute !important;";launcherStyleTags+="left: 0 !important;";launcherStyleTags+="top: 0 !important;";launcherStyleTags+="right: 0 !important;";launcherStyleTags+="bottom: 0 !important;";launcherStyleTags+="background: none !important;";launcherStyleTags+="border: none; !important;";launcherStyleTags+="text-decoration: none; !important;";launcherStyleTags+="z-index: 9999999;";launcherStyleTags+="cursor: pointer;";launcherStyleTags+="width: 100% !important;";launcherStyleTags+="}"}if(Settings.launcherCSS.before===!0){launcherStyleTags+=".cv-va-opener:before {";launcherStyleTags=launcherStyleTags+"border-color: "+Settings.launcherCSS.backgroundColor+";";launcherStyleTags+="border-radius: 50%;";launcherStyleTags+="border-style: solid;";launcherStyleTags+="border-width: 0 20px;";launcherStyleTags+="bottom: 0;";launcherStyleTags+="clip: rect(20px, 35px, 42px, 0px);";launcherStyleTags+='content: " ";';launcherStyleTags+="height: 40px;";launcherStyleTags+="position: absolute;";launcherStyleTags+="right: -40px;";launcherStyleTags+="width: 30px;";launcherStyleTags+="z-index: -1;";launcherStyleTags+="box-sizing: content-box;";launcherStyleTags+="}"}launcherStyleTags+="</style>";window.CVMobile===!1&&$(launcherStyleTags).appendTo("head")}},render:function(container,prepend,css){var _this=this;console.log("render launcher");var hiddenLauncher;if(window.CVMobile===!1||Settings.selectiveInjection.device.mobile===!0){container instanceof $||(container=$(container));if(void 0===prepend||prepend===!1)if(this.customLauncherInjectedIndex<0)"liveperson"!==Settings.livechatVendor||Settings.liveperson.leTag.injectOnLauncher===!1?container.append('<button class="cv-va-bootstrap cv-va-opener" type="button"><div><i class="'+Settings.launcherCSS.fontAwesomeClass+'" aria-hidden="true"></i></div></button>'):("liveperson"===Settings.livechatVendor||Settings.liveperson.leTag.injectOnLauncher===!0)&&container.append('<button class="cv-va-opener" type="button"></button>');else{container.append(Settings.customLaunchers[this.customLauncherInjectedIndex].launcherHtml.replace(/QUOTES/g,'"'));window.CVMobile!==!0&&Settings.showMobileLauncherOnDesktop!==!0||"true"===localStorage.getItem(Settings.businessName+"-cvVaMinimized")||("true"===localStorage.getItem(Settings.businessName+"-hideLauncher")?$(".cv-hide-launcher-onClick").hide():$(".cv-va-bootstrap.cv-mobile-floating").show().removeClass("hidden"))}else if(prepend===!0)if(this.customLauncherInjectedIndex<0){if("liveperson"!==Settings.livechatVendor||Settings.liveperson.leTag.injectOnLauncher===!1)container.prepend('<button class="cv-va-bootstrap cv-va-opener" type="button"><div><i class="'+Settings.launcherCSS.fontAwesomeClass+'" aria-hidden="true"></i></div></button>');else if("liveperson"===Settings.livechatVendor||Settings.liveperson.leTag.injectOnLauncher===!0)if(void 0===css)container.prepend('<button class="cv-va-opener" type="button"></button>');else{var constant=(new Date).getMilliseconds();container.prepend('<button id="cv-va-opener-'+constant+'" class="cv-va-opener" type="button"></button>');container.find("#cv-va-opener-"+constant).css(css)}}else{container.prepend(hiddenLauncher||Settings.customLaunchers[_this.customLauncherInjectedIndex].launcherHtml.replace(/QUOTES/g,'"'));window.CVMobile!==!0&&Settings.showMobileLauncherOnDesktop!==!0||"true"===localStorage.getItem(Settings.businessName+"-cvVaMinimized")||("true"===localStorage.getItem(Settings.businessName+"-hideLauncher")?$(".cv-hide-launcher-onClick").hide():$(".cv-va-bootstrap.cv-mobile-floating").show().removeClass("hidden"))}("liveperson"!==Settings.livechatVendor||Settings.liveperson.leTag.injectOnLauncher===!1)&&this.customLauncherInjectedIndex<0&&"hide"!==Settings.launcherText&&container.find(".cv-va-opener").append("<div>"+Settings.launcherText+"</div>");Settings.launcherCSS.draggable&&container.find(".cv-va-opener").draggable({containment:"parent",axis:"x",scroll:!1,cancel:!1});var popup,hideLauncherOnClick=function(){window.CVlaunchVA();window.cvVaMinimized&&$(".cv-va-bootstrap #cv-minimize-btn").trigger("click");if(container.find(".cv-va-opener").hasClass("cv-hide-launcher-onClick")){$(".cv-hide-launcher-onClick").hide();window.cvCrossStorage.onConnect().then(function(){return window.cvCrossStorage.set(Settings.businessName+"-hideLauncher",!0)});localStorage.setItem(Settings.businessName+"-hideLauncher",!0)}};container.find(".cv-va-opener").on("click",function(event){event.stopPropagation();event.preventDefault();if(!$(this).is(".cv-ui-draggable-dragging")){$(".LPMimage").each(function(index){$(this).attr("src").indexOf("invitation/need_help_on.gif")>-1&&$(this).parent().parent().hide()});if(window.CVMobile===!1)hideLauncherOnClick();else if(Settings.mobilePopupMode===!1)hideLauncherOnClick();else{var openVApopup=function(){if(popup&&!popup.closed)popup.focus();else{var url=location.protocol+"//"+location.host+"/bot?config="+window.cvVASettings.businessName,name=window.cvVASettings.businessName+"/window";popup=window.open(url,name)}};openVApopup()}}})}},hide:function(){this.$el.hide()},show:function(){this.$el.hide()},remove:function(){this.$el.remove()}});return Launcher});define("views/virtual_assistant/components/faq_list",["jquery","underscore_loader","backbone","views/virtual_assistant/components/base"],function($,_,Backbone,Base){var FaqList=Base.extend({bindEvent:"change:faqitems",el:"#faq_list",render:function(model){var faqitems=model.get("faqitems");if(faqitems&&"string"==typeof faqitems.faqlist){this.$el.html(faqitems.faqlist);this.$el.find("ul").addClass("list-group");this.$el.find("li").addClass("cv-faq-item").css("font-size","13px");this.$el.find(".cv-faq-item").prepend('<i class="faq-item-icon fa fa-angle-double-right" aria-hidden="true"></i>')}return this}});return FaqList});define("views/virtual_assistant/components/breadcrumb",["jquery","underscore_loader","backbone","views/virtual_assistant/components/base"],function($,_,Backbone,Base){var Breadcrumb=Base.extend({bindEvent:"change:faqitems",el:"#breadcrumb",render:function(model){var faqitems=model.get("faqitems");if(faqitems&&"string"==typeof faqitems.breadcrumb){this.$el.html(faqitems.breadcrumb);this.$el.find("li").parent().addClass("breadcrumb");this.$el.find("a").has("li")?this.$el.find("a").parent().addClass("breadcrumb-item"):this.$el.find("a").wrap('<li class="breadcrumb-item"></div>');this.$el.find(".seperator").remove()}return this}});return Breadcrumb});define("views/virtual_assistant/components/dropdown",["jquery","underscore_loader","backbone","views/virtual_assistant/components/base"],function($,_,Backbone,Base){var Dropdown=Base.extend({bindEvent:"change:faqitems",el:"#dropdown",events:{"change select":"changeContext"},changeContext:function(evt){var maincat=this.model.get("maincat"),newcat=this.$el.find("select").val(),val=maincat+"."+newcat;this.model.changeContext(val)},render:function(model){var faqitems=model.get("faqitems");if(faqitems&&"string"==typeof faqitems.dropdown){this.$el.html(faqitems.dropdown);this.$el.find("select").addClass("form-control")}return this}});return Dropdown});define("views/virtual_assistant/components/text_resize",["jquery","underscore_loader","backbone"],function($,_,Backbone){var Resize=Backbone.View.extend({el:"#cv-chat-content",currentClass:"font-medium",events:{"click #cv-font-size a":"render"},render:function(evt){evt.preventDefault();var $el=$(evt.currentTarget);$("#cv-font-size i.active-cv-font-size").removeClass("active-cv-font-size");$el.find("i").addClass("active-cv-font-size");var klass="font-"+$el.data("class");this.$el.removeClass(this.currentClass).addClass(klass);this.currentClass=klass}});return Resize});define("views/virtual_assistant/components/input_launcher",["jquery","jquery_ui","backbone","settings"],function($,$ui,Backbone,Settings){var InputLauncher=Backbone.View.extend({initialize:function(options){Backbone.View.prototype.initialize.call(this,options);var inputLauncherStyleTags='<style class="cv-va-input-launcher-styles">';inputLauncherStyleTags+=".cv-va-input-launcher-container {";inputLauncherStyleTags+="border-radius: 6px;";inputLauncherStyleTags+="display: flex;";inputLauncherStyleTags+="display: -webkit-flex;";inputLauncherStyleTags+="flex-direction: column;";inputLauncherStyleTags+="-webkit-flex-direction: column;";inputLauncherStyleTags+="position: static;";inputLauncherStyleTags+="z-index: auto;";inputLauncherStyleTags+="pointer-events: all;";inputLauncherStyleTags=inputLauncherStyleTags+"background-color: "+Settings.inputLauncher.css.container.backgroundColor+";";inputLauncherStyleTags=inputLauncherStyleTags+"border: "+Settings.inputLauncher.css.container.border+";";inputLauncherStyleTags=inputLauncherStyleTags+"padding: "+Settings.inputLauncher.css.container.padding+";";inputLauncherStyleTags=inputLauncherStyleTags+"margin-top: "+Settings.inputLauncher.css.container.marginTop+";";inputLauncherStyleTags=inputLauncherStyleTags+"margin-bottom: "+Settings.inputLauncher.css.container.marginBottom+";";inputLauncherStyleTags+="}";inputLauncherStyleTags+=".cv-va-input-launcher-header {";inputLauncherStyleTags=inputLauncherStyleTags+"font-family: "+Settings.inputLauncher.css.header.fontFamily+";";inputLauncherStyleTags+="font-size: 16px;";inputLauncherStyleTags+="display: table;";inputLauncherStyleTags+="border-radius: 5px 5px 0 0;";inputLauncherStyleTags+="position: relative;";inputLauncherStyleTags+="top: 1px;";inputLauncherStyleTags+="border-bottom: none !important;";inputLauncherStyleTags=inputLauncherStyleTags+"background-color: "+Settings.inputLauncher.css.header.backgroundColor+";";inputLauncherStyleTags=inputLauncherStyleTags+"border: "+Settings.inputLauncher.css.header.border+";";inputLauncherStyleTags=inputLauncherStyleTags+"padding: "+Settings.inputLauncher.css.header.padding+";";inputLauncherStyleTags+="}";inputLauncherStyleTags+=".cv-va-input-launcher-header i {";inputLauncherStyleTags+="font-size: 18px;";inputLauncherStyleTags+="margin-left: 2px;";inputLauncherStyleTags=inputLauncherStyleTags+"color: "+Settings.submitBtn.backgroundColor+" !important;";inputLauncherStyleTags+="}";inputLauncherStyleTags+=".cv-va-input-launcher-body {";inputLauncherStyleTags+="border-radius: 0px 5px 5px 5px;";inputLauncherStyleTags=inputLauncherStyleTags+"background-color: "+Settings.inputLauncher.css.body.backgroundColor+" !important;";inputLauncherStyleTags=inputLauncherStyleTags+"border: "+Settings.inputLauncher.css.body.border+" !important;";inputLauncherStyleTags=inputLauncherStyleTags+"padding: "+Settings.inputLauncher.css.body.padding+" !important;";inputLauncherStyleTags+="}";inputLauncherStyleTags+=".cv-va-input-launcher-form {";inputLauncherStyleTags+="display: flex;";inputLauncherStyleTags+="display: -webkit-flex;";inputLauncherStyleTags+="flex-direction: row;";inputLauncherStyleTags+="-webkit-flex-direction: row;";inputLauncherStyleTags=inputLauncherStyleTags+"padding: "+Settings.inputLauncher.css.body.form.padding+" !important;";inputLauncherStyleTags+="background-color: #fff;";inputLauncherStyleTags=inputLauncherStyleTags+"border: "+Settings.inputLauncher.css.body.form.border+" !important;";inputLauncherStyleTags+="border-radius: 6px;";inputLauncherStyleTags+="}";inputLauncherStyleTags+=".cv-va-input-launcher-form input {";inputLauncherStyleTags=inputLauncherStyleTags+"margin: "+Settings.inputLauncher.css.body.input.margin+";";inputLauncherStyleTags=inputLauncherStyleTags+"height: "+Settings.inputLauncher.css.body.input.height+" !important;";inputLauncherStyleTags=inputLauncherStyleTags+"border: "+Settings.inputLauncher.css.body.input.border+" !important;";inputLauncherStyleTags=inputLauncherStyleTags+"box-shadow: "+Settings.inputLauncher.css.body.input.boxShadow+" !important;";inputLauncherStyleTags=inputLauncherStyleTags+"-webkit-box-shadow: "+Settings.inputLauncher.css.body.input.boxShadow+" !important;";inputLauncherStyleTags=inputLauncherStyleTags+"background-color: "+Settings.inputLauncher.css.body.input.backgroundColor+" !important;";inputLauncherStyleTags=inputLauncherStyleTags+"font-size: "+Settings.inputLauncher.css.body.input.fontSize+" !important;";inputLauncherStyleTags+="}";inputLauncherStyleTags+=".cv-va-input-launcher-form button {";inputLauncherStyleTags=inputLauncherStyleTags+"font-family: "+Settings.inputLauncher.css.body.button.fontFamily+" !important;";inputLauncherStyleTags+="color: #fff;";inputLauncherStyleTags=inputLauncherStyleTags+"background: "+Settings.inputLauncher.css.body.button.background+" !important;";inputLauncherStyleTags=inputLauncherStyleTags+"padding: "+Settings.inputLauncher.css.body.button.padding+" !important;";inputLauncherStyleTags=inputLauncherStyleTags+"font-size: "+Settings.inputLauncher.css.body.button.fontSize+" !important;";inputLauncherStyleTags+="}";inputLauncherStyleTags+=".cv-va-input-launcher-form button:hover, .cv-va-input-launcher-form button:focus {";inputLauncherStyleTags+="color: #fff !important;";inputLauncherStyleTags+="}";inputLauncherStyleTags+="</style>";0===$(".cv-va-input-launcher-styles").length&&$(inputLauncherStyleTags).appendTo("head")},render:function(containerSelector){var _this=this;!function checkContainerReady(){$(containerSelector).length>0?_this.onReadyToRender($(containerSelector)):setTimeout(function(){checkContainerReady()},0)}()},onReadyToRender:function(container){var $mainWrapper=$("<section>").addClass("cv-va-bootstrap cv-va-input-launcher-container"),$header=$("<div>").addClass("cv-va-input-launcher-header").html("<div>"+Settings.inputLauncher.headerText+'<i class="'+Settings.inputLauncher.headerFontAwesome+'" aria-hidden="true"></i></div>'),$body=$("<div>").addClass("cv-va-input-launcher-body"),$form=$("<div>").addClass("cv-va-input-launcher-form"),$input=$("<input>").addClass("form-control").attr("placeholder",Settings.inputLauncher.inputPlaceholder),$btn=$("<button>").addClass("btn").html(Settings.inputLauncher.submitBtnText+' <i class="'+Settings.inputLauncher.submitBtnFontawesome+'" aria-hidden="true"></i>').attr("disabled",!0);$form.append($input,$btn);$body.append($form);$mainWrapper.append($header,$body);var submitInputQuestion=function(){if(void 0==window.cvVaCollectionLength){window.CVVA.inputLauncher={trigger:!0,userQuestion:$(".cv-va-input-launcher-form input").val()||!1};$(".cv-va-input-launcher-form input").val("");$(".cv-va-input-launcher-form input").attr("disabled",!0)}window.CVlaunchVA()};if(0===$(".cv-va-bootstrap.cv-va-input-launcher-container").length){"cox"===Settings.businessName&&window.utag&&window.utag.link&&window.utag.link({eventNames:"cvInviteDisplayed"});container.prepend($mainWrapper);container.find(".cv-va-input-launcher-form button").on("click",function(evt){evt.stopPropagation();0!==$.trim($(".cv-va-input-launcher-form input").val()).length&&submitInputQuestion()});container.find(".cv-va-input-launcher-form input").on("keyup",function(event){if(0!==$.trim($(this).val()).length){container.find(".cv-va-input-launcher-form button").attr("disabled",!1);13===event.keyCode&&submitInputQuestion()}else container.find(".cv-va-input-launcher-form button").attr("disabled",!0)})}else $(".cv-va-input-launcher-form input").attr("disabled",!1);if(void 0!==window.cvVaCollectionLength){$(".cv-va-input-launcher-form input").attr("disabled",!0);container.find(".cv-va-input-launcher-form button").attr("disabled",!0)}}});return InputLauncher});define("views/virtual_assistant/index",["jquery","bootstrap","underscore_loader","backbone","views/virtual_assistant/components/container","views/virtual_assistant/components/ask_form","views/virtual_assistant/components/answer_inline","views/virtual_assistant/components/autocomplete","views/virtual_assistant/components/cv_livechat","views/virtual_assistant/components/liveperson","views/virtual_assistant/components/linkR","views/virtual_assistant/components/genesys","views/virtual_assistant/components/print_transcript","views/virtual_assistant/components/launcher","views/virtual_assistant/components/faq_list","views/virtual_assistant/components/breadcrumb","views/virtual_assistant/components/dropdown","views/virtual_assistant/components/text_resize","views/virtual_assistant/components/eocs","views/virtual_assistant/components/input_launcher","settings"],function($,Bootstrap,_,Backbone,Container,AskForm,Answer,AutoComplete,CVLivechat,Liveperson,LinkR,Genesys,PrintTranscript,Launcher,FaqList,Breadcrumb,Dropdown,TextResize,EOCS,InputLauncher,Settings){var VirtualAssistant=Backbone.View.extend({initialize:function(opts){Backbone.View.prototype.initialize.call(this,opts);this.render()},render:function(){$(Settings.trigger).off("click");$(Settings.trigger).removeProp("onclick");$(Settings.trigger).prop("href","#");var _this=this,instantiateViews=function(){_this.container=new Container({model:_this.model,collection:_this.collection});_this.ask_form=new AskForm({model:_this.model,collection:_this.collection});_this.faq_list=new FaqList({model:_this.model,collection:_this.collection});_this.breadcrumb=new Breadcrumb({model:_this.model,collection:_this.collection});_this.dropdown=new Dropdown({model:_this.model,collection:_this.collection});_this.print_transcript=new PrintTranscript({model:_this.model,collection:_this.collection});_this.eocs=new EOCS({model:_this.model,collection:_this.collection});_this.autocomplete=new AutoComplete({model:_this.model,collection:_this.collection,endpoint:Settings.endpoint||"./bot.htm"});_this.text_resize=new TextResize({model:_this.model,collection:_this.collection});if(Settings.launcherInjection===!0){var customLauncherDetected=!1;for(i=0;i<Settings.customLaunchers.length;i++)window.location.href.indexOf(Settings.customLaunchers[i].url)>-1&&$(Settings.customLaunchers[i].elementSelector).length>0&&(customLauncherDetected=!0);_this.launcher=new Launcher;if(Settings.lcAvailabilityLauncher===!1&&!customLauncherDetected&&window.CVMobile===!1)if(Settings.selectiveLauncherInjection.enabled===!0)for(i=0;i<Settings.selectiveLauncherInjection.url.length;i++)window.location.href.indexOf(Settings.selectiveLauncherInjection.url[i])>-1&&_this.launcher.render(Settings.appendLauncherTo);else Settings.showMobileLauncherOnDesktop===!1&&_this.launcher.render(Settings.appendLauncherTo)}if(Settings.inputLauncher.enabled===!0&&window.CVMobile===!1){_this.inputLauncher=new InputLauncher;if(Settings.inputLauncher.selectiveInjection.enabled===!0)for(i=0;i<Settings.inputLauncher.selectiveInjection.url.length;i++)window.location.href.indexOf(Settings.inputLauncher.selectiveInjection.url[i])>-1&&_this.inputLauncher.render(Settings.inputLauncher.appendTo);else _this.inputLauncher.render(Settings.inputLauncher.appendTo)}_this.answer=new Answer({model:_this.model,collection:_this.collection,bindEvent:"change",launcher:_this.launcher});if("liveperson"===Settings.livechatVendor){Settings.launcherInjection===!0&&Settings.lcAvailabilityLauncher===!0?_this.liveperson=new Liveperson({model:_this.model,collection:_this.collection,launcher:_this.launcher}):_this.liveperson=new Liveperson({model:_this.model,collection:_this.collection});_this.endChatLP=function(){_this.liveperson.endChat(_this.liveperson)}}else"linkR"===Settings.livechatVendor?_this.linkR=new LinkR({model:_this.model,collection:_this.collection}):"genesys"===Settings.livechatVendor&&(_this.linkR=new Genesys({model:_this.model,collection:_this.collection}));window.CVMobile===!0&&$(".cv-va-bootstrap #cv-chat-header, .cv-va-bootstrap #cv-chat-body, .cv-va-bootstrap #cv-chat-form").find("*").each(function(){})};if(Settings.persistenceEnabled===!0){window.cvCrossStorage.onConnect().then(function(){}).then(function(){return window.cvCrossStorage.get(Settings.businessName+"-cvVaContentWidth",Settings.businessName+"-cvVaContentHeight",Settings.businessName+"-cvVaMinimized")}).then(function(res){null!==res[0]&&localStorage.setItem(Settings.businessName+"-cvVaContentWidth",res[0]);null!==res[1]&&localStorage.setItem(Settings.businessName+"-cvVaContentHeight",res[1]);null!==res[2]&&localStorage.setItem(Settings.businessName+"-cvVaMinimized",res[2])});instantiateViews()}else instantiateViews()}});return VirtualAssistant});!function(root){function noop(){}function bind(fn,thisArg){return function(){fn.apply(thisArg,arguments)}}function Promise(fn){if("object"!=typeof this)throw new TypeError("Promises must be constructed via new");if("function"!=typeof fn)throw new TypeError("not a function");this._state=0;this._handled=!1;this._value=void 0;this._deferreds=[];doResolve(fn,this)}function handle(self,deferred){for(;3===self._state;)self=self._value;if(0!==self._state){self._handled=!0;Promise._immediateFn(function(){var cb=1===self._state?deferred.onFulfilled:deferred.onRejected;if(null!==cb){var ret;try{ret=cb(self._value)}catch(e){reject(deferred.promise,e);return}resolve(deferred.promise,ret)}else(1===self._state?resolve:reject)(deferred.promise,self._value)})}else self._deferreds.push(deferred)}function resolve(self,newValue){try{if(newValue===self)throw new TypeError("A promise cannot be resolved with itself.");if(newValue&&("object"==typeof newValue||"function"==typeof newValue)){var then=newValue.then;if(newValue instanceof Promise){self._state=3;self._value=newValue;finale(self);return}if("function"==typeof then){doResolve(bind(then,newValue),self);return}}self._state=1;self._value=newValue;finale(self)}catch(e){reject(self,e)}}function reject(self,newValue){self._state=2;self._value=newValue;finale(self)}function finale(self){2===self._state&&0===self._deferreds.length&&Promise._immediateFn(function(){self._handled||Promise._unhandledRejectionFn(self._value)});for(var i=0,len=self._deferreds.length;len>i;i++)handle(self,self._deferreds[i]);self._deferreds=null}function Handler(onFulfilled,onRejected,promise){this.onFulfilled="function"==typeof onFulfilled?onFulfilled:null;this.onRejected="function"==typeof onRejected?onRejected:null;this.promise=promise}function doResolve(fn,self){var done=!1;try{fn(function(value){if(!done){done=!0;resolve(self,value)}},function(reason){if(!done){done=!0;reject(self,reason)}})}catch(ex){if(done)return;done=!0;reject(self,ex)}}var setTimeoutFunc=setTimeout;Promise.prototype["catch"]=function(onRejected){return this.then(null,onRejected)};Promise.prototype.then=function(onFulfilled,onRejected){var prom=new this.constructor(noop);handle(this,new Handler(onFulfilled,onRejected,prom));return prom};Promise.all=function(arr){var args=Array.prototype.slice.call(arr);return new Promise(function(resolve,reject){function res(i,val){try{if(val&&("object"==typeof val||"function"==typeof val)){var then=val.then;if("function"==typeof then){then.call(val,function(val){res(i,val)},reject);return}}args[i]=val;0===--remaining&&resolve(args)}catch(ex){reject(ex)}}if(0===args.length)return resolve([]);for(var remaining=args.length,i=0;i<args.length;i++)res(i,args[i])})};Promise.resolve=function(value){return value&&"object"==typeof value&&value.constructor===Promise?value:new Promise(function(resolve){resolve(value)})};Promise.reject=function(value){return new Promise(function(resolve,reject){reject(value)})};Promise.race=function(values){return new Promise(function(resolve,reject){for(var i=0,len=values.length;len>i;i++)values[i].then(resolve,reject)})};Promise._immediateFn="function"==typeof setImmediate&&function(fn){setImmediate(fn)}||function(fn){setTimeoutFunc(fn,0)};Promise._unhandledRejectionFn=function(err){"undefined"!=typeof console&&console&&console.warn("Possible Unhandled Promise Rejection:",err)};Promise._setImmediateFn=function(fn){Promise._immediateFn=fn};Promise._setUnhandledRejectionFn=function(fn){Promise._unhandledRejectionFn=fn};window.Promise||(window.Promise=Promise);"undefined"!=typeof module&&module.exports?module.exports=Promise:root.Promise||(root.Promise=Promise)}(this);define("iePollyfill",function(){});!function(root){function CrossStorageClient(url,opts){opts=opts||{};this._id=CrossStorageClient._generateUUID();this._promise=opts.promise||Promise;this._frameId=opts.frameId||"CrossStorageClient-"+this._id;this._origin=CrossStorageClient._getOrigin(url);this._requests={};this._connected=!1;this._closed=!1;this._count=0;this._timeout=opts.timeout||5e3;this._listener=null;this._installListener();var frame;opts.frameId&&(frame=document.getElementById(opts.frameId));frame&&this._poll();frame=frame||this._createFrame(url);this._hub=frame.contentWindow}CrossStorageClient.frameStyle={display:"none",position:"absolute",top:"-999px",left:"-999px"};CrossStorageClient._getOrigin=function(url){var uri,protocol,origin;uri=document.createElement("a");uri.href=url;uri.host||(uri=window.location);protocol=uri.protocol&&":"!==uri.protocol?uri.protocol:window.location.protocol;origin=protocol+"//"+uri.host;origin=origin.replace(/:80$|:443$/,"");return origin};CrossStorageClient._generateUUID=function(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(c){var r=16*Math.random()|0,v="x"==c?r:3&r|8;return v.toString(16)})};CrossStorageClient.prototype.onConnect=function(){var client=this;if(this._connected)return this._promise.resolve();if(this._closed)return this._promise.reject(new Error("CrossStorageClient has closed"));this._requests.connect||(this._requests.connect=[]);return new this._promise(function(resolve,reject){var timeout=setTimeout(function(){reject(new Error("CrossStorageClient could not connect"))},client._timeout);client._requests.connect.push(function(err){clearTimeout(timeout);if(err)return reject(err);resolve()})})};CrossStorageClient.prototype.set=function(key,value){return this._request("set",{key:key,value:value})};CrossStorageClient.prototype.get=function(key){var args=Array.prototype.slice.call(arguments);return this._request("get",{keys:args})};CrossStorageClient.prototype.del=function(){var args=Array.prototype.slice.call(arguments);return this._request("del",{keys:args})};CrossStorageClient.prototype.clear=function(){return this._request("clear")};CrossStorageClient.prototype.getKeys=function(){return this._request("getKeys")};CrossStorageClient.prototype.close=function(){var frame=document.getElementById(this._frameId);frame&&frame.parentNode.removeChild(frame);window.removeEventListener?window.removeEventListener("message",this._listener,!1):window.detachEvent("onmessage",this._listener);this._connected=!1;this._closed=!0};CrossStorageClient.prototype._installListener=function(){var client=this;this._listener=function(message){var i,origin,error,response;if(!client._closed&&message.data&&"string"==typeof message.data){origin="null"===message.origin?"file://":message.origin;if(origin===client._origin)if("cross-storage:unavailable"!==message.data){if(-1!==message.data.indexOf("cross-storage:")&&!client._connected){client._connected=!0;if(!client._requests.connect)return;for(i=0;i<client._requests.connect.length;i++)client._requests.connect[i](error);delete client._requests.connect}if("cross-storage:ready"!==message.data){try{response=JSON.parse(message.data)}catch(e){return}response.id&&client._requests[response.id]&&client._requests[response.id](response.error,response.result)}}else{client._closed||client.close();if(!client._requests.connect)return;error=new Error("Closing client. Could not access localStorage in hub.");for(i=0;i<client._requests.connect.length;i++)client._requests.connect[i](error)}}};window.addEventListener?window.addEventListener("message",this._listener,!1):window.attachEvent("onmessage",this._listener)};CrossStorageClient.prototype._poll=function(){var client,interval,targetOrigin;client=this;targetOrigin="file://"===client._origin?"*":client._origin;interval=setInterval(function(){if(client._connected)return clearInterval(interval);client._hub&&client._hub.postMessage("cross-storage:poll",targetOrigin)},1e3)};CrossStorageClient.prototype._createFrame=function(url){var frame,key;frame=window.document.createElement("iframe");frame.id=this._frameId;for(key in CrossStorageClient.frameStyle)CrossStorageClient.frameStyle.hasOwnProperty(key)&&(frame.style[key]=CrossStorageClient.frameStyle[key]);window.document.body.appendChild(frame);frame.src=url;return frame};CrossStorageClient.prototype._request=function(method,params){var req,client;if(this._closed)return this._promise.reject(new Error("CrossStorageClient has closed"));client=this;client._count++;req={id:this._id+":"+client._count,method:"cross-storage:"+method,params:params};return new this._promise(function(resolve,reject){var timeout,originalToJSON,targetOrigin;timeout=setTimeout(function(){if(client._requests[req.id]){delete client._requests[req.id];reject(new Error("Timeout: could not perform "+req.method))}},client._timeout);client._requests[req.id]=function(err,result){clearTimeout(timeout);delete client._requests[req.id];if(err)return reject(new Error(err));resolve(result)};if(Array.prototype.toJSON){originalToJSON=Array.prototype.toJSON;Array.prototype.toJSON=null}targetOrigin="file://"===client._origin?"*":client._origin;client._hub.postMessage(JSON.stringify(req),targetOrigin);originalToJSON&&(Array.prototype.toJSON=originalToJSON)})};"undefined"!=typeof module&&module.exports?module.exports=CrossStorageClient:"undefined"!=typeof exports?exports.CrossStorageClient=CrossStorageClient:"function"==typeof define&&define.amd?define("crossStorage",[],function(){return CrossStorageClient}):root.CrossStorageClient=CrossStorageClient}(this);define("utils/get-param",[],function(){var _get=function(name){name=name.replace(/[\[]/,"\\[").replace(/[\]]/,"\\]");var regex=new RegExp("[\\?&]"+name+"=([^&#]*)","i"),results=regex.exec(window.location.href);return null===results?"":decodeURI(results[1])};return _get});var CVMobileDet={initCompleted:!1,isWebkit:!1,isMobilePhone:!1,isIphone:!1,isAndroid:!1,isAndroidPhone:!1,isTierTablet:!1,isTierIphone:!1,isTierRichCss:!1,isTierGenericMobile:!1,engineWebKit:"webkit",deviceIphone:"iphone",deviceIpod:"ipod",deviceIpad:"ipad",deviceMacPpc:"macintosh",deviceAndroid:"android",deviceGoogleTV:"googletv",deviceHtcFlyer:"htc_flyer",deviceWinPhone7:"windows phone os 7",deviceWinPhone8:"windows phone 8",deviceWinMob:"windows ce",deviceWindows:"windows",deviceIeMob:"iemobile",devicePpc:"ppc",enginePie:"wm5 pie",deviceBB:"blackberry",deviceBB10:"bb10",vndRIM:"vnd.rim",deviceBBStorm:"blackberry95",deviceBBBold:"blackberry97",deviceBBBoldTouch:"blackberry 99",deviceBBTour:"blackberry96",deviceBBCurve:"blackberry89",deviceBBCurveTouch:"blackberry 938",deviceBBTorch:"blackberry 98",deviceBBPlaybook:"playbook",deviceSymbian:"symbian",deviceSymbos:"symbos",deviceS60:"series60",deviceS70:"series70",deviceS80:"series80",deviceS90:"series90",devicePalm:"palm",deviceWebOS:"webos",deviceWebOShp:"hpwos",engineBlazer:"blazer",engineXiino:"xiino",deviceNuvifone:"nuvifone",deviceBada:"bada",deviceTizen:"tizen",deviceMeego:"meego",deviceKindle:"kindle",engineSilk:"silk-accelerated",vndwap:"vnd.wap",wml:"wml",deviceTablet:"tablet",deviceBrew:"brew",deviceDanger:"danger",deviceHiptop:"hiptop",devicePlaystation:"playstation",devicePlaystationVita:"vita",deviceNintendoDs:"nitro",deviceNintendo:"nintendo",deviceWii:"wii",deviceXbox:"xbox",deviceArchos:"archos",engineOpera:"opera",engineNetfront:"netfront",engineUpBrowser:"up.browser",engineOpenWeb:"openweb",
deviceMidp:"midp",uplink:"up.link",engineTelecaQ:"teleca q",engineObigo:"obigo",devicePda:"pda",mini:"mini",mobile:"mobile",mobi:"mobi",maemo:"maemo",linux:"linux",mylocom2:"sony/com",manuSonyEricsson:"sonyericsson",manuericsson:"ericsson",manuSamsung1:"sec-sgh",manuSony:"sony",manuHtc:"htc",svcDocomo:"docomo",svcKddi:"kddi",svcVodafone:"vodafone",disUpdate:"update",uagent:"",InitDeviceScan:function(){this.initCompleted=!1;navigator&&navigator.userAgent&&(this.uagent=navigator.userAgent.toLowerCase());this.isWebkit=this.DetectWebkit();this.isIphone=this.DetectIphone();this.isAndroid=this.DetectAndroid();this.isAndroidPhone=this.DetectAndroidPhone();this.isTierIphone=this.DetectTierIphone();this.isTierTablet=this.DetectTierTablet();this.isMobilePhone=this.DetectMobileQuick();this.isTierRichCss=this.DetectTierRichCss();this.isTierGenericMobile=this.DetectTierOtherPhones();this.initCompleted=!0},DetectIphone:function(){return this.initCompleted||this.isIphone?this.isIphone:-1<this.uagent.search(this.deviceIphone)?this.DetectIpad()||this.DetectIpod()?!1:!0:!1},DetectIpod:function(){return-1<this.uagent.search(this.deviceIpod)?!0:!1},DetectIphoneOrIpod:function(){return this.DetectIphone()||this.DetectIpod()?!0:!1},DetectIpad:function(){return-1<this.uagent.search(this.deviceIpad)&&this.DetectWebkit()?!0:!1},DetectIos:function(){return this.DetectIphoneOrIpod()||this.DetectIpad()?!0:!1},DetectAndroid:function(){return this.initCompleted||this.isAndroid?this.isAndroid:-1<this.uagent.search(this.deviceAndroid)||this.DetectGoogleTV()?!0:-1<this.uagent.search(this.deviceHtcFlyer)?!0:!1},DetectAndroidPhone:function(){return this.initCompleted||this.isAndroidPhone?this.isAndroidPhone:this.DetectAndroid()&&-1<this.uagent.search(this.mobile)||this.DetectOperaAndroidPhone()?!0:-1<this.uagent.search(this.deviceHtcFlyer)?!0:!1},DetectAndroidTablet:function(){return!this.DetectAndroid()||this.DetectOperaMobile()||-1<this.uagent.search(this.deviceHtcFlyer)?!1:-1<this.uagent.search(this.mobile)?!1:!0},DetectAndroidWebKit:function(){return this.DetectAndroid()&&this.DetectWebkit()?!0:!1},DetectGoogleTV:function(){return-1<this.uagent.search(this.deviceGoogleTV)?!0:!1},DetectWebkit:function(){return this.initCompleted||this.isWebkit?this.isWebkit:-1<this.uagent.search(this.engineWebKit)?!0:!1},DetectWindowsPhone:function(){return this.DetectWindowsPhone7()||this.DetectWindowsPhone8()?!0:!1},DetectWindowsPhone7:function(){return-1<this.uagent.search(this.deviceWinPhone7)?!0:!1},DetectWindowsPhone8:function(){return-1<this.uagent.search(this.deviceWinPhone8)?!0:!1},DetectWindowsMobile:function(){return this.DetectWindowsPhone()?!1:-1<this.uagent.search(this.deviceWinMob)||-1<this.uagent.search(this.deviceIeMob)||-1<this.uagent.search(this.enginePie)||-1<this.uagent.search(this.devicePpc)&&!(-1<this.uagent.search(this.deviceMacPpc))?!0:-1<this.uagent.search(this.manuHtc)&&-1<this.uagent.search(this.deviceWindows)?!0:!1},DetectBlackBerry:function(){return-1<this.uagent.search(this.deviceBB)||-1<this.uagent.search(this.vndRIM)?!0:this.DetectBlackBerry10Phone()?!0:!1},DetectBlackBerry10Phone:function(){return-1<this.uagent.search(this.deviceBB10)&&-1<this.uagent.search(this.mobile)?!0:!1},DetectBlackBerryTablet:function(){return-1<this.uagent.search(this.deviceBBPlaybook)?!0:!1},DetectBlackBerryWebKit:function(){return this.DetectBlackBerry()&&-1<this.uagent.search(this.engineWebKit)?!0:!1},DetectBlackBerryTouch:function(){return this.DetectBlackBerry()&&(-1<this.uagent.search(this.deviceBBStorm)||-1<this.uagent.search(this.deviceBBTorch)||-1<this.uagent.search(this.deviceBBBoldTouch)||-1<this.uagent.search(this.deviceBBCurveTouch))?!0:!1},DetectBlackBerryHigh:function(){return this.DetectBlackBerryWebKit()?!1:this.DetectBlackBerry()&&(this.DetectBlackBerryTouch()||-1<this.uagent.search(this.deviceBBBold)||-1<this.uagent.search(this.deviceBBTour)||-1<this.uagent.search(this.deviceBBCurve))?!0:!1},DetectBlackBerryLow:function(){return this.DetectBlackBerry()?this.DetectBlackBerryHigh()||this.DetectBlackBerryWebKit()?!1:!0:!1},DetectS60OssBrowser:function(){return this.DetectWebkit()&&(-1<this.uagent.search(this.deviceS60)||-1<this.uagent.search(this.deviceSymbian))?!0:!1},DetectSymbianOS:function(){return-1<this.uagent.search(this.deviceSymbian)||-1<this.uagent.search(this.deviceS60)||-1<this.uagent.search(this.deviceSymbos)&&this.DetectOperaMobile||-1<this.uagent.search(this.deviceS70)||-1<this.uagent.search(this.deviceS80)||-1<this.uagent.search(this.deviceS90)?!0:!1},DetectPalmOS:function(){return this.DetectPalmWebOS()?!1:-1<this.uagent.search(this.devicePalm)||-1<this.uagent.search(this.engineBlazer)||-1<this.uagent.search(this.engineXiino)?!0:!1},DetectPalmWebOS:function(){return-1<this.uagent.search(this.deviceWebOS)?!0:!1},DetectWebOSTablet:function(){return-1<this.uagent.search(this.deviceWebOShp)&&-1<this.uagent.search(this.deviceTablet)?!0:!1},DetectOperaMobile:function(){return-1<this.uagent.search(this.engineOpera)&&(-1<this.uagent.search(this.mini)||-1<this.uagent.search(this.mobi))?!0:!1},DetectOperaAndroidPhone:function(){return-1<this.uagent.search(this.engineOpera)&&-1<this.uagent.search(this.deviceAndroid)&&-1<this.uagent.search(this.mobi)?!0:!1},DetectOperaAndroidTablet:function(){return-1<this.uagent.search(this.engineOpera)&&-1<this.uagent.search(this.deviceAndroid)&&-1<this.uagent.search(this.deviceTablet)?!0:!1},DetectKindle:function(){return-1<this.uagent.search(this.deviceKindle)&&!this.DetectAndroid()?!0:!1},DetectAmazonSilk:function(){return-1<this.uagent.search(this.engineSilk)?!0:!1},DetectGarminNuvifone:function(){return-1<this.uagent.search(this.deviceNuvifone)?!0:!1},DetectBada:function(){return-1<this.uagent.search(this.deviceBada)?!0:!1},DetectTizen:function(){return-1<this.uagent.search(this.deviceTizen)?!0:!1},DetectMeego:function(){return-1<this.uagent.search(this.deviceMeego)?!0:!1},DetectDangerHiptop:function(){return-1<this.uagent.search(this.deviceDanger)||-1<this.uagent.search(this.deviceHiptop)?!0:!1},DetectSonyMylo:function(){return-1<this.uagent.search(this.manuSony)&&(-1<this.uagent.search(this.qtembedded)||-1<this.uagent.search(this.mylocom2))?!0:!1},DetectMaemoTablet:function(){return-1<this.uagent.search(this.maemo)?!0:-1<this.uagent.search(this.linux)&&-1<this.uagent.search(this.deviceTablet)&&!this.DetectWebOSTablet()&&!this.DetectAndroid()?!0:!1},DetectArchos:function(){return-1<this.uagent.search(this.deviceArchos)?!0:!1},DetectGameConsole:function(){return this.DetectSonyPlaystation()||this.DetectNintendo()||this.DetectXbox()?!0:!1},DetectSonyPlaystation:function(){return-1<this.uagent.search(this.devicePlaystation)?!0:!1},DetectGamingHandheld:function(){return-1<this.uagent.search(this.devicePlaystation)&&-1<this.uagent.search(this.devicePlaystationVita)?!0:!1},DetectNintendo:function(){return-1<this.uagent.search(this.deviceNintendo)||-1<this.uagent.search(this.deviceWii)||-1<this.uagent.search(this.deviceNintendoDs)?!0:!1},DetectXbox:function(){return-1<this.uagent.search(this.deviceXbox)?!0:!1},DetectBrewDevice:function(){return-1<this.uagent.search(this.deviceBrew)?!0:!1},DetectSmartphone:function(){return this.DetectTierIphone()||this.DetectS60OssBrowser()||this.DetectSymbianOS()||this.DetectWindowsMobile()||this.DetectBlackBerry()||this.DetectPalmOS()?!0:!1},DetectMobileQuick:function(){return this.DetectTierTablet()?!1:this.initCompleted||this.isMobilePhone?this.isMobilePhone:this.DetectSmartphone()||-1<this.uagent.search(this.mobile)||this.DetectKindle()||this.DetectAmazonSilk()||-1<this.uagent.search(this.deviceMidp)||this.DetectBrewDevice()||this.DetectOperaMobile()||this.DetectArchos()||-1<this.uagent.search(this.engineObigo)||-1<this.uagent.search(this.engineNetfront)||-1<this.uagent.search(this.engineUpBrowser)||-1<this.uagent.search(this.engineOpenWeb)?!0:!1},DetectMobileLong:function(){return this.DetectMobileQuick()||this.DetectGameConsole()||this.DetectDangerHiptop()||this.DetectMaemoTablet()||this.DetectSonyMylo()||this.DetectGarminNuvifone()||-1<this.uagent.search(this.devicePda)&&!(-1<this.uagent.search(this.disUpdate))||-1<this.uagent.search(this.manuSamsung1)||-1<this.uagent.search(this.manuSonyEricsson)||-1<this.uagent.search(this.manuericsson)||-1<this.uagent.search(this.svcDocomo)||-1<this.uagent.search(this.svcKddi)||-1<this.uagent.search(this.svcVodafone)?!0:!1},DetectTierTablet:function(){return this.initCompleted||this.isTierTablet?this.isTierTablet:this.DetectIpad()||this.DetectAndroidTablet()||this.DetectBlackBerryTablet()||this.DetectWebOSTablet()?!0:!1},DetectTierIphone:function(){return this.initCompleted||this.isTierIphone?this.isTierIphone:this.DetectIphoneOrIpod()||this.DetectAndroidPhone()||this.DetectWindowsPhone()||this.DetectBlackBerry10Phone()||this.DetectPalmWebOS()||this.DetectBada()||this.DetectTizen()||this.DetectGamingHandheld()?!0:this.DetectBlackBerryWebKit()&&this.DetectBlackBerryTouch()?!0:!1},DetectTierRichCss:function(){return this.initCompleted||this.isTierRichCss?this.isTierRichCss:this.DetectTierIphone()||this.DetectKindle()||this.DetectTierTablet()||!this.DetectMobileQuick()?!1:this.DetectWebkit()?!0:this.DetectS60OssBrowser()||this.DetectBlackBerryHigh()||this.DetectWindowsMobile()||-1<this.uagent.search(this.engineTelecaQ)?!0:!1},DetectTierOtherPhones:function(){return this.initCompleted||this.isTierGenericMobile?this.isTierGenericMobile:this.DetectTierIphone()||this.DetectTierRichCss()||this.DetectTierTablet()?!1:this.DetectMobileLong()?!0:!1}};CVMobileDet.InitDeviceScan();define("detectmobile",function(global){return function(){var ret;return ret||global.detectmobile}}(this));define("app",["jquery","bootstrap","underscore_loader","models/transaction","collections/transactions","views/virtual_assistant/index","crossStorage","utils/get-param","detectmobile","settings","views/virtual_assistant/components/launcher","views/virtual_assistant/components/input_launcher"],function($,Bootstrap,_,TransactionModel,TransactionsCollection,VirtualAssistant,CrossStorage,_get,Detectmobile,Settings,Launcher,InputLauncher){var initialize=function(){CVVA=CVVA||{};CVVA.version="3.0.2";if(window.CVVA.popupMode===!0){var styleTagsPopupMode='<style id="cv-va-popup-mode-styles">';styleTagsPopupMode+=".cv-va-bootstrap #cv-chat-content {";styleTagsPopupMode+="width: 100% !important;";styleTagsPopupMode+="height: 100% !important;";styleTagsPopupMode+="max-height: none !important;";styleTagsPopupMode+="border-radius: 0px !important;";styleTagsPopupMode+="left: 0px !important;";styleTagsPopupMode+="top: 0px !important;";styleTagsPopupMode+="margin: 0px !important;";styleTagsPopupMode+="}";styleTagsPopupMode+=".cv-va-bootstrap #cv-chat-header {";styleTagsPopupMode+="cursor: auto !important;";styleTagsPopupMode+="border-top-left-radius: 0 !important;";styleTagsPopupMode+="border-top-right-radius: 0 !important;";styleTagsPopupMode+="}";styleTagsPopupMode+=".cv-va-bootstrap #cv-btn-group {";styleTagsPopupMode+="display: none !important;";styleTagsPopupMode+="}";styleTagsPopupMode+=".cv-va-bootstrap #cv-lp-secure-form-container {";styleTagsPopupMode+="z-index: 999999999 !important;";styleTagsPopupMode+="position: absolute !important;";styleTagsPopupMode+="top: 0 !important;";styleTagsPopupMode+="right: 0 !important;";styleTagsPopupMode+="}";styleTagsPopupMode+=".cv-va-bootstrap #cv-lp-secure-form-container, .cv-va-bootstrap #cv-lp-secure-form-panel {";styleTagsPopupMode+="width: 100% !important;";styleTagsPopupMode+="height: 100% !important;";styleTagsPopupMode+="}";styleTagsPopupMode+=".cv-va-bootstrap #cv-lp-secure-form-body {";styleTagsPopupMode+="width: 100% !important;";styleTagsPopupMode+="}";styleTagsPopupMode+="</style>";$(styleTagsPopupMode).appendTo("head");Settings.businessName=Settings.businessName+"-popup";Settings.disableBtn.close=!0;Settings.disableBtn.minimize=!0;Settings.disableBtn.fullscreen=!0;Settings.fullScreen.enabled=!0;Settings.launcherInjection=!1}else window.CVVA.popupMode=!1;if(window.CVVA.iframeMode===!0){Settings.disableBtn.fullscreen=!0;Settings.fullScreen.enabled=!0;Settings.launcherInjection=!1}window.calledResetVAOnLP=void 0;window.cvCrossStorage=new CrossStorage(Settings.libEndpoint+"storage-hub.html");window.cvCrossStorage.onConnect().then(function(){}).then(function(){return window.cvCrossStorage.get(Settings.businessName+"-cvVaBootstrapState",Settings.businessName+"-cvVaModel",Settings.businessName+"-cvVaStyles",Settings.businessName+"-cvVaInitCall",Settings.businessName+"-cvVaTimestamp",Settings.businessName+"-cvVaMinimized",Settings.businessName+"-cvVaCollectionLength",Settings.businessName+"-cvVaContentHeight",Settings.businessName+"-cvVaContentWidth",Settings.businessName+"-cvVaSemanticsFAQs",Settings.businessName+"-cvVaActiveSession_lp",Settings.businessName+"-cvLpVisitorChatRels",Settings.businessName+"-cvLpVisitorResumeMode",Settings.businessName+"-cvLpVisitorSessionVars",Settings.businessName+"-cvVaEOCSRendered",Settings.businessName+"-cvVaActiveSession_cv",Settings.businessName+"-cvPCSdata",Settings.businessName+"-lpSessionEndedExternal",Settings.businessName+"-cvVaBusinessArea",Settings.businessName+"-cvVaIdent",Settings.businessName+"-requestingChat_lp",Settings.businessName+"-chatSessionData_genesys",Settings.businessName+"-agentPickedUp_genesys",Settings.businessName+"-pcsData_genesys",Settings.businessName+"-requestingChat_genesys",Settings.businessName+"-genesysSessionEnded_external",Settings.businessName+"-cvVaIframePosition",Settings.businessName+"-cvVaIframeMinimizeUIPosition",Settings.businessName+"-cvVaIframeClose","cv-tserverid","cvSessionEndedExternal_VA",Settings.businessName+"-hideLauncher",Settings.businessName+"-cvVaData","cvlc_customerId","cvlc_username","cvlc_firstName","cvlc_lastName","cvlc_emailId","cvlc_chatStatus","cvlc_userSessionId","cvlc_endUserId","cvlc_roomId","cvlc_agentName","cvlc_queueId","cvlc_queueName")}).then(function(res){function OnInput(){this.style.height="auto";this.style.height=this.scrollHeight+"px"}null!==res[0]&&"undefined"!==res[0]?localStorage.setItem(Settings.businessName+"-cvVaBootstrapState",res[0]):localStorage.removeItem(Settings.businessName+"-cvVaBootstrapState");null!==res[1]&&"undefined"!==res[1]?localStorage.setItem(Settings.businessName+"-cvVaModel",res[1]):localStorage.removeItem(Settings.businessName+"-cvVaModel");null!==res[2]&&"undefined"!==res[2]?localStorage.setItem(Settings.businessName+"-cvVaStyles",res[2]):localStorage.removeItem(Settings.businessName+"-cvVaStyles");null!==res[3]&&"undefined"!==res[3]?localStorage.setItem(Settings.businessName+"-cvVaInitCall",res[3]):localStorage.removeItem(Settings.businessName+"-cvVaInitCall");null!==res[4]&&"undefined"!==res[4]?localStorage.setItem(Settings.businessName+"-cvVaTimestamp",res[4]):localStorage.removeItem(Settings.businessName+"-cvVaTimestamp");null!==res[5]&&"undefined"!==res[5]?localStorage.setItem(Settings.businessName+"-cvVaMinimized",res[5]):localStorage.removeItem(Settings.businessName+"-cvVaMinimized");if(null!==res[6]&&"undefined"!==res[6]){localStorage.setItem(Settings.businessName+"-cvVaCollectionLength",res[6]);window.rebuiltFromStorage=!0}else localStorage.removeItem(Settings.businessName+"-cvVaCollectionLength");null!==res[7]&&"undefined"!==res[7]?localStorage.setItem(Settings.businessName+"-cvVaContentHeight",res[7]):localStorage.removeItem(Settings.businessName+"-cvVaContentHeight");null!==res[8]&&"undefined"!==res[8]?localStorage.setItem(Settings.businessName+"-cvVaContentWidth",res[8]):localStorage.removeItem(Settings.businessName+"-cvVaContentWidth");null!==res[9]&&"undefined"!==res[9]?localStorage.setItem(Settings.businessName+"-cvVaSemanticsFAQs",res[9]):localStorage.removeItem(Settings.businessName+"-cvVaSemanticsFAQs");null!==res[10]&&"undefined"!==res[10]?localStorage.setItem(Settings.businessName+"-cvVaActiveSession_lp",res[10]):localStorage.removeItem(Settings.businessName+"-cvVaActiveSession_lp");if(null!==res[11]&&"undefined"!==res[11]){sessionStorage.setItem("lpVisitorChatRels"+Settings.liveperson.accountNumber,res[11]);sessionStorage.setItem("lpVisitorResumeMode"+Settings.liveperson.accountNumber,res[12]);sessionStorage.setItem("lpVisitorSessionVars"+Settings.liveperson.accountNumber,res[13])}else{sessionStorage.removeItem("lpVisitorChatRels"+Settings.liveperson.accountNumber);sessionStorage.removeItem("lpVisitorResumeMode"+Settings.liveperson.accountNumber);sessionStorage.removeItem("lpVisitorSessionVars"+Settings.liveperson.accountNumber)}null!==res[14]&&"undefined"!==res[14]?localStorage.setItem(Settings.businessName+"-cvVaEOCSRendered",res[14]):localStorage.removeItem(Settings.businessName+"-cvVaEOCSRendered");null!==res[15]&&"undefined"!==res[15]?localStorage.setItem(Settings.businessName+"-cvVaActiveSession_cv",res[15]):localStorage.removeItem(Settings.businessName+"-cvVaActiveSession_cv");null!==res[16]&&"undefined"!==res[16]?localStorage.setItem(Settings.businessName+"-cvPCSdata",res[16]):localStorage.removeItem(Settings.businessName+"-cvPCSdata");null!==res[17]&&"undefined"!==res[17]?localStorage.setItem(Settings.businessName+"-lpSessionEndedExternal",res[17]):localStorage.removeItem(Settings.businessName+"-lpSessionEndedExternal");null!==res[18]&&"undefined"!==res[18]?localStorage.setItem(Settings.businessName+"-cvVaBusinessArea",res[18]):localStorage.removeItem(Settings.businessName+"-cvVaBusinessArea");if(null!==res[19]&&"undefined"!==res[19]){localStorage.setItem(Settings.businessName+"-cvVaIdent",res[19]);void 0!==window.CVVA.model&&(window.CVVA.model.ident=res[19])}else localStorage.removeItem(Settings.businessName+"-cvVaIdent");null!==res[20]&&"undefined"!==res[20]?localStorage.setItem(Settings.businessName+"-requestingChat_lp",res[20]):localStorage.removeItem(Settings.businessName+"-requestingChat_lp");null!==res[21]&&"undefined"!==res[21]?localStorage.setItem(Settings.businessName+"-chatSessionData_genesys",res[21]):localStorage.removeItem(Settings.businessName+"-chatSessionData_genesys");null!==res[22]&&"undefined"!==res[22]?localStorage.setItem(Settings.businessName+"-agentPickedUp_genesys",res[22]):localStorage.removeItem(Settings.businessName+"-agentPickedUp_genesys");null!==res[23]&&"undefined"!==res[23]?localStorage.setItem(Settings.businessName+"-pcsData_genesys",res[23]):localStorage.removeItem(Settings.businessName+"-pcsData_genesys");null!==res[24]&&"undefined"!==res[24]?localStorage.setItem(Settings.businessName+"-requestingChat_genesys",res[24]):localStorage.removeItem(Settings.businessName+"-requestingChat_genesys");null!==res[25]&&"undefined"!==res[25]?localStorage.setItem(Settings.businessName+"-genesysSessionEnded_external",res[25]):localStorage.removeItem(Settings.businessName+"-genesysSessionEnded_external");null!==res[26]&&"undefined"!==res[26]?localStorage.setItem(Settings.businessName+"-cvVaIframePosition",res[26]):localStorage.removeItem(Settings.businessName+"-cvVaIframePosition");null!==res[27]&&"undefined"!==res[27]?localStorage.setItem(Settings.businessName+"-cvVaIframeMinimizeUIPosition",res[27]):localStorage.removeItem(Settings.businessName+"-cvVaIframeMinimizeUIPosition");null!==res[28]&&"undefined"!==res[28]?localStorage.setItem(Settings.businessName+"-cvVaIframeClose",res[28]):localStorage.removeItem(Settings.businessName+"-cvVaIframeClose");null!==res[29]&&"undefined"!==res[29]?localStorage.setItem("cv-tserverid",res[29]):localStorage.removeItem("cv-tserverid");null!==res[30]&&"undefined"!==res[30]?localStorage.setItem("cvSessionEndedExternal_VA",res[30]):localStorage.removeItem("cvSessionEndedExternal_VA");null!==res[31]&&"undefined"!==res[31]?localStorage.setItem(Settings.businessName+"-hideLauncher",res[31]):localStorage.removeItem(Settings.businessName+"-hideLauncher");null!==res[32]&&"undefined"!==res[32]?localStorage.setItem(Settings.businessName+"-cvVaData",res[32]):localStorage.removeItem(Settings.businessName+"-cvVaData");null!==res[33]&&"undefined"!==res[33]?localStorage.setItem("cvlc_customerId",res[33]):localStorage.removeItem("cvlc_customerId");null!==res[34]&&"undefined"!==res[34]?localStorage.setItem("cvlc_username",res[34]):localStorage.removeItem("cvlc_username");null!==res[35]&&"undefined"!==res[35]?localStorage.setItem("cvlc_firstName",res[35]):localStorage.removeItem("cvlc_firstName");null!==res[36]&&"undefined"!==res[36]?localStorage.setItem("cvlc_lastName",res[36]):localStorage.removeItem("cvlc_lastName");null!==res[37]&&"undefined"!==res[37]?localStorage.setItem("cvlc_emailId",res[37]):localStorage.removeItem("cvlc_emailId");null!==res[38]&&"undefined"!==res[38]?localStorage.setItem("cvlc_chatStatus",res[38]):localStorage.removeItem("cvlc_chatStatus");null!==res[39]&&"undefined"!==res[39]?localStorage.setItem("cvlc_userSessionId",res[39]):localStorage.removeItem("cvlc_userSessionId");null!==res[40]&&"undefined"!==res[40]?localStorage.setItem("cvlc_endUserId",res[40]):localStorage.removeItem("cvlc_endUserId");null!==res[41]&&"undefined"!==res[41]?localStorage.setItem("cvlc_roomId",res[41]):localStorage.removeItem("cvlc_roomId");null!==res[42]&&"undefined"!==res[42]?localStorage.setItem("cvlc_agentName",res[42]):localStorage.removeItem("cvlc_agentName");null!==res[43]&&"undefined"!==res[43]?localStorage.setItem("cvlc_queueId",res[43]):localStorage.removeItem("cvlc_queueId");null!==res[44]&&"undefined"!==res[44]?localStorage.setItem("cvlc_queueName",res[44]):localStorage.removeItem("cvlc_queueName");if(Settings.persistenceEnabled===!0&&Date.now()-localStorage.getItem(Settings.businessName+"-cvVaTimestamp")>=Settings.persistenceTimeout){localStorage.removeItem(Settings.businessName+"-cvVaBootstrapState");localStorage.removeItem(Settings.businessName+"-cvVaModel");localStorage.removeItem(Settings.businessName+"-cvVaStyles");localStorage.removeItem(Settings.businessName+"-cvVaInitCall");localStorage.removeItem(Settings.businessName+"-cvVaTimestamp");localStorage.removeItem(Settings.businessName+"-cvVaMinimized");localStorage.removeItem(Settings.businessName+"-cvVaCollectionLength");localStorage.removeItem(Settings.businessName+"-cvVaActiveSession_lp");localStorage.removeItem(Settings.businessName+"-cvVaEOCSRendered");localStorage.removeItem(Settings.businessName+"-cvVaActiveSession_cv");localStorage.removeItem(Settings.businessName+"-cvPCSdata");localStorage.removeItem(Settings.businessName+"-lpSessionEndedExternal");localStorage.removeItem(Settings.businessName+"-cvVaIdent");localStorage.removeItem(Settings.businessName+"-requestingChat_lp");localStorage.removeItem(Settings.businessName+"-chatSessionData_genesys");localStorage.removeItem(Settings.businessName+"-agentPickedUp_genesys");localStorage.removeItem(Settings.businessName+"-pcsData_genesys");localStorage.removeItem(Settings.businessName+"-requestingChat_genesys");localStorage.removeItem(Settings.businessName+"-genesysSessionEnded_external");localStorage.removeItem(Settings.businessName+"-cvVaIframePosition");localStorage.removeItem(Settings.businessName+"-cvVaIframeMinimizeUIPosition");localStorage.removeItem(Settings.businessName+"-cvVaIframeClose");localStorage.removeItem(Settings.businessName+"-hideLauncher");localStorage.removeItem("cv-tserverid");localStorage.removeItem("cvSessionEndedExternal_VA");localStorage.removeItem("cvlc_customerId");localStorage.removeItem("cvlc_username");localStorage.removeItem("cvlc_firstName");localStorage.removeItem("cvlc_lastName");localStorage.removeItem("cvlc_emailId");localStorage.removeItem("cvlc_chatStatus");localStorage.removeItem("cvlc_userSessionId");localStorage.removeItem("cvlc_endUserId");localStorage.removeItem("cvlc_roomId");localStorage.removeItem("cvlc_agentName");localStorage.removeItem("cvlc_queueId");localStorage.removeItem("cvlc_queueName");sessionStorage.removeItem("lpVisitorChatRels"+Settings.liveperson.accountNumber);sessionStorage.removeItem("lpVisitorResumeMode"+Settings.liveperson.accountNumber);sessionStorage.removeItem("lpVisitorSessionVars"+Settings.liveperson.accountNumber);sessionStorage.removeItem(Settings.businessName+"-cvVaBusinessArea");sessionStorage.removeItem(Settings.businessName+"-cvVaData");window.rebuiltFromStorage=!1}else if(Settings.persistenceEnabled===!1){localStorage.removeItem(Settings.businessName+"-cvVaBootstrapState");localStorage.removeItem(Settings.businessName+"-cvVaModel");localStorage.removeItem(Settings.businessName+"-cvVaStyles");localStorage.removeItem(Settings.businessName+"-cvVaInitCall");localStorage.removeItem(Settings.businessName+"-cvVaTimestamp");localStorage.removeItem(Settings.businessName+"-cvVaMinimized");localStorage.removeItem(Settings.businessName+"-cvVaCollectionLength");localStorage.removeItem(Settings.businessName+"-cvVaActiveSession_lp");localStorage.removeItem(Settings.businessName+"-cvVaEOCSRendered");localStorage.removeItem(Settings.businessName+"-cvVaActiveSession_cv");localStorage.removeItem(Settings.businessName+"-cvPCSdata");localStorage.removeItem(Settings.businessName+"-lpSessionEndedExternal");localStorage.removeItem(Settings.businessName+"-cvVaIdent");localStorage.removeItem(Settings.businessName+"-requestingChat_lp");localStorage.removeItem(Settings.businessName+"-chatSessionData_genesys");localStorage.removeItem(Settings.businessName+"-agentPickedUp_genesys");localStorage.removeItem(Settings.businessName+"-pcsData_genesys");localStorage.removeItem(Settings.businessName+"-requestingChat_genesys");localStorage.removeItem(Settings.businessName+"-genesysSessionEnded_external");localStorage.removeItem(Settings.businessName+"-cvVaIframePosition");localStorage.removeItem(Settings.businessName+"-cvVaIframeMinimizeUIPosition");localStorage.removeItem(Settings.businessName+"-cvVaIframeClose");localStorage.removeItem(Settings.businessName+"-hideLauncher");localStorage.removeItem("cvSessionEndedExternal_VA");localStorage.removeItem("cvlc_customerId");localStorage.removeItem("cvlc_username");localStorage.removeItem("cvlc_firstName");localStorage.removeItem("cvlc_lastName");localStorage.removeItem("cvlc_emailId");localStorage.removeItem("cvlc_chatStatus");localStorage.removeItem("cvlc_userSessionId");localStorage.removeItem("cvlc_endUserId");localStorage.removeItem("cvlc_roomId");localStorage.removeItem("cvlc_agentName");localStorage.removeItem("cvlc_queueId");localStorage.removeItem("cvlc_queueName");sessionStorage.removeItem("lpVisitorChatRels"+Settings.liveperson.accountNumber);sessionStorage.removeItem("lpVisitorResumeMode"+Settings.liveperson.accountNumber);sessionStorage.removeItem("lpVisitorSessionVars"+Settings.liveperson.accountNumber);sessionStorage.removeItem(Settings.businessName+"-cvVaBusinessArea");sessionStorage.removeItem(Settings.businessName+"-cvVaData");window.rebuiltFromStorage=!1}else if("true"===localStorage.getItem(Settings.businessName+"-lpSessionEndedExternal")){localStorage.removeItem(Settings.businessName+"-cvVaBootstrapState");localStorage.removeItem(Settings.businessName+"-cvVaModel");localStorage.removeItem(Settings.businessName+"-cvVaStyles");localStorage.removeItem(Settings.businessName+"-cvVaInitCall");localStorage.removeItem(Settings.businessName+"-cvVaTimestamp");localStorage.removeItem(Settings.businessName+"-cvVaMinimized");localStorage.removeItem(Settings.businessName+"-cvVaCollectionLength");localStorage.removeItem(Settings.businessName+"-cvVaActiveSession_lp");localStorage.removeItem(Settings.businessName+"-cvVaEOCSRendered");localStorage.removeItem(Settings.businessName+"-cvVaActiveSession_cv");localStorage.removeItem(Settings.businessName+"-cvPCSdata");localStorage.removeItem(Settings.businessName+"-lpSessionEndedExternal");localStorage.removeItem(Settings.businessName+"-cvVaIdent");localStorage.removeItem(Settings.businessName+"-requestingChat_lp");localStorage.removeItem("cvSessionEndedExternal_VA");sessionStorage.removeItem("lpVisitorChatRels"+Settings.liveperson.accountNumber);sessionStorage.removeItem("lpVisitorResumeMode"+Settings.liveperson.accountNumber);sessionStorage.removeItem("lpVisitorSessionVars"+Settings.liveperson.accountNumber);sessionStorage.removeItem(Settings.businessName+"-cvVaBusinessArea");window.rebuiltFromStorage=!1}else if("true"===localStorage.getItem(Settings.businessName+"-genesysSessionEnded_external")){localStorage.removeItem(Settings.businessName+"-cvVaBootstrapState");localStorage.removeItem(Settings.businessName+"-cvVaModel");localStorage.removeItem(Settings.businessName+"-cvVaStyles");localStorage.removeItem(Settings.businessName+"-cvVaInitCall");localStorage.removeItem(Settings.businessName+"-cvVaTimestamp");localStorage.removeItem(Settings.businessName+"-cvVaMinimized");localStorage.removeItem(Settings.businessName+"-cvVaCollectionLength");localStorage.removeItem(Settings.businessName+"-cvVaActiveSession_lp");localStorage.removeItem(Settings.businessName+"-cvVaEOCSRendered");localStorage.removeItem(Settings.businessName+"-cvVaActiveSession_cv");localStorage.removeItem(Settings.businessName+"-cvPCSdata");localStorage.removeItem(Settings.businessName+"-cvVaIdent");localStorage.removeItem(Settings.businessName+"-agentPickedUp_genesys");localStorage.removeItem(Settings.businessName+"-pcsData_genesys");localStorage.removeItem(Settings.businessName+"-requestingChat_genesys");localStorage.removeItem(Settings.businessName+"-genesysSessionEnded_external");localStorage.removeItem(Settings.businessName+"-lpSessionEndedExternal");localStorage.removeItem(Settings.businessName+"-requestingChat_lp");localStorage.removeItem("cvSessionEndedExternal_VA");sessionStorage.removeItem("lpVisitorChatRels"+Settings.liveperson.accountNumber);sessionStorage.removeItem("lpVisitorResumeMode"+Settings.liveperson.accountNumber);sessionStorage.removeItem("lpVisitorSessionVars"+Settings.liveperson.accountNumber);sessionStorage.removeItem(Settings.businessName+"-cvVaBusinessArea");sessionStorage.removeItem(Settings.businessName+"-tokenv");window.rebuiltFromStorage=!1}else if("true"===localStorage.getItem("cvSessionEndedExternal_VA")){localStorage.removeItem(Settings.businessName+"-cvVaBootstrapState");localStorage.removeItem(Settings.businessName+"-cvVaModel");localStorage.removeItem(Settings.businessName+"-cvVaStyles");localStorage.removeItem(Settings.businessName+"-cvVaInitCall");localStorage.removeItem(Settings.businessName+"-cvVaTimestamp");localStorage.removeItem(Settings.businessName+"-cvVaMinimized");localStorage.removeItem(Settings.businessName+"-cvVaCollectionLength");localStorage.removeItem(Settings.businessName+"-cvVaActiveSession_lp");localStorage.removeItem(Settings.businessName+"-cvVaEOCSRendered");localStorage.removeItem(Settings.businessName+"-cvVaActiveSession_cv");localStorage.removeItem(Settings.businessName+"-cvPCSdata");localStorage.removeItem(Settings.businessName+"-lpSessionEndedExternal");localStorage.removeItem(Settings.businessName+"-cvVaIdent");localStorage.removeItem(Settings.businessName+"-requestingChat_lp");localStorage.removeItem("cvSessionEndedExternal_VA");localStorage.removeItem(Settings.businessName+"-agentPickedUp_genesys");localStorage.removeItem(Settings.businessName+"-pcsData_genesys");localStorage.removeItem(Settings.businessName+"-requestingChat_genesys");localStorage.removeItem(Settings.businessName+"-genesysSessionEnded_external");sessionStorage.removeItem("lpVisitorChatRels"+Settings.liveperson.accountNumber);sessionStorage.removeItem("lpVisitorResumeMode"+Settings.liveperson.accountNumber);sessionStorage.removeItem("lpVisitorSessionVars"+Settings.liveperson.accountNumber);sessionStorage.removeItem(Settings.businessName+"-cvVaBusinessArea");sessionStorage.removeItem(Settings.businessName+"-cvVaData");window.rebuiltFromStorage=!1}CVMobileDet.DetectMobileLong()===!0||CVMobileDet.DetectTierTablet()===!0?window.CVMobile=!0:window.CVMobile=!1;var allowInjection=!1;if(Settings.selectiveInjection.enabled===!0){if(Settings.selectiveInjection.url.length>0)for(var i=0;i<Settings.selectiveInjection.url.length;i++)window.location.href.indexOf(Settings.selectiveInjection.url[i])>-1&&(allowInjection=!0);null!==Settings.selectiveInjection.variable&&Settings.selectiveInjection.variable===!0&&(allowInjection=!0);
}else allowInjection=!0;window.CVMobile===!1?Settings.selectiveInjection.device.desktop===!1&&(allowInjection=!1):window.CVMobile===!0&&Settings.selectiveInjection.device.mobile===!1&&(allowInjection=!1);if(allowInjection===!0){var libEndpoint=Settings.libEndpoint,head=document.getElementsByTagName("head")[0],linkFontAwesomeCSS=document.createElement("link");linkFontAwesomeCSS.id="cv-font-awesome-css";linkFontAwesomeCSS.rel="stylesheet";linkFontAwesomeCSS.type="text/css";linkFontAwesomeCSS.href=libEndpoint+"css/libs/font_awesome/cv-font-awesome.css";linkFontAwesomeCSS.media="screen";0===$("#cv-font-awesome-css").length&&head.appendChild(linkFontAwesomeCSS);var linkJqueryUICSS=document.createElement("link");linkJqueryUICSS.id="cv-jquery-ui-css";linkJqueryUICSS.rel="stylesheet";linkJqueryUICSS.type="text/css";linkJqueryUICSS.href=libEndpoint+"css/libs/jquery/jquery-ui.css";linkJqueryUICSS.media="screen";0===$("#cv-jquery-ui-css").length&&head.appendChild(linkJqueryUICSS);var linkBootstrapCSS=document.createElement("link");linkBootstrapCSS.id="cv-bootstrap-css";linkBootstrapCSS.rel="stylesheet";linkBootstrapCSS.type="text/css";linkBootstrapCSS.href=libEndpoint+"css/libs/bootstrap/cv-va-bootstrap.css";linkBootstrapCSS.media="screen";0===$("#cv-bootstrap-css").length&&head.appendChild(linkBootstrapCSS);var linkVACSS=document.createElement("link");linkVACSS.id="cv-va-css";linkVACSS.rel="stylesheet";linkVACSS.type="text/css";linkVACSS.href=libEndpoint+"css/styles.css";linkVACSS.media="screen";0===$("#cv-va-css").length&&head.appendChild(linkVACSS);var linkPrintCSS=document.createElement("link");linkPrintCSS.id="cv-print-css";linkPrintCSS.rel="stylesheet";linkPrintCSS.type="text/css";linkPrintCSS.href=libEndpoint+"css/print.css";linkPrintCSS.media="print";0===$("#cv-print-css").length&&head.appendChild(linkPrintCSS);var perfectScrollbarCSS=document.createElement("link");perfectScrollbarCSS.id="cv-scrollbar-css";perfectScrollbarCSS.rel="stylesheet";perfectScrollbarCSS.type="text/css";perfectScrollbarCSS.href=libEndpoint+"css/libs/perfect_scrollbar/cv-perfect-scrollbar.css";perfectScrollbarCSS.media="screen";0===$("#cv-scrollbar-css").length&&head.appendChild(perfectScrollbarCSS);window.loadFromStorage=!1;var linkVAMobileCSS;if("altice"===Settings.businessName){$("#cv-va-opener-static").click(function(){localStorage.setItem("cv-pcs-clicked",!0);setTimeout(function(){localStorage.removeItem("cv-pcs-clicked")},3e3)});if("true"===localStorage.getItem("cv-pcs-clicked")&&window.location.href.indexOf("support/livepage/chat")>-1&&0===$("#cv-va-opener-static").length){localStorage.removeItem("cv-pcs-clicked");$.ajax({type:"POST",url:Settings.logEndpoint+"log",data:{level:"error",metadata:{logEvent:"error submitting PCS to launch VA"}}})}else"true"===localStorage.getItem("cv-pcs-clicked")&&localStorage.removeItem("cv-pcs-clicked")}void 0!==localStorage.getItem(Settings.businessName+"-cvVaBootstrapState")&&null!==localStorage.getItem(Settings.businessName+"-cvVaBootstrapState")&&Settings.persistenceEnabled===!0&&Date.now()-localStorage.getItem(Settings.businessName+"-cvVaTimestamp")<=Settings.persistenceTimeout&&(window.loadFromStorage=!0);if(void 0!==localStorage.getItem(Settings.businessName+"-cvVaBootstrapState")&&null!==localStorage.getItem(Settings.businessName+"-cvVaBootstrapState")&&Settings.persistenceEnabled===!0&&window.loadFromStorage===!0){if(Settings.liveperson.removeLPengagements===!0){var removeExternalEngagements=function(){$(".LPMcontainer").each(function(i,element){for(var removeEngagement=!0,i=0;i<Settings.liveperson.removeLPengagementExceptions.length;i++)$(this).parent().attr("id")===Settings.liveperson.removeLPengagementExceptions[i]&&(removeEngagement=!1);removeEngagement&&$(this).addClass("cv-va-hide-external-engagements")})};clearInterval(window.CVVA.removeExternalEngagementsInterval);window.CVVA.removeExternalEngagementsInterval=setInterval(removeExternalEngagements,100);removeExternalEngagements()}if("true"===localStorage.getItem(Settings.businessName+"-cvVaMinimized")){window.cvVaMinimized=!0;parent.postMessage("minimize","*")}else if("false"===localStorage.getItem(Settings.businessName+"-cvVaMinimized")){window.cvVaMinimized=!1;parent.postMessage("maximize","*")}if(window.CVVA.iframeMode){"false"!==localStorage.getItem(Settings.businessName+"-cvVaMinimized")&&localStorage.getItem(Settings.businessName+"-cvVaMinimized")||parent.postMessage("loadedFromStorage","*");if(void 0!==localStorage.getItem(Settings.businessName+"-cvVaIframePosition")){var iframePosition=JSON.parse(localStorage.getItem(Settings.businessName+"-cvVaIframePosition"));parent.postMessage({cvVaIframePosition:iframePosition},"*")}if(void 0!==localStorage.getItem(Settings.businessName+"-cvVaIframeMinimizeUIPosition")){var iframeMinimizeUIPosition=JSON.parse(localStorage.getItem(Settings.businessName+"-cvVaIframeMinimizeUIPosition"));parent.postMessage({cvVaIframeMinimizeUIPosition:iframeMinimizeUIPosition},"*")}"true"===localStorage.getItem(Settings.businessName+"-cvVaIframeClose")&&parent.postMessage("close","*")}$("head").append('<style id="cv-va-styles">'+JSON.parse(localStorage.getItem(Settings.businessName+"-cvVaStyles"))+"</style>");if(window.CVMobile===!0){linkVAMobileCSS=document.createElement("link");linkVAMobileCSS.id="cv-va-mobile-css";linkVAMobileCSS.rel="stylesheet";linkVAMobileCSS.type="text/css";linkVAMobileCSS.href=libEndpoint+"/css/styles-mobile.css";linkVAMobileCSS.media="screen";head.appendChild(linkVAMobileCSS)}$("body").append('<div class="cv-va-bootstrap" style="display: none;">'+JSON.parse(localStorage.getItem(Settings.businessName+"-cvVaBootstrapState"))+"</div>");$(".cv-va-bootstrap #cv-chat-content").removeClass("ui-resizable");$(".cv-va-bootstrap .cv-ui-resizable-handle").remove();$(".cv-va-bootstrap #va-tab").click(function(e){e.preventDefault();$(".cv-va-bootstrap #cv-chat-form").show();$(".cv-va-bootstrap #va-tab").addClass("active");$(".cv-va-bootstrap #lc-tab").removeClass("active");$(".cv-va-bootstrap #cv-live-chat-answer-history").hide();$(".cv-va-bootstrap #cv-chat-answer-history").show();$(".cv-va-bootstrap .cv-chat-footer").show()});$("#lc-tab").click(function(e){e.preventDefault();$(".cv-va-bootstrap #cv-chat-form").hide();$(".cv-va-bootstrap #lc-tab").addClass("active");$(".cv-va-bootstrap #va-tab").removeClass("active");$(".cv-va-bootstrap #cv-live-chat-answer-history").show();$(".cv-va-bootstrap #cv-chat-answer-history").hide();$(".cv-va-bootstrap .cv-chat-footer").hide()});if("creative virtual"===Settings.livechatVendor&&"true"===localStorage.getItem(Settings.businessName+"-cvVaActiveSession_cv")&&"true"!==localStorage.getItem(Settings.businessName+"-cvVaEOCSRendered")){var loader_div=$("<div>").attr("id","cv-lc-loader").css("background-color","#fff");loader_div.append('<i class="fa fa-spinner fa-spin fa-3x fa-fw"></i><span class="sr-only">Loading Live Chat Prechat Survey...</span>');$(".cv-va-bootstrap #cv-chat-body").append(loader_div);var loader=!0,removeLoader=function(){setTimeout(function(){$("#cv-lc-loader").hide().remove()},3e3);loader=!1};removeLoader()}$(".cv-va-bootstrap #cv-chat-user-entry").prop("disabled",!1);$.each($(".cv-va-bootstrap .cv-chat-connector-disabled"),function(){$(this).add($(this).children("span")).css({"background-color":Settings.connectorsBackgroundColor,color:Settings.connectorsFontColor})});$(".cv-va-bootstrap .back_link").click(function(evt){evt.preventDefault();model.backnavRequest()});setTimeout(function(){$(".cv-va-bootstrap").show();$(".cv-va-bootstrap #cv-chat-answer-history").length&&$(".cv-va-bootstrap #cv-chat-answer-history").scrollTop($(".cv-va-bootstrap #cv-chat-answer-history")[0].scrollHeight)},500)}else{var chatContainerHTML='<div class="cv-va-bootstrap"';chatContainerHTML+=window.navigator.userAgent.indexOf("MSIE ")>0||window.navigator.userAgent.indexOf("Trident/")>0||window.navigator.userAgent.indexOf("Edge/")>0?'tabindex="0"><div id="cv-chat-container" style="display:none;" class="modal fade" data-cv-backdrop="false">':'><div id="cv-chat-container" style="display:none;" class="modal fade" data-cv-backdrop="false">';chatContainerHTML+='<div class="modal-dialog">';chatContainerHTML+='<div id="cv-chat-content" class="cv-modal-content">';chatContainerHTML+='<div id="_csrf" hidden></div>';chatContainerHTML+='<div id="cv-chat-header" class="modal-header">';Settings.modalHeader.logo.enabled===!0&&(chatContainerHTML=chatContainerHTML+'<img class="cv-chat-logo" src="'+Settings.libEndpoint+"images/titles/"+Settings.modalHeader.logo.name+'" alt="'+Settings.businessName+' logo">');Settings.modalHeader.extralogo.enabled===!0&&(chatContainerHTML=chatContainerHTML+'<img class="cv-chat-extra-logo" src="'+Settings.libEndpoint+"images/titles/"+Settings.modalHeader.extralogo.name+'" alt="'+Settings.businessName+' logo">');Settings.modalHeader.minimizedLogo.enabled===!0&&(chatContainerHTML=chatContainerHTML+'<img class="cv-chat-minimized-logo" src="'+Settings.libEndpoint+"images/titles/"+Settings.modalHeader.minimizedLogo.name+'" alt="'+Settings.businessName+' logo" style="display: none;">');chatContainerHTML=chatContainerHTML+'<div id="cv-va-title" class="cv-chat-title" aria-live="polite">'+Settings.modalHeader.title.text+"</div>";chatContainerHTML=chatContainerHTML+'<div id="cv-btn-group" class="btn-group" role="group" aria-label="'+Settings.ariaLabel.btnGroup+'">';if(Settings.disableBtn.close===!1){chatContainerHTML=chatContainerHTML+'<button id="cv-close-btn" aria-label="'+Settings.ariaLabel.closeBtn+'" type="button" class="close container-control mobile-close">';chatContainerHTML=chatContainerHTML+'<i class="fa '+Settings.modalHeader.btnIcons.close+'" aria-hidden="true"></i>';chatContainerHTML+="</button>"}if(Settings.disableBtn.minimize===!1){chatContainerHTML=chatContainerHTML+'<button id="cv-minimize-btn" aria-label="'+Settings.ariaLabel.minimizedBtn+'" type="button" class="close container-control minimize-va">';chatContainerHTML=chatContainerHTML+'<i class="fa '+Settings.modalHeader.btnIcons.minimize+'" aria-hidden="true"></i>';chatContainerHTML+="</button>"}if(window.CVMobile===!1&&Settings.fullScreen.enabled===!0&&Settings.disableBtn.fullscreen===!1){chatContainerHTML=chatContainerHTML+'<button id="cv-compress-expand-btn" aria-label="'+Settings.ariaLabel.fullScreenBtn+'" type="button" class="close container-control">';chatContainerHTML+='<i class="fa fa-compress" aria-hidden="true"></i>';chatContainerHTML+="</button>"}if(Settings.printIconOption===!0&&window.CVMobile===!1){chatContainerHTML=chatContainerHTML+'<button aria-label="'+Settings.ariaLabel.printBtn+'" type="button" id="print_transcript" class="close container-control cv-print-icon" hidden>';chatContainerHTML+='<i class="fa fa-print" aria-hidden="true"></i>';chatContainerHTML+="</button>"}chatContainerHTML+="</div>";if(Settings.avatar["switch"]===!0){chatContainerHTML+='<label class="switch">';chatContainerHTML+='<input type="checkbox" checked id="cv-toggle-avatar">';chatContainerHTML+='<div class="slider round"></div>';chatContainerHTML+="</label>"}chatContainerHTML+="</div>";Settings.avatar.showInBody===!0&&(chatContainerHTML=chatContainerHTML+'<img id="cv-chat-img-avatar" src="'+Settings.libEndpoint+"images/titles/"+Settings.avatar.name+'" alt="'+Settings.avatar.name+' avatar" style="display: none;">');chatContainerHTML+='<div class="cv-overlays">';chatContainerHTML+='<div id="cv-chat-loader-layer">';chatContainerHTML=chatContainerHTML+'<i class="fa '+Settings.loaderlayerCSS.icon["class"]+' fa-spin cv-loader-icon"></i><span class="sr-only">Loading...</span>';chatContainerHTML+="</div>";if("liveperson"===Settings.livechatVendor){chatContainerHTML+='<div id="cv-lp-end-chat-confirmation" style="display: none;">';chatContainerHTML+='<div style="text-align: center;margin: 0 45px;">Are you sure you want to end the conversation?</div>';chatContainerHTML+='<div class="cv-lp-confirmation-btn-group">';chatContainerHTML+='<input class="btn btn-primary btn-lg btn-block small-border-radius" type="button" value="Yes">';chatContainerHTML+='<input class="btn btn-primary btn-lg btn-block small-border-radius" type="button" value="No">';chatContainerHTML+="</div>";chatContainerHTML+="</div>"}chatContainerHTML+="</div>";chatContainerHTML+='<div id="cv-chat-body" class="modal-body" aria-live="polite">';chatContainerHTML+='<div id="cv-chat-answer-history" class="cv-chat-history">';chatContainerHTML+="</div>";if(Settings.agentSurveyOptions){for(var checkboxes=[],i=0;i<Settings.agentSurveyOptions.checkboxes.length;i++)checkboxes.push('<div class="checkbox"> <label for="checkboxes-'+i+'"> <input type="checkbox" name="checkboxes" id="checkboxes-'+i+'" value="'+Settings.agentSurveyOptions.checkboxes[i]+'">'+Settings.agentSurveyOptions.checkboxes[i]+" </label></div>");var freeText="";Settings.agentSurveyOptions.freeText&&(freeText='<textarea class="form-control" id="textarea" name="textarea" placeholder="Type your message..."></textarea>');chatContainerHTML=chatContainerHTML+'<div id="cv-agent-survey-modal" class="" style="display:none;z-index: 9999;background: #8e8e8ebd;width: 101%;height: 100%;position: absolute;left: 0px;overflow: auto;"><div class="modal-content" style="background-color: #ffffff;"> <div class="modal-header" style="padding-top: 5px;padding-bottom: px;"> <h5 class="modal-title" style="display: inline;">Feedback</h5> <button type="button" class="close" data-dismiss="modal" aria-label="Close"> <span aria-hidden="true">×</span> </button> </div><div class="modal-body" style="position: relative;padding-bottom: 5px;"><div class="row submitmessage" style="display:none"><div class="col-md-12" style="padding-bottom: 15px;">Thank you for your feedback!</div></div> <div class="row agentsurvey"><div class="col-md-12" style="">'+checkboxes.join("")+'</div><div class="col-md-12">'+freeText+'</div></div><div class="modal-footer" style="padding-top: 5px;"><div class="row"><div class="col-md-12"> <button type="button" class="btn btn-primary submitagentfeedback" style="background-color: rgb(215, 25, 32) !important;border-color: rgb(215, 25, 32);position: relative">Send Feedback</button></div></div> </div></div></div></div>'}chatContainerHTML+="</div>";chatContainerHTML+='<div class="row modal-footer cv-chat-footer">';Settings.input.counter.enable===!0&&(chatContainerHTML+='<div id="cv-maxlength-counter" style="display: none;"></div>');chatContainerHTML+='<form id="cv-chat-form" class="form col-sm-12 center-block">';chatContainerHTML+='<div class="form-group cv-form-group-input">';chatContainerHTML=Settings.inputTextArea===!0?chatContainerHTML+'<textarea rows="2" aria-label="'+Settings.ariaLabel.userEntry+'" accesskey="c" id="cv-chat-user-entry" type="text" name="entry" autocomplete="off" class="form-control cv-chat-user-entry" placeholder="'+Settings.defaultPlaceholderText+'" maxlength="'+Settings.input.maxlength+'"></textarea>':chatContainerHTML+'<input aria-label="'+Settings.ariaLabel.userEntry+'" accesskey="c" id="cv-chat-user-entry" type="text" name="entry" autocomplete="off" class="form-control cv-chat-user-entry" placeholder="'+Settings.defaultPlaceholderText+'" maxlength="'+Settings.input.maxlength+'"></input>';chatContainerHTML+="</div>";chatContainerHTML+='<div class="form-group cv-form-group-submit">';chatContainerHTML=chatContainerHTML+'<button aria-label="'+Settings.ariaLabel.submitBtn+'" id="cv-chat-submit" type="submit" class="btn btn-primary btn-block small-border-radius" disabled="true">';Settings.useImageButton===!0&&(chatContainerHTML=chatContainerHTML+'<img class="cv-button-text-image" src="'+Settings.libEndpoint+"images/submit/"+Settings.imageButtonText+'" alt="VA Button Image">');if(Settings.useImageDisabledButton===!0)chatContainerHTML=chatContainerHTML+'<img class="cv-disabled-button-text-image" src="'+Settings.libEndpoint+"images/submit/"+Settings.imageDisabledButtonText+'" alt="VA Button Image">';else{Settings.submitBtn.enabledFontAwesome&&(chatContainerHTML=chatContainerHTML+'<i class="cv-submit-icon fa '+Settings.submitBtn.fontAwesome+'" aria-hidden="true"></i>');chatContainerHTML+=Settings.submitBtn.text}chatContainerHTML+="</button>";chatContainerHTML+="</div>";chatContainerHTML+="</form>";if(window.CVMobile===!1){if(Settings.cvFooter===!0){chatContainerHTML+='<div class="col-xs-5 col-sm-4 creative-virtual-logo">';chatContainerHTML+="<span>";chatContainerHTML+='<a href="http://www.creativevirtual.com/us/" target="_blank">';chatContainerHTML=chatContainerHTML+'<img src="'+libEndpoint+'/images/creative_virtual_full_color.png" alt="Creative Virtual Logo"/>';chatContainerHTML+="</a>";chatContainerHTML+="</span>";chatContainerHTML+="</div>"}if(Settings.cvDisclaimer===!0){chatContainerHTML+='<div class="col-xs-7 col-sm-8 cv-chat-disclaimer">';chatContainerHTML+="<span>For quality and security purposes, your session is recorded and may be reviewed. For your privacy, please do not enter any personal information.</span>";chatContainerHTML+="</div>"}}if(Settings.textResize===!0&&window.CVMobile===!1){chatContainerHTML+='<ul id="cv-font-size" class="list-group">';chatContainerHTML=chatContainerHTML+'<li><a class="font-small" role="button" data-class="small" href="#" aria-label="'+Settings.ariaLabel.fontSizeBtn.small+'"><i class="fa fa-font cv-font-icon" aria-hidden="true"></i></a></li>';chatContainerHTML=chatContainerHTML+'<li><a class="font-medium" role="button" data-class="medium" href="#" aria-label="'+Settings.ariaLabel.fontSizeBtn.medium+'"><i class="fa fa-font cv-font-icon active-cv-font-size" aria-hidden="true"></i></a></li>';chatContainerHTML=chatContainerHTML+'<li><a class="font-large" role="button" data-class="large" href="#" aria-label="'+Settings.ariaLabel.fontSizeBtn.large+'"><i class="fa fa-font cv-font-icon" aria-hidden="true"></i></a></li>';chatContainerHTML+="</ul>"}Settings.cvLCbtn.enabled===!0&&(chatContainerHTML=chatContainerHTML+'<button aria-label="'+Settings.cvLCbtn.text+'" type="button" id="cv-lc-btn" class="btn">'+Settings.cvLCbtn.text+"</button>");chatContainerHTML+="</div>";if(Settings.faqTab===!0&&window.CVMobile===!1){chatContainerHTML+='<div id="cv-faq-container">';chatContainerHTML+='<div id="cv-faq-panel" class="collapse width">';chatContainerHTML+='<div id="cv-faq-body">';chatContainerHTML+='<div id="breadcrumb"></div>';chatContainerHTML+='<div id="dropdown"></div>';chatContainerHTML+='<div id="faq_list"></div>';chatContainerHTML+="</div>";chatContainerHTML+="</div>";chatContainerHTML+='<button id="cv-faq-btn" type="button" class="btn btn-primary" data-cv-toggle="collapse" data-cv-target="#cv-faq-panel"><i class="fa fa-bars" aria-hidden="true"></i></button>';chatContainerHTML+="</div>"}if("liveperson"===Settings.livechatVendor){chatContainerHTML+='<div id="cv-lp-secure-form-container">';chatContainerHTML+='<div id="cv-lp-secure-form-panel" class="collapse width">';chatContainerHTML+='<div id="cv-lp-secure-form-header">';chatContainerHTML+='<a href="#">';chatContainerHTML+='<i class="fa fa-arrow-circle-right" aria-hidden="true"></i>';chatContainerHTML+="</a>";chatContainerHTML+="</div>";chatContainerHTML+='<div id="cv-lp-secure-form-body">';chatContainerHTML+="</div>";chatContainerHTML+="</div>";chatContainerHTML+="</div>"}chatContainerHTML+="</div>";chatContainerHTML+="</div>";chatContainerHTML+="</div>";chatContainerHTML+="</div>";$("body").append(chatContainerHTML);$(".cv-va-bootstrap #cv-chat-submit.disabled, .cv-va-bootstrap #cv-live-chat-submit.disabled").css({"background-color":Settings.submitBtn.disabled.backgroundColor,"border-color":Settings.submitBtn.disabled.backgroundColor});if($(".cv-va-bootstrap #cv-chat-submit, .cv-va-bootstrap #cv-live-chat-submit").is(":disabled")){$(".cv-va-bootstrap .cv-button-text-image").hide();$(".cv-va-bootstrap .cv-disabled-button-text-image").show()}else{$(".cv-va-bootstrap .cv-button-text-image").show();$(".cv-va-bootstrap .cv-disabled-button-text-image").hide()}$(".cv-va-bootstrap #cv-chat-header, .cv-va-bootstrap #cv-lp-secure-form-header").css({"background-color":Settings.modalHeader.backgroundColor,"border-top-color":Settings.modalHeader.backgroundColor,"border-right-color":Settings.modalHeader.backgroundColor,"border-left-color":Settings.modalHeader.backgroundColor,"border-bottom":Settings.headerBorderBottom});$(".cv-va-bootstrap #cv-lp-secure-form-header").css({height:Settings.modalHeader.height});$(".cv-va-bootstrap #cv-lp-secure-form-header a").css({color:Settings.modalHeader.color}).on("click",function(e){e.preventDefault();$(".cv-va-bootstrap .modal-dialog").css({width:"100%",left:"0"})});$(document).off("click").on("click","#cv-agent-survey-modal .submitagentfeedback",function(event){if($("#cv-agent-survey-modal .agentsurvey").is(":visible")){var checkboxes=[];$("#cv-agent-survey-modal input:checked").each(function(){checkboxes.push($(this).attr("value"))});var freeText=$("#cv-agent-survey-modal textarea").val();console.log("Agent Survey feedback: ",window.CVVA.model);console.log("Agent Survey feedback: "+checkboxes);console.log("Agent Survey feedback: "+freeText);$.ajax({type:"POST",url:Settings.libEndpoint+"agentfeedback",data:{data:JSON.stringify($.extend(window.CVVA.model,{freetext:freeText,checkboxes:checkboxes}))||null},error:function(xhr,textStatus,error){console.log("Failed to submit feedback");$("#cv-agent-survey-modal .submitagentfeedback").animate({left:"+=20"}).animate({left:"-=40"}).animate({left:"+=20"}).text("Please try again")},success:function(){$("#cv-agent-survey-modal .agentsurvey").hide();$("#cv-agent-survey-modal .submitmessage").show();$("#cv-agent-survey-modal .submitagentfeedback").text("Close");$(".agent_survey_overlay").last().hide()}})}else{$("#cv-agent-survey-modal").hide();$("#cv-agent-survey-modal .agentsurvey").show();$("#cv-agent-survey-modal .submitmessage").hide();$("#cv-agent-survey-modal .submitagentfeedback").text("Send Feedback")}});$(document).on("click",".agent_survey_overlay",function(event){event.preventDefault();$("#cv-agent-survey-modal textarea").val("");$("#cv-agent-survey-modal input:checked").prop("checked",!1);$("#cv-agent-survey-modal").show()});$(document).on("click","#cv-agent-survey-modal button.close",function(){$("#cv-agent-survey-modal").hide();$("#cv-agent-survey-modal .agentsurvey").show();$("#cv-agent-survey-modal .submitmessage").hide();$("#cv-agent-survey-modal .submitagentfeedback").text("Send Feedback")});$(".cv-va-bootstrap .cv-chat-title").css({color:Settings.modalHeader.color});if(Settings.modalHeader.title.disabled===!0){$(".cv-va-bootstrap .cv-chat-title").hide();$(".cv-va-bootstrap .cv-chat-title").addClass("offscreen")}Settings.modalHeader.extralogo.enabled===!0&&$(".cv-va-bootstrap .cv-chat-title").hide();Settings.modalHeader.minimizedLogo.enabled===!0&&$(".cv-va-bootstrap .cv-chat-minimized-logo").hide();$(".cv-va-bootstrap #cv-chat-header .container-control, .cv-va-bootstrap .cv-live-chat-active-title").css({color:Settings.modalHeader.color});$(".cv-va-bootstrap .btn-primary:hover").css({"background-color":Settings.mainColor,"border-color":Settings.mainColor});if(Settings.vaShim===!0&&window.CVMobile===!1){$(".cv-va-bootstrap #cv-chat-content").addClass("back-shim");$(".cv-va-bootstrap #cv-chat-content").addClass("front-shim")}window.CVMobile===!1?$(".cv-va-bootstrap #cv-chat-user-entry").css({height:"85px","font-size":Settings.inputFontSize,"border-radius":Settings.inputBorderRadius}):$(".cv-va-bootstrap #cv-chat-user-entry").css({height:"50px","font-size":Settings.input.mobileFontSize,"border-radius":Settings.inputBorderRadius});$(".cv-va-bootstrap #cv-chat-submit, .cv-va-bootstrap #cv-live-chat-submit").css({"border-radius":Settings.inputBorderRadius,"font-weight":Settings.submitBtn.fontWeight,"font-size":Settings.submitBtn.fontSize});window.CVMobile&&Settings.submitBtn.mobileFontSize!==!1&&$(".cv-va-bootstrap #cv-chat-submit, .cv-va-bootstrap #cv-live-chat-submit").css({"font-size":Settings.submitBtn.mobileFontSize});Settings.submitBtn.disabled.opacity===!0&&$(".cv-va-bootstrap .btn.disabled, .cv-va-bootstrap .btn[disabled], .cv-va-bootstrap fieldset[disabled] .btn").css({opacity:"1"});if(Settings.avatar.enabled===!0&&$(".cv-va-bootstrap #cv-toggle-avatar").is(":visible")){$(".cv-va-bootstrap .container-control").css({top:"-8px"});$(".cv-va-bootstrap #cv-chat-img-avatar").css({width:"initial",top:"30px",left:"70px"});window.desactivate_avatar=function(){if($(".cv-va-bootstrap #cv-toggle-avatar").is(":checked")){$(".cv-va-bootstrap #cv-chat-img-avatar").show();!$(".cv-va-bootstrap .cv-va-bubble").is(":visible");$(".cv-va-bootstrap .cv-va-bubble").before('<img class="cv-avatar" src="'+Settings.libEndpoint+"images/titles/"+Settings.modalHeader.logo.name+'">');$(".cv-va-bootstrap .cv-avatar").show();$(".cv-va-bootstrap .cv-va-bubble").css("margin-left","34px");$(".cv-va-bootstrap .va-time-stamp").css("left","37px");$(".cv-va-bootstrap .cv-va-bubble.va-time-stamp-shim").removeClass("va-time-stamp-shim-avatar")}else{$(".cv-va-bootstrap #cv-chat-img-avatar").hide();$(".cv-va-bootstrap .cv-avatar").hide();$(".cv-va-bootstrap .cv-va-bubble").css("margin-left","0px");$(".cv-va-bootstrap .va-time-stamp").css("left","6px");$(".cv-va-bootstrap .cv-va-bubble.va-time-stamp-shim").addClass("va-time-stamp-shim-avatar")}};$("#cv-toggle-avatar").on("click",desactivate_avatar)}var styleTags='<style id="cv-va-styles">';Settings.googleFont.enabled===!0&&(styleTags=styleTags+"@import url("+Settings.googleFont.url+");");styleTags+=".cv-va-bootstrap {";styleTags=styleTags+"font-family: "+Settings.fontfamily+" !important;";styleTags=styleTags+"z-index: "+Settings.cvvaBootstrapzIndex+";";styleTags+="}";var modalFooterHeight=$(".cv-va-bootstrap .cv-chat-footer").outerHeight()+"px";styleTags+=".cv-va-bootstrap #cv-chat-loader-layer {";styleTags=styleTags+"align-items: "+Settings.loaderlayerCSS.alignItems+" !important;";styleTags=styleTags+"padding: "+Settings.loaderlayerCSS.padding+" !important;";styleTags=styleTags+"top: "+Settings.modalHeader.height+" !important;";styleTags=styleTags+"bottom: "+modalFooterHeight+" !important;";styleTags+="}";styleTags+=".cv-va-bootstrap .cv-loader-icon {";styleTags=styleTags+"width: "+Settings.loaderlayerCSS.icon.width+";";styleTags=styleTags+"font-size: "+Settings.loaderlayerCSS.icon.fontSize+" !important;";styleTags=styleTags+"color: "+Settings.loaderlayerCSS.icon.color+" !important;";styleTags+="}";styleTags+=".cv-va-bootstrap #cv-chat-submit, .cv-va-bootstrap #cv-live-chat-submit, .cv-va-bootstrap #cv-lc-btn {";styleTags=styleTags+"background-color: "+Settings.submitBtn.backgroundColor+";";styleTags=styleTags+"color: "+Settings.submitBtn.color+";";styleTags+="}";styleTags+=".cv-va-bootstrap #cv-chat-submit.disabled, .cv-va-bootstrap #cv-live-chat-submit.disabled {";styleTags=styleTags+"background-color: "+Settings.submitBtn.disabled.backgroundColor+";";styleTags=styleTags+"color: "+Settings.submitBtn.disabled.color+";";styleTags+="}";styleTags+=".cv-va-bootstrap #cv-chat-submit:focus, .cv-va-bootstrap #cv-live-chat-submit:focus, .cv-va-bootstrap #cv-lc-btn:focus {";styleTags=styleTags+"background-color: "+Settings.submitBtn.focus.backgroundColor+" !important;";styleTags+="}";styleTags+=".cv-va-bootstrap .panel-heading, .cv-va-bootstrap .cv-live-chat-user, .cv-va-bootstrap .cv-chat-transaction-entry {";styleTags=styleTags+"background-color: "+Settings.userBubbleBackgroundColor+" !important;";styleTags=styleTags+"color: "+Settings.vaPillFontColor+" !important;";styleTags+="}";styleTags+=".cv-va-bootstrap .cv-va-bubble *, .cv-va-bootstrap .cv-live-chat-agent, .cv-va-bootstrap .panel-heading, .cv-va-bootstrap .cv-live-chat-user {";styleTags=styleTags+"line-height: "+Settings.bubbleLineHeight+" !important;";styleTags+="}";styleTags+=".cv-va-bootstrap .cv-chat-transaction-title {";styleTags=styleTags+"color: "+Settings.vaPillFontColor+" !important;";styleTags+="}";styleTags+=".cv-va-bootstrap .cv-chat-transaction-entry {";styleTags=styleTags+"color: "+Settings.vaInputPillFontColor+" !important;";styleTags=styleTags+"font-style: "+Settings.inputPillFontStyle+" !important;";styleTags+="}";styleTags+=".cv-va-bootstrap .cv-chat-history, .cv-va-bootstrap .cv-chat-transaction-title, .cv-va-bootstrap .cv-live-chat-info, .cv-va-bootstrap .cv-live-chat-user, .cv-va-bootstrap .cv-ui-autocomplete, .cv-va-bootstrap .cv-live-chat-agent, .cv-va-bootstrap .cv-live-chat-user, #cv-eocs-overlay{";styleTags=window.CVMobile===!1?styleTags+"font-size: "+Settings.chatHistoryDiv.fontSize+";":styleTags+"font-size: "+Settings.chatHistoryDiv.mobileFontSize+";";styleTags+="}";styleTags+=".cv-va-bootstrap #cv-chat-header {";styleTags=styleTags+"border-bottom-width: "+Settings.modalHeader.bottomBorderWidth+"!important;";styleTags=window.CVMobile===!1?styleTags+"height: "+Settings.modalHeader.height+";":styleTags+"height: "+Settings.modalHeader.mobile.height+";";Settings.avatar.enabled===!0&&(styleTags+="padding: 0px 15px !important;");styleTags+="}";if("liveperson"===Settings.livechatVendor){styleTags+=".cv-va-bootstrap .cv-lp-confirmation-btn-group>input, .cv-va-bootstrap #cv-lp-btn-group>button {";styleTags=styleTags+"background-color: "+Settings.submitBtn.backgroundColor+";";styleTags=styleTags+"border-color: "+Settings.submitBtn.backgroundColor+";";styleTags=styleTags+"color: "+Settings.submitBtn.color+";";styleTags+="}"}styleTags+=".cv-va-bootstrap #cv-chat-header .container-control:focus {";styleTags=styleTags+"outline: "+Settings.modalHeader.outline+" !important;";styleTags+="}";if("conversational"===Settings.vaChatView){if(Settings.shrunkenUI===!0){styleTags+=".cv-va-bootstrap #cv-chat-content {";styleTags=styleTags+"width: "+Settings.modalContent.width+";";styleTags=styleTags+"height: "+Settings.modalContent.height+";";styleTags=styleTags+"border: "+Settings.modalContent.border+";";if(window.CVMobile===!1){styleTags=styleTags+"box-shadow: "+Settings.modalContent.boxShadow+";";styleTags=styleTags+"border-radius: "+Settings.modalContent.borderRadius+";"}else{styleTags+="box-shadow: none;";styleTags+="border-radius: 0px;"}styleTags=styleTags+"border-top: "+Settings.modalContent.borderTop+";";styleTags=styleTags+"margin: "+Settings.modalContent.minimizeMargin+";";styleTags+="}";styleTags+=".cv-va-bootstrap .cv-chat-footer {";styleTags=styleTags+"border-top:"+Settings.modalFooter.borderTop+";";styleTags=styleTags+"background-color:"+Settings.modalFooter.backgroundColor+";";styleTags=styleTags+"border-radius:"+Settings.modalFooter.borderRadius+";";styleTags=window.CVMobile===!1?styleTags+"padding:"+Settings.modalFooter.padding+";":styleTags+"padding:"+Settings.modalFooter.mobilePadding+";";styleTags+="}";styleTags+=".cv-va-bootstrap #cv-chat-submit:focus, .cv-va-bootstrap #cv-live-chat-submit:focus {";styleTags=styleTags+"color:"+Settings.submitBtn.focus.color+";";styleTags+="}";styleTags+=".cv-va-bootstrap #cv-chat-body, .cv-va-bootstrap .cv-chat-transaction-panel{";styleTags=styleTags+"background-color:"+Settings.chatHistoryDiv.backgroundColor+";";styleTags=styleTags+"padding:"+Settings.chatHistoryDiv.padding+";";styleTags+="}";styleTags+=".cv-va-bootstrap .cv-init-message {";styleTags=styleTags+"background-color:"+Settings.initMessage.backgroundColor+";";styleTags=styleTags+"color:"+Settings.initMessage.color+";";styleTags=styleTags+"border-radius:"+Settings.initMessage.borderRadius+";";styleTags=styleTags+"margin:"+Settings.initMessage.margin+";";styleTags=window.CVMobile===!1?styleTags+"padding:"+Settings.initMessage.padding+";":styleTags+"padding:"+Settings.initMessage.mobilePadding+";";styleTags=styleTags+"border:"+Settings.initMessage.border+";";styleTags=styleTags+"box-shadow:"+Settings.initMessage.boxShadow+";";styleTags=styleTags+"border-bottom-color:"+Settings.initMessage.borderBottomColor+";";styleTags=styleTags+"border-top:"+Settings.initMessage.borderTop+";";styleTags+="}";styleTags+=".cv-va-bootstrap .cv-chat-logo, .cv-va-bootstrap .cv-chat-minimized-logo, .cv-va-bootstrap #cv-lc-chat-logo {";styleTags+="margin-left: 0px;";
styleTags+="}";styleTags+=".cv-va-bootstrap .cv-chat-logo, .cv-va-bootstrap #cv-lc-chat-logo {";styleTags=styleTags+"width:"+Settings.modalHeader.logo.width+";";styleTags=styleTags+"border-radius:"+Settings.modalHeader.logo.borderRadius+";";styleTags+="}";styleTags+=".cv-va-bootstrap .cv-chat-minimized-logo {";styleTags=styleTags+"width:"+Settings.modalHeader.minimizedLogo.width+";";styleTags=styleTags+"border-radius:"+Settings.modalHeader.logo.borderRadius+";";styleTags+="}";styleTags+=".cv-va-bootstrap .cv-chat-extra-logo {";styleTags=styleTags+"width:"+Settings.modalHeader.extralogo.width+";";styleTags+="}";styleTags+=".cv-va-bootstrap #cv-chat-header button i {";styleTags=window.CVMobile===!1?styleTags+"font-size: "+Settings.modalHeader.iconFontSize+";":styleTags+"font-size: "+Settings.modalHeader.mobileIconFontSize+"!important;";styleTags+="}";styleTags+=".cv-va-bootstrap .panel-heading, .cv-va-bootstrap .cv-live-chat-user {";styleTags+="min-width: 0px!important;";styleTags+="margin-left: 45px!important;";styleTags=styleTags+"border-radius: "+Settings.userBubbleCSS.borderRadius+";";styleTags+="}";if(Settings.userBubbleDisabledShim===!1){styleTags+=".cv-va-bootstrap .panel-heading.va-time-stamp-shim:before, .cv-va-bootstrap .cv-live-chat-user.ts-shim:before {";styleTags+='content: "";';styleTags+="position: absolute;";styleTags+="right: -8px;";styleTags+="width: 0;";styleTags+="height: 0;";styleTags+="border: 4px solid;";if("top"===Settings.bubbleShim.position){styleTags+="top: 0px;";styleTags=styleTags+"border-color: "+Settings.userBubbleBorderColor+" transparent transparent "+Settings.userBubbleBorderColor+";"}else{styleTags+="bottom: 0px;";styleTags=styleTags+"border-color: transparent transparent "+Settings.userBubbleBorderColor+" "+Settings.userBubbleBorderColor+";"}styleTags+="}";styleTags+=".cv-va-bootstrap .panel-heading.va-time-stamp-shim:after, .cv-va-bootstrap .cv-live-chat-user.ts-shim:after {";styleTags+='content: "";';styleTags+="position: absolute;";styleTags=styleTags+"right: "+Settings.bubbleShim.leftRight+";";styleTags+="width: 0;";styleTags+="height: 0;";styleTags+="border-style: solid;";styleTags=styleTags+"border-width: "+Settings.bubbleShim.width+";";if("top"===Settings.bubbleShim.position){styleTags=styleTags+"border-color: "+Settings.userBubbleBackgroundColor+" transparent transparent "+Settings.userBubbleBackgroundColor+";";styleTags+=""===Settings.userBubbleBorder?"top: 0px;":"top: 1px;"}else{styleTags=styleTags+"border-color: transparent transparent "+Settings.userBubbleBackgroundColor+" "+Settings.userBubbleBackgroundColor+";";styleTags+=""===Settings.userBubbleBorder?"bottom: 0px;":"bottom: 1px;"}styleTags+="}"}if(Settings.vaBubbleDisabledShim===!1){styleTags+=".cv-va-bootstrap .cv-va-bubble.va-time-stamp-shim:before, .cv-va-bootstrap .cv-live-chat-agent.ts-shim:before {";styleTags+='content: "";';styleTags+="position: absolute;";if("top"===Settings.bubbleShim.position){styleTags+="top: 0px;";styleTags+="transform: rotate(90deg);"}else{styleTags+="bottom: 0px;";styleTags+="transform: rotate(180deg);"}styleTags+="left: -8px;";styleTags+="width: 0;";styleTags+="height: 0;";styleTags+="border: 4px solid;";styleTags=styleTags+"border-color: "+Settings.vaBubbleBorderColor+" transparent transparent "+Settings.vaBubbleBorderColor+";";styleTags+="}";styleTags+=".cv-va-bootstrap .cv-va-bubble.va-time-stamp-shim:after, .cv-va-bootstrap .cv-live-chat-agent.ts-shim:after {";styleTags+='content: "";';styleTags+="position: absolute;";Settings.avatar.enabled===!1?styleTags=styleTags+"left: "+Settings.bubbleShim.leftRight+";":styleTags+="left: 28px;";styleTags+="width: 0;";styleTags+="height: 0;";styleTags+="border-style: solid;";styleTags=styleTags+"border-width: "+Settings.bubbleShim.width+";";if("top"===Settings.bubbleShim.position){styleTags+="transform: rotate(90deg);";styleTags=styleTags+"border-color: "+Settings.vaBubbleBackgroundColor+" transparent transparent "+Settings.vaBubbleBackgroundColor+";";styleTags+=""===Settings.userBubbleBorder?"top: 0px;":"top: 1px;"}else{styleTags+="transform: rotate(270deg);";styleTags=styleTags+"border-color: transparent transparent "+Settings.vaBubbleBackgroundColor+" "+Settings.vaBubbleBackgroundColor+";";styleTags+=""===Settings.userBubbleBorder?"bottom: 0px;":"bottom: 1px;"}styleTags+="}";styleTags+=".cv-va-bootstrap #cv-chat-submit, .cv-va-bootstrap #cv-live-chat-submit{";styleTags=styleTags+"border-radius:"+Settings.inputBorderRadius+" !important;";styleTags=styleTags+"font-weight:"+Settings.submitBtn.fontWeight+" !important;";styleTags=styleTags+"font-size:"+Settings.submitBtn.fontSize+" !important;";styleTags=styleTags+"background-color:"+Settings.submitBtn.backgroundColor+" !important;";styleTags=styleTags+"border-color:"+Settings.submitBtn.backgroundColor+" !important;";styleTags+="}";styleTags+=".cv-va-bootstrap #cv-lc-pcs button, .cv-va-bootstrap #feedbackSend {";styleTags+="border-radius: 0px !important;";styleTags+="font-weight: normal !important;";styleTags+="font-size:14px !important;";styleTags+="background-color: #000 !important;";styleTags+="border: none !important;";styleTags+="color: #fff !important;";styleTags+="}"}styleTags+=".cv-va-bootstrap .cv-minimize-chat-header i {";styleTags=styleTags+"color:"+Settings.minimizedContentMobile.color+" !important;";styleTags+="}";styleTags+=".cv-va-bootstrap .cv-minimize-chat-header {";styleTags=styleTags+"background:linear-gradient("+Settings.minimizedContentMobile.backgroundColor+","+Settings.minimizedContentMobile.backgroundColor+")repeat 0 0 !important;";styleTags=styleTags+"color:"+Settings.minimizedContentMobile.color+" !important;";styleTags=styleTags+"border-color:"+Settings.minimizedContentMobile.backgroundColor+" !important;";styleTags+="}";styleTags+=".cv-va-bootstrap .cv-va-bubble, .cv-va-bootstrap .cv-live-chat-agent {";styleTags=styleTags+"border-radius: "+Settings.vaBubbleCSS.borderRadius+";";styleTags+=Settings.avatar.enabled===!0?"margin-left:34px;":"margin-right:45px !important;";styleTags+="}";styleTags+=".cv-va-bootstrap .cv-chat-user-entry, .cv-va-bootstrap #cv-chat-submit, .cv-va-bootstrap #cv-live-chat-submit, .cv-va-bootstrap #cv-live-chat-user-entry {";if(Settings.inputTextArea===!0){styleTags=styleTags+"min-height:"+Settings.submitBtn.height+";";styleTags+="max-height: 166px;"}else styleTags=styleTags+"height:"+Settings.submitBtn.height+" !important;";Settings.submitBtn.transition===!0&&(styleTags+="transition:color .15s ease-in-out,background-color .15s ease-in-out,border-color .15s ease-in-out,box-shadow .15s ease-in-out !important;");styleTags+="}";styleTags+=".cv-va-bootstrap .form-group {";styleTags+="margin-bottom:6px !important;";styleTags+="}";styleTags+=".cv-va-bootstrap #cv-chat-submit, .cv-va-bootstrap #cv-live-chat-submit {";styleTags+="padding:0px;";styleTags=styleTags+"width:"+Settings.submitBtn.width+";";styleTags+="}";styleTags+=".cv-va-bootstrap .cv-chat-user-entry, .cv-va-bootstrap #cv-live-chat-user-entry {";styleTags=styleTags+"border:"+Settings.input.css.border+" !important;";styleTags=styleTags+"box-shadow:"+Settings.input.css.boxShadow+" !important;";styleTags=styleTags+"-webkit-box-shadow:"+Settings.input.css.boxShadow+" !important;";styleTags=styleTags+"border-right:"+Settings.input.css.borderRight+" !important;";styleTags=styleTags+"padding:"+Settings.input.css.padding+" !important;";styleTags=styleTags+"border-radius:"+Settings.inputBorderRadius+" !important;";styleTags=styleTags+"background-color:"+Settings.input.css.backgroundColor+" !important;";styleTags+="}";if("row"===Settings.form.flexDirection){styleTags+=".cv-va-bootstrap #cv-chat-form {";styleTags+="flex-direction: row;";styleTags+="-webkit-flex-direction: row;";styleTags+="}";styleTags+=".cv-va-bootstrap .cv-form-group-input {";styleTags+="flex-grow: 2;";styleTags+="margin-bottom: 0 !important;";styleTags+="margin-right: 6px !important;";styleTags+="}";styleTags+=".cv-va-bootstrap .cv-form-group-submit {";styleTags+="margin-bottom: 0 !important;";styleTags+="}";styleTags+=".cv-va-bootstrap .cv-form-group-submit button {";styleTags+="padding-right: 10px !important;";styleTags+="padding-left: 10px !important;";styleTags+="}";styleTags+=".cv-va-bootstrap .cv-submit-icon {";styleTags+="margin-right: 0px !important;";styleTags+="}"}styleTags+=".cv-va-bootstrap #cv-chat-user-entry[disabled] {";styleTags=styleTags+"background-color:"+Settings.inputDisabledBackgroundColor+" !important;";styleTags+="}"}styleTags+=".cv-va-bootstrap .cv-chat-va-typing {";styleTags=styleTags+"font-size:"+Settings.vaTypingFontSize+";";styleTags+="}";var modalHeaderBorderTopRightLeftRadius;modalHeaderBorderTopRightLeftRadius=window.CVMobile===!0?"0px":parseInt(Settings.modalContent.borderRadius,10)-1+"px";styleTags+=".cv-va-bootstrap #cv-chat-header {";styleTags=styleTags+"background:linear-gradient("+Settings.modalHeader.backgroundColor+","+Settings.modalHeader.secondBackgroundColor+")repeat 0 0;";styleTags=styleTags+"padding:"+Settings.modalHeader.padding+";";styleTags=styleTags+"border-top-left-radius:"+modalHeaderBorderTopRightLeftRadius+";";styleTags=styleTags+"border-top-right-radius:"+modalHeaderBorderTopRightLeftRadius+";";styleTags+="}";styleTags+=".cv-va-bootstrap #cv-btn-group {";styleTags=styleTags+"margin:"+Settings.modalHeader.btnGroupMargin+";";styleTags+="}";styleTags+=".cv-va-bootstrap #cv-close-btn {";styleTags=styleTags+"margin:"+Settings.modalHeader.closeBtnMargin+";";styleTags+="}";styleTags+=".cv-va-bootstrap #cv-minimize-btn {";styleTags=styleTags+"margin:"+Settings.modalHeader.minimizeBtnMargin+";";styleTags+="}";styleTags+=".cv-va-bootstrap .minimize-icon {";styleTags+=Settings.modalHeader.btnIcons.css.minimize;styleTags+="}";styleTags+=".cv-va-bootstrap .close-icon {";styleTags+=Settings.modalHeader.btnIcons.css.close;styleTags+="}";styleTags+=".cv-va-bootstrap .col-xs-12 {";styleTags=styleTags+"margin-bottom:"+Settings.chatHistoryDiv.spaceBtwnBubbles+";";styleTags+="}";styleTags+=".cv-va-bootstrap .cv-va-bubble, .cv-va-bootstrap .cv-live-chat-agent {";styleTags=styleTags+"border:"+Settings.vaBubbleBorder+" !important;";styleTags=styleTags+"border-color:"+Settings.vaBubbleBorderColor+" !important;";styleTags=styleTags+"background-color:"+Settings.vaBubbleBackgroundColor+" !important;";styleTags=styleTags+"border-radius: "+Settings.vaBubbleCSS.borderRadius+";";Settings.avatar.enabled===!1&&(styleTags+="margin-right:140px;");styleTags=styleTags+"padding:"+Settings.bubblePadding+" !important;";styleTags+="word-wrap:break-word !important;";Settings.shrunkenUI===!0&&(styleTags+="display:inline-block;");styleTags+="}";styleTags+=".cv-va-bootstrap .cv-va-answerpart {";styleTags+="border-radius: 15px!important;";styleTags+="}";styleTags+=".cv-va-bootstrap .cv-chat-transaction-title {";styleTags+="}";styleTags+=".cv-va-bootstrap .panel-heading, .cv-va-bootstrap .cv-live-chat-user{";styleTags=styleTags+"border-radius: "+Settings.userBubbleCSS.borderRadius+";";styleTags=styleTags+"padding:"+Settings.bubblePadding+" !important;";styleTags=styleTags+"border:"+Settings.userBubbleBorder+" !important;";styleTags=styleTags+"border-color:"+Settings.userBubbleBorderColor+" !important;";styleTags+="word-wrap:break-word !important;";styleTags+="margin-left:150px;";styleTags+="min-width:54px;";styleTags+="float:right;";styleTags+="}";styleTags+=".cv-va-bootstrap .va-time-stamp, .cv-va-bootstrap .time-stamp-info {";styleTags=styleTags+"color:"+Settings.timeStamp.color+";";styleTags=styleTags+"font-size:"+Settings.timeStamp.fontSize+" !important;";styleTags+="position:absolute !important;";styleTags=styleTags+"bottom:"+Settings.timeStamp.bottom+";";styleTags+="line-height:14.2857px; !important;";Settings.avatar.enabled===!0?styleTags+="left:37px;":styleTags=styleTags+"left:"+Settings.timeStamp.positionRightLeft+";";styleTags+="}";styleTags+=".cv-va-bootstrap .user-cv-time-stamp, .cv-va-bootstrap .time-stamp-user {";styleTags=styleTags+"color:"+Settings.timeStamp.color+";";styleTags=styleTags+"font-size:"+Settings.timeStamp.fontSize+" !important;";styleTags+="position:absolute !important;";styleTags=styleTags+"bottom:"+Settings.timeStamp.bottom+" !important;";styleTags=styleTags+"right:"+Settings.timeStamp.positionRightLeft+";";styleTags+="}";styleTags+=".cv-va-bootstrap .ics-thumb-btn-group {";styleTags+="left:122px !important;";styleTags+="bottom:43px !important;";styleTags+="margin-bottom:-6px !important;";styleTags+="}";if(window.CVMobile===!0){styleTags+=".cv-va-bootstrap .minimize-shim:before {";styleTags=styleTags+"border-color: "+Settings.minimizedContentMobile.backgroundColor+" !important;";styleTags+="}"}if(Settings.shrunkenUI===!1){styleTags+=".cv-va-bootstrap .va-time-stamp.va-time-stamp-shim:before {";styleTags+="border-left:9px solid transparent;";styleTags+="border-right:9px solid transparent;";styleTags+="border-top:9px solid;";styleTags=styleTags+"border-top-color: "+Settings.vaBubbleBackgroundColor+" !important;";styleTags+='content:"";';styleTags+="margin-top:-7px;";styleTags+="position:absolute;";styleTags+="width:0;";styleTags+="left:3px;";styleTags+="}"}styleTags+=".cv-va-bootstrap .user-cv-time-stamp.va-time-stamp-shim:before {";styleTags+="border-left:9px solid transparent;";styleTags+="border-right:9px solid transparent;";styleTags+="border-top:9px solid;";styleTags=styleTags+"border-top-color: "+Settings.userBubbleBackgroundColor+" !important;";styleTags+='content:"";';styleTags+="margin-top:-8px;";styleTags+="position:absolute;";styleTags+="width:0;";styleTags+="right:2px;";styleTags+="bottom:12px;";styleTags+="}";styleTags+=".cv-va-bootstrap .cv-chat-transaction-entry {";styleTags=styleTags+"background-color: "+Settings.userBubbleBackgroundColor+" !important;";styleTags=styleTags+"color: "+Settings.vaInputPillFontColor+" !important;";styleTags=styleTags+"font-weight: "+Settings.userInputFontWeight+" !important;";styleTags+="}";styleTags+=".cv-va-bootstrap .cv-va-bubble p {";styleTags+="margin: 0 0 10px;";styleTags+="}";styleTags+=".cv-va-bootstrap .cv-va-bubble {";styleTags=styleTags+"color: "+Settings.vaBubbleFontColor+" !important;";styleTags+="}";styleTags+=".cv-va-bootstrap .cv-va-bubble ul:not(.list-group) {";styleTags=styleTags+"padding: "+Settings.vabubble_ulTagCSS.padding+";";styleTags=styleTags+"margin: "+Settings.vabubble_ulTagCSS.margin+";";styleTags+="}";styleTags+=".cv-va-bootstrap .cv-va-bubble li:not(.list-group-item) {";styleTags=styleTags+"margin: "+Settings.vabubble_liTagCSS.margin+";";styleTags+="}";styleTags+=".cv-va-bootstrap .list-group-item a {";styleTags=styleTags+"color: "+Settings.connectorsFontColor+";";styleTags+="margin-right: 20px;";styleTags+="}";styleTags+=".cv-va-bootstrap .back_link {";styleTags=styleTags+"color: "+(Settings.backNavCSS.enabled?Settings.backNavCSS.color:Settings.connectorsFontColor)+";";styleTags=styleTags+"background-color: "+(Settings.backNavCSS.enabled?Settings.backNavCSS.backgroundColor:Settings.connectorsBackgroundColor)+";";styleTags=styleTags+"padding: "+Settings.connectorCSS.padding+";";styleTags=styleTags+"border-width: "+Settings.backlinkBorderWidth+";";styleTags=styleTags+"border-color: "+(Settings.backNavCSS.enabled?Settings.backNavCSS.borderColor:Settings.connectorBorder.borderColor)+";";styleTags+="}";styleTags+=".cv-va-bootstrap .back_link:hover {";styleTags=styleTags+"color: "+(Settings.backNavCSS.enabled?Settings.backNavCSS.hoverColor:Settings.connectorsHoverFontColor)+";";styleTags=styleTags+"background-color: "+(Settings.backNavCSS.enabled?Settings.backNavCSS.hoverBackgroundColor:Settings.connectorsHoverBackgroundColor)+";";styleTags=styleTags+"padding: "+Settings.connectorCSS.padding+";";styleTags=styleTags+"border-width: "+Settings.backlinkBorderWidth+";";styleTags=styleTags+"border-color: "+(Settings.backNavCSS.enabled?Settings.backNavCSS.hoverBorderColor:Settings.connectorBorder.borderColor)+";";styleTags+="}";styleTags+=".cv-va-bootstrap .cv-chat-connector, .cv-va-bootstrap .cv-chat-connector-disabled {";styleTags=styleTags+"color: "+Settings.connectorsFontColor+";";styleTags=styleTags+"background-color: "+Settings.connectorsBackgroundColor+";";styleTags=styleTags+"border-width: "+Settings.connectorBorder.borderWidth+";";styleTags=styleTags+"border-style: "+Settings.connectorBorder.borderStyle+";";styleTags=styleTags+"border-color: "+Settings.connectorBorder.borderColor+";";styleTags=styleTags+"padding: "+Settings.connectorCSS.padding+";";styleTags=styleTags+"margin: "+Settings.connectorCSS.margin+";";styleTags=styleTags+"border-radius: "+Settings.connectorCSS.borderRadius+" !important;";styleTags+="}";if(Settings.disabledConnector.enabled){styleTags+=".cv-va-bootstrap .cv-chat-connector-disabled, .cv-va-bootstrap .cv-chat-connector-disabled span {";styleTags=styleTags+"background-color: "+Settings.disabledConnector.backgroundColor+" !important;";styleTags=styleTags+"color: "+Settings.disabledConnector.color+" !important;";styleTags+="}"}styleTags+=".cv-va-bootstrap .cv-chat-connector:last-child, .cv-va-bootstrap .cv-chat-connector-disabled:last-child {";styleTags=styleTags+"border-bottom-width: "+Settings.connectorLastChildBorderBottomWidth+"!important;";styleTags+="}";styleTags+=".cv-va-bootstrap .cv-chat-connector:hover {";styleTags=styleTags+"background-color: "+Settings.connectorsHoverBackgroundColor+"!important;";styleTags=styleTags+"border-width: "+Settings.connectorBorder.borderWidth+";";styleTags=styleTags+"border-style: "+Settings.connectorBorder.borderStyle+";";styleTags=styleTags+"border-color: "+Settings.connectorCSS.hoverBorderColor+";";styleTags+="}";styleTags+=".cv-va-bootstrap .cv-chat-connector:hover * {";styleTags=styleTags+"background-color: "+Settings.connectorsHoverBackgroundColor+"!important;";styleTags=styleTags+"color: "+Settings.connectorsHoverFontColor+";";styleTags+="}";styleTags+=".cv-va-bootstrap .cv-chat-transaction-entry {";styleTags+="padding: 0px !important;";styleTags+="}";styleTags+=".cv-va-bootstrap #cv-live-chat-submit[disabled] {";styleTags=styleTags+"background-color: "+Settings.submitBtn.disabled.backgroundColor+" !important;";styleTags=styleTags+"border-color: "+Settings.submitBtn.disabled.backgroundColor+" !important;";styleTags+="}";styleTags+=".cv-va-bootstrap .cv-va-tabs-container li.active, .cv-va-bootstrap .cv-va-tabs-container li.active:hover {";styleTags=styleTags+"border-bottom-color: "+Settings.tabsActiveBorderBottomColor+" !important;";styleTags+="}";styleTags+=".cv-va-bootstrap .cv-va-tabs-container li.open, .cv-va-bootstrap .cv-va-tabs-container li:hover {";styleTags=styleTags+"border-bottom-color: "+Settings.tabsHoverBorderBottomColor+" !important;";styleTags+="}";styleTags+=".cv-va-bootstrap a {";styleTags=styleTags+"color: "+Settings.vaHyperLinkCSS.color+";";styleTags=styleTags+"text-decoration: "+Settings.vaHyperLinkCSS.textDecoration+";";!window.CVMobile||"6c"!==Settings.businessName&&"ki"!==Settings.businessName&&"ihg"!==Settings.mainBusinessName?window.CVMobile||"6c"!==Settings.businessName&&"ki"!==Settings.businessName&&"ihg"!==Settings.mainBusinessName||(styleTags=styleTags+Settings.vaHyperLinkCSS.fontSize+";"):styleTags+="font-size: 16px;";styleTags+="}";styleTags+=".cv-va-bootstrap a:hover {";styleTags=styleTags+"color: "+Settings.vaHyperLinkHoverCSS+";";styleTags+="}";styleTags+=".cv-va-bootstrap .cv-va-bubble .list-group {";styleTags=styleTags+"margin: "+Settings.listGroupMargin+";";styleTags+="}";styleTags+=".cv-va-bootstrap .connector-icon {";styleTags=styleTags+"background-color: "+Settings.connectorsFontColor+";";styleTags+="}";styleTags+=".cv-va-bootstrap .cv-autocomplete-style {";styleTags=styleTags+"color: "+Settings.vaHyperLinkCSS.color+";";styleTags+="font-size: 14px;";styleTags+="}";styleTags+=".cv-va-bootstrap .cv-autocomplete-style .cv-ui-state-active {";styleTags=styleTags+"background: "+Settings.vaHyperLinkCSS.color+";";styleTags=styleTags+"border-color: "+Settings.vaHyperLinkCSS.color+";";styleTags+="}";styleTags+=".cv-va-bootstrap .active-cv-font-size {";styleTags+="color: #444;";styleTags+="}";if(!window.CVMobile||"6c"!==Settings.businessName&&"ki"!==Settings.businessName&&"ihg"!==Settings.mainBusinessName){if(!window.CVMobile&&("6c"===Settings.businessName||"ki"===Settings.businessName||"ihg"===Settings.mainBusinessName)){styleTags+=".cv-va-bootstrap a, .cv-va-bootstrap .cv-chat-user-entry, .cv-va-bootstrap #cv-live-chat-user-entry, .cv-va-bootstrap #cv-chat-submit, .cv-va-bootstrap #cv-live-chat-submit {";styleTags+="line-height: 20px !important;";styleTags+="}";styleTags+=".cv-va-bootstrap .user-cv-time-stamp, .cv-va-bootstrap .time-stamp-user, .cv-va-bootstrap .va-time-stamp, .cv-va-bootstrap .time-stamp-info {";styleTags+="line-height: 12px !important;";styleTags+="}";styleTags+=".cv-va-bootstrap .panel-heading, .cv-va-bootstrap .cv-live-chat-user, .cv-va-bootstrap .cv-va-bubble *, .cv-va-bootstrap .cv-autocomplete-style li div{";styleTags+="line-height: 18px !important;";styleTags+="}"}}else{styleTags+=".cv-va-bootstrap a, .cv-va-bootstrap .cv-chat-user-entry, .cv-va-bootstrap #cv-live-chat-user-entry, .cv-va-bootstrap #cv-chat-submit, .cv-va-bootstrap #cv-live-chat-submit, .cv-va-bootstrap .cv-autocomplete-style li div{";styleTags+="line-height: 18px !important;";styleTags+="}";styleTags+=".cv-va-bootstrap .user-cv-time-stamp, .cv-va-bootstrap .time-stamp-user, .cv-va-bootstrap .va-time-stamp, .cv-va-bootstrap .time-stamp-info {";styleTags+="line-height: 12px !important;";styleTags+="}";styleTags+=".cv-va-bootstrap .panel-heading, .cv-va-bootstrap .cv-live-chat-user, .cv-va-bootstrap .cv-va-bubble * {";styleTags+="line-height: 18px !important;";styleTags+="}"}}styleTags+=".cv-va-bootstrap #cv-agent-survey-modal .radio,.cv-va-bootstrap #cv-agent-survey-modal .checkbox {";styleTags+="margin-bottom: 5px;";styleTags+="}";styleTags+="</style>";$(styleTags).appendTo("head");if(window.CVMobile===!0){linkVAMobileCSS=document.createElement("link");linkVAMobileCSS.id="cv-va-mobile-css";linkVAMobileCSS.rel="stylesheet";linkVAMobileCSS.type="text/css";linkVAMobileCSS.href=libEndpoint+"/css/styles-mobile.css";linkVAMobileCSS.media="screen";head.appendChild(linkVAMobileCSS)}}window.CVVA.resizable=function(){var height,minHeight,maxHeight,minWidth,maxWidth;if(Settings.shrunkenUI===!0){height="560px";minHeight="560";maxHeight="600";minWidth="350";maxWidth="600"}else{height="550px";minHeight="445";maxHeight="600";minWidth="480";maxWidth="700"}if(void 0===window.expanded){window.expanded=!0;parent.postMessage("expand","*")}Settings.anchoredContainer.expandHeight===!0&&$(".cv-va-bootstrap #cv-chat-content").css("height",height);Settings.anchoredContainer.enabledResizable&&$(".cv-va-bootstrap #cv-chat-content").resizable({maxHeight:maxHeight,maxWidth:maxWidth,minHeight:minHeight,minWidth:minWidth,stop:function(){window.CVSaveAttributes()}});var ariaLabelResizeHandler=Settings.ariaLabel.resizeHandlerBtn;ariaLabelResizeHandler=$(".cv-va-bootstrap #cv-chat-content").hasClass("content-expanded")?Settings.ariaLabel.maximizeBtn:Settings.ariaLabel.resizeHandlerBtn;$(".cv-va-bootstrap #cv-chat-content").find(".cv-ui-icon").attr({tabindex:"0","aria-label":ariaLabelResizeHandler,role:"button"}).on("keypress",function(e){var key=e.keyCode||e.which;if(13!=key||$(".cv-va-bootstrap #cv-chat-content").hasClass("content-expanded")){if(13==key&&$(".cv-va-bootstrap #cv-chat-content").hasClass("content-expanded")){$(".cv-va-bootstrap #cv-chat-content").css({height:minHeight,width:minWidth});$(this).attr("aria-label",Settings.ariaLabel.resizeHandlerBtn);$(".cv-va-bootstrap #cv-chat-content").removeClass("content-expanded")}}else{$(".cv-va-bootstrap #cv-chat-content").css({height:maxHeight,width:maxWidth});$(this).attr("aria-label",Settings.ariaLabel.maximizeBtn);$(".cv-va-bootstrap #cv-chat-content").addClass("content-expanded")}$(window).width()-($(".cv-va-bootstrap #cv-chat-content").offset().left+$(".cv-va-bootstrap #cv-chat-content").outerWidth())<282&&$(".cv-va-bootstrap #cv-chat-content").css({left:"auto",right:"0"});window.CVSaveAttributes()})};if(window.CVMobile===!1&&localStorage.getItem(Settings.businessName+"-cvVaCollectionLength")>1&&window.loadFromStorage===!0&&(window.cvVaMinimized===!1||void 0===window.cvVaMinimized)){window.resizableAttached=!0;window.CVVA.resizable()}window.CVVA.mobileMetaTag=function(){$("body > *").not("body > .cv-va-bootstrap").addClass("cv-va-hide-external-engagements");void 0!==$("meta[name=viewport]").attr("content")&&(window.originalViewport=$("meta[name=viewport]").attr("content"));$("meta[name=viewport]").remove();$("head").append('<meta name="viewport" content="width=device-width, height=device-height, initial-scale=1.0, minimum-scale=1.0, maximum-scale=1.0, user-scalable=no"/>');/iPad|iPhone|iPod/.test(navigator.userAgent)&&!window.MSStream&&document.querySelector("meta[name=viewport]").setAttribute("content","initial-scale=1.0001, minimum-scale=1.0001, maximum-scale=1.0001, user-scalable=yes")};if(window.CVMobile===!0&&window.loadFromStorage===!0&&(window.cvVaMinimized===!1||void 0===window.cvVaMinimized)&&$("#cv-chat-container").hasClass("in")){console.log("modal visible");window.CVVA.mobileMetaTag()}var tmp,plugins=Settings.plugins||[],endpoint=(Settings.development||!1,Settings.endpoint||"./bot.htm?JSIN=1"),model_args={url:endpoint,extra_params:{}},collection=new TransactionsCollection,params={data:{}},businessArea=_get("businessArea")||Settings.businessArea,channel=_get("channel")||Settings.channel,startContext=_get("startContext");businessArea&&(model_args.extra_params.businessArea=businessArea);channel&&(model_args.extra_params.channel=channel);var deviceDetection={};if(CVMobileDet.DetectMobileLong()===!0){deviceDetection.isMobile=!0;deviceDetection.isTablet=!1;deviceDetection.isDesktop=!1}else if(CVMobileDet.DetectTierTablet()===!0){deviceDetection.isMobile=!1;deviceDetection.isTablet=!0;deviceDetection.isDesktop=!1}else{deviceDetection.isMobile=!1;deviceDetection.isTablet=!1;deviceDetection.isDesktop=!0}model_args.extra_params.deviceDetection=JSON.stringify(deviceDetection);var model;if(void 0!==localStorage.getItem(Settings.businessName+"-cvVaModel")&&null!==localStorage.getItem(Settings.businessName+"-cvVaModel")&&window.loadFromStorage===!0){model=new TransactionModel(model_args);model.attributes=JSON.parse(localStorage.getItem(Settings.businessName+"-cvVaModel"));window.cvVaCollectionLength=parseInt(localStorage.getItem(Settings.businessName+"-cvVaCollectionLength"))}else model=new TransactionModel(model_args);model_args.extra_params.t=localStorage.getItem(Settings.businessName+"-cvVaData")||"";model_args.extra_params.host=window.location.host;window.cvVaModel=model;if($(".cv-va-bootstrap .cv-chat-va-imessage").length){$(".cv-va-bootstrap .cv-va-bubble").last().html(window.cvVaModel.attributes.botanswer);var $el=$("<ul>").addClass("list-group"),semanticFAQs=window.cvVaModel.attributes.faqitems.suggestedfaqlist.semanticfaqs.semanticfaq,semanticFAQsLimit=window.cvVaModel.attributes.maxsemanticfaqs||3,relatedlistprompttext=window.cvVaModel.attributes.relatedlistprompttext;if(_.isArray(semanticFAQs)&&semanticFAQs.length){$el.append(relatedlistprompttext);semanticFAQs=semanticFAQs.slice(0,semanticFAQsLimit);_.each(semanticFAQs,function(semanticFAQ){if($.trim(semanticFAQ.QuestionText).length){$li=$("<li>").addClass("list-group-item cv-chat-connector cv-sematic-connector").html(semanticFAQ.QuestionText);$li.append('<span class="pull-right"><i class="'+Settings.connectorCSS.icon+'"></i></span>');$li.find(".pull-right").css({color:Settings.connectorsFontColor});Settings.semanticTextAlignRight===!0&&$li.css("text-align","right");$el.append($li)}});$(".cv-va-bootstrap .cv-va-bubble").last().append($el)}if(void 0!==window.cvVaModel.attributes.disambiguationoptions){var disambiguationoptions=window.cvVaModel.attributes.disambiguationoptions.option;if(_.isArray(disambiguationoptions)&&disambiguationoptions.length){$el.addClass("list-group");_.each(disambiguationoptions,function(disambiguationoption){if($.trim(disambiguationoption.clicktext).length){$li=$("<li>").addClass("list-group-item cv-chat-connector cv-disambiguation-connector").html(disambiguationoption.clicktext);$li.append('<span class="pull-right"><i class="'+Settings.connectorCSS.icon+'"></i></span>');$li.find(".pull-right").css({color:Settings.connectorsFontColor});Settings.semanticTextAlignRight===!0&&$li.css("text-align","right");$el.append($li)}});$(".cv-va-bootstrap .cv-va-bubble").last().append($el)}}var dt=new Date,time=dt.getHours()+":"+(dt.getMinutes()<10?"0":"")+dt.getMinutes();$(".cv-va-bootstrap .cv-va-bubble").last().after('<span class="va-time-stamp">'+Settings.virtualAgentName+"&nbsp"+time+"</span>")}$.each($(".cv-va-bootstrap .cv-sematic-connector:not(.cv-chat-connector-disabled)"),function(element){$(this).hasClass("cv-disambiguation-connector")||$(this).click(function(evt){evt.preventDefault();evt.stopPropagation();var semanticConnector=$(this).find("a"),recognitionID=semanticConnector.data("recognition-id"),answerID=semanticConnector.data("answer-id"),subtype=semanticConnector.data("subtype");model.faqRequest(recognitionID,answerID,$(this).text(),subtype)})});$.each($(".cv-va-bootstrap .cv-connector:not(.cv-chat-connector-disabled)"),function(element){var connectorId=window.cvVaModel.attributes.connectors[element].ConnectorId,answerID=window.cvVaModel.attributes.answerID,connectorText=window.cvVaModel.attributes.connectors[element].DefaultClickText;$(this).click(function(evt){evt.preventDefault();evt.stopPropagation();if(window.processingRequest===!1||void 0===window.processingRequest){window.processingRequest=!0;model.dtreeConnectorRequest(connectorId,answerID,connectorText)}})});$.each($(".cv-va-bootstrap .cv-chat-connector.cv-disambiguation-connector"),function(element){$(this).click(function(evt){evt.preventDefault();evt.stopPropagation();model.disambiguationRequest($(this).text(),window.cvVaModel.attributes.disambiguationoptions.option[element].answerid)})});$.each($(".cv-va-bootstrap .ics-btn-group .cv-chat-connector-ics:not(.cv-chat-connector-ics-disabled)"),function(element){$(this).click(function(evt){evt.preventDefault();evt.stopPropagation();model.dtreeConnectorRequest(window.cvVaModel.attributes.connectors[element].ConnectorId,window.cvVaModel.attributes.answerID,$(this).text())})});if(Settings.inputTextArea===!0)for(var tx=$(".cv-va-bootstrap #cv-chat-user-entry"),i=0;i<tx.length;i++){tx[i].setAttribute("style","height:"+tx[i].scrollHeight+"px;overflow-y:hidden;");tx[i].addEventListener("input",OnInput,!1)}window.CVVA.methods.sendData=function(data){window.cvCrossStorage.onConnect().then(function(){return window.cvCrossStorage.set(Settings.businessName+"-cvVaData",JSON.stringify(data))});localStorage.setItem(Settings.businessName+"-cvVaData",JSON.stringify(data));void 0!==window.cvVaCollectionLength&&model.faqRequest("88","89","cvvadata","",JSON.stringify(data))};collection.subscribe(model);var view_args={model:model,collection:collection},va=new VirtualAssistant(view_args);window.ask_question=function(event,question,faqIDin,faqMainCatID,faqMainCatDesc,recognitionID,answerID){if("string"!=typeof event){event.preventDefault();if(7==arguments.length)model.faqRequest(recognitionID,answerID,question);else{model.askQuestion(question);"A"===event.target.tagName&&$(event.target).prop("onclick",null)}}else"string"==typeof event&&(6==arguments.length?model.faqRequest(faqMainCatDesc,recognitionID,answerID):model.askQuestion(event))};window.connector_Click=function(connector_id,answer_id,question){model.dtreeConnectorRequest(connector_id,answer_id,question)};window.change_context=function(context){model.changeContext(context)};window.bot_nav=function(event,url,target,width,height){va.answer.botNav(event,url,target,width,height)};_.each(plugins,function(VAPlugin){try{tmp=new VAPlugin(view_args);tmp.render()}catch(err){settings.development&&alert("Error thrown whilst instantiating plugin: "+err)}});$.trim(_get("entry")).length&&(params.data.entry=$.trim(_get("entry")));
_get("region")&&(params.data.region=_get("region"));startContext&&(params.success=function(){model.changeContext(startContext)});window.CVSaveAttributes=function(){if(Settings.persistenceEnabled===!0&&(window.forcesessionclose===!1||void 0===window.forcesessionclose)){window.cvCrossStorage.onConnect().then(function(){return window.cvCrossStorage.set(Settings.businessName+"-cvVaCollectionLength",window.cvVaCollectionLength)}).then(function(){return window.cvCrossStorage.set(Settings.businessName+"-cvVaModel",JSON.stringify(window.cvVaModel))}).then(function(){return window.cvCrossStorage.set(Settings.businessName+"-cvVaBootstrapState",JSON.stringify($("div.cv-va-bootstrap:first").html()))}).then(function(){return window.cvCrossStorage.set(Settings.businessName+"-cvVaStyles",JSON.stringify($("#cv-va-styles").html()))}).then(function(){return window.cvCrossStorage.set(Settings.businessName+"-cvVaIdent",window.CVVA.model.ident)});localStorage.setItem(Settings.businessName+"-cvVaCollectionLength",window.cvVaCollectionLength);localStorage.setItem(Settings.businessName+"-cvVaModel",JSON.stringify(window.cvVaModel));localStorage.setItem(Settings.businessName+"-cvVaBootstrapState",JSON.stringify($("div.cv-va-bootstrap:first").html()));localStorage.setItem(Settings.businessName+"-cvVaStyles",JSON.stringify($("#cv-va-styles").html()));localStorage.setItem(Settings.businessName+"-cvVaIdent",window.CVVA.model.ident)}};window.CVlaunchVA=function(){if(Settings.liveperson.removeLPengagements===!0){var removeExternalEngagements=function(){$(".LPMcontainer").each(function(i,element){for(var removeEngagement=!0,i=0;i<Settings.liveperson.removeLPengagementExceptions.length;i++)$(this).parent().attr("id")===Settings.liveperson.removeLPengagementExceptions[i]&&(removeEngagement=!1);removeEngagement&&$(this).addClass("cv-va-hide-external-engagements")})};clearInterval(window.CVVA.removeExternalEngagementsInterval);window.CVVA.removeExternalEngagementsInterval=setInterval(removeExternalEngagements,100);removeExternalEngagements()}if(void 0===window.forcesessionclose){if(void 0===window.localInitCall){window.localInitCall=!0;if((void 0===localStorage.getItem(Settings.businessName+"-cvVaModel")||null===localStorage.getItem(Settings.businessName+"-cvVaModel")||Settings.persistenceEnabled===!1||(void 0===localStorage.getItem(Settings.businessName+"-cvVaInitCall")||null===localStorage.getItem(Settings.businessName+"-cvVaInitCall"))&&window.loadFromStorage===!1)&&$(".cv-va-bootstrap #cv-chat-container").is(":visible")===!1){console.log("init");if(Settings.genesys.sendPCSqueueOnInit===!0&&localStorage.getItem(Settings.businessName+"-pcsData_genesys")){var escalationData=JSON.parse(localStorage.getItem(Settings.businessName+"-pcsData_genesys"));model.init({data:{pcsqueue:escalationData.CustProd,pcsqueuesubtype:escalationData.ServiceSubType}})}else model.init(params)}}else window.cvVaMinimized&&$(".cv-va-bootstrap #cv-minimize-btn").trigger("click");if(window.CVMobile===!0){if(window.cvVaMinimized===!1||void 0===window.cvVaMinimized){window.CVVA.mobileMetaTag();setTimeout(function(){$("#cv-chat-container").modal({show:!0,keyboard:!1,backdrop:!1})},0);$("#cv-chat-container").on("shown.bs.modal",function(){window.CVSaveAttributes()})}}else setTimeout(function(){$("#cv-chat-container").modal({show:!1,keyboard:!0,backdrop:!1});$("#cv-chat-container").on("shown.bs.modal",function(){window.CVSaveAttributes();Settings.focusInputOnOpen===!0&&$(".cv-va-bootstrap #cv-chat-user-entry").focus()});$("#cv-chat-container").modal({show:!0,keyboard:!0,backdrop:!1})},0)}};window.CVInputLauncherSubmission=function(){if(window.CVVA.inputLauncher)if(localStorage.getItem(Settings.businessName+"-cvVaInitCall")){if(0!==$.trim(window.CVVA.inputLauncher.userQuestion).length){window.cvVaMinimized&&$(".cv-va-bootstrap #cv-minimize-btn").trigger("click");window.CVVA.inputLauncher.trigger=!1;model.askInputLauncherQuestion(window.CVVA.inputLauncher.userQuestion)}}else window.CVlaunchVA()};setTimeout(function(){window.CVVA.events.loaded({launcherExposed:!0,loadTime:((new Date).getTime()-window.CVVA.initStarts.getTime())/1e3});window.CVVA.iframeMode&&parent.postMessage("loadedVAlib","*")},100);$("#cv-chat-container").on("hidden.bs.modal",function(){"liveperson"===Settings.livechatVendor&&localStorage.getItem(Settings.businessName+"-cvVaActiveSession_lp")||"true"===localStorage.getItem(Settings.businessName+"-lpSessionEndedExternal")?va.endChatLP():"creative virtual"===Settings.livechatVendor&&"true"===localStorage.getItem(Settings.businessName+"-cvVaActiveSession_cv")||Settings.persistenceEnabled!==!0||window.forcesessionclose!==!1&&void 0!==window.forcesessionclose||window.CVSaveAttributes()});var startLCchat=!1;(navigator.userAgent.toLowerCase().indexOf("firefox")>-1,1)||window.addEventListener("focus",function(e){"cv-minimize-btn"!==$(e.target).id&&$(".cv-va-bootstrap .minimize-va").css("outline","none")},!0);var receiveMsg=function(event){if(event.origin===window.CVVA.cvLcOrigin&&event.data.hasOwnProperty("chat_accepted")){window.cvLCQueueId=event.data.queueId;startLCchat=!0}else if(event.origin===window.CVVA.cvLcOrigin&&event.data.hasOwnProperty("get_ident")){var lc_iframe=document.getElementById("cv-lc-iframe").contentWindow,ident={ident:window.CVVA.model.ident};lc_iframe.postMessage(ident,"*")}else if(event.origin===window.CVVA.cvLcOrigin&&event.data.hasOwnProperty("focusMinimize")){if(navigator.userAgent.toLowerCase().indexOf("firefox")>-1,!1){$(".cv-va-bootstrap .minimize-va").css("outline","2px solid #ffffff");$(".cv-va-bootstrap .minimize-va").focus()}}else event.origin===window.CVVA.cvLcOrigin&&event.data.hasOwnProperty("botNav")&&window.bot_nav({preventDefault:function(){},stopPropagation:function(){}},event.data.url,event.data.target)};if(navigator.userAgent.toLowerCase().indexOf("firefox")>-1,!1){$(".cv-va-bootstrap .minimize-va").on("blur",function(){$(".cv-va-bootstrap .minimize-va").css("outline","none")});$(".cv-va-bootstrap .minimize-va").on("focus",function(){$(".cv-va-bootstrap .minimize-va").css("outline","2px solid #ffffff")})}window.addEventListener("message",receiveMsg,!1);var resetVaSession,iframeClose=function(){console.log("iframeClose");parent.postMessage("close","*");window.cvCrossStorage.onConnect().then(function(){return window.cvCrossStorage.set(Settings.businessName+"-cvVaIframeClose",!0)});localStorage.setItem(Settings.businessName+"-cvVaIframeClose",!0)};window.CVVA.flushVaSession=function(){resetVaSession=!0;window.cvCrossStorage.onConnect().then(function(){return window.cvCrossStorage.del(Settings.businessName+"-cvVaData")}).then(function(){localStorage.removeItem(Settings.businessName+"-cvVaData")});$(".cv-va-bootstrap .close.container-control.mobile-close").trigger("click")};$(".cv-va-bootstrap .close.container-control.mobile-close").click(function(event){if("creative virtual"===Settings.livechatVendor&&localStorage.getItem("cvlc_userSessionId")&&"true"!==localStorage.getItem(Settings.businessName+"-cvVaEOCSRendered")&&Settings.vaLcTabs===!1||"ended"===localStorage.getItem("cvlc_chatStatus")&&"true"!==localStorage.getItem(Settings.businessName+"-cvVaEOCSRendered")){localStorage.removeItem(Settings.businessName+"-cvPCSdata");$(".cv-chat-footer").remove();window.render_eocs()}else if("liveperson"===Settings.livechatVendor&&"true"===localStorage.getItem(Settings.businessName+"-cvVaActiveSession_lp"))$(".cv-va-bootstrap #cv-lp-end-chat-confirmation").show();else if(window.forcesessionclose===!0){clearInterval(window.CVVA.removeExternalEngagementsInterval);$(".LPMcontainer").each(function(i,element){$(this).removeClass("cv-va-hide-external-engagements")});window.resetVA();window.forcesessionclose=void 0}else if(("true"===localStorage.getItem("cvSessionEndedExternal_VA")||Settings.flushVAonClose||resetVaSession)===!0){"cox"===Settings.businessName&&window.utag&&window.utag.link&&(window.CVVA.activeCloseTracked||window.utag.link({eventNames:"cvEndNoEscalation"}));if(Settings.liveperson.removeLPengagements===!0){clearInterval(window.CVVA.removeExternalEngagementsInterval);$(".LPMcontainer").each(function(i,element){$(this).removeClass("cv-va-hide-external-engagements")})}window.cvCrossStorage.onConnect().then(function(){return window.cvCrossStorage.del(Settings.businessName+"-cvVaMinimized",Settings.businessName+"-cvVaContentWidth",Settings.businessName+"-cvVaContentHeight",Settings.businessName+"-cvVaIdent",Settings.businessName+"-cvVaBootstrapState",Settings.businessName+"-cvVaModel",Settings.businessName+"-cvVaStyles",Settings.businessName+"-cvVaInitCall",Settings.businessName+"-cvVaCollectionLength",Settings.businessName+"-cvVaTimestamp","cvSessionEndedExternal_VA",Settings.businessName+"-lpSessionEndedExternal",Settings.businessName+"-cvVaActiveSession_lp",Settings.businessName+"-requestingChat_lp",Settings.businessName+"-cvLpVisitorChatRels",Settings.businessName+"-cvLpVisitorResumeMode",Settings.businessName+"-cvLpVisitorSessionVars")})["catch"](function(){console.log("Caught cross storage error");localStorage.removeItem("cvSessionEndedExternal_VA");localStorage.removeItem(Settings.businessName+"-cvVaActiveSession_lp");localStorage.removeItem(Settings.businessName+"-requestingChat_lp");localStorage.removeItem(Settings.businessName+"-lpSessionEndedExternal");localStorage.removeItem(Settings.businessName+"-cvVaIdent");localStorage.removeItem(Settings.businessName+"-cvVaContentHeight");localStorage.removeItem(Settings.businessName+"-cvVaContentWidth");localStorage.removeItem(Settings.businessName+"-cvVaMinimized");localStorage.removeItem(Settings.businessName+"-cvVaBootstrapState");localStorage.removeItem(Settings.businessName+"-cvVaStyles");model.closeSession();window.resetVA()}).then(function(){localStorage.removeItem("cvSessionEndedExternal_VA");localStorage.removeItem(Settings.businessName+"-cvVaActiveSession_lp");localStorage.removeItem(Settings.businessName+"-requestingChat_lp");localStorage.removeItem(Settings.businessName+"-lpSessionEndedExternal");localStorage.removeItem(Settings.businessName+"-cvVaIdent");localStorage.removeItem(Settings.businessName+"-cvVaContentHeight");localStorage.removeItem(Settings.businessName+"-cvVaContentWidth");localStorage.removeItem(Settings.businessName+"-cvVaMinimized");localStorage.removeItem(Settings.businessName+"-cvVaBootstrapState");localStorage.removeItem(Settings.businessName+"-cvVaStyles");model.closeSession();window.resetVA()});clearInterval(window.proactiveEndSessionInterval);clearInterval(window.cvVaSaveState);localStorage.removeItem(Settings.businessName+"-cvVaBootstrapState");localStorage.removeItem(Settings.businessName+"-cvVaModel");localStorage.removeItem(Settings.businessName+"-cvVaStyles");localStorage.removeItem(Settings.businessName+"-cvVaInitCall");localStorage.removeItem(Settings.businessName+"-cvVaCollectionLength");localStorage.removeItem(Settings.businessName+"-cvVaTimestamp");localStorage.removeItem(Settings.businessName+"-cvVaIdent");window.cvVaCollectionLength=void 0;window.cvVaModel=void 0;window.cvVaMinimized=void 0;window.resizableAttached=void 0;window.localInitCall=void 0;window.sessionFlushInterval=setInterval(function(){clearInterval(window.proactiveEndSessionInterval);clearInterval(window.cvVaSaveState);localStorage.removeItem(Settings.businessName+"-cvVaBootstrapState");localStorage.removeItem(Settings.businessName+"-cvVaModel");localStorage.removeItem(Settings.businessName+"-cvVaStyles");localStorage.removeItem(Settings.businessName+"-cvVaInitCall");localStorage.removeItem(Settings.businessName+"-cvVaCollectionLength");localStorage.removeItem(Settings.businessName+"-cvVaTimestamp");localStorage.removeItem(Settings.businessName+"-cvVaIdent");window.cvVaCollectionLength=void 0;window.cvVaModel=void 0;window.cvVaMinimized=void 0;window.resizableAttached=void 0;window.localInitCall=void 0},0);setTimeout(function(){window.cvCrossStorage.onConnect().then(function(){return window.cvCrossStorage.del(Settings.businessName+"-cvVaMinimized",Settings.businessName+"-cvVaContentWidth",Settings.businessName+"-cvVaContentHeight",Settings.businessName+"-cvVaIdent",Settings.businessName+"-cvVaBootstrapState",Settings.businessName+"-cvVaModel",Settings.businessName+"-cvVaStyles",Settings.businessName+"-cvVaInitCall",Settings.businessName+"-cvVaCollectionLength",Settings.businessName+"-cvVaTimestamp","cvSessionEndedExternal_VA")})["catch"](function(){console.warn("Caught cross storage error");window.loadFromStorage=!1;clearInterval(window.sessionFlushInterval)}).then(function(res){window.loadFromStorage=!1;clearInterval(window.sessionFlushInterval)})},150)}else if(window.CVVA.iframeMode===!0)iframeClose();else{$("#cv-chat-container").modal({show:!0,keyboard:!0,backdrop:!1});$("#cv-chat-container").modal("hide")}})}else{window.CVlaunchVA=function(){};console.warn("CV VA Disabled")}})["catch"](function(error){console.log(error);console.log("cross domain storage not available");var allowInjection=!1;CVMobileDet.DetectMobileLong()===!0||CVMobileDet.DetectTierTablet()===!0?window.CVMobile=!0:window.CVMobile=!1;if(Settings.selectiveInjection.enabled===!0){if(Settings.selectiveInjection.url.length>0)for(var i=0;i<Settings.selectiveInjection.url.length;i++)window.location.href.indexOf(Settings.selectiveInjection.url[i])>-1&&(allowInjection=!0);null!==Settings.selectiveInjection.variable&&Settings.selectiveInjection.variable===!0&&(allowInjection=!0)}else allowInjection=!0;window.CVMobile===!1?Settings.selectiveInjection.device.desktop===!1&&(allowInjection=!1):window.CVMobile===!0&&Settings.selectiveInjection.device.mobile===!1&&(allowInjection=!1);if(allowInjection===!0&&Settings.launcherInjection===!0){var head=document.getElementsByTagName("head")[0],linkFontAwesomeCSS=document.createElement("link");linkFontAwesomeCSS.id="cv-font-awesome-css";linkFontAwesomeCSS.rel="stylesheet";linkFontAwesomeCSS.type="text/css";linkFontAwesomeCSS.href=Settings.libEndpoint+"css/libs/font_awesome/cv-font-awesome.css";linkFontAwesomeCSS.media="screen";0===$("#cv-font-awesome-css").length&&head.appendChild(linkFontAwesomeCSS);var linkJqueryUICSS=document.createElement("link");linkJqueryUICSS.id="cv-jquery-ui-css";linkJqueryUICSS.rel="stylesheet";linkJqueryUICSS.type="text/css";linkJqueryUICSS.href=Settings.libEndpoint+"css/libs/jquery/jquery-ui.css";linkJqueryUICSS.media="screen";0===$("#cv-jquery-ui-css").length&&head.appendChild(linkJqueryUICSS);var linkBootstrapCSS=document.createElement("link");linkBootstrapCSS.id="cv-bootstrap-css";linkBootstrapCSS.rel="stylesheet";linkBootstrapCSS.type="text/css";linkBootstrapCSS.href=Settings.libEndpoint+"css/libs/bootstrap/cv-va-bootstrap.css";linkBootstrapCSS.media="screen";0===$("#cv-bootstrap-css").length&&head.appendChild(linkBootstrapCSS);var linkVACSS=document.createElement("link");linkVACSS.id="cv-va-css";linkVACSS.rel="stylesheet";linkVACSS.type="text/css";linkVACSS.href=Settings.libEndpoint+"css/styles.css";linkVACSS.media="screen";0===$("#cv-va-css").length&&head.appendChild(linkVACSS);var linkPrintCSS=document.createElement("link");linkPrintCSS.id="cv-print-css";linkPrintCSS.rel="stylesheet";linkPrintCSS.type="text/css";linkPrintCSS.href=Settings.libEndpoint+"css/print.css";linkPrintCSS.media="print";0===$("#cv-print-css").length&&head.appendChild(linkPrintCSS);var perfectScrollbarCSS=document.createElement("link");perfectScrollbarCSS.id="cv-scrollbar-css";perfectScrollbarCSS.rel="stylesheet";perfectScrollbarCSS.type="text/css";perfectScrollbarCSS.href=Settings.libEndpoint+"css/libs/perfect_scrollbar/cv-perfect-scrollbar.css";perfectScrollbarCSS.media="screen";0===$("#cv-scrollbar-css").length&&head.appendChild(perfectScrollbarCSS);var launcher=new Launcher;if(Settings.lcAvailabilityLauncher===!1){var customLauncherDetected=!1;for(i=0;i<Settings.customLaunchers.length;i++)window.location.href.indexOf(Settings.customLaunchers[i].url)>-1&&$(Settings.customLaunchers[i].elementSelector).length>0&&(customLauncherDetected=!0);if(customLauncherDetected||window.CVMobile!==!1)Settings.showMobileLauncherOnDesktop===!1&&launcher.render(Settings.appendLauncherTo);else if(Settings.selectiveLauncherInjection.enabled===!0)for(var j=0;j<Settings.selectiveLauncherInjection.url.length;j++)window.location.href.indexOf(Settings.selectiveLauncherInjection.url[j])>-1&&launcher.render(Settings.appendLauncherTo)}if(Settings.inputLauncher.enabled===!0&&window.CVMobile===!1){var inputLauncher=new InputLauncher;if(Settings.inputLauncher.selectiveInjection.enabled===!0)for(i=0;i<Settings.inputLauncher.selectiveInjection.url.length;i++)window.location.href.indexOf(Settings.inputLauncher.selectiveInjection.url[i])>-1&&inputLauncher.render(Settings.inputLauncher.appendTo);else inputLauncher.render(Settings.inputLauncher.appendTo)}window.CVlaunchVA=function(){var url=window.cvVASettings.libEndpoint+"bot?config="+window.cvVASettings.businessName,name=window.cvVASettings.businessName+"/window";window.open(url,name,"width=350,height=560,resizable=yes")}}});if(window.CVVA.popupMode===!0){localStorage.removeItem(Settings.businessName+"-cvVaBootstrapState");localStorage.removeItem(Settings.businessName+"-cvVaModel");localStorage.removeItem(Settings.businessName+"-cvVaStyles");localStorage.removeItem(Settings.businessName+"-cvVaInitCall");localStorage.removeItem(Settings.businessName+"-cvVaTimestamp");localStorage.removeItem(Settings.businessName+"-cvVaMinimized");localStorage.removeItem(Settings.businessName+"-cvVaCollectionLength");localStorage.removeItem(Settings.businessName+"-cvVaActiveSession_lp");localStorage.removeItem(Settings.businessName+"-cvVaEOCSRendered");localStorage.removeItem(Settings.businessName+"-cvVaActiveSession_cv");localStorage.removeItem(Settings.businessName+"-cvPCSdata");localStorage.removeItem(Settings.businessName+"-chatSessionData_genesys");localStorage.removeItem(Settings.businessName+"-agentPickedUp_genesys");localStorage.removeItem(Settings.businessName+"-pcsData_genesys");localStorage.removeItem(Settings.businessName+"-requestingChat_genesys");localStorage.removeItem(Settings.businessName+"-genesysSessionEnded_external");localStorage.removeItem(Settings.businessName+"-cvVaIframePosition");localStorage.removeItem(Settings.businessName+"-cvVaIframeMinimizeUIPosition");localStorage.removeItem(Settings.businessName+"-cvVaIframeClose");localStorage.removeItem(Settings.businessName+"-hideLauncher");localStorage.removeItem(Settings.businessName+"-cvVaData");localStorage.removeItem("cv-tserverid");localStorage.removeItem("cvlc_customerId");localStorage.removeItem("cvlc_username");localStorage.removeItem("cvlc_firstName");localStorage.removeItem("cvlc_lastName");localStorage.removeItem("cvlc_emailId");localStorage.removeItem("cvlc_chatStatus");localStorage.removeItem("cvlc_userSessionId");localStorage.removeItem("cvlc_endUserId");localStorage.removeItem("cvlc_roomId");localStorage.removeItem("cvlc_agentName");localStorage.removeItem("cvlc_queueId");localStorage.removeItem("cvlc_queueName");sessionStorage.removeItem("lpVisitorChatRels"+Settings.liveperson.accountNumber);sessionStorage.removeItem("lpVisitorResumeMode"+Settings.liveperson.accountNumber);sessionStorage.removeItem("lpVisitorSessionVars"+Settings.liveperson.accountNumber)}};return{initialize:initialize}});require.config({baseUrl:"js_source/",urlArgs:"cb="+Math.random(),paths:{jquery:"libs/jquery/jquery",jquery_loader:"utils/jquery-loader",jquery_ui:"libs/jquery/jquery.ui",jquery_signalR:"libs/jquery/jquery.signalR-2.1.1.min",underscore:"libs/underscore/underscore",underscore_loader:"utils/underscore-loader",backbone:"libs/backbone/backbone",bootstrap:"libs/bootstrap/bootstrap",xml2json:"libs/jquery/jquery.xml2json",iePollyfill:"libs/cross_storage/ie-pollyfill",crossStorage:"libs/cross_storage/client",detectmobile:"libs/detectmobile/detectmobile",scrollto:"libs/jquery/jquery.scrollto",lpChatV3:"libs/liveperson/lpChat.min",leTagConfiguration:"libs/liveperson/leTagConfiguration",leTag:"libs/liveperson/leTag.min",perfectScrollbar:"libs/jquery/perfect-scrollbar.jquery",jquery_ui_touch_punch:"libs/jquery/jquery.ui.touch-punch.min"},map:{"*":{jquery:"jquery_loader"},jquery_loader:{jquery:"jquery"}},shim:{bootstrap:{deps:["jquery"]},xml2json:{deps:["jquery"],exports:"window.cvjq.fn.xml2json"},crossStorage:{deps:["iePollyfill"]},detectmobile:{exports:"detectmobile"}}});require(["app"],function(App){window.resetVA=function(){console.log("resetVA");window.cvjq("#"+window.cvCrossStorage._frameId).remove();window.cvjq(".cv-va-bootstrap:not(.cv-va-input-launcher-container)").remove();window.cvjq(".cv-va-opener").remove();window.cvjq("#cv-va-styles").remove();window.cvjq(".cv-va-launcher-styles").remove();window.cvjq(".cv-ui-helper-hidden-accessible").remove();window.CVVA.inputLauncher=void 0;window.CVVA.initCompleted=!1;App.initialize()};return App.initialize()});define("main",function(){});