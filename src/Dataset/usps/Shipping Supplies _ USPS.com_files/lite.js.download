define(["../has","../_base/kernel"],function(n,r){var m=document.createElement("div"),p=m.matchesSelector||m.webkitMatchesSelector||m.mozMatchesSelector||m.msMatchesSelector||m.oMatchesSelector,t=m.querySelectorAll,u=/([^\s,](?:"(?:\\.|[^"])+"|'(?:\\.|[^'])+'|[^,])*)/g;n.add("dom-matches-selector",!!p);n.add("dom-qsa",!!t);var q=function(c,a){if(v&&-1<c.indexOf(","))return v(c,a);var g=a?a.ownerDocument||a:r.doc||document,d=(t?/^([\w]*)#([\w\-]+$)|^(\.)([\w\-\*]+$)|^(\w+$)/:/^([\w]*)#([\w\-]+)(?:\s+(.*))?$|(?:^|(>|.+\s+))([\w\-\*]+)(\S*$)/).exec(c);
a=a||g;if(d){if(d[2]){var e=r.byId?r.byId(d[2],g):g.getElementById(d[2]);if(!e||d[1]&&d[1]!=e.tagName.toLowerCase())return[];if(a!=g)for(c=e;c!=a;)if(c=c.parentNode,!c)return[];return d[3]?q(d[3],e):[e]}if(d[3]&&a.getElementsByClassName)return a.getElementsByClassName(d[4]);if(d[5])if(e=a.getElementsByTagName(d[5]),d[4]||d[6])c=(d[4]||"")+d[6];else return e}if(t)return 1===a.nodeType&&"object"!==a.nodeName.toLowerCase()?w(a,c,a.querySelectorAll):a.querySelectorAll(c);e||(e=a.getElementsByTagName("*"));
d=[];g=0;for(var k=e.length;g<k;g++){var h=e[g];1==h.nodeType&&x(h,c,a)&&d.push(h)}return d},w=function(c,a,g){var d=c,e=c.getAttribute("id"),k=e||"__dojo__",h=c.parentNode,l=/^\s*[+~]/.test(a);if(l&&!h)return[];e?k=k.replace(/'/g,"\\$&"):c.setAttribute("id",k);l&&h&&(c=c.parentNode);a=a.match(u);for(h=0;h<a.length;h++)a[h]="[id='"+k+"'] "+a[h];a=a.join(",");try{return g.call(c,a)}finally{e||d.removeAttribute("id")}};if(!n("dom-matches-selector"))var x=function(){function c(a,b,c){var f=b.charAt(0);
if('"'==f||"'"==f)b=b.slice(1,-1);b=b.replace(/\\/g,"");var d=h[c||""];return function(f){return(f=f.getAttribute(a))&&d(f,b)}}function a(a){return function(b,f){for(;(b=b.parentNode)!=f;)if(a(b,f))return!0}}function g(a){return function(b,f){b=b.parentNode;return a?b!=f&&a(b,f):b==f}}function d(a,b){return a?function(f,c){return b(f)&&a(f,c)}:b}var e="div"==m.tagName?"toLowerCase":"toUpperCase",k={"":function(a){a=a[e]();return function(b){return b.tagName==a}},".":function(a){var b=" "+a+" ";return function(c){return-1<
c.className.indexOf(a)&&-1<(" "+c.className+" ").indexOf(b)}},"#":function(a){return function(b){return b.id==a}}},h={"^=":function(a,b){return 0==a.indexOf(b)},"*=":function(a,b){return-1<a.indexOf(b)},"$=":function(a,b){return a.substring(a.length-b.length,a.length)==b},"~=":function(a,b){return-1<(" "+a+" ").indexOf(" "+b+" ")},"|=":function(a,b){return 0==(a+"-").indexOf(b+"-")},"=":function(a,b){return a==b},"":function(a,b){return!0}},l={};return function(e,b,h){var f=l[b];if(!f){if(b.replace(/(?:\s*([> ])\s*)|(#|\.)?((?:\\.|[\w-])+)|\[\s*([\w-]+)\s*(.?=)?\s*("(?:\\.|[^"])+"|'(?:\\.|[^'])+'|(?:\\.|[^\]])*)\s*\]/g,
function(b,e,h,l,m,n,p){l?f=d(f,k[h||""](l.replace(/\\/g,""))):e?f=(" "==e?a:g)(f):m&&(f=d(f,c(m,p,n)));return""}))throw Error("Syntax error in query");if(!f)return!0;l[b]=f}return f(e,h)}}();if(!n("dom-qsa"))var v=function(c,a){for(var g=c.match(u),d=[],e=0;e<g.length;e++){c=new String(g[e].replace(/\s*$/,""));c.indexOf=escape;c=q(c,a);for(var k=0,h=c.length;k<h;k++){var l=c[k];d[l.sourceIndex]=l}}a=[];for(e in d)a.push(d[e]);return a};q.match=p?function(c,a,g){return g&&9!=g.nodeType?w(g,a,function(a){return p.call(c,
a)}):p.call(c,a)}:x;return q});
