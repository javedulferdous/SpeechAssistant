(this.$WP=this.$WP||[]).push(["RiHMo-",(t,e)=>{"use strict";var s,r,a,i,n,o,l,h,d,u,c,g=t=>fetch("/data/1.0/batch",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(t),credentials:"same-origin"}).then(t=>t.json()),p=/\{(\w+):[^}]*\}/,v=/\{([^}]+):[^}]*\}/,f=t=>{var e="function"==typeof t?{data:t,actions:null}:t,s=null;return t=>{var i=a((t,e)=>{if(null===s)throw new Error("Container rendered before staging");return s(t,e)},e.actions)(t);return i.stage=(t,r,a)=>{s=e.data(t,r,a)},i.load=t=>{new h(r(),i,t).reload()},i}},S=t=>{var e,s;return s=e=class extends i{constructor(t){super(t),this.state={mounted:!1}}componentDidMount(){this.setState({mounted:!0}),t.load()}render(){return this.state.mounted?n(t,this.props):null}},e.displayName="loadOnMount",s},C=(t,e,s)=>({get:r=>({loading:!!t,data:e||null,error:s||null}),select:t=>"{:}"});return[()=>{l=class{constructor(){this.stagedCalls={},this.dependencies={},this.stager=t=>{var e=this.getId(t);this.stagedCalls[e]=t;var s=t.match(p);return s&&s.length>=1?this.dependencies[e]=s[1]:delete this.dependencies[e],e},this.getId=t=>t.replace(/[\W]/g,"_"),this.hasStagedCalls=()=>0!==Object.keys(this.stagedCalls).length,this.filterStagedCalls=t=>{var e=!1,s={},r=Object.keys(this.stagedCalls);return r.forEach(r=>{if(t(r,this.stagedCalls[r])){e=!0,s[r]=!0;for(var a=this.dependencies[r];a&&!s[a];a=this.dependencies[a])s[a]=!0}}),r.forEach(t=>{s[t]||(delete this.stagedCalls[t],delete this.dependencies[t])}),e},this.resolve=()=>(t=>t&&t.length>0?1===t.length?g(t[0]):Promise.all(t.map(g)).then(t=>Object.assign({},...t.filter(t=>!!t))):Promise.resolve({}))(((t,e)=>{var s=Object.keys(t);if(s.length>50){s.sort();var r={};s.forEach(t=>{var s=e[t]||"",a=r[s]||[];a.push(t),r[s]=a}),s=[];var a=t=>{s.push(t);var e=r[t];e&&e.length>0&&e.forEach(a)};a(""),s.shift()}var i={},n=0,o=[i];return s.forEach(s=>{if(n>=50){i={},o.push(i),n=0;for(var r=e[s];r;r=e[r])i[r]={url:t[r]},n+=1}i[s]={url:t[s]},n+=1}),o})(this.stagedCalls,this.dependencies))}},t("ApiMonitor",h=class{constructor(t,e,s){this.store=void 0,this.root=void 0,this.previousState=void 0,this.param=void 0,this.store=t,this.root=e,this.previousState=this.getState(),this.param=s,t.subscribe(()=>this.watch())}watch(){var t=this.getState();o(t,this.previousState)||(this.previousState=t,this.reload())}stage(t){var e=new l;return this.root.stage&&this.root.stage(this.store.getState(),((t,e)=>s=>{var r=((t,e,s)=>({get:r=>{var a=s.getState(),i=a.api.requests[t];if(!i)return{loading:!1,data:null,error:"No request found for "+e};var n=r?e.replace(v,""+r):e,o=i.result.includes(n);if(!i.loading&&!o)return{loading:!1,data:null,error:"No request found for "+e};var l=a.api.responses[n];return{loading:i.loading,data:l?l.data:null,error:l?l.error:null}},select:e=>`{${t}:${e}}`}))(t.getId(s),s,e);return t.stager(s),r})(e,this.store),t),e}updateState(t){var e=this.stage(t);return!!e.hasStagedCalls()&&(this.store.dispatch(s.api.newApiRequests(e.stagedCalls)),!0)}reload(){var{param:t}=this,e=this.stage(t),r=this.store.getState().api.requests||{};return e.filterStagedCalls((t,e)=>!(r[t]&&r[t].url&&r[t].url===e))?(this.store.dispatch(s.api.newApiRequests(e.stagedCalls)),e.resolve().then(t=>(this.store.dispatch(s.api.newApiResponse(t)),!0))):Promise.resolve(!0)}getState(){var t=this.store.getState();return Object.assign({},t,{api:void 0,overlays:void 0,rebindCount:t.api&&t.api.rebindCount||void 0})}}),d=C(!1,null,null),u=C(!0,null,null),c=C(!1,{},null),t({ApiCaller:l,ApiMonitor:h,EMPTY_HANDLE:c,LOADING_HANDLE:u,NULL_HANDLE:d,bind:f,loadOnMount:S})},[t=>(s=t.actions,r=t.getStore),t=>a=t.connect,t=>(i=t.Component,n=t.createElement),t=>o=t.shallowEquals]]},["aunxON","h74DsO","cDcdfi","XtxvfD"]]);
