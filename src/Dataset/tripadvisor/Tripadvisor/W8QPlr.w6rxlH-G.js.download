(this.$WP=this.$WP||[]).push(["W8QPlr",(e,t)=>{"use strict";var i,a,s,l,o,n,r,h,c,d,u,m,p,g,v,f,_,k,b,y,S,P,w,C,N,x,A,I,E,T,M,D,L,R,O,V,H=({locationId:e,height:t,width:s,client:l})=>{var o,n,r,h,[{page:c}]=i(L),d=D(),u=E(c,d),m=l||u,p=T(),g={locationId:e,albumId:M.ALL_PHOTOS_ALBUM,client:m,dataStrategy:"ta",filter:p},[v]=A({query:I,variables:g}),{fetching:f,data:_}=v;if(!f&&(null==_||null==(o=_.mediaAlbum)||null==(n=o.album)||null==(r=n.mediaList)||null==(h=r[0])?void 0:h.photoSizes)){var k,b,y,S,P=null==_||null==(k=_.mediaAlbum)||null==(b=k.album)||null==(y=b.mediaList)||null==(S=y[0])?void 0:S.photoSizes.map(e=>({url:(null==e?void 0:e.url)?null==e?void 0:e.url:"",height:(null==e?void 0:e.height)?null==e?void 0:e.height:0,width:(null==e?void 0:e.width)?null==e?void 0:e.width:0}));return a(C,{sources:P,height:t,width:s,notLazy:!0})}return a("div",{style:{height:t,width:s}},a(N,{url:"/img2/icons/64/no_thumb_styleguide_icon.gif"}))},F=e=>null!=e&&e.hotels&&e.hotels.length>0,j=["nl_BE","el","hu","id","ja","nl"];return[()=>{"undefined"!=typeof window&&globalThis.require(["trjs!commerce/offerclick"],()=>null),(R=class extends s{constructor(...e){super(...e),this.state={expanded:!1,rvPollData:null,rvPollCount:0},this.hasMounted=!1,this.MAX_POLLS=7,this.coalesceRVData=()=>this.state.rvPollData||this.props.rvData,this.resetPollCount=()=>{this.setState({rvPollCount:0})},this.updateShelfAnimation=()=>{this.state.expanded&&this.animElement&&this.animHeightTarget?(this.animElement.style.height=this.animHeightTarget.clientHeight+"px",this.animElement.style.opacity="1",this.animAutoTimeout=setTimeout(this.handleAnimFinish,300)):!this.state.expanded&&this.animElement&&this.animHeightTarget&&(this.animElement.style.height=this.animHeightTarget.clientHeight+"px",this.animElement&&this.animElement.offsetWidth,this.animElement.style.height="0",this.animElement.style.opacity="0",clearTimeout(this.animAutoTimeout))},this.handleAnimFinish=()=>{this.animElement&&(this.animElement.style.height="auto")},this.trackImpression=()=>{var e=this.coalesceRVData();if(null!=e){var t={module:"recently_viewed_shelf",action:"shelf_impression",value:e.hotels&&e.hotels.length};d(t)}},this.toggleExpandShelf=()=>{var e=this.state.expanded,t=this.coalesceRVData();if(null!=t){var i={module:"recently_viewed_shelf",action:e?"recently_viewed_shelf_close_tier_2":"recently_viewed_shelf_open_tier_2",value:t.hotels&&t.hotels.length};d(i)}h.set("rvshelf_collapsed",e),this.setState({expanded:!e})},this.checkProofAndFetchComparisonRates=f(e=>{if(!e){var t=this.coalesceRVData();if(null!=t&&!t.needsPoll)return;if(this.state.rvPollCount>=this.MAX_POLLS)return}var{locationId:i,selectedPricingMode:a="",stayDates:s,excludedId:l}=this.props,o="/data/1.0/recenthotels/locationsInGeo?geo="+i+`&stayDates=${s}&pricingMode=${a}`;l&&(o+="&excludedIds="+l),fetch(o,{credentials:"same-origin"}).then(e=>e.json()).then(e=>{if(this.hasMounted){var t=this.state.rvPollCount+1;this.setState({rvPollData:e,rvPollCount:t})}})},2e3),this.trackBookmarkClick=e=>{c({module:"recently_viewed_shelf",action:"location_bookmarked"}),e()},this.makeSingleCard=(e,t,i)=>{var s="";i&&void 0!==i&&(s=i(e.id));var l,o={module:"recently_viewed_shelf",action:"click_shelf_card_location",value:t},n={module:"recently_viewed_shelf",action:"visible_shelf_card_location",value:t,once:!0};l=j.includes(this.props.locale)?152:136;var r={url:this.props.imgCdnUrl+"/img2/icons/64/no_thumb_styleguide_icon.gif",width:116,height:l},h=null;e.photo&&e.photo.images&&(h=e.photo.images.medium?e.photo.images.medium:e.photo.images.small);var c=this.makeOfferMarkup(e);return a(u,{click:o,visible:n,element:"span",key:e.id},a("div",{className:"_1Rs-5jJW",style:{height:l+12},ref:s},a("div",{className:"xW0L4nPL"},a("a",{href:e.url,target:"_blank"},v("hotels_recent_viewed_shelf_mas")?a(H,{locationId:e.id,height:l+"px",width:"116px"}):a(C,{sources:[h||r],height:l+"px",width:"116px",notLazy:!0}))),a("div",{className:"_1WvP8Nce"},a("a",{href:e.url,target:"_blank",className:"_2vZFDYls"},e.name),a("a",{href:e.url+"#REVIEWS",target:"_blank",className:"_1xawiHTZ"},a(k,{rating:e.rating,label:a("span",{className:"_2Xpyj-a0 _2nWrO_fY"},"(",p.formatNumber("integer",e.ratingCount),")"),bubbleRatingVerticalAlign:"middle",fontSize:14})),c),a("div",{className:"GA2eqDoT"},a(S,{object:{__typename:"LocationInformation",locationId:e.id}},(e,t)=>a(P,{bookmarkStyle:"flat",bookmarkSize:"18",active:t,onClick:()=>{this.trackBookmarkClick(e)}},()=>null)))))},this.offerClick=(e,t)=>{globalThis.require&&globalThis.require(["trjs!commerce/offerclick"],i=>i.clickEvent(e.nativeEvent,e.currentTarget,t))},this.makeOfferMarkup=e=>{if(e.offersLoading&&this.state.rvPollCount<this.MAX_POLLS)return a("div",{className:"YKWhuomv"},a(y,null));if(e.noCommerce)return a("span",{className:"_26ijSwrp"},g("meta_ui_contact_accom_c2b"));if(!e.offer||!e.offer.displayPrice)return a("span",{className:"_26ijSwrp"},g("contact_accommodation_for_availability"));var t=e.offer;return a(l,null,a("div",{className:"_3sZhC1vh",onClick:e=>this.offerClick(e,t.clickToken)},a("span",null,a("span",{className:"_2E3GujIk"},a("span",{className:"_2z9dCUqi"},t.xthroughPrice||""),a("span",{className:"_206cj_YN"},t.displayPrice),a("div",{className:"NXvoXq93"},a("div",{className:"_2eZd3-JK"},t.vendor),a("span",{className:r("ui_icon","external-link-no-box","_1XRyMtt_")}))),a(b,{size:"small"},x()))))},this.animElement=null,this.animHeightTarget=null,this.animAutoTimeout=void 0}componentDidMount(){this.hasMounted=!0,h.get("rvshelf_collapsed")||this.setState({expanded:!0}),this.updateShelfAnimation(),this.props.pollImmediately||F(this.coalesceRVData())?(this.checkProofAndFetchComparisonRates(this.props.pollImmediately),this.trackImpression()):this.props.notifyNoContent()}componentDidUpdate(e,t){this.trackImpression();var i=t.rvPollData||e.rvData,a=this.coalesceRVData(),s=!1;null!=a&&(s=null==i||i.hotels.length!==a.hotels.length);var{guests:l,stayDates:o,selectedPricingMode:n}=e||{},{guests:r,stayDates:h,selectedPricingMode:c}=this.props,d=h!==o||c!==n||r!==l;(d||s)&&this.resetPollCount(),this.updateShelfAnimation(),this.state.rvPollCount>=1&&!F(a)?this.props.notifyNoContent():this.checkProofAndFetchComparisonRates(d)}componentWillUnmount(){this.hasMounted=!1}render(){var e=this.coalesceRVData();if(!F(e))return this.props.isMobile||!this.props.showStub?null:a("div",{className:"_1wrTj2x8"});if(null==e)return this.props.isMobile||!this.props.showStub?null:a("div",{className:"_1wrTj2x8"});var t=this.props.useSwipe?{}:{right:{left:16},left:{left:-16}};return a(l,null,a(m,{windowFocusedCallback:()=>{this.checkProofAndFetchComparisonRates(!0)},useVisibilityApi:!0}),a("div",{className:r("_7e28_rK3",{WM8anu0V:this.props.extraOuterMargins})},a("span",{className:"_2dZMAhTM",onClick:this.toggleExpandShelf},a("span",{className:"_1Vsmg-Bk"},a("span",{className:this.props.isMobile?void 0:"_3DcKbe32"},a("span",{className:"ui_icon clock"}),a("span",{className:"IOTHn-Na"},e.localized_title),a("span",{className:r("ui_icon",this.state.expanded?"caret-up":"caret-down")})))),a("div",{className:r("_2-xlQPuF"),ref:e=>{this.animElement=e}},a("div",{className:"_2ze5EkZb",ref:e=>{this.animHeightTarget=e}},a("div",{className:this.props.isMobile?"_2JPkOH_N":"_2_T7fkLC"},this.props.isMobile?e.hotels.map((e,t)=>this.makeSingleCard(e,t,null)):a(_,{top:!1,bottom:!1,isActive:this.state.expanded,className:r("oF-0s5LQ",this.props.useSwipe?"_31bDSDQR":""),viewportCategories:["TABLET","DESKTOP"],shift:t,snapToEdge:{left:50,top:0,bottom:0,right:50},key:e.hotels.length},t=>e.hotels.map((e,i)=>this.makeSingleCard(e,i,t)))),a("div",{className:"YVBz15OK",onClick:this.toggleExpandShelf},g("mobile_dropdown_collapse")," ",a("span",{className:r("ui_icon",this.state.expanded?"caret-up":"caret-down")}))))))}}).defaultProps={showStub:!0},O=w(R),V=o((e,t)=>{var i="",a="";e.travelerInfo&&e.travelerInfo.hotels&&(i=e.travelerInfo.hotels.stayDates,({guests:a}=e.travelerInfo.hotels));var{sharedUIState:s}=n(e),{priceRange:{selectedPricingMode:l}={}}=s,o=e.page.detailId,r="/data/1.0/recenthotels/locationsInGeo?geo="+e.page.geoId;o&&(r+="&excludedIds="+o);var h=t(r);return()=>({selectedPricingMode:l,stayDates:i,guests:a,rvData:h.get().data,isMobile:"MOBILE"===e.meta.device.userAgentCategory,useSwipe:"MOBILE"===e.meta.device.userAgentCategory||"TABLET"===e.meta.device.userAgentCategory,locationId:e.page.geoId,excludedId:o,locale:e.i18n.locale})})(O),e("default",V)},[e=>(i=e.useContext,a=e.createElement,s=e.Component,l=e.Fragment),e=>o=e.bind,e=>n=e.getState,e=>r=e.default,e=>h=e.default,e=>(c=e.default,d=e.trackEventAJAXOnPageOnce,u=e.Track),e=>m=e.WindowVisibility,e=>(p=e.globalize,g=e.localize),e=>v=e.featureIsEnabled,e=>f=e.default,e=>_=e.ScrollAffordance,e=>k=e.BubbleRatingWithLabel,e=>b=e.default,e=>y=e.LoadingSpinner,e=>S=e.QueriedTripFlowSelector,e=>P=e.BookmarkIcon,e=>w=e.default,e=>(C=e.ResponsiveImage,N=e.ResponsiveDefaultImage),e=>x=e.getViewDealText,e=>A=e.useQuery,e=>I=e.carouselAlbumQuery,e=>(E=e.useClientNameForServlet,T=e.getMediaFilterToRetrieveAllPhotos,M=e.AlbumTypes),e=>D=e.useGARecorder,e=>L=e.Route]]},["cDcdfi","RiHMo-","Bf1Sux","jSLlaY","qKFflQ","Jk5sjx","S2VEpX","535agn","-i3PJS","gsKhh7","REpc0H","QnohJ2","PCbs_l","V08PS7","HZtvHO","vF730k","4kVXmt","KwOV1Z","ts_HYm","5X2em-","n4rOEs","wc54S1","fsml46","2R4xv2"]]);
