(this.$WP=this.$WP||[]).push(["fTyhRT",(e,r)=>{"use strict";var t,l,i,n,u,d,a,s,o,T,c,I,p,v,f=e=>{var[,r]=o(d),[u,a]=t({fetching:!1}),s=c("SAVE_TO_TRIP"),I=l(!0),p=i(e=>{I.current&&a(e)},[]);if(n(()=>()=>{I.current=!1},[]),!e)return[u,()=>Promise.resolve([null,null])];var v=e;return[u,e=>(p({fetching:!0}),r({tripId:e,referenceId:""+v.id,referenceType:v.type,allowDuplicates:!1}).then(e=>{var r,t,l,i,n,u,d=null==e||null==(r=e.data)||null==(t=r.addItemToTrip)?void 0:t.trip,a=null==e||null==(l=e.data)||null==(i=l.addItemToTrip)||null==(n=i.errors)||null==(u=n[0])?void 0:u.error;if(d){var o=T(d,v);o?(s(),p({fetching:!1,result:{trip:d,tripItem:o}})):"bundleSave"===v.type?p({fetching:!1,result:{trip:d,tripItem:{__typename:"TripItem",id:0,comments:[]}}}):p({fetching:!1,error:{query:"ADD_ITEM_TO_TRIP",tripsError:a}})}else p({fetching:!1,error:{query:"ADD_ITEM_TO_TRIP",tripsError:a}});return[d,a]}).catch(e=>(console.error(e),p({fetching:!1,error:{query:"ADD_ITEM_TO_TRIP"}}),[null,null])))]},h=(e,r,t)=>{var[l,n]=f(e),{userId:d}=u(p);return[l,i(()=>{var l=(e=>{var r=I.get("mostRecentlyAddedToTrip");return r&&r.userId===e?r.tripId:null})(d);return r||!l||v.has(null==e?void 0:e.type)?(t&&t(),Promise.resolve([null,null])):n(l)},[r,e,t,n,d]),e=>((e,r)=>{r?I.set("mostRecentlyAddedToTrip",{tripId:e,userId:r},144e5):I.remove("mostRecentlyAddedToTrip")})(e,d)]},m=(e,r,l)=>{var[i,n]=t({fetching:!1,saved:!!l}),[,u]=o(a),[,d]=o(s);return[i,l?()=>l?(n(Object.assign({},i,{fetching:!0})),d({itemId:l.id,tripId:r}).then(e=>{var r,t=null==e||null==(r=e.data)?void 0:r.tripsRemoveItem;return t?(n({fetching:!1,saved:!1,result:{trip:t}}),i):(n({fetching:!1,saved:!0,error:{query:"REMOVE_TRIP_ITEM",tripsError:void 0}}),i)}).catch(()=>(n({fetching:!1,saved:!0,error:{query:"REMOVE_TRIP_ITEM"}}),i))):Promise.resolve(i):()=>(n(Object.assign({},i,{fetching:!0})),u({tripId:r,referenceId:""+e.id,referenceType:e.type,allowDuplicates:!1}).then(e=>{var r,t,l,u,d,a,s,o,T,c=null==e||null==(r=e.data)||null==(t=r.addItemToTrip)?void 0:t.trip,I=null==e||null==(l=e.data)||null==(u=l.addItemToTrip)||null==(d=u.errors)||null==(a=d[0])?void 0:a.error;if(I||!c)return n({fetching:!1,saved:!1,error:{query:"ADD_ITEM_TO_TRIP",tripsError:I||void 0}}),i;var p=null==e||null==(s=e.data)||null==(o=s.addItemToTrip)||null==(T=o.items)?void 0:T[0];return n(p?{fetching:!1,saved:!0,result:{trip:c,tripItem:p}}:{fetching:!1,saved:!1,error:{query:"ADD_ITEM_TO_TRIP"}}),i}).catch(()=>(n({fetching:!1,saved:!1,error:{query:"ADD_ITEM_TO_TRIP"}}),i)))]};return[()=>{v=new Set(["savesItem","bundleSave"]),e({useAutosave:h,useSave:f,useTripSaveToggle:m})},[e=>(t=e.useState,l=e.useRef,i=e.useCallback,n=e.useEffect,u=e.useContext),e=>(d=e.AddItemToTrip,a=e.AddItemWithFullTrip,s=e.RemoveItemWithFullTrip),e=>o=e.useMutation,e=>T=e.getItemByReference,e=>c=e.usePixelCallback,e=>I=e.default,e=>p=e.Visitor]]},["cDcdfi","RXx5aI","5X2em-","eFKnUp","jb_4W2","jaCyxS","2R4xv2"]]);
