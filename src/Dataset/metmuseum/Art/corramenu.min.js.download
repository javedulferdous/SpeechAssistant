define(['jquery','js/lazy','jquery/ui'],function($){console.log("==Corra Menu ==");$.widget("corra.corramenu",{_init:function(){this.positionCloseIcon();this.bindEvents();},positionCloseIcon:function(){$('.push-menu-close-wrap').prependTo('.panel.header');},bindEvents:function(){$(document).delegate("a.jq-head","click",function(){var me=$(this);if(CorraUI.isWideTablet()){var me=$(this);setTimeout(function(){jQuery('.nav-sections').scrollTop((me.offset().top+jQuery('.nav-sections').scrollTop())-jQuery("#close-push-menu").outerHeight()-10);},1);var myParent=me.closest(".jq-parent");if(myParent.find(".jq-body *").length>0){myParent.toggleClass("open");myParent.siblings(".jq-parent").removeClass("open").find(".open").removeClass("open");me.parents(".jq-parent.open").find(".jq-parent.open").not(myParent).removeClass("open");return false;}else{return true;}}else{if(me.hasClass("level-top")&&!me.hasClass("clickable")){return false;}}});$(".footer-box-wrap h2").click(function(){if(CorraUI.isMobile()){var parentWrap=$(this).parents(".footer-box-wrap");parentWrap.toggleClass('open');$(".footer-box-wrap").not(parentWrap).removeClass("open");}});$(".action.nav-toggle").click(function(){$("body").addClass("push-menu-open");});$("#close-push-menu").click(function(){$("body").removeClass("push-menu-open");});jQuery(".hdr-met-link:first").clone().insertAfter("#jq-global-nav");jQuery(".header.links:last").clone().insertAfter("#jq-global-nav");jQuery(".customer-service-mob-link").clone().insertAfter("#jq-global-nav");jQuery(".become-a-member-mob-link").clone().insertAfter(".customer-service-mob-link");if(jQuery(".become-a-member-mob-link").next().find('li').length>1){jQuery(".become-a-member-mob-link").next().find('li').eq(0).find('a').text('My Account');}
jQuery(".only-img-block").parents(".jq-parent").find(".level-top").addClass("redirect-link");var menuTimer;if(CorraUI.isTouch()){$(".navigation li.level0").click(function(){$(this).siblings().removeClass("hover");$(this).toggleClass("hover");});}else{$(".navigation li.level0").mouseenter(function(){var _this=$(this);clearTimeout(menuTimer);_this.siblings().removeClass("hover");if(CorraUI.isDesktop()){$(this).find('.lazy-image').lazy();}
_this.addClass("hover");}).mouseleave(function(){var _this=$(this);clearTimeout(menuTimer);menuTimer=setTimeout(function(){_this.removeClass("hover");},300);});}
$("body").click(function(e){if($(e.target).parents("#jq-global-nav").length==0&&$(e.target).attr("id")!="jq-global-nav"){$(".navigation li.level0").removeClass("hover");}});$(window).scroll(function(){var scrollTop=$(window).scrollTop();if(scrollTop>20){$("body").addClass("sticky-header-1");}else{$("body").removeClass("sticky-header-1");}});try{jQuery(".jq-parent.level0 a").click(function(){var clickedElementParent=jQuery(this).parents(".jq-parent.level0");var indexParent=jQuery(".jq-parent.level0").index(clickedElementParent);window.localStorage.setItem("MegaMenuActiveIndex",indexParent);});var currentUrl=location.href;var baseUrl=currentUrl.indexOf('?')==-1?currentUrl:currentUrl.substring(0,currentUrl.indexOf('?'));var parentMenuItem=jQuery("#jq-global-nav [href='"+baseUrl+"']").parents(".jq-parent.level0");var clickedElementParent=window.localStorage.getItem("MegaMenuActiveIndex");if(parentMenuItem.length!==0&&clickedElementParent!==null){jQuery(".jq-parent.level0").eq(clickedElementParent).addClass("active");}
window.localStorage.removeItem("MegaMenuActiveIndex");}catch(e){console.log(e);}}});return $.corra.corramenu;});