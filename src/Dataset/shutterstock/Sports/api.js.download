extole.define("https://origin.xtlo.net/type=core:clientId=1528233037:coreAssetsVersion=27/common/api.js","https://origin.xtlo.net/type=core:clientId=1528233037:coreAssetsVersion=27/common/ExtoleError.js https://origin.xtlo.net/type=core:clientId=1528233037:coreAssetsVersion=27/common/collection.js https://origin.xtlo.net/type=core:clientId=1528233037:coreAssetsVersion=27/common/logger.js https://origin.xtlo.net/type=core:clientId=1528233037:coreAssetsVersion=27/common/ajax.js https://origin.xtlo.net/type=core:clientId=1528233037:coreAssetsVersion=27/common/Timer.js https://origin.xtlo.net/type=core:clientId=1528233037:coreAssetsVersion=27/common/client/program.js https://origin.xtlo.net/type=core:clientId=1528233037:coreAssetsVersion=27/common/client/token-store.js".split(" "),
function(p,g,k,q,r,m,t){function n(){var d=this,f,e,g,l,c;this.withRequestSummary=function(a){l=a;return d};this.withResponseSummary=function(a){c=a;return d};this.withStatusCode=function(a){g=a;return d};this.withMessage=function(a){e=a;return d};this.asDebug=function(){f="debug";return d};this.asInfo=function(){f="info";return d};this.asWarn=function(){f="warn";return d};this.asError=function(){f="error";return d};this.log=function(){if(!l.url.match(k.LOGGING_ENDPOINT)){var a=[];g&&a.push("Status "+
g);e&&a.push(e);k[f](a.join(" "),{request:l,response:c})}}}var u=/^\/api\/v\d\//,v=m.getProgramDomain();return new function(){function d(c,a,b){e("get",c,null,a,b)}function f(c,a,b){e("delete",c,null,a,b)}function e(c,a,b,h,d){h=h||function(){};d=d||{};a=m.getProtocol()+v+k(a);b=g.merge({},b);var e=g.merge({"Content-Type":"application/json","X-Extole-App":"javascript_sdk"},d.headers);d.noAuthorizationHeader||(e.Authorization=t.get());q({timeout:2E4,url:a,type:c,complete:function(a){var b=null;try{a=
JSON.parse(a)}catch(w){b=new p("Couldn't parse as JSON response from request, response: "+a),a=null}h&&h(b,a);a=g.merge({},a);a.timestamp=String((new Date).getTime());(new n).withRequestSummary(f).withResponseSummary(a).withMessage("Completed api request").asDebug().log()},error:function(a,b){try{var c=JSON.parse(this.response)}catch(x){c={statusText:this.statusText,status:b}}h&&h(c);a=g.merge({},c);a.timestamp=String((new Date).getTime());a=(new n).withRequestSummary(f).withResponseSummary(a);b=
String(b||c.http_status_code);"4"===b[0]?a.asInfo().withMessage("Failed api request").withStatusCode(b).log():a.asError().withMessage("Failed api request").withStatusCode(b).log()},data:b,headers:e,xhrFields:{withCredentials:!0}});var f={url:a,type:c,headers:e,data:b,timestamp:String((new Date).getTime())}}function k(c){return c.match(u)?c:"/api/v4"+c}var l=!1;this.poll=function(c,a,b){function h(){var e=f.getElapsedTime();b.headers=g.merge({"X-Extole-Polling-Time":e},b.headers);d(c,function(b,c){if(l)b=
new p("poll cancelled","cancelled");else if(k&&e>=k)b=new p("poll timed out after "+e+"ms","timed_out");else if(n(b,c)){setTimeout(h,m||300);return}a(b||c.error,c)},b)}function e(a,b){return a?!1:b&&"PENDING"===b.status}l=!1;a=a||function(){};b=b||{};var f=(new r).start(),k=b.pollTimeout||2E4,m=b.pollInterval||300,n=b.retryCondition||e;h()};this.cancel=function(){l=!0};this.get=d;this.post=function(c,a,b,d){e("post",c,a,b,d)};this.put=function(c,a,b,d){e("put",c,a,b,d)};this.delete=this.del=f}});