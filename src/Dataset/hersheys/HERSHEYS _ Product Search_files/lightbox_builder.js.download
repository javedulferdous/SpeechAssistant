var bodInsert="<div id='layout'></div>";bodInsert+="<div id='modal_loading'><div id='modal_loading_spinner'></div></div>";bodInsert+="<span style='display: none;' class='error-bubble' id='error_bubble'>";bodInsert+="<span class='error-message' id='error_message'></span>";bodInsert+="<span id='error_close'>x</span>";bodInsert+="</span>";var ie9="<!--[if lte IE 9]>";ie9+="<scr";ie9+="ipt type='text/javascript'>";ie9+="IS_IE_9_OR_LESS = true;";ie9+="<";ie9+="/scr"+"ipt>";ie9+="<![endif]-->";PROTOCOL_USER_OVERRIDE=PROTOCOL_USER_OVERRIDE||"https://";var loaderBg="#modal_loading{display:none;position:fixed;z-index:90000;top:0;left:0;height:100%;width:100%;background:rgba(255,255,255,.8)}";var loaderCss="#modal_loading_spinner{position:fixed;z-index:90001;color:#0078d7;font-size:15px;margin:0;width:1em;height:1em;border-radius:50%;text-indent:-9999em;-webkit-animation:load4 1.3s infinite linear;animation:load4 1.3s infinite linear;-webkit-transform:translateZ(0);-ms-transform:translateZ(0);transform:translateZ(0)}@-webkit-keyframes load4{0%,100%{box-shadow:0 -3em 0 .2em,2em -2em 0 0,3em 0 0 -1em,2em 2em 0 -1em,0 3em 0 -1em,-2em 2em 0 -1em,-3em 0 0 -1em,-2em -2em 0 0}12.5%{box-shadow:0 -3em 0 0,2em -2em 0 .2em,3em 0 0 0,2em 2em 0 -1em,0 3em 0 -1em,-2em 2em 0 -1em,-3em 0 0 -1em,-2em -2em 0 -1em}25%{box-shadow:0 -3em 0 -.5em,2em -2em 0 0,3em 0 0 .2em,2em 2em 0 0,0 3em 0 -1em,-2em 2em 0 -1em,-3em 0 0 -1em,-2em -2em 0 -1em}37.5%{box-shadow:0 -3em 0 -1em,2em -2em 0 -1em,3em 0 0 0,2em 2em 0 .2em,0 3em 0 0,-2em 2em 0 -1em,-3em 0 0 -1em,-2em -2em 0 -1em}50%{box-shadow:0 -3em 0 -1em,2em -2em 0 -1em,3em 0 0 -1em,2em 2em 0 0,0 3em 0 .2em,-2em 2em 0 0,-3em 0 0 -1em,-2em -2em 0 -1em}62.5%{box-shadow:0 -3em 0 -1em,2em -2em 0 -1em,3em 0 0 -1em,2em 2em 0 -1em,0 3em 0 0,-2em 2em 0 .2em,-3em 0 0 0,-2em -2em 0 -1em}75%{box-shadow:0 -3em 0 -1em,2em -2em 0 -1em,3em 0 0 -1em,2em 2em 0 -1em,0 3em 0 -1em,-2em 2em 0 0,-3em 0 0 .2em,-2em -2em 0 0}87.5%{box-shadow:0 -3em 0 0,2em -2em 0 -1em,3em 0 0 -1em,2em 2em 0 -1em,0 3em 0 -1em,-2em 2em 0 0,-3em 0 0 0,-2em -2em 0 .2em}}@keyframes load4{0%,100%{box-shadow:0 -3em 0 .2em,2em -2em 0 0,3em 0 0 -1em,2em 2em 0 -1em,0 3em 0 -1em,-2em 2em 0 -1em,-3em 0 0 -1em,-2em -2em 0 0}12.5%{box-shadow:0 -3em 0 0,2em -2em 0 .2em,3em 0 0 0,2em 2em 0 -1em,0 3em 0 -1em,-2em 2em 0 -1em,-3em 0 0 -1em,-2em -2em 0 -1em}25%{box-shadow:0 -3em 0 -.5em,2em -2em 0 0,3em 0 0 .2em,2em 2em 0 0,0 3em 0 -1em,-2em 2em 0 -1em,-3em 0 0 -1em,-2em -2em 0 -1em}37.5%{box-shadow:0 -3em 0 -1em,2em -2em 0 -1em,3em 0 0 0,2em 2em 0 .2em,0 3em 0 0,-2em 2em 0 -1em,-3em 0 0 -1em,-2em -2em 0 -1em}50%{box-shadow:0 -3em 0 -1em,2em -2em 0 -1em,3em 0 0 -1em,2em 2em 0 0,0 3em 0 .2em,-2em 2em 0 0,-3em 0 0 -1em,-2em -2em 0 -1em}62.5%{box-shadow:0 -3em 0 -1em,2em -2em 0 -1em,3em 0 0 -1em,2em 2em 0 -1em,0 3em 0 0,-2em 2em 0 .2em,-3em 0 0 0,-2em -2em 0 -1em}75%{box-shadow:0 -3em 0 -1em,2em -2em 0 -1em,3em 0 0 -1em,2em 2em 0 -1em,0 3em 0 -1em,-2em 2em 0 0,-3em 0 0 .2em,-2em -2em 0 0}87.5%{box-shadow:0 -3em 0 0,2em -2em 0 -1em,3em 0 0 -1em,2em 2em 0 -1em,0 3em 0 -1em,-2em 2em 0 0,-3em 0 0 0,-2em -2em 0 .2em}}";var loaderImg="#modal_loading{display:none;position:fixed;z-index:90000;top:0;left:0;height:100%;width:100%;background:url("+PROTOCOL_USER_OVERRIDE+"www.lightboxcdn.com/static/loading_animation.gif) 50% 50% no-repeat rgba(255,255,255,.8)}";var pgStyle="<style type='text/css'>.hidden_until_loaded, .hidden_until_loaded body, .hidden_until_loaded div {visibility: hidden !important;} body{margin:0;padding:0;border:none;}.error-bubble{-webkit-border-radius:3px;-moz-border-radius:3px;-ms-border-radius:3px;-o-border-radius:3px;border-radius:3px;padding:12px 15px;margin:0;text-align:left;position:fixed;top:30px;left:30px;color:red;background-color:#fff4f4;border:1px solid #d58a8a;font-size:13px;line-height:18px;font-family:'Open Sans','lucida grande','Segoe UI',arial,verdana,'lucida sans unicode',tahoma,sans-serif;z-index:10001;white-space:nowrap;font-weight:400}.error-bubble .error-message{color:#d58a8a;font-size:inherit;line-height:inherit}.error-message{color:#dd3b38;font-size:10px}#error_close{color:#dd3b38;font-size:18px;font-weight:700;display:inline-block;float:right;cursor:pointer;margin-top:-2px}.error-bubble .error-bubble-arrow-border{display:block;border-color:#d58a8a transparent transparent;border-style:solid;border-width:6px;height:0;width:0;position:absolute;bottom:-13px;left:10px}"+loaderCss+loaderBg+"body.loading{overflow:hidden}body.loading #modal_loading{display:block}</style>";pgStyle+="<style id='element_styles' type='text/css'></style>";var html_ele=document.getElementsByTagName("html")[0];if(typeof html_ele.classList==='object'&&html_ele.classList!==null)
html_ele.classList.add("hidden_until_loaded");var basic_fonts=["Arial, Helvetica, sans-serif","'Comic Sans MS', cursive, sans-serif","'lucida sans unicode', 'Lucida Grande', sans-serif","Tahoma, Geneva, sans-serif","Verdana, Geneva, sans-serif","'Courier New', Courier, monospace","'Lucida Console', Monaco, monospace","'Trebuchet MS', Helvetica, sans-serif","Impact, Charcoal, sans-serif"];var google_fonts=[];var custom_fonts=[];var TIME_OF_OPEN=(new Date()).getTime();var KEEN_CLIENT;var EVENT_GUID='';var IS_SETTINGS_LOADED=false;var IS_SCRIPTS_LOADED=false;var BOX_CUSTOM_JS={};var LIGHTBOX_OR_VARIATION_GUID='';var STANDARD_OBJ={};var CUSTOM_JS_GUIDS_ARR=[];var CUSTOM_JS_BOX_EMBED={};var COUPONS_FOR_SUBMIT={};var COUPONS_FOR_DISPLAY={};var CURRENT_PAGE='main';var CURRENT_WIDTH=0;var CURRENT_HEIGHT=0;var BugsnagInitAttempts=0;var processSubmitLock=false;var settings;var body;var modal_loading;var error_bubble;var error_message;var image_dims={};var form_wrapper;var form;var thx_form_wrapper;var thx_form;var ep1_form_wrapper;var ep1_form;var ep2_form_wrapper;var ep2_form;var ep3_form_wrapper;var ep3_form;var ep4_form_wrapper;var ep4_form;var pref_form_input_full_name=false;var pref_form_input_first_name=false;var pref_form_input_last_name=false;var pref_form_input_email=false;var pref_form_input_phone=false;var pref_form_input_opt_in=false;var pref_form_input_custom1=false;var pref_form_input_custom2=false;var pref_form_input_custom3=false;var pref_form_input_custom4=false;var pref_form_input_custom5=false;var pref_form_input_custom6=false;var pref_form_input_custom7=false;var pref_form_input_custom8=false;var pref_form_input_custom9=false;var pref_form_input_custom10=false;var pref_form_input_custom11=false;var pref_form_input_custom12=false;var pref_form_input_custom13=false;var pref_form_input_custom14=false;var pref_form_input_custom15=false;var pref_form_input_custom16=false;var pref_form_input_custom17=false;var pref_form_input_custom18=false;var pref_form_input_custom19=false;var pref_form_input_custom20=false;var pref_form_input_customN=false;var form_input_full_name;var form_input_first_name;var form_input_last_name;var form_input_email;var form_input_phone;var form_input_opt_in;var form_input_custom1;var form_input_custom2;var form_input_custom3;var form_input_custom4;var form_input_custom5;var form_input_custom6;var form_input_custom7;var form_input_custom8;var form_input_custom9;var form_input_custom10;var form_input_custom11;var form_input_custom12;var form_input_custom13;var form_input_custom14;var form_input_custom15;var form_input_custom16;var form_input_custom17;var form_input_custom18;var form_input_custom19;var form_input_custom20;var thx_form_input_full_name;var thx_form_input_first_name;var thx_form_input_last_name;var thx_form_input_email;var thx_form_input_phone;var thx_form_input_opt_in;var thx_form_input_custom1;var thx_form_input_custom2;var thx_form_input_custom3;var thx_form_input_custom4;var thx_form_input_custom5;var thx_form_input_custom6;var thx_form_input_custom7;var thx_form_input_custom8;var thx_form_input_custom9;var thx_form_input_custom10;var thx_form_input_custom11;var thx_form_input_custom12;var thx_form_input_custom13;var thx_form_input_custom14;var thx_form_input_custom15;var thx_form_input_custom16;var thx_form_input_custom17;var thx_form_input_custom18;var thx_form_input_custom19;var thx_form_input_custom20;var ep1_form_input_full_name;var ep1_form_input_first_name;var ep1_form_input_last_name;var ep1_form_input_email;var ep1_form_input_phone;var ep1_form_input_opt_in;var ep1_form_input_custom1;var ep1_form_input_custom2;var ep1_form_input_custom3;var ep1_form_input_custom4;var ep1_form_input_custom5;var ep1_form_input_custom6;var ep1_form_input_custom7;var ep1_form_input_custom8;var ep1_form_input_custom9;var ep1_form_input_custom10;var ep1_form_input_custom11;var ep1_form_input_custom12;var ep1_form_input_custom13;var ep1_form_input_custom14;var ep1_form_input_custom15;var ep1_form_input_custom16;var ep1_form_input_custom17;var ep1_form_input_custom18;var ep1_form_input_custom19;var ep1_form_input_custom20;var ep2_form_input_full_name;var ep2_form_input_first_name;var ep2_form_input_last_name;var ep2_form_input_email;var ep2_form_input_phone;var ep2_form_input_opt_in;var ep2_form_input_custom1;var ep2_form_input_custom2;var ep2_form_input_custom3;var ep2_form_input_custom4;var ep2_form_input_custom5;var ep2_form_input_custom6;var ep2_form_input_custom7;var ep2_form_input_custom8;var ep2_form_input_custom9;var ep2_form_input_custom10;var ep2_form_input_custom11;var ep2_form_input_custom12;var ep2_form_input_custom13;var ep2_form_input_custom14;var ep2_form_input_custom15;var ep2_form_input_custom16;var ep2_form_input_custom17;var ep2_form_input_custom18;var ep2_form_input_custom19;var ep2_form_input_custom20;var ep3_form_input_full_name;var ep3_form_input_first_name;var ep3_form_input_last_name;var ep3_form_input_email;var ep3_form_input_phone;var ep3_form_input_opt_in;var ep3_form_input_custom1;var ep3_form_input_custom2;var ep3_form_input_custom3;var ep3_form_input_custom4;var ep3_form_input_custom5;var ep3_form_input_custom6;var ep3_form_input_custom7;var ep3_form_input_custom8;var ep3_form_input_custom9;var ep3_form_input_custom10;var ep3_form_input_custom11;var ep3_form_input_custom12;var ep3_form_input_custom13;var ep3_form_input_custom14;var ep3_form_input_custom15;var ep3_form_input_custom16;var ep3_form_input_custom17;var ep3_form_input_custom18;var ep3_form_input_custom19;var ep3_form_input_custom20;var ep4_form_input_full_name;var ep4_form_input_first_name;var ep4_form_input_last_name;var ep4_form_input_email;var ep4_form_input_phone;var ep4_form_input_opt_in;var ep4_form_input_custom1;var ep4_form_input_custom2;var ep4_form_input_custom3;var ep4_form_input_custom4;var ep4_form_input_custom5;var ep4_form_input_custom6;var ep4_form_input_custom7;var ep4_form_input_custom8;var ep4_form_input_custom9;var ep4_form_input_custom10;var ep4_form_input_custom11;var ep4_form_input_custom12;var ep4_form_input_custom13;var ep4_form_input_custom14;var ep4_form_input_custom15;var ep4_form_input_custom16;var ep4_form_input_custom17;var ep4_form_input_custom18;var ep4_form_input_custom19;var ep4_form_input_custom20;var using_form=false;var using_form_thx=false;var using_form_ep1=false;var using_form_ep2=false;var using_form_ep3=false;var using_form_ep4=false;var IsDatepickerScriptLoaded=false;var IsDatepickerScriptLoading=false;var jQuery={};var $={};var AfterDomLoadedHasRun=false;var BuiltExtraPageStyles={};var LoadedCustomFonts={};var LoadedPageImages={};var ImageSrcMap={};window.jQuery=function(selector){return parent.DIGIOH_API.LIGHTBOX.JQUERY_DIGIOH(selector,document);};jQuery=parent.DIGIOH_API.LIGHTBOX.JQUERY_DIGIOH.extend(jQuery,parent.DIGIOH_API.LIGHTBOX.JQUERY_DIGIOH);window.$=window.jQuery;$=jQuery;if(!String.prototype.trim){String.prototype.trim=function(){return this.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,'');};}
if(!String.prototype.includes){String.prototype.includes=function(search,start){'use strict';if(typeof start!=='number'){start=0;}
if(start+search.length>this.length){return false;}else{return this.indexOf(search,start)!==-1;}};}
if(!String.prototype.contains){String.prototype.contains=String.prototype.includes;}
if(!String.prototype.Contains){String.prototype.Contains=String.prototype.includes;}
if(!Array.prototype.includes){Object.defineProperty(Array.prototype,"includes",{enumerable:false,value:function(obj){var newArr=this.filter(function(el){return el==obj;});return newArr.length>0;}});}
if(!Array.prototype.contains){Array.prototype.contains=Array.prototype.includes;}
if(!Array.prototype.Contains){Array.prototype.Contains=Array.prototype.includes;}
if(typeof Array.prototype.remove!=="function"){Object.defineProperty(Array.prototype,"remove",{enumerable:false,value:function(obj){var idx=0;while(idx!=-1){idx=this.indexOf(obj);if(idx!=-1){this.splice(idx,1);}}
return this;}});}
function checkJqLoaded(){onJqLoaded();}
function onScriptsLoaded(){IS_SCRIPTS_LOADED=true;tryInitScripts();tryInitBugsnag();}
function onJqLoaded(){if(typeof LIGHTBOX_GUID==='undefined'){window.setTimeout(onJqLoaded,100);}else{onVarsLoaded();}}
function checkDocumentReadyState(){try{if(document.readyState==="complete"||document.readyState==="loaded"||document.readyState==="interactive"){afterDomLoaded();}else{setTimeout(checkDocumentReadyState,250);}}
catch(e){BOX_CUSTOM_JS.logError(e,"checkDocumentReadyState");}}
function afterDomLoaded(){try{if(!AfterDomLoadedHasRun){AfterDomLoadedHasRun=true;$("html").attr("lang","en");body=$('body');$('head').append(ie9);$('head').append(pgStyle);body.append(bodInsert);modal_loading=$('#modal_loading');error_bubble=$('#error_bubble');error_message=$('#error_message');$('#error_close').on(IS_MOBILE?'click':'mousedown',function(){error_bubble.hide();});try{parent.DIGIOH_API.LIGHTBOX.JQUERY_DIGIOH(top).keyup(function(e){var code=(e.keyCode?e.keyCode:e.which);if(code==27){postMessageCloseBox('button_click');}});}
catch(err){}
$(window).keyup(function(e){var code=(e.keyCode?e.keyCode:e.which);if(code==27){postMessageCloseBox('button_click');}
if(code==13){var pref=CURRENT_PAGE;if(pref=='main')
pref='';var foundMatch=false;$('#'+pref+'layout .button_focus_tab_submit').each(function(){if(!foundMatch){foundMatch=true;if(pref==''){processSubmit(pref);}else if(pref.indexOf('_')===-1){processSubmit(pref+'_');}}});$('#'+pref+'layout .button_focus_tab_close').each(function(){if(!foundMatch){foundMatch=true;postMessageCloseBox('button_click');}});$('#'+pref+'layout .button_focus_tab_redirect').each(function(){if(!foundMatch){foundMatch=true;var ptn=$(this).attr('id');if(ptn&&settings.hasOwnProperty(ptn)){var prop=settings[ptn];if(prop.url){if(prop.url.toLowerCase().trim().indexOf('http')!==0&&prop.url.toLowerCase().trim().indexOf('mailto')!==0){prop.url='http://'+prop.url;}
if(!prop.hasOwnProperty('redirect_type')||!prop.redirect_type){prop.redirect_type='current';}
postMessageRedirectParent(prop,'button');}}}});$('#'+pref+'layout .button_focus_tab_lightbox_open').each(function(){if(!foundMatch){foundMatch=true;var ptn=$(this).attr('id');if(ptn&&settings.hasOwnProperty(ptn)){var prop=settings[ptn];if(prop.lightbox_open&&prop.lightbox_open.length>0){postMessageOpenAnotherBox(prop,'button');}}}});$('#'+pref+'layout .button_focus_tab_change_pages').each(function(){if(!foundMatch){foundMatch=true;var ptn=$(this).attr('id');if(ptn&&settings.hasOwnProperty(ptn)){var prop=settings[ptn];if(prop.action=='main_page'){changePages('',ptn,prop,'button');}else if(prop.action=='thank_you_page'){changePages('thx_',ptn,prop,'button');}else if(prop.action=='extra_page_1'){changePages('ep1_',ptn,prop,'button');}else if(prop.action=='extra_page_2'){changePages('ep2_',ptn,prop,'button');}else if(prop.action=='extra_page_3'){changePages('ep3_',ptn,prop,'button');}else if(prop.action=='extra_page_4'){changePages('ep4_',ptn,prop,'button');}}}});}});tryApplySettings();}}
catch(e){BOX_CUSTOM_JS.logError(e,"afterDomLoaded");}}
function onVarsLoaded(){LIGHTBOX_OR_VARIATION_GUID=(IS_VARIATION?VARIATION_GUID:LIGHTBOX_GUID);STANDARD_OBJ.protocol=PROTOCOL;STANDARD_OBJ.protocol_user_override=PROTOCOL_USER_OVERRIDE;STANDARD_OBJ.widget_type=WIDGET_TYPE;STANDARD_OBJ.cache_version=CACHE_VERSION;STANDARD_OBJ.parent_url=PARENT_URL;STANDARD_OBJ.full_url=FULL_URL||'';STANDARD_OBJ.use_bugsnag=DIGIOH_USE_BUGSNAG;STANDARD_OBJ.use_console=SHOW_ERRORS;STANDARD_OBJ.is_preview=IS_PREVIEW;STANDARD_OBJ.is_responsive=DIGIOH_USE_RESPONSIVE;STANDARD_OBJ.is_variation=IS_VARIATION;STANDARD_OBJ.user_id=VENDOR_GUID;STANDARD_OBJ.user_guid=VENDOR_GUID;STANDARD_OBJ.user_short_id=VENDOR_SHORT_ID;STANDARD_OBJ.vendor_id=VENDOR_GUID;STANDARD_OBJ.vendor_guid=VENDOR_GUID;STANDARD_OBJ.vendor_short_id=VENDOR_SHORT_ID;STANDARD_OBJ.client_id=CLIENT_GUID;STANDARD_OBJ.client_guid=CLIENT_GUID;STANDARD_OBJ.lightbox_id=LIGHTBOX_GUID;STANDARD_OBJ.lightbox_guid=LIGHTBOX_GUID;STANDARD_OBJ.lightbox_short_id=LIGHTBOX_SHORT_ID;STANDARD_OBJ.lightbox_name=LIGHTBOX_NAME;STANDARD_OBJ.variation_id=VARIATION_GUID;STANDARD_OBJ.variation_guid=VARIATION_GUID;STANDARD_OBJ.variation_short_id=VARIATION_SHORT_ID;STANDARD_OBJ.variation_name=VARIATION_NAME;STANDARD_OBJ.ab_test_id=AB_TEST_GUID;STANDARD_OBJ.ab_test_guid=AB_TEST_GUID;STANDARD_OBJ.ab_test_short_id=AB_TEST_SHORT_ID;STANDARD_OBJ.ab_test_name=AB_TEST_NAME;STANDARD_OBJ.lightbox_or_variation_id=LIGHTBOX_OR_VARIATION_GUID;STANDARD_OBJ.lightbox_or_variation_guid=LIGHTBOX_OR_VARIATION_GUID;STANDARD_OBJ.lightbox_or_variation_short_id=(IS_VARIATION?VARIATION_SHORT_ID:LIGHTBOX_SHORT_ID);STANDARD_OBJ.lightbox_or_variation_name=(IS_VARIATION?VARIATION_NAME:LIGHTBOX_NAME);STANDARD_OBJ.is_desktop=IS_DESKTOP;STANDARD_OBJ.is_phone=IS_PHONE;STANDARD_OBJ.is_tablet=IS_TABLET;STANDARD_OBJ.is_mobile=IS_MOBILE;var cjsRes=BOX_CUSTOM_JS.runCustomJsBeforeDOMReady();if(typeof cjsRes==='boolean'&&cjsRes===false){sendMessageToParent({sender:"lightbox",parent_action:'terminate_lightbox',lightbox_id:LIGHTBOX_OR_VARIATION_GUID});}
else{onScriptsLoaded();$(document).ready(function(){afterDomLoaded();});checkDocumentReadyState();}}
function onResponsiveDimensionChange(obj){try{if(IS_SETTINGS_LOADED&&IS_SCRIPTS_LOADED){var width=obj.width;var height=obj.height;CURRENT_WIDTH=width;CURRENT_HEIGHT=height;var pref='';if(CURRENT_PAGE&&CURRENT_PAGE!=='main'){pref=CURRENT_PAGE;}
if(!settings.hasOwnProperty(pref+'responsive')||!settings[pref+'responsive'].use){return;}
var origBoxWidth=700;var origBoxHeight=500;if(settings.hasOwnProperty(pref+'layout')&&settings[pref+'layout'].hasOwnProperty('width')&&settings[pref+'layout'].hasOwnProperty('height')){origBoxWidth=settings[pref+'layout'].width;origBoxHeight=settings[pref+'layout'].height;}else{origBoxWidth=settings['layout'].width;origBoxHeight=settings['layout'].height;}
var newBoxWidth=obj.width;var newBoxHeight=obj.height;if(DIGIOH_USE_RESPONSIVE){if(newBoxWidth>settings[pref+'responsive'].width_max)
newBoxWidth=settings[pref+'responsive'].width_max;else if(newBoxWidth<settings[pref+'responsive'].width_min)
newBoxWidth=settings[pref+'responsive'].width_min;if(newBoxHeight>settings[pref+'responsive'].height_max)
newBoxHeight=settings[pref+'responsive'].height_max;else if(newBoxHeight<settings[pref+'responsive'].height_min)
newBoxHeight=settings[pref+'responsive'].height_min;}
else{newBoxWidth=obj.width;newBoxHeight=origBoxHeight;}
if(settings[pref+'layout'].border.style==='none'||settings[pref+'layout'].border.width==='0'||settings[pref+'layout'].border.width===0){newBoxWidth=newBoxWidth;newBoxHeight=newBoxHeight;}else{newBoxWidth=newBoxWidth-(2*settings[pref+'layout'].border.width);newBoxHeight=newBoxHeight-(2*settings[pref+'layout'].border.width);}
var diffBoxWidth=newBoxWidth-origBoxWidth;var diffBoxHeight=newBoxHeight-origBoxHeight;var growthBoxWidth=diffBoxWidth/origBoxWidth;var growthBoxHeight=diffBoxHeight/origBoxHeight;$('#'+pref+'layout').width(newBoxWidth);$('#'+pref+'layout').height(newBoxHeight);var includeFilter=settings[pref+'responsive'].include_filter||'';var excludeFilter=settings[pref+'responsive'].exclude_filter||'';if(!DIGIOH_USE_RESPONSIVE){includeFilter='';excludeFilter='';}
for(var j=0;j<=4;j++){var ele_type='';if(j===0)ele_type='html';if(j===1)ele_type='text';if(j===2)ele_type='button';if(j===3)ele_type='image';if(j===4)ele_type='form';for(var idx=1;idx<=10;idx++){var i=idx;var pref_responsive=pref+'responsive';if(ele_type==='form'){if(idx<10){continue;}else{i='';if(pref!==''){pref=pref+'_';}}}
if(!DIGIOH_USE_RESPONSIVE&&settings.hasOwnProperty(pref+ele_type+i)&&settings[pref+ele_type+i].display){var origElementWidth=settings[pref+ele_type+i].width;var origElementHeight=settings[pref+ele_type+i].height;var origElementLeft=settings[pref+ele_type+i].x;var origElementTop=settings[pref+ele_type+i].y;var newElementWidth=origElementWidth;var newElementHeight=origElementHeight;var newElementLeft=getNewElementLeft(pref_responsive,origElementLeft,origElementWidth,newElementWidth,origBoxWidth,newBoxWidth);var newElementTop=getNewElementTop(pref_responsive,origElementTop,origElementHeight,newElementHeight,origBoxHeight,newBoxHeight);var diffElementWidth=newElementWidth-origElementWidth;var diffElementHeight=newElementHeight-origElementHeight;$('#'+pref+ele_type+i+'_wrapper').css({"left":newElementLeft+"px","top":newElementTop+"px","width":newElementWidth+"px","height":newElementHeight+"px"});}
else if(DIGIOH_USE_RESPONSIVE&&settings.hasOwnProperty(pref+ele_type+i)&&settings[pref+ele_type+i].display&&excludeFilter.indexOf(ele_type+i)===-1&&(settings[pref_responsive]['use_'+ele_type]||includeFilter.indexOf(ele_type+i)>=0)){var elementWidthPct=settings[pref_responsive].content_width;var elementHeightPct=settings[pref_responsive].content_height;var elementFontPct=settings[pref_responsive].content_font;var labelsFontPct=elementFontPct;var inputsFontPct=elementFontPct;var optInFontPct=0;var helpTextFontPct=0;var elementWidthMin=0;var elementHeightMin=0;var elementFontMin=0;var labelsFontMin=0;var inputsFontMin=0;var optInFontMin=0;var helpTextFontMin=0;var elementWidthMax=10000;var elementHeightMax=10000;var elementFontMax=10000;var labelsFontMax=10000;var inputsFontMax=10000;var optInFontMax=10000;var helpTextFontMax=10000;if(includeFilter.indexOf(ele_type+i)>=0){var includeParts=includeFilter.split(/\r?\n/);for(var x=0;x<includeParts.length;x++){if(includeParts[x].indexOf('|')>0&&includeParts[x].indexOf(':')>0){var elementNWHF=includeParts[x].split('|');var elementNameNum='';var elementW='';var elementH='';var elementF='';if(elementNWHF.length>0)
elementNameNum=elementNWHF[0];if(elementNWHF.length>1)
elementW=elementNWHF[1];if(elementNWHF.length>2)
elementH=elementNWHF[2];if(elementNWHF.length>3)
elementF=elementNWHF[3];var elementWparts=elementW.split(':');var elementHparts=elementH.split(':');var elementFparts=elementF.split(':');if(elementNameNum.trim()===(ele_type+i)){if(elementWparts.length===3){elementWidthPct=parseInt(elementWparts[0].trim());elementWidthMin=parseInt(elementWparts[1].trim());elementWidthMax=parseInt(elementWparts[2].trim());}
if(elementHparts.length===3){elementHeightPct=parseInt(elementHparts[0].trim());elementHeightMin=parseInt(elementHparts[1].trim());elementHeightMax=parseInt(elementHparts[2].trim());}
if(elementFparts.length===3){elementFontPct=parseInt(elementFparts[0].trim());elementFontMin=parseInt(elementFparts[1].trim());elementFontMax=parseInt(elementFparts[2].trim());}}else if(elementNameNum.trim()==='labels'){if(elementFparts.length===3){labelsFontPct=parseInt(elementFparts[0].trim());labelsFontMin=parseInt(elementFparts[1].trim());labelsFontMax=parseInt(elementFparts[2].trim());}}else if(elementNameNum.trim()==='inputs'){if(elementFparts.length===3){inputsFontPct=parseInt(elementFparts[0].trim());inputsFontMin=parseInt(elementFparts[1].trim());inputsFontMax=parseInt(elementFparts[2].trim());}}else if(elementNameNum.trim()==='opt_in'){if(elementFparts.length===3){optInFontPct=parseInt(elementFparts[0].trim());optInFontMin=parseInt(elementFparts[1].trim());optInFontMax=parseInt(elementFparts[2].trim());}}else if(elementNameNum.trim()==='help_text'){if(elementFparts.length===3){helpTextFontPct=parseInt(elementFparts[0].trim());helpTextFontMin=parseInt(elementFparts[1].trim());helpTextFontMax=parseInt(elementFparts[2].trim());}}}}}
var origElementWidth=settings[pref+ele_type+i].width;var origElementHeight=settings[pref+ele_type+i].height;var origElementLeft=settings[pref+ele_type+i].x;var origElementTop=settings[pref+ele_type+i].y;var newElementWidth=Math.round(origElementWidth+(diffBoxWidth*elementWidthPct/100));var newElementHeight=Math.round(origElementHeight+(diffBoxHeight*elementHeightPct/100));if(newElementWidth<elementWidthMin)
newElementWidth=elementWidthMin;if(newElementWidth>elementWidthMax)
newElementWidth=elementWidthMax;if(newElementHeight<elementHeightMin)
newElementHeight=elementHeightMin;if(newElementHeight>elementHeightMax)
newElementHeight=elementHeightMax;var newElementLeft=getNewElementLeft(pref_responsive,origElementLeft,origElementWidth,newElementWidth,origBoxWidth,newBoxWidth);var newElementTop=getNewElementTop(pref_responsive,origElementTop,origElementHeight,newElementHeight,origBoxHeight,newBoxHeight);var diffElementWidth=newElementWidth-origElementWidth;var diffElementHeight=newElementHeight-origElementHeight;$('#'+pref+ele_type+i+'_wrapper').css({"left":newElementLeft+"px","top":newElementTop+"px","width":newElementWidth+"px","height":newElementHeight+"px"});if(ele_type==='form'){if(excludeFilter.indexOf('labels')===-1){var labelsFontMultiplier=((diffElementWidth/5)*(labelsFontPct/100));var origLabelFontSize=parseInt(settings[pref+'labels'].font.size);var newLabelFontSize=Math.round(origLabelFontSize+labelsFontMultiplier);if(newLabelFontSize<labelsFontMin)
newLabelFontSize=labelsFontMin;if(newLabelFontSize>labelsFontMax)
newLabelFontSize=labelsFontMax;$('.'+pref+'form_labels').css({"font-size":newLabelFontSize+"px"});}
if(excludeFilter.indexOf('inputs')===-1){var inputsFontMultiplier=((diffElementWidth/5)*(inputsFontPct/100));var origInputFontSize=parseInt(settings[pref+'inputs'].font.size);var newInputFontSize=Math.round(origInputFontSize+inputsFontMultiplier);if(newInputFontSize<inputsFontMin)
newInputFontSize=inputsFontMin;if(newInputFontSize>inputsFontMax)
newInputFontSize=inputsFontMax;$('.'+pref+'form_inputs').css({"font-size":newInputFontSize+"px"});}
if(settings.hasOwnProperty(pref+'opt_in')&&settings[pref+'opt_in'].display&&excludeFilter.indexOf('opt_in')===-1&&optInFontPct>0){var optInFontMultiplier=((diffElementWidth/5)*(optInFontPct/100));var origOptInFontSize=parseInt(settings[pref+'opt_in'].font.size);var newOptInFontSize=Math.round(origOptInFontSize+optInFontMultiplier);if(newOptInFontSize<optInFontMin)
newOptInFontSize=optInFontMin;if(newOptInFontSize>optInFontMax)
newOptInFontSize=optInFontMax;$('#'+pref+'form_input_opt_in_text').css({"font-size":newOptInFontSize+"px"});}
if(excludeFilter.indexOf('help_text')===-1&&helpTextFontPct>0){var helpTextFontMultiplier=((diffElementWidth/5)*(helpTextFontPct/100));var origHelpTextFontSize=11;var newHelpTextFontSize=Math.round(origHelpTextFontSize+helpTextFontMultiplier);if(newHelpTextFontSize<helpTextFontMin)
newHelpTextFontSize=helpTextFontMin;if(newHelpTextFontSize>helpTextFontMax)
newHelpTextFontSize=helpTextFontMax;$('.'+pref+'form_inputs_help').css({"font-size":newHelpTextFontSize+"px"});}
var growthElementHeightPct=diffElementHeight/origElementHeight;var newFormRowHeight=Math.round(parseInt(settings[pref+'inputs'].height)*(1+growthElementHeightPct));if(settings[pref+'labels'].position=='left'){$('.'+pref+'form_labels').height(newFormRowHeight);$('.'+pref+'form_labels').css({'line-height':newFormRowHeight+'px'});}
$('.'+pref+'form_inputs').height(newFormRowHeight);}
else if(ele_type==='text'||ele_type==='button'){var fontMultiplier=((diffElementWidth/5)*(elementFontPct/100));var origElementFontSize=parseInt(settings[pref+ele_type+i].font.size);var newElementFontSize=Math.round(origElementFontSize+fontMultiplier);if(newElementFontSize<elementFontMin)
newElementFontSize=elementFontMin;if(newElementFontSize>elementFontMax)
newElementFontSize=elementFontMax;$('#'+pref+ele_type+i).css({"font-size":newElementFontSize+"px"});}}}}}else{}}catch(e){BOX_CUSTOM_JS.logError(e,'onResponsiveDimensionChange');}}
function getNewElementLeft(pref_responsive,origElementLeft,origElementWidth,newElementWidth,origBoxWidth,newBoxWidth){var contentAlignmentX=settings[pref_responsive].content_alignment_x||'center';var newElementLeft=origElementLeft;if(contentAlignmentX==='left'){newElementLeft=origElementLeft;}else if(contentAlignmentX==='center'){var diffBoxWidth=newBoxWidth-origBoxWidth;var diffElementWidth=newElementWidth-origElementWidth;newElementLeft=Math.round(origElementLeft+(0.5*diffBoxWidth)-(0.5*diffElementWidth));}else if(contentAlignmentX==='right'){newElementLeft=newBoxWidth-(origBoxWidth-origElementWidth-origElementLeft)-newElementWidth;}
return newElementLeft;}
function getNewElementTop(pref_responsive,origElementTop,origElementHeight,newElementHeight,origBoxHeight,newBoxHeight){var contentAlignmentY=settings[pref_responsive].content_alignment_y||'top';var newElementTop=origElementTop;if(contentAlignmentY==='top'){newElementTop=origElementTop;}else if(contentAlignmentY==='center'){var diffBoxHeight=newBoxHeight-origBoxHeight;var diffElementHeight=newElementHeight-origElementHeight;newElementTop=Math.round(origElementTop+(0.5*diffBoxHeight)-(0.5*diffElementHeight));}else if(contentAlignmentY==='bottom'){newElementTop=newBoxHeight-(origBoxHeight-origElementHeight-origElementTop)-newElementHeight;}
return newElementTop;}
function sendMessageToParent(obj){parent.DIGIOH_API.LIGHTBOX.receiveMessageFromIframe(obj,LIGHTBOX_OR_VARIATION_GUID);}
function receiveMessageFromParent(obj){if(obj&&obj.hasOwnProperty('message')){logger('(BOX #'+LIGHTBOX_SHORT_ID+') - receiveMessageFromParent: '+obj.message);}
if(obj&&obj.hasOwnProperty('sender')&&obj.sender==='lightbox'){if(obj.hasOwnProperty('action')){if(obj.action==='dimensions_changed'){onResponsiveDimensionChange(obj);}
else if(obj.action==='pixel_version_changed'){var pg='';if(obj.hasOwnProperty('page')){pg=obj['page'];}
onPixelVersionChange(pg);}
else if(obj.action==='before_lightbox_display'){BOX_CUSTOM_JS.runCustomJsBeforeDisplay();}
else if(obj.action==='after_lightbox_display'){if(obj.auto_focus){if($('#form_input_first_name').length){$('#form_input_first_name').focus();}
else if($('#form_input_full_name').length){$('#form_input_full_name').focus();}
else if($('#form_input_email').length){$('#form_input_email').focus();}}
BOX_CUSTOM_JS.runCustomJsAfterDisplay();}
else if(obj.action==='before_lightbox_close'){BOX_CUSTOM_JS.runCustomJsBeforeClose();}
else if(obj.action==='after_lightbox_close'){BOX_CUSTOM_JS.runCustomJsAfterClose();}}}}
function sendMessageToIframe(obj,lid_target){parent.DIGIOH_API.LIGHTBOX.relayMessageToIframe(obj,LIGHTBOX_OR_VARIATION_GUID,lid_target);}
function receiveMessageFromIframe(obj,lid_source,lid_target){if(obj&&obj.hasOwnProperty('message')){logger('(BOX #'+LIGHTBOX_SHORT_ID+') -'+obj.message);}}
function tryInitBugsnag(){BugsnagInitAttempts++;if(typeof DIGIOH_USE_BUGSNAG!=='undefined'&&DIGIOH_USE_BUGSNAG){if(typeof parent.DIGIOH_API.LIGHTBOX.DIGIOH_BUGSNAG!=='undefined'&&parent.DIGIOH_API.LIGHTBOX.DIGIOH_BUGSNAG!==null){}else if(BugsnagInitAttempts<10){setTimeout(tryInitBugsnag,250);}}}
function onPixelVersionChange(page){tryInitScripts();clearSettings();applySettings(false,page,true);}
function tryInitScripts(){if(parent.DIGIOH_API.LIGHTBOX.PixelThresholdSettings&&parent.DIGIOH_API.LIGHTBOX.PixelThresholdSettings.hasOwnProperty(LIGHTBOX_OR_VARIATION_GUID)&&typeof parent.DIGIOH_API.LIGHTBOX.PixelThresholdSettings[LIGHTBOX_OR_VARIATION_GUID]==='object'){settings=parent.DIGIOH_API.LIGHTBOX.PixelThresholdSettings[LIGHTBOX_OR_VARIATION_GUID];IS_SETTINGS_LOADED=true;}else if(parent.DIGIOH_API.DIGIOH_LIGHTBOX_SETTINGS&&parent.DIGIOH_API.DIGIOH_LIGHTBOX_SETTINGS.hasOwnProperty(LIGHTBOX_OR_VARIATION_GUID)&&parent.DIGIOH_API.LIGHTBOX.LZString){if(typeof parent.DIGIOH_API.DIGIOH_LIGHTBOX_SETTINGS[LIGHTBOX_OR_VARIATION_GUID]==='object'&&parent.DIGIOH_API.DIGIOH_LIGHTBOX_SETTINGS[LIGHTBOX_OR_VARIATION_GUID]!==null){settings=parent.DIGIOH_API.DIGIOH_LIGHTBOX_SETTINGS[LIGHTBOX_OR_VARIATION_GUID];}else if(typeof parent.DIGIOH_API.DIGIOH_LIGHTBOX_SETTINGS[LIGHTBOX_OR_VARIATION_GUID]==='string'&&parent.DIGIOH_API.DIGIOH_LIGHTBOX_SETTINGS[LIGHTBOX_OR_VARIATION_GUID].length>50&&parent.DIGIOH_API.DIGIOH_LIGHTBOX_SETTINGS[LIGHTBOX_OR_VARIATION_GUID].indexOf('{')<0){settings=JSON.parse(parent.DIGIOH_API.LIGHTBOX.LZString.decompressFromBase64(parent.DIGIOH_API.DIGIOH_LIGHTBOX_SETTINGS[LIGHTBOX_OR_VARIATION_GUID]));}else if(typeof parent.DIGIOH_API.DIGIOH_LIGHTBOX_SETTINGS[LIGHTBOX_OR_VARIATION_GUID]==='string'&&parent.DIGIOH_API.DIGIOH_LIGHTBOX_SETTINGS[LIGHTBOX_OR_VARIATION_GUID].length>50&&parent.DIGIOH_API.DIGIOH_LIGHTBOX_SETTINGS[LIGHTBOX_OR_VARIATION_GUID].indexOf('{')>=0){settings=JSON.parse(parent.DIGIOH_API.DIGIOH_LIGHTBOX_SETTINGS[LIGHTBOX_OR_VARIATION_GUID]);}
IS_SETTINGS_LOADED=true;}else{setTimeout(tryInitScripts,200);}}
function tryApplySettings(){if(IS_SETTINGS_LOADED&&IS_SCRIPTS_LOADED){applySettings(true,'');}else{setTimeout(tryApplySettings,100);}}
function clearSettings(){if($('#layout').length){$('#layout').empty();}
if($('#thxlayout').length){$('#thxlayout').empty();}
if($('#ep1layout').length){$('#ep1layout').empty();}
if($('#ep2layout').length){$('#ep2layout').empty();}
if($('#ep3layout').length){$('#ep3layout').empty();}
if($('#ep4layout').length){$('#ep4layout').empty();}}
function getFormMergeTagsFromString(str){try{var tags=[];var mergeParts=str.split('[FORM_');if(mergeParts.length>1){for(var j=1;j<mergeParts.length;j++){if(mergeParts[j].contains(']')){tags.push('[FORM_'+mergeParts[j].split(']')[0]+']');}}}
return tags;}catch(e){BOX_CUSTOM_JS.logError(e,'getFormMergeTagsFromString');}
return[];}
function getFormMergeTagReplacementValue(mergeTag){try{var ls=parent.DIGIOH_API.LIGHTBOX.DIGIOH_LOCAL_STORAGE.getManual('fsdbx');var localStorageVal='';var fallback='';mergeTag=mergeTag.replace('[','').replace(']','');var mergeTagParts=mergeTag.split('_');if(mergeTagParts.length>=3){if(mergeTagParts[1]==='GLOBAL'&&typeof ls==='object'&&ls!==null){if(mergeTagParts[2]==='FIRST'&&mergeTagParts.length>3&&mergeTagParts[3]==='NAME'){localStorageVal=ls.hasOwnProperty('first_name')?ls['first_name']:'';}
else if(mergeTagParts[2]==='LAST'&&mergeTagParts.length>3&&mergeTagParts[3]==='NAME'){localStorageVal=ls.hasOwnProperty('last_name')?ls['last_name']:'';}
else if(mergeTagParts[2]==='OPT'&&mergeTagParts.length>3&&mergeTagParts[3]==='IN'){localStorageVal=ls.hasOwnProperty('opt_in')?ls['opt_in']:'';}
else if(mergeTagParts[2]==='CUSTOM'&&mergeTagParts.length>3){localStorageVal=ls.hasOwnProperty('custom_'+mergeTagParts[3])?ls['custom_'+mergeTagParts[3]]:'';}
else{localStorageVal=ls.hasOwnProperty(mergeTagParts[2].toLowerCase())?ls[mergeTagParts[2].toLowerCase()]:'';}}
else if(ls.hasOwnProperty(mergeTagParts[1])&&typeof ls[mergeTagParts[1]]==='object'&&ls[mergeTagParts[1]]!==null&&typeof ls==='object'&&ls!==null){if(mergeTagParts[2]==='FIRST'&&mergeTagParts.length>3&&mergeTagParts[3]==='NAME'){localStorageVal=ls[mergeTagParts[1]].hasOwnProperty('first_name')?ls[mergeTagParts[1]]['first_name']:'';}
else if(mergeTagParts[2]==='LAST'&&mergeTagParts.length>3&&mergeTagParts[3]==='NAME'){localStorageVal=ls[mergeTagParts[1]].hasOwnProperty('last_name')?ls[mergeTagParts[1]]['last_name']:'';}
else if(mergeTagParts[2]==='OPT'&&mergeTagParts.length>3&&mergeTagParts[3]==='IN'){localStorageVal=ls[mergeTagParts[1]].hasOwnProperty('opt_in')?ls[mergeTagParts[1]]['opt_in']:'';}
else if(mergeTagParts[2]==='CUSTOM'&&mergeTagParts.length>3){localStorageVal=ls[mergeTagParts[1]].hasOwnProperty('custom_'+mergeTagParts[3])?ls[mergeTagParts[1]]['custom_'+mergeTagParts[3]]:'';}
else{localStorageVal=ls[mergeTagParts[1]].hasOwnProperty(mergeTagParts[2].toLowerCase())?ls[mergeTagParts[1]][mergeTagParts[2].toLowerCase()]:'';}}
if(mergeTagParts.length>4&&(mergeTag.indexOf('_FIRST_NAME')>0||mergeTag.indexOf('_LAST_NAME')>0||mergeTag.indexOf('_OPT_IN')>0||mergeTag.indexOf('_CUSTOM_')>0)){for(var k=4;k<mergeTagParts.length;k++){fallback+=mergeTagParts[k]+'_';}}
else if(mergeTagParts.length>3&&(mergeTag.indexOf('_EMAIL')>0||mergeTag.indexOf('_PHONE')>0||mergeTag.indexOf('_NAME')>0)&&mergeTag.indexOf('_FIRST_NAME')===-1&&mergeTag.indexOf('_LAST_NAME')===-1){for(var k=3;k<mergeTagParts.length;k++){fallback+=mergeTagParts[k]+'_';}}
if(fallback.length>0){fallback=fallback.substr(0,fallback.length-1);}
return[localStorageVal,fallback];}}catch(e){BOX_CUSTOM_JS.logError(e,'getFormMergeTagReplacementValue');}
return[];}
function replaceSettingsObjFormMergeTags(settingsProp,pref){try{var keys=Object.keys(settingsProp);for(var i=0;i<keys.length;i++){if(typeof settingsProp[keys[i]]==='object'&&((pref===''&&keys[i].indexOf('thx')!==0&&keys[i].indexOf('ep')!==0)||(pref!==''&&keys[i].indexOf(pref)===0))){replaceSettingsObjFormMergeTags(settingsProp[keys[i]],pref);}
else if((typeof settingsProp[keys[i]]==='string'&&settingsProp[keys[i]].indexOf('[FORM_')>=0)&&((pref===''&&keys[i].indexOf('thx')!==0&&keys[i].indexOf('ep')!==0)||(pref!==''&&keys[i].indexOf(pref)===0))){var tags=getFormMergeTagsFromString(settingsProp[keys[i]]);for(var j=0;j<tags.length;j++){var mergeTag=tags[j];var replacementValues=getFormMergeTagReplacementValue(mergeTag);if(replacementValues.length===2){var localStorageVal=replacementValues[0];var fallback=replacementValues[1];if(localStorageVal!==''){settingsProp[keys[i]]=settingsProp[keys[i]].split(mergeTag).join(localStorageVal);}
else if(fallback!==''){settingsProp[keys[i]]=settingsProp[keys[i]].split(mergeTag).join(fallback);}
else{settingsProp[keys[i]]=settingsProp[keys[i]].split(mergeTag).join('');}}}}}}catch(e){BOX_CUSTOM_JS.logError(e,'replaceSettingsObjFormMergeTags');}}
function replaceSettingsObjFormMergeTagsAfterChangePages(pref){try{$('#'+pref+'layout div:contains("[FORM_"), '+'#'+pref+'layout span:contains("[FORM_"), '+'#'+pref+'layout p:contains("[FORM_"),'+'#'+pref+'layout button:contains("[FORM_")').each(function(){if($(this).children().length<1||($(this).children('a').length+$(this).children('br').length)===$(this).children().length||($(this).children().length<2&&$(this).find('a').length===0&&$(this).find('button').length===0&&$(this).find('*').length<2)){var tags=getFormMergeTagsFromString($(this).html());for(var i=0;i<tags.length;i++){var replacementValues=getFormMergeTagReplacementValue(tags[i]);if(replacementValues.length===2){var localStorageVal=replacementValues[0];var fallback=replacementValues[1];if(localStorageVal!=='')$(this).html($(this).html().split(tags[i]).join(localStorageVal));else if(fallback!=='')$(this).html($(this).html().split(tags[i]).join(fallback));else $(this).html($(this).html().split(tags[i]).join(''));}}}});$('#'+pref+'layout img').each(function(){if($(this).attr('src')&&$(this).attr('src').contains('[FORM_')){var tags=getFormMergeTagsFromString($(this).attr('src'));for(var i=0;i<tags.length;i++){var replacementValues=getFormMergeTagReplacementValue(tags[i]);if(replacementValues.length===2){var localStorageVal=replacementValues[0];var fallback=replacementValues[1];if(localStorageVal!=='')$(this).attr('src',$(this).attr('src').split(tags[i]).join(localStorageVal));else if(fallback!=='')$(this).attr('src',$(this).attr('src').split(tags[i]).join(fallback));else $(this).attr('src',$(this).attr('src').split(tags[i]).join(''));}}}});$('#'+pref+'layout input, '+'#'+pref+'layout textarea,'+'#'+pref+'layout select option').each(function(){if($(this).val()&&$(this).val().contains('[FORM_')){var tags=getFormMergeTagsFromString($(this).val());for(var i=0;i<tags.length;i++){var replacementValues=getFormMergeTagReplacementValue(tags[i]);if(replacementValues.length===2){var localStorageVal=replacementValues[0];var fallback=replacementValues[1];if(localStorageVal!=='')$(this).val($(this).val().split(tags[i]).join(localStorageVal));else if(fallback!=='')$(this).val($(this).val().split(tags[i]).join(fallback));else $(this).val($(this).val().split(tags[i]).join(''));}}}
if(typeof $(this).attr('placeholder')==='string'&&$(this).attr('placeholder').contains('[FORM_')){var tags=getFormMergeTagsFromString($(this).attr('placeholder'));for(var i=0;i<tags.length;i++){var replacementValues=getFormMergeTagReplacementValue(tags[i]);if(replacementValues.length===2){var localStorageVal=replacementValues[0];var fallback=replacementValues[1];if(localStorageVal!=='')$(this).attr('placeholder',$(this).attr('placeholder').split(tags[i]).join(localStorageVal));else if(fallback!=='')$(this).attr('placeholder',$(this).attr('placeholder').split(tags[i]).join(fallback));else $(this).attr('placeholder',$(this).attr('placeholder').split(tags[i]).join(''));}}}
if(typeof $(this).text()==='string'&&$(this).text().contains('[FORM_')){var tags=getFormMergeTagsFromString($(this).text());for(var i=0;i<tags.length;i++){var replacementValues=getFormMergeTagReplacementValue(tags[i]);if(replacementValues.length===2){var localStorageVal=replacementValues[0];var fallback=replacementValues[1];if(localStorageVal!=='')$(this).text($(this).text().split(tags[i]).join(localStorageVal));else if(fallback!=='')$(this).text($(this).text().split(tags[i]).join(fallback));else $(this).text($(this).text().split(tags[i]).join(''));}}}});replaceSettingsObjFormMergeTags(settings,pref);}
catch(e){BOX_CUSTOM_JS.logError(e,'replaceSettingsObjFormMergeTagsAfterChangePages');}}
function applySettings(is_first_render,page,is_pixel_version){try{console.log('applySettings: '+LIGHTBOX_GUID+', '+typeof settings);console.log(settings);if(typeof settings==='string'&&settings.length>50&&settings.indexOf('{')<0){settings=JSON.parse(parent.DIGIOH_API.LIGHTBOX.LZString.decompressFromBase64(settings));}
var x=1;for(var y=5;y>=0;y--){var pr='';if(y===5)pr='';else if(y===0)pr='thx';else pr='ep'+y;if(pr!==''&&!$('#'+pr+'layout').length){$('#layout').after("<div id='"+pr+"layout' style='display: none;'></div>");}
for(x=1;x<=10;x++){if(settings.hasOwnProperty(pr+'text'+x)&&settings[pr+'text'+x].display||x<=4){$('#'+pr+'layout').append("<div id='"+pr+"text"+x+"_wrapper'><div id='"+pr+"text"+x+"'></div></div>");}else if(x<=4){$('#'+pr+'layout').append("<div id='"+pr+"text"+x+"_wrapper' style='display:none;'><div id='"+pr+"text"+x+"'></div></div>");}}
if(pr==='')
$('#'+pr+'layout').append("<div id='form_wrapper'><div id='form'></div></div>");else
$('#'+pr+'layout').append("<div id='"+pr+"_form_wrapper'><div id='"+pr+"_form'></div></div>");for(x=1;x<=10;x++){if(settings.hasOwnProperty(pr+'button'+x)&&settings[pr+'button'+x].display){$('#'+pr+'layout').append("<div id='"+pr+"button"+x+"_wrapper'><button id='"+pr+"button"+x+"' class='"+pr+"button"+x+"'></button></div>");}else if(x<=4){$('#'+pr+'layout').append("<div id='"+pr+"button"+x+"_wrapper' style='display:none;'><button id='"+pr+"button"+x+"' class='"+pr+"button"+x+"'></button></div>");}}
for(x=1;x<=10;x++){if(settings.hasOwnProperty(pr+'image'+x)&&settings[pr+'image'+x].display){$('#'+pr+'layout').append("<div id='"+pr+"image"+x+"_wrapper'><img id='"+pr+"image"+x+"' /></div>");}else if(x<=4){$('#'+pr+'layout').append("<div id='"+pr+"image"+x+"_wrapper' style='display:none;'><img id='"+pr+"image"+x+"' /></div>");}}
for(x=1;x<=10;x++){if(settings.hasOwnProperty(pr+'html'+x)&&settings[pr+'html'+x].display){$('#'+pr+'layout').append("<div id='"+pr+"html"+x+"_wrapper'><div id='"+pr+"html"+x+"'></div></div>");}else if(x<=4){$('#'+pr+'layout').append("<div id='"+pr+"html"+x+"_wrapper' style='display:none;'><div id='"+pr+"html"+x+"'></div></div>");}}
for(x=1;x<=20;x++){if(pr===''&&!settings.hasOwnProperty('custom'+x)){settings['custom'+x]={display:false};}
else if(pr!==''&&!settings.hasOwnProperty(pr+'_custom'+x)){settings[pr+'_custom'+x]={display:false};}}}
form_wrapper=$('#form_wrapper');form=$('#form');thx_form_wrapper=$('#thx_form_wrapper');thx_form=$('#thx_form');ep1_form_wrapper=$('#ep1_form_wrapper');ep1_form=$('#ep1_form');ep2_form_wrapper=$('#ep2_form_wrapper');ep2_form=$('#ep2_form');ep3_form_wrapper=$('#ep3_form_wrapper');ep3_form=$('#ep3_form');ep4_form_wrapper=$('#ep4_form_wrapper');ep4_form=$('#ep4_form');CURRENT_WIDTH=settings.layout.width;CURRENT_HEIGHT=settings.layout.height;determineGoogleFonts();loadExternalFonts('');replaceSettingsObjFormMergeTags(settings,'');buildStyles(page,is_pixel_version);buildText();buildForm();buildButtons();buildImages();loadImages('');buildHTML();buildDynamicItems();buildCouponsDisplay();replaceHrefMergeTags();replaceBrMergeTags();if(is_first_render){if(typeof html_ele.classList==='object'&&html_ele.classList!==null)
html_ele.classList.remove("hidden_until_loaded");$('input').focus(function(){sendMessageToParent({sender:'lightbox',event:'input_focus',lightbox_id:LIGHTBOX_OR_VARIATION_GUID});});sendMessageToParent({sender:'lightbox',status:'child_messaging_ready',lightbox_id:LIGHTBOX_OR_VARIATION_GUID});sendMessageToParent({sender:'lightbox',loading_status:'settings_applied',lightbox_id:LIGHTBOX_OR_VARIATION_GUID,widget_type:WIDGET_TYPE});}
else if(page){if(page.indexOf('_')<0){page+='_';}
changePages(page,page+'form',settings[page+'form'],'form');}
BOX_CUSTOM_JS.runCustomJsAfterDOMReady();}
catch(e){BOX_CUSTOM_JS.logError(e,'applySettings');}}
function buildDynamicItems(){try{if(parent.DIGIOH_API.DIGIOH_DYNAMIC_BOXES){for(var i=0;i<parent.DIGIOH_API.DIGIOH_DYNAMIC_BOXES.length;i++){if(parent.DIGIOH_API.DIGIOH_DYNAMIC_BOXES[i].BoxID===LIGHTBOX_SHORT_ID){var item=parent.DIGIOH_API.DIGIOH_DYNAMIC_BOXES[i];if(item.SourceType==='jquery'){if(parent.DIGIOH_API.LIGHTBOX.JQUERY_DIGIOH(item.SourceSelector).length){var sourceValFound='[DTMP]';if(item.hasOwnProperty('JqueryMethod')&&item.hasOwnProperty('JqueryMethodParam')&&item.JqueryMethodParam){if(item.JqueryMethod==='attr'){sourceValFound=parent.DIGIOH_API.LIGHTBOX.JQUERY_DIGIOH(item.SourceSelector).attr(item.JqueryMethodParam);}else if(item.JqueryMethod==='prop'){sourceValFound=parent.DIGIOH_API.LIGHTBOX.JQUERY_DIGIOH(item.SourceSelector).prop(item.JqueryMethodParam);}else if(item.JqueryMethod==='is'){sourceValFound=parent.DIGIOH_API.LIGHTBOX.JQUERY_DIGIOH(item.SourceSelector).is(item.JqueryMethodParam);}else if(item.JqueryMethod==='css'){sourceValFound=parent.DIGIOH_API.LIGHTBOX.JQUERY_DIGIOH(item.SourceSelector).css(item.JqueryMethodParam);}else if(item.JqueryMethod==='hasClass'){sourceValFound=parent.DIGIOH_API.LIGHTBOX.JQUERY_DIGIOH(item.SourceSelector).hasClass(item.JqueryMethodParam);}}
if(item.hasOwnProperty('JqueryMethod')){if(item.JqueryMethod==='text'){sourceValFound=parent.DIGIOH_API.LIGHTBOX.JQUERY_DIGIOH(item.SourceSelector).text();}else if(item.JqueryMethod==='val'){sourceValFound=parent.DIGIOH_API.LIGHTBOX.JQUERY_DIGIOH(item.SourceSelector).val();}else if(item.JqueryMethod==='length'){sourceValFound=parent.DIGIOH_API.LIGHTBOX.JQUERY_DIGIOH(item.SourceSelector).length.toString();}}
if(sourceValFound==='[DTMP]'){sourceValFound=parent.DIGIOH_API.LIGHTBOX.JQUERY_DIGIOH(item.SourceSelector).html();}
runDynamicSourceComparison(item,sourceValFound);}else if(item.TargetDefault!==''){replaceDynamicTarget(item,item.TargetDefault);}}else if(item.SourceType==='url'){var sourceValFound=parent.location.href;if(typeof sourceValFound!=='string'){sourceValFound='';}
runDynamicSourceComparison(item,sourceValFound);}else if(item.SourceType==='url_param'){var sourceValFound=parent.DIGIOH_API.LIGHTBOX.getUrlParam(item.SourceSelector);if(typeof sourceValFound!=='string'){sourceValFound='';}
runDynamicSourceComparison(item,sourceValFound);}}}}}
catch(e){BOX_CUSTOM_JS.logError(e,'buildDynamicItems');}}
function runDynamicSourceComparison(item,sourceValFound){try{if(item.SourceValue==='[ANYTHING]'){replaceDynamicTarget(item,sourceValFound,item.TargetDefault);}else if(typeof sourceValFound==='string'){var compareVal1=sourceValFound;var compareVal2=item.SourceValue;if(!item.CaseSensitive){compareVal1=compareVal1.toLowerCase();compareVal2=compareVal2.toLowerCase();}
var compareValArr=[];if(compareVal2.contains(',')||compareVal2.contains('|')){if(compareVal2.split(',').length>compareVal2.split('|').length)
compareValArr=compareVal2.split(',');else
compareValArr=compareVal2.split('|');}else{compareValArr.push(compareVal2);}
if(item.SourceOperator==='equals'||item.SourceOperator==='contains'||item.SourceOperator==='starts_with'||item.SourceOperator==='ends_with'){var foundMatch=false;for(var i=0;i<compareValArr.length;i++){if(compareValArr[i].trim()!==''){if(item.SourceOperator==='equals'&&compareVal1===compareValArr[i].trim()){replaceDynamicTarget(item,sourceValFound,item.TargetDefault);foundMatch=true;break;}else if(item.SourceOperator==='contains'&&compareVal1.indexOf(compareValArr[i].trim())>=0){replaceDynamicTarget(item,sourceValFound,item.TargetDefault);foundMatch=true;break;}else if(item.SourceOperator==='starts_with'&&compareVal1.indexOf(compareValArr[i].trim())===0){replaceDynamicTarget(item,sourceValFound,item.TargetDefault);foundMatch=true;break;}else if(item.SourceOperator==='ends_with'&&compareVal1.indexOf(compareValArr[i].trim(),compareVal1.length-compareValArr[i].trim().length)!==-1){replaceDynamicTarget(item,sourceValFound,item.TargetDefault);foundMatch=true;break;}}}
if(!foundMatch&&item.TargetDefault!==''){replaceDynamicTarget(item,'',item.TargetDefault);}}else if(item.SourceOperator.indexOf('not_')===0){var foundMatch=false;for(var i=0;i<compareValArr.length;i++){if(compareValArr[i].trim()!==''){if(item.SourceOperator==='not_equals'&&compareVal1===compareValArr[i].trim()){foundMatch=true;break;}else if(item.SourceOperator==='not_contains'&&compareVal1.contains(compareValArr[i].trim())){foundMatch=true;break;}else if(item.SourceOperator==='not_starts_with'&&compareVal1.indexOf(compareValArr[i].trim())===0){foundMatch=true;break;}else if(item.SourceOperator==='not_ends_with'&&compareVal1.indexOf(compareValArr[i].trim(),compareVal1.length-compareValArr[i].trim().length)!==-1){foundMatch=true;break;}}}
if(!foundMatch){replaceDynamicTarget(item,sourceValFound,item.TargetDefault);}
if(foundMatch&&item.TargetDefault!==''){replaceDynamicTarget(item,'',item.TargetDefault);}}}else if(item.TargetDefault!==''){replaceDynamicTarget(item,'',item.TargetDefault);}}
catch(e){BOX_CUSTOM_JS.logError(e,'runDynamicSourceComparison');}}
function replaceDynamicTarget(item,srcval,target_default){try{if(item.TargetType==='merge')
replaceDynamicTargetMerge(item,srcval,target_default);else if(item.TargetType.contains('_custom'))
replaceDynamicTargetCustomField(item,srcval,target_default);else
replaceDynamicTargetElement(item,srcval,target_default);}
catch(e){BOX_CUSTOM_JS.logError(e,'replaceDynamicTarget');}}
function replaceDynamicTargetMerge(item,srcval,target_default){try{var val=item.TargetValue||'';if(val==='[SOURCE]'&&typeof srcval==='string'&&srcval!=='')
val=srcval;else if(val==='[SOURCE]'&&(typeof srcval!=='string'||srcval===''))
val=target_default||'';else if(!srcval||!val)
val=target_default||'';if(!val)
return;$('div:contains("'+item.TargetMerge+'")').each(function(){if($(this).children().length<1||($(this).children('a').length+$(this).children('br').length)===$(this).children().length){$(this).html($(this).html().split(item.TargetMerge).join(val));}
else if($(this).children().length<2&&$(this).find('a').length===0&&$(this).find('button').length===0&&$(this).find('*').length<2){$(this).html($(this).html().split(item.TargetMerge).join(val));}});$('span:contains("'+item.TargetMerge+'")').each(function(){if($(this).children().length<1||($(this).children('a').length+$(this).children('br').length)===$(this).children().length){$(this).html($(this).html().split(item.TargetMerge).join(val));}});$('p:contains("'+item.TargetMerge+'")').each(function(){if($(this).children().length<1||($(this).children('a').length+$(this).children('br').length)===$(this).children().length){$(this).html($(this).html().split(item.TargetMerge).join(val));}});$('style:contains("'+item.TargetMerge+'")').each(function(){if($(this).children().length<1){$(this).html($(this).html().split(item.TargetMerge).join(val));}});$('button:contains("'+item.TargetMerge+'")').each(function(){if($(this).children().length<1){$(this).html($(this).html().split(item.TargetMerge).join(val));}});$('img').each(function(){if($(this).attr('src')&&$(this).attr('src').contains(item.TargetMerge)){$(this).attr('src',$(this).attr('src').split(item.TargetMerge).join(val));}});$('input,textarea').each(function(){if($(this).val()&&$(this).val().contains(item.TargetMerge)){$(this).val($(this).val().split(item.TargetMerge).join(val));}
if(typeof $(this).attr('placeholder')==='string'&&$(this).attr('placeholder').contains(item.TargetMerge)){$(this).attr('placeholder',$(this).attr('placeholder').split(item.TargetMerge).join(val));}});$('select option').each(function(){if($(this).val()&&$(this).val().contains(item.TargetMerge)){$(this).val($(this).val().split(item.TargetMerge).join(val));}
if($(this).text()&&$(this).text().contains(item.TargetMerge)){$(this).text($(this).text().split(item.TargetMerge).join(val));}});for(var j=1;j<=6;j++){var pref='';if(j<=4){pref='ep'+j+'_';}else if(j==5){pref='thx_';}else if(j==6){pref='';}
if(settings.hasOwnProperty(pref+'form')&&settings[pref+'form'].redirect_url&&settings[pref+'form'].redirect_url.contains(item.TargetMerge)){settings[pref+'form'].redirect_url=settings[pref+'form'].redirect_url.split(item.TargetMerge).join(val);}
if(settings.hasOwnProperty(pref+'name')&&settings[pref+'name'].hasOwnProperty("error_text")&&settings[pref+'name'].error_text&&settings[pref+'name'].error_text.contains(item.TargetMerge)){settings[pref+'name'].error_text=settings[pref+'name'].error_text.split(item.TargetMerge).join(val);}
if(settings.hasOwnProperty(pref+'name')&&settings[pref+'name'].label&&settings[pref+'name'].label.contains(item.TargetMerge)){settings[pref+'name'].label=settings[pref+'name'].label.split(item.TargetMerge).join(val);}
if(settings.hasOwnProperty(pref+'name')&&settings[pref+'name'].placeholder_full&&settings[pref+'name'].placeholder_full.contains(item.TargetMerge)){settings[pref+'name'].placeholder_full=settings[pref+'name'].placeholder_full.split(item.TargetMerge).join(val);}
if(settings.hasOwnProperty(pref+'name')&&settings[pref+'name'].placeholder_first&&settings[pref+'name'].placeholder_first.contains(item.TargetMerge)){settings[pref+'name'].placeholder_first=settings[pref+'name'].placeholder_first.split(item.TargetMerge).join(val);}
if(settings.hasOwnProperty(pref+'name')&&settings[pref+'name'].placeholder_last&&settings[pref+'name'].placeholder_last.contains(item.TargetMerge)){settings[pref+'name'].placeholder_last=settings[pref+'name'].placeholder_last.split(item.TargetMerge).join(val);}
if(settings.hasOwnProperty(pref+'name')&&settings[pref+'name'].help_full&&settings[pref+'name'].help_full.contains(item.TargetMerge)){settings[pref+'name'].help_full=settings[pref+'name'].help_full.split(item.TargetMerge).join(val);}
if(settings.hasOwnProperty(pref+'name')&&settings[pref+'name'].help_first&&settings[pref+'name'].help_first.contains(item.TargetMerge)){settings[pref+'name'].help_first=settings[pref+'name'].help_first.split(item.TargetMerge).join(val);}
if(settings.hasOwnProperty(pref+'name')&&settings[pref+'name'].help_last&&settings[pref+'name'].help_last.contains(item.TargetMerge)){settings[pref+'name'].help_last=settings[pref+'name'].help_last.split(item.TargetMerge).join(val);}
if(settings.hasOwnProperty(pref+'name')&&settings[pref+'name'].default_full&&settings[pref+'name'].default_full.contains(item.TargetMerge)){settings[pref+'name'].default_full=settings[pref+'name'].default_full.split(item.TargetMerge).join(val);}
if(settings.hasOwnProperty(pref+'name')&&settings[pref+'name'].default_first&&settings[pref+'name'].default_first.contains(item.TargetMerge)){settings[pref+'name'].default_first=settings[pref+'name'].default_first.split(item.TargetMerge).join(val);}
if(settings.hasOwnProperty(pref+'name')&&settings[pref+'name'].default_last&&settings[pref+'name'].default_last.contains(item.TargetMerge)){settings[pref+'name'].default_last=settings[pref+'name'].default_last.split(item.TargetMerge).join(val);}
if(settings.hasOwnProperty(pref+'email')&&settings[pref+'email'].hasOwnProperty("error_text")&&settings[pref+'email'].error_text&&settings[pref+'email'].error_text.contains(item.TargetMerge)){settings[pref+'email'].error_text=settings[pref+'email'].error_text.split(item.TargetMerge).join(val);}
if(settings.hasOwnProperty(pref+'email')&&settings[pref+'email'].label&&settings[pref+'email'].label.contains(item.TargetMerge)){settings[pref+'email'].label=settings[pref+'email'].label.split(item.TargetMerge).join(val);}
if(settings.hasOwnProperty(pref+'email')&&settings[pref+'email'].placeholder&&settings[pref+'email'].placeholder.contains(item.TargetMerge)){settings[pref+'email'].placeholder=settings[pref+'email'].placeholder.split(item.TargetMerge).join(val);}
if(settings.hasOwnProperty(pref+'email')&&settings[pref+'email'].help&&settings[pref+'email'].help.contains(item.TargetMerge)){settings[pref+'email'].help=settings[pref+'email'].help.split(item.TargetMerge).join(val);}
if(settings.hasOwnProperty(pref+'email')&&settings[pref+'email'].default&&settings[pref+'email'].default.contains(item.TargetMerge)){settings[pref+'email'].default=settings[pref+'email'].default.split(item.TargetMerge).join(val);}
if(settings.hasOwnProperty(pref+'phone')&&settings[pref+'phone'].hasOwnProperty("error_text")&&settings[pref+'phone'].error_text&&settings[pref+'phone'].error_text.contains(item.TargetMerge)){settings[pref+'phone'].error_text=settings[pref+'phone'].error_text.split(item.TargetMerge).join(val);}
if(settings.hasOwnProperty(pref+'phone')&&settings[pref+'phone'].label&&settings[pref+'phone'].label.contains(item.TargetMerge)){settings[pref+'phone'].label=settings[pref+'phone'].label.split(item.TargetMerge).join(val);}
if(settings.hasOwnProperty(pref+'phone')&&settings[pref+'phone'].placeholder&&settings[pref+'phone'].placeholder.contains(item.TargetMerge)){settings[pref+'phone'].placeholder=settings[pref+'phone'].placeholder.split(item.TargetMerge).join(val);}
if(settings.hasOwnProperty(pref+'phone')&&settings[pref+'phone'].help&&settings[pref+'phone'].help.contains(item.TargetMerge)){settings[pref+'phone'].help=settings[pref+'phone'].help.split(item.TargetMerge).join(val);}
if(settings.hasOwnProperty(pref+'phone')&&settings[pref+'phone'].default&&settings[pref+'phone'].default.contains(item.TargetMerge)){settings[pref+'phone'].default=settings[pref+'phone'].default.split(item.TargetMerge).join(val);}
if(settings.hasOwnProperty(pref+'opt_in')&&settings[pref+'opt_in'].hasOwnProperty("error_text")&&settings[pref+'opt_in'].error_text&&settings[pref+'opt_in'].error_text.contains(item.TargetMerge)){settings[pref+'opt_in'].error_text=settings[pref+'opt_in'].error_text.split(item.TargetMerge).join(val);}
if(settings.hasOwnProperty(pref+'opt_in')&&settings[pref+'opt_in'].text&&settings[pref+'opt_in'].text.contains(item.TargetMerge)){settings[pref+'opt_in'].text=settings[pref+'opt_in'].text.split(item.TargetMerge).join(val);}
for(var i=1;i<=10;i++){var pr=pref;if(pr.indexOf('_')>0){pr=pr.split('_')[0];}
if(settings.hasOwnProperty(pr+'button'+i)&&settings[pr+'button'+i].url&&settings[pr+'button'+i].url.contains(item.TargetMerge)){settings[pr+'button'+i].url=settings[pr+'button'+i].url.split(item.TargetMerge).join(val);}}
for(var i=1;i<=20;i++){var propName=pref+'custom'+i;if(settings.hasOwnProperty(propName)){if(settings[propName].hasOwnProperty("error_text")&&settings[propName].error_text&&settings[propName].error_text.contains(item.TargetMerge)){settings[propName].error_text=settings[propName].error_text.split(item.TargetMerge).join(val);}
if(settings[propName].label&&settings[propName].label.contains(item.TargetMerge)){settings[propName].label=settings[propName].label.split(item.TargetMerge).join(val);}
if(settings[propName].placeholder&&settings[propName].placeholder.contains(item.TargetMerge)){settings[propName].placeholder=settings[propName].placeholder.split(item.TargetMerge).join(val);}
if(settings[propName].help&&settings[propName].help.contains(item.TargetMerge)){settings[propName].help=settings[propName].help.split(item.TargetMerge).join(val);}
if(settings[propName].default&&settings[propName].default.contains(item.TargetMerge)){settings[propName].default=settings[propName].default.split(item.TargetMerge).join(val);}}}}}
catch(e){BOX_CUSTOM_JS.logError(e,'replaceDynamicTargetMerge');}}
function replaceDynamicTargetElement(item,srcval,target_default){try{var val=item.TargetValue||'';if(val==='[SOURCE]'&&typeof srcval==='string'&&srcval!=='')
val=srcval;else if(val==='[SOURCE]'&&(typeof srcval!=='string'||srcval===''))
val=target_default||'';else if(!srcval||!val)
val=target_default||'';if(!val)
return;var ele=item.TargetType;if(ele.indexOf('main_')===0)
ele=ele.split('_')[1];else
ele=ele.split('_').join('');var ptn=$('#'+ele).attr('id');if(settings.hasOwnProperty(ptn)&&settings[ptn].display){if(ele.indexOf('image')>=0){if(typeof val==='string'&&val.indexOf('://')>0){image_dims[ptn+'_dynamic']={width:100,height:100};var img=new Image();img.onload=function(){image_dims[ptn+'_dynamic'].width=this.width;image_dims[ptn+'_dynamic'].height=this.height;resizeImage(image_dims[ptn+'_dynamic'],$('#'+ptn+'_wrapper'),$('#'+ptn),ptn,settings[ptn].width,settings[ptn].height,true);$('#'+ptn+'_wrapper').show();};ImageSrcMap[ptn+'_dynamic']={img_obj:img,img_src:val,img_element:$('#'+ptn)};ImageSrcMap[ptn+'_dynamic'].img_element.attr('src',ImageSrcMap[ptn+'_dynamic'].img_src);ImageSrcMap[ptn+'_dynamic'].img_obj.src=ImageSrcMap[ptn+'_dynamic'].img_src;}}else{$('#'+ele).html(val);}}}
catch(e){BOX_CUSTOM_JS.logError(e,'replaceDynamicTargetElement');}}
function replaceDynamicTargetCustomField(item,srcval,target_default){try{var val=item.TargetValue||'';if(val==='[SOURCE]'&&typeof srcval==='string'&&srcval!=='')
val=srcval;else if(val==='[SOURCE]'&&(typeof srcval!=='string'||srcval===''))
val=target_default||'';else if(!srcval||!val)
val=target_default||'';if(!val)
return;var field=item.TargetType;if(field.indexOf('main_')===0)
field='form_input_'+field.split('_')[1];else
field=field.split('_')[0]+'_form_input_'+field.split('_')[1];$('#'+field).val(val);}
catch(e){BOX_CUSTOM_JS.logError(e,'replaceDynamicTargetCustomField');}}
function buildCouponsDisplay(){findCouponsOnPages('display');}
function buildCouponsSubmit(){findCouponsOnPages('submit');}
function findCouponsOnPages(couponPopulateOn){try{var mtags=[];$('div:contains("[COUPON_")').each(function(){if($(this).children().length<1||($(this).children('a').length+$(this).children('br').length)===$(this).children().length){var cgidParts=$(this).html().split('[COUPON_');if(cgidParts.length>1){for(var i=1;i<cgidParts.length;i++){if(cgidParts[i].contains(']')){var cgid=cgidParts[i].split(']')[0];if(cgid&&!mtags.contains(cgid)){mtags.push(cgid);}}}}}});$('button:contains("[COUPON_")').each(function(){if($(this).children().length<1){var cgidParts=$(this).html().split('[COUPON_');if(cgidParts.length>1){for(var i=1;i<cgidParts.length;i++){if(cgidParts[i].contains(']')){var cgid=cgidParts[i].split(']')[0];if(cgid&&!mtags.contains(cgid)){mtags.push(cgid);}}}}}});$('input,select,textarea').each(function(){if($(this).val().contains('[COUPON_')){var cgidParts=$(this).val().split('[COUPON_');if(cgidParts.length>1){for(var i=1;i<cgidParts.length;i++){if(cgidParts[i].contains(']')){var cgid=cgidParts[i].split(']')[0];if(cgid&&!mtags.contains(cgid)){mtags.push(cgid);}}}}}});logger('(BOX #'+LIGHTBOX_SHORT_ID+') - findCouponsOnPages: '+couponPopulateOn);logger('mtags ==>');logger(mtags);if(mtags.length>0){for(var i=0;i<mtags.length;i++){if(couponPopulateOn==='display'){if(parent.DIGIOH_API.hasOwnProperty('COUPON_GROUP_POPULATE_OBJ')&&parent.DIGIOH_API.COUPON_GROUP_POPULATE_OBJ.hasOwnProperty(mtags[i])&&parent.DIGIOH_API.COUPON_GROUP_POPULATE_OBJ[mtags[i]]==='submit'&&!COUPONS_FOR_SUBMIT.hasOwnProperty(mtags[i])){COUPONS_FOR_SUBMIT[mtags[i]]=false;}else if(!parent.DIGIOH_API.hasOwnProperty('COUPON_GROUP_POPULATE_OBJ')||!parent.DIGIOH_API.COUPON_GROUP_POPULATE_OBJ.hasOwnProperty(mtags[i])){COUPONS_FOR_SUBMIT[mtags[i]]=false;}}
if(parent.DIGIOH_API.hasOwnProperty('COUPON_GROUP_POPULATE_OBJ')){if(parent.DIGIOH_API.COUPON_GROUP_POPULATE_OBJ.hasOwnProperty(mtags[i])){if(parent.DIGIOH_API.COUPON_GROUP_POPULATE_OBJ[mtags[i]]===couponPopulateOn){insertCouponCodeAsync(mtags[i],couponPopulateOn,'1');logger('(BOX #'+LIGHTBOX_SHORT_ID+') - findCouponsOnPages: '+couponPopulateOn+' ('+mtags[i]+') section 1');}}else if(couponPopulateOn==='submit'){insertCouponCodeAsync(mtags[i],couponPopulateOn,'2');logger('(BOX #'+LIGHTBOX_SHORT_ID+') - findCouponsOnPages: '+couponPopulateOn+' ('+mtags[i]+') section 2');}}else if(couponPopulateOn==='submit'){insertCouponCodeAsync(mtags[i],couponPopulateOn,'3');logger('(BOX #'+LIGHTBOX_SHORT_ID+') - findCouponsOnPages: '+couponPopulateOn+' ('+mtags[i]+') section 3');}else{logger('(BOX #'+LIGHTBOX_SHORT_ID+') - findCouponsOnPages: '+couponPopulateOn+' ('+mtags[i]+') section 4 - no match');}}}
logger('COUPONS_FOR_SUBMIT ==>');logger(COUPONS_FOR_SUBMIT);}
catch(e){BOX_CUSTOM_JS.logError(e,'findCouponsOnPages');}}
function insertCouponCodeAsync(coupon_group_id,populate_on,code_section_trigger){try{var couponApiUrl='https://coupon.lightboxcdn.com/Coupon/GetCoupon?user_id='+VENDOR_SHORT_ID+'&coupon_group_id='+coupon_group_id+'&client_id='+CLIENT_GUID;if(COUPONS_FOR_DISPLAY.hasOwnProperty(coupon_group_id)&&COUPONS_FOR_DISPLAY[coupon_group_id]){var couponText=COUPONS_FOR_DISPLAY[coupon_group_id];$('div:contains("[COUPON_'+coupon_group_id+']")').each(function(){if($(this).children().length<1||($(this).children('a').length+$(this).children('br').length)===$(this).children().length){$(this).html($(this).html().split('[COUPON_'+coupon_group_id+']').join(couponText));}});$('button:contains("[COUPON_'+coupon_group_id+']")').each(function(){if($(this).children().length<1){$(this).html($(this).html().split('[COUPON_'+coupon_group_id+']').join(couponText));}});$('input,select,textarea').each(function(){if($(this).val().contains("[COUPON_"+coupon_group_id+"]")){$(this).val($(this).val().split("[COUPON_"+coupon_group_id+"]").join(couponText));}});}
else{$.ajax({dataType:'jsonp',url:couponApiUrl,success:function(data){if(data&&typeof data==='object'&&data!==null&&data.hasOwnProperty('success')&&data.success){if(data.hasOwnProperty('payload')){logger('(BOX #'+LIGHTBOX_SHORT_ID+') - GetCoupon: SUCCESS ==>');logger(data);var couponText=data.payload;COUPONS_FOR_DISPLAY[coupon_group_id]=couponText;$('div:contains("[COUPON_'+coupon_group_id+']")').each(function(){if($(this).children().length<1||($(this).children('a').length+$(this).children('br').length)===$(this).children().length){$(this).html($(this).html().split('[COUPON_'+coupon_group_id+']').join(couponText));}});$('button:contains("[COUPON_'+coupon_group_id+']")').each(function(){if($(this).children().length<1){$(this).html($(this).html().split('[COUPON_'+coupon_group_id+']').join(couponText));}});$('input,select,textarea').each(function(){if($(this).val().contains("[COUPON_"+coupon_group_id+"]")){$(this).val($(this).val().split("[COUPON_"+coupon_group_id+"]").join(couponText));}});postMessageCouponUsed(coupon_group_id,data,'success',populate_on,code_section_trigger,'1',CURRENT_PAGE);}else{postMessageCouponUsed(coupon_group_id,data,'failure',populate_on,code_section_trigger,'2',CURRENT_PAGE);logger('(BOX #'+LIGHTBOX_SHORT_ID+') - GetCoupon: FAILURE 2 ==>');logger(data);}}else if(data&&typeof data==='object'&&data!==null){postMessageCouponUsed(coupon_group_id,data,'failure',populate_on,code_section_trigger,'3',CURRENT_PAGE);logger('(BOX #'+LIGHTBOX_SHORT_ID+') - GetCoupon: FAILURE 3 ==>');logger(data);}else{postMessageCouponUsed(coupon_group_id,'null','failure',populate_on,code_section_trigger,'4',CURRENT_PAGE);logger('(BOX #'+LIGHTBOX_SHORT_ID+') - GetCoupon: FAILURE 4 ==>');logger(data);}
if(COUPONS_FOR_SUBMIT.hasOwnProperty(coupon_group_id)){COUPONS_FOR_SUBMIT[coupon_group_id]=true;}},error:function(htmltext,textStatus,errorThrown){if(COUPONS_FOR_SUBMIT.hasOwnProperty(coupon_group_id)){COUPONS_FOR_SUBMIT[coupon_group_id]=true;}
postMessageCouponUsed(coupon_group_id,{textStatus:textStatus},'error',populate_on,code_section_trigger,'5',CURRENT_PAGE);logger('(BOX #'+LIGHTBOX_SHORT_ID+') - GetCoupon: FAILURE 5 ==>');logger(textStatus);BOX_CUSTOM_JS.logError(errorThrown,'insertCouponCodeAsync');}});}}
catch(e){BOX_CUSTOM_JS.logError(e,'insertCouponCodeAsync');}}
function replaceHrefMergeTags(){try{$('div:contains("[[LINK|"),p:contains("[[LINK|"),span:contains("[[LINK|")').each(function(){if($(this).children().length<1||($(this).children('a').length+$(this).children('br').length)===$(this).children().length){var divParts=$(this).html().split('[[LINK|');if(divParts.length>1){for(var i=1;i<divParts.length;i++){if(divParts[i].contains(']]')){var divLink=divParts[i].split(']]')[0].split('|')[0];var divText='';var divStyle='';var divReplace='[[LINK|'+divLink+']]';if(divParts[i].split(']]')[0].split('|').length>1){divText=divParts[i].split(']]')[0].split('|')[1];divReplace='[[LINK|'+divLink+'|'+divText+']]';}
if(divParts[i].split(']]')[0].split('|').length>2){divStyle=divParts[i].split(']]')[0].split('|')[2];divReplace='[[LINK|'+divLink+'|'+divText+'|'+divStyle+']]';}
if(divText.length<1){divText=divLink;}
if(!divLink.contains('://')){divLink='https://'+divLink;}
$(this).html($(this).html().split(divReplace).join("<a target='_blank' href='"+divLink+"' style='"+divStyle+"'>"+divText+"</a>"));}}}}});}
catch(e){BOX_CUSTOM_JS.logError(e,'replaceHrefMergeTags');}}
function replaceBrMergeTags(){try{$('div:contains("[[BR]]"),p:contains("[[BR]]"),span:contains("[[BR]]")').each(function(){if($(this).children().length<1||($(this).children('a').length+$(this).children('br').length)===$(this).children().length){var divParts=$(this).html().split('[[BR]]');if(divParts.length>1){$(this).html(divParts.join('<br>'));}}});}
catch(e){BOX_CUSTOM_JS.logError(e,'replaceBrMergeTags');}}
function showLoading(pref){var modal_width=0;var modal_height=0;if(CURRENT_WIDTH&&CURRENT_HEIGHT){modal_width=CURRENT_WIDTH;modal_height=CURRENT_HEIGHT;}else if(pref==='thx_'&&settings.hasOwnProperty('thxlayout')){modal_width=settings.thxlayout.width;modal_height=settings.thxlayout.height;}else if(pref==='ep1_'&&settings.hasOwnProperty('ep1layout')){modal_width=settings.ep1layout.width;modal_height=settings.ep1layout.height;}else if(pref==='ep2_'&&settings.hasOwnProperty('ep2layout')){modal_width=settings.ep2layout.width;modal_height=settings.ep2layout.height;}else if(pref==='ep3_'&&settings.hasOwnProperty('ep3layout')){modal_width=settings.ep3layout.width;modal_height=settings.ep3layout.height;}else if(pref==='ep4_'&&settings.hasOwnProperty('ep4layout')){modal_width=settings.ep4layout.width;modal_height=settings.ep4layout.height;}else{modal_width=settings.layout.width;modal_height=settings.layout.height;}
$('#modal_loading_spinner').css('left',((Math.round(modal_width/2)-10)+'px'));$('#modal_loading_spinner').css('top',((Math.round(modal_height/2)-10)+'px'));body.addClass('loading');}
function hideLoading(){body.removeClass('loading');}
function determineGoogleFonts(){var pref='';for(var i=1;i<=6;i++){if(i===1){pref='';}else if(i===2){pref='thx';}else if(i===3){pref='ep1';}else if(i===4){pref='ep2';}else if(i===5){pref='ep3';}else if(i===6){pref='ep4';}
for(var x=1;x<=10;x++){if(settings.hasOwnProperty(pref+'text'+x)&&settings[pref+'text'+x].display)addGoogleFontToStack(settings[pref+'text'+x].font.family);if(settings.hasOwnProperty(pref+'button'+x)&&settings[pref+'button'+x].display)addGoogleFontToStack(settings[pref+'button'+x].font.family);if(settings.hasOwnProperty(pref+'button'+x)&&settings[pref+'button'+x].display)addGoogleFontToStack(settings[pref+'button'+x].font_hover.family);if(settings.hasOwnProperty(pref+'button'+x)&&settings[pref+'button'+x].display)addGoogleFontToStack(settings[pref+'button'+x].font_focus.family);}}
loadGoogleFontsFromStack();}
function loadExternalFonts(pref){try{if(typeof pref!=='string'||pref==='main'){pref='';}
if(pref.contains('_')){pref=pref.split('_')[0];}
if(pref!==''&&!LoadedCustomFonts.hasOwnProperty(pref)){LoadedCustomFonts[pref]=true;}else if(LoadedCustomFonts.hasOwnProperty(pref)&&LoadedCustomFonts[pref]===true){return;}
logger('loadExternalFonts('+pref+')');for(var x=1;x<=10;x++){if(settings.hasOwnProperty(pref+'text'+x)&&settings[pref+'text'+x].display)addCustomFontToStack(settings[pref+'text'+x].font.family);if(settings.hasOwnProperty(pref+'button'+x)&&settings[pref+'button'+x].display)addCustomFontToStack(settings[pref+'button'+x].font.family);if(settings.hasOwnProperty(pref+'button'+x)&&settings[pref+'button'+x].display)addCustomFontToStack(settings[pref+'button'+x].font_hover.family);if(settings.hasOwnProperty(pref+'button'+x)&&settings[pref+'button'+x].display)addCustomFontToStack(settings[pref+'button'+x].font_focus.family);}
var pr=pref;if(pr!=='')
pr=pr+'_';if(settings.hasOwnProperty(pr+'labels'))
addCustomFontToStack(settings[pr+'labels'].font.family);if(settings.hasOwnProperty(pr+'inputs'))
addCustomFontToStack(settings[pr+'inputs'].font.family);}
catch(e){BOX_CUSTOM_JS.logError(e,'loadExternalFonts');}}
function addCustomFontToStack(f){try{if(f.indexOf('__custom__')>=0&&f.indexOf('||||')>=0){var font_parts=f.split('||||');var font_name=font_parts[1];var font_guid=font_parts[2];var font_url=PROTOCOL_USER_OVERRIDE+'s3.lightboxcdn.com/custom_fonts/'+font_guid+'.css'+'?cb='+CACHE_VERSION;if($.inArray(font_name,basic_fonts)===-1&&$.inArray(font_name,custom_fonts)===-1){custom_fonts.push(font_name);var h=document.head||document.getElementsByTagName('head')[0];var l=document.createElement('link');l.type='text/css';l.rel='stylesheet';l.href=font_url;h.appendChild(l);}}}
catch(e){BOX_CUSTOM_JS.logError(e,'addCustomFontToStack');}}
function addGoogleFontToStack(f){try{var font_name='';if(f.indexOf('__google__')>=0){font_name=f.replace('__google__','').split("'")[1];}else if(f&&f.indexOf('__custom__')===-1&&f.length>10&&$.inArray(f,basic_fonts)===-1){font_name=f.split("'")[1];}
if(font_name&&font_name.length>1&&$.inArray(font_name,google_fonts)===-1){google_fonts.push(font_name);}}
catch(e){BOX_CUSTOM_JS.logError(e,'addGoogleFontToStack');}}
function loadGoogleFontsFromStack(){try{if(google_fonts.length>0){var font_builder='https://fonts.googleapis.com/css?family=';var font_fam='';for(var i=0;i<google_fonts.length;i++){font_fam=google_fonts[i];if(font_fam.indexOf(' ')>0){font_fam=font_fam.split(' ').join('+');}
font_builder+=font_fam;if(i<(google_fonts.length-1)){font_builder+='|';}}
var h=document.head||document.getElementsByTagName('head')[0];var l=document.createElement('link');l.type='text/css';l.rel='stylesheet';l.href=font_builder+'&display=fallback';h.appendChild(l);}}
catch(e){BOX_CUSTOM_JS.logError(e,'loadGoogleFontsFromStack');}}
function buildText(){try{for(var y=1;y<=6;y++){var pr='';if(y===5)pr='thx';else if(y===6)pr='';else pr='ep'+y;for(var x=1;x<=10;x++){if(settings.hasOwnProperty(pr+'text'+x)&&settings[pr+'text'+x].display){$('#'+pr+'text'+x).text(settings[pr+'text'+x].text);if(settings[pr+'text'+x].hasOwnProperty('metadata_kvps')){for(var k=0;k<settings[pr+'text'+x].metadata_kvps.length;k++){if(settings[pr+'text'+x].metadata_kvps[k].k&&settings[pr+'text'+x].metadata_kvps[k].v){if(settings[pr+'text'+x].metadata_kvps[k].k==='class'){$('#'+pr+'text'+x).addClass(settings[pr+'text'+x].metadata_kvps[k].v);}else{$('#'+pr+'text'+x).attr(settings[pr+'text'+x].metadata_kvps[k].k,settings[pr+'text'+x].metadata_kvps[k].v);}}}}}}}}
catch(e){BOX_CUSTOM_JS.logError(e,'buildText');}}
function appendScript(scriptHtml){try{var j=document.createElement('script');j.type='text/javascript';j.async=true;j.text=scriptHtml;document.body.appendChild(j);}
catch(e){BOX_CUSTOM_JS.logError(e,'appendScript');}}
function buildHTMLItemAndEvalJSFromHtml(htmlEle,htmlId){try{if(!settings.hasOwnProperty(htmlId)||!settings[htmlId]||!settings[htmlId].hasOwnProperty('display')||!settings[htmlId].hasOwnProperty('html')||!settings[htmlId].display||!settings[htmlId].html){return;}
else if(settings[htmlId].html.indexOf("script")===-1){htmlEle.html(settings[htmlId].html);}
else{var htmlElement=document.getElementById(htmlId);htmlElement.innerHTML=settings[htmlId].html;var scripts=htmlElement.getElementsByTagName("script");for(var i=0;i<scripts.length;++i){var script=scripts[i];if(script.innerHTML&&script.innerHTML.length>0){eval(script.innerHTML);}else if(script.hasAttribute("src")){var elSrc=script.getAttribute("src");if(typeof elSrc==='string'&&elSrc.indexOf('//')>=0){var elRef=document.createElement('script');elRef.setAttribute("type","text/javascript");elRef.setAttribute("src",elSrc);elRef.async=true;document.getElementsByTagName("head")[0].appendChild(elRef);}}}}}
catch(e){BOX_CUSTOM_JS.logError(e,'buildHTMLItemAndEvalJSFromHtml');}}
function buildHTML(){try{for(var y=1;y<=6;y++){var pr='';if(y===5)pr='thx';else if(y===6)pr='';else pr='ep'+y;for(var x=1;x<=10;x++){if(settings.hasOwnProperty(pr+'html'+x)&&settings[pr+'html'+x].display){buildHTMLItemAndEvalJSFromHtml($('#'+pr+'html'+x),pr+'html'+x);if(settings[pr+'html'+x].hasOwnProperty('metadata_kvps')){for(var k=0;k<settings[pr+'html'+x].metadata_kvps.length;k++){if(settings[pr+'html'+x].metadata_kvps[k].k&&settings[pr+'html'+x].metadata_kvps[k].v){if(settings[pr+'html'+x].metadata_kvps[k].k==='class'){$('#'+pr+'html'+x).addClass(settings[pr+'html'+x].metadata_kvps[k].v);}else{$('#'+pr+'html'+x).attr(settings[pr+'html'+x].metadata_kvps[k].k,settings[pr+'html'+x].metadata_kvps[k].v);}}}}}}}}
catch(e){BOX_CUSTOM_JS.logError(e,'buildHTML');}}
function buildForm(){try{using_form=settings.hasOwnProperty('form')&&settings.form.display;using_form_thx=settings.hasOwnProperty('thxlayout')&&settings.hasOwnProperty('thx_form')&&settings.thx_form.display;using_form_ep1=settings.hasOwnProperty('ep1layout')&&settings.hasOwnProperty('ep1_form')&&settings.ep1_form.display;using_form_ep2=settings.hasOwnProperty('ep2layout')&&settings.hasOwnProperty('ep2_form')&&settings.ep2_form.display;using_form_ep3=settings.hasOwnProperty('ep3layout')&&settings.hasOwnProperty('ep3_form')&&settings.ep3_form.display;using_form_ep4=settings.hasOwnProperty('ep4layout')&&settings.hasOwnProperty('ep4_form')&&settings.ep4_form.display;if(using_form){form.empty();buildFormName('',form);buildFormEmail('',form);buildFormPhone('',form);for(var i=1;i<=20;i++){buildFormCustomN('','custom'+i,form);}
buildFormOptIn('',form);}
if(using_form_thx){thx_form.empty();buildFormName('thx',thx_form);buildFormEmail('thx',thx_form);buildFormPhone('thx',thx_form);for(var i=1;i<=20;i++){buildFormCustomN('thx','thx_custom'+i,thx_form);}
buildFormOptIn('thx',thx_form);}
if(using_form_ep1){ep1_form.empty();buildFormName('ep1',ep1_form);buildFormEmail('ep1',ep1_form);buildFormPhone('ep1',ep1_form);for(var i=1;i<=20;i++){buildFormCustomN('ep1','ep1_custom'+i,ep1_form);}
buildFormOptIn('ep1',ep1_form);}
if(using_form_ep2){ep2_form.empty();buildFormName('ep2',ep2_form);buildFormEmail('ep2',ep2_form);buildFormPhone('ep2',ep2_form);for(var i=1;i<=20;i++){buildFormCustomN('ep2','ep2_custom'+i,ep2_form);}
buildFormOptIn('ep2',ep2_form);}
if(using_form_ep3){ep3_form.empty();buildFormName('ep3',ep3_form);buildFormEmail('ep3',ep3_form);buildFormPhone('ep3',ep3_form);for(var i=1;i<=20;i++){buildFormCustomN('ep3','ep3_custom'+i,ep3_form);}
buildFormOptIn('ep3',ep3_form);}
if(using_form_ep4){ep4_form.empty();buildFormName('ep4',ep4_form);buildFormEmail('ep4',ep4_form);buildFormPhone('ep4',ep4_form);for(var i=1;i<=20;i++){buildFormCustomN('ep4','ep4_custom'+i,ep4_form);}
buildFormOptIn('ep4',ep4_form);}
if(!using_form&&$('#form_wrapper').length){form_wrapper.hide();form.hide();}
if(!using_form_thx&&$('#thx_form_wrapper').length){thx_form_wrapper.hide();thx_form.hide();}
if(!using_form_ep1&&$('#ep1_form_wrapper').length){ep1_form_wrapper.hide();ep1_form.hide();}
if(!using_form_ep2&&$('#ep2_form_wrapper').length){ep2_form_wrapper.hide();ep2_form.hide();}
if(!using_form_ep3&&$('#ep3_form_wrapper').length){ep3_form_wrapper.hide();ep3_form.hide();}
if(!using_form_ep4&&$('#ep4_form_wrapper').length){ep4_form_wrapper.hide();ep4_form.hide();}
initFormInputs();}
catch(e){BOX_CUSTOM_JS.logError(e,'buildForm');}}
function buildButtons(){try{for(var y=1;y<=6;y++){var pr='';if(y===5)pr='thx';else if(y===6)pr='';else pr='ep'+y;for(var x=1;x<=10;x++){if(settings.hasOwnProperty(pr+'button'+x)&&settings[pr+'button'+x].display){if(pr===''){buildButtonN($('#'+pr+'button'+x),$('#'+pr+'button'+x+'_wrapper'),pr+'button'+x,settings[pr+'button'+x],'');}else{buildButtonN($('#'+pr+'button'+x),$('#'+pr+'button'+x+'_wrapper'),pr+'button'+x,settings[pr+'button'+x],pr+'_');}
if(settings[pr+'button'+x].hasOwnProperty('metadata_kvps')){for(var k=0;k<settings[pr+'button'+x].metadata_kvps.length;k++){if(settings[pr+'button'+x].metadata_kvps[k].k&&settings[pr+'button'+x].metadata_kvps[k].v){if(settings[pr+'button'+x].metadata_kvps[k].k==='class'){$('#'+pr+'button'+x).addClass(settings[pr+'button'+x].metadata_kvps[k].v);}else{$('#'+pr+'button'+x).attr(settings[pr+'button'+x].metadata_kvps[k].k,settings[pr+'button'+x].metadata_kvps[k].v);}}}}
if(typeof $('#'+pr+'button'+x).attr('aria-label')!=='string'||$('#'+pr+'button'+x).attr('aria-label').length<1){if(settings[pr+'button'+x].action=='submit'){$('#'+pr+'button'+x).attr('aria-label','Submit Modal Form');}else if(settings[pr+'button'+x].action=='close'){$('#'+pr+'button'+x).attr('aria-label','Close Modal');}else if(settings[pr+'button'+x].action=='url'){$('#'+pr+'button'+x).attr('aria-label','Redirect to URL');}else if(settings[pr+'button'+x].action=='download'){$('#'+pr+'button'+x).attr('aria-label','Download File');}else if(settings[pr+'button'+x].action=='lightbox_open'){$('#'+pr+'button'+x).attr('aria-label','Open Another Modal');}else if(settings[pr+'button'+x].action.indexOf('_page')>0){$('#'+pr+'button'+x).attr('aria-label','Open Next Modal Page');}}}}}}
catch(e){BOX_CUSTOM_JS.logError(e,'buildButtons');}}
function initFormInputs(){try{if($('#form_input_full_name').length)form_input_full_name=$('#form_input_full_name');if($('#form_input_first_name').length)form_input_first_name=$('#form_input_first_name');if($('#form_input_last_name').length)form_input_last_name=$('#form_input_last_name');if($('#form_input_email').length)form_input_email=$('#form_input_email');if($('#form_input_phone').length)form_input_phone=$('#form_input_phone');if($('#form_input_opt_in').length)form_input_opt_in=$('#form_input_opt_in');if($('#form_input_custom1').length)form_input_custom1=$('#form_input_custom1');if($('#form_input_custom2').length)form_input_custom2=$('#form_input_custom2');if($('#form_input_custom3').length)form_input_custom3=$('#form_input_custom3');if($('#form_input_custom4').length)form_input_custom4=$('#form_input_custom4');if($('#form_input_custom5').length)form_input_custom5=$('#form_input_custom5');if($('#form_input_custom6').length)form_input_custom6=$('#form_input_custom6');if($('#form_input_custom7').length)form_input_custom7=$('#form_input_custom7');if($('#form_input_custom8').length)form_input_custom8=$('#form_input_custom8');if($('#form_input_custom9').length)form_input_custom9=$('#form_input_custom9');if($('#form_input_custom10').length)form_input_custom10=$('#form_input_custom10');if($('#form_input_custom11').length)form_input_custom11=$('#form_input_custom11');if($('#form_input_custom12').length)form_input_custom12=$('#form_input_custom12');if($('#form_input_custom13').length)form_input_custom13=$('#form_input_custom13');if($('#form_input_custom14').length)form_input_custom14=$('#form_input_custom14');if($('#form_input_custom15').length)form_input_custom15=$('#form_input_custom15');if($('#form_input_custom16').length)form_input_custom16=$('#form_input_custom16');if($('#form_input_custom17').length)form_input_custom17=$('#form_input_custom17');if($('#form_input_custom18').length)form_input_custom18=$('#form_input_custom18');if($('#form_input_custom19').length)form_input_custom19=$('#form_input_custom19');if($('#form_input_custom20').length)form_input_custom20=$('#form_input_custom20');if($('#thx_form_input_full_name').length)thx_form_input_full_name=$('#thx_form_input_full_name');if($('#thx_form_input_first_name').length)thx_form_input_first_name=$('#thx_form_input_first_name');if($('#thx_form_input_last_name').length)thx_form_input_last_name=$('#thx_form_input_last_name');if($('#thx_form_input_email').length)thx_form_input_email=$('#thx_form_input_email');if($('#thx_form_input_phone').length)thx_form_input_phone=$('#thx_form_input_phone');if($('#thx_form_input_opt_in').length)thx_form_input_opt_in=$('#thx_form_input_opt_in');if($('#thx_form_input_custom1').length)thx_form_input_custom1=$('#thx_form_input_custom1');if($('#thx_form_input_custom2').length)thx_form_input_custom2=$('#thx_form_input_custom2');if($('#thx_form_input_custom3').length)thx_form_input_custom3=$('#thx_form_input_custom3');if($('#thx_form_input_custom4').length)thx_form_input_custom4=$('#thx_form_input_custom4');if($('#thx_form_input_custom5').length)thx_form_input_custom5=$('#thx_form_input_custom5');if($('#thx_form_input_custom6').length)thx_form_input_custom6=$('#thx_form_input_custom6');if($('#thx_form_input_custom7').length)thx_form_input_custom7=$('#thx_form_input_custom7');if($('#thx_form_input_custom8').length)thx_form_input_custom8=$('#thx_form_input_custom8');if($('#thx_form_input_custom9').length)thx_form_input_custom9=$('#thx_form_input_custom9');if($('#thx_form_input_custom10').length)thx_form_input_custom10=$('#thx_form_input_custom10');if($('#thx_form_input_custom11').length)thx_form_input_custom11=$('#thx_form_input_custom11');if($('#thx_form_input_custom12').length)thx_form_input_custom12=$('#thx_form_input_custom12');if($('#thx_form_input_custom13').length)thx_form_input_custom13=$('#thx_form_input_custom13');if($('#thx_form_input_custom14').length)thx_form_input_custom14=$('#thx_form_input_custom14');if($('#thx_form_input_custom15').length)thx_form_input_custom15=$('#thx_form_input_custom15');if($('#thx_form_input_custom16').length)thx_form_input_custom16=$('#thx_form_input_custom16');if($('#thx_form_input_custom17').length)thx_form_input_custom17=$('#thx_form_input_custom17');if($('#thx_form_input_custom18').length)thx_form_input_custom18=$('#thx_form_input_custom18');if($('#thx_form_input_custom19').length)thx_form_input_custom19=$('#thx_form_input_custom19');if($('#thx_form_input_custom20').length)thx_form_input_custom20=$('#thx_form_input_custom20');if($('#ep1_form_input_full_name').length)ep1_form_input_full_name=$('#ep1_form_input_full_name');if($('#ep1_form_input_first_name').length)ep1_form_input_first_name=$('#ep1_form_input_first_name');if($('#ep1_form_input_last_name').length)ep1_form_input_last_name=$('#ep1_form_input_last_name');if($('#ep1_form_input_email').length)ep1_form_input_email=$('#ep1_form_input_email');if($('#ep1_form_input_phone').length)ep1_form_input_phone=$('#ep1_form_input_phone');if($('#ep1_form_input_opt_in').length)ep1_form_input_opt_in=$('#ep1_form_input_opt_in');if($('#ep1_form_input_custom1').length)ep1_form_input_custom1=$('#ep1_form_input_custom1');if($('#ep1_form_input_custom2').length)ep1_form_input_custom2=$('#ep1_form_input_custom2');if($('#ep1_form_input_custom3').length)ep1_form_input_custom3=$('#ep1_form_input_custom3');if($('#ep1_form_input_custom4').length)ep1_form_input_custom4=$('#ep1_form_input_custom4');if($('#ep1_form_input_custom5').length)ep1_form_input_custom5=$('#ep1_form_input_custom5');if($('#ep1_form_input_custom6').length)ep1_form_input_custom6=$('#ep1_form_input_custom6');if($('#ep1_form_input_custom7').length)ep1_form_input_custom7=$('#ep1_form_input_custom7');if($('#ep1_form_input_custom8').length)ep1_form_input_custom8=$('#ep1_form_input_custom8');if($('#ep1_form_input_custom9').length)ep1_form_input_custom9=$('#ep1_form_input_custom9');if($('#ep1_form_input_custom10').length)ep1_form_input_custom10=$('#ep1_form_input_custom10');if($('#ep1_form_input_custom11').length)ep1_form_input_custom11=$('#ep1_form_input_custom11');if($('#ep1_form_input_custom12').length)ep1_form_input_custom12=$('#ep1_form_input_custom12');if($('#ep1_form_input_custom13').length)ep1_form_input_custom13=$('#ep1_form_input_custom13');if($('#ep1_form_input_custom14').length)ep1_form_input_custom14=$('#ep1_form_input_custom14');if($('#ep1_form_input_custom15').length)ep1_form_input_custom15=$('#ep1_form_input_custom15');if($('#ep1_form_input_custom16').length)ep1_form_input_custom16=$('#ep1_form_input_custom16');if($('#ep1_form_input_custom17').length)ep1_form_input_custom17=$('#ep1_form_input_custom17');if($('#ep1_form_input_custom18').length)ep1_form_input_custom18=$('#ep1_form_input_custom18');if($('#ep1_form_input_custom19').length)ep1_form_input_custom19=$('#ep1_form_input_custom19');if($('#ep1_form_input_custom20').length)ep1_form_input_custom20=$('#ep1_form_input_custom20');if($('#ep2_form_input_full_name').length)ep2_form_input_full_name=$('#ep2_form_input_full_name');if($('#ep2_form_input_first_name').length)ep2_form_input_first_name=$('#ep2_form_input_first_name');if($('#ep2_form_input_last_name').length)ep2_form_input_last_name=$('#ep2_form_input_last_name');if($('#ep2_form_input_email').length)ep2_form_input_email=$('#ep2_form_input_email');if($('#ep2_form_input_phone').length)ep2_form_input_phone=$('#ep2_form_input_phone');if($('#ep2_form_input_opt_in').length)ep2_form_input_opt_in=$('#ep2_form_input_opt_in');if($('#ep2_form_input_custom1').length)ep2_form_input_custom1=$('#ep2_form_input_custom1');if($('#ep2_form_input_custom2').length)ep2_form_input_custom2=$('#ep2_form_input_custom2');if($('#ep2_form_input_custom3').length)ep2_form_input_custom3=$('#ep2_form_input_custom3');if($('#ep2_form_input_custom4').length)ep2_form_input_custom4=$('#ep2_form_input_custom4');if($('#ep2_form_input_custom5').length)ep2_form_input_custom5=$('#ep2_form_input_custom5');if($('#ep2_form_input_custom6').length)ep2_form_input_custom6=$('#ep2_form_input_custom6');if($('#ep2_form_input_custom7').length)ep2_form_input_custom7=$('#ep2_form_input_custom7');if($('#ep2_form_input_custom8').length)ep2_form_input_custom8=$('#ep2_form_input_custom8');if($('#ep2_form_input_custom9').length)ep2_form_input_custom9=$('#ep2_form_input_custom9');if($('#ep2_form_input_custom10').length)ep2_form_input_custom10=$('#ep2_form_input_custom10');if($('#ep2_form_input_custom11').length)ep2_form_input_custom11=$('#ep2_form_input_custom11');if($('#ep2_form_input_custom12').length)ep2_form_input_custom12=$('#ep2_form_input_custom12');if($('#ep2_form_input_custom13').length)ep2_form_input_custom13=$('#ep2_form_input_custom13');if($('#ep2_form_input_custom14').length)ep2_form_input_custom14=$('#ep2_form_input_custom14');if($('#ep2_form_input_custom15').length)ep2_form_input_custom15=$('#ep2_form_input_custom15');if($('#ep2_form_input_custom16').length)ep2_form_input_custom16=$('#ep2_form_input_custom16');if($('#ep2_form_input_custom17').length)ep2_form_input_custom17=$('#ep2_form_input_custom17');if($('#ep2_form_input_custom18').length)ep2_form_input_custom18=$('#ep2_form_input_custom18');if($('#ep2_form_input_custom19').length)ep2_form_input_custom19=$('#ep2_form_input_custom19');if($('#ep2_form_input_custom20').length)ep2_form_input_custom20=$('#ep2_form_input_custom20');if($('#ep3_form_input_full_name').length)ep3_form_input_full_name=$('#ep3_form_input_full_name');if($('#ep3_form_input_first_name').length)ep3_form_input_first_name=$('#ep3_form_input_first_name');if($('#ep3_form_input_last_name').length)ep3_form_input_last_name=$('#ep3_form_input_last_name');if($('#ep3_form_input_email').length)ep3_form_input_email=$('#ep3_form_input_email');if($('#ep3_form_input_phone').length)ep3_form_input_phone=$('#ep3_form_input_phone');if($('#ep3_form_input_opt_in').length)ep3_form_input_opt_in=$('#ep3_form_input_opt_in');if($('#ep3_form_input_custom1').length)ep3_form_input_custom1=$('#ep3_form_input_custom1');if($('#ep3_form_input_custom2').length)ep3_form_input_custom2=$('#ep3_form_input_custom2');if($('#ep3_form_input_custom3').length)ep3_form_input_custom3=$('#ep3_form_input_custom3');if($('#ep3_form_input_custom4').length)ep3_form_input_custom4=$('#ep3_form_input_custom4');if($('#ep3_form_input_custom5').length)ep3_form_input_custom5=$('#ep3_form_input_custom5');if($('#ep3_form_input_custom6').length)ep3_form_input_custom6=$('#ep3_form_input_custom6');if($('#ep3_form_input_custom7').length)ep3_form_input_custom7=$('#ep3_form_input_custom7');if($('#ep3_form_input_custom8').length)ep3_form_input_custom8=$('#ep3_form_input_custom8');if($('#ep3_form_input_custom9').length)ep3_form_input_custom9=$('#ep3_form_input_custom9');if($('#ep3_form_input_custom10').length)ep3_form_input_custom10=$('#ep3_form_input_custom10');if($('#ep3_form_input_custom11').length)ep3_form_input_custom11=$('#ep3_form_input_custom11');if($('#ep3_form_input_custom12').length)ep3_form_input_custom12=$('#ep3_form_input_custom12');if($('#ep3_form_input_custom13').length)ep3_form_input_custom13=$('#ep3_form_input_custom13');if($('#ep3_form_input_custom14').length)ep3_form_input_custom14=$('#ep3_form_input_custom14');if($('#ep3_form_input_custom15').length)ep3_form_input_custom15=$('#ep3_form_input_custom15');if($('#ep3_form_input_custom16').length)ep3_form_input_custom16=$('#ep3_form_input_custom16');if($('#ep3_form_input_custom17').length)ep3_form_input_custom17=$('#ep3_form_input_custom17');if($('#ep3_form_input_custom18').length)ep3_form_input_custom18=$('#ep3_form_input_custom18');if($('#ep3_form_input_custom19').length)ep3_form_input_custom19=$('#ep3_form_input_custom19');if($('#ep3_form_input_custom20').length)ep3_form_input_custom20=$('#ep3_form_input_custom20');if($('#ep4_form_input_full_name').length)ep4_form_input_full_name=$('#ep4_form_input_full_name');if($('#ep4_form_input_first_name').length)ep4_form_input_first_name=$('#ep4_form_input_first_name');if($('#ep4_form_input_last_name').length)ep4_form_input_last_name=$('#ep4_form_input_last_name');if($('#ep4_form_input_email').length)ep4_form_input_email=$('#ep4_form_input_email');if($('#ep4_form_input_phone').length)ep4_form_input_phone=$('#ep4_form_input_phone');if($('#ep4_form_input_opt_in').length)ep4_form_input_opt_in=$('#ep4_form_input_opt_in');if($('#ep4_form_input_custom1').length)ep4_form_input_custom1=$('#ep4_form_input_custom1');if($('#ep4_form_input_custom2').length)ep4_form_input_custom2=$('#ep4_form_input_custom2');if($('#ep4_form_input_custom3').length)ep4_form_input_custom3=$('#ep4_form_input_custom3');if($('#ep4_form_input_custom4').length)ep4_form_input_custom4=$('#ep4_form_input_custom4');if($('#ep4_form_input_custom5').length)ep4_form_input_custom5=$('#ep4_form_input_custom5');if($('#ep4_form_input_custom6').length)ep4_form_input_custom6=$('#ep4_form_input_custom6');if($('#ep4_form_input_custom7').length)ep4_form_input_custom7=$('#ep4_form_input_custom7');if($('#ep4_form_input_custom8').length)ep4_form_input_custom8=$('#ep4_form_input_custom8');if($('#ep4_form_input_custom9').length)ep4_form_input_custom9=$('#ep4_form_input_custom9');if($('#ep4_form_input_custom10').length)ep4_form_input_custom10=$('#ep4_form_input_custom10');if($('#ep4_form_input_custom11').length)ep4_form_input_custom11=$('#ep4_form_input_custom11');if($('#ep4_form_input_custom12').length)ep4_form_input_custom12=$('#ep4_form_input_custom12');if($('#ep4_form_input_custom13').length)ep4_form_input_custom13=$('#ep4_form_input_custom13');if($('#ep4_form_input_custom14').length)ep4_form_input_custom14=$('#ep4_form_input_custom14');if($('#ep4_form_input_custom15').length)ep4_form_input_custom15=$('#ep4_form_input_custom15');if($('#ep4_form_input_custom16').length)ep4_form_input_custom16=$('#ep4_form_input_custom16');if($('#ep4_form_input_custom17').length)ep4_form_input_custom17=$('#ep4_form_input_custom17');if($('#ep4_form_input_custom18').length)ep4_form_input_custom18=$('#ep4_form_input_custom18');if($('#ep4_form_input_custom19').length)ep4_form_input_custom19=$('#ep4_form_input_custom19');if($('#ep4_form_input_custom20').length)ep4_form_input_custom20=$('#ep4_form_input_custom20');}
catch(e){BOX_CUSTOM_JS.logError(e,'initFormInputs');}}
function isNullOrWhiteSpace(str){try{return(typeof str==='undefined'||str===null||str.match(/^ *$/)!==null);}
catch(e){BOX_CUSTOM_JS.logError(e,'isNullOrWhiteSpace');return false;}}
function getFirstLastNames(fullName){try{if(isNullOrWhiteSpace(fullName))return['',''];fullName=fullName.trim();var parts=fullName.split(' ');if(parts.length==0)return['',''];if(parts.length==1)return[parts[0],''];if(parts.length==2)return[parts[0],parts[1]];var first=parts[0];var last='';for(var x=1;x<parts.length;x++){if(!isNullOrWhiteSpace(parts[x])){last+=parts[x].trim()+' ';}}
if(last.length>0)last=last.trim();return[first,last];}
catch(e){BOX_CUSTOM_JS.logError(e,'getFirstLastNames');return['',''];}}
function getFullName(first,last){try{if(isNullOrWhiteSpace(first))first='';else first=first.trim();if(isNullOrWhiteSpace(last))last='';else last=last.trim();if(first.length>0&&last.length>0)return(first+' '+last);if(first.length>0)return first;if(last.length>0)return last;}
catch(e){BOX_CUSTOM_JS.logError(e,'getFullName');return(first+' '+last);}}
function isValidEmail(email){try{if(typeof email!=='string'||email.indexOf('@')<=0)return false;var emailParts=email.split('@'),emailName=emailParts[0],emailDomain=emailParts[1],emailDomainParts=emailDomain.split('.'),validChars='abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ.0123456789_-+',validCharsBasic='abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789';var valid_email_regex=/\S+@\S+\.\S+/;if(!valid_email_regex.test(email)){return false;}
if(emailParts.length!==2){return false;}
if(emailName.length<1||emailDomain.length<3){return false;}
if(emailDomain.indexOf('.')<=0){return false;}
if(email.indexOf(',')>=0||email.indexOf("'")>=0||email.indexOf('`')>=0||email.indexOf('"')>=0||email.indexOf(' ')>=0){return false;}
if(validCharsBasic.indexOf(emailName.substr(emailName.length-1))<0){return false;}
if(validCharsBasic.indexOf(emailDomain.substr(0,1))<0){return false;}
if(validCharsBasic.indexOf(emailName.substr(0,1))<0){return false;}
if(emailDomainParts[emailDomainParts.length-1].length<2){return false;}
if(emailName.indexOf(' ')>0||emailDomain.indexOf(' ')>0||emailName.indexOf('..')>=0||emailDomain.indexOf('..')>=0){return false;}
return true;}
catch(e){BOX_CUSTOM_JS.logError(e,'isValidEmail');return false;}}
function setPrefFormInputs(pref){try{if(pref==='thx_'){pref_form_input_full_name=thx_form_input_full_name;pref_form_input_first_name=thx_form_input_first_name;pref_form_input_last_name=thx_form_input_last_name;pref_form_input_email=thx_form_input_email;pref_form_input_phone=thx_form_input_phone;pref_form_input_custom1=thx_form_input_custom1;pref_form_input_custom2=thx_form_input_custom2;pref_form_input_custom3=thx_form_input_custom3;pref_form_input_custom4=thx_form_input_custom4;pref_form_input_custom5=thx_form_input_custom5;pref_form_input_custom6=thx_form_input_custom6;pref_form_input_custom7=thx_form_input_custom7;pref_form_input_custom8=thx_form_input_custom8;pref_form_input_custom9=thx_form_input_custom9;pref_form_input_custom10=thx_form_input_custom10;pref_form_input_custom11=thx_form_input_custom11;pref_form_input_custom12=thx_form_input_custom12;pref_form_input_custom13=thx_form_input_custom13;pref_form_input_custom14=thx_form_input_custom14;pref_form_input_custom15=thx_form_input_custom15;pref_form_input_custom16=thx_form_input_custom16;pref_form_input_custom17=thx_form_input_custom17;pref_form_input_custom18=thx_form_input_custom18;pref_form_input_custom19=thx_form_input_custom19;pref_form_input_custom20=thx_form_input_custom20;pref_form_input_opt_in=thx_form_input_opt_in;}else if(pref==='ep1_'){pref_form_input_full_name=ep1_form_input_full_name;pref_form_input_first_name=ep1_form_input_first_name;pref_form_input_last_name=ep1_form_input_last_name;pref_form_input_email=ep1_form_input_email;pref_form_input_phone=ep1_form_input_phone;pref_form_input_custom1=ep1_form_input_custom1;pref_form_input_custom2=ep1_form_input_custom2;pref_form_input_custom3=ep1_form_input_custom3;pref_form_input_custom4=ep1_form_input_custom4;pref_form_input_custom5=ep1_form_input_custom5;pref_form_input_custom6=ep1_form_input_custom6;pref_form_input_custom7=ep1_form_input_custom7;pref_form_input_custom8=ep1_form_input_custom8;pref_form_input_custom9=ep1_form_input_custom9;pref_form_input_custom10=ep1_form_input_custom10;pref_form_input_custom11=ep1_form_input_custom11;pref_form_input_custom12=ep1_form_input_custom12;pref_form_input_custom13=ep1_form_input_custom13;pref_form_input_custom14=ep1_form_input_custom14;pref_form_input_custom15=ep1_form_input_custom15;pref_form_input_custom16=ep1_form_input_custom16;pref_form_input_custom17=ep1_form_input_custom17;pref_form_input_custom18=ep1_form_input_custom18;pref_form_input_custom19=ep1_form_input_custom19;pref_form_input_custom20=ep1_form_input_custom20;pref_form_input_opt_in=ep1_form_input_opt_in;}else if(pref==='ep2_'){pref_form_input_full_name=ep2_form_input_full_name;pref_form_input_first_name=ep2_form_input_first_name;pref_form_input_last_name=ep2_form_input_last_name;pref_form_input_email=ep2_form_input_email;pref_form_input_phone=ep2_form_input_phone;pref_form_input_custom1=ep2_form_input_custom1;pref_form_input_custom2=ep2_form_input_custom2;pref_form_input_custom3=ep2_form_input_custom3;pref_form_input_custom4=ep2_form_input_custom4;pref_form_input_custom5=ep2_form_input_custom5;pref_form_input_custom6=ep2_form_input_custom6;pref_form_input_custom7=ep2_form_input_custom7;pref_form_input_custom8=ep2_form_input_custom8;pref_form_input_custom9=ep2_form_input_custom9;pref_form_input_custom10=ep2_form_input_custom10;pref_form_input_custom11=ep2_form_input_custom11;pref_form_input_custom12=ep2_form_input_custom12;pref_form_input_custom13=ep2_form_input_custom13;pref_form_input_custom14=ep2_form_input_custom14;pref_form_input_custom15=ep2_form_input_custom15;pref_form_input_custom16=ep2_form_input_custom16;pref_form_input_custom17=ep2_form_input_custom17;pref_form_input_custom18=ep2_form_input_custom18;pref_form_input_custom19=ep2_form_input_custom19;pref_form_input_custom20=ep2_form_input_custom20;pref_form_input_opt_in=ep2_form_input_opt_in;}else if(pref==='ep3_'){pref_form_input_full_name=ep3_form_input_full_name;pref_form_input_first_name=ep3_form_input_first_name;pref_form_input_last_name=ep3_form_input_last_name;pref_form_input_email=ep3_form_input_email;pref_form_input_phone=ep3_form_input_phone;pref_form_input_custom1=ep3_form_input_custom1;pref_form_input_custom2=ep3_form_input_custom2;pref_form_input_custom3=ep3_form_input_custom3;pref_form_input_custom4=ep3_form_input_custom4;pref_form_input_custom5=ep3_form_input_custom5;pref_form_input_custom6=ep3_form_input_custom6;pref_form_input_custom7=ep3_form_input_custom7;pref_form_input_custom8=ep3_form_input_custom8;pref_form_input_custom9=ep3_form_input_custom9;pref_form_input_custom10=ep3_form_input_custom10;pref_form_input_custom11=ep3_form_input_custom11;pref_form_input_custom12=ep3_form_input_custom12;pref_form_input_custom13=ep3_form_input_custom13;pref_form_input_custom14=ep3_form_input_custom14;pref_form_input_custom15=ep3_form_input_custom15;pref_form_input_custom16=ep3_form_input_custom16;pref_form_input_custom17=ep3_form_input_custom17;pref_form_input_custom18=ep3_form_input_custom18;pref_form_input_custom19=ep3_form_input_custom19;pref_form_input_custom20=ep3_form_input_custom20;pref_form_input_opt_in=ep3_form_input_opt_in;}else if(pref==='ep4_'){pref_form_input_full_name=ep4_form_input_full_name;pref_form_input_first_name=ep4_form_input_first_name;pref_form_input_last_name=ep4_form_input_last_name;pref_form_input_email=ep4_form_input_email;pref_form_input_phone=ep4_form_input_phone;pref_form_input_custom1=ep4_form_input_custom1;pref_form_input_custom2=ep4_form_input_custom2;pref_form_input_custom3=ep4_form_input_custom3;pref_form_input_custom4=ep4_form_input_custom4;pref_form_input_custom5=ep4_form_input_custom5;pref_form_input_custom6=ep4_form_input_custom6;pref_form_input_custom7=ep4_form_input_custom7;pref_form_input_custom8=ep4_form_input_custom8;pref_form_input_custom9=ep4_form_input_custom9;pref_form_input_custom10=ep4_form_input_custom10;pref_form_input_custom11=ep4_form_input_custom11;pref_form_input_custom12=ep4_form_input_custom12;pref_form_input_custom13=ep4_form_input_custom13;pref_form_input_custom14=ep4_form_input_custom14;pref_form_input_custom15=ep4_form_input_custom15;pref_form_input_custom16=ep4_form_input_custom16;pref_form_input_custom17=ep4_form_input_custom17;pref_form_input_custom18=ep4_form_input_custom18;pref_form_input_custom19=ep4_form_input_custom19;pref_form_input_custom20=ep4_form_input_custom20;pref_form_input_opt_in=ep4_form_input_opt_in;}else{pref_form_input_full_name=form_input_full_name;pref_form_input_first_name=form_input_first_name;pref_form_input_last_name=form_input_last_name;pref_form_input_email=form_input_email;pref_form_input_phone=form_input_phone;pref_form_input_custom1=form_input_custom1;pref_form_input_custom2=form_input_custom2;pref_form_input_custom3=form_input_custom3;pref_form_input_custom4=form_input_custom4;pref_form_input_custom5=form_input_custom5;pref_form_input_custom6=form_input_custom6;pref_form_input_custom7=form_input_custom7;pref_form_input_custom8=form_input_custom8;pref_form_input_custom9=form_input_custom9;pref_form_input_custom10=form_input_custom10;pref_form_input_custom11=form_input_custom11;pref_form_input_custom12=form_input_custom12;pref_form_input_custom13=form_input_custom13;pref_form_input_custom14=form_input_custom14;pref_form_input_custom15=form_input_custom15;pref_form_input_custom16=form_input_custom16;pref_form_input_custom17=form_input_custom17;pref_form_input_custom18=form_input_custom18;pref_form_input_custom19=form_input_custom19;pref_form_input_custom20=form_input_custom20;pref_form_input_opt_in=form_input_opt_in;}}
catch(e){BOX_CUSTOM_JS.logError(e,'setPrefFormInputs');}}
function validateForm(data,page_pref,get_data_only,override_data){try{var pref='';if(typeof page_pref==='undefined'||page_pref===null||page_pref==='main'){pref='';}else{pref=page_pref;}
if(typeof data!=='object'||data===null){data={};}
if(typeof get_data_only!=='boolean'){get_data_only=false;}
if(typeof override_data!=='boolean'){override_data=false;}
logger('(BOX #'+LIGHTBOX_SHORT_ID+') - validateForm('+pref+', '+get_data_only+')');setPrefFormInputs(pref);if(settings.hasOwnProperty(pref+'name')&&settings[pref+'name'].display){if(settings[pref+'name'].mode=='full'){if(!data.hasOwnProperty('name')||override_data)data.name=pref_form_input_full_name.val().trim();if(!get_data_only){if(settings[pref+'name'].require&&data.name.length==0){if(settings[pref+'name'].hasOwnProperty('error_text')&&settings[pref+'name'].error_text){showError(pref,'name',settings[pref+'name'].error_text);}else{showError(pref,'name',settings[pref+'name'].label+' is required.');}
return false;}
else if(data.name.length>100){if(settings[pref+'name'].hasOwnProperty('error_text')&&settings[pref+'name'].error_text){showError(pref,'name',settings[pref+'name'].error_text);}else{showError(pref,'name',settings[pref+'name'].label+' must be less than 100 characters.');}
return false;}}
var fl=getFirstLastNames(data.name);if(!data.hasOwnProperty('first_name')||override_data)data.first_name=fl[0];if(!data.hasOwnProperty('last_name')||override_data)data.last_name=fl[1];}else if(settings[pref+'name'].mode=='first'){if(!data.hasOwnProperty('first_name')||override_data)data.first_name=pref_form_input_first_name.val().trim();if(!get_data_only){if(settings[pref+'name'].require&&data.first_name.length==0){if(settings[pref+'name'].hasOwnProperty('error_text')&&settings[pref+'name'].error_text){showError(pref,'name',settings[pref+'name'].error_text);}else{showError(pref,'name',settings[pref+'name'].label+' is required.');}
return false;}
if(data.first_name.length>100){if(settings[pref+'name'].hasOwnProperty('error_text')&&settings[pref+'name'].error_text){showError(pref,'name',settings[pref+'name'].error_text);}else{showError(pref,'name',settings[pref+'name'].label+' must be less than 100 characters.');}
return false;}}
if(!data.hasOwnProperty('name')||override_data)data.name=data.first_name;if(!data.hasOwnProperty('last_name')||override_data)data.last_name='';}else if(settings[pref+'name'].mode=='both'){if(!data.hasOwnProperty('first_name')||override_data)data.first_name=pref_form_input_first_name.val().trim();if(!data.hasOwnProperty('last_name')||override_data)data.last_name=pref_form_input_last_name.val().trim();if(!get_data_only){if(settings[pref+'name'].require&&(data.first_name.length==0||data.last_name.length==0)){if(settings[pref+'name'].hasOwnProperty('error_text')&&settings[pref+'name'].error_text){showError(pref,'name',settings[pref+'name'].error_text);}else{showError(pref,'name','First Name and Last Name are both required.');}
return false;}
if(data.first_name.length>100){if(settings[pref+'name'].hasOwnProperty('error_text')&&settings[pref+'name'].error_text){showError(pref,'name',settings[pref+'name'].error_text);}else{showError(pref,'name','First Name must be less than 100 characters.');}
return false;}
if(data.last_name.length>100){if(settings[pref+'name'].hasOwnProperty('error_text')&&settings[pref+'name'].error_text){showError(pref,'name',settings[pref+'name'].error_text);}else{showError(pref,'name','Last Name must be less than 100 characters.');}
return false;}}
if(!data.hasOwnProperty('name')||override_data)data.name=getFullName(data.first_name,data.last_name);}}
if(settings.hasOwnProperty(pref+'email')&&settings[pref+'email'].display){if(!data.hasOwnProperty('email')||override_data)data.email=pref_form_input_email.val().trim();if(!get_data_only){if(settings[pref+'email'].require&&data.email.length==0){if(settings[pref+'email'].hasOwnProperty('error_text')&&settings[pref+'email'].error_text){showError(pref,'email',settings[pref+'email'].error_text);}else{showError(pref,'email',settings[pref+'email'].label+' is required.');}
return false;}
if(data.email.length>200){if(settings[pref+'email'].hasOwnProperty('error_text')&&settings[pref+'email'].error_text){showError(pref,'email',settings[pref+'email'].error_text);}else{showError(pref,'email',settings[pref+'email'].label+' must be less than 100 characters.');}
return false;}
data.email=data.email.replace(/\s+/g,'');if(!isValidEmail(data.email)){if(settings[pref+'email'].hasOwnProperty('error_text')&&settings[pref+'email'].error_text){showError(pref,'email',settings[pref+'email'].error_text);}else{showError(pref,'email',settings[pref+'email'].label+' is in an invalid format.');}
return false;}}}
if(settings.hasOwnProperty(pref+'phone')&&settings[pref+'phone'].display){if(!data.hasOwnProperty('phone')||override_data)data.phone=pref_form_input_phone.val().trim();if(!get_data_only){if(settings[pref+'phone'].require&&data.phone.length==0){if(settings[pref+'phone'].hasOwnProperty('error_text')&&settings[pref+'phone'].error_text){showError(pref,'phone',settings[pref+'phone'].error_text);}else{showError(pref,'phone',settings[pref+'phone'].label+' is required.');}
return false;}
if(data.phone.length>20){if(settings[pref+'phone'].hasOwnProperty('error_text')&&settings[pref+'phone'].error_text){showError(pref,'phone',settings[pref+'phone'].error_text);}else{showError(pref,'phone',settings[pref+'phone'].label+' must be less than 20 characters.');}
return false;}}}
for(var n=1;n<=20;n++){pref_form_input_customN=false;if(n===1)pref_form_input_customN=pref_form_input_custom1;else if(n===2)pref_form_input_customN=pref_form_input_custom2;else if(n===3)pref_form_input_customN=pref_form_input_custom3;else if(n===4)pref_form_input_customN=pref_form_input_custom4;else if(n===5)pref_form_input_customN=pref_form_input_custom5;else if(n===6)pref_form_input_customN=pref_form_input_custom6;else if(n===7)pref_form_input_customN=pref_form_input_custom7;else if(n===8)pref_form_input_customN=pref_form_input_custom8;else if(n===9)pref_form_input_customN=pref_form_input_custom9;else if(n===10)pref_form_input_customN=pref_form_input_custom10;else if(n===11)pref_form_input_customN=pref_form_input_custom11;else if(n===12)pref_form_input_customN=pref_form_input_custom12;else if(n===13)pref_form_input_customN=pref_form_input_custom13;else if(n===14)pref_form_input_customN=pref_form_input_custom14;else if(n===15)pref_form_input_customN=pref_form_input_custom15;else if(n===16)pref_form_input_customN=pref_form_input_custom16;else if(n===17)pref_form_input_customN=pref_form_input_custom17;else if(n===18)pref_form_input_customN=pref_form_input_custom18;else if(n===19)pref_form_input_customN=pref_form_input_custom19;else if(n===20)pref_form_input_customN=pref_form_input_custom20;if(settings.hasOwnProperty(pref+'custom'+n)&&settings[pref+'custom'+n].display){if((!data.hasOwnProperty('custom_'+n)||override_data)&&(settings[pref+'custom'+n].hasOwnProperty('field_type')&&settings[pref+'custom'+n].field_type!=='datedrop'&&settings[pref+'custom'+n].field_type!=='radio')&&pref_form_input_customN){data['custom_'+n]=pref_form_input_customN.val().trim();}
else if((!data.hasOwnProperty('custom_'+n)||override_data)&&(settings[pref+'custom'+n].hasOwnProperty('field_type')&&settings[pref+'custom'+n].field_type=='radio')){if($("input[name="+pref+"form_input_custom"+n+"]:checked").length){data['custom_'+n]=$("input[name="+pref+"form_input_custom"+n+"]:checked").val();}
if(settings[pref+'custom'+n].require&&!data['custom_'+n]){if(settings[pref+'custom'+n].hasOwnProperty('error_text')&&settings[pref+'custom'+n].error_text){showError(pref,'custom'+n,settings[pref+'custom'+n].error_text);}else{showError(pref,'custom'+n,settings[pref+'custom'+n].label+' is required.');}
return false;}}
var evalCustomNCheckboxResult=evaluateCustomNCheckbox(data,pref,''+n,get_data_only,parent.DIGIOH_API.LIGHTBOX.INTEGRATION_MAP,LIGHTBOX_OR_VARIATION_GUID);if(!evalCustomNCheckboxResult){return false;}
var evalCustomNDatedropResult=evalCustomNDatedrop(data,pref,''+n,get_data_only);if(!evalCustomNDatedropResult){return false;}
if(!get_data_only){if(settings[pref+'custom'+n].hasOwnProperty('field_type')&&settings[pref+'custom'+n].field_type!=='hidden'&&settings[pref+'custom'+n].field_type!=='checkbox'&&settings[pref+'custom'+n].field_type!=='radio'&&settings[pref+'custom'+n].field_type!=='datedrop'&&settings[pref+'custom'+n].require&&data['custom_'+n].length==0){if(settings[pref+'custom'+n].hasOwnProperty('error_text')&&settings[pref+'custom'+n].error_text){showError(pref,'custom'+n,settings[pref+'custom'+n].error_text);}else{showError(pref,'custom'+n,settings[pref+'custom'+n].label+' is required.');}
return false;}
if(data['custom_'+n]&&data['custom_'+n].length>5000){if(settings[pref+'custom'+n].hasOwnProperty('error_text')&&settings[pref+'custom'+n].error_text){showError(pref,'custom'+n,settings[pref+'custom'+n].error_text);}else{showError(pref,'custom'+n,settings[pref+'custom'+n].label+' must be less than 500 characters.');}
return false;}}}else if(settings.hasOwnProperty(pref+'custom'+n)&&!data.hasOwnProperty('custom_'+n)&&pref_form_input_customN&&pref_form_input_customN.length){data['custom_'+n]=pref_form_input_customN.val().trim();}else if(settings.hasOwnProperty(pref+'custom'+n)&&!data.hasOwnProperty('custom_'+n)&&settings[pref+'custom'+n].hasOwnProperty('field_type')&&settings[pref+'custom'+n].field_type==='datedrop'&&$('#'+pref+'form_input_'+'custom'+n+'_datedrop_yyyy').length){evalCustomNDatedrop(data,pref,''+n,true);}}
if(settings.hasOwnProperty(pref+'opt_in')&&settings[pref+'opt_in'].display){if(!data.hasOwnProperty('opt_in')||override_data)data.opt_in=(pref_form_input_opt_in[0].checked?'true':'false');if(!get_data_only){if(settings[pref+'opt_in'].require&&data.opt_in=='false'){if(settings[pref+'opt_in'].hasOwnProperty('error_text')&&settings[pref+'opt_in'].error_text){showError(pref,'opt_in',settings[pref+'opt_in'].error_text);}else{showError(pref,'opt_in','Checkbox is required.');}
return false;}}}
return data;}
catch(e){BOX_CUSTOM_JS.logError(e,'validateForm');return data;}}
function evalCustomNDatedrop(data,pref,n,get_data_only){try{var propName=pref+'custom'+n;if(settings[propName].hasOwnProperty('field_type')&&settings[propName].field_type==='datedrop'){var dropdown_yyyy=$('#'+pref+'form_input_'+'custom'+n+'_datedrop_yyyy').val();var dropdown_mm=$('#'+pref+'form_input_'+'custom'+n+'_datedrop_mm').val();var dropdown_dd=$('#'+pref+'form_input_'+'custom'+n+'_datedrop_dd').val();var output_format="";if(settings[propName].datedrop.custom_format&&!isNullOrWhitespace(settings[propName].datedrop.custom_format)){output_format=settings[propName].datedrop.custom_format;}else if(settings[propName].datedrop.output_format){output_format=settings[propName].datedrop.output_format;}else{output_format="MM-dd-yyyy";}
var sep='';if(output_format.indexOf("-")>0&&output_format.indexOf("-")<=7){sep='-';}else if(output_format.indexOf("/")>0&&output_format.indexOf("/")<=7){sep='/';}else if(output_format.indexOf(".")>0&&output_format.indexOf(".")<=7){sep='.';}
var mm_format="MM";var dd_format="dd";var yyyy_format="yyyy";var output_parts=output_format.split(sep);for(var i=0;i<output_parts.length;i++){if(output_parts[i].contains("M"))mm_format=output_parts[i];else if(output_parts[i].contains("d"))dd_format=output_parts[i];else if(output_parts[i].contains("y"))yyyy_format=output_parts[i];}
if(output_format.contains("MM")&&dropdown_mm.length==1){dropdown_mm="0"+dropdown_mm;}else if(!output_format.contains("MM")&&output_format.contains("M")&&dropdown_mm.length==2&&dropdown_mm.indexOf("0")===0){dropdown_mm=dropdown_mm.substring(1);}else if(dropdown_mm.length==0){dropdown_mm="MM";}
if(output_format.contains("dd")&&dropdown_dd.length==1){dropdown_dd="0"+dropdown_dd;}else if(!output_format.contains("dd")&&output_format.contains("d")&&dropdown_dd.length==2&&dropdown_dd.indexOf("0")===0){dropdown_dd=dropdown_dd.substring(1);}else if(dropdown_dd.length==0){dropdown_dd="dd";}
if(!output_format.contains("yyyy")&&output_format.contains("yy")){if(dropdown_yyyy.length==4)dropdown_yyyy=dropdown_yyyy.substring(2);if(dropdown_yyyy.length==0)dropdown_yyyy="yy";}
var isValidDateSelected=false;if(dropdown_mm!==''&&dropdown_mm.toLowerCase()!=="mm"&&!dropdown_mm.toLowerCase()!=="m"&&dropdown_dd!==''&&dropdown_dd.toLowerCase()!=="dd"&&!dropdown_dd.toLowerCase()!=="d"&&dropdown_yyyy!==''&&dropdown_yyyy.toLowerCase()!=="yyyy"&&dropdown_yyyy.toLowerCase()!=="yy"&&dropdown_yyyy.toLowerCase()!=="y"){isValidDateSelected=true;}
var caseN='';if(!isValidDateSelected&&!settings[propName].require){data['custom_'+n]='';caseN='0';}else if(output_format==(mm_format+sep+dd_format+sep+yyyy_format)){data['custom_'+n]=dropdown_mm+sep+dropdown_dd+sep+dropdown_yyyy;caseN='1';}else if(output_format==(dd_format+sep+mm_format+sep+yyyy_format)){data['custom_'+n]=dropdown_dd+sep+dropdown_mm+sep+dropdown_yyyy;caseN='2';}else if(output_format==(yyyy_format+sep+mm_format+sep+dd_format)){data['custom_'+n]=dropdown_yyyy+sep+dropdown_mm+sep+dropdown_dd;caseN='3';}else{data['custom_'+n]=$('#'+pref+'form_input_'+'custom'+n+'_datedrop_mm').val()+'-'+$('#'+pref+'form_input_'+'custom'+n+'_datedrop_dd').val()+'-'+$('#'+pref+'form_input_'+'custom'+n+'_datedrop_yyyy').val();caseN='4';}
logger('(BOX #'+LIGHTBOX_SHORT_ID+') - evalCustomNDatedrop: '+data['custom_'+n]+' (case '+caseN+')');logger('(BOX #'+LIGHTBOX_SHORT_ID+') - output_format='+output_format+', mm_format='+mm_format+', dd_format='+dd_format+', yyyy_format='+yyyy_format+', sep='+sep);if(!get_data_only){if(settings[propName].require&&(!dropdown_mm||dropdown_mm.toLowerCase()=="mm"||dropdown_mm.toLowerCase()=="m")){if(settings[propName].require){if(settings[propName].hasOwnProperty('error_text')&&settings[propName].error_text){showError(pref,'custom'+n,settings[propName].error_text);}else{showError(pref,'custom'+n,settings[propName].label+' is required.');}}
else{if(settings[propName].hasOwnProperty('error_text')&&settings[propName].error_text){showError(pref,'custom'+n,settings[propName].error_text);}else{showError(pref,'custom'+n,settings[propName].label+' invalid date.');}}
return false;}
if(settings[propName].require&&(!dropdown_dd||dropdown_dd.toLowerCase()=="dd"||dropdown_dd.toLowerCase()=="d")){if(settings[propName].require){if(settings[propName].hasOwnProperty('error_text')&&settings[propName].error_text){showError(pref,'custom'+n,settings[propName].error_text);}else{showError(pref,'custom'+n,settings[propName].label+' is required.');}}
else{if(settings[propName].hasOwnProperty('error_text')&&settings[propName].error_text){showError(pref,'custom'+n,settings[propName].error_text);}else{showError(pref,'custom'+n,settings[propName].label+' invalid date.');}}
return false;}
if(settings[propName].require&&(!dropdown_yyyy||dropdown_yyyy.toLowerCase()=="yyyy"||dropdown_yyyy.toLowerCase()=="yy"||dropdown_yyyy.toLowerCase()=="y")){if(settings[propName].require){if(settings[propName].hasOwnProperty('error_text')&&settings[propName].error_text){showError(pref,'custom'+n,settings[propName].error_text);}else{showError(pref,'custom'+n,settings[propName].label+' is required.');}}
else{if(settings[propName].hasOwnProperty('error_text')&&settings[propName].error_text){showError(pref,'custom'+n,settings[propName].error_text);}else{showError(pref,'custom'+n,settings[propName].label+' invalid date.');}}
return false;}
if(isValidDateSelected){if(settings[propName].datedrop.min_age){var curr_date=new Date();var curr_yyyy=curr_date.getFullYear();var sel_yyyy=parseInt($('#'+pref+'form_input_'+'custom'+n+'_datedrop_yyyy').val());var min_age=parseInt(settings[propName].datedrop.min_age);if(curr_yyyy-sel_yyyy<min_age){if(settings[propName].hasOwnProperty('error_text')&&settings[propName].error_text){showError(pref,'custom'+n,settings[propName].error_text);}else{showError(pref,'custom'+n,'You must be '+min_age+' years old.');}
return false;}}
if(settings[propName].datedrop.max_age){var curr_date=new Date();var curr_yyyy=curr_date.getFullYear();var sel_yyyy=parseInt($('#'+pref+'form_input_'+'custom'+n+'_datedrop_yyyy').val());var max_age=parseInt(settings[propName].datedrop.max_age);if(curr_yyyy-sel_yyyy>max_age){if(settings[propName].hasOwnProperty('error_text')&&settings[propName].error_text){showError(pref,'custom'+n,settings[propName].error_text);}else{showError(pref,'custom'+n,'You are over '+max_age+' years old.');}
return false;}}}}}
return true;}
catch(e){BOX_CUSTOM_JS.logError(e,'evalCustomNDatedrop');return false;}}
function evaluateCustomNCheckbox(data,pref,n,get_data_only,integration_map,lbguid){try{var propName=pref+'custom'+n;if(settings[propName].hasOwnProperty('field_type')&&settings[propName].field_type==='checkbox'){var cb=document.getElementById(pref+'form_input_custom'+n);if(cb&&cb.checked){if(typeof settings[propName].checkbox.checkedval==='string'){if(settings[propName].checkbox.checkedval==='[BLANK]'){data['custom_'+n]='';}else if(settings[propName].checkbox.checkedval===''){data['custom_'+n]='true';}else{data['custom_'+n]=settings[propName].checkbox.checkedval;}}
else{data['custom_'+n]='true';}
if(settings[propName].checkbox.integration_id){var integration_id=settings[propName].checkbox.integration_id;if(typeof integration_id!=='string')integration_id=integration_id.toString();if(integration_id.indexOf(' ')!==-1)integration_id=integration_id.split(' ').join('');if(!integration_map.hasOwnProperty(lbguid)){integration_map[lbguid]=integration_id;logger('(BOX #'+LIGHTBOX_SHORT_ID+') - Added integration_id '+integration_id+' to INTEGRATION_MAP for box '+lbguid);logger(integration_map);}
else if(integration_map[lbguid].indexOf(integration_id)===-1){if(integration_map[lbguid].length>1){integration_map[lbguid]+=',';}
integration_map[lbguid]+=integration_id;logger('(BOX #'+LIGHTBOX_SHORT_ID+') - Added integration_id '+integration_id+' to INTEGRATION_MAP for box '+lbguid);logger(integration_map);}}}
else{if(typeof settings[propName].checkbox.uncheckedval==='string'){if(settings[propName].checkbox.uncheckedval==='[BLANK]'){data['custom_'+n]='';}else if(settings[propName].checkbox.uncheckedval===''){data['custom_'+n]='false';}else{data['custom_'+n]=settings[propName].checkbox.uncheckedval;}}
else{data['custom_'+n]='false';}
var integration_id=settings[propName].checkbox.integration_id;if(typeof integration_id!=='string')integration_id=integration_id.toString();if(integration_id.indexOf(' ')!==-1)integration_id=integration_id.split(' ').join('');if(integration_id&&integration_map.hasOwnProperty(lbguid)&&integration_map[lbguid].indexOf(integration_id)>=0){integration_map[lbguid]=integration_map[lbguid].replace(','+integration_id,'').replace(integration_id,'');logger('(BOX #'+LIGHTBOX_SHORT_ID+') - Removed integration_id '+integration_id+' from INTEGRATION_MAP for box '+lbguid);logger(integration_map);}}
logger('(BOX #'+LIGHTBOX_SHORT_ID+') - evaluateCustomNCheckbox(custom_'+n+') ==> '+data['custom_'+n]);if(!get_data_only){if(settings[propName].require&&!cb.checked){if(settings[propName].hasOwnProperty('error_text')&&settings[propName].error_text){showError(pref,'custom'+n,settings[propName].error_text);}else{showError(pref,'custom'+n,settings[propName].label+' is required.');}
return false;}}}
return true;}
catch(e){BOX_CUSTOM_JS.logError(e,'evaluateCustomNCheckbox');return false;}}
function showError(pref,propName,msg){if(typeof pref==='string'&&typeof propName==='undefined'&&typeof msg==='undefined'){var error_width=settings.layout.width;if(CURRENT_WIDTH){error_width=CURRENT_WIDTH;}
error_bubble.width(CURRENT_WIDTH-90);error_message.html(pref);error_bubble.show();window.setTimeout(function(){error_bubble.hide();},4000);return;}
if(!propName||propName===''||!settings.hasOwnProperty(pref+propName)||!settings[pref+'inputs'].hasOwnProperty('error_position')||settings[pref+'inputs']['error_position'].indexOf('top')>=0){var error_width=settings.layout.width;if(CURRENT_WIDTH){error_width=CURRENT_WIDTH;}
error_bubble.width(CURRENT_WIDTH-90);error_message.html(msg);error_bubble.show();window.setTimeout(function(){error_bubble.hide();},4000);}
if(propName!==''&&settings[pref+'inputs'].hasOwnProperty('error_position')&&settings[pref+'inputs']['error_position'].indexOf('inline')>=0){if(propName==='name'){if($('#'+pref+'form_input_full_name_help').length)$('#'+pref+'form_input_full_name_help').hide();if($('#'+pref+'form_input_first_name_help').length)$('#'+pref+'form_input_first_name_help').hide();if($('#'+pref+'form_input_last_name_help').length)$('#'+pref+'form_input_last_name_help').hide();$('#'+pref+'form_input_name_error_text').html(msg).show();$('#'+pref+'form_input_full_name,'+'#'+pref+'form_input_first_name,'+'#'+pref+'form_input_last_name').addClass(pref+'form_inputs_error');$('#'+pref+'form_input_full_name,'+'#'+pref+'form_input_first_name,'+'#'+pref+'form_input_last_name').focus(function(){$('#'+pref+'form_input_name_error_text').hide();$('#'+pref+'form_input_full_name,'+'#'+pref+'form_input_first_name,'+'#'+pref+'form_input_last_name').removeClass(pref+'form_inputs_error');if(settings[pref+'name'].display_help){if($('#'+pref+'form_input_full_name_help').length)$('#'+pref+'form_input_full_name_help').show();if($('#'+pref+'form_input_first_name_help').length)$('#'+pref+'form_input_first_name_help').show();if($('#'+pref+'form_input_last_name_help').length)$('#'+pref+'form_input_last_name_help').show();}});}
else if(propName==='email'){if($('#'+pref+'form_input_email_help').length)$('#'+pref+'form_input_email_help').hide();$('#'+pref+'form_input_email_error_text').html(msg).show();$('#'+pref+'form_input_email').addClass(pref+'form_inputs_error');$('#'+pref+'form_input_email').focus(function(){$('#'+pref+'form_input_email_error_text').hide();$('#'+pref+'form_input_email').removeClass(pref+'form_inputs_error');if(settings[pref+'email'].display_help&&$('#'+pref+'form_input_email_help').length){$('#'+pref+'form_input_email_help').show();}});}
else if(propName==='phone'){if($('#'+pref+'form_input_phone_help').length)$('#'+pref+'form_input_phone_help').hide();$('#'+pref+'form_input_phone_error_text').html(msg).show();$('#'+pref+'form_input_phone').addClass(pref+'form_inputs_error');$('#'+pref+'form_input_phone').focus(function(){$('#'+pref+'form_input_phone_error_text').hide();$('#'+pref+'form_input_phone').removeClass(pref+'form_inputs_error');if(settings[pref+'phone'].display_help&&$('#'+pref+'form_input_phone_help').length){$('#'+pref+'form_input_phone_help').show();}});}
else if(propName==='opt_in'){$('#'+pref+'form_input_opt_in_error_text').html(msg).show();$('#'+pref+'form_input_opt_in').change(function(){$('#'+pref+'form_input_opt_in_error_text').hide();});}
else if(propName.indexOf('custom')===0){if($('#'+pref+'form_input_'+propName+'_help').length)$('#'+pref+'form_input_'+propName+'_help').hide();$('#'+pref+'form_input_'+propName+'_error_text').html(msg).show();if(settings[pref+propName]['field_type']==='checkbox'){$('#'+pref+'form_input_'+propName).change(function(){$('#'+pref+'form_input_'+propName+'_error_text').hide();});}
else if(settings[pref+propName]['field_type']==='datedrop'){$('#'+pref+'form_input_'+propName+'_wrapper .'+pref+'form_inputs').addClass(pref+'form_inputs_error');$('#'+pref+'form_input_'+propName+'_wrapper .'+pref+'form_inputs').focus(function(){$('#'+pref+'form_input_'+propName+'_error_text').hide();$('#'+pref+'form_input_'+propName+'_wrapper .'+pref+'form_inputs').removeClass(pref+'form_inputs_error');if(settings[pref+propName].display_help){$('#'+pref+'form_input_'+propName+'_wrapper .'+pref+'form_inputs_help').show();}});}
else{$('#'+pref+'form_input_'+propName).addClass(pref+'form_inputs_error');$('#'+pref+'form_input_'+propName).focus(function(){$('#'+pref+'form_input_'+propName+'_error_text').hide();$('#'+pref+'form_input_'+propName).removeClass(pref+'form_inputs_error');if(settings[pref+propName].display_help&&$('#'+pref+'form_input_'+propName+'_help').length){$('#'+pref+'form_input_'+propName+'_help').show();}});}}}}
function getFriendlyPagePrefix(pref){var page_prefix_friendly='main';if(pref==='thx_'||pref==='thx')page_prefix_friendly='thx';else if(pref==='ep1_'||pref==='ep1')page_prefix_friendly='ep1';else if(pref==='ep2_'||pref==='ep2')page_prefix_friendly='ep2';else if(pref==='ep3_'||pref==='ep3')page_prefix_friendly='ep3';else if(pref==='ep4_'||pref==='ep4')page_prefix_friendly='ep4';return page_prefix_friendly;}
function checkPendingCouponsOnSubmit(pref,hideLoadingSpinner){try{var foundCouponPending=false;for(var prop in COUPONS_FOR_SUBMIT){if(COUPONS_FOR_SUBMIT.hasOwnProperty(prop)&&COUPONS_FOR_SUBMIT[prop]===false){foundCouponPending=true;break;}}
if(foundCouponPending){setTimeout(function(){checkPendingCouponsOnSubmit(pref,hideLoadingSpinner);},100);}else{processSubmitLock=false;processSubmit(pref,hideLoadingSpinner,true);}}
catch(e){BOX_CUSTOM_JS.logError(e,'checkPendingCouponsOnSubmit');}}
function processSubmit(pref,hideLoadingSpinner,bypassCoupons){if(processSubmitLock){logger('processSubmitLock');return false;}
processSubmitLock=true;setTimeout(function(){processSubmitLock=false;},1000);try{if(typeof pref==='undefined'||pref===null){pref='';}
if(typeof COUPONS_FOR_SUBMIT==='object'&&Object.keys(COUPONS_FOR_SUBMIT).length>0){if(typeof bypassCoupons!=='boolean'||!bypassCoupons){buildCouponsSubmit();checkPendingCouponsOnSubmit(pref,hideLoadingSpinner);return;}}}
catch(e){pref='';BOX_CUSTOM_JS.logError(e,'processSubmit');}
if((using_form&&pref==='')||(using_form_thx&&pref==='thx_')||(using_form_ep1&&pref==='ep1_')||(using_form_ep2&&pref==='ep2_')||(using_form_ep3&&pref==='ep3_')||(using_form_ep4&&pref==='ep4_')){var data_with_validation='';var data_only=validateForm({},pref,true,true);var customJsResBeforeFormValidation=BOX_CUSTOM_JS.runCustomJsBeforeFormValidation(data_only);if(typeof customJsResBeforeFormValidation==='boolean'&&customJsResBeforeFormValidation===false){return false;}else if(typeof customJsResBeforeFormValidation==='string'&&customJsResBeforeFormValidation.trim().length>0){showError('','',customJsResBeforeFormValidation);return false;}else if(typeof customJsResBeforeFormValidation==='object'&&customJsResBeforeFormValidation!==null){data_with_validation=customJsResBeforeFormValidation;}else{data_with_validation=validateForm({},pref,false,true);}
if(typeof data_with_validation==='object'&&data_with_validation!==null){var customJsResAfterFormValidation=BOX_CUSTOM_JS.runCustomJsAfterFormValidation(data_with_validation);if(typeof customJsResAfterFormValidation==='boolean'&&customJsResAfterFormValidation===false){return false;}else if(typeof customJsResAfterFormValidation==='string'&&customJsResAfterFormValidation.trim().length>0){showError('','',customJsResAfterFormValidation);return false;}else if(typeof customJsResAfterFormValidation==='object'&&customJsResAfterFormValidation!==null){data_with_validation=customJsResAfterFormValidation;}
var data=data_with_validation;if(typeof hideLoadingSpinner!=='boolean'||hideLoadingSpinner===false){showLoading(pref);}
var query='';for(var key in data){if(data.hasOwnProperty(key)){if(key.indexOf('custom_')===0){if(data[key]){var propName=pref+'custom'+key.split('_')[1];var keyName='_c'+key.split('_')[1];if(settings.hasOwnProperty(propName)&&settings[propName].hasOwnProperty('label')&&settings[propName].label!==''){query+=keyName.split('=').join('[*#*!]').split('&').join('[*#*$]').split('|').join('[*#*%]')+'=';query+=settings[propName].label.split('=').join('[*#*!]').split('&').join('[*#*$]').split('|').join('[*#*%]')+'|';if(data[key]){query+=data[key].split('=').join('[*#*!]').split('&').join('[*#*$]').split('|').join('[*#*%]')+'&';}else{query+='&';}}else{query+=keyName.split('=').join('[*#*!]').split('&').join('[*#*$]').split('|').join('[*#*%]')+'=';query+='Custom Field '+key.split('_')[1]+'|';if(data[key]){query+=data[key].split('=').join('[*#*!]').split('&').join('[*#*$]').split('|').join('[*#*%]')+'&';}else{query+='&';}}}}else{var keyName=key;if(key=='email')keyName='_e';if(key=='name')keyName='_n';if(key=='first_name')keyName='_fn';if(key=='last_name')keyName='_ln';if(key=='phone')keyName='_p';if(key=='opt_in')keyName='_oi';query+=keyName.split('=').join('[*#*!]').split('&').join('[*#*$]').split('|').join('[*#*%]')+'=';if(data[key]){query+=data[key].split('=').join('[*#*!]').split('&').join('[*#*$]').split('|').join('[*#*%]')+'&';}else{query+='&';}}}}
var customJsResBeforeSubmit=BOX_CUSTOM_JS.runCustomJsBeforeSubmit(data);if(typeof customJsResBeforeSubmit==='boolean'&&customJsResBeforeSubmit===false){return false;}else if(typeof customJsResBeforeSubmit==='string'&&customJsResBeforeSubmit.trim().length>0){showError('','',customJsResBeforeSubmit);return false;}else if(typeof customJsResBeforeSubmit==='object'&&customJsResBeforeSubmit!==null){data=customJsResBeforeSubmit;}
if(pref===''){query+='_pg=main';postMessageSubmit(data,query,using_form,pref);}else if(pref.indexOf('_')>0){query+='_pg='+pref.split('_')[0];if(pref==='thx_')postMessageSubmit(data,query,using_form_thx,pref);if(pref==='ep1_')postMessageSubmit(data,query,using_form_ep1,pref);if(pref==='ep2_')postMessageSubmit(data,query,using_form_ep2,pref);if(pref==='ep3_')postMessageSubmit(data,query,using_form_ep3,pref);if(pref==='ep4_')postMessageSubmit(data,query,using_form_ep4,pref);}else{query+='_pg='+pref;postMessageSubmit(data,query,using_form,pref);}
var customJsAfterSubmit=BOX_CUSTOM_JS.runCustomJsAfterSubmit(data);if(typeof customJsAfterSubmit==='boolean'&&customJsAfterSubmit===false){return false;}
if(settings[pref+'form'].after_submit=='lightbox_open'&&settings[pref+'form'].lightbox_open&&settings[pref+'form'].lightbox_open.length>0){window.setTimeout(function(){hideLoading();var prop={};prop.lightbox_open=settings[pref+'form'].lightbox_open;postMessageOpenAnotherBox(prop,'form');},50);}else{afterSubmit(pref);}}}}
function afterSubmit(pref){try{if(settings[pref+'form'].after_submit=='main_page'){window.setTimeout(function(){hideLoading();changePages('','form',settings['form'],'form');},400);}else if(settings[pref+'form'].after_submit=='thank_you_page'){window.setTimeout(function(){hideLoading();changePages('thx_',pref+'form',settings[pref+'form'],'form');},400);}else if(settings[pref+'form'].after_submit=='extra_page_1'){window.setTimeout(function(){hideLoading();changePages('ep1_',pref+'form',settings[pref+'form'],'form');},300);}else if(settings[pref+'form'].after_submit=='extra_page_2'){window.setTimeout(function(){hideLoading();changePages('ep2_',pref+'form',settings[pref+'form'],'form');},300);}else if(settings[pref+'form'].after_submit=='extra_page_3'){window.setTimeout(function(){hideLoading();changePages('ep3_',pref+'form',settings[pref+'form'],'form');},300);}else if(settings[pref+'form'].after_submit=='extra_page_4'){window.setTimeout(function(){hideLoading();changePages('ep4_',pref+'form',settings[pref+'form'],'form');},300);}else if(settings[pref+'form'].after_submit=='redirect'&&settings[pref+'form'].redirect_url){window.setTimeout(function(){hideLoading();var prop={};if(settings[pref+'form'].redirect_url.toLowerCase().trim().indexOf('http')===0||settings[pref+'form'].redirect_url.toLowerCase().trim().indexOf('mailto')===0){prop.url=settings[pref+'form'].redirect_url;}else{prop.url='http://'+settings[pref+'form'].redirect_url;}
if(settings[pref+'form'].hasOwnProperty('redirect_type')&&settings[pref+'form'].redirect_type){prop.redirect_type=settings[pref+'form'].redirect_type;}else{prop.redirect_type='current';}
postMessageRedirectParent(prop,'form');},400);}else if(settings[pref+'form'].after_submit=='close'){window.setTimeout(function(){hideLoading();postMessageCloseBox('form_submit');},400);}else if(settings[pref+'form'].after_submit=='nothing'){window.setTimeout(function(){hideLoading();},400);}else{window.setTimeout(function(){hideLoading();postMessageCloseBox('form_submit');},400);}}
catch(e){BOX_CUSTOM_JS.logError(e,'afterSubmit');}}
function changePages(pref,el_name,prop,ui_source){try{var previous_page=CURRENT_PAGE;var customJsBeforeChangePages=BOX_CUSTOM_JS.runCustomJsBeforeChangePages(getFriendlyPagePrefix(previous_page),getFriendlyPagePrefix(pref),el_name,prop,ui_source);if(typeof customJsBeforeChangePages==='boolean'&&customJsBeforeChangePages===false){return false;}
var modal_width=0;var modal_height=0;if(CURRENT_WIDTH===0){CURRENT_WIDTH=settings.layout.width;}
if(CURRENT_HEIGHT===0){CURRENT_HEIGHT=settings.layout.height;}
if(pref==='thx_'&&settings.hasOwnProperty('thxlayout')){modal_width=settings.thxlayout.width;modal_height=settings.thxlayout.height;CURRENT_PAGE='thx';buildStyles('thx');loadImages('thx');loadExternalFonts('thx');replaceSettingsObjFormMergeTagsAfterChangePages('thx');}else if(pref==='ep1_'&&settings.hasOwnProperty('ep1layout')){modal_width=settings.ep1layout.width;modal_height=settings.ep1layout.height;CURRENT_PAGE='ep1';buildStyles('ep1');loadImages('ep1');loadExternalFonts('ep1');replaceSettingsObjFormMergeTagsAfterChangePages('ep1');}else if(pref==='ep2_'&&settings.hasOwnProperty('ep2layout')){modal_width=settings.ep2layout.width;modal_height=settings.ep2layout.height;CURRENT_PAGE='ep2';buildStyles('ep2');loadImages('ep2');loadExternalFonts('ep2');replaceSettingsObjFormMergeTagsAfterChangePages('ep2');}else if(pref==='ep3_'&&settings.hasOwnProperty('ep3layout')){modal_width=settings.ep3layout.width;modal_height=settings.ep3layout.height;CURRENT_PAGE='ep3';buildStyles('ep3');loadImages('ep3');loadExternalFonts('ep3');replaceSettingsObjFormMergeTagsAfterChangePages('ep3');}else if(pref==='ep4_'&&settings.hasOwnProperty('ep4layout')){modal_width=settings.ep4layout.width;modal_height=settings.ep4layout.height;CURRENT_PAGE='ep4';buildStyles('ep4');loadImages('ep4');loadExternalFonts('ep4');replaceSettingsObjFormMergeTagsAfterChangePages('ep4');}else{modal_width=settings.layout.width;modal_height=settings.layout.height;CURRENT_PAGE='main';}
postMessageChangePages(pref,modal_width,modal_height,CURRENT_WIDTH,CURRENT_HEIGHT,getFriendlyPagePrefix(previous_page),getFriendlyPagePrefix(pref),el_name,prop,ui_source);var pref_resp='responsive';if(CURRENT_PAGE!=='main'){pref_resp=CURRENT_PAGE+pref_resp;}
if(!settings.hasOwnProperty(pref_resp)||!settings[pref_resp].use){CURRENT_WIDTH=modal_width;CURRENT_HEIGHT=modal_height;}
setTimeout(function(){if(pref==='thx_'&&settings.hasOwnProperty('thxlayout')){$('#layout').hide();if(settings.hasOwnProperty('ep1layout'))$('#ep1layout').hide();if(settings.hasOwnProperty('ep2layout'))$('#ep2layout').hide();if(settings.hasOwnProperty('ep3layout'))$('#ep3layout').hide();if(settings.hasOwnProperty('ep4layout'))$('#ep4layout').hide();if(settings.hasOwnProperty('thxlayout'))$('#thxlayout').show();}else if(pref==='ep1_'&&settings.hasOwnProperty('ep1layout')){$('#layout').hide();if(settings.hasOwnProperty('ep1layout'))$('#ep1layout').show();if(settings.hasOwnProperty('ep2layout'))$('#ep2layout').hide();if(settings.hasOwnProperty('ep3layout'))$('#ep3layout').hide();if(settings.hasOwnProperty('ep4layout'))$('#ep4layout').hide();if(settings.hasOwnProperty('thxlayout'))$('#thxlayout').hide();}else if(pref==='ep2_'&&settings.hasOwnProperty('ep2layout')){$('#layout').hide();if(settings.hasOwnProperty('ep1layout'))$('#ep1layout').hide();if(settings.hasOwnProperty('ep2layout'))$('#ep2layout').show();if(settings.hasOwnProperty('ep3layout'))$('#ep3layout').hide();if(settings.hasOwnProperty('ep4layout'))$('#ep4layout').hide();if(settings.hasOwnProperty('thxlayout'))$('#thxlayout').hide();}else if(pref==='ep3_'&&settings.hasOwnProperty('ep3layout')){$('#layout').hide();if(settings.hasOwnProperty('ep1layout'))$('#ep1layout').hide();if(settings.hasOwnProperty('ep2layout'))$('#ep2layout').hide();if(settings.hasOwnProperty('ep3layout'))$('#ep3layout').show();if(settings.hasOwnProperty('ep4layout'))$('#ep4layout').hide();if(settings.hasOwnProperty('thxlayout'))$('#thxlayout').hide();}else if(pref==='ep4_'&&settings.hasOwnProperty('ep4layout')){$('#layout').hide();if(settings.hasOwnProperty('ep1layout'))$('#ep1layout').hide();if(settings.hasOwnProperty('ep2layout'))$('#ep2layout').hide();if(settings.hasOwnProperty('ep3layout'))$('#ep3layout').hide();if(settings.hasOwnProperty('ep4layout'))$('#ep4layout').show();if(settings.hasOwnProperty('thxlayout'))$('#thxlayout').hide();}else{$('#layout').show();if(settings.hasOwnProperty('ep1layout'))$('#ep1layout').hide();if(settings.hasOwnProperty('ep2layout'))$('#ep2layout').hide();if(settings.hasOwnProperty('ep3layout'))$('#ep3layout').hide();if(settings.hasOwnProperty('ep4layout'))$('#ep4layout').hide();if(settings.hasOwnProperty('thxlayout'))$('#thxlayout').hide();}},100);var customJsAfterChangePages=BOX_CUSTOM_JS.runCustomJsAfterChangePages(getFriendlyPagePrefix(previous_page),getFriendlyPagePrefix(pref),el_name,prop,ui_source);}
catch(e){BOX_CUSTOM_JS.logError(e,'changePages');}}
function postMessageChangePages(pref,new_width,new_height,old_width,old_height,previous_page,new_page,el_name,prop,ui_source){sendMessageToParent({sender:'lightbox',child_action:'change_pages',lightbox_id:LIGHTBOX_OR_VARIATION_GUID,width:new_width,height:new_height,width_prev:old_width,height_prev:old_height,page_prefix:pref,previous_page:previous_page,new_page:new_page,el_name:el_name,ui_source:ui_source});}
function postMessageCloseBox(trig){sendMessageToParent({sender:'lightbox',child_action:'close_lightbox',lightbox_id:LIGHTBOX_OR_VARIATION_GUID,trigger:trig});}
function postMessageRedirectParent(prop,ui_source){var customJsBeforeRedirect=BOX_CUSTOM_JS.runCustomJsBeforeRedirect(prop,ui_source);if(typeof customJsBeforeRedirect==='boolean'&&customJsBeforeRedirect===false){return false;}
sendMessageToParent({sender:'lightbox',child_action:'redirect_parent',lightbox_id:LIGHTBOX_OR_VARIATION_GUID,url:prop.url,ui_trigger:ui_source,redirect_type:prop.redirect_type});var customJsAfterRedirect=BOX_CUSTOM_JS.runCustomJsAfterRedirect(prop,ui_source);}
function postMessageOpenAnotherBox(prop,ui_source){var customJsBeforeOpenAnotherBox=BOX_CUSTOM_JS.runCustomJsBeforeOpenAnotherBox(prop.lightbox_open,ui_source);if(typeof customJsBeforeOpenAnotherBox==='boolean'&&customJsBeforeOpenAnotherBox===false){return false;}
sendMessageToParent({sender:'lightbox',child_action:'lightbox_open',lightbox_id:LIGHTBOX_OR_VARIATION_GUID,lightbox_open:prop.lightbox_open,ui_trigger:ui_source});var customJsAfterOpenAnotherBox=BOX_CUSTOM_JS.runCustomJsAfterOpenAnotherBox(prop.lightbox_open,ui_source);}
function postMessageSubmit(data,post_to_keen_query,pref_using_form,pref){var submit_data=parent.DIGIOH_API.LIGHTBOX.LZString.compressToBase64(JSON.stringify(data));var query_data=parent.DIGIOH_API.LIGHTBOX.LZString.compressToBase64(post_to_keen_query);sendMessageToParent({sender:'lightbox',child_action:'register_analytics_submit',lightbox_id:LIGHTBOX_OR_VARIATION_GUID,submission:submit_data,post_to_keen:query_data,form_display:pref_using_form,page_prefix:pref});}
function postMessageCouponUsed(coupon_group_id,coupon_value,success_or_error,populate_on,code_section_trigger,code_section_response,pref){sendMessageToParent({sender:'lightbox',child_action:'coupon_used',lightbox_id:LIGHTBOX_OR_VARIATION_GUID,coupon_meta_data:{coupon_group_id:coupon_group_id,coupon_value:coupon_value,success_or_error:success_or_error,populate_on:populate_on,code_section_trigger:code_section_trigger,code_section_response:code_section_response,pref:pref}});}
function processDownload(prop){sendMessageToParent({sender:'lightbox',child_action:'download_file',lightbox_id:LIGHTBOX_OR_VARIATION_GUID});}
function buildButtonN(el,elWrapper,elName,prop,pref){try{if(prop.display){el.text(prop.text);el.hover(function(){$(this).addClass(elName+'_hover');},function(){$(this).removeClass(elName+'_hover');});if(prop.action=='download'&&prop.file&&prop.file.length>7){var src=PROTOCOL_USER_OVERRIDE+'s3.lightboxcdn.com/vendors/'+VENDOR_GUID+'/uploads/'+prop.file;el.wrap('<a style="border: none;" target="_blank" href="'+src+'"></a>');el.parent().on(IS_MOBILE?'click':'mousedown',function(e){e.stopPropagation();var customJsResBeforeDownload=BOX_CUSTOM_JS.runCustomJsBeforeDownload(getFriendlyPagePrefix(pref),elName,prop);if(typeof customJsResBeforeDownload==='boolean'&&customJsResBeforeDownload===false){e.preventDefault();return false;}
processDownload(prop);var customJsResAfterDownload=BOX_CUSTOM_JS.runCustomJsAfterDownload(getFriendlyPagePrefix(pref),elName,prop);return true;});el.on(IS_MOBILE?'touchstart':'mousedown',function(){$(this).addClass(elName+'_focus');}).on(IS_MOBILE?'touchend':'mouseup',function(){$(this).removeClass(elName+'_focus');});}else{el.on('focus',function(e){if(prop.action=='submit'){$(this).addClass('button_focus_tab_submit');}else if(prop.action=='close'){$(this).addClass('button_focus_tab_close');}else if(prop.action=='url'&&prop.url){$(this).addClass('button_focus_tab_redirect');}else if(prop.action=='lightbox_open'&&prop.lightbox_open&&prop.lightbox_open.length>0){$(this).addClass('button_focus_tab_lightbox_open');}else if(prop.action.indexOf('_page')>0){$(this).addClass('button_focus_tab_change_pages');}}).on('blur',function(e){if($(this).hasClass('button_focus_tab_submit')){$(this).removeClass('button_focus_tab_submit');}
if($(this).hasClass('button_focus_tab_close')){$(this).removeClass('button_focus_tab_close');}
if($(this).hasClass('button_focus_tab_redirect')){$(this).removeClass('button_focus_tab_redirect');}
if($(this).hasClass('button_focus_tab_lightbox_open')){$(this).removeClass('button_focus_tab_lightbox_open');}
if($(this).hasClass('button_focus_tab_change_pages')){$(this).removeClass('button_focus_tab_change_pages');}});if(prop.action&&prop.action!=='nothing'){el.on(IS_MOBILE?'click':'mousedown',function(e){e.stopPropagation();$(this).addClass(elName+'_focus');if(prop.action==='submit'){processSubmit(pref);}else if(prop.action==='close'){if(IS_MOBILE){setTimeout(function(){postMessageCloseBox('button_click');},150);}else{setTimeout(function(){postMessageCloseBox('button_click');},10);}}else if(prop.action==='url'&&prop.url){if(prop.url.toLowerCase().trim().indexOf('http')!==0&&prop.url.toLowerCase().trim().indexOf('mailto')!==0){prop.url='http://'+prop.url;}
if(!prop.hasOwnProperty('redirect_type')||!prop.redirect_type){prop.redirect_type='current';}
postMessageRedirectParent(prop,'button');}else if(prop.action==='lightbox_open'&&prop.lightbox_open&&prop.lightbox_open.length>0){if(IS_MOBILE){setTimeout(function(){postMessageOpenAnotherBox(prop,'button');},150);}else{setTimeout(function(){postMessageOpenAnotherBox(prop,'button');},10);}}else if(prop.action==='main_page'||prop.action==='thank_you_page'||prop.action==='extra_page_1'||prop.action==='extra_page_2'||prop.action==='extra_page_3'||prop.action==='extra_page_4'){var changePagePref='';if(prop.action==='thank_you_page'){changePagePref='thx_';}else if(prop.action.indexOf('extra_page_')>=0){changePagePref='ep'+prop.action.split('_')[2]+'_';}
if(IS_MOBILE){setTimeout(function(){changePages(changePagePref,elName,prop,'button');},150);}else{changePages(changePagePref,elName,prop,'button');}}else if(prop.action==='nothing'){}});}
el.on(IS_MOBILE?'touchstart':'mousedown',function(){$(this).addClass(elName+'_focus');}).on(IS_MOBILE?'touchend':'mouseup',function(){$(this).removeClass(elName+'_focus');});}}else{el.hide();elWrapper.hide();}}
catch(e){BOX_CUSTOM_JS.logError(e,'buildButtonN');}}
function loadImages(pref){try{if(typeof pref!=='string'||pref==='main'){pref='';}
if(pref.contains('_')){pref=pref.split('_')[0];}
if(pref!==''&&!LoadedPageImages.hasOwnProperty(pref)){LoadedPageImages[pref]=true;}else if(LoadedPageImages.hasOwnProperty(pref)&&LoadedPageImages[pref]===true){return;}
for(var x=1;x<=10;x++){if(settings.hasOwnProperty(pref+'image'+x))
loadImageN(pref+'image'+x);}}
catch(e){BOX_CUSTOM_JS.logError(e,'loadImages');}}
function loadImageN(prop_name){try{var attr=$('#'+prop_name).attr('src');if(ImageSrcMap.hasOwnProperty(prop_name)&&(typeof attr==='undefined'||attr===false||!attr)){ImageSrcMap[prop_name].img_element.attr('src',ImageSrcMap[prop_name].img_src);ImageSrcMap[prop_name].img_obj.src=ImageSrcMap[prop_name].img_src;}}
catch(e){BOX_CUSTOM_JS.logError(e,'loadImageN');}}
function buildImages(){try{for(var y=1;y<=6;y++){var pr='';if(y===5)pr='thx';else if(y===6)pr='';else pr='ep'+y;for(var x=1;x<=10;x++){if(settings.hasOwnProperty(pr+'image'+x)&&settings[pr+'image'+x].display){if(!image_dims.hasOwnProperty(pr+'image'+x)){image_dims[pr+'image'+x]={width:100,height:100};}
if(settings[pr+'image'+x].hasOwnProperty('metadata_kvps')){for(var k=0;k<settings[pr+'image'+x].metadata_kvps.length;k++){if(settings[pr+'image'+x].metadata_kvps[k].k&&settings[pr+'image'+x].metadata_kvps[k].v){if(settings[pr+'image'+x].metadata_kvps[k].k==='class'){$('#'+pr+'image'+x).addClass(settings[pr+'image'+x].metadata_kvps[k].v);}else{$('#'+pr+'image'+x).attr(settings[pr+'image'+x].metadata_kvps[k].k,settings[pr+'image'+x].metadata_kvps[k].v);}}}}
buildImageN(image_dims[pr+'image'+x],$('#'+pr+'image'+x+'_wrapper'),$('#'+pr+'image'+x),pr+'image'+x,settings[pr+'image'+x]);}}}}
catch(e){BOX_CUSTOM_JS.logError(e,'buildImages');}}
function buildImageN(el_dims,el_wrapper,el,prop_name,prop){try{if(prop.display&&prop.src&&prop.src!=='none'&&prop.src.length>5){var src=PROTOCOL_USER_OVERRIDE+'s3.lightboxcdn.com/vendors/'+VENDOR_GUID+'/uploads/'+prop.src;var img=new Image();img.onload=function(){el_dims.width=this.width;el_dims.height=this.height;resizeImage(el_dims,el_wrapper,el,prop_name,prop.width,prop.height,false);el_wrapper.show();};ImageSrcMap[prop_name]={img_obj:img,img_src:src,img_element:el};}else{el_wrapper.hide();}}
catch(e){BOX_CUSTOM_JS.logError(e,'buildImageN');}}
function resizeImage(el_dims,el_wrapper,el,prop_name,wrapperWidth,wrapperHeight,isDynamic){try{var prop=settings[prop_name];if(prop.constrain){var width=wrapperWidth-(2*prop.border.width)-(2*prop.padding);if(prop.border.style==='none'||prop.border.width==='0'||prop.border.width===0){width=wrapperWidth-(2*prop.padding);}
var heightCalc=el_dims.height*width/el_dims.width;if(isDynamic&&heightCalc<wrapperHeight-(2*prop.padding)-10){var margin=(wrapperHeight-(2*prop.padding)-heightCalc)/2;el.css({'height':'auto','margin-top':Math.round(margin)+'px'});}else{el.css({'height':'auto'});}
el.width(Math.floor(width));}else{var width=wrapperWidth-(2*prop.border.width)-(2*prop.padding);var height=wrapperHeight-(2*prop.border.width)-(2*prop.padding);if(prop.border.style==='none'||prop.border.width==='0'||prop.border.width===0){width=wrapperWidth-(2*prop.padding);}
if(prop.border.style==='none'||prop.border.width==='0'||prop.border.width===0){height=wrapperHeight-(2*prop.padding);}
el.width(Math.floor(width));el.height(Math.floor(height));}}
catch(e){BOX_CUSTOM_JS.logError(e,'resizeImage');}}
function getBorderStyle(propBorder){var str='';if(typeof propBorder.style==='undefined'||propBorder.style===null||propBorder.style==='none'||propBorder.width==='0'||propBorder.width===0){str+='border-style: none;';str+='border-width: 0px;';}else{str+='border-color: '+propBorder.color+';';str+='border-style: '+propBorder.style+';';str+='border-width: '+propBorder.width+'px'+';';str+='border-radius: '+propBorder.radius+'px'+';';}
return str;}
function getBackgroundStyle(propBackground){var str='';if(propBackground.use_image&&propBackground.image.length>3&&propBackground.image!='none'){str+='background-image: '+'url('+PROTOCOL_USER_OVERRIDE+'s3.lightboxcdn.com/vendors/'+VENDOR_GUID+'/uploads/'+propBackground.image+')'+';';str+='background-position: '+propBackground.position+';';str+='background-color: '+propBackground.color+';';if(propBackground.repeat==='stretch'){str+='-webkit-background-size: cover;';str+='-moz-background-size: cover;';str+='-o-background-size: cover;';str+='background-size: cover;';}else{str+='background-repeat: '+propBackground.repeat+';';}}
else if(!IS_IE_9_OR_LESS&&propBackground.use_gradient&&propBackground.gradient.length>3){str+='background: '+'-webkit-gradient(linear, left top, left bottom, from('+propBackground.color+'),to('+propBackground.gradient+'))'+';';str+='background: '+'-webkit-linear-gradient(top, '+propBackground.color+','+propBackground.gradient+')'+';';str+='background: '+'-o-linear-gradient(top, '+propBackground.color+','+propBackground.gradient+')'+';';str+='background: '+'-moz-linear-gradient(top, '+propBackground.color+','+propBackground.gradient+')'+';';str+='background: '+'-ms-linear-gradient(top, '+propBackground.color+','+propBackground.gradient+')'+';';str+='background: '+'linear-gradient(to bottom,'+propBackground.color+','+propBackground.gradient+')'+';';}
else{str+='background: '+propBackground.color+';';}
return str;}
function getFontStyle(propFont){var str='';var gweight='';if(propFont.family.indexOf('__google__')>=0){var gfam=propFont.family.replace('__google__','');if(gfam.indexOf(':')>0){gweight=gfam.split(':')[1].split("'")[0];gfam=gfam.split(':')[0];str+='font-family: '+gfam+"';";}else{str+='font-family: '+gfam+';';}}else if(propFont.family.indexOf('__custom__')>=0){str+='font-family: '+propFont.family.split('||||')[1]+';';}else{str+='font-family: '+propFont.family+';';}
if(gweight){if(gweight=='Black'){str+='font-weight: 900;';}
if(gweight=='ExtraBold'){str+='font-weight: 800;';}
if(gweight=='Bold'){str+='font-weight: 700;';}
if(gweight=='Light'){str+='font-weight: 300;';}
if(gweight=='ExtraLight'){str+='font-weight: 200;';}
if(gweight=='Thin'){str+='font-weight: 100;';}}else{str+='font-weight: '+(propFont.bold?'bold':'normal')+';';}
str+='font-style:  '+(propFont.italic?'italic':'normal')+';';str+='text-decoration: '+(propFont.underline?'underline':'none')+';';str+='text-align: '+propFont.align+';';str+='font-size: '+propFont.size+'px'+';';str+='color: '+propFont.color+';';if(propFont.hasOwnProperty('vspace')&&propFont.vspace!==null&&propFont.vspace!==''&&propFont.vspace!=='0'&&propFont.vspace!==0){str+='line-height: '+propFont.vspace+'px'+';';}
return str;}
function getWidthStyle(width){var str='';str+='width: '+width+'px'+';';return str;}
function getWidthPercentStyle(width){var str='';str+='width: '+width+'%'+';';return str;}
function getHeightStyle(height){var str='';str+='height: '+height+'px'+';';return str;}
function getHeightPercentStyle(height){var str='';str+='height: '+height+'%'+';';return str;}
function getLineHeightStyle(lineHeight){var str='';str+='line-height: '+lineHeight+'px'+';';return str;}
function getTextAlignStyle(align){var str='';str+='text-align: '+align+';';return str;}
function getDisplayStyle(display){var str='';str+='display: '+(display?'block':'none')+';';return str;}
function getOverflowHiddenStyle(){var str='';str+='overflow: '+'hidden'+';';return str;}
function getOverflowVisibleStyle(){var str='';str+='overflow: '+'visible'+';';return str;}
function getFloatLeftStyle(){var str='';str+='float: '+'left'+';';return str;}
function getFloatRightStyle(){var str='';str+='float: '+'right'+';';return str;}
function getPositionAbsoluteStyle(){var str='';str+='position: '+'absolute'+';';return str;}
function getGeneralStyle(propName,propVal){var str='';str+=propName+': '+propVal+';';return str;}
function getLeftStyle(left){var str='';str+='left: '+left+'px'+';';return str;}
function getTopStyle(top){var str='';str+='top: '+top+'px'+';';return str;}
function getLeftTopWidthHeightStyle(prop){var str='';str+='left: '+prop.x+'px'+';';str+='top: '+prop.y+'px'+';';str+='width: '+prop.width+'px'+';';str+='height: '+prop.height+'px'+';';return str;}
function getTextElementLeftTopWidthHeightStyle(prop){var str='';str+='left: '+prop.x+'px'+';';str+='top: '+prop.y+'px'+';';str+='width: '+(prop.width+5)+'px'+';';str+='height: '+prop.height+'px'+';';return str;}
function getZindexStyle(zindex){var str='';str+='z-index: '+zindex+';';return str;}
function getCursorStyle(curse){var str='';str+='cursor: '+curse+';';return str;}
function buildStyles(pref,force_run){try{var str='';if(typeof pref!=='string'||pref==='main'){pref='';}
if(pref.contains('_')){pref=pref.split('_')[0];}
if(pref!==''&&!BuiltExtraPageStyles.hasOwnProperty(pref)){BuiltExtraPageStyles[pref]=true;}else if(BuiltExtraPageStyles.hasOwnProperty(pref)&&BuiltExtraPageStyles[pref]===true){if(!force_run){return;}}
if(pref===''){$('#element_styles').remove();}else{$('#element_styles_'+pref).remove();}
logger('buildStyles('+pref+')');if(pref===''){str+='.float_left {';str+=getFloatLeftStyle();str+='} ';str+='.float_right {';str+=getFloatRightStyle();str+='} ';}
str+='#'+pref+'layout {';str+=getBorderStyle(settings[pref+'layout'].border);str+=getBackgroundStyle(settings[pref+'layout'].background);if(settings[pref+'layout'].hasOwnProperty('width')&&settings[pref+'layout'].hasOwnProperty('height')){if(settings[pref+'layout'].border.style==='none'||settings[pref+'layout'].border.width==='0'||settings[pref+'layout'].border.width===0){str+=getWidthStyle(settings[pref+'layout'].width);str+=getHeightStyle(settings[pref+'layout'].height);}else{str+=getWidthStyle(settings[pref+'layout'].width-(2*settings[pref+'layout'].border.width));str+=getHeightStyle(settings[pref+'layout'].height-(2*settings[pref+'layout'].border.width));}}else{if(settings['layout'].border.style==='none'||settings['layout'].border.width==='0'||settings['layout'].border.width===0){str+=getWidthStyle(settings['layout'].width);str+=getHeightStyle(settings['layout'].height);}else{str+=getWidthStyle(settings['layout'].width-(2*settings['layout'].border.width));str+=getHeightStyle(settings['layout'].height-(2*settings['layout'].border.width));}}
str+=getOverflowHiddenStyle();str+=getGeneralStyle('margin','0');str+=getGeneralStyle('padding','0');str+='} ';for(var j=1;j<=10;j++){if(settings.hasOwnProperty(pref+'text'+j)&&settings[pref+'text'+j].display){str+='#'+pref+'text'+j+'_wrapper {';str+=getDisplayStyle(settings[pref+'text'+j].display);str+=getPositionAbsoluteStyle();str+=getTextElementLeftTopWidthHeightStyle(settings[pref+'text'+j]);str+='} ';str+='#'+pref+'text'+j+' {';str+=getFontStyle(settings[pref+'text'+j].font);if(settings[pref+'text'+j].hasOwnProperty('css_kvps')){for(var k=0;k<settings[pref+'text'+j].css_kvps.length;k++){if(settings[pref+'text'+j].css_kvps[k].k&&settings[pref+'text'+j].css_kvps[k].v){str+=getGeneralStyle(settings[pref+'text'+j].css_kvps[k].k,settings[pref+'text'+j].css_kvps[k].v);}}}
str+='} ';}
if(settings.hasOwnProperty(pref+'button'+j)&&settings[pref+'button'+j].display){str+='#'+pref+'button'+j+'_wrapper {';str+=getDisplayStyle(settings[pref+'button'+j].display);str+=getPositionAbsoluteStyle();str+=getLeftTopWidthHeightStyle(settings[pref+'button'+j]);str+=getZindexStyle(9000);str+='} ';str+='.'+pref+'button'+j+' {';str+=getFontStyle(settings[pref+'button'+j].font);str+=getBorderStyle(settings[pref+'button'+j].border);str+=getBackgroundStyle(settings[pref+'button'+j].background);str+=getWidthPercentStyle(100);str+=getHeightPercentStyle(100);str+=getCursorStyle('pointer');if(settings[pref+'button'+j].hasOwnProperty('css_kvps')){for(var k=0;k<settings[pref+'button'+j].css_kvps.length;k++){if(settings[pref+'button'+j].css_kvps[k].k&&settings[pref+'button'+j].css_kvps[k].v){str+=getGeneralStyle(settings[pref+'button'+j].css_kvps[k].k,settings[pref+'button'+j].css_kvps[k].v);}}}
str+='} ';str+='.'+pref+'button'+j+'_hover {';str+=getFontStyle(settings[pref+'button'+j].font_hover);str+=getBorderStyle(settings[pref+'button'+j].border_hover);str+=getBackgroundStyle(settings[pref+'button'+j].background_hover);str+=getCursorStyle('pointer');str+='} ';str+='.'+pref+'button'+j+'_focus {';str+=getFontStyle(settings[pref+'button'+j].font_focus);str+=getBorderStyle(settings[pref+'button'+j].border_focus);str+=getBackgroundStyle(settings[pref+'button'+j].background_focus);str+=getCursorStyle('pointer');str+='} ';}
if(settings.hasOwnProperty(pref+'image'+j)&&settings[pref+'image'+j].display){str+='#'+pref+'image'+j+'_wrapper {';str+=getDisplayStyle(settings[pref+'image'+j].display);str+=getPositionAbsoluteStyle();str+=getLeftTopWidthHeightStyle(settings[pref+'image'+j]);str+=getTextAlignStyle('center');str+='} ';str+='#'+pref+'image'+j+' {';str+=getBorderStyle(settings[pref+'image'+j].border);str+=getGeneralStyle('padding',settings[pref+'image'+j].padding+'px');if(settings[pref+'image'+j].width>=settings[pref+'image'+j].height){str+=getGeneralStyle('max-width',settings[pref+'image'+j].width+'px');str+=getGeneralStyle('max-height',settings[pref+'image'+j].width+'px');}else{str+=getGeneralStyle('max-width',settings[pref+'image'+j].height+'px');str+=getGeneralStyle('max-height',settings[pref+'image'+j].height+'px');}
if(settings[pref+'image'+j].hasOwnProperty('css_kvps')){for(var k=0;k<settings[pref+'image'+j].css_kvps.length;k++){if(settings[pref+'image'+j].css_kvps[k].k&&settings[pref+'image'+j].css_kvps[k].v){str+=getGeneralStyle(settings[pref+'image'+j].css_kvps[k].k,settings[pref+'image'+j].css_kvps[k].v);}}}
str+='} ';}
if(settings.hasOwnProperty(pref+'html'+j)&&settings[pref+'html'+j].display){str+='#'+pref+'html'+j+'_wrapper {';str+=getDisplayStyle(settings[pref+'html'+j].display);str+=getPositionAbsoluteStyle();str+=getLeftTopWidthHeightStyle(settings[pref+'html'+j]);str+='} ';str+='#'+pref+'html'+j+' {';if(settings[pref+'html'+j].hasOwnProperty('css_kvps')){for(var k=0;k<settings[pref+'html'+j].css_kvps.length;k++){if(settings[pref+'html'+j].css_kvps[k].k&&settings[pref+'html'+j].css_kvps[k].v){str+=getGeneralStyle(settings[pref+'html'+j].css_kvps[k].k,settings[pref+'html'+j].css_kvps[k].v);}}}
str+='} ';}}
if(pref!==''){pref+='_';}
if(settings.hasOwnProperty(pref+'form')){str+='#'+pref+'form_wrapper {';str+=getDisplayStyle(settings[pref+'form'].display);str+=getPositionAbsoluteStyle();str+=getLeftTopWidthHeightStyle(settings[pref+'form']);str+='} ';str+='.'+pref+'form_spacing {';str+=getGeneralStyle('margin-top',settings[pref+'inputs'].spacing+'px');str+='} ';str+='.'+pref+'form_labels {';str+=getFontStyle(settings[pref+'labels'].font);str+=getOverflowHiddenStyle();str+='} ';str+='.'+pref+'form_labels_left {';str+=getFloatLeftStyle();str+=getWidthPercentStyle(settings[pref+'labels'].width);str+=getHeightStyle(settings[pref+'inputs'].height);str+=getLineHeightStyle(settings[pref+'inputs'].height);str+='} ';str+='.'+pref+'form_labels_above {';str+=getFloatRightStyle();str+=getWidthPercentStyle(100);str+=getGeneralStyle('margin-bottom','5px');str+='} ';str+='.'+pref+'form_labels_hide {';str+=getDisplayStyle(false);str+='} ';str+='.'+pref+'form_labels_required {';str+=getGeneralStyle('color',settings[pref+'labels'].required.color);str+=getGeneralStyle('margin-left','3px');str+=getGeneralStyle('font-size',((settings[pref+'labels'].required.text=='*')?(parseInt(settings[pref+'labels'].font.size)+4):(parseInt(settings[pref+'labels'].font.size)-2))+'px');str+='} ';str+='.'+pref+'form_inputs {';str+=getBorderStyle(settings[pref+'inputs'].border);str+=getBackgroundStyle(settings[pref+'inputs'].background);str+=getFontStyle(settings[pref+'inputs'].font);str+=getWidthPercentStyle(100);str+=getHeightStyle(settings[pref+'inputs'].height);str+=getOverflowHiddenStyle();str+=getGeneralStyle('-webkit-box-sizing','border-box');str+=getGeneralStyle('-moz-box-sizing','border-box');str+=getGeneralStyle('box-sizing','border-box');str+=getGeneralStyle('padding-left','5px');str+=getGeneralStyle('padding-right','5px');str+='} ';if(settings[pref+'inputs'].hasOwnProperty('placeholder_color')){str+='::placeholder {opacity: 1; color:'+settings[pref+'inputs'].placeholder_color+'} ';str+=':-ms-input-placeholder {color:'+settings[pref+'inputs'].placeholder_color+'} ';str+='::-ms-input-placeholder {color:'+settings[pref+'inputs'].placeholder_color+'} ';}
str+='.'+pref+'form_inputs_hover {';str+=getBorderStyle(settings[pref+'inputs'].border_hover);str+=getBackgroundStyle(settings[pref+'inputs'].background_hover);str+='} ';str+='.'+pref+'form_inputs_focus {';str+=getBorderStyle(settings[pref+'inputs'].border_focus);str+=getBackgroundStyle(settings[pref+'inputs'].background_focus);str+='} ';str+='.'+pref+'form_inputs_error {';str+=getBorderStyle(settings[pref+'inputs'].border_error);str+=getBackgroundStyle(settings[pref+'inputs'].background_error);str+='} ';str+='.'+pref+'form_inputs_error_text {';str+=getDisplayStyle(false);str+=getGeneralStyle('text-align','left');str+=getGeneralStyle('color',settings[pref+'inputs'].border_error.color);str+=getGeneralStyle('font-family',settings[pref+'labels'].font.family);str+=getGeneralStyle('font-size','11px');str+=getGeneralStyle('margin-top','2px');str+=getGeneralStyle('margin-left','2px');str+=getOverflowHiddenStyle();str+=getWidthPercentStyle(100);str+='} ';str+='.'+pref+'form_inputs_help {';str+=getGeneralStyle('text-align','left');str+=getGeneralStyle('color',settings[pref+'labels'].font.color);str+=getGeneralStyle('font-family',settings[pref+'labels'].font.family);str+=getGeneralStyle('font-size','11px');str+=getGeneralStyle('margin-top','2px');str+=getGeneralStyle('margin-left','2px');str+=getOverflowHiddenStyle();str+=getWidthPercentStyle(100);str+='} ';str+='.'+pref+'form_inputs_wrapper {';str+=getGeneralStyle('padding','0');str+=getFloatRightStyle();str+=getOverflowVisibleStyle();str+=getWidthPercentStyle((settings[pref+'labels'].position=='left')?(100-settings[pref+'labels'].width-2):100);str+='} ';if(settings.hasOwnProperty(pref+'opt_in')&&settings[pref+'opt_in'].display){str+='#'+pref+'form_input_opt_in_wrapper  {';str+=(settings[pref+'opt_in'].align=='inputs'||settings[pref+'labels'].position!='left')?getFloatRightStyle():getFloatLeftStyle();str+=getWidthPercentStyle((settings[pref+'opt_in'].align=='inputs'&&settings[pref+'labels'].position=='left')?(100-settings[pref+'labels'].width-2):100);str+=getGeneralStyle('margin-top',settings[pref+'opt_in'].margin+'px');str+='} ';str+='#'+pref+'form_input_opt_in {';str+=getFloatLeftStyle();str+=getGeneralStyle('margin','0');str+='} ';str+='#'+pref+'form_input_opt_in_text {';str+=getGeneralStyle('margin','0');str+=getFontStyle(settings[pref+'opt_in'].font);str+=getLineHeightStyle(settings[pref+'opt_in'].font.size);str+='} ';}
var checkboxCnt=0;var checkboxSequentialFloatMatchCtr=0;var previousCbPropName='';for(var n=1;n<=20;n++){var propName=pref+'custom'+n;if(settings.hasOwnProperty(propName)&&settings[propName].display&&settings[propName].hasOwnProperty('field_type')&&settings[propName]['field_type']==='radio'&&settings[propName].radio){str+='.'+pref+'form_custom'+n+'_radio_labels {';str+=getLineHeightStyle(settings[propName].radio.font.size);str+=getFontStyle(settings[propName].radio.font);str+=getGeneralStyle('margin-left','5px');str+='} ';str+='.'+pref+'form_custom'+n+'_radio_inputs {';str+=getGeneralStyle('width',settings[propName].radio.size+'px');str+=getGeneralStyle('height',settings[propName].radio.size+'px');str+=getGeneralStyle('margin-top','-3px');str+=getGeneralStyle('vertical-align','middle');str+='} ';}
else if(settings.hasOwnProperty(propName)&&settings[propName].display&&settings[propName].hasOwnProperty('field_type')&&settings[propName]['field_type']==='checkbox'&&settings[propName].checkbox){checkboxCnt++;str+='#'+pref+'form_input_custom'+n+'_checkbox_wrapper {';if(settings[propName].checkbox.align=='inputs'||(settings[propName].checkbox.align=='form'&&settings[pref+'labels'].position!='left')){checkboxSequentialFloatMatchCtr=0;str+=getFloatRightStyle();if(settings[propName].checkbox.align=='inputs'&&settings[pref+'labels'].position=='left'){var inputsConcreteWidth=Math.floor(settings[pref+'form'].width*(100-settings[pref+'labels'].width)/100);str+=getWidthStyle(inputsConcreteWidth-7);}else{str+=getWidthStyle(settings[pref+'form'].width-2);}}else if(settings[propName].checkbox.align=='form'&&settings[pref+'labels'].position=='left'){checkboxSequentialFloatMatchCtr=0;str+=getFloatLeftStyle();str+=getWidthStyle(settings[pref+'form'].width-2);}else if(settings[propName].checkbox.align=='float2col'){checkboxSequentialFloatMatchCtr++;str+=getFloatLeftStyle();var spacing=settings[pref+'inputs'].spacing;if(spacing<10)spacing=10;if(spacing>30)spacing=30;if(checkboxSequentialFloatMatchCtr%2===1){str+=getGeneralStyle('margin-right',spacing+'px');}
str+=getWidthStyle(Math.floor((settings[pref+'form'].width-spacing-4)/2));}
if(settings[pref+'inputs'].hasOwnProperty('checkboxes_margin')&&settings[pref+'inputs'].checkboxes_margin&&(checkboxCnt==1||(checkboxCnt==2&&settings[propName].checkbox.align=='float2col'&&settings[previousCbPropName].checkbox.align=='float2col'))){str+=getGeneralStyle('margin-top',(settings[pref+'inputs'].spacing+settings[pref+'inputs'].checkboxes_margin)+'px');}else{str+=getGeneralStyle('margin-top',settings[pref+'inputs'].spacing+'px');}
str+='} ';str+='#'+pref+'form_input_custom'+n+' {';str+=getFloatLeftStyle();str+=getGeneralStyle('margin','0');str+='} ';str+='#'+pref+'form_input_custom'+n+'_checkbox_text {';str+=getGeneralStyle('margin','0');str+=getLineHeightStyle(settings[propName].checkbox.font.size);str+=getFontStyle(settings[propName].checkbox.font);str+='} ';previousCbPropName=propName;}
else if(settings.hasOwnProperty(propName)&&settings[propName].display&&(!settings[propName].hasOwnProperty('field_type')||settings[propName]['field_type']!=='hidden')){checkboxSequentialFloatMatchCtr=0;logger('(BOX #'+LIGHTBOX_SHORT_ID+') - '+propName+' checkbox not found.');}}}
if(pref.contains('_')){pref=pref.split('_')[0];}
if(pref===''){$('head').append('<style id="element_styles" type="text/css">'+str+'</style>');}else{$('head').append('<style id="element_styles_'+pref+'" type="text/css">'+str+'</style>');}}
catch(e){BOX_CUSTOM_JS.logError(e,'buildStyles');}}
function isNullOrWhitespace(input){if(typeof input==='undefined'||input==null)return true;return input.replace(/\s/g,'').length<1;}
function buildFormName(pref,form_ele){if(pref!==''&&pref.indexOf('_')===-1){pref+='_';}
if(settings.hasOwnProperty(pref+'name')&&settings[pref+'name'].display){form_ele.append("<div id='"+pref+"form_label_name' class='"+pref+"form_labels'>"+settings[pref+'name'].label+"<span id='"+pref+"form_label_name_required' class='"+pref+"form_labels_required'></span></div>");if(settings[pref+'name'].require&&settings[pref+'labels'].required.text.length>0){$('#'+pref+'form_label_name_required').text(settings[pref+'labels'].required.text);}
if(settings[pref+'labels'].position=='left'){$('#'+pref+'form_label_name').addClass(pref+'form_labels_left');}else if(settings[pref+'labels'].position=='above'){$('#'+pref+'form_label_name').addClass(pref+'form_labels_above');if(isNullOrWhitespace(settings[pref+'name'].label)){$('#'+pref+'form_label_name').css({'height':'0px'});}}else{$('#'+pref+'form_label_name').addClass(pref+'form_labels_hide');}
if(settings[pref+'name'].mode=='full'){form_ele.append("<label id='"+pref+"form_input_name_ada_label' for='"+pref+"form_input_full_name' style='border: 0;clip: rect(0 0 0 0);height: 1px;width: 1px;margin: -1px;overflow: hidden;padding: 0;position: absolute;'>"+settings[pref+'name'].label+"</label>");form_ele.append("<div id='"+pref+"form_input_full_name_wrapper' class='"+pref+"form_inputs_wrapper'><input type='text' id='"+pref+"form_input_full_name' class='"+pref+"form_inputs' /><div id='"+pref+"form_input_full_name_help' class='"+pref+"form_inputs_help'></div><div id='"+pref+"form_input_name_error_text' class='"+pref+"form_inputs_error_text'></div></div><div style='float: none; clear: both;'></div>");if(settings[pref+'name'].default_full){$('#'+pref+'form_input_full_name').val(settings[pref+'name'].default_full);}
if(settings[pref+'name'].placeholder_full){$('#'+pref+'form_input_full_name').attr('placeholder',settings[pref+'name'].placeholder_full);}
if(settings[pref+'name'].display_help){$('#'+pref+'form_input_full_name_help').text(settings[pref+'name'].help_full);}else{$('#'+pref+'form_input_full_name_help').hide();}
$('#'+pref+'form_input_full_name').hover(function(){$(this).addClass(pref+"form_inputs_hover");},function(){$(this).removeClass(pref+"form_inputs_hover");});$('#'+pref+'form_input_full_name').focus(function(){$(this).addClass(pref+"form_inputs_focus");}).blur(function(){$(this).removeClass(pref+"form_inputs_focus");});$('#'+pref+'form_input_full_name').keypress(function(e){if(e.which==13){e.preventDefault();processSubmit(pref);}});}else if(settings[pref+'name'].mode=='first'){form_ele.append("<label id='"+pref+"form_input_name_ada_label' for='"+pref+"form_input_first_name' style='border: 0;clip: rect(0 0 0 0);height: 1px;width: 1px;margin: -1px;overflow: hidden;padding: 0;position: absolute;'>"+settings[pref+'name'].label+"</label>");form_ele.append("<div id='"+pref+"form_input_first_name_wrapper' class='"+pref+"form_inputs_wrapper'><input type='text' id='"+pref+"form_input_first_name' class='"+pref+"form_inputs' /><div id='"+pref+"form_input_first_name_help' class='"+pref+"form_inputs_help'></div><div id='"+pref+"form_input_name_error_text' class='"+pref+"form_inputs_error_text'></div></div><div style='float: none; clear: both;'></div>");if(settings[pref+'name'].default_first){$('#'+pref+'form_input_first_name').val(settings[pref+'name'].default_first);}
if(settings[pref+'name'].placeholder_first){$('#'+pref+'form_input_first_name').attr('placeholder',settings[pref+'name'].placeholder_first);}
if(settings[pref+'name'].display_help){$('#'+pref+'form_input_first_name_help').text(settings[pref+'name'].help_first);}else{$('#'+pref+'form_input_first_name_help').hide();}
$('#'+pref+'form_input_first_name').hover(function(){$(this).addClass(pref+"form_inputs_hover");},function(){$(this).removeClass(pref+"form_inputs_hover");});$('#'+pref+'form_input_first_name').focus(function(){$(this).addClass(pref+"form_inputs_focus");}).blur(function(){$(this).removeClass(pref+"form_inputs_focus");});$('#'+pref+'form_input_first_name').keypress(function(e){if(e.which==13){e.preventDefault();processSubmit(pref);}});}else if(settings[pref+'name'].mode=='both'){form_ele.append("<label id='"+pref+"form_input_name_ada_label' for='"+pref+"form_input_first_name' style='border: 0;clip: rect(0 0 0 0);height: 1px;width: 1px;margin: -1px;overflow: hidden;padding: 0;position: absolute;'>"+settings[pref+'name'].label+"</label>");if(settings[pref+'name'].arrange=='horizontal'){form_ele.append("<div id='"+pref+"form_input_first_and_last_name_wrapper' class='"+pref+"form_inputs_wrapper'>  <div id='"+pref+"form_input_first_name_wrapper'><input type='text' id='"+pref+"form_input_first_name' class='"+pref+"form_inputs' /><div id='"+pref+"form_input_first_name_help' class='"+pref+"form_inputs_help'></div></div>  <div id='"+pref+"form_input_last_name_wrapper'><input type='text' id='"+pref+"form_input_last_name' class='"+pref+"form_inputs' /><div id='"+pref+"form_input_last_name_help' class='"+pref+"form_inputs_help'></div></div>  <div id='"+pref+"form_input_name_error_text' class='"+pref+"form_inputs_error_text'></div>  </div>  <div style='float: none; clear: both;'></div>");$('#'+pref+'form_input_last_name_wrapper').css({"float":'right',"width":'48%'});$('#'+pref+'form_input_first_name_wrapper').css({"float":'left',"width":'48%'});}else{form_ele.append("<div id='"+pref+"form_input_first_and_last_name_wrapper' class='"+pref+"form_inputs_wrapper'>  <div id='"+pref+"form_input_first_name_wrapper'><input type='text' id='"+pref+"form_input_first_name' class='"+pref+"form_inputs' /><div id='"+pref+"form_input_first_name_help' class='"+pref+"form_inputs_help'></div></div>  <div id='"+pref+"form_input_last_name_wrapper'><input type='text' id='"+pref+"form_input_last_name' class='"+pref+"form_inputs' /><div id='"+pref+"form_input_last_name_help' class='"+pref+"form_inputs_help'></div></div>  <div id='"+pref+"form_input_name_error_text' class='"+pref+"form_inputs_error_text'></div>  </div>  <div style='float: none; clear: both;'></div>");$('#'+pref+'form_input_last_name_wrapper').css({"float":'right',"width":'100%',"margin-top":settings[pref+'inputs'].spacing+'px'});$('#'+pref+'form_input_first_name_wrapper').css({"float":'right',"width":'100%'});}
if(settings[pref+'name'].default_last){$('#'+pref+'form_input_last_name').val(settings[pref+'name'].default_last);}
if(settings[pref+'name'].default_first){$('#'+pref+'form_input_first_name').val(settings[pref+'name'].default_first);}
if(settings[pref+'name'].placeholder_last){$('#'+pref+'form_input_last_name').attr('placeholder',settings[pref+'name'].placeholder_last);}
if(settings[pref+'name'].placeholder_first){$('#'+pref+'form_input_first_name').attr('placeholder',settings[pref+'name'].placeholder_first);}
if(settings[pref+'name'].display_help){$('#'+pref+'form_input_last_name_help').text(settings[pref+'name'].help_last);}else{$('#'+pref+'form_input_last_name_help').hide();}
if(settings[pref+'name'].display_help){$('#'+pref+'form_input_first_name_help').text(settings[pref+'name'].help_first);}else{$('#'+pref+'form_input_first_name_help').hide();}
$('#'+pref+'form_input_last_name').hover(function(){$(this).addClass(pref+"form_inputs_hover");},function(){$(this).removeClass(pref+"form_inputs_hover");});$('#'+pref+'form_input_last_name').focus(function(){$(this).addClass(pref+"form_inputs_focus");}).blur(function(){$(this).removeClass(pref+"form_inputs_focus");});$('#'+pref+'form_input_first_name').hover(function(){$(this).addClass(pref+"form_inputs_hover");},function(){$(this).removeClass(pref+"form_inputs_hover");});$('#'+pref+'form_input_first_name').focus(function(){$(this).addClass(pref+"form_inputs_focus");}).blur(function(){$(this).removeClass(pref+"form_inputs_focus");});$('#'+pref+'form_input_last_name').keypress(function(e){if(e.which==13){e.preventDefault();processSubmit(pref);}});$('#'+pref+'form_input_first_name').keypress(function(e){if(e.which==13){e.preventDefault();processSubmit(pref);}});}}}
function buildFormEmail(pref,form_ele){if(pref!==''){pref+='_';}
if(settings.hasOwnProperty(pref+'email')&&settings[pref+'email'].display){form_ele.append("<label id='"+pref+"form_input_email_ada_label' for='"+pref+"form_input_email' style='border: 0;clip: rect(0 0 0 0);height: 1px;width: 1px;margin: -1px;overflow: hidden;padding: 0;position: absolute;'>"+settings[pref+'email'].label+"</label>");form_ele.append("<div id='"+pref+"form_label_email' class='"+pref+"form_labels "+pref+"form_spacing'>"+settings[pref+'email'].label+"<span id='"+pref+"form_label_email_required' class='"+pref+"form_labels_required'></span></div>");form_ele.append("<div id='"+pref+"form_input_email_wrapper' class='"+pref+"form_inputs_wrapper'><input type='text' id='"+pref+"form_input_email' class='"+pref+"form_inputs' /><div id='"+pref+"form_input_email_help' class='"+pref+"form_inputs_help'></div><div id='"+pref+"form_input_email_error_text' class='"+pref+"form_inputs_error_text'></div></div><div style='float: none; clear: both;'></div>");if(settings[pref+'email'].require&&settings[pref+'labels'].required.text.length>0){$('#'+pref+'form_label_email_required').text(settings[pref+'labels'].required.text);}
if(settings[pref+'labels'].position=='left'){$('#'+pref+'form_label_email').addClass(pref+'form_labels_left');$('#'+pref+'form_input_email_wrapper').addClass(pref+'form_spacing');}else if(settings[pref+'labels'].position=='above'){$('#'+pref+'form_label_email').addClass(pref+'form_labels_above');if(isNullOrWhitespace(settings[pref+'email'].label)){$('#'+pref+'form_label_email').css({'height':'0px'});}}else{$('#'+pref+'form_label_email').addClass(pref+'form_labels_hide');$('#'+pref+'form_input_email_wrapper').addClass(pref+'form_spacing');}
if(settings[pref+'email']['default']){$('#'+pref+'form_input_email').val(settings[pref+'email']['default']);}
if(settings[pref+'email'].placeholder){$('#'+pref+'form_input_email').attr('placeholder',settings[pref+'email'].placeholder);}
if(settings[pref+'email'].display_help){$('#'+pref+'form_input_email_help').text(settings[pref+'email'].help);}else{$('#'+pref+'form_input_email_help').hide();}
$('#'+pref+'form_input_email').hover(function(){$(this).addClass(pref+"form_inputs_hover");},function(){$(this).removeClass(pref+"form_inputs_hover");});$('#'+pref+'form_input_email').focus(function(){$(this).addClass(pref+"form_inputs_focus");}).blur(function(){$(this).removeClass(pref+"form_inputs_focus");});$('#'+pref+'form_input_email').keypress(function(e){if(e.which==13){e.preventDefault();processSubmit(pref);}});}}
function buildFormPhone(pref,form_ele){if(pref!==''){pref+='_';}
if(settings.hasOwnProperty(pref+'phone')&&settings[pref+'phone'].display){form_ele.append("<label id='"+pref+"form_input_phone_ada_label' for='"+pref+"form_input_phone' style='border: 0;clip: rect(0 0 0 0);height: 1px;width: 1px;margin: -1px;overflow: hidden;padding: 0;position: absolute;'>"+settings[pref+'phone'].label+"</label>");form_ele.append("<div id='"+pref+"form_label_phone' class='"+pref+"form_labels "+pref+"form_spacing'>"+settings[pref+'phone'].label+"<span id='"+pref+"form_label_phone_required' class='"+pref+"form_labels_required'></span></div>");form_ele.append("<div id='"+pref+"form_input_phone_wrapper' class='"+pref+"form_inputs_wrapper'><input type='text' id='"+pref+"form_input_phone' class='"+pref+"form_inputs' /><div id='"+pref+"form_input_phone_help' class='"+pref+"form_inputs_help'></div><div id='"+pref+"form_input_phone_error_text' class='"+pref+"form_inputs_error_text'></div></div><div style='float: none; clear: both;'></div>");if(settings[pref+'phone'].require&&settings[pref+'labels'].required.text.length>0){$('#'+pref+'form_label_phone_required').text(settings[pref+'labels'].required.text);}
if(settings[pref+'labels'].position=='left'){$('#'+pref+'form_label_phone').addClass(pref+'form_labels_left');$('#'+pref+'form_input_phone_wrapper').addClass(pref+'form_spacing');}else if(settings[pref+'labels'].position=='above'){$('#'+pref+'form_label_phone').addClass(pref+'form_labels_above');if(isNullOrWhitespace(settings[pref+'phone'].label)){$('#'+pref+'form_label_phone').css({'height':'0px'});}}else{$('#'+pref+'form_label_phone').addClass(pref+'form_labels_hide');$('#'+pref+'form_input_phone_wrapper').addClass(pref+'form_spacing');}
if(settings[pref+'phone']['default']){$('#'+pref+'form_input_phone').val(settings[pref+'phone']['default']);}
if(settings[pref+'phone'].placeholder){$('#'+pref+'form_input_phone').attr('placeholder',settings[pref+'phone'].placeholder);}
if(settings[pref+'phone'].display_help){$('#'+pref+'form_input_phone_help').text(settings[pref+'phone'].help);}else{$('#'+pref+'form_input_phone_help').hide();}
$('#'+pref+'form_input_phone').hover(function(){$(this).addClass(pref+"form_inputs_hover");},function(){$(this).removeClass(pref+"form_inputs_hover");});$('#'+pref+'form_input_phone').focus(function(){$(this).addClass(pref+"form_inputs_focus");}).blur(function(){$(this).removeClass(pref+"form_inputs_focus");});$('#'+pref+'form_input_phone').keypress(function(e){if(e.which==13){e.preventDefault();processSubmit(pref);}});}}
function buildFormOptIn(pref,form_ele){if(pref!==''){pref+='_';}
if(settings.hasOwnProperty(pref+'opt_in')&&settings[pref+'opt_in'].display){form_ele.append("<div id='"+pref+"form_input_opt_in_wrapper'><input type='checkbox' id='"+pref+"form_input_opt_in' /><p id='"+pref+"form_input_opt_in_text'>"+settings[pref+'opt_in'].text+"</p> <div style='float: none; clear: both;'></div> <div id='"+pref+"form_input_opt_in_error_text' class='"+pref+"form_inputs_error_text'></div></div>");if(settings[pref+'opt_in'].font.size<=10){$('#'+pref+'form_input_opt_in_text').css({"margin-top":"2px","margin-left":"20px"});}else if(settings[pref+'opt_in'].font.size>10&&settings[pref+'opt_in'].font.size<14){$('#'+pref+'form_input_opt_in_text').css({"margin-top":"1px","margin-left":"20px"});}else if(settings[pref+'opt_in'].font.size>=14){$('#'+pref+'form_input_opt_in_text').css({"margin-top":"-1px","margin-left":"20px"});}
if(settings[pref+'opt_in'].hasOwnProperty('default')&&settings[pref+'opt_in'].default==='on'){$("#"+pref+"form_input_opt_in").prop('checked',true).attr('checked','checked');}
$('#'+pref+"form_input_opt_in").keypress(function(e){if((e.keyCode?e.keyCode:e.which)==13){$(this).trigger('click');}});$('#'+pref+"form_input_opt_in").change(function(){if(this.checked){$(this).attr('checked','checked');}else{$(this).removeAttr('checked');}});}}
function buildFormCustomN(pref,propName,form_ele){if(pref&&pref!==''&&pref.indexOf('_')===-1){pref+='_';}
var customN=propName;if(propName.indexOf('_')>0&&propName.indexOf('custom')>0){customN=propName.split('_')[1];}
var n=propName.split('custom')[1];if(settings.hasOwnProperty(propName)&&settings[propName].display){if(settings[propName].hasOwnProperty('align')&&settings[propName].align=='h'&&settings[propName].hasOwnProperty('field_type')&&settings[propName].field_type!=='radio'&&settings[propName].field_type!=='checkbox'&&settings[propName].field_type!=='hidden'){form_ele.append("<div id='"+pref+"form_float_"+customN+"' style=''></div>");form_ele=$('#'+pref+"form_float_"+customN);var consecutiveCnt=1;for(var w=n-1;w>0;w--){if(settings.hasOwnProperty(pref+'custom'+w)&&settings[pref+'custom'+w].display&&settings[pref+'custom'+w].hasOwnProperty('align')&&settings[pref+'custom'+w].align=='h'&&settings[pref+'custom'+w].hasOwnProperty('field_type')&&settings[pref+'custom'+w].field_type!=='radio'&&settings[pref+'custom'+w].field_type!=='checkbox'&&settings[pref+'custom'+w].field_type!=='hidden'){consecutiveCnt++;}else{break;}}
if(consecutiveCnt>1){var fieldWidth=(settings[pref+'form'].width/consecutiveCnt)-(settings.inputs.spacing*(consecutiveCnt-1)/consecutiveCnt);for(var w=n;w>(n-consecutiveCnt);w--){$('#'+pref+"form_float_custom"+w).css({'width':fieldWidth+'px','float':'left'});if(w>n-consecutiveCnt+1){$('#'+pref+"form_float_custom"+w).css({'margin-left':settings.inputs.spacing+'px'});if($('#'+pref+"form_float_custom"+w+"_clear").length){$('#'+pref+"form_float_custom"+w+"_clear").remove();}}}
form_ele.after("<div id='"+pref+"form_float_"+customN+"_clear' style='float:none;clear:both;'></div>");}}
if(settings[propName].hasOwnProperty('field_type')&&settings[propName].field_type!=='checkbox'&&settings[propName].field_type!=='radio'&&settings[propName].field_type!=='hidden'){form_ele.append("<label id='"+pref+"form_input_"+customN+"_ada_label' for='"+pref+"form_input_"+customN+"' style='border: 0;clip: rect(0 0 0 0);height: 1px;width: 1px;margin: -1px;overflow: hidden;padding: 0;position: absolute;'>"+settings[propName].label+"</label>");}
if(!settings[propName].hasOwnProperty('field_type')||settings[propName].field_type=='textbox'){form_ele.append("<div id='"+pref+"form_label_"+customN+"' class='"+pref+"form_labels "+pref+"form_spacing'>"+settings[propName].label+"<span id='"+pref+"form_label_"+customN+"_required' class='"+pref+"form_labels_required'></span></div>");form_ele.append("<div id='"+pref+"form_input_"+customN+"_wrapper' class='"+pref+"form_inputs_wrapper'><input type='text' id='"+pref+"form_input_"+customN+"' class='"+pref+"form_inputs' /><div id='"+pref+"form_input_"+customN+"_help' class='"+pref+"form_inputs_help'></div><div id='"+pref+"form_input_"+customN+"_error_text' class='"+pref+"form_inputs_error_text'></div></div><div style='float: none; clear: both;'></div>");if(settings[propName].placeholder){$('#'+pref+'form_input_'+customN).attr('placeholder',settings[propName].placeholder);}
if(settings[propName]['default']){$('#'+pref+'form_input_'+customN).val(settings[propName]['default']);}}else if(settings[propName].field_type=='textarea'){form_ele.append("<div id='"+pref+"form_label_"+customN+"' class='"+pref+"form_labels "+pref+"form_spacing'>"+settings[propName].label+"<span id='"+pref+"form_label_"+customN+"_required' class='"+pref+"form_labels_required'></span></div>");form_ele.append("<div id='"+pref+"form_input_"+customN+"_wrapper' class='"+pref+"form_inputs_wrapper'><textarea id='"+pref+"form_input_"+customN+"' class='"+pref+"form_inputs' style='height: "+settings[propName].textarea_height+"px; margin-bottom: 0px;'></textarea><div id='"+pref+"form_input_"+customN+"_help' class='"+pref+"form_inputs_help' style='margin-top: 0px;'></div><div id='"+pref+"form_input_"+customN+"_error_text' class='"+pref+"form_inputs_error_text'></div></div><div style='float: none; clear: both;'></div>");if(settings[propName].placeholder){$('#'+pref+'form_input_'+customN).attr('placeholder',settings[propName].placeholder);}
if(settings[propName]['default']){$('#'+pref+'form_input_'+customN).val(settings[propName]['default']);}}else if(settings[propName].field_type=='datepicker'&&settings[propName].datepicker){form_ele.append("<div id='"+pref+"form_label_"+customN+"' class='"+pref+"form_labels "+pref+"form_spacing'>"+settings[propName].label+"<span id='"+pref+"form_label_"+customN+"_required' class='"+pref+"form_labels_required'></span></div>");form_ele.append("<div id='"+pref+"form_input_"+customN+"_wrapper' class='"+pref+"form_inputs_wrapper'><input type='text' id='"+pref+"form_input_"+customN+"' class='"+pref+"form_inputs' /><div id='"+pref+"form_input_"+customN+"_help' class='"+pref+"form_inputs_help'></div><div id='"+pref+"form_input_"+customN+"_error_text' class='"+pref+"form_inputs_error_text'></div></div><div style='float: none; clear: both;'></div>");if(!isNullOrWhiteSpace(settings[propName]['placeholder'])){$('#'+pref+'form_input_'+customN).attr('placeholder',settings[propName].placeholder);}
initDatepicker(pref,propName,customN);}else if(settings[propName].field_type=='datedrop'&&settings[propName].datedrop){form_ele.append("<div id='"+pref+"form_label_"+customN+"' class='"+pref+"form_labels "+pref+"form_spacing'>"+settings[propName].label+"<span id='"+pref+"form_label_"+customN+"_required' class='"+pref+"form_labels_required'></span></div>");if(settings[propName].datedrop.display_format=="MM-dd-yyyy"||settings[propName].datedrop.display_format==""){var append_html="<div id='"+pref+"form_input_"+customN+"_wrapper' class='"+pref+"form_inputs_wrapper'>";append_html+="<div id='"+pref+"form_input_"+customN+"_datedrop_mm_wrapper'><select id='"+pref+"form_input_"+customN+"_datedrop_mm' class='"+pref+"form_inputs'><option value='MM'>MM</option></select><div id='"+pref+"form_input_"+customN+"_datedrop_mm_help' class='"+pref+"form_inputs_help'></div></div>";append_html+="<div id='"+pref+"form_input_"+customN+"_datedrop_dd_wrapper'><select id='"+pref+"form_input_"+customN+"_datedrop_dd' class='"+pref+"form_inputs'><option value='dd'>DD</option></select><div id='"+pref+"form_input_"+customN+"_datedrop_dd_help' class='"+pref+"form_inputs_help'></div></div>";append_html+="<div id='"+pref+"form_input_"+customN+"_datedrop_yyyy_wrapper'><select id='"+pref+"form_input_"+customN+"_datedrop_yyyy' class='"+pref+"form_inputs'><option value='yyyy'>YYYY</option></select><div id='"+pref+"form_input_"+customN+"_datedrop_yyyy_help' class='"+pref+"form_inputs_help'></div></div>";append_html+="<div id='"+pref+"form_input_"+customN+"_help' class='"+pref+"form_inputs_help'></div><div id='"+pref+"form_input_"+customN+"_error_text' class='"+pref+"form_inputs_error_text'></div>";append_html+="</div>";append_html+="<div style='float: none; clear: both;'></div>";form_ele.append(append_html);$('#'+pref+"form_input_"+customN+"_datedrop_yyyy_wrapper").css({"float":'right',"width":'38%'});$('#'+pref+"form_input_"+customN+"_datedrop_mm_wrapper").css({"float":'left',"width":'28%',"margin-right":"3%"});$('#'+pref+"form_input_"+customN+"_datedrop_dd_wrapper").css({"float":'left',"width":'28%'});}else if(settings[propName].datedrop.display_format=="dd-MM-yyyy"){var append_html="<div id='"+pref+"form_input_"+customN+"_wrapper' class='"+pref+"form_inputs_wrapper'>";append_html+="<div id='"+pref+"form_input_"+customN+"_datedrop_dd_wrapper'><select id='"+pref+"form_input_"+customN+"_datedrop_dd' class='"+pref+"form_inputs'><option value='dd'>DD</option></select><div id='"+pref+"form_input_"+customN+"_datedrop_dd_help' class='"+pref+"form_inputs_help'></div></div>";append_html+="<div id='"+pref+"form_input_"+customN+"_datedrop_mm_wrapper'><select id='"+pref+"form_input_"+customN+"_datedrop_mm' class='"+pref+"form_inputs'><option value='MM'>MM</option></select><div id='"+pref+"form_input_"+customN+"_datedrop_mm_help' class='"+pref+"form_inputs_help'></div></div>";append_html+="<div id='"+pref+"form_input_"+customN+"_datedrop_yyyy_wrapper'><select id='"+pref+"form_input_"+customN+"_datedrop_yyyy' class='"+pref+"form_inputs'><option value='yyyy'>YYYY</option></select><div id='"+pref+"form_input_"+customN+"_datedrop_yyyy_help' class='"+pref+"form_inputs_help'></div></div>";append_html+="<div id='"+pref+"form_input_"+customN+"_help' class='"+pref+"form_inputs_help'></div><div id='"+pref+"form_input_"+customN+"_error_text' class='"+pref+"form_inputs_error_text'></div>";append_html+="</div>";append_html+="<div style='float: none; clear: both;'></div>";form_ele.append(append_html);$('#'+pref+"form_input_"+customN+"_datedrop_yyyy_wrapper").css({"float":'right',"width":'38%'});$('#'+pref+"form_input_"+customN+"_datedrop_dd_wrapper").css({"float":'left',"width":'28%',"margin-right":"3%"});$('#'+pref+"form_input_"+customN+"_datedrop_mm_wrapper").css({"float":'left',"width":'28%'});}else if(settings[propName].datedrop.display_format=="yyyy-MM-dd"){var append_html="<div id='"+pref+"form_input_"+customN+"_wrapper' class='"+pref+"form_inputs_wrapper'>";append_html+="<div id='"+pref+"form_input_"+customN+"_datedrop_yyyy_wrapper'><select id='"+pref+"form_input_"+customN+"_datedrop_yyyy' class='"+pref+"form_inputs'><option value='yyyy'>YYYY</option></select><div id='"+pref+"form_input_"+customN+"_datedrop_yyyy_help' class='"+pref+"form_inputs_help'></div></div>";append_html+="<div id='"+pref+"form_input_"+customN+"_datedrop_dd_wrapper'><select id='"+pref+"form_input_"+customN+"_datedrop_dd' class='"+pref+"form_inputs'><option value='dd'>DD</option></select><div id='"+pref+"form_input_"+customN+"_datedrop_dd_help' class='"+pref+"form_inputs_help'></div></div>";append_html+="<div id='"+pref+"form_input_"+customN+"_datedrop_mm_wrapper'><select id='"+pref+"form_input_"+customN+"_datedrop_mm' class='"+pref+"form_inputs'><option value='MM'>MM</option></select><div id='"+pref+"form_input_"+customN+"_datedrop_mm_help' class='"+pref+"form_inputs_help'></div></div>";append_html+="<div id='"+pref+"form_input_"+customN+"_help' class='"+pref+"form_inputs_help'></div><div id='"+pref+"form_input_"+customN+"_error_text' class='"+pref+"form_inputs_error_text'></div>";append_html+="</div>";append_html+="<div style='float: none; clear: both;'></div>";form_ele.append(append_html);$('#'+pref+"form_input_"+customN+"_datedrop_yyyy_wrapper").css({"float":'left',"width":'38%'});$('#'+pref+"form_input_"+customN+"_datedrop_dd_wrapper").css({"float":'right',"width":'28%'});$('#'+pref+"form_input_"+customN+"_datedrop_mm_wrapper").css({"float":'right',"width":'28%',"margin-right":"3%"});}
var dropdown_yyyy=$('#'+pref+'form_input_'+customN+'_datedrop_yyyy');var dropdown_mm=$('#'+pref+'form_input_'+customN+'_datedrop_mm');var dropdown_dd=$('#'+pref+'form_input_'+customN+'_datedrop_dd');var min_date=settings[propName].datedrop.min_date;var max_date=settings[propName].datedrop.max_date;var default_date=settings[propName].datedrop.default_date;var foundSelected=false;var yyyy_min=1900;if(min_date&&min_date.split('/').length==3&&min_date.split('/')[2].trim().length==4){yyyy_min=parseInt(min_date.split('/')[2].trim());}
var date_curr=new Date();var yyyy_max=date_curr.getFullYear();if(max_date&&max_date.split('/').length==3&&max_date.split('/')[2].trim().length==4){yyyy_max=parseInt(max_date.split('/')[2].trim());}
var yyyy_default="";if(default_date&&default_date.split('/').length==3&&default_date.split('/')[2].trim().length==4){yyyy_default=parseInt(default_date.split('/')[2].trim());}
var mm_default="";if(default_date&&default_date.split('/').length==3&&default_date.split('/')[0].trim().length==2){mm_default=parseInt(default_date.split('/')[0].trim());}
var dd_default="";if(default_date&&default_date.split('/').length==3&&default_date.split('/')[1].trim().length==2){dd_default=parseInt(default_date.split('/')[1].trim());}
for(var i=yyyy_min;i<=yyyy_max;i++){if(!foundSelected&&i===yyyy_default){dropdown_yyyy.append("<option selected value='"+i+"'>"+i+"</option>");foundSelected=true;}else{dropdown_yyyy.append("<option value='"+i+"'>"+i+"</option>");}}
foundSelected=false;var mm_disp="";for(var i=1;i<=12;i++){if(i<10)mm_disp="0"+i;else mm_disp=i;if(!foundSelected&&i===mm_default){dropdown_mm.append("<option selected value='"+i+"'>"+mm_disp+"</option>");foundSelected=true;}else{dropdown_mm.append("<option value='"+i+"'>"+mm_disp+"</option>");}}
foundSelected=false;var dd_disp="";for(var i=1;i<=31;i++){if(i<10)dd_disp="0"+i;else dd_disp=i;if(!foundSelected&&i===dd_default){dropdown_dd.append("<option selected value='"+i+"'>"+dd_disp+"</option>");foundSelected=true;}else{dropdown_dd.append("<option value='"+i+"'>"+dd_disp+"</option>");}}}else if(settings[propName].field_type=='dropdown'){form_ele.append("<div id='"+pref+"form_label_"+customN+"' class='"+pref+"form_labels "+pref+"form_spacing'>"+settings[propName].label+"<span id='"+pref+"form_label_"+customN+"_required' class='"+pref+"form_labels_required'></span></div>");form_ele.append("<div id='"+pref+"form_input_"+customN+"_wrapper' class='"+pref+"form_inputs_wrapper'><select id='"+pref+"form_input_"+customN+"' class='"+pref+"form_inputs'></select><div id='"+pref+"form_input_"+customN+"_help' class='"+pref+"form_inputs_help'></div><div id='"+pref+"form_input_"+customN+"_error_text' class='"+pref+"form_inputs_error_text'></div></div><div style='float: none; clear: both;'></div>");if(settings[propName].dropdown_kvps.length>0){var dropdown=$('#'+pref+'form_input_'+customN);var kvps=settings[propName].dropdown_kvps;var foundSelected=false;for(var i=0;i<kvps.length;i++){if(!foundSelected&&settings[propName]['default']&&(kvps[i].k==settings[propName]['default']||kvps[i].v==settings[propName]['default'])){dropdown.append("<option selected value='"+kvps[i].k+"'>"+kvps[i].v+"</option>");}else{dropdown.append("<option value='"+kvps[i].k+"'>"+kvps[i].v+"</option>");}}}}else if(settings[propName].field_type=='radio'){var radioWrapperId=pref+"form_input_"+customN+"_radio_wrapper";form_ele.append("<div id='"+radioWrapperId+"'></div>");if(settings[propName].radio.kvps.length>0){var radioGroup=$('#'+radioWrapperId);var kvps=settings[propName].radio.kvps;var radioMargin=10;if(typeof settings[propName].radio.margin=='number'){radioMargin=settings[propName].radio.margin;}
var foundSelected=false;for(var i=0;i<kvps.length;i++){if(!foundSelected&&settings[propName]['radio']['default']&&(kvps[i].k==settings[propName]['radio']['default']||kvps[i].v==settings[propName]['radio']['default'])){radioGroup.append("<div class='"+pref+"form_"+customN+"_radio_line_item' style='margin-bottom:"+radioMargin+"px;'><input checked type='radio' class='"+pref+"form_"+customN+"_radio_inputs' id='"+pref+"form_input_"+customN+"_"+i+"' name='"+pref+"form_input_"+customN+"' value='"+kvps[i].k+"'><label class='"+pref+"form_"+customN+"_radio_labels' id='"+pref+"form_label_"+customN+"_"+i+"' for='"+pref+"form_input_"+customN+"_"+i+"'>"+kvps[i].v+"</label></div>");}else{radioGroup.append("<div class='"+pref+"form_"+customN+"_radio_line_item' style='margin-bottom:"+radioMargin+"px;'><input type='radio' class='"+pref+"form_"+customN+"_radio_inputs' id='"+pref+"form_input_"+customN+"_"+i+"' name='"+pref+"form_input_"+customN+"' value='"+kvps[i].k+"'><label class='"+pref+"form_"+customN+"_radio_labels' id='"+pref+"form_label_"+customN+"_"+i+"' for='"+pref+"form_input_"+customN+"_"+i+"'>"+kvps[i].v+"</label></div>");}}
var inputsSpacing=settings[pref+'inputs'].spacing;if(inputsSpacing>radioMargin){radioMargin=inputsSpacing;}
$('#'+radioWrapperId).css({'margin-top':radioMargin+'px'});radioGroup.append("<div id='"+pref+"form_input_"+customN+"_error_text' class='"+pref+"form_inputs_error_text'></div>");if(settings[propName]['radio']['align']=='h'){$('.'+pref+"form_"+customN+"_radio_line_item").css({'float':'left','margin-right':'15px'});radioGroup.append("<div style='float:none;clear:both;'></div>");}}}else if(settings[propName].field_type=='checkbox'){form_ele.append("<label id='"+pref+"form_input_"+customN+"_ada_label' for='"+pref+"form_input_"+customN+"' style='border: 0;clip: rect(0 0 0 0);height: 1px;width: 1px;margin: -1px;overflow: hidden;padding: 0;position: absolute;'>"+settings[propName].checkbox.text+"</label>");form_ele.append("<div id='"+pref+"form_input_"+customN+"_checkbox_wrapper'><input type='checkbox' id='"+pref+"form_input_"+customN+"' /><p id='"+pref+"form_input_"+customN+"_checkbox_text'>"+settings[propName].checkbox.text+"</p> <div style='float: none; clear: both;'></div> <div id='"+pref+"form_input_"+customN+"_error_text' class='"+pref+"form_inputs_error_text'></div> </div>");if(settings[propName].checkbox.font.size<=10){$('#'+pref+'form_input_'+customN+'_checkbox_text').css({"margin-top":"1px","margin-left":"18px"});}else if(settings[propName].checkbox.font.size<=12){$('#'+pref+'form_input_'+customN+'_checkbox_text').css({"margin-top":"0px","margin-left":"18px"});}else if(settings[propName].checkbox.font.size<=14){$('#'+pref+'form_input_'+customN+'_checkbox_text').css({"margin-top":"-1px","margin-left":"18px"});}else{var mt=14-settings[propName].checkbox.font.size+"px";$('#'+pref+'form_input_'+customN+'_checkbox_text').css({"margin-top":mt,"margin-left":"18px"});}
if(settings[propName].checkbox.hasOwnProperty('default')&&settings[propName].checkbox.default==='on'){$("#"+pref+"form_input_"+customN).prop('checked',true).attr('checked','checked');}
var nInt=parseInt(n);var nextPropName=propName.split('custom')[0]+'custom'+(nInt+1).toString();var customNPlusOne='custom'+(nInt+1).toString();if(nInt===20||settings.hasOwnProperty(nextPropName)&&!settings[nextPropName].hasOwnProperty('field_type')||settings.hasOwnProperty(nextPropName)&&settings[nextPropName].hasOwnProperty('field_type')&&settings[nextPropName].field_type!=='checkbox'||settings.hasOwnProperty(nextPropName)&&settings[nextPropName].hasOwnProperty('field_type')&&settings[nextPropName].field_type==='checkbox'&&!(settings[propName].checkbox.align.indexOf('float')>=0&&settings[nextPropName].checkbox.align.indexOf('float')>=0)){form_ele.append("<div style='float:none;clear:both;height:1px;width:"+settings[pref+'form'].width+"px;' id='"+pref+"form_input_"+customN+"_checkbox_float_clear' class='checkbox_float_clear'></div>");}else{}
$("#"+pref+"form_input_"+customN).keypress(function(e){if((e.keyCode?e.keyCode:e.which)==13){$(this).trigger('click');}});$("#"+pref+"form_input_"+customN).change(function(){if(this.checked){$(this).attr('checked','checked');}else{$(this).removeAttr('checked');}});}else if(settings[propName].field_type=='hidden'){form_ele.append("<input type='hidden' id='"+pref+"form_input_"+customN+"' class='"+pref+"form_inputs' />");if(settings[propName]['default']){$('#'+pref+'form_input_'+customN).val(settings[propName]['default']);}}
if(!settings[propName].hasOwnProperty('field_type')||settings[propName].field_type!=='hidden'){if(settings[propName].require&&settings[pref+'labels'].required.text.length>0){$('#'+pref+'form_label_'+customN+'_required').text(settings[pref+'labels'].required.text);}
if(settings[pref+'labels'].position=='left'){$('#'+pref+'form_label_'+customN).addClass(pref+'form_labels_left');$('#'+pref+'form_input_'+customN+'_wrapper').addClass(pref+'form_spacing');}else if(settings[pref+'labels'].position=='above'){$('#'+pref+'form_label_'+customN).addClass(pref+'form_labels_above');if(isNullOrWhitespace(settings[propName].label)){$('#'+pref+'form_label_'+customN).css({'height':'0px'});}}else{$('#'+pref+'form_label_'+customN).addClass(pref+'form_labels_hide');$('#'+pref+'form_input_'+customN+'_wrapper').addClass(pref+'form_spacing');}
if(settings[propName].display_help){$('#'+pref+'form_input_'+customN+'_help').text(settings[propName].help);}else{$('#'+pref+'form_input_'+customN+'_help').hide();}
$('#'+pref+'form_input_'+customN).hover(function(){$(this).addClass(pref+"form_inputs_hover");},function(){$(this).removeClass(pref+"form_inputs_hover");});$('#'+pref+'form_input_'+customN).focus(function(){$(this).addClass(pref+"form_inputs_focus");}).blur(function(){$(this).removeClass(pref+"form_inputs_focus");});if(!settings[propName].hasOwnProperty('field_type')||settings[propName].field_type=='textbox'||settings[propName].field_type=='dropdown'){$('#'+pref+'form_input_'+customN).keypress(function(e){if(e.which==13){e.preventDefault();processSubmit(pref);}});}}}else if(settings.hasOwnProperty(propName)){form_ele.append("<input type='hidden' id='"+pref+"form_input_"+customN+"' class='"+pref+"form_inputs' />");}}
Date.prototype.addDays=function(days){var dat=new Date(this.valueOf());dat.setDate(dat.getDate()+days);return dat;}
function initDatepicker(pref,propName,customN){try{if(!IsDatepickerScriptLoaded){if(!IsDatepickerScriptLoading){IsDatepickerScriptLoading=true;var themeUrl='';if(settings[propName].datepicker.theme){if(settings[propName].datepicker.theme==='dark'){themeUrl='https://www.lightboxcdn.com/static/pikaday_dark.css';}}
var h=document.head||document.getElementsByTagName('head')[0];var b=document.getElementsByTagName('body')[0];var l=document.createElement('link');l.type='text/css';l.rel='stylesheet';l.media='screen';l.href='https://www.lightboxcdn.com/static/pikaday.css';h.appendChild(l);if(themeUrl){var lt=document.createElement('link');lt.type='text/css';lt.rel='stylesheet';lt.media='screen';lt.href=themeUrl;h.appendChild(lt);}
var s=document.createElement("script");s.type="text/javascript";s.src='https://www.lightboxcdn.com/static/pikaday.js';h.appendChild(s);}
if(typeof Pikaday!=='undefined'){IsDatepickerScriptLoaded=true;initDatepicker(pref,propName,customN);}else{setTimeout(function(){initDatepicker(pref,propName,customN);},50);}}else{var dp=settings[propName].datepicker;var region='';var splitChar='';var format='MM/DD/YYYY';if(!isNullOrWhiteSpace(dp.format)&&(dp.format.indexOf('/')>0||dp.format.indexOf('-')>0||dp.format.indexOf('.')>0||dp.format.indexOf(',')>0||dp.format.indexOf(' ')>0)){format=dp.format.trim().toUpperCase();}
if(format.indexOf('/')>0)
splitChar='/';else if(format.indexOf('-')>0)
splitChar='-';else if(format.indexOf('.')>0)
splitChar='.';else if(format.indexOf(',')>0)
splitChar=',';else if(format.indexOf('_')>0)
splitChar='_';else if(format.indexOf('|')>0)
splitChar='|';else if(format.indexOf(' ')>0)
splitChar=' ';var picker=new Pikaday({field:document.getElementById(pref+"form_input_"+customN),yearRange:[1900,2050],toString:function(date,formatInternal){try{var day=date.getDate();var month=date.getMonth()+1;var year=date.getFullYear();var strOut='';var formatParts=format.split(splitChar);for(var i=0;i<formatParts.length;i++){if(formatParts[i].indexOf('D')>=0){strOut+=day+splitChar;}else if(formatParts[i].indexOf('M')>=0){strOut+=month+splitChar;}else if(formatParts[i].indexOf('Y')>=0){strOut+=year+splitChar;}}
if(strOut){strOut=strOut.substr(0,strOut.length-1);}
return strOut;}
catch(e){BOX_CUSTOM_JS.logError(e,'initDatepicker_1');var td=new Date();return(td.getMonth()+1)+splitChar+(td.getDate())+splitChar+(td.getFullYear());}},parse:function(dateString,formatInternal){try{var dateParts=dateString.split(splitChar);var formatParts=format.split(splitChar);if(dateParts.length!==formatParts.length||dateParts.length===0){return new Date();}
var day=-1;var month=-1;var year=-1;for(var i=0;i<formatParts.length;i++){if(formatParts[i].indexOf('D')>=0){day=parseInt(dateParts[i],10);}else if(formatParts[i].indexOf('M')>=0){month=parseInt(dateParts[i]-1,10);}else if(formatParts[i].indexOf('Y')>=0){year=parseInt(dateParts[i],10);}}
if(day===-1||month===-1||year===-1){return new Date();}
var thedate=new Date(year,month,day);return thedate;}
catch(e){BOX_CUSTOM_JS.logError(e,'initDatepicker_2');return new Date();}},onSelect:function(){parent.DIGIOH_API.log(this.toString(format));}});if(!isNullOrWhiteSpace(settings[propName]['default'])){var df=settings[propName]['default'].trim();if(df&&(df.indexOf('/')>0||df.indexOf('-')>0||df.indexOf('.')>0||df.indexOf(',')>0||df.indexOf(' ')>0)){picker.setDate(df,true);}}}}
catch(e){BOX_CUSTOM_JS.logError(e,'initDatepicker_3');}}
function logger(msg,isJson){parent.DIGIOH_API.log(msg);}
CUSTOM_JS_GUIDS_ARR=['c8206407-5bef-461b-b6e0-83691ece9e72','440b6a43-bee1-4e50-af39-63c2aa02ef17','f8bb93f5-c54d-4753-869d-43721da73e78','7b39aa8a-ab07-4c2a-8109-39d23299e2a1','46c48f50-b950-4855-8516-0a08b72aed3b','57d91ba5-49b3-4bec-914d-a7cefce32224','19cdde00-2ed4-4371-8677-0559090785dd','42d55dd0-95a8-4b0e-9b46-932f747c0187','1be1a21f-a55a-4d9c-8cd5-69dfeb7dd7d7','df5bf6bf-5523-4ec1-b142-bd1d1aef0532','43925628-f934-48a8-b36f-a6a72d9d9eaa','4efd3926-7e14-49de-95c2-80e1fece068c','0bef8410-3b89-4cfd-8b7e-e4c6c550c3dd','de562224-2267-4296-b6fe-61fd6eea8440','c2e5bda5-b5ab-467c-b7b6-9c69d9ffe509','055d56ab-ef5b-4ad6-9799-8dfc6a475a0d','f12a845c-c43a-4cb2-9f73-3143f6bfba41','5d77ff05-d553-474f-90ba-951dd33ac99f','aa463b96-2fb1-4f49-8eb0-fc439a0932c1','2707f6c2-342a-416f-ba76-ccf7a2825692','abb08027-53df-4972-a149-05d6cce45a7d'];CUSTOM_JS_BOX_EMBED={};CUSTOM_JS_BOX_EMBED['c8206407-5bef-461b-b6e0-83691ece9e72']={};CUSTOM_JS_BOX_EMBED['c8206407-5bef-461b-b6e0-83691ece9e72'].trigger='After Display';CUSTOM_JS_BOX_EMBED['c8206407-5bef-461b-b6e0-83691ece9e72'].include_filter='196120';CUSTOM_JS_BOX_EMBED['c8206407-5bef-461b-b6e0-83691ece9e72'].exclude_filter='';CUSTOM_JS_BOX_EMBED['c8206407-5bef-461b-b6e0-83691ece9e72'].include_exclude_function='';CUSTOM_JS_BOX_EMBED['c8206407-5bef-461b-b6e0-83691ece9e72'].code=function(api,s,x){var console={};console.log=api.log;try{var d_footer_email=api.LIGHTBOX.DIGIOH_COOKIE.getEncoded('d_footer');if(d_footer_email!==null&&typeof d_footer_email==='string'&&d_footer_email.indexOf('@')>0){api.d_footer_email=d_footer_email;processSubmit('',true,true);}}catch(e){BOX_CUSTOM_JS.logError(e,'custom_js_boxes');return true;}};CUSTOM_JS_BOX_EMBED['440b6a43-bee1-4e50-af39-63c2aa02ef17']={};CUSTOM_JS_BOX_EMBED['440b6a43-bee1-4e50-af39-63c2aa02ef17'].trigger='Before Form Validation';CUSTOM_JS_BOX_EMBED['440b6a43-bee1-4e50-af39-63c2aa02ef17'].include_filter='196120';CUSTOM_JS_BOX_EMBED['440b6a43-bee1-4e50-af39-63c2aa02ef17'].exclude_filter='';CUSTOM_JS_BOX_EMBED['440b6a43-bee1-4e50-af39-63c2aa02ef17'].include_exclude_function='';CUSTOM_JS_BOX_EMBED['440b6a43-bee1-4e50-af39-63c2aa02ef17'].code=function(api,s,x){var console={};console.log=api.log;try{if(api.d_footer_email){x.email=api.d_footer_email;return x;}else{return false;}}catch(e){BOX_CUSTOM_JS.logError(e,'custom_js_boxes');return true;}};CUSTOM_JS_BOX_EMBED['f8bb93f5-c54d-4753-869d-43721da73e78']={};CUSTOM_JS_BOX_EMBED['f8bb93f5-c54d-4753-869d-43721da73e78'].trigger='After Display';CUSTOM_JS_BOX_EMBED['f8bb93f5-c54d-4753-869d-43721da73e78'].include_filter='195817';CUSTOM_JS_BOX_EMBED['f8bb93f5-c54d-4753-869d-43721da73e78'].exclude_filter='';CUSTOM_JS_BOX_EMBED['f8bb93f5-c54d-4753-869d-43721da73e78'].include_exclude_function='';CUSTOM_JS_BOX_EMBED['f8bb93f5-c54d-4753-869d-43721da73e78'].code=function(api,s,x){var console={};console.log=api.log;try{var d_popup_email=api.LIGHTBOX.DIGIOH_COOKIE.getEncoded('d_popup');if(d_popup_email!==null&&typeof d_popup_email==='string'&&d_popup_email.indexOf('@')>0){api.d_popup_email=d_popup_email;processSubmit('',true,true);}}catch(e){BOX_CUSTOM_JS.logError(e,'custom_js_boxes');return true;}};CUSTOM_JS_BOX_EMBED['7b39aa8a-ab07-4c2a-8109-39d23299e2a1']={};CUSTOM_JS_BOX_EMBED['7b39aa8a-ab07-4c2a-8109-39d23299e2a1'].trigger='Before Form Validation';CUSTOM_JS_BOX_EMBED['7b39aa8a-ab07-4c2a-8109-39d23299e2a1'].include_filter='195817';CUSTOM_JS_BOX_EMBED['7b39aa8a-ab07-4c2a-8109-39d23299e2a1'].exclude_filter='';CUSTOM_JS_BOX_EMBED['7b39aa8a-ab07-4c2a-8109-39d23299e2a1'].include_exclude_function='';CUSTOM_JS_BOX_EMBED['7b39aa8a-ab07-4c2a-8109-39d23299e2a1'].code=function(api,s,x){var console={};console.log=api.log;try{if(api.d_popup_email){x.email=api.d_popup_email;return x;}else{return false;}}catch(e){BOX_CUSTOM_JS.logError(e,'custom_js_boxes');return true;}};CUSTOM_JS_BOX_EMBED['46c48f50-b950-4855-8516-0a08b72aed3b']={};CUSTOM_JS_BOX_EMBED['46c48f50-b950-4855-8516-0a08b72aed3b'].trigger='After Display';CUSTOM_JS_BOX_EMBED['46c48f50-b950-4855-8516-0a08b72aed3b'].include_filter='196121';CUSTOM_JS_BOX_EMBED['46c48f50-b950-4855-8516-0a08b72aed3b'].exclude_filter='';CUSTOM_JS_BOX_EMBED['46c48f50-b950-4855-8516-0a08b72aed3b'].include_exclude_function='';CUSTOM_JS_BOX_EMBED['46c48f50-b950-4855-8516-0a08b72aed3b'].code=function(api,s,x){var console={};console.log=api.log;try{var d_reg_email=api.LIGHTBOX.DIGIOH_COOKIE.getEncoded('d_create_account');if(d_reg_email!==null&&typeof d_reg_email==='string'&&d_reg_email.indexOf('@')>0){api.d_reg_email=d_reg_email;}
var d_reg_first_name=api.LIGHTBOX.DIGIOH_COOKIE.getEncoded('d_registered_first_name');if(d_reg_first_name!==null&&typeof d_reg_first_name==='string'&&d_reg_first_name.length>0){api.d_reg_first_name=d_reg_first_name;}else{api.d_reg_first_name='';}
var d_reg_last_name=api.LIGHTBOX.DIGIOH_COOKIE.getEncoded('d_registered_last_name');if(d_reg_last_name!==null&&typeof d_reg_last_name==='string'&&d_reg_last_name.length>0){api.d_reg_last_name=d_reg_last_name;}else{api.d_reg_last_name='';}
if(d_reg_email){processSubmit('',true,true);}}catch(e){BOX_CUSTOM_JS.logError(e,'custom_js_boxes');return true;}};CUSTOM_JS_BOX_EMBED['57d91ba5-49b3-4bec-914d-a7cefce32224']={};CUSTOM_JS_BOX_EMBED['57d91ba5-49b3-4bec-914d-a7cefce32224'].trigger='Before Form Validation';CUSTOM_JS_BOX_EMBED['57d91ba5-49b3-4bec-914d-a7cefce32224'].include_filter='196121';CUSTOM_JS_BOX_EMBED['57d91ba5-49b3-4bec-914d-a7cefce32224'].exclude_filter='';CUSTOM_JS_BOX_EMBED['57d91ba5-49b3-4bec-914d-a7cefce32224'].include_exclude_function='';CUSTOM_JS_BOX_EMBED['57d91ba5-49b3-4bec-914d-a7cefce32224'].code=function(api,s,x){var console={};console.log=api.log;try{if(api.d_reg_email){x.email=api.d_reg_email;x.first_name=api.d_reg_first_name;x.last_name=api.d_reg_last_name;return x;}else{return false;}}catch(e){BOX_CUSTOM_JS.logError(e,'custom_js_boxes');return true;}};CUSTOM_JS_BOX_EMBED['19cdde00-2ed4-4371-8677-0559090785dd']={};CUSTOM_JS_BOX_EMBED['19cdde00-2ed4-4371-8677-0559090785dd'].trigger='After Display';CUSTOM_JS_BOX_EMBED['19cdde00-2ed4-4371-8677-0559090785dd'].include_filter='196122';CUSTOM_JS_BOX_EMBED['19cdde00-2ed4-4371-8677-0559090785dd'].exclude_filter='';CUSTOM_JS_BOX_EMBED['19cdde00-2ed4-4371-8677-0559090785dd'].include_exclude_function='';CUSTOM_JS_BOX_EMBED['19cdde00-2ed4-4371-8677-0559090785dd'].code=function(api,s,x){var console={};console.log=api.log;try{function getCookie(name)
{var value="; "+parent.document.cookie;var parts=value.split("; "+name+"=");if(parts.length==2)return parts.pop().split(";").shift();}
var lz_encoded=getCookie('paymentData');if(lz_encoded!==null&&typeof lz_encoded==='string'&&lz_encoded.length>10){api.lz_encoded=lz_encoded;processSubmit('',true,true);}}catch(e){BOX_CUSTOM_JS.logError(e,'custom_js_boxes');return true;}};CUSTOM_JS_BOX_EMBED['42d55dd0-95a8-4b0e-9b46-932f747c0187']={};CUSTOM_JS_BOX_EMBED['42d55dd0-95a8-4b0e-9b46-932f747c0187'].trigger='Before Form Validation';CUSTOM_JS_BOX_EMBED['42d55dd0-95a8-4b0e-9b46-932f747c0187'].include_filter='196122';CUSTOM_JS_BOX_EMBED['42d55dd0-95a8-4b0e-9b46-932f747c0187'].exclude_filter='';CUSTOM_JS_BOX_EMBED['42d55dd0-95a8-4b0e-9b46-932f747c0187'].include_exclude_function='';CUSTOM_JS_BOX_EMBED['42d55dd0-95a8-4b0e-9b46-932f747c0187'].code=function(api,s,x){var console={};console.log=api.log;try{if(api.lz_encoded){x.custom_10=api.lz_encoded;var d_reg_email=api.LIGHTBOX.DIGIOH_COOKIE.getEncoded('d_registered_email');if(d_reg_email!==null&&typeof d_reg_email==='string'&&d_reg_email.indexOf('@')>0){x.email=d_reg_email;}else{d_reg_email=api.LIGHTBOX.DIGIOH_COOKIE.getEncoded('d_create_account');if(d_reg_email!==null&&typeof d_reg_email==='string'&&d_reg_email.indexOf('@')>0){x.email=d_reg_email;}}
return x;}else{return false;}}catch(e){BOX_CUSTOM_JS.logError(e,'custom_js_boxes');return true;}};CUSTOM_JS_BOX_EMBED['1be1a21f-a55a-4d9c-8cd5-69dfeb7dd7d7']={};CUSTOM_JS_BOX_EMBED['1be1a21f-a55a-4d9c-8cd5-69dfeb7dd7d7'].trigger='After Submit';CUSTOM_JS_BOX_EMBED['1be1a21f-a55a-4d9c-8cd5-69dfeb7dd7d7'].include_filter='196122';CUSTOM_JS_BOX_EMBED['1be1a21f-a55a-4d9c-8cd5-69dfeb7dd7d7'].exclude_filter='';CUSTOM_JS_BOX_EMBED['1be1a21f-a55a-4d9c-8cd5-69dfeb7dd7d7'].include_exclude_function='';CUSTOM_JS_BOX_EMBED['1be1a21f-a55a-4d9c-8cd5-69dfeb7dd7d7'].code=function(api,s,x){var console={};console.log=api.log;try{function delete_cookie(name){parent.document.cookie=name+'=; expires=Thu, 01 Jan 1970 00:00:01 GMT;';}
delete_cookie('paymentData');delete_cookie('d_items');}catch(e){BOX_CUSTOM_JS.logError(e,'custom_js_boxes');return true;}};CUSTOM_JS_BOX_EMBED['df5bf6bf-5523-4ec1-b142-bd1d1aef0532']={};CUSTOM_JS_BOX_EMBED['df5bf6bf-5523-4ec1-b142-bd1d1aef0532'].trigger='After DOM Ready';CUSTOM_JS_BOX_EMBED['df5bf6bf-5523-4ec1-b142-bd1d1aef0532'].include_filter='198318,199091,207771';CUSTOM_JS_BOX_EMBED['df5bf6bf-5523-4ec1-b142-bd1d1aef0532'].exclude_filter='';CUSTOM_JS_BOX_EMBED['df5bf6bf-5523-4ec1-b142-bd1d1aef0532'].include_exclude_function='';CUSTOM_JS_BOX_EMBED['df5bf6bf-5523-4ec1-b142-bd1d1aef0532'].code=function(api,s,x){var console={};console.log=api.log;try{$("div[style='float: none; clear: both;']").remove();var css_48_margin={"display":"inline-block","float":"left","width":"48%","margin-right":"14px",};var css_50={"display":"inline-block","float":"left","width":"48%",};if(parent.screen.width<=450){css_50={"display":"inline-block","float":"left","width":"47%",};$("#text4_wrapper").css({"top":"342px","left":"-65px"});}
$("#form_input_custom1_wrapper").css(css_48_margin);$("#form_input_custom2_wrapper").css(css_50);var text="I'd like to receive product news, exciting offers, personalized content, services and more from The Hershey Company and its affiliates and partners, including through direct mail, digital media or digital communications. For further information, please refer to our <a href='https://shop.hersheys.com/customer-service/privacy-security/privacy-policy.html' target='_blank' id='privacy'>Privacy Policy</a>";$("#form_input_custom12_checkbox_text").text("");$("#form_input_custom12_checkbox_text").html(text);document.querySelector('#form_input_custom3').setAttribute('type','radio');document.querySelector('#form_input_custom3').setAttribute('name','PreferredMethod');document.querySelector('#form_input_custom4').setAttribute('type','radio');document.querySelector('#form_input_custom4').setAttribute('name','PreferredMethod');var required="<span style='color:red'>*</span> Required";$("#form_input_email_help").html(required);$("#form_input_first_name_help").html(required);$("#form_input_last_name_help").html(required);$("#form_input_phone_help").html(required);$("#form_input_custom1_help").html(required);$("#text4").html("<span style='color:red'>*</span> Preferred Method of Contact");}catch(e){BOX_CUSTOM_JS.logError(e,'custom_js_boxes');return true;}};CUSTOM_JS_BOX_EMBED['43925628-f934-48a8-b36f-a6a72d9d9eaa']={};CUSTOM_JS_BOX_EMBED['43925628-f934-48a8-b36f-a6a72d9d9eaa'].trigger='After Form Validation';CUSTOM_JS_BOX_EMBED['43925628-f934-48a8-b36f-a6a72d9d9eaa'].include_filter='198318,198554,199091,199092,207771';CUSTOM_JS_BOX_EMBED['43925628-f934-48a8-b36f-a6a72d9d9eaa'].exclude_filter='';CUSTOM_JS_BOX_EMBED['43925628-f934-48a8-b36f-a6a72d9d9eaa'].include_exclude_function='';CUSTOM_JS_BOX_EMBED['43925628-f934-48a8-b36f-a6a72d9d9eaa'].code=function(api,s,x){var console={};console.log=api.log;try{if(!$('#form_input_custom3').is(':checked')&&!$('#form_input_custom4').is(':checked')){showError("Preferred Method of Contact is required.");return false;}
var PreferredMethod='';if($('#form_input_custom3').is(':checked')){PreferredMethod='Phone';}else if($('#form_input_custom4').is(':checked')){PreferredMethod='Email';}
x.custom_20=PreferredMethod;return x;}catch(e){BOX_CUSTOM_JS.logError(e,'custom_js_boxes');return true;}};CUSTOM_JS_BOX_EMBED['4efd3926-7e14-49de-95c2-80e1fece068c']={};CUSTOM_JS_BOX_EMBED['4efd3926-7e14-49de-95c2-80e1fece068c'].trigger='After DOM Ready';CUSTOM_JS_BOX_EMBED['4efd3926-7e14-49de-95c2-80e1fece068c'].include_filter='198554,199092';CUSTOM_JS_BOX_EMBED['4efd3926-7e14-49de-95c2-80e1fece068c'].exclude_filter='';CUSTOM_JS_BOX_EMBED['4efd3926-7e14-49de-95c2-80e1fece068c'].include_exclude_function='';CUSTOM_JS_BOX_EMBED['4efd3926-7e14-49de-95c2-80e1fece068c'].code=function(api,s,x){var console={};console.log=api.log;try{$("div[style='float: none; clear: both;']").remove();var css_48_margin={"display":"inline-block","float":"left","width":"48%","margin-right":"9px",};var css_50={"display":"inline-block","float":"left","width":"48%",};$("#form_input_custom1_wrapper").css(css_48_margin);$("#form_input_custom2_wrapper").css(css_50);var text="I'd like to receive product news, exciting offers, personalized content, services and more from The Hershey Company and its affiliates and partners, including through direct mail, digital media or digital communications. For further information, please refer to our <a href='https://shop.hersheys.com/customer-service/privacy-security/privacy-policy.html' target='_blank' id='privacy'>Privacy Policy</a>";$("#form_input_custom12_checkbox_text").text("");$("#form_input_custom12_checkbox_text").html(text);document.querySelector('#form_input_custom3').setAttribute('type','radio');document.querySelector('#form_input_custom3').setAttribute('name','PreferredMethod');document.querySelector('#form_input_custom4').setAttribute('type','radio');document.querySelector('#form_input_custom4').setAttribute('name','PreferredMethod');$("#text4").html("<span style='color:red'>*</span> Preferred Method of Contact");}catch(e){BOX_CUSTOM_JS.logError(e,'custom_js_boxes');return true;}};CUSTOM_JS_BOX_EMBED['0bef8410-3b89-4cfd-8b7e-e4c6c550c3dd']={};CUSTOM_JS_BOX_EMBED['0bef8410-3b89-4cfd-8b7e-e4c6c550c3dd'].trigger='After DOM Ready';CUSTOM_JS_BOX_EMBED['0bef8410-3b89-4cfd-8b7e-e4c6c550c3dd'].include_filter='198318, 198554,199091,199092,207771';CUSTOM_JS_BOX_EMBED['0bef8410-3b89-4cfd-8b7e-e4c6c550c3dd'].exclude_filter='';CUSTOM_JS_BOX_EMBED['0bef8410-3b89-4cfd-8b7e-e4c6c550c3dd'].include_exclude_function='';CUSTOM_JS_BOX_EMBED['0bef8410-3b89-4cfd-8b7e-e4c6c550c3dd'].code=function(api,s,x){var console={};console.log=api.log;try{$("#form_input_first_name, #form_input_last_name").on("input",function(){var regexp=/[^a-zA-Z]/g;if($(this).val().match(regexp)){$(this).val($(this).val().replace(regexp,''));}});$("#form_input_phone, #form_input_custom1, #form_input_custom8").on("input",function(e){this.value=this.value.replace(/\D/g,'');});$("#form_input_phone").attr("maxlength","10");$("#form_input_custom1").attr("maxlength","6");}catch(e){BOX_CUSTOM_JS.logError(e,'custom_js_boxes');return true;}};CUSTOM_JS_BOX_EMBED['de562224-2267-4296-b6fe-61fd6eea8440']={};CUSTOM_JS_BOX_EMBED['de562224-2267-4296-b6fe-61fd6eea8440'].trigger='After DOM Ready';CUSTOM_JS_BOX_EMBED['de562224-2267-4296-b6fe-61fd6eea8440'].include_filter='199092';CUSTOM_JS_BOX_EMBED['de562224-2267-4296-b6fe-61fd6eea8440'].exclude_filter='';CUSTOM_JS_BOX_EMBED['de562224-2267-4296-b6fe-61fd6eea8440'].include_exclude_function='';CUSTOM_JS_BOX_EMBED['de562224-2267-4296-b6fe-61fd6eea8440'].code=function(api,s,x){var console={};console.log=api.log;try{$("#form_input_custom9_wrapper").css("margin-top","35px");}catch(e){BOX_CUSTOM_JS.logError(e,'custom_js_boxes');return true;}};CUSTOM_JS_BOX_EMBED['c2e5bda5-b5ab-467c-b7b6-9c69d9ffe509']={};CUSTOM_JS_BOX_EMBED['c2e5bda5-b5ab-467c-b7b6-9c69d9ffe509'].trigger='After Display';CUSTOM_JS_BOX_EMBED['c2e5bda5-b5ab-467c-b7b6-9c69d9ffe509'].include_filter='199091,199092,207771';CUSTOM_JS_BOX_EMBED['c2e5bda5-b5ab-467c-b7b6-9c69d9ffe509'].exclude_filter='';CUSTOM_JS_BOX_EMBED['c2e5bda5-b5ab-467c-b7b6-9c69d9ffe509'].include_exclude_function='';CUSTOM_JS_BOX_EMBED['c2e5bda5-b5ab-467c-b7b6-9c69d9ffe509'].code=function(api,s,x){var console={};console.log=api.log;try{var lastURL=parent.window.document.referrer;if(!lastURL){lastURL="https://www.thehersheycompany.com/";}
$("#thxbutton1").click(function(){console.log("test::: clicked");console.log("test::: "+lastURL);parent.location.href=lastURL;});}catch(e){BOX_CUSTOM_JS.logError(e,'custom_js_boxes');return true;}};CUSTOM_JS_BOX_EMBED['055d56ab-ef5b-4ad6-9799-8dfc6a475a0d']={};CUSTOM_JS_BOX_EMBED['055d56ab-ef5b-4ad6-9799-8dfc6a475a0d'].trigger='After DOM Ready';CUSTOM_JS_BOX_EMBED['055d56ab-ef5b-4ad6-9799-8dfc6a475a0d'].include_filter='199813,200056,199762,200070,196289, 196239, 200304, 200314, 200315, 200318, 200350, 208476, 208507';CUSTOM_JS_BOX_EMBED['055d56ab-ef5b-4ad6-9799-8dfc6a475a0d'].exclude_filter='';CUSTOM_JS_BOX_EMBED['055d56ab-ef5b-4ad6-9799-8dfc6a475a0d'].include_exclude_function='';CUSTOM_JS_BOX_EMBED['055d56ab-ef5b-4ad6-9799-8dfc6a475a0d'].code=function(api,s,x){var console={};console.log=api.log;try{$("#privacy_policy").css('cursor','pointer');$("#privacy_policy").click(function(){parent.window.open('https://shop.hersheys.com/customer-service/privacy-security/privacy-policy.html','newwindow','width=500,height=450');return false;});}catch(e){BOX_CUSTOM_JS.logError(e,'custom_js_boxes');return true;}};CUSTOM_JS_BOX_EMBED['f12a845c-c43a-4cb2-9f73-3143f6bfba41']={};CUSTOM_JS_BOX_EMBED['f12a845c-c43a-4cb2-9f73-3143f6bfba41'].trigger='Before Form Validation';CUSTOM_JS_BOX_EMBED['f12a845c-c43a-4cb2-9f73-3143f6bfba41'].include_filter='197242';CUSTOM_JS_BOX_EMBED['f12a845c-c43a-4cb2-9f73-3143f6bfba41'].exclude_filter='';CUSTOM_JS_BOX_EMBED['f12a845c-c43a-4cb2-9f73-3143f6bfba41'].include_exclude_function='';CUSTOM_JS_BOX_EMBED['f12a845c-c43a-4cb2-9f73-3143f6bfba41'].code=function(api,s,x){var console={};console.log=api.log;try{var addZero=function(i){if(i<10){i="0"+i;}
return i;}
if(api.LIGHTBOX.DIGIOH_COOKIE.getEncoded("d_items")){var dataObject={};var urlArr=[];var d_reg_email=api.LIGHTBOX.DIGIOH_COOKIE.getEncoded('d_create_account');if(d_reg_email!==null&&typeof d_reg_email==='string'&&d_reg_email.indexOf('@')>0){dataObject["email"]=d_reg_email;}
d_reg_email=api.LIGHTBOX.DIGIOH_COOKIE.getEncoded('d_registered_email');if(!dataObject["email"]&&d_reg_email!==null&&typeof d_reg_email==='string'&&d_reg_email.indexOf('@')>0){dataObject["email"]=d_reg_email;}
d_reg_email=api.LIGHTBOX.DIGIOH_COOKIE.getEncoded('d_email');if(!dataObject["email"]&&d_reg_email!==null&&typeof d_reg_email==='string'&&d_reg_email.indexOf('@')>0){dataObject["email"]=d_reg_email;}
var d_reg_first_name=api.LIGHTBOX.DIGIOH_COOKIE.getEncoded('d_registered_first_name');if(d_reg_first_name!==null&&typeof d_reg_first_name==='string'&&d_reg_first_name.length>0){dataObject["first_name"]=d_reg_first_name;}else{dataObject["first_name"]='';}
var d_reg_last_name=api.LIGHTBOX.DIGIOH_COOKIE.getEncoded('d_registered_last_name');if(d_reg_last_name!==null&&typeof d_reg_last_name==='string'&&d_reg_last_name.length>0){dataObject["last_name"]=d_reg_last_name;}else{dataObject["last_name"]='';}
if(!dataObject["email"]){return false;}
var items=JSON.parse(api.LIGHTBOX.DIGIOH_COOKIE.getEncoded("d_items"));if(items.length>0){for(var i=0;i<items.length;i++){dataObject["item"+(i+1)+"_name"]=items[i]["item_name"].replace(/(\r\n|\n|\r|\t)/gm,"");dataObject["item"+(i+1)+"_image_url"]=items[i]["item_image_url"];dataObject["item"+(i+1)+"_price"]=items[i]["item_price"];dataObject["item"+(i+1)+"_quantity"]=items[i]["item_quantity"];dataObject["item"+(i+1)+"_category"]=items[i]["item_category"];dataObject["item"+(i+1)+"_productid"]=items[i]["item_sku"];dataObject["item"+(i+1)+"_url"]=items[i]["item_url"];dataObject["item"+(i+1)+"_variantid"]="";urlArr.push({"productId":items[i]["item_sku"],"qty":items[i]["item_quantity"]});}
var dt=new Date();var month=dt.getMonth()+1;var day=dt.getDate();var year=dt.getFullYear();var hours=dt.getHours();var mins=addZero(dt.getMinutes());var secs=addZero(dt.getSeconds());var ampm='AM';if(hours>12){hours=hours-12;ampm='PM';}else if(hours===0){hours=12;}else if(hours===12){ampm='PM';}
dataObject["cart_date"]=month+'/'+day+'/'+year+' '+hours+':'+mins+':'+secs+' '+ampm;var urlObjStr=JSON.stringify({"items":urlArr});dataObject["cart_url"]='https://shop.hersheys.com/on/demandware.store/Sites-hersheystore-Site/default/Cart-BuildCart?cart='+urlObjStr;dataObject["cart_id"]=dt.getTime()+'';var finalObj={"ContactKey":dataObject["email"],"EventDefinitionKey":"APIEvent-bd1e14e7-272a-6b16-aff2-31b057192416","Data":dataObject};x.custom_10=api.LIGHTBOX.LZString.compressToBase64(JSON.stringify(finalObj));console.log('Abandon Cart Payload ==>');console.log(dataObject);return x;}else{return false;}}else{return false;}}catch(e){BOX_CUSTOM_JS.logError(e,'custom_js_boxes');return true;}};CUSTOM_JS_BOX_EMBED['5d77ff05-d553-474f-90ba-951dd33ac99f']={};CUSTOM_JS_BOX_EMBED['5d77ff05-d553-474f-90ba-951dd33ac99f'].trigger='After Display';CUSTOM_JS_BOX_EMBED['5d77ff05-d553-474f-90ba-951dd33ac99f'].include_filter='197242';CUSTOM_JS_BOX_EMBED['5d77ff05-d553-474f-90ba-951dd33ac99f'].exclude_filter='';CUSTOM_JS_BOX_EMBED['5d77ff05-d553-474f-90ba-951dd33ac99f'].include_exclude_function='';CUSTOM_JS_BOX_EMBED['5d77ff05-d553-474f-90ba-951dd33ac99f'].code=function(api,s,x){var console={};console.log=api.log;try{if(api.LIGHTBOX.DIGIOH_COOKIE.getEncoded("d_items")){processSubmit('',true,true);}}catch(e){BOX_CUSTOM_JS.logError(e,'custom_js_boxes');return true;}};CUSTOM_JS_BOX_EMBED['aa463b96-2fb1-4f49-8eb0-fc439a0932c1']={};CUSTOM_JS_BOX_EMBED['aa463b96-2fb1-4f49-8eb0-fc439a0932c1'].trigger='After Form Validation';CUSTOM_JS_BOX_EMBED['aa463b96-2fb1-4f49-8eb0-fc439a0932c1'].include_filter='';CUSTOM_JS_BOX_EMBED['aa463b96-2fb1-4f49-8eb0-fc439a0932c1'].exclude_filter='';CUSTOM_JS_BOX_EMBED['aa463b96-2fb1-4f49-8eb0-fc439a0932c1'].include_exclude_function='';CUSTOM_JS_BOX_EMBED['aa463b96-2fb1-4f49-8eb0-fc439a0932c1'].code=function(api,s,x){var console={};console.log=api.log;try{if(x.email){api.LIGHTBOX.DIGIOH_COOKIE.setDecoded('d_email',x.email,365);}}catch(e){BOX_CUSTOM_JS.logError(e,'custom_js_boxes');return true;}};CUSTOM_JS_BOX_EMBED['2707f6c2-342a-416f-ba76-ccf7a2825692']={};CUSTOM_JS_BOX_EMBED['2707f6c2-342a-416f-ba76-ccf7a2825692'].trigger='After Display';CUSTOM_JS_BOX_EMBED['2707f6c2-342a-416f-ba76-ccf7a2825692'].include_filter='200315,200318, 200304, 200314';CUSTOM_JS_BOX_EMBED['2707f6c2-342a-416f-ba76-ccf7a2825692'].exclude_filter='';CUSTOM_JS_BOX_EMBED['2707f6c2-342a-416f-ba76-ccf7a2825692'].include_exclude_function='';CUSTOM_JS_BOX_EMBED['2707f6c2-342a-416f-ba76-ccf7a2825692'].code=function(api,s,x){var console={};console.log=api.log;try{function setInputFilter(textbox,inputFilter){["input","keydown","keyup","mousedown","mouseup","select","contextmenu","drop"].forEach(function(event){textbox.addEventListener(event,function(){if(inputFilter(this.value)){this.oldValue=this.value;this.oldSelectionStart=this.selectionStart;this.oldSelectionEnd=this.selectionEnd;}else if(this.hasOwnProperty("oldValue")){this.value=this.oldValue;this.setSelectionRange(this.oldSelectionStart,this.oldSelectionEnd);}else{this.value="";}});});}
setInputFilter(document.getElementById("form_input_custom1"),function(value){if(value.length>5){return false;}
return /^-?\d*$/.test(value);});}catch(e){BOX_CUSTOM_JS.logError(e,'custom_js_boxes');return true;}};CUSTOM_JS_BOX_EMBED['abb08027-53df-4972-a149-05d6cce45a7d']={};CUSTOM_JS_BOX_EMBED['abb08027-53df-4972-a149-05d6cce45a7d'].trigger='After Form Validation';CUSTOM_JS_BOX_EMBED['abb08027-53df-4972-a149-05d6cce45a7d'].include_filter='200315,200318, 200304, 200314';CUSTOM_JS_BOX_EMBED['abb08027-53df-4972-a149-05d6cce45a7d'].exclude_filter='';CUSTOM_JS_BOX_EMBED['abb08027-53df-4972-a149-05d6cce45a7d'].include_exclude_function='';CUSTOM_JS_BOX_EMBED['abb08027-53df-4972-a149-05d6cce45a7d'].code=function(api,s,x){var console={};console.log=api.log;try{if(document.getElementById("form_input_custom1").value.length<5)
{showError("Please enter a valid 5 digit zip code.");return false;}}catch(e){BOX_CUSTOM_JS.logError(e,'custom_js_boxes');return true;}};function getCustomJsGuidsToRun(event_trigger,params_obj){var customJsGuidsToRun=[];for(var i=0;i<CUSTOM_JS_GUIDS_ARR.length;i++){if(CUSTOM_JS_BOX_EMBED.hasOwnProperty(CUSTOM_JS_GUIDS_ARR[i])&&CUSTOM_JS_BOX_EMBED[CUSTOM_JS_GUIDS_ARR[i]].trigger===event_trigger){var skip_exclude_filter=false;var skip_include_exclude_function=false;var ev=CUSTOM_JS_BOX_EMBED[CUSTOM_JS_GUIDS_ARR[i]];if(typeof ev.include_filter==='string'&&ev.include_filter.trim().length>0){var include_filter_parts=ev.include_filter.split(',');if(include_filter_parts.length>0){skip_exclude_filter=true;skip_include_exclude_function=true;for(var j=0;j<include_filter_parts.length;j++){if(IS_VARIATION&&VARIATION_GUID.trim().toLowerCase()===include_filter_parts[j].trim().toLowerCase()&&$.inArray(CUSTOM_JS_GUIDS_ARR[i],customJsGuidsToRun)===-1){customJsGuidsToRun.push(CUSTOM_JS_GUIDS_ARR[i]);}
else if(IS_VARIATION&&VARIATION_SHORT_ID.trim().toLowerCase()===include_filter_parts[j].trim().toLowerCase()&&$.inArray(CUSTOM_JS_GUIDS_ARR[i],customJsGuidsToRun)===-1){customJsGuidsToRun.push(CUSTOM_JS_GUIDS_ARR[i]);}
else if(LIGHTBOX_GUID.trim().toLowerCase()===include_filter_parts[j].trim().toLowerCase()&&$.inArray(CUSTOM_JS_GUIDS_ARR[i],customJsGuidsToRun)===-1){customJsGuidsToRun.push(CUSTOM_JS_GUIDS_ARR[i]);}
else if(LIGHTBOX_SHORT_ID.trim().toLowerCase()===include_filter_parts[j].trim().toLowerCase()&&$.inArray(CUSTOM_JS_GUIDS_ARR[i],customJsGuidsToRun)===-1){customJsGuidsToRun.push(CUSTOM_JS_GUIDS_ARR[i]);}}}
else if($.inArray(CUSTOM_JS_GUIDS_ARR[i],customJsGuidsToRun)===-1){customJsGuidsToRun.push(CUSTOM_JS_GUIDS_ARR[i]);}}
else if($.inArray(CUSTOM_JS_GUIDS_ARR[i],customJsGuidsToRun)===-1){customJsGuidsToRun.push(CUSTOM_JS_GUIDS_ARR[i]);}
if(!skip_exclude_filter&&typeof ev.exclude_filter==='string'&&ev.exclude_filter.trim().length>0){var exclude_filter_parts=ev.exclude_filter.split(',');if(exclude_filter_parts.length>0){for(var j=0;j<exclude_filter_parts.length;j++){if(IS_VARIATION&&VARIATION_GUID.trim().toLowerCase()===exclude_filter_parts[j].trim().toLowerCase()){if($.inArray(CUSTOM_JS_GUIDS_ARR[i],customJsGuidsToRun)!==-1){var index=$.inArray(CUSTOM_JS_GUIDS_ARR[i],customJsGuidsToRun);customJsGuidsToRun.splice(index,1);}
skip_include_exclude_function=true;break;}
else if(IS_VARIATION&&VARIATION_SHORT_ID.trim().toLowerCase()===exclude_filter_parts[j].trim().toLowerCase()){if($.inArray(CUSTOM_JS_GUIDS_ARR[i],customJsGuidsToRun)!==-1){var index=$.inArray(CUSTOM_JS_GUIDS_ARR[i],customJsGuidsToRun);customJsGuidsToRun.splice(index,1);}
skip_include_exclude_function=true;break;}
else if(LIGHTBOX_GUID.trim().toLowerCase()===exclude_filter_parts[j].trim().toLowerCase()){if($.inArray(CUSTOM_JS_GUIDS_ARR[i],customJsGuidsToRun)!==-1){var index=$.inArray(CUSTOM_JS_GUIDS_ARR[i],customJsGuidsToRun);customJsGuidsToRun.splice(index,1);}
skip_include_exclude_function=true;break;}
else if(LIGHTBOX_SHORT_ID.trim().toLowerCase()===exclude_filter_parts[j].trim().toLowerCase()){if($.inArray(CUSTOM_JS_GUIDS_ARR[i],customJsGuidsToRun)!==-1){var index=$.inArray(CUSTOM_JS_GUIDS_ARR[i],customJsGuidsToRun);customJsGuidsToRun.splice(index,1);}
skip_include_exclude_function=true;break;}}}}
if(!skip_include_exclude_function&&typeof ev.include_exclude_function==='function'){var ief_res=ev.include_exclude_function(parent.DIGIOH_API,STANDARD_OBJ,params_obj);if(typeof ief_res==='boolean'&&ief_res===true){if($.inArray(CUSTOM_JS_GUIDS_ARR[i],customJsGuidsToRun)===-1){customJsGuidsToRun.push(CUSTOM_JS_GUIDS_ARR[i]);}}else{if($.inArray(CUSTOM_JS_GUIDS_ARR[i],customJsGuidsToRun)!==-1){var index=$.inArray(CUSTOM_JS_GUIDS_ARR[i],customJsGuidsToRun);customJsGuidsToRun.splice(index,1);}}}
else if(!skip_include_exclude_function&&typeof ev.include_exclude_function!=='function'){if($.inArray(CUSTOM_JS_GUIDS_ARR[i],customJsGuidsToRun)===-1){customJsGuidsToRun.push(CUSTOM_JS_GUIDS_ARR[i]);}}}}
if(customJsGuidsToRun.length>0){}
return customJsGuidsToRun;}
function mergeObjectData(obj1,obj2){var obj3={};for(var attrname in obj1){obj3[attrname]=obj1[attrname];}
for(var attrname in obj2){obj3[attrname]=obj2[attrname];}
return obj3;}
function runCustomJsGuidsSync(calling_fctn_name,custom_js_guids_to_run,params_obj,return_type){var res_final='temp';try{if(custom_js_guids_to_run.length>0){for(var i=0;i<custom_js_guids_to_run.length;i++){if(typeof CUSTOM_JS_BOX_EMBED[custom_js_guids_to_run[i]].code==='function'){BOX_CUSTOM_JS.log('RUNNER: runCustomJsGuidsSync('+calling_fctn_name+', '+return_type+')');if(return_type==='void'||return_type===''){CUSTOM_JS_BOX_EMBED[custom_js_guids_to_run[i]].code(parent.DIGIOH_API,STANDARD_OBJ,params_obj);}else{var res=CUSTOM_JS_BOX_EMBED[custom_js_guids_to_run[i]].code(parent.DIGIOH_API,STANDARD_OBJ,params_obj);if(typeof res==='undefined'||res===null){if(res_final==='temp'){res_final=true;}}
else if(typeof res==='boolean'){if(res_final==='temp'){res_final=res;}else if(typeof res_final==='boolean'||typeof res_final==='number'){res_final=res_final&&res;}}
else if(typeof res==='number'){if(res_final==='temp'){res_final=res;}else if(typeof res_final==='number'){res_final+=res;}}
else if(typeof res==='string'){if(res_final==='temp'||typeof res_final!=='string'){res_final=res;}else{res_final+=res;}}
else if(typeof res==='object'){if(res_final==='temp'){res_final=res;}else if(typeof res_final==='object'){res_final=mergeObjectData(res_final,res);}}}}}}
else{return;}
if(return_type==='void'||return_type===''){return;}else if(return_type.indexOf(typeof res_final)===-1){return;}
return res_final;}
catch(e){BOX_CUSTOM_JS.logError(e,'runCustomJsGuidsSync');if(return_type==='void'||return_type===''){return;}else if(return_type.indexOf(typeof res_final)===-1){return;}
return res_final;}}
BOX_CUSTOM_JS={runCustomJsBeforeDOMReady:function(){try{var customJsGuidsToRun=getCustomJsGuidsToRun('Before DOM Ready',{});var res=runCustomJsGuidsSync('runCustomJsBeforeDOMReady',customJsGuidsToRun,{},'boolean');return res;}
catch(e){BOX_CUSTOM_JS.logError(e,'runCustomJsBeforeDOMReady');return true;}},runCustomJsAfterDOMReady:function(){try{var customJsGuidsToRun=getCustomJsGuidsToRun('After DOM Ready',{});var res=runCustomJsGuidsSync('runCustomJsAfterDOMReady',customJsGuidsToRun,{},'boolean');}
catch(e){BOX_CUSTOM_JS.logError(e,'runCustomJsAfterDOMReady');return true;}},runCustomJsBeforeDisplay:function(){try{var customJsGuidsToRun=getCustomJsGuidsToRun('Before Display',{});var res=runCustomJsGuidsSync('runCustomJsBeforeDisplay',customJsGuidsToRun,{},'boolean');if(res===false){}}
catch(e){BOX_CUSTOM_JS.logError(e,'runCustomJsBeforeDisplay');return true;}},runCustomJsAfterDisplay:function(){try{var customJsGuidsToRun=getCustomJsGuidsToRun('After Display',{});var res=runCustomJsGuidsSync('runCustomJsAfterDisplay',customJsGuidsToRun,{},'boolean');if(res===false){}}
catch(e){BOX_CUSTOM_JS.logError(e,'runCustomJsAfterDisplay');return true;}},runCustomJsBeforeFormValidation:function(form){try{var customJsGuidsToRun=getCustomJsGuidsToRun('Before Form Validation',form);return runCustomJsGuidsSync('runCustomJsBeforeFormValidation',customJsGuidsToRun,form,'boolean,string,object');}
catch(e){BOX_CUSTOM_JS.logError(e,'runCustomJsBeforeFormValidation');return true;}},runCustomJsAfterFormValidation:function(form){try{var customJsGuidsToRun=getCustomJsGuidsToRun('After Form Validation',form);return runCustomJsGuidsSync('runCustomJsAfterFormValidation',customJsGuidsToRun,form,'boolean,string,object');}
catch(e){BOX_CUSTOM_JS.logError(e,'runCustomJsAfterFormValidation');return true;}},runCustomJsBeforeSubmit:function(form){try{var customJsGuidsToRun=getCustomJsGuidsToRun('Before Submit',form);return runCustomJsGuidsSync('runCustomJsBeforeSubmit',customJsGuidsToRun,form,'boolean,string,object');}
catch(e){BOX_CUSTOM_JS.logError(e,'runCustomJsBeforeSubmit');return true;}},runCustomJsAfterSubmit:function(form){try{var customJsGuidsToRun=getCustomJsGuidsToRun('After Submit',form);return runCustomJsGuidsSync('runCustomJsAfterSubmit',customJsGuidsToRun,form,'boolean');}
catch(e){BOX_CUSTOM_JS.logError(e,'runCustomJsAfterSubmit');return true;}},runCustomJsBeforeRedirect:function(element,trigger){try{var customJsGuidsToRun=getCustomJsGuidsToRun('Before Redirect',{element:element,trigger:trigger});return runCustomJsGuidsSync('runCustomJsBeforeRedirect',customJsGuidsToRun,{element:element,trigger:trigger},'boolean');}
catch(e){BOX_CUSTOM_JS.logError(e,'runCustomJsBeforeRedirect');return true;}},runCustomJsAfterRedirect:function(element,trigger){try{var customJsGuidsToRun=getCustomJsGuidsToRun('After Redirect',{element:element,trigger:trigger});return runCustomJsGuidsSync('runCustomJsAfterRedirect',customJsGuidsToRun,{element:element,trigger:trigger},'void');}
catch(e){BOX_CUSTOM_JS.logError(e,'runCustomJsAfterRedirect');return;}},runCustomJsBeforeDownload:function(page,name,element){try{var customJsGuidsToRun=getCustomJsGuidsToRun('Before Download',{page:page,name:name,element:element});return runCustomJsGuidsSync('runCustomJsBeforeDownload',customJsGuidsToRun,{page:page,name:name,element:element},'boolean');}
catch(e){BOX_CUSTOM_JS.logError(e,'runCustomJsBeforeDownload');return true;}},runCustomJsAfterDownload:function(page,name,element){try{var customJsGuidsToRun=getCustomJsGuidsToRun('After Download',{page:page,name:name,element:element});return runCustomJsGuidsSync('runCustomJsAfterDownload',customJsGuidsToRun,{page:page,name:name,element:element},'void');}
catch(e){BOX_CUSTOM_JS.logError(e,'runCustomJsAfterDownload');return;}},runCustomJsBeforeOpenAnotherBox:function(target_lightbox_guid,trigger){try{var customJsGuidsToRun=getCustomJsGuidsToRun('Before Open Another Box',{target_lightbox_guid:target_lightbox_guid,trigger:trigger});return runCustomJsGuidsSync('runCustomJsBeforeOpenAnotherBox',customJsGuidsToRun,{target_lightbox_guid:target_lightbox_guid,trigger:trigger},'boolean');}
catch(e){BOX_CUSTOM_JS.logError(e,'runCustomJsBeforeOpenAnotherBox');return true;}},runCustomJsAfterOpenAnotherBox:function(target_lightbox_guid,trigger){try{var customJsGuidsToRun=getCustomJsGuidsToRun('After Open Another Box',{target_lightbox_guid:target_lightbox_guid,trigger:trigger});return runCustomJsGuidsSync('runCustomJsAfterOpenAnotherBox',customJsGuidsToRun,{target_lightbox_guid:target_lightbox_guid,trigger:trigger},'void');}
catch(e){BOX_CUSTOM_JS.logError(e,'runCustomJsAfterOpenAnotherBox');return;}},runCustomJsBeforeChangePages:function(old_page,new_page,name,element,trigger){try{var customJsGuidsToRun=getCustomJsGuidsToRun('Before Change Pages',{old_page:old_page,new_page:new_page,name:name,element:element,trigger:trigger});return runCustomJsGuidsSync('runCustomJsBeforeChangePages',customJsGuidsToRun,{old_page:old_page,new_page:new_page,name:name,element:element,trigger:trigger},'boolean');}
catch(e){BOX_CUSTOM_JS.logError(e,'runCustomJsBeforeChangePages');return true;}},runCustomJsAfterChangePages:function(old_page,new_page,name,element,trigger){try{var customJsGuidsToRun=getCustomJsGuidsToRun('After Change Pages',{old_page:old_page,new_page:new_page,name:name,element:element,trigger:trigger});return runCustomJsGuidsSync('runCustomJsAfterChangePages',customJsGuidsToRun,{old_page:old_page,new_page:new_page,name:name,element:element,trigger:trigger},'void');}
catch(e){BOX_CUSTOM_JS.logError(e,'runCustomJsAfterChangePages');return;}},runCustomJsBeforeClose:function(){try{var customJsGuidsToRun=getCustomJsGuidsToRun('Before Close',{});var res=runCustomJsGuidsSync('runCustomJsBeforeClose',customJsGuidsToRun,{},'void');}
catch(e){BOX_CUSTOM_JS.logError(e,'runCustomJsBeforeClose');return;}},runCustomJsAfterClose:function(){try{var customJsGuidsToRun=getCustomJsGuidsToRun('After Close',{});var res=runCustomJsGuidsSync('(BOX #'+LIGHTBOX_SHORT_ID+') - runCustomJsAfterClose',customJsGuidsToRun,{},'void');}
catch(e){BOX_CUSTOM_JS.logError(e,'runCustomJsAfterClose');return;}},log:function(msg){try{parent.DIGIOH_API.log(msg);}
catch(e){}},logError:function(e,msg){try{parent.DIGIOH_API.logErrorFromBox(e,msg);}
catch(e){}}};checkJqLoaded();