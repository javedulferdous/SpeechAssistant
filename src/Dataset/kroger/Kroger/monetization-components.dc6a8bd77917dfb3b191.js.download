(window.webpackJsonp=window.webpackJsonp||[]).push([["@kroger/monetization-components"],{"25GR":function(t,e,n){"use strict";var o,r=n("sdug"),i=n("Gee6"),s={},a=((o={})[i.a]=function(t,e){var n;switch(void 0===t&&(t=s),void 0===e&&(e={}),e.type){case r.a.FETCH_ADPLACEMENTS_SUCCESS:return Object.assign({},t,((n={})[e.adPlacementRequestId]=e.data,n));default:return t}},o);e.a=a},ByYs:function(t,e,n){"use strict";var o=n("pVnL"),r=n.n(o),i=n("8OQS"),s=n.n(i),a=n("zQw7"),c=n("PJYZ"),u=n.n(c),h=n("VbXa"),d=n.n(h),p=n("q1tI"),l=n.n(p),f=n("/MKj"),m=(n("Wr5T"),n("i8i4"));n("17x9"),n("kvau"),n("v8il");function v(t){return l.a.isValidElement(t)&&"string"==typeof t.type}var g=/^-?\d*\.?\d+(px|%)$/;function b(t){var e=(t?t.trim():"0px").split(/\s+/).map((function(t){if(!g.test(t))throw new Error("rootMargin must be a string literal containing pixels and/or percent values");return t})),n=e[0],o=void 0===n?"0px":n,r=e[1],i=void 0===r?o:r,s=e[2],a=void 0===s?o:s,c=e[3];return o+" "+i+" "+a+" "+(void 0===c?i:c)}function y(t,e){return Array.isArray(t)&&Array.isArray(e)&&t.length===e.length?t.some((function(n,o){return y(t[o],e[o])})):t!==e}var _=new Map;function I(t,e){var n=_.get(t);if(n)for(var o=n.values(),r=void 0;r=o.next().value;)if(r.target===e.target)return r;return null}function w(t,e){for(var n=0;n<t.length;n++){var o=I(e,t[n]);o&&o.handleChange(t[n])}}function E(t){return function(){for(var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=t.root||null,n=b(t.rootMargin),o=Array.isArray(t.threshold)?t.threshold:[null!=t.threshold?t.threshold:0],r=_.keys(),i=void 0;i=r.next().value;){var s=e!==i.root||n!==i.rootMargin||y(o,i.thresholds);if(!s)return i}return null}(t)||new IntersectionObserver(w,t)}function C(t){_.has(t.observer)||_.set(t.observer,new Set),_.get(t.observer).add(t),t.observer.observe(t.target)}function T(t){if(_.has(t.observer)){var e=_.get(t.observer);e.delete(t)&&(e.size>0?t.observer.unobserve(t.target):(t.observer.disconnect(),_.delete(t.observer)))}}var x="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},O=function(){function t(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}return function(e,n,o){return n&&t(e.prototype,n),o&&t(e,o),e}}();function R(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function S(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}var A=["root","rootMargin","threshold"],N=["disabled"].concat(A),M=Object.prototype,P=function(t){function e(){var n,o;R(this,e);for(var r=arguments.length,i=Array(r),s=0;s<r;s++)i[s]=arguments[s];return n=o=S(this,t.call.apply(t,[this].concat(i))),o.handleChange=function(t){o.props.onChange(t,o.unobserve),o.props.onlyOnce&&t.isIntersecting&&o.unobserve()},o.handleNode=function(t){var e=o.props.children.ref;e&&("function"==typeof e?e(t):"object"===(void 0===e?"undefined":x(e))&&(e.current=t)),o.targetChanged=null!=(o.renderedTarget&&t)&&o.renderedTarget!==t,o.targetChanged&&o.unobserve(),o.target=t},o.observe=function(){o.target=v(o.target)?o.target:Object(m.findDOMNode)(o.target),o.observer=E(o.options),C(o)},o.unobserve=function(){null!=o.target&&T(o)},S(o,n)}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,t),e.prototype.componentDidMount=function(){this.props.disabled||this.observe()},e.prototype.componentDidUpdate=function(t){var e=this,n=N.some((function(n){return y(e.props[n],t[n])}));n&&this.unobserve(),(this.targetChanged||n)&&(this.props.disabled||this.observe())},e.prototype.componentWillUnmount=function(){this.unobserve()},e.prototype.render=function(){return this.renderedTarget=this.target,l.a.cloneElement(l.a.Children.only(this.props.children),{ref:this.handleNode})},O(e,[{key:"options",get:function(){var t=this;return A.reduce((function(e,n){if(M.hasOwnProperty.call(t.props,n)){var o="root"===n&&"[object String]"===M.toString.call(t.props[n]);e[n]=o?document.querySelector(t.props[n]):t.props[n]}return e}),{})}}]),e}(l.a.Component);P.displayName="IntersectionObserver";var L=P,k=function(t){var e=t.id,n=t.espot_id,o=t.espotName,r=t.monetized,i=void 0!==r&&r,s=t.viewStatus,a=t.viewDuration,c={componentName:"espot",scenarioName:"make-a-good-impression",usageContext:"make a good impression",schemaVersion:"0.3.0",kpm:i,espotName:o};if(!0===i){var u=function(t){var e=t.id,n=t.espot_id,o=t.monetized,r=void 0!==o&&o,i=t.viewStatus,s=t.viewDuration;if(r&&void 0===e||null===e)return console.warn("ðŸ‘º No ID found for monetized impression ðŸ‘º"),{monetization:{}};var a={impression_id:e,espot_id:n,viewStatus:i};return"end"===i&&(a.viewDuration=s),{monetization:a}}({id:e,espot_id:n,monetized:i,viewStatus:s,viewDuration:a});c.monetization=u.monetization}return{type:"impression/COMPLETE",payload:c}},D=n("ANjH"),j="end",F="start",z=function(t){var e=t.id,n=t.espot_id,o=t.espotName,i=t.impressionConfig,a=void 0===i?{threshold:.5,duration:1e3,monetized:!1}:i,c=s()(t,["id","espot_id","espotName","impressionConfig"]);return function(t){var i=t.displayName||t.name||"Component";!function(t,e){if("string"!=typeof t&&"number"!=typeof t)throw new TypeError("Expected ID to be of type string or number, but got: "+typeof t);if("object"!=typeof e)throw new TypeError("Expected Impression Config to be of type object, but got: "+typeof e);var n=Object.keys(e);if(!n.includes("threshold")||!n.includes("duration"))throw new RangeError("Expected config values to include threshold and duration, but got "+n)}(e,a);var h=function(i){function s(t){var e;return(e=i.call(this,t)||this).sendImpressionComplete=e.sendImpressionComplete.bind(u()(e)),e.handleChange=e.handleChange.bind(u()(e)),e.state={startTime:(new Date).getTime()},e}d()(s,i);var h=s.prototype;return h.componentWillUnmount=function(){this.state.isIntersecting&&this.state.intersectionRatio>=a.threshold&&this.sendImpressionComplete(j)},h.sendImpressionComplete=function(t){var i=a.monetized,s=r()({id:e,monetized:i,viewStatus:t,espot_id:n,espotName:o},c);if(t===j){var u=(new Date).getTime()-this.state.startTime;s.viewDuration=u}this.props.completeImpression(r()({id:e},s))},h.handleChange=function(t){var e=t.isIntersecting,n=t.intersectionRatio,o=a.threshold;e&&n>=o&&(this.setState({startTime:(new Date).getTime(),isIntersecting:e,intersectionRatio:n}),this.sendImpressionComplete(F)),!e&&n<o&&(this.setState({isIntersecting:e,intersectionRatio:n}),this.sendImpressionComplete(j))},h.render=function(){return l.a.createElement(L,{onChange:this.handleChange,threshold:a.threshold},l.a.createElement("div",null,l.a.createElement(t,this.props)))},s}(l.a.Component);h.displayName="withImpressionObserver("+i+")";return Object(D.d)(Object(f.connect)(null,(function(t){return{completeImpression:function(e){var n=e.dispID,o=s()(e,["dispID"]);return t(k(r()({dispID:n},o)))}}})),(function(){return h}))(t)}},q=n("SjGZ"),U=function(t){var e=t.data,n=t.impressionId,o=t.espotId,i=s()(t,["data","impressionId","espotId"]),c={kpm:!0,espot_id:o,impression_id:n},u=z({id:n,espot_id:o,espotName:e.espotItems[0].altText,impressionConfig:{monetized:!0,threshold:.5,duration:1e3}})((function(){return l.a.createElement(a.a,r()({data:r()({},e,{isMonetized:!1,monetizationData:c})},i))}));return Object.keys(e).length>0?l.a.createElement(u,null):null};e.a=function(t){var e=t.assetId,n=t.impressionId;return l.a.createElement(q.a,{type:"espot",version:"1.0.0",id:e},l.a.createElement(U,{impressionId:n,espotId:e}))}},Gee6:function(t,e,n){"use strict";n.d(e,"a",(function(){return o})),n.d(e,"b",(function(){return r}));var o="toaContainers",r="/toa/v1/ad-placements"},Wr5T:function(t,e,n){!function(){"use strict";if("IntersectionObserver"in window&&"IntersectionObserverEntry"in window&&"intersectionRatio"in window.IntersectionObserverEntry.prototype)"isIntersecting"in window.IntersectionObserverEntry.prototype||Object.defineProperty(window.IntersectionObserverEntry.prototype,"isIntersecting",{get:function(){return this.intersectionRatio>0}});else{var t=window.document,e=[];o.prototype.THROTTLE_TIMEOUT=100,o.prototype.POLL_INTERVAL=null,o.prototype.USE_MUTATION_OBSERVER=!0,o.prototype.observe=function(t){if(!this._observationTargets.some((function(e){return e.element==t}))){if(!t||1!=t.nodeType)throw new Error("target must be an Element");this._registerInstance(),this._observationTargets.push({element:t,entry:null}),this._monitorIntersections(),this._checkForIntersections()}},o.prototype.unobserve=function(t){this._observationTargets=this._observationTargets.filter((function(e){return e.element!=t})),this._observationTargets.length||(this._unmonitorIntersections(),this._unregisterInstance())},o.prototype.disconnect=function(){this._observationTargets=[],this._unmonitorIntersections(),this._unregisterInstance()},o.prototype.takeRecords=function(){var t=this._queuedEntries.slice();return this._queuedEntries=[],t},o.prototype._initThresholds=function(t){var e=t||[0];return Array.isArray(e)||(e=[e]),e.sort().filter((function(t,e,n){if("number"!=typeof t||isNaN(t)||t<0||t>1)throw new Error("threshold must be a number between 0 and 1 inclusively");return t!==n[e-1]}))},o.prototype._parseRootMargin=function(t){var e=(t||"0px").split(/\s+/).map((function(t){var e=/^(-?\d*\.?\d+)(px|%)$/.exec(t);if(!e)throw new Error("rootMargin must be specified in pixels or percent");return{value:parseFloat(e[1]),unit:e[2]}}));return e[1]=e[1]||e[0],e[2]=e[2]||e[0],e[3]=e[3]||e[1],e},o.prototype._monitorIntersections=function(){this._monitoringIntersections||(this._monitoringIntersections=!0,this.POLL_INTERVAL?this._monitoringInterval=setInterval(this._checkForIntersections,this.POLL_INTERVAL):(r(window,"resize",this._checkForIntersections,!0),r(t,"scroll",this._checkForIntersections,!0),this.USE_MUTATION_OBSERVER&&"MutationObserver"in window&&(this._domObserver=new MutationObserver(this._checkForIntersections),this._domObserver.observe(t,{attributes:!0,childList:!0,characterData:!0,subtree:!0}))))},o.prototype._unmonitorIntersections=function(){this._monitoringIntersections&&(this._monitoringIntersections=!1,clearInterval(this._monitoringInterval),this._monitoringInterval=null,i(window,"resize",this._checkForIntersections,!0),i(t,"scroll",this._checkForIntersections,!0),this._domObserver&&(this._domObserver.disconnect(),this._domObserver=null))},o.prototype._checkForIntersections=function(){var t=this._rootIsInDom(),e=t?this._getRootRect():{top:0,bottom:0,left:0,right:0,width:0,height:0};this._observationTargets.forEach((function(o){var r=o.element,i=s(r),a=this._rootContainsTarget(r),c=o.entry,u=t&&a&&this._computeTargetAndRootIntersection(r,e),h=o.entry=new n({time:window.performance&&performance.now&&performance.now(),target:r,boundingClientRect:i,rootBounds:e,intersectionRect:u});c?t&&a?this._hasCrossedThreshold(c,h)&&this._queuedEntries.push(h):c&&c.isIntersecting&&this._queuedEntries.push(h):this._queuedEntries.push(h)}),this),this._queuedEntries.length&&this._callback(this.takeRecords(),this)},o.prototype._computeTargetAndRootIntersection=function(e,n){if("none"!=window.getComputedStyle(e).display){for(var o,r,i,a,u,h,d,p,l=s(e),f=c(e),m=!1;!m;){var v=null,g=1==f.nodeType?window.getComputedStyle(f):{};if("none"==g.display)return;if(f==this.root||f==t?(m=!0,v=n):f!=t.body&&f!=t.documentElement&&"visible"!=g.overflow&&(v=s(f)),v&&(o=v,r=l,i=void 0,a=void 0,u=void 0,h=void 0,d=void 0,p=void 0,i=Math.max(o.top,r.top),a=Math.min(o.bottom,r.bottom),u=Math.max(o.left,r.left),h=Math.min(o.right,r.right),p=a-i,!(l=(d=h-u)>=0&&p>=0&&{top:i,bottom:a,left:u,right:h,width:d,height:p})))break;f=c(f)}return l}},o.prototype._getRootRect=function(){var e;if(this.root)e=s(this.root);else{var n=t.documentElement,o=t.body;e={top:0,left:0,right:n.clientWidth||o.clientWidth,width:n.clientWidth||o.clientWidth,bottom:n.clientHeight||o.clientHeight,height:n.clientHeight||o.clientHeight}}return this._expandRectByRootMargin(e)},o.prototype._expandRectByRootMargin=function(t){var e=this._rootMarginValues.map((function(e,n){return"px"==e.unit?e.value:e.value*(n%2?t.width:t.height)/100})),n={top:t.top-e[0],right:t.right+e[1],bottom:t.bottom+e[2],left:t.left-e[3]};return n.width=n.right-n.left,n.height=n.bottom-n.top,n},o.prototype._hasCrossedThreshold=function(t,e){var n=t&&t.isIntersecting?t.intersectionRatio||0:-1,o=e.isIntersecting?e.intersectionRatio||0:-1;if(n!==o)for(var r=0;r<this.thresholds.length;r++){var i=this.thresholds[r];if(i==n||i==o||i<n!=i<o)return!0}},o.prototype._rootIsInDom=function(){return!this.root||a(t,this.root)},o.prototype._rootContainsTarget=function(e){return a(this.root||t,e)},o.prototype._registerInstance=function(){e.indexOf(this)<0&&e.push(this)},o.prototype._unregisterInstance=function(){var t=e.indexOf(this);-1!=t&&e.splice(t,1)},window.IntersectionObserver=o,window.IntersectionObserverEntry=n}function n(t){this.time=t.time,this.target=t.target,this.rootBounds=t.rootBounds,this.boundingClientRect=t.boundingClientRect,this.intersectionRect=t.intersectionRect||{top:0,bottom:0,left:0,right:0,width:0,height:0},this.isIntersecting=!!t.intersectionRect;var e=this.boundingClientRect,n=e.width*e.height,o=this.intersectionRect,r=o.width*o.height;this.intersectionRatio=n?Number((r/n).toFixed(4)):this.isIntersecting?1:0}function o(t,e){var n,o,r,i=e||{};if("function"!=typeof t)throw new Error("callback must be a function");if(i.root&&1!=i.root.nodeType)throw new Error("root must be an Element");this._checkForIntersections=(n=this._checkForIntersections.bind(this),o=this.THROTTLE_TIMEOUT,r=null,function(){r||(r=setTimeout((function(){n(),r=null}),o))}),this._callback=t,this._observationTargets=[],this._queuedEntries=[],this._rootMarginValues=this._parseRootMargin(i.rootMargin),this.thresholds=this._initThresholds(i.threshold),this.root=i.root||null,this.rootMargin=this._rootMarginValues.map((function(t){return t.value+t.unit})).join(" ")}function r(t,e,n,o){"function"==typeof t.addEventListener?t.addEventListener(e,n,o||!1):"function"==typeof t.attachEvent&&t.attachEvent("on"+e,n)}function i(t,e,n,o){"function"==typeof t.removeEventListener?t.removeEventListener(e,n,o||!1):"function"==typeof t.detatchEvent&&t.detatchEvent("on"+e,n)}function s(t){var e;try{e=t.getBoundingClientRect()}catch(t){}return e?(e.width&&e.height||(e={top:e.top,right:e.right,bottom:e.bottom,left:e.left,width:e.right-e.left,height:e.bottom-e.top}),e):{top:0,bottom:0,left:0,right:0,width:0,height:0}}function a(t,e){for(var n=e;n;){if(n==t)return!0;n=c(n)}return!1}function c(t){var e=t.parentNode;return e&&11==e.nodeType&&e.host?e.host:e&&e.assignedSlot?e.assignedSlot.parentNode:e}}()},"k/PN":function(t,e,n){"use strict";n.r(e);var o=n("25GR");n.d(e,"reducers",(function(){return o.a}));var r=n("ojQK");n.d(e,"TOAContainer",(function(){return r.a}));var i=n("ByYs");n.d(e,"MonetizedEspot",(function(){return i.a}))},ojQK:function(t,e,n){"use strict";var o=n("q1tI"),r=n.n(o),i=n("+QQp"),s=n("pVnL"),a=n.n(s),c=n("VbXa"),u=n.n(c),h=function(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,(function(t){var e=16*Math.random()|0;return("x"===t?e:3&e|8).toString(16)}))},d=n("/MKj"),p=(n("17x9"),n("Y+p1")),l=n.n(p),f=n("SjGZ"),m=n("8OQS"),v=n.n(m),g=n("dCAT"),b=n("sdug"),y=n("Gee6"),_=function(t){return function(e,n){return g.a.get(y.b,{params:(o=n,r=o.displayLocation,i=v()(o,["displayLocation"]),s={"filter.displayLocations":[r]},c=Object.keys(i).reduce((function(t,e){return t["filter."+e]=i[e],t}),{}),a()({},s,c))}).then((function(o){var r=o.data.data.adPlacements.filter((function(t){return t.displayLocation===n.displayLocation}))[0];t({type:b.a.FETCH_ADPLACEMENTS_SUCCESS,adPlacementRequestId:e,data:r})})).catch((function(){t({type:b.a.FETCH_ADPLACEMENTS_FAILURE,adPlacementRequestId:e})}));var o,r,i,s,c}},I=n("ByYs"),w=function(t){function e(e){var n;return(n=t.call(this,e)||this).getAdPlacement=function(){return n.props.adPlacements[n.state.adPlacementRequestId]},n.state={adPlacementRequestId:h()},n}u()(e,t);var n=e.prototype;return n.fetchAdPlacement=function(){var t=this.props.currentShoppingContext,e=t.storeNumber,n=void 0===e?"":e,o=t.divisionNumber,r=void 0===o?"":o;n&&r&&this.props.fetchAdPlacements(this.state.adPlacementRequestId,a()({},this.props.toaFilters,{divisionId:r,storeId:n}))},n.componentDidMount=function(){this.fetchAdPlacement()},n.isShoppingContextChanged=function(t,e){var n=t.storeNumber,o=void 0===n?"":n,r=t.divisionNumber,i=void 0===r?"":r,s=e.storeNumber,a=void 0===s?"":s,c=e.divisionNumber;return o!==a||i!==(void 0===c?"":c)},n.isToaFiltersChanged=function(t,e){return!l()(t,e)},n.fetchNewAdPlacement=function(){var t=this;this.setState({adPlacementRequestId:h()},(function(){return t.fetchAdPlacement()}))},n.componentDidUpdate=function(t){(this.isShoppingContextChanged(t.currentShoppingContext,this.props.currentShoppingContext)||this.isToaFiltersChanged(t.toaFilters,this.props.toaFilters))&&this.fetchNewAdPlacement()},n.render=function(){var t=this.getAdPlacement();return r.a.createElement("div",{"data-qa":"TOAContainer"},t?r.a.createElement(I.a,{assetId:t.assetId,impressionId:t.id}):null)},e}(r.a.Component),E=Object(d.connect)((function(t){return{adPlacements:t[y.a],currentShoppingContext:Object(f.b)(t)}}),(function(t){return{fetchAdPlacements:_(t)}}),(function(t,e,n){return a()({},t,e,{toaFilters:n})}))(w);e.a=function(t){return r.a.createElement(i.a,{showUnauthenticatedContent:!1},r.a.createElement(E,t))}},sdug:function(t,e,n){"use strict";e.a={FETCH_ADPLACEMENTS_SUCCESS:"TOA/FETCH_ADPLACEMENTS_SUCCESS",FETCH_ADPLACEMENTS_FAILURE:"TOA/FETCH_ADPLACEMENTS_FAILURE"}},v8il:function(t,e,n){"use strict";var o=function(){};t.exports=o}}]);
//# sourceMappingURL=monetization-components.dc6a8bd77917dfb3b191.js.map