(window.webpackJsonp=window.webpackJsonp||[]).push([[2],{Q1bK:function(e,t,o){"use strict";var s=o("q1tI"),n=o.n(s),r=o("17x9"),a=o.n(r),i=o("eJN4"),c=o("OhoJ"),p=o("ldFH");function g(e){return(g="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"===typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function l(e,t){for(var o=0;o<t.length;o++){var s=t[o];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(e,s.key,s)}}function u(e,t){return(u=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function d(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var o,s=h(e);if(t){var n=h(this).constructor;o=Reflect.construct(s,arguments,n)}else o=s.apply(this,arguments);return f(this,o)}}function f(e,t){return!t||"object"!==g(t)&&"function"!==typeof t?w(e):t}function w(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function h(e){return(h=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var m=function(e){!function(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&u(e,t)}(a,e);var t,o,s,r=d(a);function a(e){var t;if(function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,a),(t=r.call(this,e)).state={username:"",password:"",nextState:!1,emailErrorMessage:"",emailErrorMessageClass:"",passwordErrorMessage:"",passwordErrorMessageClass:"",forgetUser:!1,signInMessage:"",signInMessageClass:"",tempPasswordError:"",newPasswordError:"",newTempPasswordError:"",newpasswordLock:!1,temppasswordLock:!1,optGDPRPolicy:!1},t.email=n.a.createRef(),t.password=n.a.createRef(),t.goNext=t.goNext.bind(w(t)),t.onSignInV3=t.onSignInV3.bind(w(t)),t.getUserDetails=t.getUserDetails.bind(w(t)),t.googleLogin=t.googleLogin.bind(w(t)),t.facebookLogin=t.facebookLogin.bind(w(t)),t.validateUserType=t.validateUserType.bind(w(t)),t.forgotPassword=t.forgotPassword.bind(w(t)),t.recoverPassword=t.recoverPassword.bind(w(t)),t.temppasswordLock=t.temppasswordLock.bind(w(t)),t.cancelEmailRecovery=t.cancelEmailRecovery.bind(w(t)),t.goBack=t.goBack.bind(w(t)),t.newpasswordLock=t.newpasswordLock.bind(w(t)),t.resetTempPassword=t.resetTempPassword.bind(w(t)),t.optOutGDPR=t.optOutGDPR.bind(w(t)),t.manageUserAction=t.manageUserAction.bind(w(t)),t.grecaptchaLogin=t.grecaptchaLogin.bind(w(t)),!window.fbAsyncInit){var o="254155001398899";window.FEATURES&&window.FEATURES.fbAppId?o=window.FEATURES.fbAppId:window.cockpitSetting&&window.cockpitSetting.ProfileSettings.FacebookClientId&&(o=window.cockpitSetting.ProfileSettings.FacebookClientId),window.fbAsyncInit=function(){window.FB.init({appId:o,channelUrl:"//"+window.location.href,scope:"id,name,first_name,last_name,gender,email,birthday",status:!1,cookie:!0,xfbml:!0,oauth:!0,version:"v2.1"})}}return t.sessionTokenExp=2,i.a.loadScripts(),t}return t=a,(o=[{key:"manageUserAction",value:function(e,t){return"getUserDetails"===e&&window.AnalyticsService&&window.AnalyticsService.SetProfileAttribute&&window.AnalyticsService.SetProfileAttribute("ProfileId",t.PersonGuid),i.a.manageUserAction(e,t)}},{key:"goNext",value:function(e){e.preventDefault(),this.props.aiCategory&&window.AnalyticsServiceLogEvent&&window.AnalyticsServiceLogEvent({Category:this.props.aiCategory,Action:"emailnext_clicked"}),i.a.trackLogin("profile next click");var t=this,o=t.email.value,s=t.state.optGDPRPolicy,n=t.props,r=n.signUpSource,a=n.pageCategory,c=n.pageComponent;o?o.match(p.b)?(this.setState({emailErrorMessage:"",username:o,nextState:!0}),t.manageUserAction("isRegisteredUser",{userName:o,signUpSource:r,pageCategory:a,pageComponent:c,isNewsletter:"ReferAFriend-Refree"!==t.props.signUpSource,optGDPRPolicy:s}).then((function(e){window.grecaptcha&&t.validateUserType(e)}))):this.setState({emailErrorMessage:this.msg.invalidEmail,emailErrorMessageClass:this.msgClass.invalidEmail}):this.setState({emailErrorMessage:this.msg.emptyEmail,emailErrorMessageClass:this.msgClass.emptyEmail})}},{key:"validateUserType",value:function(e){var t=e.data.AlreadyRegistered;this.setState({isRegisteredUser:t,isNewUser:!t,loginStage:t?2:3})}},{key:"onSignInV3",value:function(e){e.preventDefault(),i.a.trackLogin("profile sign in click");var t=this.password.value;t.length>7?(this.setState({password:t}),this.grecaptchaLogin(this.state.username,t,this.props.signUpSource,this.props.pageCategory,this.props.pageComponent)):(this.setState({passwordErrorMessage:this.msg.invalidPassword,passwordErrorMessageClass:this.msgClass.invalidPassword}),i.a.trackLogin("profile login invalid password entered"))}},{key:"grecaptchaLogin",value:function(e,t,o,s,n){var r=this,a=r.state.optGDPRPolicy;return i.a.trackLogin("profile sign in request made"),r.manageUserAction("userLogin",{userName:e,password:t,signUpSource:o,pageCategory:s,pageComponent:n,optGDPRPolicy:a},null).then((function(e){if(!e)return!1;500===e.status&&i.a.trackLogin("profile request 500"),e.data.Message?(r.setState({signInMessage:e.data.Message,signInMessageClass:r.msgClass.loginFailure}),i.a.trackLogin("profile server error "+e.data.Message),r.props.aiCategory&&window.AnalyticsServiceLogEvent&&window.AnalyticsServiceLogEvent({Category:r.props.aiCategory,Action:"profile_errormessage",Values:{message:e.data.Message}})):e.data.SessionToken?(r.setState({signInMessage:r.msg.loginSuccess,signInMessageClass:r.msgClass.loginSuccess}),window.AnalyticsService&&window.AnalyticsService.SetProfileAttribute&&window.AnalyticsService.SetProfileAttribute("profile_id",e.data.PersonGuid),r.getUserDetails(e.data.SessionToken,e.data.PersonGuid,1).then((function(e){r.props.closePopUp&&r.props.closePopUp(),window.Launchpad&&window.Launchpad.logEvent&&r.props.signUpSource&&c.a.TrackGACommonEvent(r.props.signUpSource,r.props.signUpSource+"_profile_signin_successful"),i.a.trackLogin("profile login success"),r.props.aiCategory&&window.AnalyticsServiceLogEvent&&window.AnalyticsServiceLogEvent({Category:r.props.aiCategory,Action:"email_successful"})})).catch((function(e){return i.a.trackLogin("profile user details error")}))):(r.setState({loginStage:4}),window.Launchpad&&window.Launchpad.logEvent&&window.Launchpad.logEvent("profile_signin_unsuccessful"),i.a.trackLogin("profile login error no session token"))})),!1}},{key:"getUserDetails",value:function(e,t,o){return this.manageUserAction("getUserDetails",{sessionToken:e,authType:o,updateUserLogin:this.props.updateUserLogin,PersonGuid:t,sessionTokenExp:this.sessionTokenExp},null,null)}},{key:"googleLogin",value:function(){this.props.aiCategory&&window.AnalyticsServiceLogEvent&&window.AnalyticsServiceLogEvent({Category:this.props.aiCategory,Action:"google_clicked"}),window.Launchpad&&window.Launchpad.logEvent&&window.Launchpad.logEvent("google_signin_click"),i.a.trackLogin("google signin click");var e=this;e.manageUserAction("googleLogin",{signUpSource:this.props.signUpSource,pageCategory:this.props.pageCategory,pageComponent:this.props.pageComponent},null,null).then((function(t){t.SessionToken?e.getUserDetails(t.SessionToken,t.PersonGuid,3).then((function(t){e.props.closePopUp&&e.props.closePopUp(),window.Launchpad&&window.Launchpad.logEvent&&(e.props.signUpSource?(c.a.TrackGACommonEvent(e.props.signUpSource,e.props.signUpSource+"_google_signin_successful"),window.Launchpad.logEvent(e.props.signUpSource+"_google_signin_successful")):window.Launchpad.logEvent("google_signin_successful_EmptySource")),i.a.trackLogin("google login success"),e.props.aiCategory&&window.AnalyticsServiceLogEvent&&window.AnalyticsServiceLogEvent({Category:e.props.aiCategory,Action:"google_successful"})})).catch((function(e){return i.a.trackLogin("google user details error")})):(window.Launchpad&&window.Launchpad.logEvent&&window.Launchpad.logEvent("google_signin_unsuccessful"),i.a.trackLogin("google success profile request no session token"))}))}},{key:"facebookLogin",value:function(){this.props.aiCategory&&window.AnalyticsServiceLogEvent&&window.AnalyticsServiceLogEvent({Category:this.props.aiCategory,Action:"facebook_clicked"}),window.Launchpad&&window.Launchpad.logEvent&&window.Launchpad.logEvent("facebook_signin_click"),i.a.trackLogin("facebook signin click");var e=this;e.manageUserAction("facebookLogin",{signUpSource:this.props.signUpSource,pageCategory:this.props.pageCategory,pageComponent:this.props.pageComponent},null,null).then((function(t){t.SessionToken?e.getUserDetails(t.SessionToken,t.PersonGuid,2).then((function(t){e.props.closePopUp&&e.props.closePopUp(),window.Launchpad&&window.Launchpad.logEvent&&(e.props.signUpSource?(c.a.TrackGACommonEvent(e.props.signUpSource,e.props.signUpSource+"_facebook_signin_successful"),window.Launchpad.logEvent(e.props.signUpSource+"_facebook_signin_successful")):window.Launchpad.logEvent("facebook_signin_successful_EmptySource")),i.a.trackLogin("facebook login success"),e.props.aiCategory&&window.AnalyticsServiceLogEvent&&window.AnalyticsServiceLogEvent({Category:e.props.aiCategory,Action:"facebook_successful"})})).catch((function(e){return i.a.trackLogin("facebook user details error")})):(window.Launchpad&&window.Launchpad.logEvent&&window.Launchpad.logEvent("facebook_signin_unsuccessful"),i.a.trackLogin("facebook success profile request no session token"))}))}},{key:"recoverPassword",value:function(e){var t=this;return e.preventDefault(),i.a.trackLogin("profile recover password click"),new Promise((function(e,o){window.grecaptcha.execute("6LfBWIYUAAAAAH-QFfjd8DMfNxGkONqMbmMTpf5W",{action:"React_RecoverPassword"}).then((function(s){if(s){var n=t;n.manageUserAction("recoverPassword",{username:t.state.username,token:s}).then((function(t){t&&"Email sent"===t.data&&(n.setState({signInMessage:n.msg.resetEmailLink,signInMessageClass:n.msgClass.resetEmailLink,forgetUser:!1}),e(t.data)),setTimeout((function(){n.setState({signInMessage:null,signInMessageClass:""})}),5e3)}))}else o(null)}))}))}},{key:"resetTempPassword",value:function(e){e.preventDefault();var t=this,o="",s="",n=t.temppassword.value,r=t.newpassword.value,a=t.state.username;(!n||n.length<=1)&&(!r||r.length<=1)?(o=this.msg.emptyPassword,s=this.msg.emptyPassword):!n||n.length<=1?(o=this.msg.emptyPassword,s="",t.setState({newTempPasswordError:""})):!r||r.length<=1?(s=this.msg.emptyPassword,o="",t.setState({newTempPasswordError:""})):t.manageUserAction("resetTempPassword",{userName:a,tempPassword:n,newPassword:r},null).then((function(e){e&&e.data?e.data.SessionToken&&(t.setState({signInMessage:t.msg.loginSuccess,signInMessageClass:t.msgClass.loginSuccess}),t.getUserDetails(e.data.SessionToken,e.data.PersonGuid,1).then((function(e){t.props.closePopUp&&t.props.closePopUp()}))):t.setState({newTempPasswordError:t.msg.incorrectPassword})})),t.setState({tempPasswordError:o,newPasswordError:s})}},{key:"goBack",value:function(e){e.preventDefault(),this.setState({forgetUser:!1,nextState:!1,isUser:void 0,isNewUser:void 0,isRegisteredUser:void 0,passwordErrorMessage:"",signInMessage:null,signInMessageClass:"",loginStage:1,newTempPasswordError:""})}},{key:"optOutGDPR",value:function(){this.setState({optGDPRPolicy:!this.state.optGDPRPolicy})}},{key:"temppasswordLock",value:function(){this.setState({temppasswordLock:!this.state.temppasswordLock})}},{key:"newpasswordLock",value:function(){this.setState({newpasswordLock:!this.state.newpasswordLock})}},{key:"forgotPassword",value:function(){this.setState({forgetUser:!0,signInMessage:"",signInMessageClass:"",passwordErrorMessage:""})}},{key:"cancelEmailRecovery",value:function(){this.setState({forgetUser:!1,signInMessage:"",signInMessageClass:"",passwordErrorMessage:""})}}])&&l(t.prototype,o),s&&l(t,s),a}(n.a.Component);m.propTypes={signUpSource:a.a.string,pageCategory:a.a.string,pageComponent:a.a.string},t.a=m},zPgE:function(e,t,o){"use strict";var s=o("q1tI"),n=o.n(s),r=o("17x9"),a=o.n(r),i=(o("i8i4"),o("eJN4")),c=o("DFIj"),p=o("OhoJ");o("/MKj");function g(e){return(g="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"===typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function l(e,t){for(var o=0;o<t.length;o++){var s=t[o];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(e,s.key,s)}}function u(e,t){return(u=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function d(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var o,s=h(e);if(t){var n=h(this).constructor;o=Reflect.construct(s,arguments,n)}else o=s.apply(this,arguments);return f(this,o)}}function f(e,t){return!t||"object"!==g(t)&&"function"!==typeof t?w(e):t}function w(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function h(e){return(h=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var m=function(e){!function(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&u(e,t)}(r,e);var t,o,s,n=d(r);function r(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,r),(t=n.call(this,e)).state={firstNameErrorMessage:"",lastNameErrorMessage:"",passwordErrorMessage:""},t.getUserDetails=t.getUserDetails.bind(w(t)),t.validateForm=t.validateForm.bind(w(t)),t}return t=r,(o=[{key:"getUserDetails",value:function(e,t,o){return i.a.manageUserAction("getUserDetails",{sessionToken:e,authType:o,updateUserLogin:this.props.updateUserLogin,PersonGuid:t,sessionTokenExp:this.sessionTokenExp},null,null)}},{key:"validateForm",value:function(){var e=this;this.props.aiCategory&&window.AnalyticsServiceLogEvent&&window.AnalyticsServiceLogEvent({Category:this.props.aiCategory,Action:"register_clicked"}),window.Launchpad&&window.Launchpad.logEvent&&window.Launchpad.logEvent("register_click"),i.a.trackLogin("register submit click");var t=this,o=/^[ A-Za-z-']+$/,s=/^[A-Za-z]+$/,n="",r="",a="",g=this.firstName?this.firstName.value:"",l=this.lastName?this.lastName.value:"",u=this.password?this.password.value:"";if(!g||g.length<=1?n="First name field can't be less than 2 characters.":g.charAt(0).match(s)?g.match(o)||(n="Name can only contain apostrophe, space or hyphen."):n="Name must begin with a letter.",!l||l.length<=1?r="Last name field can't be less than 2 characters.":l.charAt(0).match(s)?l.match(o)||(r="Name can only contain apostrophe, space or hyphen."):r="Name must begin with a letter.",!u||u.length<=0)a="Password field can't be left blank.";else{var d=u.match(/^(?=.*\d)[0-9a-zA-Z!_@#$%^&*()-]{8,30}$/);(!d||d.length<=0)&&(a="Your password must be between 8 and 30 characters, have at least 1 number and 1 letter, and cannot have spaces.")}this.setState({firstNameErrorMessage:n,lastNameErrorMessage:r,passwordErrorMessage:a}),n||r||a?(n&&i.a.trackLogin("register page submit firstname error "+n),r&&i.a.trackLogin("register page submit lastname error "+r),a&&i.a.trackLogin("register page submit password error "+a)):i.a.manageUserAction("registerUser",{userName:this.props.email,firstName:g,lastName:l,password:u,signUpSource:this.props.signUpSource,pageCategory:this.props.pageCategory,pageComponent:this.props.pageComponent},null,null).then((function(o){var s=g+" "+l,n=o.data[1].SessionToken,r=o.data[1].PersonGuid;i.a.createProfileCookies(s,n,1,r),e.getUserDetails(n,r,1).then((function(o){e.props.closePopUp&&e.props.closePopUp(),window.Launchpad&&window.Launchpad.logEvent&&(t.props.signUpSource?("ReferAFriend-Refree"===t.props.signUpSource&&c.a.saveInLocalStorage("accountCreatedRefree",!0),p.a.TrackGACommonEvent(t.props.signUpSource,t.props.signUpSource+"-signup"),window.Launchpad.logEvent(t.props.signUpSource+"-signup")):window.Launchpad.logEvent("register_successful")),i.a.trackLogin("register success"),e.props.aiCategory&&window.AnalyticsServiceLogEvent&&window.AnalyticsServiceLogEvent({Category:e.props.aiCategory,Action:"register_successful"})}))})).catch((function(e){return i.a.trackLogin("register call error")}))}}])&&l(t.prototype,o),s&&l(t,s),r}(n.a.Component);m.propTypes={email:a.a.string,signUpSource:a.a.string,pageCategory:a.a.string,pageComponent:a.a.string},t.a=m}}]);