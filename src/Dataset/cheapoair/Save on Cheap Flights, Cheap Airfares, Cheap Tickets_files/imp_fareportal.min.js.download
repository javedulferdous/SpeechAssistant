if (!(typeof IMP == "object")) {
(function () {

    var csSessionId = "";
    var handlerLoaded = false;
    var nowReplyListnersListing = false;
    var nowReplyListnersPayment = false;
	var nowReplyListnersPaymentMobile = false;
    var extLoggedChat = false;
    var extLoggedFacebook = false;
    var extLoggedTwitter = false;
    var extLoggedYoutube = false;
    var extLoggedShopfinder = false;
    var extLoggedInstagram = false;
    var extLoggedGooglePlus = false;
    var extLoggedFAQ = false;
    var extLoggedPinterest = false;
    var extLoggedEmail = false;
    var extLoggedContactForm = false;
    var extLoggedCallback = false;
    var extLoggedLinkedIn = false;
    var extLoggedChatSidebar = false;
    var extLoggedQuote = false;
    var extLoggedNewsLetter = false;
    var nowInPageListnerPost = false;
    var nowSimpleInPageListnerPost = false;
    var nowActivelog = false;
	var ni_modalAny;
    var ni_IsInsuranceAdded = 0;
    var ni_supportPkgMVP = 0;
    var ni_revPlusTrigger = 0;
	var ni_upgradeBtn = 0;
	var ni_travelAssTrigger = 0;
	var ni_flexibleTicket = 0;
	var ni_SelectSeats = 0;
	var ni_SelectSeatsListen = false;
	var last_SelectSeatsTotal = 0;
	var ni_payevent = "";
    var searchType = "Flights";
    var ni_data_collected = false;
	var currUrl;

	
    var appendReferenceLog = function () {
		var impStartCheck = IMP.getKeyVal("imp_st");
		impStartCheck =  Math.round(impStartCheck) + 0;
		var impLogDataCheck = IMP.getKeyVal("imp_ld");
		//console.log("impStartCheck: " + impStartCheck);
		//console.log("impLogDataCheck: " + impLogDataCheck);
		if ( !impLogDataCheck ) {
			//console.log("impStartCheck return true ");
			return true;
		}
		//console.log("impStartCheck return false ");
		return false;
	 };

    // globals
    return IMP_HL = {

        // on/off section - change true to false to turn off and vice versa

        exist_handle_accepttel: function () { return true; },
        exist_handle_show: function () { return true; },
        exist_handle_acceptpuff: function () { return true; },
        exist_handle_customized: function () { return false },
        exist_handle_customized_number: function () { return false },
        exist_handle_receiveInfo: function () { return false; },
        exist_logUserGroup: function () { return false; },
        exist_logSessionGroup: function () { return false; },
        exist_handle_inithandler: function () { return false; },
        exist_handle_runhandler: function () { return false; },
        exist_handle_runhandlerresult: function () { return false; },
        exist_check_handlerpattern: function () { return false; },
        allow_nocookie: function () { return false; },
        allow_storage: function () { return false; },
        block_loginiframe: function () { return false; },
        block_showiniframe: function () { return true; },
        exist_handlecollectdata: function () { return true; },
        exist_handle_collectmeta: function () { return false },
        exist_handle_focus: function () { return true; },
        exist_appendLocalSiteProp: function () { return true; },
        exist_appendLocalSitePropPostLog: function () { return true; },
        exist_appendLocalSitePropPostReply: function () { return true; },
        exist_handlelogdata: function () { return true; },
        allowed_propenc: function () { return 'pageproperty,event,pagedetail,ni_attachment,ni_payevent'; },
        expected_prop: function () { return ''; },
		session_persist: function () {return true; },
	    exist_local_userkey: function() { return true; },
		
		trackReference: function () {
			setTimeout(
				function() {
					try {
						if (appendReferenceLog()) {
							var fpuid = IMP.getKeyVal("uid");
							IMP.appendSiteProp("fpuid",fpuid);
							IMP.appendSiteProp("impreference","1");
							IMP.appendSiteProp("impversion","post_z48f");
							try {
								IMP.appendSiteProp("impnavigator",navigator.userAgent.replace(/[:"]/g, ""));
							}
							catch (e) {
							}
							IMP.trackLogPost(true);
						}
					}
					catch (e) {
					}
				}
				,3100
			);		
		},

		trackReferenceDelay: function () {
					try {
						if (appendReferenceLog()) {
							var fpuid = IMP.getKeyVal("uid");
							IMP.appendSiteProp("fpuid",fpuid);
							IMP.appendSiteProp("impreference","1");
							IMP.appendSiteProp("impversion","delay_z48f");
							try {
								IMP.appendSiteProp("impnavigator",navigator.userAgent.replace(/[:"]/g, ""));
							}
							catch (e) {
							}
							IMP.trackLogPost(true);
						}
					}
					catch (e) {
					}	
		},
		
		get_local_userkey: function (nowUserKey) {
			try {
				var localuserkey = IMP.getKeyVal("uid");
				if (localuserkey) {
					//console.log("nowUserKey : " + nowUserKey);
					if (!nowUserKey) {
						//console.log("no now userkey");
						return localuserkey;
					}
					if (!(( /Android|webOS|iPhone|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent) ) && (screen.width < 500) ) ) {
						//console.log("override now user key for non mobile");
						if (localuserkey) {
							return localuserkey;
						}	
					}		
				}				
			} catch (usex) {
			}
			return "";
	    },
		
        handle_logdata: function (logData) {
            try {
				var logDataOnp = {};
				if (logData.imp_onp) {
					logDataOnp.imp_onp = logData.imp_onp;
				}
				IMP.setKeyVal("imp_ld", JSON.stringify(logDataOnp), 1);
				if (logData.imp_onp) {
					//IMP.appendSitePropStatic("implogdata", logData.imp_onp);
				}
				var ldcount = 0;
				for (var ldkey in logData) {
					ldcount ++;
					if (ldcount > 15) {
						//console.log("Too many logdata cookies: " + ldcount);
						break;
					}
					if (logData.hasOwnProperty(ldkey)) {
						var val = logData[ldkey];
						//console.log(ldkey);
						//console.log(val);
						IMP.setKeyVal("imp_ld" + "_" + ldkey, val, 1);
					}
				}
                if (typeof window.nowInteractLoaded == 'function') {
                    window.nowInteractLoaded(logData);
                } else {
                    //IMP.appendSitePropStatic("imperrorinfo", "nologdatahandler");
                }
				return true;
            } catch (e) {
                IMP.appendSitePropStatic("imperrorinfo", e);
            }
        },

        logUserGroup: function (code) {

        },

        handle_accepttel: function () {

        },

        handle_acceptpuff: function (code) {

        },

        handle_show: function (caption) {

        },

        handle_customized: function (code, interactionLogId, displayReason, displayReasonDetail, isReferenceMessage) {

        },

        handle_customized_number: function (noA, noB, interactionLogId, displayReason, displayReasonDetail) {

        },

        appendLocalSiteProp: function (isFocus) {

			// x reference id
			try {
				var fpuid = IMP.getKeyVal("uid");
				IMP.appendSiteProp("fpuid",fpuid);
				var curraff = IMP.getKeyVal("CurrAff");
				if (curraff) {
					IMP.appendSiteProp("curraff",curraff);
				}
			}
			catch (e) {
				IMP.appendSiteProp("imperror",e);
			}

			try {
				var implogdataprev = IMP.getKeyVal("imp_ld");
				//IMP.appendSiteProp("implogdataprev",implogdataprev);
				var implogdataprevonp = IMP.getKeyVal("imp_ld_imp_onp");
				IMP.appendSiteProp("implogdataprevonp",implogdataprevonp);			}
			catch (e) {
				IMP.appendSiteProp("imperror",e);
			}

                var storeData = 0;
                var travelData = {};

                try {
                    if (typeof GTMFlight == "object" && GTMFlight.Param.Origin != "") {
                        storeData = 1;
                        travelData.airTravel = {};

                        travelData.airTravel.ticketsAdult = GTMFlight.Param.NoAdults;
                        travelData.airTravel.ticketsChildren = GTMFlight.Param.NoChildren;
                        travelData.airTravel.ticketsInfants = ((GTMFlight.Param.NoInfantsInLap - 0) + (GTMFlight.Param.NoInfantsOnSeat - 0)).toString();
                        travelData.airTravel.ticketsInfantsInLap = GTMFlight.Param.NoInfantsInLap;
                        travelData.airTravel.ticketsInfantsOnSeat = GTMFlight.Param.NoInfantsOnSeat;

						travelData.airTravel.ticketsKid = GTMFlight.Param.NoKid;
                        travelData.airTravel.ticketsSeniors = GTMFlight.Param.NoSeniors;
                        travelData.airTravel.ticketsYouth = GTMFlight.Param.NoYouth;

                        //travelData.airTravel.ticketsTot = GTMFlight.Param.NoPassenger;
						try {
							travelData.airTravel.ticketsTot = (Math.round(GTMFlight.Param.NoAdults) 
																+ Math.round(GTMFlight.Param.NoChildren)
																+ Math.round(GTMFlight.Param.NoInfantsInLap)
																+ Math.round(GTMFlight.Param.NoInfantsOnSeat)
																+ Math.round(GTMFlight.Param.NoKid)
																+ Math.round(GTMFlight.Param.NoSeniors)
																+ Math.round(GTMFlight.Param.NoYouth)).toString();																									
						} catch (e) {}

						if (GTMFlight.Param.FlightClass) {
							if (GTMFlight.Param.FlightClass.toString().length>0) {
								travelData.airTravel.FC = GTMFlight.Param.FlightClass.toString().substring(0,1);
							}							
						}
						if (GTMFlight.Param.TripType) {
							if (GTMFlight.Param.TripType.toString().length>0) {
								travelData.airTravel.TT = GTMFlight.Param.TripType;
							}							
						}
						
                        travelData.airTravel.flight = {};

                        var seDepdate = "";
                        var seDeptime = "";

                        if (typeof GTMFlight.Param.DepartureDate == "string") {

                            if (GTMFlight.Param.DepartureDate.indexOf(" ") > -1 && GTMFlight.Param.DepartureDate.indexOf("/") > -1) {

                                depDateArr = GTMFlight.Param.DepartureDate.split(" ");
                                depDateDate = depDateArr[0].split("/");
                                month = depDateDate[0];
                                if (month < 10) {
                                    month = "0" + month;
                                }

                                day = depDateDate[1];

                                if (day < 10) {
                                    day = "0" + day;
                                }

                                year = depDateDate[2];

                                seDepdate = year + "-" + month + "-" + day;


                                addHours = 0;
                                if (depDateArr[2] == "PM") {
                                    addHours = 12;
                                }



                                depDateTime = depDateArr[1].split(":");

                                hours = (depDateTime[0] - 0) + addHours;

                                if (hours < 10) {
                                    hours = "0" + hours;
                                }

                                minutes = (depDateTime[1] - 0);

                                if (minutes < 10) {
                                    minutes = "0" + minutes;
                                }

                                seDeptime = hours + ":" + minutes;

                            } else if (/\d{4}-\d{2}-\d{2}/.test(GTMFlight.Param.DepartureDate)) {
								seDepdate = GTMFlight.Param.DepartureDate;

							} else {
								//console.log("test:" + /\d{4}-\d{2}-\d{2}/.test(GTMFlight.Param.DepartureDate));
							}

                        }

                        travelData.airTravel.flight.date = seDepdate;

                        travelData.airTravel.flight.departure = {};
                        travelData.airTravel.flight.arrival = {};
						if (GTMFlight.Param.Airline) {
							if (GTMFlight.Param.Airline instanceof Array) {
								if (GTMFlight.Param.Airline.length > 0) {
									travelData.airTravel.flight.airline = GTMFlight.Param.Airline[0];
									travelData.airTravel.flight.airlinefromarray = "1";
								}
							} else {
								travelData.airTravel.flight.airline = GTMFlight.Param.Airline;
							}						
						}

                        travelData.airTravel.flight.departure.iata = GTMFlight.Param.Origin;
                        travelData.airTravel.flight.departure.name = GTMFlight.Param.Origin;

                        travelData.airTravel.flight.departure.time = seDeptime;
						
						travelData.airTravel.flight.departure.country = GTMFlight.Param.OrgCountry;
						travelData.airTravel.flight.departure.region = GTMFlight.Param.OrgRegion;
						travelData.airTravel.flight.departure.state = GTMFlight.Param.OrgState;

                        //travelData.airTravel.flight.departure.city = "";

                        travelType = "";
                        if (GTMFlight.Param.IsDirectFlight == "True") {
                            travelType = "Direct"
                        }
                        else {
                            travelType = GTMFlight.Param.Stops + " stops";

                        }

                        travelData.airTravel.flight.type = travelType;
						if (GTMFlight.Param.duration1) {
							travelData.airTravel.flight.flighttime = GTMFlight.Param.duration1;							
						} else {
							travelData.airTravel.flight.flighttime = "";
						}

                        travelData.airTravel.flight.arrival.iata = GTMFlight.Param.Destination;
                        travelData.airTravel.flight.arrival.name = GTMFlight.Param.Destination;

						travelData.airTravel.flight.arrival.country = GTMFlight.Param.DesCountry;
						travelData.airTravel.flight.arrival.region = GTMFlight.Param.DesRegion;
						travelData.airTravel.flight.arrival.state = GTMFlight.Param.DesState;

                        //travelData.airTravel.flight.arrival.time = "";
                        //travelData.airTravel.flight.arrival.city = "";

                        if (GTMFlight.Param.TripType == "ROUNDTRIP") {


                            var seRetdate = "";
                            var seRettime = "";


                            if (typeof GTMFlight.Param.ReturnDate == "string") {

                                if (GTMFlight.Param.ReturnDate.indexOf(" ") > -1 && GTMFlight.Param.ReturnDate.indexOf("/") > -1) {

                                    retDateArr = GTMFlight.Param.ReturnDate.split(" ");

                                    retDateDate = retDateArr[0].split("/");
                                    month = retDateDate[0];
                                    if (month < 10) {
                                        month = "0" + month;
                                    }

                                    day = retDateDate[1];

                                    if (day < 10) {
                                        day = "0" + day;
                                    }

                                    year = retDateDate[2];

                                    seRetdate = year + "-" + month + "-" + day;


                                    addHours = 0;
                                    if (retDateArr[2] == "PM") {
                                        addHours = 12;
                                    }



                                    retDateTime = retDateArr[1].split(":");

                                    hours = (retDateTime[0] - 0) + addHours;

                                    if (hours < 10) {
                                        hours = "0" + hours;
                                    }

                                    minutes = (retDateTime[1] - 0);

                                    if (minutes < 10) {
                                        minutes = "0" + minutes;
                                    }

                                    seRettime = hours + ":" + minutes;


								} else if (/\d{4}-\d{2}-\d{2}/.test(GTMFlight.Param.ReturnDate)) {
									seRetdate = GTMFlight.Param.ReturnDate;
								} else {
									//console.log("test:" + /\d{4}-\d{2}-\d{2}/.test(GTMFlight.Param.ReturnDate));
								}
                            }

                            travelData.airTravel.returnflight = {};
                            travelData.airTravel.returnflight.date = seRetdate;

                            travelData.airTravel.returnflight.departure = {};
                            travelData.airTravel.returnflight.arrival = {};

                            travelData.airTravel.returnflight.departure.iata = GTMFlight.Param.Destination;
                            travelData.airTravel.returnflight.departure.name = GTMFlight.Param.Destination;
                            travelData.airTravel.returnflight.departure.time = seRettime;
                            //travelData.airTravel.returnflight.departure.city = "";

                            travelData.airTravel.returnflight.type = ""
							if (GTMFlight.Param.duration2) {
								travelData.airTravel.returnflight.flighttime = GTMFlight.Param.duration2;								
							} else {
								travelData.airTravel.returnflight.flighttime = "";
							}

                            travelData.airTravel.returnflight.arrival.iata = GTMFlight.Param.Origin;
                            travelData.airTravel.returnflight.arrival.name = GTMFlight.Param.Origin;
                            //travelData.airTravel.returnflight.arrival.time = "";
                            //travelData.airTravel.returnflight.arrival.city = "";

                        }

						if (GTMFlight.Param.Price) {
							travelData.airTravel.flight.price = GTMFlight.Param.Price;	
						}
						if (GTMFlight.Param.BaseFare) {
							travelData.airTravel.flight.basefare = GTMFlight.Param.BaseFare;	
						}
						if (GTMFlight.Param.Tax) {
							travelData.airTravel.flight.tax = GTMFlight.Param.Tax;	
						}
						
						/*
						travelData.airTravel.flight.discount = "0";
						travelData.airTravel.flight.isdiscounted = "0";
						if (document.getElementById("TotalDiscountAmount")) {
							if (document.getElementById("TotalDiscountAmount").childNodes) {
								if (document.getElementById("TotalDiscountAmount").childNodes.length > 1) {
									if ( document.getElementById("TotalDiscountAmount").childNodes[1]) {
										if (document.getElementById("TotalDiscountAmount").childNodes[1].innerText) {
											if (document.getElementById("TotalDiscountAmount").childNodes[1].innerText.match(/(\d+)/)[0]) {
												travelData.airTravel.flight.isdiscounted = "1";
												travelData.airTravel.flight.discount = document.getElementById("TotalDiscountAmount").childNodes[1].innerText.match(/(\d+)/)[0];
											}
										}
									}
								}
							}
						}
						travelData.airTravel.flight.pricediff = (Math.round(GTMFlight.Param.Price) - Math.round(travelData.airTravel.flight.discount) - Math.round(GTMFlight.Param.BaseFare) - Math.round(GTMFlight.Param.Tax)).toString();
						*/
                    }

                    if (typeof GTMCar == "object" && GTMCar.Param.PickupLocation != "") {
                        storeData = 1;

                        travelData.carRental = {};

                        travelData.carRental.CarType = GTMCar.Param.CarType;
                        travelData.carRental.CarType1 = GTMCar.Param.CarType1;
                        travelData.carRental.CarType2 = GTMCar.Param.CarType2;
                        travelData.carRental.CarType3 = GTMCar.Param.CarType3;
                        travelData.carRental.DropOffDate = GTMCar.Param.DropOffDate;
                        travelData.carRental.PickupDate = GTMCar.Param.PickupDate;
                        travelData.carRental.PickupLocation = GTMCar.Param.PickupLocation;
                        travelData.carRental.Price = GTMCar.Param.Price;
                        travelData.carRental.RentalCompany = GTMCar.Param.RentalCompany;



                    }


                    if (typeof GTMHotel == "object" && GTMHotel.Param && GTMHotel.Param.Location != "") {
                        storeData = 1;


                        travelData.hotel = {};


                        CheckInDate = GTMHotel.Param.CheckIn.split("/");
                        month = CheckInDate[0];
                        if (month < 10) {
                            month = "0" + month;
                        }

                        day = CheckInDate[1];

                        if (day < 10) {
                            day = "0" + day;
                        }

                        year = CheckInDate[2];

                        seCheckInDate = year + "-" + month + "-" + day;


                        CheckOutDate = GTMHotel.Param.CheckOut.split("/");
                        month = CheckOutDate[0];
                        if (month < 10) {
                            month = "0" + month;
                        }

                        day = CheckOutDate[1];

                        if (day < 10) {
                            day = "0" + day;
                        }

                        year = CheckOutDate[2];

                        seCheckOutDate = year + "-" + month + "-" + day;





                        travelData.hotel.Location = GTMHotel.Param.Location;
                        travelData.hotel.Address = GTMHotel.Param.Address;
                        travelData.hotel.CheckInDate = seCheckInDate;
                        travelData.hotel.CheckOutDate = seCheckOutDate;
                        travelData.hotel.HotelName = GTMHotel.Param.HotelName;
                        travelData.hotel.NoAdults = GTMHotel.Param.NoAdults;
                        travelData.hotel.NoChildren = GTMHotel.Param.NoChildren;
                        travelData.hotel.NoInfants = (GTMHotel.Param.NoInfantsInLap - 0) + (GTMHotel.Param.NoInfantsOnSeat - 0);
                        travelData.hotel.NoPassenger = GTMHotel.Param.NoPassenger;
                        travelData.hotel.NoRooms = GTMHotel.Param.NoRooms;
                        travelData.hotel.NumberOfNights = GTMHotel.Param.NumberOfNights;
                        travelData.hotel.SelectedHotelRating = GTMHotel.Param.SelectedHotelRating;
                        travelData.hotel.AverageNightlyRateHotel = GTMHotel.Param.AverageNightlyRateHotel;
                        travelData.hotel.OriginalNightlyRateHotel = GTMHotel.Param.OriginalNightlyRateHotel;







                    }

                    if (typeof GTMPackage == "object" && GTMPackage.Param.Destination != "") {

                        storeData = 1;




                        DepartureDate = GTMPackage.Param.DepartureDate.split("/");
                        month = DepartureDate[0];
                        if (month < 10) {
                            month = "0" + month;
                        }

                        day = DepartureDate[1];

                        if (day < 10) {
                            day = "0" + day;
                        }

                        year = DepartureDate[2];

                        seDepartureDate = year + "-" + month + "-" + day;


                        ReturnDate = GTMPackage.Param.ReturnDate.split("/");
                        month = ReturnDate[0];
                        if (month < 10) {
                            month = "0" + month;
                        }

                        day = ReturnDate[1];

                        if (day < 10) {
                            day = "0" + day;
                        }

                        year = ReturnDate[2];

                        seReturnDate = year + "-" + month + "-" + day;







                        travelData.package = {};
                        travelData.package.Airline = GTMPackage.Param.Airline;
                        travelData.package.CarTransmisson = GTMPackage.Param.CarTransmisson;
                        travelData.package.CarType = GTMPackage.Param.CarType;
                        travelData.package.DepartureDate = seDepartureDate;
                        travelData.package.Destination = GTMPackage.Param.Destination;
                        travelData.package.FlightClass = GTMPackage.Param.FlightClass;
                        travelData.package.HotelName = GTMPackage.Param.HotelName;
                        travelData.package.HotelRating = GTMPackage.Param.HotelRating;
                        travelData.package.NoAdults = GTMPackage.Param.NoAdults;
                        travelData.package.NoChildren = GTMPackage.Param.NoChildren;
                        travelData.package.NoInfants = (GTMPackage.Param.NoInfantsInLap - 0) + (GTMPackage.Param.NoInfantsOnSeat - 0);
                        travelData.package.NoRooms = GTMPackage.Param.NoRooms;
                        travelData.package.Origin = GTMPackage.Param.Origin;
                        travelData.package.Price = GTMPackage.Param.Price;
                        travelData.package.RentalCompany = GTMPackage.Param.RentalCompany;
                        travelData.package.ReturnDate = seReturnDate;
                        travelData.package.RentalCompany = GTMPackage.Param.RentalCompany;
                        travelData.package.TypeOfPackage = GTMPackage.Param.TypeOfPackage;











                    }

                }
                catch (e) {
                    travelData.error = e;
                    storeData = 1;
                }

                if (storeData == 1) {
                    travelDataJSON = JSON.stringify(travelData);
                    IMP.appendSiteProp("pageproperty", travelDataJSON);
                }

        },

		addattachments: function () {
			try {
				var ni_attachment = {};
				ni_attachment.attachments = new Array;
				var ni_attachment_index = 0;
				var ni_attachment_source_index = 6;
				var ni_attachment_source_index_offset = 6;
				var ni_seat_add = false;
				var ni_insurance_set = 0;
				var source_attachment = new Array();
				var source_attachment_split;

				if (document.getElementsByClassName('price-details--mod').length > 0) {
					if (document.getElementsByClassName('price-details--mod')[0].innerText) {
						source_attachment = document.getElementsByClassName('price-details--mod')[0].innerText.split('\n');
					}
				}
				ni_attachment_index = 0;
				ni_attachment_source_index = ni_attachment_index + ni_attachment_source_index_offset;
				if (source_attachment.length > ni_attachment_source_index) {
					source_attachment_split = source_attachment[ni_attachment_source_index].split('\t');
					if (source_attachment_split.length > 3) {
						ni_attachment.attachments[ni_attachment_index] = {};
						ni_attachment.attachments[ni_attachment_index].name = source_attachment_split[0];
						ni_attachment.attachments[ni_attachment_index].value = source_attachment_split[3];
						if (ni_attachment.attachments[ni_attachment_index].name.toLowerCase().indexOf('protect') > -1) {
							if (source_attachment_split[1].toLowerCase().indexOf('add') < 0) {
								ni_insurance_set = 2;
							} else {
								ni_insurance_set = 1;
							}
						}
						if ((ni_attachment.attachments[ni_attachment_index].name.toLowerCase().indexOf('seats') > -1)
							&& (ni_attachment.attachments[ni_attachment_index].name.toLowerCase().indexOf('fee') < 0)) {
							ni_seat_add = true;
						}
					}
				}
				ni_attachment_index = 1;
				ni_attachment_source_index = ni_attachment_index + ni_attachment_source_index_offset;
				if (source_attachment.length > ni_attachment_source_index) {
					source_attachment_split = source_attachment[ni_attachment_source_index].split('\t');
					if (source_attachment_split.length > 3) {
						ni_attachment.attachments[ni_attachment_index] = {};
						ni_attachment.attachments[ni_attachment_index].name = source_attachment_split[0];
						ni_attachment.attachments[ni_attachment_index].value = source_attachment_split[3];
						if (ni_attachment.attachments[ni_attachment_index].name.toLowerCase().indexOf('protect') > -1) {
							if (source_attachment_split[1].toLowerCase().indexOf('add') < 0) {
								ni_insurance_set = 2;
							} else {
								ni_insurance_set = 1;
							}
						}
						if ((ni_attachment.attachments[ni_attachment_index].name.toLowerCase().indexOf('seats') > -1)
							&& (ni_attachment.attachments[ni_attachment_index].name.toLowerCase().indexOf('fee') < 0)) {
							ni_seat_add = true;
						}
					}
				}
				ni_attachment_index = 2;
				ni_attachment_source_index = ni_attachment_index + ni_attachment_source_index_offset;
				if (source_attachment.length > ni_attachment_source_index) {
					source_attachment_split = source_attachment[ni_attachment_source_index].split('\t');
					if (source_attachment_split.length > 3) {
						ni_attachment.attachments[ni_attachment_index] = {};
						ni_attachment.attachments[ni_attachment_index].name = source_attachment_split[0];
						ni_attachment.attachments[ni_attachment_index].value = source_attachment_split[3];
						if (ni_attachment.attachments[ni_attachment_index].name.toLowerCase().indexOf('protect') > -1) {
							if (source_attachment_split[1].toLowerCase().indexOf('add') < 0) {
								ni_insurance_set = 2;
							} else {
								ni_insurance_set = 1;
							}
						}
						if ((ni_attachment.attachments[ni_attachment_index].name.toLowerCase().indexOf('seats') > -1)
							&& (ni_attachment.attachments[ni_attachment_index].name.toLowerCase().indexOf('fee') < 0)) {
							ni_seat_add = true;
						}
					}
				}
				ni_attachment_index = 3;
				ni_attachment_source_index = ni_attachment_index + ni_attachment_source_index_offset;
				if (source_attachment.length > ni_attachment_source_index) {
					source_attachment_split = source_attachment[ni_attachment_source_index].split('\t');
					if (source_attachment_split.length > 3) {
						ni_attachment.attachments[ni_attachment_index] = {};
						ni_attachment.attachments[ni_attachment_index].name = source_attachment_split[0];
						ni_attachment.attachments[ni_attachment_index].value = source_attachment_split[3];
						if (ni_attachment.attachments[ni_attachment_index].name.toLowerCase().indexOf('protect') > -1) {
							if (source_attachment_split[1].toLowerCase().indexOf('add') < 0) {
								ni_insurance_set = 2;
							} else {
								ni_insurance_set = 1;
							}
						}
						if ((ni_attachment.attachments[ni_attachment_index].name.toLowerCase().indexOf('seats') > -1)
							&& (ni_attachment.attachments[ni_attachment_index].name.toLowerCase().indexOf('fee') < 0)) {
							ni_seat_add = true;
						}
					}
				}
				ni_attachment_index = 4;
				ni_attachment_source_index = ni_attachment_index + ni_attachment_source_index_offset;
				if (source_attachment.length > ni_attachment_source_index) {
					source_attachment_split = source_attachment[ni_attachment_source_index].split('\t');
					if (source_attachment_split.length > 3) {
						ni_attachment.attachments[ni_attachment_index] = {};
						ni_attachment.attachments[ni_attachment_index].name = source_attachment_split[0];
						ni_attachment.attachments[ni_attachment_index].value = source_attachment_split[3];
						if (ni_attachment.attachments[ni_attachment_index].name.toLowerCase().indexOf('protect') > -1) {
							if (source_attachment_split[1].toLowerCase().indexOf('add') < 0) {
								ni_insurance_set = 2;
							} else {
								ni_insurance_set = 1;
							}
						}
						if ((ni_attachment.attachments[ni_attachment_index].name.toLowerCase().indexOf('seats') > -1)
							&& (ni_attachment.attachments[ni_attachment_index].name.toLowerCase().indexOf('fee') < 0)) {
							ni_seat_add = true;
						}
					}
				}
				ni_attachment_index = 5;
				ni_attachment_source_index = ni_attachment_index + ni_attachment_source_index_offset;
				if (source_attachment.length > ni_attachment_source_index) {
					source_attachment_split = source_attachment[ni_attachment_source_index].split('\t');
					if (source_attachment_split.length > 3) {
						ni_attachment.attachments[ni_attachment_index] = {};
						ni_attachment.attachments[ni_attachment_index].name = source_attachment_split[0];
						ni_attachment.attachments[ni_attachment_index].value = source_attachment_split[3];
						if (ni_attachment.attachments[ni_attachment_index].name.toLowerCase().indexOf('protect') > -1) {
							if (source_attachment_split[1].toLowerCase().indexOf('add') < 0) {
								ni_insurance_set = 2;
							} else {
								ni_insurance_set = 1;
							}
						}
						if ((ni_attachment.attachments[ni_attachment_index].name.toLowerCase().indexOf('seats') > -1)
							&& (ni_attachment.attachments[ni_attachment_index].name.toLowerCase().indexOf('fee') < 0)) {
							ni_seat_add = true;
						}
					}
				}
				ni_attachment_index = 6;
				ni_attachment_source_index = ni_attachment_index + ni_attachment_source_index_offset;
				if (source_attachment.length > ni_attachment_source_index) {
					source_attachment_split = source_attachment[ni_attachment_source_index].split('\t');
					if (source_attachment_split.length > 3) {
						ni_attachment.attachments[ni_attachment_index] = {};
						ni_attachment.attachments[ni_attachment_index].name = source_attachment_split[0];
						ni_attachment.attachments[ni_attachment_index].value = source_attachment_split[3];
						if (ni_attachment.attachments[ni_attachment_index].name.toLowerCase().indexOf('protect') > -1) {
							if (source_attachment_split[1].toLowerCase().indexOf('add') < 0) {
								ni_insurance_set = 2;
							} else {
								ni_insurance_set = 1;
							}
						}
						if ((ni_attachment.attachments[ni_attachment_index].name.toLowerCase().indexOf('seats') > -1)
							&& (ni_attachment.attachments[ni_attachment_index].name.toLowerCase().indexOf('fee') < 0)) {
							ni_seat_add = true;
						}
					}
				}
				ni_attachment_index = 7;
				ni_attachment_source_index = ni_attachment_index + ni_attachment_source_index_offset;
				if (source_attachment.length > ni_attachment_source_index) {
					source_attachment_split = source_attachment[ni_attachment_source_index].split('\t');
					if (source_attachment_split.length > 3) {
						ni_attachment.attachments[ni_attachment_index] = {};
						ni_attachment.attachments[ni_attachment_index].name = source_attachment_split[0];
						ni_attachment.attachments[ni_attachment_index].value = source_attachment_split[3];
						if (ni_attachment.attachments[ni_attachment_index].name.toLowerCase().indexOf('protect') > -1) {
							if (source_attachment_split[1].toLowerCase().indexOf('add') < 0) {
								ni_insurance_set = 2;
							} else {
								ni_insurance_set = 1;
							}
						}
						if ((ni_attachment.attachments[ni_attachment_index].name.toLowerCase().indexOf('seats') > -1)
							&& (ni_attachment.attachments[ni_attachment_index].name.toLowerCase().indexOf('fee') < 0)) {
							ni_seat_add = true;
						}
					}
				}

				if (document.getElementsByClassName('payment-header-flex').length > 0) {
					if (document.getElementsByClassName('payment-header-flex')[0].innerText) {
						if (document.getElementsByClassName('payment-header-flex')[0].innerText.indexOf("Seat") > -1) {
							if (ni_seat_add == true) {
								IMP.appendSiteProp("ni_SelectSeats", 2);
								IMP.appendSiteProp("ni_SelectSeats_final", 2);
							} else {
								IMP.appendSiteProp("ni_SelectSeats", 1);
								IMP.appendSiteProp("ni_SelectSeats_final", 1);
							}
						}
					}
				}
				if (ni_insurance_set > 0) {
					IMP.appendSiteProp('ni_IsInsuranceAdded', ni_insurance_set);
					IMP.appendSiteProp('ni_IsInsuranceAdded_final', ni_insurance_set);
				}

				if (document.getElementsByClassName('icurrency').length > 0) {
					if (document.getElementsByClassName('icurrency')[0].innerText) {
						ni_currency = document.getElementsByClassName('icurrency')[0].innerText;
						IMP.appendSiteProp("ni_currency", ni_currency);
					}
				}

				if (ni_attachment.attachments.length > 0) {
					IMP.appendSiteProp('pagedetail', JSON.stringify(ni_attachment));
					IMP.trackAppendLog();
				}
			} catch (attex) {
				//console.log(attex);
			}
		},
		
        appendLocalSitePropPostLog: function () {

        },

        appendLocalSitePropPostReply: function (logactive, eventlogactive, detaillogactive) {

							
			if (logactive) {
				
				// additional logging
				if (document.location.href.toLowerCase().indexOf("m.cheapoair.com/air/review") > -1) {
					setTimeout(function() {
						try {
							ni_IsInsuranceAdded = 0;
							if (document.getElementsByClassName('travel-protection__sec').length > 0) {
								ni_IsInsuranceAdded = 1;
							}
							IMP.appendSiteProp("ni_IsInsuranceAdded",ni_IsInsuranceAdded);

							ni_supportPkgMVP = 0;
							if (document.getElementsByClassName('support--Services').length > 0) {
								ni_supportPkgMVP = 1;
							}
							IMP.appendSiteProp("ni_supportPkgMVP",ni_supportPkgMVP);
							
							var ni_revPlusTrigger = 0;
							if (document.getElementsByClassName('rev-plus').length > 0) {
								ni_revPlusTrigger = 1;
							}
							IMP.appendSiteProp("ni_revPlusTrigger",ni_revPlusTrigger);
							
							var ni_upgradeBtn = 0;
							if (document.getElementsByClassName('panel--upsell').length > 0) {
								ni_upgradeBtn = 1;
							}
							IMP.appendSiteProp("ni_upgradeBtn",ni_upgradeBtn);

							var ni_travelAssTrigger = 0;
							if (document.getElementsByClassName('is--travelClassicImage').length > 0) {
								ni_travelAssTrigger = 1;
							}
							IMP.appendSiteProp("ni_travelAssTrigger",ni_travelAssTrigger);

							var ni_flexibleTicket = 0;
							if (document.getElementsByClassName('flexibleBottom__space').length > 0) {
								ni_flexibleTicket = 1;
							}
							IMP.appendSiteProp("ni_flexibleTicket",ni_flexibleTicket);
															
							ni_SelectSeats = 0;
							if (document.getElementsByClassName('payment-header-flex').length > 0) {
								if (document.getElementsByClassName('payment-header-flex')[0].innerText) {
									if (document.getElementsByClassName('payment-header-flex')[0].innerText.indexOf("Seat") > -1) {
										ni_SelectSeats = 1;
									}
								}
							}
							IMP.appendSiteProp("ni_SelectSeats",ni_SelectSeats);

							if (document.getElementsByClassName('icurrency').length > 0) {
								if (document.getElementsByClassName('icurrency')[0].innerText) {
									ni_currency = document.getElementsByClassName('icurrency')[0].innerText;
									IMP.appendSiteProp("ni_currency",ni_currency);
								}
							}
							IMP.trackAppendLog();
						} catch (attex) {
							//console.log(attex);
						}
					}, 5000);	
				}

				if (document.location.href.toLowerCase().indexOf("m.cheapoair.com/air/book") > -1) {
					setTimeout(function() {
						IMP_HL.addattachments();
					}, 1000);
				}
				
				// events
				/*
				if (!nowReplyListnersPaymentMobile) {
					if (document.location.href.toLowerCase().indexOf("m.cheapoair.com/air/book") > -1) {
						nowReplyListnersPaymentMobile = true;
						setTimeout(function() {
							try {	
								document.addEventListener('click', function (e) {
									try {
										if (document.location.href.toLowerCase().indexOf("m.cheapoair.com/air/book") > -1) {
											if (e.target.tagName == 'SPAN') 
											{
												if (e.target.innerText) {
													ni_payevent = ni_payevent + "|" + e.target.innerText.substring(0,10);
												} else {
													ni_payevent = ni_payevent + "|" + e.target.tagName;
												}
												if (ni_payevent.length > 149) {
													ni_payevent = ni_payevent.substring(0,147) + "..";
												}
												setTimeout(function() {	
													IMP.appendSiteProp('ni_payevent',ni_payevent);
													IMP_HL.addattachments();
												}, 1000);
											}
										}
									} catch (ni_addatt) {
										//console.log(ni_e);
									}
								});
							} catch (ni_addatt) {
								//console.log(ni_e);
							}
						}, 1000);
					}
				}
				*/
			}

			if (eventlogactive) {
				if (!nowSimpleInPageListnerPost) {

                    try {

                    var oldTargetS=null;
                    var hasTouchStartEvent = 'ontouchstart' in document.createElement( 'div' );
                document.body.addEventListener(hasTouchStartEvent ? 'touchstart' : 'mousedown',function(d){targetElem=d.target;if(targetElem.matches("div,span,a,section,img,h1,h2,h3,h4,h5,h6,li,article,p,table,tr,td,svg,iframe,input,textarea,select")&&targetElem!=oldTargetS){var b=targetElem.getAttribute("id"),a=targetElem.getAttribute("class"),c=targetElem;if("undefined"==typeof b||null==b)if(b=a,"undefined"==typeof a||null==a)for(i=0;10>i;i++)if(c=c.parentElement,a=c.getAttribute("class"),"undefined"!=typeof a&&null!=a){b=a;break}""!=b&&IMP.appendSiteEvent(b);
                oldTargetS=d.target}});
                    } catch (e) {

                    }

                  nowSimpleInPageListnerPost = true;
				}
			}

			if (detaillogactive) {

				// additional logging
				if (document.location.href.toLowerCase().indexOf("www.cheapoair.com/air/payment") > -1) {
					
					setTimeout(function() {
						try {
							ni_IsInsuranceAdded = 0;
							if (document.getElementsByClassName('travel-protection_checkboxes').length > 0) {
								ni_IsInsuranceAdded = 1;
							}
							IMP.appendSiteProp("ni_IsInsuranceAdded",ni_IsInsuranceAdded);
							
							ni_supportPkgMVP = 0;
							if (document.getElementsByClassName('support-package').length > 0) {
								ni_supportPkgMVP = 1;
							}
							IMP.appendSiteProp("ni_supportPkgMVP",ni_supportPkgMVP);
							
							var ni_revPlusTrigger = 0;
							if (document.getElementsByClassName('rev-plus').length > 0) {
								ni_revPlusTrigger = 1;
							}
							IMP.appendSiteProp("ni_revPlusTrigger",ni_revPlusTrigger);
							
							var ni_upgradeBtn = 0;
							if (document.getElementsByClassName('panel--upsell').length > 0) {
								ni_upgradeBtn = 1;
							}
							IMP.appendSiteProp("ni_upgradeBtn",ni_upgradeBtn);

							var ni_travelAssTrigger = 0;
							if (document.getElementsByClassName('travel-assist').length > 0) {
								ni_travelAssTrigger = 1;
							}
							IMP.appendSiteProp("ni_travelAssTrigger",ni_travelAssTrigger);

							var ni_flexibleTicket = 0;
							if (document.getElementsByClassName('flexible-ticket').length > 0) {
								ni_flexibleTicket = 1;
							}
							IMP.appendSiteProp("ni_flexibleTicket",ni_flexibleTicket);
															
							ni_SelectSeats = 0;
							if (document.getElementsByClassName('panel-seatmap').length > 0) {
								ni_SelectSeats = 1;
							}
							IMP.appendSiteProp("ni_SelectSeats",ni_SelectSeats);

							if (document.getElementsByClassName('currency-wrap').length > 0) {
								if (document.getElementsByClassName('currency-wrap')[0].innerText) {
									ni_currency = document.getElementsByClassName('currency-wrap')[0].innerText;
									IMP.appendSiteProp("ni_currency",ni_currency);
								}
							}
							IMP.trackAppendLog();
						} catch (attex) {
							//console.log(attex);
						}
					}, 2000);
				}
				
				if (document.location.href.toLowerCase().indexOf("www.cheapoair.com/air/listing") > -1)
				{
					setTimeout(function() {
						try {
							var anyprc = false;
							if (document.getElementsByClassName("is--tab-recommended").length > 0) {
								if (document.getElementsByClassName("is--tab-recommended")[0].innerText) {
									IMP.appendSiteProp("pr_rec",document.getElementsByClassName("is--tab-recommended")[0].innerText.split(".")[0]);
									anyprc=true;																		
								};
							}
							if (document.getElementsByClassName("is--tab-cheapest").length > 0) {
								if (document.getElementsByClassName("is--tab-cheapest")[0].innerText) {
									IMP.appendSiteProp("pr_che",document.getElementsByClassName("is--tab-cheapest")[0].innerText.split(".")[0]);
									anyprc=true;																		
								};
							}
							if (document.getElementsByClassName("is--tab-shortest").length > 0) {
								if (document.getElementsByClassName("is--tab-shortest")[0].innerText) {
									IMP.appendSiteProp("pr_sho",document.getElementsByClassName("is--tab-shortest")[0].innerText.split(".")[0]);
									anyprc=true;																		
								};
							}							
							if (document.getElementsByClassName("is--tab-alternatedates").length > 0) {
								if (document.getElementsByClassName("is--tab-alternatedates")[0].innerText) {
									IMP.appendSiteProp("pr_alt",document.getElementsByClassName("is--tab-alternatedates")[0].innerText.split(".")[0]);
									anyprc=true;																		
								};
							}
							if (document.getElementsByClassName("is--tab-nearby").length > 0) {
								if (document.getElementsByClassName("is--tab-nearby")[0].innerText) {
									IMP.appendSiteProp("pr_rec",document.getElementsByClassName("is--tab-nearby")[0].innerText.split(".")[0]);
									anyprc=true;																		
								};
							}
							if (document.getElementsByClassName('currency-wrap').length > 0) {
								if (document.getElementsByClassName('currency-wrap')[0].innerText) {
									if (document.getElementsByClassName('currency-wrap')[0].innerText.split(" ").length>1) {
										IMP.appendSiteProp("pr_cur",document.getElementsByClassName('currency-wrap')[0].innerText.split(" ")[0]);																		
									} else {
										IMP.appendSiteProp("pr_cur",document.getElementsByClassName('currency-wrap')[0].innerText);
									}
								}
							}
							if (typeof GTMFlight == "object" && GTMFlight.Param) {
								if (GTMFlight.Param.listingCheapeastFare) {
									IMP.appendSiteProp("ni_listingcheapeastfare",GTMFlight.Param.listingCheapeastFare);
									anyprc=true;																											
								}
								/*
								if (GTMFlight.Param.DisplayCurrency) {
									IMP.appendSiteProp("ni_listingcurrency",GTMFlight.Param.DisplayCurrency);
								}
								*/
							}
							if (anyprc) {
								IMP.trackAppendLog();
							}
						} catch (ni_e) {
							//console.log(ni_e);
						}
					}, 10000);				
				}
				
				// events 1
				if (!nowReplyListnersListing) {
					nowReplyListnersListing = true;
					
				}

				// events 2
				if (!nowReplyListnersPayment) {
					if (document.location.href.toLowerCase().indexOf("www.cheapoair.com/air/payment") > -1) {
						nowReplyListnersPayment = true;

						setTimeout(function() {

							try {	
								document.addEventListener('click', function (e) {
									try {

										if (document.location.href.toLowerCase().indexOf("www.cheapoair.com/air/payment") > -1) {

											if ( ( (e.target.tagName == 'LABEL') || 
													( (e.target.tagName == 'DIV') && (e.target.className) && (e.target.className.indexOf('seat') > -1) ) || 
													( (e.target.tagName == 'DIV') && (e.target.className) && (e.target.className.indexOf('support-package') > -1) ) || 
													( (e.target.tagName == 'DIV') && (e.target.parentNode) && (e.target.parentNode.className) && (e.target.parentNode.className.indexOf('support-package') > -1) ) || 
													( (e.target.tagName == 'DIV') && (e.target.parentNode) && (e.target.parentNode.parentNode) && (e.target.parentNode.parentNode.className) && (e.target.parentNode.parentNode.className.indexOf('support-package') > -1) ) || 
													( (e.target.tagName == 'DIV') && (e.target.parentNode) && (e.target.parentNode.parentNode) && (e.target.parentNode.parentNode.parentNode) && (e.target.parentNode.parentNode.parentNode.className) && (e.target.parentNode.parentNode.parentNode.className.indexOf('support-package') > -1) ) || 
													(e.target.tagName == 'A') || 
													(e.target.tagName == 'B') || 
													(e.target.type == 'submit') || 
													(e.target.type == 'button') 
													)
													&& !((e.target.className) && (e.target.className.indexOf('btn-cta-booking') > -1))
											) {
												if (e.target.innerText) {
													ni_payevent = ni_payevent + "|" + e.target.innerText.substring(0,10);
												} else {
													ni_payevent = ni_payevent + "|" + e.target.tagName;
												}
												if (ni_payevent.length > 149) {
													ni_payevent = ni_payevent.substring(0,147) + "..";
												}
												setTimeout(function() {
													try {	
														var ni_attachment = {};
														ni_attachment.attachments = new Array;
														var ni_attachment_index = 0;
														var ni_seat_add = false;
														var ni_seat_val = "0";
														var source_attachment = document.getElementsByClassName('is--additional-service');
														if (source_attachment.length>0) {
															ni_attachment_index = 0;
															if (source_attachment[ni_attachment_index].innerText) {
																if (source_attachment[ni_attachment_index].innerText.split('\n').length>1) {
																	ni_attachment.attachments[ni_attachment_index] = {};
																	ni_attachment.attachments[ni_attachment_index].name = source_attachment[ni_attachment_index].innerText.split('\n')[0];
																	ni_attachment.attachments[ni_attachment_index].value = source_attachment[ni_attachment_index].innerText.split('\n')[1];
																	if (ni_attachment.attachments[ni_attachment_index].name.toLowerCase().indexOf('protect') > -1) {
																		if (ni_attachment.attachments[ni_attachment_index].value.toLowerCase().indexOf('declined') < 0)  {
																			IMP.appendSiteProp('ni_IsInsuranceAdded',2);
																			IMP.appendSiteProp('ni_IsInsuranceAdded_final',2);
																		} else {
																			IMP.appendSiteProp('ni_IsInsuranceAdded',1);
																			IMP.appendSiteProp('ni_IsInsuranceAdded_final',1);
																		}
																	}
																}	
															}
														}
														if (source_attachment.length>1) {
															ni_attachment_index = 1;
															if (source_attachment[ni_attachment_index].innerText) {
																if (source_attachment[ni_attachment_index].innerText.split('\n').length>1) {
																	ni_attachment.attachments[ni_attachment_index] = {};
																	ni_attachment.attachments[ni_attachment_index].name = source_attachment[ni_attachment_index].innerText.split('\n')[0];
																	ni_attachment.attachments[ni_attachment_index].value = source_attachment[ni_attachment_index].innerText.split('\n')[1];
																	if ( (ni_attachment.attachments[ni_attachment_index].name.toLowerCase().indexOf('seats') > -1)
																		&& (ni_attachment.attachments[ni_attachment_index].name.toLowerCase().indexOf('fee') < 0) ) {
																			ni_seat_add = true;
																			ni_seat_val = ni_attachment.attachments[ni_attachment_index].value;
																	}
																}	
															}
														}
														if (source_attachment.length>2) {
															ni_attachment_index = 2;
															if (source_attachment[ni_attachment_index].innerText) {
																if (source_attachment[ni_attachment_index].innerText.split('\n').length>1) {
																	ni_attachment.attachments[ni_attachment_index] = {};
																	ni_attachment.attachments[ni_attachment_index].name = source_attachment[ni_attachment_index].innerText.split('\n')[0];
																	ni_attachment.attachments[ni_attachment_index].value = source_attachment[ni_attachment_index].innerText.split('\n')[1];
																	if ( (ni_attachment.attachments[ni_attachment_index].name.toLowerCase().indexOf('seats') > -1)
																		&& (ni_attachment.attachments[ni_attachment_index].name.toLowerCase().indexOf('fee') < 0) ) {
																			ni_seat_add = true;
																			ni_seat_val = ni_attachment.attachments[ni_attachment_index].value;
																	}
																}
															}
														}
														if (source_attachment.length>3) {
															ni_attachment_index = 3;
															if (source_attachment[ni_attachment_index].innerText) {
																if (source_attachment[ni_attachment_index].innerText.split('\n').length>1) {
																	ni_attachment.attachments[ni_attachment_index] = {};												
																	ni_attachment.attachments[ni_attachment_index].name = source_attachment[ni_attachment_index].innerText.split('\n')[0];
																	ni_attachment.attachments[ni_attachment_index].value = source_attachment[ni_attachment_index].innerText.split('\n')[1];
																	if ( (ni_attachment.attachments[ni_attachment_index].name.toLowerCase().indexOf('seats') > -1)
																		&& (ni_attachment.attachments[ni_attachment_index].name.toLowerCase().indexOf('fee') < 0) ) {
																			ni_seat_add = true;
																			ni_seat_val = ni_attachment.attachments[ni_attachment_index].value;
																	}
																}	
															}
														}
														if (source_attachment.length>4) {
															ni_attachment_index = 4;
															if (source_attachment[ni_attachment_index].innerText) {
																if (source_attachment[ni_attachment_index].innerText.split('\n').length>1) {
																	ni_attachment.attachments[ni_attachment_index] = {};
																	ni_attachment.attachments[ni_attachment_index].name = source_attachment[ni_attachment_index].innerText.split('\n')[0];
																	ni_attachment.attachments[ni_attachment_index].value = source_attachment[ni_attachment_index].innerText.split('\n')[1];		
																	if ( (ni_attachment.attachments[ni_attachment_index].name.toLowerCase().indexOf('seats') > -1)
																		&& (ni_attachment.attachments[ni_attachment_index].name.toLowerCase().indexOf('fee') < 0) ) {
																			ni_seat_add = true;
																			ni_seat_val = ni_attachment.attachments[ni_attachment_index].value;
																	}												
																}	
															}
														}
														if (source_attachment.length>5) {
															ni_attachment_index = 5;
															if (source_attachment[ni_attachment_index].innerText) {
																if (source_attachment[ni_attachment_index].innerText.split('\n').length>1) {
																	ni_attachment.attachments[ni_attachment_index] = {};
																	ni_attachment.attachments[ni_attachment_index].name = source_attachment[ni_attachment_index].innerText.split('\n')[0];
																	ni_attachment.attachments[ni_attachment_index].value = source_attachment[ni_attachment_index].innerText.split('\n')[1];
																	if ( (ni_attachment.attachments[ni_attachment_index].name.toLowerCase().indexOf('seats') > -1)
																		&& (ni_attachment.attachments[ni_attachment_index].name.toLowerCase().indexOf('fee') < 0) ) {
																			ni_seat_add = true;
																			ni_seat_val = ni_attachment.attachments[ni_attachment_index].value;
																	}
																}
															}
														}
														if (document.getElementsByClassName('panel-seatmap').length > 0) {
															if (ni_seat_add == true) {
																IMP.appendSiteProp("ni_SelectSeats",2);
																IMP.appendSiteProp("ni_SelectSeats_final",2);
																IMP.appendSiteProp("ni_SelectSeats_total",ni_seat_val);															
															} else {
																IMP.appendSiteProp("ni_SelectSeats",1);
																IMP.appendSiteProp("ni_SelectSeats_final",1);
																IMP.appendSiteProp("ni_SelectSeats_total","0");
															}
														}

														IMP.appendSiteProp('ni_payevent',ni_payevent);
														if (ni_attachment.attachments.length>0) {
															IMP.appendSiteProp('pagedetail',JSON.stringify(ni_attachment));
															IMP.trackAppendLog();
														}
													} catch (attex) {
														//console.log(attex);
													}
												}, 1000);
											} else {
												//console.log("unselected");
											}
										}
									} catch (attex) {
										//console.log(attex);
									}
								});

							} catch (ni_addatt) {
								//console.log(ni_e);
							}
						}, 2200);
					}
				}
			}
			
        }

    };
})();

(function(){function p(){try{return window.self!==window.top}catch(a){return!0}}function Sa(){try{return document.hasFocus()}catch(a){return!0}}var z,U,O=[],ca=[],P=0,ta=0,ua=!1,da=!1,j=[,"ni_imp_prim","ni_imp_secd","ni_imp_spec"],Q=j[1],s=[];s[j[1]]=0;s[j[2]]=0;s[j[3]]=0;var ea=[,0,0,0],V=[];V[j[1]]="";V[j[2]]="";V[j[3]]="";var W=[];W[j[1]]="";W[j[2]]="";W[j[3]]="";var Ta=[,0,0,0],g=[,[],[],[]];g[1][1]=[];g[1][2]=[];g[1][3]=[];g[1][4]=[];g[2][1]=[];g[2][2]=[];g[2][3]=[];g[2][4]=[];g[3][1]=[];g[3][2]=
[];g[3][3]=[];g[3][4]=[];var fa=!1,ga=0,va=0,Ua="notset",R=0,Va=!1,X=!1,wa=!1,ha=!1,xa=!1,ia=0,ja=0,Wa=0,ya=0,E=0,ka=0,la=0,J=!1,za=!1,ma="scroll_0",Aa,na=!1,Xa=!1,Ya=!1;Math.round((new Date).getTime()/1E3);var t="",K="",Y="",Ba=!1,Za=0,$a=!1,Ca=!1,oa=!1,Da=0,ab=(new Date).getTime(),Cb=(new Date).getTime();(new Date).getTime();var bb=[],L;imprushdialogueany=!1;imprushdialogueparams=[,"","",""];var Ea=[,"",""],cb=!1,Z=!1,Fa=!1,M,B=document,db=window,l=db.encodeURIComponent||escape,Db=db.decodeURIComponent||
unescape,i=B.location.href,w=B.referrer,N="",$=function(){try{var a=new Date,b=(new Date(a.getTime()-6E4*a.getTimezoneOffset())).toISOString().slice(0,-1);IMP.appendSiteProp("imploctime",b);var c=a.getTimezoneOffset();IMP.appendSiteProp("implocoffset",c);var d=Intl.DateTimeFormat().resolvedOptions().timeZone;IMP.appendSiteProp("imploczone",d)}catch(e){}},eb=function(a){a=a.split(".");return 4===a.length?a.every(function(a){return 0<=parseInt(a,10)&&255>=parseInt(a,10)}):!1},pa="",pa=function(){var a=
document.location.hostname,b=a.toString().substr(a.toString().length-3),c=a.lastIndexOf("."),d=eb(a);-1<c&&!d&&(c=a.lastIndexOf(".",c-1),-1<c&&(".uk"==b||".in"==b||".id"==b||".il"==b||".za"==b||".cr"==b||".nz"==b||".jp"==b||".kr"==b||".pe"==b||".br"==b||".ck"==b?(b=a.lastIndexOf(".",c-1),-1<b&&(a=a.substr(b+1))):a=a.substr(c+1)));return a}(),fb=function(a){var b={},c=a.indexOf("?");if(-1==c)return b;a=a.substring(c+1).split("&");for(c=0;c<a.length;c++){var d=a[c].split("=");b[d[0]]=d[1]}return b},
n=function(a,b,c){var d=q("ni_imp_collection"),d=d?JSON.parse(d):{},e=q("ni_imp_collection_lc"),e=e?JSON.parse(e):{};d[a]=b;c&&(e[a+"_expire"]=Date.now()+864E5*c);A("ni_imp_collection",JSON.stringify(d));A("ni_imp_collection_lc",JSON.stringify(e))},gb=function(a,b,c,d,e){var h;c&&(h=new Date,h.setTime(h.getTime()+864E5*c));pa&&(e=pa);B.cookie=a+"="+b+(c?";expires="+h.toGMTString():"")+";path="+(d?d:"/")+(e?";domain="+e:"")+("https:"==document.location.protocol?";SameSite=None":"")+("https:"==document.location.protocol?
";secure":"")},m=function(a){var b=q("ni_imp_collection"),c;b&&(c=JSON.parse(b));var b=q("ni_imp_collection_lc"),d;b&&(d=JSON.parse(b));if(c){c=c[a];var e;d&&(e=d[a+"_expire"]);return c?e?e>Date.now()?c:0:c:0}return 0},hb=function(a){return(a=RegExp("(^|;)[ ]*"+a+"=([^;]*)").exec(B.cookie))?Db(a[2]):0},ib=function(){var a="",a=new Date,b=a.getDate().toString(),c;c=a.getMonth()+1;c=10>c?"0"+c.toString():c.toString();for(var d=a.getFullYear().toString(),e=navigator.userAgent.toString().replace(/[\/();:. ]/g,
"").toUpperCase(),h=e.length,f=Math.floor(h/22),a="",g=0,k=0;k<h;k+=f)22>g&&(a+=e.charAt(k)),g++;primitiveStartChar="A";15>f&&0<f&&(primitiveStartChar="0123456789ABCDEF".toString().charAt(f));return primitiveStartChar+a+"_"+d+c+b},Eb=function(){var a=m("imp_gp");a||(a=q("imp_gp"))||(a=aa().toString().substring(0,1));n("imp_gp",a,365);A("imp_gp",a);return a},y=function(){if(fa)return ib();var a=m("imp_uk");a||(a=q("imp_uk"));var b;a:{try{if("object"===typeof IMP_HL&&"function"===typeof IMP_HL.exist_local_userkey&&
IMP_HL.exist_local_userkey()&&"function"===typeof IMP_HL.get_local_userkey){b=!0;break a}}catch(c){}b=!1}if(b){var d;a:{b=a;try{if("object"===typeof IMP_HL&&"function"===typeof IMP_HL.exist_local_userkey&&IMP_HL.exist_local_userkey()&&"function"===typeof IMP_HL.get_local_userkey){d=IMP_HL.get_local_userkey(b);break a}}catch(e){}d=!1}d&&(a=d)}a||(a=aa());n("imp_uk",a,365);A("imp_uk",a);return a},F=function(a){if(fa)return ib();var b=m("imp_sk"),c=m("imp_sb"),d;a:{try{if("object"===typeof IMP_HL&&"function"==
typeof IMP_HL.session_persist){d=IMP_HL.session_persist();break a}}catch(e){}d=!1}if(d)c?b=c:(c=b=aa(),a&&(jb(b),kb(y())));else if(!b||!c)c=b=aa(),a&&(jb(b),kb(y()));n("imp_sk",b);n("imp_sb",c,lb()/24);return b},mb=function(a){return btoa(encodeURIComponent(a).replace(/%([0-9A-F]{2})/g,function(a,c){return String.fromCharCode("0x"+c)}))},Fb=function(a){return decodeURIComponent(atob(a).split("").map(function(a){return"%"+("00"+a.charCodeAt(0).toString(16)).slice(-2)}).join(""))},q=function(a,b){var c=
"";try{if("object"===typeof localStorage&&"function"===typeof localStorage.getItem&&(c=localStorage.getItem(a),b))try{c=Fb(c)}catch(d){}}catch(e){}return c},A=function(a,b,c){try{if("object"===typeof localStorage&&"function"===typeof localStorage.setItem){if(c)try{b=mb(b.toString())}catch(d){}localStorage.setItem(a,b.toString())}}catch(e){}},r=function(a){try{"object"===typeof localStorage&&"function"===typeof localStorage.setItem&&localStorage.removeItem(a)}catch(b){}},nb=function(a){for(var b=a.split("/"),
c=!1,d=a=0,e=1,h=0,f=1,g=1,k=1,g=0,i=!0,m=0,l=!1,n=!1,j=0,o=0,q="",r=0,s=0,p=0;p<b.length;p++){s++;if(100<s)break;currEventList=b[p].toString().split("|");if(0<currEventList.length){f=currEventList[0];if("scroll"==f)if(c)a++,d++,1<currEventList.length&&(f=currEventList[1].split("-"),1<f.length&&(g=f[0],f=f[1],g>e&&(e=g,h=Math.round(100*e/f),l=!0),g>k?(i||m++,i=!0):g<k&&(i&&m++,i=!1),1==g&&(n=!0),k=g,g=Math.round(100*k/f)));else{c=!0;continue}else if("click"==f||"change"==f||"copy"==f||"paste"==f)"click"==
f&&j++,d++;4<currEventList.length&&(o=Math.round(currEventList[4]/1E3));1<currEventList.length&&0==currEventList[1].toString().indexOf("IMG")&&r++;2<currEventList.length&&"INPUT"==currEventList[1]&&(q=currEventList[2])}}b={};if(!ha)b.scrollCount=a,b.activityCount=d,b.scrollLatest=k,b.scrollLatestPerc=g,b.scrollDirChangeCount=m,b.scrollHasScrolled=l,b.scrollBackToTop=n,b.scrollMax=e,b.scrollMaxPerc=h;b.lastActivitySec=o;b.imageClickCount=r;b.lastInputField=q;a=0;for(x in b)if(a++,20<a)break;return b},
S=function(a){try{a||(a=2);var b=q("imp_pt"),c=q("imp_lpt",!0),d=q("imp_plpt",!0),e=q("imp_lov"),h=q("imp_clpt",!0),f=q("imp_cov");if(b||c||2!=a)if(IMP.appendSiteProp("webevent",a),b&&IMP.appendSiteProp("webdata",b),c)if(a={},ob()){a.webdatalog=c;a.activity={};a.activity=nb(c);a.path=d;if(e)a.pattoverflow="1";if(h)a.content=h;if(f)a.contoverflow="1";if(1500<JSON.stringify(a).toString().length)a.webdatalog="",a.sumoverflow="1";IMP.appendSiteProp("webdatalog",JSON.stringify(a))}else IMP.appendSiteProp("webdatalog",
c),e&&IMP.appendSiteProp("implog","pattoverflow")}catch(g){}},qa=function(){try{r("imp_pt"),r("imp_lpt"),r("imp_plpt"),r("imp_lov"),r("imp_clpt"),r("imp_cov"),Y=K=t="",bb=[],da=!1}catch(a){}},Ga=function(a,b){var c=m("imp_uk");c||(c="unknown");var d=m("imp_sk");d||(d="unknown");c!=a&&(IMP.appendSiteProp("imptransferuk",c),n("imp_uk",a,365));d!=b&&(IMP.appendSiteProp("imptransfersk",d),n("imp_sk",b),n("imp_sb",b,lb()/24))},aa=function(){for(var a=[],b=0;32>b;b++)a[b]="0123456789ABCDEF".substr(Math.floor(16*
Math.random()),1);a[12]="4";a[16]="0123456789ABCDEF".substr(a[16]&3|8,1);return a.join("")},ra=function(){var a="",b;a:{try{if("object"===typeof IMP_HL&&"function"==typeof IMP_HL.allowed_propenc){b=IMP_HL.allowed_propenc();break a}}catch(c){}b=""}var d=!1;for(keyIndex=0;keyIndex<P;keyIndex++){var e;a:{e=O[keyIndex];if(b){var h=b.split(",");for(propIndex=0;propIndex<h.length;propIndex++)if(e==h[propIndex]){e=!0;break a}}e=!1}e?(a+="&KeyValue="+l(O[keyIndex])+":"+l(mb(ca[keyIndex])),d=!0):a+="&KeyValue="+
l(O[keyIndex])+":"+l(ca[keyIndex])}d&&(a+="&KeyValue="+l("impenc")+":"+l(b));return a},H=function(a,b){var c;c="siteid="+N+"&url="+l(i)+"&urlref="+l(w)+"&userkey="+l(y())+"&impsess="+l(F(!1))+"&rand="+Math.random();b&&Ha();c+=ra();Z&&(c+="&ispriority=1");return z+c},C=function(a,b){var c;c="siteid="+N+"&url="+l("https://impevent")+"&urlref="+l(i)+"&userkey="+l(y())+"&impsess="+l(F(!1))+"&rand="+Math.random();b&&Ha();c+=ra();Z&&(c+="&ispriority=1");return z+c},Gb=function(){var a="siteid="+N+"&url="+
l(i)+"&userkey="+l(y())+"&impsess="+l(F(!1))+"&rand="+Math.random();Z&&(a+="&ispriority=1");return z+a},Hb=function(a){var b="siteid="+N+"&url="+l(i)+"&urlref="+l(w)+"&userkey="+l(y())+"&impsess="+l(F(!1))+"&rand="+Math.random();a&&Ha();return b+=ra()},Ib=function(a,b,c){b="InteractionLogId="+l(b)+"&PhoneNumber="+l(c)+"&uk="+l(y())+"&rand="+Math.random();return a+"?"+b},o=function(a){return isNaN(a)?0:a},G=function(a){return a?a:!1},sa=function(a){var b="",b=a.lastIndexOf("/");-1<b?b=a.substr(0,b+
1):(b=z.lastIndexOf("/"),b=-1<b?z.substr(0,b+1):"");return b},pb=function(a){try{"object"===typeof IMP_HL&&"function"==typeof IMP_HL.exist_handle_inithandler&&IMP_HL.exist_handle_inithandler()&&"function"==typeof IMP_HL.handle_inithandler&&IMP_HL.handle_inithandler(a)}catch(b){}},qb=function(a,b,c,d,e,h){a||(a="1");b||(b="start");c||(c=y());d||(d="CoTV");e||(e="CS-5000-01-01");h||(h="sv");var f="0";try{f="object"===typeof IMP_HL?"function"==typeof IMP_HL.exist_handle_runhandler?IMP_HL.exist_handle_runhandler()?
"function"==typeof IMP_HL.handle_runhandler?IMP_HL.handle_runhandler(a,b,c,d,e,h):"-1":"-2":"-3":"-4"}catch(g){f="-5"}return f},Ia=function(a){try{"object"===typeof IMP_HL&&"function"==typeof IMP_HL.exist_appendLocalSiteProp&&IMP_HL.exist_appendLocalSiteProp()&&"function"==typeof IMP_HL.appendLocalSiteProp&&(result=IMP_HL.appendLocalSiteProp(a))}catch(b){}},rb=function(){try{"object"===typeof IMP_HL&&"function"==typeof IMP_HL.exist_appendLocalSitePropPostLog&&IMP_HL.exist_appendLocalSitePropPostLog()&&
"function"==typeof IMP_HL.appendLocalSitePropPostLog&&(result=IMP_HL.appendLocalSitePropPostLog())}catch(a){}},ob=function(){try{if("object"===typeof IMP_HL&&"function"==typeof IMP_HL.allow_extended_datalog&&IMP_HL.allow_extended_datalog())return!0}catch(a){}return!1},sb=function(){try{if("object"===typeof IMP_HL&&"function"==typeof IMP_HL.allow_protect&&IMP_HL.allow_protect())return!0}catch(a){}return!1},lb=function(){try{if("object"===typeof IMP_HL&&"function"==typeof IMP_HL.session_length)return Math.round(IMP_HL.session_length())}catch(a){}return 2},
D=function(){try{if("object"===typeof IMP_HL&&"function"==typeof IMP_HL.block_loginiframe&&IMP_HL.block_loginiframe())return!0}catch(a){}return!1},Ja=function(a){var b;a:{try{if("object"===typeof IMP_HL&&"function"===typeof IMP_HL.exist_handle_focus&&IMP_HL.exist_handle_focus()&&"function"===typeof IMP_HL.handle_focus){b=!0;break a}}catch(c){}b=!1}if(b)try{IMP_HL.handle_focus(a)}catch(d){}},Jb=function(a){var b;a:{try{if("object"===typeof IMP_HL&&"function"===typeof IMP_HL.exist_handle_close&&IMP_HL.exist_handle_close()&&
"function"===typeof IMP_HL.handle_close){b=!0;break a}}catch(c){}b=!1}if(b)try{IMP_HL.handle_close(a)}catch(d){}},Kb=function(a,b,c){var d;a:{try{if("object"===typeof IMP_HL&&"function"===typeof IMP_HL.exist_handle_customized_close&&IMP_HL.exist_handle_customized_close()&&"function"===typeof IMP_HL.handle_customized_close){d=!0;break a}}catch(e){}d=!1}if(d)try{IMP_HL.handle_customized_close(a,b,c)}catch(h){}},tb=function(a,b,c,d,e){var h;a:{try{if("object"===typeof IMP_HL&&"function"===typeof IMP_HL.exist_handle_customized&&
IMP_HL.exist_handle_customized()&&"function"===typeof IMP_HL.handle_customized){h=!0;break a}}catch(f){}h=!1}if(h)try{IMP_HL.handle_customized(a,b,c,d,e)}catch(g){}},Lb=function(){return!0},ub=function(a){var b=[],b=document.getElementsByTagName("title");if(0<b.length)return b[0].innerHTML;for(var b=document.getElementsByTagName("meta"),c=0;c<b.length;c++){if(b[c].getAttribute("property")==a||b[c].getAttribute("name")==a)return b[c].content;if(25<=c)break}return""},La=function(){Ka();Y=K=t="";r("imp_pt");
r("imp_lpt");r("imp_plpt");r("imp_lov");r("imp_clpt");r("imp_cov")},Ma=function(){Math.round((new Date).getTime()/1E3);(new Date).getTime();Y=K=t="";$a=Ca=Ba=!1;ba()},Mb=function(a){if(!p()&&(a=a.split(","),!(5>a.length))){ia=o(a[3]);ja=o(a[4]);if(1==ia&&!Ya)Ya=!0,window.onbeforeunload=function(){if(!1==Ca&&1==ia)try{t&&A("imp_pt",t);S(1);IMP.appendSiteProp("impunload","1");var a=H();if(v()&&"object"===typeof navigator&&"function"===typeof navigator.sendBeacon){try{navigator.sendBeacon(a,"test")}catch(c){}IMP.clearSiteProp()}Ka();
Ca=!0}catch(d){}};if(1==ja&&!Xa)Xa=!0,window.onfocus=function(){if(!0==oa)IMP.appendSiteProp("implogtype",3),Da++,IMP.appendSiteProp("impfocus","1"),IMP.trackFocusInteract(),oa=!1;else if(!0==Ba&&!1==$a&&1==ja&&5>=Da){var a=Math.round(((new Date).getTime()-Za)/1E3),c=m("imp_st");if(c&&(c>ga||120<=a))c>ga?IMP.appendSiteProp("implogtype",4):IMP.appendSiteProp("implogtype",5),Da++,IMP.appendSiteProp("impfocus","1"),IMP.trackFocusInteract()}},window.onblur=function(){Ba=!0;Za=(new Date).getTime();if(1==
ia&&1==ja){var a;a:{try{if("object"===typeof IMP_HL&&"function"===typeof IMP_HL.exist_handle_blur&&IMP_HL.exist_handle_blur()&&"function"===typeof IMP_HL.handle_blur){a=!0;break a}}catch(c){}a=!1}if(a)try{IMP_HL.handle_blur()}catch(d){}t&&A("imp_pt",t);S(1);IMP.appendSiteProp("impblur","1");I(H());Ka()}}}},ba=function(){na||1!=ya||(0<E&&(Aa=setTimeout(function(){try{Sa()&&(na=!1,Wa++,Wa<=la?3==ka?(IMP.appendSiteProp("event",ma),IMP.appendSiteProp("implogtype",9),IMP.trackTimeInteract()):2==ka?!0==
J?(IMP.appendSiteProp("event",ma),IMP.appendSiteProp("implogtype",10),IMP.trackTimeInteract()):ba():1==ka?za=!0:(IMP.appendSiteProp("imptimeappend","1"),IMP.trackAppendLog(!0),ba()):E=0)}catch(a){}},1E3*E)),na=!0,J=za=!1)},Ka=function(){Aa&&clearTimeout(Aa);na=!1},Na=function(a,b,c,d){if((3==d||4==d||5==d)&&0!=ea[a]&&ea[a]==c.InteractionMessageId)if((d=document.getElementById(b))&&"none"!=d.style.display){IMP.trackDisplay(c.InteractionLogId,13,0);s[b]=c.InteractionLogId;return}if((1==a||2==a)&&Ea[a]&&
Ea[a].InteractionMessageId&&c.InteractionMessageId==Ea[a].InteractionMessageId)return!0;d=G(c.IsRepeatState);var e;a:{if(c)try{var h;if(h=!0==p()){var f;b:{try{if("object"===typeof IMP_HL&&"function"==typeof IMP_HL.block_showiniframe&&IMP_HL.block_showiniframe()){f=!0;break b}}catch(g){}f=!1}h=!0==f}if(h){IMP.trackError(c.InteractionLogId,6,"No show in iframe set in script");e=!0;break a}if(placeHolderToUse=c.PlaceHolderToUse)if(-1<placeHolderToUse.indexOf(",")){var k=placeHolderToUse.split(",");
0<k.length&&u(a,b,c,k[0],!0);1<k.length&&u(a,b+"2",c,k[1],!0);2<k.length&&u(a,b+"3",c,k[2],!0);3<k.length&&u(a,b+"4",c,k[3],!0);4<k.length&&u(a,b+"5",c,k[4],!0);5<k.length&&u(a,b+"6",c,k[5],!0);6<k.length&&u(a,b+"7",c,k[6],!0);7<k.length&&u(a,b+"8",c,k[7],!0);8<k.length&&u(a,b+"9",c,k[8],!0);9<k.length&&u(a,b+"10",c,k[9],!0)}else u(a,b,c,placeHolderToUse,!1);else u(a,b,c,"",!1)}catch(i){try{IMP.trackError(c.InteractionLogId,6,i.lineNumber+" "+i.message)}catch(m){}}e=!0}return e},u=function(a,b,c,
d){if(!c)return!0;G(c.OverrideClosedMessage);if(c.BlockMultipleOnSamePage&&document.getElementById(b)){try{IMP.trackError(c.InteractionLogId,6,"BlockMultipleOnSamePage")}catch(e){}return!1}d&&(G(c.PlaceholderReplaceContent),o(c.PlaceholderNewHeight),G(c.PlaceholderChangeHeight),o(c.PlaceholderNewWidth),G(c.PlaceholderChangeWidth));o(c.StartEffect);o(c.StartEffectTime);d=o(c.CloseEffect);0>d&&(d=0);var h=o(c.CloseEffectTime);if(0>h||120<h)h=0;o(c.HideAfterSek);Ta[a]=h;var f=c.ButtonSwitchContext;if(f)g[a][1].LogEvent=
f.LogEvent,g[a][1].LocalHandler=f.LocalHandler,g[a][1].LocalHandlerDirective=f.LocalHandlerDirective,g[a][1].ChangePage=f.ChangePage,g[a][1].PageReference=f.PageReference,g[a][1].KeepUrl=f.KeepUrl,g[a][1].CloseEffect=d,g[a][1].CloseEffectTime=h;if(f=c.ButtonYes)g[a][2].LogEvent=f.LogEvent,g[a][2].LocalHandler=f.LocalHandler,g[a][2].LocalHandlerDirective=f.LocalHandlerDirective,g[a][2].ChangePage=f.ChangePage,g[a][2].PageReference=f.PageReference,g[a][2].KeepUrl=f.KeepUrl,g[a][2].CloseEffect=d,g[a][2].CloseEffectTime=
h;if(f=c.ButtonLater)g[a][3].LogEvent=f.LogEvent,g[a][3].LocalHandler=f.LocalHandler,g[a][3].LocalHandlerDirective=f.LocalHandlerDirective,g[a][3].ChangePage=f.ChangePage,g[a][3].PageReference=f.PageReference,g[a][3].KeepUrl=f.KeepUrl,g[a][3].CloseEffect=d,g[a][3].CloseEffectTime=h;if(f=c.ButtonNo)g[a][4].LogEvent=f.LogEvent,g[a][4].LocalHandler=f.LocalHandler,g[a][4].LocalHandlerDirective=f.LocalHandlerDirective,g[a][4].ChangePage=f.ChangePage,g[a][4].PageReference=f.PageReference,g[a][4].KeepUrl=
f.KeepUrl,g[a][4].CloseEffect=d,g[a][4].CloseEffectTime=h;d=c.DisplayUrl;o(c.Width);o(c.Height);o(c.DelaySek);o(c.TopPos);o(c.LeftPos);var f=h=c.BGUrl,i=h.lastIndexOf("/");-1<i&&(f=h.slice(i+1));(h=f)?"-"==h.toString().substr(0,1)||h.toString().indexOf("--"):sa(d);o(c.BGDelay);(closeButtonText=c.BGText)||(closeButtonText="Close");h=c.InteractionLogId;s[b]=h;W[b]=c.ResponseUrl;ea[a]=c.InteractionMessageId;V[b]=c.Caption;f=c.IsReferenceMessage;G(c.DisplayAsHTML);i=c.HtmlBody;imprushdialogueparams[a]=
rushparamstring="";if(0!=c.SyncWithPartnerDirective)if(5==c.SyncWithPartnerDirective){if(!Va)try{var k=window.addEventListener?"addEventListener":"attachEvent";(0,window[k])("attachEvent"==k?"onmessage":"message",Lb,!1);Va=!0}catch(l){}}else{if(8==c.SyncWithPartnerDirective){var j;a:{try{if("object"===typeof IMP_HL&&"function"==typeof IMP_HL.exist_handle_accepttel&&IMP_HL.exist_handle_accepttel()&&"function"==typeof IMP_HL.handle_accepttel){j=!0;break a}}catch(q){}j=!1}if(j)try{m("imp_int")||(n("imp_int",
Math.round((new Date).getTime()/1E3),30),IMP_HL.handle_accepttel())}catch(r){}return!0}if(9==c.SyncWithPartnerDirective)return b=qb(),(c=c.SyncWithPartnerUrl)||(c="1"),0==b&&n("imp_lh",c),!0;if(10==c.SyncWithPartnerDirective)return n("imp_lh",""),!0;if(11==c.SyncWithPartnerDirective){(b=c.SyncWithPartnerUrl)||(b="1");var p;a:{try{if("object"===typeof IMP_HL&&"function"==typeof IMP_HL.exist_handle_outcome&&IMP_HL.exist_handle_outcome()&&"function"==typeof IMP_HL.handle_outcome){p=!0;break a}}catch(v){}p=
!1}if(p)try{var t=m("imp_oc");t?t.toString()!=b.toString()&&(IMP_HL.handle_outcome(b.toString()),n("imp_oc",b.toString())):(IMP_HL.handle_outcome(b.toString()),n("imp_oc",b.toString()))}catch(y){}return!0}if(12==c.SyncWithPartnerDirective)return tb(c.SyncWithPartnerUrl,h,12,0,f),!0;if(13==c.SyncWithPartnerDirective){var b=c.SyncWithPartnerUrl,u;a:{try{if("object"===typeof IMP_HL&&"function"===typeof IMP_HL.exist_handle_customized_number&&IMP_HL.exist_handle_customized_number()&&"function"===typeof IMP_HL.handle_customized_number){u=
!0;break a}}catch(A){}u=!1}if(u)try{IMP_HL.handle_customized_number(b,i,h,11,0,f)}catch(B){}return!0}if(14==c.SyncWithPartnerDirective)return b=c.SyncWithPartnerUrl.split("|"),c=b[0],d&&-1!=c.indexOf(".css")&&("http://"!=c.substring(0,7)&&"https://"!=c.substring(0,8)&&(c=sa(d)+c),1<b.length&&(p=b[1],-1!=p.indexOf(".js")&&"http://"!=p.substring(0,7)&&"https://"!=p.substring(0,8)&&sa(d)),2<b.length&&"CB"==b[2]&&n("imp_ih","1"),b=c,-1==b.indexOf(".css")&&window.open(d,"Now_VideoWin",b)),!0;if(15!=c.SyncWithPartnerDirective&&
16!=c.SyncWithPartnerDirective&&17!=c.SyncWithPartnerDirective){if(18==c.SyncWithPartnerDirective)return!0;if(19!=c.SyncWithPartnerDirective&&20!=c.SyncWithPartnerDirective)if(21==c.SyncWithPartnerDirective)cb=!0;else{if(22==c.SyncWithPartnerDirective){var b=c.SyncWithPartnerUrl,w;a:{try{if("object"===typeof IMP_HL&&"function"===typeof IMP_HL.exist_handle_customized_number_multi&&IMP_HL.exist_handle_customized_number_multi()&&"function"===typeof IMP_HL.handle_customized_number_multi){w=!0;break a}}catch(C){}w=
!1}if(w)try{IMP_HL.handle_customized_number_multi(b,i,h,11,0,f)}catch(D){}return!0}if(23!=c.SyncWithPartnerDirective)if(24==c.SyncWithPartnerDirective)tb(c.SyncWithPartnerUrl,h,12,0,f);else if(25==c.SyncWithPartnerDirective){var c=c.SyncWithPartnerUrl,z;a:{try{if("object"===typeof IMP_HL&&"function"===typeof IMP_HL.exist_handle_customized_number_button&&IMP_HL.exist_handle_customized_number_button()&&"function"===typeof IMP_HL.handle_customized_number_button){z=!0;break a}}catch(E){}z=!1}if(z)try{IMP_HL.handle_customized_number_button(c,
i,h,11,0,f,b)}catch(F){}}else IMP.trackError(c.InteractionLogId,6,"SyncWithPartnerDirective not supported by script: "+c.SyncWithPartnerDirective)}}}return!0},v=function(){var a=m("imp_no"),b=(new Date).getTime();return a?0<Math.round(a)-Math.round(b)?!1:!0:!0},Oa=function(){if(sb()){var a=m("imp_to"),a=a?Math.round(a)+1:"1",b=60,c=300;1>=Math.round(a)?(b=60,c=300):2>=Math.round(a)?(b=120,c=900):3>=Math.round(a)?(b=300,c=900):(Math.round(a),b=900,c=1800);var d=Math.round(b)/60/60/24,c=Math.round(c)/
60/60/24,b=(new Date).getTime()+1E3*b;n("imp_no",b,d);n("imp_to",a,c)}},vb=function(a){try{if(a.LogData){var b=a.LogData,c;a:{try{if("object"===typeof IMP_HL&&"function"==typeof IMP_HL.exist_handlelogdata&&IMP_HL.exist_handlelogdata()&&"function"==typeof IMP_HL.handle_logdata){c=IMP_HL.handle_logdata(b);break a}}catch(d){}c=!1}if(!c)try{var a=0,e;for(e in b){a++;if(11<a)break;b.hasOwnProperty(e)&&gb("imp_ld_"+e,b[e])}}catch(h){}}}catch(f){IMP.appendSitePropStatic("implogdataerror",f)}},kb=function(a){try{"object"===
typeof IMP_HL&&"function"===typeof IMP_HL.exist_logUserGroup&&IMP_HL.exist_logUserGroup()&&"function"===typeof IMP_HL.logUserGroup&&IMP_HL.logUserGroup(a.toString().substring(0,1))}catch(b){}},jb=function(a){try{"object"===typeof IMP_HL&&"function"===typeof IMP_HL.exist_logSessionGroup&&IMP_HL.exist_logSessionGroup()&&"function"===typeof IMP_HL.logSessionGroup&&IMP_HL.logSessionGroup(a.toString().substring(0,1))}catch(b){}},wb=function(){window.innerWidth&&IMP.appendSiteProp("impwidth",window.innerWidth);
window.innerHeight&&IMP.appendSiteProp("impheight",window.innerHeight);IMP.appendSiteProp("impnavigator",navigator.userAgent.replace(/[:"]/g,""))},yb=function(){if(!m("imp_sb")){var a=q("ni_imp_collection"),b;a&&(b=JSON.parse(a));var c;q("ni_imp_collection_lc")&&(c=JSON.parse(a));if(b)for(key in b)c&&(c[key+"_expire"]||(b[key]=""));A("ni_imp_collection",JSON.stringify(b))}fa=!1;a=m("imp_st");if(!a&&(r("imp_pt"),r("imp_lpt"),r("imp_plpt"),r("imp_lov"),r("imp_clpt"),r("imp_cov"),xb(),n("imp_st","0"),
!m("imp_st"))){a=document.location.hostname;b=a.toString().substr(a.toString().length-3);c=a.lastIndexOf(".");var d=eb(a);-1<c&&!d&&(d=a.lastIndexOf(".",c-1),-1<d?".uk"==b||".in"==b||".id"==b||".il"==b||".za"==b||".cr"==b||".nz"==b||".jp"==b||".kr"==b||".pe"==b||".br"==b||".ck"==b?(b=a.lastIndexOf(".",d-1),-1<b?2<d-b-1&&(a=a.substr(b+1)):2>d-1&&0>a.indexOf("www")&&(a="www."+a)):2<c-d-1&&(a=a.substr(d+1)):2>c-1&&0>a.indexOf("www")&&(a="www."+a));pa=a;n("imp_st","0");if(!m("imp_st")){var e;a:{try{if("object"===
typeof IMP_HL&&"function"==typeof IMP_HL.allow_nocookie&&IMP_HL.allow_nocookie()){e=!0;break a}}catch(h){}e=!1}return e?fa=!0:!1}}if(-1<i.toString().indexOf("imp_ilogid"))(e=fb(i).imp_ilogid)&&IMP.trackSystemEvent(8,e);if(-1<i.toString().indexOf("imp_uk")&&-1<i.toString().indexOf("imp_sk")&&(e=fb(i),a=e.imp_uk,b=e.imp_sk,a&&b))Ga(a,b),(e=e.imp_lh)&&n("imp_lh",e);a=m("imp_st");a=Math.round(a)+1;n("imp_st",a);ga=a;if(3>=Math.round(a)){if(1>Math.round(a))return!1;if(1==Math.round(a))try{"object"===typeof IMP_HL&&
"function"==typeof IMP_HL.exist_appendLocalSessionProp&&IMP_HL.exist_appendLocalSessionProp()&&"function"==typeof IMP_HL.appendLocalSessionProp&&(result=IMP_HL.appendLocalSessionProp())}catch(f){}e="desktopstyle";if(navigator.userAgent.match(/Android/i)||navigator.userAgent.match(/webOS/i)||navigator.userAgent.match(/Phone/i)||navigator.userAgent.match(/iPod/i)||navigator.userAgent.match(/BlackBerry/)||500>screen.width)e="phonestyle";IMP.appendSiteProp("impviewstyle",e);IMP.appendSiteProp("impversion",
"9.10.28_z48f");navigator.language&&IMP.appendSiteProp("implang",navigator.language);IMP.appendSiteProp("impgroup",Eb())}wb();m("imp_ve")&&(IMP.appendSiteProp("impvideoexit","1"),n("imp_ve",""));m("imp_lh")&&IMP.appendSiteProp("imphandler","1");(e=m("cos_mode"))&&IMP.appendSiteProp(e.toString().toLowerCase(),"1");(e=m("imp_to"))&&IMP.appendSiteProp("impprotect",e);p()&&IMP.appendSiteProp("impiframe","1");return!0},T=function(a,
b){if(v())try{if(!window.XMLHttpRequest)return!0;var c=(new Date).getTime(),d=new XMLHttpRequest;d.open("GET",a,!0);d.timeout=3E3;d.onreadystatechange=function(){if(4===d.readyState&&200===d.status){try{zb(JSON.parse(d.responseText),b)}catch(a){IMP.appendSitePropStatic("imperrorreply",a)}var e=(new Date).getTime()-c;IMP.appendSitePropStatic("imploop",e)}};d.ontimeout=function(){Oa();try{IMP.appendSitePropStatic("imptimeout","1"),IMP.appendSitePropStatic("imptimeouturl",i.toString().replace(document.location.protocol,
"").substring(0,150)),IMP.appendSitePropStatic("imptimeoutref",w.toString().replace(document.location.protocol,"").substring(0,150))}catch(a){}};d.send(null);IMP.clearSiteProp();Z=!1}catch(e){return!0}},Nb=function(a,b,c,d){try{if(!window.XMLHttpRequest)return d&&"function"===typeof d&&d("no ajax support"),!0;var e=new XMLHttpRequest;e.open("GET",a,!0);e.timeout=3E3;e.onreadystatechange=function(){if(4===e.readyState&&200===e.status&&(zb(JSON.parse(e.responseText),b),c&&"function"===typeof c)){var a;
var d=JSON.parse(e.responseText);try{a=d.HasClientScriptData&&d.ClientScriptData&&d.ClientScriptData.LogData?d.ClientScriptData.LogData:null}catch(h){a=null}c(a)}};e.ontimeout=function(){d&&"function"===typeof d&&d("timeout");Oa();try{IMP.appendSitePropStatic("imptimeout","1"),IMP.appendSitePropStatic("imptimeouturl",i.toString().replace(document.location.protocol,"").substring(0,150)),IMP.appendSitePropStatic("imptimeoutref",w.toString().replace(document.location.protocol,"").substring(0,150))}catch(a){}};
e.send(null);IMP.clearSiteProp();Z=!1}catch(h){return d&&"function"===typeof d&&d(h),IMP.appendSitePropStatic("imperror",h),!0}},zb=function(a,b){if(a){if(1==b){if(a.HasControlMessage){var c=a.LogPause,d=o(a.LogPauseTime);0>=d&&(d=15);86400<d&&(d=86400);var e=Math.round(d)/60/60/24,d=(new Date).getTime()+1E3*d;c&&n("imp_no",d,e)}if(a.HasClientScriptData){c=a.ClientScriptData;if(c.HandlerFile){e=c.HandlerFile;"http://"!=e.substring(0,7)&&"https://"!=e.substring(0,8)&&(e="//"!=e.substring(0,2)?"https://"+
e:"https:"+e);var d=sa(z).toString(),d=d.replace("https://",""),d=d.replace("http://",""),h=d.indexOf("/");0<h&&(d=d.substr(0,h));if(-1<e.indexOf(".js")&&-1<e.indexOf(d))d=document.createElement("script"),d.type="text/javascript",d.src=e,document.getElementsByTagName("head")[0].appendChild(d)}vb(c);ha=wa=X=!1;if(c.PageLogDirective&&!p()){d=e=!1;try{var f=RegExp(c.PageLogActiveRegExp);c.PageLogActiveRegExp&&f&&(e=f.test(i));var g=RegExp(c.PageLogDetailRegExp);c.PageLogDetailRegExp&&g&&(d=g.test(i))}catch(k){}try{Mb(c.PageLogDirective)}catch(l){IMP.appendSitePropStatic("imperror",
l)}f=c.PageLogDirective.split(",");0<f.length&&1==o(f[0])&&(X=!0);e&&1<f.length&&o(1==f[1])&&(wa=!0);if(d&&(2<f.length&&o(1==f[2])&&(ha=!0),f=c.PageLogDirective,!p()&&(f=f.split(","),!(10>f.length)&&(ya=o(f[6]),ka=o(f[7]),E=o(f[8]),la=o(f[9]),1==ya)))){0==la&&(la=1);if(0<E&&(15>E||60<E))E=30;ba()}}}if(a.HasCollectMetaDataInstruction&&a.CollectMetaData)try{"object"===typeof IMP_HL&&"function"==typeof IMP_HL.exist_handle_collectmeta&&IMP_HL.exist_handle_collectmeta()&&"function"==typeof IMP_HL.handle_collectmeta&&
IMP_HL.handle_collectmeta()}catch(q){}if(f=a.HasChangeKeysMessage)f=a.ChangeKeysMessageUserKey,g=a.ChangeKeysMessageSessionKey,!xa||!f||!g?f=!1:f==y()&&g==F()?f=!1:(Ga(f,g),xa=!1,IMP.appendSiteProp("impdomainswitch","1"),IMP.trackInteract(),f=!0),f=!0==f;if(f)return}else a.HasClientScriptData&&vb(a.ClientScriptData);a.HasSpecialMessage&&(j[3]="ni_imp_spec",Na(3,j[3],a.SpecialMessage,b));a.HasNormalMessage&&(j[1]="ni_imp_prim",Na(1,j[1],a,b));a.HasTeaserMessage&&(j[2]="ni_imp_secd",Na(2,j[2],a.TeaserMessage,
b));if(1==b||4==b){f=X;g=wa;c=ha;try{"object"===typeof IMP_HL&&"function"==typeof IMP_HL.exist_appendLocalSitePropPostReply&&IMP_HL.exist_appendLocalSitePropPostReply()&&"function"==typeof IMP_HL.appendLocalSitePropPostReply&&(result=IMP_HL.appendLocalSitePropPostReply(f,g,c))}catch(r){}J=!1}}sb()&&m("imp_to")&&n("imp_to","",(1/60/60/24).toString())},Pa=function(a){a||(a="logtool");IMP.appendSiteProp("impevent",a);IMP.appendSiteProp("implogtype",6);Fa&&IMP.appendSiteProp("webevent",4);I(C());IMP.clearSiteProp()},
Ab=function(a,b,c){if(v()){var d;try{a||(a="logtool");IMP.appendSiteProp("impevent",a);IMP.appendSiteProp("implogtype",8);Fa&&IMP.appendSiteProp("webevent",4);if(!window.XMLHttpRequest)return IMP.appendSiteProp("impajax","jquery"),d=C(),d+="&impajax=jquery",!0;d=C();var e=new XMLHttpRequest;e.open("GET",d,!0);e.timeout=3E3;e.onreadystatechange=function(){4===e.readyState&&200===e.status&&Ob(JSON.parse(e.responseText),b,c)};e.ontimeout=function(){Oa()};e.send(null);IMP.clearSiteProp()}catch(h){return d||
(d=C()),d+="&impajax=errorjquery",!0}}},Qa=function(a,b,c){a=Ib(a,b,c);b=new XMLHttpRequest;b.open("GET",a,!0);b.timeout=1E4;b.onreadystatechange=function(){};b.ontimeout=function(){};b.send(null)},Ob=function(a,b,c){var d;if(a){if(a.HasSpecialMessage&&a.SpecialMessage.InteractionLogId&&!G(a.SpecialMessage.IsRepeatState))d=a.SpecialMessage.InteractionLogId;if(a.HasTeaserMessage&&a.TeaserMessage.InteractionLogId&&!G(a.TeaserMessage.IsRepeatState))d=a.TeaserMessage.InteractionLogId;if(a.HasNormalMessage&&
a.InteractionLogId&&!G(a.IsRepeatState))d=a.InteractionLogId}if(d==s[j[1]]||d==s[j[2]]||d==s[j[3]])d=0;d&&(IMP.trackDisplay(d,0,0),M=d,b&&c&&setTimeout(function(){Qa(U,M,c)},500))},I=function(a){if(v()){if(!window.XMLHttpRequest)return!0;try{var b=new XMLHttpRequest;b.open("GET",a,!0);b.timeout=3E3;b.onreadystatechange=function(){};b.ontimeout=function(){};b.send(null);IMP.clearSiteProp()}catch(c){return!0}}},Bb=function(a){if(v()){if(!window.XMLHttpRequest)return!0;try{var b=new XMLHttpRequest,c=
Gb(),d=Hb(a);b.open("POST",c,!0);b.setRequestHeader("Content-type","application/x-www-form-urlencoded");b.timeout=3E3;b.onreadystatechange=function(){};b.ontimeout=function(){};b.send(d);IMP.clearSiteProp()}catch(e){return!0}}},Ra=function(a){a=a.toString().replace(/[\x8C]/g,"OE");a=a.toString().replace(/[\x9C]/g,"oe");a=a.toString().replace(/[\x9E]/g,"z");a=a.toString().replace(/[\x9F]/g,"Y");a=a.toString().replace(/[\xC0-\xC5]/g,"A");a=a.toString().replace(/[\xC6]/g,"AE");a=a.toString().replace(/[\xC7]/g,
"C");a=a.toString().replace(/[\xC8-\xCB]/g,"E");a=a.toString().replace(/[\xCC-\xCF]/g,"I");a=a.toString().replace(/[\xD0]/g,"D");a=a.toString().replace(/[\xD1]/g,"N");a=a.toString().replace(/[\xD2-\xD6]/g,"O");a=a.toString().replace(/[\xD7]/g," ");a=a.toString().replace(/[\xD8]/g,"O");a=a.toString().replace(/[\xD9-\xDC]/g,"U");a=a.toString().replace(/[\xDD]/g,"Y");a=a.toString().replace(/[\xDE-\xDF]/g," ");a=a.toString().replace(/[\xE0-\xE5]/g,"a");a=a.toString().replace(/[\xE6]/g,"ae");a=a.toString().replace(/[\xE7]/g,
"c");a=a.toString().replace(/[\xE8-\xEB]/g,"e");a=a.toString().replace(/[\xEC-\xEF]/g,"i");a=a.toString().replace(/[\xF0]/g,"o");a=a.toString().replace(/[\xF1]/g,"n");a=a.toString().replace(/[\xF2-\xF6]/g,"o");a=a.toString().replace(/[\xF7]/g," ");a=a.toString().replace(/[\xF8]/g,"o");a=a.toString().replace(/[\xF9-\xFC]/g,"u");a=a.toString().replace(/[\xFD]/g,"y");a=a.toString().replace(/[\xFE]/g," ");return a=a.toString().replace(/[\xFF]/g,"y")},Ha=function(){var a=q("ni_imp_lprp"),b,c;if(a)for(var d=
a.split(","),a=0;a<d.length;a++)if(c=d[a],b=q("ni_imp_prp_"+c,!0)){var e;a:{e=void 0;for(e=0;e<P;e++)if(c==O[e]){e=!0;break a}e=!1}e||IMP.appendSiteProp(c,b)}},xb=function(){var a=q("ni_imp_lprp"),b;if(a){for(var c=a.split(","),a=0;a<c.length;a++)b=c[a],r("ni_imp_prp_"+b);r("ni_imp_lprp")}};return IMP={hide_IMPiframe:function(a,b,c,d){var e=j[a];setTimeout(function(){var a=document.getElementById(e);a&&a.parentNode.removeChild(a);(a=document.getElementById(e+"2"))&&a.parentNode.removeChild(a);(a=
document.getElementById(e+"3"))&&a.parentNode.removeChild(a);(a=document.getElementById(e+"4"))&&a.parentNode.removeChild(a);(a=document.getElementById(e+"5"))&&a.parentNode.removeChild(a);(a=document.getElementById(e+"6"))&&a.parentNode.removeChild(a);(a=document.getElementById(e+"7"))&&a.parentNode.removeChild(a);(a=document.getElementById(e+"8"))&&a.parentNode.removeChild(a);(a=document.getElementById(e+"9"))&&a.parentNode.removeChild(a);(a=document.getElementById(e+"10"))&&a.parentNode.removeChild(a)},
1E3*Ta[a]);ea[a]=0;d||(IMP.trackCloseBox(b),cb&&Kb(a,b,c),Jb(V[e]))},initsite:function(a,b){var c=b;N=a;c?("1"==c?c="imp":"2"==c?c="imp2":"3"==c?c="imp3":"4"==c?c="imp4":"5"==c&&(c="imp5"),z="https://"+c+".nowinteract.com/logserver/ResponseService.ashx?",metadataurl="https://"+c+".nowinteract.com/logserver/PageMetaData.ashx?",U="https://"+c+".nowinteract.com/logserver/ActionResponse.aspx"):(z="https://imp.nowinteract.com/logserver/ResponseService.ashx?",metadataurl="https://imp.nowinteract.com/logserver/PageMetaData.ashx?",
U="https://imp.nowinteract.com/logserver/ActionResponse.aspx")},setToolAppendMode:function(){Fa=!0},initSubDomain:function(){m("imp_sb")||(xa=!0,IMP.appendSiteProp("webdomainevent","1"))},isInitsite:function(){return N?!0:!1},appendSiteEvent:function(a){if(a){var b=a,c=(new Date).getTime();Math.round((c-ab)/1E3);ab=c;Math.round((c-Cb)/1E3);var b=b.toString().replace(/[\x09-\x10]/g," "),b=Ra(b),b=b.toString().replace(/[^\x20-\x7E]/g,""),b=b.toString().replace(/[\/:]/g," "),b=b.toString().replace(/[<>]/g,
""),d=IMP.getSitePropStatic("event"),c=IMP.getSitePropStatic("eventcount");d?(b=d+"/"+b,c=Math.round(c)+1):c=1;150>b.length&&IMP.appendSitePropStatic("event",b);IMP.appendSitePropStatic("eventcount",c);J=!0;-1<a.toString().indexOf("scroll")&&(b=a.split("|"),2<=b.length&&(a=b[0]+"_"+b[1]),ma=a);za&&(IMP.appendSiteProp("event",ma),IMP.appendSiteProp("implogtype",11),IMP.trackTimeInteract(),ba());Math.round((new Date).getTime()/1E3)}},clearSiteProp:function(){O=[];ca=[];P=0},appendSiteProp:function(a,
b){if("object"===typeof b&&"impevent"==a){if(X)try{if(b.Category&&!("react"==b.Category||"googleads"==b.Category))bb.push(b),da=!0}catch(c){}}else{"order"==b&&"impevent"==a&&(ua=!0);O[P]=a;var d;d=b.toString().replace(/[\x09-\x10]/g," ");d=Ra(d);d=d.toString().replace(/[^\x20-\x7E]/g,"");d=d.toString().replace(/[<>]/g,"");ca[P]=d;P++}},appendSitePropStatic:function(a,b){if(b){if(!q("ni_imp_prp_"+a,!0)){var c=q("ni_imp_lprp");A("ni_imp_lprp",c?c+","+a:a)}A("ni_imp_prp_"+a,b,!0)}},getSitePropStatic:function(a){return q("ni_imp_prp_"+
a,!0)},clearAllSitePropStatic:function(){xb()},appendNamedMetaProp:function(a,b){var c=ub(a),d=a.toString().replace(/:/g,"");b&&(d=b);c&&IMP.appendSiteProp(d,c)},appendMetaProp:function(a){a=ub(a);ta++;var b="impmeta";1<ta&&(b+=ta.toString());a&&IMP.appendSiteProp(b,a)},appendEventProp:function(a){a&&IMP.appendSiteProp("impevent",a)},trackButtonEvent:function(){return!0},trackLogToolFollow:function(a){Pa(a)},trackLogToolAccept:function(a){Pa(a)},trackLogToolAcceptServer:function(a){Pa(a)},trackLogToolDisplay:function(a){Ab(a)},
trackLogToolDisplayClose:function(){var a=M;a&&IMP.trackCloseBox(a)},trackLogToolClose:function(){var a=M;a&&IMP.trackCloseBox(a)},trackLogToolDisplayAccept:function(a,b,c){var d=M;d&&IMP.trackAcceptTool(d,a,b,c)},trackLogToolDisplayAcceptContact:function(a){M&&U&&Qa(U,M,a)},trackLogToolAcceptContact:function(a,b){Ab(a,!0,b)},trackAppendLog:function(a){if(!0==p()&&!0==D())return!0;i=B.location.href;if(v()){a?IMP.appendSiteProp("webevent",1):IMP.appendSiteProp("webevent",3);t&&IMP.appendSiteProp("webdata",
t);if(K)if(a={},a.webdatalog=K,a.activity={},a.activity=nb(K),a.path=document.location.pathname,a.activity.lastInputField&&IMP.apppendSiteProp("lastinput",a.activity.lastInputField),ob()){if(Y)a.pattoverflow="1";if(1E3<JSON.stringify(a).toString().length)a.webdatalog="",a.sumoverflow="1";IMP.appendSiteProp("webdatalog",JSON.stringify(a))}else IMP.appendSiteProp("webdatalog",K),Y&&IMP.appendSiteProp("implog","pattoverflow");I(H())}},trackLogPost:function(){Bb(!0)},trackAppendLogPost:function(){if(!0==
p()&&!0==D())return!0;v()&&(IMP.appendSiteProp("webevent",3),Bb())},trackClean:function(){IMP.hide_IMPiframe(1,s[j[1]],4,!0);IMP.hide_IMPiframe(2,s[j[2]],4,!0);IMP.hide_IMPiframe(3,s[j[3]],4,!0)},trackInteract:function(a,b){if(!0==p()&&!0==D())return!0;i=B.location.href;w=B.referrer;a&&(i=a);b&&(w=b);L=i;if(yb()){if(v()){try{S();F(!0);var c=m("imp_lh"),d=m("imp_ih"),e=!1,g,f=i,l="";if(f)try{"object"===typeof IMP_HL&&"function"==typeof IMP_HL.exist_check_handlerpattern&&IMP_HL.exist_check_handlerpattern()&&
"function"==typeof IMP_HL.check_handlerpattern&&(l=IMP_HL.check_handlerpattern(f))}catch(k){}if(g=l)n("imp_lh",g.toString()),e=!0;c?pb(c.toString()):e?pb(g.toString()):d&&(runhandlerresult=qb(),0==runhandlerresult&&n("imp_lh","1"));Ia();var j=m("imp_sl");j||(j="0");j=Math.round(j)+1;n("imp_sl",j);va=j;IMP.appendSiteProp("impview",va);IMP.appendSiteProp("imptab",R++);Sa()?(IMP.appendSiteProp("implogtype",0),oa=!1):(IMP.appendSiteProp("implogtype",1),oa=!0);$()}catch(o){IMP.appendsiteprop("imperror",
o)}T(H(!0,!0),1);qa();IMP.clearAllSitePropStatic();Ua=F();rb()}}else IMP.appendSitePropStatic("imperrorsend","nostartupinfo")},trackEventInteract:function(a){if(ua)ua=!1;else{if(X&&da){if(L!=document.location.href||!m("imp_sb"))a=L,L=document.location.href,IMP.trackTabInteract("",L,a);da=!1}return!0}if(!0==p()&&!0==D())return!0;a&&IMP.appendSiteProp("impevent",a);v()&&(IMP.appendSiteProp("implogtype",7),IMP.appendSiteProp("imptab",R++),$(),T(C(),2))},trackEventInteractCallback:function(a,b){if(!0==
p()&&!0==D())return b&&"function"===typeof b&&b("iframe"),!0;if(!v())return b&&"function"===typeof b&&b("not active"),!0;IMP.appendSiteProp("implogtype",7);IMP.appendSiteProp("imptab",R++);Nb(C(),2,a,b)},trackSwitchEventInteract:function(){if(!0==p()&&!0==D())return!0;v()&&(IMP.appendSiteProp("implogtype",7),T(H(),2))},trackItemInteract:function(a,b,c){var a=i,d=w;IMP.trackTabInteract("",b,c,!0);i=a;w=d},trackTabInteract:function(a,b,c,d){if(!0==p()&&!0==D())return!0;i=B.location.href;w=B.referrer;
b&&(i=b);c&&(w=c);L=i;a&&IMP.appendSiteProp("tabevent",a);v()&&(t&&A("imp_pt",t),S(),wb(),Ia(!0),d?IMP.appendSiteProp("implogtype",14):IMP.appendSiteProp("implogtype",2),IMP.appendSiteProp("imptab",R++),$(),T(H(!0,!0),4),qa(),IMP.clearAllSitePropStatic(),La(),Ma(),Ja("pagetab"),J=!1)},trackFocusInteract:function(){if(!0==p()&&!0==D())return!0;L=i;v()&&yb()&&(S(),Ia(!0),IMP.appendSiteProp("imptab",R++),$(),T(H(),5),qa(),La(),Ma(),Ja(),J=!1,rb())},trackTimeInteract:function(){if(!0==p()&&!0==D())return!0;
v()&&(t&&A("imp_pt",t),S(),IMP.appendSiteProp("imptab",R++),$(),T(H(),3),qa(),La(),Ma(),Ja("pagetimer"),J=!1)},trackMetaData:function(){i=B.location.href;var a=I,b;b="siteid="+N+"&url="+l(i)+"&rand="+Math.random();b+=ra();a(metadataurl+b);IMP.clearSiteProp()},trackSystemEvent:function(a,b){IMP.clearSiteProp();IMP.appendSiteProp("sysevent",a);IMP.appendSiteProp("interactionlogid",b);I(C());IMP.clearSiteProp()},trackCloseBox:function(a){IMP.trackSystemEvent(2,a)},trackHtmlCloseBox:function(a){var b=
0;a?b=s[a]:Q?(a=Q,b=s[a]):b=0;b&&IMP.trackCloseBox(b)},trackHtmlAccept:function(a){IMP.trackHtmlAcceptTool(a)},trackHtmlAcceptTool:function(a,b,c,d){var e=0;a?e=s[a]:Q?(a=Q,e=s[a]):e=0;e&&IMP.trackAcceptTool(e,b,c,d)},trackDisplay:function(a,b,c){IMP.clearSiteProp();IMP.appendSiteProp("sysevent",5);IMP.appendSiteProp("interactionlogid",a);IMP.appendSiteProp("displayreason",b);IMP.appendSiteProp("displayreasondetail",c);I(C());IMP.clearSiteProp()},trackFollowLink:function(a){IMP.trackSystemEvent(1,
a)},trackAccept:function(a){IMP.trackSystemEvent(9,a)},trackAcceptTool:function(a,b,c,d){IMP.clearSiteProp();IMP.appendSiteProp("sysevent",9);IMP.appendSiteProp("interactionlogid",a);b&&IMP.appendSiteProp("accepttype",b);c&&IMP.appendSiteProp("acceptcode",c);d&&IMP.appendSiteProp("acceptexttype",d);I(C());IMP.clearSiteProp()},trackError:function(a,b,c){IMP.clearSiteProp();IMP.appendSiteProp("sysevent",b);IMP.appendSiteProp("interactionlogid",a);IMP.appendSiteProp("syserrorinfo",c);I(C());IMP.clearSiteProp()},
trackSendContact:function(a,b){b||(b=Q?Q:j[1]);Qa(W[b],s[b],a);return!0},trackKeep:function(){},trackGetKey:function(){return y()},getUKey:function(){return y()},getSKey:function(){return F()},getPKey:function(){return y()+"_"+Ua+"_"+ga+"_"+va},getJKey:function(){return aa()},getCookie:function(a){return hb(a)},getKeyVal:function(a){return hb(a)},setKeyVal:function(a,b,c){return gb(a,b,c)},transferKeys:function(a,b){return Ga(a,b)},adjustExtendedAscii:function(a){return Ra(a)}}})();

    try {
		var fpcategory="usfar170615epo";
		if (document.location.href.toLowerCase().indexOf("onetravel.com")>-1){
			fpcategory="usone171129tra";
		} else if (document.location.href.toLowerCase().indexOf("cheapoair.ca")>-1) {
			fpcategory="usche180717air";
		}
		
    	if (!IMP.isInitsite()) {
			IMP.initsite(fpcategory,"us1");
			if (document.readyState === "complete") {
				IMP.appendSiteProp("impload","complete");
				IMP.trackInteract();
				IMP_HL.trackReference();
			} else if (document.readyState === "interactive") {
				IMP.appendSiteProp("impload","interactive");
				IMP.trackInteract();
				IMP_HL.trackReference();
			} else if (document.readyState !== "loading" && !document.documentElement.doScroll) {
				IMP.appendSiteProp("impload","ie");
				IMP.trackInteract();
				IMP_HL.trackReference();
			} else {
				IMP_HL.trackReferenceDelay();
				document.addEventListener("DOMContentLoaded", function(event) {
					IMP.initsite(fpcategory,"us1");
					IMP.appendSiteProp("impload","ondomcontentloaded");
					IMP.trackInteract();
					IMP_HL.trackReference();
				});
			}
		}
    } catch (e)
    {

    }
  } else {
	if (document.readyState === "complete") {
		IMP.appendSitePropStatic("impreload","reloadcomplete");
	} else if (document.readyState === "interactive") {
		IMP.appendSitePropStatic("impreload","reloadinteractive");
	} else {
		IMP.appendSitePropStatic("impreload","reloadother");
	}
  	//IMP.trackInteract();
  }
