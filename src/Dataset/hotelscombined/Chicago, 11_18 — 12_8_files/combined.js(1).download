(new R9.logger).time("combined");(function(h,k){h.createComponentClass("hotels.common.brands.hotelscombined.SecretDealsNotification",{confetti:{maxCount:500,speed:2,frameInterval:15,alpha:1,gradient:!1},colors:"rgba(30,144,255, rgba(107,142,35, rgba(255,215,0, rgba(255,192,203, rgba(106,90,205, rgba(173,216,230, rgba(238,130,238, rgba(152,251,152, rgba(70,130,180, rgba(244,164,96, rgba(210,105,30, rgba(220,20,60,".split(" "),streamingConfetti:!1,animationTimer:null,lastFrameTime:Date.now(),particles:[],waveAngle:0,context:null,options:{loggedIn:!1,
closeAfter:void 0,closeConfettiAfter:2E3,minConfetti:500,maxConfetti:1E3,lockedCookie:"locked-secretdeal-toast"},addEventHandlers:function(){var a=this;a.getChildElement("close").on("click",function(){a.swapClasses(a.element,"Wrapper--Visible","Wrapper--Hidden")});a.subscribe(["htc.details.page.secret.deal.visible","htc.results.page.secret.deal.visible"],function(){setTimeout(function(){a.options.loggedIn?h.storage.get("secret-deals.first.page")&&(h.storage.remove("secret-deals.first.page"),a.show(),
a.startConfetti(a.options.closeConfettiAfter,a.options.minConfetti,a.options.maxConfetti)):sessionStorage.getItem(a.options.lockedCookie)||(sessionStorage.setItem(a.options.lockedCookie,"true"),a.show())},1E3)})},show:function(){var a=this;a.swapClasses(a.element,"Wrapper--Hidden","Wrapper--Visible");setTimeout(function(){a.swapClasses(a.element,"Wrapper--Visible","Wrapper--Hidden")},a.options.closeAfter)},inlineComponentsReady:function(){h.events.publish("secret.deals.notification.loaded");this.swapClasses(this.element,
"","Wrapper--Animated")},resetParticle:function(a,c,b){a.color=this.colors[Math.random()*this.colors.length|0]+(this.confetti.alpha+")");a.color2=this.colors[Math.random()*this.colors.length|0]+(this.confetti.alpha+")");a.x=Math.random()*c;a.y=Math.random()*b-b;a.diameter=5*Math.random();a.tilt=5*Math.random();a.tiltAngleIncrement=.07*Math.random()+.05;a.tiltAngle=Math.random()*Math.PI;return a},runAnimation:function(){if(0===this.particles.length)this.context.clearRect(0,0,window.innerWidth,window.innerHeight),
this.animationTimer=null;else{var a=Date.now(),c=a-this.lastFrameTime;c>this.confetti.frameInterval&&(this.context.clearRect(0,0,window.innerWidth,window.innerHeight),this.updateParticles(),this.drawParticles(this.context),this.lastFrameTime=a-c%this.confetti.frameInterval);this.animationTimer=requestAnimationFrame(this.runAnimation.bind(this))}},startConfetti:function(a,c,b){var d=this,f=window.innerWidth,g=window.innerHeight;window.requestAnimationFrame=function(){return window.requestAnimationFrame||
window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame||function(a){return window.setTimeout(a,d.confetti.frameInterval)}}();this.context=document.getElementById("confetti-canvas").getContext("2d");var e=this.confetti.maxCount;c?b?c===b?e=this.particles.length+b:(c>b&&(e=c,c=b,b=e),e=this.particles.length+(Math.random()*(b-c)+c|0)):e=this.particles.length+c:b&&(e=this.particles.length+b);for(;this.particles.length<e;)this.particles.push(this.resetParticle({},
f,g));this.streamingConfetti=!0;this.runAnimation.call(d);a&&window.setTimeout(function(){d.streamingConfetti=!1},a)},drawParticles:function(a){for(var c,b,d,f,g=0;g<this.particles.length;g++){c=this.particles[g];a.beginPath();a.lineWidth=c.diameter;d=c.x+c.tilt;b=d+c.diameter/2;f=c.y+c.tilt+c.diameter/2;if(this.confetti.gradient){var e=a.createLinearGradient(b,c.y,d,f);e.addColorStop("0",c.color);e.addColorStop("1.0",c.color2);a.strokeStyle=e}else a.strokeStyle=c.color;a.moveTo(b,c.y);a.lineTo(d,
f);a.stroke()}},updateParticles:function(){var a=window.innerWidth,c=window.innerHeight,b;this.waveAngle+=.01;for(var d=0;d<this.particles.length;d++)if(b=this.particles[d],!this.streamingConfetti&&-15>b.y?b.y=c+100:(b.tiltAngle+=b.tiltAngleIncrement,b.x+=Math.sin(this.waveAngle)-.5,b.y+=.5*(Math.cos(this.waveAngle)+b.diameter+this.confetti.speed),b.tilt=15*Math.sin(b.tiltAngle)),b.x>a+20||-20>b.x||b.y>c)this.streamingConfetti&&this.particles.length<=this.confetti.maxCount?this.resetParticle(b,a,
c):(this.particles.splice(d,1),d--)}})})(R9,jQuery);(function(a){a.createComponentClass("hotels.results.brands.hotelscombined.HotelResultsBreadcrumbs",{crumbList:null,options:{currentDestination:""},init:function(){this.crumbList=this.getChildElement("crumbList");var b=this;a.events.publish("hotels.breadcrumbs.destinationChange",b.options.currentDestination);a.question.forget("hotels.breadcrumbs.destination");a.question.answer("hotels.breadcrumbs.destination",function(){return b.options.currentDestination})}})})(window.R9);(function(b){R9.extend("Widgets",{TextInput:function(a,c){this.elementNode=a;this.element=b(this.elementNode);this.validateElement()&&(this.options=b.extend({},this.options,c),this.init())}});R9.extend("Widgets.TextInput",{isTextInput:function(a){return a&&a.nodeName&&"input"==a.nodeName.toLowerCase()&&"text"==a.type.toLowerCase()},isWidgetControlled:function(a){return"undefined"==typeof document.createElement("input").placeholder}});R9.extend("Widgets.TextInput.prototype",{widgetName:"textinput",
widgetBaseClass:"r9-textinput",widgetPlaceholderClass:"r9-textinput-placeholder-active",elementNode:null,element:null,options:{click:null,change:null},init:function(){this.bindInputEvent("focus",this.handleElementFocusEvent);this.bindInputEvent("smartyfocus",this.handleElementFocusEvent);this.bindInputEvent("blur",this.handleElementBlurEvent);this.bindFormSubmission();this.element.data(this.widgetName,this);this.element.is(":focus")||this.handleElementBlurEvent(this.elementNode)},validateElement:function(){return R9.Widgets.TextInput.isTextInput(this.elementNode)&&
R9.Widgets.TextInput.isWidgetControlled(this.elementNode)&&void 0===this.element.data(this.widgetName)},bindInputEvent:function(a,b){var c=this;a+="."+this.widgetName;this.element.unbind(a).bind(a,function(a){b.call(c,this,a)})},bindFormSubmission:function(){var a=this,b="submit."+a.widgetName+a.element.attr("id"),d="form-pre-submit."+a.widgetName+a.element.attr("id");this.element.parents("form").off(b).on(b,function(b){a.element.val()==a.element.attr("placeholder")&&a.clearPlaceholderText(a.element)});
this.element.parents("form").off(d).on(d,function(b){a.element.val()==a.element.attr("placeholder")&&a.clearPlaceholderText(a.element)})},handleElementFocusEvent:function(a,c){a.disabled||(b(a).val()==b(a).attr("placeholder")&&this.clearPlaceholderText(b(a)),this.options.focus&&this.options.focus.apply(this,arguments))},handleElementBlurEvent:function(a,c){a.disabled||(0==b.trim(b(a).val()).length&&this.setPlaceholderText(a),this.options.blur&&this.options.blur.apply(this,arguments))},clearPlaceholderText:function(a){a.removeClass(this.widgetPlaceholderClass).val("")},
setPlaceholderText:function(a){b(a).addClass(this.widgetPlaceholderClass).val(b(a).attr("placeholder"))}})})(jq||jQuery);
(function(b){R9.createWidgetClass("text.TextInput",b.extend({},R9.Widgets.TextInput.prototype,{widgetPlaceholderClass:"vs-placeholder",inputElement:null,icon:null,options:{needsPlaceholderSupport:!1,selectOnFocus:!1,useMcFlyStyling:!1,useIcon:!1},init:function(){this.inputElement=this.inputElement||this.element;this.elementNode=this.inputElement.get(0);this.options.useMcFlyStyling&&this.options.useIcon&&(this.icon=b("#"+this.id("icon")))},addEventHandlers:function(){var a=this;this.options.needsPlaceholderSupport&&
(this.element.is(":focus")||this.handleElementBlurEvent(this.elementNode),this.bindInputEvent("focus",this.handleElementFocusEvent),this.bindInputEvent("smartyfocus",this.handleElementFocusEvent),this.bindInputEvent("blur",this.handleElementBlurEvent));if(this.options.selectOnFocus)a.inputElement.on("focus",function(){a.inputElement.on("mouseup.a keyup.a",function(b){a.elementNode.setSelectionRange(0,9999);a.inputElement.off("mouseup.a keyup.a").select()})});this.options.useMcFlyStyling&&this.options.useIcon&&
(this.registerEvent("mouseenter",this.inputElement,function(){a.icon.addClass("hovered")}),this.registerEvent("mouseleave",this.inputElement,function(){a.icon.removeClass("hovered")}),this.registerEvent("focus",this.inputElement,function(){a.icon.addClass("focused")}),this.registerEvent("blur",this.inputElement,function(){a.icon.removeClass("focused")}))},getValue:function(){return b(this.inputElement).val()}}))})(jq||jQuery);(function(e,f){e.publish("SmartyLogger",{loggingCategory:"Smarty",inputDefault:"destination",selectedIndex:"",subscribedLogSearchId:void 0,locationTypeIdLookupMap:{ap:"lmid",lm:"lmid",hotel:"hid",freereg:"frid",hood:"nhid",ctry:"cid"},_save:function(a){this.setStorage(a)},_log:function(a){a&&(this.logData(a,"origin"),this.logData(a,"destination"))},logData:function(a,c){var b=this;a=this.getLoggingObj(a,c);f.isEmptyObject(a)||e.Analytics.api.trackEvent(a,function(){b.cleanUpSmartyLogger(c)})},makeOptionsStr:function(a,
c){var b=this,d,f,k,g=[],l=!1;a.each(function(h){d=e.common.widgets.smarty.FlareSmarty.prototype.translateItem.call(this,a[h]);null==c||l||d.id!==c.id||d.type!==c.type||(b.selectedIndex=h+1,l=!0);f=d.id.split("/");1<f.length&&(d.idCode=f[1],d.apCode=f[0]);k="ap"===d.type?"airport":d.type;g.push("pos: "+(h+1));g.push("text: "+b.cleanString(d.short_str||d.str));g.push("locid: "+b.getBestItemId.call(b,d));g.push("loc_type: "+k)});return g.join("|")},getBestItemId:function(a){return a&&a.type?this.cleanString(a[this.locationTypeIdLookupMap[a.type]||
"id"]||a.id||""):""},getLoggingObj:function(a,c){var b=this.getStorage(c),d={};f.isEmptyObject(b)||(d={searchid:a,category:this.loggingCategory,params:{point:c}},b.hasOwnProperty("vertical")&&(d.params.vertical=b.vertical),b.hasOwnProperty("prefix")&&(d.params.prefix=b.prefix),b.hasOwnProperty("selected")&&(d.params.selected=b.selected),b.hasOwnProperty("options")&&(d.params.options=b.options));return d},setStorage:function(a){if(a&&e.storage.isAvailable()){var c=(a.inputType||this.inputDefault)+
"SmartyLogging",b=this.getStorageObj(a.inputType);a.hasOwnProperty("vertical")&&(b.vertical=a.vertical);a.hasOwnProperty("prefix")&&(b.prefix=this.cleanString(a.prefix));a.hasOwnProperty("options")&&(b.options=this.makeOptionsStr(a.options,a.selectedElem||null),b.selected=this.selectedIndex,this.selectedIndex="");e.storage.set(c,b)}},getStorageObj:function(a){a=(a||this.inputDefault)+"SmartyLogging";var c={};e.storage.isAvailable()&&(c=e.storage.get(a),f.isEmptyObject(c)&&(e.storage.set(a,{}),c=e.storage.get(a)));
return c},getStorage:function(a){var c={};e.storage.isAvailable()&&(c=e.storage.get(a+"SmartyLogging"));return c},cleanString:function(a){return"string"===typeof a?a.trim().replace(/&/g,"\\\x26"):""},cleanUpSmartyLogger:function(a){e.storage.remove(a+"SmartyLogging");this.selectedIndex=""},onLogSearchId:function(a){a&&this._log(a)}});e.SmartyLogger.subscribedLogSearchId||(e.SmartyLogger.subscribedLogSearchId=1,e.events.subscribe("smartylogger.log.searchId",f.proxy(e.SmartyLogger.onLogSearchId,e.SmartyLogger)))})(R9,
jQuery);(function(l){var m={},n=function(a,c){var b=JSON.stringify(a,Object.keys(a).sort());if(m.hasOwnProperty(b))m[b].callbacks.push(c);else{var d={key:b,callbacks:[c],request:l.ajax({type:"GET",dataType:"json",url:"/s/run/recentsearchhistory/gethistory",data:a,success:function(a){for(;d.callbacks.length;)d.callbacks.pop()(a)},complete:function(){delete m[b]}})};m[b]=d}};R9.extend("Common",{SmartyHistory:function(a){var c=a.historyType;c||(c="flight");var b=R9.Common.SmartyHistory.prototype["_"+c+"Instance"];
if(b)return b.init(),R9.Common.SmartyHistory.prototype["_"+c+"Instance"];this.options=l.extend({},this.options,a);this.init();R9.Common.SmartyHistory.prototype["_"+c+"Instance"]=this}});R9.extend("Common.SmartyHistory",{SmartyFlightHistory:function(a){return R9.Common.SmartyHistory.call(this,l.extend({historyType:"flight"},a))},SmartyHotelHistory:function(a){return R9.Common.SmartyHistory.call(this,l.extend({historyType:"hotel"},a))},SmartyCarHistory:function(a){return R9.Common.SmartyHistory.call(this,
l.extend({historyType:"car"},a))},SmartyClearHistory:function(){this.currentSmartyHistory&&(this.currentSmartyHistory.clearHistory(),this.currentSmarty.hideDropdown(),this.currentSmarty.runSearch(!1));R9.Analytics.api.trackEvent("smartyHistory/click/clearHistory")}});R9.extend("Common.SmartyHistory.prototype",{history:null,received:!1,options:{historyType:"flight",maxSearchHistory:30,searchHistorySubtype:"",showPastDates:R9.config.getBoolean("ui.smarty-history.showPastDates",!1)},init:function(){this.received&&
null!==this.history||setTimeout(this.update.bind(this),1)},update:function(){var a=this;n({searchType:a.options.historyType,maxSearchHistoryNum:a.options.maxSearchHistory,searchHistorySubtype:a.options.searchHistorySubtype},function(c){if(c)for(a.history=c,a.processPastDates(),a.received=!0,c=0;c<a.history.length;c++)a.history[c].idx=c})},clearHistory:function(){this.history=[];var a=this;l.ajax({type:"POST",url:"/s/run/recentsearchhistory/clearhistory",data:{searchType:a.options.historyType},success:function(c){a.history=
[];R9.Analytics.api.trackEvent({category:"Smarty-History",action:"clear-history"})}})},matchWord:function(a,c){var b=a.indexOf(c);0!==b&&(b=a.indexOf(" "+c),-1<b&&(b+=1));return b},processPastDates:function(){var a=[];if(null!==this.history){for(var c=0;c<this.history.length;c++){var b=this.history[c],d=b.startDate||b.checkinDate,e=b.endDate||b.checkoutDate;if(d&&e){var d=new moment(d),e=new moment(e),g=new moment;d.isBefore(g,"day")||e.isBefore(g,"day")?this.options.showPastDates&&(b.isPast=!0,a.push(b)):
a.push(b)}}this.history=a}}});R9.extend("Common.SmartyHistory.SmartyFlightHistory.prototype",!0,R9.Common.SmartyHistory.prototype,{filter:function(a,c,b,d,e){b=b||Infinity;var g=[];if(null===this.history)return[];var h=[];if(c||""===e)h=this.history;else for(var f=0;f<this.history.length;f++){var k=this.history[f];k.departCode===e&&h.push(k)}h=this.filterByRoundTrip(h,d);if(""===a)return h.slice(0,b);for(e=0;e<h.length&&!(f=h[e],k=f.departShortName+" "+f.departAirportName.toUpperCase(),c||(k=f.destShortName+
" "+f.destAirportName.toUpperCase()),-1<this.matchWord(k.toUpperCase(),a.toUpperCase())&&(g.push(f),g.length>=b));e++);return this.filterByRoundTrip(g,d).slice(0,b)},filterByRoundTrip:function(a,c){if(null===a)return[];if(R9.config.getBoolean("ui.flight.smarty-history.separateRTOW",!1)){for(var b=[],d=0;d<a.length;d++){var e=a[d];e.isRoundTrip===c&&b.push(e)}return b}return a}});R9.extend("Common.SmartyHistory.SmartyHotelHistory.prototype",!0,R9.Common.SmartyHistory.prototype,{filter:function(a,c){c=
c||Infinity;var b=[];if(null===this.history)return[];if(""===a)return this.history.slice(0,c);for(var d=0;d<this.history.length;d++){var e=this.history[d],g=e.location.toUpperCase();if(-1<this.matchWord(g,a)&&(b.push(e),b.length>=c))break}return b.slice(0,c)}});R9.extend("Common.SmartyHistory.SmartyCarHistory.prototype",!0,R9.Common.SmartyHistory.prototype,{filter:function(a,c,b,d){b=b||Infinity;var e=[];if(null===this.history)return[];var g=this.filterByOneWay(this.history,d);if(""===a)return g.slice(0,
b);for(var h=0;h<g.length;h++){var f=g[h],k=null===f.airportCode?f.location.toUpperCase():f.location.toUpperCase()+" "+f.airportCode;!c&&f.location2&&(k=null===f.airportCode2?f.location2.toUpperCase():f.location2.toUpperCase()+" "+f.airportCode2);if(-1<this.matchWord(k,a)&&(e.push(f),e.length>=b))break}return this.filterByOneWay(e,d).slice(0,b)},filterByOneWay:function(a,c){if(null===a)return[];for(var b=[],d=0;d<a.length;d++){var e=a[d];e.oneWay===c&&b.push(e)}return b}})})(jq||jQuery);(function(b){R9.extend("Common",{SmartyControlGroup:function(a){this.options=b.extend({},this.options,a);null===this.options.startFormat&&(this.options.startFormat=R9.Widgets.DaterangePicker.prototype.options.startFormat);null===this.options.endFormat&&(this.options.endFormat=R9.Widgets.DaterangePicker.prototype.options.endFormat);this.init()}});R9.extend("Common.SmartyControlGroup.prototype",{options:{form:"",smartyHistory:null,smartyTopDestinations:null,daterangePicker:"",startDate:"",endDate:"",
datePicker:"",startFormat:null,endFormat:null,useLegacyDatePicker:null},type:"flight",getHistory:function(){return this.options.smartyHistory&&this.options.smartyHistory()},getTopDestinations:function(){return this.options.smartyTopDestinations&&this.options.smartyTopDestinations()},getTime:function(a){return null==a?null:a.getTime()},validateDate:function(a){return null==a?null:this.datepicker().utils?this.datepicker().utils.validate(new Date(a)):this.options.datePicker&&this.options.datePicker.validateDate(a)?
new Date(a):null},datepicker:function(){return b(this.options.daterangePicker).data("datepicker")}});R9.extend("Common.SmartyControlGroup",{SmartyFlightControlGroup:function(a){R9.Common.SmartyControlGroup.call(this,a)},SmartyHotelControlGroup:function(a){R9.Common.SmartyControlGroup.call(this,a)},SmartyCarControlGroup:function(a){R9.Common.SmartyControlGroup.call(this,a)}});R9.extend("Common.SmartyControlGroup.SmartyFlightControlGroup.prototype",!0,R9.Common.SmartyControlGroup.prototype,{options:b.extend(R9.Common.SmartyControlGroup.prototype.options,
{form:null,formObject:null,originInput:"",destInput:"",originCode:"",destCode:"",daterangePicker:"",cabin:null,travelers:"",nearbyDeparture:"",nearbyArrival:"",smartyObject:"",maxHistory:5,state:null,isRoundTrip:null}),init:function(){this.type="flight"},setFieldsFromHistoryItem:function(a,c){a.isRoundTrip?(R9.events.publish("flights.search.form.display.change",{value:"roundtrip"}),R9.events.publish("flights.search.form.display.set","roundtrip")):(R9.events.publish("flights.search.form.display.change",
{value:"oneway"}),R9.events.publish("flights.search.form.display.set","oneway"));c&&!R9.config.getBoolean("ui.smarty.previewUpdatesForm.enabled",!1)||null==this.options.formObject||this.options.formObject.updateTravelDateState(this.validateDate(a.startDate),this.validateDate(a.endDate));this.options.useLegacyDatePicker?(this.datepicker().setStartDate(this.validateDate(a.startDate)),this.datepicker().setEndDate(this.validateDate(a.endDate))):(this.startDate().setDate(a.startDate),this.endDate().setDate(a.endDate));
b(this.options.nearbyDeparture).prop("checked",a.departureAllowNearby);b(this.options.nearbyArrival).prop("checked",a.arrivalAllowNearby);this.setTravelersFromHistoryItem(a);c?(b(this.options.originInput).val(a.departAirportName),b(this.options.destInput).val(a.destAirportName),b(this.options.originCode).val(a.departCode),b(this.options.destCode).val(a.destCode)):this.options.airportMultiSelectEnabled?(this.options.originField.resetAirportMultiSelect(),this.isMultiAirportOrigin(a)?this.options.originField.addAirportMultiSelections(this.getAirportMultiSelections(a.departAirportName)):
this.options.originField.addAirportMultiSelection(a.departCode,a.departAirportName,a.depSmartyDisplay),this.options.destField.resetAirportMultiSelect(),this.isMultiAirportDestination(a)?this.options.destField.addAirportMultiSelections(this.getAirportMultiSelections(a.destAirportName)):this.options.destField.addAirportMultiSelection(a.destCode,a.destAirportName,a.dstSmartyDisplay)):(c={type:"ap",id:a.departCode,short_str:a.departAirportName},this.options.originInput.getWidget().setItem(c),a={type:"ap",
id:a.destCode,short_str:a.destAirportName},this.options.destInput.getWidget().setItem(a))},saveFieldsToHistoryItem:function(){var a={};a.departAirportName=b(this.options.originInput).val();a.destAirportName=b(this.options.destInput).val();a.departCode=b(this.options.originCode).val();a.destCode=b(this.options.destCode).val();this.options.useLegacyDatePicker?(a.startDate=this.getTime(this.datepicker().getStartDate()),a.endDate=this.getTime(this.datepicker().getEndDate())):(a.startDate=this.startDate().getValue(),
a.endDate=this.endDate().getValue());a.departureAllowNearby=b(this.options.nearbyDeparture).prop("checked");a.arrivalAllowNearby=b(this.options.nearbyArrival).prop("checked");this.options.travelers&&b(".Common-Widgets-Number-NumberBox, .Common-Widgets-Number-StyleJamNumberBox",this.options.travelers.elementNode).each(function(){var c=b(this).getWidget(),e=b(this).attr("id").split("-").pop().toLowerCase();a[e]=c.getValue()});this.options.cabin&&(a.cabin=this.options.cabin.getValue());a.isRoundTrip=
"function"===typeof this.options.isRoundTrip?this.options.isRoundTrip():this.options.isRoundTrip;return a},isRoundTrip:function(){return"function"===typeof this.options.isRoundTrip?this.options.isRoundTrip():"checked"===b("#roundtrip").attr("checked")?!0:0<b(".roundtrip").length?!0:0<b(".inlineSearchAgainView").length&&"y"!==b('[name\x3d"oneway"]',".inlineSearchAgainView").val()?!0:!1},setTravelersFromHistoryItem:function(a){if(this.options.cabin){this.options.cabin.setButtonCheckedByValue(a.cabin);
var c=this.options.cabin.getCheckedPair();this.options.state.cabinDisplayType=c.title;this.options.state.cabin=c.value}this.options.travelers&&b(".Common-Widgets-Number-NumberBox, .Common-Widgets-Number-StyleJamNumberBox",this.options.travelers.elementNode).each(function(){var c=b(this).getWidget(),d=b(this).attr("id").split("-").pop().toLowerCase(),d=a[d];void 0!=c&&c.setValue(d)})},datepicker:function(){return this.options.daterangePicker},startDate:function(){return this.options.startDate},endDate:function(){return this.options.endDate},
setSmarty:function(a){this.options.smartyObject=a},getMaxHistory:function(){return this.options.maxHistory},isMultiAirportOrigin:function(a){return null===a.departCode&&3===a.departAirportName.indexOf(",")},isMultiAirportDestination:function(a){return null===a.destCode&&3===a.destAirportName.indexOf(",")},getAirportMultiSelections:function(a){var b=[];a.split(",").forEach(function(a){b.push({code:a,display:a,description:a})});return b},statusMessage:{adults:"{0} adult",seniors:"{0} senior",children:"{0} child",
traveler_count:"1#1 traveler|2#{0} travelers"}});R9.extend("Common.SmartyControlGroup.SmartyHotelControlGroup.prototype",!0,R9.Common.SmartyControlGroup.prototype,{options:b.extend(R9.Common.SmartyControlGroup.prototype.options,{form:null,locationInput:"",ctid:"",lmid:"",hid:"",nhid:"",rooms:"",adults:"",children:"",guests:"",minStars:"",priceRange:"",rating:"",smartyObject:"",maxHistory:5}),init:function(){this.type="hotel"},setSmarty:function(a){this.options.smartyObject=a},validateDate:function(a){return null==
a?null:this.options.daterangePicker.utils?this.options.daterangePicker.utils.validate(new Date(a)):this.options.datePicker?this.options.datePicker.validateDate(a):null},getMaxHistory:function(){return this.options.maxHistory},setFieldsFromHistoryItem:function(a,c){this.options.useLegacyDatePicker?(this.options.daterangePicker.setStartDate(this.validateDate(a.checkinDate)),this.options.daterangePicker.setEndDate(this.validateDate(a.checkoutDate))):(this.options.startDate.setDate(a.checkinDate),this.options.endDate.setDate(a.checkoutDate));
this.options.rooms&&this.options.rooms.setValue(a.rooms);this.options.adults&&this.options.adults.setValue(a.adults);this.options.children&&this.options.children.setValue(a.children);this.options.minStars&&b(this.options.minStars).val(a.minStars);this.options.rating&&b(this.options.rating).val(Math.floor(a.rating/10));c?(b(this.options.locationInput).val(a.location),b(this.options.ctid).val(a.ctid),b(this.options.lmid).val(a.lmid),b(this.options.hid).val(a.hid),b(this.options.nhid).val(a.nhid),b(this.options.frid).val(a.frid),
b(this.options.rid).val(a.rid),b(this.options.cid).val(a.cid)):(a={id:a.ctid,str:a.location,lmid:a.lmid,hid:a.hid,nhid:a.nhid,frid:a.frid,rid:a.rid,cid:a.cid},this.options.locationInput.getWidget().setItem(a))},saveFieldsToHistoryItem:function(){var a={};a.location=b(this.options.locationInput).val();a.ctid=b(this.options.ctid).val();a.lmid=b(this.options.lmid).val();a.hid=b(this.options.hid).val();a.nhid=b(this.options.nhid).val();a.frid=b(this.options.frid).val();a.rid=b(this.options.rid).val();
a.cid=b(this.options.cid).val();this.options.useLegacyDatePicker?(a.checkinDate=this.getTime(this.options.daterangePicker.getStartDate()),a.checkoutDate=this.getTime(this.options.daterangePicker.getEndDate())):(a.checkinDate=this.options.startDate.getValue(),a.checkoutDate=this.options.endDate.getValue());this.options.rooms&&(a.rooms=this.options.rooms.getValue());this.options.adults&&(a.adults=this.options.adults.getValue());this.options.children&&(a.children=this.options.children.getValue());this.options.minStars&&
(a.minStars=b(this.options.minStars).val());this.options.rating&&(a.rating=Math.floor(10*b(this.options.rating).val()));return a}});R9.extend("Common.SmartyControlGroup.SmartyCarControlGroup.prototype",!0,R9.Common.SmartyControlGroup.prototype,{options:{form:null,location:"",location2:"",ctid1:"",ctid2:"",datePicker:"",pickupDate:"",dropoffDate:"",locationSmarty:null,location2Smarty:null},init:function(){this.type="car"},setLocationSmarty:function(a){this.options.locationSmarty=a},setLocation2Smarty:function(a){this.options.location2Smarty=
a},getMaxHistory:function(){return this.options.maxHistory},datepicker:function(){return this.options.datePicker},validateDate:function(a){return null==a?null:this.options.datePicker?this.options.datePicker.validateDate(a):null},isOneWay:function(){return"function"===typeof this.options.isOneWay?this.options.isOneWay():"true"==b(".formType.active").attr("data-oneway")?!0:0<b(".inlineSearchAgainView").length&&"y"===b('[name\x3d"oneway"]',".inlineSearchAgainView").val()?!0:!1},setFieldsFromHistoryItem:function(a,
c){this.options.pickupDate.setDate(a.startDate);this.options.dropoffDate.setDate(a.endDate);this.options.pickupDate.setTime(a.pickupHour);this.options.dropoffDate.setTime(a.dropoffHour);c?(a.airportName?b(this.options.location).val(a.airportDisplayName):b(this.options.location).val(a.location),a.airportName2?b(this.options.location2).val(a.airportDisplayName2):b(this.options.location2).val(a.location2),b(this.options.ctid1).val(a.cityCode),b(this.options.ctid2).val(a.cityCode2)):(this.options.locationSmarty.setItem({id:a.cityCode,
str:a.airportDisplayName||a.location}),a={id:a.cityCode2,str:a.airportDisplayName2||a.location2},null!=this.options.location2Smarty&&null!=a&&null!=a.str&&this.options.location2Smarty.setItem(a))},saveFieldsToHistoryItem:function(){var a={};a.location=b(this.options.location).val();a.location2=b(this.options.location2).val();a.cityCode=b(this.options.ctid1).val();a.cityCode2=b(this.options.ctid2).val();a.startDate=this.options.pickupDate.getValue();a.endDate=this.options.dropoffDate.getValue();a.pickupHour=
this.options.pickupDate.getTime();a.dropoffHour=this.options.dropoffDate.getTime();return a}})})(jq||jQuery);(function(b){R9.extend("Widgets.Smarty",{Smarty:function(a,c){this.elementNode=a;this.element=b(this.elementNode);this.validateElement()&&(this.options=b.extend({},this.options,c),this.init())}});R9.extend("Widgets.Smarty.Smarty",{isInput:function(a){return a&&a.nodeName&&"input"==a.nodeName.toLowerCase()},isWidgetControlled:function(a){return b(a).hasClass(R9.Widgets.Smarty.Smarty.prototype.widgetBaseClass+"-input")},getDropdownEl:function(a){return jq(a).find("#smartbox")},getDropdownId:function(a){return"smartbox"}});
R9.extend("Widgets.Smarty.Smarty.prototype",{widgetName:"smarty",widgetBaseClass:"r9-smarty",elementNode:null,element:null,dropdown:null,lastValue:null,lastRequestedValue:null,aria:!1,trimInputElements:"span.nearbyHotels, span.nearbyRentals, span.showRank",lastClickOnScrollbar:!1,keyTimeout:null,isHighlightKeyPressed:!1,isItemSet:!1,backgroundAutocomplete:null,trackInteraction:!1,trackSetItemDuplicate:!1,trackSetItemDuplicateTimeout:void 0,initialList:null,options:{minLength:0,appendTo:"body",dropdown:null,
fixedDropdown:!1,initialData:null,initialDataLoadWithCallback:null,searchOnFocus:!1,showDropdownWhenEmpty:!1,dataSource:null,dataSourceList:[],dataType:"text",minWidth:10,maxWidth:1024,noAutoWidth:!1,position:"left",dropdownClass:null,setItem:null,beforeStart:null,afterDone:null,dropdownListSelector:"ul li[class!\x3d'separator']",keyDelay:200,forceSelection:!1,makeHTML:null,translateItem:null,display:"inline",showBackgroundAutocomplete:!1,backgroundAutocompleteMinLength:3,getBackgroundAutocompletePositionProps:null,
delayShowDropdown:null,showDropdownDelay:200,enableRemoteHide:!1,zIndex:9999,continents:[],showContinents:!1,onInputValueChange:function(a){},forceSelectionOfHighlightedItem:!0,trackingType:"destination",simplifiedValueChange:!1,e2eTestMode:!1,isDialog:!1,autoSelectFirstOption:!0,windowDataTestTagName:null,windowDataTestTagValue:null,onHighlightedOptionChange:function(a,c){}},init:function(){var a=this;R9.config&&(this.options.zIndex=R9.config.getInt("ui.smarty.zIndex",9999),this.trackInteraction=
R9.config.getBoolean("ui.smarty.trackInteraction",!0),this.aria=R9.config.getBoolean("ui.smarty.aria",!0));this.initDropdown();R9.globals.browserCapabilities.scrollbarRetainsInputFocus&&"false"!==R9.globals.browserCapabilities.scrollbarRetainsInputFocus||this.trackScrollbarClick();this.bindInputEvent("focus",this.handleInputFocusEvent);this.bindInputEvent("blur",this.handleInputBlurEvent);this.bindInputEvent("keydown",this.handleInputKeydownEvent);this.bindInputEvent("textchange",this.handleInputChangeEvent);
b(window).on("scroll.smarty",function(){a.position()});b(window).resize(this.handleWindowResize.bind(a));this.element.attr({autocomplete:"off",autocapitalize:"off",autocorrect:"off"});this.aria&&this.element.attr({role:"combobox","aria-autocomplete":this.options.showBackgroundAutocomplete?"both":"list"});this.element.data(this.widgetName,this);this.element.is(":focus")&&this.element.focus();this.initBackgroundAutocomplete()},unInit:function(){this.unbindInputEvent("focus");this.unbindInputEvent("blur");
this.unbindInputEvent("keydown");this.unbindInputEvent("textchange");b(window).off("scroll.smarty");this.dropdown.off("mousedown.trackScrollbarClick");jq("body").off("click.trackScrollbarClick")},initDropdown:function(){var a=R9.Widgets.Smarty.Smarty.getDropdownEl(this.element),c=R9.Widgets.Smarty.Smarty.getDropdownId(this.element),b=jq(a)[0];null==b&&(a=R9.Widgets.Smarty.Smarty.prototype.widgetBaseClass,this.options.dropdownClass&&(a=a+" "+this.options.dropdownClass),c={id:c,css:{display:"none",
position:"absolute",width:"auto",zIndex:1E4},role:"dialog",tabindex:"0"},this.options.e2eTestMode&&this.options.windowDataTestTagName&&(c[this.options.windowDataTestTagName]=this.options.windowDataTestTagValue||""),b=jq("\x3cdiv\x3e\x3c/div\x3e",c).appendTo(this.options.appendTo)[0],jq(b).addClass(a));this.dropdown=jq(b)},validateElement:function(){return R9.Widgets.Smarty.Smarty.isInput(this.elementNode)&&R9.Widgets.Smarty.Smarty.isWidgetControlled(this.element)},trackScrollbarClick:function(){var a=
this;a.dropdown.on("mousedown.trackScrollbarClick",function(c){a.lastClickOnScrollbar=!0;c.stopPropagation();jq("body").trigger("event",[c])});jq("body").on("click.trackScrollbarClick",function(c){R9.Common.Utils.Browsers.isIE()&&a.lastClickOnScrollbar&&(a.lastClickOnScrollbar=!1,a.element.blur());a.lastClickOnScrollbar=!1})},bindInputEvent:function(a,c){var b=this;a+="."+this.widgetName;this.element.off(a).on(a,function(a){return c.call(b,this,a)})},unbindInputEvent:function(a){a+="."+this.widgetName;
this.element.off(a)},bindDropdownEvent:function(a,c){var b=this;this.dropdown.off(a,this.options.dropdownListSelector).on(a,this.options.dropdownListSelector,function(a){c.call(b,this,a)})},handleInputKeydownEvent:function(a,c){this.focusEventHandled=!1;var d=c.keyCode?c.keyCode:c.which;switch(d){case 38:return this.highlitePrevItem(),!1;case 40:return this.highliteNextItem(),!1;case 27:return!this.hideDropdown();case 13:return this.selectHighlightedItemWhenSearchCompleted(d,this.isDropdownHidden()&&
!b(a).val()&&!b(a).data("val-close"));case 9:this.canItemBeActivatedByTab()&&this.options.forceSelectionOfHighlightedItem&&this.selectHighlitedItem(d);this.hideDropdown();break;default:this.handleKeydownBeforeAutocomplete(a,c),this.abortSearchCompletedEventListeners()}},isItAnywhereItem:function(){var a=this.getItemList(),c=this.getHighlitedItemIndex();return(a=a[c])?"anywhere"===a.getAttribute("data-short-name"):!1},canItemBeActivatedByTab:function(){var a=this.getItemList(),c=this.getHighlitedItemIndex();
return(a=b(a[c]))?!(a.hasClass("signupnow")||a.hasClass("signup")||a.hasClass("showHistory")||a.hasClass("js-not-selectable")||"anywhere"===a.attr("data-short-name")):!1},handleInputChangeEvent:function(a,c){if(this.options.simplifiedValueChange)this.onInputChange(),this.handleInputValue();else if(this.focusEventHandled)this.focusEventHandled=!1;else if(!R9.Common.Utils.Browsers.isIE(10)&&!R9.Common.Utils.Browsers.isIE(11)||this.element.is(":focus")){this.abortKeyTimeout();this.abortRequest();this.onInputChange();
var b=this;this.keyTimeout=setTimeout(function(){b.keyTimeout=null;b.handleInputValue()},this.options.keyDelay)}},onInputChange:function(){this.isItemSet=!1;if(!this.options.simplifiedValueChange){var a=this.getHighlitedItem();a&&!this.itemMatches(a,this.element.val())&&this.removeItemHighlight();"function"===typeof this.options.clearItem&&this.options.clearItem(this);try{this.element&&(jq(this.element).removeClass("smarty-complete").addClass("smarty-incomplete"),R9.events.publish("smarty.setitem.incomplete",
{id:this.element.attr("id")}))}catch(c){}}},handleInputValue:function(){var a=this.element.val();this.options.onInputValueChange(a);this.trackFirstLetter(a);this.element.length&&0<a.length?(this.options.simplifiedValueChange||this.abortRequest(),this.runSearch(!0)):this.options.showDropdownWhenEmpty?(this.abortRequest(),this.showInitialDropdown()):(this.dropdown[0].innerHTML="",this.hideDropdown())},trackFirstLetter:function(a){if(R9.VestigoEvents&&"none"!==this.options.trackingType&&1===a.length){a=
this.getActiveFormTrackingData();var c="destination"===this.options.trackingType?R9.VestigoType.LocationType.destination:R9.VestigoType.LocationType.origin,b=this.loadPrefilledItem();R9.VestigoEvents.smarty.input(c,b?b.name:this.initalValue||this.initialCode,b?b.type:"",a.id)}},loadPrefilledItem:function(){this.initialList||(this.initialList=this.getItemList());var a=this.initialList&&this.initialList[0];return a&&this.translateItem(a)},handleInputFocusEvent:function(a,c){jq(a).trigger("smartyfocus");
var b=this;if(!b.lastClickOnScrollbar){var e=function(){b.checkAlive()&&setTimeout(e,250)};setTimeout(e,250);this.onBeforeStart(c);this.focusEventHandled=!0;this.runSearchOnFocus()&&(0!=this.element.val().length||this.runNoQuerySearch()?this.runSearch(!!c):null!==this.options.initialDataLoadWithCallback?this.options.initialDataLoadWithCallback(function(a){b.showInitialDropdownForData(a)}):this.showInitialDropdown())}},runSearchOnFocus:function(){return this.options.searchOnFocus},runNoQuerySearch:function(){return this.options.searchNoQuery},
onBeforeStart:function(a){"function"===typeof this.options.beforeStart&&this.options.beforeStart(this,a)},handleInputBlurEvent:function(a,b){this.focusEventHandled=!1;var c=this;setTimeout(function(){if(c.lastClickOnScrollbar)R9.Common.Utils.Browsers.isIE()||(c.element.focus(),c.lastClickOnScrollbar=!1);else{c.stopInputProcessing();if(c.hideDropdown()&&c.options.forceSelection)c.onForceSelection();c.onAfterDone()}},10)},stopInputProcessing:function(){this.isUpdateInProgress()&&(this.abortKeyTimeout(),
this.abortRequest(),this.removeItemHighlight())},isUpdateInProgress:function(){return this.keyTimeout||this.request},onForceSelection:function(){if(!this.isItemSet&&""!==this.element.val()){var a=this.getHighlitedItem();a&&this.selectItem(a,null)}},onAfterDone:function(){this.options.simplifiedValueChange&&!this.isItemSet&&this.options.clearItem&&this.options.clearItem(this);"function"===typeof this.options.afterDone&&this.options.afterDone(this)},handleItemMouseoverEvent:function(a,c){this.getItemList().removeClass("selected");
jq(a).not(".js-not-selectable").addClass("selected")},handleItemMouseoutEvent:function(a,c){jq(a).removeClass("selected")},handleItemMousedownEvent:function(a,c){c.stopPropagation();jq("body").trigger("event",[c]);this.selectItem(a,null);this.hideDropdown()},selectHighlitedItem:function(a,c){var b=this.getItemList();b?(c=this.getHighlitedItemIndex(c&&13===a),0>c?13===a&&this.noItemToSelect():(b=b[c])&&this.selectItem(b,a)):13===a&&this.noItemToSelect()},selectHighlightedItemWhenSearchCompleted:function(a,
c){var b=this;if(this.isItemSet&&!this.isHighlightKeyPressed){if(this.isDropdownHidden()&&13===a)return!0;this.hideDropdown();return!1}this.selectHighlitedItem(a,c);this.hideDropdown(!this.isItemSet);if(this.isItemSet)return!1;this.element.one("searchCompleted",function(){b.selectHighlitedItem(a,c);b.hideDropdown()});return!1},noItemToSelect:function(){},selectItem:function(a,b){a=this.translateItem(a);this.setItem(a,b)},translateItem:function(a){return"function"===typeof this.options.translateItem?
this.options.translateItem(a):a},setItem:function(a,b){if(this.element)try{jq(this.element).toggleClass("smarty-complete",!!a).toggleClass("smarty-incomplete",!a),R9.events.publish(a?"smarty.setitem.complete":"smarty.setitem.incomplete",{id:this.element.attr("id")}),a&&this.trackInteraction&&this.trackSetItem(a)}catch(d){}"function"===typeof this.options.setItem?(this.isItemSet=!0,this.options.setItem(this,a,b)):a?(this.isItemSet=!0,this.element.val(jq(a).text())):(this.isItemSet=!1,this.element.val(""))},
trackSetItem:function(a){if(R9.VestigoEvents&&"none"!==this.options.trackingType){var b=this;if(this.trackSetItemDuplicate)clearTimeout(this.trackSetItemDuplicateTimeout),this.trackSetItemDuplicateTimeout=setTimeout(function(){b.trackSetItemDuplicate=!1},200);else{this.trackSetItemDuplicate=!0;this.trackSetItemDuplicateTimeout=setTimeout(function(){b.trackSetItemDuplicate=!1},200);var d=this.getHighlitedItemIndex(),e=void 0;"hotel"===a.type?e=a.hid:"rest"===a.type?e=a.rtid:"freereg"===a.type?e=a.frid:
"reg"===a.type?e=a.rid:"ctry"===a.type?e=a.cid:"ctgroup"===a.type?e=a.cgid:"hood"===a.type?e=a.nhid:"lm"===a.type&&(e=a.lmid);"addr"===a.type?e=void 0:void 0===e&&(e=a.apicode||a.id);this.element.attr("id");var f=this.element.val(),d=-1<d?d+1:d;a=this.isItAnywhereItem()?"anywhere":a.type;var g=!!this.isNearbyChecked,h=this.getActiveFormTrackingData();"destination"===this.options.trackingType?R9.VestigoEvents.smarty.destination(f,d,a,e,g,h.id,h.type):R9.VestigoEvents.smarty.origin(f,d,a,e,g,h.id,h.type)}}},
showInitialDropdown:function(){this.showInitialDropdownForData(this.onInitialData())},showInitialDropdownForData:function(a){a&&this.searchCompleted(a,!1)},onInitialData:function(){return"function"===typeof this.options.initialData?this.options.initialData(this):this.options.initialData},runSearch:function(a){var b=this.element.val(),d=this.options.simplifiedValueChange?this.lastRequestedValue===b:this.lastValue===b;if(!(b.length<this.options.minLength||d)){d=this.getRequestData();d=this.preprocessRequest(d);
this.options.e2eTestMode&&this.element.attr("data-request-pending","");this.options.simplifiedValueChange&&(this.lastRequestedValue=b,this.abortRequest());var e=this,f=function(c){e.request=null;e.lastValue=b;c=e.postprocessResponse(c,a);e.searchCompleted(c,a);e.options.e2eTestMode&&e.element.removeAttr("data-request-pending")};if("function"===typeof this.options.dataSource)this.options.dataSource(d,f,this,a);else if(R9.config.getBoolean("ui.common.smarty.get.enabled",!1)){var g=this.getDataSource();
d.cv=R9.config.getString("ui.common.smarty.get.version","1");this.request=jq.ajax({type:"GET",url:g,data:d,dataType:this.options.dataType,cache:!0,success:f,error:function(){e.lastRequestedValue=null}})}else this.request=jq.post(this.getDataSource(),d,f,this.options.dataType)}},getDataSource:function(){return this.options.dataSource},preprocessRequest:function(a){return a},getRequestData:function(){return{value:this.element.val(),formtoken:R9.globals.formtoken}},searchCompleted:function(a,b){(a=this.canShowDropdown(a))?
this.showDropdown(a,b):(this.dropdown[0].innerHTML="",this.hideDropdown());this.element.trigger("searchCompleted",!!a)},canShowDropdown:function(a){return a},abortSearchCompletedEventListeners:function(){this.element.off("searchCompleted")},postprocessResponse:function(a,b){return a},makeHTML:function(a){return"function"===typeof this.options.makeHTML?this.options.makeHTML(a):a},showDropdown:function(a,b){if("function"===typeof this.options.delayShowDropdown&&this.options.delayShowDropdown()&&!this.showDropdownTimeout)this.showDropdownTimeout=
setTimeout(this.showDropdown.bind(this,a,b),this.options.showDropdownDelay);else{null!==this.showDropdownTimeout&&(clearTimeout(this.showDropdownTimeout),this.showDropdownTimeout=null);b=this.dropdown[0].style;var c=this.makeHTML(a);this.dropdown[0].innerHTML=c;c=R9.Widgets.Smarty.Smarty.prototype.widgetBaseClass;this.options.dropdownClass&&(c=c+" "+this.options.dropdownClass);this.dropdown.attr("class",c);a.length?this.dropdown.removeClass("empty"):this.dropdown.addClass("empty");this.position();
this.aria&&(this.element.attr({"aria-expanded":!0}),this.dropdown.find("ul").attr("role","listbox"),this.dropdown.find("li").not(".js-not-option").attr("role","option"));b.visibility="visible";b.display=this.options.display;jq.fn.zIndex&&(b.zIndex=jq(this.element).zIndex()+this.options.zIndex);this.bindDropdownEvent("mousedown",this.handleItemMousedownEvent);this.bindDropdownEvent("mouseover",this.handleItemMouseoverEvent);this.bindDropdownEvent("mouseout",this.handleItemMouseoutEvent);this.removeItemHighlight();
""!==this.element.val()&&this.highlightFirstSelectableItem()}},position:function(){this.dropdown.removeClass("up");var a=this.dropdown[0].style,b=0;this.dropdown.parent()[0]===jq(document.body)[0]&&(b=parseInt((jq(document.body).css("top")||"0").replace("-",""))||0);this.dropdown.css("width","auto");var d=this.dropdown.outerWidth(!0),e=!1;this.options.minWidth&&d<=this.options.minWidth&&(d=Math.max(this.options.minWidth,d),e=!0);this.options.maxWidth&&d>=this.options.maxWidth&&(d=Math.min(this.options.maxWidth,
d),e=!0);a.width=e||this.options.noAutoWidth?d+"px":"auto";var e=this.element.offset(),f=jq(this.options.appendTo).offset(),g=e.left-f.left;"right"===this.options.position&&(g+=this.element.width()-d-2);a.left=g+"px";a.top=b+e.top+this.element.outerHeight()-f.top+"px"},isDropdownHidden:function(){return"none"==this.dropdown.css("display")||"hidden"==this.dropdown.css("visibility")},hideDropdown:function(a){a||(this.abortKeyTimeout(),this.abortRequest());this.isHighlightKeyPressed=!1;this.lastRequestedValue=
this.lastValue=null;if(this.isDropdownHidden()&&!this.options.isDialog)return!1;this.dropdown.hide();this.aria&&this.element.attr({"aria-expanded":!1});this.setBackgroundAutocomplete();return!0},abortRequest:function(){if(this.request){try{this.request.abort()}catch(a){}this.request=null}},abortKeyTimeout:function(){this.keyTimeout&&(clearTimeout(this.keyTimeout),this.keyTimeout=null)},highliteNextItem:function(){var a=this.getItemList(),b=nsel=this.getHighlitedItemIndex();-1==b?nsel=0:b<a.length-
1&&(nsel=b+1);b!=nsel&&(jq(a[b]).removeClass("selected"),jq(a[b]).trigger("mouseout"),jq(a[nsel]).addClass("selected"),jq(a[nsel]).trigger("mouseover"),this.isHighlightKeyPressed=!0,this.setBackgroundAutocomplete(a[nsel]),this.options.onHighlightedOptionChange(jq(a[nsel]),jq(a[b])))},highlitePrevItem:function(){var a=this.getItemList(),b=nsel=this.getHighlitedItemIndex();-1==b?nsel=0:0<b&&(nsel=b-1);b!=nsel&&(jq(a[b]).removeClass("selected"),jq(a[b]).trigger("mouseout"),jq(a[nsel]).addClass("selected"),
jq(a[nsel]).trigger("mouseover"),this.isHighlightKeyPressed=!0,this.setBackgroundAutocomplete(a[nsel]),this.options.onHighlightedOptionChange(jq(a[nsel]),jq(a[b])))},highlightFirstSelectableItem:function(){for(var a=this.getItemList(),b=0;b<a.length;b++){var d=jq(a[b]);if(!(d.hasClass("hist")||d.hasClass("js-not-selectable")||d.hasClass("js-nearby-select-all"))){d.addClass("selected");this.setBackgroundAutocomplete(a[b]);return}}jq(a[0]).addClass("selected");this.setBackgroundAutocomplete(a[0])},
removeItemHighlight:function(){jq(this.getItemList()).removeClass("selected")},getHighlitedItemIndex:function(a){for(var b=this.getItemList(),d=b.length,e=0;e<d;e++)if(jq(b[e]).hasClass("selected"))return e;return!a&&R9.config.getBoolean("ui.smarty.auto.select.1st",!1)&&this.options.autoSelectFirstOption&&0<d?0:-1},getHighlitedItem:function(){for(var a=this.getItemList(),b=a.length,d=0;d<b;d++)if(jq(a[d]).hasClass("selected"))return a[d];return R9.config.getBoolean("ui.smarty.auto.select.1st",!1)&&
0<b?a[0]:null},getItemList:function(){return this.dropdown.find(this.options.dropdownListSelector)},itemMatches:function(a,b){return a?0<=jq(a).text().toLowerCase().indexOf(b.toLowerCase()):!1},checkAlive:function(){return this.element.closest("html").length?this.element.is(":visible")?!0:(this.hideDropdown(),!1):(this.hideDropdown(),this.unInit(),!1)},initBackgroundAutocomplete:function(){!this.backgroundAutocomplete&&this.options.showBackgroundAutocomplete&&(this.options.backgroundAutocompleteMinLength=
R9.config.getInt("ui.common.smarty.background.autocomplete.min.length",3),this.backgroundAutocomplete=jq("\x3cinput/\x3e",{id:this.element.attr("id")+"-bg-autocomplete","class":this.element.attr("class"),type:"text",tabindex:"-1"}).insertBefore(this.element),this.updateBackgroundAutocompletePosition(),this.backgroundAutocomplete.css("color",this.element.css("color").replace(")",", 0.27)").replace("rgb","rgba")),this.backgroundAutocomplete.addClass("smarty-bg-autocomplete"),this.element.addClass("smarty-with-bg-autocomplete"))},
updateBackgroundAutocompletePosition:function(){if(this.options.showBackgroundAutocomplete)if("function"===typeof this.options.getBackgroundAutocompletePositionProps)this.backgroundAutocomplete.css(this.options.getBackgroundAutocompletePositionProps());else{var a=this.element.is(":visible")?this.element.outerHeight():this.element.height();this.backgroundAutocomplete.css({"margin-bottom":"-"+a+"px"})}},handleKeydownBeforeAutocomplete:function(a,b){if(this.options.showBackgroundAutocomplete){var c=
this;setTimeout(function(){var a=c.backgroundAutocomplete.val(),b=c.element.val();b.length>=c.options.backgroundAutocompleteMinLength&&b.length<a.length&&!c.isDropdownHidden()?c.backgroundAutocomplete.val(b+a.substr(b.length)):c.backgroundAutocomplete.val("")},1)}},setBackgroundAutocomplete:function(a){if(this.options.showBackgroundAutocomplete){var b=this.element.val();if(a&&b.length>=this.options.backgroundAutocompleteMinLength){var d=this.getBackgroundAutocompleteText(a);if(0<d.length){a=d.toUpperCase().indexOf(b.toUpperCase());
this.backgroundAutocomplete.val(-1===a?"":b+d.substr(a+b.length));return}}this.backgroundAutocomplete.val("")}this.aria&&a&&a.attributes.id&&(b=jq(a).find(this.trimInputElements).filter(function(){return jq(this).is(":visible")}),0<b.length&&(d=jq(a).clone(),d.find(this.trimInputElements).remove(),jq(a).attr("aria-label",d.text()+" "+b.text())),this.element.attr({"aria-activedescendant":a.attributes.id.value}))},getBackgroundAutocompleteText:function(a){a=this.translateItem(a);return"string"===typeof a.str?
a.str:""},handleWindowResize:function(){this.updateBackgroundAutocompletePosition()},getActiveFormTrackingData:function(){if(R9&&R9.question&&R9.VestigoType){var a=R9.question.ask("base.search.SearchForm.id")||"";return{id:a,type:a?R9.VestigoType.SearchFormType[R9.question.ask("base.search.SearchForm.type."+a)]:""}}return{}}})})(jq||jQuery);R9.extend("Widgets.Smarty",{FlareSmarty:function(b,a){R9.Widgets.Smarty.Smarty.call(this,b,jq.extend({dataSource:"/mv/marvel"},a));var c=this;jq(".mapViewOuter .filterWrapper").scroll(function(){R9.Widgets.Smarty.Smarty.prototype.handleInputBlurEvent.call(c)})}});
R9.extend("Widgets.Smarty.FlareSmarty",!0,{setRunSearchNextFocus:function(b){R9.Widgets.Smarty.FlareSmarty.runSearchNextFocus=b},runSearchNextFocus:!0});
R9.extend("Widgets.Smarty.FlareSmarty.prototype",!0,R9.Widgets.Smarty.Smarty.prototype,{translateItem:function(b){if(!b)return null;var a=jq(b).clone()[0];b=a.id.split("-");var c="";1<b.length&&0>b[1].indexOf(" ")&&(c=b[1]);jq(a).find("span.airportCode, span.region-label, span.nearbyHotels, span.nearbyRentals, span.smarty-emoji, span.smarty-label, span.smarty-popular, span.smarty-city-popular, span.smarty-air-popular, span.showRank").remove();var d=jq(a).attr("data-text-to-select"),d=d&&0<jq.trim(d).length?
d:jq(a).text(),c={type:b[0],id:c,str:d,name:d,short_str:jq(a).attr("data-short-name"),cc:jq(a).attr("data-cc")||"",apicode:a.getAttribute("data-apicode")};c.apicode&&"a"===c.apicode.slice(-1)&&(c.iatadisplay=a.getAttribute("data-iatadisplay"));"isl"===c.type&&1<b.length&&(d=b[1].split("/"),c.str=d[0]);"addr"===c.type&&(a=a.getAttribute("data-ctid"))&&(c.id=a);2<b.length&&(c.hc=b[2]);3<b.length&&("hotel"===c.type?c.hid=b[3]:"rest"===c.type?c.rtid=b[3]:"freereg"===c.type?c.frid=b[3]:"reg"===c.type?
c.rid=b[3]:"ctry"===c.type?c.cid=b[3]:"ctgroup"===c.type?c.cgid=b[3]:"hood"===c.type?c.nhid=b[3]:c.lmid=b[3]);return c},preprocessRequest:function(b){var a={};this.options.extendRequest&&(a="function"===typeof this.options.extendRequest?this.options.extendRequest(this,b):this.options.extendRequest);var c={};this.options.v&&(c.v=this.options.v);c.f="h";this.options.f&&(c.f=this.options.f);c.where=b.value;c.s=this.getFlareSmartyType()||-1;c.lc_cc=R9.globals.locale.lc_cc;c.lc=R9.globals.locale.lc;return jq.extend(c,
a)},runSearchOnFocus:function(){var b=R9.Widgets.Smarty.FlareSmarty.runSearchNextFocus;R9.Widgets.Smarty.FlareSmarty.runSearchNextFocus=!0;return R9.Widgets.Smarty.Smarty.prototype.runSearchOnFocus.call(this)&&b},onInitialData:function(){var b=this.generateTopDestinations()||R9.Widgets.Smarty.Smarty.prototype.onInitialData.call(this)||this.makeRecentList(null,!0),a=this.generateAnywhereMarkup(),c=this.generateContinentsMarkup(),d;if(b)return d=this.generateLoginBar(b||a),this.placeAnywhereMarkup(b,
(a?a:"")+d);b=[];this.appendToInitialData(b);d=0<b.length;d=this.generateLoginBar(a||d);a&&b.push(a);c&&b.push(c);this.options.smartyControlGroup&&R9.globals.canLogin&&"undefined"!==typeof d&&b.push(d);return b.length?"\x3cul\x3e"+b.join("")+"\x3c/ul\x3e":""},appendToInitialData:function(b){},generateTopDestinations:function(){if(this.options.smartyControlGroup){var b=this.options.smartyControlGroup.getTopDestinations();if(b){var a=b.getItems(),c=b.getMaxItems();return(b=a&&a.filter(function(a,b){return b<
c}).map(this.createTopDestinationItem.bind(this)).join(""))&&""!==b?"\x3cul\x3e"+b+"\x3c/ul\x3e":null}}},createTopDestinationItem:function(b){return""},generateAnywhereMarkup:function(b){},generateContinentsMarkup:function(){},placeAnywhereMarkup:function(b,a){return b?R9.config.getBoolean("ui.smarty.anywhereFirst",!1)?b.replace("\x3cul\x3e","\x3cul\x3e"+a):b.replace("\x3c/ul\x3e",a+"\x3c/ul\x3e"):b},placeContinentsMarkup:function(b,a){return b?b.replace("\x3c/ul\x3e",a+"\x3c/ul\x3e"):b},postprocessResponse:function(b,
a){var c=b&&/<li/i.test(b),d=this.makeRecentList(a?this.element.val().toUpperCase():null,!c),e=this.generateOtherMarkup(c);a=this.generateAnywhereMarkup(c);var f=this.generateContinentsMarkup();if(!d&&!c&&!a)return null;if(!c)return b=d?d:"\x3cul\x3e\x3c/ul\x3e",b=e?b.replace("\x3c/ul\x3e",e+"\x3c/ul\x3e"):b,b=this.placeAnywhereMarkup(b,a?a:""),b=this.placeContinentsMarkup(b,f),b+this.generateLoginBar(!1);b=e?b.replace("\x3c/ul\x3e",e+"\x3c/ul\x3e"):b;b=this.placeAnywhereMarkup(b,a?a:"");d&&(b=b.replace("\x3c/ul\x3e",
d+"\x3c/ul\x3e"));return b.replace("\x3c/ul\x3e",this.generateLoginBar(!0)+"\x3c/ul\x3e")},generateOtherMarkup:function(b){return null},selectItem:function(b,a){jq(b).hasClass("hist")&&this.options.smartyControlGroup?(b=jq(b).data("history-idx"),b=this.options.smartyControlGroup.getHistory().history[b],this.options.smartyControlGroup.setFieldsFromHistoryItem(b,!1),"undefined"!==typeof this.tempState&&delete this.tempState,R9.Analytics.api.trackEvent("smartyHistory/click/historyItem"),this.trackRecentLocation(b)):
jq(b).hasClass("showHistory")?(window.location.assign("/history"),R9.Analytics.api.trackEvent("smartyHistory/click/seeAllHistory")):jq(b).hasClass("signup")?(AjaxReg.ui.register({promoType:"smarty"}),R9.Analytics.api.trackEvent("smartyHistory/click/signUp")):jq(b).hasClass("signupnow")?(R9.config.getBoolean("ui.login.staticSignUp")?R9.authentication.showDefault({promoType:"smarty"}):R9.authentication.showSignup(),R9.Analytics.api.trackEvent("smartyHistory/click/signUp"),R9.events.publish("smarty.setitem.complete",
{id:this.element.attr("id")})):(b=this.translateItem(b),this.setItem(b,a))},trackRecentLocation:function(b){if(this.trackInteraction&&R9.Vestigo&&R9.VestigoType&&b){var a=R9.question.ask("base.search.SearchForm.id")||"",c=b.isRoundTrip?R9.VestigoType.SearchFormType.RT:R9.VestigoType.SearchFormType.OW;b.dstSearchFormPrimary&&R9.VestigoEvents.smarty.destination(b.dstSearchFormPrimary,"","ap",b.destShortName,b.arrivalAllowNearby,a,c,"recentsearches");b.depSearchFormPrimary&&R9.VestigoEvents.smarty.origin(b.depSearchFormPrimary,
"","ap",b.departShortName,b.departureAllowNearby,a,c,"recentsearches")}},makeRecentList:function(b,a){var c=this.options.recentList,d=null;if(c&&0<c.length){for(var d="",e=0;e<c.length;e++)if(!b||-1!=c[e].display.toUpperCase().indexOf(b)){var f=c[e].display;b&&(f=this.highliteText(f,b));d+="\x3cli id\x3d'"+c[e].code+"' class\x3d'"+c[e].className+"' data-short-name\x3d'"+c[e].shortName+"'\x3e"+f+"\x3c/li\x3e"}d=""!=d?(a?"\x3cul\x3e":"")+"\x3cli class\x3d'separator'\x3e\x3cb\x3eRecently searched:\x3c/b\x3e\x3c/li\x3e"+
d+(a?"\x3c/ul\x3e":""):null}return d},highliteText:function(b,a){a&&(a=a.replace(/[-[\]{}()*+?.,\\^$|#\s]/g,"\\$\x26"),b=b.replace(new RegExp("("+a+")","ig"),"\x3cb\x3e$1\x3c/b\x3e"));return b},getFlareSmartyType:function(){return this.options.flareSmartyType},setFlareSmartyType:function(b){this.options.flareSmartyType=b},matchAndBold:function(b,a,c,d){if(!b||!a)return a;c=c||"\x3cb\x3e";d=d||"\x3c/b\x3e";var e=0,f=0,g="",h=a,k=b.length;for(b=b.toUpperCase();;){if(0!==e||0!==(f=a.toUpperCase().indexOf(b,
e)))if(-1<(f=a.toUpperCase().indexOf(" "+b,e)))f++;else break;e=a.substring(e,f);h=a.substring(f,f+k);g+=e+c+h+d;h=a.substring(f+k,a.length);e=f+k}return g+h},handleItemMouseoverEvent:function(b,a){this.getItemList().removeClass("selected");jq(b).addClass("selected");!this.isDisabledHistoryPreview()&&jq(b).hasClass("hist")&&this.options.smartyControlGroup&&"undefined"===typeof this.tempState&&(this.tempState=this.options.smartyControlGroup.saveFieldsToHistoryItem(),b=jq(b).data("history-idx"),a=this.options.smartyControlGroup.getHistory(),
this.options.smartyControlGroup.setFieldsFromHistoryItem(a.history[b],!0))},handleItemMouseoutEvent:function(b,a){jq(b).removeClass("selected");this.isDisabledHistoryPreview()||"undefined"===typeof this.tempState||(this.options.smartyControlGroup.setFieldsFromHistoryItem(this.tempState,!0),delete this.tempState)},isDisabledHistoryPreview:function(){return!1},generateLoginBar:function(b){if(!this.options.smartyControlGroup||!R9.globals.canLogin)return"";var a="admin";b&&(a+=" addSeparation");return"undefined"!==
typeof R9Anon&&R9Anon?"\x3cli class\x3d'signup "+a+"'\x3eSign up to access recent searches anywhere\x3c/li\x3e":"\x3cli class\x3d'showHistory "+a+"'\x3e See all search history\x3c/li\x3e"},generateRecentHeader:function(){R9.Common.SmartyHistory.currentSmarty=this;R9.Common.SmartyHistory.currentSmartyHistory=this.options.smartyControlGroup.getHistory();this.hasClearRecentEvent||(this.hasClearRecentEvent=!0,this.dropdown.on("click","ul li.searchHistorySeparator",function(b){b.stopPropagation();b.stopImmediatePropagation()}),
this.dropdown.on("mousedown","ul li .clearRecent",function(b){b.stopPropagation();jq("body").trigger("event",[b]);R9.Common.SmartyHistory.SmartyClearHistory()}));return"\x3cli class\x3d'separator searchHistorySeparator'\x3e\x3cspan class\x3d'separatorLabel'\x3eRecent Searches\x3c/span\x3e\x3ca class\x3d'clearRecent'\x3eclear\x3c/a\x3e\x3c/li\x3e"}});
(function(b,a){b.createWidgetClass("smarty.SmartyBaseLoader",a.extend({},b.Widgets.Smarty.Smarty.prototype));b.createWidgetClass("smarty.FlareSmartyBaseLoader","common.widgets.smarty.Smarty",a.extend({},b.Widgets.Smarty.FlareSmarty.prototype,{constructor:function(c,d){this.base(c,a.extend({},b.Widgets.Smarty.FlareSmarty.prototype.options,d))}}))})(window.R9,window.jq||window.jQuery);(function(e,f){e.createWidgetClass("smarty.Smarty","common.widgets.smarty.SmartyBaseLoader",{loggingPrefix:"smarty",setItemTriggered:!1,focusEventHandled:!1,updateDropdownTop:!0,options:{flippable:!0,direction:"down",repositionDropdownOnResize:e.config.getBoolean("ui.smarty.repositionDropdownOnResize",!0),alternateSmartyInputElement:null,mcFlyInline:!1,messages:{SMARTY_HOTELS_NEAR_CITY:"",SMARTY_RENTALS_NEAR_CITY:"",SMARTY_LOCATION_TYPE_HOTEL:"",SMARTY_LOCATION_TYPE_AIRPORT:"",SMARTY_LOCATION_TYPE_NEIGHBORHOOD:"",
SMARTY_LOCATION_TYPE_CITY:"",SMARTY_LOCATION_TYPE_LANDMARK:"",SMARTY_LOCATION_TYPE_COUNTRY:"",SMARTY_LOCATION_TYPE_COUNTRY_GROUP:"",SMARTY_LOCATION_TYPE_REGION:"",SMARTY_LOCATION_TYPE_FREE_REGION:"",SMARTY_LOCATION_TYPE_RAIL:"",SMARTY_LOCATION_TYPE_RESTAURANT:"",SMARTY_LOCATION_TYPE_AIRLINE:"",SMARTY_LOCATION_TYPE_BRAND:"",SMARTY_LOCATION_TYPE_BRAND_GROUP:"",SMARTY_LOCATION_TYPE_AIRPORT_NEAR_CITY:"",SMARTY_LOCATION_TYPE_PLACE:"",SMARTY_LOCATION_TYPE_POI:"",SMARTY_LOCATION_TYPE_WORLD:"",SMARTY_CONTINENTS_LABEL:"",
SMARTY_NEARBY_DISTANCE_FROM:"",SMARTY_NEARBY_DISPLAY:"",SMARTY_NO_RECENT_SEARCHES:""}},locationTypeMessages:{},constructor:function(a,b){this.base(a,b);this.applyJsonOptions();this.locationTypeMessages={ap:this.options.messages.SMARTY_LOCATION_TYPE_AIRPORT,hood:this.options.messages.SMARTY_LOCATION_TYPE_NEIGHBORHOOD,lm:this.options.messages.SMARTY_LOCATION_TYPE_LANDMARK,ctry:this.options.messages.SMARTY_LOCATION_TYPE_COUNTRY,cg:this.options.messages.SMARTY_LOCATION_TYPE_REGION,ctgroup:this.options.messages.SMARTY_LOCATION_TYPE_REGION,
reg:this.options.messages.SMARTY_LOCATION_TYPE_REGION,subreg:this.options.messages.SMARTY_LOCATION_TYPE_REGION,freereg:this.options.messages.SMARTY_LOCATION_TYPE_FREE_REGION,city:this.options.messages.SMARTY_LOCATION_TYPE_CITY,hotel:this.options.messages.SMARTY_LOCATION_TYPE_HOTEL,rail:this.options.messages.SMARTY_LOCATION_TYPE_RAIL,rest:this.options.messages.SMARTY_LOCATION_TYPE_RESTAURANT,addr:this.options.messages.SMARTY_LOCATION_TYPE_PLACE}},init:function(){this.options.zIndex=e.config.getInt("ui.smarty.zIndex",
9999);this.options.simplifiedValueChange=e.config.getBoolean("ui.smarty.simplifiedValueChange",!0);this.options.e2eTestMode=e.globals.testMode;this.aria=e.config.getBoolean("ui.smarty.aria",!0);this.trackInteraction=e.config.getBoolean("ui.smarty.trackInteraction",!0);this.dropdown=this.options.dropdown;this.initSmartyDropdown();this.element.attr("smarty",!0);!0===this.options.enableRemoteHide&&this.id()&&e.events.subscribe("Smarty.hide",f.proxy(this.hideSmartyById,this));this.subscribe("Smarty.change.style",
this.changeSmartyStyle.bind(this))},changeSmartyStyle:function(a){var b=this.dropdown[0].id;b.includes(a.id)&&(this.updateDropdownTop=a.updateDropdownTop,b.includes("origin")?this.dropdown.css(a.originCss):b.includes("destination")?this.dropdown.css(a.destinationCss):b.includes("location")&&this.dropdown.css(a.locationCss))},hideSmartyById:function(a){this.id()!==a&&this.hideDropdown(!1)},inlineComponentsReady:function(){var a=this;setTimeout(function(){a.element.attr({autocomplete:"off",autocapitalize:"off",
autocorrect:"off"});a.aria&&a.element.attr({role:"combobox","aria-autocomplete":a.options.showBackgroundAutocomplete?"both":"list"});a.element.is(":focus")?a.element.focus():a.element.attr("autofocus")&&a.element.focus();a.options.showBackgroundAutocomplete&&(a.options.getBackgroundAutocompletePositionProps=function(){return{"margin-bottom":"-"+a.element.outerHeight(!0)+"px"}});a.initBackgroundAutocomplete();a.initialVal=a.element.val();a.initialCode=a.element.next(".aircode").val();""!==a.initialVal&&
(a.isItemSet=!0)},1)},concatExtraDropdownClasses:function(a,b){if(f.isArray(a)&&b)for(var c=0;c<a.length;c++)a[c]&&a[c].dropdownClass&&(a[c].dropdownClass+=b)},extraIconClasses:function(a){return a?" "+e.config.getString("ui.smarty.iconClasses","greyIcons")+" ":""},extraLabelClasses:function(){return e.config.getBoolean("ui.smarty.labels",!1)&&this.options.extendRequest&&"v2"===this.options.extendRequest.v?e.config.getString("ui.smarty.labelsClasses","greyLabels"):""},addEventHandlers:function(){this.bindInputEvent("keydown",
this.handleInputKeydownEvent);this.addDelegateEventHandlers()},addDelegateEventHandlers:e.Common.Utils.limit(1,function(){this.bindDelegateInputEvent("focus",this.handleInputFocusEvent);this.bindDelegateInputEvent("mousedown touchstart",this.handleInputFocusEvent);this.bindDelegateInputEvent("blur",this.handleSmartyInputBlurEvent);this.bindDelegateInputEvent("keyup",this.handleInputKeyUp);this.options.simplifiedValueChange||this.bindDelegateInputEvent("textchange",this.handleInputChangeEvent)}),bindDelegateInputEvent:function(a,
b){f("body").off(a,'input[smarty\x3d"true"]').on(a,'input[smarty\x3d"true"]',function(a){var c=f(this).getWidget();return c?b.call(c,a):!1})},initDropdown:function(){this.initSmartyDropdown()},initSmartyDropdown:function(){if(!this.dropdown){var a={id:this.id("smartbox-dropdown"),css:{display:"none",position:"absolute",width:"auto"},role:"dialog",tabindex:"0"};this.options.e2eTestMode&&this.options.windowDataTestTagName&&(a[this.options.windowDataTestTagName]=this.options.windowDataTestTagValue||
"");var b=this.widgetBaseClass||"";this.options.dropdownClass&&(b=b+" "+this.options.dropdownClass);this.dropdown=f("\x3cdiv\x3e\x3c/div\x3e",a).addClass(b);this.dropdown.addClass("R9-Overlay");this.dropdown.addClass(this.extraIconClasses());this.dropdown.addClass(this.extraLabelClasses())}},setDropdownContent:function(a){this.dropdown[0].innerHTML=a},setDropdownPosition:function(){var a=this.widgetBaseClass;this.options.dropdownClass&&(a=a+" "+this.options.dropdownClass);a=a+" "+this.extraIconClasses()+
" "+this.extraLabelClasses();this.dropdown.attr("class",a);var a=this.dropdown[0].style,b=this.dropdown.outerWidth(!0),c=!1;this.options.minWidth&&b<this.options.minWidth&&(b=Math.max(this.options.minWidth,b),c=!0);this.options.maxWidth&&b>this.options.maxWidth&&(b=Math.min(this.options.maxWidth,b),c=!0);a.width=c?b+"px":"auto";if(this.options.fixedDropdown)a.position="relative";else{var c=this.options.positionTarget||this.element,d=c.offset(),e=f(this.options.appendTo).offset(),h=0,l=d.left-e.left,
k=this.options.direction;this.dropdown.parent()[0]===f(document.body)[0]&&(h=parseInt((f(document.body).css("top")||"0").replace("-",""),10)||0);"right"===this.options.position&&(l+=c.width()-b-2);this.shouldFlipDirection(k)&&(k="down"===k?"up":"down");"up"===k?this.updateDropdownTop&&(this.dropdown.addClass("up"),this.element.addClass("up"),a.top=d.top-this.dropdown.outerHeight()-h+"px"):this.updateDropdownTop&&(this.dropdown.removeClass("up"),this.element.removeClass("up"),a.top=h+d.top+c.outerHeight()-
e.top+"px");"rtl"===document.dir?(b=f(window).width()-(d.left+c.outerWidth()),a.right=b+"px"):a.left=l+"px"}a.display=this.options.mcFlyInline?"block":"inline";this.aria&&(this.element.attr({"aria-expanded":!0}),this.dropdown.find("ul").attr("role","listbox"),this.dropdown.find("li").attr("role","option"));a.zIndex=this.element.zIndex()+this.options.zIndex;this.options.boundToScreen&&(this.dropdown.css("height","auto"),b=f(window).height(),c=f(window).scrollTop(),d=this.dropdown.outerHeight(),a=parseInt(a.top,
10),d+a+10-c>b&&(this.dropdown.height(b+c-a-10),this.dropdown.css("overflow-y","auto")))},shouldFlipDirection:function(a){if(this.options.flippable){var b=f(window).scrollTop(),c=b+f(window).outerHeight(),d=this.dropdown.outerHeight(),e=this.element.offset().top,c=e+this.element.outerHeight()+d>c,b=e-d<b;if("down"===a)return c&&!b;if("up"===a)return b&&!c}return!1},showDropdown:function(a,b){this.options.enableRemoteHide&&e.events.publish("Smarty.hide",this.id());this.deferredSmartyAppend||(this.deferredSmartyAppend=
1,this.dropdown.appendTo(this.options.appendTo));var c=this;this.showDropdownTimeout&&(clearTimeout(this.showDropdownTimeout),this.showDropdownTimeout=null);if("function"===typeof this.options.delayShowDropdown&&this.options.delayShowDropdown()){var d=this.showDropdownLast?Date.now()-this.showDropdownLast:null;if(!this.showDropdownLast||0===d||d&&0<d&&d<this.options.showDropdownDelay){this.showDropdownLast=this.showDropdownLast||Date.now();this.showDropdownTimeout=setTimeout(this.showDropdown.bind(this,
a,b),d||this.options.showDropdownDelay);return}}this.showDropdownLast=null;this.setDropdownContent(this.makeHTML(a));this.setDropdownPosition();this.bindDropdownEvent("click",this.handleItemClickEvent);this.bindDropdownEvent("mouseover",this.handleItemMouseoverEvent);this.bindDropdownEvent("mouseout",this.handleItemMouseoutEvent);if(this.options.repositionDropdownOnResize)f(window).off("resize.smarty").on("resize.smarty",this.handleWindowResizeSmarty.bind(this));clearTimeout(this.clickDropdownSetID);
this.clickDropdownSetID=setTimeout(function(){if(c.isSmartyActiveElement())f(document).off("click.Smarty"+c.id()).on("click.Smarty"+c.id(),function(){c.onDocumentClicked()})},400);this.initFirstHighlight();this.options.positionOnScroll&&(a=function(){c.position()},f(window).off("scroll.smarty",a).on("scroll.smarty",a),f(".col-left-rail").off("scroll.colSmarty").on("scroll.colSmarty",a),f(".filterList").off("scroll.colSmarty").on("scroll.colSmarty",a),f(".Common-Widgets-Dialog-Dialog.visible\x3e.viewport").off("scroll.dialogSmarty").on("scroll.dialogSmarty",
a))},initFirstHighlight:function(){this.removeItemHighlight();""!==this.element.val()&&this.highlightFirstSelectableItem()},hideDropdown:function(a){f(window).off("resize.smarty");this.base(a);if(e.config.getBoolean("ui.smarty.auto.select.1st",!1))return!0},toggleAnywhere:function(a){this.options.showAnywhere=a},stopInputProcessing:function(){this.setItemTriggered||this.smartyLoggerSave();this.setItemTriggered=!1;this.base()},handleItemClickEvent:function(a,b){this.selectItem(a,null);this.hideDropdown();
this.options.stopPropagation&&b&&"function"===typeof b.stopPropagation&&b.stopPropagation()},handleInputBlurEvent:function(a,b){this.handleSmartyInputBlurEvent(a,b)},handleSmartyInputBlurEvent:function(){var a=this;this.focusEventHandled=!1;setTimeout(function(){if(!a.isSmartyActiveElement()){a.stopInputProcessing();if(a.hideDropdown()&&a.options.forceSelection)a.onForceSelection();a.onAfterDone()}},10)},handleInputKeyUp:function(a){var b=[e.globals.keyCodes.TAB,e.globals.keyCodes.RETURN,e.globals.keyCodes.ESC];
e.config.getBoolean("ui.smarty.ignoreArrowsInKeyUp",!0)&&(b=b.concat(e.globals.keyCodes.UP,e.globals.keyCodes.DOWN));var c=a.keyCode?a.keyCode:a.which,d=this.options.simplifiedValueChange||this.dropdown&&this.dropdown.is(":visible");0<=b.indexOf(c)||!d||(this.options.simplifiedValueChange?this.handleInputChangeEvent():this.handleInputFocusEvent(this.element,a))},onDocumentClicked:function(){if(!this.isSmartyActiveElement())if(f(document).off("click.Smarty"+this.id()),this.options.cleanUpInputFieldOnFocus){if(this.lastValue&&
!this.element.val()&&this.element.val(this.lastValue),!this.isSmartyActiveElement()){this.stopInputProcessing();if(this.hideDropdown()&&this.options.forceSelection)this.onForceSelection();this.onAfterDone()}}else this.hideDropdown()},isSmartyActiveElement:function(){return this.dropdown&&this.element?document.activeElement===this.dropdown.get(0)||document.activeElement===this.element.get(0)||this.options.alternateSmartyInputElement&&document.activeElement===this.options.alternateSmartyInputElement||
0<this.dropdown.find(f(document.activeElement)).length:!1},setItem:function(a,b){this.smartyLoggerSave(a);this.setItemTriggered=!0;this.base(a,b)},smartyLoggerSave:function(a){if(e.config.getBoolean("ui.smarty.r9LogOptions",!0)){var b={vertical:this._logPath,inputType:this.element.attr("name")||"destination",prefix:this.isItemSet||!this.setItemTriggered&&this.initialVal&&this.initialVal===this.element.val()?"":this.element.val()||"",options:this.getSmartyLoggerItems()||[]};a&&(b.selectedElem=a);e.SmartyLogger._save(b)}},
getSmartyLoggerItems:function(){return this.dropdown&&this.dropdown.children&&this.dropdown.children("ul").children("li")},handleWindowResize:function(){this.handleWindowResizeSmarty()},handleWindowResizeSmarty:function(){if(!this.isDropdownHidden()){var a=this.options.positionTarget||this.element,b=a.offset().left-f(this.options.appendTo).offset().left,c=a.offset().top+a.outerHeight()-f(this.options.appendTo).offset().top;"right"===this.options.position&&(b+=a.width()-2);this.dropdown.css("left",
b+"px");this.dropdown.css("top",c+"px")}this.updateBackgroundAutocompletePosition()},destroy:function(){this.base();this.hideDropdown();this.abortSearchCompletedEventListeners();this.unInit();this.unbindInputEvent("mousedown touchstart");this.unbindInputEvent("keyup");this.element.removeData("widget");this.element.attr("smarty",!1);f(document).off("click.Smarty"+this.id());f(window).off("resize.smarty");!0===this.options.enableRemoteHide&&this.id()&&e.events.unsubscribe("Smarty.hide",this.hideSmartyById)},
isJSON:function(){var a=this.options.extendRequest;return a&&"j"===a.f},isJsonResponse:function(a){return this.isJSON()&&"string"!==typeof a},applyJsonOptions:function(){this.isJSON()&&(this.options.dataType="json",this.options.extendRequest=f.extend({},this.options.extendRequest,{v:"v1"}),this.options.dropdownClass+=" smartbox-js")},postprocessResponse:function(a,b){return this.isJsonResponse(a)?a:this.base(a,b)},makeHTML:function(a){if(!this.isJsonResponse(a))return this.base(a);var b=this,c=this.getRequestData(),
d=c&&c.value||"",e=this.getMaxItemsToShow();return'\x3cul role\x3d"listbox"\x3e'+a.map(function(a,c){return 0<e&&c>=e?null:b.formatItem(a,d)}).filter(function(a){return!!a}).join("")+"\x3c/ul\x3e"},getMaxItemsToShow:function(){return-1},formatItem:function(a,b){var c=a.cc&&"ctry"===a.loctype&&e.config&&e.config.getBoolean("ui.smarty.hideCountryFeatures."+a.cc,!1);if(!a||!a.loctype)return"";var d=this.getDisplayName(a),g=this.getNearbyHotels(a),h=this.getNearbyRentals(a),d=f.extend({},a,{id:this.getItemId(a),
name:d,label:[d,g,h].filter(function(a){return!!a}).join(" "),highlighting:this.highlight(d,b),parentPath:a.parentPath||a.rc||"",nearbyHotels:g,nearbyRentals:h}),g='\x3cdiv class\x3d"smarty-city"\x3e'+d.highlighting+"\x3c/div\x3e";"ap"===a.loctype?(d.shortName=a.shortdisplayname||"",g+='\x3cspan class\x3d"airportCode"\x3e'+this.highlight(a.ap,b)+"\x3c/span\x3e"):"city"===a.loctype?d.shortName=a.cityonly||"":"ctry"===a.loctype&&a.cc&&!c&&(d.icon="/images/flags/a-small-flag."+a.cc.toLowerCase()+".png");
(b=this.locationTypeMessages[a.loctype]||"")&&!c&&(g+='\x3cspan class\x3d"smarty-label '+a.loctype+'"\x3e'+b+"\x3c/span\x3e");"ap"!==a.loctype&&"hotel"!==a.loctype&&(g+=this.formatNearbyDetails(a,d));b=a.loctype||"city";"cg"===b&&(b="ctgroup");c&&(b+=" noBackgroundIcon");c=['id\x3d"'+this.formatListItemId(a,d)+'"','class\x3d"'+b+'"','role\x3d"option"','tabindex\x3d"0"'];a.cc&&c.push('data-cc\x3d"'+a.cc+'"');a.rc&&c.push('data-rc\x3d"'+a.rc+'"');d.shortName&&c.push('data-short-name\x3d"'+d.shortName+
'"');d.label&&c.push('aria-label\x3d"'+d.label+'"');d.icon&&c.push('style\x3d"background-image:url('+d.icon+')"');c.push('data-attr\x3d"'+this.htmlEscape(JSON.stringify(d))+'"');this.options.e2eTestMode&&c.push("data-test-item");return"\x3cli "+c.join(" ")+"\x3e"+g+"\x3c/li\x3e"},getDisplayName:function(a){var b=a.displayname||"";if(a.ap){a="("+a.ap+")";var c=b.length,d=c-a.length;b&&b.substring(d,c)===a&&(b=b.substring(0,d).trim())}return b},getNearbyHotelsCount:function(a){return a.hotelCount||
a.nearbyHotels||0},getNearbyHotels:function(){return""},getNearbyRentalsCount:function(a){return a.rentalCount||a.nearbyRentals||0},getNearbyRentals:function(){return""},formatNearbyDetails:function(a,b){a="";b.nearbyHotels&&(a+='\x3cspan class\x3d"smarty-label hotels"\x3e'+b.nearbyHotels+"\x3c/span\x3e");b.nearbyRentals&&(a+='\x3cspan class\x3d"smarty-label rentals"\x3e'+b.nearbyRentals+"\x3c/span\x3e");return a},getItemId:function(a){return""+(("ap"===a.loctype?a.ap:"city"===a.loctype?a.ctid:"ctry"===
a.loctype?a.cid:"hotel"===a.loctype?a.hid:"reg"===a.loctype?a.rid:"freereg"===a.loctype?a.frid:"cg"===a.loctype?a.cgid:"hood"===a.loctype?a.sid:"lm"===a.loctype?a.lmid:a.id)||"")},formatListItemId:function(a,b){return a.loctype+"-"+b.id},htmlEscape:function(a){var b={"\x26":"\x26amp;","\x3c":"\x26lt;","\x3e":"\x26gt;",'"':"\x26quot;","'":"\x26#39;"};return a.replace(/[&<>"']/g,function(a){return b[a]})},highlight:function(a,b){var c=a.toLowerCase().indexOf(b.toLowerCase());b=c+b.length;return 0>c?
a:a.substring(0,c)+"\x3cb\x3e"+a.substring(c,b)+"\x3c/b\x3e"+a.substring(b)}})})(window.R9,window.jq||window.jQuery);(function(d,e){d.createWidgetClass("smarty.PopularDestinationsSmarty","common.widgets.smarty.FlareSmarty",{currentOrigin:null,hideDropdown:function(){this.base();if(d.config.getBoolean("ui.smarty.auto.select.1st",!1))return!0},checkAndSetItem:function(a,b){a=e(b);if(a.hasClass("anywhere")&&a.hasClass("selected")&&a.is(":visible"))return a={id:"",short_str:"anywhere",str:a[0].innerText,type:""},this.setItem(a),!1;if("undefined"!==a.attr("id")&&a.is(":visible")&&(a=this.extractFirstListItemData(a)))return this.setItem(a),
!1},extractFirstListItemData:function(a){if(a.hasClass("anywhere")&&a.hasClass("selected")&&a.is(":visible"))return{id:"",short_str:"anywhere",str:a[0].innerText,type:""};if(d.config.getBoolean("ui.smarty.populardestinations.1st.translate",!0))return(a=this.translateItem(a))?a:!1;var b=a[0].id.split("-"),c=a[0].id;return c.startsWith("ap")?{id:b[1],short_str:a.attr("data-short-name"),str:a.clone().find("span").remove().end().text(),type:"ap"}:c.startsWith("freereg")?{frid:b[3],hc:b[2],id:b[1],str:a.children("div")[0].innerText,
type:"freereg"}:c.startsWith("ctry")?{cid:b[3],hc:b[2],id:b[1],str:a.children("div")[0].innerText,type:"ctry"}:c.startsWith("reg")?{rid:b[3],hc:b[2],id:b[1],str:a.children("div")[0].innerText,type:"reg"}:c.startsWith("city")?{hc:b[2],id:b[1],str:a.children("div")[0].innerText,type:"city"}:c.startsWith("lm")?{hc:b[2],lmid:b[3],id:b[1],str:a.children("div")[0].innerText,type:"lm"}:!1},isSelectOnCloseSupported:function(){return 51===this.options.flareSmartyType||50===this.options.flareSmartyType||58===
this.options.flareSmartyType},drawDestinationsContent:function(a){this.lastValue=null;this.currentOrigin&&this.currentOrigin===a||(this.currentOrigin=a,this.dropdown[0].innerHTML="");this.hideDropdown()}})})(window.R9,window.jq||window.jQuery);(function(e,f){e.createWidgetClass("smarty.HotelSmarty","common.widgets.smarty.PopularDestinationsSmarty",{constructor:function(a,b){var c={dropdownClass:" smartbox smartbox-v2 smartbox-hotel R9-Overlay ",forceSelection:!0,minWidth:377,searchOnFocus:!0,extendRequest:{v:"v2"},showDropdownWhenEmpty:!1,showPopularDestinationsList:!1,showPopularDestinationsPictures:!1},d=b.limitToCtids;d&&d.length&&(c.extendRequest.ctids=d.join(","));d=!0;a&&a[0]&&a[0].id&&(-1!=a[0].id.indexOf("hotelchain")||-1!=a[0].id.indexOf("hotelname"))&&
(d=!1);d&&this.concatExtraDropdownClasses([c,b],this.extraIconClasses(e.config.getBoolean("ui.smarty.hotels.greyIcons",!1)));c.isBusinessMode=e.question.ask("common.business.BusinessIsBusinessMode");c.isBusinessMode&&(c.showDropdownWhenEmpty=!0,c.businessOffices=e.question.ask("common.business.BusinessOffices"),c.businessOfficesHeader=e.question.ask("common.business.BusinessOfficesHeader"),c.businessSmartyMatchOffices=e.question.ask("common.business.BusinessSmartyMatchOffices"));this.base(a,f.extend(c,
b))},searchCompleted:function(a,b){this.shouldDisplayBusinessOffices()?this.showDropdown(a||"\x3cul\x3e\x3c/ul\x3e",b):this.base(a,b)},postprocessResponse:function(a,b){var c=this;!a&&e.config.getBoolean("ui.hotel.smarty-addresses",!0)&&e.Maps&&e.Maps.Google&&e.Maps.Google.load&&e.Maps.Google.load(function(){if(c.lastValue){var d=c.getAddressSuggestions(c.lastValue),e=c.searchCompleted,g=c.base,f=c.matchAndBold,n=c.lastValue;d.done(function(a){if(a&&0<a.length){for(var d="\x3cul\x3e",l=0;l<a.length;l++){var h=
a[l],m=!1;if(h.types)for(var k=0;k<h.types.length;k++)if("street_address"===h.types[k]||"route"===h.types[k]){m=!0;break}m&&(d+="\x3cli tabindex\x3d'0' class\x3d'map'\x3e\x3cdiv class\x3d\"smarty-city\"\x3e"+f.call(c,n,h.description)+"\x3c/div\x3e\x3c/li\x3e")}e.call(c,g.call(c,d+"\x3c/ul\x3e",b),b)}});return a}},c.widgetName);return this.base(a,b)},getAddressSuggestions:function(a){var b=f.Deferred();e.config.getBoolean("ui.hotel.googleAddressSuggestions",!0)&&window.google&&google.maps&&google.maps.places&&
google.maps.places.AutocompleteService&&(new google.maps.places.AutocompleteService).getPlacePredictions({input:a},function(a,d){d===google.maps.places.PlacesServiceStatus.OK?b.resolve(a):b.reject(d)});return b.promise()},createTopDestinationItem:function(a){var b=[];b.push(a.name);a.stateCode&&""!==a.stateCode?b.push(a.stateCode):a.state&&b.push(a.state);a.country&&b.push(a.country);return('\x3cli tabindex\x3d"0" id\x3d"city-%s" class\x3d"city" data-cc\x3d"%s" role\x3d"option" aria-label\x3d"%s"\x3e\x3cspan class\x3d"nearbyHotels"\x3e%s\x3c/span\x3e\x3cdiv class\x3d"smarty-city"\x3e%s\x3c/div\x3e\x3cspan class\x3d"smarty-label city"\x3e'+
this.options.messages.SMARTY_LOCATION_TYPE_CITY+"\x3c/span\x3e\x3c/li\x3e").format(a.ctId,a.cid,b.join(", "),a.hotelCountDisplay,b.join(", "))},makeHTML:function(a){if(!this.isJsonResponse(a))return this.shouldDisplayBusinessOffices()&&(a='\x3cul role\x3d"listbox" class\x3d"hotel-smarty"\x3e'+this.makeBusinessOfficeList()+"\x3c/ul\x3e"),this.base(a);a=this.base(a);this.shouldDisplayBusinessOffices()&&(a=a.slice(0,-5)+this.makeBusinessOfficeList()+"\x3c/ul\x3e");return a},makeBusinessOfficeList:function(){if(this.shouldDisplayBusinessOffices()){var a;
a=null!==this.lastValue&&this.element[0].value.length?this.options.businessSmartyMatchOffices(this.lastValue):this.options.businessOffices;return 0<a.length?e.template.render("hotelBusinessOffices",{businessOfficesHeader:this.options.businessOfficesHeader,offices:a}):""}},makeRecentList:function(a,b){if(this.shouldDisplayBusinessOffices())return"";if(this.options.smartyControlGroup){var c=this.options.smartyControlGroup.getHistory();if(c){var d=this.options.smartyControlGroup.getMaxHistory();a=jq.trim(a);
for(var c=c.filter(a,""===a?d:3),d="",e=0;e<c.length;e++){var g=c[e],f=!1;e===c.length-1&&(f=!0);d+=this.generateSmartyItem(this.matchAndBold(a,g.location),g.checkinDate,g.checkoutDate,g.idx,g.isPast,f)}return d=""!==d?(b?"\x3cul\x3e":"")+this.generateRecentHeader()+d+(b?"\x3c/ul\x3e":""):null}}},generateSmartyItem:function(a,b,c,d,f,g){b=new moment(b);c=new moment(c);g=g?" last":"";a='\x3cspan class\x3d"smartyRecentHotels"\x3e'+a+'\x3c/span\x3e\x3cspan class\x3d"smartyRecentDate '+(f?"past":"")+
'"\x3e'+b.format(this.options.smartyControlGroup.options.startFormat)+" - "+c.format(this.options.smartyControlGroup.options.endFormat)+"\x3c/span\x3e";return this.isSmartyUIV1()?'\x3cli tabindex\x3d"0" class\x3d"hist '+g+'" data-history-idx\x3d"'+d+'"\x3e\x3cdiv class\x3d"icon-wrapper"\x3e'+e.template.render("smartyHotelHistorySVG")+'\x3c/div\x3e\x3cdiv class\x3d"hist-info"\x3e'+a+"\x3c/div\x3e\x3c/li\x3e":'\x3cli tabindex\x3d"0" class\x3d"hist '+g+'" data-history-idx\x3d"'+d+'"\x3e\x3c/li\x3e'},
generateLoginBar:function(a){if(!this.options.smartyControlGroup)return"";var b="admin";a&&(b+=" addSeparation");return"notloggedin"===e.globals.analytics.loginState?(a="\x3cli tabindex\x3d'0' class\x3d'signupnow "+b+"'\x3e"+this.options.messages.loginForSearchHistory+"\x3c/li\x3e",this.isSmartyUIV1()&&(a=e.template.render("smartySignUpIn",{extraClasses:b})),a):"\x3cli class\x3d'click-disabled'\x3e\x3cdiv class\x3d'no-searches'\x3e"+(this.isSmartyUIV1()?'\x3cdiv class\x3d"icon-wrapper"\x3e'+e.template.render("smartyHistorySVG")+
"\x3c/div\x3e":"")+"\x3cspan\x3e"+this.options.messages.SMARTY_NO_RECENT_SEARCHES+"\x3c/span\x3e\x3c/div\x3e\x3c/li\x3e"},handleInputFocusEvent:function(a,b){!this.options.showPopularDestinationsList&&!this.options.showPopularDestinationsPictures||this.startedSearching&&0!==this.element[0].value.length?this.base(a,b):(this.options.searchOnFocus=!1,this.base(a,b),this.showPopularDestinations())},showInitialDropdownForData:function(a){this.shouldDisplayBusinessOffices()?this.searchCompleted(a,!1):this.base(a)},
showDropdown:function(a,b){this.base(a,b);if(this.options.showPopularDestinationsList||this.options.showPopularDestinationsPictures)0!==this.element[0].value.length&&this.startedSearchings?this.options.showPopularDestinationsPictures&&this.dropdown.removeClass("smartbox-pictures"):(this.dropdown[0].style.minimumWidth="420px",!this.options.showPopularDestinationsPictures||this.startedSearching&&0!==this.element[0].value.length||this.dropdown.addClass("smartbox-pictures"))},onInputChange:function(){if(this.options.showPopularDestinationsList||
this.options.showPopularDestinationsPictures)this.startedSearching=!0,this.options.searchOnFocus=!0,this.options.showPopularDestinationsPictures&&this.dropdown.removeClass("smartbox-pictures");this.base()},getItemList:function(){return this.options.showPopularDestinationsList||this.options.showPopularDestinationsPictures?this.dropdown.find(this.options.dropdownListSelector+", .destinationItem"):this.base()},selectItem:function(a,b){var c=-1<a.className.indexOf("destinationItem");(this.options.showPopularDestinationsList||
this.options.showPopularDestinationsPictures)&&c?e.question.ask("hotel.search.popularDestinationSelected",a):this.base(a,b)},showPopularDestinations:function(){if(!this.options.showPopularDestinationsList||!this.options.showPopularDestinationsPictures){var a;this.options.showPopularDestinationsList?a=f(".Hotels-Search-PopularDestinationsList"):this.options.showPopularDestinationsPictures&&(a=f(".Hotels-Search-PopularDestinationsPictures"));if(a&&a[0]){a=a.clone().removeAttr("hidden")[0].outerHTML;
var b=this.makeRecentList(null,!1);null==b?b="":0>b.indexOf("\x3cul\x3e")&&(b="\x3cul\x3e"+b+"\x3c/ul\x3e");var c="\x3cul\x3e"+this.generateLoginBar(!1)+"\x3c/ul\x3e";this.showDropdown(b+a+c,!1);var d=this;e.question.ask("hotel.search.popularDestinationsAppended",{smarty:d,after:function(){d.startedSearching=!0;d.options.searchOnFocus=!0;d.hideDropdown()}})}}},setItem:function(a,b){a&&"easter"===a.type?(e.events.publish("smarty.easteregg.found",f.extend(a,{vertical:"hotels"})),this.element.val(""),
this.element.trigger("textchange")):this.base(a,b)},formatListItemId:function(a){switch(a.loctype){case "ap":case "apnc":return[a.loctype,a.ctid,a.nearbyHotels,a.ap].join("-");case "hotel":return[a.loctype,a.ctid,0,a.id].join("-");default:return this.base(a)}},getMaxItemsToShow:function(){return-1},shouldDisplayBusinessOffices:function(){return e.config.getBoolean("ui.smarty.hotels.business.showOffices",!1)&&this.options.isBusinessMode&&-1===this._id.indexOf("Input")},onInitialData:function(){var a,
b=this.generateAnywhereMarkup(),c=this.generateContinentsMarkup(),d;if(a="loggedin"===e.globals.analytics.loginState?this.generateTopDestinations()||e.Widgets.Smarty.Smarty.prototype.onInitialData.call(this)||this.makeRecentList(null,!0):this.generateTopDestinations()||e.Widgets.Smarty.Smarty.prototype.onInitialData.call(this))return d=this.generateLoginBar(a||b),this.placeAnywhereMarkup(a,(b?b:"")+d);a=[];this.appendToInitialData(a);d=0<a.length;d=this.generateLoginBar(b||d);b&&a.push(b);c&&a.push(c);
this.options.smartyControlGroup&&e.globals.canLogin&&"undefined"!==typeof d&&a.push(d);return a.length?"\x3cul\x3e"+a.join("")+"\x3c/ul\x3e":""}})})(window.R9,window.jq||window.jQuery);(function(d,h){var k=d.config.getBoolean("ui.horizon.flights.smarty.iataCity.fullDisplay",!1);d.createWidgetClass("smarty.FlareSmarty","common.widgets.smarty.FlareSmartyBaseLoader",{constructor:function(a,b){this.base(a,h.extend({dataSource:"/f/smarty",appendTo:"body"},b))},init:function(){d.common.widgets.smarty.Smarty.prototype.init.apply(this,arguments)},showDropdown:function(){d.common.widgets.smarty.Smarty.prototype.showDropdown.apply(this,arguments)},translateItem:function(a){var b=d.Widgets.Smarty.FlareSmarty.prototype.translateItem.call(this,
a);(a=h(a).data("attr"))&&(b=h.extend(b,a));return b},setItem:function(){d.common.widgets.smarty.Smarty.prototype.setItem.apply(this,arguments)},handleItemClickEvent:function(a,b){this.isSmartyUIV1()?h(a).hasClass("sign-up-in")?(this.openSignUpInPopup(h(b.target).hasClass("sign-up")),this.hideDropdown()):this.base(a,b):this.base(a,b)},getDataSource:function(){return this.isSmartyUIV1()?d.config.getString("ui.common.smarty.get.url",this.options.dataSource):this.base()},postprocessResponse:function(a,
b){return this.isJsonResponse(a)?d.common.widgets.smarty.Smarty.prototype.postprocessResponse.call(this,a,b):this.base(a,b)},makeHTML:function(a){return this.isJsonResponse(a)?d.common.widgets.smarty.Smarty.prototype.makeHTML.call(this,a):this.base(a)},getMaxItemsToShow:function(){return d.config.getInt("ui.smarty.json.itemLimit",-1)},openSignUpInPopup:function(a){a?d.authentication.showSignup():d.authentication.showLogin()},isSmartyUIV1:function(){return this.isJSON()&&this.options.smartyUIUpdateEnabled},
isDestinationImagesEnabled:function(){return this.isSmartyUIV1()&&d.config.getBoolean("ui.smarty.destinationimages.enabled",!1)},formatItem:function(a,b){if(!this.isSmartyUIV1())return this.base(a,b);var c=a.cc&&"ctry"===a.loctype&&d.config&&d.config.getBoolean("ui.smarty.hideCountryFeatures."+a.cc,!1);if(!a||!a.loctype)return"";b=this.getItemAttrs(a);var g=this.getDisplayNameHtml(a),e=this.getAirportCodeHtml(a),g=g+e,e=a.loctype||"city";"cg"===e&&(e="ctgroup");c&&(e+=" noBackgroundIcon");c=this.options.allAirportsLocalizedText===
a.airportname;if(("ap"===a.loctype||"apnc"===a.loctype)&&c||this.itemIsCustomMetro(a))e+=" aap";c=['role\x3d"option"','tabindex\x3d"0"','data-short-name\x3d"'+(b.shortName||"")+'"','data-text-to-select\x3d"'+(b.displayName||"")+'"'];b.hasOwnProperty("apicode")?(c.push("data-apicode\x3d"+b.apicode),k&&c.push("data-iatadisplay\x3d'"+(b.locationname||b.searchFormSecondary)+"'")):"rail"===a.loctype&&b.hasOwnProperty("ap")&&c.push("data-apicode\x3d"+b.ap);"number"===typeof b.airportCount&&c.push("data-airportcount\x3d"+
b.airportCount);var m=this.getDestinationImages(a);"ctry"===a.loctype&&b.icon?(c.push('style\x3d"background-image:url('+b.icon+')"'),e+=" with-icon"):g=m&&!a.sub?m+g:b.svgIcon+g;c.push('class\x3d"'+e+(a.sub?" sub":"")+'"');e=this.formatListItemId(a);this.addItemAttributes(a,c);e&&c.push('id\x3d"'+e+'"');a.cc&&c.push('data-cc\x3d"'+a.cc+'"');a.rc&&c.push('data-rc\x3d"'+a.rc+'"');b.shortName&&c.push('data-short-name\x3d"'+b.shortName+'"');"addr"===a.loctype&&c.push('data-ctid\x3d"'+a.ctid+'"');b.label&&
(e=this.locationTypeMessages[a.loctype],c.push('aria-label\x3d"'+(e?b.label+" - "+e:b.label)+'"'));c.push('data-attr\x3d"'+this.htmlEscape(JSON.stringify({entityKey:a.entityKey,objectID:a.objectID}))+'"');this.options.e2eTestMode&&c.push("data-test-item");return"\x3cli "+c.join(" ")+"\x3e"+g+"\x3c/li\x3e"},addItemAttributes:function(a,b){},formatListItemId:function(a){var b=this.getItemId(a);switch(a.loctype){case "ap":case "apnc":return[a.loctype,[a.ap||a.airportcode,a.ctid].join("/")].join("-");
case "freereg":case "reg":case "ctry":return[a.loctype,0,a.nearbyHotels,b].join("-");case "hood":case "lm":return[a.loctype,a.ctid,a.nearbyHotels,b].join("-");case "ctgroup":return[a.loctype,0,0,a.cg].join("-");default:return b?[a.loctype,b].join("-"):null}},getItemAttrs:function(a){var b=a.cc&&"ctry"===a.loctype&&d.config&&d.config.getBoolean("ui.smarty.hideCountryFeatures."+a.cc,!1),c=this.getDisplayName(a),g=this.getNearbyHotels(a),e=this.getNearbyRentals(a),c=h.extend({},a,{id:this.getItemId(a),
displayName:c,label:[c,g,e].filter(function(a){return!!a}).join(" "),parentPath:a.parentPath||a.rc||"",nearbyHotels:g,nearbyRentals:e});"ap"===a.loctype||"apnc"===a.loctype?c.shortName=a.shortdisplayname||"":"city"===a.loctype?c.shortName=a.cityonly||"":"geocode"===a.loctype&&(c.shortName=a.structured_formatting.main_text);"ctry"===a.loctype&&a.cc&&!b&&(c.icon="/images/flags/a-small-flag."+a.cc.toLowerCase()+".png");c.svgIcon=this.getSvgIcon(a);return c},getDisplayName:function(a){return"geocode"===
a.loctype?a.description:this.base(a)},getItemId:function(a){if(this.isSmartyUIV1())switch(a.loctype){case "hotel":case "hood":case "lm":case "freereg":return a.id;case "addr":return a.displayname;case "rest":return a.rtid}return this.base(a)},getDisplayNameHtml:function(a){var b=a.locationname||a.searchFormSecondary,c=a.airportname,g=a.cityname,e=a.smartyDisplay,h=a.displayname,k=a.nearbyInfo,l=this.getItemId(a),l=d.config.getBoolean("ui.smarty.hideTypeFeatures."+a.loctype+"."+l,!1),n=a.cc&&"ctry"===
a.loctype&&d.config&&d.config.getBoolean("ui.smarty.hideCountryFeatures."+a.cc,!1);if("ap"===a.loctype||"apnc"===a.loctype){var f=[];"apnc"!==a.loctype&&c===this.options.allAirportsLocalizedText?f.push("\x3cdiv\x3e%s\x3c/div\x3e".format([g,c].join(", "))):(f.push("\x3cdiv\x3e%s\x3c/div\x3e".format("apnc"===a.loctype?e||c:a.sub?c:b)),f.push("\x3cdiv\x3e%s\x3c/div\x3e".format("apnc"===a.loctype?k||b:a.sub?b:c)));return"\x3cdiv class\x3d'item-info'\x3e%s\x3c/div\x3e".format(f.join(""))}if("ctgroup"===
a.loctype)return"\x3cdiv class\x3d'item-info'\x3e\x3cdiv\x3e%s\x3c/div\x3e\x3c/div\x3e".format(h);"hotel"===a.loctype?(f=[],f.push("\x3cdiv\x3e%s\x3c/div\x3e".format(a.hotelname||a.name)),f.push("\x3cdiv\x3e%s\x3c/div\x3e".format(g))):"geocode"===a.loctype?(f=[],f.push("\x3cdiv\x3e%s\x3c/div\x3e".format(a.structured_formatting.main_text)),f.push("\x3cdiv\x3e%s\x3c/div\x3e".format(a.structured_formatting.secondary_text))):"addr"===a.loctype?(f=[],f.push("\x3cdiv\x3e%s\x3c/div\x3e".format(a.searchFormPrimary)),
f.push("\x3cdiv\x3e%s\x3c/div\x3e".format(a.searchFormSecondary))):"rail"===a.loctype?f=["\x3cdiv\x3e%s\x3c/div\x3e".format(this.getDisplayName(a)),"\x3cdiv\x3e%s\x3c/div\x3e".format(this.locationTypeMessages[a.loctype])]:(f=[],f.push("\x3cdiv\x3e%s\x3c/div\x3e".format(h)),n||l||f.push("\x3cdiv\x3e%s\x3c/div\x3e".format(this.locationTypeMessages[a.loctype])));return"\x3cdiv class\x3d'item-info'\x3e%s\x3c/div\x3e".format(f.join(""))},getAirportCodeHtml:function(a,b){return"ap"===a.loctype||"apnc"===
a.loctype?"\x3cdiv class\x3d'ap-code'\x3e\x3cspan\x3e"+(a.ap||a.airportcode)+"\x3c/span\x3e\x3c/div\x3e":""},getSvgIcon:function(a){var b;switch(a.loctype){case "ap":case "apnc":b="smartyFlightSVG";a.nearby?b="smartyNearbySVG":this.options.allAirportsLocalizedText&&a.airportname===this.options.allAirportsLocalizedText&&(b="smartyCitySVG");break;case "hotel":b="smartyHotelSVG";break;case "rail":b="smartyTrainSVG";break;case "city":b="smartyCitySVG";break;case "ctgroup":b=this.getCtGroupIcon(a);break;
default:b="smartyMapSVG"}return"\x3cdiv class\x3d'smarty-icon-wrapper'\x3e"+d.template.render(b)+"\x3c/div\x3e"},getDestinationImages:function(a){if(!this.isDestinationImagesEnabled())return null;switch(a.loctype){case "city":case "ctry":case "reg":case "freereg":case "lm":case "hood":return this.createDestinationImageNode(a)}return null},createDestinationImageNode:function(a){return(a=a.destination_images)&&a.image_jpeg?a.image_webp?'\x3cdiv class\x3d"destination-images"\x3e\x3cdiv class\x3d"img-wrapper"\x3e\x3cpicture\x3e'+
'\x3csource srcset\x3d"%s" type\x3d"image/webp"\x3e'.format(a.image_webp)+'\x3csource srcset\x3d"%s" type\x3d"image/jpeg"\x3e'.format(a.image_jpeg)+'\x3cimg src\x3d"%s" onerror\x3d"this.style.display\x3d\'none\'" onload\x3d"this.style.opacity\x3d1" alt\x3d""/\x3e'.format(a.image_jpeg)+"\x3c/picture\x3e\x3c/div\x3e\x3c/div\x3e":'\x3cdiv class\x3d"destination-images"\x3e\x3cdiv class\x3d"img-wrapper"\x3e'+'\x3cimg src\x3d"%s" onerror\x3d"this.style.display\x3d\'none\'" onload\x3d"this.style.opacity\x3d1" alt\x3d""/\x3e'.format(a.image_jpeg)+
"\x3c/div\x3e\x3c/div\x3e":null},getCtGroupIcon:function(a){switch(a.cg){case "AS":case "AF":case "EU":case "NA":case "SA":case "SP":case "CB":case "ME":return"smartyCtGroup"+a.cg;default:return"smartyCtGroup"}},generateContinentsMarkup:function(){var a="",b=this.options.continents;0<b.length&&this.options.showContinents&&(a+='\x3cdiv class\x3d"separator continents-separator"\x3e\x3cspan class\x3d"separatorLabel"\x3e'+this.options.messages.SMARTY_CONTINENTS_LABEL+"\x3c/span\x3e\x3c/div\x3e",b.forEach(function(b,
d){a="oceania"===b.id?a+('\x3cli  id\x3d"freereg-0-0-'+b.destinyId+'" class\x3d"freereg continent-item" tabindex\x3d"'+d+'"\x3e'+b.message+"\x3c/li\x3e"):a+('\x3cli  id\x3d"ctgroup-0-0-'+b.destinyId+'" class\x3d"ctgroup continent-item" tabindex\x3d"'+d+'"\x3e'+b.message+"\x3c/li\x3e")}));return a},itemIsCustomMetro:function(a){return this.options.useApiAirportCode&&a.apicode&&4===a.apicode.length&&"a"===a.apicode.slice(-1)}})})(window.R9,window.jq||window.jQuery);(function(e,f){e.createWidgetClass("datepicker.DateInput",{options:{placeholder:"",displayFormat:"ddd M/D",inputFormat:"MM/DD/YYYY",maxDateIso:null,field:"startDate",group:"",updateGroup:"",isoDate:"",change:null,wrapper:null,minDateFunc:null,flexDisplayEnabled:!1,responsive:!1,responsiveMobileOnly:!1,optional:!1,notEditableInputInMobile:!1,isMobileOrTablet:!1,noDateSetup:!1},inputElement:null,date:null,previewDate:null,now:null,maxDate:null,minDate:null,tempDate:null,inModal:!1,inSticky:!1,flexDisplay:null,
clearIcon:null,focusData:null,Keys:{LEFT:37,UP:38,RIGHT:39,DOWN:40,TAB:9,RETURN:13,PAGE_UP:33,PAGE_DOWN:34,SPACE:32,HOME:36,SHIFT:16,END:35,ESC:27},currentEvent:null,init:function(){this.focusData={data:null,triggering:!1};this.inputElement=this.getChildElement("input");this.inModal=1===this.element.closest(".R9-Overlay").length;this.inSticky=1===this.element.closest(".R9-Sticky").length;this.now=moment().startOf("day");this.options.maxDateIso&&(this.maxDate=moment(this.options.maxDateIso,"YYYY-MM-DD"));
this.maxDate&&this.maxDate.isValid()||(this.maxDate=moment().add(1,"year"));this.flexDisplay=this.getChildElement("flexDisplay");this.options.optional&&(this.clearIcon=this.getChildElement("clear"))},inlineComponentsReady:function(){this.options.noDateSetup||(this.validateDate(moment(this.options.isoDate))?this.setDate(moment(this.options.isoDate).valueOf()):this.showPlaceholder());if(this.options.optional){var a=this.clearIcon.data("message");if(a){var b=this.clearIcon.is(":visible")&&this.options.showToolTipImmediately;
this.clearIcon.toolTip({content:a,showImmediately:b,position:"bottom",size:"s",delay:b?1E3:200})}}},addEventHandlers:function(){var a=this;this.subscribe("DatePicker.update",{updateGroup:this.options.updateGroup},this.onDatePickerUpdate.bind(this));this.subscribe("DateInput.%s.focus".format(this.options.field),this.options.group,function(){a.focus()});this.inputElement.on("focus",function(b,c){a.focusData.refocus||a.onFocus.call(a,this,b,a.focusData.data);a.focusData.triggering=!1;a.focusData.data=
null;delete a.focusData.refocus});this.inputElement.on("blur",function(b){a.onBlur.call(a,this,b)});this.inputElement.on("keydown",function(b){a.onKeydown.call(a,this,b)});this.inputElement.on("keyup",function(b){a.onKeyup.call(a,this,b)});this.element.find("[data-proxy-click]").click(function(){a.inputElement.trigger("click")});this.answer("DateInput.%s.%s".format(this.options.group,this.options.field),this.getInputData.bind(this));if(this.options.optional)this.clearIcon.on("click",function(b){a.onClearIconClick(a,
this,b)})},getInputData:function(){var a={offset:this.element.offset(),width:this.element.outerWidth(),height:this.element.outerHeight(),value:this.getValue()};this.options.wrapper&&(a.wrapper="#%s".format(this.options.wrapper));return a},onDatePickerUpdate:function(a){if(a&&a.fields&&a.fields.hasOwnProperty(this.options.field)&&a.group&&a.group===this.options.group)switch(a.action){case "change":this.receiveDateChange(a);break;case "preview":this.receiveDatePreview(a);break;case "focus":this.options.group===
a.group&&(this.focusData={data:a,triggering:!0},this.focus());break;case "blur":this.showDate();this.element.removeClass("focused");e.events.publish("DateInput.%s.onBlur".format(this.options.field),this.options.group);a.tabForward&&(this.focusData={refocus:!0},this.focus());break;case "flex":this.options.flexDisplayEnabled&&this.receiveFlexChange(a)}},focus:function(){this.inputElement.trigger("focus")},onFocus:function(a,b,c){var d=this;!0===this.options.isMobileOrTablet&&!0===this.options.notEditableInputInMobile&&
d.hideKeyboard(a);b="input";c&&c.format&&(b=c.format);"function"===typeof this.options.minDateFunc&&this.options.minDateFunc.call(this,this);this.focusData.triggering||setTimeout(function(){d.summonDatePicker()},100);(c=this.getValue())&&this.showDate(c,b);"input"!==b||this.isPlaceholder||this.selectAll(a);this.element.addClass("focused");e.events.publish("DateInput.%s.onFocus".format(this.options.field),this.options.group)},hideKeyboard:function(a){a.setAttribute("contenteditable","false");setTimeout(function(){a.blur();
a.setAttribute("contenteditable","true")},100)},onBlur:function(a,b){},onKeydown:function(a,b){var c=a=!1;switch(b.which){case this.Keys.RETURN:c=a=!0;this.currentEvent=b;break;case this.Keys.TAB:c=!0;this.currentEvent=b;b.shiftKey||(a=!0);break;case this.Keys.ESC:c=!0}this.isPlaceholder&&this.hidePlaceholder();var d=moment(this.inputElement.html(),this.options.inputFormat);if(this.validateDate(d)||c)this.handleKeyboardNavigation(b,d),a&&b.preventDefault()},handleKeyboardNavigation:function(a,b){var c,
d=b.clone();switch(a.which){case this.Keys.TAB:c=!1;a.shiftKey?"startDate"===this.options.field&&this.dismissDatePicker(!0,!0):this.publishUpdate({field:this.options.field,action:"tab",tabForward:!0});break;case this.Keys.RETURN:c=!1;this.validateDate(b)?this.sendDateChange(b):this.dismissDatePicker(!1,!1,!0);break;case this.Keys.ESC:c=!1;this.dismissDatePicker(!1,!1,!0);this.inputElement.trigger("blur");break;default:c=!1}c&&this.sendDatePreview(b,d)},onKeyup:function(a,b){a=moment(this.inputElement.html(),
this.options.inputFormat);this.validateDate(a)&&b.which!==this.Keys.TAB&&b.which!==this.Keys.RETURN&&this.sendDatePreview(a,this.date?this.date.clone():null,{preventUpdate:!0})},setDate:function(a,b){if(a&&this.validateDate(moment(a)))this.date=moment(a),e.events.publish("DateInput.%s.%s.setDate".format(this.options.group,this.options.field),{date:this.date}),this.options.optional&&this.toggleClearIcon(!1);else if(null===a||""===a)this.clearDate(),"endDate"===this.options.field&&this.options.optional&&
this.toggleClearIcon(!0);b||this.showDate()},setMinDate:function(a){a&&this.validateDate(moment(a))&&(this.minDate=a)},clearDate:function(){this.date=null},getValue:function(){return this.date?this.date.valueOf():0},getDate:function(){return this.date?this.date.clone():null},validateDate:function(a){return this.hasFunctions(a,"isValid","isSameOrAfter","isBefore")?a.isValid()&&a.isSameOrAfter(this.now)&&!a.isAfter(this.maxDate):!1},hasFunctions:function(){var a=Array.prototype.slice.call(arguments);
return a.slice(1).reduce(function(b,c){return b&&a[0][c]&&"function"===typeof a[0][c]},!!a[0])},receiveDatePreview:function(a){var b=a.fields[this.options.field];a=this.options.field===a.picking&&!a.clear;b?this.showDate(b,"input"):this.getValue()?this.showDate(this.getValue(),a?"input":"display"):this.showPlaceholder()},receiveDateChange:function(a){var b=a.fields[this.options.field],c=this.options.field===a.picking;a.tabForward&&(this.focusData={refocus:!0},this.focus());this.setDate(b,!0);"function"===
typeof this.options.change&&this.options.change.call(this,{field:this.options.field,date:this.date.format("YYYY-MM-DD")});this.showDate(c?"input":"display")},sendDatePreview:function(a,b,c){var d={action:"preview",date:0,field:this.options.field};a&&(d.value=a.valueOf(),b&&f.extend(d,{previous:b.valueOf()}),f.extend(d,c));this.publishUpdate(d)},receiveFlexChange:function(a){var b=a.data;switch(a.flex){case "plusminusthree":case "weekend":case "openflex":b.inputDisplay&&b.inputDisplay.hasOwnProperty(this.options.field)?
(this.element.addClass("show-flex-display"),this.flexDisplay.html(b.inputDisplay[this.options.field])):(this.element.removeClass("show-flex-display"),this.flexDisplay.html(""));break;default:this.element.removeClass("show-flex-display"),this.flexDisplay.html("")}},sendDateChange:function(a,b,c){this.publishUpdate({action:"change",value:a.valueOf(),field:this.options.field,focused:!!b,tabForward:!!c,event:this.currentEvent})},publishUpdate:function(a){f.extend(a,{updateGroup:this.options.updateGroup,
group:this.options.group});e.events.publish("DateInput.update",a)},summonDatePicker:function(){var a={modal:this.inModal,sticky:this.inSticky,updateGroup:this.options.updateGroup,group:this.options.group,field:this.options.field};this.minDate&&f.extend(a,{minDate:this.minDate});e.events.publish("DateInput.summon",a)},dismissDatePicker:function(a,b,c){var d={updateGroup:this.options.updateGroup,group:this.options.group,field:this.options.field};a&&!b?(d.tabForward=!0,d.event=this.currentEvent):a&&
b&&(d.tabBackward=!0);c&&(d.focusDisplay=!0);e.events.publish("DateInput.dismiss",d)},showDate:function(a,b){0===arguments.length?(b="display",a=this.getValue()):"string"===typeof arguments[0]?(b=a,a=this.getValue()):"undefined"===typeof b&&(b="display");0!==a?(this.hidePlaceholder(),"input"===b?this.inputElement.html(moment(a).format(this.options.inputFormat)):"display"===b&&this.inputElement.html(moment(a).format(this.options.displayFormat))):this.showPlaceholder()},showPlaceholder:function(){this.inputElement.html(this.options.placeholder);
this.isPlaceholder=!0;this.element.addClass("Placeholder")},hidePlaceholder:function(){this.inputElement.html("");this.isPlaceholder=!1;this.element.removeClass("Placeholder")},selectAll:function(a){var b=document.createRange();b.selectNodeContents(a);a=window.getSelection();a.removeAllRanges();try{a.addRange(b)}catch(c){}},clearOptional:function(){this.clearIcon.trigger("click")},onClearIconClick:function(a,b){a={updateGroup:this.options.updateGroup,group:this.options.group,field:this.options.field};
this.clearDate();this.dismissDatePicker();this.toggleClearIcon(!0);e.events.publish("DateInput.clear",a);e.Analytics.api.trackEvent({category:"Date-Input",action:"click",label:"clear-optional"})},toggleClearIcon:function(a){null==this.clearIcon&&(this.clearIcon=this.getChildElement("clear"));this.clearIcon.toggleClass("hidden",a)},destroy:function(){this.base();e.events.publish("DateInput.destroy",{group:this.options.group})}})})(R9,jQuery);(function(m,e){m.createWidgetClass("datepicker.Calendar",{aboveCalendarContainer:null,belowCalendarContainer:null,months:null,currentPickerId:null,animate:!0,animating:!1,isOpen:!1,DateMode:{SINGLE:"single",RANGE:"range",WEEKEND:"weekend",OPENFLEX:"openflex"},now:null,maxDate:null,leftArrow:'\x3csvg xmlns\x3d"http://www.w3.org/2000/svg" viewBox\x3d"0 0 26 26" fill\x3d"currentColor"\x3e\x3cpath d\x3d"M16.49 20.89L7.89 13l8.6-7.89 1.02 1.11-7.4 6.78 7.4 6.78-1.02 1.11z"/\x3e\x3c/svg\x3e',rightArrow:'\x3csvg xmlns\x3d"http://www.w3.org/2000/svg" viewBox\x3d"0 0 26 26" fill\x3d"currentColor"\x3e\x3cpath d\x3d"M9.91 20.87l-1.07-1.05L15.57 13 8.84 6.18l1.07-1.05L17.68 13l-7.77 7.87"/\x3e\x3c/svg\x3e',
pickers:{},options:{monthTitleFormat:"MMMM YYYY",allowPastDates:!1,fullCssClass:"Common-Widgets-Datepicker-Calendar",shortDayNameLen:1,mobileBreakpoint:568,monthWidth:260,maxDateIso:null,isMobile:!1,flexRadioButtons:!1,forceDownwards:!1,removeOnPollingStart:!1,inContent:!1},daysSelector:".col-day[data-val]:not(.disabled)",mobileHtml:null,dataTestTagDay:"",dataTestTagMonth:"",getCssClass:function(){var a=this.getCurrentPicker(),b=this.options.fullCssClass;a&&a.cssClass()&&(b+=" "+a.cssClass());this.options.inContent&&
(b+=" InContent");this.options.mcfly&&(b+=" mcfly");return b},addPicker:function(a){var b=a.dateMode,c=a.group;if("undefined"===typeof a.id||"undefined"===typeof b||"undefined"===typeof c)throw Error("id, dateMode and group should not be empty.");this.pickers[a.id]=e.extend({},a,{state:{currentDate:this.getInitDate(a.initDate),minDate:null}})},init:function(){this.now=moment().startOf("day");this.options.maxDateIso&&(this.maxDate=moment(this.options.maxDateIso,"YYYY-MM-DD"));this.maxDate&&this.maxDate.isValid()||
(this.maxDate=moment().add(1,"year"));this.createCalendar();m.events.ready("common.widgets.datepicker.calendar.initialized",{instance:this});this.dataTestTagMonth=this.dataTestTag("month");this.dataTestTagDay=this.dataTestTag("day")},createCalendar:function(){this.element=e(this.createSkeleton(this.now));this.aboveCalendarContainer=this.element.find(".aboveCalendar");this.belowCalendarContainer=this.element.find(".belowCalendar");this.pointer=this.element.find(".pointer");this.title=this.element.find(".title");
this.displayWrapper=this.element.find(".displayWrapper");this.next=this.element.find(".nextMonth");this.prev=this.element.find(".prevMonth");this.months=this.element.find(".monthsGrid");this.animation=this.element.find(".animationWrapper");this.defaultView=this.element.find(".default-view")},addEventHandlers:function(){var a=this,b=function(b){return function(c){b.call(a,this,c)}};this.element.on("click.next",".nextMonth",this.onNextClick.bind(this));this.element.on("click.prev",".prevMonth",this.onPrevClick.bind(this));
this.element.on("keypress.next",".nextMonth",this.proxyClick.bind(this));this.element.on("keypress.prev",".prevMonth",this.proxyClick.bind(this));this.element.on("click.day",this.daysSelector,b(this.onDayClick));this.element.on("mouseenter.day",this.daysSelector,b(this.onDayOver));this.element.on("mouseleave.day",this.daysSelector,b(this.onDayOut));this.element.on("keydown.day",this.daysSelector,b(this.onDayKeydown));this.options.removeOnPollingStart&&m.events.subscribe("resultspage.streaming.start",
this.resetPosition.bind(this))},proxyClick:function(a){32!=a.which&&13!=a.which||this.trigger("click")},changeMonth:function(a){var b=this,c=this.getCurrentDate(),d=c.add(a,"month");1!==Math.abs(a)||500>this.animation.outerWidth()?(this.update(d),this.onMonthChange()):(this.animating=!0,this.animation.addClass("animating").css("transform","translateX(%spx)".format(a*("rtl"===document.dir?this.options.monthWidth:-this.options.monthWidth))),setTimeout(function(){b.animating=!1;b.animation.removeClass("animating").css("transform",
"translateX(0px)");-1==a?(b.removeMonth(b.months.children().last()),b.addMonth(b.makeMonthHTML(c.clone(),-1),!0),b.months.children().eq(1).attr("aria-hidden","false").removeClass("col-hidden"),b.months.children().eq(3).attr("aria-hidden","true").addClass("col-hidden"),b.dataTestTagMonth&&(b.months.children().eq(1).attr(b.dataTestTagMonth,""),b.months.children().eq(3).removeAttr(b.dataTestTagMonth))):1==a&&(b.removeMonth(b.months.children().first()),b.addMonth(b.makeMonthHTML(c.clone(),2),!1),b.months.append(),
b.months.children().eq(2).attr("aria-hidden","false").removeClass("col-hidden"),b.months.children().eq(0).attr("aria-hidden","true").addClass("col-hidden"),b.dataTestTagMonth&&(b.months.children().eq(2).attr(b.dataTestTagMonth,""),b.months.children().eq(0).removeAttr(b.dataTestTagMonth)));b.setDisplayHeight();b.onMonthChange()},200),this.updateNav())},removeMonth:function(a){a.remove()},addMonth:function(a,b){b?this.months.prepend(a):this.months.append(a)},onNextClick:function(a){e(a.currentTarget).is(".disabled")||
this.animating?a.preventDefault():this.changeMonth(1)},onPrevClick:function(a){e(a.currentTarget).is(".disabled")||this.animating?a.preventDefault():this.changeMonth(-1)},onDayClick:function(a,b){var c=this.getCurrentPicker();if(c.onDayClick)c.onDayClick(a,b)},onDayOver:function(a,b){var c=this.getCurrentPicker();if(c.onDayOver)c.onDayOver(a,b)},onDayOut:function(a,b){var c=this.getCurrentPicker();if(c.onDayOut)c.onDayOut(a,b)},onDayKeydown:function(a,b){var c=this.getCurrentPicker();if(c.onDayKeydown)c.onDayKeydown(a,
b)},setMinDate:function(a,b){if(b=this.pickers[b]){var c=b.state.currentDate,d=b.state.minDate;null!=d&&d.isSame(a,"d")||(d=moment(a),b.state.minDate=d,a=d.clone().startOf("month"),a.isAfter(c)&&(b.state.currentDate=a))}},getMinDate:function(a){return a&&this.pickers[a]?this.pickers[a].state.minDate:this.getCurrentPicker()?this.getCurrentPicker().state.minDate:null},setCurrentDate:function(a){this.getCurrentPicker().state.currentDate=a},getCurrentDate:function(){return this.getCurrentPicker().state.currentDate},
checkDate:function(a){return!this.options.allowPastDates&&a.isBefore(this.now)||a.isAfter(this.maxDate)||null!==this.getMinDate()&&a.isBefore(this.getMinDate())?!1:!0},makeNavHTML:function(a){var b=this.checkDate(a.clone().add(-1,"month"))?"":"disabled";a=this.checkDate(a.clone().add(1,"month"))?"":"disabled";var c=[];c.push('\x3cdiv id\x3d"%s" tabindex\x3d"0" role\x3d"button" %s aria-label\x3d"Previous month" class\x3d"navItem prevMonth %s" %s\x3e%s\x3c/div\x3e'.format(this.id("prev"),b?'disabled\x3d"disabled"':
"",b,this.dataTestTag("previous-month"),this.leftArrow));c.push('\x3cdiv id\x3d"%s" tabindex\x3d"0" role\x3d"button" %s aria-label\x3d"Next month" class\x3d"navItem nextMonth %s" %s\x3e%s\x3c/div\x3e'.format(this.id("next"),a?'disabled\x3d"disabled"':"",a,this.dataTestTag("next-month"),this.rightArrow));return c.join("")},makeWeekHeaderHTML:function(a,b,c){var d=[];d.push('\x3cdiv class\x3d"keel-grid weekDayGrid %s" %s\x3e'.format((a?"hide":"")+" "+(c||""),a?'role\x3d"row"':'aria-hidden\x3d"true"'));
c=moment().startOf("week");for(var e=0;7>e;e++)d.push('\x3cdiv class\x3d"col-weekDay"\x3e\x3cdiv %s class\x3d"weekDay" %s aria-label\x3d"%s"\x3e%s\x3c/div\x3e\x3c/div\x3e'.format(b?'id\x3d"%s-%s"'.format(b,e):"",a?'role\x3d"columnheader"':"",c.format("dddd"),c.format("dd").substr(0,this.options.shortDayNameLen))),c.add(1,"day");d.push("\x3c/div\x3e");return d.join("")},makeMobileCalendarHTML:function(a){this.isMobileModeLoaded=!0;if(!this.mobileHtml){this.mobileHtml=[];for(var b=-1;13>b;b++)this.mobileHtml.push(this.makeMonthHTML(a.clone(),
b,!0))}return this.mobileHtml},makeCalendarHTML:function(a){var b=[];b.push(this.makeMonthHTML(a.clone(),-1));b.push(this.makeMonthHTML(a.clone(),0));b.push(this.makeMonthHTML(a.clone(),1));b.push(this.makeMonthHTML(a.clone(),2));return b.join("")},makeMonthHTML:function(a,b,c){var d=[];a=a.clone().add(b,"month").startOf("month");var e=a.month(),g=this.id(a.format("YYYYMM"));b=(-1===b||2===b)&&!c;d.push('\x3cdiv id\x3d"'+g+'" class\x3d"col col-month col-month-m '+(b?"col-hidden":"")+'" role\x3d"grid" aria-readonly\x3d"true" aria-hidden\x3d"'+
b+'" '+(b?"":this.dataTestTagMonth)+"\x3e");d.push('\x3cdiv class\x3d"month"\x3e');d.push('\x3cdiv class\x3d"monthDisplay"\x3e'+a.format(this.options.monthTitleFormat)+"\x3c/div\x3e");d.push(this.makeWeekHeaderHTML(!0,g));d.push('\x3cdiv class\x3d"weeks"\x3e');d.push('\x3cdiv class\x3d"keel-grid weekGrid" role\x3d"row"\x3e');for(b=0;b<a.weekday();b++)d.push(this.makeDayHTML(g));for(;a.month()==e;)d.push(this.makeDayHTML(g,a)),6===a.weekday()&&d.push('\x3c/div\x3e\x3cdiv class\x3d"keel-grid weekGrid" role\x3d"row"\x3e'),
a.add(1,"day");a.add(-1,"day");d.push("\x3c/div\x3e");d.push("\x3c/div\x3e");d.push("\x3c/div\x3e");d.push("\x3c/div\x3e");return d.join("")},makeDayHTML:function(a,b){var c="",d="",e="",g=-1,l="",h="",n=this.dataTestTagDay;b?(this.checkDate(b)?(b.isSame(this.now)&&(c="today"),g=0):(c="disabled",n=""),d=b.date(),l='aria-describedby\x3d"'+a+"-"+b.weekday()+'"',h=' aria-label\x3d"'+b.format("MMMM D")+'"',e='data-val\x3d"'+b.valueOf()+'"'):(c="empty",n="");return"\x3cdiv "+e+' class\x3d"col-day '+c+
'" role\x3d"gridcell" '+l+h+'tabindex\x3d"'+g+'" '+n+'\x3e\x3cdiv class\x3d"day"\x3e'+d+"\x3c/div\x3e\x3c/div\x3e"},createSkeleton:function(a){var b=this.makeWeekHeaderHTML(!1);a=this.makeNavHTML(a);var c=this.options.flexRadioButtons?"flexRadioButtons":"";return'                \x3cdiv id\x3d"'+this.id()+'" class\x3d"'+this.getCssClass()+'" aria-expanded\x3d"false" role\x3d"dialog" '+this.dataTestTag("calendar")+'\x3e                    \x3cdiv id\x3d"'+this.id("pointer")+'" class\x3d"pointer hidden"\x3e\x3c/div\x3e                    \x3cdiv id\x3d"'+
this.id("title")+'" class\x3d"title"\x3e\x3c/div\x3e                    \x3cdiv class\x3d"innerWrapper"\x3e                        \x3cdiv class\x3d"contentContainer"\x3e                            \x3cdiv id\x3d"'+this.id("above")+'" class\x3d"aboveCalendar hidden '+c+'"\x3e\x3c/div\x3e                            '+(this.options.mcfly?a:"")+'                            \x3cdiv id\x3d"'+this.id("displayWrapper")+'" class\x3d"displayWrapper"\x3e                                \x3cdiv class\x3d"default-view"\x3e                                    '+
(this.options.mcfly?"":a)+'                                    \x3cdiv class\x3d"keel-grid weekDaysGrid"\x3e                                        \x3cdiv class\x3d"col-hidden col-weekHeader col-weekHeader-m"\x3e'+b+'\x3c/div\x3e                                        \x3cdiv class\x3d"col-hidden col-weekHeader col-weekHeader-m"\x3e'+b+'\x3c/div\x3e                                    \x3c/div\x3e                                    \x3cdiv id\x3d"'+this.id("animation")+'" class\x3d"animationWrapper"\x3e                                        \x3cdiv id\x3d"'+
this.id("months")+'" class\x3d"keel-grid monthsGrid"\x3e\x3c/div\x3e                                    \x3c/div\x3e                                \x3c/div\x3e                            \x3c/div\x3e                            \x3cdiv id\x3d"'+this.id("below")+'" class\x3d"belowCalendar hidden"\x3e\x3c/div\x3e                        \x3c/div\x3e                    \x3c/div\x3e                \x3c/div\x3e            '},getCurrentPicker:function(){return this.pickers[this.currentPickerId]},setTitle:function(){var a=
this.getCurrentPicker().title;"undefined"===typeof a||""===a?this.title.addClass("hidden"):this.title.text(a)},setClass:function(){this.element.removeClass().addClass(this.getCssClass())},populateMonthsGrid:function(a){a=a||this.getCurrentPicker().initDate||this.now;var b=this.makeCalendarHTML(a);this.setCurrentDate(a.clone());this.months.html(b)},switchPicker:function(a){if(null!==this.currentPickerId){var b=this.pickers[this.currentPickerId];if(b.onUnload)b.onUnload(this)}if(b=this.pickers[a]){this.currentPickerId=
a;this.setTitle();this.setClass();0===this.element.closest(m.config.getString("ui.horizon.output.container","body")).length&&this.element.appendTo(m.config.getString("ui.horizon.output.container","body"));if(b.onLoad)b.onLoad(this);b.afterLoad&&b.afterLoad(this);this.update(b.state.minDate);this.element.attr("data-date-group",b.group)}},update:function(a){this.populateMonthsGrid(a);this.updateNav();this.setDisplayHeight()},updateNav:function(){this.checkDate(this.getMonthDate(-1,!0))?this.prev.removeClass("disabled").removeAttr("disabled"):
this.prev.addClass("disabled").attr("disabled","disabled");this.checkDate(this.getMonthDate(2))?this.next.removeClass("disabled").removeAttr("disabled"):this.next.addClass("disabled").attr("disabled","disabled")},setDisplayHeight:function(){if(this.displayWrapper.is(":visible")){var a=0;this.months.children().each(function(b){if(1==b||2==b)a=Math.max(a,e(this).find(".month").outerHeight())});this.displayWrapper.height(a);this.getCurrentPicker()&&this.getCurrentPicker().setDisplayHeight&&this.getCurrentPicker().setDisplayHeight()}},
resetPosition:function(){setTimeout(function(){this.element.removeAttr("style")}.bind(this),750)},position:function(a,b){if(this.isOpen){var c=this.getCurrentPicker(),d=c.dateMode,t=c.group,c=c.hasPointer,g={},l=0,h=0,n=0,r=Math.round(e(window).outerWidth()),f=m.question.ask("DateInput.%s.startDate".format(t));if(r<this.options.mobileBreakpoint&&this.isOpen)this.element.removeAttr("style");else{if(d===this.DateMode.RANGE){var q=m.question.ask("DateInput.%s.endDate".format(t)),k,p;q||console.error('Missing end input field, if this is a single date, set the dateMode parameter to "single"');
var u=q.offset.left-f.offset.left;f.wrapper&&f.wrapper===q.wrapper&&e(f.wrapper).length&&(k=e(f.wrapper),p=k.offset());k?(g.left=p.left,l=p.top,h=k.outerHeight(),n="endDate"===a?q.offset.left-p.left:f.offset.left-p.left):f.height===q.height&&f.offset.top===q.offset.top&&this.element.outerWidth()-60>u&&(g.left=f.offset.left,l=f.offset.top,h=f.height,n="endDate"===a?u:0)}else f.wrapper&&e(f.wrapper).length&&(k=e(f.wrapper),p=k.offset()),k&&(g.left=p.left,l=p.top,h=k.outerHeight(),n=f.offset.left-p.left);
g.hasOwnProperty("left")&&"undefined"!==typeof h||(a=m.question.ask("DateInput.%s.%s".format(t,d===this.DateMode.RANGE?a:"startDate")),l=a.offset.top,h=a.height,g.left=a.offset.left);(a=this.shouldFlipDirection(l,h))&&!this.options.forceDownwards?(g.top=l-this.element.outerHeight(),this.element.addClass("up")):(g.top=l+h,this.element.removeClass("up"));l=Math.round(g.left);g=Math.round(g.top);n=Math.round(n);h=Math.round(this.element.outerWidth())+l-r;0<h&&(l-=h,n+=h);h=0;this.element.parent()[0]===
jq(document.body)[0]&&(h=parseInt((jq(document.body).css("top")||"0").replace("-",""))||0);"rtl"===document.dir&&(l=k?-(r-k.offset().left-k.outerWidth()):-(r-f.offset.left-f.width));k="translateX(%spx) translateY(%spx)".format(l,g+h);f="translateX(%spx)".format(n);k={transform:k,msTransform:k};f={transform:f,msTransform:f};b||this.options.inContent||this.element.css(k);c?this.pointer.css(f).removeClass("hidden"):this.pointer.addClass("hidden");this.animate=!0;!a&&this.getCurrentPicker()&&this.getCurrentPicker().autoScrollPosition&&
r>this.options.mobileBreakpoint&&(b=this.scrollToCalendar(g),0<b&&e("html, body").animate({scrollTop:e(window).scrollTop()+b},1E3));setTimeout(function(){this.animate&&this.element.addClass("animate")}.bind(this),1)}}},scrollToCalendar:function(a){a=e(window).scrollTop()+e(window).outerHeight()-a;return this.element.outerHeight(!0)-a},shouldFlipDirection:function(a,b){var c=e(window).scrollTop(),d=c+e(window).outerHeight(),m=this.element.outerHeight();return a+b+m>d&&!(a-m<c)},getMonthDate:function(a,
b){a=this.getCurrentDate().clone().add(a,"month");return b?a.endOf("month"):a.startOf("month")},onMonthChange:function(){m.events.publish("Calendar.monthchange",{group:this.getCurrentPicker().group})},open:function(a){if("undefined"===typeof this.pickers[a])throw Error('Picker %s not attached to the calendar. Please use "addPicker" to attach it to the calendar',a);a!==this.currentPickerId&&(this.switchPicker(a),this.animate=!1);this.element.attr("aria-expanded",!0);this.element.addClass("Summon");
setTimeout(function(){this.animate&&this.element.addClass("animate")}.bind(this),1);this.isOpen=!0},close:function(a){this.isOpen&&this.currentPickerId===a&&(this.element.attr("aria-expanded",!1),this.element.removeClass("Summon animate"),this.isOpen=!1)},getInitDate:function(a){a=a?moment(a):this.now.clone();a.isBefore(this.now)&&!this.options.allowPastDates&&(a=this.now.clone());return a},getSelectableDays:function(a){var b=this.months.children().find(".col-day[data-val]").not(".disabled");return a&&
0>a.indexOf("%s")?b.filter(a):b},getDayElement:function(a){a=moment(a).valueOf();return this.element.find(".col-day[data-val\x3d%s]".format(a))},hideTooltip:function(){this.element.find(".dayTip").hide()},highlightDates:function(a){this.getSelectableDays(a.join(",")).addClass("highlighted")},markFlex:function(a){this.getSelectableDays(a.join(",")).addClass("flex")},markStartDate:function(a){this.selectDate(a).addClass("startDate")},selectDates:function(a){return this.getSelectableDays(a.join(",")).addClass("selected").attr("aria-selected",
"true")},selectDate:function(a){a=this.getDayElement(a);a.addClass("selected").attr("aria-selected","true");return a},markEndDate:function(a){this.selectDate(a).addClass("endDate")},markPreviewDates:function(a){this.getSelectableDays(a.join(",")).addClass("preview")},isDifferentPicker:function(a){return this.currentPickerId!==a},calculateMonthOffset:function(a){a=moment(a).startOf("month").diff(this.getCurrentDate().startOf("month"));a=Math.round(moment.duration(a).asMonths());0<a&&--a;return a},
offset:function(){return this.element.offset()},append:function(a){var b=this.getAppendElement(a);return null!==b&&this.appended!==a?(b.append(this.element.detach()),this.appended=a,!0):!1},buffer:function(a){return null!==this.getAppendElement(a)&&this.appended===a?(e("body").append(this.element.detach()),this.appended=null,!0):!1},getAppendElement:function(a){return a&&e(a).length?e(a):null}})})(R9,jQuery);(function(d,c){d.extend("DatePicker.BuzzData",{});var a={},b=null,e=null,g=d.DatePicker.BuzzData=function(){if(e)return e;e=this;return this};g.prototype={constructor:g,datePicker:null,form:null,vertical:"",update:function(a,b){this.datePicker=a;this.form=b;this.vertical=b.vertical;a=d.config.getBoolean("ui.calendar.buzz.hotels.enabled",!1);b=d.config.getBoolean("ui.calendar.buzz.flights.enabled",!1);a&&"hotels"===this.vertical&&this.updatePickerAccordingData(this.form.cityId,this.updateDatePicker.bind(this));
b&&"flights"===this.vertical&&this.updatePickerAccordingData(this.getFlightUrl(),this.updateDatePicker.bind(this))},fetch:function(a,b){this.form=a;this.vertical=a.vertical;a=d.config.getBoolean("ui.calendar.buzz.hotels.enabled",!1);var e=d.config.getBoolean("ui.calendar.buzz.flights.enabled",!1);a&&"hotels"===this.vertical&&this.updatePickerAccordingData(this.form.cityId,b);e&&"flights"===this.vertical&&this.updatePickerAccordingData(this.getFlightUrl(),b)},getFlightUrl:function(){var a=this.form,
b=this.getAirportCode(a.origin),e=this.getAirportCode(a.destination),c=a.departDate,a=a.isOneWay,g="";if(this.isEmpty(b))return null;g+=b+"/";if(this.isEmpty(e))return null;g=g+(e+"")+("?oneWay\x3d"+(a?"true":"false"));c&&(g+="\x26departDate\x3d"+c);return g},isEmpty:function(a){return!a||0===a.length},getAirportCode:function(a){if("undefined"!==typeof a){var b=/(([A-Z]{3}))/g,e=a.substr(0,3);if(""==e||0==e.indexOf("C-"))e=a.value+"",e=e.replace(/ /g,""),-1!=e.indexOf("(")&&(a=b.exec(e),null!=a&&
(e=a[0]));return c.trim(e)}return null},updatePickerAccordingData:function(a,e){if(a){var g=this.getCacheData(a),f=this;null!==g?e(g):(b&&4!==b.readyState&&b.abort(),b=c.ajax({type:"GET",url:"/api/search/buzzCalendar/"+this.vertical+"/"+a,dataType:"json"}).done(function(b){b.success&&(f.putCacheData(a,b),e(b))}))}},getCacheData:function(b){b=this.getKey(b);return a.hasOwnProperty(b)?a[b]:null},putCacheData:function(b,e){b=this.getKey(b);a[b]=e},getKey:function(a){return this.vertical+"_"+a},updateDatePicker:function(a){var b=
d.config.getBoolean("ui.calendar.buzz.prices",!1),e=d.config.getBoolean("ui.calendar.buzz.prices.low",!1),g="buzz-date-low";b&&(g="buzz-prices-low");c(".r9-datepicker-item",this.datePicker).each(function(){var f=c(this);f.removeClass(g);b&&c(".buzz-price",f).html("");var d=f.data("val");"undefined"!==typeof d&&(d=moment(d).format("YYYY-MM-DD"),a.dates&&a.dates.hasOwnProperty(d)&&"LOW"===a.dates[d]&&f.addClass("buzz-date-low"),b&&a.prices&&a.prices.hasOwnProperty(d)&&(d=a.prices[d],c(".buzz-price",
f).html(d.price),e&&"LOW"===d.rate&&f.addClass("buzz-prices-low")))})}}})(window.R9,window.jq||window.jQuery);
(function(d){R9.extend("Widgets.BaseCalendarWidget",{});(R9.Widgets.BaseCalendarWidget=function(){this.updateSettings()}).prototype={advanceStyling:!0,loadBuzzData:!1,buzzDataClass:"",buzzPrices:!1,updateSettings:function(){this.advanceStyling=R9.config.getBoolean("ui.calendar.advanceStyling",!0);this.loadBuzzData=R9.config.getBoolean("ui.calendar.loadBuzzData",!1);this.buzzDataClass=(this.buzzPrices=R9.config.getBoolean("ui.calendar.buzz.prices",!1))?"datepicker-buzz-prices":"datepicker-buzz-data";
this.wholeMonthSearch=!1;jq("body").hasClass("FlightsSearch")&&0<jq(".flexOpenflex").length&&0<jq(".Flights-Search-FlightSearchPage.vm-fd").length&&(this.wholeMonthSearch=R9.config.getBoolean("ui.flights.whole-month-search.enabled",!1),this.daterangePickerDefaultNavTab="specificDate",this.noOfNightsValue="6-8",this.flexSelectedYear=this.flexSelectedMonth="",this.flexPlusMinusChecked=!1)},buzzGraph:jq("\x3cdiv\x3e",{"class":"r9-datepicker-buzz-graph"}),buzzGraphFooter:jq("\x3cdiv\x3e",{"class":"r9-datepicker-buzz-graph-footer"}),
buzzGraphFooterInner1:jq("\x3cdiv\x3e",{"class":"noairports hidden"}),buzzGraphFooterInner2:jq("\x3cdiv\x3e",{"class":"duration hidden"}),buzzGraphFooterInner3:jq("\x3cdiv\x3e",{"class":"fixedstart hidden"}),buzzGraphFooterInner4:jq("\x3cdiv\x3e",{"class":"oneway hidden"}),buzzGraphFooterDetail:jq("\x3cspan\x3e",{"class":"detail"}),buzzGraphPriceRule:jq("\x3cdiv\x3e",{id:"graphpricebar","class":"r9-datepicker-buzz-graph-price"}),buzzGraphLowestPriceRule:jq("\x3cdiv\x3e",{id:"graphlowpricebar","class":"r9-datepicker-buzz-graph-price"}),
buzzGraphPriceValue:jq("\x3cdiv\x3e",{id:"graphprice","class":"r9-datepicker-buzz-graph-price-value"}),makeCalendarHTML:function(c){var a=function(){var a=this.makeBelowCalendarHTML();a&&0<a.length&&(b.push("\x3cdiv id\x3d'%s' class\x3d'belowCalendar'\x3e".format("below")),b.push(a),b.push("\x3c/div\x3e"))},b=[];this.options.showBuzzGraph&&(this.buzzGraph.html(this.buzzGraphPriceRule.prop("outerHTML")+this.buzzGraphLowestPriceRule.prop("outerHTML")+this.buzzGraphPriceValue.prop("outerHTML")),this.buzzGraphFooterInner1.html("Select airports to see recent best prices. \x3cspan class\x3d'detail'\x3e\x3c/span\x3e"),
this.buzzGraphFooterInner2.html("Best prices for \x3cspan id\x3d\"durationNumber\"\x3e\x3c/span\x3e day trips. \x3cspan class\x3d'detail'\x3e\x3c/span\x3e"),this.buzzGraphFooterInner3.html("Best prices for trips departing on \x3cspan id\x3d\"flexDepartDate\"\x3e\x3c/span\x3e. \x3cspan class\x3d'detail'\x3e\x3c/span\x3e"),this.buzzGraphFooterInner4.html("Best prices for one-way trips \x3cspan class\x3d'detail'\x3e\x3c/span\x3e"),this.buzzGraphFooter.html(this.buzzGraphFooterInner1.prop("outerHTML")+
this.buzzGraphFooterInner2.prop("outerHTML")+this.buzzGraphFooterInner3.prop("outerHTML")+this.buzzGraphFooterInner4.prop("outerHTML")));b.push("\x3cdiv class\x3d'r9-datepicker-pointer'\x3e\x3c/div\x3e");b.push("\x3cspan role\x3d'button' class\x3d'r9-datepicker-close'\x3e\x26times;\x3c/span\x3e");!0===this.options.belowContentOnTop&&a.call(this);b.push(this.makeTitleHTML(this.options.title));this.wholeMonthSearch&&b.push(this.makeCalendarTabNavHTML());var e=moment().startOf("day"),g=this.minDate,
g=g?moment(g):e;c=c?moment(c):g;if(null==c||!this.isPastDateAllowed()&&c<e)c=e;e=moment(c).subtract(1,"months");g=moment(c).add(1,"months");b.push(this.makeMonthCalendarHTML(c,e,"r9-datepicker-month-first",this.options.prevTitle));c.add(1,"months");b.push(this.makeMonthCalendarHTML(c,g,"r9-datepicker-month-last",this.options.nextTitle));b.push("\x3cdiv class\x3d'r9-datepicker-month-break'\x3e\x3c/div\x3e");this.options.showBuzzGraph&&(b.push(this.buzzGraph.prop("outerHTML")),b.push(this.buzzGraphFooter.prop("outerHTML")));
this.wholeMonthSearch&&b.push(this.makeCalendarSelectMonthHTML());this.options.belowContentOnTop||a.call(this);return b.join("")},makeTitleHTML:function(c){return'\x3cdiv class\x3d"r9-datepicker-title"\x3e\x3cspan\x3e'+c+'\x3c/span\x3e\x3ca class\x3d"r9-datepicker-title-close"\x3eX\x3c/a\x3e\x3c/div\x3e'},makeCalendarTabNavHTML:function(){var c=jq(document.createElement("div")),a=jq(document.createElement("div")).addClass("CalendarWidget-TabNav"),b=jq(document.createElement("div")).addClass("keel-grid distribute mainGrid"),
e=jq(document.createElement("div")).addClass("col-auto leftNavItems"),g=jq(document.createElement("div")).addClass("col-auto rightNavItems"),f=jq(document.createElement("div")).addClass("keel-grid leftNavItemsGrid"),d=jq(document.createElement("div")).addClass("keel-grid rightNavItemsGrid"),h=jq(document.createElement("div")).addClass("tabWrapper specificDate"),n=jq(document.createElement("div")).addClass("col-auto dateCol"),m=jq(document.createElement("span")).addClass("icon calendar").html('\x3csvg viewBox\x3d"0 0 13 14" xmlns\x3d"http://www.w3.org/2000/svg"\x3e\x3cpath d\x3d"M9.75 1.647h1.247c1.106 0 2.003.888 2.003 1.999v8.356A1.999 1.999 0 0 1 10.997 14H2.003A1.997 1.997 0 0 1 0 12.002V3.646a2 2 0 0 1 2.003-1.999H3.25V0h.813v1.647h4.875V0h.812v1.647zm0 .824h1.428c.558 0 1.01.446 1.01 1.007v8.691c0 .557-.446 1.007-1.01 1.007H1.822c-.558 0-1.01-.446-1.01-1.007V3.478c0-.556.446-1.007 1.01-1.007H3.25v.823h.813v-.823h4.875v.823h.812v-.823zM.812 4.94h11.376v.824H.812V4.94zM2.6 6.364h2v2h-2v-2z" fill\x3d"currentColor" fill-rule\x3d"evenodd"/\x3e\x3c/svg\x3e'),
l=jq(document.createElement("div")).addClass("tabWrapper wholeMonth"),r=jq(document.createElement("div")).addClass("col-auto dateMonth"),w=jq(document.createElement("span")).addClass("icon trend").html('\x3csvg viewBox\x3d"0 0 15 12" xmlns\x3d"http://www.w3.org/2000/svg"\x3e\x3cpath d\x3d"M0 12V5h3v7H0zm4 0V0h3v12H4zm4 0V5h3v7H8zm4 0V8h3v4h-3z" fill\x3d"currentColor" fill-rule\x3d"evenodd"/\x3e\x3c/svg\x3e'),p=jq(document.createElement("div")).addClass("col-auto plusMinus"),q=jq(document.createElement("span")).addClass("input flexPlusMinus"),
u=jq(document.createElement("div")).addClass("tabUnderlay no-transition");"undefined"!==typeof R9.storage&&(null!==R9.storage.get("daterangePickerDefaultNavTab")&&"wholeMonth"!==R9.storage.get("daterangePickerDefaultNavTab")||R9.storage.set("daterangePickerDefaultNavTab","specificDate"),this.daterangePickerDefaultNavTab=R9.storage.get("daterangePickerDefaultNavTab"),null===R9.storage.get("flexPlusMinusChecked")&&R9.storage.set("flexPlusMinusChecked",!1),this.flexPlusMinusChecked=R9.storage.get("flexPlusMinusChecked"));
"wholeMonthSearch"==this.daterangePickerDefaultNavTab?(l.addClass("selected"),u.addClass("wholeMonth"),p.hide()):(h.addClass("selected"),u.addClass("specificDate"));this.flexPlusMinusChecked&&q.addClass("checked");c.append(a.append(b.append(e.append(f.append(n.append(h.text("Date").addClass("v-c-p").prepend(m)),r.append(l.text("Flex Month").prepend(w).append(jq(document.createElement("span")).addClass("newTag").text("new"))))),g.append(d.append(p.append(jq(document.createElement("div")).addClass("likeTabWrapper").append(q.text("\u00b1 3 days")))))),
u));return c.html()},makeCalendarSelectMonthHTML:function(){"undefined"!==typeof R9.storage&&(null===R9.storage.get("flexNoOfNights")&&R9.storage.set("flexNoOfNights","6-8"),this.noOfNightsValue=R9.storage.get("flexNoOfNights"));var c=jq(document.createElement("div")),a=jq(document.createElement("div")).addClass("CalendarWidget-MonthSelect"),b=jq(document.createElement("div")).addClass("keel-grid mainGrid"),e=jq(document.createElement("div")).addClass("col"),g=jq(document.createElement("div")).addClass("col"),
f=jq(document.createElement("div")).addClass("keel-grid keel-form topColGrid"),d=jq(document.createElement("div")).addClass("keel-grid bottomColGrid"),h=jq(document.createElement("div")).addClass("col"),n=jq(document.createElement("div")).addClass("col noOfNightsInputCol"),m=jq(document.createElement("input")).addClass("Common-Widgets-Text-TextInput selectTextOnFocus noOfNightsInput").attr({type:"text",id:"noOfNightsInput",name:"noOfNightsInput",value:this.noOfNightsValue}),l=jq(document.createElement("label")).addClass("nightsAtDestination").text("nights"),
r=jq(document.createElement("div")).addClass("col subTextCol"),w=jq(document.createElement("div")).addClass("col"),p=jq(document.createElement("div")).addClass("keel-grid monthSelectGrid");c.append(a.append(b.append(e.append(f.append(h.text("Number of nights:"),n.append(m,l),r.text("Not sure how long? Use a range, like 10-12 nights."))),g.append(d.append(w.append(p))))));for(a=0;12>a;a++)"undefined"!==typeof R9.storage&&(null===R9.storage.get("flexSelectedMonth")&&R9.storage.set("flexSelectedMonth",
moment().format("M")),null===R9.storage.get("flexSelectedYear")&&R9.storage.set("flexSelectedYear",moment().format("Y")),this.flexSelectedMonth=R9.storage.get("flexSelectedMonth"),this.flexSelectedYear=R9.storage.get("flexSelectedYear")),b=jq(document.createElement("div")).addClass("col-1-3 col-1-4-l centre"),e=jq(document.createElement("div")).addClass("monthWrapper"),g=moment().add(a,"M").format("M"),f=moment().add(a,"M").daysInMonth(),d=moment().add(a,"M").format("Y"),h=jq(document.createElement("div")).addClass("monthName").text(moment().add(a,
"M").format("MMMM")),n=jq(document.createElement("div")).addClass("shortMonthName").text(moment().add(a,"M").format("MMM")),m=jq(document.createElement("div")).addClass("monthYear").text(moment().add(a,"M").format("Y")),this.flexSelectedMonth==g&&this.flexSelectedYear==d&&e.addClass("selected"),p.append(b.append(e.append(h,n,m).attr("data-month",g).attr("data-year",d).attr("data-end-of-month",f)));return c.html()},makeBelowCalendarHTML:function(){return""},runBelowCalendarCallback:function(){},makeMonthCalendarHTML:function(c,
a,b,e){var g=[];g.push("\x3cdiv class\x3d'r9-datepicker-month "+b+"'\x3e");g.push(this.makeMonthHeaderHTML(c,a,e));g.push(this.makeMonthBodyHTML(c,e));g.push("\x3c/div\x3e");return g.join("")},showMonth:function(c){var a=[];a.push("\x3cspan class\x3d'r9-datepicker-month-name'\x3e");a.push(c.format(this.options.titleMonthFormat).substring(0,1).toUpperCase()+c.format(this.options.titleMonthFormat).substring(1,this.options.titleMonthFormatLen));a.push("\x3c/span\x3e");return a.join("")},showYearWithSpecialSymbol:function(c){var a=
[],b;R9&&R9.globals&&(b=R9.globals.reverseDatePickerMonthAndYear);a.push("\x3cspan class\x3d'r9-datepicker-year'\x3e");a.push(c.format(this.options.titleYearFormat)+b+" ");a.push("\x3c/span\x3e");return a.join("")},showMonthAndYear:function(c){var a=[];a.push(this.showMonth(c));a.push(this.showYearWithSpecialSymbol(c));return a.join("")},makeMonthHeaderHTML:function(c,a,b){var e=[],g=moment().startOf("month"),f=moment().add(11,"months"),d=moment(a).startOf("month"),h=moment(a).endOf("month"),n=this.maxDate,
m=this.minDate,l=this.getStartDate&&moment(this.getStartDate()),r=this.getEndDate&&moment(this.getEndDate()),l=l&&h.isBefore(l)&&this.isPastDateAllowed(),r=r&&h.isBefore(r),m=m&&h.isBefore(m),n=n&&d.isAfter(n),g=!l&&!r&&(m||n||!this.isPastDateAllowed()&&h.isBefore(g)||d.isAfter(f));e.push("\x3cspan class\x3d'r9-datepicker-month-header'\x3e");e.push("\x3ca title\x3d'"+b+"' class\x3d'r9-datepicker-switch-month "+(g?"r9-datepicker-disabled":"r9-datepicker-enabled")+"' data-val\x3d'"+a.valueOf()+"'\x3e");
e.push(this.makeMonthHeaderPickerHTML(b));e.push("\x3c/a\x3e");e.push("\x3cspan class\x3d'r9-datepicker-month-title'\x3e");e.push(this.showMonthAndYear(c));e.push("\x3c/span\x3e");e.push("\x3c/span\x3e");return e.join("")},makeMonthHeaderPickerHTML:function(c){var a=[];a.push("\x3cspan\x3e");a.push(c);a.push("\x3c/span\x3e");return a},makeMonthBodyHTML:function(c,a){var b=[];b.push("\x3cspan class\x3d'r9-datepicker-month-body'\x3e");b.push(this.makeWeekDaysHTML(c));b.push(this.makeMonthDatesHTML(c,
a));b.push("\x3c/span\x3e");return b.join("")},makeWeekDaysHTML:function(c){c=[];c.push("\x3cspan class\x3d'r9-datepicker-month-days'\x3e");for(var a=0+this.getFirstWeekDay();a<7+this.getFirstWeekDay();a++){var b=a%7;c.push("\x3cspan class\x3d'r9-datepicker-day'\x3e");c.push(this.getVeryShortDayName(b));c.push("\x3c/span\x3e")}c.push("\x3c/span\x3e");return c.join("")},makeMonthDatesHTML:function(c,a){var b=[];b.push("\x3cspan class\x3d'r9-datepicker-month-dates'\x3e");var e=this.getMonthLeadDays(c),
g=this.getDaysInMonth(c),f=moment().startOf("day"),d=moment(c).subtract(1,"months").startOf("month"),h=d.daysInMonth(),n=moment(c).add(1,"months").startOf("month"),m=moment(f).add(1,"year"),l=this.maxDate,r,w,p,q,u=this.minDate,t=1;a=a.toLowerCase();this.getStartDate&&this.getStartDate();for(var v=0;42>v;v++){r=v-e+1;q=moment([c.year(),c.month(),r]);w=v%7;p=Math.ceil((v+1)/7);0==w&&b.push("\x3cspan class\x3d'r9-datepicker-month-row "+(this.loadBuzzData?this.buzzDataClass:"")+"' aria-label\x3d'Week "+
p+"' role\x3d'week'\x3e");if(v<e&&"prev"===a&&!this.advanceStyling){var x=moment([d.year(),d.month(),h+v-e+1]);p="r9-datepicker-item r9-datepicker-othermonth-item";p=(q.isBefore(f)||q.isAfter(m))&&!this.isPastDateAllowed()||u&&q.isBefore(u)||l&&q.isAfter(l)?p+" r9-datepicker-disabled":p+" r9-datepicker-enabled";this.addGraphBar(!1,x.valueOf());b.push("\x3cspan role\x3d'gridcell' class\x3d'"+p+"' data-val\x3d'"+x.valueOf()+"'\x3e");b.push("\x3cspan\x3e"+(h+v-e+1));this.loadBuzzData&&(this.buzzPrices?
b.push("\x3cspan class\x3d'buzz-price'\x3e\x3c/span\x3e"):(b.push("\x3cspan class\x3d'buzz-message'\x3eGreat price\x3c/span\x3e"),b.push("\x3ci\x3e\x3c/i\x3e")));b.push("\x3c/span\x3e\x3c/span\x3e")}else if(v>=e+g&&"next"===a&&!this.advanceStyling)x=moment([n.year(),n.month(),t]),p="r9-datepicker-othermonth-item r9-datepicker-item",p=(q.isBefore(f)||q.isAfter(m))&&!this.isPastDateAllowed()||u&&q.isBefore(u)||l&&q.isAfter(l)?p+" r9-datepicker-disabled":p+" r9-datepicker-enabled",b.push("\x3cspan role\x3d'gridcell' class\x3d'"+
p+"' data-val\x3d'"+x.valueOf()+"'\x3e"),b.push("\x3cspan\x3e"+t++),this.loadBuzzData&&(this.buzzPrices?b.push("\x3cspan class\x3d'buzz-price'\x3e\x3c/span\x3e"):(b.push("\x3cspan class\x3d'buzz-message'\x3eGreat price\x3c/span\x3e"),b.push("\x3ci\x3e\x3c/i\x3e"))),b.push("\x3c/span\x3e\x3c/span\x3e"),this.addGraphBar(!1,x.valueOf());else if(v>=e+g&&("next"!==a||this.advanceStyling))break;else v<e&&("Prev"!==a||this.advanceStyling)?b.push("\x3cspan role\x3d'gridcell' class\x3d'r9-datepicker-item r9-datepicker-disabled'\x3e\x3cspan\x3e\x26nbsp;\x3c/span\x3e\x3c/span\x3e"):
(p="r9-datepicker-item",(q.isBefore(f)||q.isAfter(m))&&!this.isPastDateAllowed()||u&&q.isBefore(u)||l&&q.isAfter(l)?(p+=" r9-datepicker-disabled",x=!1):(p+=" r9-datepicker-enabled",x=!0),q.isSame(f)&&(p+=" r9-datepicker-today"),b.push("\x3cspan role\x3d'gridcell' class\x3d'"+p+"' "),this.addGraphBar(x,q.valueOf()),b.push("data-val\x3d'"+q.valueOf()+"'"),b.push("\x3e\x3cspan\x3e"),b.push(r),this.loadBuzzData&&(this.buzzPrices?b.push("\x3cspan class\x3d'buzz-price'\x3e\x3c/span\x3e"):(b.push("\x3cspan class\x3d'buzz-message'\x3eGreat price\x3c/span\x3e"),
b.push("\x3ci\x3e\x3c/i\x3e"))),b.push("\x3c/span\x3e\x3c/span\x3e"));if(6==w&&(b.push("\x3c/span\x3e"),r===g||1<t))break}b.push("\x3c/span\x3e");return b.join("")},getFirstWeekDay:function(){return moment().startOf("week").day()},getVeryShortDayName:function(c){return moment().day(c).format("dd").substring(0,this.options.shortDayNameLen)},getMonthLeadDays:function(c){c=this.getFirstMonthDay(c)-this.getFirstWeekDay();0>c&&(c=6);return c},getFirstMonthDay:function(c){c=moment(c);c.startOf("month");
return c.day()},getDaysInMonth:function(c){return c.daysInMonth()},insideLastCalendar:function(c){return!!this.dropdown.find(".r9-datepicker-item-"+c).closest(".r9-datepicker-month").hasClass("r9-datepicker-month-last")},isPastDateAllowed:function(){return"undefined"!=this.options.allowPastDate?this.options.allowPastDate:!1},addGraphBar:function(c,a){this.options.showBuzzGraph&&(c=jq("\x3cdiv\x3e",{"class":"r9-datepicker-buzz-day "+(c?"r9-datepicker-enabled":"r9-datepicker-disabled"),"data-val":a}),
c.append(jq("\x3cdiv\x3e",{"class":"r9-datepicker-buzz-bar"})),this.buzzGraph.append(c))}}})(jq||jQuery);
(function(d){function c(a,b,e){var c,f,d,h,n,m=Date.now||function(){return(new Date).getTime()},l=function(){var g=m()-h;g<b&&0<=g?c=setTimeout(l,b-g):(c=null,e||(n=a.apply(d,f),c||(d=f=null)))};return function(){d=this;f=arguments;h=m();var g=e&&!c;c||(c=setTimeout(l,b));g&&(n=a.apply(d,f),d=f=null);return n}}R9.extend("Widgets",{DaterangePicker:function(a,b){R9.Widgets.BaseCalendarWidget.apply(this);this.elementNode=a;this.element=d(this.elementNode);this.validateElement()&&(this.startSection=d(R9.Widgets.DaterangePicker.findStartSection(this.elementNode)),
this.startDisplay=d(R9.Widgets.DaterangePicker.findStartDisplay(this.elementNode)),this.startPlaceholderDisplay=d(R9.Widgets.DaterangePicker.findStartPlaceholderDisplay(this.elementNode)),this.endSection=d(R9.Widgets.DaterangePicker.findEndSection(this.elementNode)),this.endDisplay=d(R9.Widgets.DaterangePicker.findEndDisplay(this.elementNode)),this.endPlaceholderDisplay=d(R9.Widgets.DaterangePicker.findEndPlaceholderDisplay(this.elementNode)),this.summaryDisplay=d(R9.Widgets.DaterangePicker.findSummaryDisplay(this.elementNode)),
this.clearDisplay=d(R9.Widgets.DaterangePicker.findClearDisplay(this.elementNode)),this.closeLink=d(R9.Widgets.DaterangePicker.findCloseLink(this.elementNode)),this.tabInput=d(R9.Widgets.DaterangePicker.findTabInput(this.elementNode)),this.startInput=d(R9.Widgets.DaterangePicker.findStartInput(this.elementNode)),this.endInput=d(R9.Widgets.DaterangePicker.findEndInput(this.elementNode)),this.options=d.extend({},this.options,b),this.init())}});R9.extend("Widgets.DaterangePicker",{isDatepicker:function(a){return a&&
a.nodeName&&"div"==a.nodeName.toLowerCase()},isWidgetControlled:function(a){return d(a).hasClass(R9.Widgets.DaterangePicker.prototype.widgetBaseClass+"-wrapper")},findStartSection:function(a){return d(a).closest("form").find("#"+a.id+"-start")},findStartDisplay:function(a){return d(a).closest("form").find("#"+a.id+"-start-display")},findStartPlaceholderDisplay:function(a){return d(a).closest("form").find("#"+a.id+"-start-placeholder")},findEndSection:function(a){return d(a).closest("form").find("#"+
a.id+"-end")},findEndDisplay:function(a){return d(a).closest("form").find("#"+a.id+"-end-display")},findEndPlaceholderDisplay:function(a){return d(a).closest("form").find("#"+a.id+"-end-placeholder")},findSummaryDisplay:function(a){return d(a).closest("form").find("#"+a.id+"-summary-display")},findClearDisplay:function(a){return d(a).closest("form").find("#"+a.id+"-clear")},findCloseLink:function(a){return d(a).closest("form").find("#"+a.id+" .r9-datepicker-title-close")[0]},findStartInput:function(a){return d(a).closest("form").find("#"+
a.id+" .r9-datepicker-input.r9-datepicker-start")[0]},findEndInput:function(a){return d(a).closest("form").find("#"+a.id+" .r9-datepicker-input.r9-datepicker-end")[0]},findTabInput:function(a){return d(a).closest("form").find("#"+a.id+"-tab")},getDropdownId:function(a){return"datepicker"},getDropdownEl:function(a){return jq(a).find("#datepicker")}});R9.extend("Widgets.DaterangePicker.prototype",!0,R9.Widgets.BaseCalendarWidget.prototype,{widgetName:"datepicker",widgetId:"datepicker",widgetBaseClass:"r9-datepicker",
accessibilityBreakpoint:768,elementNode:null,element:null,startSection:null,startDisplay:null,startPlaceholderDisplay:null,endSection:null,endDisplay:null,endPlaceholderDisplay:null,summaryDisplay:null,clearDisplay:null,closeLink:null,startInput:null,endInput:null,tabInput:null,clicks:[],timers:null,hideTimeoutValue:100,unitFormat:null,unitAdjustment:0,preventBlur:!1,actOnStart:!0,buzzCall:!1,canShowCalendar:!0,canCloseCalendar:!0,options:{initAccessibility:!1,accessible:!0,appendTo:"body",dateItemsSelector:"span.r9-datepicker-item",
shortDayNameLen:1,title:"Prev",prevTitle:"Prev",nextTitle:"Next",offsetWidth:0,titleMonthFormat:"MMMM",titleYearFormat:"YYYY",startFormat:"ddd MMM D",startInputFormat:"YYYY/M/D",endFormat:"ddd MMM D",endInputFormat:"YYYY/M/D",nightsFormat:"0#same day|1#{0} night|2#{0} nights",daysFormat:"0#same day|1#{0} day|2#{0} days",useDaysFormat:!1,secondClickHideDelay:200,minRangeDays:0,change:null,show:null,hide:null,minDateFunc:null,focusAfterClick:!0,allowPastDate:!1,widgetId:null,useLongDisplayFormat:!1,
singlePickerWithSingleField:!1,showBuzzGraph:!1,originControl:!1,destControl:!1,isOneWay:!1,skipForceSetDefaultStartOnFocusBlur:!1,skipForceSetDefaultEndOnFocusBlur:!1,doNotFillWhenEmpty:!1,datepickerWrapperSelector:".r9-datepicker-wrapper",handleNegativeSummary:!0,delayShowDropdown:null,showDropdownDelay:200},getWidgetId:function(){this.options&&this.options.widgetId&&(this.widgetId=this.options.widgetId);return this.widgetId},getDropdownId:function(a){return this.options&&this.options.widgetId?
this.options.widgetId:R9.Widgets.DaterangePicker.getDropdownId(a)},getDropdownEl:function(a){return this.options&&this.options.widgetId?jq(a).find("#"+this.options.widgetId):R9.Widgets.DaterangePicker.getDropdownEl(a)},isAccessibilityEnabled:function(){return this.options.initAccessibility},init:function(){this.options.useDaysFormat?(this.unitFormat=this.options.daysFormat,this.unitAdjustment=1):(this.unitFormat=this.options.nightsFormat,this.unitAdjustment=0);this.options.useLongDisplayFormat&&(this.options.startFormat=
this.options.startInputFormat,this.options.endFormat=this.options.endInputFormat);this.advanceStyling&&(this.options.skipForceSetDefaultStartOnFocusBlur=!0,this.options.skipForceSetDefaultEndOnFocusBlur=!0,this.options.doNotFillWhenEmpty=!0);this.options.offsetWidth=2;this.initDropdown();this.timers={};this.bindEvent(this.tabInput,"focus",this.handleInputFocusEvent);this.bindEvent(this.tabInput,"blur",this.handleInputBlurEvent);this.bindEvent(this.tabInput,"keydown",this.handleInputKeydownEvent);
this.bindEvent(this.element,"mousedown",this.handleElementClickEvent);this.endStartIsSameField()||this.bindEvent(this.endSection,"mousedown",this.handleEndClickEvent);this.bindEvent(this.startSection,"mousedown",this.handleStartClickEvent);this.bindEvent(this.clearDisplay,"mousedown",this.handleClearClickEvent);this.bindEvent(this.closeLink,"mousedown",this.handleClearClickEvent);this.bindEvent(this.dropdown,"mousedown",this.handleDropdownClickEvent);this.bindEvent(this.overlay,"mousedown",this.handleItemClickEvent);
this.element.data(this.widgetName,this);this.update();var a=this.element.find(".r9-datepicker-display");void 0!==a&&1<a.length||(this.element.off("mousedown focus").on("mousedown focus",function(a){a.preventDefault();a.stopPropagation();jq(this).find(".r9-datepicker-display").focus();jq("body").trigger("event",[a])}),this.bindCommandUtilities(),this.start_custom_value=this.end_custom_value="",this.utils=this.options.commands.utilities,this.today=moment().startOf("day").toDate(),this.bindAccessibilityEvents(),
this.updateClicks(),this.updateDOM())},validateElement:function(){return R9.Widgets.DaterangePicker.isDatepicker(this.elementNode)&&R9.Widgets.DaterangePicker.isWidgetControlled(this.elementNode)&&void 0===this.element.data(this.widgetName)},bindEvent:function(a,b,e){var c=this;b+="."+this.getWidgetId();a.off(b).on(b,function(a){return e.call(c,this,a)})},bindCommandUtilities:function(){var a=this;this.options.commands={keys:{TAB:9,ENTER:13,UP:38,DOWN:40,LEFT:37,RIGHT:39,DOLLAR:52,CARAT:54,ESC:27},
utilities:{changeCalendar:function(b,e){e=e||1;var c=a.dropdown.find(".r9-datepicker-switch-month.r9-datepicker-enabled"),c="prev"===b?c.first():c.last();for(b=Math.abs(e);0<b;b--)a.handleNextPrevClickEvent(c);return a},isCharacterKeyPress:function(b){var e=a.options.commands.keys;return"undefined"==typeof b.which?!0:"number"==typeof b.which&&0<b.which?!b.ctrlKey&&!b.metaKey&&!b.altKey&&b.keyCode!=e.TAB&&b.keyCode!=e.ENTER&&16!=b.keyCode&&b.keyCode!=e.UP&&b.keyCode!=e.DOWN&&b.keyCode!=e.LEFT&&b.keyCode!=
e.RIGHT:!1},getRowInfo:function(b){b=a.dropdown.find(".r9-datepicker-item-"+b);var e=b.parent().children().not(".r9-datepicker-disabled");return{len:e.length-1,index:e.index(b)}},isValidDateObject:function(a){return a instanceof Date?!isNaN(a.getTime()):this.isValidDate(new Date(a))},isValidDatePair:function(a,e){return moment(a).isBefore(moment(e))},isValidDate:function(b){return this.isValidDateObject(b)&&(this.isValidDatePair(moment().subtract(1,"d"),moment(b))||a.isPastDateAllowed())},applyEndVal:function(){if(""!==
a.end_custom_value&&moment(a.end_custom_value,a.options.endInputFormat).isValid()){var b=this.formatLocaleDate(a.end_custom_value,a.options.endInputFormat);if(b&&this.isValidDate(b)){var e=a.getStartDate()||a.today;this.isValidDatePair(e,b)&&a.setEndDate(b);a.fetchBuzzData();a.options.change&&a.options.change.call(a);a.end_custom_value=""}}},applyStartVal:function(){if(""!==a.start_custom_value&&moment(a.start_custom_value,a.options.startInputFormat).isValid()){var b=this.formatLocaleDate(a.start_custom_value,
a.options.startInputFormat);if(b&&this.isValidDate(b)){a.setStartDate(b);var e=a.getEndDate()||a.today;this.isValidDatePair(b,e)||a.setEndDate(b);a.start_custom_value="";a.fetchBuzzData();a.options.change&&a.options.change.call(a)}}},validate:function(b){b=b||moment().startOf("day").toDate();return!a.isPastDateAllowed()&&b.getTime()<=a.today.getTime()?a.today:b},formatLocaleDate:function(b,e){e=e||a.options.startInputFormat;try{var c=b.split(/\D+/g)[2];4!==c.length&&(b=b.substr(0,b.length-2)+"20"+
c);return moment(b,e).toDate()}catch(f){return new Date}},incrementDay:function(b,e,c){c=c||jq.noop;b=moment(b).add(e||1,"days");c.call(a,this.validate(b.toDate()));return b},decrementDay:function(b,e,c){c=c||jq.noop;b=moment(b).subtract(e||1,"days");c.call(a,this.validate(b.toDate()));return b},dateDiff:function(a,e){return(a.getTime()-e.getTime())/864E5}}};this.utils=this.options.commands.utilities;return this},bindAccessibilityEvents:function(){var a=this;this.options.accessible="true"===jq(this.startDisplay).attr("contenteditable");
jq(this.startDisplay).attr("aria-label")||jq(this.startDisplay).attr({"aria-label":this.options.startLabel||"Start Date"});jq(this.endDisplay).attr("aria-label")||jq(this.endDisplay).attr({"aria-label":this.options.endLabel||"End Date"});this.clickTarget=this.blurTarget=null;jq(document).mousedown(function(b){a.clickTarget=jq(b.target);a.isDropdownVisible()&&jq(a.blurTarget).blur()}).mouseup(function(b){a.clickTarget=null});this.endStartIsSameField()||(this.bindEvent(this.endDisplay,"focus",this.handleEndDisplayFocusEvent),
this.bindEvent(this.endDisplay,"blur",this.handleEndDisplayBlurEvent),this.bindEvent(this.endDisplay,"keydown",this.handleEndDisplayKeydownEvent),this.bindEvent(this.endDisplay,"keyup",this.handleEndDisplayKeyupEvent));this.bindEvent(this.startDisplay,"focus",this.handleStartDisplayFocusEvent);this.bindEvent(this.startDisplay,"blur",this.handleStartDisplayBlurEvent);this.bindEvent(this.startDisplay,"keydown",this.handleStartDisplayKeydownEvent);this.bindEvent(this.startDisplay,"keyup",this.handleStartDisplayKeyupEvent);
this.isAccessibilityEnabled()&&(this.bindEvent(jq(document),"keypress",this.handleItemKeypressEvent),this.bindEvent(jq(document),"click",this.handleOutsideClickEvent))},handleClearClickEvent:function(a,b){this.clearDaterange();b.stopPropagation();this.fetchBuzzData();this.options.change&&this.options.change.apply(this,arguments);jq("body").trigger("event",[b]);return!this.element.hasClass("r9-datepicker-focus")},handleElementClickEvent:function(a,b){return this.isDropdownVisible()?this.handleClickEvent(a,
b,this.actOnStart):this.handleStartClickEvent(a,b)},handleStartClickEvent:function(a,b){return this.handleClickEvent(a,b,!0)},handleEndClickEvent:function(a,b){return this.handleClickEvent(a,b,!1)},handleClickEvent:function(a,b,e){this.actOnStart=e;var c=this.getWrapperElement(),f=this;!this.isDropdownVisible()&&this.options.focusAfterClick?setTimeout(function(){f.isDropdownVisible()||c.find(".r9-datepicker-tab").focus()},1):(this.markDropdownElements(),this.preventBlur=!0);b.stopPropagation();jq("body").trigger("event",
[b]);return!0},getWrapperElement:function(){return this.element},getStartWrapperElement:function(){return this.element},getEndWrapperElement:function(){return this.element},handleDropdownClickEvent:function(a,b){return!1},handleInputKeydownEvent:function(a,b){if(!a.disabled){var e=b.keyCode?b.keyCode:b.which,c=jq(a).parent();switch(e){case 9:return!0;case 27:this.isDropdownVisible()&&this.hideDropdown(c);break;case 32:this.isDropdownVisible()?this.hideDropdown(c):(this.actOnStart=!0,this.showDropdown(c));
break;case 8:this.clearDaterange(),this.fetchBuzzData(),this.options.change&&this.options.change.apply(this,arguments)}return!1}},handleInputFocusEvent:function(a,b){if(!a.disabled){this.preventBlur=!1;var e=jq(a).parent();this.addFocusClass(e);this.isDropdownVisible()||this.showDropdown(e);this.options.focus&&this.options.focus.apply(this,arguments)}},handleInputBlurEvent:function(a,b){if(this.preventBlur)return this.preventBlur=!1,setTimeout(function(){a.focus()},1),!1;if(a.disabled)return!0;this.hideDropdown(jq(a).parent());
this.options.blur&&this.options.blur.apply(this,arguments);return!0},handleItemHoverEvent:function(a,b){a=jq(a);a.hasClass("r9-datepicker-enabled")&&this.updateDropdownSelection(a);jq(".r9-datepicker-buzz-day[data-val\x3d%s]".format(a.attr("data-val"))).addClass("hover");return!1},handleItemHoverEndEvent:function(a,b){this.updateDropdownSelection(null);jq(".r9-datepicker-buzz-day[data-val\x3d%s]".format(jq(a).attr("data-val"))).removeClass("hover");return!1},handleItemKeypressEvent:function(a,b){if(13===
b.which&&jq(b.target).is(this.options.dateItemsSelector))return a=jq(b.target).closest(this.options.dateItemsSelector),b.stopPropagation(),b.preventDefault(),b.cancelBubble=!0,this.clickTarget=a,this.handleItemClickEvent(a,b),!1;if(13===b.which&&jq(b.target).is(".r9-datepicker-switch-month.r9-datepicker-enabled"))return a=jq(b.target).closest(".r9-datepicker-switch-month.r9-datepicker-enabled"),b.stopPropagation(),b.preventDefault(),b.cancelBubble=!0,this.clickTarget=a,this.handleNextPrevClickEvent(a,
b),!1},handleOutsideClickEvent:function(a,b){this.clickTarget=d(b.target);this.isDropdownVisible()&&!this.clickTarget.closest(".r9-datepicker, .r9-datepicker-wrapper").length&&(this.clickTarget=null,b.stopPropagation(),this.hideDropdown())},focusSelectedDay:function(a){var b=this;this.isAccessibilityEnabled()&&a&&a.length&&(this.clickTarget=null,this.dropdown.attr("tabindex",-1),this.dropdown.removeClass("r9-calendar-no-outline").addClass("r9-calendar-no-outline"),this.setTabIndexes(this.dropdown.find(".r9-datepicker-switch-month.r9-datepicker-enabled, .r9-datepicker-item.r9-datepicker-enabled")),
this.timers.focusTimeout&&clearTimeout(this.timers.focusTimeout),b.setCanClose(!1),this.timers.focusTimeout=window.setTimeout(function(){var e=b.isEndWrapper(a)?b.dropdown.find(".r9-datepicker-item-end"):b.dropdown.find(".r9-datepicker-item-start");e.length||(e=b.dropdown.find(".r9-datepicker-item.r9-datepicker-enabled").first()||null);e&&e.length&&e.focus();b.timers.setCanClose&&clearTimeout(b.timers.setCanClose);b.timers.setCanClose=setTimeout(function(){b.setCanClose(!0)},200)},300))},isEndWrapper:function(a){return a&&
this.isEndWrapperId(a.attr("id"))},isEndWrapperId:function(a){return a&&"travel_dates-end-wrapper"==a},setTabIndexes:function(a){(a=jq(a))&&0!==a.length&&a.each(function(){jq(this).attr("tabindex","0")})},focusDisplay:function(a){var b=this;if(this.isAccessibilityEnabled()){var e=jq("#"+a);e&&0!==e.length&&(this.timers.focusDisplayTimeout&&clearTimeout(this.timers.focusDisplayTimeout),!this.isDropdownVisible()&&this.clickTarget&&this.clickTarget.closest(".r9-datepicker").length&&(this.clickTarget=
null,this.addFocusClass(e),this.setCanShow(!1),this.setCanClose(!1),this.timers.focusDisplayTimeout=window.setTimeout(function(){e.find(".r9-datepicker-tab").focus();b.timers.setCanShow&&clearTimeout(b.timers.setCanShow);b.timers.setCanShow=setTimeout(function(){b.setCanShow(!0);b.setCanClose(!0)},200)},1)))}},canShow:function(){return!this.isAccessibilityEnabled()||this.canShowCalendar},setCanShow:function(a){this.canShowCalendar=a},canClose:function(){return!this.isAccessibilityEnabled()||this.canCloseCalendar},
setCanClose:function(a){this.canCloseCalendar=a},clearFocusClass:function(){this.removeFocusClass(jq(".r9-datepicker-focus"))},removeFocusClass:function(a){a.removeClass("r9-datepicker-focus")},addFocusClass:function(a){this.clearFocusClass();a.addClass("r9-datepicker-focus")},handleItemClickEvent:function(a,b){if(!0===this.isBeforeStart(a)&&!1===this.actOnStart)return this.preventBlur=!0,b.preventDefault(),this;var e=this,c=jq(a),f,d;if(c.hasClass("r9-datepicker-enabled")){f=parseInt(c.attr("data-val"));
var h=this.actOnStart;d=h?1:0;this.clicks[h?0:1]=f;this.clicks[0]&&this.clicks[1]&&(c=moment(this.clicks[1]).diff(this.clicks[0],"days"),c<this.options.minRangeDays&&(this.clicks[d]=0));this.updateDropdownSelection(null);this.clicks[0]&&this.clicks[1]?setTimeout(function(){e.hideDropdown(e.element);e.options.change&&e.options.change.apply(e,[f,h]);e.options.nextFieldSelector&&jq(e.options.nextFieldSelector).focus()},this.options.secondClickHideDelay):this.switchActOn()}this.updateDOM();jq(a).trigger("daterangepicker.itemclicked");
jq("body").trigger("event",[b]);return!1},switchActOn:function(){this.actOnStart=!this.actOnStart;this.markDropdownElements()},computeHighlitedRange:function(a){var b=[this.clicks[0],this.clicks[1]];return b[0]&&b[1]?b:0==a?[0,0]:this.actOnStart?[a,this.clicks[1]]:this.clicks[0]?[this.clicks[0],a]:[0,0]},computeItemState:function(a,b,e,c,f){var g=!1;this.advanceStyling||(a==b?this.actOnStart?(c.hover=!0,c.start=!0):(c.hover=!0,c.end=!0,c.highlighted=f&&f.highlighted):(c.beforeStart=a<this.clicks[0]&&
!this.actOnStart,a==this.clicks[0]?(c.start=!0,c.selected=!0):a==this.clicks[1]&&(c.selected=!0,c.end=!0,c.highlighted=f&&f.highlighted,f&&f.selected&&(c.tight=!0,g=f.tight=!0)),a>e[0]&&a<e[1]&&(c.highlighted=!0,f&&f.start&&(g=f.highlighted=!0))));this.advanceStyling&&(delete c.beforeStart,delete c.hover,a>e[0]&&a<e[1]&&(c.highlighted=!0),a===this.clicks[0]&&(c.start=!0,c.selected=!0),a===this.clicks[1]&&(c.selected=!0,c.end=!0),0<b&&(e=this.getStateStartPoint(b),(this.actOnStart&&e===this.clicks[0]||
!this.actOnStart&&e===this.clicks[1])&&e&&(f=Math.max(e,b),a>Math.min(e,b)&&a<f&&(c.tempHighlight=!0))));return g},getStateStartPoint:function(a){var b=[],e=!0,c=!0,f=this.clicks[0];0<f&&(e=e&&f<a,c=c&&f>a,b.push(f));f=this.clicks[1];0<f&&(e=e&&f<a,c=c&&f>a,b.push(f));a=e?Math.max.apply(null,b):Math.min.apply(null,b);e=!(!1===c&&!1===e);return isFinite(a)?e?a:0:null},updateItem:function(a,b){var e,c;e=[];c=[];b.highlighted?e.push("r9-datepicker-item-highlighted"):c.push("r9-datepicker-item-highlighted");
b.hover?e.push("r9-datepicker-item-hover"):c.push("r9-datepicker-item-hover");b.selected?(e.push("r9-datepicker-item-selected"),a.attr("aria-selected",!0)):(c.push("r9-datepicker-item-selected"),a.attr("aria-selected",!1));b.start?e.push("r9-datepicker-item-start"):c.push("r9-datepicker-item-start");b.beforeStart?e.push("r9-datepicker-before-start"):c.push("r9-datepicker-before-start");b.end?e.push("r9-datepicker-item-end"):c.push("r9-datepicker-item-end");b.tight?e.push("r9-datepicker-item-tight"):
c.push("r9-datepicker-item-tight");this.advanceStyling&&(b.tempHighlight?e.push("r9-datepicker-item-tempHighlight"):c.push("r9-datepicker-item-tempHighlight"));a.removeClass(c.join(" "));a.addClass(e.join(" "))},updateDropdownSelection:function(a){if(!this.advanceStyling&&!0===this.isBeforeStart(a)&&!1===this.actOnStart)return this;var b=this,c=[0,0],g=null,f=null,d=this.dropdown.find(this.options.dateItemsSelector),h=0;a&&(h=parseInt(jq(a).attr("data-val")));c=this.computeHighlitedRange(h);d.each(function(a,
e){e=jq(e);a=parseInt(e.attr("data-val"));var d={};b.computeItemState(a,h,c,d,f)&&b.updateItem(g,f);b.updateItem(e,d);g=e;f=d});this.updateHoverDOM(a)},clearDaterange:function(a){"undefined"!=typeof a?this.clicks[a]=0:this.clicks=[0,0];this.isDropdownVisible()&&this.updateDropdownSelection();this.updateDOM()},updateHoverDOM:function(a){var b,c,d,f;c=this.clicks[0];d=this.clicks[1];a&&(b=parseInt(a.attr("data-val")),this.actOnStart?c=b:d=b);c?(f=moment(c),this.startDisplay.text(f.format(this.options.startFormat)),
this.getStartWrapperElement().removeClass("r9-datepicker-start-empty")):this.getStartWrapperElement().addClass("r9-datepicker-start-empty");d?(b=moment(d),this.endDisplay.text(b.format(this.options.endFormat)),this.summaryDisplay&&(f=b.diff(f,"days"),(b=this.options.handleNegativeSummary&&0>f)&&a&&this.actOnStart?(this.endDisplay.text(this.endPlaceholderDisplay.text()),this.summaryDisplay.text("")):b||this.summaryDisplay.text(R9.Common.Utils.String.formatChoice(this.unitFormat,f+this.unitAdjustment,
f+this.unitAdjustment))),this.getEndWrapperElement().removeClass("r9-datepicker-end-empty")):this.getEndWrapperElement().addClass("r9-datepicker-end-empty")},updateDOM:function(){var a,b,c;if(0!=this.clicks[0]){if(a=moment(this.clicks[0]),this.startDisplay.text(a.format(this.options.startFormat)),this.startInput.val(a.format(this.options.startInputFormat)),this.wholeMonthSearch){var d,f;"wholeMonthSearch"==("undefined"!==typeof R9.storage.get("daterangePickerDefaultNavTab")?R9.storage.get("daterangePickerDefaultNavTab"):
"specificDate")&&jq(".searchform.rtow").hasClass("roundtrip")&&("undefined"!==typeof R9.storage&&(null===R9.storage.get("flexSelectedMonth")&&R9.storage.set("flexSelectedMonth",moment(this.clicks[0]).format("M")),null===R9.storage.get("flexSelectedYear")&&R9.storage.set("flexSelectedYear",moment(this.clicks[0]).format("Y")),null===R9.storage.get("flexNoOfNights")&&R9.storage.set("flexNoOfNights","6-8"),d=R9.storage.get("flexSelectedMonth"),f=R9.storage.get("flexSelectedYear"),c=R9.storage.get("flexNoOfNights")),
a=moment(new Date(f,d-1,1)),a.isBefore(moment())&&(a=moment().add(1,"d")),d="string"===typeof c?c.replace("-"," to "):c,c=1==c?"night":"nights",this.startDisplay.text(a.format("MMMM")+" "+a.format("Y")+", "+d+" "+c),this.startInput.val(a.format(this.options.startInputFormat)))}}else this.startDisplay.text(""),this.startInput.val("");this.endStartIsSameField()||(0!=this.clicks[1]?(b=moment(this.clicks[1]),this.endDisplay.text(b.format(this.options.endFormat)),this.endInput.val(b.format(this.options.endInputFormat))):
(this.endDisplay.text(""),this.endInput.val("")));this.summaryDisplay&&(null!=a&&null!=b?(c=b.diff(a,"days"),this.summaryDisplay.text(R9.Common.Utils.String.formatChoice(this.unitFormat,c+this.unitAdjustment,c+this.unitAdjustment))):this.summaryDisplay.text(""));null==a?this.getStartWrapperElement().addClass("r9-datepicker-start-empty"):this.getStartWrapperElement().removeClass("r9-datepicker-start-empty");this.endStartIsSameField()||(null==b?this.getEndWrapperElement().addClass("r9-datepicker-end-empty"):
this.getEndWrapperElement().removeClass("r9-datepicker-end-empty"))},endStartIsSameField:function(){var a=this.getStartWrapperElement().get(0).id,b=this.getEndWrapperElement().get(0).id;return a===b&&!0===this.options.singlePickerWithSingleField},updateClicks:function(){this.clicks=[0,0];var a;this.startInput.val()&&(a=moment(this.startInput.val(),this.options.startInputFormat),null!=a&&a.isValid()&&(this.clicks[0]=a.valueOf()));this.endInput.val()&&(a=moment(this.endInput.val(),this.options.endInputFormat),
null!=a&&a.isValid()&&(this.clicks[1]=a.valueOf()))},handleNextPrevClickEvent:function(a,b){a=moment(parseInt(jq(a).attr("data-val")));this.dropdown[0].innerHTML=this.makeCalendarHTML(a);this.runBelowCalendarCallback();this.options.showBuzzGraph&&(this.bindBuzzGraphEvents(),this.displayBuzzGraph());this.updateDropdownSelection(null);this.loadBuzzData&&this.displayBuzzData();this.focusSelectedDay(jq("#"+this.dropdown.prop("data-owner")));return!1},bindItemEvent:function(a,b){var c=this;this.dropdown.off(a,
this.options.dateItemsSelector).on(a,this.options.dateItemsSelector,function(a){return b.call(c,this,a)})},bindOverlayEvent:function(a,b){var c=this;this.overlay.off(a).on(a,function(a){return b.call(c,this,a)})},bindNextPrevEvent:function(a,b){var c=this;this.dropdown.off(a,".r9-datepicker-switch-month.r9-datepicker-enabled").on(a,".r9-datepicker-switch-month.r9-datepicker-enabled",function(a){return b.call(c,this,a)})},bindCloseEvent:function(a,b){var c=this;this.dropdown.off(a,".r9-datepicker-close").on(a,
".r9-datepicker-close",function(a){return b.call(c,this,a)})},initDropdown:function(){var a=this.getDropdownId(this.element),b=this.getDropdownEl(this.element).get(0);if(null==b){var c=R9.Widgets.DaterangePicker.prototype.widgetBaseClass;this.options.dropdownClass&&(c=c+" "+this.options.dropdownClass);b=jq("\x3cdiv\x3e\x3c/div\x3e",{id:a,css:{display:"none",position:"absolute",zIndex:10009}}).appendTo(this.options.appendTo)[0];jq(b).addClass(c);this.advanceStyling&&jq(b).addClass("r9-advance-styling");
this.wholeMonthSearch&&jq(b).addClass("CalendarWidget-WholeMonthSearch")}this.dropdown=jq(b);this.overlay=jq("#"+this.widgetBaseClass+"-overlay");this.overlay.length||(this.overlay=jq('\x3cdiv id\x3d"'+this.widgetBaseClass+'-overlay" class\x3d"'+this.widgetBaseClass+'-overlay"\x3e\x3c/div\x3e').appendTo(this.options.appendTo))},debounceChangeFn:function(){this._debouncedChange&&this._debouncedChange.apply(this,arguments);this._debouncedChange=c(this.options.change||function(){},20);this._debouncedChange.apply(this,
arguments)},isDropdownVisible:function(){return"none"!=this.dropdown.css("display")},markDropdownElements:function(){this.unmarkDropdownElements();this.element.addClass("r9-datepicker-dropdown");this.actOnStart?this.element.addClass("r9-datepicker-dropdown-start"):this.element.addClass("r9-datepicker-dropdown-end")},unmarkDropdownElements:function(){this.element.removeClass("r9-datepicker-dropdown r9-datepicker-dropdown-start r9-datepicker-dropdown-end")},positionDropdown:function(a){var b=a.offset(),
c=jq(this.options.appendTo).offset(),d=0,f=this.dropdown[0].style;this.dropdown.parent()[0]===jq(document.body)[0]&&(d=parseInt((jq(document.body).css("top")||"0").replace("-",""))||0);jq("#datepicker").removeClass("r9-datepicker-responsive-right-position");if(606>jq(window).width()&&jq(".fdSearchForm-hotel").length&&jq("#travel_dates-end-wrapper").hasClass("r9-datepicker-focus")){jq("#datepicker").addClass("r9-datepicker-responsive-right-position");var k=b.left-c.left-144}else{var k=b.left-c.left,
h=k+this.dropdown.outerWidth();h>window.innerWidth&&(h-=window.innerWidth,k=k-h-15,this.dropdown.find(".r9-datepicker-pointer").css("left",h+36+"px"))}f.left=k+"px";f.top=d+b.top+a.outerHeight()-c.top+"px"},_hideDropdown:function(a){if("none"==this.dropdown.css("display")||null!=a&&this.dropdown.prop("data-owner")!=a.attr("id"))return!1;this.clearFocusClass();this.options.hide&&this.options.hide.apply(this,arguments);this.hideOverlay();this.preventBlur=!1;this.updateDOM();this.unmarkDropdownElements();
this.dropdown.hide();this.actOnStart=!0;this.focusDisplay(this.dropdown.prop("data-owner"));jq(window).unbind("resize",this.resizeHandler);return!0},hideDropdown:function(a){var b=this;if(!this.canClose())return!1;this.clearFocusClass();if("none"==this.dropdown.css("display")||null!=a&&this.dropdown.prop("data-owner")!=a.attr("id")||this.preventBlur)return this.preventBlur=!1;this.options.hide&&this.options.hide.apply(this,arguments);this.preventBlur=!1;this.updateDOM();this.unmarkDropdownElements();
this.actOnStart=!0;this.timers.hideTimeout&&clearTimeout(this.timers.hideTimeout);this.timers.hideTimeout=setTimeout(function(){b._hideDropdown.call(b,a)},this.hideTimeoutValue)},hideMultipleDropdowns:function(){this.options.datepickerWrapperSelector&&jq(this.options.datepickerWrapperSelector).not(this.getStartWrapperElement()).not(this.getEndWrapperElement()).each(function(a,b){jq(b).daterangePickerTwoFields("hideDropdown")})},showDropdown:function(a){this.timers.hideTimeout&&clearTimeout(this.timers.hideTimeout);
if("function"===typeof this.options.delayShowDropdown&&this.options.delayShowDropdown()&&!this.showDropdownTimeout)this.showDropdownTimeout=setTimeout(this.showDropdown.bind(this,a),this.options.showDropdownDelay);else if(null!==this.showDropdownTimeout&&(clearTimeout(this.showDropdownTimeout),this.showDropdownTimeout=null),this.canShow()){this.options.show&&this.options.show.apply(this,arguments);this.hideMultipleDropdowns();this.showOverlay();this.markDropdownElements();this.updateClicks();"function"===
typeof this.options.minDateFunc&&this.options.minDateFunc(this);this.dropdown[0].innerHTML=this.makeCalendarHTML(!this.actOnStart&&this.clicks[1]?this.clicks[1]:this.clicks[0]);this.updateDropdownSelection(null);var b=R9.Widgets.DaterangePicker.prototype.widgetBaseClass;this.options.dropdownClass&&(b=b+" "+this.options.dropdownClass);this.addFocusClass(a);this.dropdown.addClass(b);b=this.dropdown[0].style;this.runBelowCalendarCallback();this.positionDropdown(a);var c=this,d=jq(window).width();this.resizeHandler=
function(){var b=jq(window).width();10<Math.abs(b-d)&&(d=b,c.positionDropdown(a))};jq(window).on("resize",this.resizeHandler);this.bindItemEvent("mousedown",this.handleItemClickEvent);if(R9.globals.isTouch){var f=this;this.bindOverlayEvent("mousedown",function(){f.hideDropdown(f.element)})}else this.bindItemEvent("mouseover",this.handleItemHoverEvent),this.bindItemEvent("mouseout",this.handleItemHoverEndEvent);this.options.showBuzzGraph&&(this.bindBuzzGraphEvents(),this.displayBuzzGraph());this.bindNextPrevEvent("mousedown",
this.handleNextPrevClickEvent);this.bindCloseEvent("mousedown",function(){c.hideDropdown(c.element)});this.dropdown.prop("data-owner",a.attr("id"));this.loadBuzzData&&this.displayBuzzData();b.display="inline";this.focusSelectedDay(a)}},showOverlay:function(){this.overlay.show()},displayBuzzData:function(){"function"===typeof this.options.getFormData&&(new R9.DatePicker.BuzzData).update(this.dropdown,this.options.getFormData(this.actOnStart))},hideOverlay:function(){this.overlay.hide()},getStartDate:function(){this.updateClicks();
return 0!=this.clicks[0]?new Date(this.clicks[0]):null},getEndDate:function(){this.updateClicks();return 0!=this.clicks[1]?new Date(this.clicks[1]):null},parseDateString:function(a,b){try{return moment(a,b||this.options.startInputFormat)._d}catch(e){return""}},setFocusAfterClick:function(a){this.options.focusAfterClick=a},setStartDate:function(a){a?("string"===typeof a?a=this.parseDateString(a,this.options.startInputFormat):"number"===typeof a?a=new Date(a):"object"===typeof a?moment.isMoment(a)?
a.isValid()&&(a=a.toDate()):moment(a).isValid()&&(a="toDate"in a?a.toDate():a):a=new Date(0),void 0!=a.getTime&&(this.clicks[0]=a.getTime())):this.clicks[0]=0;this.updateDOM()},setEndDate:function(a){a?("string"===typeof a?a=this.parseDateString(a,this.options.endInputFormat):"number"===typeof a?a=new Date(a):"object"===typeof a?moment.isMoment(a)?a.isValid()&&(a=a.toDate()):moment(a).isValid()&&(a="toDate"in a?a.toDate():a):a=new Date(0),void 0!=a.getTime&&(this.clicks[1]=a.getTime())):this.clicks[1]=
0;this.updateDOM()},setUseDaysFormat:function(a){this.options.useDaysFormat=a;this.options.useDaysFormat?(this.unitFormat=this.options.daysFormat,this.unitAdjustment=1):(this.unitFormat=this.options.nightsFormat,this.unitAdjustment=0)},update:function(){this.updateClicks();this.updateDOM()},isBeforeStart:function(a){a instanceof jq&&(a=jq(a).attr("data-val"));return a&&null!==this.getStartDate()&&moment(parseInt(a)).isBefore(this.getStartDate())?!0:!1},decrementEndDay:function(a){var b=this.insideLastCalendar("end"),
c=this.getEndDate()||this.today,d=this.getStartDate()||this.today;a=this.utils.decrementDay(c,a);a.date()!==a.daysInMonth()||b||this.prevCalendar();d&&moment(c)>moment(d)&&this.setEndDate(a.toDate());this.fetchBuzzData();this.debounceChangeFn();this.updateDropdownSelection();return this.getEndDate()},decrementStartDay:function(a){var b=this.insideLastCalendar("start");a=this.utils.decrementDay(this.utils.validate(this.getStartDate()),a,this.setStartDate);a.date()!==a.daysInMonth()||b||this.prevCalendar();
this.fetchBuzzData();this.debounceChangeFn();this.updateDropdownSelection();return this.getEndDate()},incrementEndDay:function(a){var b=this.insideLastCalendar("end"),c=this.getEndDate();a=this.utils.incrementDay(c||this.today,a,this.setEndDate);1<=a.date()&&a.month()!==c.getMonth()&&b&&this.nextCalendar();this.fetchBuzzData();this.debounceChangeFn();this.updateDropdownSelection();return this.getEndDate()},incrementStartDay:function(a){var b=this.insideLastCalendar("start"),c=this.getStartDate()||
this.today,d=this.getEndDate();1===this.utils.incrementDay(c,a,this.setStartDate).date()&&b&&this.nextCalendar();(!d||moment(c)>=moment(d))&&this.setEndDate(this.getStartDate());this.fetchBuzzData();this.debounceChangeFn();this.updateDropdownSelection();return this.getStartDate()},handleStartDisplayFocusEvent:function(a,b){var c="",d=this.getStartWrapperElement(),f=this;this.markDropdownElements();this.addFocusClass(d);var k=jq(a);k.text()||!0!==this.options.skipForceSetDefaultStartOnFocusBlur&&this.setStartDate(this.today);
null!==(startdate=this.getStartDate())&&(c=jq(this.startInput).val()||moment(startdate).format(this.options.startInputFormat));this.actOnStart=!0;this.hideDropdown(this.getEndWrapperElement());this.showDropdown(d);this.options.accessible&&setTimeout(function(){k.text(c);f.selectDisplayBox(a)},1);b.stopPropagation();b.stopImmediatePropagation();jq("body").trigger("event",[b]);return this},handleStartDisplayBlurEvent:function(a,b){if(null!==this.clickTarget&&0<this.clickTarget.closest(".r9-datepicker").length)this.blurTarget=
a;else{var c=this.getStartWrapperElement(),d=this.getStartDate();this.hideDropdown(c);a=jq(a);""===a.text()&&!0===this.options.doNotFillWhenEmpty&&(this.setStartDate(null),this.options.change&&this.options.change.apply(this,arguments));""===a.text()&&null===d?!0!==this.options.skipForceSetDefaultStartOnFocusBlur&&this.setStartDate(this.today):""!==this.start_custom_value&&this.utils.applyStartVal();this.updateDropdownSelection();this.updateClicks();return this}},callNTimes:function(a,b){for(var c=
0;c<b;c++)a.call(this)},handleStartDisplayKeydownEvent:function(a,b){var c=b.keyCode||b.which,g=this.options.commands.keys,f=jq(this.endDisplay);a=jq(a);var k=0!==f.length&&!f.is(":hidden");if((c===g.TAB&&k||c===g.ENTER)&&!b.shiftKey){if(!1===f.is(":hidden")){var k=d(this.options.nextFieldAfterStartDateSelector),h=d(".gridCellFlexDepartPlusMinus").first();k.length?k.focus():0===h.length||!1===h.is(":visible")?(b.preventDefault(),b.stopPropagation(),setTimeout(function(){f.focus()},1)):0<h.length&&
h.find("select").focus()}if(c===g.ENTER&&f.is(":hidden"))return a.closest("form").find("[type\x3dsubmit]").trigger("click"),b.preventDefault(),b.stopPropagation(),!1;this.utils.applyStartVal();this.updateDropdownSelection();return!1}a=this.options.commands.keys;switch(c){case a.UP:this.callNTimes(this.decrementStartDay,7);b.preventDefault();b.stopPropagation();break;case a.RIGHT:this.incrementStartDay();b.preventDefault();b.stopPropagation();break;case a.LEFT:this.decrementStartDay();b.preventDefault();
b.stopPropagation();break;case a.DOWN:this.callNTimes(this.incrementStartDay,7);b.preventDefault();b.stopPropagation();break;case a.ESC:this.isDropdownVisible()&&this.hideDropdown(this.getStartWrapperElement())}this.vim(b,"start");jq("body").trigger("event",[b]);return this},handleEndDisplayFocusEvent:function(a,b){var c="",d=this.getEndWrapperElement(),f=this;f.markDropdownElements();this.addFocusClass(jq(d));var k=jq(a),h=f.clicks[0]||f.today.getTime();(!k.text()||f.clicks[1]<=h)&&!0!==this.options.skipForceSetDefaultEndOnFocusBlur&&
f.setEndDate(moment(h).toDate());null!==(enddate=f.getEndDate())&&(c=jq(f.endInput).val()||moment(enddate).format(f.options.endInputFormat));f.actOnStart=!1;f.showDropdown(d);f.options.accessible&&(jq(f.endDisplay).attr("contenteditable","true"),setTimeout(function(){k.text(c);f.selectDisplayBox(a)},1));b.stopPropagation();b.stopImmediatePropagation();jq("body").trigger("event",[b]);return this},handleEndDisplayBlurEvent:function(a,b){var c=this.getEndWrapperElement();this.options.accessible&&jq(this.endDisplay).attr("contenteditable",
"false");if(null!==this.clickTarget&&0<this.clickTarget.closest(".r9-datepicker").length)this.blurTarget=a;else return this.hideDropdown(c),a=jq(a),""===a.text()&&!0===this.options.doNotFillWhenEmpty&&(this.setEndDate(null),this.options.change&&this.options.change.apply(this,arguments)),""==a.text()&&null===this.getEndDate()?!0!==this.options.skipForceSetDefaultEndOnFocusBlur&&(null!==this.getStartDate()?this.setEndDate(moment(this.getStartDate()).add(1,"days")):this.setEndDate(moment().toDate())):
this.utils.applyEndVal(),this.updateDropdownSelection(),this},handleEndDisplayKeydownEvent:function(a,b){var c=b.keyCode||b.which;a=jq(a);a.text();var g=this.options.commands.keys;if(c===g.TAB&&!0===b.shiftKey){var f=d(this.options.nextFieldAfterStartDateSelector),k=d(".gridCellFlexDepartPlusMinus").first(),h=jq(this.startDisplay);f.length?setTimeout(function(){f.focus()}):k.is(":visible")?setTimeout(function(){k.children(".flexPlusMinusChoices").focus()}):!1===h.is(":hidden")&&(b.preventDefault(),
b.stopPropagation(),setTimeout(function(){h.focus()}))}else{if(c===g.ENTER)return this.utils.applyEndVal(),a.closest("form").find("[type\x3dsubmit]").trigger("click"),this.updateDropdownSelection(),b.preventDefault(),b.stopPropagation(),this.hideDropdown(this.getEndWrapperElement()),!1;a=this.options.commands.keys||{};switch(c){case a.UP:this.callNTimes(this.decrementEndDay,7);b.preventDefault();b.stopPropagation();break;case a.RIGHT:this.incrementEndDay();b.preventDefault();b.stopPropagation();break;
case a.LEFT:this.decrementEndDay();b.preventDefault();b.stopPropagation();break;case a.DOWN:this.callNTimes(this.incrementEndDay,7);b.preventDefault();b.stopPropagation();break;case a.ESC:this.isDropdownVisible()&&this.hideDropdown(this.getEndWrapperElement())}this.vim(b,"end")}jq("body").trigger("event",[b]);return this},handleStartDisplayKeyupEvent:function(a,b){this.utils.isCharacterKeyPress(b)&&(this.start_custom_value=jq(a).text());return this},handleEndDisplayKeyupEvent:function(a,b){this.utils.isCharacterKeyPress(b)&&
(this.end_custom_value=jq(a).text());return this},nextCalendar:function(a){return this.utils.changeCalendar("next",a)},prevCalendar:function(a){return this.utils.changeCalendar("prev",a)},selectDisplayBox:function(a){clearTimeout(this.timers.selectDisplayBox);this.timers.selectDisplayBox=window.setTimeout(function(){var b,c;window.getSelection&&document.createRange?(b=window.getSelection(),b.removeAllRanges(),c=document.createRange(),c.selectNodeContents(a),b.addRange(c)):document.body.createTextRange&&
(c=document.body.createTextRange(),c.moveToElementText(a),R9.Common.Utils.Browsers.isIE(8)||c.select())},1)},vim:function(a,b){var c=this.options.commands.keys||{};switch(a.keyCode||a.which){case c.DOLLAR:a.shiftKey&&(this.endOfLine(b),a.preventDefault());break;case c.CARAT:a.shiftKey&&(this.startOfLine(b),a.preventDefault())}return this},startOfLine:function(a){var b=this.utils.getRowInfo(a);"start"==a?this.decrementStartDay(b.index):this.decrementEndDay(b.index)},endOfLine:function(a){var b=this.utils.getRowInfo(a),
b=b.len-b.index;"start"==a?this.incrementStartDay(b):this.incrementEndDay(b)},bindBuzzGraphEvents:function(){var a=this;jq(".r9-datepicker-buzz-day").hover(function(){jq(".r9-datepicker-item[data-val\x3d%s]".format(jq(this).attr("data-val"))).addClass("r9-datepicker-item-hover");jq(".r9-datepicker-buzz-graph-footer \x3e div \x3e .detail").html(jq(this).children(".r9-datepicker-buzz-bar").attr("footertitle"))},function(){jq(".r9-datepicker-item[data-val\x3d%s]".format(jq(this).attr("data-val"))).removeClass("r9-datepicker-item-hover");
jq(".r9-datepicker-buzz-graph-footer \x3e div \x3e .detail").html("")});jq(".r9-datepicker-buzz-day").click(function(){var b=Number(jq(this).children(".r9-datepicker-buzz-bar").attr("dtstart"));if(a.actOnStart){var c=Number(jq(this).children(".r9-datepicker-buzz-bar").attr("dtend"));a.clearDaterange();a.setStartDate(b);a.options.isOneWay||a.setEndDate(c);a.updateDropdownSelection(null);a.options.isOneWay?(a.setEndDate(b),jq(".r9-datepicker-item[data-val\x3d%s]".format(jq(this).attr("data-val"))).mousedown(),
R9.Analytics.api.trackEvent("/flexgraph/oneway/click")):(a.endDisplay.focus(),R9.Analytics.api.trackEvent("/flexgraph/startdate/click"))}else a.setEndDate(b),jq(".r9-datepicker-item[data-val\x3d%s]".format(jq(this).attr("data-val"))).mousedown(),R9.Analytics.api.trackEvent("/flexgraph/enddate/click")})},fetchBuzzGraphData:function(){var a=this;jq("#flexgraphOK").size();var b="y"==jq("#onewaytrip").filter(":checked").val()||"y"==jq("#multi").filter(":checked").val();a.options.isOneWay=b;var c=a.getStartDate()||
a.today,d=a.getEndDate(),f=b?1:3;null==d||b||(f=Math.floor(a.utils.dateDiff(d,c)+1));var k=Number(jq(".r9-datepicker-month-first").find(".r9-datepicker-enabled:first").attr("data-val"));if(""==a.options.originControl.val()||""==a.options.destControl.val())jq(".r9-datepicker-buzz-graph-footer \x3e div").addClass("hidden"),jq(".r9-datepicker-buzz-graph-footer .noairports").removeClass("hidden");else if(a.actOnStart){var h=moment(k).format("YYYY-MM-DD");a.buzzCall&&a.buzzCall.abort();a.buzzCall=b?jq.ajax({type:"GET",
url:"/h/run/flexgraph",data:{q:"oneway",o:a.options.originControl.val().substr(0,3),d:a.options.destControl.val().substr(0,3),depart:h,daysout:70,duration:f,json:1},dataType:"json",success:function(b){try{responseObject=b,a.graphDataReadyCallback(responseObject,f,k,!0,c.getTime())}catch(l){}a.buzzCall=!1},error:function(b,c,e){a.buzzCall=!1},cache:!1}):jq.ajax({type:"GET",url:"/h/run/flexgraph",data:{q:"fixed",o:a.options.originControl.val().substr(0,3),d:a.options.destControl.val().substr(0,3),depart:h,
daysout:70,duration:f,json:1},dataType:"json",success:function(b){try{responseObject=b,a.graphDataReadyCallback(responseObject,f,k,!1,c.getTime())}catch(l){}a.buzzCall=!1},error:function(b,c,e){a.buzzCall=!1},cache:!1})}else{var h=moment(c.getTime()).format("YYYY-MM-DD"),n=(d||a.today).getTime();a.buzzCall&&a.buzzCall.abort();a.buzzCall=jq.ajax({type:"GET",url:"/h/run/flexgraph",data:{q:"start",o:a.options.originControl.val().substr(0,3),d:a.options.destControl.val().substr(0,3),depart:h,daysout:70,
json:1},dataType:"json",success:function(b){try{responseObject=b,a.graphDataReadyCallback(responseObject,f,c.getTime(),!1,n)}catch(l){}a.buzzCall=!1},error:function(b,c,e){a.buzzCall=!1},cache:!1})}},displayBuzzGraph:function(){this.fetchBuzzData(!0)},fetchBuzzData:function(a){this.options.showBuzzGraph&&a&&(jq(".r9-datepicker-buzz-day.r9-datepicker-enabled .r9-datepicker-buzz-bar").each(function(){jq(this).css("height","2px").attr("footertitle","")}),this.fetchBuzzGraphData())},graphDataReadyCallback:function(a,
b,c,d,f){this.actOnStart?d?(jq(".r9-datepicker-buzz-graph-footer \x3e div").addClass("hidden"),jq(".r9-datepicker-buzz-graph-footer .oneway").removeClass("hidden")):(jq(".r9-datepicker-buzz-graph-footer \x3e div").addClass("hidden"),jq(".r9-datepicker-buzz-graph-footer .duration #durationNumber").html(b),jq(".r9-datepicker-buzz-graph-footer .duration").removeClass("hidden")):(jq(".r9-datepicker-buzz-graph-footer \x3e div").addClass("hidden"),jq(".r9-datepicker-buzz-graph-footer .fixedstart #flexDepartDate").html(moment(c).format(this.options.startInputFormat)),
jq(".r9-datepicker-buzz-graph-footer .fixedstart").removeClass("hidden"));c=b=500;var e=0,g=0,n=0,m;for(m in a){n++;var l=Number(a[m].localPrice);l>b&&(b=l);l<c&&1<l&&(c=l,g=m);m==f&&(e=l)}if(0==n)jq(".r9-datepicker-buzz-graph").hide(),jq(".r9-datepicker-buzz-graph-footer").hide();else{n=0;for(m in a){var l=a[m].localPrice,r=a[m].localPriceAsString,w=a[m].departMilli,p=a[m].returnMilli,q=moment(a[m].departMilli).format(this.options.startInputFormat),u=moment(a[m].returnMilli).format(this.options.startInputFormat),
t=this.actOnStart?jq(".r9-datepicker-buzz-day[data-val\x3d'"+m+"']").find("div"):jq(".r9-datepicker-buzz-day[data-val\x3d'"+p+"']").find("div");1==t.size()&&(l=Math.floor(l/b*100),t.css("height",l+"%"),n++,d?t.attr("footertitle",q+" "+r):t.attr("footertitle",q+"-"+u+" "+r),this.actOnStart?t.attr("dtstart",w):t.attr("dtstart",p),t.attr("dtend",p),this.actOnStart?m==f&&(t.addClass("selected"),jq("#graphpricebar").css("bottom",l-1+"px").show(),jq("#graphprice").html(r).css("bottom",l-7+"px").show()):
p==f&&(t.addClass("selected"),jq("#graphpricebar").css("bottom",l-1+"px").show(),jq("#graphprice").html(r).css("bottom",l-7+"px").show()),m==g&&(0<e&&e>c&&c<.9*e?jq("#graphlowpricebar").css("bottom",l-1+"px").show():jq("#graphlowpricebar").hide()))}0==n?(jq(".r9-datepicker-buzz-graph").hide(),jq(".r9-datepicker-buzz-graph-footer").hide()):jq(".r9-datepicker-buzz-graph").is(":visible")||(jq(".r9-datepicker-buzz-graph").show(),jq(".r9-datepicker-buzz-graph-footer").show())}}})})(jq||jQuery);
(function(d){d.extend("Widgets.DaterangePicker.prototype.options",{prevTitle:"Prev",nextTitle:"Next",nightsFormat:"0#same day|1#1 night|2#{0} nights",daysFormat:"0#same day|1#1 day|2#{0} days",startInputFormat:"MM/DD/YYYY",endInputFormat:"MM/DD/YYYY",startFormat:"ddd M/D",endFormat:"ddd M/D"})})(window.R9);
(function(d){R9.extend("Widgets",{DaterangePickerTwoFields:function(c,a){R9.Widgets.BaseCalendarWidget.apply(this);this.endNode=c;this.endElement=d(this.endNode);this.startElement=jq(this.endElement).closest("form").find('[id$\x3d"start-wrapper"]');1!=this.startElement.length&&(this.startElement=jq("#"+this.endElement.attr("id").replace("end-wrapper","start-wrapper")));this.validateElement()&&(this.startDisplay=d(R9.Widgets.DaterangePickerTwoFields.findDisplay(this.startElement[0])),this.startClearDisplay=
d(R9.Widgets.DaterangePickerTwoFields.findClearDisplay(this.startElement[0])),this.startPlaceholderDisplay=d(R9.Widgets.DaterangePickerTwoFields.findPlaceholderDisplay(this.startElement[0])),this.startInputTab=d(R9.Widgets.DaterangePickerTwoFields.findInputTab(this.startElement[0])),this.startInput=d(R9.Widgets.DaterangePickerTwoFields.findInput(this.startElement[0])),this.endDisplay=d(R9.Widgets.DaterangePickerTwoFields.findDisplay(this.endElement[0])),this.endClearDisplay=d(R9.Widgets.DaterangePickerTwoFields.findClearDisplay(this.endElement[0])),
this.endPlaceholderDisplay=d(R9.Widgets.DaterangePickerTwoFields.findPlaceholderDisplay(this.endElement[0])),this.endInputTab=d(R9.Widgets.DaterangePickerTwoFields.findInputTab(this.endElement[0])),this.endInput=d(R9.Widgets.DaterangePickerTwoFields.findInput(this.endElement[0])),this.options=d.extend({},this.options,a),this.init())}});R9.extend("Widgets.DaterangePickerTwoFields",{isDatepicker:function(c){return c&&c.nodeName&&"div"==c.nodeName.toLowerCase()},isWidgetControlled:function(c){return d(c).hasClass(R9.Widgets.DaterangePicker.prototype.widgetBaseClass+
"-wrapper")},findDisplay:function(c){var a=d(c).closest("form").find("#"+c.id.replace("wrapper","display"))[0];a||(a=document.getElementById(c.id.replace("wrapper","display")));return a},findClearDisplay:function(c){var a=d(c).closest("form").find("#"+c.id.replace("wrapper","clear"))[0];a||(a=document.getElementById(c.id.replace("wrapper","clear")));return a},findPlaceholderDisplay:function(c){var a=d(c).closest("form").find("#"+c.id.replace("wrapper","placeholder"))[0];a||(a=document.getElementById(c.id.replace("wrapper",
"placeholder")));return a},findInputTab:function(c){var a=d(c).closest("form").find("#"+c.id.replace("wrapper","tab"))[0];a||(a=document.getElementById(c.id.replace("wrapper","tab")));return a},findInput:function(c){var a=jq(c).closest("form").find("#"+c.id+" .r9-datepicker-input")[0];a||(a=jq("#"+c.id+" .r9-datepicker-input")[0]);return a},getDropdownId:function(c){return"datepicker"}});R9.extend("Widgets.DaterangePickerTwoFields.prototype",!0,R9.Widgets.DaterangePicker.prototype,{endNode:null,startElement:null,
endElement:null,startDisplay:null,startClearDisplay:null,startPlaceholderDisplay:null,startInputTab:null,startInput:null,endDisplay:null,endClearDisplay:null,endPlaceholderDisplay:null,endInputTab:null,endInput:null,singleDateMode:!1,init:function(){this.advanceStyling&&(this.options.skipForceSetDefaultStartOnFocusBlur=!0,this.options.skipForceSetDefaultEndOnFocusBlur=!0,this.options.doNotFillWhenEmpty=!0);this.initDropdown();this.timers={};this.options.useLongDisplayFormat&&(this.options.startFormat=
this.options.startInputFormat,this.options.endFormat=this.options.endInputFormat);this.endStartIsSameField()||(this.bindEvent(this.endInputTab,"focus",this.handleEndInputFocusEvent),this.bindEvent(this.endInputTab,"blur",this.handleInputBlurEvent),this.bindEvent(this.endInputTab,"keydown",this.handleInputKeydownEvent),this.bindEvent(this.endElement,"mousedown",this.handleEndClickEvent),this.bindEvent(this.endClearDisplay,"mousedown",this.handleEndClearClickEvent));this.bindEvent(this.startInputTab,
"focus",this.handleStartInputFocusEvent);this.bindEvent(this.startInputTab,"blur",this.handleInputBlurEvent);this.bindEvent(this.startInputTab,"keydown",this.handleInputKeydownEvent);this.bindEvent(this.startElement,"mousedown",this.handleStartClickEvent);this.bindEvent(this.startClearDisplay,"mousedown",this.handleStartClearClickEvent);this.endElement.data(this.widgetName,this);jq(".r9-datepicker-wrapper").each(function(){var c=jq(this).find(".r9-datepicker-display");if(!(void 0!==c&&1<c.length))jq(this).off("mousedown focus").on("mousedown focus",
function(a){a.preventDefault();a.stopPropagation();jq("body").trigger("event",[a]);jq(this).find(".r9-datepicker-display").focus()})});this.bindCommandUtilities();this.start_custom_value=this.end_custom_value="";this.utils=this.options.commands.utilities;this.today=moment().startOf("day").toDate();this.bindAccessibilityEvents();this.updateClicks();this.updateDOM()},validateElement:function(){return R9.Widgets.DaterangePicker.isDatepicker(this.endNode)&&R9.Widgets.DaterangePicker.isWidgetControlled(this.endNode)&&
void 0===this.endElement.data(this.widgetName)},getWrapperElement:function(){return this.actOnStart?this.startElement:this.endElement},getStartWrapperElement:function(){return this.startElement},getEndWrapperElement:function(){return this.endElement},switchActOn:function(){var c=!this.actOnStart;this.hideDropdown(this.getWrapperElement());this.actOnStart=c;(this.actOnStart?this.startInputTab:this.endInputTab).focus()},markDropdownElements:function(){this.unmarkDropdownElements();this.actOnStart?this.startElement.addClass("r9-datepicker-dropdown r9-datepicker-dropdown-start"):
this.endElement.addClass("r9-datepicker-dropdown r9-datepicker-dropdown-end")},unmarkDropdownElements:function(){this.startElement.removeClass("r9-datepicker-dropdown r9-datepicker-dropdown-start");this.endElement.removeClass("r9-datepicker-dropdown r9-datepicker-dropdown-end")},setSingleDateMode:function(c,a){this.singleDateMode!=c&&(this.singleDateMode=c,a||this.updateDOM())},getSingleDateMode:function(){return this.singleDateMode},handleStartClearClickEvent:function(c,a){this.clearDaterange(0);
this.options.change&&this.options.change.apply(this,arguments);return!this.startElement.hasClass("r9-datepicker-focus")},handleEndClearClickEvent:function(c,a){this.clearDaterange(1);this.options.change&&this.options.change.apply(this,arguments);return!this.endElement.hasClass("r9-datepicker-focus")},handleStartInputFocusEvent:function(c,a){if(!c.disabled){this.preventBlur=!1;var b=this.getStartWrapperElement();b.addClass("r9-datepicker-focus");this.startDisplay.text()||this.setStartDate(this.today);
this.actOnStart=!0;this.showDropdown(b);this.options.focus&&this.options.focus.apply(this,arguments)}},handleEndInputFocusEvent:function(c,a){if(!c.disabled){this.preventBlur=!1;var b=this.getEndWrapperElement();b.addClass("r9-datepicker-focus");this.endDisplay.text()||this.setEndDate(moment(this.getStartDate()).toDate());this.actOnStart=!1;this.showDropdown(b);this.options.focus&&this.options.focus.apply(this,arguments)}},handleItemClickEvent:function(c,a){var b=this,e=jq(c);return this.singleDateMode?
(e.hasClass("r9-datepicker-enabled")&&(c=parseInt(e.attr("data-val")),this.clicks[0]=c,this.clicks[1]<this.clicks[0]&&(this.clicks[1]=this.clicks[0]),this.updateDropdownSelection(null),setTimeout(function(){b.hideDropdown(null);b.options.change&&b.options.change.apply(b,arguments);b.options.nextFieldSelector&&jq(b.options.nextFieldSelector).focus()},this.options.secondClickHideDelay)),this.updateDOM(),!1):R9.Widgets.DaterangePicker.prototype.handleItemClickEvent.call(this,c,a)},handleClickEvent:function(c,
a,b){return!0},updateItem:function(c,a){this.singleDateMode?(a.hover?c.addClass("r9-datepicker-item-hover"):c.removeClass("r9-datepicker-item-hover"),c.removeClass("r9-datepicker-item-selected"),c.removeClass("r9-datepicker-item-start"),a.selected&&!a.end?(c.addClass("r9-datepicker-item-selected"),c.attr("aria-selected",!0)):a.selected||c.attr("aria-selected",!1),a.start&&c.addClass("r9-datepicker-item-start")):R9.Widgets.DaterangePicker.prototype.updateItem.call(this,c,a)}})})(jq||jQuery);
(function(d){R9.extend("Widgets",{DaterangePickerFixed:function(c,a){this.elementNode=c;this.element=d(this.elementNode);this.validateElement()&&(this.startDisplay=d(R9.Widgets.DaterangePicker.findStartDisplay(this.elementNode)),this.sepDisplay=d(R9.Widgets.DaterangePicker.findSepDisplay(this.elementNode)),this.endDisplay=d(R9.Widgets.DaterangePicker.findEndDisplay(this.elementNode)),this.clearDisplay=d(R9.Widgets.DaterangePicker.findClearDisplay(this.elementNode)),this.nightsDisplay=d(R9.Widgets.DaterangePicker.findNightsDisplay(this.elementNode)),
this.placeholderDisplay=d(R9.Widgets.DaterangePicker.findPlaceholderDisplay(this.elementNode)),this.input=d(R9.Widgets.DaterangePicker.findInputNode(this.elementNode)),this.startInput=d(R9.Widgets.DaterangePicker.findStartInput(this.elementNode)),this.endInput=d(R9.Widgets.DaterangePicker.findEndInput(this.elementNode)),this.options=d.extend({},this.options,a),this.init())}});R9.extend("Widgets.DaterangePickerFixed",{isDatepicker:function(c){return c&&c.nodeName&&"div"==c.nodeName.toLowerCase()},
isWidgetControlled:function(c){return d(c).hasClass(R9.Widgets.DaterangePicker.prototype.widgetBaseClass+"-wrapper")},findStartDisplay:function(c){return document.getElementById(c.id+"-start")},findEndDisplay:function(c){return document.getElementById(c.id+"-end")},findSepDisplay:function(c){return document.getElementById(c.id+"-sep")},findClearDisplay:function(c){return document.getElementById(c.id+"-clear")},findNightsDisplay:function(c){return document.getElementById(c.id+"-nights")},findPlaceholderDisplay:function(c){return document.getElementById(c.id+
"-placeholder")},findStartInput:function(c){return jq("#"+c.id+" .r9-datepicker-input.r9-datepicker-start")[0]},findEndInput:function(c){return jq("#"+c.id+" .r9-datepicker-input.r9-datepicker-end")[0]},findInputNode:function(c){return document.getElementById(c.id+"-tab")},getDropdownId:function(c){return"datepicker"}});R9.extend("Widgets.DaterangePickerFixed.prototype",!0,R9.Widgets.DaterangePicker.prototype,{options:{rangeDays:34},handleItemClickEvent:function(c,a){var b=this;c=jq(c);c.hasClass("r9-datepicker-enabled")&&
(c=parseInt(c.attr("data-val")),this.clicks[0]=c,this.clicks[1]=moment(c).add(this.options.rangeDays,"days").valueOf(),this.updateDropdownSelection(null),setTimeout(function(){b.hideDropdown(null);b.options.change&&b.options.change.apply(b,arguments);b.options.nextFieldSelector&&jq(b.options.nextFieldSelector).focus()},this.options.secondClickHideDelay));this.updateDOM();return!1},getHighlitedRange:function(c,a){c=[0,0];if(null==a)return c;c[0]=parseInt(a.attr("data-val"));c[1]=moment(c[0]).add(34,
"days").valueOf();return c},setStartDate:function(c){null!=c&&(this.clicks[0]=c.getTime(),this.clicks[1]=moment(this.clicks[0]).add(this.options.rangeDays,"days").valueOf(),this.updateDOM())},setEndDate:function(c){null!=c&&(this.clicks[1]=c.getTime(),this.clicks[0]=moment(this.clicks[1]).subtract(this.options.rangeDays,"days").valueOf(),this.updateDOM())}})})(jq||jQuery);
(function(d){R9.extend("Widgets",{DaterangePickerOrSingleDate:function(c,a){R9.Widgets.DaterangePicker.call(this,c,a)}});R9.extend("Widgets.DaterangePickerOrSingleDate",{});R9.extend("Widgets.DaterangePickerOrSingleDate.prototype",!0,R9.Widgets.DaterangePicker.prototype,{minDate:null,singleDateMode:!1,setSingleDateMode:function(c,a){this.singleDateMode=c;a||this.updateDOM()},getSingleDateMode:function(){return this.singleDateMode},updateDOM:function(){var c;this.singleDateMode?(this.element.addClass("r9-datepicker-single-date-mode"),
this.dropdown.addClass("r9-datepicker-single-date-mode"),this.endDisplay.text(""),this.endInput.val(""),0!=this.clicks[0]?(c=moment(this.clicks[0]),this.startDisplay.text(c.format(this.options.startFormat)),this.startInput.val(c.format(this.options.startInputFormat))):(this.startDisplay.text(""),this.startInput.val("")),null==c?this.element.addClass("r9-datepicker-start-empty"):this.element.removeClass("r9-datepicker-start-empty")):(this.element.removeClass("r9-datepicker-single-date-mode"),this.dropdown.removeClass("r9-datepicker-single-date-mode"),
R9.Widgets.DaterangePicker.prototype.updateDOM.call(this))},updateHoverDOM:function(c){this.singleDateMode||R9.Widgets.DaterangePicker.prototype.updateHoverDOM.call(this,c)},computeState:function(c,a,b,e,d,f){this.singleDateMode?a==b[0]?d.start=!0:a==c&&(d.highlited=!0):R9.Widgets.DaterangePicker.prototype.computeState.call(this,c,a,b,e,d,f)},handleItemClickEvent:function(c,a){var b=this,e=jq(c);return this.singleDateMode?(e.hasClass("r9-datepicker-enabled")&&(c=parseInt(e.attr("data-val")),this.clicks[0]=
c,this.updateDropdownSelection(null),setTimeout(function(){b.hideDropdown(null);b.options.change&&b.options.change.apply(b,arguments);b.options.nextFieldSelector&&jq(b.options.nextFieldSelector).focus()},this.options.secondClickHideDelay)),this.updateDOM(),!1):R9.Widgets.DaterangePicker.prototype.handleItemClickEvent.call(this,c,a)}})})(jq||jQuery);
(function(d,c){d.publish("common.widgets.datepicker.BaseCalendar.prototype",c.extend({},d.Widgets.BaseCalendarWidget.prototype,{useSpecialCharacters:!1,options:{language:null,title:"",prevTitle:"",nextTitle:"",titleYearFormat:"YYYY",titleMonthFormat:"MMMM",reverseMonthAndYearOrder:!1,yearSymbol:null},showYearWithSpecialSymbol:function(a){var b=[],c=this.getYearSymbol();b.push("\x3cspan class\x3d'r9-datepicker-year'\x3e");b.push(a.format(this.options.titleYearFormat)+c+" ");b.push("\x3c/span\x3e");
return b.join("")},showMonthAndYear:function(a){var b=[];this.isReverseMonthAndYearOrder()?(b.push(this.showYearWithSpecialSymbol(a)),b.push(this.showMonth(a))):(b.push(this.showMonth(a)),b.push(this.showYearWithSpecialSymbol(a)));return b.join("")},isReverseMonthAndYearOrder:function(){return!0===this.options.reverseMonthAndYearOrder||!0===d.config.getBoolean("ui.datepicker.reverse.order.month.year",!1)},getYearSymbol:function(){return null!=this.options.yearSymbol?this.options.yearSymbol:this.isReverseMonthAndYearOrder()?
d.config.getString("ui.datepicker.year.symbol",""):""}}));d.createWidgetClass("datepicker.DaterangePicker",c.extend({},d.Widgets.DaterangePickerTwoFields.prototype,d.common.widgets.datepicker.BaseCalendar.prototype,{widgetName:"daterangePicker",widgetBaseClass:"r9-datepicker",calendarBaseClass:"r9-datepicker-calendar",dropdownId:"datepicker",html:null,singleDateMode:!1,maxDate:null,options:c.extend({},d.common.widgets.datepicker.BaseCalendar.prototype.options,d.Widgets.DaterangePickerTwoFields.prototype.options,
{skipForceSetDefaultStartOnFocusBlur:!1,skipForceSetDefaultEndOnFocusBlur:!1,doNotFillWhenEmpty:!1,minRangeDays:1,alwaysShowEndDatepicker:!1,responsive:!1,presentationCheck:function(){return d.utils.presentation.isTablet()}}),init:function(a){this.html=c("html");d.Widgets.BaseCalendarWidget.apply(this);this.options.useDaysFormat?(this.unitFormat=this.options.daysFormat,this.unitAdjustment=1):(this.unitFormat=this.options.nightsFormat,this.unitAdjustment=0);this.advanceStyling&&(this.options.skipForceSetDefaultStartOnFocusBlur=
!0,this.options.skipForceSetDefaultEndOnFocusBlur=!0,this.options.doNotFillWhenEmpty=!0);this.options.maxDate&&(this.maxDate=this.options.maxDate);this.elementNode=this.element.get(0);a=this.element.closest(".R9-Overlay");0<a.length&&(this.options.appendTo="#%s".format(a.attr("id")));this.startSection=this.findStartSection();this.startDisplay=this.findStartDisplay();this.startPlaceholderDisplay=this.findStartPlaceholderDisplay();this.startElement=this.startWrapper=this.findStartWrapperElement();this.startInput=
this.findStartInput();this.startInputTab=this.findStartInputTab();this.endSection=this.findEndSection();this.endDisplay=this.findEndDisplay();this.endPlaceholderDisplay=this.findEndPlaceholderDisplay();this.endElement=this.endWrapper=this.findEndWrapperElement();this.endInput=this.findEndInput();this.endInputTab=this.findEndInputTab();this.element.hasClass("singleDate")&&this.setSingleDateMode(!0,!0);this.summaryDisplay=this.findSummaryDisplay();this.setUseDaysFormat(this.options.useDaysFormat);this.initDropdown();
this.timers={};this.bindCommandUtilities();this.start_custom_value=this.end_custom_value="";this.utils=this.options.commands.utilities;this.today=moment().startOf("day").toDate();this.isResponsive()&&this.handleResponsive();this.wholeMonthSearch&&(this.options.skipForceSetDefaultStartOnFocusBlur=!0,this.options.skipForceSetDefaultEndOnFocusBlur=!0,this.options.doNotFillWhenEmpty=!0);this.update();this.updateClicks();this.updateDOM()},addEventHandlers:function(){var a=function(a){a.off("mousedown focus").on("mousedown focus",
function(b){b.preventDefault();b.stopPropagation();a.removeClass("r9-datepicker-end-empty r9-datepicker-start-empty");c(this).find(".r9-datepicker-display").focus()})};a(this.startWrapper);a(this.endWrapper);this.bindAccessibilityEvents();this.bindEvent(this.startInputTab,"focus",this.handleStartInputFocusEvent);this.bindEvent(this.startInputTab,"blur",this.handleInputBlurEvent);this.bindEvent(this.startInputTab,"keydown",this.handleInputKeydownEvent);this.bindEvent(this.startElement,"mousedown",
this.handleStartClickEvent);this.bindEvent(this.endInputTab,"focus",this.handleEndInputFocusEvent);this.bindEvent(this.endInputTab,"blur",this.handleInputBlurEvent);this.bindEvent(this.endInputTab,"keydown",this.handleInputKeydownEvent);this.bindEvent(this.endElement,"mousedown",this.handleEndClickEvent);this.bindEvent(this.dropdown,"mousedown",this.handleDropdownClickEvent);this.bindEvent(this.overlay,"mousedown",this.handleItemClickEvent);this.isResponsive()&&c(window).resize(this.handleResponsive.bind(this))},
handleDropdownClickEvent:function(){return!!this.wholeMonthSearch},isSelectingEndDate:function(){return this.endWrapper.hasClass("r9-datepicker-focus")},handleCloseEvent:function(){this.isDropdownVisible()&&this.hideDropdown()},handleItemClickEvent:function(a,b){if(!0===this.isBeforeStart(a)&&!1===this.actOnStart)return this.preventBlur=!0,this.wholeMonthSearch&&(this.preventBlur=!1),b.preventDefault(),this;var e=this;b=c(a);var d,f,k;b.hasClass("r9-datepicker-enabled")&&(f=parseInt(b.attr("data-val")),
d=(k=this.actOnStart)?0:1,b=this.actOnStart?1:0,this.clicks[d]=f,this.clicks[0]&&this.clicks[1]&&(d=moment(this.clicks[1]).diff(this.clicks[0],"days"),d<this.options.minRangeDays&&(this.clicks[b]=0)),this.updateDropdownSelection(null),!this.options.alwaysShowEndDatepicker||this.singleDateMode||this.isSelectingEndDate()?!this.singleDateMode&&this.clicks[0]&&this.clicks[1]||this.singleDateMode&&this.clicks[0]?setTimeout(function(){e.hideDropdown();e.options.change&&e.options.change.apply(e,[f,k]);e.options.nextFieldSelector&&
c(e.options.nextFieldSelector).focus()},this.options.secondClickHideDelay):this.switchActOn():(this.switchActOn(),e.options.change&&e.options.change.apply(e,[f,k]),this.loadBuzzData&&k&&this.displayBuzzData()));this.updateDOM();c(a).trigger("daterangepicker.itemclicked");return!1},handleStartDisplayFocusEvent:function(a,b){if(this.clickTarget&&c(this.clickTarget[0]).hasClass("FormView"))return this;var e=null,g="",f=this.getStartWrapperElement(),k=this;this.markDropdownElements();c(".r9-datepicker-focus").removeClass("r9-datepicker-focus");
c(f).addClass("r9-datepicker-focus");var h=c(a);h.text()||!0!==this.options.skipForceSetDefaultStartOnFocusBlur&&this.setStartDate(this.today);null!==(e=this.getStartDate())&&(g=c(this.startInput).val()||moment(e).format(this.options.startInputFormat));this.actOnStart=!0;this.hideDropdown(this.getEndWrapperElement());this.showDropdown(f);this.options.accessible&&setTimeout(function(){h.text(g);k.wholeMonthSearch&&("wholeMonthSearch"===(null!==d.storage.get("daterangePickerDefaultNavTab")?d.storage.get("daterangePickerDefaultNavTab"):
"specificDate")?k.startDisplay.text("Select a month..."):h.text(g));k.selectDisplayBox(a)},1);b.stopPropagation();b.stopImmediatePropagation();c("body").trigger("event",[b]);return this},handleStartDisplayBlurEvent:function(a,b){if(null!==this.clickTarget&&(0<this.clickTarget.closest(".r9-datepicker").length||this.wholeMonthSelect))this.blurTarget=a;else{var e=this.getStartWrapperElement(),d=this.getStartDate();a=c(a);""===a.text()&&!0===this.options.doNotFillWhenEmpty&&(this.setStartDate(null),this.options.change&&
this.options.change.apply(this,arguments));this.hideDropdown(e);c(e).removeClass("r9-datepicker-focus");""===a.text()&&null===d?!0!==this.options.skipForceSetDefaultStartOnFocusBlur&&this.setStartDate(this.today):""!==this.start_custom_value?this.utils.applyStartVal():(null===this.getEndDate()||moment(this.getStartDate()).isSame(this.getEndDate()))&&this.setEndDate(moment(this.getStartDate()).add(1,"days").toDate());this.updateDropdownSelection();this.updateClicks();return this}},handleEndDisplayFocusEvent:function(a,
b){var c="",d=this.getEndWrapperElement(),f=this;f.markDropdownElements();jq(".r9-datepicker-focus").removeClass("r9-datepicker-focus");jq(d).addClass("r9-datepicker-focus");var k=jq(a),h=f.clicks[0]||f.today.getTime();(!k.text()||f.clicks[1]<=h)&&!0!==this.options.skipForceSetDefaultEndOnFocusBlur&&f.setEndDate(moment(h).toDate());var n;null!==(n=f.getEndDate())&&(c=jq(f.endInput).val()||moment(n).format(f.options.endInputFormat));f.actOnStart=!1;f.showDropdown(d);f.options.accessible&&(jq(f.endDisplay).attr("contenteditable",
"true"),setTimeout(function(){k.text(c);f.selectDisplayBox(a)},1));b.stopPropagation();b.stopImmediatePropagation();jq("body").trigger("event",[b]);return this},handleEndDisplayBlurEvent:function(a,b){var c=this.getEndWrapperElement();this.options.accessible&&jq(this.endDisplay).attr("contenteditable","false");if(null!==this.clickTarget&&0<this.clickTarget.closest(".r9-datepicker").length)this.blurTarget=a;else return a=jq(a),""===a.text()&&!0===this.options.doNotFillWhenEmpty&&(this.setEndDate(null),
this.options.change&&this.options.change.apply(this,arguments)),this.hideDropdown(c),""===a.text()&&null===this.getEndDate()?!0!==this.options.skipForceSetDefaultEndOnFocusBlur&&(null!==this.getStartDate()?this.setEndDate(moment(this.getStartDate()).add(1,"days")):this.setEndDate(moment().toDate())):this.utils.applyEndVal(),this.updateDropdownSelection(),this},switchActOn:function(){var a=!this.actOnStart;this.hideDropdown(this.getWrapperElement());this.actOnStart=a;c(this.actOnStart?this.startInputTab:
this.endInputTab).focus()},findStartSection:function(){return this.getChildElement("start")},findStartDisplay:function(){return this.getChildElement("start-display")},findStartPlaceholderDisplay:function(){return this.getChildElement("start-placeholder")},findEndSection:function(){return this.getChildElement("end")},findEndDisplay:function(){return this.getChildElement("end-display")},findEndPlaceholderDisplay:function(){return this.getChildElement("end-placeholder")},findSummaryDisplay:function(){return this.getChildElement("summary-display")},
findClearDisplay:function(){return this.getChildElement("clear")},findCloseLink:function(){return c(".r9-datepicker-title-close",this.dropdown)},findTitle:function(){return c(".r9-datepicker-title \x3e span",this.dropdown)},findStartInput:function(){return this.getChildElement("start-formField")},findEndInput:function(){return this.getChildElement("end-formField")},findTabInput:function(){return this.getChildElement("tab")},findStartInputTab:function(){return this.getChildElement("start-tab")},findEndInputTab:function(){return this.getChildElement("end-tab")},
findStartWrapperElement:function(){return this.getChildElement("start-wrapper")},findEndWrapperElement:function(){return this.getChildElement("end-wrapper")},getDropdownEl:function(){return c("#datepicker")},getWrapperElement:function(){return this.actOnStart?this.startWrapper:this.endWrapper},getStartWrapperElement:function(){return this.startWrapper},getEndWrapperElement:function(){return this.endWrapper},handleNextPrevClickEvent:function(a,b){b=this.saveDropdownPositionState(this.dropdown);a=moment(parseInt(c(a).attr("data-val")));
this.dropdown[0].innerHTML=this.makeCalendarHTML(a);this.restoreDropdownPositionState(this.dropdown,b);this.runBelowCalendarCallback();this.updateDropdownSelection(null);this.loadBuzzData&&this.displayBuzzData();this.isResponsive()&&this.presentationCheck()&&(this.updateTitle(),this.bindEvent(this.findCloseLink(),"click",this.handleCloseEvent));this.wholeMonthSearch&&(this.createCalendarTabNavBindings(),this.createWholeMonthClickBindings(),this.createNoOfNightsChangedBinding(),jq(".tabWrapper.wholeMonth").hasClass("selected")?
jq(".tabWrapper.wholeMonth").trigger("click"):jq(".tabWrapper.specificDate").trigger("click"),jq(".searchform.rtow").hasClass("oneway")&&(jq(".tabWrapper.wholeMonth").hide(),jq(".tabWrapper.specificDate").click()));return!1},saveDropdownPositionState:function(a){if(a){var b=a.find(".r9-datepicker-pointer");a=c(a);if(0<b.length&&0<a.length)return{pointerPos:b.position(),wrapperPos:a.position(),wrapperHeight:a.height(),topPointer:0>b.position().top}}return null},restoreDropdownPositionState:function(a,
b){if(b&&a){var e=c(a);if(0<e.length){if(!b.topPointer){var d=e.height()-b.wrapperHeight;e.css("top",b.wrapperPos.top-d+"px")}a.find(".r9-datepicker-pointer").css("left",b.pointerPos.left+"px")}}},showDropdown:function(a){this.hideTimeout&&clearTimeout(this.hideTimeout);this.options.show&&this.options.show.apply(this,arguments);this.dropdown.parent().is(this.options.appendTo)||this.dropdown.appendTo(this.options.appendTo);this.showOverlay();this.markDropdownElements();this.updateClicks();"function"===
typeof this.options.minDateFunc&&this.options.minDateFunc(this);this.wholeMonthSearch&&jq(".searchform.rtow").hasClass("oneway")&&(d.events.publish("flights.search.rt.form.wholeMonthSelect.setSpecificDateCategory",{group:"wholeMonthSelect"}),this.daterangePickerDefaultNavTab="specificDate");this.dropdown[0].innerHTML=this.makeCalendarHTML(!this.actOnStart&&this.clicks[1]?this.clicks[1]:this.clicks[0]);this.updateDropdownSelection(null);this.runBelowCalendarCallback();this.wholeMonthSearch&&(this.createCalendarTabNavBindings(),
this.createWholeMonthClickBindings(),this.createNoOfNightsChangedBinding(),jq(".tabWrapper.wholeMonth").hasClass("selected")?jq(".tabWrapper.wholeMonth").trigger("click"):jq(".tabWrapper.specificDate").trigger("click"),jq(".searchform.rtow").hasClass("oneway")&&(jq(".tabWrapper.wholeMonth").hide(),jq(".tabWrapper.specificDate").click()));var b=this.calendarBaseClass;this.options.dropdownClass&&(b=b+" "+this.options.dropdownClass);c(a).addClass("r9-datepicker-focus");this.dropdown.addClass(b);this.advanceStyling&&
this.dropdown.addClass("r9-advance-styling");this.wholeMonthSearch?this.dropdown.addClass("CalendarWidget-WholeMonthSearch"):this.dropdown.hasClass("CalendarWidget-WholeMonthSearch")&&this.dropdown.removeClass("CalendarWidget-WholeMonthSearch");b=this.dropdown[0].style;this.positionDropdown(a);d.events.publish("common.widgets.datepicker.DaterangePicker.showDropdown",{wrapper:a});var e=this,g=c(window).width();this.resizeHandler=function(){var b=c(window).width();10<Math.abs(b-g)&&(g=b,e.positionDropdown(a))};
c(window).on("resize",this.resizeHandler);this.bindItemEvent("mousedown",this.handleItemClickEvent);if("ontouchstart"in document.documentElement){var f=this;this.overlay.addClass("touch");this.bindOverlayEvent("mousedown",function(){f.hideDropdown()})}else this.bindItemEvent("mouseover",this.handleItemHoverEvent),this.bindItemEvent("mouseout",this.handleItemHoverEndEvent);this.isResponsive()&&this.presentationCheck()&&(this.updateTitle(),this.bindEvent(this.findCloseLink(),"click",this.handleCloseEvent));
this.bindNextPrevEvent("mousedown",this.handleNextPrevClickEvent);this.dropdown.prop("data-owner",a.attr("id"));this.loadBuzzData&&this.displayBuzzData();b.display=this.isResponsive()&&this.presentationCheck()?"block":"inline";this.wholeMonthSearch&&(e=this,jq(".noOfNightsInput").on("click",function(){jq(this).change().select()}),setTimeout(function(){jq(".noOfNightsInput").is(":focus")||(e.clickTarget=jq(".noOfNightsInput"),jq(".noOfNightsInput").trigger("click"))},300));this.isResponsive()&&(this.presentationCheck()?
this.html.addClass("mobile-overlay-fix-content"):this.html.removeClass("mobile-overlay-fix-content"))},createCalendarTabNavBindings:function(){var a=this;jq(a.dropdown).find(".tabWrapper").on("click",function(){var b=this;jq(a.dropdown).find(".tabWrapper:not(no-click)").removeClass("selected");jq(this).addClass("selected");jq(a.dropdown).removeClass("SelectedNavTab-Date").removeClass("SelectedNavTab-Month");if(jq(this).hasClass("specificDate"))setTimeout(function(){var c=jq(b).width(),e=jq(b).position().left-
25;jq(a.dropdown).find(".tabUnderlay").css({left:e,width:c})},10),setTimeout(function(){var b=jq(a.dropdown).find(".tabUnderlay");b.hasClass("no-transition")&&b.removeClass("no-transition")},100),jq(a.dropdown).addClass("SelectedNavTab-Date"),jq(a.dropdown).find(".plusMinus").stop().fadeIn(),"undefined"!==typeof d.storage&&d.storage.set("daterangePickerDefaultNavTab","specificDate"),d.events.publish("flights.search.rt.form.wholeMonthSelect.setSpecificDateCategory",{group:"wholeMonthSelect"}),this.daterangePickerDefaultNavTab=
"specificDate";else{var c=jq(a.dropdown).find(".tabUnderlay");setTimeout(function(){var a=jq(b).width(),e=jq(b).position().left-25;c.css({left:e,width:a})},10);setTimeout(function(){var b=jq(a.dropdown).find(".tabUnderlay");b.hasClass("no-transition")&&b.removeClass("no-transition")},100);jq(a.dropdown).addClass("SelectedNavTab-Month");jq(a.dropdown).find(".plusMinus").stop().fadeOut();"undefined"!==typeof d.storage&&d.storage.set("daterangePickerDefaultNavTab","wholeMonthSearch");setTimeout(function(){jq(".noOfNightsInput").is(":focus")||
(a.clickTarget=jq(".noOfNightsInput"),jq(".noOfNightsInput").trigger("click"))},300);d.events.publish("flights.search.rt.form.wholeMonthSelect.setWholeMonthCategory",{group:"wholeMonthSelect"});this.daterangePickerDefaultNavTab="wholeMonthSearch"}});jq(a.dropdown).find(".input.flexPlusMinus").on("click",function(){jq(this).toggleClass("checked");jq(this).hasClass("checked")?("undefined"!==typeof d.storage&&d.storage.set("flexPlusMinusChecked",!0),d.events.publish("flights.search.rt.form.wholeMonthSelect.enablePlusMinusSearch",
{group:"wholeMonthSelect"})):("undefined"!==typeof d.storage&&d.storage.set("flexPlusMinusChecked",!1),d.events.publish("flights.search.rt.form.wholeMonthSelect.disablePlusMinusSearch",{group:"wholeMonthSelect"}))})},createWholeMonthClickBindings:function(){var a=this;jq(a.dropdown).off("click").on("click",".monthWrapper",function(){jq(a.dropdown).find(".monthWrapper").removeClass("selected");jq(this).addClass("selected");var b=jq(this).data("month"),c=jq(this).data("end-of-month"),g=jq(this).data("year"),
f=new Date(g,b-1,1),c=new Date(g,b-1,c);moment(f).isBefore(moment())&&(f=moment().toDate());"undefined"!==typeof d.storage&&(d.storage.set("flexSelectedMonth",b),d.storage.set("flexSelectedYear",g));d.events.publish("flights.search.rt.form.wholeMonthSelect",{group:"wholeMonthSelect",startDate:f,endDate:c});d.Analytics.api.trackEvent({category:"sw16-flex-to-the-max",action:"searchByWholeMonthClick",label:"month",value:b-1});a.handleCloseEvent()})},createNoOfNightsChangedBinding:function(){var a=jq(this.dropdown).find(".noOfNightsInput");
jq(this.dropdown).off("change").on("change",".noOfNightsInput",function(){var b,c;b=a.val().replace(" ","").replace("nights","").split("-");1<b.length?(c=b[0],b=b[1]):(c=b[0],b=b[0]);7<b-c&&(c=b-7);var g=c+"-"+b;c===b&&(g=c);a.val(g);"undefined"!==typeof d.storage&&d.storage.set("flexNoOfNights",g);d.events.publish("flights.search.rt.form.noOfNightsChanged",{group:"wholeMonthSelect",noOfNights:a.val()})})},endStartIsSameField:function(){return this.options.singleDateMode||this.options.singlePickerWithSingleField},
refreshWidth:function(){var a=this.dropdown[0].style;a.width="inherit";var b=this.dropdown.outerWidth();this.options.minWidth&&(b=Math.max(this.options.minWidth,b));this.options.maxWidth&&(b=Math.min(this.options.maxWidth,b));a.width=b+this.options.offsetWidth+"px"},positionDropdown:function(a){var b=a.offset(),e=jq(this.options.appendTo).offset(),g=this.dropdown[0].style;g.zIndex=10009;c("#datepicker").removeClass("r9-datepicker-responsive-right-position");if(this.isResponsive()&&this.presentationCheck())this.dropdown.css({left:"0",
top:d.utils.presentation.isMobile()?"0":"4%"});else{var f=b.left-e.left,k=f+this.dropdown.outerWidth();k>window.innerWidth&&(k-=window.innerWidth,f=f-k-15,this.dropdown.find(".r9-datepicker-pointer").css("left",k+36+"px"));g.left=f+"px";f=0;this.element.parent()[0]===jq(document.body)[0]&&(f=parseInt((jq(document.body).css("top")||"0").replace("-",""))||0);this.shouldFlipDirection()?(this.dropdown.addClass("up"),g.top=f+b.top-this.dropdown.outerHeight()-e.top+"px"):(this.dropdown.removeClass("up"),
g.top=f+b.top+a.outerHeight()-e.top+"px")}},shouldFlipDirection:function(){var a=c(window).scrollTop(),b=a+c(window).outerHeight(),e=this.dropdown.outerHeight(),d=this.element.offset().top;return d+this.element.outerHeight()+e>b&&!(d-e<a)},initDropdown:function(){var a=this.getDropdownId(this.element),b=this.getDropdownEl(this.element).get(0);if("undefined"===typeof b){var c=d.Widgets.DaterangePicker.prototype.widgetBaseClass+" R9-Overlay";this.options.dropdownClass&&(c=c+" "+this.options.dropdownClass);
b=jq("\x3cdiv\x3e\x3c/div\x3e",{id:a,css:{display:"none",position:"absolute"}}).appendTo(this.options.appendTo)[0];jq(b).addClass(c);this.advanceStyling&&jq(b).addClass("r9-advance-styling");this.wholeMonthSearch&&(jq(b).addClass("CalendarWidget-WholeMonthSearch"),a="specificDate","undefined"!==typeof d.storage&&(a="undefined"!==typeof d.storage.get("daterangePickerDefaultNavTab")?d.storage.get("daterangePickerDefaultNavTab"):"specificDate"),"wholeMonthSearch"===a?jq(b).addClass("SelectedNavTab-Month"):
jq(b).addClass("SelectedNavTab-Date"))}this.dropdown=jq(b);this.overlay=jq("#"+this.widgetBaseClass+"-overlay");this.overlay.length||(this.overlay=jq('\x3cdiv id\x3d"'+this.widgetBaseClass+'-overlay" class\x3d"'+this.widgetBaseClass+'-overlay R9-Overlay"\x3e\x3c/div\x3e').appendTo(this.options.appendTo))},isResponsive:function(){return this.options.responsive},presentationCheck:function(){return this.options.presentationCheck()},handleResponsive:function(){this.presentationCheck()?(this.dropdown.addClass("mobile-datepicker"),
this.overlay.addClass("mobile-overlay"),this.isDropdownVisible()&&!this.html.hasClass("mobile-overlay-fix-content")&&(this.html.addClass("mobile-overlay-fix-content"),this.updateTitle(),this.bindEvent(this.findCloseLink(),"click",this.handleCloseEvent))):(this.dropdown.removeClass("mobile-datepicker"),this.overlay.removeClass("mobile-overlay"),this.html.removeClass("mobile-overlay-fix-content"));this.positionDropdown(this.actOnStart?this.getStartWrapperElement():this.getEndWrapperElement())},updateTitle:function(){var a=
"",b,c="";null!==(b=this.getStartDate())&&(a=moment(b).format(this.options.titleFormat));null!==(c=this.getEndDate())&&b!==c&&(a+=(a?" - ":"")+moment(c).format(this.options.titleFormat));this.findTitle().text(a)}}))})(R9,jQuery);(function(d){d.extend("common.widgets.datepicker.DaterangePicker.prototype.options",{startInputFormat:"MM/DD/YYYY",endInputFormat:"MM/DD/YYYY",startFormat:"ddd M/D",endFormat:"ddd M/D",inlineDisplayFormat:"MMM D",titleFormat:"MMM D"})})(window.R9);(function(c){c.createWidgetClass("datepicker.DatePickerTrackFormatter",{dateFormat:"YYYY-MM-DD",formatCommonData:function(a){var b=this.getParentId(),d=b?c.question.ask("base.search.SearchForm.type."+b):"";return{from:this.formatDateType(a.options.startDate,a.startDate),to:a.dateMode===a.DateMode.SINGLE?void 0:this.formatDateType(a.options.endDate,a.endDate),searchformId:b,searchformType:c.VestigoType.SearchFormType[d]}},getParentId:function(){return c.question.ask("base.search.SearchForm.id")||""},
formatDateType:function(a,b){return new c.VestigoType.DateType(a?this.formatDate(a):"",b?this.formatDate(b):"")},formatDate:function(a){return a&&moment(a).format(this.dateFormat)}})})(R9);(function(d,f){d.createWidgetClass("datepicker.DatePicker",{DateMode:{SINGLE:"single",RANGE:"range",WEEKEND:"weekend",OPENFLEX:"openflex"},Keys:{LEFT:37,UP:38,RIGHT:39,DOWN:40,TAB:9,RETURN:13,PAGE_UP:33,PAGE_DOWN:34,SPACE:32,HOME:36,SHIFT:16,END:35,ESC:27},options:{msg:{},title:"",initDate:"",fullCssClass:"Common-Widgets-Datepicker-DatePicker",startDate:"",endDate:"",dateMode:"range",group:"",updateGroup:"",minRange:0,change:null,dismiss:null,closeDelay:0,rising:!1,getFormData:null,consecutive:!0,
delayShowDropdown:f.noop,showDropdownDelay:200,keepOpenOnRangeStartChange:!0,hasPointer:!0,mobileBreakpoint:568,optionalReturn:!1,markOpenFlexDates:!1,markWeekendDates:!1,hasCloseButton:!0,mobileFriendly:!1,autoScrollPosition:!1,trackEnabled:!0,allowNullDates:!1},dateMode:"range",startDate:0,endDate:0,tempDate:0,weekendStartTime:{day:4,partial:""},weekendEndTime:{day:0,partial:""},picking:"startDate",prevState:null,visible:!1,html:null,fullScreen:!1,calendar:null,cssClasses:[],lastAboveMobileContent:null,
addFixedClass:!1,calendarElementCss:{},dateTrackFormatter:null,init:function(){this.cssClasses=[];this.html=f("html");this.addCssClass(this.options.fullCssClass);this.options.getFormData&&this.addCssClass("Buzz");this.makeAboveCalendarContent();this.makeBelowCalendarContent();d.events.when("common.widgets.datepicker.calendar.initialized",function(a){this.calendar=a.instance;this.options.startDate&&this.validateDate(this.options.startDate)&&(this.startDate=moment(this.options.startDate).valueOf());
this.options.endDate&&this.validateDate(this.options.endDate)&&(this.endDate=moment(this.options.endDate).valueOf());this.options.dateMode&&this.setDateMode(this.options.dateMode);this.addMeToCalendar()}.bind(this));this.dateTrackFormatter=this.options.trackEnabled?new d.common.widgets.datepicker.DatePickerTrackFormatter:null},addMeToCalendar:function(){var a=this.getExtraOptions();this.calendar.addPicker(f.extend({},{id:this.id(),dateMode:this.dateMode,initDate:this.options.initDate,title:this.options.title,
cssClass:this.getCssClass.bind(this),group:this.options.group,onLoad:this.onLoad.bind(this),afterLoad:this.afterLoad.bind(this),onUnload:this.onUnload.bind(this),onDayClick:this.onDayClick.bind(this),onDayOver:this.onDayPreviewOver.bind(this),onDayOut:this.onDayPreviewOut.bind(this),onDayKeydown:this.onDayKeydown.bind(this),autoScrollPosition:this.options.autoScrollPosition},a))},onLoad:function(a){this.addAboveCalendarContent(a.aboveCalendarContainer,a.leftContainer);this.addBelowCalendarContent(a.belowCalendarContainer,
a.leftContainer)},afterLoad:function(a){},onUnload:function(){this.removeAboveCalendarContent();this.removeBelowCalendarContent();this.updatePickingVal("startDate")},addAboveCalendarContent:function(a){var b=this.element.find(".aboveCalContent");b.length&&(this.aboveCalContent=b,a.append(b))},addBelowCalendarContent:function(){},removeAboveCalendarContent:function(){this.aboveCalContent&&this.element.append(this.aboveCalContent);this.lastAboveMobileContent&&this.element.append(this.lastAboveMobileContent)},
removeBelowCalendarContent:function(){},addEventHandlers:function(){this.subscribe("DateInput.update",{group:this.options.group},this.onDateInputUpdate.bind(this));this.subscribe("DateInput.summon",{group:this.options.group},this.onSummon.bind(this));this.subscribe("DateInput.dismiss",{group:this.options.group},this.onDismiss.bind(this));this.subscribe("Calendar.monthchange",{group:this.options.group},this.onMonthChange.bind(this));this.subscribe("forceDismiss.DatePicker",this.onDismiss.bind(this));
this.subscribe("DateInput.change.element.style",this.changeElementStyle.bind(this));f(document).on("click.DatePicker",this.hideOnClickOut.bind(this));f(window).on("resize.DatePicker",this.handleWindowResize.bind(this));this.options.optionalReturn&&this.subscribe("DateInput.clear",{group:this.options.group},this.onClear.bind(this))},destroy:function(){f(window).off("resize.DatePicker"+this.id());f(document).off("click.DatePicker"+this.id());this.base();this.element.remove()},getCssClass:function(){return[this.cssClasses.join(" "),
"R9-Overlay"].join(" ")},hideOnClickOut:function(a){var b=f(a.target).closest("[data-date-group\x3d%s]".format(this.options.group));if((a.originalEvent||!d.config.getBoolean("ui.xp.autoopen-dp",!1))&&this.isCalendarOpen()&&0===b.length)this.onDismiss()},handleWindowResize:function(){this.isCalendarOpen()&&(this.calendar.append(this.options.appendTo)||this.calendar.position(this.picking))},publishUpdate:function(a){f.extend(a,{updateGroup:this.options.updateGroup,group:this.options.group});d.events.publish("DatePicker.update",
a)},onDateInputUpdate:function(a){if(this.isCalendarOpen()||a.force)switch(a.clear&&this.clear(),a.picking&&this.updatePickingVal(a.picking),a.weekendStartTime&&(this.weekendStartTime=this.parseWeekendTimes(a.weekendStartTime)),a.weekendEndTime&&(this.weekendEndTime=this.parseWeekendTimes(a.weekendEndTime)),a.dateMode&&this.setDateMode(a.dateMode),a.action){case "preview":this.updatePickingVal(a.field);!a.previous&&a.value||this.removeDatePreview(a.previous,!0);a.value&&this.previewDate(a.value,a.preventUpdate);
break;case "change":a.spinner&&this.handleSpinnerUpdate(a);this.changeDate(a.value,a.focused||a.spinner,a.tabForward,a.event);break;case "tab":this.handleTabIntoEvent(a)}},addCssClass:function(a){a.split(" ").forEach(function(a){0<=this.cssClasses.indexOf(a)||this.cssClasses.push(a)}.bind(this))},changeElementStyle:function(a){this.addFixedClass=a.addFixedClass;this.calendarElementCss=a.calendarElementCss},removeCssClass:function(a){a.split(" ").forEach(function(a){for(var b=this.cssClasses.indexOf(a);0<=
b;)this.cssClasses.splice(b,1),b=this.cssClasses.indexOf(a)}.bind(this))},onSummon:function(a){if(this.calendar)if(this.tempDate=0,"function"===typeof this.options.delayShowDropdown&&this.options.delayShowDropdown()&&!this.showDropdownTimeout)this.showDropdownTimeout=setTimeout(this.onSummon.bind(this,a),this.options.showDropdownDelay);else{null!==this.showDropdownTimeout&&(clearTimeout(this.showDropdownTimeout),this.showDropdownTimeout=null);this.setPicking(a.field,!0);null!==this.options.getFormData?
this.addCssClass("Buzz"):this.removeCssClass("Buzz");a.modal?this.addCssClass("InModal"):this.removeCssClass("InModal");a.mcfly?this.addCssClass("mcfly"):this.removeCssClass("mcfly");a.inContent?this.addCssClass("InContent"):this.removeCssClass("InContent");this.addFixedClass?this.addCssClass("calendar-fixed"):this.removeCssClass("calendar-fixed");a.rising?this.addCssClass("Rising"):this.removeCssClass("Rising");a.sticky?this.addCssClass("InSticky"):this.removeCssClass("InSticky");this.validateDate(a.minDate,
!0)&&this.setMinDate(a.minDate);!0===this.options.mobileFriendly&&this.addCssClass("mobile-friendly");!0===this.options.seoDatepicker&&this.addCssClass("seo-datepicker");if(!this.isCalendarOpen()||this.calendar.isDifferentPicker(this.id())){this.calendar.open(this.id());var b=d.question.ask("DateInput.%s.startDate".format(this.options.group));b&&(this.startDate=b.value);if(this.dateMode===this.DateMode.RANGE){var c=d.question.ask("DateInput.%s.endDate".format(this.options.group));this.validateDateRange(b.value,
c.value)&&(this.startDate=b.value,this.endDate=c.value);c&&(this.endDate=c.value)}d.events.publish("DatePicker.opened",this.options.group);this.setDateMode(this.dateMode,!1,!0)}this.calendar.setDisplayHeight();this.calendar.append(this.options.appendTo)||this.calendar.position(this.getPicking());this.moveDateIntoView(this[a.field]);this.markSelectedDays();this.updateBuzzData();this.options.hasCloseButton&&this.bindEvent(this.findCloseLink(),"click",this.handleCloseEvent);f(".Common-Widgets-Datepicker-Calendar.Common-Widgets-Datepicker-DatePicker").css(this.calendarElementCss)}},
dismissDatePicker:function(a){this.calendar&&(this.trackInteraction(),this.visible=!1,this.hideTooltip(),0!==this.tempDate&&this.changeDate(this.tempDate,!1,!1,null),this.calendar.buffer(this.options.appendTo),this.calendar.close(this.id()),this.publishUpdate(f.extend(a,{action:"blur",fields:{startDate:!0,endDate:!0},format:"display"})),"function"===typeof this.options.dismiss&&this.options.dismiss(),d.events.publish("DatePicker.closed",f.extend({},a,{group:this.options.group})))},onDismiss:function(a){this.shouldDismiss(a)&&
(this.options.closeDelay?setTimeout(this.dismissDatePicker.bind(this,a),this.options.closeDelay):this.dismissDatePicker(a))},shouldDismiss:function(a){return this.dateMode===this.DateMode.RANGE&&a&&this.options.consecutive&&(a.tabForward&&"startDate"===this.getPicking()||a.tabBackward&&"endDate"===this.getPicking())?!1:!0},onClear:function(a){},onDayClick:function(a){a=f(a).data("val");this.changeDate(a)},changeDate:function(a,b,c,e){moment(a);var g=!1,k=!0,f=this.getPicking(),d={action:"change",
fields:{}};this.tempDate=0;if(this.dateMode===this.DateMode.RANGE){if("startDate"===this.getPicking()&&this.validateDate(a))this.startDate===a&&this.options.consecutive?this.setPicking("endDate",c,void 0,c):(this.startDate=a,d.fields.startDate=a,this.validateDateRange(a,this.endDate)||(this.endDate=0,this.options.optionalReturn?d.fields.endDate=null:(d.fields.endDate=this.getMinEndDate(),this.endDate=d.fields.endDate)),this.moveDateIntoView(a),this.markSelectedDays(),!b&&this.isCalendarOpen()&&((0===
this.endDate||this.options.keepOpenOnRangeStartChange)&&this.options.consecutive?this.setPicking("endDate",c,void 0,c):g=!0)),"endDate"===this.wasPicking&&this.endDate&&(d.fields.endDate=this.endDate);else if("endDate"===this.getPicking()&&this.validateDate(a))if(this.endDate===a)k=!1,0===this.startDate&&this.options.consecutive?this.setPicking("startDate"):g=!0;else{if(this.validateDateRange(this.startDate,a)||!this.startDate)this.endDate=a,d.fields.endDate=a;this.startDate||(this.startDate=this.getMinStartDate(),
d.fields.startDate=this.startDate);this.moveDateIntoView(this.endDate);this.markSelectedDays();b||(0===this.startDate&&this.options.consecutive?this.setPicking("startDate"):g=!0)}d.picking=this.getPicking()}else{this.moveDateIntoView(a);d.fields.startDate=a;if(this.validateDate(this.endDate)&&!this.validateDateRange(a,this.endDate)){var l=Math.max(this.options.minRange,1),l=moment(a).add(l,"days");d.fields.endDate=l.valueOf();this.endDate=d.fields.endDate}this.startDate=a;this.markSelectedDays();
b||(g=!0)}d.tabForward=c;k&&this.publishUpdate(d);"function"===typeof this.options.change&&(a=[this.startDate],a.push(this.endDate?this.endDate:null),a.push(f),this.options.change.apply(this,a));g&&(g={},g.field=this.picking,g.tabForward=c,g.event=e,g.focusDisplay=!0,this.onDismiss(g))},moveDateIntoView:function(a){0!==a&&this.isCalendarOpen()&&(a=this.calendar.calculateMonthOffset(a),0!==a&&this.calendar.changeMonth(a))},clear:function(){this.endDate=this.startDate=0;this.setPicking("startDate");
this.clearDayState("preview");this.clearDayState("hover");this.clearDayState("highlighted");this.clearDayState("selected");this.clearDayState("startDate");this.clearDayState("endDate");this.publishUpdate({action:"clear",fields:{startDate:0,endDate:0}})},onMonthChange:function(){this.updateBuzzData();this.markSelectedDays()},clearDayState:function(a){var b=this.calendar.getSelectableDays(".%s".format(a)).removeClass(a);"selected"===a&&(b.removeAttr("aria-selected"),this.calendar.getSelectableDays(".flex").removeClass("flex"))},
validateDate:function(a,b){if("undefined"===typeof a||0===a)return!1;a=moment(a);var c=this.calendar.getMinDate(this.id());if(a.isValid()){if(a.isBefore(this.calendar.now)&&!this.options.allowPastDates||!b&&null!==c&&a.isBefore(c))return!1}else return!1;return!0},validateDateRange:function(a,b){return a&&b?this.validateMinRange(a,b)&&this.validateDate(a)&&this.validateDate(b):!1},validateMinRange:function(a,b){a=moment(a);return moment(b).diff(a,"days")>=this.options.minRange},getMinStartDate:function(){return this.endDate?
moment(this.endDate).subtract(this.options.minRange,"days").valueOf():0},getMinEndDate:function(){return this.startDate?moment(this.startDate).add(this.options.minRange,"days").valueOf():0},onDayPreviewOver:function(a){a=f(a).data("val");this.previewDate(a)},previewDate:function(a,b){var c=moment(a),e={action:"preview",fields:{},picking:this.getPicking()};if(!a||c.isBefore(this.calendar.now))c=this.calendar.now.clone(),a=c.valueOf();else if(c.isSame(this.calendar.maxDate)||c.isAfter(this.calendar.maxDate))c=
this.calendar.maxDate.clone(),a=c.valueOf();this.dateMode===this.DateMode.RANGE?"endDate"===this.getPicking()&&0!==this.startDate?this.validateMinRange(this.startDate,a)?this.validateDateRange(this.startDate,a)?e.fields[this.getPicking()]=a:e.endDate=this.getMinEndDate():(0===this.endDate?(this.endDate=this.startDate,this.startDate=0,e.fields={startDate:a,endDate:this.endDate}):e.fields={startDate:a,endDate:0},this.wasPicking=this.getPicking(),this.setPicking("startDate",!0,!0),e.picking="startDate"):
e.fields[this.getPicking()]=a:e.fields.startDate=a;b||this.publishUpdate(e);this.moveDateIntoView(a);this.markPreviewedDays(a)},removeDatePreview:function(a,b){if(this.isCalendarOpen()){a={action:"preview",fields:{startDate:0,endDate:0},clear:!0};this.clearDayState("preview");this.clearDayState("hover");this.hideTooltip();if(this.wasPicking){var c=this[this.wasPicking],e=this[this.getPicking()];if(0===e||0===c)this[this.wasPicking]=e,this[this.getPicking()]=c;delete a.fields[this.wasPicking];this.setPicking(this.wasPicking,
!1,!0);this.wasPicking=null;this.markSelectedDays()}a.picking=this.getPicking();b||this.publishUpdate(a)}},onDayPreviewOut:function(a){a=f(a).data("val");this.removeDatePreview(a)},setDateMode:function(a,b,c){this.dateMode=a;c||this.dateMode===this.DateMode.RANGE||this.setPicking("startDate");this.isCalendarOpen()&&this.markSelectedDays()},computeActiveDates:function(a,b){var c=function(){return a?[a.format(b)]:[b]};switch(this.dateMode){case this.DateMode.RANGE:return this.computeActiveRangeDates(a,
b);case this.DateMode.WEEKEND:return this.options.markWeekendDates?this.computeActiveWeekendDates(a,b):c();case this.DateMode.OPENFLEX:return this.options.markOpenFlexDates?this.computeActiveOpenFlexDates(a,b):c();default:return c()}},computeActiveRangeDates:function(a,b){var c;b||(b=this[this.getPicking()]);b&&(c=moment(b));var e=[];if(c)if("startDate"===this.getPicking()&&this.endDate&&c.valueOf()<=this.endDate){b=this.endDate;var g=this.calendar.getMonthDate(3),d=moment(this.endDate);if(g.isSame(d)||
g.isBefore(d))b=this.calendar.getMonthDate(3).valueOf();for(;c.valueOf()<=b;)a?e.push(a.format(c.valueOf())):e.push(c.valueOf()),c.add(1,"day")}else if("endDate"===this.getPicking()&&this.startDate&&c.valueOf()>=this.startDate){b=this.startDate;g=this.calendar.getMonthDate(-1);d=moment(this.startDate);if(g.isSame(d)||g.isAfter(d))b=this.calendar.getMonthDate(-1).valueOf();for(;c.valueOf()>=b;)a?e.unshift(a.format(c.valueOf())):e.unshift(c.valueOf()),c.add(-1,"day")}else a?e.push(a.format(b)):e.push(b);
return e},computeActiveWeekendDates:function(a,b){b=b?moment(b):moment(this.startDate);for(var c=b.clone().add(5,"weeks"),e={selected:[],highlighted:[]},d=!1,f=[],h=[];b.isSame(c)||b.isBefore(c);)!d&&b.day()>this.weekendStartTime.day||(b.day()===this.weekendStartTime.day?(d=!0,f=[],h=[],a?f.push(a.format(b.valueOf())):f.push(b.valueOf())):b.day()===this.weekendEndTime.day&&d?(a?f.push(a.format(b.valueOf())):f.push(b.valueOf()),e.selected=e.selected.concat(f),e.highlighted=e.highlighted.concat(h)):
(b.day()>this.weekendStartTime.day||b.day()<this.weekendEndTime.day)&&d&&(a?h.push(a.format(b.valueOf())):h.push(b.valueOf()))),b.add(1,"day");return e},computeActiveOpenFlexDates:function(a,b){b=b?moment(b):moment(this.startDate);for(var c=b.clone().add(5,"weeks"),e=[];b.isSame(c)||b.isBefore(c);)a?e.push(a.format(b.valueOf())):e.push(b.valueOf()),b.add(1,"day");return e},parseWeekendTimes:function(a){var b=a.split("_");a=b[0];b=b[1];return{day:moment().set("day",a).day(),partial:"ANYTIME"!==b?b:
""}},markSelectedDays:function(){var a;if(this.isCalendarOpen())switch(this.clearDayState("highlighted"),this.clearDayState("preview"),this.clearDayState("hover"),this.clearDayState("selected"),this.clearDayState("startDate"),this.clearDayState("endDate"),this.dateMode){case this.DateMode.RANGE:a=this.computeActiveDates("[data-val\x3d%s]");1<a.length&&this.calendar.highlightDates(a);this.startDate&&(a=this.getStartDayElements(),a.flex&&this.calendar.markFlex(a.flex),a.exact&&this.calendar.markStartDate(a.exact));
this.endDate&&(a=this.getEndDayElements(),a.flex&&this.calendar.markFlex(a.flex),a.exact&&this.calendar.markEndDate(a.exact));break;case this.DateMode.OPENFLEX:this.options.markOpenFlexDates&&(a=this.computeActiveDates("[data-val\x3d%s]"),this.calendar.getSelectableDays(a.join(",")).addClass("highlighted"));this.calendar.getDayElement(this.startDate).addClass("selected").attr("aria-selected","true");break;case this.DateMode.WEEKEND:this.options.markWeekendDates&&(a=this.computeActiveDates("[data-val\x3d%s]"),
this.calendar.getSelectableDays(a.selected.join(",")).addClass("highlighted"),a.highlighted.length&&this.calendar.getSelectableDays(a.highlighted.join(",")).addClass("highlighted"));this.calendar.getDayElement(this.startDate).addClass("selected").attr("aria-selected","true");break;default:this.calendar.selectDate(this.startDate)}},getStartDayElements:function(){return{exact:this.startDate}},getEndDayElements:function(){return{exact:this.endDate}},markPreviewedDays:function(a){this.clearDayState("preview");
this.clearDayState("hover");var b=this.computeActiveDates("[data-val\x3d%s]",a);this.calendar.markPreviewDates(b);a=this.calendar.getDayElement(a);a.addClass("hover");a.attr("data-tip")&&this.showTooltip(a)},setPicking:function(a,b,c,e){if(this.getPicking()!==a){this.tempDate=0;var d={},f={};d[this.getPicking()]=!0;f[a]=!0;this.updatePickingVal(a);this.calendar.position(this.getPicking(),c);b||this.publishUpdate({action:"focus",fields:f,format:"input"});this.publishUpdate({action:"blur",fields:d,
tabForward:e})}},updatePickingVal:function(a){this.picking=a},getPicking:function(){return this.picking},findCloseLink:function(){return f(".DatePickerTitleClose",this.calendar.element)},handleCloseEvent:function(){this.onDismiss()},bindEvent:function(a,b,c){var e=this;b+="."+this.id();a.off(b).on(b,function(a){return c.call(e,this,a)})},isBuzzEnabled:function(){return"function"===typeof this.options.getFormData&&d.DatePicker&&d.DatePicker.BuzzData},updateBuzzData:function(){this.isBuzzEnabled()&&
(new d.DatePicker.BuzzData).fetch(this.options.getFormData(),this.handleBuzzUpdate.bind(this))},handleBuzzUpdate:function(a){var b=this,c=this.calendar.months.find("[data-tip\x3dBUZZ_LOW]"),e=[];window.subData&&(a=window.subData);if("object"===typeof a.dates)for(var d in a.dates)a.dates.hasOwnProperty(d)&&"LOW"===a.dates[d]&&e.push(moment(d).valueOf());0<c.length&&c.each(function(a,b){a=f(b);b=e.indexOf(a.attr("data-val"));-1==b?a.removeClass("buzz-date-low").removeAttr("data-tip"):e.splice(b,1)});
f.each(e,function(a,c){b.calendar.getDayElement(c).addClass("buzz-date-low").attr("data-tip","BUZZ_LOW")})},makeAboveCalendarContent:function(){f("\x3cdiv class\x3d'aboveCalContent'\x3e"+(this.options.hasCloseButton?"\x3ca class\x3d'DatePickerTitleClose'\x3eX\x3c/a\x3e":"")+"\x3cdiv id\x3d'"+this.id("BUZZ_LOW")+"' class\x3d'dayTip buzzMsg'\x3e"+this.options.msg.BUZZ_MESSAGE_LOW+"\x3c/div\x3e\x3c/div\x3e").appendTo(this.element)},makeBelowCalendarContent:function(){},showTooltip:function(a){var b=
this.getChildElement(a.attr("data-tip"));a=a.offset();var c=this.calendar.element.offset();b.css({top:Math.round(a.top-c.top),left:Math.round(a.left-c.left)}).show()},hideTooltip:function(){this.calendar.hideTooltip()},setMinDate:function(a){this.calendar.setMinDate(a,this.id())},onDayKeydown:function(a,b){a=moment(this.getCurrentDayVal());var c=!0,d=!1,f=!1,k=!0,h=!1;switch(b.which){case this.Keys.UP:a.subtract(1,"week");break;case this.Keys.DOWN:a.add(1,"week");break;case this.Keys.LEFT:a.subtract(1,
"day");break;case this.Keys.RIGHT:a.add(1,"day");break;case this.Keys.PAGE_UP:b.ctrlKey||b.metaKey?a.subtract(1,"year"):a.subtract(1,"month");break;case this.Keys.PAGE_DOWN:b.ctrlKey||b.metaKey?a.add(1,"year"):a.add(1,"month");break;case this.Keys.HOME:a=a.startOf("month");break;case this.Keys.END:a=a.endOf("month");break;case this.Keys.SPACE:this.tempDate=0;d=!0;c=!1;f=!0;break;case this.Keys.TAB:this.tempDate=0;c=!1;b.shiftKey?this.handleDayTabBackward():(h=d=!0,k=!1);break;case this.Keys.RETURN:this.tempDate=
0;c=!1;d=!0;break;case this.Keys.ESC:this.tempDate=0;this.onDismiss({focusDisplay:!0});break;default:c=k=!1}c&&this.validateDate(a.valueOf(),!1)&&("endDate"!==this.picking||this.validateDateRange(this.startDate,a.valueOf())||this.options.allowNullDates)&&(this.tempDate=a.valueOf(),this.previewDate(this.tempDate),this.calendar.getDayElement(this.tempDate).focus());d&&this.changeDate(a.valueOf(),f,h,b);k&&b.preventDefault()},getCurrentDayVal:function(){var a=this.tempDate?this.tempDate:this[this.getPicking()];
0===a&&(a="startDate"===this.getPicking()||0===this.startDate?moment().startOf("day").valueOf():this.getMinEndDate());return a},publishCurrentInputFocus:function(){var a={};a[this.picking]=!0;this.publishUpdate({action:"focus",fields:a,format:"input"})},handleTabIntoEvent:function(a){this.setPicking(a.field);var b=a&&a.event&&a.event.shiftKey,c;if("startDate"===this.getPicking())if(b)this.onDismiss(a);else c=!0,this.calendar.getDayElement(this.startDate).focus();else"endDate"===this.getPicking()&&
(c=!0,b?(this.setPicking("startDate"),this.calendar.getDayElement(this.startDate).focus()):this.calendar.getDayElement(this.endDate).focus());c&&a&&a.event&&a.event.preventDefault()},handleDayTabBackward:function(){this.publishCurrentInputFocus()},handleSpinnerUpdate:function(a){var b=a.currentValue,c=a.delta;b||("endDate"===this.getPicking()&&this.startDate?b=this.getMinEndDate():(b=(new Date).valueOf(),c=1));a.value=moment(b).add(c,"day").valueOf()},isCalendarOpen:function(){return this.calendar&&
this.calendar.isOpen&&this.calendar.currentPickerId===this.id()},getExtraOptions:function(){return{}},trackInteraction:function(){if(this.dateTrackFormatter&&this.isCalendarOpen()){var a=this.dateTrackFormatter.formatCommonData(this),b=new d.VestigoType.DatePrecisionHistory(d.VestigoType.DatePrecision.exact);d.VestigoEvents.calendarpicker.dates(a.from,b,a.searchformId,a.searchformType,a.to,b)}}})})(R9,jQuery);(function(a,e){a.createWidgetClass("dropdown.StyleJamDropdownDialogTrigger",{options:{states:null,showFocusIndication:!1,useValueLabel:!1},isFocused:!1,isOpen:!1,cover:null,init:function(){this.options.useCover&&(this.cover=this.getChildElement("cover"))},addEventHandlers:function(){var d=this,c=this.options.states||{};this.element.on("focus",this.onFocus.bind(this));this.element.on("blur",this.onBlur.bind(this));this.options.showFocusIndication&&this.subscribe("body.accessibilityMode.enabled",function(b){b?
a.dom.swapClasses(d.element,"",c.focusModeHighlight):a.dom.swapClasses(d.element,c.focusModeHighlight,"")});this.subscribe("hotels.detailsv2.sticky.toggle",function(b){b?a.dom.swapClasses(this.element,this.options.styles.dropdownTrigger,this.options.styles.dropdownTriggerSticky):a.dom.swapClasses(this.element,this.options.styles.dropdownTriggerSticky,this.options.styles.dropdownTrigger)}.bind(this))},onFocus:function(){this.isFocused||(this.setView("focused"),this.isFocused=!0)},onBlur:function(a){if(a||
this.isFocused&&!this.isOpen)this.setView("blurred"),this.isFocused=!1},focus:function(){this.element.focus()},blur:function(){this.element.blur()},open:function(){this.isOpen=!0;this.element.attr("aria-pressed")&&this.element.attr("aria-pressed",!0);this.element.attr("aria-expanded",!0);this.setView("opened");this.onFocus()},close:function(){this.isOpen=!1;this.element.attr("aria-pressed")&&this.element.attr("aria-pressed",!1);this.element.attr("aria-expanded",!1);this.setView("closed");if(!this.element.is(":focus"))this.onBlur()},
setView:function(d){var c=this,b=this.options.states||{};a.dom.schedule(function(){switch(d){case "opened":a.dom.swapClasses(c.element,b.closed,b.opened);c.options.useCover&&(a.dom.swapClasses(c.cover,b.coverClosed,b.coverOpened),c.getChildElement("cover-inner").css("transform","scale("+(c.cover.outerWidth()+2)/c.element.outerWidth()+", 1.333)"));break;case "closed":a.dom.swapClasses(c.element,b.opened,b.closed);c.options.useCover&&(a.dom.swapClasses(c.cover,b.coverOpened,b.coverClosed),c.getChildElement("cover-inner").css("transform",
"scale(1)"));break;case "focused":a.dom.swapClasses(c.element,b.notFocused,b.focused);break;case "blurred":a.dom.swapClasses(c.element,b.focused,b.notFocused)}})},removeHasValue:function(){},addHasValue:function(){},hasValue:function(){return!0},enabled:e.noop,disable:e.noop,isVisible:function(){return this.element.is(":visible")},updateValueText:function(a){this.options.useValueLabel&&this.getChildElement("display-text").attr("aria-label",a)}})})(R9,jQuery);(function(b,c){b.createWidgetClass("button.StyleJamButton",{options:{inactiveStlBlock:"",activeStlBlock:"",canPulse:!1,showFocusOutlines:!1,activeCssClass:""},init:function(){},addEventHandlers:function(){this.options.inactiveStlBlock&&this.options.activeStlBlock&&(this.subscribe("button.deactivate",{id:this.id()},this.toggleActivation.bind(this,!1)),this.subscribe("button.activate",{id:this.id()},this.toggleActivation.bind(this,!0)));this.options.canPulse&&(this.subscribe("button.pulse",{id:this.id()},
this.pulse.bind(this,!0)),this.subscribe("button.pulse.reset",{id:this.id()},this.pulse.bind(this,!1)));this.options.showFocusOutlines&&(this.element.on("focus",this.toggleFocus.bind(this,!0)),this.element.on("blur",this.toggleFocus.bind(this,!1)))},toggleFocus:function(a){a&&!document.body.classList.contains(this.options.activeCssClass)||this.swapClassesToggle(this.element,"Button--with-focus-outline","Button--no-focus-outline",a)},toggleActivation:function(a){this.swapClassesToggle(this.element,
this.options.inactiveStlBlock,this.options.activeStlBlock,!a)},pulse:function(a){this.swapClassesToggle(this.element,"","Button--pulse",!a)}})})(R9,jQuery);(function(b){R9.extend("Widgets",{TextInput:function(a,c){this.elementNode=a;this.element=b(this.elementNode);this.validateElement()&&(this.options=b.extend({},this.options,c),this.init())}});R9.extend("Widgets.TextInput",{isTextInput:function(a){return a&&a.nodeName&&"input"==a.nodeName.toLowerCase()&&"text"==a.type.toLowerCase()},isWidgetControlled:function(a){return"undefined"==typeof document.createElement("input").placeholder}});R9.extend("Widgets.TextInput.prototype",{widgetName:"textinput",
widgetBaseClass:"r9-textinput",widgetPlaceholderClass:"r9-textinput-placeholder-active",elementNode:null,element:null,options:{click:null,change:null},init:function(){this.bindInputEvent("focus",this.handleElementFocusEvent);this.bindInputEvent("smartyfocus",this.handleElementFocusEvent);this.bindInputEvent("blur",this.handleElementBlurEvent);this.bindFormSubmission();this.element.data(this.widgetName,this);this.element.is(":focus")||this.handleElementBlurEvent(this.elementNode)},validateElement:function(){return R9.Widgets.TextInput.isTextInput(this.elementNode)&&
R9.Widgets.TextInput.isWidgetControlled(this.elementNode)&&void 0===this.element.data(this.widgetName)},bindInputEvent:function(a,b){var c=this;a+="."+this.widgetName;this.element.unbind(a).bind(a,function(a){b.call(c,this,a)})},bindFormSubmission:function(){var a=this,b="submit."+a.widgetName+a.element.attr("id"),d="form-pre-submit."+a.widgetName+a.element.attr("id");this.element.parents("form").off(b).on(b,function(b){a.element.val()==a.element.attr("placeholder")&&a.clearPlaceholderText(a.element)});
this.element.parents("form").off(d).on(d,function(b){a.element.val()==a.element.attr("placeholder")&&a.clearPlaceholderText(a.element)})},handleElementFocusEvent:function(a,c){a.disabled||(b(a).val()==b(a).attr("placeholder")&&this.clearPlaceholderText(b(a)),this.options.focus&&this.options.focus.apply(this,arguments))},handleElementBlurEvent:function(a,c){a.disabled||(0==b.trim(b(a).val()).length&&this.setPlaceholderText(a),this.options.blur&&this.options.blur.apply(this,arguments))},clearPlaceholderText:function(a){a.removeClass(this.widgetPlaceholderClass).val("")},
setPlaceholderText:function(a){b(a).addClass(this.widgetPlaceholderClass).val(b(a).attr("placeholder"))}})})(jq||jQuery);
(function(b){R9.createWidgetClass("text.StyleJamTextInput",b.extend({},R9.Widgets.TextInput.prototype,{widgetPlaceholderClass:"vs-placeholder",inputElement:null,inputState:null,options:{needsPlaceholderSupport:!1,selectOnFocus:!1,inputValidationEnabled:!1,presentationStates:{}},init:function(){this.inputElement=this.inputElement||this.element;this.elementNode=this.inputElement.get(0);this.options.inputValidationEnabled&&(this.inputState=this.getChildElement("inputState"),this.inputError=this.getChildElement("inputError"),
this.inputSuccess=this.getChildElement("inputSuccess"))},addEventHandlers:function(){var a=this;(this.options.needsPlaceholderSupport||this.options.presentationStates)&&this.bindInputEvent("focus",this.handleElementFocusEvent);this.options.needsPlaceholderSupport&&(this.element.is(":focus")||this.handleElementBlurEvent(this.elementNode),this.bindInputEvent("smartyfocus",this.handleElementFocusEvent),this.bindInputEvent("blur",this.handleElementBlurEvent));if(this.options.selectOnFocus)a.inputElement.on("focus",
function(){a.inputElement.on("mouseup.a keyup.a",function(b){a.elementNode.setSelectionRange(0,9999);a.inputElement.off("mouseup.a keyup.a").select()})});this.options.inputValidationEnabled&&null!==this.inputState&&this.subscribe("input.validation",a.handleValidation.bind(this));this.options.presentationStates&&this.styleInvalidState()},getValue:function(){return b(this.inputElement).val()},handleElementFocusEvent:function(a,b){this.options.presentationStates&&this.styleInvalidState(!1);R9.Widgets.TextInput.prototype.handleElementFocusEvent.call(this,
a,b)},styleInvalidState:function(a){a?R9.dom.swapClasses(b(this.elementNode),this.options.presentationStates.regular,this.options.presentationStates.invalid):R9.dom.swapClasses(b(this.elementNode),this.options.presentationStates.invalid,this.options.presentationStates.regular)},handleValidation:function(a){a&&a.state&&a.inputEl===this.element.id()&&("error"===a.state&&this.swapClasses(this.inputError,"TextInput__State--hidden","TextInput__State--visible"),"success"===a.state&&this.swapClasses(this.inputSuccess,
"TextInput__State--hidden","TextInput__State--visible"))}}))})(jq||jQuery);(function(c){R9.extend("Widgets",{NumberBox:function(b,a){this.inputNode=c(b).find("input")[0];this.jqNode=c(b);if(!this.isValidElement())return this;this.options=c.extend({},this.options,a);this.init()}});R9.extend("Widgets.NumberBox.prototype",{widgetName:"r9NumberBox",inputNode:null,jqNode:null,options:{min:0,max:6,defaultValue:0,callback:c.noop,validator:null,onlyDecorateDisabledButtons:!1},boxValue:0,incrButton:null,decrButton:null,styleJamButton:null,isValidElement:function(){return this.jqNode&&
this.jqNode.children().hasClass("incrementor")&&this.jqNode.children().hasClass("decrementor")&&this.jqNode.children().hasClass("numberHolder")},canChange:function(b){return"function"===typeof this.options.validator?this.options.validator.call(this,b,this.boxValue):!0},getStyleJamButton:function(){return R9.stylejam&&R9.stylejam.common&&R9.stylejam.common.widgets&&R9.stylejam.common.widgets.button?R9.stylejam.common.widgets.button.StyleJamButton:null},increment:function(){if(this.boxValue<this.options.max&&
this.canChange(1))return this.boxValue+=1,this.updateView(),this.options.callback.call(this,1,this.boxValue),!0;this.disableButton(this.incrButton);return!1},decrement:function(){if(this.boxValue>this.options.min&&this.canChange(-1))return--this.boxValue,this.updateView(),this.options.callback.call(this,-1,this.boxValue),!0;this.disableButton(this.decrButton);return!1},updateView:function(){c(this.inputNode).val(this.boxValue);c(this.inputNode).trigger("change");c(this.jqNode).attr("aria-valuenow",
this.boxValue);c(this.jqNode).attr("aria-valuemin",this.options.min).attr("aria-valuemax",this.options.max);this.boxValue===this.options.max?(this.enableButton(this.decrButton),this.disableButton(this.incrButton)):(this.boxValue===this.options.min?this.disableButton(this.decrButton):this.enableButton(this.decrButton),this.enableButton(this.incrButton));this.ariaLabel&&this.ariaLabel.length&&this.ariaLabelMessage&&this.updateAriaLabel()},updateAriaLabel:function(){this.ariaLabelUpdateId&&(window.clearTimeout(this.ariaLabelUpdateId),
this.ariaLabelUpdateId=null);this.ariaLabelUpdateId=window.setTimeout(function(){var b;b=-1<this.ariaLabelMessage.indexOf("|")?R9.Common.Utils.String.formatChoice(this.ariaLabelMessage,this.boxValue,this.boxValue):R9.Common.Utils.String.formatString(this.ariaLabelMessage,this.boxValue);this.ariaLabel.html(b)}.bind(this),200)},getValue:function(){return this.boxValue},setValue:function(b,a){b=parseInt(b);if(isNaN(b)||this.boxValue===b)return!1;var c=b-this.boxValue;if(!a&&!this.canChange(c))return!1;
this.boxValue=b;this.updateView();this.options.callback&&this.options.callback.call(this,c);return!0},init:function(){this.styleJamButton=this.getStyleJamButton();this.boxValue=""!=this.inputNode.value?parseInt(this.inputNode.value,10):0;this.incrButton=this.jqNode.find(".incrementor");this.decrButton=this.jqNode.find(".decrementor");this.jqNode.data(this.widgetName,this);0<this.options.defaultValue?this.setValue(this.options.defaultValue):!isNaN(this.options.max)&&this.boxValue>this.options.max&&
(this.boxValue=this.options.max);c(this.inputNode).prop("readonly","readonly");this.inputNode.value=this.boxValue;var b=this;this.incrButton.unbind("click").click(function(a){b.increment();jq(b.jqNode).trigger("increment");return!1});this.decrButton.unbind("click").click(function(a){b.decrement();jq(b.jqNode).trigger("decrement");return!1});this.updateView()},enableButton:function(b){b.removeClass("NumberBox-disabled").prop("disabled",!1).attr("aria-disabled","false");this.styleJamButton&&R9.dom.swapClasses(b,
this.styleJamButton.plusMinusButtonDisabled,this.styleJamButton.plusMinusButtonEnabled)},disableButton:function(b){b.addClass("NumberBox-disabled");this.options.onlyDecorateDisabledButtons||b.prop("disabled",!0).attr("aria-disabled","true");this.styleJamButton&&R9.dom.swapClasses(b,this.styleJamButton.plusMinusButtonEnabled,this.styleJamButton.plusMinusButtonDisabled)},disableDecrement:function(){this.disableButton(this.decrButton)},enableDecrement:function(){this.enableButton(this.decrButton)},disableIncrement:function(){this.disableButton(this.incrButton)},
enableIncrement:function(){this.enableButton(this.incrButton)}})})(jq||jQuery);
(function(c,b){c.createWidgetClass("number.StyleJamNumberBox",b.extend({},c.Widgets.NumberBox.prototype,{init:function(a,c){this.styleJamButton=this.getStyleJamButton();this.inputNode=b(a).find("input")[0];this.jqNode=b(a);this.styleJamButton&&this.jqNode.data("presentation")&&(a=this.jqNode.data("presentation"),this.styleJamButton.hasOwnProperty(a)&&(this.styleJamButton=this.styleJamButton[a]));if(!this.isValidElement())return this;this.inputNode&&(this.boxValue=""!==this.inputNode.value?parseInt(this.inputNode.value,
10):0);this.incrButton=this.jqNode.find(".incrementor-js");this.decrButton=this.jqNode.find(".decrementor-js");this.ariaLabel=this.getChildElement("ariaLabel");this.ariaLabelMessage=this.ariaLabel.data("msg");this.ariaLabel.attr("data-msg",null);0<this.options.defaultValue&&0===this.boxValue&&this.setValue(this.options.defaultValue,!0);this.options.withConstant&&(this.options=b.extend({withConstant:!1,descriptionWords:[]},this.options,c),this.index=0,this.countWord=this.jqNode.find(".count-word-js"),
this.options.min=0,this.options.max=this.options.descriptionWords.length-1,this.updateConstantValue(0));b(this.inputNode).prop("readonly","readonly");this.updateView()},isValidElement:function(){return!0},canChange:function(a){return"function"===typeof this.options.validator?this.options.validator.call(this,a,this.boxValue):!0},addEventHandlers:function(a){var d=this;this.incrButton.unbind("click").click(function(a){d.options.withConstant?(d.updateConstantValue(1),d.options.callback.call(d)):d.increment();
jq(d.jqNode).trigger("increment");c.globals.keyboardNav||b(this).blur();return!1});this.decrButton.unbind("click").click(function(a){d.options.withConstant?(d.updateConstantValue(-1),d.options.callback.call(d)):d.decrement();jq(d.jqNode).trigger("decrement");c.globals.keyboardNav||b(this).blur();return!1});this.element.keyup(function(a){if(a.altKey||a.ctrlKey||a.shiftKey)return!0;switch(a.keyCode){case c.globals.keyCodes.DOWN:case c.globals.keyCodes.LEFT:case c.globals.keyCodes.PAGE_DOWN:return d.decrement(),
jq(d.jqNode).trigger("decrement"),a.preventDefault(),a.stopPropagation(),!1;case c.globals.keyCodes.UP:case c.globals.keyCodes.RIGHT:case c.globals.keyCodes.PAGE_UP:return d.increment(),jq(d.jqNode).trigger("increment"),a.preventDefault(),a.stopPropagation(),!1}});this.element.on("keydown",function(a){if(a.altKey||a.ctrlKey||a.shiftKey)return!0;switch(a.keyCode){case c.globals.keyCodes.PAGE_UP:case c.globals.keyCodes.PAGE_DOWN:case c.globals.keyCodes.HOME:case c.globals.keyCodes.END:case c.globals.keyCodes.LEFT:case c.globals.keyCodes.UP:case c.globals.keyCodes.RIGHT:case c.globals.keyCodes.DOWN:return a.preventDefault(),
a.stopPropagation(),!1}});this.options.showFocusOutlines&&(this.element.on("focus",this.toggleFocus.bind(this,!0)),this.element.on("blur",this.toggleFocus.bind(this,!1)))},toggleFocus:function(a){a&&!document.body.classList.contains(this.options.activeCssClass)||this.swapClassesToggle(this.element,"TravelerDropdown__NumberBox","TravelerDropdown__NumberBox--focus",a)},setValue:function(a,b){a=parseInt(a);if(isNaN(a)||this.boxValue===a)return!1;var c=this.boxValue>a?0===a?a:this.boxValue-a:a-this.boxValue;
if(b||this.canChange(c))this.boxValue=a,this.updateView(),this.options.callback&&!b&&this.options.callback.call(this,c)},getIndex:function(){return this.index},setIndex:function(a,b){a=parseInt(a);if(isNaN(a)||this.index===a)return!1;a-=this.index;b&&(this.updateConstantValue(a),this.options.callback&&!b&&this.options.callback.call(this,a))},updateConstantValue:function(a){a=this.index+a;0<=a&&a<this.options.descriptionWords.length&&(this.index=a,this.countWord.text(this.options.descriptionWords[this.index]));
this.index===this.options.max?(this.enableButton(this.decrButton),this.disableButton(this.incrButton)):(this.index===this.options.min?this.disableButton(this.decrButton):this.enableButton(this.decrButton),this.enableButton(this.incrButton))}}))})(window.R9,window.jQuery);(function(b,d){b.createComponentClass("framework.JavaScriptComponent",{options:{vertical:null,global:!1},addEventHandlers:function(){var a=this;this.subscribe("resultspage.JavaScriptComponent.cleanup",function(c){a.options.vertical===c||a.options.global?a.options.vertical=c:a.options.singleton?b.ComponentManager.removeSingleton(a._namespace):a.destroy()})}})})(R9,jQuery);(function(d){d.createComponentClass("hotels.search.HotelPlannerHelper","framework.JavaScriptComponent",{addEventHandlers:function(){var b=this;this.base();this.subscribe("hotelplanner.open",function(c){c&&b.open(c.location,c.startDate,c.endDate)})},open:function(b,c,e){b="/k/redirect/out?url\x3d"+encodeURIComponent(this.buildHotelPlannerMaxRoomsURL(b,c,e));d.Common.Utils.Browsers.isIE(11)||d.Common.Utils.Browsers.isEdge()?window.open("","title").location.href=b:open(b)},buildHotelPlannerMaxRoomsURL:function(b,
c,e){var f="www",g="",a=d.globals&&d.globals.locale?d.globals.locale:null;a&&a.lc&&"string"===typeof a.lc&&"en"!==a.lc.toLowerCase()&&(f=a.lc.toLowerCase());a&&a.loc&&"string"===typeof a.loc&&(g=a.loc);return"https://"+f+".hotelplanner.com/GroupForm.cfm?sc\x3dKayak\x26City\x3d"+encodeURIComponent(b)+"\x26InDate\x3d"+encodeURIComponent(c)+"\x26OutDate\x3d"+encodeURIComponent(e)+"\x26locale\x3d"+g}})})(window.R9);(function(f,e){f.createWidgetClass("dropdown.StyleJamDropdownDialog",{element:null,trigger:null,rtlAlignment:void 0,triggerObj:void 0,elementNode:null,content:null,label:null,value:null,icon:null,isOpen:!1,leftOffset:0,ajaxLoadFailed:!1,eventSuffix:null,subValue:null,animationDuration:200,interactedWithRecently:!1,options:{autoOpen:!1,alignment:null,direction:"down",isPopover:!1,showIcon:!0,matchWidth:!1,isFixedWidth:!1,loadWithAjaxOnInit:!1,ajaxUrl:"",ajaxData:{},iconClass:"",contentClass:"",triggerElemId:null,
content:null,onInit:null,onOpen:null,onClose:null,text:"",coverTrigger:!1,topOffset:0,topOffsetFromTrigger:0,leftOffset:0,removeZIndex:!1,flippable:!0,delayShowDropdown:e.noop,showDropdownDelay:200,hasSubValue:!1,animateClose:null,expandTo:null,forceTriggerWidth:!1,openDisabled:!1,staticPosition:!1,subtractContainerOffset:!1},states:null,init:function(){!this.options.alignment&&this.element&&this.element.data("alignment")&&(this.options.alignment=this.element.data("alignment"));!this.options.expandTo&&
this.element&&this.element.data("expandto")&&(this.options.expandTo=this.element.data("expandto"));this.options.alignment||(this.options.alignment="left");this.eventSuffix=".DropdownDialog."+this.id();this.options.autoOpen?this.open():this.element.addClass(this.options.closedStateClzs);this.options.coverTrigger&&(this.cover=this.getChildElement("cover"),this.innerContent=this.getChildElement("inner"));if(this.options.onInit)this.options.onInit(this);this.options.target?this.trigger=this.options.target:
this.createTrigger();f.globals.testMode&&this.trigger.attr("data-test-popover-trigger","");this.elementNode=this.element[0];this.createContent();this.popoverArrow=this.getChildElement("popover-arrow");this.options.loadWithAjaxOnInit&&this.options.ajaxUrl&&this.loadAjax();this.options.alignment||(this.options.alignment="left");if(this.options.coverTrigger)this.trigger.one("mouseover",this.reposition.bind(this))},addEventHandlers:function(){function a(a){if(b.isOpen){a=e(a.target);var c=b.content.add(b.trigger);
a.closest(c).length||b.close()}}var b=this,c=e("body"),d=this.trigger;c.on("click"+this.eventSuffix,a);c.on("touchstart"+this.eventSuffix,a);this.subscribe("trips.menu.open",e.proxy(this.close,this));this.subscribe("authentication.showLogin",this.close.bind(this,null,!0));this.registerEvent("click",d,function(){b.toggleContent()});this.registerEvent("keydown",d,function(d){if(13===d.which||32===d.which)b.toggleContent(),setTimeout(function(){c.on("click",a)},10),d.preventDefault(),d.stopImmediatePropagation(),
d.stopPropagation()});this.registerEvent("keydown"+this.eventSuffix,e(document),function(a){27===a.which&&b.close(a,null,!0)});this.registerEvent("resize"+this.eventSuffix,e(window),function(){b.isOpen&&b.reposition(!0)});this.registerEvent("scroll"+this.eventSuffix,e(document),function(){b.isOpen&&b.reposition(!0)});this.registerEvent("scroll"+this.eventSuffix,e(".viewport"),function(){b.isOpen&&b.reposition(!0)});var l=null,d=function(){b.triggerObj&&!b.triggerObj.isVisible()||l||f.Common.Utils.Browsers.isIE(11)||
(l=setTimeout(function(){b.reposition(!0);l=null},25))};this.registerEvent("click",this.content.find(".close"),this.close.bind(this));this.subscribe("common.dropdown.closeAll",this.close.bind(this));this.registerEvent("mouseup touchend",this.content,d);this.subscribe("horizon.dropdownDialog.reposition",d)},destroy:function(){this.base();this.trigger.off("mouseover");e(".viewport").off("scroll"+this.eventSuffix);e(window).off("resize"+this.eventSuffix);e(document).off("scroll"+this.eventSuffix).off("keydown"+
this.eventSuffix);e(document.body).off("click"+this.eventSuffix).off("touchstart"+this.eventSuffix);this.content.off("keydown")},createContent:function(){this.content=this.options.content&&this.options.content.length?e(this.options.content):e("#"+this.element.attr("id")+"_content");this.options.isFixedWidth&&this.content.css("width",this.getTriggerWidth()+"px")},createTrigger:function(){if(null!=this.options.triggerElemId)this.trigger=e("#"+this.options.triggerElemId);else{var a=this.element.data("trigger-id");
null!=a&&""!==a&&(this.trigger=e("#"+a))}null!=this.trigger&&this.trigger.length?this.triggerObj=this.trigger.getWidget():this.trigger=this.element;this.label=this.trigger.find(".js-label");this.options.showIcon&&(this.icon=this.trigger.find(".js-icon"));this.options.hasSubValue&&(this.subValue=this.label.find(".js-subValue"));if(this.options.text)this[this.options.hasSubValue?"updateValue":"updateLabel"](this.options.text);else this.options.hasSubValue||(a=this.label.html())&&a.trim()&&this.updateLabel(a.trim())},
open:function(){if(!this.options.openDisabled){this.isOpen=!0;var a=this,b=f.config.getString("ui.horizon.output.container","body");if("function"===typeof this.options.delayShowDropdown&&this.options.delayShowDropdown()&&!this.showDropdownTimeout)this.showDropdownTimeout=setTimeout(this.open.bind(this),this.options.showDropdownDelay);else{null!==this.showDropdownTimeout&&(clearTimeout(this.showDropdownTimeout),this.showDropdownTimeout=null);this.options.container&&""!==this.options.container&&(b=
this.options.container,e(a.options.container).off("scroll."+a.id()).on("scroll."+a.id(),function(){a.isOpen&&a.reposition()}));this.options.isPopover&&this.popoverArrow.show();this.content.appendTo(b);if(this.options.onOpen)this.options.onOpen(this);a.triggerObj&&a.triggerObj.open();this.reposition();f.dom.swapClasses(a.content,this.getStateClasses("closed"),this.getStateClasses("open"));this.options.coverTrigger&&(this.content.removeClass("closed").addClass("open"),f.dom.swapClasses(this.cover,this.getStateClasses("coverClosed"),
this.getStateClasses("coverOpened")),f.dom.swapClasses(this.innerContent,this.getStateClasses("contentClosed"),this.getStateClasses("contentOpened")));this.content.attr("aria-expanded",!0);f.globals.testMode&&this.element.add(this.content).attr("data-test-popover-open",!0);f.events.publish("DropdownDialog.open",{id:a.id()});window.setTimeout(this.setupTabKeyHandling.bind(this),1)}}},setupTabKeyHandling:function(){var a=this,b=this.getFocusableElements();b.length&&(b.first().focus(),this.content.off("keydown").on("keydown",
function(b){var d=a.getFocusableElements(),c=e(b.target),h=d.first().is(c)&&b.shiftKey,c=d.last().is(c)&&!b.shiftKey;b.which===f.globals.keyCodes.TAB&&(1===d.length||h||c)&&a.close(b,!1,!0)}))},getFocusableElements:function(){return this.content.find(":input:visible,[tabindex]:visible").not("[tabindex\x3d-1],[disabled]")},_close:function(a,b,c){var d=this.isOpen,e=this;this.isOpen=!1;this.options.isPopover&&this.popoverArrow.hide();this.triggerObj&&this.triggerObj.close();f.dom.swapClasses(this.content,
this.getStateClasses("open"),this.getStateClasses("closed"));this.options.coverTrigger&&(this.content.removeClass("open").addClass("closed"),f.dom.swapClasses(this.cover,this.getStateClasses("coverOpened"),this.getStateClasses("coverClosed")),f.dom.swapClasses(this.innerContent,this.getStateClasses("contentOpened"),this.getStateClasses("contentClosed")));this.content.css({top:"",right:"",left:"",bottom:""});this.options.coverTrigger?setTimeout(function(){e.element.append(e.content)},200):this.element.append(this.content);
this.content.off("keydown");c&&e.triggerObj&&e.triggerObj.focus();if(this.options.onClose)this.options.onClose(d,this,a);f.events.publish("DropdownDialog.close",{id:this.id(),silent:!!b});this.content.attr("aria-expanded",!1);f.globals.testMode&&this.element.add(this.content).attr("data-test-popover-open",!1)},close:function(a,b,c){if(this.options.animateClose){var d=this;this.animateClose(function(){d._close(a,b,c)})}else this.isOpen&&this._close(a,b,c)},toggleContent:function(){this.isOpen?this.close(null,
null,!0):this.open()},updateLabel:function(a,b,c){var d=a;b&&(d+=(c||"")+b);this.label.html(d);"0"===d+""||d?this.triggerObj&&this.triggerObj.addHasValue():this.triggerObj&&this.triggerObj.removeHasValue();this.triggerObj&&a&&this.triggerObj.updateValueText(a)},updateValue:function(a){var b=a||"";this.value.html(a);"0"===b+""||a?this.triggerObj&&this.triggerObj.addHasValue():this.triggerObj&&this.triggerObj.removeHasValue()},hasValue:function(){return this.triggerObj?this.triggerObj.hasValue():!1},
reposition:function(a){if(this.options.staticPosition)this.content.css(this.options.staticPosition);else{this.rtlAlignment="rtl"!==document.dir||"left"!==this.options.alignment&&"right"!==this.options.alignment?void 0:"right"===this.options.alignment?"left":"right";var b=this.options.direction,c=this.rtlAlignment||this.options.alignment,d=this.trigger.offset(),l=e(this.options.container),h=e(this.options.expandTo),m=h.length&&h.is(":visible"),g=e(window).outerWidth(),n=m?h.offset():null;if(l.length)var k=
l.offset(),d={top:d.top-k.top+l.scrollTop(),left:d.left-k.left};else l=e(window);k=d.top+this.trigger.outerHeight();k+=this.options.topOffsetFromTrigger;0===this.trigger.width()&&0!==this.trigger.position().top&&(k+=window.scrollY);if(this.options.coverTrigger)m=0,h=e(this.options.container),this.options.subtractContainerOffset&&h.length&&(m=h.offset().left),h=this.content.outerWidth(),c=this.trigger.offset().left,m="rtl"===document.dir?-1*Math.floor(window.innerWidth-(c+this.getTriggerWidth())-m):
Math.floor(this.trigger.offset().left-m),k=Math.floor(k)-this.trigger.outerHeight(),c=m+"px",m+h>g&&(h=g-h-10,c=(0<h?h:0)+"px"),this.options.newSearchHeaderDesign&&568>g&&(c=0),this.content.css({transform:"translate("+c+","+(k+"px")+")",top:0,right:"inherit !important"}),this.cover.css({width:this.trigger.outerWidth()-16,height:this.trigger.outerHeight()-16});else{this.shouldFlipDirection(b)&&(b=this.getReversedDirection(b));this.shouldFlipAlignment(c)&&(c=this.getReversedDirection(c));this.updateAnimationClass(b,
c);this.content.toggleClass("noAnimation",!!a);"up"===b?(f.dom.swapClasses(this.content,this.getStateClasses("default"),this.getStateClasses("up")),k=d.top-this.content.outerHeight()):f.dom.swapClasses(this.content,this.getStateClasses("up"),this.getStateClasses("default"));if("left"===b||"right"===b)k="up"===this.options.alignment?d.top-this.trigger.outerHeight()/2:"down"===this.options.alignment?d.top-this.content.outerHeight()+this.trigger.outerHeight():d.top+this.trigger.outerHeight()/2-this.content.outerHeight()/
2;g={top:Math.floor(k)+"px"};m?"right"===c?g.right=Math.floor(l.width()-h.width()-n.left)+"px":g.left=Math.floor(n.left)+"px":"left"===b?g.right=Math.floor(l.width()-d.left)+"px":"right"===b?g.left=Math.floor(d.left+this.trigger.width())+"px":"right"===c?(b=this.getTriggerWidth(),38>b&&!this.options.forceTriggerWidth&&(b=38),g.right=Math.floor(l.width()-(d.left+b))+"px"):g.left="center"===c?Math.floor(d.left-this.content.outerWidth()/2)+this.getTriggerWidth()/2+"px":Math.floor(d.left)+"px";this.options.topOffset&&
0!==this.options.topOffset&&(g.marginTop=this.options.topOffset+"px");this.options.leftOffset&&0!==this.options.leftOffset&&(g.right?g.right=parseInt(g.right.replace("px",""),10)-this.options.leftOffset+"px":g.left&&(g.left=parseInt(g.left.replace("px",""),10)+this.options.leftOffset+"px"));this.leftOffset&&(g.marginLeft=this.leftOffset+"px");this.options.isPopover&&"right"===c&&(g.left=Math.floor(d.left+this.getTriggerWidth()+22)+"px",g.top=Math.floor(k-45)+"px");k=this.options.isFixedWidth?"width":
"minWidth";this.options.matchWidth?g[k]=this.getTriggerWidth()+"px":m?g[k]=h.outerWidth()+"px":g.minWidth="";this.options.removeZIndex||(g.zIndex=this.trigger.zIndex()+9999);this.content.css(g)}}},shouldFlipDirection:function(a){if(this.options.flippable){var b=e(window).scrollTop(),c=b+e(window).outerHeight(),d=this.content.outerHeight(),f=this.trigger.offset().top,c=f+this.trigger.outerHeight()+d>c,b=f-d<b;if("down"===a)return c&&!b;if("up"===a)return b&&!c}return!1},shouldFlipAlignment:function(a){if(this.options.flippable){var b=
e(window).width(),c=this.content.width(),d=this.trigger.offset().left,f=this.trigger.width(),f=0>=d+("left"===a?0:f)-c,b=d+("left"===a?c:0)>=b;if("left"===a)return!f&&b;if("right"===a)return f&&!b}return!1},getReversedDirection:function(a){switch(a){case "down":return"up";case "up":return"down";case "left":return"right";case "right":return"left";case "bottom":return"top";case "top":return"bottom";case "center":return"center"}return a},updateAnimationClass:function(a,b){a=this.getDirectionClass(a,
b);this.content.hasClass(a)||this.content.removeClass(function(a,b){return(b.match(/\banimate-\S+/g)||[]).join(" ")}).addClass(a).removeAttr("style")},getDirectionClass:function(a,b){var c;"left"===a||"right"===a?(c="down"===b?"top":"bottom",a="center"===a?"right":this.getReversedDirection(a)):(c="down"===a?"top":"bottom",a="center"===b?"right":b);return"animate-"+c+"-"+a},loadAjax:function(){var a=this;return f.ajax.execute(this.options.ajaxUrl,{data:this.options.ajaxData,customUpdate:function(b){b.innerHTML&&
""!==b.innerHTML?a.content.html(b.innerHTML):(a.element.remove(),a.ajaxLoadFailed=!0);return!0}})},getTriggerWidth:function(){if(null!=this.trigger){var a=this.trigger[0].getBoundingClientRect();return a?a.right-a.left:this.trigger.outerWidth()}return 0},disableDropdown:function(){this.options.openDisabled=!0;this.element.addClass("disabled");this.triggerObj&&this.triggerObj.disable()},enableDropdown:function(){this.options.openDisabled=!1;this.element.removeClass("disabled");this.triggerObj&&this.triggerObj.enable()},
animateClose:function(a){var b=this,c=this.content.attr("class").match(/\banimate-\S+/);c&&c.length&&(this.content.removeClass(c[0]),window.setTimeout(function(){b.content.addClass(c[0]+" close-animation")},1),window.setTimeout(function(){a();b.content.removeClass("close-animation")},this.animationDuration))},getStateClasses:function(a){null===this.states&&(this.states=f.question.ask("dropdown.dialog.states"));return this.states?this.states[a]:""}})})(R9,jQuery);(function(a,c){var d=a.config.getString("ui.horizon.common.core.focusOutlineClass","a11y-focused");a.createWidgetClass("dropdown.StyleJamDropdown",{status:null,select:null,selectEl:null,refreshTimer:null,lastSelectedIndex:-1,options:{click:null,change:null,statusClientTemplate:"",presentationStates:{}},init:function(){this.status=this.getChildElement("status");this.status.length||(this.status=this.element.find(".status"));this.select=this.getChildElement("select");this.select.length||(this.select=
this.element.find("select"));this.selectEl=this.select.get(0)},addEventHandlers:function(){this.select.click(this.handleSelectClickEvent.bind(this));this.select.keydown(this.handleSelectKeydownEvent.bind(this));this.select.keyup(this.handleSelectKeyupEvent.bind(this));this.select.focus(this.handleSelectFocusEvent.bind(this));this.select.blur(this.handleSelectBlurEvent.bind(this));this.select.change(this.handleSelectChangeEvent.bind(this));this.options.presentationStates&&this.styleInvalidState()},
refresh:function(){this.select.is(":disabled")?this.element.addClass("disabled"):this.element.removeClass("disabled");var b=this.selectEl.selectedIndex;0>b&&(b=0);b=this.selectEl.options[b];"undefined"!==typeof b&&(this.options.statusClientTemplate?this.status.html(a.template.render(this.options.statusClientTemplate,b)):(this.status.html(a.utils.escapeHTML(b.title||b.text||b.value)),this.selectEl.title=b.title||b.text||b.value))},startRefreshLoop:function(){var b=this;this.lastSelectedIndex=this.selectEl.selectedIndex;
this.refreshTimer=setInterval(function(){b.doRefresh()},100)},stopRefreshLoop:function(){null!=this.refreshTimer&&(clearTimeout(this.refreshTimer),this.refreshTimer=null,this.lastSelectedIndex=-1)},doRefresh:function(){this.selectEl.selectedIndex!==this.lastSelectedIndex&&(this.lastSelectedIndex=this.selectEl.selectedIndex,this.refresh())},handleSelectClickEvent:function(){"function"===typeof this.options.click&&this.options.click(this);this.stopRefreshLoop()},handleSelectKeydownEvent:function(){this.startRefreshLoop()},
handleSelectKeyupEvent:function(){this.refresh();this.stopRefreshLoop()},handleSelectFocusEvent:function(){this.selectEl.disabled||(this.element.addClass("focused").addClass(d),this.options.presentationStates?(this.element.removeClass(this.options.presentationStates.invalid),a.dom.swapClasses(this.element,this.options.presentationStates.regular,this.options.presentationStates.focus)):this.element.is(".TEXT")?(a.dom.swapClasses(c(this.element),a.stylejam.common.widgets.dropdown.StyleJamDropdown.dropdownTextBlurred,
a.stylejam.common.widgets.dropdown.StyleJamDropdown.dropdownTextFocused),a.dom.swapClasses(this.element.children(".icon"),a.stylejam.common.widgets.dropdown.StyleJamDropdown.dropdownIconText,a.stylejam.common.widgets.dropdown.StyleJamDropdown.dropdownIconTextFocused)):a.dom.swapClasses(c(this.element),a.stylejam.common.widgets.dropdown.StyleJamDropdown.dropdownBlurred,a.stylejam.common.widgets.dropdown.StyleJamDropdown.dropdownFocused))},handleSelectBlurEvent:function(){this.selectEl.disabled||(this.element.removeClass("focused").removeClass(d),
this.options.presentationStates?a.dom.swapClasses(this.element,this.options.presentationStates.focus,this.options.presentationStates.regular):(this.element.is(".TEXT")?(a.dom.swapClasses(c(this.element),a.stylejam.common.widgets.dropdown.StyleJamDropdown.dropdownTextFocused,a.stylejam.common.widgets.dropdown.StyleJamDropdown.dropdownTextBlurred),a.dom.swapClasses(this.element.children(".icon"),a.stylejam.common.widgets.dropdown.StyleJamDropdown.dropdownIconTextFocused,a.stylejam.common.widgets.dropdown.StyleJamDropdown.dropdownIconText)):
a.dom.swapClasses(c(this.element),a.stylejam.common.widgets.dropdown.StyleJamDropdown.dropdownFocused,a.stylejam.common.widgets.dropdown.StyleJamDropdown.dropdownBlurred),this.refresh(),this.stopRefreshLoop()))},handleSelectChangeEvent:function(b){"function"===typeof this.options.change&&this.options.change.call(this,b);this.refresh();this.stopRefreshLoop()},styleInvalidState:function(b){b?a.dom.swapClasses(this.element,this.options.presentationStates.regular,this.options.presentationStates.invalid):
a.dom.swapClasses(this.element,this.options.presentationStates.invalid,this.options.presentationStates.regular)},getSelectedElement:function(){return this.selectEl.options[0<=this.selectEl.selectedIndex?this.selectEl.selectedIndex:0]},getName:function(){return this.selectEl.name},hasOptions:function(){return 0!==this.selectEl.options.length},getValue:function(){return this.hasOptions()?this.getSelectedElement().value:null},val:function(b){"undefined"!==typeof b&&this.setValue(b);return this.getValue()},
getText:function(){return c(this.getSelectedElement()).text()},setText:function(b){this.status.text(b)},setValue:function(b,a){this.select.val(b);a?this.select.trigger("change"):this.refresh()},setOptions:function(a,d){var b=c("\x3cselect\x3e");(a||[]).forEach(function(a){a.value===d&&(a.selected=!0);b.append(c("\x3coption\x3e",a))});this.select.html(b.html());this.refresh()}})})(R9,jQuery);(function(b,d){var c=b.config.getString("ui.horizon.common.core.focusOutlineClass","a11y-focused");b.createWidgetClass("dropdown.Dropdown",{status:null,select:null,selectEl:null,refreshTimer:null,lastSelectedIndex:-1,options:{click:null,change:null,statusClientTemplate:""},init:function(){this.status=this.getChildElement("status");this.status.length||(this.status=this.element.find(".status"));this.select=this.getChildElement("select");this.select.length||(this.select=this.element.find("select"));
this.selectEl=this.select.get(0)},addEventHandlers:function(){this.select.click(this.handleSelectClickEvent.bind(this));this.select.keydown(this.handleSelectKeydownEvent.bind(this));this.select.keyup(this.handleSelectKeyupEvent.bind(this));this.select.focus(this.handleSelectFocusEvent.bind(this));this.select.blur(this.handleSelectBlurEvent.bind(this));this.select.change(this.handleSelectChangeEvent.bind(this))},refresh:function(){this.select.is(":disabled")?this.element.addClass("disabled"):this.element.removeClass("disabled");
var a=this.selectEl.selectedIndex;0>a&&(a=0);a=this.selectEl.options[a];"undefined"!==typeof a&&(this.options.statusClientTemplate?this.status.html(b.template.render(this.options.statusClientTemplate,a)):(this.status.html(b.utils.escapeHTML(a.title||a.text||a.value)),this.selectEl.title=a.title||a.text||a.value))},startRefreshLoop:function(){var a=this;this.lastSelectedIndex=this.selectEl.selectedIndex;this.refreshTimer=setInterval(function(){a.doRefresh()},100)},stopRefreshLoop:function(){null!=
this.refreshTimer&&(clearTimeout(this.refreshTimer),this.refreshTimer=null,this.lastSelectedIndex=-1)},doRefresh:function(){this.selectEl.selectedIndex!=this.lastSelectedIndex&&(this.lastSelectedIndex=this.selectEl.selectedIndex,this.refresh())},handleSelectClickEvent:function(){"function"===typeof this.options.click&&this.options.click(this);this.stopRefreshLoop()},handleSelectKeydownEvent:function(){this.startRefreshLoop()},handleSelectKeyupEvent:function(){this.refresh();this.stopRefreshLoop()},
handleSelectFocusEvent:function(){this.selectEl.disabled||this.element.addClass("focused").addClass(c)},handleSelectBlurEvent:function(){this.selectEl.disabled||(this.element.removeClass("focused").removeClass(c),this.refresh(),this.stopRefreshLoop())},handleSelectChangeEvent:function(a){"function"===typeof this.options.change&&this.options.change.call(this,a);this.refresh();this.stopRefreshLoop()},getSelectedElement:function(){return this.selectEl.options[0<=this.selectEl.selectedIndex?this.selectEl.selectedIndex:
0]},getName:function(){return this.selectEl.name},hasOptions:function(){return 0!==this.selectEl.options.length},getValue:function(){return this.hasOptions()?this.getSelectedElement().value:null},val:function(a){if("undefined"!==typeof a)this.setValue(a);else return this.getValue()},getText:function(){return d(this.getSelectedElement()).text()},setText:function(a){this.status.text(a)},setValue:function(a,b){this.select.val(a);b?this.select.trigger("change"):this.refresh()},setOptions:function(a,b){var c=
d("\x3cselect\x3e");d.each(a,function(a,e){e.value===b&&(e.selected=!0);c.append(d("\x3coption\x3e",e))});this.select.html(c.html());this.refresh()}})})(R9,jQuery);(function(e,g){e.createComponentClass("hotels.search.HotelTravelersDropdown",{roomsGuestsDropdown:null,rooms:null,guests:null,adults:null,children:null,hotelPlanner:null,travelersAgeContainer:null,renderedTravelerDropdowns:[],trigger:null,isOnStickyForm:!1,isOnDialog:!1,options:{autoSubmit:!1,namespace:null,specifyChildAges:!1,subtractOffsetFromDropdown:!1,defaultRooms:1,defaultGuests:5,defaultAdults:1,defaultChildren:1,maxRooms:8,maxGuests:32,maxAdults:32,maxChildren:32,childrenAges:[],maxPerRoom:4,
travelersDataQuestion:"hotels.searchform.travelers",roomsQuestion:"hotel-rooms-selected",travelerAgeTemplateId:"travelerAgeDropdown",hotelPlannerTrigger:0,updateAll:!1,numberBoxMsg:{roomsOverMax:function(){var a=this.adults.getValue()+this.children.getValue();return e.Common.Utils.String.formatString(this.options.msg.roomsOverMax,this.rooms.getValue(),a)},roomsBelowMin:function(){var a=this.adults.getValue()+this.children.getValue();return e.Common.Utils.String.formatChoice(this.options.msg.roomsBelowMin,
this.rooms.getValue(),this.rooms.getValue(),a)},guestsOverMax:function(){var a=this.adults.getValue()+this.children.getValue();return e.Common.Utils.String.formatString(this.options.msg.guestsOverMax,a,this.rooms.getValue())},guestsBelowMin:function(){var a=this.adults.getValue()+this.children.getValue();return e.Common.Utils.String.formatChoice(this.options.msg.guestsBelowMin,a,a,this.rooms.getValue())}}},init:function(){this.bindRoomsGuestsDropdown();this.options.specifyChildAges&&(this.travelersAgeContainer=
this.getChildElement("travelersAgeContainer"))},addEventHandlers:function(){var a=this;this.subscribe("hotelsearchform.close.roomsGuestsDropdown",function(){a.roomsGuestsDropdown.close()});this.subscribe("hotels.frontdoor.form.sticky",{namespace:this.options.namespace},function(b){a.isOnStickyForm=b.isSticky;a.setMaxAgeContainerHeight()});this.subscribe("hotels.dialog.form.open",{id:this.options.namespace},function(){a.isOnDialog=!0;a.setMaxAgeContainerHeight()});e.events.subscribe("select.force.close",
function(){a.roomsGuestsDropdown.close()});this.answer(this.options.travelersDataQuestion,this.serialize.bind(this));var b=this.options.updateAll?{}:{namespace:this.options.namespace};this.subscribe("hotels.frontdoor.rooms.onChange",b,this.onRoomsChange.bind(this));this.subscribe("hotels.frontdoor.guests.onChange",b,this.onGuestsChange.bind(this));this.subscribe("hotels.frontdoor.childrenAges.onChange",b,this.onChildrenAgesChange.bind(this));this.answer(this.options.roomsQuestion,function(){return a.rooms.getValue()})},
setMaxAgeContainerHeight:function(){if((this.isOnStickyForm||this.isOnDialog)&&this.travelersAgeContainer&&this.roomsGuestsDropdown.cover&&this.travelersAgeContainer.prev()&&this.roomsGuestsDropdown.element){var a=this.roomsGuestsDropdown.cover[0].getBoundingClientRect().top,b=this.travelersAgeContainer.prev()[0].getBoundingClientRect().height,c=parseInt(window.getComputedStyle(this.roomsGuestsDropdown.cover[0])["padding-top"],10)+parseInt(window.getComputedStyle(this.roomsGuestsDropdown.cover[0])["padding-bottom"],
10);this.travelersAgeContainer.css("maxHeight","calc(100vh - "+(a+b+c+64)+"px)").css("overflow-y","auto")}else this.travelersAgeContainer.css("maxHeight","unset").css("overflow-y","unset")},inlineComponentsReady:function(){if(this.options.specifyChildAges){var a=this.children.getValue();0<a&&this.displayTravelersAgeSection(a,this.options.childrenAges)}this.trigger=this.getChildElement("roomsGuestsDropdown-trigger");this.rooms&&this.rooms.getValue()&&this.updateHotelPlanner(this.rooms.getValue())},
bindRoomsGuestsDropdown:function(){var a=this,b,c;this.roomsGuestsDropdown=this.getChildElement("roomsGuestsDropdown").getWidget();this.roomsGuestsDropdown.setOption("onOpen",function(){a.roomsGuestChanged=!1;setTimeout(function(){g(a.rooms).focus()},100);a.getChildElement("roomsGuestsDropdown").attr("aria-expanded","true");setTimeout(function(){a.setMaxAgeContainerHeight()},0)});this.roomsGuestsDropdown.setOption("onClose",function(b,c,d){b&&d&&setTimeout(function(){a.trigger.focus()},100);a.roomsGuestChanged&&
a.options.autoSubmit&&e.events.publish("hotels.frontdoor.form.autoSubmit",{});a.roomsGuestsDropdown.element.find(".focused").removeClass("focused");a.trigger.focus();a.getChildElement("roomsGuestsDropdown").attr("aria-expanded","false")});c=function(a){return(a.styleJamNumberBox||a.numberBox).bind(a)};this.rooms=c(this.getChildElement("rooms"))({min:1,max:a.options.maxRooms,defaultValue:a.options.defaultRooms,callback:function(){a.updateBoxButtonStates();a.roomsGuestChanged=!0;e.events.publish("hotels.frontdoor.form.rooms",
{namespace:a.options.namespace,id:a.options.namespace,rooms:this.getValue()});e.Analytics.api.trackEvent("hotels/form/changerooms")}}).getWidget();b=this.rooms.decrButton;this.adults=c(this.getChildElement("adults"))({min:1,max:a.options.maxAdults,defaultValue:a.options.defaultAdults,callback:function(){a.roomsGuestChanged=!0;e.events.publish("hotels.frontdoor.form.guests.adults",{namespace:a.options.namespace,id:a.options.namespace,adults:this.getValue()});e.Analytics.api.trackEvent("hotels/form/changeguests_adults")}}).getWidget();
c=(this.children=c(this.getChildElement("children"))({min:0,max:a.options.maxChildren,defaultValue:a.options.defaultChildren,callback:function(){a.roomsGuestChanged=!0;e.events.publish("hotels.frontdoor.form.guests.children",{namespace:a.options.namespace,id:a.options.namespace,children:this.getValue()});e.Analytics.api.trackEvent("hotels/form/changeguests_children")}}).getWidget())&&this.children.incrButton;var d=function(b,c){b&&b.off("keydown").keydown(function(b){9===b.which&&(c?b.shiftKey:!b.shiftKey)&&
(b.preventDefault(),b.stopPropagation(),setTimeout(function(){a.roomsGuestsDropdown.element.focus();a.roomsGuestsDropdown.toggleContent(!1)},100))})};d(b,!0);d(c,!1);this.hotelPlanner=this.getChildElement("hotelPlanner");this.hotelPlanner.on("click",function(b){b.preventDefault();b=a.serialize();e.events.publish("hotelplanner.open",{location:b.location,startDate:b.checkInDate,endDate:b.checkOutDate})});this.updateBoxButtonStates()},updateBoxButtonStates:function(){var a=this.adults.getValue(),b=this.children.getValue();
a+b===Math.min(this.options.maxGuests,this.options.maxRooms*this.options.maxPerRoom)?(this.adults.disableIncrement(),this.children.disableIncrement()):(this.adults.enableIncrement(),this.children.enableIncrement())},onRoomsChange:function(a){var b=this.options.maxPerRoom;a.rooms>this.rooms.options.max?this.rooms.setValue(this.rooms.options.max,!0):a.rooms<this.rooms.options.min?this.rooms.setValue(this.rooms.options.min,!0):this.rooms.setValue(a.rooms,!0);var c=this.rooms.getValue(),d=this.adults.getValue(),
f=this.children.getValue();d<c&&(d=c);c*b<d+f&&(f=c*b-d,0>f&&(f=0,d=c*b));this.children.setValue(f,!0);this.options.specifyChildAges&&this.displayTravelersAgeSection(f);this.adults.setValue(d,!0);this.refreshRoomsGuestsDropdownDisplay(a)},onGuestsChange:function(a){var b,c;"undefined"!==typeof a.guests?(b=a.guests,a.adults=b,c=0):(b=a.adults,c=a.children);if("undefined"!==typeof b)this.onAdultsFieldChange(a);if("undefined"!==typeof c)this.onChildrenFieldChange(a);this.updateBoxButtonStates()},onChildrenAgesChange:function(a){if(this.options.specifyChildAges){var b=
[];"undefined"!==typeof a.childrenAges&&(""!==a.childrenAges&&(b=a.childrenAges.split("-")),this.displayTravelersAgeSection(b.length,b))}},onChildrenFieldChange:function(a){var b=this.options.maxPerRoom;a.children>this.children.options.max?this.children.setValue(this.children.options.max,!0):a.children<this.children.options.min?this.children.setValue(this.children.options.min,!0):this.children.setValue(a.children,!0);var c=this.adults.getValue(),d=this.children.getValue(),f=this.rooms.getValue(),
b=Math.ceil((d+c)/b);f<b&&(f=b);f>c&&(c=f);this.adults.setValue(c,!0);this.rooms.setValue(f,!0);this.options.specifyChildAges&&this.displayTravelersAgeSection(this.children.getValue());this.refreshRoomsGuestsDropdownDisplay(a)},onAdultsFieldChange:function(a){var b=this.options.maxPerRoom;a.adults>this.adults.options.max?this.adults.setValue(this.adults.options.max,!0):a.adults<this.adults.options.min?this.adults.setValue(this.adults.options.min,!0):this.adults.setValue(a.adults,!0);var c,d=this.adults.getValue(),
f=this.children.getValue();a=this.rooms.getValue();c=Math.ceil((d+f)/b);c>d&&(c=d);a<c?a=c:a>d&&(a=d,b=a*b-d,f=b<f?b:f);this.children.setValue(f,!0);this.rooms.setValue(a,!0);this.options.specifyChildAges&&this.displayTravelersAgeSection(f);this.refreshRoomsGuestsDropdownDisplay()},onGuestsFieldChange:function(a){var b=this.options.maxPerRoom;a.guests>this.guests.options.max?this.guests.setValue(this.guests.options.max,!0):a.guests<this.guests.options.min?this.guests.setValue(this.guests.options.min,
!0):this.guests.setValue(a.guests,!0);var c=this.guests.getValue(),d=this.rooms.getValue();d*b<c?(d=Math.ceil(c/b),this.rooms.setValue(d),this.options.showNumberboxTooltips&&this.showTooltip(this.guests.incrButton,this.options.numberBoxMsg.guestsOverMax.call(this))):d>c?(this.rooms.setValue(c),this.options.showNumberboxTooltips&&this.showTooltip(this.guests.incrButton,this.options.numberBoxMsg.guestsBelowMin.call(this))):this.options.showNumberboxTooltips&&this.clearTooltips();this.refreshRoomsGuestsDropdownDisplay(a)},
refreshRoomsGuestsDropdownDisplay:function(){var a=this.rooms.getValue(),b=this.adults.getValue()+this.children.getValue(),a=e.Common.Utils.String.formatChoice(this.options.msg.roomsChoiceLabel,a,a);(b=e.Common.Utils.String.formatChoice(this.options.msg.guestsChoiceLabel,b,b))&&a&&this.roomsGuestsDropdown.updateLabel(a+", "+b);this.updateHotelPlanner(this.rooms.getValue());this.setMaxAgeContainerHeight()},updateHotelPlanner:function(a){0<this.options.hotelPlannerTrigger&&(a>=this.options.hotelPlannerTrigger?
(this.hotelPlanner.addClass("visible"),this.swapClasses(this.hotelPlanner,"RoomsGuestsDropdown__HotelPlanner--hidden","RoomsGuestsDropdown__HotelPlanner--visible")):(this.hotelPlanner.removeClass("visible"),this.swapClasses(this.hotelPlanner,"RoomsGuestsDropdown__HotelPlanner--visible","RoomsGuestsDropdown__HotelPlanner--hidden")))},getRoomsData:function(){return{rooms:this.rooms.getValue()}},getGuestsData:function(){return{adults:this.adults.getValue(),children:this.children.getValue()}},getTravelersAgeData:function(){var a=
this.travelersAgeContainer.children().length,b=this.children.getValue(),c="";if(b<=a)for(a=0;a<b;a++){var d=this.renderedTravelerDropdowns[a].getValue();"undefined"!==typeof d&&(c+=d,a<b-1&&(c+="-"))}return{childrenAges:c}},showTooltip:function(a,b){a.toolTip({content:b,position:"right",showImmediately:!0})},clearTooltips:function(){this.rooms.incrButton.data("toolTip")&&this.rooms.incrButton.data("toolTip").removeWidget();this.guests&&this.guests.incrButton.data("toolTip")&&this.guests.incrButton.data("toolTip").removeWidget();
this.children&&this.children.incrButton.data("toolTip")&&this.children.incrButton.data("toolTip").removeWidget();this.adults&&this.adults.incrButton.data("toolTip")&&this.adults.incrButton.data("toolTip").removeWidget()},displayTravelersAgeSection:function(a,b){0<a?this.swapClasses(this.travelersAgeContainer,"TravelersAgeContainer--hidden","TravelersAgeContainer--visible"):this.swapClasses(this.travelersAgeContainer,"TravelersAgeContainer--visible","TravelersAgeContainer--hidden");this.renderTravelerDropdowns(a,
b)},renderTravelerDropdowns:function(a,b){var c;c=this.travelersAgeContainer.children().length;for(var d=c>a?c:a,f="#traveler-"+this.id()+"-",e=0;e<d;e++)c=g(f+e),0<c.length?e<a?(this.swapClasses(c,"TravelersAgeItem--hidden","TravelersAgeItem--visible"),"undefined"!==typeof b&&"undefined"!==typeof b[e]&&this.renderedTravelerDropdowns[e].setValue(b[e],!1)):(this.swapClasses(c,"TravelersAgeItem--visible","TravelersAgeItem--hidden"),this.renderedTravelerDropdowns[e].setValue("0",!1)):null!=b&&"undefined"!==
typeof b[e]?this.renderNewTravelerAgeDropdown(e,b[e]):this.renderNewTravelerAgeDropdown(e)},renderNewTravelerAgeDropdown:function(a,b){var c=this,d="#traveler-"+this.id()+"-",f=e.template.render(c.options.travelerAgeTemplateId,{id:this.id(a),index:a+1});this.travelersAgeContainer.append(f);this.renderedTravelerDropdowns[a]=g(d+a+"-dropdown").dropdown({change:function(){var a=g.extend({namespace:c.options.namespace,id:c.options.namespace},c.getTravelersAgeData());e.events.publish("hotels.frontdoor.form.guests.childrenAges",
a)}}).getWidget();"undefined"!==typeof b&&this.renderedTravelerDropdowns[a].setValue(b);return f},serialize:function(){var a={};g.extend(a,this.getRoomsData());g.extend(a,this.getGuestsData());this.options.specifyChildAges&&g.extend(a,this.getTravelersAgeData());return a}})})(R9,jQuery);/*
 @r9/cmp2-ui - 2.3.0 generated: 2020-03-02T08:20:15.864Z */
(function(e){function b(h){if(a[h])return a[h].exports;var f=a[h]={i:h,l:!1,exports:{}};return e[h].call(f.exports,f,f.exports,b),f.l=!0,f.exports}var a={};b.m=e;b.c=a;b.d=function(a,f,l){b.o(a,f)||Object.defineProperty(a,f,{configurable:!1,enumerable:!0,get:l})};b.n=function(a){var f=a&&a.__esModule?function(){return a.default}:function(){return a};return b.d(f,"a",f),f};b.o=function(a,b){return Object.prototype.hasOwnProperty.call(a,b)};b.p="";b(b.s=30)})([function(e,b,a){function h(d){var c="function"==
typeof Symbol&&d[Symbol.iterator],a=0;return c?c.call(d):{next:function(){return d&&a>=d.length&&(d=void 0),{value:d&&d[a++],done:!d}}}}function f(d,c){var a="function"==typeof Symbol&&d[Symbol.iterator];if(!a)return d;var b,g;d=a.call(d);var k=[];try{for(;(void 0===c||0<c--)&&!(b=d.next()).done;)k.push(b.value)}catch(m){g={error:m}}finally{try{b&&!b.done&&(a=d.return)&&a.call(d)}finally{if(g)throw g.error;}}return k}function l(d){return this instanceof l?(this.v=d,this):new l(d)}Object.defineProperty(b,
"__esModule",{value:!0});b.__extends=function(d,c){function a(){this.constructor=d}k(d,c);d.prototype=null===c?Object.create(c):(a.prototype=c.prototype,new a)};a.d(b,"__assign",function(){return g});b.__rest=function(d,c){var a={},b;for(b in d)Object.prototype.hasOwnProperty.call(d,b)&&0>c.indexOf(b)&&(a[b]=d[b]);if(null!=d&&"function"==typeof Object.getOwnPropertySymbols){var g=0;for(b=Object.getOwnPropertySymbols(d);g<b.length;g++)0>c.indexOf(b[g])&&(a[b[g]]=d[b[g]])}return a};b.__decorate=function(d,
c,a,b){var g,p=arguments.length,q=3>p?c:null===b?b=Object.getOwnPropertyDescriptor(c,a):b;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)q=Reflect.decorate(d,c,a,b);else for(var k=d.length-1;0<=k;k--)(g=d[k])&&(q=(3>p?g(q):3<p?g(c,a,q):g(c,a))||q);return 3<p&&q&&Object.defineProperty(c,a,q),q};b.__param=function(d,c){return function(a,b){c(a,b,d)}};b.__metadata=function(a,c){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(a,c)};b.__awaiter=
function(a,c,b,g){return new (b||(b=Promise))(function(d,p){function q(c){try{n(g.next(c))}catch(r){p(r)}}function k(c){try{n(g.throw(c))}catch(r){p(r)}}function n(c){c.done?d(c.value):(new b(function(a){a(c.value)})).then(q,k)}n((g=g.apply(a,c||[])).next())})};b.__generator=function(a,c){function d(c){return function(a){return b([c,a])}}function b(d){if(g)throw new TypeError("Generator is already executing.");for(;f;)try{if(g=1,k&&(m=k[2&d[0]?"return":d[0]?"throw":"next"])&&!(m=m.call(k,d[1])).done)return m;
switch(k=0,m&&(d=[0,m.value]),d[0]){case 0:case 1:m=d;break;case 4:return f.label++,{value:d[1],done:!1};case 5:f.label++;k=d[1];d=[0];continue;case 7:d=f.ops.pop();f.trys.pop();continue;default:if(m=f.trys,!(m=0<m.length&&m[m.length-1])&&(6===d[0]||2===d[0])){f=0;continue}if(3===d[0]&&(!m||d[1]>m[0]&&d[1]<m[3]))f.label=d[1];else if(6===d[0]&&f.label<m[1])f.label=m[1],m=d;else if(m&&f.label<m[2])f.label=m[2],f.ops.push(d);else{m[2]&&f.ops.pop();f.trys.pop();continue}}d=c.call(a,f)}catch(r){d=[6,r],
k=0}finally{g=m=0}if(5&d[0])throw d[1];return{value:d[0]?d[1]:void 0,done:!0}}var g,k,m,l,f={label:0,sent:function(){if(1&m[0])throw m[1];return m[1]},trys:[],ops:[]};return l={next:d(0),throw:d(1),return:d(2)},"function"==typeof Symbol&&(l[Symbol.iterator]=function(){return this}),l};b.__exportStar=function(d,c){for(var a in d)c.hasOwnProperty(a)||(c[a]=d[a])};b.__values=h;b.__read=f;b.__spread=function(){for(var d=[],c=0;c<arguments.length;c++)d=d.concat(f(arguments[c]));return d};b.__await=l;b.__asyncGenerator=
function(d,c,a){function b(c){e[c]&&(h[c]=function(d){return new Promise(function(a,b){1<r.push([c,d,a,b])||g(c,d)})})}function g(c,d){try{var a=e[c](d);a.value instanceof l?Promise.resolve(a.value.v).then(p,k):f(r[0][2],a)}catch(x){f(r[0][3],x)}}function p(c){g("next",c)}function k(c){g("throw",c)}function f(c,d){c(d);r.shift();r.length&&g(r[0][0],r[0][1])}if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var h,e=a.apply(d,c||[]),r=[];return h={},b("next"),b("throw"),
b("return"),h[Symbol.asyncIterator]=function(){return this},h};b.__asyncDelegator=function(d){function c(c,g){d[c]&&(a[c]=function(a){return(b=!b)?{value:l(d[c](a)),done:"return"===c}:g?g(a):a})}var a,b;return a={},c("next"),c("throw",function(c){throw c;}),c("return"),a[Symbol.iterator]=function(){return this},a};b.__asyncValues=function(d){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var c=d[Symbol.asyncIterator];return c?c.call(d):"function"==typeof h?h(d):
d[Symbol.iterator]()};b.__makeTemplateObject=function(d,c){return Object.defineProperty?Object.defineProperty(d,"raw",{value:c}):d.raw=c,d};b.__importStar=function(d){if(d&&d.__esModule)return d;var c={};if(null!=d)for(var a in d)Object.hasOwnProperty.call(d,a)&&(c[a]=d[a]);return c.default=d,c};b.__importDefault=function(a){return a&&a.__esModule?a:{default:a}};var k=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,c){a.__proto__=c}||function(a,c){for(var d in c)c.hasOwnProperty(d)&&
(a[d]=c[d])},g=Object.assign||function(a){for(var c,d=1,b=arguments.length;d<b;d++){c=arguments[d];for(var g in c)Object.prototype.hasOwnProperty.call(c,g)&&(a[g]=c[g])}return a}},function(e,b,a){Object.defineProperty(b,"__esModule",{value:!0});var h=function(){function a(){}return a.getInstance=function(){return this._instance||(this._instance=new this),this._instance},a.prototype.setLogger=function(a){this._method=a},a.prototype.getLogger=function(){return this._method||this._methodPlaceholder()},
a.prototype._methodPlaceholder=function(){return{debug:f,error:f,info:f,warn:f}},a}(),f=function(){console.error("cmp2-ui: You should really consider adding logger")};b.getLogger=function(){return h.getInstance().getLogger()};b.setLogger=function(a){return h.getInstance().setLogger(a)}},function(e,b,a){Object.defineProperty(b,"__esModule",{value:!0});var h=a(0);e=a(19);var f=a(6),l=a(5),k=a(3),g=a(4).default(),d=k.default();a=function(c){function a(a){var d=c.call(this)||this;return d.options=a,d}
return h.__extends(a,c),a.prototype.onDirectClick=function(a,c){a=d.forDirect(a);a=new l.default(this.options,a);(new f.default(a)).start(!1)},a.prototype.onDirectMouseUp=function(a,c){},a.prototype.onDirectMouseDown=function(a,c){},a.prototype.onItemChange=function(a,c,d){},a.prototype.onItemMouseDown=function(a,c){},a.prototype.onItemMouseUp=function(a,c){},a.prototype.onFormClick=function(a,c,d){d([],[])},a.prototype.onFormButtonMouseDown=function(a){},a.prototype.onFormButtonMouseUp=function(a){},
a.prototype.navigateToResults=function(a,c,d){return!1},a.prototype.showRPCompareAll=function(){return!0},a.prototype.pushHandleHistory=function(a,c){c&&g.addHistory(a,c)},a.prototype.getWindowNamePrefix=function(){return d.getWindowNamePrefix()},a.prototype.onResultPageOpen=function(a,c,b){void 0===b&&(b="");a=new l.default(this.options,d.forSubmit(a));a=new f.default(a);a.setWindowNamePrefix(b);a.start(!0)},a.prototype.setIgnoreWindowErrors=function(a){g.setIgnoreWindowErrors(a)},a}(e.Observer);
b.Base=a;b.default=a},function(e,b,a){Object.defineProperty(b,"__esModule",{value:!0});var h=a(14),f=a(15),l=a(8),k=a(27).default(),g=function(){function a(){this.windowNamePrefix="k"+(new Date).getTime()+l.default.randomString(8)}return a.getInstance=function(){return this._instance||(this._instance=new this),this._instance},a.prototype.getWindowNamePrefix=function(){return this.windowNamePrefix},a.prototype.hidden=function(a,d){return{url:this.getUrl(a),name:a.code,features:k.hidden(!1,d)}},a.prototype.hiddenSmall=
function(a,d){return{url:this.getUrl(a),name:a.code,features:k.hidden(!0,d)}},a.prototype.tiled=function(a,d,b,g){return{url:this.getUrl(a),name:a.code,features:k.tiled(d,b,g)}},a.prototype.empty=function(a){return{url:this.getUrl(a),name:a.code,features:{}}},a.prototype.forDirect=function(a){for(var c=[],d=k.getWindowHandleInformation(),b=0,g=0,f;f=a[g];g++)f.visible&&b++;for(g=0;f=a[g];g++)f.visible&&c.push(this.tiled(f,g,b,d));return c},a.prototype.forBlank=function(a){return[{url:a||this.getUrl(),
name:"_blank",features:{}}]},a.prototype.forMultiProviderWindow=function(a,d){void 0===a&&(a=[]);void 0===d&&(d={});var c,b=[];if(0<a.length){for(var g=0,k;k=a[g];g++)k.deepLink&&"CLOSE"!==k.deepLink&&(b.push(k.code),c=k.deepLink);if(0<b.length)return 1===b.length&&c?h.formatUrl(c):h.formatUrl("/s/compareresults/multi",f.extend({providerCodes:b.join(",")},d||{}))}return""},a.prototype.forSubmit=function(a,d){void 0===d&&(d=0);for(var c=[],b=k.getWindowHandleInformation(),g=0,p=0,f;f=a[p];p++)f.visible&&
f.checked&&g++;for(p=0;f=a[p];p++)f.visible&&f.checked&&(4===d&&c.push(this.empty(f)),0===d&&c.push(this.tiled(f,p,g,b)),2===d&&c.push(this.hidden(f,b)),3===d&&c.push(this.hiddenSmall(f,b)));return c},a.prototype.getSpinnerPath=function(){return h.formatUrl("/s/compareresults/spinner")},a.prototype.getUrl=function(a){return a?a.deepLink?h.formatUrl(a.deepLink):h.formatUrl("/s/compareresults/spinner",{code:a.code}):this.getSpinnerPath()},a}();b.WindowHandleOptions=g;b.default=function(){return g.getInstance()}},
function(e,b,a){Object.defineProperty(b,"__esModule",{value:!0});var h=a(20),f=a(1);e=a(26);b.isSystemTargetName=function(a){return void 0===a&&(a=""),-1!==["_blank","_parent","_self","_top"].indexOf(a)};b.getWindowName=function(a){return void 0===a&&(a=""),b.isSystemTargetName(a)?a:a.replace(/[^a-z0-9]+/gi,"")};"undefined"!=typeof window&&e.addEvent(window,"popstate",function(a){(a=a.originalEvent?a.originalEvent:a)&&a.state&&a.state.hasOwnProperty("cmp2-workaround-back-Key")&&window.location.replace(a.state["cmp2-workaround-back-Key"])});
var l=function(){function a(){this._ignoreWindowErrors=!1}return a.getInstance=function(){return this._instance||(this._instance=new this),this._instance},a.prototype.getIgnoreWindowErrors=function(){return this._ignoreWindowErrors},a.prototype.setIgnoreWindowErrors=function(a){this._ignoreWindowErrors=a},a.prototype.open=function(a,d,c){void 0===d&&(d="");void 0===c&&(c={});"object"==typeof c&&(c=h.param(c,!0,","));return(a=open(a,b.getWindowName(d),c))&&!a.closed?a:null},a.prototype.getActiveWindowHandles=
function(a){for(var d=[],c=0,b;b=a[c];c++)(b=this.getWindowHandle(b))&&d.push(b);return d},a.prototype.getFirstActiveHandle=function(a){for(var d=0,c;c=a[d];d++)if(this.getWindowHandle(c))return c;return null},a.prototype.getLastActiveHandle=function(a){for(var d=a.length-1,c;c=a[d];d--)if(this.getWindowHandle(c))return c;return null},a.prototype.getWindowHandle=function(a){try{return!a||a.closed?null:a}catch(d){return null}},a.prototype.addHistory=function(a,d){if(a&&d&&void 0!==history.pushState&&
void 0!==history.replaceState)try{var c=a.location.href;a.history.replaceState((b={},b["cmp2-workaround-back-Key"]=d,b),"",d);a.history.pushState((g={},g["cmp2-workaround-back-Key"]=c,g),a.document.title,c)}catch(n){f.getLogger().warn("cmp2-workaround: WindowHandle unable to add history",n)}var b,g},a.prototype.updateHandleName=function(a,d,c){void 0===c&&(c="");a=this.getWindowHandle(a);if(!a)return f.getLogger().warn("cmp2-workaround: WindowHandle handle is not found",c),!1;try{if(a.name=d,a.name!==
d)return f.getLogger().warn("cmp2-workaround: WindowHandle unable to change name",c),!1}catch(p){return f.getLogger().warn("cmp2-workaround: WindowHandle unable to change name",p,c),!1}return!0},a.prototype.resizeBeforeMove=function(a,d){var c=this.getWindowHandle(a);if(c)try{if(void 0!==d.left&&void 0!==d.top){c.resizeTo(100,100);var b=this.moveToLeftTop(a);c.moveTo(b[0]+d.left,b[1]+d.top)}void 0!==d.width&&void 0!==d.height&&c.resizeTo(d.width,d.height)}catch(q){f.getLogger().warn("cmp2-workaround: WindowHandle unable resize handler in resizeBeforeMove",
q,q.stack)}},a.prototype.moveAccordingFeatures=function(a,d){if((a=this.getWindowHandle(a))&&d)try{void 0!==d.left&&void 0!==d.top&&a.moveTo(d.left,d.top),void 0!==d.width&&void 0!==d.height&&a.resizeTo(d.width,d.height)}catch(c){f.getLogger().warn("cmp2-workaround: WindowHandle unable resize handler in moveAccordingFeatures",c,c.stack)}},a.prototype.moveToLeftTop=function(a){if(a=this.getWindowHandle(a))try{return a.moveTo(-1E7,-1E7),["screenX"in a?a.screenX:a.screenLeft,"screenY"in a?a.screenY:
a.screenTop]}catch(d){f.getLogger().warn("cmp2-workaround: WindowHandle unable to move handler in moveToLeftTop",d,d.stack)}return[0,0]},a}();b.WindowHandle=l;b.default=function(){return l.getInstance()}},function(e,b,a){Object.defineProperty(b,"__esModule",{value:!0});e=function(){return function(a,b){this.items=[];this.options=a;this.items=b;this.resize=a.resizeWindows||!1}}();b.WindowHandleConstructor=e;b.default=e},function(e,b,a){Object.defineProperty(b,"__esModule",{value:!0});var h=a(0);e=
a(19);var f=a(1),l=a(4);a=a(3);var k=l.default(),g=a.default();a=function(a){function c(c){var d=a.call(this)||this;return d.windowNamePrefix="",d.windowHandleInformation=c,d.items=c.items,c.resize&&d.resizeHandle(c),c.preOpen&&d.preOpen(c.preOpen),c.postOpen&&d.postOpen(c.postOpen),c.preItemOpen&&d.preItemOpen(c.preItemOpen),c.postItemOpen&&d.postItemOpen(c.postItemOpen),d}return h.__extends(c,a),c.prototype.setWindowNamePrefix=function(a){void 0===a&&(a="");a&&(this.windowNamePrefix=a)},c.prototype.getWindowNamePrefix=
function(){return this.windowNamePrefix||(this.windowNamePrefix=g.getWindowNamePrefix()),this.windowNamePrefix},c.prototype.start=function(a){var c=this.items;this.publish("preOpen",[c]);for(var d=this.getWindowNamePrefix(),b=[],g=[],p=0,h;h=c[p];p++){this.publish("preItemOpen",[h,c]);var e=l.isSystemTargetName(h.name)?h.name:l.getWindowName(d+h.name),r=k.open(h.url,e,h.features),y=this.windowHandleInformation.options;if(y.expectWindowReference)if(r)b.push(e),g.push(r),this.publish("handleCreated",
[h,c,r]);else if(!k.getIgnoreWindowErrors()){var w=a?"":" in the RP";f.getLogger().warn("cmp2-workaround: unable to open handle in StandardWindowHandleExecutor"+w,{workaround:y,name:e,item:h})}this.publish("postItemOpen",[h,c,r])}this.publish("postOpen",[g,b])},c.prototype.handleCreated=function(a){return this.subscribe("handleCreated",a),this},c.prototype.preOpen=function(a){return this.subscribe("preOpen",a),this},c.prototype.postOpen=function(a){return this.subscribe("postOpen",a),this},c.prototype.preItemOpen=
function(a){return this.subscribe("preItemOpen",a),this},c.prototype.postItemOpen=function(a){return this.subscribe("postItemOpen",a),this},c.prototype.getItems=function(){return this.items},c.prototype.resizeHandle=function(a){this.postItemOpen(function(c,d,b){(d=k.getWindowHandle(b))&&c.features&&(c=c.features,a.options.resizeBeforeOpening?k.resizeBeforeMove(d,c):k.moveAccordingFeatures(d,c))})},c}(e.Observer);b.StandardWindowHandleExecutor=a;b.default=a},function(e,b,a){Object.defineProperty(b,
"__esModule",{value:!0});e=a(35);var h=a(2);b.Base=h.default;var f=e.default();b.setWorkaround=function(a){f.setWorkaround(a,!1)};b.getWorkaround=function(){return f.getWorkaround()};e=a(1);b.getLogger=e.getLogger;b.setLogger=e.setLogger;e=a(15);b.extend=e.extend;a=a(14);b.updateBasePath=a.updateBasePath},function(e,b,a){Object.defineProperty(b,"__esModule",{value:!0});e=function(){function a(){}return a.UUID=function(){var a=(new Date).getTime();return"xxxxxxxxxxxx4xxxyxxxxxxxxxxxxxxx".replace(/[xy]/g,
function(b){var k=(a+16*Math.random())%16|0;return a=Math.floor(a/16),("x"===b?k:3&k|8).toString(16)})},a.randomString=function(a){void 0===a&&(a=6);for(var b="",k=0;k<a;k++)b+="abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789".charAt(Math.floor(62*Math.random()));return b},a}();b.StringGenerators=e;b.default=e},function(e,b,a){Object.defineProperty(b,"__esModule",{value:!0});var h=a(10),f=a(11),l=a(7);e=function(){function a(){this._client="other";this._queue=[];this._isInProgress=
!1}return a.getInstance=function(){return this._instance||(this._instance=new this),this._instance},a.prototype.setClient=function(a){this._client=a},a.prototype.getClient=function(){return this._client},a.prototype.setSettings=function(a){this._settings=a;l.setWorkaround(a.workaround)},a.prototype.isSettings=function(){return!!this._settings},a.prototype.getSettings=function(a,d){var c=this;if(this._settings)return void a(this._settings);if(this._queue.push({onSuccess:a,onError:d}),!this._isInProgress){this._isInProgress=
!0;a=h.Settings.getConfig();var b=function(){c._isInProgress=!1;c._queue.forEach(function(a){a.onError&&a.onError(void 0)});c._queue=[]};f.Ajax.getInstance().request(a,function(a){if(!a||!a.success)return l.getLogger().error("cmp2-ui: AJAX error on getSettings",a.errors),void b();var d=a.content;c.setSettings(d);c._isInProgress=!1;c._queue.forEach(function(a){a.onSuccess(d)});c._queue=[]},function(a){l.getLogger().error("cmp2-ui: AJAX error on getSettings",a);b()},b)}},a.prototype.getSettingsSync=
function(){return this.isSettings()?this._settings:void l.getLogger().error("cmp2-ui: getSettingsSync failed. Refactor")},a}();b.CompareToSettings=e},function(e,b,a){Object.defineProperty(b,"__esModule",{value:!0});e=a(32);b.List=e.List;e=a(33);b.WindowInfo=e.WindowInfo;a=a(34);b.Settings=a.Settings},function(e,b,a){Object.defineProperty(b,"__esModule",{value:!0});var h,f=a(0),l=a(7),k=a(52);e=function(){function a(){var a=k.StorageSessionHelper.getInstance().getItem("cmp2.headers");a&&(this._headers=
a)}return a.getInstance=function(){return h||(h=new this),h},a.prototype.setMethod=function(a){this._method=a},a.prototype.request=function(a,c,b,g){var d=this;return this._method?(this._headers&&(a.headers=f.__assign({},a.headers,this._headers)),this._method(a,function(a){if(a&&a.headers){var b=a.headers;d._headers=b;k.StorageSessionHelper.getInstance().setItem("cmp2.headers",b)}c&&c(a)},b),!0):(l.getLogger().error("cmp2-ui: Ajax method is not set"),g&&g(),!1)},a}();b.Ajax=e},function(e,b,a){Object.defineProperty(b,
"__esModule",{value:!0});b.isFunction=function(a){return"function"==typeof a&&"number"!=typeof a.nodeType}},function(e,b,a){Object.defineProperty(b,"__esModule",{value:!0});b.class2Type={}},function(e,b,a){function h(a){a=a.split("/");for(var c=a.length,d=[],b=0;b<c;b++){var g=a[b];0!==g.length&&d.push(g)}return d.join("/").replace(/^(https?:)([\/])*/g,"$1//")}Object.defineProperty(b,"__esModule",{value:!0});var f=a(20);b.updateBasePath=function(a){return b.BASE_PATH=h(a),-1===b.BASE_PATH.indexOf("http")&&
(b.BASE_PATH="/"+b.BASE_PATH),b.BASE_PATH};var l=/#.*$/,k=/\?/,g=/([?&])_=[^&]*/;b.formatUrl=function(a,c,p){void 0===c&&(c="");void 0===p&&(p=!0);a=(a=h(a))?a&&0===a.indexOf("http")?a:b.BASE_PATH.replace(/[\/]$/g,"")+"/"+a:b.BASE_PATH;if(c){var d=p;void 0===a&&(a="");void 0===c&&(c="");void 0===d&&(d=!0);p=a.replace(l,"");a=a.slice(p.length);c&&(c="object"==typeof c?f.param(c):c,p+=(k.test(p)?"\x26":"?")+c);c=(!1===d&&(p=p.replace(g,"$1"),a=(k.test(p)?"\x26":"?")+"_\x3d"+(new Date).getTime()+a),
p+a)}else c=a;return c};b.BASE_PATH=""},function(e,b,a){function h(){for(var a=[],b=0;b<arguments.length;b++)a[b]=arguments[b];var d,c,p,e,n,t=a.length,m=a[0]||{},u=1,v=!1;"boolean"==typeof m&&(v=m,m=a[u]||{},u++);"object"==typeof m||l.isFunction(m)||(m={});for(u===t&&(m=this,u--);u<t;u++)if(null!=(b=a[u]))for(d in b)b.hasOwnProperty(d)&&(c=m[d],p=b[d],m!==p)&&(v&&p&&(f.isPlainObject(p)||(e=Array.isArray(p)))?(e?(e=!1,n=c&&Array.isArray(c)?c:[]):n=c&&f.isPlainObject(c)?c:{},m[d]=h(v,n,p)):void 0!==
p&&(m[d]=p));return m}Object.defineProperty(b,"__esModule",{value:!0});var f=a(23),l=a(12);b.extend=h},function(e,b,a){Object.defineProperty(b,"__esModule",{value:!0});var h=a(29),f=a(9);b.invokeLoadingTrackingUrl=function(a){(new Image(1,1)).src=a};e=function(){function a(){var a=h.StorageHelper.getInstance().getItem("cmp2.state");this._setCompareToState(a)}return a.getInstance=function(){return this._instance||(this._instance=new this),this._instance},a.prototype.getImpressionRequestState=function(a){for(var b=
[],d=0;d<a.length;d++){var c=a[d];b.push({checked:c.checked,code:c.code,id:c.id,prechecked:c.prechecked,rank:c.rank,termId:c.termId,visible:c.visible})}return b},a.prototype.getVisibleItem=function(a){var b=[];if(a&&"object"==typeof a&&a.constructor===Array&&0<a.length)for(var d=0;d<a.length;d++){var c=a[d];c.visible&&b.push(c)}return b},a.prototype.getVisibleItemCount=function(a){return this.getVisibleItem(a).length},a.prototype.isCheckedItem=function(a){for(var b=0;b<a.length;b++){var d=a[b];if(d.visible&&
d.checked)return!0}return!1},a.prototype.updateCheckedItemState=function(a,b){if(b.id&&b.idInState)this._compareTosStates[b.id]=b.checked;else{var d=b.code;if(d){var c=this._getMediaAlphaProviderName(d);c&&(d=c);this._compareTosStates[d]=b.checked}}b=h.StorageHelper.getInstance();b.setItem("cmp2.state",this._compareTosStates);var g=0;a.forEach(function(a){a.visible&&a.checked&&g++});0===g?b.setItem("cmp2.check.all","false"):this.getVisibleItemCount(a)===g?b.setItem("cmp2.check.all","true"):b.removeItem("cmp2.check.all")},
a.prototype.prepareItemsToDisplay=function(a){var g=this,d=f.CompareToSettings.getInstance().getSettingsSync();if(!d)return[];var c=[],k=h.StorageHelper.getInstance().getItem("cmp2.check.all"),d=d.rendering,l=d.storeStateSession,n=d.limited,e=d.usePreCheckItems,m=d.maxCheckedItems,u=d.loadTrackingUrl,v=0;return a.forEach(function(a){var d=!1;(!n||v<m)&&(d=g._isItemChecked(a,l,e,k))&&v++;d={name:a.name,code:a.code,id:a.id,visible:a.visible,checked:d,prechecked:e&&a.prechecked,termId:a.termId,idInState:a.idInState,
rank:a.rank,logo:a.logo,logoLarge:a.logoLarge};"deepLink"in a&&(d.deepLink=a.deepLink);"clickToCall"in a&&(d.clickToCall=a.clickToCall);"svgLogo"in a&&(d.svgLogo=a.svgLogo);"phoneNumber"in a&&(d.phoneNumber=a.phoneNumber);u?a.visible&&a.trackingUrl&&b.invokeLoadingTrackingUrl(a.trackingUrl):"trackingUrl"in a&&(d.trackingUrl=a.trackingUrl);c.push(d)}),c},a.prototype.getCompareToItemsFromImpressionState=function(a){var b=[];return a.forEach(function(a){b.push({name:"",logo:"",logoLarge:"",code:a.code,
id:a.id,visible:a.visible,checked:a.checked,prechecked:a.prechecked,idInState:!0,termId:a.termId,rank:a.rank})}),b},a.prototype.mapDeepLinkToItems=function(a,b){var d=[];return this.getCompareToItemsFromImpressionState(a).forEach(function(a){a.visible&&a.checked&&b[a.code]&&b[a.code].deepLink&&(a.deepLink=b[a.code].deepLink,d.push(a))}),d},a.prototype._getMediaAlphaProviderName=function(a){return(a=/^([a-zA-Z]*-[0-9]*-[0-9]*)/.exec(a))?a[1]:null},a.prototype._isItemChecked=function(a,b,d,c){if(!a.visible)return!1;
if(b){if(null!==c)return!0===c;b=this._compareTosStates;if(a.idInState){if(a.id&&b.hasOwnProperty(a.id))return b[a.id]}else if(c=a.code){var g=this._getMediaAlphaProviderName(c);if(g&&(c=g),b.hasOwnProperty(c))return b[c]}}return a.prechecked&&d},a.prototype._setCompareToState=function(a){this._compareTosStates=a&&"object"==typeof a?a:{}},a}();b.CompareToList=e},function(e,b,a){function h(a){var b=[];if(a.placement){var c=a.placement;b.push(c.vertical?c.vertical:a.type);b.push(c.type||"");b.push(f(c.showOn)||
"");b.push(c.page||"");b.push(l(c.displayRail)+(c.position||0))}return b.join(".")}function f(a){switch(a){case "fd":case "pn":return"FD";case "bb":case "rr":case "sa":case "pu":case "md":return"RP"}}function l(a){switch(a){case "right":return"R";case "top":case "inline":case "panel":case "fdct":return"M";case "bottom":return"B";case "popup":return"P"}return""}Object.defineProperty(b,"__esModule",{value:!0});var k=a(9);b.isEnabled=function(a,b){return b&&b.enabled&&(!b.verticals||b.verticals[a])||
!1};b.excludeRequest=function(a,b,c){if(!c)return!1;var d=a.clientDisplayRails;a=a.displayRails;return d&&d[b]&&!1===d[b][c.displayRail]||a&&!1===a[c.displayRail]||!1};b.buildWindowOpenerRequest=function(){return{event:b.WINDOW_OPENER_REQUEST_EVENT}};b.buildWindowOpenerResponse=function(a){return{event:b.WINDOW_OPENER_EVENT,windowInfo:a}};b.extractWindowOpenerRequest=function(a){a=a&&a.data;return!(!a||!a.event||a.event!==b.WINDOW_OPENER_REQUEST_EVENT)&&a};b.extractWindowOpenerResponse=function(a){a=
a&&a.data;return!(!a||!a.event||a.event!==b.WINDOW_OPENER_EVENT)&&a};b.getMultiProviderWindowExtra=function(a,b,c){c={searchId:void 0!==c?c:a.searchId};var d=k.CompareToSettings.getInstance().getSettingsSync();if(!d||!(b="rp"===b?d.multiProviderWindowRP:d.multiProviderWindowFD))return c;d=a.placement;return d&&(b.pageOrigin&&(c.pageOrigin=h(a)),b.showOn&&(c.showOn=d.showOn),b.displayRail&&(c.displayRail=d.displayRail),b.vertical&&(c.vertical=a.type),b.position&&(c.position=d.displayRail)),c};b.getPageOrigin=
h;b.WINDOW_OPENER_REQUEST_EVENT="FD_CMP2_ITEMS_REQUEST";b.WINDOW_OPENER_EVENT="FD_CMP2_ITEMS"},function(e,b,a){Object.defineProperty(b,"__esModule",{value:!0});b.getPostHeader=function(){return{"Content-Type":"application/json; charset\x3dUTF-8"}}},function(e,b,a){Object.defineProperty(b,"__esModule",{value:!0});e=function(){function a(){this.events={}}return a.prototype.on=function(a,b){var f=this.events[a];return f||(this.events[a]=f=[]),f.push(b),this},a.prototype.off=function(a,b){var f=this.events[a];
return f?(void 0===b?delete this.events[a]:this.events[a]=f.filter(function(a){if(a!==b)return a}),this):this},a.prototype.subscribe=function(a,b){return this.on(a,b)},a.prototype.unSubscribe=function(a,b){return this.off(a,b)},a.prototype.publish=function(a,b){a=this.events[a];if(!a)return this;for(var f=0,g;g=a[f];f++)g.apply(this,b||[]);return this},a.prototype.notify=function(a,b){return this.publish(a,b)},a}();b.Observer=e},function(e,b,a){function h(a,b,g,n){var c;if(Array.isArray(b))f.each(b,
function(b,c){g||d.test(a)?n(a,c):h(a+"["+("object"==typeof c&&null!=c?b:"")+"]",c,g,n)});else if(g||"object"!==l.toType(b))n(a,b);else for(c in b)b.hasOwnProperty(c)&&h(a+"["+c+"]",b[c],g,n)}Object.defineProperty(b,"__esModule",{value:!0});var f=a(36),l=a(21),k=a(23),g=a(12),d=/\[\]$/;b.param=function(a,b,d){void 0===b&&(b=!1);void 0===d&&(d="\x26");var c,e=[],m=function(a,b){b=g.isFunction(b)?b():b;e[e.length]=encodeURIComponent(a)+"\x3d"+encodeURIComponent(null==b?"":b)};if(Array.isArray(a)||!k.isPlainObject(a))f.each(a,
function(a,b){m(a,b)});else for(c in a)a.hasOwnProperty(c)&&h(c,a[c],b,m);return e.join(d)}},function(e,b,a){Object.defineProperty(b,"__esModule",{value:!0});var h=a(13),f=a(22);b.toType=function(a){return null==a?a+"":"object"==typeof a||"function"==typeof a?h.class2Type[f.toString.call(a)]||"object":typeof a}},function(e,b,a){Object.defineProperty(b,"__esModule",{value:!0});e=a(13);b.toString=e.class2Type.toString},function(e,b,a){Object.defineProperty(b,"__esModule",{value:!0});var h=a(24),f=a(39),
l=a(25),k=a(22);b.isPlainObject=function(a){var b,c;return!(!a||"[object Object]"!==k.toString.call(a))&&(!(b=Object.getPrototypeOf(a))||"function"==typeof(c=l.hasOwn.call(b,"constructor")&&b.constructor)&&h.functionToString.call(c)===f.objectFunctionString)}},function(e,b,a){Object.defineProperty(b,"__esModule",{value:!0});e=a(25);b.functionToString=e.hasOwn.toString},function(e,b,a){Object.defineProperty(b,"__esModule",{value:!0});e=a(13);b.hasOwn=e.class2Type.hasOwnProperty},function(e,b,a){Object.defineProperty(b,
"__esModule",{value:!0});b.addEvent=function(a,b,e){void 0===a._eventListeners&&(a._eventListeners=[]);a.addEventListener(b,e,!1);var f=a._eventListeners;f.push({type:b,fn:e});a._eventListeners=f};b.removeEvent=function(a,b,e){if(void 0!==a._eventListeners){a.removeEventListener(b,e);for(var f,g=a._eventListeners,d=[],c=g.length,l=0;l<c;l++)f=g[l],f.type!==b&&f.fn!==e&&d.push(g[l]);a._eventListeners=g}}},function(e,b,a){Object.defineProperty(b,"__esModule",{value:!0});var h=a(15),f=a(1),l={scrollbars:1,
location:1,statusbar:1,menubar:0,resizable:1},k=function(){function a(){}return a.getInstance=function(){return this._instance||(this._instance=new this),this._instance},a.prototype.getWindowHandleInformation=function(a){try{a=a||window;var b=a.document,d=a.screen,g=b.documentElement,n=b.getElementsByTagName("body")[0];return{y:"screenY"in a?a.screenY:a.screenTop,x:"screenX"in a?a.screenX:a.screenLeft,width:a.innerWidth||g.clientWidth||n.clientWidth,height:a.innerHeight||g.clientHeight||n.clientHeight,
screenWidth:d.availWidth,screenHeight:d.availHeight}}catch(t){f.getLogger().error("cmp2-workaround: WindowHandleFeatures unable to access window/handle information",t)}try{return{y:0,x:0,width:window.screen.availWidth,height:window.screen.availHeight,screenWidth:window.screen.availWidth,screenHeight:window.screen.availHeight}}catch(t){f.getLogger().error("cmp2-workaround: WindowHandleFeatures unable to access window information",t)}return{y:0,x:0,width:800,height:600,screenWidth:800,screenHeight:600}},
a.prototype.hidden=function(a,b){var c=Math.min(1024,b.height-20),d=Math.min(1280,b.width-20),f=b.y+10,g=b.x+10;return a&&(c=160,d=160,f=b.y+(b.height-110),g=b.x+(b.width-185)),h.extend({},l,{top:f,left:g,height:c,width:d})},a.prototype.tiled=function(a,b,f){b=Math.floor(f.screenWidth/b-10);return h.extend({},l,{left:Math.floor((b+5)*a),top:-999999999,height:Math.abs(-1*f.screenHeight),width:Math.abs(b)})},a}();b.WindowHandleFeatures=k;b.default=function(){return k.getInstance()}},function(e,b,a){Object.defineProperty(b,
"__esModule",{value:!0});var h=a(0),f=a(1),l=a(4);e=a(6);var k=l.default();e=function(a){function b(){var b=null!==a&&a.apply(this,arguments)||this;return b.windowHandleNames=[],b.windowHandles=[],b}return h.__extends(b,a),b.prototype.start=function(a){var b=this,c=this.getItems();this.windowHandleNames=[];this.windowHandles=[];this.publish("preOpen",[c]);var d=this.windowHandleInformation.options,f=1;void 0!==d.delay&&(f=d.delay);for(var d=0,g=void 0;g=c[d];d++)this._open(g,a);setTimeout(function(){b.publish("postOpen",
[b.windowHandles,b.windowHandleNames])},f)},b.prototype._open=function(a,b){var c=this,d=this.getItems(),g=this.getWindowNamePrefix(),e=this.windowHandleInformation.options,h=0;void 0!==e.timer&&(h=e.timer);setTimeout(function(){c.publish("preItemOpen",[a,d]);var m=l.isSystemTargetName(a.name)?a.name:l.getWindowName(g+a.name),n=k.open(a.url,m,a.features);if(e.expectWindowReference)if(n)c.addHandleName(m),c.addHandle(n),c.publish("handleCreated",[a,d,n]);else{var h=b?"":" in the RP";f.getLogger().warn("cmp2-workaround: unable to open handle in TimeoutWindowHandleExecutor"+
h,{workaround:e,name:m,item:a})}c.publish("postItemOpen",[a,d,n])},h)},b.prototype.addHandleName=function(a){this.windowHandleNames.push(a)},b.prototype.addHandle=function(a){this.windowHandles.push(a)},b}(e.default);b.TimeoutWindowHandleExecutor=e;b.default=e},function(e,b,a){Object.defineProperty(b,"__esModule",{value:!0});var h,f=a(7);e=function(){function a(){this._available=!1;this.setStorage(this._getWindowStorage())}return a.getInstance=function(){return h||(h=new this),h},a.prototype.setStorage=
function(a){var b;try{a&&(a.setItem("vendor-support-test","success?"),b=a.getItem("vendor-support-test"),a.removeItem("vendor-support-test"),this._storage=a),"success?"===b&&(this._available=!0)}catch(d){}},a.prototype.getItem=function(a){if(this._available&&this._storage){var b=this._storage.getItem(a);if(b)try{return JSON.parse(b)}catch(d){return f.getLogger().error("cmp2-ui: StorageHelper unable to parse value",{key:a,value:b,error:d}),b}}return null},a.prototype.setItem=function(a,b){if(this._available&&
this._storage)try{null!==b&&"object"==typeof b?this._storage.setItem(a,JSON.stringify(b)):this._storage.setItem(a,b)}catch(d){f.getLogger().error("cmp2-ui: StorageHelper unable to set item",{key:a,data:b})}},a.prototype.removeItem=function(a){try{this._available&&this._storage&&this._storage.removeItem(a)}catch(g){f.getLogger().error("cmp2-ui: StorageHelper unable to remove item",{key:a})}},a.prototype.clear=function(){if(this._available&&this._storage)try{this._storage.clear()}catch(k){f.getLogger().error("cmp2-ui: StorageHelper unable to clear")}},
a.prototype._getWindowStorage=function(){var a;try{a=window.localStorage}catch(g){}return a},a}();b.StorageHelper=e},function(e,b,a){Object.defineProperty(b,"__esModule",{value:!0});e=a(31);window["@r9/cmp2-ui"]||(window["@r9/cmp2-ui"]=e)},function(e,b,a){Object.defineProperty(b,"__esModule",{value:!0});var h=a(10),f=a(7),l=a(11),k=a(9),g=a(16),d=a(17);e=a(7);b.updateBasePath=e.updateBasePath;e=a(7);b.getWorkaround=e.getWorkaround;e=a(53);b.onItemMouseUp=e.onItemMouseUp;b.onItemMouseDown=e.onItemMouseDown;
b.onItemChange=e.onItemChange;b.onFormClick=e.onFormClick;b.onFormButtonMouseDown=e.onFormButtonMouseDown;b.onFormButtonMouseUp=e.onFormButtonMouseUp;a=a(54);b.onDirectMouseUp=a.onDirectMouseUp;b.onDirectMouseDown=a.onDirectMouseDown;b.onDirectClick=a.onDirectClick;b.onResultPage=a.onResultPage;b.registerImpression=a.registerImpression;b.setModuleConfig=function(a){a.ajax&&l.Ajax.getInstance().setMethod(a.ajax);a.logger&&f.setLogger(a.logger);a.settings&&k.CompareToSettings.getInstance().setSettings(a.settings);
a.client&&k.CompareToSettings.getInstance().setClient(a.client)};b.showRPCompareAll=function(a){var b=k.CompareToSettings.getInstance();return b.isSettings()?f.getWorkaround().showRPCompareAll()&&(a=g.CompareToList.getInstance().getVisibleItemCount(a),(b=b.getSettingsSync())&&a>=b.rendering.minItemsForCompareAll)?!0:!1:(f.getLogger().error("cmp2-ui: settings are not set to execute showRPCompareAll"),!1)};b.showMultiActions=function(a,b){var c=k.CompareToSettings.getInstance();if(!c.isSettings())return f.getLogger().error("cmp2-ui: settings are not set to execute showMultiActions"),
!1;if(!f.getWorkaround().showRPCompareAll())return!1;a=g.CompareToList.getInstance().getVisibleItemCount(a);c=c.getSettingsSync();if(!c)return!1;var d=c.rendering,c=d.minItemsForCompareAll,d=d.placementMinItemsForMultiActions;b=b&&d&&d[b];return void 0!==b?a>=b:a>=c};b.getCompareTo=function(a,b,e){if(!a.placement)return b([]),void f.getLogger().error("cmp2-ui: placement information is missing",a);if(!a.url)return b([]),void f.getLogger().error("cmp2-ui: missing url",a);var c=k.CompareToSettings.getInstance();
if(c.isSettings()){var t=c.getSettingsSync();if(!d.isEnabled(a.type,t)||d.excludeRequest(t,c.getClient(),a.placement))return void b([])}a.registerImpression=!!a.registerImpression;a.deepLink=!!a.deepLink;a.convertUrl=a.convertUrl;a.list=!0;a.config=!c.isSettings();var m=h.List.getConfig(a);l.Ajax.getInstance().request(m,function(n){if(!n||!n.success)return f.getLogger().error("cmp2-ui: Received an unexpected response",m,n,a),void e();if(n.config){c.setSettings(n.config);var h=c.getSettingsSync();
if(!d.isEnabled(a.type,h)||d.excludeRequest(h,c.getClient(),a.placement))return void b([])}return c.isSettings()?n.content?void b(g.CompareToList.getInstance().prepareItemsToDisplay(n.content)):void b([]):(f.getLogger().error("cmp2-ui: expected to have settings after getCompareTo request",m,n,a),void b([]))},function(a){f.getLogger().error("cmp2-ui: AJAX error on getCompareTo",a,m);e()},e)}},function(e,b,a){Object.defineProperty(b,"__esModule",{value:!0});var h=a(18);e=function(){function a(){}return a.getConfig=
function(a){return{method:"POST",headers:h.getPostHeader(),url:"/s/horizon/compareTo/list",data:a}},a}();b.List=e},function(e,b,a){Object.defineProperty(b,"__esModule",{value:!0});var h=a(18);e=function(){function a(){}return a.getStoreConfig=function(a,b,f){return void 0===f&&(f={}),{method:"POST",url:"/s/horizon/compareTo/WindowInformation/add",headers:h.getPostHeader(),data:{type:a.type,placement:a.placement,convertUrl:a.convertUrl,url:a.url?a.url:"",items:b,other:f}}},a.getRetrieveConfig=function(a){return{method:"POST",
url:"/s/horizon/compareTo/WindowInformation/list",headers:h.getPostHeader(),data:a}},a}();b.WindowInfo=e},function(e,b,a){Object.defineProperty(b,"__esModule",{value:!0});e=function(){function a(){}return a.getConfig=function(){return{method:"GET",url:"/s/horizon/compareTo/config"}},a}();b.Settings=e},function(e,b,a){Object.defineProperty(b,"__esModule",{value:!0});var h=a(2),f=a(40),l=a(41),k=a(42),g=a(43),d=a(45),c=a(46),p=a(1),q=a(47),n=a(48),t=a(49),m=a(50),u=a(51),v=function(){function a(){}
return a.getInstance=function(){return this._instance||(this._instance=new this),this._instance},a.prototype.setWorkaround=function(a,b){switch(b?a.fallbackName:a.name){case "AsyncOpen":this.workaround=new f.default(a);break;case "AsyncOpenMobile":this.workaround=new l.default(a);break;case "ChangeWindowNameLast":this.workaround=new k.default(a);break;case "ChangeWindowNameSequence":this.workaround=new g.default(a);break;case "DocumentFocus":this.workaround=new d.default(a);break;case "HandleOpen":this.workaround=
new c.default(a);break;case "RegularOpenCloseLast":this.workaround=new q.default(a);break;case "Swapper":this.workaround=new n.default(a);break;case "SwapperMultipleWindows":this.workaround=new t.default(a);break;case "SwapperMultipleWindowsNoSpinner":this.workaround=new u.default(a);break;case "SwapperNoSpinner":this.workaround=new m.default(a);break;default:if(!b&&a.fallbackName)return p.getLogger().warn("cmp2-workaround: unable to find workaround. Trying to fallback",a),void this.setWorkaround(a,
!0);p.getLogger().error("cmp2-workaround: unable to find workaround",a.name);this.workaround=new h.default(a)}},a.prototype.getWorkaround=function(){return this.workaround||(p.getLogger().error("cmp2-workaround: workaround is not set"),this.workaround=new h.default({name:""})),this.workaround},a}();b.Workaround=v;b.default=function(){return v.getInstance()}},function(e,b,a){Object.defineProperty(b,"__esModule",{value:!0});var h=a(37);b.each=function(a,b){if(h.isArrayLike(a))for(var f=a.length,g=0;g<
f&&!1!==b.call(a[g],g,a[g]);g++);else for(g in a)if(a.hasOwnProperty(g)&&!1===b.call(a[g],g,a[g]))break;return a}},function(e,b,a){Object.defineProperty(b,"__esModule",{value:!0});var h=a(12),f=a(21),l=a(38);b.isArrayLike=function(a){var b=!!a&&"length"in a&&a.length,d=f.toType(a);return!h.isFunction(a)&&!l.isWindow(a)&&("array"===d||0===b||"number"==typeof b&&0<b&&b-1 in a)}},function(e,b,a){Object.defineProperty(b,"__esModule",{value:!0});b.isWindow=function(a){return null!=a&&a===a.window}},function(e,
b,a){Object.defineProperty(b,"__esModule",{value:!0});e=a(24);b.objectFunctionString=e.functionToString.call(Object)},function(e,b,a){Object.defineProperty(b,"__esModule",{value:!0});var h=a(0);e=a(2);var f=a(5),l=a(3),k=a(7),g=a(28),d=l.default();a=function(a){function b(){return null!==a&&a.apply(this,arguments)||this}return h.__extends(b,a),b.prototype.onDirectClick=function(a,b){a=d.forDirect(a);a=new f.default(this.options,a);(new g.default(a)).start(!1)},b.prototype.onFormClick=function(a,b,
c){var e=this;a=d.forSubmit(b);b={url:"",name:"_self",features:{}};delete b.features;a.push(b);a=new f.default(this.options,a);a.postItemOpen=function(a,b,c){a.features||(c&&!c.closed?c.focus():k.getLogger().warn("cmp2-workaround: AsyncOpen unable to focus",{workaround:e.options}))};a.postOpen=function(a,b){c(a,b)};(new g.default(a)).start(!0)},b}(e.default);b.AsyncOpen=a;b.default=a},function(e,b,a){Object.defineProperty(b,"__esModule",{value:!0});var h=a(0);e=a(2);var f=a(5),l=a(3),k=a(7),g=a(28),
d=a(4),c=a(8),p=d.default(),q=l.default();a=function(a){function b(){return null!==a&&a.apply(this,arguments)||this}return h.__extends(b,a),b.prototype.onDirectClick=function(a,b){a=q.forDirect(a);a=new f.default(this.options,a);(new g.default(a)).start(!1)},b.prototype.navigateToResults=function(a,b,c){return!(!c||0===c.length)||(k.getLogger().warn("cmp2-workaround: AsyncOpenMobile navigateToResults using fallback. There is no window handles available.",{workaround:this.options}),!1)},b.prototype.onFormClick=
function(a,b,e){var m=this,n=q.forSubmit(b,4),h=n.shift();h?(b=this.getWindowNamePrefix(),p.updateHandleName(window,d.getWindowName(b+h.name),1),n.push({url:a,name:"k"+c.default.randomString(8),features:{}}),n=new f.default(this.options,n),n.postOpen=function(b,d){var f=p.getActiveWindowHandles(b),g=p.getLastActiveHandle(f);f.length!==b.length&&k.getLogger().warn("cmp2-workaround: AsyncOpenMobile some windows are closed",{workaround:m.options,activeWindowHandlesLength:f.length,windowHandlesLength:b.length});
g&&(p.updateHandleName(g,"k"+c.default.randomString(8),2),g.location.href=a);e(b,d)},n=new g.default(n),n.setWindowNamePrefix(b),n.start(!0)):(k.getLogger().error('cmp2-workaround: AsyncOpenMobile "firstItem" is undefined',{workaround:this.options}),e([],[]))},b}(e.default);b.AsyncOpenMobile=a;b.default=a},function(e,b,a){Object.defineProperty(b,"__esModule",{value:!0});var h=a(0);e=a(2);var f=a(6),l=a(5),k=a(4);a=a(3);var g=k.default(),d=a.default();a=function(a){function b(){return null!==a&&a.apply(this,
arguments)||this}return h.__extends(b,a),b.prototype.onResultPageOpen=function(a,b,c){void 0===b&&(b={});void 0===c&&(c="");b=this.options;a=new l.default(b,d.forSubmit(a));b.resultPageFocus&&(a.postOpen=function(){g.open("",name)});a=new f.default(a);a.setWindowNamePrefix(c);a.start(!0)},b.prototype.onFormClick=function(a,b,c){a=d.forSubmit(b);var e=this.getWindowNamePrefix();g.updateHandleName(window,e,1);a=new l.default(this.options,a);a.postOpen=function(a,b){g.open("",e);c(a,b)};(new f.default(a)).start(!0)},
b}(e.default);b.ChangeWindowNameLast=a;b.default=a},function(e,b,a){Object.defineProperty(b,"__esModule",{value:!0});var h=a(0),f=a(44);e=a(2);var l=a(1),k=a(6),g=a(8),d=a(5),c=a(4),p=a(27),q=a(3),n=a(14),t=c.default(),m=p.default(),u=q.default();a=function(a){function b(){return null!==a&&a.apply(this,arguments)||this}return h.__extends(b,a),b.prototype.onDirectClick=function(a,b){var c=this;void 0===b&&(b={});var f=m.getWindowHandleInformation(),e=g.default.UUID(),f=[{url:u.getSpinnerPath(),name:"provider",
features:m.hidden(!1,f)}],f=new d.default(this.options,f);f.postOpen=function(){c.onResultPageOpen(a,b,e)};f=new k.default(f);f.setWindowNamePrefix(e);f.start(!1)},b.prototype.onResultPageOpen=function(a,b,c){void 0===b&&(b={});void 0===c&&(c="");var d=u.forMultiProviderWindow(a,b);if(d){var f=g.default.UUID();t.updateHandleName(window,f,1);c+="provider";var e=t.open(u.getSpinnerPath(),c),m=this.options;if(!m.expectWindowReference)return void l.getLogger().warn("cmp2-workaround: ChangeWindowNameSequence not expecting window reference. Refactor",
{workaround:m,windowName:c,items:a,extra:b});if(!e)return void(t.getIgnoreWindowErrors()||l.getLogger().error("cmp2-workaround: ChangeWindowNameSequence unable to open window",{workaround:m,windowName:c,items:a,extra:b}));t.open("",f);this.createSequence(e,a,d,function(a,b){a=t.getWindowHandle(a);return!!a&&(a.location.href=b,!0)})}},b.prototype.createSequence=function(a,b,c,d){var e=this;if(1===b.length)return void d.apply(e,[a,c,-1,-1]);var g=new f.TimedQueue(this.options.delay);g.setOnError(function(){l.getLogger().error("cmp2-workaround: ChangeWindowNameSequence unable finish sequence",
{workaround:e.options,items:b,index:g.getIndex(),total:g.getTotal()})});for(var h=0,k=void 0;k=b[h];h++)g.add(d,e,[a,n.formatUrl(k.deepLink||"")]);g.add(d,e,[a,u.getSpinnerPath()]);g.add(function(a){if(a=t.getWindowHandle(a)){try{var c=m.getWindowHandleInformation(window);t.moveAccordingFeatures(a,m.tiled(0,1,c))}catch(A){l.getLogger().error("cmp2-workaround: ChangeWindowNameSequence unable to change position",{workaround:e.options,items:b,index:g.getIndex(),total:g.getTotal()},A)}return!0}return!1},
e,[a]);g.add(d,e,[a,c,-1]);g.run()},b.prototype.onFormClick=function(a,b,c){a=m.getWindowHandleInformation();a=[{url:u.getSpinnerPath(),name:"provider",features:m.hidden(!1,a)}];var f=g.default.UUID();t.updateHandleName(window,f,1);a=new d.default(this.options,a);a.postOpen=function(a,b){t.open("",f);c(a,b)};(new k.default(a)).start(!0)},b}(e.default);b.ChangeWindowNameSequence=a;b.default=a},function(e,b,a){Object.defineProperty(b,"__esModule",{value:!0});e=function(){function a(a){void 0===a&&(a=
3E3);this._index=0;this._defaultDelay=a;this._queue=[]}return a.prototype.add=function(a,b,e,g){void 0===b&&(b=this);void 0===e&&(e=[]);void 0===g&&(g=this._defaultDelay);this._queue.push({fn:a,caller:b,delay:g,args:e})},a.prototype.run=function(a){void 0===a&&(a=0);this._index=a;this.next()},a.prototype.next=function(){var a=this,b=this._index++,e=this._queue[b],b=this._queue[this.getIndex()];if(e){var e=e.fn.apply(e.caller,e.args),g="boolean"!=typeof e||e;!1===e&&this.onError&&this.onError();b&&
g&&setTimeout(function(){a.next()},b.delay)}},a.prototype.setOnError=function(a){this.onError=a},a.prototype.reset=function(){this._index=0},a.prototype.getDefaultDelay=function(){return this._defaultDelay},a.prototype.getIndex=function(){return this._index},a.prototype.getTotal=function(){return this._queue.length},a.prototype.cleanUp=function(){this._index=0;this._queue=[]},a}();b.TimedQueue=e},function(e,b,a){Object.defineProperty(b,"__esModule",{value:!0});var h=a(0),f=a(26);e=a(2);var l=a(1),
k=a(6),g=a(5),d=a(4),c=a(3).default(),p=d.default();a=function(a){function b(b){var c=a.call(this,b)||this;return c.submitEvent=!1,c.opened={},f.addEvent(window,"unload",function(){c.closeAllOpened()}),c}return h.__extends(b,a),b.prototype.showRPCompareAll=function(){return!1},b.prototype.onItemChange=function(a,b,c){var d=this;c.checked?this._openAndFocus([c],function(a){(a=p.getWindowHandle(a[0]))&&(d.opened[c.code]=a);d.submitEvent=!1}):this.close(c.code,this.opened[c.code]?this.opened[c.code]:
null)},b.prototype.onFormClick=function(a,b,c){this._openAndFocus(b,c)},b.prototype._openAndFocus=function(a,b){var d=this,e=c.forSubmit(a,3),e=new g.default(this.options,e);e.postItemOpen=function(a,b,c){return d._windowFocus(c)};e.postOpen=function(c,e){d.submitEvent=!0;d.closeNotActive(a);b(c,e)};(new k.default(e)).start(!0)},b.prototype.closeAllOpened=function(){if(!this.submitEvent){var a=this.opened,b;for(b in a)a.hasOwnProperty(b)&&this.close(b,a[b])}},b.prototype.closeNotActive=function(a){for(var b=
0,c;c=a[b];b++)!c.checked&&this.opened[c.code]&&this.close(c.code,this.opened[c.code])},b.prototype.close=function(a,b){if(b){b=p.getWindowHandle(b);try{b?(b.close(),delete this.opened[a]):l.getLogger().warn("cmp2-workaround: unable to close handle handle is not exists",{workaround:this.options})}catch(u){l.getLogger().warn("cmp2-workaround: error in closing handle",{workaround:this.options})}}},b.prototype._windowFocus=function(a){var b=this;this.focusInterval&&clearInterval(this.focusInterval);
var c=0,d=setInterval(function(){try{var e=p.getWindowHandle(a);e&&(e.blur(),e.opener.focus());window.self.focus();window.focus();document.focus()}catch(r){l.getLogger().warn("cmp2-workaround: DocumentFocus - windowFocus",{workaround:b.options},r)}10<++c&&d&&clearInterval(d)},300);this.focusInterval=d},b}(e.default);b.DocumentFocus=a;b.default=a},function(e,b,a){Object.defineProperty(b,"__esModule",{value:!0});var h=a(0);e=a(2);var f=a(1),l=a(6),k=a(5),g=a(3).default();a=function(a){function b(){return null!==
a&&a.apply(this,arguments)||this}return h.__extends(b,a),b.prototype.onFormClick=function(a,b,c){var d=this;a=g.forSubmit(b);a=new k.default(this.options,a);a.postItemOpen=function(a,b,c){c&&!c.closed&&((a=c.open(g.getSpinnerPath()))?a.close():f.getLogger().warn("cmp2-workaround: HandleOpen unable to focus",{workaround:d.options}))};a.postOpen=function(a,b){return c(a,b)};(new l.default(a)).start(!0)},b}(e.default);b.HandleOpen=a;b.default=a},function(e,b,a){Object.defineProperty(b,"__esModule",{value:!0});
var h=a(0);e=a(2);var f=a(1),l=a(6),k=a(5),g=a(4);a=a(3);var d=g.default(),c=a.default();a=function(a){function b(){return null!==a&&a.apply(this,arguments)||this}return h.__extends(b,a),b.prototype.onFormClick=function(a,b,e){var g=this;a=c.forSubmit(b);a=new k.default(this.options,a);a.postOpen=function(a,b){var h=d.open(c.getSpinnerPath()),n=g.options;n.expectWindowReference?h?h.close():f.getLogger().warn("cmp2-workaround: RegularOpenCloseLast unable to focus",{workaround:n}):f.getLogger().warn("cmp2-workaround: RegularOpenCloseLast not expecting window reference. Refactor",
{workaround:n});e(a,b)};(new l.default(a)).start(!0)},b}(e.default);b.RegularOpenCloseLast=a;b.default=a},function(e,b,a){Object.defineProperty(b,"__esModule",{value:!0});var h=a(0);e=a(2);var f=a(1),l=a(6),k=a(5),g=a(4);a=a(3);var d=g.default(),c=a.default();a=function(a){function b(){return null!==a&&a.apply(this,arguments)||this}return h.__extends(b,a),b.prototype.onDirectClick=function(a,b){void 0===b&&(b={});a=[{url:c.forMultiProviderWindow(a,b),name:"_blank",features:{}}];a=new k.default(this.options,
a);(new l.default(a)).start(!1)},b.prototype.onResultPageOpen=function(a,b,e){void 0===b&&(b={});void 0===e&&(e="");if(b=c.forMultiProviderWindow(a,b)){var g=this.options,h=d.getWindowHandle(window.opener);if(g.windowLocationHref&&h&&h!==window)try{return g.locationTopHref&&h.top!==h.self?void(h.top.location.href=b):void(h.location.href=b)}catch(z){}h=d.open(b,e);!g.expectWindowReference||d.getIgnoreWindowErrors()||h||f.getLogger().info("cmp2-workaround: Swapper unable to open window",{workaround:g,
items:a,url:b,windowNamePrefix:e})}},b.prototype.navigateToResults=function(a,b,e){return(e=d.getFirstActiveHandle(e))?(e.location.href=a,this.options.method||(window.location.href=c.getSpinnerPath()),!0):(f.getLogger().error("cmp2-workaround: Swapper unable to navigate to RP",{workaround:this.options,items:b,url:a}),!1)},b.prototype.onFormClick=function(a,b,e){a=c.forBlank();d.updateHandleName(window,this.getWindowNamePrefix(),1);a=new k.default(this.options,a);a.postOpen=function(a,b){return e(a,
b)};(new l.default(a)).start(!0)},b}(e.default);b.Swapper=a;b.default=a},function(e,b,a){Object.defineProperty(b,"__esModule",{value:!0});var h=a(0);e=a(2);var f=a(1),l=a(6),k=a(8),g=a(5),d=a(4);a=a(3);var c=d.default(),p=a.default();a=function(a){function b(){return null!==a&&a.apply(this,arguments)||this}return h.__extends(b,a),b.prototype.navigateToResults=function(a,b,d){b=c.getActiveWindowHandles(d);var e=c.getLastActiveHandle(b);return e?(b.length!==d.length&&f.getLogger().warn("cmp2-workaround: SwapperMultipleWindows some windows are closed",
{workaround:this.options,activeWindowHandlesLength:b.length,windowHandlesLength:d.length}),c.updateHandleName(e,"k"+k.default.randomString(8),2),e.location.href=a,this.options.method||(window.location.href=p.getSpinnerPath()),!0):(f.getLogger().error("cmp2-workaround: SwapperMultipleWindows unable to found active window",{workaround:this.options}),!1)},b.prototype.onFormClick=function(a,b,e){b=p.forSubmit(b,4);var h=b.shift();if(!h)return f.getLogger().error('cmp2-workaround: SwapperMultipleWindows "firstItem" is undefined',
{workaround:this.options}),void e([],[]);a=this.getWindowNamePrefix();c.updateHandleName(window,d.getWindowName(a+h.name),1);b.push({url:p.getSpinnerPath(),name:"k"+k.default.randomString(8),features:{}});b=new g.default(this.options,b);b.postOpen=function(a,b){e(a,b)};b=new l.default(b);b.setWindowNamePrefix(a);b.start(!0)},b}(e.default);b.SwapperMultipleWindows=a;b.default=a},function(e,b,a){Object.defineProperty(b,"__esModule",{value:!0});var h=a(0);e=a(2);var f=a(1),l=a(6),k=a(5),g=a(4);a=a(3);
var d=g.default(),c=a.default();a=function(a){function b(){return null!==a&&a.apply(this,arguments)||this}return h.__extends(b,a),b.prototype.onDirectClick=function(a,b){void 0===b&&(b={});a=[{url:c.forMultiProviderWindow(a,b),name:"_blank",features:{}}];a=new k.default(this.options,a);(new l.default(a)).start(!1)},b.prototype.onResultPageOpen=function(a,b,e){void 0===b&&(b={});void 0===e&&(e="");if(b=c.forMultiProviderWindow(a,b)){var g=this.options,h=d.getWindowHandle(window.opener);if(g.windowLocationHref&&
h&&h!==window)try{return g.locationTopHref&&h.top!==h.self?void(h.top.location.href=b):void(h.location.href=b)}catch(z){}h=d.open(b,e);!g.expectWindowReference||d.getIgnoreWindowErrors()||h||f.getLogger().error("cmp2-workaround: SwapperNoSpinner unable to open window",{workaround:g,items:a,url:b,windowNamePrefix:e})}},b.prototype.navigateToResults=function(a,b,c){return!(!c||0===c.length)||(f.getLogger().warn("cmp2-workaround: SwapperNoSpinner navigateToResults using fallback. There is no window handles available.",
{workaround:this.options}),!1)},b.prototype.onFormClick=function(a,b,e){a=c.forBlank(a);d.updateHandleName(window,this.getWindowNamePrefix(),1);a=new k.default(this.options,a);a.postOpen=function(a,b){return e(a,b)};(new l.default(a)).start(!0)},b}(e.default);b.SwapperNoSpinner=a;b.default=a},function(e,b,a){Object.defineProperty(b,"__esModule",{value:!0});var h=a(0);e=a(2);var f=a(1),l=a(6),k=a(8),g=a(5),d=a(4);a=a(3);var c=d.default(),p=a.default();a=function(a){function b(){return null!==a&&a.apply(this,
arguments)||this}return h.__extends(b,a),b.prototype.navigateToResults=function(a,b,c){return!(!c||0===c.length)||(f.getLogger().warn("cmp2-workaround: SwapperMultipleWindowsNoSpinner navigateToResults using fallback. There is no window handles available.",{workaround:this.options}),!1)},b.prototype.onFormClick=function(a,b,e){var h=this,n=p.forSubmit(b,4),m=n.shift();if(!m)return f.getLogger().error('cmp2-workaround: SwapperMultipleWindowsNoSpinner "firstItem" is undefined',{workaround:this.options}),
void e([],[]);b=this.getWindowNamePrefix();c.updateHandleName(window,d.getWindowName(b+m.name),1);n.push({url:a,name:"k"+k.default.randomString(8),features:{}});n=new g.default(this.options,n);n.postOpen=function(b,d){var g=c.getActiveWindowHandles(b),l=c.getLastActiveHandle(g);g.length!==b.length&&f.getLogger().warn("cmp2-workaround: SwapperMultipleWindowsNoSpinner some windows are closed",{workaround:h.options,activeWindowHandlesLength:g.length,windowHandlesLength:b.length});l&&(c.updateHandleName(l,
"k"+k.default.randomString(8),2),l.location.href=a);e(b,d)};n=new l.default(n);n.setWindowNamePrefix(b);n.start(!0)},b}(e.default);b.SwapperMultipleWindowsNoSpinner=a;b.default=a},function(e,b,a){Object.defineProperty(b,"__esModule",{value:!0});var h,f=a(0);e=function(a){function b(){return null!==a&&a.apply(this,arguments)||this}return f.__extends(b,a),b.getInstance=function(){return h||(h=new this),h},b.prototype._getWindowStorage=function(){var a;try{a=window.sessionStorage}catch(d){}return a},
b}(a(29).StorageHelper);b.StorageSessionHelper=e},function(e,b,a){function h(a){window.removeEventListener("message",f,!1);q=a;window.addEventListener("message",f,!1)}function f(a){c.extractWindowOpenerRequest(a)&&(q||l.getLogger().error("cmp2-ui: Did not expect FD data to be empty"),a.source.postMessage(c.buildWindowOpenerResponse(q),"*"),q=void 0,window.removeEventListener("message",f,!1))}Object.defineProperty(b,"__esModule",{value:!0});var l=a(7),k=a(10),g=a(16),d=a(9),c=a(17),p=a(11);b.onItemMouseUp=
function(a,b){return l.getWorkaround().onItemMouseUp(a,b)};b.onItemMouseDown=function(a,b){return l.getWorkaround().onItemMouseDown(a,b)};b.onItemChange=function(a,b,c){return g.CompareToList.getInstance().updateCheckedItemState(a,c),l.getWorkaround().onItemChange(a,b,c)};b.onFormClick=function(a,b,e,f){var n=function(){f&&f()};if(!a.placement)return n(),void l.getLogger().error("cmp2-ui: placement information is missing in onFormClick method",a);var m=a.type,r=d.CompareToSettings.getInstance();if(!r.isSettings())return 0<
b.length&&l.getLogger().error("cmp2-ui: settings is missing in onFormClick method with items",a,b),void n();var q=r.getSettingsSync();if(!c.isEnabled(m,q)||c.excludeRequest(q,r.getClient(),a.placement))return void n();a.url=e;var m=g.CompareToList.getInstance().getImpressionRequestState(b),r={windowNamePrefix:l.getWorkaround().getWindowNamePrefix(),referer:q.uiReferer?window.location.href:""},w=k.WindowInfo.getStoreConfig(a,m,r);a=a.urlPrefix?a.urlPrefix:"";if(g.CompareToList.getInstance().isCheckedItem(b)){var t=
q.parentWindowOpener;t&&h(w.data);var x=a+e;return void l.getWorkaround().onFormClick(x,b,function(a){if(t)return void(l.getWorkaround().navigateToResults(x,b,a)||n());p.Ajax.getInstance().request(w,function(c){if(!c||!c.success)return l.getLogger().error("cmp2-ui: AJAX error on Store WindowInfo",c.errors),void n();l.getWorkaround().navigateToResults(x,b,a)||n()},function(a){l.getLogger().error("cmp2-ui: AJAX error on Store WindowInfo",a);n()},n)})}p.Ajax.getInstance().request(w,function(a){a&&a.success||
l.getLogger().error("cmp2-ui: AJAX error on Store WindowInfo",a.errors);n()},function(a){l.getLogger().error("cmp2-ui: AJAX error on Store WindowInfo",a);n()},n)};b.onFormButtonMouseDown=function(a){if(g.CompareToList.getInstance().isCheckedItem(a))return d.CompareToSettings.getInstance().isSettings()?void l.getWorkaround().onFormButtonMouseDown(a):void l.getLogger().error("cmp2-ui: settings are not set to execute form mouse down")};b.onFormButtonMouseUp=function(a){if(g.CompareToList.getInstance().isCheckedItem(a))return d.CompareToSettings.getInstance().isSettings()?
void l.getWorkaround().onFormButtonMouseUp(a):void l.getLogger().error("cmp2-ui: settings are not set to execute form mouse up")};var q=void 0},function(e,b,a){function h(a,b,c,d,e){var g=t.WindowInfo.getRetrieveConfig(d);m.Ajax.getInstance().request(g,function(h){if(!h||!h.success)return void q.getLogger().error("cmp2-ui: errors in Storage",h.errors,g);if((h=h.content||[],"object"==typeof h)&&h.constructor===Array&&0<h.length){var k=h[h.length-1];k&&f(a,c,b,k.items||[],k.other);var n=h.length;h.forEach(function(c,
f){l(a,b,f+1!==n,c.items,d,c,e)})}},function(a){q.getLogger().error("cmp2-ui: AJAX error on Retrieve WindowInfo V3",a,g)})}function f(a,b,c,d,e){d=a.getCompareToItemsFromImpressionState(d||[]);(void 0===b.workaround.updateHistory||b.workaround.updateHistory)&&a.isCheckedItem(d)&&c.pushHandleHistory(window,e.referer||"")}function l(a,b,c,d,e,f,g){var h=e.searchId||f&&f.searchId,l=k(e.type,f&&f.placement||e.placement,h,f&&f.url||e.url,d),p=t.List.getConfig(l);m.Ajax.getInstance().request(p,function(e){if(!e||
!e.success)return void q.getLogger().error("cmp2-ui: ResultPage error",p,e);var k=a.mapDeepLinkToItems(d||[],e.content||{});a:if(e=e.content||{},g)for(var m=0;m<k.length;m++){var r=k[m];if(r.visible&&r.checked&&(r=e[r.code])){g(r.name);break a}}b.setIgnoreWindowErrors(c);b.onResultPageOpen(k,n.getMultiProviderWindowExtra(l,"fd",h),f.other.windowNamePrefix);b.setIgnoreWindowErrors(!1)},function(a){q.getLogger().error("cmp2-ui: AJAX error on onResultPage",a,p)})}function k(a,b,d,e,f){return{type:a,
placement:b,searchId:d,url:e,compareTos:c.CompareToList.getInstance().getCompareToItemsFromImpressionState(f||[]),registerImpression:!0,includeCloseDeepLinks:!1,deepLink:!0,list:!1}}function g(a){(a=n.extractWindowOpenerResponse(a))&&(window.removeEventListener("message",g,!1),v(a.windowInfo),v=u)}function d(a,b,c,d,e){window.removeEventListener("message",g,!1);var f=setTimeout(function(){window.removeEventListener("message",g,!1);e()},c);v=function(b){return clearTimeout(f),b?a.type!==b.type?void q.getLogger().error("cmp2-ui: window opener returned an unexpected vertical",
b,a):void d(b):void q.getLogger().error("cmp2-ui: Received incomplete information from the parent")};window.addEventListener("message",g,!1);b.postMessage(n.buildWindowOpenerRequest(),"*")}Object.defineProperty(b,"__esModule",{value:!0});var c=a(16),p=a(9),q=a(7),n=a(17),t=a(10),m=a(11);b.onDirectMouseUp=function(a,b){if(!p.CompareToSettings.getInstance().isSettings())return void q.getLogger().error("cmp2-ui: settings are not set to execute direct mouse up");q.getWorkaround().onDirectMouseUp(c.CompareToList.getInstance().getVisibleItem(a),
n.getMultiProviderWindowExtra(b,"rp"))};b.onDirectMouseDown=function(a,b){if(!p.CompareToSettings.getInstance().isSettings())return void q.getLogger().error("cmp2-ui: settings are not set to execute direct mouse down");q.getWorkaround().onDirectMouseDown(c.CompareToList.getInstance().getVisibleItem(a),n.getMultiProviderWindowExtra(b,"rp"))};b.onDirectClick=function(a,b){if(!p.CompareToSettings.getInstance().isSettings())return void q.getLogger().error("cmp2-ui: settings are not set to execute direct click");
q.getWorkaround().onDirectClick(c.CompareToList.getInstance().getVisibleItem(a),n.getMultiProviderWindowExtra(b,"rp"))};b.onResultPage=function(a,b){var e=p.CompareToSettings.getInstance(),g=e.getSettingsSync();if(!g)return void q.getLogger().error("cmp2-ui: errors config is not defined can't make request on ResultPage");if(n.isEnabled(a.type,g)&&!n.excludeRequest(g,e.getClient(),a.placement)){var k=c.CompareToList.getInstance(),m=q.getWorkaround();return(e=window.opener)&&e===window&&(g.logSameWindowOpener&&
q.getLogger().warn("cmp2-ui: window.opener is the same as window"),g.excludeSameWindowOpener)?void h(k,m,g,a,b):g.childWindowOpener&&e?void d(a,e,g.childWindowOpenerWait||1E3,function(c){var d=c.items||[];f(k,g,m,d,c.other);l(k,m,!1,d,a,c,b)},function(){h(k,m,g,a,b)}):void h(k,m,g,a,b)}};b.registerImpression=function(a,b){var c=p.CompareToSettings.getInstance();c.getSettings(function(d){if(n.isEnabled(a.type,d)&&!n.excludeRequest(d,c.getClient(),a.placement)){d=k(a.type,a.placement,a.searchId,a.url,
b);var e=t.List.getConfig(d);m.Ajax.getInstance().request(e,function(a){a&&a.success||q.getLogger().error("cmp2-ui: Error on registerImpression",e,a)},function(a){q.getLogger().error("cmp2-ui: AJAX error on registerImpression",a,e)})}})};var u=function(a){q.getLogger().error("cmp2-ui: noop was called")},v=u}]);(function(f,g){f.createComponentClass("common.compareto.v3.CompareToModuleSettings",{options:{config:null,prefix:null,addType:!1,advanceError:!1},moduleLoaded:!1,ajaxCall:function(a,b,c){var e=this.options,d=g.extend(!0,{},a.params,a.data);"GET"!==a.method&&(d=JSON.stringify(d));g.ajax({url:a.url,method:a.method,dataType:"json",contentType:"application/json; charset\x3dutf-8",data:d,headers:a.headers,success:function(a){b&&b(a)},error:function(a,b,d){c&&(e.advanceError?c({jqXHR:a,status:a.status,
responseText:a.responseText,textStatus:b,errorThrown:d}):c(a))}})},init:function(){var a=this,b=a.options,c=b.config,e=b.prefix,d=a.log;f.question.answer("cmp2.module.loaded",function(){return a.moduleLoaded});f.question.answer("cmp2.module.config",function(){return c});c?a.setConfig(c):(e={method:"GET",url:e+"compareTo/config",success:function(b){b&&b.content?a.setConfig(b.content):(d.error("cmp2-module: unexpected response in config",b),a.setConfig(null))},error:function(b){d.error("cmp2-module: error loading config",
b);a.setConfig(null)}},b.addType&&(e.dataType="json",e.contentType="application/json;charset\x3dutf-8"),g.ajax(e))},setConfig:function(a){var b=this,c=b.log;f.events.publish("cmp2.module.config",a);window["@r9/cmp2-ui"].setModuleConfig({ajax:function(a,d,c){b.ajaxCall(a,d,c)},logger:c,settings:a,client:"desktop"});b.moduleLoaded=!0;f.events.publish("cmp2.module.loaded",!0)},addEventHandlers:function(){}})})(window.R9,window.jQuery||window.jq);(function(d,g){d.createComponentClass("common.compareto.v3.Items",{options:{navigateToResults:!1,placement:{},hiddenClass:"",visibleClass:"",hiddenControls:"",visibleControls:"",itemChecked:"",defaultStyle:"",itemUnChecked:"",useOnlyVisible:!1,e2eTesting:!1},lastRequest:null,lastRequestData:null,lastResponse:null,itemsInProgress:!1,cleanupTimer:null,init:function(){this.cmp2ItemsElement=this.getChildElement("checkbox-row");this.cmp2ModuleLoaded=!0===d.question.ask("cmp2.module.loaded")},shouldUpdate:function(a){return-1<
this.id().indexOf(a.id)},addEventHandlers:function(){var a=this;a.subscribe("cmp2.module.loaded",function(b){a.cmp2ModuleLoaded=b;a.lastRequestData&&a.cmp2ModuleLoaded&&(d.events.publish("cmp2.getItems",a.lastRequestData),a.lastRequestData=null)});a.subscribe("cmp2.getItems",function(b){a.shouldUpdate(b)&&(a.cmp2ModuleLoaded?(a.cleanupTimer&&clearTimeout(a.cleanupTimer),b=a.sanitizeFormData(b),a.lastRequest===g.param(b)?a.itemsInProgress||a.printResponse(a.lastResponse):(a.lastRequest=g.param(b),
a.lastResponse=[],a.itemsInProgress=!0,window["@r9/cmp2-ui"].getCompareTo(b,function(b){a.printResponse(b);a.lastResponse=b;a.itemsInProgress=!1},function(){a.lastResponse=[];a.itemsInProgress=!1;a.printResponse([])}))):a.lastRequestData=b)});a.subscribe("cmp2.cleanUp",function(b){a.shouldUpdate(b)&&(a.cleanupTimer=setTimeout(function(){a.printResponse([])},50))});a.subscribe("cmp2.submit",function(b){if(a.shouldUpdate(b)){var c=a.items||[],d=b.url&&b.url.startsWith("http")?b.url:"/"+b.url,h=a.sanitizeFormData(b);
a.isVisible()||(c=[]);a.onFormSubmit(b,h,c,d)}});var c=a.id(),c=c.substr(0,c.lastIndexOf("-"));g("#"+c+" button[type\x3dsubmit]").on("mousedown",function(){var b=a.items||[];a.isVisible()||(b=[]);window["@r9/cmp2-ui"].onFormButtonMouseDown(b)});g("#"+c+" button[type\x3dsubmit]").on("mouseup",function(){var b=a.items||[];a.isVisible()||(b=[]);window["@r9/cmp2-ui"].onFormButtonMouseUp(b)});a.getChildElement("allLink").on("click",function(b){b.preventDefault();a.toggleCheckedItems(!0)});a.getChildElement("noneLink").on("click",
function(b){b.preventDefault();a.toggleCheckedItems(!1)});a.subscribe("cmp2.uncheckAll",function(){a.toggleCheckedItems(!1)});a.subscribe("cmp2.checkAll",function(){a.toggleCheckedItems(!0)});a.subscribe("cmp2.update.component.options",function(b){if(b||b.navigateToResults)a.options.navigateToResults=b.navigateToResults})},isVisible:function(){var a=this.element,c=this.elementNode;return this.options.useOnlyVisible?a.length&&!!(c.offsetWidth||c.offsetHeight||c.getClientRects().length):!0},onFormSubmit:function(a,
c,b,e){var f=this,h=f.options.navigateToResults;window["@r9/cmp2-ui"].onFormClick(c,b||[],e||"",function(){h?e&&e.startsWith("http")?f.redirectPage(e):f.redirectPage("/"+e.replace(/^[/]*/g,"")):d.events.publish("searchform.submit",a)})},redirectPage:function(a){window.location.href=a},toggleCheckedItems:function(a){(!a||this.items&&window["@r9/cmp2-ui"].showRPCompareAll(this.items))&&this.cmp2ItemsElement.find(".item").each(function(){var c=g(this);"true"===c.attr("aria-checked")!==a&&c.trigger("click")})},
renderItemTemplate:function(a){var c=this.options;return g("\x3cspan /\x3e").addClass(c.defaultStyle).addClass("item").addClass(a.checked?c.itemChecked:c.itemUnChecked).attr("role","checkbox").attr("aria-checked",a.checked).attr("data-code",a.code).attr("tabindex","0").text(a.name)},printResponse:function(a){var c=this.options,b=0;d.dom.swapClasses(this.element,c.visibleClass,c.hiddenClass);d.events.publish("cmp2.hidden",{id:this.id(),visible:!1});this.cmp2ItemsElement.empty();if(a&&0<a.length){for(var e=
0,f=a.length,h;e<f;e++)(h=a[e])&&h.visible&&(b=this.renderItemTemplate(h),this.cmp2ItemsElement.append(b),this.updateElementState(b,h),b=1);b&&(this.updateControlsState(a),d.events.publish("cmp2.shown",{id:this.id(),visible:!0}),d.dom.swapClasses(this.element,c.hiddenClass,c.visibleClass))}this.items=a;d.events.publish("cmp2.rendering.finished",{id:this.id(),items:a})},updateControlsState:function(a){this.options.e2eTesting?this.getChildElement("controls").addClass(this.options.visibleControls):d.dom.swapClassesToggle(this.getChildElement("controls"),
this.options.visibleControls,this.options.hiddenControls,window["@r9/cmp2-ui"].showRPCompareAll(a))},updateElementState:function(a,c){var b=this,e=b.options,f=g(a);f.on("click",function(){var a=g.extend(!0,{},c);c.checked=!c.checked;d.dom.swapClassesToggle(f,e.itemChecked,e.itemUnChecked,c.checked);f.attr("aria-checked",c.checked);window["@r9/cmp2-ui"].onItemChange(b.items,a,c)}).on("mousedown",function(){window["@r9/cmp2-ui"].onItemMouseDown(b.items,c)}).on("mouseup",function(){window["@r9/cmp2-ui"].onItemMouseUp(b.items,
c)}).on("keydown",function(a){return a.keyCode===d.globals.keyCodes.SPACE||a.keyCode===d.globals.keyCodes.RETURN?(f.trigger("click"),!1):!0})},sanitizeFormData:function(a){var c;switch(a.vertical){case "flights":c="F";break;case "hotels":c="H";break;case "cars":c="C";break;case "packages":c="P";break;case "cruises":c="R";break;case "trains":c="T";break;default:c=a.vertical}return{type:c,placement:this.options.placement,url:a.url,requestInformation:null}}})})(window.R9,window.jQuery||window.jq);(function(e,g){e.publish("hotels.search.HotelSearchFormUrls",{generateUrl:function(a,c){var b=(a.urlPrefix||"hotels")+"/",d=a.location,f="-c";this._isEmpty(a.address)||(d=a.address,-1===a.address.indexOf(a.location)&&(d+=","+a.location),f="-a");b+=this._encodeLocation(d,a.useFullSearchUrl);this._isEmpty(a.frid)?this._isEmpty(a.srid)?this._isEmpty(a.rid)?this._isEmpty(a.cid)?!this._isEmpty(a.placeId)&&e.config.getBoolean("ui.hotels.searchUrlPlace.enabled",!1)?b+="-p"+a.placeId:this._isEmpty(a.ctid)||
(b+=f+a.ctid):b+="-u"+a.cid:b+="-r"+a.rid:b+="-s"+a.srid:b+="-e"+a.frid;this._isEmpty(a.hid)?this._isEmpty(a.lmid)||"custom"===a.lmid?this._isEmpty(a.nhid)||(b+="-n"+a.nhid):b+="-l"+a.lmid:(b+="-h"+a.hid,a.goToHotelDetailsPage&&(a.smartyItemChanged||a.fromRatesTable)&&(b+="-details"));this._isEmpty(a.amenity)||(b+="-f"+a.amenity);!this._isEmpty(a.minStars)&&0<=a.minStars&&5>=a.minStars&&(b+="-"+a.minStars+"stars");a.starsAndAbove&&0<a.starsAndAbove&&(b+="-"+a.starsAndAbove+"starsAA");a.minGuestRating&&
0<a.minGuestRating&&(b+="-mgRating"+a.minGuestRating);this._isEmpty(a.checkin)||this._isEmpty(a.checkout)||(b+="/"+a.checkin+"/"+a.checkout);this._isEmpty(a.adults)||(0<a.adults&&(b+="/"+a.adults+"adults"),!this._isEmpty(a.children)&&0<a.children&&(b+="/"+a.children+"children",a.childAges&&(b+="-"+a.childAges)));a.rooms&&1<a.rooms&&(b+="/"+a.rooms+"rooms");a.lmName&&a.lmid&&"custom"===a.lmid&&(b+="/at-"+this._cleanString(a.lmName));if(a.placeId||a.placeName||a.stars)if(b+="?",a.placeId&&(b+="placeId\x3d"+
a.placeId),a.placeName&&(a.placeId&&(b+="\x26"),b+="placeName\x3d"+a.placeName),a.stars){if(a.placeId||a.placeName)b+="\x26";b+="stars\x3d"+a.stars}b=this.appendFilterStateParam(b,c);"map"===a.view&&(b+=";map");return b},appendFilterStateParam:function(a,c){if(!c||g.isEmptyObject(c)||!e.config.getBoolean("ui.hotels.searchUrlFS.enabled",!0))return a;var b=[];Object.keys(c).each(function(a){a&&"string"===typeof c[a]&&""!==c[a]&&b.push(a+"\x3d"+c[a])});if(b.length){var d=-1<a.indexOf("\x26")?"\x26":
"?";return a+d+"fs\x3d"+b.join(";")}return a},_cleanString:function(a){return a.replace(/, /g,",").replace(/ - /g,",").replace(/ /g,"-").replace(/[^A-Za-z0-9_\-,.]/g,"")},_isEmpty:function(a){return a?"string"===typeof a&&(""===a.trim()||0>=parseInt(a)):!0},_encodeLocation:function(a,c){a=this._mapAccentedChars((a+"").replace(/, /g,",").replace(/ - /g,",").replace(/ /g,"-"));c||(a=a.replace(/[^A-Za-z0-9_\-,.]/g,""));return a},_mapAccentedChars:function(a){return e.Common.RemoveAccents.removeAccentedChars(a)}})})(R9,
jQuery);(function(g,f,h){g.publish("common.maps.Geocoding",h.extend({_channel:null,_context:null,loggingBase:"/common/maps/Geocoding/",_data:{location:null,postalCode:null,address:null,addressNickname:null,lat:null,lng:null,isAddress:!1},constructor:function(a,b){this._channel=a;this._context="string"===typeof b?b:null},initGeocoder:function(a){var b=f.Deferred(),c;c="initialize/"+(g.Maps.Google.isLoaded()?"already_loaded":"api_request_made");g.Maps.Google.load(function(){b.resolve(new google.maps.Geocoder)},
this._channel);this.logAnalytics(c,"undefined"!==typeof a?a:null);return b.promise()},clear:function(){for(var a in this._data)this._data.hasOwnProperty(a)&&(this._data[a]=null)},getLastResult:function(){return this._data},makeRequest:function(a,b){var c=this,e=f.Deferred();this.initGeocoder().then(function(d){c.logAnalytics("findAddress/api_request_started",b);d.geocode({address:a},function(a,d){d===google.maps.GeocoderStatus.OK?(c.logAnalytics("findAddress/api_request_successful",b),c.formatGeometry(a),
e.resolve(c.getLastResult(),b)):(c.logAnalytics("findAddress/api_request_failed",b,"string"===typeof d?{status:"/"+d}:null),e.reject(d))})});return e.promise()},findAddress:function(a,b,c){var e=this,d=f.Deferred();this.makeRequest(a).then(function(a){e.parseResult(a,b,c)}).then(function(){d.resolve(e.getLastResult())});return d.promise()},parseResult:function(a,b,c){this._data.isAddress=!1;var e=this.getValidatedPlace(a,b);if(e){this._data.location=e.formatted_address;b=this.getAddressFragments(e,
c);this._data.location="US"===b.country||"CA"===b.country?b.city+","+b.state+","+b.country:b.city+","+b.country;var e=e.formatted_address.split(", "),d=e.length;b="US"===b.country||"CA"===b.country?3:2;d<b?this.logAnalytics("parseResult/location_length_too_short",c):(this._data.isAddress=!0,d>=b+1&&(this._data.address=e[d-b-1]),d>=b+2&&(this._data.addressNickname=e[0]),this.formatGeometry(a),this.logAnalytics("parseResult/success",c))}else this.logAnalytics("parseResult/invalid_result",c)},getValidatedPlace:function(a,
b){a=f.isArray(a)?a[0]:a||{};var c=["street_address","premise","route"];if(!a||!a.formatted_address||b&&0<=c.indexOf(a.types[0]))a=null;return a},getAddressFragments:function(a,b){for(var c={city:null,state:null,country:null},e=0;e<a.address_components.length;e++)for(var d=a.address_components[e],f=0;f<d.types.length;f++){var g=d.types[f];if("country"===g){c.country="US"===d.short_name||"UK"===d.short_name?d.short_name:d.long_name;break}else if("administrative_area_level_1"===g){c.state=d.short_name;
break}else if("locality"===g){c.city=d.long_name;break}else if("postal_code"===g){this._data.postalCode=d.long_name;break}}return"undefined"===typeof c.country||"undefined"===typeof c.city?(this.logAnalytics("parseResult/invalid_country_or_city",b),null):c},formatGeometry:function(a){a=f.isArray(a)?a[0]:a||{};var b={};if(a.geometry&&a.geometry.location){b.lat=a.geometry.location.lng();b.lng=a.geometry.location.lat();var c=a.geometry.bounds||a.geometry.viewport||null;if(c){var e=c.getNorthEast(),c=
c.getSouthWest();b.bounds={neBounds:{lat:e.lat(),lng:e.lng()},swBounds:{lat:c.lat(),lng:c.lng()}}}}this._data=f.extend({},a,b)},logAnalytics:function(a,b,c){a={category:this.loggingBase+a,channel:this._channel,parentComponent:this._context};"undefined"!==typeof b&&(a.callerComponent=b);"object"===typeof c&&(a=f.extend(a,c));g.Analytics.api.trackEvent(a)}}))})(R9,jQuery,base2.Base);(function(c,d){var f=c.config.getBoolean("ui.horizon.searchForm.includePageTypeCookie",!0);c.createComponentClass("base.search.SearchForm",{vertical:null,searchForm:null,submitButton:null,errorContainer:null,searchFormFilterState:null,animationInterval:null,isFormChanged:!1,isScrollUserAction:!1,timers:{selectAll:null},sticky:!1,stickyAfterElement:null,options:{loadCmp2WhenVisible:!1,suppressCmp2s:!1,cleanUpInputFieldOnFocus:!1,useCmp2Submit:!0,navigateToResults:!1,pageOrigin:"",useHistory:!0,inlineErrorEnabled:!1,
sync:!0,forceSearchFormSubmit:!1,loggingPrefix:"",isSeo:!1,isCmp2Tooltip:!1,autofocusViaJs:!1,multiSearcherEnabled:!1,useSelectWidget:!1,useDialogQuestions:!1,displayDateFormat:"MMM D",enableSmartyRemoteHide:!1,hasSubscriptionPanel:!1,formChangedClass:"formChangedState",singlePulseAnimation:!1,showTopDestinations:!1,continents:[],smartyInnerScrollEnabled:!1,smartyUIUpdateEnabled:!1,searchFormFilterState:null,useStyleJamInlineSearchButton:!1,useMultipleSubmitIds:!1,scrollLoggingEnabled:!1,isSEM:!1,
semZoomAuditParams:null,isStickySearchFormEnabled:!1,stickyAfterCssSelector:null,stickySearchFormAdditionalPadding:!1,searchInputContainerId:null,mcFlySearch:!1,cmp2LoadOnChangesOnly:!1},scrollSearchToggleHeight:200,didUpdateHistory:!1,localHistory:null,isSubmitted:!1,consentGranted:!1,init:function(a){this.searchForm=this.element.find(".searchform");this.submitButton=this.options.useMultipleSubmitIds?this.getChildElements("submit,submit-multi"):this.getChildElement("submit");this.errorContainer=
this.getChildElement("error");this.searchFormFilterState=this.options.searchFormFilterState;var b=this;this.answer(this.id(),function(){return b.serialize()});this.answer("base.search.SearchForm.type."+b.id(),function(){return b._formType()});b.element.is(":visible")&&this.answer("base.search.SearchForm.id",function(){return b.id()});this.options.mcFlySearch&&(this.answer("searchForm.searchUrl",function(){return b.buildSearchURL(b.serialize())}),this.answer("searchForm.valid",function(){return b.isValid()}))},
addEventHandlers:function(){var a=this;this.bindLocalHistory();this.bindSelectTextOnFocus();this.loadFromStorage();this.options.useStyleJamInlineSearchButton&&(this.registerEvent("click",this.submitButton,function(){a.searchForm.submit();return!0}),this.registerEvent("keyup",this.submitButton,function(b){0<=[c.globals.keyCodes.RETURN,c.globals.keyCodes.SPACE].indexOf(b.keyCode)&&a.searchForm.submit()}));this.subscribe("submit.search.form",this.submitSearchForm.bind(this));this.subscribe("submit.search.form.force",
{id:this.id()},function(){a.isFormChanged=!0;a.submitSearchForm()});this.searchForm.on("submit",function(b){b.preventDefault();a.logUserImpressionForScrollSearchBanner();a.trackSubmitEvent();return a.onSubmit(b)});c.events.subscribe("search.form.clear",d.proxy(this.onClear,this));c.events.subscribe("common.compareto.focusout",{id:this.id()+"-compareTo"},function(){a.submitButton.focus()});c.events.subscribe("search.form.button.enable",function(){a.enableSearchButton()});this.setUpSEMStickyListener()},
enableSearchButton:function(){this.submitButton.prop("disabled",!1).attr("aria-disabled",!1);this.isSubmitted=!1},disableSearchButton:function(){this.submitButton.prop("disabled",!0).attr("aria-disabled",!0);this.isSubmitted=!0},inlineComponentsReady:function(){c.events.publish("searchform.initialized",this);this.loadCompareToItems();if(this.options.autofocusViaJs){var a=this;setTimeout(function(){a.autofocus()},10)}},loadCompareToItems:function(){var a=this;if(!c.config.getBoolean("ui.cmp2.searchform.defer",
!0)||!this.deferCmp2Id&&this.deferCmp2Init)if(this.isEnoughInformationForCompareToRequest()){var b=this.serialize()||{};b.relativeUrl=!0;var e=this.buildSearchURL(b);b.id=this.id();b.url=e;b.vertical=this.vertical;c.events.publish("cmp2.getItems",b);c.events.publish("search.form.clear",this.id())}else c.events.publish("cmp2.cleanUp",{id:this.id()});else this.deferCmp2Init=1,this.deferCmp2Id&&clearTimeout(this.deferCmp2Id),this.deferCmp2Id=setTimeout(function(){clearTimeout(a.deferCmp2Id);a.deferCmp2Id=
null;a.loadCompareToItems()},100)},shouldUpdate:function(a){a=a||{};return!!a.forceUpdate||this.options.sync||this.id()===a.id},updateLogging:function(a){a.loggingPrefix&&a.loggingPrefix!==this.options.loggingPrefix&&(this.options.loggingPrefix=a.loggingPrefix)},getCompareToFormData:function(){return{}},isEnoughInformationForCompareToRequest:function(){return!1},serialize:function(){return{tab:this.vertical,pageOrigin:this.options.pageOrigin,src:"",searchingAgain:"",c2s:"",po:"",personality:"",provider:"-1",
searchFormFilterState:this.getSearchFormFilterState(),pageType:f?this.getPageType():null}},load:function(a){},buildSearchURL:function(a){},onClear:function(){this.clearErrors()},clearErrors:function(){this.errorContainer.html("")},validate:function(){return!1},isValid:function(){var a=this.validate();return!a||!a.length},showError:function(a){if(this.options.inlineErrorEnabled)if(0<this.errorContainer.length)this.errorContainer.html(a),c.events.publish("search.submit.error",this.errorContainer);else throw"Missing container with id: "+
this.id("error");else c.events.publish("error.alert",{messages:a})},onSubmit:function(a,b){if(this.isSubmitted)return!1;this.clearErrors();this.disableSearchButton();if((a=this.validate())&&a.length)return this.enableSearchButton(),this.showError(a),!1;this.saveToStorage(!0);c.storage.set("search_submit_pageId",c.globals.analytics.pageId);b=b||this.serialize()||{};b.vertical=this.vertical;b.url=this._generate(b);b.id=this.id();this.triggerConsentGranted();this.publishSubmitEvent(b);c.config.getBoolean("ui.horizon.common.results.tooltip-reset.enabled",
!0)&&c.events.publish("resultItem.alert.tooltip.reset");c.storage.remove("p13n.results.saveToTrips.tripId");var e=this;setTimeout(function(){e.enableSearchButton()},2500);return!1},triggerConsentGranted:function(){c.config.getBoolean("ui.gtm.useConsent",!1)&&c.config.getBoolean("ui.consent.submit.publish",!0)&&!this.consentGranted&&(this.consentGranted=!0,c.events.publish("consent.granted"))},notValidSubscription:function(){return!0===this.options.hasSubscriptionPanel?c.question.ask("email.subscription.validate."+
this.id("subscription-panel")):!1},submitSubscription:function(){return!0===this.options.hasSubscriptionPanel?c.question.ask("email.subscription.submit."+this.id("subscription-panel")):!0},publishSubmitEvent:function(a){var b;b=this.options.multiSearcherEnabled?"multilocale.search.submit":this.options.useCmp2Submit&&!this.options.forceSearchFormSubmit?"cmp2.submit":"searchform.submit";a.navigateToResults=this.options.navigateToResults;c.events.publish(b,a)},bindSelectTextOnFocus:function(){var a=
this;this.searchForm.find("input.selectTextOnFocus").on("focus.selectAll",function(){a.selectInput(this)});var b=this.searchForm.find("input[autofocus]");b.length&&a.selectInput(b.get(0))},selectInput:function(a){if(!d(a).data("disabledSelect")){var b=this;clearTimeout(this.timers.selectAll);this.timers.selectAll=window.setTimeout(function(){a.select();b.options.cleanUpInputFieldOnFocus&&(a.value="")},50)}},bindLocalHistory:function(){var a=this;this.didUpdateHistory=!1;this.localHistory=new c.common.utils.history.UserHistory({tab:a.vertical,
persistLocalStorage:!0,onSave:function(){a.didUpdateHistory||a.saveToStorage(!1)}})},trackSubmitEvent:function(){c.Analytics.api.trackEvent("%s/searchform/submit".format(this.options.loggingPrefix))},getCookieData:function(){var a=this.serialize(),b={page_origin:a.pageOrigin,src:a.src,searchingagain:a.searchingAgain,c2s:a.c2s,po:a.po,personality:a.personality,provider:a.provider};f&&(b.pageType=a.pageType);return b},getPageType:function(){var a;a=c.question.ask("SearchPage.view");a||(a=(a=c.globals.analytics&&
c.globals.analytics.pageId)?"results"===a?"RP":"FD":data.pageOrigin.contains(".FD")?"FD":"RP");return a},getSearchFormFilterState:function(){return d.extend({},this.searchFormFilterState)},_formType:function(){return""},_generate:function(a){a=this.buildSearchURL(a);this.setCookies(a);if(this.options.isSEM&&this.options.semZoomAuditParams){var b=this.options.semZoomAuditParams,e;for(e in b)a=c.Common.Utils.URL.addQueryParameter(a,e,b[e])}this.options.isSEM&&(a=c.Common.Utils.URL.addQueryParameter(a,
"isSEM","true"));return a},setCookies:function(a){var b=this.getCookieData();b.id=this.id();c.events.publish("update.cookies",b);document.cookie=this._generateCookie(a,this.vertical,b)},_generateCookie:function(a,b,c){if(""!==a){b="/"+b+"/";var e=encodeURIComponent(a.substring(a.indexOf(b)+b.length));0>a.indexOf(b)&&(e=encodeURIComponent(a.substring(a.indexOf("/",1)+1)));a="hiddenParams"+e;b=new Date;e=b.getTime();b.setTime(e+3E4);c=encodeURIComponent(decodeURIComponent(d.param(c)));return a+"\x3d"+
c+"; expires\x3d"+b.toGMTString()+"; path\x3d/"}},getStorageProps:function(){return null},getStorageExceptions:function(){return null},loadFromStorage:function(){this.loadingHistory=!0;this.options.useHistory&&this.localHistory.wasLastUsedPage&&this.loadFromHistory(this.localHistory.getRecentHistory());this.loadingHistory=!1},loadFromHistory:function(a){this.load(d.extend({},{id:this.id()},a))},saveToStorage:function(a){this.didUpdateHistory=!0;if(a){a=this.serialize()||{};var b=this.getStorageProps()||
{},c=this.getStorageExceptions()||[],g={};b||(b=d.map(a,function(a,b){return b}));c&&d.map(c,function(a){a=d.inArray(a,b);0<=a&&b.splice(a,1)});for(c=0;c<b.length;c++)if(a.hasOwnProperty(b[c])){var h=b[c],f=a[h];this.localHistory.set(h,f);g[h]=f}d.isEmptyObject(g)||this.localHistory.pushSearchHistory(g)}},autofocus:function(){return null},isNull:function(a){return null===a},isUndefined:function(a){return"undefined"===typeof a},isEmpty:function(a){return this.isNull(a)||this.isUndefined(a)||"string"===
typeof a&&""===a.trim()},checkFormChanges:function(){return null},destroy:function(){this.options.scrollLoggingEnabled&&d(window).off("scroll.logListener");null!==this.animationInterval&&clearInterval(this.animationInterval);this.base()},setFormChangedState:function(a){a=this.checkFormChanges()?a:!1;c.events.publish("searchForm.changed",a&&this.searchForm.is(":visible"));this._trackEvent("formChanged","stateChange",a);(this.isFormChanged=a)&&this.enableScrollLoggingEvent();if(this.options.useStyleJamInlineSearchButton)return this.setStyleJamButtonActivation(a,
this.id("submit"));c.events.publish("button.formChangedState",{changed:a});this.element.toggleClass(this.options.formChangedClass,a);this.options.singlePulseAnimation&&this.submitButton.toggleClass("pulse",a)},setStyleJamButtonActivation:function(a,b){c.events.publish(a?"button.activate":"button.deactivate",{id:b});this.options.singlePulseAnimation&&c.events.publish(a?"button.pulse":"button.pulse.reset",{id:b})},checkAndSetDropdownSmartyInnerScrollOpts:function(a){this.options.smartyInnerScrollEnabled&&
(a.boundToScreen=!0)},checkAndSetSmartyUIUpdateOpts:function(a){this.options.smartyUIUpdateEnabled&&(a.extendRequest={f:"j"},a.dropdownClass+=" ui-update-v1",a.smartyUIUpdateEnabled=!0);this.options.mcFlySearch&&(a.dropdownClass+=" mcfly",a.repositionDropdownOnResize=!1,this.options.searchInputContainerId&&(a.mcFlyInline=!0,a.dropdownClass+=" mcfly-inline"))},submitSearchForm:function(){this._isFormChanged()&&this.searchForm.submit()},_isFormChanged:function(){return this.isFormChanged&&this.searchForm.is(":visible")},
logUserImpressionForScrollSearchBanner:function(){c.question.ask("was.user.shown.scrollSearch.banner")&&(this._trackEvent("userSubmitAfterSeeingScrollBanner","searchFormSubmit","manual"),c.events.publish("reset.scrollSearch.banner.shown"))},enableScrollLoggingEvent:function(){d(window).off("scroll.logListener").on("scroll.logListener",this.onScrollSearchEventLog.bind(this))},onScrollSearchEventLog:function(){c.dom.schedule(this.logUserScrollInteraction.bind(this))},logUserScrollInteraction:function(){d(window).scrollTop()>
this.scrollSearchToggleHeight&&this._isFormChanged()&&(this._trackEvent("scrollBeforeSubmit","outsideScrollSearchXp",d(window).scrollTop()),this.isScrollUserAction=!0,d(window).off("scroll.logListener"))},setSmartyContainer:function(a){if(a&&this.options.dialog&&this.options.dialogId){a.isDialog=!0;var b="#"+this.options.dialogId+"-dialog-viewport";d(b).length&&(a.appendTo=b,a.stopPropagation=!0)}},_trackEvent:function(a,b,d){c.Analytics.api.trackEvent({category:"searchForm",action:a,label:b,value:d})},
setUpSEMStickyListener:function(){if(this.options.isStickySearchFormEnabled&&this.options.isSEM)if(void 0!==this.options.stickyAfterCssSelector&&(this.stickyAfterElement=d(this.options.stickyAfterCssSelector)),void 0===this.options.stickyAfterCssSelector||void 0===this.stickyAfterElement)(new c.logger("SEM")).error("You need to setup the stickyAfterElement");else{var a=this;window.addEventListener("scroll",function(){var b=a.stickyAfterElement.offset().top,c=a.stickyAfterElement.outerHeight(!0);window.pageYOffset>
b+c?a.sticky||(a.setMinHeightOnElement(a),a.setSticky(!0)):a.sticky&&a.setSticky(!1)})}},setMinHeightOnElement:function(a){var b=a.element.outerHeight(!0);a.element.parent().css("min-height",b+"px")},setSticky:function(a){this.sticky=a;c.events.publish("select.force.close");a?d(".r9-tooltip-wrapper").css("z-index","9000"):d(".r9-tooltip-wrapper").css("z-index","9999999");this.element.click();if(this.options.stickySearchFormAdditionalPadding)if(a){this.element.addClass("desktop-of-the-future");var b=
this;setTimeout(function(){b.element.addClass("desktop-of-the-future-transition")},200)}else this.element.removeClass("desktop-of-the-future"),this.element.removeClass("desktop-of-the-future-transition")}})})(window.R9,window.jq||window.jQuery);(function(c,f){function h(a){return(a.styleJamNumberBox||a.numberBox).bind(a)}function g(a){return a?"string"===typeof a&&(""===a.trim()||0>=parseInt(a,10)):!0}var l={landmarkId:"lm",countryId:"ctry",hotelId:"hotel",neighbourhoodId:"hood",regionId:"reg",freeRegionId:"freereg",cityId:"city",subRegionId:"subreg",address:"addr"},n={lm:"landmarkId",ctry:"countryId",hotel:"hotelId",hood:"neighbourhoodId",reg:"regionId",freereg:"freeRegionId",city:"cityId",addr:"location",subreg:"subRegionId"},m="landmarkId countryId hotelId neighbourhoodId regionId freeRegionId subRegionId cityId".split(" ");
c.createComponentClass("hotels.search.StyleJamHotelSearchForm","base.search.SearchForm",{formQuestion:"hotels.fd.searchform",formCitycodeQuestion:"hotels.fd.searchform.citycode",formCitynameQuestion:"hotels.fd.searchform.cityname",formLocationQuestion:"hotels.fd.searchform.location",travelersDataQuestion:"hotels.searchform.travelers.",numNightsDataQuestion:"hotels.fd.searchform.numNights",daysOutQuestion:"hotels.fd.searchform.daysOut",searchTypeQuestion:"hotels.results.searchType",locationIdQuestion:"hotels.results.locationId",
options:{doubleDatesUpdate:!1,isSEM:!1,defaultRooms:1,defaultGuests:5,defaultAdults:1,defaultChildren:1,flareSmartyType:30,useJSONSmartyData:!1,smartyUrl:"/mv/marvel",locationType:"",maxRooms:8,maxGuests:32,maxAdults:32,maxChildren:32,forceOpen:!1,filterTemplateName:null,hotelPlannerTrigger:0,useLegacySearchUrl:!1,actionUrl:"hotels",msg:{location:"",city:"",checkinDate:"",checkoutDate:"",roomsChoiceLabel:"",guestsChoiceLabel:"",roomsOverMax:"",roomsBelowMin:"",guestsOverMax:"",guestsBelowMin:"",loyaltyProgram:""},
formQuestion:"hotels.fd.searchform",isSingleHotel:!1,isDisabledAdvanced:!1,isTravelerTypeEnabled:!1,loggingPrefix:"",dotfStickyEnabled:!1,goToHotelDetailsPage:!1,keepLocation:!0,showSmartyHistory:!1,showTopDestinations:!1,maxHistoryItems:5,controlGroup:null,urlParams:void 0,autofocusDestination:!1,autoOpenDatepicker:!1,isFdForm:!1,isRegionSearchEnabled:!1,showNumberboxTooltips:!1,useLocalStorageHistory:!1,numberBoxMsg:{roomsOverMax:function(){var a=this.adults.getValue()+this.children.getValue();
return c.Common.Utils.String.formatString(this.options.msg.roomsOverMax,this.rooms.getValue(),a)},roomsBelowMin:function(){var a=this.adults.getValue()+this.children.getValue();return c.Common.Utils.String.formatChoice(this.options.msg.roomsBelowMin,this.rooms.getValue(),this.rooms.getValue(),a)},guestsOverMax:function(){var a=this.adults.getValue()+this.children.getValue();return c.Common.Utils.String.formatString(this.options.msg.guestsOverMax,a,this.rooms.getValue())},guestsBelowMin:function(){var a=
this.adults.getValue()+this.children.getValue();return c.Common.Utils.String.formatChoice(this.options.msg.guestsBelowMin,a,a,this.rooms.getValue())}},showNeedIdeasButton:!1,showPopularDestinationsList:!1,showPopularDestinationsPictures:!1,searchAutoExecute:!1,searchAutoExecuteAfterCmp2:!1,subtractOffsetFromDropdown:!1,sticky:!1,hotelTravelersDropdownEnabled:!1,addHtcPlaceParams:!1,stlPresentation:"",stickyPresentation:"",dotfStickyPresentation:"",collapsibleStickyForm:!1,useAlgoliaSmarty:!1,cmp2LoadOnChangesOnly:!1},
filtersContainerEl:null,amenity:null,neighbourhoodId:null,neighbourhood:null,ambiance:null,location:null,cityId:null,hotelId:null,freeRegionId:null,subRegionId:null,regionId:null,countryId:null,locationType:"",entityKey:"",objectID:"",daterangePicker:null,datePicker:null,rooms:null,guests:null,adults:null,children:null,roomsGuestsDropdown:null,traveler:null,hotelPlanner:null,vertical:"hotels",_dateFormat:"YYYY-MM-DD",extraFiltersData:{},advancedFilterState:null,searchFormFilterState:null,lastCheckInDate:null,
lastCheckOutDate:null,searchAutoExecuteOnChangeCount:3,searchAutoExecuteChanged:[],cmp2Items:void 0,sticked:!1,formRoomsGuestsAbove:null,formGrid:null,formGridFieldCol:null,formFieldGrid:null,formFieldGridDataPickerCol:null,formGridButtonCol:null,formGridSearchBtn:null,startingForm:null,init:function(){this.base();this.hcPlacesEnabled=c.config.getBoolean("ui.hc.places.enabled",!1);this.locationType=this.options.locationType||"";this.formQuestion=this.options.formQuestion;this.formCitycodeQuestion=
this.formQuestion+".citycode";this.formLocationQuestion=this.formQuestion+".location";this.numNightsDataQuestion=this.formQuestion+".numNights";this.daysOutQuestion=this.formQuestion+".daysOut";this.bindDaterangePicker();this.options.hotelTravelersDropdownEnabled||this.bindRoomsGuestsDropdown();this.bindLocationField();this.bindTravelerTypeRadios();if(!this.options.loggedIn&&this.options.privateDealsPromoEnabled){var a=this.getChildElement("privatedeals");a.on("click",function(){c.Analytics.api.trackEvent("hotels/form/private-deals-promo/click");
c.authentication.showLogin({success:function(){c.Analytics.api.trackEvent("hotels/form/private-deals-promo/success");location.reload()}})});if(this.options.isFdForm){var b=c.storage.get("fd.privatedeals.promo.viewcount");b||(a.addClass("first-time-user"),b=0);c.storage.set("fd.privatedeals.promo.viewcount",++b)}c.Analytics.api.trackEvent("hotels/form/private-deals-promo/impression")}this.options.useDialogQuestions&&(this.formQuestion+=".dialog",this.formCitycodeQuestion+=".dialog",this.formLocationQuestion+=
".dialog",this.searchTypeQuestion+=".dialog",this.locationIdQuestion+=".dialog");this.filtersContainerEl=this.getChildElement("filtersContainer");this.searchFormFilterState=f.extend({},this.searchFormFilterState);this.options.sticky&&(this.formRoomsGuestsAbove=this.getChildElement("roomsGuestsAboveForm"),this.formGrid=this.getChildElement("formGrid"),this.formGridFieldCol=this.getChildElement("formGridFieldCol"),this.formFieldGrid=this.getChildElement("fieldGrid"),this.formFieldGridDataPickerCol=
this.getChildElement("fieldGridDatePickerCol"),this.formGridButtonCol=this.getChildElement("formGridButtonCol"),this.formGridSearchBtn=this.getChildElement("formGridSearchBtn"),this.formGridSearchBtnText=this.formGridSearchBtn.find(".text"),this.formGridSearchBtnIcon=this.formGridSearchBtn.find(".icon"),this.formGridSearchBtnTextWithIcon=this.formGridSearchBtnIcon.children(),this.innerSearchFormElement=this.getChildElement("innerSearchForm"),this.searchFormElement=this.getChildElement("searchform"),
this.formFieldGridLocationCol=this.getChildElement("fieldGridLocationCol"),this.formCollapseBtn=this.getChildElement("collapseFormButton"));this.options.cmp2LoadOnChangesOnly&&(this.startingForm=this.serialize())},inlineComponentsReady:function(){this.base();this.options.autoOpenDatepicker&&this.openDatepicker();c.globals&&c.globals.isSeo&&this.isValidDates()},vsLog:function(a){this.searchForm.is(":visible")&&0<=this.searchForm.offset().top&&"complete"===document.readyState&&c.Analytics.api.trackEvent(["hotels/form",
a].join("/"))},getSearchType:function(){for(var a=this.serialize(),b=0;b<m.length;b++){var c=m[b];if(!g(a[c]))return l[c]}return l.address},getLocationId:function(){var a=this.getSearchType();return"hood"===a?this.neighbourhoodId:this[n[a]].val()},addEventHandlers:function(){this.base();var a=this;this.answer(this.searchTypeQuestion,this.getSearchType.bind(this));this.answer(this.locationIdQuestion,this.getLocationId.bind(this));this.subscribe("hotels.frontdoor.form.location hotels.frontdoor.form.rooms hotels.frontdoor.form.guests hotels.frontdoor.form.guests.adults hotels.frontdoor.form.guests.children hotels.frontdoor.form.guests.childrenAges hotels.frontdoor.form.dates hotels.frontdoor.form.traveler hotels.frontdoor.form.all cmp2.form.fill".split(" "),
f.proxy(this.onChange,this));this.bindAdvancedFilter();this.subscribe("hotels.frontdoor.form.location hotels.frontdoor.form.rooms hotels.frontdoor.form.guests hotels.frontdoor.form.guests.adults hotels.frontdoor.form.guests.children hotels.frontdoor.form.guests.childrenAges hotels.frontdoor.form.dates hotels.frontdoor.form.traveler hotels.frontdoor.form.all cmp2.form.fill".split(" "),{id:this.id()},f.proxy(this.onInternalChange,this));this.subscribe("hotels.frontdoor.filter.TOGGLE",f.proxy(this.toggleAdvanced,
this));this.subscribe("intentmedia.submit.handler",f.proxy(this.onHookSubmitForIntentMedia,this));this.subscribe("hotels.frontdoor.form.autoSubmit",this.autoSubmit.bind(this));this.subscribe("omni.vertical.changed",function(b){"hotels"===b&&a.focusFirstElement()});this.options.sticky&&this.subscribe("hotels.frontdoor.form.presentation.sticky.toggle",function(b){a.toggleStickyPresentation(b)});this.answer(this.formQuestion,function(){return a.serialize()});this.answer(this.formLocationQuestion,function(){var b=
"\x3cdiv\x3e"+a.location.val()+"\x3c/div\x3e";return f(b).text()});this.answer(this.formCitycodeQuestion,function(){return a.cityId.val()});this.answer(this.formCitynameQuestion,function(){return a.cityName.val()});this.answer(this.numNightsDataQuestion,this.calculateNumNights.bind(this));this.answer(this.daysOutQuestion,this.calculateDaysOut.bind(this));this.options.showNeedIdeasButton&&(this.needIdeasButton=this.getChildElement("need-ideas"),this.needIdeasButton.click(this.needIdeas),a.needIdeasButton.removeClass("hidden"));
this.options.searchAutoExecuteAfterCmp2&&this.subscribe("cmp2.rendering.finished",function(b){!a.isNewCmp2CheckAdded(b)&&a.canExecuteAutoSearch()&&(a.searchAutoExecuteChanged=[],a.onSubmit())});this.options.sticky&&this.subscribe("hotels.detailsv2.sticky.toggle",function(a){return a?this.stickyShow():this.stickyHide()}.bind(this));this.options.hotelTravelersDropdownEnabled||(this.subscribe("hotels.frontdoor.rooms.onChange",{namespace:this.id()},this.onRoomsChange.bind(this)),this.subscribe("hotels.frontdoor.guests.onChange",
{namespace:this.id()},this.onGuestsChange.bind(this)));a.searchForm.is(":visible")&&c.question.answer("date.input.wrapper.width",function(){return a.checkIn.element.width()});this.subscribe("hotels.search.StyleJamHotelSearchForm.enableSearchButton",function(b){b===a.id()&&a.enableSearchButton()});if(this.options.collapsibleStickyForm){var b=this.getChildElement("collapseFormButton");b.length&&b.click(function(){a.toggleStickyPresentation(!1);c.events.publish("hotels.frontdoor.form.sticky.collapsed",
!0)})}this.options.showFlexOptionDropdown&&this.subscribe("common.search.flexOption.change",{namespace:this.id()},this.updateFlexOptions.bind(this))},refreshHistory:function(){if(this.options.controlGroup){var a=this.options.controlGroup.getHistory();a&&a.update()}},setupLocationFields:function(){this.location=this.getChildElement("location");this.cityId=this.getChildElement("city-id");this.cityName=this.getChildElement("city-name");this.hotelId=this.getChildElement("hotel-id");this.landmarkId=this.getChildElement("landmark-id");
this.neighbourhoodId=this.getChildElement("neighborhood-id");this.regionId=this.getChildElement("regionId");this.freeRegionId=this.getChildElement("freeRegionId");this.subRegionId=this.getChildElement("subRegionId");this.addr=this.getChildElement("addr");this.countryId=this.getChildElement("countryId");this.stars=this.getChildElement("star-wrapped");this.price=this.getChildElement("price-wrapped");this.rating=this.getChildElement("rating-wrapped");this.dates=this.daterangePicker;this.hcPlacesEnabled&&
(this.placeName=this.getChildElement("placeName"),this.placeId=this.getChildElement("placeId"))},bindLocationField:function(){var a=this;this.setupLocationFields();this.options.autoOpenDatepicker&&(f(this.location).on("keyup",function(b){13===b.which&&a.cityId.val()&&a.openDatepicker()}),f(this.location).on("mousedown touchstart",function(){f(this).focus()}));var b={minWidth:420,smartyControlGroup:a.smartyControlGroup(),flareSmartyType:a.options.flareSmartyType,dataSource:a.options.smartyUrl,messages:a.options.msg,
clearItem:function(){a.smartyItemChanged=!0;a.locationType="";a.entityKey="";a.objectID="";a.cityId.val("");a.landmarkId.val("");a.hotelId.val("");a.neighbourhoodId.val("");a.freeRegionId.val("");a.subRegionId.val("");a.addr.val("");a.regionId.val("");a.countryId.val("");a.hcPlacesEnabled&&(a.placeName.val(""),a.placeId.val(""));c.events.publish("hotels.frontdoor.form.location",{id:a.id(),locationType:"",location:"",cityId:"",landmarkId:"",hotelId:"",entityKey:"",objectID:"",placeName:"",placeId:""})},
showPopularDestinationsList:a.options.showPopularDestinationsList&&this.options.isFdForm,showPopularDestinationsPictures:a.options.showPopularDestinationsPictures&&this.options.isFdForm,showBackgroundAutocomplete:c.config.getBoolean("ui.common.smarty.background.autocomplete.enabled",!1),setItem:c.Common.Utils.throttle(50,function(b,d){a.smartyItemChanged=!0;b=d||{};d=b.id||b.lmid||b.hid||b.frid||b.rid||b.cid||b.nhid||b.entityKey||b.objectID;a.options.keepHotelIdOnCitySearch&&b.id===a.options.citycode&&
"city"===b.type&&(b.hid=b.hid||a.options.hotelId||"",b.hid===a.options.hotelId&&(a.smartyItemChanged=!1));"subreg"===b.type&&(b.srid=b.id,b.id="0");c.events.publish("hotels.frontdoor.form.location",{id:a.id(),locationType:b.type||"",location:b.str,locationName:b.short_str,cityId:b.id||(d?"0":""),landmarkId:b.lmid||(d?"0":""),hotelId:b.hid||(d?"0":""),freeRegionId:b.frid||(d?"0":""),subRegionId:b.srid||(d?"0":""),regionId:b.rid||(d?"0":""),countryId:b.cid||(d?"0":""),neighbourhoodId:b.nhid||(d?"0":
""),entityKey:b.entityKey||(d?"0":""),objectID:b.objectID||(d?"0":"")});d=a.checkIn.getValue()&&a.checkOut.getValue();a.options.autoOpenDatepicker&&!d&&a.openDatepicker();a.options.autoSubmit&&b.str&&a.autoSubmit();a.vsLog("location")}),afterDone:function(){""===a.location.val()&&(a.smartyItemChanged=!0,a.locationType="",a.entityKey="",a.objectID="",a.cityId.val(""),a.landmarkId.val(""),a.hotelId.val(""),a.neighbourhoodId.val(""),a.freeRegionId.val(""),a.subRegionId.val(""),a.addr.val(""),a.regionId.val(""),
a.countryId.val(""),a.hcPlacesEnabled&&(a.placeName.val(""),a.placeId.val("")),c.events.publish("hotels.frontdoor.form.location",{id:a.id(),locationType:"",location:"",cityId:"",landmarkId:"",hotelId:"",entityKey:"",objectID:"",placeName:"",placeId:""}))}},d=this.location.data("inputModal");a.options.searchInputContainerId?(b.appendTo=f("#"+a.options.searchInputContainerId),b.fixedDropdown=!0):d&&(b.appendTo=d.getSmartyWrapper(),b.fixedDropdown=!0,b.minWidth=null,b.maxWidth=null);this.checkAndSetSmartyUIUpdateOpts(b);
this.locationSmarty=a.options.useAlgoliaSmarty?this.location.algoliaHotelSmarty(b).getWidget():this.location.hotelSmarty(b).getWidget();c.question._questionAnswerMap.searchForm_buildSearchUrl||c.question.answer("searchForm.buildSearchUrl",function(a){return this.buildSearchURL(a)}.bind(this))},smartyControlGroup:function(){if(!this.options.showSmartyHistory&&!this.options.showTopDestinations)return null;var a={form:this,locationInput:this.location,ctid:this.cityId,lmid:this.landmarkId,hid:this.hotelId,
nhid:this.neighbourhoodId,frid:this.freeRegionId,srid:this.subRegionId,rid:this.regionId,cid:this.countryId,rooms:this.rooms,minStars:this.stars,priceRange:this.price,rating:this.rating,maxHistory:this.options.maxHistoryItems,useLegacyDatePicker:!1};this.hcPlacesEnabled&&(a.entityKey=this.placeName,a.objectID=this.placeId);if(this.options.showSmartyHistory){var b=new c.Common.SmartyHistory.SmartyHotelHistory;a.smartyHistory=function(){return b}}if(this.options.showTopDestinations){var d=new c.Common.SmartyTopDestinations.SmartyHotelTopDestinations;
a.smartyTopDestinations=function(){return d}}a.adults=this.adults;a.children=this.children;a.startDate=this.checkIn;a.endDate=this.checkOut;a.datePicker=this.datePicker;a=new c.Common.SmartyControlGroup.SmartyHotelControlGroup(a);return this.options.controlGroup=a},openDatepicker:function(){var a=this;setTimeout(function(){a.checkIn&&a.checkIn.trigger&&a.checkIn.trigger("focus")},25)},bindAdvancedFilter:function(){var a=this;this.subscribe("hotels.frontdoor.form.location",function(b){a.shouldUpdate(b)&&
c.events.publish("hotels.frontdoor.updateFilters",b)})},bindDaterangePicker:function(){var a=this,b=function(a){var b=this.serialize();c.events.publish("hotels.frontdoor.form.dates",{id:this.id(),checkInDate:b.checkInDate,checkOutDate:b.checkOutDate,actOnStart:a,hotelLocationFilterUrl:b.hotelLocationFilterUrl});this.vsLog("checkout")};this.checkIn=this.getChildElement("checkIn").getWidget();this.checkOut=this.getChildElement("checkOut").getWidget();this.checkIn.options.change=b.bind(this,!0);this.checkOut.options.change=
b.bind(this,!1);this.datePicker=this.getChildElement("datePicker").getWidget();this.options.autoSubmit&&(this.datePicker.setOption("change",function(b,c,k){a.options.autoSubmit&&b&&c&&"endDate"===k&&a.autoSubmit()}),this.datePicker.setOption("dismiss",function(){a.autoSubmit()}))},bindRoomsGuestsDropdown:function(){var a=this,b,d;b=this.searchForm.closest(".viewport").find(".content");this.roomsGuestsDropdown=this.getChildElement("roomsGuestsDropdown").styleJamDropdownDialog({container:b.length?b:
void 0,expandTo:this.options.phoenixRising?null:this.id("hotelguestsdropdown-trigger-cover"),coverTrigger:this.options.phoenixRising,subtractContainerOffset:this.options.subtractOffsetFromDropdown,onOpen:function(){a.roomsGuestChanged=!1;setTimeout(function(){f(a.rooms).focus()},100);a.getChildElement("roomsGuestsDropdown").attr("aria-expanded","true")},onClose:function(b,c,d){b&&d&&27===d.which&&setTimeout(function(){a.roomsGuestsDropdown.element.focus()},100);a.roomsGuestChanged&&a.options.autoSubmit&&
a.autoSubmit();a.getChildElement("roomsGuestsDropdown").attr("aria-expanded","false")}}).getWidget();this.roomsGuestsDropdown.element.off("keydown").keydown(function(b){if(40===b.which||32===b.which)b.preventDefault(),b.stopPropagation(),a.roomsGuestsDropdown.toggleContent(!0)});c.events.subscribe("hotelsearchform.close.roomsGuestsDropdown",function(){a.roomsGuestsDropdown.close()});this.rooms=h(this.getChildElement("rooms"))({min:1,max:a.options.maxRooms,defaultValue:a.options.defaultRooms,callback:function(){a.updateBoxButtonStates();
a.roomsGuestChanged=!0;c.events.publish("hotels.frontdoor.form.rooms",{id:a.id(),rooms:this.getValue()});a.vsLog("changerooms")}}).getWidget();b=this.rooms.decrButton;this.adults=h(this.getChildElement("adults"))({min:1,max:a.options.maxAdults,defaultValue:a.options.defaultAdults,callback:function(){a.roomsGuestChanged=!0;c.events.publish("hotels.frontdoor.form.guests.adults",{id:a.id(),adults:this.getValue()});a.vsLog("changeguests_adults")}}).getWidget();d=(this.children=h(this.getChildElement("children"))({min:0,
max:a.options.maxChildren,defaultValue:a.options.defaultChildren,callback:function(){a.roomsGuestChanged=!0;c.events.publish("hotels.frontdoor.form.guests.children",{id:a.id(),children:this.getValue()});a.vsLog("changeguests_children")}}).getWidget())&&this.children.incrButton;var e=function(b,c){b&&b.off("keydown").keydown(function(b){9===b.which&&(c?b.shiftKey:!b.shiftKey)&&(b.preventDefault(),b.stopPropagation(),setTimeout(function(){a.roomsGuestsDropdown.element.focus();a.roomsGuestsDropdown.toggleContent(!1)},
100))})};e(b,!0);e(d,!1);this.hotelPlanner=this.getChildElement("hotelPlanner");this.hotelPlanner.on("click",function(){var b=a.serialize();c.events.publish("hotelplanner.open",{location:b.location,startDate:b.checkInDate,endDate:b.checkOutDate})});this.updateBoxButtonStates()},updateBoxButtonStates:function(){var a=this.adults.getValue(),b=this.children.getValue(),d=c.config.getInt("ui.hotels.max.per.room",4);a+b===Math.min(this.options.maxGuests,this.options.maxRooms*d)?(this.adults.disableIncrement(),
this.children.disableIncrement()):(this.adults.enableIncrement(),this.children.enableIncrement())},bindTravelerTypeRadios:function(){if(this.options.isTravelerTypeEnabled&&this.getChildElement("traveler").length){var a=this;this.traveler=this.getChildElement("traveler").radioButtonSet({change:function(b){b="traveler/"+(b.value||"");f.proxy(a.dataChanged,a);a.vsLog(b)}}).getWidget()}},onHookSubmitForIntentMedia:function(a){a&&"function"===typeof a.callOnSubmit&&(this.intentMediaCallOnSubmit=a.callOnSubmit)},
updateFlexOptions:function(a){var b=this.searchFormFilterState.freebies;"y"===a.value?this.searchFormFilterState.freebies=b?b+",freecancellation":"freecancellation":"n"===a.value&&(a=b?b.split(","):[],b=a.indexOf("freecancellation"),-1<b&&a.splice(b,1),0<a.length?this.searchFormFilterState.freebies=a.join(","):delete this.searchFormFilterState.freebies)},onSubmit:function(a){var b=this.base;this.isSubmitted||(this.syncFilters(),this.setYandexTracking(),this.submitIntentMedia(),b.call(this,a),this.options.autoSubmit&&
(this.isSubmitted=!1),this.options.cmp2LoadOnChangesOnly&&this.isValid()&&(this.startingForm=this.serialize()));return!1},isRegionSearch:function(a){return(a.regionId||a.freeRegionId||a.countryId||a.subRegionId)&&(0!==a.regionId||0!==a.freeRegionId||0!==a.countryId||0!==a.subRegionId)},publishSubmitEvent:function(a){a&&a.url&&0<=a.url.indexOf("%s")&&(new c.logger).error("StyleJamHotelSearchForm submit url has invalid %s parameter");this.isRegionSearch(a)&&this.options.isRegionSearchEnabled?window.location.href=
"/"+a.url:this.base(a)},autoSubmit:function(){if(this.checkFormChanges())this.onSubmit()},checkFormChanges:function(){var a=this.serialize();if(a.location&&a.checkInDate&&a.checkOutDate){var b=moment(a.checkInDate,this._dateFormat),a=moment(a.checkOutDate,this._dateFormat);if(0>b.diff(a,"days"))return!0}return!1},hasFormChanged:function(){var a=this.serialize();this.cmp2ChangeOnly=!1;if(a&&this.startingForm){var b=a.location===this.startingForm.location,c=a.checkInDate===this.startingForm.checkInDate,
e=a.checkOutDate===this.startingForm.checkOutDate,k=1!=a.cmp2dirty,f;f=a.adults===this.startingForm.adults&&a.children===this.startingForm.children;this.options.specifyChildAges&&(f=f&&a.childrenAges===this.startingForm.childrenAges);var g=a.rooms===this.startingForm.rooms,a=this.options.priceTypeEnabled&&"undefined"===typeof a.priceType;b&&c&&e&&f&&g&&!a&&!k&&(this.cmp2ChangeOnly=!0);if(b&&c&&e&&f&&g&&k&&!a)return!1;this.preserveFilters=this.options.preserveFiltersOnSearchChange&&b}return!0},onChange:function(a){this.shouldUpdate(a)&&
(this.updateLogging(a),this.load(a),this.saveToStorage(),this.refreshHistory())},registerAndCheckAutoSearch:function(a){var b=this,c=function(a,c){var d=b.searchAutoExecuteChanged.indexOf(a);(c=0===c.length)&&-1!==d?b.searchAutoExecuteChanged.splice(d,0):-1!==d||c||b.searchAutoExecuteChanged.push(a)};a.hasOwnProperty("location")&&(b.searchAutoExecuteChanged=[],c("location",a.location));a.hasOwnProperty("checkInDate")&&c("checkInDate",a.checkInDate);a.hasOwnProperty("checkOutDate")&&!a.actOnStart&&
c("checkOutDate",a.checkOutDate);return this.canExecuteAutoSearch()},canExecuteAutoSearch:function(){return!this.element.hasClass("Advanced")&&this.searchAutoExecuteChanged.length===this.searchAutoExecuteOnChangeCount},isNewCmp2CheckAdded:function(a){var b;if(this.cmp2Items){var c=this.cmp2Items;b=function(a){return a.checked&&!c.some(function(b){return a.id===b.id&&b.checked})}}else b=function(a){return a.checked};this.cmp2Items=a.items;return a.items.some(b)},onInternalChange:function(a){if(this.options.searchAutoExecute&&
this.registerAndCheckAutoSearch(a))this.searchAutoExecuteChanged=[],this.onSubmit();else{for(var b=this.options.searchAutoExecuteAfterCmp2&&this.registerAndCheckAutoSearch(a),c="location checkInDate checkOutDate refreshCmp2sOnOpen rooms adults children childrenAges".split(" "),e=0;e<c.length;e++)if(a.hasOwnProperty(c[e])){this.loadCompareToItems();break}if(!b&&(b={location:"location",checkInDate:"checkin",checkOutDate:"checkout",rooms:"rooms",guests:"guests",adults:"adults",children:"children",traveler:"traveler"},
c=null,a.hasOwnProperty("checkInDate")&&(a.checkInDate!==this.lastCheckInDate&&(c="checkInDate"),this.lastCheckInDate=a.checkInDate),a.hasOwnProperty("checkOutDate")&&(a.checkOutDate!==this.lastCheckOutDate&&(c="checkOutDate"),this.lastCheckOutDate=a.checkOutDate),null===c||this.options.doubleDatesUpdate||delete a["checkOutDate"===c?"checkInDate":"checkOutDate"],!a.silent))for(var f in b)a.hasOwnProperty(f)&&this.submitPreload(b[f])}},onRoomsChange:function(a){a.rooms>this.rooms.options.max?this.rooms.setValue(this.rooms.options.max,
!0):a.rooms<this.rooms.options.min?this.rooms.setValue(this.rooms.options.min,!0):this.rooms.setValue(a.rooms,!0);a=c.config.getInt("ui.hotels.max.per.room",4);var b=this.rooms.getValue(),d=this.adults.getValue(),e=this.children.getValue();d<b&&(d=b);b*a<d+e&&(e=b*a-d,0>e&&(e=0,d=b*a));this.children.setValue(e,!0);this.adults.setValue(d,!0);this.refreshRoomsGuestsDropdownDisplay()},onGuestsFieldChange:function(a){a.guests>this.guests.options.max?this.guests.setValue(this.guests.options.max,!0):a.guests<
this.guests.options.min?this.guests.setValue(this.guests.options.min,!0):this.guests.setValue(a.guests,!0);a=c.config.getInt("ui.hotels.max.per.room",4);var b=this.guests.getValue(),d=this.rooms.getValue();d*a<b?(d=Math.ceil(b/a),this.rooms.setValue(d),this.options.showNumberboxTooltips&&this.showTooltip(this.guests.incrButton,this.options.numberBoxMsg.guestsOverMax.call(this))):d>b?(this.rooms.setValue(b),this.options.showNumberboxTooltips&&this.showTooltip(this.guests.incrButton,this.options.numberBoxMsg.guestsBelowMin.call(this))):
this.options.showNumberboxTooltips&&this.clearTooltips();this.refreshRoomsGuestsDropdownDisplay()},onAdultsFieldChange:function(a){a.adults>this.adults.options.max?this.adults.setValue(this.adults.options.max,!0):a.adults<this.adults.options.min?this.adults.setValue(this.adults.options.min,!0):this.adults.setValue(a.adults,!0);var b=c.config.getInt("ui.hotels.max.per.room",4),d=this.adults.getValue();a=this.children.getValue();var e=this.rooms.getValue(),f=Math.ceil((d+a)/b);f>d&&(f=d);e<f?e=f:e>
d&&(e=d,b=e*b-d,a=b<a?b:a);this.children.setValue(a,!0);this.rooms.setValue(e,!0);this.refreshRoomsGuestsDropdownDisplay()},onChildrenFieldChange:function(a){a.children>this.children.options.max?this.children.setValue(this.children.options.max,!0):a.children<this.children.options.min?this.children.setValue(this.children.options.min,!0):this.children.setValue(a.children,!0);var b=c.config.getInt("ui.hotels.max.per.room",4);a=this.adults.getValue();var d=this.children.getValue(),e=this.rooms.getValue(),
b=Math.ceil((d+a)/b);e<b&&(e=b);e>a&&(a=e);this.adults.setValue(a,!0);this.rooms.setValue(e,!0);this.refreshRoomsGuestsDropdownDisplay()},onGuestsChange:function(a){var b,c;"undefined"!==typeof a.guests?(b=a.guests,c=0):(b=a.adults,c=a.children);if("undefined"!==typeof b)this.onAdultsFieldChange(a);else if("undefined"!==typeof c)this.onChildrenFieldChange(a)},calculateNumNights:function(){var a=1,b,c;this.options.useLegacyDatePicker?(b=moment(this.daterangePicker.getStartDate()),c=moment(this.daterangePicker.getEndDate())):
(b=this.checkOut.getDate(),c=this.checkIn.getDate());null!=b&&null!=c&&(a=b.diff(c,"days",!0));return Math.ceil(a)},calculateDaysOut:function(){var a=0,b;b=this.options.useLegacyDatePicker?moment(this.daterangePicker.getStartDate()):this.checkIn.getDate();null!=b&&(a=moment(moment.now()),a=b.diff(a,"days",!0));return Math.ceil(a)},getExtraFilterData:function(){var a=c.question.ask("hotels.frontdoor.filter.DATA");this.extraFiltersData=a||{};var b={};if(null!=a&&("0"!==a.stars||"-10"!==a.rating||a.price&&
a.price.max!==a.price.min||null!=a.priceType)){if("0"!==a.stars){b.stars={};var d=parseInt(a.stars,10);[0,2,3,4,5].forEach(function(a){b.stars[a]=a>=d?1:0})}if("-10"!==a.rating){b.rating={};var e={horrible:20,mediocre:40,okay:60,good:80,excellent:100},f;for(f in e)if(e.hasOwnProperty(f)){var g=parseInt(a.rating,10);b.rating[f]=g<=e[f]?1:0}}a.price&&a.price.max!==a.price.min&&(b.price={min:parseInt(a.price.min,10),max:parseInt(a.price.max,10)});null!=a.priceType&&(b.priceType={code:a.priceType})}this.advancedFilterState=
b},syncFilters:function(){var a=this;this.getExtraFilterData();this.advancedFilterState&&Object.keys(this.advancedFilterState).forEach(function(b){c.events.publish("resultspage.filters.sync",{name:b,state:a.advancedFilterState[b]})})},toggleStickyPresentation:function(a){this.options.hotelTravelersDropdownEnabled&&c.events.publish("hotels.frontdoor.form.sticky",{namespace:this.id(),isSticky:a});this.options.stickyPresentation&&this.options.stlPresentation?this.swapStickyPresentationBlocks(a):a?this.applyStickyPresentation():
this.removeStickyPresentation()},swapStickyPresentationBlocks:function(a){var b=this.options.dotfStickyEnabled?this.options.dotfStickyPresentation.toLowerCase():this.options.stickyPresentation.toLowerCase();this.swapPresentationBlocksForChildIds(a?b:this.options.stlPresentation.toLowerCase(),{hotelSearchForm__inner:this.innerSearchFormElement,"hotelSearchForm-rising__form":this.searchFormElement,"hotelSearchFormGrid--rising":this.formGrid,"hotelSearchFormGrid--rising__fieldsCol":this.formGridFieldCol,
"hotelSearchFormGrid--rising__buttonCol":this.formGridButtonCol,"hotelSearchFormGrid__fieldsGrid--rising":this.formFieldGrid,"hotelSearchFormGrid__fieldsGrid--rising__locationCol":this.formFieldGridLocationCol,"hotelSearchFormGrid__fieldsGrid--rising__datePickerCol":this.formFieldGridDataPickerCol,hotelSearchFormGrid__collapseFormButton:this.formCollapseBtn,hotelSearchForm__searchButtonText:this.formGridSearchBtnText,hotelSearchForm__searchButtonIcon:this.formGridSearchBtnIcon,"hotelSearchForm__searchIcon--text-and-icon":this.formGridSearchBtnTextWithIcon,
hotelSearchForm__button:this.formGridSearchBtn})},swapPresentationBlocksForChildIds:function(a,b){var c=this,e=Object.keys(b).map(function(a){return{blockName:a,blockClass:c.getStlBlock(a)}});this.options.presentation=a;e.forEach(function(a){var d=b[a.blockName];a.blockName&&d&&d.length&&(a.blockClass&&d.removeClass(a.blockClass),(a=c.getStlBlock(a.blockName))&&d.addClass(a))})},applyStickyPresentation:function(){this.sticked||(this.sticked=!0,c.events.publish("DatePicker.layout.compressed.toggle",
!0),c.dom.swapClasses(this.formRoomsGuestsAbove,c.stylejam.hotels.search.StyleJamHotelSearchForm.formRoomsGuestsAbove,c.stylejam.hotels.search.StyleJamHotelSearchForm.formRoomsGuestsAboveSticky),c.dom.swapClasses(this.formGridButtonCol,c.stylejam.hotels.search.StyleJamHotelSearchForm.formGridButtonCol,c.stylejam.hotels.search.StyleJamHotelSearchForm.formGridButtonColSticky),c.dom.swapClasses(this.formGridSearchBtn,c.stylejam.hotels.search.StyleJamHotelSearchForm.formButton,c.stylejam.hotels.search.StyleJamHotelSearchForm.formButtonSticky),
c.dom.swapClasses(this.formGrid,c.stylejam.hotels.search.StyleJamHotelSearchForm.formGrid,c.stylejam.hotels.search.StyleJamHotelSearchForm.formGridSticky),c.dom.swapClasses(this.formGridFieldCol,c.stylejam.hotels.search.StyleJamHotelSearchForm.formGridFieldsCol,c.stylejam.hotels.search.StyleJamHotelSearchForm.formGridFieldsColSticky),c.dom.swapClasses(this.formFieldGrid,c.stylejam.hotels.search.StyleJamHotelSearchForm.formGridFieldsGrid,c.stylejam.hotels.search.StyleJamHotelSearchForm.formGridFieldsGridSticky),
c.dom.swapClasses(this.formFieldGridDataPickerCol,c.stylejam.hotels.search.StyleJamHotelSearchForm.formGridFieldsGridDataPickerCol,c.stylejam.hotels.search.StyleJamHotelSearchForm.formGridFieldsGridDataPickerColSticky))},removeStickyPresentation:function(){this.sticked&&(this.sticked=!1,c.events.publish("DatePicker.layout.compressed.toggle",!1),c.dom.swapClasses(this.formRoomsGuestsAbove,c.stylejam.hotels.search.StyleJamHotelSearchForm.formRoomsGuestsAboveSticky,c.stylejam.hotels.search.StyleJamHotelSearchForm.formRoomsGuestsAbove),
c.dom.swapClasses(this.formGridButtonCol,c.stylejam.hotels.search.StyleJamHotelSearchForm.formGridButtonColSticky,c.stylejam.hotels.search.StyleJamHotelSearchForm.formGridButtonCol),c.dom.swapClasses(this.formGridSearchBtn,c.stylejam.hotels.search.StyleJamHotelSearchForm.formButtonSticky,c.stylejam.hotels.search.StyleJamHotelSearchForm.formButton),c.dom.swapClasses(this.formGrid,c.stylejam.hotels.search.StyleJamHotelSearchForm.formGridSticky,c.stylejam.hotels.search.StyleJamHotelSearchForm.formGrid),
c.dom.swapClasses(this.formGridFieldCol,c.stylejam.hotels.search.StyleJamHotelSearchForm.formGridFieldsColSticky,c.stylejam.hotels.search.StyleJamHotelSearchForm.formGridFieldsCol),c.dom.swapClasses(this.formFieldGrid,c.stylejam.hotels.search.StyleJamHotelSearchForm.formGridFieldsGridSticky,c.stylejam.hotels.search.StyleJamHotelSearchForm.formGridFieldsGrid),c.dom.swapClasses(this.formFieldGridDataPickerCol,c.stylejam.hotels.search.StyleJamHotelSearchForm.formGridFieldsGridDataPickerColSticky,c.stylejam.hotels.search.StyleJamHotelSearchForm.formGridFieldsGridDataPickerCol))},
stickyShow:function(){c.dom.swapClasses(this.formGridFieldCol,this.options.styles.formGridFieldsCol,this.options.styles.formGridFieldsColSticky);c.dom.swapClasses(this.formGrid,this.options.styles.formGrid,this.options.styles.formGridSticky);c.dom.swapClasses(this.formRoomsGuestsAbove,this.options.styles.formRoomsGuestsAbove,this.options.styles.formRoomsGuestsAboveSticky);c.dom.swapClasses(this.formGridButtonCol,this.options.styles.formGridButtonCol,this.options.styles.formGridButtonColSticky);c.dom.swapClasses(this.formGridSearchBtn,
this.options.styles.formButton,this.options.styles.formButtonSticky)},stickyHide:function(){c.dom.swapClasses(this.formGridFieldCol,this.options.styles.formGridFieldsColSticky,this.options.styles.formGridFieldsCol);c.dom.swapClasses(this.formGrid,this.options.styles.formGridSticky,this.options.styles.formGrid);c.dom.swapClasses(this.formRoomsGuestsAbove,this.options.styles.formRoomsGuestsAboveSticky,this.options.styles.formRoomsGuestsAbove);c.dom.swapClasses(this.formGridButtonCol,this.options.styles.formGridButtonColSticky,
this.options.styles.formGridButtonCol);c.dom.swapClasses(this.formGridSearchBtn,this.options.styles.formButtonSticky,this.options.styles.formButton)},serialize:function(){var a=this.base(),b=moment(this.checkIn.getDate()),d=moment(this.checkOut.getDate()),e=this.checkIn&&!moment(Date.now()).isAfter(b,"day");c&&c.globals&&c.globals.isSeo&&!e&&(b=moment().add(1,"day").format("YYYY-MM-DD"),d=moment().add(2,"day").format("YYYY-MM-DD"),this.checkIn.setDate(b),this.checkOut.setDate(d));this.getExtraFilterData();
this.options.hotelTravelersDropdownEnabled?e=c.question.ask(this.travelersDataQuestion+this.id("form")):(e={adults:this.adults.getValue(),children:this.children.getValue()},f.extend(e,{rooms:this.rooms.getValue()}));this.advancedFilterState&&this.advancedFilterState.hasOwnProperty("priceType")&&this.advancedFilterState.priceType.code&&(a.priceType=this.advancedFilterState.priceType.code);a.goToHotelDetailsPage=this.options.goToHotelDetailsPage&&this.smartyItemChanged;f.extend(a,{locationType:this.locationType,
location:this.location.val(),cityId:this.cityId.val(),landmarkId:this.landmarkId.val(),hotelId:this.hotelId.val(),checkInDate:b.format(this._dateFormat),checkOutDate:d.format(this._dateFormat),freeRegionId:this.freeRegionId.val(),subRegionId:this.subRegionId.val(),amenity:this.amenity,regionId:this.regionId.val(),countryId:this.countryId.val(),neighbourhoodId:this.neighbourhoodId.val(),neighbourhood:this.neighbourhood,ambiance:this.ambiance,searchType:"C",citycode:this.cityId.val(),applyFilters:!0,
filterState:JSON.stringify(this.advancedFilterState),hotelLocationFilterUrl:this.hotelLocationFilterUrl},e);this.hcPlacesEnabled&&f.extend(a,{placeName:this.placeName.val(),placeId:this.placeId.val()});this.locationType!==l.address&&this.hasLocationId()||f.extend(a,{searchType:"A",address:this.location.val()});return a},serializeForCompareTo:function(){var a=this.serialize();delete a.checkInDate;delete a.checkOutDate;a.checkin_date=moment(this.checkIn.getDate()).format(c.globals.apiDateFormat);a.checkout_date=
moment(this.checkOut.getDate()).format(c.globals.apiDateFormat);return a},load:function(a){a.hasOwnProperty("searchDialog")&&a.searchDialog&&this.resetFieldsForSearchDialog();a.locationType&&(this.locationType=a.locationType);a.location&&this.location.val(a.location);a.cityId&&this.cityId.val(a.cityId);a.landmarkId&&this.landmarkId.val(a.landmarkId);a.hotelId&&this.hotelId.val(a.hotelId);a.freeRegionId&&this.freeRegionId.val(a.freeRegionId);a.subRegionId&&this.subRegionId.val(a.subRegionId);a.regionId&&
this.regionId.val(a.regionId);a.countryId&&this.countryId.val(a.countryId);this.hcPlacesEnabled&&(a.entityKey&&this.placeName.val(a.entityKey),a.objectID&&this.placeId.val(a.objectID));a.neighbourhoodId&&this.neighbourhoodId.val(a.neighbourhoodId);if(a.checkInDate){var b=moment(a.checkInDate,this._dateFormat);b.isValid()&&this.checkIn.setDate(b)}a.checkOutDate&&(b=moment(a.checkOutDate,this._dateFormat),b.isValid()&&this.checkOut.setDate(b));a.rooms&&c.events.publish("hotels.frontdoor.rooms.onChange",
f.extend({namespace:this.id()},a));"undefined"===typeof a.guests&&"undefined"===typeof a.adults&&"undefined"===typeof a.children||c.events.publish("hotels.frontdoor.guests.onChange",f.extend({namespace:this.id()},a));this.options.hotelTravelersDropdownEnabled&&this.options.specifyChildAges&&"undefined"!==typeof a.childrenAges&&c.events.publish("hotels.frontdoor.childrenAges.onChange",f.extend({namespace:this.id()},a));a.urlParams&&(this.options.urlParams=a.urlParams);this.hotelLocationFilterUrl=a.hotelLocationFilterUrl?
a.hotelLocationFilterUrl:null;this.options.hotelTravelersDropdownEnabled||(this.refreshRoomsGuestsDropdownDisplay(),this.updateBoxButtonStates());a.skipSemEvent||c.events.publish("notify.sem.datepicker",{startDate:moment(a.checkInDate,this._dateFormat),endDate:moment(a.checkOutDate,this._dateFormat)})},resetFieldsForSearchDialog:function(){this.options.keepLocation||(this.locationType="",this.location.val(""),this.cityId.val(""),this.landmarkId.val(""),this.hotelId.val(""));this.freeRegionId.val("");
this.subRegionId.val("");this.regionId.val("");this.countryId.val("");this.neighbourhoodId.val("")},getCookieData:function(){var a=this.base();this.options.isDisabledAdvanced||(this.extraFiltersData.price&&(a.filterMinPrice=this.extraFiltersData.price.min,a.filterMaxPrice=this.extraFiltersData.price.max),a.filterPriceType=this.extraFiltersData.priceType,a.filterMinStars=this.extraFiltersData.stars,a.filterMinGuestRating=this.extraFiltersData.rating);return a},loadFromHistory:function(a){this.options.useLocalStorageHistory&&
this.base(a);a=this.localHistory.reduceTravelersObjectToTotal();if(0<a){var b;b=this.options.hotelTravelersDropdownEnabled?c.question.ask("hotel-rooms-selected"):this.rooms.getValue();this.load({guests:a,rooms:Math.min(Math.max(b||0,Math.ceil(a/4)),a)})}},getStorageProps:function(){return"checkInDate checkOutDate location locationType cityId landmarkId hotelId rooms guests searchType".split(" ")},mapSearchUrlData:function(a){var b={urlPrefix:c.config.getString("ui.hotels.searchUrlPath","hotels").replace(/\//g,
""),location:a.location,ctid:a.cityId,frid:a.freeRegionId,srid:a.subRegionId,rid:a.regionId,cid:a.countryId,hid:a.hotelId,lmid:a.landmarkId,nhid:a.neighbourhoodId,adults:a.adults,children:a.children,childAges:a.childrenAges,guests:a.guests,rooms:a.rooms,checkin:a.checkInDate,checkout:a.checkOutDate,address:a.address,amenity:a.amenity,minStars:a.minStars,view:c.question.ask("hotels.resultspage.pageView"),useFullSearchUrl:c.globals&&c.globals.useFullSearchUrl,goToHotelDetailsPage:this.options.goToHotelDetailsPage,
smartyItemChanged:this.smartyItemChanged};this.options.addHtcPlaceParams&&(b.placeName=a.placeName,b.placeId=a.placeId);return b},buildSearchURL:function(a){if(this.options.useLegacySearchUrl)return this.legacyBuildSearchUrl(a);c.storage.remove("hotels.results.saveToTrips.tripId");return c.hotels.search.HotelSearchFormUrls.generateUrl(this.mapSearchUrlData(a),this.getSearchFormFilterState())},getSearchFormFilterState:function(){return f.extend({},this.searchFormFilterState)},legacyBuildSearchUrl:function(a){c.storage.remove("hotels.results.saveToTrips.tripId");
var b=[this.options.actionUrl],d=a.location,e=[],k="-c%s";this.options.isRegionSearchEnabled&&this.isRegionSearch(a)&&b.push("region");var h=a.address||"";g(h)||(d=h,-1===h.indexOf(a.location)&&(d+=","+a.location),k="-a%s");e.push(c.utils.search.encodeLocation(d));g(a.freeRegionId)?g(a.regionId)?g(a.subRegionId)?g(a.countryId)?g(a.cityId)||e.push(k.format(a.cityId)):e.push("-u%s".format(a.countryId)):e.push("-s%s".format(a.subRegionId)):e.push("-r%s".format(a.regionId)):e.push("-e%s".format(a.freeRegionId));
g(a.hotelId)?g(a.landmarkId)?g(a.neighbourhoodId)||e.push("-n%s".format(a.neighbourhoodId)):e.push("-l%s".format(a.landmarkId)):(e.push("-h%s".format(a.hotelId)),this.options.goToHotelDetailsPage&&this.smartyItemChanged&&e.push("-details"));g(a.amenity)||e.push("-f%s".format(a.amenity));b.push(e.join(""));g(a.checkInDate)||g(a.checkOutDate)||(b.push(a.checkInDate),b.push(a.checkOutDate));1<a.guests&&b.push("%sguests".format(a.guests));a.adults&&b.push("%sadults".format(a.adults));a.children&&(this.options.specifyChildAges&&
this.options.hotelTravelersDropdownEnabled&&a.childrenAges?b.push("%schildren-%s".format(a.children,a.childrenAges)):b.push("%schildren".format(a.children)));1<a.rooms&&b.push("%srooms".format(a.rooms));b=b.join("/");d={};g(a.neighbourhood)?g(a.ambiance)||(d=f.extend(d,{ambiance:a.ambiance,filterType:"A"})):d=f.extend(d,{neighborhood:a.neighbourhood,filterType:"N"});if(!g(this.options.urlParams))try{d=f.extend(d,JSON.parse(this.options.urlParams))}catch(p){}f.isEmptyObject(d)&&f.isEmptyObject(a.urlParams)||
(b+="?");f.isEmptyObject(d)||(b+=f.param(d));g(a.urlParams)||(b+=a.urlParams);this.hotelLocationFilterUrl&&(-1===b.indexOf("?")&&(b+="?"),b+=this.hotelLocationFilterUrl);!this.options.addHtcPlaceParams||g(a.placeName)&&g(a.placeId)||(b+=-1===b.indexOf("?")?"?":"\x26",b+=this.addPlaceParams(a.placeId,a.placeName));return b},addPlaceParams:function(a,b){var c="";g(a)||(c+="placeId\x3d"+a);g(b)||(c+=(g(a)?"":"\x26")+"placeName\x3d"+this.htmlEscape(b));return c},htmlEscape:function(a){var b={"\x26":"\x26amp;",
"\x3c":"\x26lt;","\x3e":"\x26gt;",'"':"\x26quot;","'":"\x26#39;",":":"%3A"};return a.replace(/[&<>"':]/g,function(a){return b[a]})},submitPreload:function(a){if(c.config.getBoolean("ui.submitpreload")&&!this.loadingHistory){var b=this.serialize()||{};b.changed_field=a;b["rooms-input"]=b.rooms;b["guests-input"]=b.guests;b.checkin_date=moment(b.checkInDate,this._dateFormat).format(c.globals.apiDateFormat);b.checkout_date=moment(b.checkOutDate,this._dateFormat).format(c.globals.apiDateFormat);c.action.execute("common.search.PreloadAction",
b)}},validate:function(){var a=this.checkIn.getDate(),b=this.checkOut.getDate();if(!this.options.isSingleHotel&&!this.hasLocationId()&&!this.location.val())return this.options.msg.city;if(null===a)return this.options.msg.checkinDate;if(null===b||a.isAfter(b.subtract(1,"day")))return this.options.msg.checkoutDate;if(g(this.location.val()))return this.options.msg.location},isEnoughInformationForCompareToRequest:function(){if(this.options.cmp2LoadOnChangesOnly&&!this.hasFormChanged()||this.options.loadCmp2WhenVisible&&
!this.element.is(":visible"))return!1;var a=this.hasLocationId()||!g(this.locationType);return!this.options.suppressCmp2s&&a&&void 0===this.validate()},setYandexTracking:function(){if(window.yaCounter16685854)try{window.yaCounter16685854.reachGoal("Hotel_Search_Button_Click")}catch(a){return 0}return 1},toggleAdvanced:function(a){this.shouldUpdate(a)&&(this.options.showNeedIdeasButton&&(!0===a.state?this.needIdeasButton.addClass("hidden"):this.needIdeasButton.removeClass("hidden")),this.element.toggleClass("Advanced",
a.state))},refreshRoomsGuestsDropdownDisplay:function(){var a=c.Common.Utils.String.formatChoice(this.options.msg.roomsChoiceLabel,this.rooms.getValue(),this.rooms.getValue()),b=this.adults.getValue()+this.children.getValue(),b=c.Common.Utils.String.formatChoice(this.options.msg.guestsChoiceLabel,b,b);this.roomsGuestsDropdown.updateLabel(a,b,", ");this.updateHotelPlanner(this.rooms.getValue())},getCompareToFormData:function(){var a=this.serializeForCompareTo();return f.extend({vertical:this.vertical},
a)},submitIntentMedia:function(){"function"===typeof this.intentMediaCallOnSubmit&&this.intentMediaCallOnSubmit.call(null,this.serialize())},updateHotelPlanner:function(a){0<this.options.hotelPlannerTrigger&&(a>=this.options.hotelPlannerTrigger?(this.hotelPlanner.addClass("visible"),f(this.element).is(".Hotels-Search-StyleJamHotelSearchForm")&&c.dom.swapClasses(this.hotelPlanner,c.stylejam.hotels.search.StyleJamRoomsGuestsDropdown.hotelPlannerHidden,c.stylejam.hotels.search.StyleJamRoomsGuestsDropdown.hotelPlannerVisible)):
(this.hotelPlanner.removeClass("visible"),f(this.element).is(".Hotels-Search-StyleJamHotelSearchForm")&&c.dom.swapClasses(this.hotelPlanner,c.stylejam.hotels.search.StyleJamRoomsGuestsDropdown.hotelPlannerVisible,c.stylejam.hotels.search.StyleJamRoomsGuestsDropdown.hotelPlannerHidden)))},showTooltip:function(a,b){a.toolTip({content:b,position:"right",showImmediately:!0})},clearTooltips:function(){this.rooms.incrButton.data("toolTip")&&this.rooms.incrButton.data("toolTip").removeWidget();this.guests&&
this.guests.incrButton.data("toolTip")&&this.guests.incrButton.data("toolTip").removeWidget();this.children&&this.children.incrButton.data("toolTip")&&this.children.incrButton.data("toolTip").removeWidget();this.adults&&this.adults.incrButton.data("toolTip")&&this.adults.incrButton.data("toolTip").removeWidget()},needIdeas:function(){var a=f(".destinationTiles");f("html, body").animate({scrollTop:a.offset().top-10},1200);c.Analytics.api.trackEvent("hotels/form/needidesbutton")},autofocus:function(){this.options.autofocusDestination&&
this.location.focus()},getStorageExceptions:function(){},isValidDates:function(){if(this.checkIn&&0===this.checkIn.getValue()){var a=1,b=2;c&&c.config&&(a=c.config.getInt("ui.horizon.hotels.search.form.checkIn.date.adjustment",a),b=c.config.getInt("ui.horizon.hotels.search.form.checkOut.date.adjustment",b));a=moment().startOf("day").add(a,"d");b=moment().startOf("day").add(b,"d");b={id:this.id(),checkInDate:a,checkOutDate:b,silent:!0};c.events.publish("hotels.frontdoor.form.dates",b)}},hasLocationId:function(){return[this.hotelId,
this.cityId,this.neighbourhoodId,this.regionId,this.freeRegionId,this.subRegionId,this.landmarkId,this.countryId].some(function(a){return null!==a&&!g(a.val?a.val():a)})},focusFirstElement:function(){this.location.get(0).focus()}})})(window.R9,window.jQuery);(function(d,e){function g(a){return a?"string"===typeof a&&(""===a.trim()||0>=parseInt(a)):!0}var l={landmarkId:"lm",countryId:"ctry",hotelId:"hotel",neighbourhoodId:"hood",regionId:"reg",freeRegionId:"freereg",cityId:"city",address:"addr"},n={lm:"landmarkId",ctry:"countryId",hotel:"hotelId",hood:"neighbourhoodId",reg:"regionId",freereg:"freeRegionId",city:"cityId",addr:"address"},m="landmarkId countryId hotelId neighbourhoodId regionId freeRegionId cityId".split(" ");d.createComponentClass("hotels.search.HotelSearchForm",
"base.search.SearchForm",{formQuestion:"hotels.fd.searchform",formCitycodeQuestion:"hotels.fd.searchform.citycode",formCitynameQuestion:"hotels.fd.searchform.cityname",formLocationQuestion:"hotels.fd.searchform.location",formSearchUrlBuilderQuestion:"hotels.fd.searchform.build",travelersDataQuestion:"hotels.searchform.travelers.",numNightsQuestion:"hotels.fd.searchform.numNights",daysOutQuestion:"hotels.fd.searchform.daysOut",options:{slideCMP2:!1,slideCMP2OnReady:!0,isSEM:!1,defaultRooms:1,defaultGuests:5,
defaultAdults:1,defaultChildren:1,flareSmartyType:30,smartyUrl:"/mv/marvel",locationType:"",maxRooms:8,maxGuests:32,maxAdults:32,maxChildren:32,forceOpen:!1,filterTemplateName:null,hotelPlannerTrigger:0,activeHome:!1,useLegacySearchUrl:!1,msg:{location:"",city:"",checkinDate:"",checkoutDate:"",roomsChoiceLabel:"",guestsChoiceLabel:"",roomsOverMax:"",roomsBelowMin:"",guestsOverMax:"",guestsBelowMin:"",useLegacyDatePicker:!0},formQuestion:"hotels.fd.searchform",isSingleHotel:!1,isDisabledAdvanced:!1,
isTravelerTypeEnabled:!1,loggingPrefix:"",belowCalendar:null,goToHotelDetailsPage:!1,keepLocation:!0,showSmartyHistory:!1,maxHistoryItems:5,controlGroup:null,urlParams:void 0,autofocusDestination:!1,autoOpenDatepicker:!1,isFdForm:!1,isRegionSearchEnabled:!1,showNumberboxTooltips:!1,useLocalStorageHistory:!1,numberBoxMsg:{roomsOverMax:function(){var a=this.adults.getValue()+this.children.getValue();return d.Common.Utils.String.formatString(this.options.msg.roomsOverMax,this.rooms.getValue(),a)},roomsBelowMin:function(){var a=
this.adults.getValue()+this.children.getValue();return d.Common.Utils.String.formatChoice(this.options.msg.roomsBelowMin,this.rooms.getValue(),this.rooms.getValue(),a)},guestsOverMax:function(){var a=this.adults.getValue()+this.children.getValue();return d.Common.Utils.String.formatString(this.options.msg.guestsOverMax,a,this.rooms.getValue())},guestsBelowMin:function(){var a=this.adults.getValue()+this.children.getValue();return d.Common.Utils.String.formatChoice(this.options.msg.guestsBelowMin,
a,a,this.rooms.getValue())}},showNeedIdeasButton:!1,showPopularDestinationsList:!1,showPopularDestinationsPictures:!1,searchAutoExecute:!1,searchAutoExecuteAfterCmp2:!1,hasSubscriptionPanel:!1,hotelTravelersDropdownEnabled:!1,useAlgoliaSmarty:!1,colorCodingDescriptions:{low:"",medium:"",high:""}},filtersContainerEl:null,amenity:null,neighbourhoodId:null,neighbourhood:null,ambiance:null,location:null,cityId:null,cityName:null,hotelId:null,freeRegionId:null,regionId:null,countryId:null,locationType:"",
calendarFooter:null,daterangePicker:null,rooms:null,guests:null,adults:null,children:null,roomsGuestsDropdown:null,traveler:null,hotelPlanner:null,cityColors:[],vertical:"hotels",_dateFormat:"YYYY-MM-DD",extraFiltersData:{},advancedFilterState:null,searchFormFilterState:null,lastCheckInDate:null,lastCheckOutDate:null,smartyItemChanged:!1,searchAutoExecuteOnChangeCount:3,searchAutoExecuteChanged:[],cmp2Items:void 0,init:function(){this.base();this.hcPlacesEnabled=d.config.getBoolean("ui.hc.places.enabled",
!1);this.locationType=this.options.locationType||"";this.formQuestion=this.options.formQuestion;this.formCitycodeQuestion=this.formQuestion+".citycode";this.formLocationQuestion=this.formQuestion+".location";this.formSearchUrlBuilderQuestion=this.formQuestion+".build";this.bindDaterangePicker();this.options.hotelTravelersDropdownEnabled||this.bindRoomsGuestsDropdown();this.bindLocationField();this.bindTravelerTypeRadios();if(!this.options.loggedIn&&this.options.privateDealsPromoEnabled){var a=this.getChildElement("privatedeals");
a.on("click",function(a){d.Analytics.api.trackEvent("hotels/form/private-deals-promo/click");d.authentication.showLogin({success:function(){d.Analytics.api.trackEvent("hotels/form/private-deals-promo/success");location.reload()}})});if(this.options.isFdForm){var b=d.storage.get("fd.privatedeals.promo.viewcount");b||(a.addClass("first-time-user"),b=0);d.storage.set("fd.privatedeals.promo.viewcount",++b)}d.Analytics.api.trackEvent("hotels/form/private-deals-promo/impression")}this.options.useDialogQuestions&&
(this.formQuestion+=".dialog",this.formCitycodeQuestion+=".dialog",this.formLocationQuestion+=".dialog");this.filtersContainerEl=this.getChildElement("filtersContainer");this.calendarFooter=this.getChildElement("calendarFooter")},inlineComponentsReady:function(){this.base();this.options.autoOpenDatepicker&&this.openDatepicker();d.globals&&d.globals.isSeo&&this.isValidDates();this.element.is(":visible")&&this.options.slideCMP2OnReady&&this.loadSlideCMP2()},vsLog:function(a){this.searchForm.is(":visible")&&
0<=this.searchForm.offset().top&&"complete"===document.readyState&&d.Analytics.api.trackEvent(["hotels/form",a].join("/"))},addEventHandlers:function(){this.base();var a=this;this.subscribe("hotels.frontdoor.form.location hotels.frontdoor.form.rooms hotels.frontdoor.form.guests hotels.frontdoor.form.guests.adults hotels.frontdoor.form.guests.children hotels.frontdoor.form.guests.childrenAges hotels.frontdoor.form.dates hotels.frontdoor.form.traveler hotels.frontdoor.form.all cmp2.form.fill".split(" "),
e.proxy(this.onChange,this));this.bindAdvancedFilter();this.subscribe("hotels.frontdoor.form.location hotels.frontdoor.form.rooms hotels.frontdoor.form.guests hotels.frontdoor.form.guests.adults hotels.frontdoor.form.guests.children hotels.frontdoor.form.guests.childrenAges hotels.frontdoor.form.dates hotels.frontdoor.form.traveler hotels.frontdoor.form.all cmp2.form.fill".split(" "),{id:this.id()},e.proxy(this.onInternalChange,this));this.options.showColorCoded&&(this.subscribe("hotels.frontdoor.form.location",
function(){a.updateCalendarColors()}),this.subscribe("DatePicker.summon",function(){a.updateCalendarColors()}),this.subscribe("DatePicker.opened",function(){a.updateCalendarColors()}),this.subscribe("Calendar.monthchange",function(){a.updateCalendarColors()}));this.subscribe("hotels.frontdoor.filter.TOGGLE",e.proxy(this.toggleAdvanced,this));this.subscribe("intentmedia.submit.handler",e.proxy(this.onHookSubmitForIntentMedia,this));this.subscribe("hotels.frontdoor.form.autoSubmit",this.autoSubmit.bind(this));
this.subscribe("omni.vertical.changed",function(b){"hotels"===b&&a.focusFirstElement()});this.answer(this.formQuestion,function(){return a.serialize()});this.answer(this.formSearchUrlBuilderQuestion,function(b){b=e.extend({},a.serialize(),b);return a.buildSearchURL(b)});this.answer(this.formLocationQuestion,function(){var b="\x3cdiv\x3e"+a.location.val()+"\x3c/div\x3e";return e(b).text()});this.answer(this.formCitycodeQuestion,function(){return a.cityId.val()});this.answer(this.formCitynameQuestion,
function(){return a.cityName.val()});this.answer("hotels.results.searchType",this.getSearchType.bind(this));this.answer("hotels.results.locationId",this.getLocationId.bind(this));this.answer(this.numNightsQuestion,this.calculateNumNights.bind(this));this.answer(this.daysOutQuestion,this.calculateDaysOut.bind(this));this.options.showNeedIdeasButton&&(this.needIdeasButton=this.getChildElement("need-ideas"),this.needIdeasButton.click(this.needIdeas),a.needIdeasButton.removeClass("hidden"));this.options.searchAutoExecuteAfterCmp2&&
this.subscribe("cmp2.rendering.finished",function(b){!a.isNewCmp2CheckAdded(b)&&a.canExecuteAutoSearch()&&(a.searchAutoExecuteChanged=[],a.onSubmit())});if(this.options.slideCMP2){var b=this;this.subscribe("hotels.frontdoor.form.location hotels.frontdoor.form.rooms hotels.frontdoor.form.guests hotels.frontdoor.form.guests.adults hotels.frontdoor.form.guests.children hotels.frontdoor.form.guests.childrenAges hotels.frontdoor.form.dates hotels.frontdoor.form.traveler hotels.frontdoor.form.all cmp2.form.fill".split(" "),
function(){b.enableSearchButton()})}this.subscribe("form.clear.location.inputs",this.clearLocationInputs.bind(this));this.options.hotelTravelersDropdownEnabled||(this.subscribe("hotels.frontdoor.rooms.onChange",{namespace:this.id()},this.onRoomsChange.bind(this)),this.subscribe("hotels.frontdoor.guests.onChange",{namespace:this.id()},this.onGuestsChange.bind(this)))},clearLocationInputs:function(){this.location.val("");this.cityId.val("");this.cityName.val("");this.hotelId.val("");this.freeRegionId.val("");
this.regionId.val("");this.landmarkId.val("");this.countryId.val("")},updateCalendarColors:function(){var a=this.cityId.val();""!=a&&"0"!=a?this.fetchPriceColors(a):this.clearColors()},fetchPriceColors:function(a){var b=this,c=e.Deferred(),f=e.Deferred(),h="/api/search/buzzCalendar/hotels/"+a;if(this.cityColors[a])return h=b.processPriceData(this.cityColors[a]),c.resolve(h),h=b.showFooter(),f.resolve(h),c;d.action.executeSkipUrlPrefix(h).done(function(d){if(!d)throw b.clearColors(),Error("No data in price response");
b.cityColors[a]=d;d=b.processPriceData(d);c.resolve(d);d=b.showFooter();f.resolve(d)}).catch(c.reject.bind(this));return c},clearColors:function(){this.belowCalendar=jq(".belowCalendar");this.belowCalendar.addClass("hidden");jq(".col-day").removeClass("low medium high").removeAttr("aria-describedby title")},showFooter:function(){this.belowCalendar=jq(".belowCalendar");0==this.belowCalendar.find("div").length&&this.belowCalendar.addClass("hidden").append(this.calendarFooter.find(".colorCodedFooter"));
this.belowCalendar.removeClass("hidden").addClass("colorCoded");this.belowCalendar.find(".colorCodedFooter").addClass("showing")},processPriceData:function(a){var b=this,c=a.dates;jq(".col-day").removeClass("low").removeClass("medium").removeClass("high");this.belowCalendar=jq(".belowCalendar");Object.keys(c).forEach(function(a){var f=c[a];a=b.strToDate(a).format("x");b.setPriceClasses(a,f);b.setPriceAriaDescription(a,f)})},setPriceClasses:function(a,b){a=jq(".col-day[data-val\x3d'"+a+"']");switch(b){case "LOW":a.addClass("low").removeClass("medium").removeClass("high");
break;case "MEDIUM":a.removeClass("low").addClass("medium").removeClass("high");break;case "HIGH":a.removeClass("low").removeClass("medium").addClass("high")}},setPriceAriaDescription:function(a,b){a=jq(".col-day[data-val\x3d'"+a+"']");var c=this.getColorLegendId(b);c?a.attr("aria-describedby",c):a.removeAttr("aria-describedby");(b=this.getColorDescription(b))?a.attr("title",b):a.removeAttr("title")},getColorLegendId:function(a){switch(a){case "LOW":return this.id("colorCodedLegend-low");case "MEDIUM":return this.id("colorCodedLegend-medium");
case "HIGH":return this.id("colorCodedLegend-high");default:return null}},getColorDescription:function(a){switch(a){case "LOW":return this.options.colorCodingDescriptions.low;case "MEDIUM":return this.options.colorCodingDescriptions.medium;case "HIGH":return this.options.colorCodingDescriptions.high;default:return null}},dateToStr:function(a){return moment(a).format("YYYY-MM-DD")},strToDate:function(a){return moment(a,"YYYY-MM-DD")},refreshHistory:function(){this.options.controlGroup&&this.options.controlGroup.getHistory().update()},
setupLocationFields:function(){this.location=this.getChildElement("location");this.cityId=this.getChildElement("city-id");this.cityName=this.getChildElement("city-name");this.hotelId=this.getChildElement("hotel-id");this.landmarkId=this.getChildElement("landmark-id");this.neighbourhoodId=this.getChildElement("neighborhood-id");this.regionId=this.getChildElement("regionId");this.subRegionId=this.getChildElement("subRegionId");this.freeRegionId=this.getChildElement("freeRegionId");this.countryId=this.getChildElement("countryId");
this.stars=this.getChildElement("star-wrapped");this.price=this.getChildElement("price-wrapped");this.rating=this.getChildElement("rating-wrapped");this.address=this.getChildElement("addr");this.placeId=this.getChildElement("placeId");this.placeName=this.getChildElement("placeName");this.dates=this.daterangePicker},loadSlideCMP2:function(){if(this.options.slideCMP2&&void 0===this.validate()){this.disableSearchButton();var a=this,b=this.serialize()||{};b.relativeUrl=!0;var b=this.buildSearchURL(b),
c={id:this.id("slidecmp2"),url:b};if(this.options.activeHome&&!this.options.slideCMP2PreventRedirect)return d.action.execute("hotels/search/brands/cheapflights/Redirect",{url:b,returnUrl:!0},function(a){window.location.href=a}),!0;d.ajax.execute("common/compareto/slide/SlideCompareToHotels",{customUpdate:function(b){var c=a.getChildElement("slidecmp2");c.attr("class","");c.replaceWith(b.innerHTML);return!0},data:c});return!0}return!1},bindLocationField:function(){var a=this;this.setupLocationFields();
this.options.autoOpenDatepicker&&(e(this.location).on("keyup",function(b){13===b.which&&a.cityId.val()&&a.openDatepicker()}),e(this.location).on("mousedown touchstart",function(){e(this).focus()}));var b={minWidth:420,smartyControlGroup:null,flareSmartyType:a.options.flareSmartyType,dataSource:a.options.smartyUrl,messages:a.options.msg,clearItem:function(){a.smartyItemChanged=!0;a.locationType="";a.cityId.val("");a.cityName.val("");a.landmarkId.val("");a.hotelId.val("");a.neighbourhoodId.val("");
a.freeRegionId.val("");a.regionId.val("");a.countryId.val("");a.address.val("");a.hcPlacesEnabled&&(a.placeName.val(""),a.placeId.val(""));d.events.publish("hotels.frontdoor.form.location",{id:a.id(),locationType:"",location:"",cityId:"",landmarkId:"",hotelId:"",addr:"",placeName:"",placeId:""})},showPopularDestinationsList:a.options.showPopularDestinationsList&&this.options.isFdForm,showPopularDestinationsPictures:a.options.showPopularDestinationsPictures&&this.options.isFdForm,showBackgroundAutocomplete:d.config.getBoolean("ui.common.smarty.background.autocomplete.enabled",
!1),setItem:d.Common.Utils.throttle(50,function(b,c){a.smartyItemChanged=!0;b=c||{};c=b.id||b.lmid||b.hid||b.frid||b.rid||b.cid||b.nhid;a.options.keepHotelIdOnCitySearch&&b.id===a.options.citycode&&"city"===b.type&&(b.hid=b.hid||a.options.hotelId||"",b.hid===a.options.hotelId&&(a.smartyItemChanged=!1));d.events.publish("hotels.frontdoor.form.location",{id:a.id(),location:b.str,locationType:b.type||"",cityId:b.id||(c?"0":""),locationName:b.short_str,landmarkId:b.lmid||(c?"0":""),hotelId:b.hid||(c?
"0":""),freeRegionId:b.frid||(c?"0":""),regionId:b.rid||(c?"0":""),countryId:b.cid||(c?"0":""),neighbourhoodId:b.nhid||(c?"0":""),entityKey:b.entityKey||(c?"0":""),objectID:b.objectID||(c?"0":"")});c=a.options.useLegacyDatePicker?a.dates.endInput.val()&&a.dates.startInput.val():a.checkIn.getValue()&&a.checkOut.getValue();a.options.autoOpenDatepicker&&!c&&a.openDatepicker();a.options.autoSubmit&&b.str&&a.autoSubmit();a.vsLog("location")}),afterDone:function(){""===a.location.val()&&(a.smartyItemChanged=
!0,a.locationType="",a.cityId.val(""),a.cityName.val(""),a.landmarkId.val(""),a.neighbourhoodId.val(""),a.hotelId.val(""),a.freeRegionId.val(""),a.regionId.val(""),a.countryId.val(""),a.address.val(""),a.hcPlacesEnabled&&(a.placeName.val(""),a.placeId.val("")),d.events.publish("hotels.frontdoor.form.location",{id:a.id(),locationType:"",location:"",cityId:"",cityName:"",landmarkId:"",hotelId:"",entityKey:"",objectID:"",placeName:"",placeId:""}))}},c=this.location.data("inputModal");c&&(b.appendTo=
c.getSmartyWrapper(),b.fixedDropdown=!0,b.minWidth=null,b.maxWidth=null);this.checkAndSetDropdownSmartyInnerScrollOpts(b);this.checkAndSetSmartyUIUpdateOpts(b);d.globals.testMode&&(b.windowDataTestTagName="data-test-location-smarty-window",b.windowDataTestTagValue=this.location.attr("id"));this.locationSmarty=(a.options.useAlgoliaSmarty?this.location.algoliaHotelSmarty(b):this.location.hotelSmarty(b)).getWidget()},openDatepicker:function(){var a=this;setTimeout(function(){a.options.useLegacyDatePicker?
a.daterangePicker.startDisplay.trigger("mousedown"):a.checkIn&&a.checkIn.trigger?a.checkIn.trigger("focus"):a.checkIn&&a.checkIn.summonDatePicker&&a.checkIn.summonDatePicker()},25)},bindAdvancedFilter:function(){var a=this;this.subscribe("hotels.frontdoor.form.location",function(b){a.shouldUpdate(b)&&d.events.publish("hotels.frontdoor.updateFilters",b)})},bindDaterangePicker:function(){var a=this,b=function(b){var c=this.serialize();d.events.publish("hotels.frontdoor.form.dates",{id:this.id(),checkInDate:c.checkInDate,
checkOutDate:c.checkOutDate,actOnStart:b});this.vsLog("checkout");a.options.autoSubmit&&a.autoSubmit()};this.options.useLegacyDatePicker?this.daterangePicker=this.getChildElement("stayDates").daterangePicker({getFormData:function(){return e.extend({vertical:a.vertical},a.serialize())},change:function(b,f){b=a.serialize();d.events.publish("hotels.frontdoor.form.dates",{id:a.id(),checkInDate:b.checkInDate,checkOutDate:b.checkOutDate,actOnStart:f});a.vsLog("checkout")},useDaysFormat:!0,alwaysShowEndDatepicker:a.options.autoOpenDatepicker,
nextFieldSelector:"#"+a.id("submit"),secondClickHideDelay:a.options.searchAutoExecute||a.options.searchAutoExecuteAfterCmp2?0:200}).getWidget():(this.checkIn=this.getChildElement("checkIn").getWidget(),this.checkOut=this.getChildElement("checkOut").getWidget(),this.checkIn.options.change=b.bind(this,!0),this.checkOut.options.change=b.bind(this,!1),this.dateRangeInput=this.getChildElement("dateRangeInput").getWidget())},bindRoomsGuestsDropdown:function(){var a=this,b,c;b=this.searchForm.closest(".viewport").find(".content");
c=this.options.phoenixRising?"styleJamDropdownDialog":"dropdownDialog";this.roomsGuestsDropdown=this.getChildElement("roomsGuestsDropdown")[c]({expandTo:this.id("roomsGuestsDropdown-cover"),container:b.length?b:void 0,alignment:this.options.phoenixRising?"left":"right",coverTrigger:this.options.phoenixRising,onOpen:function(){a.roomsGuestChanged=!1;setTimeout(function(){a.rooms.decrButton.focus()},100);a.getChildElement("roomsGuestsDropdown").attr("aria-expanded","true")},onClose:function(b,c,d){b&&
d&&27===d.which&&setTimeout(function(){a.roomsGuestsDropdown.element.focus()},100);a.roomsGuestChanged&&a.options.autoSubmit&&a.autoSubmit();a.getChildElement("roomsGuestsDropdown").attr("aria-expanded","false")}}).getWidget();this.roomsGuestsDropdown.element.off("keydown").keydown(function(b){if(40===b.which||32===b.which)b.preventDefault(),b.stopPropagation(),a.roomsGuestsDropdown.toggleContent(!0)});d.events.subscribe("hotelsearchform.close.roomsGuestsDropdown",function(){a.roomsGuestsDropdown.close()});
this.rooms=this.getChildElement("rooms").numberBox({min:1,max:a.options.maxRooms,defaultValue:a.options.defaultRooms,callback:function(){a.updateBoxButtonStates();a.roomsGuestChanged=!0;d.events.publish("hotels.frontdoor.form.rooms",{id:a.id(),rooms:this.getValue()});a.vsLog("changerooms")}}).getWidget();b=this.rooms.decrButton;this.adults=this.getChildElement("adults").numberBox({min:1,max:a.options.maxAdults,defaultValue:a.options.defaultAdults,callback:function(){a.roomsGuestChanged=!0;d.events.publish("hotels.frontdoor.form.guests.adults",
{id:a.id(),adults:this.getValue()});a.vsLog("changeguests_adults")}}).getWidget();c=(this.children=this.getChildElement("children").numberBox({min:0,max:a.options.maxChildren,defaultValue:a.options.defaultChildren,callback:function(){a.roomsGuestChanged=!0;d.events.publish("hotels.frontdoor.form.guests.children",{id:a.id(),children:this.getValue()});a.vsLog("changeguests_children")}}).getWidget())&&this.children.incrButton;var f=function(b,c){b&&b.off("keydown").keydown(function(b){9===b.which&&(c?
b.shiftKey:!b.shiftKey)&&(b.preventDefault(),b.stopPropagation(),setTimeout(function(){a.roomsGuestsDropdown.element.focus();a.roomsGuestsDropdown.toggleContent(!1)},100))})};f(b,!0);f(c,!1);this.hotelPlanner=this.getChildElement("hotelPlanner");this.hotelPlanner.on("click",function(b){b=a.serialize();d.events.publish("hotelplanner.open",{location:b.location,startDate:b.checkInDate,endDate:b.checkOutDate})});this.updateBoxButtonStates()},updateBoxButtonStates:function(){var a=this.adults.getValue(),
b=this.children.getValue();a+b===Math.min(this.options.maxGuests,4*this.options.maxRooms)?(this.adults.disableIncrement(),this.children.disableIncrement()):(this.adults.enableIncrement(),this.children.enableIncrement())},bindTravelerTypeRadios:function(){if(this.options.isTravelerTypeEnabled&&this.getChildElement("traveler").length){var a=this;this.traveler=this.getChildElement("traveler").radioButtonSet({change:function(b){b="traveler/"+(b.value||"");e.proxy(a.dataChanged,a);a.vsLog(b)}}).getWidget()}},
onHookSubmitForIntentMedia:function(a){a&&"function"===typeof a.callOnSubmit&&(this.intentMediaCallOnSubmit=a.callOnSubmit)},onSubmit:function(a){var b=this.base;if(!this.isSubmitted){this.syncFilters();if(this.loadSlideCMP2()||!1===this.submitSubscription.call(this))return!1;this.setYandexTracking();this.submitIntentMedia();b.call(this,a);this.options.autoSubmit&&(this.isSubmitted=!1)}return!1},isRegionSearch:function(a){return(a.regionId||a.freeRegionId||a.countryId)&&(0!=a.regionId||0!=a.freeRegionId||
0!=a.countryId)},publishSubmitEvent:function(a){a&&a.url&&0<=a.url.indexOf("%s")&&(new d.logger).error("HotelSearchForm submit url has invalid %s parameter");this.isRegionSearch(a)&&this.options.isRegionSearchEnabled?window.location.href="/"+a.url:this.base(a);d.storage.remove("hotelsHideRentalsXSell")},autoSubmit:function(){if(this.checkFormChanges())this.onSubmit()},checkFormChanges:function(){return!1},onChange:function(a){this.shouldUpdate(a)&&(this.updateLogging(a),this.load(a),this.saveToStorage(),
this.refreshHistory())},registerAndCheckAutoSearch:function(a){var b=this,c=function(a,c){var d=b.searchAutoExecuteChanged.indexOf(a);(c=0===c.length)&&-1!==d?b.searchAutoExecuteChanged.splice(d,0):-1!==d||c||b.searchAutoExecuteChanged.push(a)};a.hasOwnProperty("location")&&(b.searchAutoExecuteChanged=[],c("location",a.location));a.hasOwnProperty("checkInDate")&&c("checkInDate",a.checkInDate);a.hasOwnProperty("checkOutDate")&&!a.actOnStart&&c("checkOutDate",a.checkOutDate);return this.canExecuteAutoSearch()},
canExecuteAutoSearch:function(){return!this.element.hasClass("Advanced")&&this.searchAutoExecuteChanged.length===this.searchAutoExecuteOnChangeCount},isNewCmp2CheckAdded:function(a){var b;if(this.cmp2Items){var c=this.cmp2Items;b=function(a){return a.checked&&!c.some(function(b){return a.id===b.id&&b.checked})}}else b=function(a){return a.checked};this.cmp2Items=a.items;return a.items.some(b)},onInternalChange:function(a){if(this.options.searchAutoExecute&&this.registerAndCheckAutoSearch(a))this.searchAutoExecuteChanged=
[],this.onSubmit();else{for(var b=this.options.searchAutoExecuteAfterCmp2&&this.registerAndCheckAutoSearch(a),c="location checkInDate checkOutDate rooms guests adults children traveler refreshCmp2sOnOpen".split(" "),d=0;d<c.length;d++)if(a.hasOwnProperty(c[d])){this.loadCompareToItems();break}if(!b&&(b={location:"location",checkInDate:"checkin",checkOutDate:"checkout",rooms:"rooms",guests:"guests",adults:"adults",children:"children",traveler:"traveler"},c=null,a.hasOwnProperty("checkInDate")&&(a.checkInDate!==
this.lastCheckInDate&&(c="checkInDate"),this.lastCheckInDate=a.checkInDate),a.hasOwnProperty("checkOutDate")&&(a.checkOutDate!==this.lastCheckOutDate&&(c="checkOutDate"),this.lastCheckOutDate=a.checkOutDate),null!==c&&delete a["checkOutDate"===c?"checkInDate":"checkOutDate"],!a.silent))for(var e in b)a.hasOwnProperty(e)&&this.submitPreload(b[e])}},onRoomsChange:function(a){a.rooms>this.rooms.options.max?this.rooms.setValue(this.rooms.options.max,!0):a.rooms<this.rooms.options.min?this.rooms.setValue(this.rooms.options.min,
!0):this.rooms.setValue(a.rooms,!0);a=this.rooms.getValue();var b=this.adults.getValue(),c=this.children.getValue();b<a&&(b=a);4*a<b+c&&(c=4*a-b,0>c&&(c=0,b=4*a));this.children.setValue(c,!0);this.adults.setValue(b,!0);this.refreshRoomsGuestsDropdownDisplay()},calculateNumNights:function(){var a=1,b,c;this.options.useLegacyDatePicker?(b=moment(this.daterangePicker.getStartDate()),c=moment(this.daterangePicker.getEndDate())):(b=this.checkOut.getDate(),c=this.checkIn.getDate());null!=b&&null!=c&&(a=
b.diff(c,"days",!0));return Math.ceil(a)},calculateDaysOut:function(){var a=0,b;b=this.options.useLegacyDatePicker?moment(this.daterangePicker.getStartDate()):this.checkIn.getDate();null!=b&&(a=moment(moment.now()),a=b.diff(a,"days",!0));return Math.ceil(a)},onGuestsFieldChange:function(a){a.guests>this.guests.options.max?this.guests.setValue(this.guests.options.max,!0):a.guests<this.guests.options.min?this.guests.setValue(this.guests.options.min,!0):this.guests.setValue(a.guests,!0);a=this.guests.getValue();
var b=this.rooms.getValue();4*b<a?(b=Math.ceil(a/4),this.rooms.setValue(b),this.options.showNumberboxTooltips&&this.showTooltip(this.guests.incrButton,this.options.numberBoxMsg.guestsOverMax.call(this))):b>a?(this.rooms.setValue(a),this.options.showNumberboxTooltips&&this.showTooltip(this.guests.incrButton,this.options.numberBoxMsg.guestsBelowMin.call(this))):this.options.showNumberboxTooltips&&this.clearTooltips();this.refreshRoomsGuestsDropdownDisplay()},onAdultsFieldChange:function(a){a.adults>
this.adults.options.max?this.adults.setValue(this.adults.options.max,!0):a.adults<this.adults.options.min?this.adults.setValue(this.adults.options.min,!0):this.adults.setValue(a.adults,!0);var b=this.adults.getValue();a=this.children.getValue();var c=this.rooms.getValue(),d=Math.ceil((b+a)/4);d>b&&(d=b);c<d?c=d:c>b&&(c=b,b=4*c-b,a=b<a?b:a);this.children.setValue(a,!0);this.rooms.setValue(c,!0);this.refreshRoomsGuestsDropdownDisplay()},onChildrenFieldChange:function(a){a.children>this.children.options.max?
this.children.setValue(this.children.options.max,!0):a.children<this.children.options.min?this.children.setValue(this.children.options.min,!0):this.children.setValue(a.children,!0);a=this.adults.getValue();var b=this.children.getValue(),c=this.rooms.getValue(),b=Math.ceil((b+a)/4);c<b&&(c=b);c>a&&(a=c);this.adults.setValue(a,!0);this.rooms.setValue(c,!0);this.refreshRoomsGuestsDropdownDisplay()},onGuestsChange:function(a){var b,c;"undefined"!==typeof a.guests?(b=a.guests,c=0):(b=a.adults,c=a.children);
if("undefined"!==typeof b)this.onAdultsFieldChange(a);else if("undefined"!==typeof c)this.onChildrenFieldChange(a)},getExtraFilterData:function(){var a=d.question.ask("hotels.frontdoor.filter.DATA");this.extraFiltersData=a||{};var b={};if(null!=a&&("0"!==a.stars||"-10"!==a.rating||a.price&&a.price.max!==a.price.min||null!=a.priceType)){if("0"!==a.stars){b.stars={};var c=parseInt(a.stars);[0,2,3,4,5].forEach(function(a){b.stars[a]=a>=c?1:0})}if("-10"!==a.rating){b.rating={};var e={horrible:20,mediocre:40,
okay:60,good:80,excellent:100},g;for(g in e)if(e.hasOwnProperty(g)){var k=parseInt(a.rating);b.rating[g]=k<=e[g]?1:0}}a.price&&a.price.max!==a.price.min&&(b.price={min:parseInt(a.price.min),max:parseInt(a.price.max)});null!=a.priceType&&(b.priceType={code:a.priceType})}this.advancedFilterState=b},syncFilters:function(){var a=this;this.getExtraFilterData();this.advancedFilterState&&Object.keys(this.advancedFilterState).forEach(function(b){d.events.publish("resultspage.filters.sync",{name:b,state:a.advancedFilterState[b]})})},
serialize:function(){var a=this.base(),b,c;this.options.useLegacyDatePicker?(b=moment(this.daterangePicker.getStartDate()),c=moment(this.daterangePicker.getEndDate())):(b=moment(this.checkIn.getDate()),c=moment(this.checkOut.getDate()));this.getExtraFilterData();var f;this.options.hotelTravelersDropdownEnabled?f=d.question.ask(this.travelersDataQuestion+this.id("form")):(f={adults:this.adults.getValue(),children:this.children.getValue()},e.extend(f,{rooms:this.rooms.getValue()}));this.advancedFilterState&&
this.advancedFilterState.hasOwnProperty("priceType")&&this.advancedFilterState.priceType.code&&(a.priceType=this.advancedFilterState.priceType.code);a.goToHotelDetailsPage=this.options.goToHotelDetailsPage&&this.smartyItemChanged;e.extend(a,{locationType:this.locationType,location:this.location.val(),cityId:this.cityId.val(),landmarkId:this.landmarkId.val(),hotelId:this.hotelId.val(),checkInDate:b.format(this._dateFormat),checkOutDate:c.format(this._dateFormat),freeRegionId:this.freeRegionId.val(),
amenity:this.amenity,regionId:this.regionId.val(),countryId:this.countryId.val(),neighbourhoodId:this.neighbourhoodId.val(),neighbourhood:this.neighbourhood,ambiance:this.ambiance,address:this.address.val(),searchType:"C",citycode:this.cityId.val(),applyFilters:!0,filterState:JSON.stringify(this.advancedFilterState)},f);this.options.addHtcPlaceParams&&e.extend(a,{placeName:this.placeName.val(),placeId:this.placeId.val()});this.locationType!==l.address&&this.hasLocationId()||e.extend(a,{searchType:"A",
address:this.location.val()});return a},serializeForCompareTo:function(){var a=this.serialize();delete a.checkInDate;delete a.checkOutDate;this.options.useLegacyDatePicker?(a.checkin_date=moment(this.daterangePicker.getStartDate()).format(d.globals.apiDateFormat),a.checkout_date=moment(this.daterangePicker.getEndDate()).format(d.globals.apiDateFormat)):(a.checkin_date=moment(this.checkIn.getDate()).format(d.globals.apiDateFormat),a.checkout_date=moment(this.checkOut.getDate()).format(d.globals.apiDateFormat));
a.lmid=a.landmarkId;a.hid=a.hotelId;a.frid=a.freeRegionId;a.rid=a.regionId;a.cid=a.countryId;a.nhid=a.neighbourhoodId;return a},load:function(a){a.hasOwnProperty("searchDialog")&&a.searchDialog&&this.resetFieldsForSearchDialog();a.locationType&&(this.locationType=a.locationType);a.locationName&&this.cityName.val(a.locationName);a.location&&this.location.val(a.location);a.cityId&&this.cityId.val(a.cityId);a.landmarkId&&this.landmarkId.val(a.landmarkId);a.hotelId&&this.hotelId.val(a.hotelId);a.freeRegionId&&
this.freeRegionId.val(a.freeRegionId);a.regionId&&this.regionId.val(a.regionId);a.countryId&&this.countryId.val(a.countryId);a.neighbourhoodId&&this.neighbourhoodId.val(a.neighbourhoodId);this.hcPlacesEnabled&&(a.entityKey&&this.placeName.val(a.entityKey),a.objectID&&this.placeId.val(a.objectID));if(a.checkInDate){var b=moment(a.checkInDate,this._dateFormat);b.isValid()&&(this.options.useLegacyDatePicker?this.daterangePicker.setStartDate(b):this.checkIn.setDate(b))}a.checkOutDate&&(b=moment(a.checkOutDate,
this._dateFormat),b.isValid()&&(this.options.useLegacyDatePicker?this.daterangePicker.setEndDate(b):this.checkOut.setDate(b)));a.rooms&&d.events.publish("hotels.frontdoor.rooms.onChange",e.extend({namespace:this.id()},a));"undefined"===typeof a.guests&&"undefined"===typeof a.adults&&"undefined"===typeof a.children||d.events.publish("hotels.frontdoor.guests.onChange",e.extend({namespace:this.id()},a));this.options.hotelTravelersDropdownEnabled&&this.options.specifyChildAges&&"undefined"!==typeof a.childrenAges&&
d.events.publish("hotels.frontdoor.childrenAges.onChange",e.extend({namespace:this.id()},a));a.urlParams&&(this.options.urlParams=a.urlParams);a.stars&&(this.options.stars=a.stars);this.options.hotelTravelersDropdownEnabled||(this.refreshRoomsGuestsDropdownDisplay(),this.updateBoxButtonStates())},resetFieldsForSearchDialog:function(){this.options.keepLocation||(this.locationType="",this.location.val(""),this.cityId.val(""),this.cityName.val(""),this.landmarkId.val(""),this.hotelId.val(""),this.address.val(""));
this.freeRegionId.val("");this.regionId.val("");this.countryId.val("");this.neighbourhoodId.val("")},getCookieData:function(){var a=this.base();this.options.isDisabledAdvanced||(this.extraFiltersData.price&&(a.filterMinPrice=this.extraFiltersData.price.min,a.filterMaxPrice=this.extraFiltersData.price.max),a.filterPriceType=this.extraFiltersData.priceType,a.filterMinStars=this.extraFiltersData.stars,a.filterMinGuestRating=this.extraFiltersData.rating);return a},loadFromHistory:function(a){this.options.useLocalStorageHistory&&
this.base(a);a=this.localHistory.reduceTravelersObjectToTotal();0<a&&(a={guests:a,rooms:Math.min(Math.max(this.rooms.getValue(),Math.ceil(a/4)),a)},this.load(a))},getStorageProps:function(){return"checkInDate checkOutDate location locationType cityId landmarkId hotelId rooms guests searchType".split(" ")},buildSearchURL:function(a){if(this.options.useLegacySearchUrl)return this.legacyBuildSearchUrl(a);d.storage.remove("hotels.results.saveToTrips.tripId");var b={urlPrefix:d.config.getString("ui.hotels.searchUrlPath",
"hotels").replace(/\//g,""),location:a.location,ctid:a.cityId,frid:a.freeRegionId,srid:a.subRegionId,rid:a.regionId,cid:a.countryId,hid:a.hotelId,lmid:a.landmarkId,nhid:a.neighbourhoodId,adults:a.adults,children:a.children,childAges:a.childrenAges,rooms:a.rooms,checkin:a.checkInDate,checkout:a.checkOutDate,address:a.address,amenity:a.amenity,minStars:a.minStars,stars:this.options.stars,view:d.question.ask("hotels.resultspage.pageView"),goToHotelDetailsPage:this.options.goToHotelDetailsPage,smartyItemChanged:this.smartyItemChanged,
fromRatesTable:a.detailsPage,useFullSearchUrl:d.globals&&d.globals.useFullSearchUrl};this.options.addHtcPlaceParams&&(b.placeName=a.placeName,b.placeId=a.placeId);return d.hotels.search.HotelSearchFormUrls.generateUrl(b,this.getSearchFormFilterState())},getSearchFormFilterState:function(){return e.extend({},this.searchFormFilterState)},legacyBuildSearchUrl:function(a){d.storage.remove("hotels.results.saveToTrips.tripId");var b=[d.config.getString("ui.hotels.searchUrlPath","hotels").replace(/\//g,
"")],c=a.location,f=[],h="-c%s";this.options.isRegionSearchEnabled&&this.isRegionSearch(a)&&!a.preserveFilters&&b.push("region");var k=a.address||"";g(k)||(c=k,-1==k.indexOf(a.location)&&(c+=","+a.location),h="-a%s");void 0!==c&&(c=c.replace("/",""));f.push(d.utils.search.encodeLocation(c));g(a.freeRegionId)?g(a.regionId)?g(a.countryId)?g(a.cityId)||f.push(h.format(a.cityId)):f.push("-u%s".format(a.countryId)):f.push("-r%s".format(a.regionId)):f.push("-e%s".format(a.freeRegionId));g(a.hotelId)?g(a.landmarkId)?
g(a.neighbourhoodId)||f.push("-n%s".format(a.neighbourhoodId)):f.push("-l%s".format(a.landmarkId)):(f.push("-h%s".format(a.hotelId)),(this.options.goToHotelDetailsPage&&this.smartyItemChanged||a.detailsPage)&&f.push("-details"));g(a.amenity)||f.push("-f%s".format(a.amenity));b.push(f.join(""));g(a.checkInDate)||g(a.checkOutDate)||(b.push(a.checkInDate),b.push(a.checkOutDate));a.adults&&b.push("%sadults".format(a.adults));a.children&&(this.options.specifyChildAges&&this.options.hotelTravelersDropdownEnabled&&
a.childrenAges?b.push("%schildren-%s".format(a.children,a.childrenAges)):b.push("%schildren".format(a.children)));1<a.rooms&&b.push("%srooms".format(a.rooms));b=b.join("/");c={};g(a.neighbourhood)?g(a.ambiance)||(c=e.extend(c,{ambiance:a.ambiance,filterType:"A"})):c=e.extend(c,{neighborhood:a.neighbourhood,filterType:"N"});if(!g(this.options.urlParams))try{c=e.extend(c,JSON.parse(this.options.urlParams))}catch(p){}this.options.isRegionSearchEnabled&&a.preserveFilters&&this.options.multiCityIds&&this.isRegionSearch(a)&&
(c=e.extend(c,{ids:this.options.multiCityIds}));e.isEmptyObject(c)||(b+="?"+e.param(c));return b},submitPreload:function(a){if(d.config.getBoolean("ui.submitpreload")&&!this.loadingHistory){var b=this.serialize()||{};b.changed_field=a;b["rooms-input"]=b.rooms;b["guests-input"]=b.guests;b.checkin_date=moment(b.checkInDate,this._dateFormat).format(d.globals.apiDateFormat);b.checkout_date=moment(b.checkOutDate,this._dateFormat).format(d.globals.apiDateFormat);d.action.execute("common.search.PreloadAction",
b)}},validate:function(){var a=this.options.useLegacyDatePicker?this.daterangePicker.getStartDate():this.checkIn.getDate(),b=this.options.useLegacyDatePicker?this.daterangePicker.getEndDate():this.checkOut.getDate();if(!this.options.isSingleHotel&&!this.hasLocationId()&&!this.location.val())return this.options.msg.city;if(null===a)return this.options.msg.checkinDate;if(null===b||moment(a).isAfter(moment(b).subtract(1,"day")))return this.options.msg.checkoutDate;if(g(this.location.val()))return this.options.msg.location;
if(this.options.hasSubscriptionPanel&&(a=this.notValidSubscription())&&a.length)return a},isEnoughInformationForCompareToRequest:function(){if(this.options.loadCmp2WhenVisible&&!this.element.is(":visible"))return!1;var a=this.hasLocationId()||!g(this.locationType);return!this.options.suppressCmp2s&&a&&void 0===this.validate()},setYandexTracking:function(){if(window.yaCounter16685854)try{yaCounter16685854.reachGoal("Hotel_Search_Button_Click")}catch(a){}},toggleAdvanced:function(a){this.shouldUpdate(a)&&
(this.options.showNeedIdeasButton&&(!0===a.state?this.needIdeasButton.addClass("hidden"):this.needIdeasButton.removeClass("hidden")),this.element.toggleClass("Advanced",a.state))},refreshRoomsGuestsDropdownDisplay:function(){var a=d.Common.Utils.String.formatChoice(this.options.msg.roomsChoiceLabel,this.rooms.getValue(),this.rooms.getValue()),b=this.adults.getValue()+this.children.getValue(),b=d.Common.Utils.String.formatChoice(this.options.msg.guestsChoiceLabel,b,b);this.roomsGuestsDropdown.updateLabel(a,
b,", ");this.updateHotelPlanner(this.rooms.getValue())},getCompareToFormData:function(){var a=this.serializeForCompareTo();return e.extend({vertical:this.vertical},a)},submitIntentMedia:function(){"function"===typeof this.intentMediaCallOnSubmit&&this.intentMediaCallOnSubmit.call(null,this.serialize())},updateHotelPlanner:function(a){0<this.options.hotelPlannerTrigger&&(a>=this.options.hotelPlannerTrigger?this.hotelPlanner.addClass("visible"):this.hotelPlanner.removeClass("visible"))},showTooltip:function(a,
b){a.toolTip({content:b,position:"right",showImmediately:!0})},clearTooltips:function(){this.rooms.incrButton.data("toolTip")&&this.rooms.incrButton.data("toolTip").removeWidget();this.guests&&this.guests.incrButton.data("toolTip")&&this.guests.incrButton.data("toolTip").removeWidget();this.children&&this.children.incrButton.data("toolTip")&&this.children.incrButton.data("toolTip").removeWidget();this.adults&&this.adults.incrButton.data("toolTip")&&this.adults.incrButton.data("toolTip").removeWidget()},
needIdeas:function(){var a=e(".destinationTiles");e("html, body").animate({scrollTop:a.offset().top-10},1200);d.Analytics.api.trackEvent("hotels/form/needidesbutton")},autofocus:function(){this.options.autofocusDestination&&this.location.focus()},getStorageExceptions:function(){},isValidDates:function(){if(!this.options.useLegacyDatePicker&&this.checkIn&&0===this.checkIn.getValue()){var a=1,b=2;d&&d.config&&(a=d.config.getInt("ui.horizon.hotels.search.form.checkIn.date.adjustment",a),b=d.config.getInt("ui.horizon.hotels.search.form.checkOut.date.adjustment",
b));a=moment().startOf("day").add(a,"d");b=moment().startOf("day").add(b,"d");b={id:this.id(),checkInDate:a,checkOutDate:b,silent:!0};d.events.publish("hotels.frontdoor.form.dates",b)}},hasLocationId:function(){return[this.hotelId,this.cityId,this.neighbourhoodId,this.regionId,this.freeRegionId,this.landmarkId,this.countryId].some(function(a){return null!==a&&!g(a.val?a.val():a)})},getSearchType:function(){var a=this.serialize();if(this.address&&this.address.val())return"addr";for(var b=0;b<m.length;b++){var c=
m[b];if(!g(a[c]))return l[c]}return"addr"},getLocationId:function(){var a=this.getSearchType();return"hood"===a?this.neighbourhoodId:this[n[a]].val()},focusFirstElement:function(){this.location.get(0).focus()}})})(window.R9,window.jQuery);(function(b){b.createComponentClass("hotels.search.brands.hotelscombined.HotelSearchForm","hotels.search.StyleJamHotelSearchForm",{options:{eventNamespace:"htc.hotels.form.default",addHtcPlaceParams:!1},checkInIcon:null,checkOutIcon:null,datePickerShown:!1,groupId:"",init:function(){this.base();this.hideButton=this.getChildElement("hideButton");this.checkInIcon=this.getChildElement("checkInIcon");this.groupId=(this.checkOutIcon=this.getChildElement("checkOutIcon"))&&this.checkOutIcon.data()?this.checkOutIcon.data().group:
""},addEventHandlers:function(){this.base();var a=this;b.question.answer(this.options.eventNamespace+".isValid",function(){return this.isDataValid()}.bind(this));b.question.answer(this.options.eventNamespace+".serializeAndBuild",function(){return this.buildSearchURL(this.serialize())}.bind(this));this.subscribe("DatePicker.opened",a.groupId,function(){a.datePickerShown=!0});this.subscribe("DatePicker.closed",{group:a.groupId},function(){a.datePickerShown=!1});this.checkInIcon.on("click",this.toggleDatePicker("startDate"));
this.checkOutIcon.on("click",this.toggleDatePicker("endDate"));this.hideButton.on("click",function(){b.events.publish("hideHtcResultForm")})},isDataValid:function(){return moment(this.checkIn.getDate()).isValid()&&moment(this.checkOut.getDate()).isValid()},onSubmit:function(a){this.base(a);this.enableSearchButton()},toggleDatePicker:function(a){var d=this;return function(c){d.datePickerShown?b.events.publish("DateInput.dismiss",{modal:!1,sticky:!1,updateGroup:c.target.dataset.group,group:c.target.dataset.group,
field:a}):b.events.publish("DateInput.summon",{modal:!1,sticky:!1,updateGroup:c.target.dataset.group,group:c.target.dataset.group,field:a});c.stopPropagation()}}})})(window.R9);(function(c,e,f){c.publish("common.utils.history.UserHistory",f.extend({constructor:function(a){this.options=e.extend({},this.options,a);this.init()},pageTab:"other",wasLastUsedPage:!1,searchHistoryLimit:3,options:{defaultCookiExpire:10,defaultSearchExpire:100,persistLocalStorage:!0,onSave:e.noop},_storageTemplate:{sticky:{origin:"",destination:"",guests:"",depart_date:"",return_date:"",travelersObject:""},lastUsedTab:"",canary:4},_storageKey:"BKHISTORY2",hasSearchHistory:!1,searchHistoryMoreRecent:!1,
_loadStorageInstance:function(){var a=this._storageTemplate.canary,b=c.storage.get(this._storageKey);c.common.utils.history.UserHistory.storageSync=b&&b.canary&&b.canary===a?b:e.extend(!0,{},this._storageTemplate)},getStorage:function(){c.common.utils.history.UserHistory.storageSync||(c.common.utils.history.UserHistory.storageSync=e.extend(!0,{},this._storageTemplate));return c.common.utils.history.UserHistory.storageSync},initStorageInstance:function(){var a=this.getStorage();a[this.pageTab]||(a[this.pageTab]=
{searches:[],last_updated:null},c.storage.set(this._storageKey,a))},_createExpirationTimestamp:function(a){return moment().add(a||0,"hours").toDate()},init:function(){this.dirty=!1;this.pageTab=this.options.tab||this.pageTab;this._loadStorageInstance();this.initStorageInstance();this.getStorage().lastUsedTab===this.pageTab&&(this.wasLastUsedPage=!0);this.evictExpiredSearches();var a=this.getStorage()[this.pageTab];a&&a.searches&&0<a.searches.length&&(this.hasSearchHistory=!0,a.last_updated&&a.searches[0]&&
1>moment(a.last_updated).diff(a.searches[0].createdAt)&&(this.searchHistoryMoreRecent=!0));var b=this;e(window).bind("beforeunload",function(){try{b.save()}catch(d){}})},save:function(){if(this.dirty)try{this.options.onSave.call(this),this.dirty&&this.options.persistLocalStorage&&(this.dirty=!1,this.getStorage().lastUsedTab=this.pageTab,this.getStorage().common=this.common,c.storage.set(this._storageKey,this.getStorage()))}catch(a){return!1}return!0},get:function(a){if(this.getStorage()[this.pageTab])return this.getStorage()[this.pageTab][a]},
set:function(a,b){var d=this.getStorage()[this.pageTab];d&&d[a]!==b&&(this.dirty=!0,d.last_updated=this._createExpirationTimestamp(),d[a]=b);clearTimeout(this._saveTimeout);this._saveTimeout=setTimeout(e.proxy(this,"save"),100)},reduceTravelersObjectToTotal:function(){var a=0;if(this.getStorage().sticky){var b=this.getStorage().sticky.travelersObject;b&&(a+=parseInt(b.adults),a+=parseInt(b.youth),a+=parseInt(b.children),a+=parseInt(b.infants),a+=parseInt(b.lapinfants),a+=parseInt(b.seniors))}return a},
getRecentHistory:function(){var a=this.getStorage()[this.pageTab],b=this.hasSearchHistory&&this.searchHistoryMoreRecent&&a&&a.searches?a.searches[0]:null;if(!b&&a&&(!a.last_updated||moment().diff(a.last_updated,"hours")<this.options.defaultSearchExpire)){var b={},d;for(d in a)a.hasOwnProperty(d)&&(b[d]=this.get(d));delete b.last_updated;delete b.searches}return b},evictExpiredSearches:function(){var a=this.getStorage(),b=a[this.pageTab]?a[this.pageTab].searches:null,d=this;b&&0!==b.length&&(b.length>
this.searchHistoryLimit&&a[this.pageTab].searches&&(b=b.slice(0,this.searchHistoryLimit)),a[this.pageTab].searches=b.filter(function(a){return!d._shouldExpire(a.expiresBy)}))},pushSearchHistory:function(a){var b=this.getStorage();b[this.pageTab]&&b[this.pageTab].searches&&(a.expiresBy=this._createExpirationTimestamp(this.options.defaultSearchExpire),a.createdAt=this._createExpirationTimestamp(),b[this.pageTab].searches.splice(0,0,a),this.dirty=!0);this.save()},_shouldExpire:function(a){return 0<moment().diff(moment(a))},
purge:function(){c.storage.remove(this._storageKey);c.common.utils.history.UserHistory.storageSync=null;this.initStorageInstance();this.options.persistLocalStorage=!1},pushHotelInteractHistoryItem:function(a,b,d){var c=this.getStorage()[this.pageTab];c&&(this.dirty=!0,c.last_updated=this._createExpirationTimestamp(),c[a]?(c[a]=c[a].filter(function(a){return a.hotelId!==b.hotelId}),c[a].length>=d&&c[a].pop()):c[a]=[],c[a].push(b),this.save())}}))})(R9,jQuery,base2.Base);(function(b,d){b.createComponentClass("common.results.filters.FilterResultsCount",{resetLink:void 0,count:void 0,total:void 0,filtered:void 0,resultsCount:null,placeholder:null,hasCountData:!1,options:{addResetType:!1},init:function(){this.resetLink=this.getChildElement("reset");this.count=this.getChildElement("count");this.ariaStatus=this.getChildElement("aria-status");this.total=this.count.find(".total");this.ariaTotal=this.ariaStatus.find(".total");this.filtered=this.count.find(".filtered, .available");
this.ariaFiltered=this.ariaStatus.find(".filtered, .available");this.resultsCount=this.getChildElement("resultsCount");this.placeholder=this.getChildElement("placeholder")},addEventHandlers:function(){var a=this;this.resetLink.click(function(){var c={};!0===a.options.addResetType&&(c=d.extend({type:"reset"},c));b.events.publish("filters.reset",c);b.Analytics.api.trackEvent({category:"Filter-Results-Count",action:"click",label:"master-reset"})});this.resetLink.keypress(function(c){switch(c.which){case b.globals.keyCodes.SPACE:case b.globals.keyCodes.RETURN:a.resetLink.click()}});
this.subscribe(["search.startSearch","resultspage.streaming.start"],this.streamingStarted.bind(this));this.subscribe(["resultspage.streaming.done","resultspage.filters.show"],this.showResultsCount.bind(this));this.subscribe("search.poll.response",this.getResultsCount.bind(a));this.subscribe("resultspage.filterList.show",this.showResultsCount.bind(this));this.subscribe("search.searchFailed",this.hideAll.bind(this))},getResultsCount:function(a){null!=a&&a.hasOwnProperty("totalCount")&&a.hasOwnProperty("filteredCount")?
(this.ariaTotal.text(a.totalCount),this.total.text(a.totalCount),this.ariaFiltered.text(a.filteredCount),this.filtered.text(a.filteredCount),this.hasCountData=!0):a.secondPhaseWait||(this.hasCountData=!0)},streamingStarted:function(){this.hasCountData=!1;this.hideResultsCount()},showResultsCount:function(){this.ariaStatus.removeClass("hidden");this.ariaStatus.attr("aria-busy",!1);this.resultsCount.removeClass("hidden");this.placeholder.addClass("hidden")},hideResultsCount:function(){this.ariaStatus.removeClass("hidden");
this.ariaStatus.attr("aria-busy",!0);this.resultsCount.addClass("hidden");this.placeholder.removeClass("hidden")},hideAll:function(){this.ariaStatus.addClass("hidden");this.resultsCount.addClass("hidden");this.placeholder.addClass("hidden")}})})(window.R9,window.jQuery);(function(c,d){c.createComponentClass("common.results.filters.Filter",{name:null,data:null,title:null,content:null,searchCompleted:!1,options:{name:null,title:null,title2:null,collapsible:!1,collapsed:!1,isDropdown:!1,mobileView:!1,logUserInteraction:!0,logFiltersQuestion:"",loggingType:"ga",loggingPrefix:"filters",loggingAction:null,loggingLabel:null,resetInTitle:!1,triggerFilteredLabel:!1,useFilterLabelHidesReset:!1,refreshFilterPosOnCollapse:!1,hasPlaceholder:!1,infoTooltip:null,infoTooltipExtraClass:null,
showApplyAll:!1,trackEnabled:!1,showOnSearchFailed:!1,useMcFlyStyling:!1},trackingType:null,trackCategory:"filters",dirty:!1,resetButton:null,enabled:null,interactable:null,previousFilters:{},init:function(){this.data={};this.name=this.options.name;this.title=this.getChildElement("title");this.content=this.getChildElement("content");if(void 0===this.name||""===this.name)throw"Error initializing Javascript filter: a filter name was not provided";this.options.infoTooltip&&this.getChildElement("info").toolTip({content:this.options.infoTooltip,
position:"top",showImmediately:!1,extraClass:this.options.infoTooltipExtraClass});this.trackingType=this.getTrackingType();c.question.answer("filters."+this.name+".state",function(){return this.getState()}.bind(this))},inlineComponentsReady:function(){this.options.collapsible&&!this.options.collapsed&&this.element.addClass("open")},addEventHandlers:function(){var a=this;this.subscribe("resultspage.filtersData.changed",this.filterDataChanged.bind(this));var b=this.reset.bind(this);this.subscribe("filters.reset",
b);this.subscribe("filter.reset",{name:this.name},b);this.subscribe(["resultspage.streaming.done","resultspage.filtersData.changed"],function(){a.element.toggleClass("hidden",a.element.hasClass("empty"))});this.subscribe("resultspage.streaming.done",function(){a.searchCompleted=!0});this.subscribe("search.searchFailed",function(){a.options.showOnSearchFailed?a.element.removeClass("hidden"):a.element.addClass("hidden")});this.subscribe("filter.show",{name:this.name},function(){a.element.removeClass("hidden")});
this.subscribe("search.startSearch",this.onSearchStart.bind(this));this.subscribe("train.legChange.reset",function(){c.events.publish("filter.reset",{name:a.name})});(b=this.getChildElement("reset"))&&b.length&&(b.click(function(b){b.stopPropagation();a.reset({type:"reset",userClick:!0})}),b.keydown(function(b){switch(b.which){case c.globals.keyCodes.RETURN:case c.globals.keyCodes.SPACE:b.preventDefault(),a.reset({type:"reset",userClick:!0})}}));this.subscribe("filters.selectedprice",function(){a.reset.apply(a,
arguments)});b=this.getChildElement("skip");b.length&&b.click(function(b){b=d("[tabbable]:visible");var c=b.index(a.element)+1;c>=b.length&&(c=0);b.eq(c).get(0).focus()});if(this.options.collapsible){var e=function(b){var f=(b=a.element.hasClass("open"))?"hide":"show";c.Analytics.api.trackEvent({category:"Filter-Collapsible",action:f,label:a.name});a.element.toggleClass("open");a.title.attr("aria-pressed","show"===f);a.title.attr("aria-expanded","show"===f);c.globals.testMode&&a.title.attr("data-test-filter-collapsed",
b);c.events.publish("horizon.filters.opened");!0===a.options.refreshFilterPosOnCollapse&&c.events.publish("horizon.filters.FiltersDialog.itemToggled");a.isMobileView()&&(a.element.parent().addClass("hideNotOpened"),c.events.publish("horizon.mobile.FiltersDialog.itemOpened",{name:a.name,title:a.options.title}));a.options.trackEnabled&&a.trackingType&&(b?c.VestigoEvents.filters.shared.collapse(a.trackingType):c.VestigoEvents.filters.shared.expand(a.trackingType))};this.title.click(e);this.title.keypress(function(a){if(a.keyCode===
c.globals.keyCodes.RETURN||a.keyCode===c.globals.keyCodes.SPACE)return e(),!1})}this.subscribe("filters.disabled",this.setDisabled.bind(this));this.subscribe("filter.disabled",{name:this.name},function(b){a.setDisabled(b.disabled)});this.subscribe("filters.goBack",function(){a.element.removeClass("open");a.element.parent().removeClass("hideNotOpened")});this.options.triggerFilteredLabel&&this.subscribe("resultspage.results.count.changed",this.onResultsCountChanged.bind(this));c.question.forget("resultspage.filter.%s.history.view".format(this.name));
this.answer("resultspage.filter.%s.history.view".format(this.name),this.getHistoryFilterViewState.bind(this));this.subscribe("resultspage.filter.%s.history.apply".format(this.name),this.applyFilterFromHistory.bind(this));this.subscribe("resultspage.filter.%s.history.reset".format(this.name),this.reset.bind(this,{type:"reset"}));this.subscribe("resultspage.filter.%s.history.sync".format(this.name),this.syncWithHistoryPillState.bind(this));this.subscribe("filters.changed",{name:this.name},function(b){a.toggleDirtyOnAfterFiltersChanged(b)});
this.options.hasPlaceholder&&this.subscribe("filters.update.placeholderDisplay",this.updatePlaceholderDisplay.bind(this));this.subscribe("filters."+this.name+".setFromPrevious",this.onSetFromPrevious.bind(this));this.subscribe("filters."+this.name+".applyPreferences",this.onApplyPreferences.bind(this));this.options.showApplyAll&&this.registerEvent("click",this.getChildElement("applyAll"),function(b){b.stopPropagation();b.stopImmediatePropagation();a.applyAll()})},toggleDirtyOnAfterFiltersChanged:function(a){this.element.is(".Common-Results-Filters-FilterSection")||
this.element.toggleClass("isDirty",!a.reset)},onApplyPreferences:function(a){if(a||a.length)this.setStateFromPrevious(a),this.pushStateChange(null,{filterPreferenceChange:!0,changeData:{field:a.key,value:a.value,remove:a.reset}})},onSetFromPrevious:function(a){this.setStateFromPrevious(a);a.silent?this.syncFilterState(a.reset):this.pushStateChange(null,{previousFilterChange:!0,changeData:{field:a.key,value:a.value,remove:a.reset,fromPrevious:!0}});a.reset?delete this.previousFilters[a.key]:this.previousFilters[a.key]=
a.value},updatePreviousFilters:function(a){},removePreviousFilter:function(a){c.events.publish("filters.myfilters.removeFromPrevious",{name:this.name,key:a});a?delete this.previousFilters[a]:this.previousFilters={}},getResetType:function(){return!1===this.options.isMultiValueSet?"showAll":!0===this.options.isMultiValueSet?"clearAll":"custom"},pushStateChange:function(a,b,e){a=!0===a?null:e?e:this.getState();b=d.extend({name:this.name,state:a},b,{elemId:this.id()});c.events.publish("filters.changed",
b);Object.keys(this.previousFilters).length&&!b.previousFilterChange&&this.updatePreviousFilters(a);this.trackStateChange(b)},logUserInteraction:function(a){this.trackInteraction(a);if(""===this.options.logFiltersQuestion||this.logViewState(this.element))"ga"===this.options.loggingType&&"object"===typeof a?c.Analytics.api.trackEvent(a):c.Analytics.api.trackEvent("/"+this.options.loggingPrefix+"/"+this.name+(a?"/"+a:""))},logViewState:function(a){return c.question.ask(this.options.logFiltersQuestion,
{filterEl:a})},publishHoverState:function(a,b){a=d.extend({namespace:this._namespace,name:this.name,hover:a},b||{});c.events.publish("filters.%s.hovering".format(this.name),a)},toggleResetLink:function(a){var b=this.getChildElement("reset");a?(0!==b.length&&b.addClass("active"),this.element.addClass("activeReset")):(0!==b.length&&b.removeClass("active"),this.element.removeClass("activeReset"))},reset:function(a){this.willReset.apply(this,arguments);this.setLastUserInteraction(!0);this.pushStateChange(!0,
{reset:!0});a&&a.userClick&&this.logUserInteraction("reset")},updatePlaceholderDisplay:function(a){},filterDataChanged:function(a){this.element.closest(".hfilter").addClass("empty-filter");var b=d.extend({},a[this.name]);if(b.hasOwnProperty("enabled"))b.enabled?this.element.hasClass("inactive")&&this.element.removeClass("inactive"):this.element.addClass("inactive"),this.setEnabled(b.enabled),delete b.enabled;else if(!a[this.name]){Object.keys(a).length&&(this.setEnabled(!1),this.element.addClass("empty"));
return}this.dirty=b.isDirty;delete b.isDirty;this.isUserManipulated=b.isUserManipulated;c.events.publish("filter.dirty",{name:this.name,dirty:this.dirty,isUserManipulated:this.isUserManipulated});this.element.toggleClass("isDirty",this.dirty);this.toggleResetLink(this.dirty);this.options.collapsible&&!this.options.resetInTitle&&this.dirty&&this.element.addClass("open");this.options.triggerFilteredLabel&&this.lastUserInteraction&&(this.invalidateFilterLabelData?(this.invalidateFilterLabelData=!1,this.updateFilteredLabels(this.lastFilterCountDiff)):
this.invalidateFilterLabelCount=!0);this.update(b);this.isUserManipulated&&this.syncFilterState();this.element.toggleClass("empty",!this.shouldBeVisible(b));this.element.closest(".hfilter").toggleClass("empty-filter",!this.shouldBeVisible(b));this.setLastUserInteraction(!1)},syncFilterState:function(a){c.events.publish("resultspage.filters.sync",{name:this.name,state:a?null:this.getState()})},syncWithHistoryPillState:function(a){c.events.publish("resultspage.filters.sync",{name:this.name,state:a})},
setStateFromPrevious:function(a){},onResultsCountChanged:function(a){!isNaN(this.lastTotalFilteredCount)&&!isNaN(a.filtered)&&0<=a.filtered&&(this.lastFilterCountDiff=a.filtered-this.lastTotalFilteredCount);this.lastTotalFilteredCount=a.filtered;this.invalidateFilterLabelCount?(this.invalidateFilterLabelCount=!1,this.updateFilteredLabels(this.lastFilterCountDiff)):this.invalidateFilterLabelData=this.lastUserInteraction},updateFilteredLabels:function(a){a=parseInt(a);if(!isNaN(a)){if(this.options.useFilterLabelHidesReset){var b=
this.getChildElement("reset");b&&b.length&&b.hasClass("active")&&(this.subscribe("filter.label.cleared."+this.name,this.onFilterLabelCleared.bind(this)),this.toggleResetLink(!1))}c.events.publish("filter.label.update",{name:this.name,diff:a})}},onFilterLabelCleared:function(a){this.unsubscribe("filter.label.cleared."+a.name);this.dirty&&this.toggleResetLink(!0)},toggleAttribute:function(a){return"true"===a?"false":"true"},setLastUserInteraction:function(a){this.lastUserInteraction=a},setDisabled:function(a){c.dom.toggleOneClass(this.element,
"Disabled",a);this.element.find("[aria-disabled]").attr("aria-disabled",a);this.interactable=!a},cleanupExistingState:function(){},shouldBeVisible:function(a){return!0},willReset:function(a){},update:function(a){},applyAll:function(){},getState:function(){},isMobileView:function(){return this.options.mobileView},setEnabled:function(a){this.enabled!==a&&(this.enabled=a,c.events.publish("filter.enabled",{name:this.name,enabled:a}))},onSearchStart:function(a){this.element.removeClass("hidden");this.enabled=
null;this.searchCompleted=!1;"undefined"!==typeof a&&a.preserveFilters||(this.options.hasPlaceholder||this.element.addClass("empty"),this.cleanupExistingState())},getHistoryFilterViewState:function(){return{}},applyFilterFromHistory:function(a){if(c.config.getBoolean("ui.horizon.filters.history.enabled",!1)){var b=d.extend({},this.getState(),a);c.Analytics.api.trackEvent({category:"Filter-History",action:"Applying state From History: "+a,label:this.name});c.events.publish("filters.changed",{name:this.name,
state:b})}},getStateForFilterHistory:function(){return d.extend({},this.getState(),{displayName:this.options.title})},updateFilterHistory:function(){c.config.getBoolean("ui.horizon.filters.history.enabled",!1)&&(c.Analytics.api.trackEvent({category:"Filter-History",action:"Storing filter state in browser: ",label:this.name}),c.events.publish("store.filter.history",{name:this.name,state:this.getStateForFilterHistory()}))},getTrackingType:function(){if(this.options.trackEnabled&&c.VestigoType){var a=
c.VestigoType.FilterType;switch(this.name){case "equipment":return a.aircraft;case "eqmodel":return a.model;case "neighborhoods":return a.neighbourhood;case "ambiance":return a.style;case "price-options":return a.other;case "providers":return a.provider;case "roomtypes":return a.roomtype;case "propertysubtype":return a.propertytype;case "boardtypes":return a.board;default:return c.VestigoType.FlightQualityType[this.name]?a.flightquality:a[this.name]}}return""},trackInteraction:function(a){c.VestigoEvents&&
this.trackingType&&("reset"!==a&&"showall"!==a||c.VestigoEvents.filters.shared.reset(this.trackingType))},getTrackingAction:function(a){if(c.VestigoType){var b=c.VestigoType.FilterValueAction.select;0===a&&(b=c.VestigoType.FilterValueAction.unselect);2===a&&(b=c.VestigoType.FilterValueAction.only);return b}},trackStateChange:function(a){},trackStateChangeEnabled:function(a){return this.options.trackEnabled&&a.changeData}})})(R9,jQuery);(function(c){R9.extend("Widgets",{Checkbox:function(a,b){this.elementNode=a;this.element=c(this.elementNode);this.icon=c(R9.Widgets.Checkbox.findIconNode(this.elementNode));this.validateElement()&&(this.options=c.extend({},this.options,b),this.init())}});R9.extend("Widgets.Checkbox",{isCheckbox:function(a){return a&&a.nodeName&&"input"==a.nodeName.toLowerCase()&&"checkbox"==a.type.toLowerCase()},isWidgetControlled:function(a){return c(a).hasClass(R9.Widgets.Checkbox.prototype.widgetBaseClass+"-input")},
refresh:function(a,b){b=c(b);b[a.checked?"addClass":"removeClass"](R9.Widgets.Checkbox.prototype.widgetBaseClass+"-icon-checked");b[a.disabled?"addClass":"removeClass"](R9.Widgets.Checkbox.prototype.widgetBaseClass+"-icon-disabled")},findIconNode:function(a){return c(a).closest("[id$\x3d'-icon']")},findElementNode:function(a){return document.getElementById(a.id.substring(0,a.id.lastIndexOf("-icon")))}});R9.extend("Widgets.Checkbox.prototype",{widgetName:"checkbox",widgetBaseClass:"r9-checkbox",elementNode:null,
element:null,icon:null,options:{click:null,change:null},init:function(){this.bindInputClickEvent();this.bindInputEvent("change",this.handleElementChangeEvent);this.bindInputEvent("focus",this.handleElementFocusEvent);this.bindInputEvent("blur",this.handleElementBlurEvent);this.element.data(this.widgetName,this)},validateElement:function(){return R9.Widgets.Checkbox.isCheckbox(this.elementNode)&&R9.Widgets.Checkbox.isWidgetControlled(this.elementNode)},bindInputEvent:function(a,b){var c=this;a+="."+
this.widgetName;this.element.unbind(a).bind(a,function(a){b.call(c,this,R9.Widgets.Checkbox.findIconNode(this),a)})},bindInputClickEvent:function(){this.bindInputEvent("click",this.handleElementClickEvent)},handleElementClickEvent:function(a,b,c){this.options.click&&this.options.click.apply(this,arguments)},handleElementChangeEvent:function(a,b,c){R9.Widgets.Checkbox.refresh(a,b);this.options.change&&this.options.change.apply(this,arguments)},handleElementFocusEvent:function(a,b,d){a.disabled||(c(b).addClass(this.widgetBaseClass+
"-state-focus"),this.options.focus&&this.options.focus.apply(this,arguments))},handleElementBlurEvent:function(a,b,d){a.disabled||(c(b).removeClass(this.widgetBaseClass+"-state-focus"),this.options.blur&&this.options.blur.apply(this,arguments))}})})(jq||jQuery);var FOCUSED_CLASS=R9.config.getString("ui.horizon.common.core.focusOutlineClass","a11y-focused");
(function(c){R9.createWidgetClass("checkbox.Checkbox",c.extend({},R9.Widgets.Checkbox.prototype,{isToggle:!1,options:{keydown:c.noop,click:null,change:null},init:function(){this.elementNode=this.element.get(0);this.element.parent().is(".toggle")&&(this.isToggle=!0);this.label=this.getChildElement("label")},addEventHandlers:function(){this.bindInputClickEvent();this.bindInputEvent("change",this._handleElementChangeEvent);this.bindInputEvent("focus",this.handleElementFocusEvent);this.bindInputEvent("blur",
this.handleElementBlurEvent)},_handleElementChangeEvent:function(a,b,d){this.handleElementChangeEvent(a,b,d);this.options.isToggle&&(b=c(a).prop("checked"),a.setAttribute("aria-checked",b))},setEnabled:function(a){a?this.element.removeAttr("disabled"):this.element.attr("disabled","disabled");this.element.attr("aria-disabled",!a);R9.Widgets.Checkbox.refresh(this.element,this.icon)},getValue:function(){return this.element.prop("checked")},setChecked:function(a){this.element.prop("checked",a);this.isToggle&&
this.elementNode.setAttribute("aria-checked",a)},handleElementFocusEvent:function(){this.base();this.toggleFocusOutline(!0)},handleElementBlurEvent:function(){this.base();this.toggleFocusOutline(!1)},toggleFocusOutline:function(a){this.element.closest(".js-checkbox-container").toggleClass(FOCUSED_CLASS,a)}}))})(jq||jQuery);(function(c,e){var f=c.config.getBoolean("ui.horizon.fitlers.valueSetFilterItem.clearDisabledPrice",!0),g=c.config.getString("ui.horizon.common.core.focusOutlineClass","a11y-focused");c.createComponentClass("common.results.filters.ValueSetFilterItem",{checkbox:null,options:{name:null,loggingValue:null,group:null,state:{code:null,displayValue:null,pluralDisplayValue:null,minPrice:null,selected:0,info:!1,showAllSate:void 0,resetState:void 0,noSelect:!1,disabled:!1,hideOnly:!1,ignoreOnly:!1,displayOrder:0,
filtered:!1,partiallyFiltered:!1,resetOnDynamicIconClick:!1,tooltipText:null,href:null,cssClass:null,enableItemActionLogging:!1,enableActionTypeLogging:!0,count:0,showAsNotChecked:null,meta:!1},unrolled:!1,withImage:!1,onlyOnClick:!1,heading:void 0,headingOnlyState:1,onUserChange:e.noop,onRemove:e.noop,countEnabled:!1,allowZeroCount:!1,disableOnZeroCount:!1,messages:{},usePluralDisplayValue:!1,allUncheckedMeansInactive:!1,openMapOnSelection:!1,inModal:!1},events:{only:"filters.valueSetFilterItem.only"},
eventPrefix:"",eventGroupPrefix:"",loggingPrefix:"filters",updateKey:null,state:null,init:function(){this.state=e.extend({},this.options.state||{});this.checkbox=this.getChildElement("check");this.price=this.getChildElement("price");this.only=this.getChildElement("only");this.count=this.getChildElement("count");this.funnel=this.element.find(".funnel");this.innerCount=e("span",this.count);this.eventPrefix="filters.%s.%s.".format(this.options.group,this.options.name);this.eventGroupPrefix="filters.%s.".format(this.options.group);
this.options.onUserChange=this.options.onUserChange.bind(this,this.options.name);this.options.tooltipText&&(this.tooltip=this.getChildElement("tooltip-anchor").toolTip(this.getTooltipOptions({content:this.options.tooltipText})).getWidget());this.update(this.state);var a=this;c.dom.schedule(function(){a.checkbox.prop("checked",0<a.state.selected);"string"===typeof a.state.cssClass&&a.element.addClass(a.state.cssClass);a.options.cssClass&&a.element.addClass(a.options.cssClass);a.state.disabled&&a.setDisabled(!0);
a.state.hasOwnProperty("noSelect")&&(a.element.toggleClass("NoSelect",a.state.noSelect),a.checkbox.attr("aria-disabled",a.state.noSelect))})},addEventHandlers:function(){var a=this;this.registerEvent("click",this.element.find(".FilterCheckbox"),this.checkboxClicked.bind(this));this.registerEvent("keypress",this.element,function(b){b.keyCode===c.globals.keyCodes.RETURN&&a.checkboxClicked(b)});this.registerEvent("click",this.price,this.priceClicked.bind(this));this.registerEvent("click",this.count,
this.countClicked.bind(this));this.registerEvent("click",this.only,this.onlyClicked.bind(this));this.registerEvent("mouseenter",this.element,this.handleOnlyContainerMouseEnter.bind(this));this.registerEvent("mouseenter",this.only,this.handleOnlyMouseEnter.bind(this));this.registerEvent("mouseleave",this.element,this.handleOnlyContainerMouseLeave.bind(this));this.registerEvent("mouseleave",this.only,this.handleOnlyMouseLeave.bind(this));this.registerEvent("focus",this.only,this.handleOnlyFocus.bind(this));
this.options.resetOnDynamicIconClick&&this.registerEvent("click",this.funnel,this.funnelClicked.bind(this));if(this.options.showRemoveIcon){var b=this.getChildElement("remove"),d=null;"function"===typeof this.options.onRemove&&this.registerEvent("click",b,function(b){b.stopPropagation();d&&d.close();a.options.onRemove(a)});b.attr("title")&&(d=b.toolTip().getWidget())}this.registerEvent("keypress",this.only,function(b){switch(b.which){case c.globals.keyCodes.SPACE:case c.globals.keyCodes.RETURN:a.only.click(),
b.stopPropagation()}});this.addSubscriptionHandlers();this.registerEvent("focus",this.checkbox,this.toggleFocusStyle.bind(this,!0));this.registerEvent("blur",this.checkbox,this.toggleFocusStyle.bind(this,!1))},addSubscriptionHandlers:function(){var a=this;this.subscribe(this.eventPrefix+"setchecked",this.setChecked.bind(this));this.only&&this.only.length&&this.subscribe(this.eventPrefix+"onlyclick.force",function(){a.only.click()});this.subscribe(this.eventPrefix+"quickclick.force",function(){a.state.disabled||
a.state.hideOnly||a.state.noSelect||a.setChecked(1,"quickfilter")});this.subscribe(this.eventPrefix+"quickunclick.force",function(){a.state.disabled||a.state.hideOnly||a.state.noSelect||a.setChecked(0,"quickfilter")});this.subscribe(this.eventPrefix+"setchecked.force",function(b){a.setChecked(b.selected,b.changeType||"toggle")});this.subscribe(this.eventPrefix+"resetitem",function(b){a.setChecked(a.state.resetState,b.changeType||"toggle")});this.subscribe(["filters.disabled",this.eventPrefix+"disabled"],
this.setDisabled.bind(this));this.subscribe("resultspage.cleanup",function(b){a.isClean=!0});this.subscribe("filters."+this.options.group+".showAsNotChecked",function(b){a.state.showAsNotChecked=b})},countClicked:function(a){this.state.disabled||this.state.hideOnly||this.state.noSelect||(this.setChecked(1),this.options.onUserChange("count"),this.options.enableItemActionLogging&&c.Analytics.api.trackEvent({category:this.loggingPrefix,action:this.options.group,label:"count"}))},priceClicked:function(a){if(this.price.attr("href"))window.open(this.price.attr("href"),
"_blank");else{if(this.state.disabled||this.state.hideOnly||this.state.noSelect)return;this.setChecked(1);this.options.onUserChange("price")}this.options.enableItemActionLogging&&c.Analytics.api.trackEvent({category:this.loggingPrefix,action:this.options.group,label:"price"})},onlyClicked:function(a){a.stopPropagation();this.state.disabled||(this.options.openMapOnSelection&&this.handleItemSelected(!0),this.options.heading?this.setChecked(this.options.headingOnlyState):this.setChecked(2),this.only.addClass("hideOnly"),
this.options.onUserChange("only"))},handleOnlyContainerMouseEnter:function(a){this.only.removeClass("hideOnly");this.only.addClass("hideOnlyDecoration")},handleOnlyContainerMouseLeave:function(a){this.only.addClass("hideOnly")},handleOnlyMouseEnter:function(a){this.only.removeClass("hideOnlyDecoration")},handleOnlyMouseLeave:function(a){this.only.addClass("hideOnlyDecoration")},handleOnlyFocus:function(a){this.only.removeClass("hideOnly");this.only.removeClass("hideOnlyDecoration")},funnelClicked:function(a){a.stopPropagation();
this.funnelTooltipWidget&&this.funnelTooltipWidget.close();c.events.publish("filters.reset",{type:"showAll"})},checkboxClicked:function(a){a.preventDefault();if(!this.state.disabled&&!this.state.noSelect){a=0<this.state.selected?0:1;var b="toggle";this.options.openMapOnSelection&&0<a&&this.handleItemSelected();this.options.enableActionTypeLogging&&(b=0<this.state.selected?"unselect":"select");this.options.onlyOnClick&&2!==this.state.selected&&(a=2,b="only");this.setChecked(a);this.options.onUserChange(b);
a=0<this.state.selected?"show":"hide";this.options.enableItemActionLogging&&c.Analytics.api.trackEvent({category:this.loggingPrefix,action:this.options.group,label:a+"-"+this.options.name})}},handleItemSelected:function(a){c.events.publish(this.eventGroupPrefix+"selected",{name:this.options.name,only:a})},setDisabled:function(a){this.state.disabled=a;c.dom.toggleOneClass(this.element,"Disabled",a);this.element.attr("aria-disabled",a);c.dom.toggleOneClass(this.checkbox.parent(),"Disabled",a);c.events.publish(this.eventPrefix+
"state.disabled",a)},setSelectable:function(a){this.state.noSelect=!a;c.dom.toggleOneClass(this.element,"Disabled",!a);this.element.attr("aria-disabled",!a);c.dom.toggleOneClass(this.checkbox.parent(),"Disabled",!a)},setPrice:function(a){a=a||"";this.state.minPrice=a;this.price.text(a)},setCount:function(a){this.state.count=a;this.innerCount.text(a)},setChecked:function(a,b,d){d=this.options.allUncheckedMeansInactive&&this.state.showAsNotChecked?!1:0<a;c.dom.toggleOneClass(this.element,"Checked",
d);this.checkbox.prop("checked",d);this.state.selected=a;c.events.publish(this.eventPrefix+"changed",this.state);if(b)this.options.onUserChange(b)},setDisplayValue:function(a){this.element.find(".label").text(a);this.state.displayValue=a},update:function(a){var b=this;this.options.disableOnZeroCount&&0===a.count&&a.filtered?(a.disabled=!0,this.state.userSelectedDisabled=this.state.selected!==a.resetState):this.state.userSelectedDisabled=!1;a.disabled&&f&&(a.minPrice="");this.state.filtered=a.filtered;
this.state.displayOrder=a.displayOrder;this.state.showAllState=a.showAllState;this.state.resetState=a.resetState;this.state.meta=a.meta;var d=this.computeUpdateKey(a);if(!c.config.getBoolean("ui.horizon.filters.updateKey",!0)||d!==this.updateKey||this.isClean)this.isClean=!1,this.state.selected=a.selected,this.state.disabled=a.disabled,c.dom.schedule(function(){b.updateElement(a);b.updateKey=d})},updateElement:function(a){a.cssClass&&a.cssClass!==this.state.cssClass&&(this.element.removeClass(this.state.cssClass),
this.element.addClass(a.cssClass),this.state.cssClass=a.cssClass);this.setChecked(a.selected,"",!0);this.setPrice(a.minPrice);this.state.displayValue!==a.displayValue&&this.setDisplayValue(a.displayValue);(0!==a.count||this.options.allowZeroCount)&&a.count!==this.state.count&&this.options.countEnabled&&this.setCount(a.count);this.updateDynamicFilterTooltip(a);var b=!!a.hideOnly;if(this.state.hideOnly!==b||this.element.hasClass("No-Only")!==b)this.state.hideOnly=b,this.element.toggleClass("No-Only",
this.state.hideOnly);b=!!a.noSelect;this.state.noSelect!==b&&(this.state.noSelect=b,this.element.toggleClass("NoSelect",this.state.noSelect));this.setDisabled(!!a.disabled);this.price.attr("href",a.href||null)},updateDynamicFilterTooltip:function(a){this.element.removeClass("Filtered FilteredOut");if(a.filtered||a.partiallyFiltered){var b=a.filtered?this.options.messages.filtered:this.options.messages.partiallyFiltered;if(b){this.showingTooltip=!0;var d=a.displayValue;this.options.usePluralDisplayValue&&
(d=a.pluralDisplayValue);b=c.Common.Utils.String.formatString(b,d);this.element.addClass("Filtered"+(a.filtered?" FilteredOut":""));this.funnel.attr({"data-title":b,"aria-label":b,"aria-disabled":!this.options.resetOnDynamicIconClick});this.funnel.getWidget()||(this.funnelTooltipWidget=this.funnel.toolTip(this.getTooltipOptions()).getWidget())}}else this.showingTooltip&&(this.funnel.attr({title:"","aria-disabled":!0}),this.showingTooltip=!1)},computeUpdateKey:function(a){var b="selected filtered partiallyFiltered hideOnly noSelect disabled showAsNotChecked".split(" ").reduce(function(b,
c){return b+(a[c]?"1":"0")},""),b=b+(this.options.countEnabled?a.count:a.minPrice),b=b+(a.cssClass?a.cssClass:""),b=b+a.displayValue;return b+=a.href?a.href:""},getTooltipOptions:function(a){var b=this.options.cssClass&&-1!==this.options.cssClass.indexOf("kayak-flights");return e.extend({},{position:"top",extraClass:"Common-Results-Filters-ValueSetFilterItem__Tooltip "+this.options.cssClass+" "+(b?"uikit ":"")+(this.options.inModal?"modal-layer":""),orientation:b?"start":"middle",size:b?"uikit":"m"},
a)},getState:function(){return this.state.disabled&&!this.state.userSelectedDisabled?null:this.state.selected},toggleFocusStyle:function(a){this.element.toggleClass(g,a)}})})(R9,jQuery);(function(h,g){h.createComponentClass("common.results.filters.ValueSetFilter","common.results.filters.Filter",{content:null,renderedFilterOptions:null,renderedHeadings:null,options:{isMultiValueSet:!1,isDefaultChecked:!1,showAllNone:!1,onReset:null,sortInPlace:!1,sortInPlaceLazy:!1,flushState:!0,onDeselect:null,confineOnlyToHeading:!1,selectableHeadings:!1,collapsedContent:!0,showHeadingCount:!0,showHeadingOnly:!0,onChange:null,removeExpiredOptions:!0,removeExpiredHeadingsWithOptions:!1,visibleCount:0,
overflowMinimum:0,showOverflowTemplate:"",hideOverflowTemplate:"",alwaysVisibleItems:[],preventNoneChecked:!1,showItemHoverTooltip:!1,includeExcludeItems:null,reverseOptionOrder:!1,countEnabled:!1,allowZeroCount:!1,allowEmptyPrice:!1,disableOnZeroCount:!1,disableOnNoPrice:!1,showOnly:!0,showDescription:!1,resetOnDynamicIconClick:!1,extraCssClass:"",featureClass:"",onlyLinkClass:"",hidePrice:!1,messages:{},itemTooltipTextMap:null,usePluralDisplayValue:!1,onGetState:null,reloadTop:!1,logItemActions:!1,
logActionType:!0,isDropdown:!1,itemTemplateId:"valueSetFilterItem",headingTemplateId:"headingContainerItem",showTooltipForEllipsed:!1,tooltipHoverDelay:1E3,allUncheckedMeansInactive:!1,reverseSortOrder:!1,sortOverflowByCount:null,displayDefaultUnchecked:!1,openMapOnSelection:!1,inModal:!1,useStarRating:!0,useStarTextDisplayValue:!1},events:{all:"filters.valueSetFilter.showall"},showAllBtn:null,showNoneBtn:null,only:null,showOverflowLink:void 0,overflowVisible:!1,includeExcludeRadios:null,metaState:null,
showAsNotChecked:null,resetState:null,multisetOptions:null,headingValueMap:null,headingsDataMap:null,init:function(){this.base();this.renderedFilterOptions={};this.content=this.getChildElement("options");0<this.options.visibleCount&&(this.showOverflowLink=this.getChildElement("overflow"));this.showAllBtn=this.getChildElement("all");this.showNoneBtn=this.getChildElement("none");this.options.itemTooltipTextMap=this.options.itemTooltipTextMap||{};this.resetState=this.options.isMultiValueSet&&!this.options.isDefaultChecked?
0:1},addEventHandlers:function(){this.base();var a=this;void 0!==this.showOverflowLink&&(this.showOverflowLink.click(function(){a.options.isDropdown?a.getChildElement("dropdown_content").hasClass("overflow-visible")?a.hideOverflowOptions(!0):a.showOverflowOptions(!0):a.element.hasClass("overflow-visible")?a.hideOverflowOptions(!0):a.showOverflowOptions(!0)}),this.showOverflowLink.keypress(function(b){switch(b.which){case h.globals.keyCodes.SPACE:case h.globals.keyCodes.RETURN:a.showOverflowLink.click()}}));
this.subscribe("filters.%s.setonly".format(this.name),function(b){b=a.getRenderedFilterOptions()[b];a.options.preventNoneChecked&&(a.only.setSelectable(!0),b.setSelectable(!1));a.only=b});this.subscribe("filters.%s.setChecked".format(this.name),this.setCheckedItems.bind(this));this.subscribe("filters.%s.setUnChecked".format(this.name),this.setUnCheckedItems.bind(this));this.options.showItemHoverTooltip&&this.subscribe("filters.%s.hovering".format(this.name),this.onItemHover.bind(this));this.options.showAllNone&&
(this.registerEvent("click",this.showAllBtn,function(b){b&&g(b.target).hasClass("disabled")||a.reset({type:"all",userClick:!0,ignoreHideOverflow:!0})}),this.registerEvent("click",this.showNoneBtn,function(b){b&&g(b.target).hasClass("disabled")||a.deselect({type:"none",userClick:!0,ignoreHideOverflow:!0})}));this.options.includeExcludeItems&&(this.includeExcludeRadios=this.getChildElement("vsf-incl-radios").styleJamRadioButtonSet({change:a.onChangedIncludeExcludeRadio.bind(this)}).getWidget());this.subscribe("search.startSearch",
function(){a.showAsNotChecked=null;0<a.options.visibleCount&&a.hideOverflowOptions()});this.subscribe("filters.%s.forceReset".format(this.name),function(){a.reset()});this.options.openMapOnSelection&&this.subscribe("filters.%s.selected".format(this.name),function(){h.events.publish("results.mapToggle.toggle");h.events.publish("results.showMapEvent")})},inlineComponentsReady:function(){this.base();this.options.showTooltipForEllipsed&&!this.options.showItemHoverTooltip&&this.subscribe("filters.%s.hovering".format(this.name),
this.onItemHover.bind(this))},reset:function(a){if(!a||!(a.ignore===this.name||g.isArray(a.ignore)&&-1<a.ignore.indexOf(this.name)))if(this.metaState=null,this.options.allUncheckedMeansInactive&&(this.showAsNotChecked=!0,h.events.publish("filters."+this.name+".showAsNotChecked",!0)),"function"===typeof this.options.onReset)this.options.onReset.apply(this,arguments);else{var b=this.options.flushState,c=this.options.displayDefaultUnchecked;this.forEachItem(function(d,f){f.state.disabled||f.state.noSelect||
(c?(b=!0,f.setChecked(0),f.state.selected=0):void 0!==f.state.showAllState&&a&&a.type&&"reset"!==a.type?(b=!1,f.setChecked(f.state.showAllState)):(d=f.state.resetState,void 0!==d&&void 0!==f.state.defaultSelectedState&&d!==f.state.defaultSelectedState&&(b=!1),f.setChecked(void 0!==d?d:this.resetState)),this.options.preventNoneChecked&&f.setSelectable(!0))});this.options.resetInTitle||!(0<this.options.visibleCount)||a&&a.ignoreHideOverflow||this.hideOverflowOptions();this.enableShowAllNone(!1,!0);
a&&a.silent?this.syncFilterState(b):this.pushStateChange(b,{reset:!0});a&&a.userClick&&(this.setLastUserInteraction(!0),this.logUserInteraction("showall"));this.only=null}},onChangedIncludeExcludeRadio:function(a){a=g(a);var b=a.val();a.is(":checked")&&b&&(this.metaState=b,this.pushStateChange())},enableShowAllNone:function(a,b){this.options.showAllNone&&(this.showAllBtn.toggleClass("disabled",!a),this.showNoneBtn.toggleClass("disabled",!b))},updateShowAllNone:function(a){this.options.showAllNone&&
(a?this.enableShowAllNone(!this.allChecked(a),this.anyChecked(a)):this.enableShowAllNone(!0,!0))},getIgnoreDeselect:function(){return null},getResetType:function(){return this.options.isDefaultChecked?"showAll":this.base()},deselect:function(a){if(!a||!(a.ignore===this.name||g.isArray(a.ignore)&&-1<a.ignore.indexOf(this.name)))if("function"===typeof this.options.onDeselect)this.options.onDeselect.apply(this,arguments);else{var b=this.getIgnoreDeselect();this.forEachItem(function(a,d){d.state.disabled||
d.state.noSelect||b&&0<=b.indexOf(a)||(d.setChecked(0),this.options.preventNoneChecked&&d.setDisabled(!1))});!(0<this.options.visibleCount)||a&&a.ignoreHideOverflow||this.hideOverflowOptions();this.enableShowAllNone(!0,!1);a&&a.silent?this.syncFilterState():this.pushStateChange(!1);a&&a.userClick&&this.logUserInteraction(a.type)}},cleanupExistingState:function(){this.forEachItem(function(a,b){h.ComponentManager.remove(b.id())});this.renderedFilterOptions={};this.multisetOptions=null;this.getOptionsContainer().empty()},
sortRenderedFilterOptions:function(a){if(a.useHeadings)for(var b=Object.keys(a.headingValueMap),c=0;c<b.length;c++){var d=this.getOptionsContainer().find('.heading[data-heading\x3d"%s"]'.format(b[c])).find(".content");this.sortOptionsInPlace(d,a.headingValueMap[b[c]])}else this.sortOptionsInPlace(this.getOptionsContainer(),a.valueMap)},sortOptionsInPlace:function(a,b){var c=a.find(".Common-Results-Filters-ValueSetFilterItem");0!==c.length&&(c=c.toArray().sort(function(a,c){a=b[g(a).data("name")];
c=b[g(c).data("name")];return a&&c?a.displayOrder-c.displayOrder:0}),g(c).detach().appendTo(a))},addOptionToFilterMap:function(a,b,c,d,f){var e=this.id()+"-"+Math.floor(1E4*Math.random())+"-"+a.replace(/\W+/g,""),e=g.extend({id:e,name:a},b,{showCount:this.options.countEnabled,showPrice:!this.options.countEnabled&&!this.options.hidePrice,itemTemplateId:this.options.itemTemplateId,hasCount:this.options.allowZeroCount?0<=b.count:0<b.count,hasPrice:this.options.allowEmptyPrice||b.minPrice,disabled:this.options.disableOnZeroCount?
0===b.count:!1,tooltipText:this.options.itemTooltipTextMap[a],showOnly:this.options.showOnly,showDescription:this.options.showDescription,hideDisplayValue:"stars"===this.options.name&&!this.options.useStarTextDisplayValue,useStarRating:this.options.useStarRating,onlyLinkClass:this.options.onlyLinkClass,optionsContainer:this.getOptionsContainer(),useMcFlyStyling:this.options.useMcFlyStyling?"mcfly-styling":"",featureClass:this.options.featureClass?this.options.featureClass.trim():""},f||{});f=h.template.renderElement(e.itemTemplateId,
e);var n=b.displayOrder,l=function(a,b){return a>b};this.options.reverseSortOrder&&(l=function(a,b){return a<b});var k=null;this.forEachItem(function(a,b){l(b.state.displayOrder,n)&&(null!==k?l(k.state.displayOrder,b.state.displayOrder)&&(k=b):k=b)},d);if(null===k||void 0!==c)if(e=e.optionsContainer,c){var m=e.find('.heading[data-heading\x3d"%s"]'.format(c));m.length||(m=this.makeHeadingContainer(c),e.append(m));m.find(".content").append(f)}else this.options.reverseOptionOrder?e.prepend(f):(f.insertAfter(k),
e.append(f));else f.insertBefore(k.element);b=this.makeFilterOption(f,b,a,c);d[a]=b;b.element.on("mouseenter",this.publishHoverState.bind(this,!0,{item:b.options.name}));b.element.on("mouseleave",this.publishHoverState.bind(this,!1,{item:b.options.name}))},addFilterItem:function(a,b,c,d){this.addOptionToFilterMap(a,b,c,this.getRenderedFilterOptions(),d)},makeFilterOption:function(a,b,c,d,f){var e=this;return new h.common.results.filters.ValueSetFilterItem(a,g.extend(!0,{},{state:b,name:c,group:this.name,
cssClass:this.options.extraCssClass+" "+this.options.featureClass+(f&&f.cssClass?" "+f.cssClass:""),onUserChange:function(){e.filterItemDidChange.apply(e,Array.prototype.slice.call(arguments).concat(this))},heading:d,headingOnlyState:this.options.confineOnlyToHeading?1:2,countEnabled:this.options.countEnabled,allowZeroCount:this.options.allowZeroCount,disableOnZeroCount:this.options.disableOnZeroCount,resetOnDynamicIconClick:this.options.resetOnDynamicIconClick,messages:this.options.messages,tooltipText:this.options.itemTooltipTextMap[c],
enableActionLogging:this.options.logItemActions,enableActionTypeLogging:this.options.logActionType,usePluralDisplayValue:this.options.usePluralDisplayValue,allUncheckedMeansInactive:this.options.allUncheckedMeansInactive,openMapOnSelection:this.options.openMapOnSelection,inModal:this.options.inModal},f||{}))},makeHeading:function(a){var b=this,c=this.id()+"-"+Math.floor(1E4*Math.random())+"-"+a.replace(/\W+/g,""),d=b.headingsDataMap&&b.headingsDataMap[a],c=h.template.renderElement(b.options.headingTemplateId,
{id:c,heading:a,showOnly:b.options.showHeadingOnly,showCount:b.options.showHeadingCount,collapsedContent:b.options.collapsedContent,selectable:b.options.selectableHeadings,selected:d?b.headingsDataMap[a].selected:!1,description:d?b.headingsDataMap[a].description:"",count:d?b.headingsDataMap[a].count:"",useMcFlyStyling:this.options.useMcFlyStyling?"mcfly-styling":"",featureClass:this.options.featureClass?this.options.featureClass.trim():""});this.renderedHeadings||(this.renderedHeadings={});this.renderedHeadings[a]=
c;this.options.selectableHeadings&&(c.find(".HeadingCheckbox").checkbox({change:function(c){if(!g(c).hasClass("Disabled")){var d=g(c).find("input").is(":checked");h.Analytics.api.trackEvent({category:"filters",action:a,label:"click"});b.onHeadingClick(a,g(c).find("input").is(":checked"));b.pushStateChange(null,{changeData:{field:b.headingsDataMap[a].code+"__ALL",value:d?1:0,displayValue:a}})}}}).getWidget().setChecked(d?b.headingsDataMap[a].selected:!1),this.options.showOnly&&this.registerEvent("click",
c.find(".only"),this.onHeadingOnlyClick.bind(this,a,!1)));return c},onHeadingClick:function(a,b){var c=this;Object.keys(this.headingValueMap[a]).forEach(function(a){c.getRenderedFilterOptions()[a].setChecked(b?1:0)})},onHeadingOnlyClick:function(a,b){var c=this;Object.entries(this.renderedHeadings).forEach(function(b){var d=b[0]===a;b[1].find(".HeadingCheckbox").find("input").prop("checked",d);c.onHeadingClick(b[0],d)});b||(h.Analytics.api.trackEvent({category:"filters",action:a,label:"only"}),this.pushStateChange())},
makeHeadingContainer:function(a){var b;this.options.selectableHeadings?b=this.makeHeading(a):(b="\x3cdiv class\x3d'heading' data-heading\x3d\""+a+'"\x3e%s\x3c/div\x3e',a="\x3cdiv class\x3d'title'\x3e%s\x3c/div\x3e\x3cdiv class\x3d'content'\x3e\x3c/div\x3e".format(a),b=g(b.format(a)));return b},shouldBeVisible:function(a){return(a=a.useHeadings?a.headingValueMap:a.valueMap)&&0<Object.keys(a).length},logUserInteraction:function(a,b){if("ga"===this.options.loggingType){a=a.split("/");var c;a[0]&&(c=
"reset"===a[0]?"showall":a[0]);var d=this.getRenderedFilterOptions()[a[0]];a[1]&&"toggle"===a[1]&&d&&(a[1]=d.state.selected?"show":"hide");a[1]&&(c=(b?"":a[1]+"-")+c+(b?"-"+a[1]:""));this.base({category:this.trackCategory,action:this.name,label:c})}else this.base(a)},filterItemDidChange:function(a,b,c,d){var f={field:a,value:c&&c.state.selected,displayValue:c&&c.state.displayValue};if(this.options.allUncheckedMeansInactive){var e=this.getRenderedFilterOptions();null==this.showAsNotChecked&&(this.showAsNotChecked=
Object.keys(e).every(function(b){var c=0<e[b].state.selected;return b===a?!c:c}));this.showAsNotChecked?(h.events.publish("filters."+this.name+".showAsNotChecked",!1),this.showAsNotChecked=!1,e[a].setChecked(1),b="only"):0===Object.keys(e).filter(function(a){return 0<e[a].state.selected}).length&&(h.events.publish("filters."+this.name+".showAsNotChecked",!0),this.showAsNotChecked=!0,this.forEachItem(function(a,b){b.setChecked(1)}),b="showall")}this.multisetOptions&&c&&Object.keys(this.multisetOptions).forEach(function(b){var c=
this.multisetOptions[b],d=a===b,f=0<this.getRenderedFilterOptions()[b].getState();d?this.forEachItem(function(a,b){b.state.meta||(a=-1<c.indexOf(a),f?b.setChecked(a?1:0):a||b.setChecked(1))}):-1===c.indexOf(a)&&this.getRenderedFilterOptions()[b].setChecked(0)},this);"only"===b||"price"===b||"count"===b?(this.only=this.getRenderedFilterOptions()[a],this.forEachItem(function(b,c){c.options.state.ignoreOnly||c&&b!==a&&(this.only.options.heading&&this.options.confineOnlyToHeading?this.only.options.heading===
c.options.heading&&c.setChecked(0):c.setChecked(0))}),"price"===b&&h.events.publish("filters.selectedprice",{ignore:this.name})):this.only&&this.unsetOnlyOption(a);"function"===typeof this.options.onChange&&this.options.onChange.call(this,c);d||(this.setLastUserInteraction(!0),this.pushStateChange(null,{changeData:f}),this.updateFilterHistory(),this.options.logUserInteraction&&(this.logUserInteraction("showall"===b?b:a+"/"+b),c&&c.state.filtered&&h.Analytics.api.trackEvent("filters/filteredItem/"+
b)));c&&0!==c.getState()&&h.events.publish("gtm.update",{event:"resultsFilterChange",filterName:this.name,filterValue:a});this.options.reloadTop&&window.scrollTo(0,0)},unsetOnlyOption:function(a){a!==this.only.options.name?(this.only.setChecked(1),this.only=null):a===this.only.options.name&&2!==this.only.state.selected&&(this.only=null)},update:function(a){var b=this,c=!1,d=Object.keys(this.getRenderedFilterOptions()).length;this.options.showDescription&&this.updateDescriptions(a);this.multisetOptions=
a.multisetOptions;a.hasOwnProperty("headingsDataMap")&&(this.headingsDataMap=a.headingsDataMap);var f=g.extend(!0,{},a);if(f.useHeadings){this.headingValueMap=f.headingValueMap;for(var e=Object.keys(this.headingValueMap),h=0;h<e.length;h++){var l=e[h],l=this.updateItems(this.headingValueMap[l],l,f);c||(c=l)}if(f.orderedHeadings){var k=f.orderedHeadings;this.getOptionsContainer().find(".heading").sort(function(a,b){return k.indexOf(g(a).data("heading"))>k.indexOf(g(b).data("heading"))?1:k.indexOf(g(a).data("heading"))<
k.indexOf(g(b).data("heading"))?-1:0}).appendTo(this.getOptionsContainer())}this.options.selectableHeadings&&this.getOptionsContainer().find(".heading").each(function(c,d){var f=!1,e=!0;g(d).find("li").each(function(a,c){a=b.getRenderedFilterOptions()[g(c).data("name")];a.state.selected&&(f=!0);a.state.disabled||(e=!1)});c=g(d).find(".HeadingCheckbox");c.find("input").prop("checked",f);c.toggleClass("Disabled",e);c.attr("aria-disabled",e);g(d).toggleClass("Disabled",e);c=g(d).data("heading");a.hasOwnProperty("headingsDataMap")&&
a.headingsDataMap[c]&&g(d).find(".headingCount").text(a.headingsDataMap[c].count)});this.options.removeExpiredHeadingsWithOptions&&this.getOptionsContainer().find(".heading").each(function(a,c){(a=g(c).data("heading"))&&""!==a&&0>e.indexOf(a)&&(g(c).find("li").each(function(a,c){(a=g(c).data("name"))&&""!==a&&delete b.getRenderedFilterOptions()[a]}),g(c).remove())})}else c=this.updateItems(f.valueMap,void 0,f);(this.options.sortInPlace||this.options.sortInPlaceLazy&&d!==Object.keys(this.getRenderedFilterOptions()).length)&&
this.sortRenderedFilterOptions(f);this.element.hasClass("empty")&&c&&this.element.removeClass("empty");this.options.showAllNone&&this.updateShowAllNone(f.valueMap)},updateItems:function(a,b,c){if(!a)return!1;var d=this.updateMetaItems(a),f=this,e=Object.keys(d);a=0<e.length;var g=!1,e=e.sort(function(a,b){return d[a].displayOrder-d[b].displayOrder});this.options.disableOnNoPrice&&e.forEach(function(a){a=d[a];a.minPrice||(a.disabled=1,a.selected=0)});this.options.displayDefaultUnchecked?(this.showAsNotChecked=
this.allChecked(d))&&e.forEach(function(a){d[a].selected=0;d[a].showAllState=0}):this.options.allUncheckedMeansInactive&&null==this.showAsNotChecked&&(this.showAsNotChecked=this.allChecked(d))&&e.forEach(function(a){d[a].showAsNotChecked=!0});e.filter(function(a){return f.getRenderedFilterOptions().hasOwnProperty(a)}).forEach(function(a){var b=d[a];f.getRenderedFilterOptions()[a].update(b)});var l={};e.length>this.options.overflowMinimum&&(l=this.getOverflowItems(e,d));e.forEach(function(a){var e=
d[a];e.showAsNotChecked=f.showAsNotChecked;f.getRenderedFilterOptions().hasOwnProperty(a)||f.addFilterItem(a,e,b,{filtersData:c});l&&l[a]&&(0===e.selected||f.options.isDefaultChecked)?(f.getRenderedFilterOptions()[a].element.addClass("overflow-item").attr("aria-hidden",!0),g=!0):f.getRenderedFilterOptions()[a].element.removeClass("overflow-item").attr("aria-hidden",!1);2===e.selected&&(f.only=f.getRenderedFilterOptions()[a])});this.options.preventNoneChecked&&this.disableOnlyOption();if(void 0!==
this.showOverflowLink&&!this.element.hasClass("overflow-visible")){this.showOverflowLink.toggleClass("visible",g);this.showOverflowLink.attr("aria-pressed",function(a){return"false"===a?"true":"false"});if(g&&(this.options.showOverflowTemplate||this.options.hideOverflowTemplate)){var e={},k=Object.keys(l).length;this.options.showOverflowTemplate&&(e.more=h.Common.Utils.String.formatChoice(this.options.showOverflowTemplate,k,k),this.overflowVisible||this.getChildElement("overflow-text").text(e.more));
this.options.hideOverflowTemplate&&(e.less=h.Common.Utils.String.formatChoice(this.options.hideOverflowTemplate,k,k),this.overflowVisible&&this.getChildElement("overflow-text").text(e.less));Object.keys(e).length&&this.showOverflowLink.data(e)}this.options.collapsedContent&&(this.element.find(".heading").addClass("collapsed"),this.showOverflowLink.toggleClass("visible",!0))}this.handleExpiredOptions(d,b);return a},updateMetaItems:function(a){if(!a)return a;var b=this,c=Object.keys(a),d={},f=function(b){return b&&
a[b]&&a[b].meta};if(1>c.length||!c.some(f))return a;c.forEach(function(c){var e;f(c)&&g.isArray(b.options.includeExcludeItems)&&0<=b.options.includeExcludeItems.indexOf(c)&&(e=!0,b.includeExcludeRadios&&a[c].selected&&(b.includeExcludeRadios.setButtonCheckedByValue(c),b.metaState=b.metaState&&b.metaState===c?c:null));e||(d[c]=a[c])});return d},updatePlaceholderDisplay:function(a){this.options.isDropdown?this.base(a):a&&(this.getChildElement("placeholder").toggleClass("hidden",!a.visible),this.getChildElement("options").toggleClass("hidden",
!!a.visible))},updateDescriptions:function(a){var b=a.valueMap,c=a.descriptions;Object.keys(c).forEach(function(a){var d=b[a];null!=d&&(d.description=c[a])})},allChecked:function(a){var b=Object.keys(a),c=this.getIgnoreDeselect();return b.length?b.every(function(b){return 0<a[b].selected||0<a[b].disabled||c&&0<=c.indexOf(b)}):null},anyChecked:function(a){var b=Object.keys(a),c=this.getIgnoreDeselect();return b.length?b.some(function(b){return 0<a[b].selected&&!a[b].disabled&&(!c||0>c.indexOf(b))}):
null},getOverflowSorter:function(a){return this.options.sortOverflowByCount?function(b,c){b=a.hasOwnProperty(b)?a[b].count:0;return(a.hasOwnProperty(c)?a[c].count:0)-b}:null},getOverflowItems:function(a,b){var c=this;if(0<this.options.visibleCount){var d=a.filter(function(a){return-1===c.options.alwaysVisibleItems.indexOf(a)});a=this.options.visibleCount-(a.length-d.length);var f=d;b=c.getOverflowSorter(b);"function"===typeof b&&(f=d.sort(b));var e={};f.slice(a).forEach(function(a){e[a]=a});return e}return null},
handleExpiredOptions:function(a,b){this.forEachItem(function(c,d){a.hasOwnProperty(c)||d.options.heading!==b||(this.options.removeExpiredOptions?(h.ComponentManager.remove(d.id()),delete this.getRenderedFilterOptions()[c]):d.setChecked(0))})},disableOnlyOption:function(){var a=this.getRenderedFilterOptions();if("object"===typeof a&&0!==a.length){var b=Object.keys(a),c=b.filter(function(b){return 0<a[b].getState()});b.forEach(function(b){a[b].setSelectable(!0)});1===c.length?a[c[0]].setSelectable(!1):
0===c.length&&this.log.console("ValueSetFilter#DisableOnlyOption: No filter options checked while preventNoneChecked is true. \nFilter name: "+this.options.name)}},setCheckedItems:function(a){this.forEachItem(function(b,c){0<=a.items.indexOf(b)?c.setChecked(1):c.setChecked(0)});this.pushStateChange()},setStateFromPrevious:function(a){var b=this.getRenderedFilterOptions()[a.key];if(b)if(a.reset)2===b.getState()?this.reset({silent:!0}):b.setChecked(void 0!==b.state.resetState?b.state.resetState:this.resetState);
else{if(a.hasOwnProperty("value")){var c=parseInt(a.value,10);b.setChecked(c);this.filterItemDidChange(a.key,2===c?"only":null,b,!0)}}else this.options.selectableHeadings&&a.key&&a.key.endsWith("__ALL")&&this.setHeadingFromPrevious(a)},setHeadingFromPrevious:function(a){var b=parseInt(a.value,10),c=this.getHeadingForCode(a.key.replace("__ALL",""));if(2===b)this.onHeadingOnlyClick(c,!a.reset);else a.reset&&(b=0===b?1:0),this.onHeadingClick(c,0<b)},getHeadingForCode:function(a){for(var b=Object.keys(this.headingsDataMap),
c,d=0;d<b.length;d++)if(this.headingsDataMap[b[d]].code===a){c=b[d];break}return c},updatePreviousFilters:function(a){a?Object.keys(this.previousFilters).forEach(function(b){var c=parseInt(this.previousFilters[b],10);if(a&&a.hasOwnProperty(b)){var d=a[b];d===c||2===d&&0<c||this.removePreviousFilter(b)}else this.options.selectableHeadings&&b.endsWith("__ALL")&&this.updatePreviousFilterHeading(b,a)},this):this.removePreviousFilter()},updatePreviousFilterHeading:function(a,b){var c=b[a],d=this.getHeadingForCode(a.replace("__ALL",
"")),f=[];Object.entries(this.headingValueMap).forEach(function(a){var e=a[0];a=Object.keys(a[1]).filter(function(a){return void 0!==b[a]});if(2>c||e!==d)f=f.concat(a)});var e=!1;(e=2===c||0===c?f.some(function(a){return 1===b[a]}):f.some(function(a){return 0===b[a]}))&&this.removePreviousFilter(a)},setUnCheckedItems:function(a){this.forEachItem(function(b,c){0<=a.items.indexOf(b)?c.setChecked(0):c.setChecked(1)});this.pushStateChange()},onItemHover:function(a){if(!a.hasOwnProperty("namespace")||
a.namespace===this._namespace){var b=this.renderedFilterOptions[a.item],c=(h.question.ask("hotels.results.filtersPinned")||!1)&&!this.options.inModal;if(this.options.showTooltipForEllipsed&&!0===a.hover){var d=b.element.find("label");if(d.length&&d[0].offsetWidth>=d[0].scrollWidth)return}!0===a.hover?b.element.toolTip({content:b.options.state.displayValue,position:c?"bottom":"top",showImmediately:!0,delay:this.options.tooltipHoverDelay}):!1===a.hover&&b.element.data("toolTip")&&b.element.data("toolTip").removeWidget()}},
showOverflowOptions:function(a){this.options.isDropdown?(this.getChildElement("dropdown_content").addClass("overflow-visible").attr("aria-expanded",!0),this.getChildElement("dropdown_content").find(".overflow-item").attr("aria-hidden",!1)):(this.element.addClass("overflow-visible").attr("aria-expanded",!0),this.element.find(".overflow-item").attr("aria-hidden",!1));this.getChildElement("overflow").attr("aria-pressed",!0);this.showOverflowLink.find(".text").html(this.showOverflowLink.data("less"));
if(this.options.collapsedContent){var b=document.documentElement.scrollTop||document.body.scrollTop;this.element.find(".heading").removeClass("collapsed");this.element.find(".heading").addClass("expanded");document.documentElement.scrollTop=b}this.overflowVisible=!0;a&&this.logUserInteraction("overflow/showmore",!0);h.events.publish("filter.overflow.toggle")},hideOverflowOptions:function(a){this.options.isDropdown?(this.getChildElement("dropdown_content").removeClass("overflow-visible").attr("aria-expanded",
!1),this.getChildElement("dropdown_content").find(".overflow-item").attr("aria-hidden",!0)):(this.element.removeClass("overflow-visible").attr("aria-expanded",!1),this.element.find(".overflow-item").attr("aria-hidden",!0));this.showOverflowLink.attr("aria-pressed",!1);this.showOverflowLink.find(".text").html(this.showOverflowLink.data("more"));if(this.options.collapsedContent){var b=document.documentElement.scrollTop||document.body.scrollTop;this.element.find(".heading").addClass("collapsed");this.element.find(".heading").removeClass("expanded");
document.documentElement.scrollTop=b}this.overflowVisible=!1;a&&this.logUserInteraction("overflow/showless",!0);h.events.publish("filter.overflow.toggle")},forEachItem:function(a,b){var c=this,d=b||this.getRenderedFilterOptions();Object.keys(d).forEach(function(b){a.call(c,b,d[b])},this)},getRenderedFilterOptions:function(){return this.renderedFilterOptions},getOptionsContainer:function(){return this.content},getState:function(){var a={};this.metaState&&(a[this.metaState]=1);this.forEachItem(function(b,
c){var d=c.getState();null!==d&&(a[c.state.code||b]=d)},g.extend({},this.getRenderedFilterOptions()));this.options.onGetState&&(a=this.options.onGetState.call(this,a));return a},getHistoryFilterViewState:function(a){var b={};this.forEachItem(function(a,c){var d=c.getState();b[c.state.code||a]=d},g.extend({},this.getRenderedFilterOptions()));var c=this.showCheckedFilterHistory()?"1":"0",d={},f=null,e=Object.keys(a).filter(function(b){b=a[b];if(g.isArray(b)){if(b.filter(function(a){return 2===parseInt(a,
10)}).length)return!0}else return 2===parseInt(b,10);return!1}),e=e.length?e[0]:null,h=Object.keys(a).filter(function(a){return b.hasOwnProperty(a)}),l=function(a,c){var d=b[a],f={},e=null;g.isArray(d)?(f[a]=[],d.forEach(function(b){b===c?null===e&&(e=!0):e=!1;f[a].push(c)})):(e=c===d,f[a]=c);return{state:f,isAlreadyApplied:e}};return e?b.hasOwnProperty(e)?g.extend({},l(e,"2"),{only:e}):{disabled:!0}:h.length?(h.forEach(function(a){var b=l(a,c);d[a]=b.state[a];b.isAlreadyApplied?null===f&&(f=b.isAlreadyApplied):
f=!1}),{state:d,isAlreadyApplied:f}):{disabled:!0}},getStateForFilterHistory:function(){var a={},b=this;this.forEachItem(function(b,d){var c=d.getState();null!==c&&(a[d.state.code||b]=c)},g.extend({},this.getRenderedFilterOptions()));return g.extend({},{displayName:this.options.title,type:h.question.ask("filters.FilterHistory.type.checkbox"),inclusive:this.showCheckedFilterHistory(),state:g.extend({},a),displayValue:Object.keys(a).reduce(function(a,d){a[d]=b.getFilterHistoryDisplayValue(d);return a},
{})})},getFilterHistoryDisplayValue:function(a){var b=h.config.getBoolean("ui.horizon.filters.history.%s.show.code.only".format(this.name),!1),c=this.getRenderedFilterOptions();return c.hasOwnProperty(a)?b?c[a].state.code:c[a].state.displayValue:null},showCheckedFilterHistory:function(){return h.config.getBoolean("ui.horizon.filters.history.%s.show.checked.items".format(this.name),!1)},trackStateChange:function(a){if(this.trackStateChangeEnabled(a)&&this.trackingType){var b=h.VestigoType,c=h.VestigoType.FilterType,
d=h.VestigoEvents.filters,f=a.changeData.field,e=this.getTrackingAction(a.changeData.value);switch(this.trackingType){case c.cabin:a=b.CabinType[f||"m"];d.flights.cabin(a,e);break;case c.sameair:d.flights.sameAirport(e);break;case c.alliance:a=b.AllianceType[f];d.flights.alliance(a,e);break;case c.layoverair:d.flights.layOverAirport(f,e);break;case c.aircraft:a=b.AircraftType[f];d.flights.aircraft(a,e);break;case c.model:a=b.AircraftModelType[f];d.flights.model(a,e);break;case c.freebies:d.hotels.freebies(b.FreebieOption[f],
e);break;case c.neighbourhood:d.hotels.neighbourhood(f,a.changeData.displayValue,e);break;case c.amenities:d.hotels.amenities(f,e);break;case c.style:d.hotels.style(f,e);break;case c.property:d.hotels.property(f,e);break;case c.other:d.hotels.other(b.PriceOption[f],e);break;case c.provider:d.shared.provider(f,e);break;case c.airlines:d.flights.airlines(f,e);break;case c.roomtype:d.packages.roomtype(b.RoomType[f],e);break;case c.propertytype:d.packages.propertytype(f,e);break;case c.board:d.packages.board(b.BoardType[f],
e);break;case c.stars:d.hotels.stars(f,e);break;case c.flightquality:(a=b.FlightQualityType[this.name])&&d.flights.flightquality(a,e)}}}})})(R9,jQuery);(function(c){function k(){var a=c('\x3cdiv class\x3d"scroll-bar"\x3e\x3cdiv class\x3d"gutter"\x3e\x3c/div\x3e\x3cdiv class\x3d"handle"\x3e\x3c/div\x3e\x3c/div\x3e').insertAfter(this);this.data("scrollbar",a);a.find(".handle").height(this[0].offsetHeight/this[0].scrollHeight*100+"%")}function l(){var a=this.data("scrollbar"),b=a.find(".handle");a.find(".gutter");var d=this,g=0;this.on("touchstart",function(a){g=a.touches[0].pageY});this.on("touchmove",function(a){var b=this.scrollTop+10*(0<g-a.touches[0].pageY?
1:-1);e.bind(c(this))(b);a.preventDefault()});this.on("wheel",function(a){var b=a.originalEvent,b=this.scrollTop+10*(0>(-b.deltaY||-b.detail)?1:-1);e.bind(c(this))(b);a.preventDefault()});a.on("click",".gutter",function(a){a=a.pageY||a.clientY;e.bind(d)(h.bind(d)(a),!0)});b.on("mousedown",function(){window.getSelection&&window.getSelection().removeAllRanges();b.addClass("hover");c(document).on("mousemove.scrollhandle",function(a){var b=a.pageY||a.clientY;a.preventDefault();e.bind(d)(h.bind(d)(b))});
c(document).on("mouseup.scrollhandle",function(a){b.removeClass("hover");c(document).off(".scrollhandle")});var a=m();if(a.changeEvt)c(document).on(a.changeEvt,function(){document[a.hiddenProp]&&(b.removeClass("hover"),c(document).off(".scrollhandle"))})})}function m(){var a,b;"undefined"!==typeof document.hidden?(a="hidden",b="visibilitychange"):"undefined"!==typeof document.msHidden?(a="msHidden",b="msvisibilitychange"):"undefined"!==typeof document.webkitHidden&&(a="webkitHidden",b="webkitvisibilitychange");
return{hiddenProp:a,changeEvt:b}}function h(a){var b=this.data("scrollbar"),d=b.find(".handle"),b=b.find(".gutter");a=a-b.offset().top-d.outerHeight()/2;var c=this[0].scrollHeight-this[0].offsetHeight,d=b.height()-d.outerHeight();return c/d*a}function e(a,b){b?this.animate({scrollTop:a},{duration:100,step:f.bind(this),complete:f.bind(this)}):(this[0].scrollTop=a,f.bind(this)())}function f(){var a=this.data("scrollbar");if(a){var b=a.find(".handle"),a=a.find(".gutter"),c=this[0].scrollTop,e=this[0].scrollHeight-
this[0].offsetHeight,a=(a.height()-b.outerHeight())/e*c+b.outerHeight()/2-b.outerHeight()/2+5;b.css("top",a)}}function n(a){a&&"undefined"!==typeof a.scrollTo&&e.bind(this)(a.scrollTo);a&&a.reset&&e.bind(this)(0)}c.fn.scroller=function(a){var b=this.data("scrollbar");if(b)this[0].offsetHeight>=this[0].scrollHeight?b.hide():b.show();else{if(this[0].offsetHeight>=this[0].scrollHeight)return;k.bind(this)();l.bind(this)()}n.bind(this)(a);return this}})(jQuery);(function(f,c){f.createWidgetClass("select.Select",{inputElement:null,dropdownOptions:null,content:null,list:null,jQueryConstructorName:"r9Select",options:{autoOpen:!1,alignment:"left",direction:"down",showIcon:!0,matchWidth:!1,matchMinWidth:!0,iconClass:"",contentClass:"",triggerClass:"",content:null,onInit:null,onOpen:null,onClose:null,text:"",placeholder:"",topOffset:"0",removeZIndex:!1,flippable:!0,change:c.noop},init:function(){this.elementNode=this.element[0];this.createContent();this.inputElement=
this.getChildElement("status");this.dropdownOptions=this.content.find("li");this.list=this.getChildElement("dropdownDialogList");this.focusSelected()},focusSelected:function(){if(this.content.find("li.selected").length){var a=this.content.find("li.selected").addClass("focused");a.siblings().removeClass("focused");this.setInputValue(a);this.element.attr("aria-activedescendant",a.attr("id"))}else a=c(this.content.find("li")[0]),a.length&&(a.addClass("focused").siblings().removeClass("focused"),this.setInputValue(a),
this.element.attr("aria-activedescendant",a.attr("id")))},updateValue:function(a,b){this.isNodeDisabled(a)||(a.addClass("focused").siblings().removeClass("focused"),this.element.attr("aria-activedescendant",a.attr("id")),this.isOpen&&this.ensureVisible(a),a.addClass("selected").siblings().removeClass("selected"),this.setInputValue(a),b&&"function"===typeof this.options.change&&this.inputElement.trigger("change"))},setInputValue:function(a){this.inputElement.text(a.attr("data-title"));this.inputElement.attr("data-value",
a.attr("data-value"));this.inputElement.attr("data-title",a.attr("data-title"));this.element.hasValue=!0},ensureVisible:function(a,b){var c=a.position().top;a=a.outerHeight(!0);var d=this.content.scrollTop(),g=this.content.height(),k=this.list.scrollTop();if(b){b=this.list[0].scrollHeight;var f=c+this.list.scrollTop(),h=(g-a)/2;if(f>h&&b-f>h){this.list.scroller({scrollTo:d+k+c-h});return}f<h?this.list.scroller({scrollTo:0}):this.list.scroller({scrollTo:b-g})}0>c?this.list.scroller({scrollTo:d+k+c}):
c+a>g&&this.list.scroller({scrollTo:d+k+(c+a-g)})},addEventHandlers:function(){function a(a){a=c(a.target).closest(".Common-Widgets-Select-Select-Content");b.content[0]!=a[0]&&b.isOpen&&(b.close(),b.blur())}var b=this,e=c("body"),d;d=this.options.triggerClass?c("."+b.options.triggerClass):c(b.element);this.inputElement.on("change",function(a){b.options.change&&b.options.change.call(b,a)});b.dropdownOptions.on("click",function(a){b.updateValue(c(this),!0);b.close();b.blur()});e.on("click",a);this.subscribe("trips.menu.open",
c.proxy(this.close,this));this.subscribe("select.force.close",c.proxy(this.close,this));f.events.subscribe("authentication.showLogin",this.close.bind(this,null,!0));d.click(function(c){b.element.closest(".Common-Widgets-Select-Select-Content").length||(e.off("click",a),b.element.focus(),b.toggleContent(),setTimeout(function(){e.on("click",a)},10))});c(document).keydown(function(a){27===a.which&&b.close(a,null,!0)});this.element.focusout(function(){b.element.hasClass("closed")&&b.blur()});this.element.blur(function(){b.element.hasClass("closed")&&
b.blur()});this.element.keydown(function(a){if(13===a.which||32===a.which)b.selectFocused(),b.close(),a.preventDefault();if(40===a.which){if(b.isOpen){var c=b.content.find(".focused").next();c.length&&b.updateValue(c)}else b.open();a.preventDefault();a.stopImmediatePropagation()}38===a.which&&(b.isOpen?(c=b.content.find(".focused").prev(),c.length&&b.updateValue(c)):b.open(),a.preventDefault(),a.stopImmediatePropagation());9==a.which&&(b.close(),b.blur())});this.element.on("focus",function(){b.element.addClass("focused")});
c(window).on("resize",function(){b.isOpen&&b.reposition()});c(document).on("scroll",function(){b.isOpen&&b.reposition()});c(".viewport").on("scroll",function(){b.isOpen&&b.reposition()});c(".col-left-rail").on("scroll",function(){b.isOpen&&b.reposition()});c(".filterList").on("scroll",function(){b.isOpen&&b.reposition()});d=function(){b.element.is(":visible")&&(f.Common.Utils.Browsers.isIE(11)||setTimeout(function(){b.reposition()},25))};this.content.on("mouseup touchend",d);f.events.subscribe("horizon.dropdownDialog.reposition",
d);f.events.subscribe("horizon.selectWidget.reposition",d);f.events.subscribe("Select.OutsideExit",b.outsideExit.bind(b))},val:function(){return this.inputElement.attr("data-value")},getValue:function(){return this.val()},dataVal:function(){return this.inputElement.attr("data-value")},getDataValue:function(){return this.dataVal()},getText:function(){return this.inputElement.text()},setText:function(a){this.inputElement.text(a)},setValue:function(a,b){a=this.content.find("li[data-value\x3d'"+a+"']");
a.length&&this.updateValue(a,b)},setValueOrDefault:function(a,b){a=this.content.find("li[data-value\x3d'"+a+"']");a.length?this.updateValue(a,b):this.setValue("",b)},isNodeSelected:function(a){return a.length&&a.hasClass("selected")},isNodeDisabled:function(a){return a.length&&a.hasClass("disabled")},getNodeDataValue:function(a){return a.length?a.attr("data-value"):""},disableValue:function(a){a=this.content.find("li[data-value\x3d'"+a+"']");a.length&&a.addClass("disabled")},enableValue:function(a){a=
this.content.find("li[data-value\x3d'"+a+"']");a.length&&a.removeClass("disabled")},blur:function(){this.element&&this.element.removeClass("closed focused");this.content.removeClass("closed")},createContent:function(){this.content=this.options.content?c(this.options.content):c("#"+this.element.attr("id")+"_content")},open:function(){this.isOpen=!0;var a=this,b="body";this.focusSelected();this.options.container&&""!==this.options.container&&(b=this.options.container,c(a.options.container).off("scroll."+
a.id()).on("scroll."+a.id(),function(){a.isOpen&&a.reposition()}));this.content.appendTo(b);this.reposition();a.element.addClass("open");a.content.addClass("open");a.element.removeClass("closed");a.content.removeClass("closed");f.globals.testMode&&this.element.add(this.content).attr("data-test-popover-open",!0);a.list.scroller();b=a.content.find("li.focused");a.ensureVisible(b,!0);if(this.options.onOpen)this.options.onOpen(this);f.events.publish("Select.open",{id:a.id()})},selectFocused:function(){var a=
this.content.find("li.focused");a.length&&this.updateValue(a,!0)},getFocusableElements:function(){return this.content.find(":input:visible,[tabindex]:visible").not("[tabindex\x3d-1],[disabled]")},close:function(a,b,c){if(this.isOpen){var d=this.isOpen,g=this;this.isOpen=!1;this.element.removeClass("open");this.content.removeClass("open");this.element.addClass("closed");this.content.addClass("closed");f.globals.testMode&&this.element.add(this.content).attr("data-test-popover-open",!1);g.element.after(g.content);
var e=this.content.find("li.selected");e.length&&this.element.attr("aria-activedescendant",e.attr("id"));c&&setTimeout(function(){g.element.focus()},1);if(this.options.onClose)this.options.onClose(d,this,a);f.events.publish("Select.close",{id:g.id(),silent:!!b})}},toggleContent:function(){this.isOpen?this.close(null,null,!0):this.open()},updateLabel:function(a){this.label.html(a);"0"==a+""||a?this.element.addClass("hasValue"):this.element.removeClass("hasValue")},hasValue:function(){return this.element.hasClass("hasValue")},
reposition:function(){var a=this.options.direction,b=this.element.offset(),e=c(this.options.container);if(e.length)var d=e.offset(),b={top:b.top-d.top+e.scrollTop(),left:b.left-d.left};else e=c(window);d=b.top+this.element.outerHeight();this.shouldFlipDirection(a)&&(a="down"===a?"up":"down");"up"===a?(this.content.addClass("up"),d=b.top-this.content.outerHeight()):this.content.removeClass("up");a={top:d+"px"};"right"===this.options.alignment?a.right=e.width()-(b.left+this.getTriggerWidth())+"px":
a.left="center"===this.options.alignment?b.left-this.content.outerWidth()/2+this.getTriggerWidth()/2+"px":b.left+"px";this.options.topOffset&&"0"!=this.options.topOffset&&(a.marginTop=this.options.topOffset+"px");this.leftOffset&&(a.marginLeft=this.leftOffset+"px");this.options.matchWidth?(a.minWidth=this.getTriggerWidth()+"px",a.maxWidth=a.minWidth):(a.minWidth=this.options.matchMinWidth?this.getTriggerWidth()+"px":"",a.maxWidth="");this.options.removeZIndex||(a.zIndex=this.element.zIndex()+9999);
this.content.css(a)},shouldFlipDirection:function(a){if(this.options.flippable){var b=c(window).scrollTop(),e=b+c(window).outerHeight(),d=this.content.outerHeight(),g=this.element.offset().top,e=g+this.element.outerHeight()+d>e,b=g-d<b;if("down"===a)return e&&!b;if("up"===a)return b&&!e}return!1},getTriggerWidth:function(){var a=this.elementNode.getBoundingClientRect();return a?a.right-a.left:this.element.outerWidth()},setOptions:function(a,b){var e=this.dropdownOptions;c.each(a,function(a,b){a=c(e[a]);
a.attr("data-value",b.value);a.attr("data-title",b.title);a.text(b.text);a.prop("disabled",b.disabled)})},setToFirstOption:function(){this.updateValue(c(this.dropdownOptions[0]),!1)},unselect:function(){this.dropdownOptions.removeClass("selected")},getSelectedElement:function(){var a=this.getValue(),b=this.getText();return{value:a,title:b,text:b}},outsideExit:function(a){a&&a.selectId&&a.selectId===this.id()&&this.close()}})})(window.R9,window.jq||window.jQuery);(function(c,d){c.createComponentClass("hotels.results.HotelPriceTypeSelector",{options:{defaultPriceType:"daybase",useRadioBoxes:!1,trackEnabled:!1,savingPriceTypeToSessionStorageEnabled:!1},priceDropdownWidget:null,init:function(){this.options.useRadioBoxes?this.bindPriceTypeWidget():this.bindPriceTypeDropdown();this.options.savingPriceTypeToSessionStorageEnabled&&sessionStorage.getItem("priceType")&&this.priceDropdownWidget.setValue(sessionStorage.getItem("priceType"))},addEventHandlers:function(){var a=
this;this.subscribe("searchform.submit",this.load.bind(this));this.subscribe(["resultspage.streaming.done","resultspage.filtersData.changed","filter.show"],function(){a.element.removeClass("hidden")});this.subscribe(["hotels.search.location.changed","rentals.search.location.changed"],function(){a.priceDropdownWidget.setValue(a.options.defaultPriceType)});this.subscribe(["search.searchFailed","search.startSearch"],function(){a.element.addClass("hidden")});this.subscribe("resultspage.priceType.changed",
function(b){b.priceType&&a.priceDropdownWidget.setValue(b.priceType)});c.question.forget("results.priceType");this.answer("results.priceType",this.getCurrentPriceType.bind(this))},load:function(a){a.priceType&&this.priceDropdownWidget.setValue(a.priceType)},bindPriceTypeWidget:function(){var a=this;this.priceDropdownWidget=this.getChildElement("priceType").styleJamRadioButtonSet({change:function(b){b&&a.publishPriceType(this.getValue())}}).getWidget()},bindPriceTypeDropdown:function(){var a=this;
this.priceDropdownWidget=this.getChildElement("priceType").r9Select({change:function(b){b&&(b=this.getValue(),a.trackChanges.call(a,b),a.publishPriceType(b))}}).getWidget();var b=this.getChildElement("price-tooltip");b&&b.toolTip({content:b.data("message"),showImmediately:!1})},trackChanges:function(a){this.options.trackEnabled&&c.VestigoEvents&&c.VestigoEvents.filters.shared.priceType(c.VestigoType.PriceType[a])},publishPriceType:function(a){a&&(this.options.savingPriceTypeToSessionStorageEnabled&&
sessionStorage.setItem("priceType",a),c.events.publish("resultsHeader.changed",{priceType:a,refreshResults:!0}))},getCurrentPriceType:function(){return this.priceDropdownWidget.getValue()}})})(R9,jQuery);(function(g,f){g.createWidgetClass("slider.Slider",{options:{start:f.noop,stop:f.noop,slide:f.noop,min:0,max:100,step:1,values:[],range:!0,logarithmic:!1,snapToValue:!1,timeValueAmount:0,leftPosition:0,rightPosition:0,exponent:-1,cutoff:-1,totalRange:-1,totalStepAmount:-1,equalStepAmount:-1,cutoffPercentage:-1,equalStepRange:-1,expStepAmount:-1,useCustomDistribution:!1},init:function(){var a=this,b=a.options,c=a.element;a.handles=c.children(".js-handle");a.activeRange=c.find(".js-active-range");a.handles.off(".r9RangeSlider").on("mousedown.r9RangeSlider touchstart.r9RangeSlider",
function(b){a.mouseDown(b);b.preventDefault();b.stopPropagation(!0)});a.setHandleAttribute("valuemin",b.min);a.setHandleAttribute("valuemax",b.max);setTimeout(function(){var c=b.values;if(!c||1>c.length)c=b.range?[b.min,b.max]:[b.min];(c=a.determineSetValues(c))&&a.errorSetValues(c);a.setHandleAttribute("label",b.ariaLabel)},1)},errorSetValues:function(a){g.Widgets.Slider.singleSetValuesError||(g.Widgets.Slider.singleSetValuesError=1,g.config.getBoolean("ui.slider.logVs",!0)&&g.Analytics.api.trackEvent({category:"slider",
action:"error",label:"setvalues",value:(window===window.top)+"-"+(window.top===window.parent)}))},determineSetValues:function(a){if(g.config.getBoolean("ui.slider.safeSetValues",!0))return this.safeSetValues(a);this.setValues(a);return null},safeSetValues:function(a){try{return this.setValues(a),null}catch(b){return b}},setHandleAttribute:function(a,b,c){var d=this.handles;void 0!==c?f(d[c]).attr("aria-"+a,b):f(d).attr("aria-"+a,b);g.globals.testMode&&(void 0!==c?f(d[c]).attr("data-test-sliderhandle-"+
a,b):f(d).attr("data-test-sliderhandle-"+a,b))},setCustomDistribution:function(a){this.options.exponent=a.exponent;this.options.cutoff=a.cutoff;this.options.totalRange=this.options.max-this.options.min;this.options.totalStepAmount=a.ranges.length;this.options.cutoffPercentage=a.cutoffPercentage;this.options.equalStepAmount=this.options.cutoffPercentage*this.options.totalStepAmount;this.options.equalStepRange=this.options.cutoff-this.options.min;this.options.expStepAmount=this.options.totalStepAmount-
this.options.equalStepAmount;this.options.useCustomDistribution=!0},resetCustomDistribution:function(){var a=this.options;a.exponent=-1;a.cutoff=-1;a.totalRange=a.max-a.min;a.totalStepAmount=-1;a.equalStepAmount=-1;a.cutoffPercentage=-1;a.equalStepRange=-1;a.expStepAmount=-1;a.useCustomDistribution=!1},setValue:function(a){this.setValues([a])},getValues:function(){return this.options.values.slice(0)},setValues:function(a){var b=this,c=b.options,d="rtl"===document.dir?"right":"left";c.values=[];for(var e=
0;e<a.length;e++){var h=b.trimAlignValue(a[e]),k=100*b.positionForValue(h),l=2;1<a.length&&(0===e&&90<=k||e===a.length-1&&10>=k)&&(l=3);c.values.push(h);f(b.handles[e]).css("z-index",l).css(d,k+"%");0===e&&c.range?c.leftPosition=k+"%":c.rightPosition=k+"%"}setTimeout(function(){b.drawActiveRange()},60);g.config.getBoolean("ui.slider.nonBlockingDrawActiveRange",!0)?setTimeout(b.drawActiveRange.bind(b),1):b.drawActiveRange();c.slide(null,c.values)},drawActiveRange:function(){var a=this.handles,b=f(this.activeRange),
c=this.options,d=!1,e=0,h=c.rightPosition,g="rtl"===document.dir?"right":"left";c.range&&(e=c.leftPosition);if(h&&"string"===typeof h&&0<=h.indexOf("%")||e&&"string"===typeof e&&0<=e.indexOf("%"))d=!0;h=parseInt(h)-parseInt(e);b.width((h||0)+(d?"%":"")).css(g,e);(1<a.length?c.values[0]===c.min&&c.values[1]===c.max:c.values[0]===c.max)?b.addClass("fullRange"):b.removeClass("fullRange")},mouseDown:function(a){var b=this,c=b.options;b.element.hasClass("Disabled")||(b.setupActiveHandle(a.target),f(document).on("mousemove.r9RangeSlider touchmove.r9RangeSlider",
function(a){b.mouseMove(a)}).on("mouseup.r9RangeSlider touchend.r9RangeSlider",function(a){a.stopPropagation(!0);b.mouseUp(a)}),b.setStartValues(),c.start(a,c.values))},mouseUp:function(a){var b=this.options;f(this.activeHandle).removeClass("r9-rangeSlider-handle-active");this.activeHandleIndex=this.activeHandle=null;f(document).off(".r9RangeSlider");var c=!1;if(this.startValues)for(var d=0;d<b.values.length;d++){if(b.values[d]!==this.startValues[d]){c=!0;break}}else c=!0;b.stop(a,b.values,c)},mouseMove:function(a){a.preventDefault();
a.stopPropagation();var b=this.options,c="rtl"===document.dir,d=a.originalEvent;d.touches&&0<d.touches.length?a.pageX=d.touches[0].pageX:d.changedTouches&&0<d.changedTouches.length&&(a.pageX=d.changedTouches[0].pageX);d=Math.min(this.elementWidth,Math.max(0,a.pageX-this.elementPositionLeft));this.setActiveHandleValue(this.valueForPosition((c?this.elementWidth-d:d)/this.elementWidth,this.activeHandleIndex));b.slide(a,b.values)},setupActiveHandle:function(a){var b=this.element;this.activeHandle=a;this.activeHandleIndex=
null;this.elementWidth=b.outerWidth();this.elementPositionLeft=b.offset().left;for(a=0;a<this.handles.length;a++)this.activeHandle===this.handles[a]&&(this.activeHandleIndex=a);f(this.activeHandle).addClass("r9-rangeSlider-handle-active")},setActiveHandleValue:function(a){var b=this.options,c=100*this.positionForValue(a),d="rtl"===document.dir?"right":"left";f(this.activeHandle).css("z-index","3").css(d,c+"%");for(c=0;c<this.handles.length;c++)this.handles[c]===this.activeHandle&&(b.values[c]=a,this.setHandleAttribute("valuenow",
a,c),1<this.handles.length&&(0===c?this.setHandleAttribute("valuemin",a,1):this.setHandleAttribute("valuemax",a,0)));this.drawActiveRange()},setStartValues:function(){var a=this.options.values;this.startValues=[];for(var b=0;b<a.length;b++)this.startValues[b]=a[b]},validateElement:function(){return this.element.hasClass("Common-Widgets-Slider-Slider2")},positionForValue:function(a){var b=this.options,c=b.min,d=b.max,e=b.cutoffPercentage;b.logarithmic?(b=Math.log(c),a=(Math.log(a)-b)/(Math.log(d)-
b)):a=b.useCustomDistribution?a>b.cutoff?Math.log(a-b.cutoff)/b.exponent/b.expStepAmount*(1-e)+e:(a-c)/b.equalStepRange*e:(a-c)/(d-c);return a.toFixed(5)},valueForPosition:function(a,b){var c=this.options;if(c.logarithmic&&1!==a){var d=Math.log(c.min);a=Math.exp(d+(Math.log(c.max)-d)*a)}else a=c.useCustomDistribution&&1!==a&&0<a?a>c.cutoffPercentage?c.cutoff+Math.exp((a*c.totalStepAmount-c.equalStepAmount)*c.exponent):1/c.cutoffPercentage*a*c.equalStepRange+c.min:c.min+(c.max-c.min)*a;a=this.trimAlignValue(a);
0<b&&(a=Math.max(a,c.values[b-1]));b+1<this.handles.length&&(a=Math.min(a,c.values[b+1]));d=100*this.positionForValue(a)+"%";0===b&&c.range?c.leftPosition=d:c.rightPosition=d;return a},trimAlignValue:function(a){var b=this.options,c=b.min,d=b.max;if(a<=c)return c;if(a>=d)return d;b.snapToValue?(b=10<b.step?b.step:10,b=Math.ceil(Math.pow(b,Math.floor(Math.log(a)/Math.log(b))-1))):b=0<b.step?b.step:1;var e=a%b;a-=e;2*Math.abs(e)>=b&&(a+=0<e?b:-b);a=parseFloat(a.toFixed(5));a=Math.min(a,d);return a=
Math.max(a,c)}})})(R9,jQuery);(function(d){R9.createWidgetClass("number.NumberInput","common.widgets.text.TextInput",{widgetPlaceholderClass:"vs-placeholder",inputElement:null,options:{needsPlaceholderSupport:!1,decimalLimit:null},init:function(){this.inputElement=this.getChildElement("input")||this.element;this.elementNode=this.inputElement.get(0)},addEventHandlers:function(){this.options.needsPlaceholderSupport&&(this.element.is(":focus")||this.handleElementBlurEvent(this.elementNode),this.bindInputEvent("focus",this.handleElementFocusEvent),
this.bindInputEvent("smartyfocus",this.handleElementFocusEvent),this.bindInputEvent("blur",this.handleElementBlurEvent));var b=this;"number"===typeof b.options.decimalLimit&&0<=b.options.decimalLimit&&this.inputElement.keyup(function(c){var a=d(c.currentTarget).val(),e=a.indexOf("."),f=a.length-e-1;-1!==e&&f>b.options.decimalLimit&&(a=parseFloat(a),"number"===typeof a&&a===a&&(d(c.currentTarget).val(a.toFixed(b.options.decimalLimit)),c.preventDefault()))})}})})(jq||jQuery);(function(g,f){g.createComponentClass("common.results.filters.RangeFilterSlider","common.results.filters.Filter",{options:{formatValues:function(a){return a},displayFormat:"%s",min:void 0,max:void 0,snapToValue:!1,step:1,logarithmic:!1,useTextInput:!1,maxValueSlider:!1,onStop:f.noop,onSlide:void 0,onStart:void 0,onValidate:void 0,useAndUp:!1,andUpString:"",andUpMax:null,usesRangeDistribution:!1},minRange:void 0,maxRange:void 0,leftRange:void 0,rightRange:void 0,displayLabel:void 0,leftDisplay:void 0,
separatorDisplay:void 0,rightDisplay:void 0,andUpDisplay:void 0,andUpMin:void 0,textInputForm:void 0,textInputMin:void 0,textInputMax:void 0,textInputOpen:!1,widget:void 0,init:function(){this.displayLabel=this.getChildElement("rangeLabel");this.leftDisplay=this.element.find(".min");this.rightDisplay=this.element.find(".max");this.separatorDisplay=this.element.find(".sep");this.andUpDisplay=this.element.find(".andup");this.andUpMin=this.element.find(".minValue");this.andUpText=this.element.find(".andUpText")},
addEventHandlers:function(){var a=this;this.answer("RangeFilterSlider.init."+this.id(),function(b){for(var c in b)!b.hasOwnProperty(c)||null!==b[c]&&void 0!==b[c]||delete b[c];f.extend(a.options,b);return a});this.widget=this.getChildElement("sliderWidget").slider({range:!this.options.maxValueSlider,min:this.options.min,max:this.options.max,step:this.options.step,snapToValue:this.options.snapToValue,logarithmic:this.options.logarithmic,useTextInput:this.options.useTextInput,usesRangeDistribution:this.options.usesRangeDistribution}).getWidget();
this.minRange=this.options.min;this.maxRange=this.options.max;var c=function(b){a.options.maxValueSlider?a.setRightRange(b[0]):(a.setLeftRange(b[0]),a.setRightRange(b[1]))};this.widget.setOption("stop",function(b,d,e){e&&(a.setLastUserInteraction(!0),c(d));a.options.onStop(b,d,e)});this.widget.setOption("slide",function(b,d){if(b&&(c(d),"function"===typeof a.options.onSlide))a.options.onSlide(b,d)});this.options.useTextInput&&(this.textInputForm=this.getChildElement("textInputForm"),this.textInputMin=
this.getChildElement("minInput").find("input[type\x3dnumber]"),this.textInputMax=this.getChildElement("maxInput").find("input[type\x3dnumber]"),this.addTextInputHandlers());this.widget.setOption("start",function(b,c){if("function"===typeof a.options.onStart)a.options.onStart(b,c)});this.subscribe("results.filter.disablePriceGraph",function(){var b=a.getChildElement("sliderWidget"),c=b.children(".left"),b=b.children(".right");c.css("left","0%");b.css("left","100%");a.leftDisplay.html("---");a.rightDisplay.html("---");
a.leftDisplay.addClass("disabled");a.rightDisplay.addClass("disabled")});this.subscribe("results.filter.enablePriceGraph",function(){a.leftDisplay.removeClass("disabled");a.rightDisplay.removeClass("disabled")})},addTextInputHandlers:function(){var a=this;this.displayLabel.click(a.openTextInput.bind(a));this.textInputForm.submit(a.submitTextInput.bind(a));f("body").on("click.exceptPriceFilter",function(b){!a.textInputOpen||0<f(a.element).find(f(b.target)).length||(a.textInputForm.trigger("submit"),
a.closeTextInput())});var c={9:function(b){b.target&&f(b.target).is(a.textInputMin)?a.textInputMax.focus():a.closeTextInput()},13:function(){a.textInputForm.trigger("submit")},27:function(){a.closeTextInput()}};this.textInputForm.keydown(function(a){"function"===typeof c[a.keyCode]&&(c[a.keyCode](a),a.preventDefault())})},setMinRange:function(a){this.minRange=a;this.options.min=a;this.widget.setOption("min",a);this.widget.setHandleAttribute("valuemin",a,0)},setMaxRange:function(a){this.maxRange=a;
this.options.max=a;this.widget.setOption("max",a);this.widget.setHandleAttribute("valuemax",a,1)},setUsesRangeDistribution:function(a){this.options.usesRangeDistribution=a;this.widget.setOption("usesRangeDistribution",a)},setLeftRange:function(a,c){this.leftRange=a;g.dom.schedule(this.updateDisplay.bind(this,c))},setRightRange:function(a,c){this.rightRange=a;g.dom.schedule(this.updateDisplay.bind(this,c))},isLeftRangeManipulated:function(){var a=this.widget&&this.widget.getValues();return a&&this.minRange!==
a[0]},isRightRangeManipulated:function(){var a=this.widget&&this.widget.getValues();return a&&this.maxRange!==a[1]},reset:function(){this.setLeftRange(this.minRange);this.setRightRange(this.maxRange)},clearState:function(){this.leftRange=this.rightRange=this.minRange=this.maxRange=void 0},validateValues:function(a){if("function"===typeof this.options.onValidate)return this.options.onValidate(a);var c=a[0]!==a[0]||a[1]!==a[1];return a&&a[0]&&a[1]&&!c?this.minRange<=a[0]&&a[0]<=a[1]&&a[1]<=this.maxRange:
!1},updateDisplay:function(a,c){var b=this.options.formatValues([this.leftRange,this.rightRange],this),d=b[0],b=b[1],e=this.options.displayFormat;if("function"===typeof e)d=e(d,!0),b=e(b,!1);else if("string"===typeof e)d=e.format(d),b=e.format(b);else throw"Must pass a valid display formula [function || string]";this.leftDisplay.html(d);this.options.useAndUp&&this.andUpMin.html(d);this.rightDisplay.html(b);this.options.useAndUp&&(this.rightRange==this.maxRange?(this.rightDisplay.hide(),this.separatorDisplay.hide(),
this.leftDisplay.hide(),this.andUpDisplay.show()):(this.andUpDisplay.hide(),this.leftDisplay.show(),this.separatorDisplay.show(),this.rightDisplay.show()),this.options.andUpMax&&(this.leftRange>this.options.andUpMax?this.andUpText.hide():this.andUpText.show()));e=[this.leftRange,this.rightRange];this.options.maxValueSlider&&(e[0]=this.rightRange);this.widget.setHandleAttribute("valuetext",this.options.maxValueSlider?b:d,0);this.widget.setHandleAttribute("valuetext",b,1);a&&(c&&c.useCustomDistribution?
this.widget.setCustomDistribution(c):c&&!1===c.useCustomDistribution&&this.widget.resetCustomDistribution(),this.widget.setValues(e));this.textInputForm&&this.updateTextInput(e)},openTextInput:function(a){if(this.textInputForm&&!(1>this.textInputForm.length)){var c=f(a.target).is(".max")?this.textInputMax:this.textInputMin;this.resetTextInput();this.textInputForm.removeClass("hidden");this.displayLabel.addClass("hidden");this.textInputOpen=!0;setTimeout(function(){c.focus()},10)}},closeTextInput:function(){!this.textInputForm||
1>this.textInputForm.length||(this.displayLabel.removeClass("hidden"),this.textInputForm.addClass("hidden"),this.textInputOpen=!1)},receiveMaxValue:function(a){a=[this.options.min,Math.round(Number(a))];if(!this.validateValues(a))return this.resetTextInput(),!1;this.widget.options.stop(null,a,a[0]!==this.leftRange||a[1]!==this.rightRange)},submitTextInput:function(a){a.preventDefault();var c=Math.round(Number(this.textInputMin.val())),b=Math.round(Number(this.textInputMax.val())),c=[c,b];if(!this.validateValues(c))return this.resetTextInput(),
!1;this.widget.options.stop(a,c,c[0]!==this.leftRange||c[1]!==this.rightRange);this.closeTextInput();return!1},updateTextInput:function(a){this.textInputMin.val(a[0]).attr("min",this.minRange).attr("max",a[1]);this.textInputMax.val(a[1]).attr("min",a[0]).attr("max",this.maxRange)},resetTextInput:function(){this.textInputMin.val(this.leftRange);this.textInputMax.val(this.rightRange)},destroy:function(){this.base();f("body").off("click.exceptPriceFilter")}})})(window.R9,window.jQuery);(function(e,g){g.openTooltipInstances={};var b=!1;R9.extend("Widgets",{Tooltip:function(a,d){this.element=e(a);this.element.data(this.widgetName,this);this.setOptions(d,!0)}});R9.extend("Widgets.Tooltip",{validateElement:function(a){return void 0===e(a).data(this.prototype.widgetName)},getInstance:function(a,d){return this.validateElement(a)?new R9.Widgets.Tooltip(a,d):(a=e(a).data(this.prototype.widgetName),d?a.setOptions(d):a)},removeWidget:function(a){this.validateElement(a)||this.getInstance(a).removeWidget()},
setDebug:function(a){b=a},isDebug:function(){return b}});R9.extend("Widgets.Tooltip.prototype",{element:null,widgetNamespace:"r9-tooltip",widgetBaseClass:"r9-tooltip",widgetName:"tooltip",positionTarget:"data-tooltip-position-target",isOpen:!1,options:{delay:200,fadeIn:200,fadeOut:200,edgeOffset:3,baseClass:null,content:null,positionTarget:null,position:"top",activation:"hover",showImmediately:!1,subNameSpace:"",onOpen:null,fixedPositioning:null,onClose:null,positionUpdate:!1,appendTo:"body",offsetLeft:0,
offsetAgainstEdge:!0,keepOpenOnContentHover:!1,keepOpenOnPositionTargetHover:!1,readContentOnOpen:!1,keepOpenOnRelatedTargetHover:!0,closeDelay:0,fallbackPosition:null,forceDesiredPosition:!1},_timer:null,_closeTimer:null,_originalTitle:null,_positionUpdater:null,init:function(){this._removeAllWidgetBindings();openTooltipInstances.hasOwnProperty(this.options.subNameSpace)||(openTooltipInstances[this.options.subNameSpace]=null);var a=this,d=a._getContainerElement(),c=a._getArrowElement();switch(this.options.activation){case "click":this.element.on("click."+
this.widgetName,function(c){null===openTooltipInstances[a.options.subNameSpace]&&(a.isOpen=!1);a.isOpen?a.close(c):setTimeout(a.open.bind(a,c),0)});this.options.keepOpenOnContentHover||this.bindContainerHoverEvents();this.options.showImmediately&&this.element.trigger("click."+this.widgetName);break;case "focus":this.element.on("focus."+this.widgetName,function(c){a.open(c)});this.element.on("blur."+this.widgetName,function(c){a.close(c)});this.options.showImmediately&&this.element.trigger("focus."+
this.widgetName);break;default:this.element.on("mouseenter."+this.widgetName,function(c){a.triggeredMouseOpen=!0;clearTimeout(a._closeTimer);a.open(c)});var b=this.options.keepOpenOnPositionTargetHover?this._getPositionTarget():this.element;b.on("mouseleave."+this.widgetName,function(b){a.triggeredMouseOpen=!1;a.options.keepOpenOnRelatedTargetHover&&(e(b.relatedTarget).closest(d).length||e(b.relatedTarget).closest(c).length)||(a.options.closeDelay?a._closeTimer=setTimeout(function(){a.close(b)},a.options.closeDelay):
a.close(b))});if(R9.config&&R9.config.getBoolean("ui.common.widgets.tooltip.touchend",!0))b.on("touchend."+this.widgetName,function(){a.triggeredMouseOpen&&(a.triggeredMouseOpen=!1,b.off("click.touchendfix").on("click.touchendfix",function(){b.off("click.touchendfix");a.element.trigger("mouseenter."+a.widgetName)}))});this.options.showImmediately&&this.element.trigger("mouseenter."+this.widgetName);this.options.keepOpenOnContentHover&&this.bindContainerHoverEvents()}return this},bindContainerHoverEvents:function(){var a=
this;this._getContainerElement().on("mouseenter."+this.widgetName,function(){a.isOpen&&clearTimeout(a._closeTimer)}).on("mouseleave."+this.widgetName,function(d){a.isOpen&&!e(d.relatedTarget).closest(a._getArrowElement()).length&&(a._closeTimer=setTimeout(function(){a.close(d)},a.options.closeDelay))})},setOptions:function(a,d){a&&(this.options=e.extend({},this.options,a));(a||d)&&this.init();return this},open:function(a){var d=this.getContent(a);if(!d||this.isOpen)return this;var c=!1;openTooltipInstances[this.options.subNameSpace]&&
openTooltipInstances[this.options.subNameSpace]!==this&&(c=!0,openTooltipInstances[this.options.subNameSpace].close(a,c));var b=this._getWrapperElement(),f=this._getContainerElement(),h=this._getArrowElement();this.renderContent(d,f);this._resetElements(b,f,h);d=this._getPositionMap(b,h);this._updateArrowElement(d,h);this._updateWrapperElement(d,b);this._updateContainerElement(d,f);if(this.options.fixedPositioning){var k=this;Object.keys(this.options.fixedPositioning).forEach(function(a){b.css(a,
k.options.fixedPositioning[a])});b.css("position","fixed")}this._timer&&clearTimeout(this._timer);this._closeTimer&&clearTimeout(this._closeTimer);this.isOpen=!0;openTooltipInstances[this.options.subNameSpace]=this;if(this.options.delay){var m=this;this._timer=setTimeout(function(){m._open(b,a,c)},this.options.delay)}else this._open(b,a,c);this._positionUpdater&&clearInterval(this._positionUpdater);e(g).on("resize",e.proxy(this._updatePosition,this));return this},renderContent:function(a,d){d.html(a)},
close:function(a,d){if(!R9.Widgets.Tooltip.isDebug()){this._timer&&clearTimeout(this._timer);this._closeTimer&&clearTimeout(this._closeTimer);this._positionUpdater&&clearInterval(this._positionUpdater);e(g).off("resize",this._updatePosition);a=this._getWrapperElement();a.stop(!0,!0);this.isOpen=!1;openTooltipInstances[this.options.subNameSpace]=null;var c=this;this.options.fadeOut&&!d?a.fadeOut(this.options.fadeOut,function(){c._close()}):(a.hide(),this._close());return this}},getContent:function(a){var d=
this.element.attr("title");d&&(this._originalTitle=d,this.element.removeAttr("title"));return this.options.content?"function"==typeof this.options.content?this.options.content.call(this,a):this.options.content:this._originalTitle?this._originalTitle:null!=this.element.data("title")?this.element.data("title"):this.element.text()},removeWidget:function(){this._removeAllWidgetBindings();this.element.removeData(this.widgetName);this.close();return this},_updatePosition:function(){var a=this._getWrapperElement(),
d=this._getContainerElement(),c=this._getArrowElement(),b=this._getPositioning(a,c);this._updateArrowElement(b,c);"rtl"!==document.dir&&a.css({top:b.newWrapperTop+"px",left:b.newWrapperLeft+"px"});this._updateContainerElement(b,d)},_getWrapperElement:function(){var a=e("#"+this._getIdValue("-wrapper"));a.length||(a=this._createDOMElement("-wrapper"),this.options.readContentOnOpen?a.attr("role","alert"):a.attr("role","tooltip"),e(this.options.appendTo).append(a));return a},_getContainerElement:function(){var a=
e("#"+this._getIdValue("-container"));a.length||(a=this._createDOMElement("-container"),this._getWrapperElement().append(a));return a},_getArrowElement:function(){var a=e("#"+this._getIdValue("-arrow"));a.length||(a=this._createDOMElement("-arrow"),this._getWrapperElement().append(a));return a},_createDOMElement:function(a){var d=e("\x3cdiv\x3e\x3c/div\x3e").attr("id",this._getIdValue(a));this._setStyleClasses(d,a);return d},_removeAllWidgetBindings:function(){this.element.off("click."+this.widgetName).off("focus."+
this.widgetName).off("blur."+this.widgetName).off("mouseenter."+this.widgetName).off("mouseleave."+this.widgetName).off("touchend."+this.widgetName);return this},_getPositionTarget:function(){var a=this.options.positionTarget||this.element.attr(this.positionTarget);return a&&(a=this.options.positionTarget?e("#"+this.options.positionTarget):e(a,this.element),0<a.length)?a:this.element},_getOffsetInformation:function(a,d,c){var b=this._getPositionTarget();this.options.fixedPositioning&&this._getContainerElement();
var f=b.outerWidth(),h=b.outerHeight();a="width"===a?c.outerWidth():c.outerHeight();return{arrowSize:Math.round(a/2),elementWidth:f,elementHeight:h,wrapperWidth:d.outerWidth(),wrapperHeight:d.outerHeight(),offset:{top:Math.floor(b.offset().top-e(this.options.appendTo).offset().top),left:Math.floor(b.offset().left-e(this.options.appendTo).offset().left)}}},_getPositionMap:function(a,b){a.attr("style","").css({top:"-1000px",left:"-5000px",display:"block"});return this._getPositioning(a,b)},_getPositioning:function(a,
b,c){switch(c||this.options.position){case "bottom":return this._getBottomPositioning(a,b);case "left":return this._getLeftPositioning(a,b);case "right":return this._getRightPositioning(a,b);default:return this._getTopPositioning(a,b)}},_getCommonPositioningMap:function(){return{newArrowTop:0,newArrowLeft:0,newWrapperTop:0,newWrapperLeft:0,wrapperClass:""}},getLeftRightOffsetAgainstEdge:function(a,b,c){if(this.options.offsetAgainstEdge){var d=e(this.options.appendTo).offset(),f=d?d.left+e(this.options.appendTo).width():
e(this.options.appendTo).width(),h,k=null!=d&&a<d.left,g=!isNaN(f)&&a+c.wrapperWidth>f;k?h=Math.floor(d.left+this.options.edgeOffset):g&&(h=Math.floor(f-c.wrapperWidth-this.options.edgeOffset));if(k||g)b=b+a-h,a=h}return{wrapperLeft:a,arrowLeft:b}},_getTopPositioning:function(a,b){var c=this._getOffsetInformation("height",a,b),d=c.elementWidth/2,f="-top",h=c.wrapperHeight,k=c.offset.top-this.options.edgeOffset-c.arrowSize-c.wrapperHeight;if(!this.options.forceDesiredPosition&&0>=k){if(this.options.fallbackPosition&&
"top"!==this.options.fallbackPosition)return this._getPositioning(a,b,this.options.fallbackPosition);f="-bottom";k=c.offset.top+c.elementHeight+this.options.edgeOffset+c.arrowSize;h=-1*c.arrowSize}a=this.getLeftRightOffsetAgainstEdge(c.offset.left+d-c.wrapperWidth/2+this.options.offsetLeft,c.wrapperWidth/2-c.arrowSize,c);return e.extend(this._getCommonPositioningMap(),{newArrowTop:Math.round(h),newArrowLeft:Math.round(a.arrowLeft),newWrapperTop:Math.round(k),newWrapperLeft:Math.round(a.wrapperLeft),
wrapperClass:f})},_getBottomPositioning:function(a,b){var c=this._getOffsetInformation("height",a,b),d=c.elementWidth/2,f="-bottom",h=-1*c.arrowSize,k=c.offset.top+c.elementHeight+this.options.edgeOffset+c.arrowSize;if(!this.options.forceDesiredPosition&&k+c.wrapperHeight>=jq(g).scrollTop()+e(g).height()){if(this.options.fallbackPosition&&"bottom"!==this.options.fallbackPosition)return this._getPositioning(a,b,this.options.fallbackPosition);f="-top";k=c.offset.top-this.options.edgeOffset-c.arrowSize-
c.wrapperHeight;h=c.wrapperHeight}a=this.getLeftRightOffsetAgainstEdge(c.offset.left+d-c.wrapperWidth/2+this.options.offsetLeft,c.wrapperWidth/2-c.arrowSize,c);return e.extend(this._getCommonPositioningMap(),{newArrowTop:Math.round(h),newArrowLeft:Math.round(a.arrowLeft),newWrapperTop:Math.round(k),newWrapperLeft:Math.round(a.wrapperLeft),wrapperClass:f})},_getLeftPositioning:function(a,b){var c=this._getOffsetInformation("width",a,b),d=c.elementHeight/2,f=c.wrapperHeight/2,h="-left",k="rtl"===document.dir?
-c.arrowSize:c.wrapperWidth,g="rtl"===document.dir?c.offset.left+this.options.edgeOffset+c.arrowSize+c.elementWidth:c.offset.left-this.options.edgeOffset-c.arrowSize-c.wrapperWidth;if(!this.options.forceDesiredPosition&&0>=g){if(this.options.fallbackPosition&&"left"!==this.options.fallbackPosition)return this._getPositioning(a,b,this.options.fallbackPosition);h="-right";g=c.offset.left+c.elementWidth+this.options.edgeOffset+c.arrowSize;k=-1*c.arrowSize}return e.extend(this._getCommonPositioningMap(),
{newArrowTop:Math.round(f-c.arrowSize),newArrowLeft:Math.round(k),newWrapperTop:Math.round(c.offset.top+d-f),newWrapperLeft:Math.round(g),wrapperClass:h})},_getRightPositioning:function(a,b){var c=this._getOffsetInformation("border-right-width",a,b),d=c.elementHeight/2,f=c.wrapperHeight/2,h="-right",k="rtl"===document.dir?c.wrapperWidth:-1*c.arrowSize,m="rtl"===document.dir?c.offset.left-c.wrapperWidth-c.arrowSize:c.offset.left+c.elementWidth+this.options.edgeOffset+c.arrowSize;if(!this.options.forceDesiredPosition&&
m+c.wrapperWidth>=e(g).width()){if(this.options.fallbackPosition&&"right"!==this.options.fallbackPosition)return this._getPositioning(a,b,this.options.fallbackPosition);a=c.offset.left-this.options.edgeOffset-c.arrowSize-c.wrapperWidth;0<=a&&(h="-left",m=a,k=c.wrapperWidth)}return e.extend(this._getCommonPositioningMap(),{newArrowTop:Math.round(f-c.arrowSize),newArrowLeft:Math.round(k),newWrapperTop:Math.round(c.offset.top+d-f),newWrapperLeft:Math.round(m),wrapperClass:h})},_setStyleClasses:function(a,
b,c){a.attr("class","");this._addStyleClasses(a,b,c);return this},_addStyleClasses:function(a,b,c){b&&(a.addClass(this.widgetBaseClass+b),c&&a.addClass(this.widgetBaseClass+b+c),this.options.baseClass&&(a.addClass(this.options.baseClass+b),c&&a.addClass(this.options.baseClass+b+c)));return this},_updateWrapperElement:function(a,b){this._addStyleClasses(b,"-wrapper",a.wrapperClass);b.attr("style","");"number"===typeof a.newWrapperTop&&b.css("top",a.newWrapperTop+"px");"number"===typeof a.newWrapperLeft&&
b.css({left:a.newWrapperLeft+"px",right:""});return this},_updateArrowElement:function(a,b){this._addStyleClasses(b,"-arrow",a.wrapperClass);b.css({top:a.newArrowTop+"px"});b.css({left:a.newArrowLeft+"px",right:""});return this},_updateContainerElement:function(a,b){this._addStyleClasses(b,"-container",a.wrapperClass);this.options.updateContainerOnResize&&b.css({top:a.newArrowTop+5+"px",left:a.newArrowLeft-b.width()+"px"});return this},_getIdValue:function(a){return this.widgetNamespace+this.options.subNameSpace+
a},_open:function(a,b,c){var d=this;a.stop(!0,!0);var f=function(a){this.options.onOpen&&this.options.onOpen.call(this,a);this.options.positionUpdate&&(this._positionUpdater=setInterval(e.proxy(this._updatePosition,this),1E3/60))};this.options.fadeIn&&!c?a.fadeIn(this.options.fadeIn,function(){f.call(d,b)}):(a.show(),f.call(d,b));return this},_close:function(){this._originalTitle&&(this.element.attr("title",this._originalTitle),this._originalTitle=null);this.options.onClose&&this.options.onClose.call(this,
null);return this},_resetElements:function(a,b,c){this._setStyleClasses(a,"-wrapper");this._setStyleClasses(b,"-container");this._setStyleClasses(c,"-arrow");return this}})})(jq||jQuery,window);
(function(e,g){e.createWidgetClass("tip.ToolTip",g.extend({},e.Widgets.Tooltip.prototype,{contentContainer:null,boundEvents:null,orientationOffset:null,rtlOrientation:void 0,trackEventId:null,options:g.extend({},e.Widgets.Tooltip.prototype.options,{showImmediately:!1,baseClass:"coolTip",extraClass:null,delay:200,position:"top",fallbackPosition:null,forceDesiredPosition:null,orientation:"middle",orientationOffset:null,onDestroy:null,activation:"hover",subNameSpace:"",alwaysRendered:!1,color:"black",
size:"l",closeOnBodyClick:!0,destroyAfterClose:!1,content:"",isComponent:!1,target:null,positionTarget:null,updateContainerOnResize:!1,track:null,testAttributes:null,setAriaContext:!1,readContentOnOpen:!1}),init:function(){this.base();if(this.options.alwaysRendered){this.contentContainer=this.getChildElement("rendered-content");var b=this.contentContainer.children().eq(0);b.attr({"data-test-popover-content":"","data-test-popover-open":this.options.showImmediately});this.setContent(b)}e.Widgets.Tooltip.prototype.init.call(this);
this.boundEvents={};this.rtlOrientation="rtl"===document.dir&&"middle"!==this.options.orientation?"start"===this.options.orientation?"end":"start":void 0;this.orientationOffset=this._getOrientationOffset()},addEventHandlers:function(){this.subscribe("common.widgets.tooltip.clearCloseTimers",this._clearCloseTimers.bind(this));var b=this;this.subscribe("common.widgets.tooltip.closeAll",function(){b.isOpen&&b.close()});this.subscribe("common.widgets.tooltip.closeSelf",b.options.subNameSpace,function(){b.isOpen&&
b.close()})},destroy:function(){if("function"===typeof this.options.onDestroy)this.options.onDestroy();this.options.fadeOut=!1;var b=this._getContainerElement();Object.keys(this.boundEvents).forEach(function(a){b.off(a,this.boundEvents[a])}.bind(this));this.isOpen&&this.close();this._removeAllWidgetBindings();this.element.removeData(this.widgetName);this.base()},bindComponent:function(){this.element.data("toolTip",this);this.element.data("widget")||this.element.data("widget",this);this._addTestAttributes(this.element,
"trigger");e.globals.testMode&&this.element.attr({"data-test-popover-widget":"","data-test-popover-triggerevent":this.options.activation});this.options.setAriaContext&&this.element.attr("aria-describedby",this._getWrapperElement().attr("id"))},bindEventHandler:function(b,a,d){b=b.replace(/\s|$/g,"."+this.id()+" ");this._getContainerElement().on(b,a,d);this.boundEvents[b]=a},setContent:function(b){this.options.content=b},renderContent:function(b,a){"string"===typeof b?e.Widgets.Tooltip.prototype.renderContent.call(this,
b,a):"object"===typeof b?g.contains(a,b)||(a.html(""),a.append(b)):this.log.errorInternal('Bad parameter passed to renderContent(): "content" param must be a String or a jQuery object');this._addTestAttributes(a,"content")},getOptionalTarget:function(b,a){return"string"===typeof b&&b.length?"#"===b[0]?g(b):g("#"+b):null!==b&&"object"===typeof b?g(b):a},_addTestAttributes:function(b,a){var d=this,c={};e.globals.testMode&&(c["data-test-popover-"+a]="");this.options.testAttributes&&Object.keys(this.options.testAttributes).forEach(function(a){var b=
/^data-/.test(a)?a:"data-"+a;c[b]=d.options.testAttributes[a]});b.attr(c)},_getOrientationOffset:function(){return null!==this.options.orientationOffset?this.options.orientationOffset:this.options.extraClass&&-1!==this.options.extraClass.indexOf("no-arrow")?0:{start:-15,middle:0,end:15}[this.rtlOrientation||this.options.orientation]},_getPositioning:function(b,a,d,c){d=d||this.options.position;var l=e.Widgets.Tooltip.prototype._getPositioning.call(this,b,a,d),f={top:0,left:0},h=this.orientationOffset*
(c?-1:1);if("middle"!==this.options.orientation){var k=this.rtlOrientation||this.options.orientation,m,n;c&&(k="start"===k?"end":"start");"left"===d||"right"===d?(n="top",m="outerHeight"):(n="left",m="outerWidth");var p=this.getOptionalTarget(this.options.positionTarget,this.element),r=p[m](),q=this._getWrapperElement()[m]();if(!c&&!this.options.forceDesiredPosition)if(c=p.offset()[n],p="scroll"+n.charAt(0).toUpperCase()+n.slice(1),"start"===k){if(c+q>g(window)[p]()+g(window)[m]())return this._getPositioning(b,
a,d,!0)}else if("end"===k&&c+r-q<g(window)[p]())return this._getPositioning(b,a,d,!0);b=r/2;q/=2;"start"===k?f[n]=Math.ceil(q-b+h):"end"===k&&(f[n]=Math.ceil(b-q+h))}l.newArrowTop-="rtl"===document.dir?-f.top:f.top;l.newArrowLeft-=f.left;l.newWrapperTop+="rtl"===document.dir?-f.top:f.top;l.newWrapperLeft+=f.left;return l},clearTrackEvent:function(){this.trackEventId&&(clearTimeout(this.trackEventId),this.trackEventId=null)},startTrackEvent:function(b){this.clearTrackEvent();if(b&&b.wait&&b.label){var a=
parseInt(b.wait);isNaN(a)||1>a||(this.trackEventId=setTimeout(this.triggerTrackEvent.bind(this,b),a))}},triggerTrackEvent:function(b){if(this.element&&this.element.hasClass("tooltip-open")&&b&&b.label){var a={category:b.category||"ToolTip",action:b.action||"open",label:b.label};b.hasOwnProperty("value")&&(a.value=b.value);e.Analytics.api.trackEvent(a)}},_open:function(b,a,d){var c=this,l="click."+this.id(),f=this._getContainerElement();e.Widgets.Tooltip.prototype._open.call(this,b,a,d);e.events.publish("common.widgets.tooltip.clearCloseTimers",
this.options.subNameSpace);this.element.addClass("tooltip-open");f.attr("aria-expanded",!0);e.globals.testMode&&this.element.add(f).attr("data-test-popover-open",!0);e.events.publish("common.widgets.tooltip.opened");var h=function(a){b[0].contains(a.target)||"click"===c.options.activation&&c.element[0].contains(a.target)||(g(document).off(l),c.close())};this.options.closeOnBodyClick&&setTimeout(function(){g(document).off(l).on(l,h)},1);this.options.track&&this.startTrackEvent(g.extend({wait:2E3},
this.options.track))},_close:function(b){var a=this.getContent(),d=this._getContainerElement();this.options.alwaysRendered&&"object"===typeof a&&this.contentContainer.append(a);e.Widgets.Tooltip.prototype._close.call(this,b);this.element.removeClass("tooltip-open");d.attr("aria-expanded",!1);e.globals.testMode&&this.element.add(d).attr("data-test-popover-open",!1);this.options.closeOnBodyClick&&e.dom.schedule(function(){g(document).off("click."+this.id())}.bind(this));this.options.track&&this.clearTrackEvent();
this.options.destroyAfterClose&&this.destroy()},closeAfter:function(b){this._forceCloseTimer&&clearTimeout(this._forceCloseTimer);this._forceCloseTimer=window.setTimeout(this.close.bind(this),b)},_clearCloseTimers:function(b){b===this.options.subNameSpace&&clearTimeout(this._closeTimer)},_addStyleClasses:function(b,a,d){a&&(b.addClass(this.widgetBaseClass+a),d&&b.addClass(this.widgetBaseClass+a+d),this.options.baseClass&&(b.addClass(this.options.baseClass+a),d&&b.addClass(this.options.baseClass+a+
d)),this.options.color&&b.addClass("Color-"+this.options.color));this.options.extraClass&&b.addClass(this.options.extraClass);this.options.size&&b.addClass("size-"+this.options.size);e.Common.Utils.Browsers.isIE()?b.addClass("ie"):e.Common.Utils.Browsers.isChrome()&&(b.addClass("chrome"),a=e.Common.Utils.Browsers.getChromeVersion(),65!==a&&66!==a||b.addClass("chrome65"));return this},_getOffsetInformation:function(b,a,d){var c=this.getOptionalTarget(this.options.positionTarget,this.element),e=c.outerWidth(),
f=c.outerHeight(),c={top:Math.floor(c.offset().top-g(this.options.appendTo).offset().top),left:Math.floor(c.offset().left-g(this.options.appendTo).offset().left)};b="width"===b?d.outerWidth():d.outerHeight();return{arrowSize:Math.round(b/2),elementWidth:e,elementHeight:f,wrapperWidth:a.outerWidth(),wrapperHeight:a.outerHeight(),offset:c}},_removeAllWidgetBindings:function(){e.Widgets.Tooltip.prototype._removeAllWidgetBindings.call(this);this.options.setAriaContext&&this.element.removeAttr("aria-describedby")}}))})(R9,
jQuery);(function(g,f){var m=JSON.parse('{"legs":[{"cutoffPercentage":0.7,"leftRange":110,"useCustomDistribution":true,"ranges":[{"min":110,"max":144,"minPrice":128.09,"count":4},{"min":144,"max":178,"minPrice":161.8,"count":15},{"min":178,"max":212,"minPrice":200.59,"count":7},{"min":212,"max":246,"minPrice":232.36,"count":16},{"min":246,"max":280,"minPrice":261.16,"count":17},{"min":280,"max":314,"minPrice":301.32,"count":11},{"min":314,"max":348,"minPrice":322.96,"count":26},{"min":348,"max":382,"minPrice":358.16,"count":36},{"min":382,"max":416,"minPrice":414.54,"count":19},{"min":416,"max":450,"minPrice":432.79,"count":18},{"min":450,"max":484,"minPrice":464.27,"count":7},{"min":484,"max":518,"minPrice":555.09,"count":7},{"min":518,"max":552,"minPrice":594.41,"count":6},{"min":552,"max":556,"minPrice":-1,"count":0},{"min":556,"max":567,"minPrice":661.45,"count":1},{"min":567,"max":612,"minPrice":665.27,"count":5},{"min":612,"max":788,"minPrice":700.47,"count":11},{"min":788,"max":1479,"minPrice":857.45,"count":7}],"isUserManipulated":false,"maxRange":1479,"rightRange":1479,"maxCount":36,"enabled":true,"isDirty":false,"isFiltering":false,"maxIndex":0,"minIndex":0,"maxPrice":857.45,"cutoff":552,"updateTitle":false,"minRange":110,"exponent":1.366390713113171}],"isUserManipulated":false,"maxPrice":[857.45],"filteredResults":213}');
g.createComponentClass("common.results.filters.SimpleRangeGraphFilter","common.results.filters.Filter",{Graph:null,legs:void 0,legCount:1,filteredResults:null,options:{showOutliers:!1,outlierDeviation:18,displayFormat:"%s",thousandsDelimiter:",",decimalDelimiter:".",showGraphOverlay:!1,activeLeg:-1,yAxisDisplay:"count",min:void 0,max:void 0,step:1,useTextInput:!1,triggerFilteredLabel:!1,showYLines:!1,graphHeight:72,xAxisSteps:0,yAxisTicks:0,hasCursor:!1,minimumResults:0,forceHideGraph:!1,forceDisableOnSingleResult:!0,
disableOnSingle:!0,usePlaceholderData:!1,showCurrencyCodes:!1,isRtl:!1},textInput:null,init:function(){this.base();this.Graph=this.makeGraphClass();this.legs=[];this.minRange=this.options.min;this.maxRange=this.options.max;this.textInput=this.getChildElement("textInputForm");this.eventPrefix="filters.%s.".format(this.options.name)},inlineComponentsReady:function(){this.base();var a=this;this.element.find(".graphFilterSection").each(function(b){a.legs[b]={slider:g.question.ask("RangeFilterSlider.init."+
a.id("slider-"+b),{min:a.options.min,max:a.options.max,step:a.options.step,useTextInput:a.options.useTextInput,displayFormat:a.options.displayFormat,formatValues:a.formatValues.bind(a),triggerFilteredLabel:a.options.triggerFilteredLabel,onStart:function(c,d){return a.sliderDidStart(b,d)},onSlide:function(c,d){return a.sliderDidSlide(b,d)},onStop:function(c,d,e){a.publishHoverState(!1,{leg:b});d={};var h=a.legs[b].slider;h&&(d.field=(f(c.target).hasClass("left")?"left":"right")+b,d.value=h[-1<d.field.indexOf("left")?
"leftRange":"rightRange"]);return a.sliderDidStop(b,e,{changeData:d})},onValidate:function(b){return a.validateValues(b)}}),label:a.getChildElement("label-"+b),ranges:void 0,maxYVal:void 0,element:f(this)}});this.options.usePlaceholderData&&(this.update(m),this.showGraph(0))},addEventHandlers:function(){this.base();this.subscribe(this.eventPrefix+"resetitem",this.reset.bind(this))},formatValues:function(a){var b=this;return a.map(function(a){return"undefined"===typeof a?a:g.Common.Utils.formatOptionalPrice(Math.round(a),
!0,b.options.showCurrencyCodes)})},update:function(a){var b=this;a&&(a.hasOwnProperty("filteredResults")&&(this.filteredResults=a.filteredResults),a.legs?a.legs.forEach(b.updateLeg.bind(b)):this.updateLeg(a,0),a.sectionLabels?a.sectionLabels.forEach(function(a,d){b.legs[d].label.html(a)}):1===b.legs.length&&(b.legs[0].label.html(this.options.title),b.legs[0].label.addClass("only-label")),this.disabledPriceGraphFilter(a))},updateLeg:function(a,b){this.updateLegSlider(a,b);this.legs[b].ranges=a;this.legs[b].graph=
void 0;var c=this.lookupGraphYKeys(this.options.yAxisDisplay);(c=a[c.max])&&c.length?this.legs[b].maxYVal=c[b]:f.isArray(c)||(this.legs[b].maxYVal=c);this.showGraph(b);this.updateGraph(b,[parseInt(a.leftRange),parseInt(a.rightRange)])},validateValues:function(a){var b=a[0]!==a[0]||a[1]!==a[1];return a&&a[0]&&a[1]&&!b?this.minRange<=a[0]&&a[0]<=a[1]&&a[1]<=this.maxRange:!1},willReset:function(){this.legs.forEach(function(a){a.slider.reset()})},lookupGraphYKeys:function(a){var b={count:{value:"count",
max:"maxCount"},price:{value:"minPrice",max:"maxPrice"}};return"string"===typeof a&&b[a]?b[a]:b.count},updateLegSlider:function(a,b){var c=this.legs[b].slider,d=parseInt(a.minRange),e=parseInt(a.maxRange),h=parseInt(a.leftRange),f=parseInt(a.rightRange),n=void 0===c.leftRange||void 0===c.minRange||c.leftRange===c.minRange,p=void 0===c.rightRange||void 0===c.maxRange||c.rightRange===c.maxRange;if(!isNaN(d)&&!isNaN(e)){c.setMinRange(d);c.setMaxRange(e);this.minRange=d;this.maxRange=e;isNaN(h)?n&&c.setLeftRange(c.minRange,
!0):c.setLeftRange(h,!0);isNaN(f)?p&&c.setRightRange(c.maxRange,!0):c.setRightRange(f,!0);c.updateDisplay(!0,a);var l=this;g.dom.schedule(function(){l.getChildElement("section-"+b).removeClass("hidden");l.getChildElement("legToggle").find("[name\x3d%s]".format(b+1)).addClass("active");l.element.removeClass("hidden")})}},getValuesFromRanges:function(a){var b=[];a.forEach(function(a,d,e){b[d]=a.min;e.length===d+1&&(b[d+1]=a.max)});return b},sliderDidStop:function(a,b,c){b&&(c&&(c.activeLegIndex=a),
this.pushStateChange(null,c),this.updateFilterHistory(),this.setLastUserInteraction(!0));this.logUserInteraction()},sliderDidSlide:function(a,b){void 0!==this.legs[a].graph&&this.updateGraph(a,b)},sliderDidStart:function(a){this.isGraphable(a)&&this.updateGraph(a,this.legs[a].slider.widget.options.values)},getLegResultCount:function(a){var b=0;a.forEach(function(a){b+=a.count});return 1E4<b?null:b},calculateRangeMean:function(a,b){var c=0;a.forEach(function(a){c+=a.max*a.count});return c/b},calculateRangeStdDev:function(a,
b,c){var d=0,e=0;a.forEach(function(a){e=a.max*a.count;d+=(e-c)*(e-c)/b});return Math.sqrt(d/b)},showGraph:function(a){var b=this.legs[a].ranges;void 0===this.legs[a].graph&&(this.legs[a].graph=this.getChildElement("graph-"+a).html(this.generateGraph(a,b)));this.getChildElement("section-"+a).addClass("showGraph");this.legs[a].graph.find(".filterGraph").addClass("open");this.filteredResults>=this.options.minimumResults&&!this.options.forceHideGraph?this.legs[a].graph.removeClass("force-hidden"):this.legs[a].graph.addClass("force-hidden")},
getState:function(){return{legs:this.legs.slice(0,this.legCount).map(function(a){if(!a.slider||"number"!==typeof a.slider.leftRange||"number"!==typeof a.slider.rightRange)return{};var b={};b.min=a.slider.leftRange.toString();b.max=a.slider.rightRange.toString();return b})}},updateGraph:function(a,b){this.legs[a].graph.find(".bars .bar").each(function(){var a=parseInt(f(this).data("boundary"));b[0]>a||b[1]<a?f(this).addClass("inactive"):f(this).removeClass("inactive")})},isGraphable:function(a){if(!this.legs[a]||
!this.legs[a].ranges||!this.legs[a].ranges.ranges)return!1;a=this.legs[a].ranges.ranges;var b=2>a.length,c=!1,d=!1;if(!this.options.showOutliers){var e=this.getLegResultCount(a);e?c=this.getHasOutliers(a,e):d=!0}return!b&&!c&&!d},getHasOutliers:function(a,b){var c=this.calculateRangeMean(a,b);a=this.calculateRangeStdDev(a,b,c);return(this.maxRange-c)/a>this.options.outlierDeviation},generateGraph:function(a,b){return(new this.Graph({minRange:b.minRange,maxRange:b.maxRange,yKey:this.lookupGraphYKeys(this.options.yAxisDisplay).value,
yMax:this.legs[a].maxYVal,ranges:b.ranges,showYLines:this.options.showYLines,height:this.options.graphHeight,xAxisSteps:this.options.xAxisSteps,yAxisTicks:this.options.yAxisTicks,hasCursor:this.options.hasCursor,yMaxPixels:this.options.graphHeight-2,isRtl:this.options.isRtl})).render()},makeGraphClass:function(){var a=function(a){this.options=f.extend(this.options,a);this.init()};a.prototype=f.extend(a.prototype,{xUnitScale:1,yUnitScale:1,xLabelPixels:void 0,yLabelPixels:void 0,xPixelPadding:5,xMaxPixels:g.config.getInt("ui.range.filter.graph.xAxisMax",
179),options:{},init:function(){this.findAxisTextWidths();0<this.xAxisSteps&&this.adjustXAxisSteps();0<this.options.yAxisTicks&&this.adjustYAxisTicks()},formatX:function(a){return g.Common.Utils.formatPrice(Math.round(a),!0)},formatY:function(a){return a},rawX:function(a){return a},rawY:function(a){return a},pixelScaleY:function(a){return 0>a?1:this.options.yMaxPixels/this.options.yMax*a},findAxisTextWidths:function(){if(!(this.xLabelPixels&&this.yLabelPixels||null==this.options.ranges)){var a=this.formatX(this.options.ranges[this.options.ranges.length-
1]&&this.options.ranges[this.options.ranges.length-1].max),c=this.formatY(this.options.yMax),a=f("\x3cspan\x3e").html(a).addClass("xLabel").css("font-size","9px"),c=f("\x3cspan\x3e").html(c).addClass("yLabel").css("font-size","10px");"rtl"===document.dir&&c.css("display","inline-block");var d=f("\x3cdiv\x3e").css("position","absolute").css("left","-9999px").css("top","-9999px").css("opacity","0");d.append(a).append(c);f("body").append(d);this.xLabelPixels=a.outerWidth()+5;this.yLabelPixels=c.outerWidth()+
5;d.remove()}},adjustXAxisSteps:function(){for(;0<this.options.xAxisSteps&&!(this.xMaxPixels/(this.options.xAxisSteps+1)>this.xLabelPixels);this.options.xAxisSteps--);2>=this.options.xAxisSteps&&(this.options.xAxisSteps=2)},adjustYAxisTicks:function(){var a=this.options.yMax,c=Number(this.options.yAxisTicks);if(0!==a%c)for(this.options.yAxisTicks=8>a?a:8;1<this.options.yAxisTicks&&0!==this.options.yMax%this.options.yAxisTicks;this.options.yAxisTicks--)1===this.options.yAxisTicks&&(this.options.yAxisTicks=
8<this.options.yAxisTicks?c:this.options.yMax)},renderYAxis:function(){if(1>this.options.yAxisTicks)return"";var a=this.options.height/this.options.yAxisTicks,c=f("\x3cdiv\x3e");if(0<this.options.yAxisTicks){for(var d=f("\x3cdiv class\x3d'y-axis'\x3e\x3c/div\x3e"),e,h=0;h<this.options.yAxisTicks;h++)e=this.renderYAxisLabel(h).css("height",a+"px").css("width",this.yLabelPixels+"px"),d.append(e);d.css("width",this.yLabelPixels);c.append(d)}if(this.options.showYLines)for(h=0;h<this.options.yAxisTicks;h++)d=
f("\x3cdiv\x3e\x3c/div\x3e").addClass(h+1===this.options.yAxisTicks?"line last":"line").css("top",h*a+"px").css("height",a-1+"px").css("rtl"===document.dir?"right":"left",this.yLabelPixels+this.xPixelPadding+"px"),c.append(d);return c.html()},renderYAxisLabel:function(a){return f("\x3cdiv class\x3d'label'\x3e"+this.formatY(this.options.yMax-this.options.yMax*a/this.options.yAxisTicks)+"\x3c/div\x3e")},renderXAxis:function(){if(0<this.options.xAxisSteps){for(var a=this.rawX(this.options.minRange),
c=this.rawX(this.options.maxRange),d=Math.max(Math.ceil((c-a)/this.options.xAxisSteps),this.xUnitScale),a=Math.min((c-a)/d+1,8),c="",e=0;e<a;e++)c+=this.renderXAxisLabel(e,d);return"\x3cdiv class\x3d'x-axis' style\x3d'"+("rtl"===document.dir?"right":"left")+": "+(this.yLabelPixels+2)+"px'\x3e"+c+"\x3c/div\x3e"}return""},renderXAxisLabel:function(a,c){a=this.rawX(this.options.minRange)+a*c;return"\x3cspan class\x3d'x-label'\x3e"+this.formatX(a)+"\x3c/span\x3e"},renderGraphBars:function(){for(var a=
"",c=40<this.yLabelPixels,d=c?this.yLabelPixels:(this.yLabelPixels+this.xPixelPadding)/2,e=0,f=this.options.ranges.length;e<f;e++)var g=this.options.ranges[e],a=a+("\x3cspan class\x3d'bar' data-boundary\x3d'"+g.min+"' style\x3d'height: "+this.pixelScaleY(g[this.options.yKey])+"px'\x3e\x3c/span\x3e");e=(c?"left:":"right:")+d+"px";"rtl"===document.dir&&(e=(c?"right:":"left:")+d+"px");return this.options.hasCursor?"\x3cdiv class\x3d'bars' style\x3d'"+e+"'\x3e"+a+"\x3cspan class\x3d'cursor'\x3e\x3c/span\x3e\x3c/div\x3e":
"\x3cdiv class\x3d'bars' style\x3d'"+e+";'\x3e"+a+"\x3c/div\x3e"},render:function(){return f("\x3cdiv class\x3d'filterGraph'/\x3e").html(this.renderYAxis()+this.renderGraphBars()+this.renderXAxis())}});return a},getHistoryFilterViewState:function(a){var b=this,c=this.legCount,d=null,e=null,g=[],k=function(a,b){b()?null===d&&(d=!0):a()&&(null===e&&(e=!0),d=!1)};a.legs.forEach(function(a,d){if(!(d>=c)){var f=b.legs[d].ranges?{min:b.legs[d].ranges.minRange,max:b.legs[d].ranges.maxRange}:{},h=b.legs[d].ranges?
{min:b.legs[d].ranges.leftRange,max:b.legs[d].ranges.rightRange}:{};a.min&&a.max?k(function(){return a.min>f.min&&a.max<f.max},function(){return a.min==h.min&&a.max==h.max}):a.min?k(function(){return a.min<f.max},function(){return a.min==h.min}):a.max?k(function(){return a.max>f.min},function(){return a.max==h.max}):e=!1;g.push(a)}});return f.extend(this.base(),{state:{legs:g},isAlreadyApplied:d,disabled:!e})},getStateForFilterHistory:function(){var a=this,b={legs:this.legs.slice(0,this.legCount).map(function(a){if(!a.slider||
"number"!==typeof a.slider.leftRange||"number"!==typeof a.slider.rightRange)return{};var b={};a.slider.isLeftRangeManipulated()&&(b.min=a.slider.leftRange.toString());a.slider.isRightRangeManipulated()&&(b.max=a.slider.rightRange.toString());return b})};return{displayName:this.options.title,state:b,type:g.question.ask("filters.FilterHistory.type.slider"),subtype:this.getFilterHistoryDisplayViewSubtype(),displayValue:b.legs.map(function(b,d){return{displayName:a.getLegDisplayName(d),min:b.min&&a.formatValues([parseInt(b.min)]),
max:b.max&&a.formatValues([parseInt(b.max)])}})}},getLegDisplayName:function(){return null},getFilterHistoryDisplayViewSubtype:function(){return g.question.ask("filters.FilterHistory.type.numeric")},setDisabled:function(a){a=a||this.options.forceDisableOnSingleResult&&this.options.disableOnSingle&&1>=this.filteredResults;this.base(a);this.legs&&this.legs.forEach(function(b){b.slider.element.find(".r9RangeSlider").toggleClass("Disabled",a)})},disabledPriceGraphFilter:function(a){this.setDisabled(0===
a.legs.length);this.element.hasClass("Disabled")?g.events.publish("results.filter.disablePriceGraph"):g.events.publish("results.filter.enablePriceGraph")},setStateFromPrevious:function(a){var b=parseInt(a.key[a.key.length-1]);if(this.legs&&b<this.legs.length){var b=this.legs[b].slider,c=a.key.startsWith("left");a=a.reset?c?b.minRange:b.maxRange:parseInt(a.value);var d=b.widget.getValues();c?(b.setLeftRange(a),d[0]=a):(b.setRightRange(a),d[1]=a);b.widget.setValues(d)}},updatePreviousFilters:function(a){a?
a.legs.forEach(function(a,c){var b="left"+c;c="right"+c;a.hasOwnProperty("min")&&this.previousFilters.hasOwnProperty(b)&&this.previousFilters[b]!==a.min&&this.removePreviousFilter(b);a.hasOwnProperty("max")&&this.previousFilters.hasOwnProperty(c)&&this.previousFilters[c]!==a.max&&this.removePreviousFilter(c)},this):this.removePreviousFilter()},trackStateChange:function(a){this.trackStateChangeEnabled(a)&&(g.VestigoType.FilterType.price===this.name?(a=0<this.legs.length?this.legs[0].slider:null)&&
g.VestigoEvents.filters.shared.priceRange(a.leftRange,a.rightRange,g.VestigoType.PriceType[g.question.ask("results.priceType")]):this.base(a))}})})(R9,jQuery);(function(h,k){h.createWidgetClass("smarty.LandmarksSmarty","common.widgets.smarty.FlareSmarty",{geocoder:null,constructor:function(a,b){this.base(a,k.extend({dataSource:"/f/smarty",appendTo:"body",flareSmartyType:25,dropdownClass:" smartbox smartbox-landmarks smartbox-longnames",minWidth:250,featureClass:"",forceSelection:!0,searchOnFocus:!0,searchNoQuery:!0,showDropdownWhenEmpty:!1,f:"j",v:"v1"},b))},translateItem:function(a){if(!a)return null;a=k(a);return{type:a.attr("data-type"),id:a.attr("id"),
str:a.text(),short_str:a.attr("data-short-name"),lat:a.attr("data-lat"),lon:a.attr("data-lon")}},onBeforeStart:function(){"function"===typeof this.options.beforeStart&&this.options.beforeStart(this)},noItemToSelect:function(){if("function"===typeof this.options.onNoItemToSelect)this.options.onNoItemToSelect(this)},runSearch:function(a){if(!(this.element.val().length<this.options.minLength)){var b=null==this.lastValue,c=this.element.val();this.lastValue=c;var d=this.getRequestData();d.value||(d.value=
"");var e=this.preprocessRequest(d),f=this,g={};!b&&0<c.length&&h.Maps&&h.Maps.Google&&h.Maps.Google.load&&(h.Maps.Google.load(null,"landmarks-smarty"),g.useGoogle=h.Maps.Google.isLoaded());var l=function(){if(!g.smarty&&!g.google)f.searchCompleted(f.makeEmptyContent(),a);else if(g.smarty||g.google){var b=f.postprocessResponse(g);b&&f.searchCompleted(b,a)}};this.smartyRequest=k.post(this.options.dataSource,e,function(a){g.smarty=a;l()},this.options.dataType);g.useGoogle&&(this.geocoder||(this.geocoder=
new google.maps.Geocoder),b=this.preprocessGoogleRequest(d),this.geocoder.geocode(b,function(a,b){"OK"===b&&(g.google=a,l())}))}},isUpdateInProgress:function(){return this.keyTimeout||this.smartyRequest},abortRequest:function(){if(this.smartyRequest){try{this.smartyRequest.abort()}catch(a){}this.smartyRequest=null}},postprocessResponse:function(a){var b,c,d;a.smarty&&(c=JSON.parse(a.smarty),d=c.landmarks);if(null!=d)b=this.makePopularContent(d,this.options.recentLandmarks);else if(c||a.google)b=this.makeRegularContent(c,
a.google);b||(b=this.makeEmptyContent());return b},makeEmptyContent:function(){return this.options.emptyItemContent},makePopularContent:function(a,b){var c=[];if(a&&0<a.length){c.push("\x3cdiv\x3e\x3cdiv class\x3d'smartyheader'\x3e");c.push(this.options.popularLandmarksHeader);c.push("\x3c/div\x3e\x3c/div\x3e");c.push("\x3cul\x3e");for(var d=0;d<a.length;d++){var e=this.makeSmartyResult(a[d]);e&&c.push(e)}c.push("\x3c/ul\x3e")}if(b&&0<b.length){c.push("\x3cdiv\x3e\x3cdiv class\x3d'smartyheader'\x3e");
c.push(this.options.recentLocationsHeader);c.push("\x3c/div\x3e\x3c/div\x3e");c.push("\x3cul\x3e");for(d=0;d<b.length;d++)a=b[d],(e=this.makeResult(a.type.uiCode,a.id,a.landmarkName,a.latitude,a.longitude))&&c.push(e);c.push("\x3c/ul\x3e")}return c.join("")},makeRegularContent:function(a,b){var c=[],d=0,e=10;if(a)for(var f=0;f<e&&f<a.length;f++,d++){var g=this.makeSmartyResult(a[f]);g&&c.push(g)}if(b)for(e-=d,f=0;f<e&&f<b.length;f++,d++)(a=this.makeGoogleResult(b[f]))&&c.push(a);return 0<c.length?
"\x3cul\x3e"+c.join("")+"\x3c/ul\x3e":null},makeSmartyResult:function(a){var b=a.loctype,c=a.id,d=a.lat,e=a.lng;a=a.displayname;a=this.highliteText(a,this.lastValue);return this.makeResult(b,c,a,d,e)},makeGoogleResult:function(a){if(this.googleHasType(a.types,["premise","street_address","neighborhood","sublocality_level_4","sublocality_level_5"])){var b=a.geometry.location.lat(),c=a.geometry.location.lng();if(this.isInBounds(b,c))return a=a.formatted_address,a=this.highliteText(a,this.lastValue),
this.makeResult("adr",null,a,b,c)}return null},makeResult:function(a,b,c,d,e){return"\x3cli data-type\x3d'"+a+"' class\x3d'"+a+"' "+(b?"id\x3d'"+b+"' ":"")+(d?" data-lat\x3d'"+d+"' ":"")+(e?" data-lon\x3d'"+e+"' ":"")+"\x3e"+c+"\x3c/li\x3e"},isInBounds:function(a,b){return this.options.swBounds&&this.options.neBounds&&(a<this.options.swBounds.lat||a>this.options.neBounds.lat||b<this.options.swBounds.lon||b>this.options.neBounds.lon)?!1:!0},googleHasType:function(a,b){for(var c=0;c<a.length;c++)for(var d=
0;d<b.length;d++)if(a[c]===b[d])return!0;return!1},preprocessGoogleRequest:function(a){var b={};b.language=h.globals.locale.lc;b.address=a.value;this.options.swBounds&&this.options.neBounds&&(b.bounds=new google.maps.LatLngBounds(new google.maps.LatLng(this.options.swBounds.lat,this.options.swBounds.lon),new google.maps.LatLng(this.options.neBounds.lat,this.options.neBounds.lon)));return b},showDropdown:function(a,b){h.events.publish("common.results.filterDrawer.preventScroll",!0);this.base(a,b)},
hideDropdown:function(a){h.events.publish("common.results.filterDrawer.preventScroll",!1);this.base(a);this.dropdown.hide();return!0}})})(window.R9,window.jq||window.jQuery);(function(c,d){c.createComponentClass("common.results.filters.DistanceFilter","common.results.filters.Filter",{landmarkInput:d(),cityOnlyCheckbox:d(),distanceDropdownWidget:void 0,distanceEl:null,landmark:null,setLandmarkFromPrevious:!1,cityIds:[],searchLandmark:null,tooltip:null,openMapLink:null,options:{toolTipMessage:null,isMultiValueSet:null,isDisabled:!1,featureClass:"",disabledText:"",forceDistanceSort:!0,forcedSortMode:"distance",smartyUrl:"/f/smarty",showOpenMapLink:!1},init:function(){var a=
this;this.base();this.landmarkInput=this.getChildElement("landmark");a.isMobileView()||this.options.useMcFlyStyling||(this.tooltip=this.landmarkInput.toolTip({content:this.options.toolTipMessage,position:"right",activation:"click",fadeIn:500,fadeOut:500,showImmediately:!1,positionUpdate:!0}));this.distanceEl=this.getChildElement("distance");this.distanceDropdownWidget=this.distanceEl[this.options.useSelectWidget?"r9Select":"dropdown"]({change:function(b,c,g,e){a.logUserInteraction("distanceFrom",
d(b.currentTarget).val());a.pushStateChangeWithDistanceSorting({field:"distance",location:a.landmarkInput.val()})},onOpen:function(){c.events.publish("common.results.filterDrawer.preventScroll",!0)},onClose:function(){c.events.publish("common.results.filterDrawer.preventScroll",!1)}}).getWidget();this.cityOnlyCheckbox=this.getChildElement("cityOnly");this.eventPrefix="filters.%s.".format(this.options.name);this.options.showOpenMapLink&&(this.openMapLink=this.getChildElement("open-map-link"))},logUserInteraction:function(a,
b){if("ga"===this.options.loggingType){switch(a){case "reset":a="showall";break;case "distanceFrom":a="select-distance";break;case "smarty":a="select-location";break;case "cityOnly":a="select-cityonly";break;case "openMap":a="select-open-map"}this.base({category:this.trackCategory,action:this.name,label:a,value:b})}else this.base(a)},addEventHandlers:function(){this.base();var a=this;this.landmarkInput.landmarksSmarty({dataSource:a.options.smartyUrl,positionOnScroll:!0,forceSelectionOfHighlightedItem:!1,
trackingType:"none",setItem:function(b,c){a.landmarkInput.val()!==c.str&&(a.landmarkInput.val(c.str),a.landmark={lat:c.lat,lon:c.lon,display:c.str,id:c.id,type:c.type},a.element.removeClass("empty"),a.logUserInteraction("smarty",a.landmarkInput.val()),a.pushStateChangeWithDistanceSorting({field:"smarty",location:a.landmarkInput.val()}))},extendRequest:function(){return{c:a.cityIds.join(",")}},appendTo:a.isMobileView()?a.landmarkInput.parent():"body",minWidth:a.isMobileView()?"auto":"250",display:a.isMobileView()?
"block":"inline",dropdownClass:" smartbox smartbox-landmarks smartbox-longnames "+a.options.featureClass+(a.options.useMcFlyStyling?" mcfly-styling":"")});a.isMobileView()&&(this.landmarkInput[0].setSelectionRange(0,9999),this.landmarkInput.on("focus",function(){d(this).select()}));this.subscribe("search.startSearch",function(){a.landmark=null});this.cityOnlyCheckbox.click(function(b){d(b.target).attr("aria-checked",d(b.target).prop("checked"));a.logUserInteraction("cityOnly");a.pushStateChange(null,
{changeData:{field:"cityOnly",value:"1"}})});this.subscribe("common.distanceFilter.renew.disable.options",function(b){a.options.isDisabled=b});this.subscribe(this.eventPrefix+"resetitem",this.setChecked.bind(this));this.options.showOpenMapLink&&this.registerEvent("click",this.openMapLink,function(){c.events.publish("results.mapToggle.toggle");c.events.publish("results.showMapEvent")})},cleanupExistingState:function(){this.willReset()},willReset:function(){this.cityOnlyCheckbox.prop("checked",!1);
this.distanceDropdownWidget.setValue("-1.00");this.landmarkInput.val("");this.landmark=null;this.landmarkInput.getWidget().options.swBounds=null;this.landmarkInput.getWidget().options.neBounds=null;this.resetForcedSortMode()},pushStateChangeWithDistanceSorting:function(a){this.options.forceDistanceSort&&-1===c.question.ask("resultsHeader.sortMode").sortType.indexOf(this.options.forcedSortMode)&&this.pushForcedSortMode(this.options.forcedSortMode,!0);this.pushStateChange(null,{changeData:a})},pushForcedSortMode:function(a,
b){c.events.publish("resultsHeader.sortType.force",{sortCode:a+"_"+(b?"a":"b")})},resetForcedSortMode:function(){c.events.publish("resultsHeader.sortType.resetForced")},update:function(a){this.adjustFilter();if(!this.options.isDisabled){var b=a.landmarkDisplayName;!b||this.landmark&&!this.setLandmarkFromPrevious&&b===this.landmark.display||(this.landmark={lat:a.lat,lon:a.lon,display:a.landmarkDisplayName,type:a.lmType,id:a.lmId},this.updateDisplay(a),this.updateSmartyBounds(a),this.setLandmarkFromPrevious=
!1);this.cityIds=a.cityIds;this.element.removeClass("empty");this.cityOnlyCheckbox.prop("checked",a.hasOwnProperty("cityOnly")&&a.cityOnly);if(a.hasOwnProperty("distance")){a=parseFloat(0===a.distance%1?"%s.0".format(a.distance):a.distance);for(var b=this.options.useSelectWidget?this.distanceDropdownWidget.dropdownOptions:this.distanceDropdownWidget.select.children(),c=null,d=0;d<b.length;d++){var e=this.options.useSelectWidget?b[d].getAttribute("data-value"):b[d].value,f=parseFloat(e);if(f===a||
a<f){c=e;break}}this.distanceDropdownWidget.setValue(c)}else this.distanceDropdownWidget.setValue("-1.00")}},updateSmartyBounds:function(a){var b=this.landmarkInput.getWidget();b.options.swBounds={lat:a.swBoundLat,lon:a.swBoundLon};b.options.neBounds={lat:a.neBoundLat,lon:a.neBoundLon}},updateDisplay:function(a){this.landmarkInput.val(a.landmarkDisplayName);var b=this.cityOnlyCheckbox.parent();a.isRegionSearch?b.addClass("hidden"):(b.hasClass("hidden")&&b.removeClass("hidden"),this.cityOnlyCheckbox.parent().find("label span").text(a.searchCityName))},
getState:function(){return null!==this.landmark?{lmLat:"%s".format(this.landmark.lat),lmLong:"%s".format(this.landmark.lon),distance:"%s".format(this.distanceDropdownWidget.getValue()),lmId:this.landmark.id,lmType:this.landmark.type,lmDisplay:this.landmark.display,cityOnly:this.cityOnlyCheckbox.is(":checked")}:{cityOnly:this.cityOnlyCheckbox.is(":checked")}},adjustFilter:function(){this.landmarkInput.attr("placeholder",this.options.disabledText);this.landmarkInput.attr("disabled",this.options.isDisabled);
this.distanceEl.find("select").attr("disabled",this.options.isDisabled)},setChecked:function(a){a&&("distance"===a&&(this.distanceDropdownWidget.setValue("-1.00"),this.landmarkInput.val(""),this.landmark=null,this.landmarkInput.getWidget().options.swBounds=null,this.landmarkInput.getWidget().options.neBounds=null,this.pushStateChange()),"cityOnly"===a&&this.cityOnlyCheckbox.trigger("click"))},setStateFromPrevious:function(a){this.setLandmarkFromPrevious=!0;a.reset?(this.resetForcedSortMode(),this.landmark=
null,this.distanceDropdownWidget.setValue("-1.00"),this.landmarkInput.val(""),this.landmarkInput.getWidget().options.swBounds=null,this.landmarkInput.getWidget().options.neBounds=null):(this.pushForcedSortMode(this.options.forcedSortMode,!0),this.landmark={id:a.value,type:a.key})},trackStateChange:function(a){if(this.trackStateChangeEnabled(a)){var b=a.changeData.field;"distance"===b?c.VestigoEvents.filters.hotels.location.distance(this.distanceDropdownWidget.getValue(),a.changeData.location):"cityOnly"===
b&&c.VestigoEvents.filters.hotels.location.cityonly(a.state&&a.state.cityOnly?c.VestigoType.FilterValueAction.select:c.VestigoType.FilterValueAction.unselect)}}})})(R9,jQuery);(function(e,f){e.createComponentClass("hotels.results.filters.HotelNameFilter","common.results.filters.Filter",{selectedHotelsContainer:null,selectedHotels:{},searchCityIds:[],searchId:null,smarty:null,hotelFilterInput:null,popularDialogHtml:null,templates:{popularSectionTemplate:"popularSection",popularItemTemplate:"popularItem",popularHotelsLabel:"popularHotelsLabel"},options:{featureClass:"",isPopularEnabled:!1},init:function(){this.base();this.selectedHotelsContainer=this.getChildElement("hotels");
this.hotelFilterInput=this.getChildElement("hotelFilterInput");this.eventPrefix="filters.%s.".format(this.options.name);this.updatePopularDialog()},addEventHandlers:function(){this.base();var a=this;this.updateSmarty();this.subscribe("resultspage.searchId.changed",function(b){a.searchId=b.searchId});this.subscribe("search.poll.response",function(b){a.updatePopularDialog(b);a.disabledFilter(b)});this.subscribe(this.eventPrefix+"resetitem",this.removeHotelFromSelected.bind(this))},updateSmarty:function(){var a=
this,b=e.config.getString("ui.brand.smartUrl","/f/smarty");this.smarty&&"function"===typeof this.smarty.destroy&&this.smarty.destroy();this.smarty=this.hotelFilterInput.hotelSmarty({dropdownClass:"smartbox smartbox-longnames hotelName"+a.options.featureClass+(a.options.useMcFlyStyling?" mcfly-styling":""),dataSource:b,forceSelection:!1,showDropDownWhenEmpty:!1,flareSmartyType:79,positionOnScroll:!0,minWidth:250,forceSelectionOfHighlightedItem:!1,trackingType:"none",initialData:function(){return a.popularDialogHtml},
setItem:function(b,c){b="h-"+c.id;a.hotelFilterInput.val("");e.events.publish("filter.reset",{name:"price-options"},{type:"reset"});a.addHotelToSelected(c.str,b);a.logUserInteraction("add");a.pushStateChange(null,{changeData:{field:b,value:"1",name:c.str}})},extendRequest:function(){return{searchid:a.searchId,c:a.searchCityIds.join(",")}}})},cleanupExistingState:function(){this.willReset()},willReset:function(){var a=this;Object.keys(this.selectedHotels).forEach(function(b){a.selectedHotels[b].remove();
delete a.selectedHotels[b]});this.selectedHotelsContainer.attr("aria-hidden",!0);e.events.publish("resultsHeader.sortType.resetForced")},update:function(a){if(a){this.searchCityIds=a.cityIds;this.element.removeClass("empty");this.resetSelectedHotels();if(a.hasOwnProperty("hotelIds"))for(var b=0,d=a.hotelIds.length;b<d;b++)this.addHotelToSelected(a.hotelNames[b],a.hotelIds[b],!0);a.hasOwnProperty("popularBrands")&&e.dom.schedule(this.updatePopularDialog.bind(this,a.popularBrands))}},updatePopularDialog:function(a){this.options.isPopularEnabled&&
("undefined"!==typeof a?(this.popularHotelsData=a.popularHotels,this.popularDialogHtml=this.renderPopularDialog()):this.popularDialogHtml=this.getChildElement("popularDialog").html())},resetSelectedHotels:function(){this.selectedHotels=[];this.selectedHotelsContainer.empty()},addHotelToSelected:function(a,b,d){var c=this;c.selectedHotels.hasOwnProperty(b)&&c.selectedHotels[b].length||(this.selectedHotels[b]=f(),d&&e.dom.schedule(function(){c.selectedHotels[b]=e.template.renderElement("hotelItem",
{name:a,code:b});c.selectedHotelsContainer.append(c.selectedHotels[b]);c.selectedHotelsContainer.attr("aria-hidden",!1);c.selectedHotels[b].find(".close").click(c.onCloseClick.bind(c,b))}))},onCloseClick:function(a){null!=a?this.removeHotelFromSelected(a):null!=this.currentTarget&&this.removeHotelFromSelected(this.currentTarget.parentElement.id())},removeHotelFromSelected:function(a){if(this.selectedHotels.hasOwnProperty(a)&&this.selectedHotels[a].length){var b=this.selectedHotels[a].data("name");
this.selectedHotels[a].slideUp().remove();delete this.selectedHotels[a];this.pushStateChange(null,{changeData:{field:a,value:"0",name:b}});this.logUserInteraction("remove");0===this.selectedHotels.length&&this.selectedHotelsContainer.attr("aria-hidden",!0)}},renderPopularDialog:function(){this.popularDialogHtml="";var a=f("\x3cdiv\x3e"),b=this.renderPopularItems(this.popularHotelsData,"hotel");if(!b)return"";b&&(a.append(e.template.renderElement(this.templates.popularHotelsLabel)),a.append(b));return a.html()},
renderPopularItems:function(a,b,d){var c="undefined"!==typeof d?d:5,h=this,g=null;a&&Object.keys(a).length&&(g=f(e.template.renderElement(this.templates.popularSectionTemplate,{type:b})),a.some(function(a,d){if(d>=c)return!0;d=b+"-"+a.id;h.selectedHotels.hasOwnProperty(d)?c++:(a=e.template.renderElement(h.templates.popularItemTemplate,{type:b,code:d,displayName:a.name}),g.append(a))}));return g},getState:function(){var a=Object.keys(this.selectedHotels);return 0<a.length?{hotelIds:a}:null},disabledFilter:function(a){var b=
this,d=!1,c=!1;a.filtersData&&(a.filtersData.hotelname&&(d=a.filtersData.hotelname.disabledFilter),a.filtersData.hotelchain&&(c=a.filtersData.hotelchain.isUserManipulated));this.hotelFilterInput[0].disabled=d||c;this.smarty.getWidget().runSearchOnFocus=function(){return!b.hotelFilterInput[0].disabled}},trackStateChange:function(a){this.trackStateChangeEnabled(a)&&e.VestigoEvents.filters.hotels.hotelname(a.changeData.field,a.changeData.name,0==a.changeData.value?e.VestigoType.FilterValueAction.unselect:
e.VestigoType.FilterValueAction.select)}})})(R9,jQuery);(function(d,e){d.createComponentClass("common.results.filters.AndUpFilter","common.results.filters.Filter",{titleEl:null,state:{},items:[],itemValues:{},tooltips:[],any:null,rentalsCheckbox:null,rentalsCheckboxState:1,lastItemClicked:0,numberVisibleItem:5,numberVisibleItems:5,lastTarget:null,atLeastSubtitle:null,disabledItemClass:null,options:{countEnabled:!1,anyEnabled:!0,plusSign:"%s+",hideUnavailable:!0,tooltipColor:"black",useRadioButtons:!1},init:function(){var a=this;this.base();this.titleEl=
this.element.find(".filterSectionTitle");this.items=this.element.find(".item");this.items.each(function(b,c){a.itemValues[e(c).attr("value")]=b});this.any=this.element.find(".item-any");this.rentalsCheckbox=this.getChildElement("rentals-check");this.eventPrefix="filters.%s.".format(this.options.name);this.disabledItemClass=this.options.hideUnavailable?"hidden":"disabled";this.itemContainer=this.getChildElement("options")},addEventHandlers:function(a){var b=this;this.base(a);this.options.useRadioButtons?
this.bindRadioButtons():(a.find(".item .overlay").on("click",this.selectItemsRight.bind(this)),a.find(".item-any .overlay").on("click",this.selectAnyItem.bind(this)),a.find(".item, .item-any").on("keypress",function(a){switch(a.which){case d.globals.keyCodes.SPACE:case d.globals.keyCodes.RETURN:a.preventDefault(),e(a.target).children(".overlay").click()}}),this.addKeyboardNavigation(a),this.element.find(".filter-options").mouseleave(this.handleItemMouseLeave.bind(this)),this.rentalsCheckbox.click(this.handleRentalsFilterClick.bind(this)),
this.subscribe("filters.property.rental.changed",this.handlePropertyFilterChange.bind(this)),this.isTouchDevice()||(this.tooltips.push(this.any.toolTip({content:function(){return b.any.attr("data-message")},position:"top",showImmediately:!1,color:b.options.tooltipColor})),this.items.each(function(){var a=e(this);b.tooltips.push(a.toolTip({content:function(){return a.attr("data-message")},position:"top",showImmediately:!1,color:b.options.tooltipColor}));a.mouseenter(b.handleItemMouseEnter.bind(b))}),
this.subscribe("hotels.results.horizontalFilters.pinned",this.adjustTooltipPositioning.bind(this))),this.subscribe(this.eventPrefix+"resetitem",this.checkItems.bind(this)),d.events.subscribe(this.eventPrefix+"clickitem",function(a){b.checkItemByValue(a.itemvalue)}))},bindRadioButtons:function(a){var b=this;this.options.useRadioButtons&&this.getChildElement("review-score-radios").length&&(this.radioButtons=this.getChildElement("review-score-radios").getWidget())&&(this.radioButtons.setOption("click",
this.selectItemsRightOfElement.bind(this)),this.items.each(function(){e(this).next().find(".count").on("click",b.selectItemsRightOfElement.bind(b,this))}))},adjustTooltipPositioning:function(a){a&&a.hasOwnProperty("filtersPinned")&&null!=this.tooltips&&!this.options.inModal&&this.tooltips.forEach(function(b){b.getWidget().options.position=a.filtersPinned?"bottom":"top"})},setClazz:function(a){this.element.removeClass("one-up two-up three-up four-up five-up");this.element.addClass(a)},filterChanged:function(a){var b=
{};a&&-1<a.indexOf("-")&&(b.field=a.split("-")[1],b.value=1);this.logFilterChanged(a);this.pushStateChange(null,{changeData:b});this.updateFilterHistory()},logFilterChanged:function(a){this.logUserInteraction(["AndUpFilter",a].join("-"))},setCountClass:function(a){this.element.removeClass("count0 count1 count2 count3 count4 count5");this.element.addClass("count"+a)},onSetFromPrevious:function(a){a.reset&&(a.silent=!0);this.base(a)},setStateFromPrevious:function(a){if(a.reset)this.reset();else{var b;
b=this.options.useRadioButtons?function(a){return a.val()}:function(a){return a.data("val")};var c=this.items.filter(function(){return b(e(this))===a.key}).eq(0);c.length&&this.selectItemsRightOfElement(c)}},setState:function(a){var b=this;this.state=a;var c=this.getKeys(a);if(this.options.useRadioButtons){this.resetItemState();var g="",k=!0;c.each(function(a){1===b.state[a]?g=a:k=!1});this.radioButtons.setButtonCheckedByValue(k?"any":g)}else{this.items.addClass(this.disabledItemClass).attr("aria-"+
this.disabledItemClass,!0);d.globals.testMode&&this.items.attr("data-test-filteritem-disabled",!0);this.any.addClass("hidden").attr("aria-hidden",!0);var f=e.map(c,function(a){return".item.item-"+a});this.numberVisibleItems=f.length;this.setCountClass(this.numberVisibleItems);var h=[];e.each(c,function(b,c){1===a[c]&&h.push(".item.item-"+c)});f=this.itemContainer.find(f.join());f.removeClass(this.disabledItemClass).attr("aria-"+this.disabledItemClass,!1);f.removeClass("selected").attr("aria-checked",
!1);d.globals.testMode&&f.attr("data-test-filteritem-disabled",!1);this.any.removeClass("hidden").attr("aria-hidden",!1);this.any.removeClass(this.disabledItemClass).attr("aria-"+this.disabledItemClass,!1);h.length>=this.numberVisibleItems?(this.resetItemState(),this.any.addClass("selected").attr("aria-checked",!0),d.globals.testMode&&this.any.attr("data-test-filteritem-selected",!0)):(c=this.itemContainer.find(h.join()),c.addClass("selected").attr("aria-checked",!0),d.globals.testMode&&c.attr("data-test-filteritem-selected",
!0))}},selectItemsRight:function(a){return this.selectItemsRightOfElement(e(a.target))},selectItemsRightOfElement:function(a){var b=this;this.resetItemState();this.lastTarget=a;if(this.options.useRadioButtons){var c=!1,g=null;this.items.each(function(a){b.state[this.value]=c?0:1;e(b.lastTarget).attr("value")===e(this).attr("value")&&(e(this).addClass("selected").attr("aria-checked",!0),g=this.value,c=!0)});g&&this.filterChanged("change-"+g)}else a=a.closest(".item").index(),0===a&&(a=1),this.lastItemClicked=
a,a=e(this.items.slice(this.options.anyOptionEnabled?a-1:a,this.items.length)),a.addClass("selected").attr("aria-checked",!0),d.globals.testMode&&a.attr("data-test-filteritem-selected",!0),this.setStateFromUI(),this.filterChanged(["change",e.map(this.state,function(a,b){return 1==a?b:null}).join("-")].join("-"))},selectAnyItem:function(a){this.lastTarget=e(a.target);this.resetItemState();d.events.publish("filter.reset",{name:this.name});this.any.addClass("selected").attr("aria-checked",!0);d.globals.testMode&&
this.any.attr("data-test-filteritem-selected",!0);this.logSelectAnyItem()},deselectAnyItem:function(){this.any.hasClass("selected")&&(this.any.removeClass("selected").attr("aria-checked",!1),d.globals.testMode&&this.any.attr("data-test-filteritem-selected",!1))},logSelectAnyItem:function(){this.logUserInteraction("showall")},toggleItem:function(a){a=e(a.target).closest(".item");var b=this.element.find(".item:not(.hidden):not(.disabled)"),c=this.element.find(".item.selected:not(.hidden):not(.disabled)");
c.length===this.numberVisibleItems?(b.removeClass("selected").attr("aria-checked",!1),a.addClass("selected").attr("aria-checked",!0),d.globals.testMode&&(b.attr("data-test-filteritem-selected",!1),a.attr("data-test-filteritem-selected",!0))):1===c.length&&a.is(".selected")?(b.addClass("selected").attr("aria-checked",!0),d.globals.testMode&&b.attr("data-test-filteritem-selected",!0)):(b=!a.hasClass("selected"),a.toggleClass("selected",b).attr("aria-checked",b),d.globals.testMode&&a.attr("data-test-filteritem-selected",
b));this.setStateFromUI();this.filterChanged(["change",e.map(this.state,function(a,b){return 1==a?b:null}).join("-")].join("-"))},setStateFromUI:function(){var a=this;a.state={0:0};this.itemContainer.find(".item:not(.disabled):not(.hidden)").each(function(b,c){b=e(c);c=e(c).data("val");a.state[c]=b.is(".selected")?1:0})},getState:function(){return this.state},update:function(a){var b=this,c=a.valueMap,e=this.getKeys(c),d=a.andUpCounts,f={},e=e.sort(function(a,b){return c[a].displayOrder-c[b].displayOrder});
e.forEach(function(a){var e=c[a];if(e.filtered)f[a]=-1;else{var g=b.element.find(".item-"+a);g.length&&(g.data(e.call||e.info?"":b.options.plusSign.format(e.minPrice)),b.options.useRadioButtons&&d&&d[a]&&g.next().find(".count span").text(d[a]));f[a]=e.selected?1:0;e.selected&&b.deselectAnyItem()}});b.options.useRadioButtons&&d&&d.any&&this.any.next().find(".count span").text(d.any);this.setState(f)},cleanupExistingState:function(){this.state={};this.setClazz("");this.items.addClass(this.disabledItemClass).attr("aria-"+
this.disabledItemClass,!0);d.globals.testMode&&this.items.attr("data-test-filteritem-disabled",!0);this.any.addClass("hidden").attr("aria-hidden",!0);this.lastTarget=null},getKeys:function(a){var b=[],c;for(c in a)a.hasOwnProperty(c)&&-1!==a[c]&&b.push(c);return b},handleItemMouseEnter:function(a){a=e(a.target).closest(".item");var b=a.index();0>b&&(b=0);e(this.items.slice(0,b)).removeClass("hovered");a.addClass("hovered");e(this.items.slice(b,this.items.length)).addClass("hovered")},handleItemMouseLeave:function(a){this.items.removeClass("hovered")},
resetItemState:function(){this.items.removeClass("selected").attr("aria-checked",!1);this.any.removeClass("selected").attr("aria-checked",!1);d.globals.testMode&&(this.items.attr("data-test-filteritem-selected",!1),this.any.attr("data-test-filteritem-selected",!1))},willReset:function(a){this.lastTarget=null;this.resetItemState()},handleRentalsFilterClick:function(a){this.rentalsCheckboxState=0<this.rentalsCheckboxState?0:1;d.events.publish("filters.property.rental.setchecked.force",{selected:this.rentalsCheckboxState,
changeType:"toggle"})},handlePropertyFilterChange:function(a){this.rentalsCheckboxState!=a.selected&&(this.rentalsCheckboxState=a.selected,this.rentalsCheckbox.prop("checked",0<this.rentalsCheckboxState).attr("aria-checked",0<this.rentalsCheckboxState))},filterDataChanged:function(a){this.base(a);1===this.lastItemClicked&&this.toggleResetLink(!0)},reset:function(a){this.base(a);this.lastItemClicked=0},checkItems:function(a){--a;this.items.length&&this.items[a]&&e(this.items[a]).find(".overlay").trigger("click")},
checkItemByValue:function(a){this.element.find('.item:not(.disabled):not(.hidden)[data-val\x3d"'+a+'"]').find(".overlay").click()},getStateForFilterHistory:function(){var a=this.getFilterPillDisplayValues();return e.extend({},{displayName:this.items.title,state:this.getState(),type:d.question.ask("filters.FilterHistory.type.andup")},a)},getFilterPillDisplayValues:function(){var a=null,b={};this.items.filter(":not(.hidden):not(.disabled)").each(function(c,d){c=e(d);d=c.attr("data-val");null==a&&c.is(".selected")&&
(a=d);b[d]=c.attr("data-message")});return{lowestKey:a,displayValues:b}},getHistoryFilterViewState:function(a){var b=this.getState(),c=this,d=function(a){return a.map(function(a){var b=c.items.filter("[data-val\x3d%s]".format(a));return b.length?{key:a,index:b.index()}:null}).filter(function(a){return null!==a}).sort(function(a,b){return a.index>b.index?1:-1}).map(function(a){return a.key})}(this.getKeys(a).filter(function(b){return 0!=a[b]})),k=[];this.items.each(function(a,b){k.push(e(b).attr("data-val"))});
var f=d.filter(function(a){return"undefined"!==typeof b[a]&&null!==b[a]});if(f.length){var h=f[0],f=b[h],h=k.indexOf(h);if(1==f&&(0===h||0==b[k[h-1]]))return{isAlreadyApplied:!0,lowestKey:d[0]}}else return{disabled:!0};return{state:a,lowestKey:d[0]}},applyFilterFromHistory:function(a){if(d.config.getBoolean("ui.horizon.filters.history.enabled",!1)){var b=e.extend({},this.getState());this.resetItemState();this.getKeys(b).forEach(function(a){b[a]=0});var c=e.extend({},b,a);d.Analytics.api.trackEvent({category:"Filter-History",
action:"Applying state From History: "+a,label:this.name});d.events.publish("filters.changed",{name:this.name,state:c})}},syncWithHistoryPillState:function(a){this.reset();this.base(a)},isTouchDevice:function(){return"ontouchstart"in window||navigator&&0<navigator.maxTouchPoints},addKeyboardNavigation:function(a){a.find(".item, .item-any").on("keydown",function(a){var b,g;switch(a.which){case d.globals.keyCodes.LEFT:b=e(this).prev();g="back";break;case d.globals.keyCodes.RIGHT:b=e(this).next(),g=
"forward"}for(;"none"===b.css("display")&&b.length;)b="back"===g?b.prev():b.next();b.focus()})}})})(R9,jQuery);(function(b,d){b.createComponentClass("hotels.results.filters.ReviewScoreFilter","common.results.filters.AndUpFilter",{startPopover:null,closeTimeout:null,autoCloseTimeout:null,options:{ratingOptions:null,showStartPopover:!1,popoverFadeTimeout:30,classNameForPopover:""},init:function(){this.base();this.startPopover=this.getChildElement("StartTooltip")},addEventHandlers:function(a){this.base(a);var c=this;this.subscribe("resultspage.streaming.firstPhase.done",function(){c.initStartPopover()});this.registerEvent("click",
d(".topFilters, .showMap"),function(){c.disablePopover()});this.subscribe(["provider.book.click","authentication.showLogin","result.details.opened"],function(){c.closePopover()});this.registerEvent("resize",d(window),function(){c.isPopoverEnabled()&&c.positionPopover(jq(c.options.classNameForPopover),c.startPopover)});null!=this.options.ratingOptions?this.options.ratingOptions.each(function(a){b.events.subscribe("filters.%s.%s.resetitem".format(c.name,a),function(a){b.events.publish("filter.reset",
{name:c.name})})}):b.events.subscribe(["filters.rating.okay.resetitem","filters.rating.good.resetitem","filters.rating.excellent.resetitem","filters.rating.mediocre.resetitem"],function(a){b.events.publish("filter.reset",{name:"rating"})})},updatePlaceholderDisplay:function(a){this.options.isDropdown?this.base(a):a&&(this.getChildElement("placeholder").toggleClass("hidden",!a.visible),this.getChildElement("options").toggleClass("hidden",!!a.visible))},initStartPopover:function(){var a=this;this.isPopoverEnabled()&&
(window.setTimeout(function(){a.positionPopover(jq(a.options.classNameForPopover),a.startPopover);a.startPopover.fadeIn("slow");jq("body").append(a.startPopover);a.timeoutPopover();a.startPopover.find(".closeLink").off("click").on("click",function(){a.disablePopover()})},1E3),this.autoCloseTimeout=window.setTimeout(function(){a.startClose(a.startPopover)},1E3*this.options.popoverFadeTimeout))},isPopoverEnabled:function(){return 0<this.startPopover.length&&this.checkShowStartPopover()},timeoutPopover:function(){b.storage.set("filterUsePromoTimeoutStart",
Date.now())},disablePopover:function(){this.setDisablePromoUse();this.closePopover()},closePopover:function(){clearTimeout(this.autoCloseTimeout);this.startClose(this.startPopover)},setDisablePromoUse:function(){b.storage.remove("filterUsePromoTimeoutStart");b.storage.set("disableFilterUsePromo","true")},checkShowStartPopover:function(){var a=b.storage.get("disableFilterUsePromo"),c=b.storage.get("filterUsePromoTimeoutStart");if(!a)if(c){if(c+864E5<Date.now())return b.storage.remove("filterUsePromoTimeoutStart"),
!0}else return!0;return!1},positionPopover:function(a,c){var b=jq(a).offset();c.css({top:b.top+70,left:b.left+jq(a).outerWidth()+10})},startClose:function(a){var c=this;this.closeTimeout=setTimeout(function(){a.find(".closeIcon").hide();a.fadeOut("slow",function(){c.element.append(a)})},100)},getFilterPillDisplayValues:function(){var a=null,c={};this.cards.filter(":not(.hidden):not(.disabled)").each(function(b,e){b=d(e);e=b.attr("data-val");var f=b.attr("data-message");null==a&&b.is(".selected")&&
(a=e);c[e]=[f,d.trim(b.text())]});return{lowestKey:a,displayValues:c}},trackStateChange:function(a){this.trackStateChangeEnabled(a)&&b.VestigoEvents.filters.hotels.reviews(this.resolveVestigoValue(a.changeData.field),this.getTrackingAction(a.changeData.value))},resolveVestigoValue:function(a){return a?b.VestigoType.ReviewsOption[a]:b.VestigoType.ReviewsOption.any}})})(R9,jQuery);(function(b,e){b.createComponentClass("hotels.results.filters.PriceOptionsFilter","common.results.filters.ValueSetFilter",{options:{shouldOverrideReset:!1,onReset:function(a){var b=a&&"reset"===a.type,d=this.options.shouldOverrideReset;this.forEachItem(function(a,c){!d||"onlinereq"!==a&&"noimage"!==a?c.setChecked(0):c.setChecked(b?0:1)});this.logUserInteraction("showall");this.pushStateChange()},onGetState:function(a){return 0==a.onlinereq&&0==a.noimage&&0==a.dealonly&&0==a.bestvalueonly?{}:a}}})})(R9,
jQuery);(function(b){b.createComponentClass("common.results.filters.FilterList",{filtersSection:null,filterTabs:null,placeholderList:null,isPlaceholderEnabled:null,filterLayout:{},options:{searchCompleted:!1,primaryFilterList:[],moreFilterList:[],hideDelay:0},init:function(){this.filtersSection=this.getChildElement("filtersSection");this.placeholderList=this.getChildElement("placeholderList");this.filterTabs=this.element.find(".filterTab");this.isPlaceholderEnabled=this.placeholderList&&0<this.placeholderList.length;
this.hideFilterList()},addEventHandlers:function(){var a=this;this.subscribe("resultspage.streaming.done",this.showFilterList.bind(this));this.subscribe(["search.startSearch","resultspage.streaming.start"],this.streamingStarted.bind(this));this.subscribe("resultspage.filtersData.changed",this.handleFilterResponse.bind(this));this.subscribe("search.searchFailed",this.hideAll.bind(this));this.subscribe("resultspage.filterList.show",this.showFilterList.bind(this));this.filterTabs.keydown(this.handleTabKeydown.bind(this));
this.element.on("click",".fullscreen-dialog-header",function(){a.element.toggleClass("active")})},handleFilterResponse:function(a){a&&Object.keys(a).length&&a[Object.keys(a)[0]].enabled&&(this.showFilterList(),b.events.publish("resultspage.filters.show"))},showFilterList:function(){this.element.removeClass("loading");this.filtersSection.removeClass("hidden");this.isPlaceholderEnabled&&this.placeholderList.addClass("hidden")},handleTabKeydown:function(a){switch(a.which){case b.globals.keyCodes.RETURN:case b.globals.keyCodes.SPACE:a.currentTarget.click();
break;case b.globals.keyCodes.RIGHT:this.focusNextTab($(a.currentTarget));break;case b.globals.keyCodes.LEFT:this.focusPrevTab($(a.currentTarget))}},focusNextTab:function(a){!a.next().is(a)&&a.next().is(".filterTab")?a.next().click().focus():this.filterTabs.eq(0).click().focus()},focusPrevTab:function(a){!a.prev().is(a)&&a.prev().is(".filterTab")?a.prev().click().focus():this.filterTabs.eq(-1).click().focus()},streamingStarted:function(a){"undefined"!==typeof a&&a.preserveFilters||(this.options.hideDelay?
setTimeout(this.hideFilterList.bind(this),this.options.hideDelay):this.hideFilterList())},hideFilterList:function(){this.element.addClass("loading");this.filtersSection.addClass("hidden");this.isPlaceholderEnabled&&this.placeholderList.removeClass("hidden");b.events.publish("resultspage.filters.hide")},hideAll:function(){this.filtersSection.addClass("hidden");this.isPlaceholderEnabled&&this.placeholderList.addClass("hidden");b.events.publish("resultspage.filters.hide")}})})(R9);(function(b,g){b.createComponentClass("hotels.results.filters.HotelFilterList","common.results.filters.FilterList",{filtersTabs:null,topFiltersSection:null,hotelSortDropdown:null,searchId:null,scrollIndicatorLeft:null,secondFiltersRowWrapper:null,scrollIndicatorRight:null,loadCompleteResultsTimeout:5E3,options:{isUpdatedStyling:!1,useMapToggle:!1,isMomondo:!1,horizontalFilter:!1,includeHeaderInMap:!1,moreCollapsible:!1},init:function(){this.base();this.options.isMomondo&&this.options.horizontalFilter&&
(this.scrollIndicatorRight=this.getChildElement("scrollIndicatorRight")[0],this.scrollIndicatorLeft=this.getChildElement("scrollIndicatorLeft")[0],this.secondFiltersRowWrapper=this.getChildElement("bottomFilterRowWrapper"),this.secondFiltersRowWrapper[0].scrollWidth>this.secondFiltersRowWrapper[0].clientWidth&&(this.scrollIndicatorRight.style.opacity="1"))},addEventHandlers:function(){this.base();var a=this,c=this.getChildElement("topFiltersTab"),d=this.getChildElement("moreFiltersTab"),e=this.getChildElement("moreFiltersSection");
this.filtersTabs=this.getChildElement("filterTabs");this.topFiltersSection=this.getChildElement("topFiltersSection");this.hotelSortDropdown=this.getChildElement("sort");c.on("click",function(){d.hasClass("selectedTab")&&(c.addClass("selectedTab").attr("aria-selected",!0),d.removeClass("selectedTab").attr("aria-selected",!1),e.addClass("hidden").attr("aria-expanded",!1),a.topFiltersSection.removeClass("hidden").attr("aria-expanded",!0),b.Analytics.api.trackEvent("filter_tabs_hrp/topFiltersTab"),b.events.publish("filterTab.changed"),
a.filtersTabs.removeClass("moreSelected"))});d.on("click",function(){c.hasClass("selectedTab")&&(d.addClass("selectedTab").attr("aria-selected",!0),c.removeClass("selectedTab").attr("aria-selected",!1),e.removeClass("hidden").attr("aria-expanded",!0),a.topFiltersSection.addClass("hidden").attr("aria-expanded",!1),b.Analytics.api.trackEvent("filter_tabs_hrp/moreFiltersTab"),b.events.publish("filterTab.changed"),a.filtersTabs.addClass("moreSelected"))});var f=this.getChildElement("mapViewPortal"),h=
this.getChildElement("fullScreenMapToggle");a.options.useMapToggle||(f.on("click",function(){b.Analytics.api.trackEvent("sparklemap/open")}),h.on("click",function(){b.events.publish("hotels.rp.fullScreenMap.toggle",{includeHeader:a.options.includeHeaderInMap})}),this.subscribe("hotels.rp.fullScreenMap.opened",function(){a.getChildElement("fullScreenMapToggleCaption").html(a.options.msg.mapLayerClose)}),this.subscribe(["hotels.rp.fullScreenMap.closed","resultspage.cleanup"],function(){a.getChildElement("fullScreenMapToggleCaption").html(a.options.msg.mapLayerOpen)}),
this.subscribe("searchform.submit",function(a){f.prop("href","/"+a.url+";map")}));this.subscribe("resultspage.filtersData.changed",function(){a.options.useMapToggle||(f.removeClass("hidden"),h.removeClass("hidden"));a.filtersTabs.removeClass("hidden");a.hotelSortDropdown.removeClass("hidden")});this.subscribe("resultspage.searchId.changed",function(b){a.searchId=b.searchId});this.subscribe("resultspage.streaming.done",function(b){a.onSearchFinished(b)});this.subscribe(["search.startSearch","search.searchFailed"],
function(b){"undefined"!==typeof b&&b.preserveFilters||(a.options.useMapToggle||f.addClass("hidden"),a.filtersTabs.addClass("hidden"),a.hotelSortDropdown.addClass("hidden"))});this.options.isMomondo&&this.options.horizontalFilter&&(this.secondFiltersRowWrapper.on("scroll",function(){a.toggleFilterScrollIndicator("scroll")}),g(window).on("resize",function(){a.toggleFilterScrollIndicator("resize")}));if(this.options.moreCollapsible){var k=this.getChildElement("moreFiltersDrawer");e.addClass("collapsed");
this.registerEvent("click",k,function(){g(this).toggleClass("expanded");e.toggleClass("collapsed")})}},onSearchFinished:function(a){a.error&&a.error.type||this.element.find(".dispCt").removeClass("hidden")},toggleFilterScrollIndicator:function(a){"resize"===a&&1250<g(window)[0].innerWidth?(this.scrollIndicatorLeft.style.opacity="0",this.scrollIndicatorRight.style.opacity="0"):0===this.secondFiltersRowWrapper[0].scrollLeft?(this.scrollIndicatorLeft.style.opacity="0",this.scrollIndicatorRight.style.opacity=
"1"):this.secondFiltersRowWrapper[0].scrollLeft===this.secondFiltersRowWrapper[0].scrollWidth-this.secondFiltersRowWrapper[0].clientWidth?(this.scrollIndicatorLeft.style.opacity="1",this.scrollIndicatorRight.style.opacity="0"):this.secondFiltersRowWrapper[0].scrollWidth===this.secondFiltersRowWrapper[0].clientWidth?(this.scrollIndicatorLeft.style.opacity="0",this.scrollIndicatorRight.style.opacity="0"):(this.scrollIndicatorLeft.style.opacity="1",this.scrollIndicatorRight.style.opacity="1")}})})(R9,
jQuery);(function(a){a.createComponentClass("hotels.results.filters.brands.hotelscombined.HotelFilterList","hotels.results.filters.HotelFilterList",{resetFilters:null,init:function(){this.base();this.resetFilters=this.getChildElement("resetFilters")},addEventHandlers:function(){this.base();this.resetFilters.on("click",function(){a.events.publish("filters.reset",{type:"showAll"});a.events.publish("resultsHeader.sortType.set",{sortCode:"rank_a"})})}})})(window.R9);(function(c,h,g){c.publish("common.kn.Mixin",g.extend({loadGPT:function(){if(!c.common.kn.Mixin.loadedGPT&&c.config&&c.config.getBoolean("ui.gpt.loadOnce",!0)||!window.googletag){c.common.kn.Mixin.loadedGPT=1;window.googletag||(window.googletag={cmd:[]});var a=document.createElement("script");a.async=!0;a.type="text/javascript";a.src="//www.googletagservices.com/tag/js/gpt.js";var f=document.getElementsByTagName("script")[0];f.parentNode.insertBefore(a,f)}window.googletag.cmd=window.googletag.cmd||
[]},loadAdsense:function(){window._googCsa||function(a,f,d,b,e,c){a[b]=a[b]||function(){(a[b].q=a[b].q||[]).push(arguments)};a[b].t=1*new Date;e=f.createElement(d);c=f.getElementsByTagName(d)[0];e.async=1;e.src="//www.google.com/adsense/search/async-ads.js";c.parentNode.insertBefore(e,c)}(window,document,"script","_googCsa")},findAdDataForType:function(a,c,d){if(!(d&&a&&c&&d[a]))return null;var b,e;for(e in d[a])if(d[a].hasOwnProperty(e)){b=d[a][e];if("string"===typeof b)try{b=JSON.parse(b)}catch(k){b=
null}if(b&&b.pageLocation&&b.pageLocation===c)return b}return null}}))})(R9,jQuery,window.base2.Base);(function(a,c){a.createComponentClass("common.kn.Display",{options:{},addEventHandlers:function(){var b=this;this.subscribe("displayads.register",{type:b.options.type},function(a){b.registerDisplay()});b.options.destroyable&&this.subscribe("displayads.destroy",function(){a.events.publish("displayad.sra.destroy",b.getSlotParams())})},inlineComponentsReady:function(){this.options.lazyLoad||this.registerDisplay()},registerDisplay:function(){a.events.publish("displayad.sra.register",c.extend(this.getSlotParams(),
this.options))},destroy:function(){a.events.publish("displayad.sra.destroy",this.getSlotParams());this.base()},getSlotParams:function(){return{adDivId:this.id()}}})})(R9,jQuery);(function(f,c){var h=f.config.getBoolean("ui.horizon.rails.fuzzyComparisons",!0);f.createComponentClass("base.results.Rail",{options:{pinnable:!0,sticky:!1,debug:!1,debounceDelay:5,handleHorizontalScroll:!0,repositionTimeout:200,fixedTopPosition:0,preventDynamicPositioning:!1,defaultRailWidth:300,isBusinessMode:!1,appliedTravelPolicyIds:[],isOneWay:!1},prevScroll:0,upScroll:!1,stickTop:!1,stickBottom:!1,originalNode:null,staticPosition:0,pinnedContentHeight:0,enabled:!0,isFullScreenMapV3:!1,init:c.noop,
addEventHandlers:c.noop,inlineComponentsReady:function(){var a=this;a.originalNode=a.element.get(0);this.bindWindowEvents();this.element.hasClass("fullscreen-drawer")&&(this.isFullScreenMapV3=!0);this.options.pinnable&&this.subscribe("resultspage.streaming.done moreFilters.toggle filterTab.changed filter.overflow.toggle displayad.loaded textad.loaded pinnedContent.heightChanged horizon.filters.opened resultspage.requestResults.completed horizon.filters.FiltersDialog.itemToggled".split(" "),function(){a.onScroll()});
this.subscribe("pinnedContent.enable",function(b){a.enabled=b});this.subscribe(["pinnableBar.pinnedChange","pinnedContent.heightChanged"],function(){a.setPinnedContentHeight()});this.subscribe("pinnedContent.reset",function(){a.resetPosition()});this.subscribe("rail.update.preventDynamicPositioning",this.updatePreventDynamicPositioning.bind(this))},onScroll:function(){!1!==this.enabled&&(this.isRailAttached()?this.handleScroll():this.unbindWindowEvents())},handleScroll:function(){var a=this.getWindowScroll(),
b=this.getParentScroll();this.upScroll=this.prevScroll>a;this.prevScroll=a;(a=this.getPositionCSS(a,b,this.isElementTallerThanScreen()))&&this.element.css(a)},unbindWindowEvents:function(){c(window).off("scroll.pinrails-"+this.id());c(window).off("resize.pinrails-"+this.id())},bindWindowEvents:function(){var a;this.options.pinnable&&(0<this.options.repositionTimeout&&this.element.css("transition","transform %sms ease-in-out".format(this.options.repositionTimeout)),a=0<this.options.debounceDelay?f.Common.Utils.debounce(this.onScroll.bind(this),
this.options.debounceDelay):this.onScroll.bind(this),this.registerEvent("scroll.pinrails-"+this.id(),c(window),a),this.registerEvent("resize.pinrails-"+this.id(),c(window),a))},testBottom:function(a,b){return b?a<this.getParentHeight()-this.getWindowHeight():a+this.getElementHeight()<this.getParentHeight()},testTop:function(a,b){return a>this.getParentTop()-this.pinnedContentHeight-this.options.fixedTopPosition},isElementTallerThanScreen:function(){return this.getElementHeight()>this.getWindowHeight()},
calculateScrollPosition:function(a,b){return!b||this.upScroll&&this.fuzzyCompare(this.getElementTop()-this.getParentTop()-this.pinnedContentHeight,a)?{position:"top"}:!this.upScroll&&this.fuzzyCompare(a+this.getWindowHeight(),this.getElementBottom()-this.getParentTop())?{position:"bottom"}:{translate:this.staticPosition}},fuzzyCompare:function(a,b){if(!h)return a>=b;a-=b;return 0<a||1>=Math.abs(a)},resetPosition:function(){var a=c.extend(!0,{},{position:"relative",left:"unset",top:"auto",bottom:"auto"},
this.makeTransformCSS("translate(0,0)"));this.element.css(a)},getPositionCSS:function(a,b,d){if(!this.isRailSticky()&&!this.isFullScreenMapV3){var g=0,e={position:"relative",top:"auto",left:"unset",bottom:"auto","padding-top":""};a=this.testTop(a,d);var f=this.testBottom(b,d);this.staticPosition=this.getElementTop()-this.getParentTop();if(a&&f)if(b=this.calculateScrollPosition(b,d),b.translate&&(g=b.translate),b.position){if(this.options.preventDynamicPositioning)return;"top"===b.position?(e={position:"fixed",
left:"inherit",top:this.options.fixedTopPosition,bottom:"auto",width:this.getParentWidth()},g=this.pinnedContentHeight):(e={position:"fixed",left:"inherit",bottom:0,top:"auto",width:this.getParentWidth()},g=0)}else e=c.extend({},e);else g=a?this.getParentHeight()-this.getElementHeight():0,e=c.extend({},e);b="translateY(%spx)".format(Math.max(0,g));this.options.handleHorizontalScroll&&"fixed"===e.position&&(d=this.getLeftScroll(),0<d&&(b="translate(-%spx, %spx)".format(d,g)));return c.extend({},e,
this.makeTransformCSS(b))}},getParentWidth:function(){return this.element.parent().width()},makeTransformCSS:function(a){return{msTransform:a,transform:a}},destroy:function(){this.unbindWindowEvents();this.base()},isRailAttached:function(){return this.element&&c.contains(window.document,this.originalNode)},isRailSticky:function(){var a=this.element.css("position");return"sticky"===a||"-webkit-sticky"===a},getElementHeight:function(){return Math.round(this.element.outerHeight())},getElementBottom:function(){return this.getElementTop()+
this.getElementHeight()},getElementTop:function(){return Math.round(this.element.offset().top)},getWindowHeight:function(){return Math.round(c(window).outerHeight())},getWindowScroll:function(){return Math.round(c(window).scrollTop())},getParentHeight:function(){return Math.round(this.element.parent().outerHeight())},getParentTop:function(){return Math.round(this.element.parent().offset().top)},getLeftScroll:function(){return Math.round(c(window).scrollLeft())},getParentBottom:function(){return this.getParentTop()+
this.getParentHeight()},getParentScroll:function(){return this.getWindowScroll()-this.getParentTop()},setPinnedContentHeight:function(){var a=f.question.ask("pinnedContent.height");null!==a?this.pinnedContentHeight=a:0!==this.pinnedContentHeight&&(this.pinnedContentHeight=0)},updatePreventDynamicPositioning:function(a){a&&a.hasOwnProperty("preventDynamicPositioning")&&(this.options.preventDynamicPositioning=a.preventDynamicPositioning)},subscribeForUpdatingPolicyInfo:function(a,b){if(this.options.isBusinessMode){var d=
this,c=this.getChildElement(b);this.subscribe("search.poll.response",function(b){b=d.getNewPolicies(b.appliedTravelPolicyIds);b.length&&(Array.prototype.push.apply(d.options.appliedTravelPolicyIds,b),f.ajax.execute("common/results/mercury/"+a,{data:{appliedTravelPolicyIds:JSON.stringify(d.options.appliedTravelPolicyIds),isOneWay:d.options.isOneWay},appendTo:c,replace:!0,afterScript:function(){c.show()}}))});this.subscribe("search.startSearch",function(a){d.options.appliedTravelPolicyIds=[];d.options.isOneWay=
!!a&&!!a.oneway;c.hide()})}},getNewPolicies:function(a){if(!a)return[];var b=this.options.appliedTravelPolicyIds;if(!b)return a;var c=[];a.forEach(function(a){-1===b.indexOf(a)&&c.push(a)});return c}})})(R9,jQuery);(function(a,b){a.createComponentClass("hotels.results.HotelLeftRail","base.results.Rail",{options:{mapVersionCode:"fullscreen"},init:function(){var a=this;"fullscreendrawer"===this.options.mapVersionCode&&(a.element.addClass("fullscreen-drawer"),setTimeout(function(){a.element.addClass("left-rail-results-closed")},1400))},addEventHandlers:function(){this.base();this.registerEvent("click",this.getChildElement("expandFilterButton"),function(){a.events.publish("hotels.results.splitView.expand.toggle");
a.Analytics.api.trackEvent("splitViewMap/filterToggle/click")})}})})(R9,jQuery);(function(d){d.createComponentClass("base.maps.MapData",{options:{url:"",searchId:""},filterState:null,headerChangeTimeout:null,filterStateChangeTimeout:null,pollNumber:0,pollPromise:null,update:!1,init:function(){this.filterState=d.question.ask("resultspage.filterState.is")||{}},addEventHandlers:function(){var a=this,b=a.options;a.subscribe("map.data.load",{id:b.map},a.loadSearchResults.bind(a));a.subscribe("map.data.update",{id:b.map},a.updateData.bind(a));a.subscribe("filters.changed",a.onFilterStateChange.bind(a));
a.subscribe("resultspage.filters.sync",a.syncFilterState.bind(a));a.subscribe("resultsHeader.changed",a.onResultHeaderChange.bind(a));a.subscribe("resultspage.searchId.changed",function(c){a.update=!1;c.searchId&&b.searchId!==c.searchId&&(b.searchId=c.searchId,a.startPolling())});a.subscribe("detailspage.searchId.changed",function(c){a.update=!1;c.searchId&&b.searchId!==c.searchId&&(b.searchId=c.searchId,a.startPolling())})},syncFilterState:function(a){this.filterState||(this.filterState=d.question.ask("resultspage.filterState.is")||
{});null===a.state?delete this.filterState[a.name]:this.filterState[a.name]=a.state},onFilterStateChange:function(a){this.syncFilterState(a);this.startPolling()},startPolling:function(){var a=this;a.pollingTimeout&&clearTimeout(a.pollingTimeout);a.pollingTimeout=setTimeout(function(){a.activeResultsUpdate||(a.pollNumber=0,a.activeResultsUpdate=!0,a.loadSearchResults())},0)},onResultHeaderChange:function(a){var b=this.options,c=!1;a&&a.sort&&(b.sortMode=a.sort.sortType,b.ascending=a.sort.ascending,
c=!0);a&&void 0!==a.priceType&&(b.priceType=a.priceType,c=!0);c&&this.startPolling()},updateData:function(){this.update?this.loadSearchResults():this.lastResponse&&d.events.publish("map.data.loaded",this.lastResponse)},loadSearchResults:function(){var a=this,b=a.options;if(d.question.ask("map.isVisible."+b.map)){a.update=!1;var c={searchId:b.searchId,sortMode:b.sortMode,ascending:b.ascending,applyFilters:!0,useViewStateFilterState:!1,pollNumber:a.pollNumber++};b.ctid&&(c.citycode=b.ctid);a.filterState&&
0<Object.keys(a.filterState).length&&(c.filterState=JSON.stringify(a.filterState));null!==b.priceType&&(c.priceType=b.priceType);a.pollPromise&&a.pollPromise.abort();a.pollPromise=d.action.execute(b.url,c,function(b,c,e){a.activeResultsUpdate=!1;202===e.status?d.events.publish("results.expired"):a.updateResults(b)});a.pollPromise.fail(function(){a.pollNumber=0;a.activeResultsUpdate=!1})}else a.activeResultsUpdate=!1,a.update=!0},updateResults:function(a){var b=this;a.id=b.options.map;b.lastResponse=
a;d.events.publish("map.data.loaded",a);a&&!a.completed&&setTimeout(function(){b.loadSearchResults()},2E3)}})})(window.R9);(function(d,m){d.createComponentClass("base.maps.MapMarkerInformation",{options:{map:"",visible:"",hidden:"",displayVisible:"",displayVisibleInlineBlock:"",displayHidden:"",secretDealsSignupHeading:"",secretDealsSignupSubheading:"",loggedIn:!1,ratingStyle:"",linkStyle:"",timeout:0},result:null,closeHandler:null,init:function(){},addEventHandlers:function(){var a=this,b=a.options,c=a.element;a.subscribe("map.marker.mouseover",{id:b.map},a.show.bind(a));a.subscribe("map.marker.mouseout",{id:b.map},
a.handleClose.bind(a));a.subscribe("map.marker.details.hide",{id:b.map},a.hide.bind(a));a.element.find(".js-openModal").on("click",function(){d.authentication.showSignup({customHeading:b.secretDealsSignupHeading,customSubheading:b.secretDealsSignupSubheading})});c.on("mouseenter",function(){a.clearHideTimeout()});c.on("mouseleave",function(){a.handleClose()});c.find(".js-openDetails").on("click",function(){a.result.detailsUrl&&window.open(a.result.detailsUrl,"_blank")});a.getChildElement("price").on("click",
function(){d.events.publish("base.maps.open.marker.details",{id:b.map,resultId:a.result.resultId})})},show:function(a){var b=this.options,c=this.element,g=a.coordinates,k=b.loggedIn;a=a.marker;var e=b.displayVisible,p=b.displayVisibleInlineBlock,f=b.displayHidden,l=this.getChildElement("price"),h=this.getChildElement("privateDealUnregister"),n=this.getChildElement("privateDealLogged"),q=this.getChildElement("privateDealLoggedPrice"),r=this.getChildElement("name"),k=k?n:h;this.result=a;r.toggleClass(b.linkStyle,
!!a.detailsUrl);this.clearHideTimeout();d.dom.swapClassesToggle(l,e,f,!1);d.dom.swapClassesToggle(n,e,f,!1);d.dom.swapClassesToggle(h,e,f,!1);this.getChildElement("name").html(a.name);h=a.userRatingWithReviewCount.replace("[]",b.ratingStyle);this.getChildElement("userRating").html(h);l.html(a.price);q.html(a.price);"private"in a&&a.private?d.dom.swapClassesToggle(k,f,e,!1):d.dom.swapClassesToggle(l,f,p,!1);this.displayStarsOrCircles(a,this);d.dom.swapClassesToggle(c,b.hidden,b.displayHidden,!0);e=
a=20;g.y>m(window).height()/2&&(a=-c.height()-35);g.x>.6*m(window).width()&&(e=c.width()-20);c.css({top:Math.floor(g.y+a),left:Math.floor(g.x-e)});d.dom.swapClassesToggle(c,b.hidden,b.displayHidden,!1);d.dom.swapClassesToggle(c,b.displayVisible,b.displayHidden,!0)},handleClose:function(){1>this.options.timeout?this.hide():(this.clearHideTimeout(),this.closeHandler=this.getHideTimeout())},clearHideTimeout:function(){this.closeHandler&&clearTimeout(this.closeHandler)},getHideTimeout:function(){var a=
this.options;return setTimeout(this.hide.bind(this),a.timeout)},hide:function(){var a=this.options;d.dom.swapClassesToggle(this.element,a.displayVisible,a.displayHidden,!1)},displayStarsOrCircles:function(a,b){for(var c=0;5>=c;c++)a.isCircleRating?(d.dom.swapClassesToggle(b.getChildElement("stars"+c),b.options.displayVisible,b.options.displayHidden,!1),d.dom.swapClassesToggle(b.getChildElement("circles"+c),b.options.displayVisible,b.options.displayHidden,c===a.rating)):(d.dom.swapClassesToggle(b.getChildElement("circles"+
c),b.options.displayVisible,b.options.displayHidden,!1),d.dom.swapClassesToggle(b.getChildElement("stars"+c),b.options.displayVisible,b.options.displayHidden,c===a.rating))}})})(window.R9,window.jq||window.jQuery);(function(c,e){c.createComponentClass("base.maps.brands.hotelscombined.MapMarkerInformation","base.maps.MapMarkerInformation",{displayStarsOrCircles:function(d,a){if(d.isShowRating&&d.rating)for(var b=0;5>=b;b++)d.isCircleRating?(c.dom.swapClassesToggle(a.getChildElement("stars"+b),a.options.displayVisible,a.options.displayHidden,!1),c.dom.swapClassesToggle(a.getChildElement("circles"+b),a.options.displayVisible,a.options.displayHidden,b===d.rating)):(c.dom.swapClassesToggle(a.getChildElement("circles"+
b),a.options.displayVisible,a.options.displayHidden,!1),c.dom.swapClassesToggle(a.getChildElement("stars"+b),a.options.displayVisible,a.options.displayHidden,b===d.rating));else for(b=0;5>=b;b++)c.dom.swapClassesToggle(a.getChildElement("stars"+b),a.options.displayVisible,a.options.displayHidden,!1),c.dom.swapClassesToggle(a.getChildElement("circles"+b),a.options.displayVisible,a.options.displayHidden,!1)}})})(window.R9,window.jq||window.jQuery);(function(d,g){d.createComponentClass("base.maps.MapMarkerDetails",{options:{map:"",searchId:"",visible:"",hidden:""},requestPromise:null,init:function(){},addEventHandlers:function(){var b=this,a=b.options;b.subscribe("map.marker.details.show",{id:a.map},b.show.bind(b));b.subscribe("map.marker.details.hide",{id:a.map},b.hide.bind(b));b.getChildElement("close").on("click",function(){b.hide({userEvent:!0});d.events.publish("map.marker.details.close",{id:a.map})});b.subscribe("resultspage.searchId.changed",
function(c){c.searchId&&(b.options.searchId=c.searchId,b.hide(),d.events.publish("map.marker.details.close",{id:a.map}))});b.subscribe("detailspage.searchId.changed",function(c){b.update=!1;c.searchId&&a.searchId!==c.searchId&&(a.searchId=c.searchId)})},show:function(b){var a=this,c=a.options,e=a.element;b=b.resultId;var f=a.getChildElement("details");a.loaderSetVisible(!0);f.hide();d.dom.swapClassesToggle(e,c.visible,c.hidden,!0);e={appendTo:f,replace:!0,data:{closeButton:!1,searchId:c.searchId,
resultId:b,isSeo:d.globals.isSeo},afterScript:function(){a.loaderSetVisible(!1);f.show();a.requestPromise=null}};a.requestPromise&&a.requestPromise.abort();a.requestPromise=d.ajax.execute(c.url,e);a.requestPromise.then(function(b,a){202===a.status&&d.events.publish("results.expired")});d.Analytics.api.trackEvent("map/openDetails")},loaderSetVisible:function(b){var a=this.getChildElement("loader");b?a.show():a.hide()},hide:function(b){var a=this.options,c=this.element;b&&b.userEvent&&d.Analytics.api.trackEvent("map/closeDetails");
d.dom.swapClassesToggle(c,a.visible,a.hidden,!1);this.requestPromise&&this.requestPromise.abort()}})})(window.R9,window.jq||window.jQuery);(function(c,d){c.createComponentClass("base.maps.MapOpener",{options:{searchId:"",fullLayout:!0,updateUrl:!0,scrollTop:!0,mapUrl:"base/maps/Map",updatePath:"base/maps/BaseFullScreenMapSearchUpdate",eventPrefix:"base",includeHeader:!1,visible:"",hidden:"",hotelDetailsPageUrl:""},priceType:null,sortMode:null,ascending:!0,loaded:!1,needsReload:!1,scrollTop:0,xhrMap:null,xhrUpdate:null,isVisible:!1,init:function(){this.mapElement=this.getChildElement("map")},addEventHandlers:function(){var b=this,a=b.options,
e=a.eventPrefix;b.base();b.subscribe(e+".map.toggle",function(a){b.toggleMap(a)});b.getChildElement("closeButton").on("click",function(){c.events.publish(e+".map.toggle",{id:b.id("map")})});b.subscribe(["inlineSearchFormUpdated","results.expired"],function(){b.resetMap()});b.subscribe("resultspage.searchId.changed",function(c){c.searchId&&a.searchId!==c.searchId&&(a.searchId=c.searchId,b.resetMap())});b.subscribe("resultspage.priceType.changed",function(a){a.priceType&&(b.priceType=a.priceType)});
b.answer("map.isVisible."+b.id("map"),function(){return b.isVisible});b.subscribe("resultsHeader.changed",function(a){a&&a.sort&&(b.sortMode=a.sort.sortType,b.ascending=a.sort.ascending);a&&void 0!==a.priceType&&(b.priceType=a.priceType)});var f;d(window).resize(function(){f&&clearTimeout(f);f=setTimeout(function(){b.updateHeight()},10)});c.question.answer("map.height",function(){return b.getMapHeight()})},loadAndShowMap:function(b){var a=this,e=a.options;if(!a.loaded){a.makeMapVisible(b);var d={appendTo:a.mapElement,
replace:!0,data:{id:a.id("map"),searchId:e.searchId,hotelDetailsPageUrl:e.hotelDetailsPageUrl,priceType:a.priceType,sortMode:a.sortMode,ascending:a.ascending},afterScript:function(){a.loaded=!0}};b&&("forceCenter"in b&&(d.data.forceCenter=b.forceCenter),"resultId"in b&&(d.data.selectedResultId=b.resultId));a.xhrMap&&a.xhrMap.abort();a.xhrMap=c.ajax.execute(e.mapUrl,d);a.xhrMap.then(function(b,d){202===d.status&&(a.element.removeClass("visible"),c.events.publish(e.eventPrefix+".map.closed"),a.hideMap(),
a.updateBrowserHistory(!1),c.events.publish("results.expired"))})}},reloadMap:function(b){var a=this,e=a.options,f={searchId:e.searchId};b&&"resultId"in b&&(f.selectedResultId=b.resultId);a.xhrUpdate&&4!==a.xhrUpdate.readyState&&a.xhrUpdate.abort();a.xhrUpdate=c.action.execute(e.updatePath,f,function(b,f,h){202===h.status?c.events.publish("results.expired"):(a.makeMapVisible(b),c.events.publish("map.reload",d.extend(b,{id:a.id("map"),searchId:e.searchId})),a.needsReload=!1)})},toggleMap:function(b){var a=
this.options;this.isVisible?(this.hideMap(),this.updateBrowserHistory(!1),c.Analytics.api.trackEvent("map/close"),c.events.publish(a.eventPrefix+".map.closed")):(this.showMap(b),this.updateBrowserHistory(!0),c.Analytics.api.trackEvent("map/open"),c.events.publish(a.eventPrefix+".map.opened",b))},resetMap:function(){this.isVisible&&this.hideMap();this.loaded&&(this.needsReload=!0)},showMap:function(b){this.isVisible=!0;this.loaded?this.needsReload?this.reloadMap(b):this.makeMapVisible(b):this.loadAndShowMap(b)},
hideMap:function(){var b=this.options.mapTarget,a=this.options,e=this.element;this.isVisible=!1;c.dom.swapClassesToggle(e,a.visible,a.hidden,!1);d(".col-left-rail").height("");a.fullLayout?d(b).addClass("wide").removeClass("mapBody full"):d(b).removeClass("mapBody");a.scrollTop&&d(window).scrollTop(this.scrollTop);c.events.publish("hotels.results.form.updateVisibility",{hidden:!1});c.events.publish("pinnedContent.enable",!0);c.events.publish("pinnedContent.heightChanged")},makeMapVisible:function(b){var a=
this.options.mapTarget,e=this.options,f=e.scrollTop,g=this.element;f&&(this.scrollTop=d(window).scrollTop());e.fullLayout?d(a).removeClass("wide").addClass("mapBody full"):d(a).addClass("mapBody");c.dom.swapClassesToggle(g,e.visible,e.hidden,!0);this.updateHeight();f&&(a=g.offset(),d(window).scrollTop(a.top));c.events.publish("hotels.results.form.updateVisibility",{hidden:!0});c.events.publish("pinnedContent.reset");c.events.publish("pinnedContent.enable",!1);this.loaded&&c.events.publish("map.opened",
d.extend(b,{id:this.id("map")}))},updateHeight:function(){if(this.isVisible){var b=this.getMapHeight();d(".col-left-rail").css({height:b});this.mapElement.css({height:b});c.events.publish("map.update.height",b)}},getMapHeight:function(){var b=this.options,a=d(window).height();b.includeHeader&&(a-=this.getHeaderHeight());return a},getHeaderHeight:function(){var b=c.question.ask("header.height"),a;a=c.question.ask("hotels.results.filtersPinned")?c.question.ask("pinnedContent.placeholderHeight"):c.question.ask("inlineSearch.height");
null==a&&(a=0);null==b&&(b=0);return a+b},updateBrowserHistory:function(b){if(this.options.updateUrl&&void 0!==window.history.replaceState){var a=document.location.pathname.replace(/;map/g,"")+document.location.search.replace(/;map/g,"");b?(b=document.location.pathname.replace(/;map/g,"")+";map"+document.location.search.replace(/;map/g,""),window.history.replaceState({},"",b)):window.history.replaceState({},"",a)}}})})(window.R9,window.jq||window.jQuery);(function(c){c.createComponentClass("hotels.results.brands.hotelscombined.MapPicker",{options:{searchId:"",autoOpenMap:!1,mapEventPrefix:!1},mapEventPrefix:!1,init:function(){(this.mapEventPrefix=this.options.mapEventPrefix)||this.log.error("map is not specified")},inlineComponentsReady:function(){this.options.autoOpenMap&&setTimeout(function(){c.events.publish("hotels.rp.fullScreenMap.toggle")},0)},addEventHandlers:function(){var b=this;b.subscribe(["bing.map.opened","mapbox.map.opened","google.map.opened",
"naver.map.opened"],function(a){c.events.publish("hotels.rp.fullScreenMap.opened",a)});b.subscribe(["bing.map.closed","mapbox.map.closed","google.map.closed","naver.map.closed"],function(a){c.events.publish("hotels.rp.fullScreenMap.closed",a)});b.subscribe("results.expired",function(a){c.events.publish("hotels.rp.fullScreenMap.closed",a)});b.subscribe("hotels.rp.fullScreenMap.toggle",function(a){c.events.publish(b.mapEventPrefix+".map.toggle",a)});b.subscribe("search.poll.response",function(a){a&&
"string"in a&&(b.mapEventPrefix=a.mapEventPrefix)})}})})(window.R9);(function(b,c){b.createWidgetClass("loader.AriaLoadMessage",{options:{message:""},init:function(){this.message=this.getChildElement("message")},deactivateLoadMessage:function(a){this.message.text(a);this.message.attr("aria-label",a)},activateLoadMessage:function(a){"undefined"!==typeof a?this.message.text(a):this.message.text(this.options.message);"undefined"!==typeof a?this.message.attr("aria-label",a):this.message.attr("aria-label",this.options.message)}})})(R9,jQuery);(function(f,g){f.createComponentClass("hotels.results.RegionCardsSlim",{cardTemplateId:"hotelRegionCard",titleTemplateId:"hotelRegionTitle",tagTemplateId:"cityFilterTag",cardsContainer:null,titleContainer:null,tagsContainer:null,countsEl:null,titleRendered:!1,userClosed:!1,renderedCards:null,renderedTags:null,arrows:null,prevButton:null,nextButton:null,options:{isNewRegionFlowEnabled:!1,cardWidth:242,upperCaseFilterTag:!0},init:function(){this.renderedCards={};this.renderedTags={};this.cardsContainer=
this.getChildElement("cards");this.titleContainer=this.getChildElement("title");this.tagsContainer=this.getChildElement("tags");this.arrows=this.getChildElement("arrows");this.prevButton=this.getChildElement("prev");this.nextButton=this.getChildElement("next")},addEventHandlers:function(){var a=this,b=this.options.isNewRegionFlowEnabled?2:f.config.getInt("ui.hrp.filters.regions.minDisplay",3);this.subscribe("resultspage.cleanup",this.cleanup.bind(this));this.subscribe("resultspage.filtersData.changed",
function(c){f.events.publish("resultspage.isRegionSearch",{isRegionSearch:c.hasOwnProperty("regions")});c.hasOwnProperty("regions")&&c.regions.valueMap&&Object.keys(c.regions.valueMap).length>=b&&(a.update(c.regions),3>=Object.keys(c.regions.valueMap).length?(a.arrows.hide(),a.cardsContainer.removeClass("gte5")):(a.cardsContainer.addClass("gte5"),a.arrows.show(),a.addPageTurnHandlers()))})},update:function(a){var b=a.topCtids,c=Object.keys(a.valueMap).length;this.element.hasClass("hidden")&&(this.element.removeClass("hidden"),
this.userClosed&&(this.element.slideDown(),this.userClosed=!1));this.titleRendered||!a.shortName||this.options.isNewRegionFlowEnabled?this.titleRendered&&(this.titleContainer.find(5>c?".gte5":".lt5").hide(),this.titleContainer.find(5<=c?".gte5":".lt5").show(),this.titleContainer.find("span.count").text(c),a.shortName&&this.titleContainer.find("span.name").text(a.shortName)):(this.titleContainer.html(f.template.renderElement(this.titleTemplateId,{count:c,name:a.shortName})),this.titleContainer.find(5>
c?".gte5":".lt5").hide(),this.titleContainer.find(5<=c?".gte5":".lt5").show(),this.titleRendered=!0);for(c=0;c<b.length;c++){var d=c;4<b.length&&(d=((c-1)%b.length+b.length)%b.length);var e=b[d];if(d=this.prepareRegionData(e,a,d))this.renderedCards.hasOwnProperty(e)?this.updateExistingCard(d):(this.addNewCard(d),this.addFilterTag(e,a.valueMap[e].displayValue))}this.updateCardSelection(a.valueMap)},addPageTurnHandlers:function(){this.nextButton.off("click").on("click",this.scrollCarousel.bind(this,
!0));this.prevButton.off("click").on("click",this.scrollCarousel.bind(this,!1))},scrollCarousel:function(a){var b=this,c=(a?"-":"")+this.options.cardWidth;this.cardsContainer.addClass("animating").css("transform","translateX("+c+"px)");this.nextButton.off("click");this.prevButton.off("click");setTimeout(function(){b.addPageTurnHandlers();b.cardsContainer.removeClass("animating").css("transform","translateX(0)");a?b.cardsContainer.append(g(".col-card",b.cardsContainer).first()):b.cardsContainer.prepend(g(".col-card",
b.cardsContainer).last())},500)},prepareRegionData:function(a,b,c){return b.valueMap[a]?{id:this.id(a),ctid:a,url:b.coverPhotos[a],displayOrder:c,popular:0===c,minPrice:b.valueMap[a].minPrice,selected:1===b.valueMap[a].selected,title:b.valueMap[a].displayValue,subtitle:b.ctidCountry?b.ctidCountry[a]:""}:null},addNewCard:function(a){var b=this,c=f.template.renderElement(this.cardTemplateId,a);c.data("ctid",a.ctid);c.click(function(){b.pushRegionFilterUpdate(a.ctid)});a.selected&&c.addClass("chosen");
(a.call||a.info||!a.minPrice.match(/\d/g))&&c.addClass("no-price");this.renderedCards[a.ctid]=c;this.cardsContainer.append(c)},pushRegionFilterUpdate:function(a){f.events.publish("filters.regions.togglecity",a);this.renderedCards[a].toggleClass("chosen");a=this.renderedTags[a];a.hasClass("hidden")?this.showFilterTag(a):a.addClass("hidden")},updateCardSelection:function(a){var b=this;Object.keys(a).forEach(function(c){var d=b.renderedCards[c],e=b.renderedTags[c];d&&e&&(1===a[c].selected?(d.addClass("chosen"),
e.hasClass("hidden")&&b.showFilterTag(e)):(d.removeClass("chosen"),e.addClass("hidden")))})},showFilterTag:function(a){this.tagsContainer.append(a);a.removeClass("hidden")},addFilterTag:function(a,b){var c=this;b=f.template.renderElement(this.tagTemplateId,{name:c.options.upperCaseFilterTag?b.toUpperCase():b});this.tagsContainer.append(b);b.addClass("hidden");b.find(".close").click(function(){c.pushRegionFilterUpdate(a)});this.renderedTags[a]=b},updateExistingCard:function(a){var b=this.renderedCards[a.ctid];
a.selected&&!b.hasClass("chosen")&&b.addClass("chosen")},cleanup:function(){this.cardsContainer.empty();this.titleContainer.empty();this.tagsContainer.empty();this.titleRendered=!1;this.renderedCards={};this.renderedTags={};this.element.addClass("hidden")}})})(R9,jQuery);(function(c){c.createComponentClass("common.results.TaxesIncludedWarning",{options:{priceType:null},init:function(){this.toggleVisibility(this.options.priceType)},addEventHandlers:function(){var a=this;this.subscribe("resultsHeader.changed",function(b){b.priceType&&a.toggleVisibility(b.priceType)})},toggleVisibility:function(a){a&&"daybase"!==a?this.element.show():this.element.hide()}})})(R9);(function(e,d){e.createComponentClass("hotels.results.filters.brands.hotelscombined.HotelRangeFilter","common.results.filters.Filter",{distanceText:null,messageBtn:null,content:null,contentVisible:!1,distance:void 0,options:{changeText:void 0,closeText:void 0,searchId:void 0,visible:!0,cityOnly:!1,latitude:void 0,longitude:void 0,locationType:void 0,locationId:void 0,name:"location",defaultValue:void 0},init:function(){var a=this.options;this.base();this.distance=a.defaultValue;this.distanceText=
this.getChildElement("distanceText");this.messageBtn=this.getChildElement("messageBtn");this.content=this.getChildElement("content")},addEventHandlers:function(){var a=this,c=a.options;a.base();a.subscribe("resultspage.searchId.changed",function(b){b&&b.searchId&&b.searchId!==c.searchId&&(e.ajax.execute("hotels/results/filters/brands/hotelscombined/HotelRangeFilter",{data:{id:a.id(),searchId:b.searchId},replace:!0}),a.destroy())});a.subscribe("resultspage.check.radius",function(b){c.searchId&&c.visible&&
b&&void 0!==b.defaultRadius&&(a.distance=b.defaultRadius,(0<b.defaultRadius||b.defaultRadius!==b.availabilityRadius)&&a.swapClasses(a.element,"Filter--hidden","Filter--visible"))});a.subscribe("resultspage.cleanup",function(){a.swapClasses(a.element,"Filter--visible","Filter--hidden");c.searchId=null});a.messageBtn.on("click",function(){a.swapClasses(a.messageBtn,"","Link--Selected");a.toggleContent()});a.element.find(".js-option").click(function(a){a.preventDefault();this.swapClasses(this.element.find(".js-option"),
"Link--Selected","Link");this.swapClasses(d(a.target),"Link","Link--Selected");this.distanceText.text(a.target.text);this.distance=d(a.target).data("distance");this.applyFilter()}.bind(this))},toggleContent:function(){this.contentVisible?this.hideContent():this.showContent()},hideContent:function(){this.contentVisible&&(this.messageBtn.text(this.options.changeText),this.swapClasses(this.content,"Content--Visible","Content--Hidden"),this.contentVisible=!1)},showContent:function(){this.contentVisible||
(this.messageBtn.text(this.options.closeText),this.swapClasses(this.content,"Content--Hidden","Content--Visible"),this.contentVisible=!0)},applyFilter:function(){var a=this.getState(),a=d.extend({name:this.options.name,state:a},{elemId:this.id()});e.events.publish("filters.changed",a)},getState:function(){return{lmLat:"%s".format(this.options.latitude),lmLong:"%s".format(this.options.longitude),distance:"%s".format(this.distance),lmId:this.options.locationId,lmType:this.options.locationType,cityOnly:this.options.cityOnly}},
update:function(a){if(this.options.visible&&a.hasOwnProperty("distance")){var c=parseFloat(0===a.distance%1?"%s.0".format(a.distance):a.distance);a=this.element.find(".js-option");for(var b=null,f=0;f<a.length;f++){var e=a[f].getAttribute("data-distance");if(parseFloat(e)===c){b=a[f].getAttribute("data-display");this.swapClasses(d(a),"Link--Selected","Link");this.swapClasses(d(a[f]),"Link","Link--Selected");break}}b?this.distanceText.text(b):(c=a[0],this.distanceText.text(c.getAttribute("data-display")),
this.swapClasses(d(a),"Link--Selected","Link"),this.swapClasses(d(c),"Link","Link--Selected"))}}})})(R9,jQuery);function _slicedToArray(d,e){return _arrayWithHoles(d)||_iterableToArrayLimit(d,e)||_nonIterableRest()}function _nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance");}
function _iterableToArrayLimit(d,e){if(Symbol.iterator in Object(d)||"[object Arguments]"===Object.prototype.toString.call(d)){var a=[],b=!0,c=!1,g=void 0;try{for(var f=d[Symbol.iterator](),h;!(b=(h=f.next()).done)&&(a.push(h.value),!e||a.length!==e);b=!0);}catch(k){c=!0,g=k}finally{try{if(!b&&null!=f["return"])f["return"]()}finally{if(c)throw g;}}return a}}function _arrayWithHoles(d){if(Array.isArray(d))return d}
(function(d,e){d.createComponentClass("common.results.SortDropdown",{sortDropdownWidget:null,placeholderOption:[],unrolledOptions:null,unrolledDropdowns:null,dropdownWidgetType:"dropdown",useDropdownPlaceholderOption:!1,trackInteractions:!1,options:{activeSortType:"rank_a",isSortUnrolled:!1,hasDropdown:!1,hasDropdownSortText:!1,useSelectWidget:!1,styleJamSelect:!1},init:function(){this.options.hasDropdown&&(this.options.styleJamSelect?this.setupStyleJamSelect():this.setupDropdownWidget());this.options.useSelectWidget&&
this.setupSelectWidget();this.options.isSortUnrolled&&this.setupUnrolledOptions();this.options.hasDropdown&&this.options.isSortUnrolled&&(this.options.useSelectWidget||(this.placeholderOption=e(this.sortDropdownWidget.element.find('option[value\x3d""]'))),this.useDropdownPlaceholderOption=!0,this.updatePlaceholderOption())},addEventHandlers:function(){var a=this;this.options.isSortUnrolled&&this.unrolledOptions.click(function(b){a.setSortMode(e(b.currentTarget).attr("data-sort"))});this.subscribe(["resultsHeader.sortType.set",
"resultspage.sortMode.changed"],this.handleSortModeChange.bind(this));this.trackInteractions&&(this.subscribe(["Select.close","Select.closed","Widgets.DropdownDialog.closed"],function(b){b.id===a.id("sorting")&&a.trackToggleAction(!1)}),this.subscribe(["Select.open","Select.opened","Widgets.DropdownDialog.opened"],function(b){b.id===a.id("sorting")&&a.trackToggleAction(!0)}))},trackToggleAction:function(a){d.VestigoEvents&&d.VestigoEvents.sortresults.sort(a?d.VestigoType.Expandable.expand:d.VestigoType.Expandable.collapse)},
setupDropdownWidget:function(){var a=this;this.dropdownWidgetType=this.options.useSelectWidget?"r9Select":this.dropdownWidgetType;(this.sortDropdownWidget=this.getChildElement("sorting")[this.dropdownWidgetType]({change:function(b){return b&&a.setSortMode()}}).getWidget())||this.log.console("SortDropdownWidget is undefined, but hasDropdown is set to true in sortDropdown's velocity template.")},setupStyleJamSelect:function(){var a=this;this.sortDropdownWidget=this.getChildElement("sorting").getWidget();
this.sortDropdownWidget.setOption("change",function(b){return a.setSortMode()})},setupSelectWidget:function(){this.options.isSortUnrolled&&(this.placeholderOption=e(this.sortDropdownWidget.dropdownOptions[0]).detach())},setupUnrolledOptions:function(){this.unrolledOptions=this.getChildElement("sortUnrolled").find("a.sortOption");this.unrolledDropdowns=this.getChildElement("sortUnrolled").find("a.sortDropdown")},setSortMode:function(){var a=0<arguments.length&&void 0!==arguments[0]?arguments[0]:this.sortDropdownWidget&&
this.sortDropdownWidget.getValue(),a=e.extend({},1<arguments.length&&void 0!==arguments[1]?arguments[1]:{},{sortCode:a});d.events.publish("resultsHeader.sortType.set",a)},handleSortModeChange:function(a){a.sortCode&&(this.setSelectedDropdownOption(a.sortCode),this.setSelectedUnrolled(a.sortCode),this.updatePlaceholderOption())},setSelectedDropdownOption:function(a){if(this.options.hasDropdown){var b=this.findDropdownSortElement(a),c=b&&0<b.length;c&&(this.sortDropdownWidget.setValue(a),this.sortDropdownWidget.setText(b.attr("title")));
this.sortDropdownWidget.element.toggleClass("selected",c).attr("aria-selected",c)}},setSelectedUnrolled:function(a){var b=this;if(this.options.isSortUnrolled){var c=this.unrolledOptions.add(this.unrolledDropdowns);c.each(function(a,c){return b.resetUnrolledOption(c)});var d=a.split("_")[0],c=c.filter("[data-sort*\x3d".concat(d,"]"));a=this.flipSortCodeDirection(a);c.addClass("selected").attr("aria-selected",!0);c.attr("data-sort",a)}},resetUnrolledOption:function(a){e(a).removeClass("selected").attr("aria-selected",
!1);var b=e(a).attr("data-default-sort");b&&e(a).attr("data-sort",b)},flipSortCodeDirection:function(a){var b=a.split("_"),c=_slicedToArray(b,2),b=c[0];return(c=c[1])?(a="a"===c?"b":"a","".concat(b,"_").concat(a)):a},updatePlaceholderOption:function(){if(this.useDropdownPlaceholderOption){var a=this.placeholderOption.text();this.element.find(".sortOption.selected").length?(this.sortDropdownWidget.setText(a),this.sortDropdownWidget.setValue(this.placeholderOption.val(),!1),this.sortDropdownWidget.element.removeClass("selected").attr("aria-selected",
!1)):(this.placeholderOption.removeAttr("selected").attr("aria-selected",!1),this.sortDropdownWidget.element.addClass("selected").attr("aria-selected",!0));this.placeholderOption({disabled:"disabled","aria-disabled":!0,hidden:"hidden","aria-hidden":!0})}},findDropdownSortElement:function(a){return this.options.useSelectWidget?this.sortDropdownWidget.dropdownOptions.filter(function(b,c){return e(c).attr("data-value")===a}):this.options.styleJamSelect?this.sortDropdownWidget.getSelectedItem(a):this.element.find("option[value\x3d"+
a+"]")}})})(window.R9,window.jq||window.jQuery);(function(d,c){d.createComponentClass("hotels.results.HotelSortDropdown","common.results.SortDropdown",{reviewDropdownWidget:null,dropdownDialogList:null,currentSelectedItem:null,dropdownWidgetType:"dropdownDialog",hasSearchLocationChanged:!1,options:{defaultActiveSort:null,hasDropdownSortText:!1,sortStyleLikeQuicklinks:!1,styleJamSelect:!1,msg:{defaultActiveSort:"",defaultActiveSortTitle:""}},init:function(){var a=this;this.options.hasDropdown&&this.options.sortStyleLikeQuicklinks&&!this.options.styleJamSelect?
(this.sortDropdownWidget=this.getChildElement("sorting").dropdownDialog({}).getWidget(),this.dropdownDialogList=this.getChildElement("dropdownDialogList"),this.dropdownDialogList.on("click","a.option",function(b){a.onDropdownDialogChange(c(b.currentTarget).attr("data-sort"))}),this.sortDropdownWidget.element.find(".label").attr("data-title",this.options.msg.defaultActiveSortTitle),this.currentSelectedItem=this.dropdownDialogList.find("a[data-sort\x3d'"+this.options.defaultActiveSort+"']"),null!=this.currentSelectedItem&&
(this.currentSelectedItem.addClass("hidden"),this.currentSelectedItem.attr({"aria-hidden":!0,"aria-selected":!0})),this.updateSortTextTitle()):this.base();this.options.isSortUnrolled&&(this.reviewDropdownWidget=this.getChildElement("review").dropdown({change:function(b){return b&&a.onReviewSortChange()}}).getWidget());this.trackInteractions=d.config.getBoolean("ui.horizon.common.results.SortDropdown.track.enabled",!0)},addEventHandlers:function(){var a=this;this.base();this.subscribe("resultspage.searchId.changed",
function(){a.options.hasDropdown&&null!==a.options.defaultActiveSort&&(a.options.sortStyleLikeQuicklinks?a.sortDropdownWidget.updateLabel(a.options.msg.defaultActiveSort):a.sortDropdownWidget.setValue(a.options.defaultActiveSort,!1));a.updateSortTextTitle()});this.options.hasDropdown&&this.options.styleJamSelect&&(this.subscribe("resultspage.sortMode.changed",function(b){a.sortDropdownWidget.setValue(b.sortCode,!1);a.updateSortTextTitle()}),this.subscribe("hotels.frontdoor.form.location",function(){a.hasSearchLocationChanged=
!0}),this.subscribe("resultsHeader.changed",function(){a.hasSearchLocationChanged&&(a.hasSearchLocationChanged=!1,a.sortDropdownWidget.setValue(a.options.msg.defaultActiveSort,!1),a.updateSortTextTitle())}))},handleSortModeChange:function(a){this.base(a);a.sortCode&&null!=this.reviewDropdownWidget&&-1<a.sortCode.indexOf("userrating")&&this.options.isSortUnrolled&&this.unrolledOptions.hasClass("selected")&&(a=this.unrolledOptions.first().find("select option"),this.reviewDropdownWidget.setValue(a,!1))},
onDropdownDialogChange:function(a){"undefined"!==typeof a&&(this.setSortMode(a,1<arguments.length&&void 0!==arguments[1]?arguments[1]:{}),this.sortDropdownWidget.isOpen&&this.sortDropdownWidget.close())},onReviewSortChange:function(){var a={reviewType:this.reviewDropdownWidget.getValue()};this.setSortMode("userrating",a)},setSelectedDropdownOption:function(a){if(this.options.hasDropdown&&!this.options.styleJamSelect){var b=this.sortDropdownWidget.element.find(".label");this.resetSelected();this.currentSelectedItem=
this.getDropdownElementFromSort(a);this.currentSelectedItem.addClass("hidden");this.currentSelectedItem.attr({"aria-hidden":!0,"aria-selected":!0});this.sortDropdownWidget.updateLabel(this.currentSelectedItem.text());b.attr("data-sort",a);b.attr("data-title",this.currentSelectedItem.data("title"))}},resetSelected:function(){var a=this.sortDropdownWidget.element.find(".label");null!=this.currentSelectedItem&&(c(this.currentSelectedItem).removeClass("hidden").attr({"aria-hidden":!1,"aria-selected":!1}),
this.currentSelectedItem=null);this.sortDropdownWidget.updateLabel(this.options.msg.defaultActiveSortTitle);a.attr("data-sort","");a.attr("data-title","")},getDropdownElementFromSort:function(a){var b=this.dropdownDialogList.find("a[data-sort\x3d'".concat(a,"']"));b.length||(a=a.split("_")[0],this.currentSelectedItem=this.dropdownDialogList.find("a[data-sort*\x3d'".concat(a,"']")));return b},updateSortTextTitle:function(){if(this.options.hasDropdownSortText&&this.options.sortStyleLikeQuicklinks){var a=
this.sortDropdownWidget.label;""!==c(a).data("title")&&this.sortDropdownWidget.updateLabel(c(a).text())}else this.base()}})})(window.R9,window.jq||window.jQuery);(function(c){c.createComponentClass("hotels.results.brands.hotelscombined.HotelSortDropdown",{price:null,rank:null,stars:null,userrating:null,currentSearch:null,options:{priceToHighMsg:void 0,priceToLowhMsg:void 0,priceMsg:void 0,starsMsg:void 0,starsToHighMsg:void 0,starsToLowhMsg:void 0},removeSelected:function(){var a=this.dropdownDialogList.find(".js-selected");a.removeClass("js-selected");this.swapClasses(a,"selected","")},setSelected:function(a){a=this[a.sortType];a.addClass("js-selected");
this.swapClasses(a,"","selected")},setSelectedIcon:function(a,b){if(b){var d=this.getSortStringFromData(b);this.swapClasses(this[b.sortType],d+"--selected",d)}"price"===a.sortType?this.currentSearch.ascending?(this.swapClasses(this.price,"price_b--selected","price_a--selected"),this.swapClasses(this.price,"price_b","price_a--selected"),this.swapClasses(this.price,"price_a","price_a--selected"),this.price.text(c.Common.Utils.String.formatString(this.options.priceToLowhMsg))):(this.swapClasses(this.price,
"price_a--selected","price_b--selected"),this.swapClasses(this.price,"price_a","price_b--selected"),this.swapClasses(this.price,"price_b","price_b--selected"),this.price.text(c.Common.Utils.String.formatString(this.options.priceToHighMsg))):this.price.text(c.Common.Utils.String.formatString(this.options.priceMsg));"stars"===a.sortType?(this.swapClasses(this.stars,"stars_b","stars_b--selected"),this.swapClasses(this.stars,"stars_a","stars_a--selected"),this.currentSearch.ascending?(this.stars.text(c.Common.Utils.String.formatString(this.options.starsToHighMsg)),
this.swapClasses(this.stars,"stars_b--selected","stars_a--selected")):(this.stars.text(c.Common.Utils.String.formatString(this.options.starsToLowhMsg)),this.swapClasses(this.stars,"stars_a--selected","stars_b--selected"))):this.stars.text(c.Common.Utils.String.formatString(this.options.starsMsg));"rank"===a.sortType&&(this.swapClasses(this.rank,"rank_a","rank_b--selected"),this.swapClasses(this.rank,"rank_b","rank_b--selected"));"userrating"===a.sortType&&(this.swapClasses(this.userrating,"userrating_a",
"userrating_b--selected"),this.swapClasses(this.userrating,"userrating_b","userrating_b--selected"));"distance"===a.sortType&&(this.swapClasses(this.distance,"distance_a","distance_a--selected"),this.swapClasses(this.distance,"distance_b","distance_a--selected"))},updateSearch:function(a){c.events.publish("resultsHeader.changed",{sortCode:this.getSortStringFromData(a),sort:a})},updateFilters:function(a){var b=this.currentSearch;this.currentSearch=a;this.setSelectedIcon(a,b);this.removeSelected();
this.setSelected(a)},init:function(){this.base();var a=this;this.dropdownDialogList=this.getChildElement("sortUnrolled");this.userrating=this.getChildElement("userrating_a")[0]?this.getChildElement("userrating_a"):this.getChildElement("userrating_b");this.rank=this.getChildElement("rank_a")[0]?this.getChildElement("rank_a"):this.getChildElement("rank_b");this.price=this.getChildElement("price_a")[0]?this.getChildElement("price_a"):this.getChildElement("price_b");this.stars=this.getChildElement("stars_a")[0]?
this.getChildElement("stars_a"):this.getChildElement("stars_b");this.distance=this.getChildElement("distance_a")[0]?this.getChildElement("distance_a"):this.getChildElement("distance_b");this.dropdownDialogList.on("click",function(b){b.target&&b.target.dataset&&b.target.dataset.sort&&(b=a.getSortDataFromString(b.target.dataset.sort),"price"!==b.sortType&&"stars"!==b.sortType||!a.currentSearch||a.currentSearch.ascending!=b.ascending||a.currentSearch.sortType!=b.sortType||(b.ascending=!a.currentSearch.ascending),
a.updateFilters(b),a.updateSearch(b))})},getSortStringFromData:function(a){return a.sortType+"_"+(a.ascending?"a":"b")},getSortDataFromString:function(a){a=a.split("_");var b=a[1];return{sortType:a[0],ascending:b?"a"==b:null}},addEventHandlers:function(){this.base();var a=this;this.subscribe("resultspage.sortMode.changed",function(b){a.updateFilters(a.getSortDataFromString(b.sortCode))});c.question.answer("resultsHeader.sortMode",function(){return a.currentSearch})}})})(window.R9);(function(a,b){a.createComponentClass("hotels.common.brands.hotelscombined.SecretDealsBanner",{closeBtn:null,init:function(){a.storage.get("secretdeals.description.hide")&&this.swapClasses(this.element,"Banner--Visible","Banner--Hidden");a.storage.set("secretdeals.description.hide",!0);this.closeBtn=this.getChildElement("close")},addEventHandlers:function(){var a=this;this.closeBtn.on("click",function(){a.swapClasses(a.element,"Banner--Visible","Banner--Hidden")})}})})(R9,jQuery);(function(b){b.createComponentClass("base.results.SimpleHeader",{counts:null,options:{loaderEnabled:!1},init:function(){this.counts=this.getChildElement("counts");this.loadingMessage=this.getChildElement("loadingMessage")},addEventHandlers:function(){var a=this;this.subscribe("displayCounts.newData",function(c){a.getChildElement("count").html(c.data);a.getChildElement("count").find("a").on("click",function(){b.events.publish("filters.reset",{type:"showAll"})})})},updateCountsDisplay:function(a){a&&
(a.hidden?this.swapClasses(this.counts,"ResultsHeader__Count--hidden","ResultsHeader__Count--visible"):this.swapClasses(this.counts,"ResultsHeader__Count--visible","ResultsHeader__Count--hidden"))},updateCountsDisplayWithMessage:function(a){a&&(a.searching?this.swapClasses(this.loadingMessage,"ResultsHeader__LoadingMessage--hidden","ResultsHeader__LoadingMessage--visible"):this.swapClasses(this.loadingMessage,"ResultsHeader__LoadingMessage--visible","ResultsHeader__LoadingMessage--hidden"))}})})(R9);(function(c){c.createComponentClass("hotels.results.brands.hotelscombined.HotelSimpleHeader","base.results.SimpleHeader",{options:{adultsPart:void 0,childrenPart:void 0,roomsPart:void 0,durationPart:void 0,totalsPart:void 0,totals:0,adults:0,children:0,rooms:0,checkInDate:"",checkOutDate:"",location:"",thousandsSeparator:"",checkInDateFormat:"DD MMM",checkOutDateFormat:"DD MMM",popularSortDescription:void 0,cheapestSortDescription:void 0,showSortingDescriptions:!1},searchButton:null,searchForm:null,
queryMessage:null,searchLocation:null,properties:null,openMapButton:null,description:null,descriptionText:null,descriptionType:void 0,init:function(){var a=this.options;this.base();this.searchButton=this.getChildElement("showSearchForm");this.searchForm=this.getChildElement("searchForm");this.queryMessage=this.getChildElement("queryMessage");this.searchLocation=this.getChildElement("SearchLocation");this.properties=this.getChildElement("Properties");this.openMapButton=this.getChildElement("openMapButton");
this.updateQueryMessage(a);(a=c.question.ask("hotels.breadcrumbs.destination"))&&this.searchLocation.text(a);this.description=this.getChildElement("description-box");this.descriptionText=this.getChildElement("description-text")},addEventHandlers:function(){var a=this;a.base();a.subscribe(["search.startSearch","resultspage.cleanup"],function(){a.swapClasses(a.openMapButton,"shown","hidden")});a.subscribe("resultspage.streaming.firstResults",function(){a.swapClasses(a.openMapButton,"hidden","shown")});
c.events.subscribe("search.poll.response",a.updateLocationMessage.bind(a));c.events.subscribe("searchform.submit",a.updateQueryMessage.bind(a));c.events.subscribe("hideHtcResultForm",function(){a.swapClasses(a.searchForm,"visible","hidden")});c.events.subscribe("hotels.breadcrumbs.destinationChange",function(b){a.searchLocation.text(b)});a.searchButton.on("click",function(){a.swapClasses(a.searchForm,"hidden","visible")});a.openMapButton.on("click",function(){c.events.publish("simpleHeader.fullScreenMap.open",
{includeHeader:!0})});a.options.showSortingDescriptions&&a.subscribe("resultspage.sortMode.changed",function(b){a.showDescriptionIfNeeded(a.getSortDataFromString(b.sortCode))})},showDescriptionIfNeeded:function(a){"rank"===a.sortType?"rank"!==this.descriptionType&&(this.descriptionType="rank",this.swapClasses(this.description,"Description--Hidden","Description--Visible"),this.descriptionText[0].innerHTML=this.options.popularSortDescription):"price"===a.sortType&&a.ascending?"price"!==this.descriptionType&&
(this.descriptionType="price",this.swapClasses(this.description,"Description--Hidden","Description--Visible"),this.descriptionText[0].innerHTML=this.options.cheapestSortDescription):this.description.is(":visible")&&(this.descriptionType=void 0,this.swapClasses(this.description,"Description--Visible","Description--Hidden"))},getSortDataFromString:function(a){a=a.split("_");var b=a[1];return{sortType:a[0],ascending:b?"a"==b:null}},generateQueryMessage:function(a){var b=this.options,d=(new Date(a.checkOutDate)-
new Date(a.checkInDate))/864E5,e=moment(a.checkInDate),f=moment(a.checkOutDate);return c.Common.Utils.String.formatChoice(b.durationPart,d,d)+" ("+e.format(b.checkInDateFormat)+" - "+f.format(b.checkOutDateFormat)+") "+c.Common.Utils.String.formatChoice(b.adultsPart,a.adults,a.adults)+" "+c.Common.Utils.String.formatChoice(b.childrenPart,a.children,a.children)+" "+c.Common.Utils.String.formatChoice(b.roomsPart,a.rooms,a.rooms)},updateQueryMessage:function(a){var b=this.options;b.location=a.location;
this.queryMessage.text(this.generateQueryMessage(a));this.searchLocation.text(b.location)},updateLocationMessage:function(a){var b=this.options;if(a&&a.filteredCount&&"0"!==a){var d=c.Common.Utils.formatThousandsSeparator(a.filteredCount);this.properties.text(0===a.filteredCount?"":c.Common.Utils.String.formatChoice(b.totalsPart,d,d))}}})})(window.R9);function _slicedToArray(b,c){return _arrayWithHoles(b)||_iterableToArrayLimit(b,c)||_nonIterableRest()}function _nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance");}
function _iterableToArrayLimit(b,c){if(Symbol.iterator in Object(b)||"[object Arguments]"===Object.prototype.toString.call(b)){var a=[],d=!0,g=!1,e=void 0;try{for(var f=b[Symbol.iterator](),h;!(d=(h=f.next()).done)&&(a.push(h.value),!c||a.length!==c);d=!0);}catch(k){g=!0,e=k}finally{try{if(!d&&null!=f["return"])f["return"]()}finally{if(g)throw e;}}return a}}function _arrayWithHoles(b){if(Array.isArray(b))return b}
(function(b,c){b.createComponentClass("base.results.ResultsListHeader",{searchId:null,activeSortMode:{sortType:null,ascending:null},overriddenSortMode:null,trackInteractions:b.config.getBoolean("ui.horizon.base.results.ResultsListHeader.track.enabled",!0),options:{sortType:"rank_a",sortUnrolled:!1,quickLinkSort:!1},init:function(){var a=this;this.activeSortMode=this.getSortDataFromString(this.options.sortType);this.answer("resultsHeader.sortMode",function(){return a.activeSortMode})},addEventHandlers:function(){var a=
this;this.subscribe("resultsHeader.changed",function(b){return a.onChange(b)});this.subscribe("resultspage.sortMode.changed",function(b){return a.onChange(b)});this.subscribe("resultsHeader.sortType.set",this.setSortType.bind(this));this.subscribe("resultsHeader.sortType.force",this.forceSortType.bind(this));this.subscribe("resultsHeader.sortType.resetForced",this.resetForcedSortType.bind(this))},onChange:function(a){a.sort?this.activeSortMode=a.sort:a.sortCode&&(this.activeSortMode=this.getSortDataFromString(a.sortCode))},
setSortType:function(a){(a=this.processSortParams(a))&&(a.sortCode!==this.getStringFromSortData(this.activeSortMode)||a.reviewType||a.forceChange)&&(a.isForcedSort||(this.overriddenSortMode=null),a.silent||this.pushSortUpdates(a))},processSortParams:function(){var a=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{};if(a.reviewType)a.sortCode="userrating";else if(!a.sortCode)return this.log.console('missing data sent in "resultsHeader.sortType.set" event.\n                Please publish an object with at least a sortCode or a reviewType property.'),
null;a.sort=this.getSortDataFromString(a.sortCode);"customTicket"===a.sort.sortType&&(a.customTicket=!0);return a},pushSortUpdates:function(a){this.logSortTypeChange(a);b.events.publish("resultsHeader.changed",a)},forceSortType:function(a){if(this.getStringFromSortData(this.activeSortMode)!==a.sortCode){var d=this.activeSortMode;a=c.extend({},a,{isForcedSort:!0});b.events.publish("resultsHeader.sortType.set",a);this.overriddenSortMode=d}},resetForcedSortType:function(){if(this.overriddenSortMode){var a=
{sortCode:this.getStringFromSortData(this.overriddenSortMode)};b.events.publish("resultsHeader.sortType.set",a)}},getSortDataFromString:function(a){a=a.split("_");a=_slicedToArray(a,2);var b=a[1];return{sortType:a[0],ascending:b?"a"===b:null}},getStringFromSortData:function(a){var b=a.sortType;a=a.ascending;return"undefined"===typeof a||null===a?b:"".concat(b,"_").concat(a?"a":"b")},logSortTypeChange:function(a){a.sort&&a.sort.sortType&&(this.trackInteractions&&this.trackSortBy(a.sort.sortType,a.sort.ascending),
a.sort.ascending&&b.Analytics.api.trackEvent({category:"Sort",action:a.sort.sortType,label:this.generateSortLoggingLabel(a.sort.sortType,a.sort.ascending)}))},generateSortLoggingLabel:function(a,b){return"".concat(a,"_").concat(b?"ascending":"descending")},trackSortBy:function(a,d){if(b.VestigoEvents){var c=d?b.VestigoType.Sortable.asc:b.VestigoType.Sortable.desc,e=b.VestigoEvents.sortresults;switch(a){case "price":e.price(c);break;case "distance":e.distance(c);break;case "recommended":case "rank":d&&
e.recommended()}}}})})(window.R9,window.jq||window.jQuery);(function(c,f){c.createComponentClass("hotels.results.HotelResultsListHeader","base.results.ResultsListHeader",{roomDisclaimer:null,mainHeader:null,filterState:null,providerLangHeader:null,options:{showLangHeader:!1,roomDisclaimers:{nightly:null,total:null}},init:function(){this.base();this.providerLangHeader=this.getChildElement("providerLangHeader");this.filterState={};this.roomDisclaimer=this.getChildElement("disclaimer")},addEventHandlers:function(){var a=this;this.base();this.subscribe("searchform.submit",
this.onSearchSubmit.bind(this));this.options.showLangHeader&&(this.subscribe("resultspage.streaming.done",this.setProviderLangHeaderOnInit.bind(this)),this.subscribe("filters.changed",this.setProviderLangHeaderOnFilters.bind(this)));this.subscribe("filters.reset",this.setSortType.bind(this,{sortCode:this.options.sortType}));this.subscribe("resultsHeader.changeVisibility",function(b){return a.element.toggleClass("Hidden",!b)});this.subscribe("results.mapToggle.syncState",this.onMapViewChange.bind(this))},
onChange:function(a){this.base(a);this.updateRoomDisclaimer(a)},onSearchSubmit:function(){this.providerLangHeader.empty()},onMapViewChange:function(a){a&&a.hasOwnProperty("isMapOpen")&&this.element.toggleClass("mapView",a.isMapOpen)},updateRoomDisclaimer:function(a){if(a){var b=this.getChildElement("disclaimer-text");1<a.rooms||1<c.question.ask("hotel-rooms-selected")?("totaltaxes"===a.priceType?b.html(this.options.roomDisclaimers.total):b.html(this.options.roomDisclaimers.nightly),this.roomDisclaimer.removeClass("hidden")):
this.roomDisclaimer.addClass("hidden")}},setProviderLangHeaderOnInit:function(a){var b=this;a.searchId&&0<a.searchId.length&&this.searchId!==a.searchId&&(this.searchId=a.searchId,a=0<this.filterState.length?{searchId:this.searchId,filterState:JSON.stringify(this.filterState)}:{searchId:this.searchId,useViewStateFilterState:!0},c.ajax.execute("hotels/results/ProviderLanguageHeader",{data:a,beforeScript:function(){b.providerLangHeader.empty()},appendTo:b.providerLangHeader}))},setProviderLangHeaderOnFilters:function(a){var b=
this;null===a.state?delete this.filterState[a.name]:this.filterState[a.name]=a.state;this.searchId&&0<this.searchId.length&&(a={data:{searchId:this.searchId,filterState:JSON.stringify(this.filterState)},beforeScript:function(){b.providerLangHeader.empty()},appendTo:b.providerLangHeader},c.ajax.execute("hotels/results/ProviderLanguageHeader",a))},generateSortLoggingLabel:function(a,b){switch(a){case "price":return b?"cheapest":"mostexpensive";case "priceless":return b?"cheapest":"mostexpensive";case "rank":return b?
"best":"worst";case "userrating":return b?"best":"worst";case "stars":return b?"best":"worst";case "distance":return b?"closest":"furthest";default:return"unknown"}},trackSortBy:function(a,b){if(c.VestigoEvents){var e=b?c.VestigoType.Sortable.asc:c.VestigoType.Sortable.desc,d=c.VestigoEvents.sortresults;switch(a){case "userrating":d.reviewscore(e);break;case "reviewscore":d.reviewscore(e);break;case "stars":d.stars(e);break;case "rank":d.recommended();break;default:this.base(a,b)}}}})})(window.R9,
window.jq||window.jQuery);(function(h,f){h.createComponentClass("hotels.results.HotelQueryAlerts",{includedListSet:null,nyepiDateEl:!1,warningsList:null,warningsHeader:null,options:{warnings:[]},init:function(){this.warningsList=this.getChildElement("warningsList");this.warningsHeader=this.getChildElement("warningsHeader");this.updateWarningVisibility()},inlineComponentsReady:function(){this.nyepiDateEl=this.getChildElement("nyepi-date")},addEventHandlers:function(){var b=this;this.subscribe("search.poll.response",function(a){b.updateWarningVisibility(a)});
this.subscribe("resultspage.cleanup",function(){b.isVisible(!1)})},updateWarningVisibility:function(b){var a=this,e=[];this.options.warnings.forEach(function(c){var d=a.getChildElement(c.id);"nyepiDayOfSilenceWarning"===c.id?(c=b&&b.nyepiWarningDate||!1,a.swapClassesToggle(f(d),"","Warning--hidden",c),a.swapClassesToggle(f(d).parent().parent(),"Warnings__List__Item--visible","Warnings__List__Item--hidden",c),c&&(e.push(d),a.nyepiDateEl&&a.nyepiDateEl.length&&b.nyepiWarningDate&&a.nyepiDateEl.html(b.nyepiWarningDate))):
(e.push(d),a.swapClassesToggle(f(d),"","Warning--hidden",!0))});var g=1<e.length;a.swapClassesToggle(this.warningsList,"Warnings__List--Multiple","Warnings__List--Single",g);a.swapClassesToggle(this.warningsHeader,"Warnings__Header--visible","Warnings__Header--hidden",g);a.isVisible(0<e.length)},isVisible:function(b){b?this.swapClasses(this.element,"Container--hidden","Container--visible"):this.swapClasses(this.element,"Container--visible","Container--hidden")}})})(R9,jQuery);(function(b){b.createComponentClass("hotels.results.brands.hotelscombined.HotelResultItemHeader",{openMapButton:null,init:function(){this.element.on("click",".openMapText",function(a){a&&a.target&&a.target&&a.target.dataset&&a.target.dataset.hotelid&&b.events.publish("simpleHeader.fullScreenMap.open",{resultId:a.target.dataset.hotelid,forceCenter:!0,includeHeader:!0});a.stopImmediatePropagation()})},addEventHandlers:function(){var a=this;this.element.on("click",function(c){c.stopPropagation();b.events.publish("hotels.results.openDetailsPage",
{resultId:a.options.resultId,tab:"header",event:c,source:"name"})})}})})(window.R9);(function(b){b.createComponentClass("hotels.results.HotelPieRating",{pieWrapper:null,breakdownTooltip:null,options:{breakdown:null,resultId:""},init:function(){this.pieWrapper=this.getChildElement("pieWrapper");this.breakdownTooltip=this.getChildElement("breakdown")},addEventHandlers:function(){var a=this;this.options.breakdown&&(this.pieWrapper.on("mouseenter",function(){a.breakdownTooltip.fadeIn()}),this.pieWrapper.on("mouseleave",function(){a.breakdownTooltip.hide()}));this.element.on("click",
function(c){c.stopPropagation();b.events.publish("hotels.results.openDetailsPage",{resultId:a.options.resultId,tab:"reviews",event:c})})}})})(window.R9);(function(b,c){b.createComponentClass("hotels.results.WatermarkClickOut",{watermarkLink:null,options:{mappedBookingCode:"",imgId:"",subscribeToRatesTable:!1},init:function(){this.watermarkLink=this.getChildElement("watermarkLink")},addEventHandlers:function(){this.watermarkLink.on("click",function(a){a.stopPropagation()});this.options.subscribeToRatesTable&&this.subscribe("hotels.ratesTable.multibookLoaded",this.updateWatermarkLink.bind(this));this.subscribe("hotels.results.carousel.resize",this.updateWatermarkDimensions.bind(this))},
updateWatermarkDimensions:function(a){a&&(a.width&&a.widthAspectRatio&&this.element.width(Math.floor(a.width*a.widthAspectRatio)),a.height&&a.heightAspectRatio&&this.element.height(Math.floor(a.height*a.heightAspectRatio)))},updateWatermarkLink:function(a){var b=this;a&&a.multibookData&&(a=a.multibookData.find(function(a){return a.code===b.options.mappedBookingCode}))&&a.url&&(this.watermarkLink.attr("href",this.buildBookingUrl(a.url)),this.updateDisplay(!0))},buildBookingUrl:function(a){return a+
("\x26imgclick\x3d"+this.options.imgId)},updateDisplay:function(a){this.element.attr("data-enabled",a)}})})(R9,jQuery);(function(d,e){d.createComponentClass("hotels.results.HotelInlineCarousel",{index:0,direction:"next",carousel:null,carouselPictures:null,filteredCarousel:null,imageCategories:null,activeCategory:null,filterStateDirty:!1,responsive:!1,responsiveWidth:0,responsiveHeight:0,responsiveTimer:!1,viewWidth:0,viewHeight:0,headerHeight:0,footerHeight:0,arrowWidth:0,minWidth:746,minHeight:665,wrapper:null,widthFactor:1.49532,heightFactor:.66875,next:null,prev:null,loggingPrefix:"hotels/results/",preloaded:!1,
images:null,virtualTour:!1,viewAllPhotosButton:null,thumbnails:null,thumbPage:0,thumbsPerPage:6,totalThumbs:0,currentThumb:0,prevThumb:null,nextThumb:null,thumbs:null,thumbList:null,info:null,indexer:null,numerator:null,denominator:null,hoverTimer:!1,xDown:null,yDown:null,xDownStrip:null,yDownStrip:null,hasBeenForceUnveiled:!1,greatestWidth:0,options:{responsive:!1,priceType:"daybase",fullScreen:!1,wrap:!0,hoverOnEvent:!1,resultId:"",searchId:null,showVirtualTour:!1,showBubbles:!1,showIndex:!1,width:0,
thumbWidth:160,thumbstrip:!1,maxThumbs:38,thumbnailPerRow:19,limitImages:!1,renderArrows:!0,forceUnveilOnInteraction:!1,imageCategoriesEnabled:!1,categoriesToImageIndicesMap:null,topCategories:null,watermarkWidthAspectRatio:.15,watermarkHeightAspectRatio:.1,fitToContainer:!1,openLargeGalleryOnClick:!1,renderViewAllButton:!1,bigCarouselEnabled:!1,autoAdvance:!1,autoAdvanceMillis:5E3},init:function(){this.carousel=this.getChildElement("carousel");this.background=this.getChildElement("carousel-bg");
this.images=this.carousel.find("img");this.next=this.getChildElement("next");this.prev=this.getChildElement("prev");this.wrapper=this.getChildElement("wrapper");this.info=jq(".popupDetailsContent .info");this.preloaded=!1;this.options.thumbstrip&&(this.thumbsPerPage=this.options.maxThumbs);(this.thumbnails=this.getChildElement("thumbnails"))&&0<this.thumbnails.length&&(this.nextThumb=this.getChildElement("nextthumb"),this.prevThumb=this.getChildElement("prevthumb"),this.totalThumbs=this.thumbnails.find("li").length,
this.thumbs=e(this.thumbnails.find("li")),this.thumbList=this.getChildElement("thumbList"),0<this.totalThumbs&&!this.options.thumbstrip&&(e(this.thumbs[0]).addClass("selected"),this.thumbList.css({"min-width":this.totalThumbs*(this.options.thumbWidth+6)+"px"})));this.options.showIndex&&(this.indexer=this.getChildElement("indexer"),this.numerator=this.getChildElement("numerator"),this.denominator=this.getChildElement("denominator"),this.numerator&&(this.numerator.html(this.index+1),this.denominator.html(this.totalThumbs)));
this.bubbles=this.getChildElement("bubbles");this.photoDialog=this.getChildElement("photoDialog").length?this.getChildElement("photoDialog").dialog({onClose:function(){d.events.publish("vfm.closeTour")},onOpen:function(){d.events.publish("vfm.openTour")}}).getWidget():null;this.options.responsive||e(this.element).removeClass("responsive");0<this.options.index&&this.selectByThumb(this.options.index);this.options.imageCategoriesEnabled&&(this.imageCategories=this.getChildElement("hotelImageCategories").find("button"),
this.carousel&&(this.carouselPictures=this.carousel.find("li.picture")),this.activeCategory=this.getChildElement("allphotos"));this.options.fitToContainer?(this.fitToContainer(),this.unhideWhenLoaded(),window.addEventListener("resize",d.Common.Utils.debounce(this.fitToContainer.bind(this),100))):this.options.autoAdvance&&this.startAutoAdvance();this.options.renderViewAllButton&&(this.viewAllPhotosButton=this.getChildElement("viewall"))},startAutoAdvance:function(){this.clearAutoAdvanceTimer();this.autoAdvanceTimer=
setInterval(this.autoAdvance.bind(this),this.options.autoAdvanceMillis)},autoAdvance:function(){this.selectByThumb((this.index+1)%this.images.length)},clearAutoAdvanceTimer:function(){this.options.autoAdvance&&0<=this.autoAdvanceTimer&&(clearTimeout(this.autoAdvanceTimer),this.autoAdvanceTimer=-1)},fitToContainer:function(){var a=this.element.parent();if(a){var b=Math.round(a.width()),a=Math.round(a.height());this.headerHeight=Math.round(this.info.outerHeight());this.arrowWidth=Math.round(this.prev.outerWidth()+
this.next.outerWidth())||0;this.viewWidth=b;this.viewHeight=a;this.responsiveWidth=b;this.responsiveHeight=a;this.wrapper.css({width:b,height:a});this.element.css({width:this.responsiveWidth+"px",height:this.responsiveHeight+"px"});this.element.find("li").css({width:this.responsiveWidth+"px",height:this.responsiveHeight+"px"});this.element.find("li img").css({width:this.responsiveWidth+"px",height:this.responsiveHeight+"px"});this.options.width=this.responsiveWidth;this.selectByThumb(this.index);
if((b=this.element.find(".picture img"))&&b.length)for(a=0;a<b.length;a++){var c=b[a];c.src&&(c.src=this.updateSrcToDimensions(c.src,this.viewWidth,this.viewHeight));c.srcset&&(c.srcset=this.updateSrcSetToDimensions(c.srcset,this.viewWidth,this.viewHeight));var e=c.getAttribute("data-src-retina");e&&c.setAttribute("data-src-retina",this.updateSrcToDimensions(e,2*this.viewWidth,2*this.viewHeight));(e=c.getAttribute("data-src"))&&c.setAttribute("data-src",this.updateSrcToDimensions(e,this.viewWidth,
this.viewHeight))}d.events.publish("hotels.results.carousel.resize",{width:this.responsiveWidth,height:this.responsiveHeight,widthAspectRatio:this.options.watermarkWidthAspectRatio,heightAspectRatio:this.options.watermarkHeightAspectRatio})}},unhideWhenLoaded:function(){var a=this;this.images&&this.images.length&&(this.images[0].onload=function(){a.element.removeClass("hidden");a.options.autoAdvance&&a.startAutoAdvance()})},updateSrcToDimensions:function(a,b,c){return a.replace(/\bwidth=\d+/g,"width\x3d"+
Math.round(b)).replace(/\bheight=\d+/g,"height\x3d"+Math.round(c))},updateSrcSetToDimensions:function(a,b,c){for(var e=a.split(/,? +/g),d="",g=0;g<e.length;g+=2){var h=e[g+1];if(!h)return a;var k=parseInt(h.substring(0,h.length-1)),d=d+(this.updateSrcToDimensions(e[g],b*k,c*k)+" "+h+", ")}return d.substring(0,d.length-2)},cancelTimeout:function(){this.hoverTimer&&(window.clearTimeout(this.hoverTimer),this.hoverTimer=!1)},selectByHover:function(a){var b=this;this.cancelTimeout();this.hoverTimer=window.setTimeout(function(){b.selectByThumb(a)},
600)},inlineComponentsReady:function(){var a=this;this.thumbnails&&0<this.thumbnails.length&&(this.preloaded||(this.unveil(this.images),this.preloaded=!0),this.options.thumbstrip&&this.thumbs.each(function(b){e(this).hover(function(){a.selectByHover(b)},function(){a.cancelTimeout()})}),a.highlightThumb());this.options.fullScreen&&this.resizeCarousel()},highlightThumb:function(){if(this.thumbs){e(this.thumbs).removeClass("selected");e(this.thumbs[this.index]).addClass("selected");var a=this.filterStateDirty?
this.getFilteredCarouselIndex():this.index,a=Math.floor(a/this.thumbsPerPage);a!=this.thumbPage&&(this.thumbPage=a,this.showThumbPage());this.options.showIndex&&this.numerator&&(this.numerator.html(this.index+1),this.denominator.html(this.totalThumbs))}},selectByThumb:function(a){var b=a==this.index;this.direction=this.index<a?"next":"prev";this.index=a;this.displayPicture(this.index,!1);b||d.Analytics.api.trackEvent(this.loggingPrefix+"click/photo/"+this.index);this.preloaded||(this.unveil(this.images),
this.preloaded=!0);this.highlightThumb()},toggleResponsive:function(){this.responsive?(this.responsive=!1,jq(".splash").removeClass("responsive"),this.resizeCarousel()):(this.responsive=!0,jq(".splash").addClass("responsive"),jq(window).resize())},cancelResize:function(){this.responsiveTimer&&(window.clearTimeout(this.responsiveTimer),this.responsiveTimer=!1)},resizeCarousel:function(){if(this.responsive){this.viewWidth=jq(window).width();this.viewHeight=jq(window).height();this.viewWidth<this.minWidth&&
(this.viewWidth=this.minWidth);this.headerHeight=this.info.outerHeight()||0;this.arrowWidth=this.prev.outerWidth()+this.next.outerWidth();isNaN(this.arrowWidth)&&(this.arrowWidth=0);var a=0;this.imageCategories&&(a=this.imageCategories.outerHeight());isNaN(a)&&(a=0);this.responsiveWidth=this.viewWidth-this.arrowWidth;700>this.responsiveWidth&&(this.responsiveWidth=700);var b=0;this.indexer&&(b=this.indexer.outerHeight()||0);var c=0;this.thumbnails&&(c=this.thumbnails.outerHeight()||0);a=this.viewHeight-
(this.headerHeight+a+c+b+10);468>a&&(a=468);this.responsiveHeight=this.responsiveWidth*this.heightFactor;468>this.responsiveHeight&&(this.responsiveHeight=468);this.responsiveHeight>a&&(this.responsiveHeight=a,this.responsiveWidth=this.responsiveHeight*this.widthFactor);this.responsiveHeight=Math.floor(this.responsiveHeight);this.responsiveWidth=Math.floor(this.responsiveWidth);jq(".splash.responsive").css({width:this.responsiveWidth+this.arrowWidth+"px"});this.wrapper.css({width:this.responsiveWidth+
this.arrowWidth+"px",height:this.responsiveHeight+"px"});this.element.css({width:this.responsiveWidth+"px",height:this.responsiveHeight+"px"});this.element.find("li.picture").css({width:this.responsiveWidth+"px",height:this.responsiveHeight+"px"});this.element.find("li.picture img").css({width:this.responsiveWidth+"px",height:this.responsiveHeight+"px"});this.options.width=this.responsiveWidth;this.selectByThumb(this.index)}else this.options.fitToContainer?this.fitToContainer():(this.viewWidth=746,
this.viewHeight=665,this.headerHeight=this.info.outerHeight(),this.arrowWidth=this.prev.outerWidth()+this.next.outerWidth()||0,this.responsiveWidth=700,this.responsiveHeight=468,jq(".splash").css({width:this.responsiveWidth+this.arrowWidth+"px"}),this.wrapper.css({width:"750px",height:"468px"}),this.element.css({width:this.responsiveWidth+"px",height:this.responsiveHeight+"px"}),this.element.find("li.picture").css({width:this.responsiveWidth+"px",height:this.responsiveHeight+"px"}),this.element.find("li.picture img").css({width:this.responsiveWidth+
"px",height:this.responsiveHeight+"px"}),this.options.width=this.responsiveWidth,this.selectByThumb(this.index));this.responsiveTimer=!1;d.events.publish("hotels.results.carousel.resize",{width:this.responsiveWidth,height:this.responsiveHeight,widthAspectRatio:this.options.watermarkWidthAspectRatio,heightAspectRatio:this.options.watermarkHeightAspectRatio})},addEventHandlers:function(){var a=this;this.options.fullScreen&&(this.subscribe("carousel.responsive",function(){a.toggleResponsive()}),this.carousel.on("click",
function(){a.toggleResponsive()}),jq(window).on("resize",function(b){a.responsive&&(a.cancelResize(),a.responsiveTimer=window.setTimeout(function(){a.resizeCarousel()},200))}));this.subscribe("resultspage.streaming.done",function(){a.addingNoHotelImage(500)});this.subscribe("paginator.getmoreresults.completed",function(){a.addingNoHotelImage(500)});this.subscribe("horizon.carousel.nextPhoto",{id:a.id()},function(){a.options.imageCategoriesEnabled?a.incrementIndexAfterFilteredCarousel():a.index++;
a.direction="next";a.displayPicture(a.index);d.Analytics.api.trackEvent(a.loggingPrefix+"click/photo/"+a.index);a.preloaded?a.options.forceUnveilOnInteraction&&!a.hasBeenForceUnveiled&&(a.unveil(a.images),a.hasBeenForceUnveiled=!0):(a.unveil(a.images),a.preloaded=!0);a.clearAutoAdvanceTimer();a.highlightThumb()});this.subscribe("horizon.carousel.previousPhoto",{id:a.id()},function(){a.options.imageCategoriesEnabled?a.decrementIndexAfterFilteredCarousel():a.index--;a.direction="prev";a.displayPicture(a.index,
!1);d.Analytics.api.trackEvent(a.loggingPrefix+"click/photo/"+a.index);a.preloaded?a.options.forceUnveilOnInteraction&&!a.hasBeenForceUnveiled&&(a.unveil(a.images),a.hasBeenForceUnveiled=!0):(a.unveil(a.images),a.preloaded=!0);a.clearAutoAdvanceTimer();a.highlightThumb()});this.options.renderArrows||(this.subscribe("horizon.carousel.previousPhotoForResult",{resultId:this.options.resultId},function(){d.events.publish("horizon.carousel.previousPhoto",{id:a.id()})}),this.subscribe("horizon.carousel.nextPhotoForResult",
{resultId:this.options.resultId},function(){d.events.publish("horizon.carousel.nextPhoto",{id:a.id()})}));if(this.options.renderViewAllButton&&this.images&&this.images.length)this.viewAllPhotosButton.on("click",function(){d.Analytics.api.trackEvent(this.loggingPrefix+"/click/viewallphotos");d.events.publish("hotels.popupDetails.show",{hid:a.options.resultId,searchId:a.options.searchId,priceType:a.options.priceType,index:a.index,force:!0,showThumbs:!0})});if(this.options.fullScreen||this.options.thumbstrip)this.subscribe("horizon.carousel.popup.nextPhoto",
function(){d.events.publish("horizon.carousel.nextPhoto",{id:a.id()})}),this.subscribe("horizon.carousel.popup.previousPhoto",function(){d.events.publish("horizon.carousel.previousPhoto",{id:a.id()})});if(d.config.getBoolean("ui.hotels.preload.on.hover",!1))this.next.one("mouseover",function(){1<a.images.length&&a.unveil(e(a.images[1]))});this.next.click(function(b){b.stopPropagation();d.events.publish("horizon.carousel.nextPhoto",{id:a.id()});a.next.blur()});this.nextThumb&&this.nextThumb.click(function(){var b=
(a.thumbPage+1)*a.thumbsPerPage;if(a.filterStateDirty){if(b>=a.filteredCarousel.length)return;a.index=a.filteredCarousel[b]}else{if(b>a.totalThumbs)return;a.index=b}a.clearAutoAdvanceTimer();a.thumbPage++;a.direction="next";a.displayPicture(a.index);d.Analytics.api.trackEvent(a.loggingPrefix+"click/photo/"+this.index);a.preloaded||(a.unveil(this.images),a.preloaded=!0);a.showThumbPage()});this.prevThumb&&this.prevThumb.click(function(){0!==a.thumbPage&&(a.thumbPage--,a.index=a.filterStateDirty?a.filteredCarousel[a.thumbPage*
a.thumbsPerPage]:a.thumbPage*a.thumbsPerPage,a.clearAutoAdvanceTimer(),a.direction="prev",a.displayPicture(a.index),d.Analytics.api.trackEvent(a.loggingPrefix+"click/photo/"+this.index),a.preloaded||(a.unveil(this.images),a.preloaded=!0),a.showThumbPage())});this.prev.click(function(b){b.stopPropagation();d.events.publish("horizon.carousel.previousPhoto",{id:a.id()});a.prev.blur()});this.options.showVirtualTour&&this.getChildElement("virtualTourLink").click(function(){d.Analytics.api.trackEvent("hotel/details/photos/virtualTour/opened");
a.openVirtualTour()});this.thumbs&&this.thumbs.bind("click",function(b){b=e(b.currentTarget).index();a.clearAutoAdvanceTimer();a.selectByThumb(b)});this.bindSwipes();if(this.options.imageCategoriesEnabled)this.imageCategories.on("click",function(b){a.onCategoryClick(b)});this.options.openLargeGalleryOnClick&&this.images&&this.images.length&&this.images.each(function(b,c){a.registerEvent("click",c,function(){a.clearAutoAdvanceTimer();e("body").click();d.events.publish("select.force.close");d.events.publish("forceDismiss.DatePicker");
d.events.publish("common.dropdown.closeAll");a.options.bigCarouselEnabled?d.events.publish("hotels.bigCarousel.show",{hid:a.options.resultId,index:a.index,force:!0}):d.events.publish("hotels.popupDetails.show",{hid:a.options.resultId,searchId:a.options.searchId,priceType:a.options.priceType,index:a.index,force:!0,showThumbs:!0})})})},bindSwipes:function(){this.carousel.on("touchstart",this.handleTouchStart);this.carousel.on("touchmove",this.handleTouchMove)},getTouches:function(a){return a.touches||
a.originalEvent.touches},handleTouchStart:function(a){this.getTouches&&(a=this.getTouches(a)[0],this.xDown=a.clientX,this.yDown=a.clientY)},handleTouchMove:function(a){if(this.xDown&&this.yDown){var b=this.xDown-a.touches[0].clientX;Math.abs(b)>Math.abs(this.yDown-a.touches[0].clientY)&&(0<b?d.events.publish("horizon.carousel.nextPhoto",{id:this.id()}):d.events.publish("horizon.carousel.prevPhoto",{id:this.id()}));this.yDown=this.xDown=null}},showThumbPage:function(){var a="rtl"===document.dir?this.thumbPage*
this.thumbsPerPage*(this.options.thumbWidth+6):this.thumbPage*this.thumbsPerPage*(this.options.thumbWidth+6)*-1;e(this.thumbList).css({transform:"translateX("+a+"px)"});0===this.thumbPage?e(this.thumbnails).addClass("firstpage"):e(this.thumbnails).removeClass("firstpage");a=(this.thumbPage+1)*this.thumbsPerPage;this.filterStateDirty?a>this.filteredCarousel.length?e(this.thumbnails).addClass("lastpage"):e(this.thumbnails).removeClass("lastpage"):a>this.totalThumbs?e(this.thumbnails).addClass("lastpage"):
e(this.thumbnails).removeClass("lastpage");this.highlightThumb()},displayPicture:function(a){var b=this;a=this.filterStateDirty?this.getFilteredCarouselIndex():a;var c=this.carousel.children().length;this.options.wrap&&a===c?(this.filterStateDirty?(this.index=this.filteredCarousel[0],a=this.getFilteredCarouselIndex()):a=this.index=0,this.carousel.addClass("stopAnimation")):this.options.wrap&&-1===a&&(this.filterStateDirty?(this.index=this.filteredCarousel[this.filteredCarousel.length-1],a=this.getFilteredCarouselIndex()):
a=this.index=c-1,this.carousel.addClass("stopAnimation"));this.options.wrap||(0===this.index?this.prev.hide():this.prev.show(),this.index===c-1?this.next.hide():this.next.show());if(this.options.responsive){var d=e(this.images.get(this.index));this.changeBackground(d);this.images.each(function(a,c){a!==b.index?e(this).css("visibility","hidden"):e(this).css("visibility","visible")})}if(b.options.fitToContainer)for(d=0;d<b.options.preLoad;d++){var f=this.images[this.index+d];if(f){var g=f.getAttribute("data-src")||
f.src;g&&(f.src=this.updateSrcToDimensions(g,this.viewWidth,this.viewHeight));f.srcset=this.createSrcSet(f)}this.unveil(e(f))}b.options.showBubbles&&b.bubbleShuffle(this.index,c);a*=this.options.width;this.carousel.css("transform","translateX(%spx)".format("rtl"===document.dir?a:-a));setTimeout(function(){b.carousel.removeClass("stopAnimation")},10)},createSrcSet:function(a){var b=a.getAttribute("data-src")||a.src,c=a.getAttribute("data-src-retina");return c?b+" 1x, "+c+" 2x":b?b+" 1x":a.srcSet},
bubbleShuffle:function(a,b){var c=this,d=b-1;b-=2;c.bubbles.find(".bubble").removeClass("selected");0===a&&c.bubbles.find(".bubble1").addClass("selected");1===a&&c.bubbles.find(".bubble2").addClass("selected");a===b&&c.bubbles.find(".bubble4").addClass("selected");a===d&&c.bubbles.find(".bubble5").addClass("selected");1<a&&a<b&&c.bubbles.find(".bubble3").addClass("selected");"next"===c.direction&&2<a&&a<b&&(c.bubbles.addClass("moving").addClass("moveRight"),setTimeout(function(){c.bubbles.addClass("transitional").removeClass("moveRight")},
250),setTimeout(function(){c.bubbles.removeClass("transitional").removeClass("moving")},600));"prev"===c.direction&&1<a&&a<b&&(c.bubbles.addClass("moving").addClass("moveLeft"),setTimeout(function(){c.bubbles.addClass("transitional").removeClass("moveLeft")},250),setTimeout(function(){c.bubbles.removeClass("transitional").removeClass("moving")},600))},changeBackground:function(a){a=a.attr("src");e(this.background).css({"background-image":"url("+a+")"})},openVirtualTour:function(){var a=this;a.virtualTour?
a.photoDialog.open():d.ajax.execute("hotels/details/HotelDetailsVirtualTour",{data:{hid:a.options.resultId},appendTo:a.getChildElement("virtualTour")}).then(function(){a.virtualTour=!0;a.photoDialog.open();d.Analytics.api.trackEvent("openVirtualTour/"+a.options.resultId)})},unveil:function(a){a.unveil(0,function(){e(this).on("load",function(){this.style.opacity=1})})},addingNoHotelImage:function(a){var b=this;this.images&&this.images[0]&&this.images[0].complete?this.addNoHotelImage():setTimeout(function(){b.addNoHotelImage()},
a)},addNoHotelImage:function(){this.element.addClass("hrp-placeholder-image")},onCategoryClick:function(a){var b=a.currentTarget.id.split("-").pop();if("allphotos"!==b){if(b in this.options.categoriesToImageIndicesMap){this.filteredCarousel=this.options.categoriesToImageIndicesMap[b];for(var c=0;c<this.totalThumbs;c++){var d=this.filteredCarousel.indexOf(c),f=e(this.thumbs[c]),g=e(this.carouselPictures[c]);-1===d?(f.addClass("hidden"),g.addClass("hidden"),g.css({width:"0px"})):(f.removeClass("hidden"),
g.removeClass("hidden"),g.css({width:this.options.width+"px"}));this.options.limitImages&&(this.isLastThumbImageInRow(d)?f.addClass("last-item-on-row"):f.removeClass("last-item-on-row"))}this.filterStateDirty=!0;this.resetCarousel(this.filteredCarousel[0]);this.logAnalyticsForCategoryClick(b)}}else this.resetCategories(),this.logAnalyticsForCategoryClick("all-photos");this.updateActiveCategory(e(a.currentTarget));this.showThumbPage()},updateActiveCategory:function(a){this.activeCategory.removeClass("active");
this.activeCategory=a;this.activeCategory.addClass("active")},resetCategories:function(){for(var a=0;a<this.totalThumbs;a++){var b=e(this.thumbs[a]),c=e(this.carouselPictures[a]);b.removeClass("hidden");c.removeClass("hidden");this.options.limitImages&&(this.isLastThumbImageInRow(a)?b.addClass("last-item-on-row"):b.removeClass("last-item-on-row"));this.carouselPictures[a].style.width=this.options.width+"px"}this.filteredCarousel=null;this.filterStateDirty=!1;this.resetCarousel(0)},resetCarousel:function(a){this.index=
a;this.displayPicture(this.index);this.highlightThumb()},incrementIndexAfterFilteredCarousel:function(){if(this.filterStateDirty&&this.filteredCarousel){var a=this.filteredCarousel.indexOf(this.index)+1;this.index=this.filteredCarousel.length>a?this.filteredCarousel[a]:this.totalThumbs}else this.index++},decrementIndexAfterFilteredCarousel:function(){if(this.filterStateDirty&&this.filteredCarousel){var a=this.filteredCarousel.indexOf(this.index)-1;this.index=0<=a?this.filteredCarousel[a]:-1}else this.index--},
getFilteredCarouselIndex:function(){if(this.filteredCarousel)return this.index===this.totalThumbs?this.index:this.filteredCarousel.indexOf(this.index)},logAnalyticsForCategoryClick:function(a){d.Analytics.api.trackEvent({category:"hotel-image-category",action:a,label:"click"})},isLastThumbImageInRow:function(a,b){if(0>a)return!1;void 0===b&&(b=!0);return 0===(b?a+1:a)%this.options.thumbnailPerRow}})})(R9,jQuery);(function(a,e){a.createComponentClass("hotels.results.HotelResultPhotoColumn",{options:{resultId:"",targetTab:"overview",searchCompleted:!1,showLightbox:!1,showBigCarousel:!1,bookingLinkMapJSON:""},timer:null,cleanBanner:null,init:function(){},addEventHandlers:function(){var d=this;(this.cleanBanner=this.getChildElement("covid"))&&this.registerEvent("click",d.cleanBanner,function(b){b.stopPropagation();e("body").click();a.Analytics.api.trackEvent("hotel/result/covid-clean/click");b=d.cleanBanner.attr("data-brand");
a.events.publish("hotels.results.covid.cleanModal.show",{brand:b})});if(this.options.showWorstPriceDisclaimer){var c=this.getChildElement("goodDeal");c&&c.toolTip({content:function(){return c.data("message")},position:"top",showImmediately:!1})}this.options.searchCompleted&&(this.registerEvent("click",this.getChildElement("thumb"),this.onGalleryClick.bind(this)),this.registerEvent("keypress",this.getChildElement("thumb"),function(b){if(b.which===a.globals.keyCodes.SPACE||b.which===a.globals.keyCodes.RETURN)d.onGalleryClick(b)}))},
onGalleryClick:function(d){var c=this;d.stopPropagation();e("body").click();a.Analytics.api.trackEvent("hotel/result/image/click");a.events.publish("select.force.close");a.events.publish("forceDismiss.DatePicker");a.events.publish("common.dropdown.closeAll");var b=function(){a.events.publish("track.result.details.open",{resultId:c.options.resultId,source:"image"})};this.options.showBigCarousel?(a.events.publish("hotels.bigCarousel.show",{hid:this.options.resultId,index:0,bookingLinkMapJSON:this.options.bookingLinkMapJSON}),
b()):this.options.showLightbox?(a.events.publish("hotels.popupDetails.show",{hid:this.options.resultId,index:0,bookingLinkMapJSON:this.options.bookingLinkMapJSON}),b()):e(d.target).closest(".next,.prev").length||a.events.publish("hotels.results.openPageOrToggle",{resultId:this.options.resultId,force:null,tab:this.options.targetTab,source:"image"})},inlineComponentsReady:function(){this.base();if(this.cleanBanner){if(1<this.element.find(".deal-banner").length){var a=e(this.element.find(".deal-banner")[0]).innerWidth(),
c=e(this.element.find(".deal-banner")[0]).position().left;this.cleanBanner.css({left:a+c+10+"px"})}this.cleanBanner.removeClass("hidden")}}})})(R9,jQuery);(function(a){a.createComponentClass("common.booking.VerticalMultibookProvider",{bookingLink:null,options:{resultId:""},init:function(){this.bookingLink=this.getChildElement("bookingLink")}})})(R9);(function(b){b.createComponentClass("common.booking.HorizontalMultibookProvider",{bookingLink:null,options:{resultId:"",hackerStayCore:!1,hackerStayCoreModalParams:{},markPriceDifference:!1},init:function(){this.bookingLink=this.getChildElement("bookingLink");var a=this.getChildElement("genius-message");a&&a.length?a.toolTip({content:a.data("message"),extraClass:"halfWidth",activation:"click"}):this.options.markPriceDifference?(a=this.getChildElement("price-difference"),a.toolTip({content:a.data("message"),
extraClass:"halfWidth",activation:"click"})):this.options.markProviderDirect&&(a=this.getChildElement("provider-direct"),a.toolTip({content:a.data("message"),extraClass:"halfWidth",activation:"click"}));(a=this.getChildElement("nonInstantBookIcon"))&&a.toolTip({content:a.data("message"),showImmediately:!1,activation:"click"})},addEventHandlers:function(){var a=this;this.bookingLink.length&&this.options.hackerStayCore&&this.registerEvent("click",this.bookingLink,function(){b.events.publish("hotels.results.HackerStayDetailsModal.open",
a.options.hackerStayCoreModalParams)})}})})(R9);(function(c){c.createComponentClass("common.booking.brands.hotelscombined.VerticalMultibookProvider","common.booking.VerticalMultibookProvider",{options:{privatePromo:!1,secretDealsSignupHeading:void 0,secretDealsSignupSubheading:void 0},addEventHandlers:function(){var a=this.options,b=this.bookingLink,d=b.attr("href");this.base();if(b.length&&a.privatePromo&&!d)b.on("click",function(){c.authentication.showSignup({customHeading:a.secretDealsSignupHeading,customSubheading:a.secretDealsSignupSubheading})})}})})(R9);(function(c,d){c.createComponentClass("common.booking.DropdownMultibookProvidersList",{templates:{multibookItem:"multibookDropdownItem",overflowLink:"multibookOverflowLink"},options:{loggingPrefix:"",promoParams:null,analyticsTrackingEvent:null,resultId:"",foreignWarnTooltip:"",showMultibookOverflow:!0,providerTagList:null},overflowProvidersCount:0,privateRatesButton:null,providersGrid:null,list:null,init:function(){this.list=this.getChildElement("list");this.multibookOverflow=this.getChildElement("overflow");
this.privateRatesButton=this.getChildElement("inlinePrivateRatesButton");this.providersGrid=this.getChildElement("providersGrid")},addEventHandlers:function(){var a=this;a.privateRatesButton&&a.privateRatesButton.length&&window.requestAnimationFrame(function(){60<a.providersGrid.innerHeight()&&a.privateRatesButton.addClass("mini")});a.registerEvent("click",a.element.find(".bookingLink[data-name]"),a.linkClicked.bind(a));a.registerEvent("click",a.list.find(".Common-Booking-MultiBookDropdownItem"),
a.linkClicked.bind(a));a.element.find(".foreignProvider").toolTip({content:a.options.foreignWarnTooltip,position:"top",showImmediately:!1});a.getChildElement("inlinePrivateRatesButton").click(function(){c.Analytics.api.trackEvent({category:a.options.loggingPrefix+"/multibook",action:"signIn",label:"privateRateButton"});var b=d.extend({regurl:a.options.promoParams.promo},a.options.promoParams);c.authentication.showLogin(b)});a.getChildElement("privateRatesButton").click(function(){var b=d.extend({regurl:a.options.promoParams.promo},
a.options.promoParams);c.authentication.showLogin(b)});a.multibookOverflow.click(a.overflowClicked.bind(a));a.element.find(".foreignProvider").toolTip({content:a.options.foreignWarnTooltip,position:"right",showImmediately:!1});a.list.find(".bookingLink.hasPenalty").toolTip({content:a.options.hasPenaltyTooltip,position:"right",showImmediately:!1});a.subscribe(a.getEvent("multibook.reset"),function(){a.list.html("");a.element.removeClass("ShowDropdown").removeClass("Show")});a.subscribe("DropdownDialog.close",
{id:a.id("dropdown")},function(){c.Analytics.api.trackEvent(a.options.loggingPrefix+"/multibook/close")})},overflowClicked:function(){c.events.publish("multibook.overflowLink.clicked");this.options.showMultibookOverflow?this.list.addClass("showOverflow"):this.closeDropdown()},linkClicked:function(a){var b=this;d(a.currentTarget).attr("href")&&(c.events.publish("clickout.open",{data:{resultId:b.options.resultId},element:d(a.currentTarget),event:a,callback:function(){b.options.analyticsTrackingEvent&&
c.Analytics.api.trackEvent(b.options.analyticsTrackingEvent)}}),null!==b.options.providerTagList&&(a=b.findSelectedProviderOptions(d(a.currentTarget).data()),null!==a&&(a.resultId=b.options.resultId,c.events.publish("hotel.clickout",a))))},findSelectedProviderOptions:function(a){for(var b=0;b<this.options.providerTagList.length;b++)if(this.options.providerTagList[b].providerName===a.name&&this.options.providerTagList[b].providerCode===a.code)return this.options.providerTagList[b];return null},getEvent:function(a){return a+
(this.options.resultId?"."+this.options.resultId:"")},closeDropdown:function(){this.getChildElement("dropdown").getWidget().close()}})})(R9,jQuery);(function(a){a.createComponentClass("common.booking.brands.hotelscombined.DropdownMultibookProvidersList","common.booking.DropdownMultibookProvidersList",{options:{secretDealsExists:!1},addEventHandlers:function(){this.base();this.options.secretDealsExists&&a.events.publish("htc.results.page.secret.deal.visible")}})})(window.R9);(function(c,p){c.createComponentClass("hotels.common.HotelInteractHistory",{options:{maxHistoryItems:30,expirationDelayHours:360,structureVersion:"v2"},localHistory:null,pageTab:"hotels",storedInteractions:null,init:function(){this.bindLocalHistory()},addEventHandlers:function(){this.subscribe("previousHotels.clearClicked",this.clearInteractions.bind(this))},bindLocalHistory:function(){this.localHistory=new c.common.utils.history.UserHistory({tab:this.pageTab,persistLocalStorage:!0})},getInteractions:function(){var a=
this;if(this.storedInteractions=this.localHistory.get("interactions"))this.storedInteractions=this.storedInteractions.slice(),this.storedInteractions=this.storedInteractions.filter(function(b){return null!==b&&b.version&&b.version===a.options.structureVersion&&!a.isExpired(b.expiresAt)});return this.storedInteractions},pushInteractionData:function(a,b,c,d,e,f,g,h,k,l,m,n){a={version:this.options.structureVersion,hotelId:a,cityId:b,arriveDate:c,departDate:d,cheapestPrice:e,createdAt:this.createExpirationTimestamp(),
expiresAt:this.createExpirationTimestamp(this.options.expirationDelayHours),hotelName:f,showRating:g,starRatingDestinyHotel:h,useStarRatingDestinyHotel:k,userRating:l,userRatingDescription:m,searchUrl:n};this.localHistory.pushHotelInteractHistoryItem("interactions",a,this.options.maxHistoryItems)},createExpirationTimestamp:function(a){return moment().add(a||0,"hours").toDate()},isExpired:function(a){return 0<moment().diff(moment(a))},clearInteractions:function(){this.localHistory.set("interactions",
[])}})})(window.R9,window.jQuery);(function(c,e){var f=c.config.getString("ui.horizon.common.core.focusOutlineClass","a11y-focused"),g=c.config.getBoolean("ui.horizon.logging.loadingClick",!0);c.createComponentClass("base.results.HorizonResult",{detailsComponentUrl:null,open:!1,options:{resultId:null,uiResultId:null,searchId:null,openDetailsTab:"",detailsEnabled:!0,showDetailsLinkVisible:!1,promoParams:null,isSEO:!1,alwaysOpen:!1,tripTicketSleeveEnabled:!1,listIndex:-1,verticalSymbol:"",outlineWrapperOnFocus:!1,trackingEnabled:!1},
awaitingDetails:!1,hasDetails:!1,detailsContainer:e(),inlineContent:null,cheapest:null,lastActiveTab:null,init:function(){var a=this.options;this.cheapest=this.getChildElement("cheapest");this.detailsWrapper=this.getChildElement("detailsWrapper");this.detailsContent=this.getChildElement("detailsContent");this.open=this.element.hasClass("DetailOpen");this.hasDetails=!!a.openDetailsTab||this.element.hasClass("DetailOpen");this.defaultTicketHeader=this.getChildElement("ticketHeader--default");this.defaultTicketSleeve=
this.getChildElement("ticketSleeve--default");this.overlayTicketHeader=this.getChildElement("ticketHeader--overlay");this.overlayTicketSleeve=this.getChildElement("ticketSleeve--overlay");this.open&&(this.lastActiveTab=c.question.ask("active.tab.of.result.details."+this.options.resultId))},addEventHandlers:function(){var a=this;this.subscribe("result.details.open",{resultId:this.options.uiResultId},function(b){a.ensureOpened(b.activeTab,b.force)});this.subscribe("result.details.toggle",{resultId:this.options.uiResultId},
function(b){a.open?a.ensureClosed():a.ensureOpened(b.activeTab,b.force)});this.subscribe("result.details.close",this.options.uiResultId,function(){a.ensureClosed()});this.subscribe("result.details.opened",{resultId:this.options.uiResultId},function(){a.element.addClass("Opened LastOpened")});this.subscribe("result.details.opened",{resultId:this.options.uiResultId},function(b){a.options.uiResultId!==b.resultId&&a.element.removeClass("LastOpened")});this.subscribe("result.details.adjusted",this.options.uiResultId,
function(){a.toggleHeight()});this.registerEvent("click",this.cheapest,function(b){c.events.publish("clickout.open",{data:{resultId:a.options.resultId},element:e(b.currentTarget),event:b,callback:function(){c.Analytics.api.trackEvent("resultItem/cheapest/clickthrough")}})});var d=this.getChildElement("skip");d.length&&this.registerEvent("click",d,function(b){b=e("[tabbable]");var c=b.index(a.element)+1;c>=b.length&&(c=0);b.eq(c).get(0).focus()});a.options.tripTicketSleeveEnabled&&(this.subscribe("resultItem.saved",
{resultItemId:this.options.resultId},function(b){a.addTripTicketHeader(a.options.resultId,b.tripId)}),this.subscribe("resultItem.removed",{resultItemId:this.options.resultId},function(){a.removeTripTicketHeader()}));this.options.outlineWrapperOnFocus&&(this.registerEvent("focus",this.element,this.toggleWrapperFocus.bind(this,!0)),this.registerEvent("blur",this.element,this.toggleWrapperFocus.bind(this,!1)));this.answer("results.HorizonResult.index.of."+this.options.uiResultId,function(){return a.options.listIndex});
this.options.detailsEnabled&&this.subscribe("result.details.tab.changed",{resultId:a.options.resultId},function(b){(a.lastActiveTab=b.activeTab)&&a.trackDetailsCategory({resultId:a.options.resultId,activeTab:b.activeTab})});this.subscribe("track.result.details.open",{resultId:this.options.uiResultId},function(b){a.trackDetailsCategory(b)})},inlineComponentsReady:function(){this.markFirstRendered();this.options.isSEO||this.toggleHeight()},markFirstRendered:function(){c.utils.performance.mark("first_result_rendered")},
toggleOpen:function(a,d,b){if(this.options.detailsEnabled){if("undefined"!==typeof a&&null!==a)if(a){var e=c.config.getBoolean("ui.horizon.flights.details.skipForce",!1);e&&this.open?this.ensureOpened(d,a):e||this.ensureOpened(d,a)}else this.ensureClosed();else this.open=this.options.alwaysOpen||!this.open,this.toggleHeight(),this[this.open?"detailsDidOpen":"detailsDidClose"](d);this.trackDetailsToggle(b)}},ensureOpened:function(a,c){this.options.detailsEnabled&&(!this.open||c?(this.open=!0,this.toggleHeight(),
this.detailsDidOpen(a)):this.toggleHeight())},detailsDidOpen:function(a){this.lastActiveTab=a;this.element.toggleClass("DetailOpen",!0);(this.detailsWrapper.length?this.detailsWrapper:this.detailsContent).attr("aria-expanded",!0);c.events.publish("result.details.opened",{resultId:this.options.uiResultId,activeTab:a});this.trackDetailsCategory({activeTab:a,resultId:this.options.uiResultId})},ensureClosed:function(){this.options.detailsEnabled&&(this.open?(this.open=!1,this.toggleHeight(),this.detailsDidClose()):
this.toggleHeight())},detailsDidClose:function(){this.element.toggleClass("DetailOpen",!1);(this.detailsWrapper.length?this.detailsWrapper:this.detailsContent).attr("aria-expanded",!1);c.events.publish("result.details.closed",{resultId:this.options.uiResultId})},trackDetailsToggle:function(a){var d="inlinedetails",b=this.open?"show":"hide";a&&(d=d+"/"+a);c.Analytics.api.trackEvent({category:d,action:b});g&&!c.question.ask("resultspage.poll.ended")&&c.Analytics.api.trackEvent({category:"inlinedetails",
action:"loading-click"+(a?"/"+a:""),label:b})},toggleHeight:function(){var a=this;this.open?(this.detailsWrapper.css("display","block"),this.detailsWrapper.css("height","auto")):(this.detailsWrapper.height(0),this.detailsWrapper.one("webkitTransitionEnd otransitionend oTransitionEnd msTransitionEnd transitionend",function(c){0===a.detailsWrapper.height()&&a.detailsWrapper.css("display","none")}))},addTripTicketHeader:function(a,d){var b=this;c.ajax.execute("common/trips/TripResultHeader",{data:{resultId:a,
activeTripId:d,listIndex:b.options.listIndex,verticalSymbol:b.options.verticalSymbol},appendTo:b.overlayTicketHeader,replace:!0}).done(function(a){b.showOverlayTicketHeader()})},removeTripTicketHeader:function(){this.overlayTicketHeader.empty();this.hideOverlayTicketHeader()},showOverlayTicketHeader:function(){this.defaultTicketHeader.addClass("hidden");this.defaultTicketSleeve.addClass("hidden");this.overlayTicketHeader.removeClass("hidden");this.overlayTicketSleeve.removeClass("hidden")},hideOverlayTicketHeader:function(){this.overlayTicketHeader.addClass("hidden");
this.overlayTicketSleeve.addClass("hidden");this.defaultTicketHeader.removeClass("hidden");this.defaultTicketSleeve.removeClass("hidden")},toggleWrapperFocus:function(a){this.element.find(".resultWrapper").toggleClass(f,a)},trackingEnabled:function(){return this.options.trackingEnabled&&c.Vestigo},trackDetailsCategory:function(a){a.activeTab=a.activeTab||"overview";if(this.trackingEnabled()){var d=c.VestigoType.ResultDetailsCategory[a.activeTab];d&&c.VestigoEvents.resultdetails.category(d,a.resultId,
this.options.listIndex,c.VestigoType.Visible.show,a.source?c.VestigoType.ResultDetailsSource[a.source]:void 0)}}})})(R9,jQuery);(function(c,d){c.createComponentClass("hotels.results.HotelResultItem","base.results.HorizonResult",{initTab:"overview",title:null,currentTab:"overview",heightSet:!1,options:{resultId:"",toolTipEnabled:!1,noPriceFlag:"",showHotelLinkVisible:!0,tripId:null,displayPrice:null,perNightUSDPrice:"",cheapestUSDPricePerNight:"",isCallForPrice:!1,stars:null,brand:null,phone:"",checkinDate:null,checkoutDate:null,formattedCheckinDate:null,formattedCheckoutDate:null,cancellationToolTipEnabled:!1,isSEO:!1,isBuzzResult:!1,
disableEventsUntilSearchCompleted:!0,preloadDetails:!1,preloadDetailsOnHover:!1,preloadDetailsOnClick:!1,preloadedTabsOnClick:[],scrollIntoViewOnExpand:!1,photosFirst:!1,isSelectedHotel:!1,isMomondo:!1,isBusinessMode:!1,travelPolicyApprovalModeName:"NO_APPROVAL",businessEventState:null,bookOnBehalfActionState:null,doesClickOpenDetailsPage:!1},init:function(){this.base();this.dataResultId=this.element.data("resultid");var a=this.options;a.isUserLoggedIn&&c.storage.get("hotels.results.watch.pending")&&
c.storage.get("hotels.results.watch.pending")===parseInt(this.dataResultId,10)&&(c.storage.remove("hotels.results.watch.pending"),this.handleWatch());this.adjustHBOFontSize();a.isSEO&&(this.hasDetails=!0,this.open=!1)},addEventHandlers:function(){this.base();var a=this;this.options.isBuzzResult||(this.options.disableEventsUntilSearchCompleted?this.options.searchCompleted&&this.setInlineDetailsEvents():this.setInlineDetailsEvents());!this.options.isBuzzResult&&this.options.searchCompleted&&this.setDebugPanelEvents();
this.registerEvent("mouseleave",function(){c.events.publish("hotel.result.mouseleave",{resultId:a.options.resultId})});this.subscribe("common.results.updateTripId",function(b){b&&b.hasOwnProperty("tripId")&&b.hasOwnProperty("resultId")&&a.options.resultId===b.resultId&&(a.options.tripId=b.tripId)});this.trackBookit();this.subscribe("watch",{resultId:this.options.resultId,searchId:this.options.searchId},a.toggleWatch.bind(a));this.subscribe("watching",{resultId:a.options.resultId,searchId:a.options.searchId},
function(){a.options.hasActivePriceAlert=!0});this.subscribe("showPriceAlertDriveBy",{resultId:a.options.resultId,searchId:a.options.searchId},this.showDriveByAlertDialog.bind(this));this.registerEvent("click","hbo",function(){var b=d(this).data("href");c.Analytics.api.trackEvent("/hbo/clicked/"+a.options.brand);window.open(b)});this.registerEvent("click","hbo a",function(a){a.stopPropagation()});this.options.isSEO&&this.subscribe("hotel.inline.detail.changeTab",{resultId:a.options.resultId},function(b){a.options.currentTab!==
b.tab&&(d(".inlineTab[data-tab\x3d'"+b.tab+"']",a.element).addClass("active"),c.events.publish("hotel.inline.detail.tabs.showClose",{resultId:a.options.resultId}))});this.subscribe("hotels.results.openPageOrToggle",function(b){!(b&&b.hasOwnProperty("resultId")&&b.resultId===a.options.resultId&&b.hasOwnProperty("force")&&b.hasOwnProperty("tab"))||b.dontOpenDetailsPage&&a.options.doesClickOpenDetailsPage||(a.openDetailsPageOrToggleOpen(a.options.isSEO||b.force,b.tab),a.trackDetailsCategory({resultId:b.resultId,
activeTab:b.tab,source:b.source}))});this.subscribe("hotels.results.openDetails",function(b){b&&b.hasOwnProperty("resultId")&&b.resultId===a.options.resultId&&a.openDetailsPage(b.tab)});this.subscribe("hotels.results.interaction",function(b){b===a.options.resultId&&a.saveHotelInteraction()});this.registerEvent("click",d(".badge-transitBus",this.element),function(b){a.openDetailsPageOrToggleOpen(null,"map");b.stopPropagation()});this.getChildElement("details-skip").click(function(){a.openDetailsPageOrToggleOpen(!0)})},
setInlineDetailsEvents:function(){var a=this;this.registerEvent("click",function(b){1>d(b.target).closest("a,button,.tabContent,.inlineTabs,.titleContainer,.inline-detail-link,.showMoreMultiBookOptions,.detailsWrapper,.searchFormFieldWrapper,.moreDetails,.Hotels-Cityhotels-ResultItemSearchForm,.locationContainer,.reviewGrid,.address,.roomCompare,.compare-toggle-wrapper,.js-freebies-tooltip,.js-htc-skip-open,.Common-Results-Mercury-HotelRecommendation,.location-link").length&&(d(b.target).hasClass("js-show-deals-trigger")?
a.openDetailsPageOrToggleOpen(null,"rates"):d(b.target).hasClass("deal-banner")?a.openDetailsPageOrToggleOpen(null,"rates"):a.openDetailsPageOrToggleOpen(null),c.events.publish("hotel.result.click",{resultId:a.options.resultId}))});this.subscribe("result.details.tab.changed",{resultId:a.options.resultId},function(b){a.currentTab=b.activeTab});this.registerEvent("click",this.getChildElement("detailsLink"),function(){a.openDetailsPageOrToggleOpen(null,null)})},setDebugPanelEvents:function(){var a=this;
this.subscribe("common.result.admin.rankingdebug.show",{},function(){a.openRankingDebugPanel()});this.subscribe("common.result.admin.rankingdebug.hide",{},function(){a.closeRankingDebugPanel()});this.registerEvent("click",this.getChildElement("show-rank-debug-link"),function(b){b.stopPropagation();a.toggleRankingDebugPanel()});this.registerEvent("click",this.getChildElement("hide-rank-debug-link"),function(b){b.stopPropagation();a.toggleRankingDebugPanel()})},toggleWatch:function(){if(this.options.isUserLoggedIn)this.handleWatch();
else{c.storage.set("hotels.results.watch.pending",this.dataResultId);var a={promoType:"watch",promo:"watch",showSingleImage:!0,messageParams:[this.options.name,[this.options.formattedCheckinDate,this.options.formattedCheckoutDate].join(" - ")]};c.authentication.showLogin(a)}},handleWatch:function(){var a=this,b=moment(this.options.checkinDate),e=moment(this.options.checkoutDate),b={method:"post",headers:{"X-CSRF":c.globals.formtoken},data:{dt:5,startDate:b.format(c.globals.apiDateFormat),endDate:e.format(c.globals.apiDateFormat),
sendFrequency:1,"deliveryType[]":"email",citycode:this.options.ctid,hid:this.options.hotelId,rooms:this.options.rooms,guests:this.options.guests,email:!0}};d.ajax("/h/hermes/prefs/ajax/alert/v1",b).then(function(b){b.success&&(a.watchId=b.alertId,c.events.publish("watching",{resultId:a.options.resultId,searchId:a.options.searchId}))})},openDetailsPageOrToggleOpen:function(a,b){a=this.options.detailsPageURL;this.options.doesClickOpenDetailsPage&&a&&this.openDetailsPage(b);!this.open&&this.options.scrollIntoViewOnExpand&&
this.scrollIntoView();c.events.publish("hotel.inline.detail.scroll",{resultId:this.options.resultId})},openDetailsPage:function(a){var b=this.options.detailsPageURL;a&&(b=0<b.indexOf("#")?b.replace(/#(\w)+/,"#"+a):b+"#"+a);c.Analytics.api.trackEvent({category:"hotelResultItem",action:"openDetailsPage"});this.options.detailsPageInSameWindow?window.location.href=b:window.open(b,this.options.resultId)},scrollIntoView:function(){var a=this.element.offset().top,b=a+this.element.height()+400,c=d(window).height()+
d(window).scrollTop();b>c&&d("html, body").animate({scrollTop:a-10},300)},toggleRankingDebugPanel:function(){this.getChildElement("show-rank-debug-link").toggle();this.getChildElement("hide-rank-debug-link").toggle();this.getChildElement("ranking-debug-panel").toggle()},openRankingDebugPanel:function(){this.getChildElement("show-rank-debug-link").hide();this.getChildElement("hide-rank-debug-link").show();this.getChildElement("ranking-debug-panel").show()},closeRankingDebugPanel:function(){this.getChildElement("show-rank-debug-link").show();
this.getChildElement("hide-rank-debug-link").hide();this.getChildElement("ranking-debug-panel").hide()},trackBookit:function(){var a=this;c.config.getBoolean("ui.tracking.gtm.bookit.enabled",!1)&&this.subscribe("provider.book.click",function(b){if(a.options.resultId===b.resultId){var e=-1<["KAYAK","SWOODOO","CHECKFELIX"].indexOf(b.providerName)?"checkout":"book",f=d.extend(b,{pageType:"interstitial",rate:1,hotelName:a.options.name,brand:a.options.brand,brandId:a.options.brandId,parentBrandId:a.options.parentBrandId,
starRating:a.options.stars});setTimeout(function(){c.events.publish("gtm.update",{event:e,pageId:e,subPageId:b.providerName,pixelContext:f})},1)}})},adjustHBOFontSize:function(){var a=this.element.find(".hbo-message"),b;a.length&&a.width()>a.closest(".hbo").width()&&(b=parseInt(a.css("fontSize"),10)-1,11<=b&&(a.css({fontSize:parseInt(a.css("fontSize"),10)-1}),this.adjustHBOFontSize.call(this)))},showDriveByAlertDialog:function(){c.ajax.execute("hotels/results/HotelPriceAlertDriveBy",{data:{searchId:this.options.searchId,
resultId:this.options.resultId},replace:!0})}})})(R9,jQuery);(function(c){c.createComponentClass("hotels.results.brands.htc.HotelResultItem","hotels.results.HotelResultItem",{compareWebsitesButton:null,options:{},init:function(){this.compareWebsitesButton=this.getChildElement("compareWebsites");this.base()},addEventHandlers:function(){this.base();var a=this;this.compareWebsitesButton.on("click",function(b){b.stopPropagation();c.events.publish("hotels.results.openDetailsPage",{resultId:a.options.resultId,tab:"rates",event:b})});this.subscribe("hotels.results.openDetailsPage",
{resultId:a.options.resultId},this.openDetails.bind(this))},openDetails:function(a){a.hasOwnProperty("tab")&&(c.events.publish("track.result.details.open",{resultId:this.options.resultId,activeTab:a.tab,source:a.source}),this.openDetailsPage(a.tab))},openDetailsPage:function(a){var b=this.options.detailsPageURL;this.options.doesClickOpenDetailsPage&&b&&(a&&(b+="#"+a),c.Analytics.api.trackEvent({category:"hotelResultItem",action:"openDetailsPage"}),window.open(b,"_blank"))}})})(window.R9);(function(a,e){a.createComponentClass("common.kn.rp.Inline",{addEventHandlers:function(){var c=this;this.element.on("keypress",function(b){switch(b.which){case a.globals.keyCodes.SPACE:case a.globals.keyCodes.RETURN:c.element.click()}});var d=this.getChildElement("skip");d.length&&d.click(function(b){b.stopPropagation();b=e("[tabbable]");var a=b.index(c.element)+1;a>=b.length&&(a=0);b.eq(a).get(0).focus()})}})})(R9,jQuery);(function(a,c){a.createComponentClass("hotels.results.brands.hotelscombined.HotelResultsList",{options:{hcHotelIds:[],firstHcHotelId:0},init:function(){var b=this;a.question.answer("hotels.results.hcHotelIds",function(){return b.options.hcHotelIds});a.question.answer("hotels.results.firstHcHotelId",function(){return b.options.firstHcHotelId})}})})(R9,jQuery);(function(d,e){function k(a,b){if(a)for(var c=0,d=a.childElementCount;c<d;c++)if(a.children){var h=b?a.children[d-c-1]:a.children[c],f=h;if((f&&null!==f.getAttribute("tabindex")&&""!==f.getAttribute("tabindex")&&"-1"!==f.getAttribute("tabindex")||-1<l.indexOf(f.tagName)||"INPUT"===f.tagName&&"hidden"!==f.getAttribute("type"))&&e(f).is(":visible")||(h=k(h,b)))return h}}var l=["SELECT","A","BUTTON","TEXTAREA"];d.createWidgetClass("dialog.Dialog",{content:null,contentBody:null,closeButton:null,modalBackground:null,
focusBoundaries:null,initialFocus:null,lastFocus:null,options:{fullHeight:!1,customWidth:!1,modal:!0,blur:!1,onClose:null,onOpen:null,afterClose:null,afterOpen:null,initialFocusId:null,preventInitialFocus:!1,closeOnModalClick:!0,hasKeyboardControl:!0,openImmediately:!1,preventClose:!1,returnFocus:!0,scrollToTopOnMobile:!1,forceOpen:!1,renderInline:!1,isMobile:!1,isOpenTopZindex:!1,iframeResize:!0,iframeTopGapPercent:.08,preventClosingClickBubble:!1},topLevelComponent:null,returnElement:null,init:function(){this.resizeEventName=
"resize."+this.id();this.content=this.getChildElement("content");this.contentBody=this.getChildElement("body");this.closeButton=this.getChildElement("close");this.modalBackground=this.getChildElement("modal");this.viewport=this.getChildElement("viewport");this.modal=this.getChildElement("modal");this.modalUniqueClass="modal-class-"+this.modal.attr("id")},addEventHandlers:function(){var a=this,b=this.closeOnModalClick.bind(this);this.options.preventClose||(this.options.hasKeyboardControl&&(this.registerEvent("keydown",
e(document),function(b){a.options.preventClose||b.which!==d.globals.keyCodes.ESC||a.close(!0)}),this.registerEvent("keypress",this.closeButton,function(b){if(!a.options.preventClose)switch(b.which){case d.globals.keyCodes.RETURN:a.close(!0)}})),this.registerEvent("click",this.closeButton,function(){a.options.preventClose||a.close(!0)}));this.options.closeOnModalClick&&this.registerEvent("click",this.viewport,b);this.registerEvent("click",this.content,function(){a.viewport.off("click",b);setTimeout(function(){if(a.options.closeOnModalClick)a.viewport.on("click",
b)},50)});this.subscribe("dialogs.close",function(){a.isOpen()&&a.close()});this.options.preventClosingClickBubble&&this.registerEvent("click",this.element,function(a){a.stopPropagation()});this.content.one("transitionend",function(){d.events.publish("dialog.transitionend",a.content.attr("class"))})},inlineComponentsReady:function(){var a=this;this.options.modal||this.modalBackground.hide();this.topLevelComponent=this.contentBody.children("div").eq("0");this.options.renderInline&&e(d.config.getString("ui.horizon.output.container",
"body")).append(this.element);this.options.openImmediately?(this.element.addClass("animate"),d.dom.schedule(this.open.bind(this))):setTimeout(function(){a.element.addClass("animate")},100);this.getChildElement("focusStartBoundary").focus(this.resetFocus.bind(this,!1));this.getChildElement("focusEndBoundary").focus(this.resetFocus.bind(this,!0))},closeOnModalClick:function(a){a=e(a.target).closest(".content");this.content[0]===a[0]||this.options.preventClose||this.close(!0)},calculateDimensions:function(){if(this.topLevelComponent&&
this.topLevelComponent.length){var a=this.topLevelComponent[0].getBoundingClientRect(),b=this.content[0].getBoundingClientRect(),c="number"===typeof this.topLevelComponent.outerWidth()?Math.ceil(a.width):null,a="number"===typeof this.topLevelComponent.outerHeight()?Math.ceil(a.height):null;this.options.customWidth||c===Math.ceil(b.width)||this.content.width(c);this.options.fullHeight||a===Math.ceil(b.height)||this.content.height(a)}},resetFocus:function(a){(a=a?this.closeButton:this.lastFocus?this.lastFocus:
this.findFirstFocusableElement(!0))&&"function"===typeof a.focus&&a.focus();return!1},handleKeyPress:function(a){switch(a.which){case d.globals.keyCodes.ESC:this.close(!0)}},setContentDimensions:function(a,b,c){void 0!==a&&this.content.width(a);void 0!==b&&this.content.height(b);c&&this.content.css({maxWidth:c})},setViewPortOverflow:function(a,b){this.viewport&&this.viewport.length&&(a&&this.viewport.css({overflowX:a}),b&&this.viewport.css({overflowX:b}))},setContent:function(a){this.contentBody.html(a);
this.topLevelComponent=this.contentBody.children("div").eq("0")},close:function(a){var b=this;if(this.isOpen()&&!this.options.forceOpen){var c,g=e("body");this.isTouchDevice()&&(c=g.css("top").replace("-","").replace("px",""),g.css({overflow:"",position:"",width:""}));this.options.iframeResize&&window.parentIFrame&&"function"===typeof window.parentIFrame.getPageInfo&&window.parentIFrame.getPageInfo(!1);g.scrollTop(c);this.element.removeClass("visible");this.element.attr("aria-hidden",!0);d.globals.testMode&&
this.element.attr("data-test-popover-open",!1);if("function"===typeof this.options.onClose)this.options.onClose(this.element,a);d.events.publish("dialog.close",{id:b.id()});this.options.blur&&d.events.publish("pageContainer.contentBlur",!1);g.removeClass(this.modalUniqueClass);0>g.attr("class").indexOf("modal-class-")&&g.removeClass("hideOverflow modal-open");this.returnElement&&this.returnElement.length&&(this.returnElement.focus(),this.returnElement=null);e(window).off(this.resizeEventName);setTimeout(function(){"function"===
typeof b.options.afterClose&&b.options.afterClose()},50)}},open:function(a){if(!this.isOpen()){this.topLevelComponent&&0!==this.topLevelComponent.length||(this.topLevelComponent=this.contentBody.children("div").eq("0"));this.options.preventClose&&this.closeButton.hide();this.options.returnFocus&&(this.returnElement=e(document.activeElement));if(this.options.isOpenTopZindex){var b=0;this.element.siblings("[role\x3ddialog],[role\x3dalertdialog]").each(function(){var a=window.parseInt(e(this).css("z-index"));
a&&a>b&&(b=a)});0<b&&this.element.css("z-index",b+1)}d.events.publish(["common.dropdown.closeAll","common.widgets.tooltip.closeAll"]);this.element.addClass("visible");this.element.attr("aria-hidden",!1);d.globals.testMode&&this.element.attr("data-test-popover-open",!0);null===this.initialFocus&&this.setFocusTargets();this.options.preventInitialFocus||this.focusInitialElement();this.options.iframeResize&&window.parentIFrame&&"function"===typeof window.parentIFrame.getPageInfo&&window.parentIFrame.getPageInfo(this.positionOnIframe.bind(this));
if("function"===typeof this.options.onOpen)this.options.onOpen(this.element);"function"===typeof a&&a(this.element);this.modalBackground.length&&(e("body").addClass("hideOverflow modal-open"),e("body").addClass(this.modalUniqueClass));this.options.blur&&d.events.publish("pageContainer.contentBlur",!0);null!==this.topLevelComponent&&setTimeout(this.calculateDimensions.bind(this),1);this.isTouchDevice()&&this.options.scrollToTopOnMobile&&e("body").css({overflow:"hidden",position:"fixed",width:"100%"});
e(window).off(this.resizeEventName).on(this.resizeEventName,this.calculateDimensions.bind(this));"function"===typeof this.options.afterOpen&&this.options.afterOpen()}},positionOnIframe:function(a){if(a&&this.viewport){var b=a.clientHeight*this.options.iframeTopGapPercent,c=a.scrollTop;a=a.offsetTop;this.content.addClass("no-margin");c<a?this.viewport.css("top",0):c-a<b?this.viewport.css("top",2*(c-a)+"px"):c-a+b+this.content.height()>=this.modal.height()?this.viewport.css("top",this.modal.height()-
this.content.height()+"px"):this.viewport.css("top",c-a+Math.round(b)+"px")}},focusInitialElement:function(){var a=this;setTimeout(function(){var b=a.initialFocus&&a.initialFocus.get(0);b&&"function"===typeof b.focus&&b.focus()},501)},setFocusTargets:function(){this.focusBoundaries=this.getChildElement("focusStartBoundary").add(this.getChildElement("focusEndBoundary"));this.initialFocus=this.findFirstFocusableElement(!1);this.lastFocus=this.findFirstFocusableElement(!0)},findFirstFocusableElement:function(a){if(this.options.initialFocusId&&
!a)return e("#"+this.options.initialFocusId);a=k(this.contentBody[0],a);a||(a=this.closeButton);return e(a)},isOpen:function(){return this.element.hasClass("visible")},isTouchDevice:function(){return"ontouchstart"in window||navigator&&navigator.maxTouchPoints},destroy:function(){this.base();this.content.off("transitionend");this.element.remove()}})})(R9,jQuery);(function(a,c){a.createComponentClass("common.results.BookingLinksExpiredDialog",{expiredResultsDialog:null,options:{redirectUrl:""},addEventHandlers:function(){a.events.subscribe("search.expired",this.showBookingLinksExpiredDialog.bind(this))},showBookingLinksExpiredDialog:function(){var b=this;if(null===this.expiredResultsDialog){this.expiredResultsDialog=this.element.dialog({onClose:function(){a.events.publish("resultspage.transition.remove")}}).getWidget();var d=this.options.redirectUrl?this.options.redirectUrl:
"/";this.getChildElement("home-btn").click(function(){a.Analytics.api.trackEvent("booklinkexpired/homepage");window.location=d});this.getChildElement("refresh-btn").click(function(){c(document.body).css("cursor","wait");a.Analytics.api.trackEvent("booklinkexpired/refresh");a.config.getInt("ui.rp.limitExpiredReload",!0)?(a.events.publish("user.refresh.expired"),b.expiredResultsDialog&&b.expiredResultsDialog.close()):window.location.reload()})}this.expiredResultsDialog.open()}})})(R9,jQuery);(function(b){window.showUsSanctionedCountriesPopup=function(){window.open("http://www.treasury.gov/resource-center/sanctions/Programs/Pages/Programs.aspx","_blank")};b.createComponentClass("common.results.SearchFailed",{defaultErrorMessage:null,hasUniqueNoResultsMessage:!1,failureTypes:{BAD_QUERY:"query",NO_RESULTS:"noresults",SERVER_ISSUE:"server",TIMEOUT:"timeout"},init:function(){var a=this;this.defaultErrorMessage=this.getChildElement("reason").html();b.events.when(["common.results.NoResults.ready",
"rentals.results.RentalNoResults.ready"],function(){a.hasUniqueNoResultsMessage=!0})},addEventHandlers:function(){var a=this;b.events.subscribe("search.searchFailed",this.handleSearchFailure.bind(this));b.events.subscribe("search.startSearch",this.hideSearchFailedView.bind(this));b.events.subscribe("resultspage.requestResults",this.hideSearchFailedView.bind(this));b.question.answer("SearchFailed.isNoResultsStatus",function(b){return a.failureTypes.NO_RESULTS===b})},handleSearchFailure:function(a){this.hasUniqueNoResultsMessage&&
a&&a.type===this.failureTypes.NO_RESULTS?this.hideSearchFailedView():this.showSearchFailedView(a&&a.userDisplayMessage?a.userDisplayMessage:this.defaultErrorMessage)},showSearchFailedView:function(a){this.getChildElement("reason").html(a);this.element.show()},hideSearchFailedView:function(){this.element.hide()}})})(R9);(function(a){a.createComponentClass("common.results.NoResults","common.results.SearchFailed",{options:{vertical:null},addEventHandlers:function(){this.base();var b=this;a.events.ready("common.results.NoResults.ready",this.element);this.getChildElement("newSearchLink").click(function(c){c.preventDefault();a.events.publish(b.options.vertical+".inline.search.form.show",{focus:!0});return!1});a.events.subscribe("search.searchFailed",this.handleSearchFailure.bind(this))},handleSearchFailure:function(a){a&&
a.type===this.failureTypes.NO_RESULTS&&this.showSearchFailedView()}})})(R9);(function(d,c){d.createComponentClass("common.results.Paginator",{trackCategory:"Pagination",activeIndex:0,pageCount:0,pageNumberTemplateId:"paginatorItem",numbered:!0,loader:null,loading:!1,activeSearch:!1,options:{button:!1,buttonInfinite:!0,infinite:!1,silent:!1,maxPages:5,infiniteScrollingOffset:0,logUserInteraction:!1,disableDuringPolling:!1},init:function(){this.numbered=!this.options.button&&!this.options.infinite;this.numbered||(this.loader=this.getChildElement("loader"))},addEventHandlers:function(){var a=
this;this.subscribe("resultspage.searchId.changed",function(){a.activeSearch=!0});this.subscribe("resultspage.pageNumber.changed",function(b){a.setIndex(b);a.updateDOM()});this.subscribe("paginator.update",function(b){a.setIndex(b.pageNumber);a.updateBounds(b.pageCount);if(a.options.infinite)if(b.pageNumber===b.pageCount)c(window).off("scroll.pagination");else if(1===b.pageNumber)c(window).on("scroll.pagination",a.scrollPagination.bind(a));if(a.options.button){if(b.pageNumber>=b.pageCount||1===b.pageNumber||
!a.options.buttonInfinite)c(window).off("scroll.pagination");else if(2===b.pageNumber)c(window).on("scroll.pagination",a.scrollPagination.bind(a));b.pageNumber>=b.pageCount||0===b.pageCount?a.element.removeClass("visible"):a.element.addClass("visible")}a.updateDOM();a.getChildElement("loadMore").blur()});this.subscribe("paginator.hide",function(){a.element.removeClass("visible")});this.numbered?(this.element.find("a.page-Previous").click(function(b){1>=a.activeIndex?b.preventDefault():(a.options.logUserInteraction&&
a.logUserInteraction("Prev"),a.userChangedIndex(--a.activeIndex))}),this.element.find("a.page-Next").click(function(b){a.activeIndex>=a.pageCount?b.preventDefault():(a.options.logUserInteraction&&a.logUserInteraction("Next"),a.userChangedIndex(++a.activeIndex))})):this.subscribe("search.poll.response",function(){a.element.removeClass("loading");a.loading=!1});this.options.button&&(this.getChildElement("loadMore").click(function(){a.element.addClass("loading");a.logUserInteraction("More");a.userChangedIndex(++a.activeIndex)}),
this.getChildElement("loadMore").keypress(function(b){switch(b.which){case d.globals.keyCodes.RETURN:case d.globals.keyCodes.SPACE:a.getChildElement("loadMore").click()}}),this.subscribe("paginator.text.set",function(b){a.getChildElement("loadMore").text(b)}));if(this.options.infinite)c(window).on("scroll.pagination",a.scrollPagination.bind(a));this.options.disableDuringPolling&&(this.subscribe("resultspage.streaming.start",this.disablePaginator.bind(this,!0)),this.subscribe("resultspage.streaming.done",
this.disablePaginator.bind(this,!1)))},logUserInteraction:function(a,b){d.Analytics.api.trackEvent({category:this.trackCategory,action:a,label:b})},scrollPagination:function(){!this.loading&&this.activeSearch&&this.element.offset().top<c(window).scrollTop()+(c(window).height()+this.options.infiniteScrollingOffset)&&(this.element.addClass("loading"),this.loading=!0,this.userChangedIndex(++this.activeIndex))},disablePaginator:function(a){this.element.toggleClass("disabled",a)},userChangedIndex:function(a){this.setIndex(a);
d.events.publish("paginator.change",{pageNumber:a,append:this.options.button||this.options.infinite})},setIndex:function(a){this.activeIndex=a},getIndex:function(){return this.activeIndex},updateBounds:function(a){this.pageCount!==a&&(this.pageCount=a)},updateDOM:function(){var a=this;this.numbered&&!this.options.silent&&c("[page-idx]").each(function(){parseInt(c(this).attr("page-idx"))===a.activeIndex?c(this).removeClass("Paginator-Item-Hidden"):c(this).addClass("Paginator-Item-Hidden")});this.options.infinite||
this.options.button||(1<this.pageCount?(this.element.addClass("visible"),this.numbered&&(this.renderDisplayRange(),this.element.find("a.page-Next, a.page-Previous").removeClass("disabled"),this.activeIndex===this.pageCount?this.element.find("a.page-Next").addClass("disabled"):1===this.activeIndex&&this.element.find("a.page-Previous").addClass("disabled"))):this.element.removeClass("visible"))},renderPageLink:function(a){return d.template.render(this.pageNumberTemplateId,{index:a,cssClass:a===this.activeIndex?
"active":""})},renderEllipsis:function(){return"\x3cspan\x3e\x26nbsp;\x26hellip;\x26nbsp;\x3c/span\x3e"},renderDisplayRange:function(){var a=this,b=this.element.find("div.page-Numbers");b.html("");var d=this.renderPageLink(1),e=0<this.activeIndex-1?this.activeIndex-1:1,f=e+this.options.maxPages-1;f>=this.pageCount&&(f=this.pageCount,e=f-this.options.maxPages+1);for(2<e?d+=this.renderEllipsis():2>e?e=2:--f;e<f;e++)d+=this.renderPageLink(e);f<this.pageCount&&(d+=this.renderEllipsis());d+=this.renderPageLink(this.pageCount);
b.html(d).find("a").click(function(){c(this).parent().hasClass("active")||(a.options.logUserInteraction&&a.logUserInteraction("Page",c(this).data("idx")),a.userChangedIndex(c(this).data("idx")),c(this).parent().addClass("active"))})}})})(R9,jQuery);(function(c,d){c.createComponentClass("hotels.results.HotelResultsFooterDisclaimers",{estimatedDisclaimer:null,taxesEstimated:null,priceType:null,options:{searchId:null,msg:{priceTypeStrings:{daybase:null,daytaxes:null,totaltaxes:null}}},init:function(){this.estimatedDisclaimer=this.getChildElement("estimated-disclaimer");this.priceTypeDisclaimer=this.getChildElement("price-type-disclaimer")},addEventHandlers:function(){var b=this;this.element.find(".pricesNotGuaranteed").on("click",function(){b.element.find(".fullPriceGuaranteeDisclaimer").toggle()});
this.searchIdChangedCallback=c.events.subscribe("resultspage.searchId.changed",function(a){});c.events.subscribe("resultsHeader.changed",function(a){a&&a.hasOwnProperty("priceType")&&(b.priceType=a.priceType,b.updateEstimatedDisclaimer())});c.events.subscribe("resultspage.taxesEstimated.changed",function(a){a&&a.hasOwnProperty("taxesEstimated")&&!b.taxesEstimated&&(b.taxesEstimated=a.taxesEstimated,b.updateEstimatedDisclaimer())});c.events.subscribe("resultspage.priceType.changed",function(a){a&&
a.hasOwnProperty("priceType")&&(b.priceType=a.priceType,b.updatePriceTypeDisclaimer())})},updateEstimatedDisclaimer:function(){this.taxesEstimated||"daytaxes"===this.priceType||"totaltaxes"===this.priceType?this.estimatedDisclaimer.removeClass("hidden"):this.estimatedDisclaimer.addClass("hidden")},updatePriceTypeDisclaimer:function(){this.priceTypeDisclaimer.text(this.options.msg.priceTypeStrings[this.priceType])}})})(R9,jQuery);(function(c,f){c.createComponentClass("common.results.AfterclickContainer",{options:{searchId:"",url:"",rateLimitCount:-1,rateLimitPeriod:864E5,rateLimitStorageKey:"hotel_afterclick_last",inMemory:!1,ignore:!1,rateLimited:!0},memory:[],dialogContent:null,dialog:null,init:function(){var a=this.options;this.dialogContent=this.getChildElement("content");a.rateLimitStorageKey||(a.rateLimitStorageKey="hotel_afterclick_last")},addEventHandlers:function(){var a=this,b=a.options;a.subscribe("multibook.providerClicked",
function(d){d&&d.afterclickIgnore||b.ignore||a.openAfterclick(d.resultId)});a.subscribe("resultspage.searchId.changed",function(d){var c=b.searchId;d&&c!==d.searchId&&(b.searchId=d.searchId,a.update())})},update:function(){var a=this;c.ajax.execute("common/results/AfterclickContainer",{data:a.options,replace:!0,customUpdate:function(b){a.destroy();a.element.replaceWith(b.innerHTML);return!0}})},rateLimit:function(){var a=this.options,b=a.rateLimitStorageKey;return"prevent"===c.storage.get("prevent-afterclick")?
(c.storage.remove("prevent-afterclick"),!0):a.rateLimited?a.inMemory?(b=this.getTimeList(this.memory))?(this.memory=b,!1):!0:c.storage.isAvailable()&&b?(a=this.getTimeList(c.storage.get(b)))?(c.storage.set(b,a),!1):!0:!1:!1},getTimeList:function(a){var b=new Date,d=this.options,c=isNaN(d.rateLimitCount)?2:d.rateLimitCount,d=isNaN(d.rateLimitPeriod)?864E5:d.rateLimitPeriod;if(0===c)return null;"string"===typeof a&&(a=[]);if(!a||a.length<c)return a?a.concat(b.getTime()):[b.getTime()];for(var e=0;e<
c;e++){if(isNaN(a[e]))return[b.getTime()];if(b.getTime()-(new Date(a[e])).getTime()>d)return a[e]=b.getTime(),a}return null},openAfterclick:function(a){var b=this;b.dialog&&b.dialog.isOpen()||!b.options.url||!b.options.searchId||b.rateLimit()||(b.dialog&&b.dialog.setContentDimensions("auto","auto"),a={resultId:a,searchId:b.options.searchId},c.Analytics.api.trackEvent({category:"AfterClick",action:"request"}),c.ajax.execute(b.options.url,{data:a,appendTo:this.dialogContent,replace:!0}).then(function(){b.dialog=
b.getChildElement("afterclickdialog").dialog({extraCssClass:"afterclickModal"}).getWidget();var a=b.getChildElement("content").children().eq(0);if(f("#acerror").length){try{c.Analytics.api.trackEvent({category:"AfterClick",action:"failed",label:f("#acerror").get(0).innerText.trim()})}catch(g){}console.log(f("#acerror").get(0).innerText)}else c.Analytics.api.trackEvent({category:"AfterClick",action:"displayed"}),b.options.responsive?(b.dialog.setContentDimensions(a.outerWidth(),a.outerHeight(),"95%"),
b.dialog.setViewPortOverflow("hidden")):b.dialog.setContentDimensions(a.outerWidth(),a.outerHeight()),b.dialog.setOption("onClose",function(){c.Analytics.api.trackEvent({category:"AfterClick",action:"closed"})}),b.dialog.open(),c.events.publish("afterclick.dialog.opened")}).fail(function(){c.Analytics.api.trackEvent({category:"AfterClick",action:"failed",label:"ajax"})}))}})})(window.R9,window.jQuery||window.jq);(function(g,c){g.createWidgetClass("text.EmailInput",{options:{maxEmails:-1,placeholder:"",readonly:!1},inputElem:null,init:function(){this.inputElem=this.getChildElement("inputEl");var a=this;setTimeout(function(){a.processValue(a.inputElem.val())},1)},addEventHandlers:function(){var a=this;this.addInputEventHandlers();this.element.on("click",".email",function(){c(this).remove();a.checkRestrictions();a.updateValue()})},addInputEventHandlers:function(){var a=this,d=!0;a.inputElem.on("keyup",function(b){switch(b.which){case 32:a.handleSpaceKey();
break;case 8:b=a.inputElem.val();var e=b.split(" "),e=a.addEmail(e);c.trim(b)!==c.trim(e)&&a.inputElem.val(e);d=!0;break;default:a.checkComma()}}).on("keydown",function(b){switch(b.which){case 13:case 9:a.handleReturnKey(b);break;case 8:0===a.getCaretPosition()&&d&&(a.element.find(".email").last().remove(),a.checkRestrictions(),a.updateValue()),d=!1}}).on("focus",function(){a.element.addClass("focused")}).on("blur",function(b){a.handledReturnID||a.handleReturnKey(b);a.element.removeClass("focused")})},
checkComma:function(){var a=c.trim(this.inputElem.val());","===a[a.length-1]&&(a=this.addEmail([a.substring(0,a.length-1)]),""===c.trim(a)&&this.inputElem.val(""))},handleSpaceKey:function(){""===this.addEmail([this.inputElem[0].value])&&(this.inputElem[0].value="")},handleReturnKey:function(a){var d=this;d.handledReturnID&&clearTimeout(d.handledReturnID);this.handledReturnID=setTimeout(function(){d.handledReturnID=null},100);var b=this.inputElem[0].value,e=b.split(" ");this.addEmail(e,!0);this.inputElem[0].value=
"";if(13===a.which||""!==c.trim(b))a.stopPropagation(),a.preventDefault()},getCaretPosition:function(){var a=0,d=this.inputElem[0];if(document.selection)d.focus(),a=document.selection.createRange(),a.moveStart("character",-d.value.length),a=a.text.length;else if(d.selectionStart||"0"==d.selectionStart)a=d.selectionStart;return a},val:function(a){if("undefined"!==typeof a)this.processValue(a);else return this.getValue()},processValue:function(a){this.element.find(".email").remove();this.inputElem[0].value=
a?this.addEmail(a.split(",")):"";this.updateValue()},isValidEmail:function(a){a=c.trim(a);return"function"===typeof window.validateEmail?validateEmail(a):/^[a-zA-Z0-9.!#$%&\u2019*+/=?^_`{|}~-]+@[a-zA-Z0-9-]+(?:\.[a-zA-Z0-9-]+)*$/.test(a)},prepareEmailElem:function(a){a=c.trim(a);if(!a)return!1;var d=c("\x3cdiv class\x3d'email'\x3e\x3c/div\x3e");c(document.createTextNode(a)).appendTo(d);return d},addEmail:function(a,d){var b=this,e="";c.each(a,function(c,f){if(0<b.options.maxEmails&&c>=b.options.maxEmails)return!1;
if(b.isValidEmail(f)){if(c=b.prepareEmailElem(f))c.insertBefore(b.inputElem),b.checkRestrictions(),b.updateValue()}else{a.splice(0,c);c=a.join(" ");if(d){if(c=b.prepareEmailElem(c))c.insertBefore(b.inputElem),b.checkRestrictions(),b.updateValue()}else e=c;return!1}});return e},updateValue:function(){var a=this.element.find(".email").map(function(){return c(this).text()}).get().join();this.element.val(a);this.getChildElement("hidnEl").val(a)},getValue:function(){var a=this.element.val(),d=c.trim(this.inputElem.val());
""!==d&&(a+=","+d);return a},checkRestrictions:function(){var a=this.element.find(".email").length;0<this.options.maxEmails&&(a>=this.options.maxEmails?(this.element.addClass("disabled"),this.inputElem.prop("disabled",!0)):(this.element.removeClass("disabled"),this.inputElem.prop("disabled",!1)));a?(this.inputElem.prop("placeholder",""),this.options.readonly&&this.inputElem.prop("readonly","readonly")):(this.inputElem.prop("placeholder",this.options.placeholder),this.options.readonly&&this.inputElem.prop("readonly",
""))}})})(window.R9,window.jq||window.jQuery);/*
 clipboard.js v1.7.1
 https://zenorocha.github.io/clipboard.js

 Licensed MIT © Zeno Rocha
*/
(function(m){"object"==typeof exports&&"undefined"!=typeof module?module.exports=m():"function"==typeof define&&define.amd?define([],m):("undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this).Clipboard=m()})(function(){return function f(h,k,a){function b(d,g){if(!k[d]){if(!h[d]){var c="function"==typeof require&&require;if(!g&&c)return c(d,!0);if(e)return e(d,!0);g=Error("Cannot find module '"+d+"'");throw g.code="MODULE_NOT_FOUND",g;}g=k[d]={exports:{}};
h[d][0].call(g.exports,function(a){return b(h[d][1][a]||a)},g,g.exports,f,h,k,a)}return k[d].exports}for(var e="function"==typeof require&&require,l=0;l<a.length;l++)b(a[l]);return b}({1:[function(f,h,k){"undefined"==typeof Element||Element.prototype.matches||(f=Element.prototype,f.matches=f.matchesSelector||f.mozMatchesSelector||f.msMatchesSelector||f.oMatchesSelector||f.webkitMatchesSelector);h.exports=function(a,b){for(;a&&9!==a.nodeType;){if("function"==typeof a.matches&&a.matches(b))return a;
a=a.parentNode}}},{}],2:[function(f,h,k){function a(a,l,d,g){return function(c){c.delegateTarget=b(c.target,l);c.delegateTarget&&g.call(a,c)}}var b=f("./closest");h.exports=function(b,l,d,g,c){var e=a.apply(this,arguments);return b.addEventListener(d,e,c),{destroy:function(){b.removeEventListener(d,e,c)}}}},{"./closest":1}],3:[function(f,h,k){k.node=function(a){return void 0!==a&&a instanceof HTMLElement&&1===a.nodeType};k.nodeList=function(a){var b=Object.prototype.toString.call(a);return void 0!==
a&&("[object NodeList]"===b||"[object HTMLCollection]"===b)&&"length"in a&&(0===a.length||k.node(a[0]))};k.string=function(a){return"string"==typeof a||a instanceof String};k.fn=function(a){return"[object Function]"===Object.prototype.toString.call(a)}},{}],4:[function(f,h,k){function a(a,b,c){return a.addEventListener(b,c),{destroy:function(){a.removeEventListener(b,c)}}}function b(a,b,c){return Array.prototype.forEach.call(a,function(a){a.addEventListener(b,c)}),{destroy:function(){Array.prototype.forEach.call(a,
function(a){a.removeEventListener(b,c)})}}}var e=f("./is"),l=f("delegate");h.exports=function(d,g,c){if(!d&&!g&&!c)throw Error("Missing required arguments");if(!e.string(g))throw new TypeError("Second argument must be a String");if(!e.fn(c))throw new TypeError("Third argument must be a Function");if(e.node(d))return a(d,g,c);if(e.nodeList(d))return b(d,g,c);if(e.string(d))return l(document.body,d,g,c);throw new TypeError("First argument must be a String, HTMLElement, HTMLCollection, or NodeList");
}},{"./is":3,delegate:2}],5:[function(f,h,k){h.exports=function(a){if("SELECT"===a.nodeName)a.focus(),a=a.value;else if("INPUT"===a.nodeName||"TEXTAREA"===a.nodeName){var b=a.hasAttribute("readonly");b||a.setAttribute("readonly","");a.select();a.setSelectionRange(0,a.value.length);b||a.removeAttribute("readonly");a=a.value}else{a.hasAttribute("contenteditable")&&a.focus();var b=window.getSelection(),e=document.createRange();e.selectNodeContents(a);b.removeAllRanges();b.addRange(e);a=b.toString()}return a}},
{}],6:[function(f,h,k){function a(){}a.prototype={on:function(a,e,l){var b=this.e||(this.e={});return(b[a]||(b[a]=[])).push({fn:e,ctx:l}),this},once:function(a,e,l){function b(){g.off(a,b);e.apply(l,arguments)}var g=this;return b._=e,this.on(a,b,l)},emit:function(a){for(var b=[].slice.call(arguments,1),l=((this.e||(this.e={}))[a]||[]).slice(),d=0,g=l.length;d<g;d++)l[d].fn.apply(l[d].ctx,b);return this},off:function(a,e){var b=this.e||(this.e={}),d=b[a],g=[];if(d&&e)for(var c=0,f=d.length;c<f;c++)d[c].fn!==
e&&d[c].fn._!==e&&g.push(d[c]);return g.length?b[a]=g:delete b[a],this}};h.exports=a},{}],7:[function(f,h,k){(function(a,b){if(void 0!==k)b(h,f("select"));else{var e={exports:{}};b(e,a.select);a.clipboardAction=e.exports}})(this,function(a,b){var e=b&&b.__esModule?b:{default:b},f="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(a){return typeof a}:function(a){return a&&"function"==typeof Symbol&&a.constructor===Symbol&&a!==Symbol.prototype?"symbol":typeof a},d=function(){function a(a,
b){for(var c=0;c<b.length;c++){var d=b[c];d.enumerable=d.enumerable||!1;d.configurable=!0;"value"in d&&(d.writable=!0);Object.defineProperty(a,d.key,d)}}return function(c,b,d){return b&&a(c.prototype,b),d&&a(c,d),c}}();b=function(){function a(c){if(!(this instanceof a))throw new TypeError("Cannot call a class as a function");this.resolveOptions(c);this.initSelection()}return d(a,[{key:"resolveOptions",value:function(){var a=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{};this.action=a.action;
this.container=a.container;this.emitter=a.emitter;this.target=a.target;this.text=a.text;this.trigger=a.trigger;this.selectedText=""}},{key:"initSelection",value:function(){this.text?this.selectFake():this.target&&this.selectTarget()}},{key:"selectFake",value:function(){var a=this,b="rtl"==document.documentElement.getAttribute("dir");this.removeFake();this.fakeHandlerCallback=function(){return a.removeFake()};this.fakeHandler=this.container.addEventListener("click",this.fakeHandlerCallback)||!0;this.fakeElem=
document.createElement("textarea");this.fakeElem.style.fontSize="12pt";this.fakeElem.style.border="0";this.fakeElem.style.padding="0";this.fakeElem.style.margin="0";this.fakeElem.style.position="absolute";this.fakeElem.style[b?"right":"left"]="-9999px";this.fakeElem.style.top=(window.pageYOffset||document.documentElement.scrollTop)+"px";this.fakeElem.setAttribute("readonly","");this.fakeElem.value=this.text;this.container.appendChild(this.fakeElem);this.selectedText=(0,e.default)(this.fakeElem);this.copyText()}},
{key:"removeFake",value:function(){this.fakeHandler&&(this.container.removeEventListener("click",this.fakeHandlerCallback),this.fakeHandler=null,this.fakeHandlerCallback=null);this.fakeElem&&(this.container.removeChild(this.fakeElem),this.fakeElem=null)}},{key:"selectTarget",value:function(){this.selectedText=(0,e.default)(this.target);this.copyText()}},{key:"copyText",value:function(){var a=void 0;try{a=document.execCommand(this.action)}catch(p){a=!1}this.handleResult(a)}},{key:"handleResult",value:function(a){this.emitter.emit(a?
"success":"error",{action:this.action,text:this.selectedText,trigger:this.trigger,clearSelection:this.clearSelection.bind(this)})}},{key:"clearSelection",value:function(){this.trigger&&this.trigger.focus();window.getSelection().removeAllRanges()}},{key:"destroy",value:function(){this.removeFake()}},{key:"action",set:function(){if(this._action=0<arguments.length&&void 0!==arguments[0]?arguments[0]:"copy","copy"!==this._action&&"cut"!==this._action)throw Error('Invalid "action" value, use either "copy" or "cut"');
},get:function(){return this._action}},{key:"target",set:function(a){if(void 0!==a){if(!a||"object"!==(void 0===a?"undefined":f(a))||1!==a.nodeType)throw Error('Invalid "target" value, use a valid Element');if("copy"===this.action&&a.hasAttribute("disabled"))throw Error('Invalid "target" attribute. Please use "readonly" instead of "disabled" attribute');if("cut"===this.action&&(a.hasAttribute("readonly")||a.hasAttribute("disabled")))throw Error('Invalid "target" attribute. You can\'t cut text from elements with "readonly" or "disabled" attributes');
this._target=a}},get:function(){return this._target}}]),a}();a.exports=b})},{select:5}],8:[function(f,h,k){(function(a,b){if(void 0!==k)b(h,f("./clipboard-action"),f("tiny-emitter"),f("good-listener"));else{var e={exports:{}};b(e,a.clipboardAction,a.tinyEmitter,a.goodListener);a.clipboard=e.exports}})(this,function(a,b,e,f){function d(a){return a&&a.__esModule?a:{default:a}}function g(a,b){if("function"!=typeof b&&null!==b)throw new TypeError("Super expression must either be null or a function, not "+
typeof b);a.prototype=Object.create(b&&b.prototype,{constructor:{value:a,enumerable:!1,writable:!0,configurable:!0}});b&&(Object.setPrototypeOf?Object.setPrototypeOf(a,b):a.__proto__=b)}function c(a,b){a="data-clipboard-"+a;if(b.hasAttribute(a))return b.getAttribute(a)}var h=d(b);b=d(e);var k=d(f),l="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(a){return typeof a}:function(a){return a&&"function"==typeof Symbol&&a.constructor===Symbol&&a!==Symbol.prototype?"symbol":typeof a},
n=function(){function a(a,b){for(var d=0;d<b.length;d++){var c=b[d];c.enumerable=c.enumerable||!1;c.configurable=!0;"value"in c&&(c.writable=!0);Object.defineProperty(a,c.key,c)}}return function(b,d,c){return d&&a(b.prototype,d),c&&a(b,c),b}}();f=function(a){function b(a,d){if(!(this instanceof b))throw new TypeError("Cannot call a class as a function");var c;c=(b.__proto__||Object.getPrototypeOf(b)).call(this);if(!this)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");
c=!c||"object"!=typeof c&&"function"!=typeof c?this:c;return c.resolveOptions(d),c.listenClick(a),c}return g(b,a),n(b,[{key:"resolveOptions",value:function(){var a=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{};this.action="function"==typeof a.action?a.action:this.defaultAction;this.target="function"==typeof a.target?a.target:this.defaultTarget;this.text="function"==typeof a.text?a.text:this.defaultText;this.container="object"===l(a.container)?a.container:document.body}},{key:"listenClick",
value:function(a){var b=this;this.listener=(0,k.default)(a,"click",function(a){return b.onClick(a)})}},{key:"onClick",value:function(a){a=a.delegateTarget||a.currentTarget;this.clipboardAction&&(this.clipboardAction=null);this.clipboardAction=new h.default({action:this.action(a),target:this.target(a),text:this.text(a),container:this.container,trigger:a,emitter:this})}},{key:"defaultAction",value:function(a){return c("action",a)}},{key:"defaultTarget",value:function(a){if(a=c("target",a))return document.querySelector(a)}},
{key:"defaultText",value:function(a){return c("text",a)}},{key:"destroy",value:function(){this.listener.destroy();this.clipboardAction&&(this.clipboardAction.destroy(),this.clipboardAction=null)}}],[{key:"isSupported",value:function(){var a=0<arguments.length&&void 0!==arguments[0]?arguments[0]:["copy","cut"],b=!!document.queryCommandSupported;return("string"==typeof a?[a]:a).forEach(function(a){b=b&&!!document.queryCommandSupported(a)}),b}}]),b}(b.default);a.exports=f})},{"./clipboard-action":7,
"good-listener":4,"tiny-emitter":6}]},{},[8])(8)});(function(d,e){var f={hotels:"hotels/results/HotelShare",cruises:"cruises/results/CruiseShare",cars:"cars/results/CarShare",packages:"packages/results/PackageShare",rentals:"rentals/results/RentalShare",flights:"flights/results/FlightShare",trains:"trains/results/TrainShare"};d.createComponentClass("common.results.Sharing",{dialog:null,urlInput:null,clipper:null,copyTooltip:null,emailFrom:null,emailTo:null,emailMessage:null,message:null,form:null,send:null,hid:null,rating:null,photoColumn:null,cityName:"",
cityImageUrl:"",trackingEnabled:!1,options:{vertical:"hotels",sourceId:void 0,messages:{},photoColumn:!1,hasRating:!1,useStars:!0,smartEmail:!1,trackingEnabled:!1},init:function(){this.form=this.getChildElement("form");this.urlInput=this.getChildElement("url");this.urlInput.attr("data-clipboard-target","#"+this.id("url"));"undefined"!==typeof window.Clipboard?this.clipper=new Clipboard(".clipboardTrigger"):(this.element.find(".col-copy").hide(),this.element.find(".col-url").removeClass("col-url").addClass("col"));
this.copyTooltip=this.getChildElement("tooltip");this.emailFrom=this.getChildElement("emailFrom");this.emailTo=this.getChildElement("emailTo");this.emailMessage=this.getChildElement("emailMessage");this.hid=this.getChildElement("sharing_email_resultid");this.send=this.getChildElement("send");this.message=this.getChildElement("message");this.options.photoColumn&&(this.options.hasRating&&(this.rating=this.getChildElement("rating").children()),this.photoColumn=this.getChildElement("photoColumn"));this.trackingEnabled=
this.options.trackingEnabled&&!!d.Vestigo},addEventHandlers:function(){var a=this;if(null!==this.clipper)this.clipper.on("success",function(b){d.Analytics.api.trackEvent({category:"Share",action:"copy-link"});a.copyTooltip.addClass("show");setTimeout(function(){a.copyTooltip.removeClass("show")},2E3)});d.events.subscribe("share",function(b){if(b&&("flighttracker"===b.page||"explore"===b.page))return b.sourceId&&b.sourceId!==a.options.sourceId||(a.createDialog(),a.dialog.open(),setTimeout(function(){a.urlInput.val(b.url);
a.urlInput.focus()},100)),!1;var c=f[a.options.vertical];c?a.openForm(b,c):console.warn("No share component found for current vertical: "+a.options.vertical)});this.form.on("submit",function(b){a.options.smartEmail?(a.emailTo.getWidget().val(a.emailTo.val().replace(" ","")),a.emailFrom.getWidget().val(a.emailFrom.val().replace(" ",""))):(a.emailTo.val(a.emailTo.val().replace(" ","")),a.emailFrom.val(a.emailFrom.val().replace(" ","")));b=validateEmail(a.emailFrom.val());var c=a.validateToField();a.emailTo.toggleClass("form-error",
!c);a.emailFrom.toggleClass("form-error",!b);c&&b?(a.send.attr("disabled","disabled"),a.showMessage("SHARING_PROGRESS"),e.ajax({type:"POST",url:d.globals.remoteHost+"/s/emailresult",data:a.form.serialize(),headers:{"X-CSRF":d.globals.formtoken},success:function(){var b=a.getChildElement("sharing_email_resultid").val();d.events.publish("share.success",b);a.send.removeAttr("disabled");a.dialog&&a.showSuccess("SHARING_SUCCESS");d.Analytics.api.trackEvent({category:"Share",action:"share-result"});a.trackShare(b)},
error:function(){a.showError("SHARING_ERROR");a.send.removeAttr("disabled")}})):(a.showError("EMAIL_ERROR"),a.options.smartEmail&&(a.emailTo.getWidget().checkRestrictions(),a.emailFrom.getWidget().checkRestrictions()));return!1})},createDialog:function(){var a=this;this.dialog=this.dialog||this.getChildElement("dialog").dialog({isOpenTopZindex:!0,onClose:function(){a.emailTo.removeClass("form-error");a.emailFrom.removeClass("form-error");a.clearMessage();d.Analytics.api.trackEvent({category:"Share",
action:"close-share"});a.options.photoColumn&&a.clearSharingData()}}).getWidget()},openForm:function(a,b){var c=this;this.options.hasRating=null;d.action.execute(b,{searchId:a.searchId,resultId:a.resultId,useCityNames:!!a.useCityNames,filterState:d.question.ask("resultspage.urlFilterState.get")},function(b){var d=a.tripShareUrl?a.tripShareUrl:b.url;a.sharingDialogTitle&&""!==a.sharingDialogTitle&&c.getChildElement("title").html(a.sharingDialogTitle);c.urlInput.val(d);c.createDialog();c.dialog.open();
c.urlInput.focus();c.getChildElement("sharing_email_fs").val(b.fs);c.getChildElement("sharing_email_subject").val(b.emailSubject);c.getChildElement("sharing_email_searchid").val(a.searchId);c.getChildElement("sharing_email_resultid").val(a.resultId);c.options.photoColumn&&c.addSharingData(e.extend({},a,b));a.hideSharingForm&&(c.element.addClass("no-sharing-form"),c.getChildElement("sharingForm").hide())})},addSharingData:function(a){a.hasOwnProperty("tripSourceName")?this.getChildElement("sourceName").html(a.tripSourceName):
a.hasOwnProperty("sourceName")&&this.getChildElement("sourceName").html(a.sourceName);a.hasOwnProperty("hotelName")&&this.getChildElement("sourceName").html(a.hotelName);a.hasOwnProperty("sourceImageUrl")?(this.photoColumn.removeClass("hidden").css({"background-image":"none"}),this.photoColumn.animate({opacity:0},0).css({"background-image":'url("'+a.sourceImageUrl+'")'}).animate({opacity:1},1E3)):d.Common.Utils.String.isEmpty(this.cityImageUrl)&&this.photoColumn.addClass("hidden");this.rating&&(a.hasOwnProperty("rating")?
(this.rating.removeClass(function(a,c){return(c.match(/(^|\s)count-\S+/g)||[]).join(" ")}),this.rating.addClass("count-"+a.rating),this.rating.attr("data-count",a.rating),!a.useStars&&this.options.useStars&&this.rating.removeClass("starIcon").addClass("circleIcon"),a.useStars||this.options.useStars?this.rating.find(".star").removeClass("circle"):this.rating.find(".star").addClass("circle")):this.rating.attr("aria-hidden","true"))},validateToField:function(){var a=this.emailTo.val().split(","),b=!0;
e.each(a,function(a,d){validateEmail(d.replace(" ",""))||(b=!1)});return b},showMessage:function(a){this.message.removeClass("success error").html(this.options.messages[a]);this.dataTestTagToggleSuccessStatus(!1)},showError:function(a){this.message.removeClass("success").addClass("error").html(this.options.messages[a]);this.dataTestTagToggleSuccessStatus(!1)},showSuccess:function(a){this.message.removeClass("error").addClass("success").html(this.options.messages[a]);this.dataTestTagToggleSuccessStatus(!0)},
dataTestTagToggleSuccessStatus:function(a){var b=this.dataTestTag("share-result-success");b&&""!==b&&(a?this.message.attr(b,""):this.message.removeAttr(b))},clearMessage:function(){this.message.html("")},clearSharingData:function(){this.photoColumn.hasClass("hidden")&&this.photoColumn.removeClass("hidden");this.options.hasRating&&null!==this.rating&&this.rating.hasClass("circleIcon")&&this.rating.removeClass("circleIcon").addClass("starIcon")},trackShare:function(a){this.trackingEnabled&&a&&d.VestigoEvents.share.log(a,
d.question.ask("results.HorizonResult.index.of."+a))}})})(window.R9,window.jq||window.jQuery);(function(a){a.createComponentClass("common.compareto.v3.RightRailCompareToHeader",{path:"common/compareto/v3/RightRailCompareToHeader",dialog:null,infoIcon:null,options:{},init:function(){},addEventHandlers:function(){}})})(window.R9);(function(c,e){c.createComponentClass("common.compareto.v3.RightRailCompareTo",{options:{pageOrigin:null,searchId:null,noUpdateFlash:!1,compareToItems:[],placement:{},type:"",vertical:"",logImpressionsAndClicks:!1},path:"common/compareto/v3/RightRailCompareTo",init:function(){this.button=this.getChildElement("all");this.logImpressions()},addEventHandlers:function(){var b=this,a=b.options;b.subscribe("resultspage.searchId.changed",function(f){var c=a.searchId;f&&c!==f.searchId&&(b.destroy(),a.searchId=
f.searchId,a.noUpdateFlash||b.element.html(""),b.update())});var d={type:a.type,placement:a.placement,searchId:a.searchId};b.button.on("click",function(){window["@r9/cmp2-ui"].onDirectClick(a.compareToItems,d);b.options.logImpressionsAndClicks&&c.Analytics.api.trackEvent({category:"rr",action:"right",label:"compareAll",value:"click"})});b.button.on("mouseup",function(){window["@r9/cmp2-ui"].onDirectMouseUp(a.compareToItems,d)});b.button.on("mousedown",function(){window["@r9/cmp2-ui"].onDirectMouseDown(a.compareToItems,
d)});e(".provider-item-row",b.element).on("click",function(a){a=e(a.currentTarget);c.events.publish("ecommerce.track",{event:"cmp2.rr"});c.events.publish("gtm.update",{event:"compareTo",providerName:a.data("providername")});b.options.logImpressionsAndClicks&&c.Analytics.api.trackEvent({category:"rr",action:"right",label:a.data("providerCode"),value:"click"});return!1})},update:function(){var b=this,a=b.options,d=b.element;c.ajax.execute(b.path,{data:{pageOrigin:a.pageOrigin,searchId:a.searchId,vertical:a.vertical,
compareToPlacement:a.placement},processData:!1,contentType:"application/json;charset\x3dutf-8",dataType:"json",replace:!0,customUpdate:function(a){b.destroy();d.replaceWith(a.innerHTML);b.logImpressions()}}).fail(function(){d.html("")})},logImpressions:function(){this.options.logImpressionsAndClicks&&e(".provider-item-row",this.element).each(function(){c.Analytics.api.trackEvent({category:"rr",action:"right",label:e(this).data("providerCode"),value:"impression"})})}})})(window.R9,window.jQuery||window.jq);(function(d,f,e){d.createComponentClass("common.kn.AdsenseService",{widgets:{},locations:{right:0,bottom:1},init:function(){this.defaultPageOptions={linkTarget:"_blank",adsResponseCallback:this._handleResponseCallback.bind(this),adLoadedCallback:this._handleAdLoadedCallback.bind(this)};this._doAdsenseRefresh=d.Common.Utils.debounce(this._doAdsenseRefresh.bind(this),1E3)},addEventHandlers:function(){this.subscribe("adsense.register.text.widget",this._handleRegisterWidget.bind(this));this.subscribe("adsense.update.text.widget",
this._handleUpdateWidget.bind(this));this.subscribe("adsense.trigger",this._triggerAdsenseRefresh.bind(this));this.subscribe("adsense.update.text.options",this._onUpdateTextOptions.bind(this))},_handleRegisterWidget:function(a){a&&a.id&&!this.widgets[a.id]&&this._addOrUpdateWidget(a)},_handleUpdateWidget:function(a){a&&a.id&&this.widgets[a.id]&&(this.widgets[a.id].refreshed=!1)},_addOrUpdateWidget:function(a){var b=Object.getOwnPropertyNames(this.widgets).length;d.config.getBoolean("ui.horizon.common.kn.adsense.single.req.widget.order.from.location",
!1)&&a.pageLocation&&this.locations.hasOwnProperty(a.pageLocation)&&(b=this.locations[a.pageLocation]);this.widgets[a.id]=e.extend({},{order:b,refreshed:!1},a)},_triggerAdsenseRefresh:function(){var a=this,b=Object.getOwnPropertyNames(this.widgets).map(function(b){return a.widgets[b]});b.filter(function(a){return!a.refreshed}).length===b.length&&this._doAdsenseRefresh()},_doAdsenseRefresh:function(){if(f._googCsa){var a=["ads",this.pageOptions].concat(this._getAdBlocks());f._googCsa.apply(null,a)}},
_handleResponseCallback:function(a){var b=this;a&&Object.getOwnPropertyNames(this.widgets).forEach(function(c){a.hasOwnProperty(c)&&(c=b.widgets[c].impressionURL+a[b.id("ads")],e.get(c))})},_handleAdLoadedCallback:function(a,b){b&&this.widgets.hasOwnProperty(a)&&(this.widgets[a].refreshed=!0,this.widgets[a].adLoadedCallback(a,b))},_getAdBlocks:function(){var a=this;return Object.getOwnPropertyNames(this.widgets).sort(function(b,c){return a.widgets[b].order-a.widgets[c].order}).map(function(b){return a.widgets[b].textAdSettings()}).filter(function(a){return null!=
a})},_onUpdateTextOptions:function(a){var b=a.id;this.widgets[b]&&(this.widgets[b]=e.extend({},this.widgets[b],{impressionURL:a.impressionURL}));this.pageOptions=e.extend({},this.defaultPageOptions,a.pageOptions)}});d.publish("common.kn.AdsenseTextService",{_instance:null,initialize:function(){null===this._instance&&(this._instance=new d.common.kn.AdsenseService)}})})(R9,window,jQuery);(function(b,c){b.createComponentClass("common.kn.Text",{options:{displayOptions:{colorBackground:"#FAFAFC",fontSizeTitle:15,colorTitleLink:"#1E93F5",colorDomainLink:"#D8580B",colorText:"#444",noTitleUnderline:!0,width:void 0},adBlockOptions:null,pageOptions:null,pageLocation:null,title:null,minRefreshRate:null,gptIframeTitle:null,order:null},adTimeout:null,init:function(a){a=new b.common.kn.Mixin;a.loadGPT();a.loadAdsense();this.title=this.getChildElement("title");this.showTitle(!1);this.isAdsenseSingleReqEnabled()&&
b.common.kn.AdsenseTextService.initialize();this.publishAdsRequest()},addEventHandlers:function(){this.subscribe("resultspage.ads.update",this.onResultsPageAdsUpdate.bind(this));this.subscribe("resultspage.adinfo.empty",this.publishAdsRequest.bind(this))},inlineComponentsReady:function(){this.publishAdsRequest();this.hasPageOptions()&&this.checkQAd()},publishAdsRequest:function(){b.events.publish("ads.request",{adType:"textAd",pageLocation:this.options.pageLocation,now:!this.hasPageOptions(),events:["searchform.submit",
"resultsHeader.changed","filters.changed","paginator.change"],minRefreshRate:this.options.minRefreshRate});this.isAdsenseSingleReqEnabled()&&b.events.publish("adsense.register.text.widget",{id:this.id("ads"),pageLocation:this.options.pageLocation,textAdSettings:this.getTextAdSettings.bind(this),adLoadedCallback:this.adLoadedCallback.bind(this)})},onResultsPageAdsUpdate:function(a){if(a=(new b.common.kn.Mixin).findAdDataForType("textAd",this.options.pageLocation,a))this.options.pageOptions=a.pageOptions,
this.options.adBlockOptions=a.adBlockOptions,this.options.impressionURL=a.impressionURL,this.isAdsenseSingleReqEnabled()&&this.hasPageOptions()&&(b.events.publish("adsense.update.text.options",{id:this.id("ads"),pageOptions:a.pageOptions,impressionURL:a.impressionURL}),b.events.publish("adsense.update.text.widget",{id:this.id("ads")})),window.clearTimeout(this.adTimeout),this.adTimeout=window.setTimeout(this.checkQAd.bind(this),b.config.getInt("ui.horizon.ads.delay",1E3))},hasPageOptions:function(){return this.options.pageOptions&&
!c.isEmptyObject(this.options.pageOptions)},getPageOptions:function(){var a=this;return c.extend({linkTarget:"_blank",adsResponseCallback:function(b){b&&b.hasOwnProperty(a.id("ads"))&&a.options&&a.options.impressionURL&&(b=a.options.impressionURL+b[a.id("ads")],c.get(b))},adLoadedCallback:this.adLoadedCallback.bind(this)},this.options.pageOptions||{})},adLoadedCallback:function(a,c){c&&(b.events.publish("textad.loaded"),this.showTitle(!0),this.addFrameTitle())},getTextAdSettings:function(){return this.hasPageOptions()?
c.extend({},this.options.adBlockOptions||{},this.options.displayOptions||{},{container:this.id("ads")}):null},checkQAd:function(){window._googCsa&&this.hasPageOptions()&&(this.isAdsenseSingleReqEnabled()?b.events.publish("adsense.trigger"):window._googCsa("ads",this.getPageOptions(),this.getTextAdSettings()))},showTitle:function(a){null!==this.title&&(a?this.title.removeClass("hidden"):this.title.addClass("hidden"))},addFrameTitle:function(){null!==this.options.gptIframeTitle&&this.getChildElement("ads").find("iframe").first().attr("title",
this.options.gptIframeTitle)},isAdsenseSingleReqEnabled:function(){return b.config.getBoolean("ui.horizon.common.kn.adsence.single.req.enabled",!1)}})})(R9,jQuery);(function(b,c){b.createComponentClass("hotels.results.HotelRightRail","base.results.Rail",{trackCategory:"RightRail",options:{sponsoredDisclaimerEnabled:!1,defaultRailWidth:300,minHeaderHeight:0,maxHeaderHeight:0,buttonMargin:0,dynamicTransitPosition:!1},transitToggle:null,mapCmp2:null,init:function(){this.options.sponsoredDisclaimerEnabled&&(this.sponsoredDisclaimer=this.getChildElement("sponsoredDisclaimer"),this.sponsoredTooltipTrigger=this.getChildElement("sponsoredDisclaimerTooltip"));this.transitToggle=
this.getChildElement("show-transit");this.mapCmp2=this.getChildElement("map-cmp2-wrapper")},addEventHandlers:function(){var a=this;this.subscribe("right.rail.hide",c.proxy(this.hide,this));this.subscribe("right.rail.show",c.proxy(this.show,this));if(this.options.sponsoredDisclaimerEnabled&&this.sponsoredTooltipTrigger.getWidget())this.sponsoredDisclaimer.on("click",function(){a.sponsoredTooltipTrigger.trigger("mouseover")});this.subscribe("right.rail.update.preventDynamicPositioning",this.updatePreventDynamicPositioning.bind(this));
this.subscribe("results.mapToggle.syncState",this.updateRailWidth.bind(this));this.transitToggle&&this.transitToggle.length&&(this.registerEvent("click",this.transitToggle,function(){a.transitToggle.hasClass("checked")?(a.transitToggle.attr("aria-checked",!1),a.transitToggle.removeClass("checked"),b.events.publish("hotels.results.dualViewMap.showTransit",{showTransit:!1})):(a.transitToggle.attr("aria-checked",!0),a.transitToggle.addClass("checked"),b.events.publish("hotels.results.dualViewMap.showTransit",
{showTransit:!0}))}),this.transitToggle.toolTip({content:this.transitToggle.data("message"),extraClass:"fake-avuxi",closeDelay:0,delay:0,edgeOffset:3}));this.subscribe("hotels.results.dualViewMap.mapLoaded",function(){a.transitToggle&&a.transitToggle.length&&a.transitToggle.addClass("loaded");a.mapCmp2&&a.mapCmp2.length&&(a.mapCmp2.addClass("loaded"),a.checkMapCmp2Impression())});this.subscribe("hotels.results.dualViewMap.open",function(){a.transitToggle&&a.transitToggle.length&&a.transitToggle.addClass("visible");
a.mapCmp2&&a.mapCmp2.length&&(a.mapCmp2.addClass("visible"),a.checkMapCmp2Impression())});this.subscribe("hotels.results.dualViewMap.closed",function(){a.transitToggle&&a.transitToggle.length&&a.transitToggle.removeClass("visible");a.mapCmp2&&a.mapCmp2.length&&a.mapCmp2.removeClass("visible")});this.mapCmp2&&this.mapCmp2.length?(this.subscribe("search.startSearch",function(){a.mapCmp2.removeClass("hasData")}),this.subscribe("hotels.results.cmp2.rightrail.loaded",function(b){a.loadMapCmp2(b)}),this.loadMapCmp2(b.question.ask("hotels.results.cmp2.data")),
c(window).scroll(b.Common.Utils.debounce(a.positionAvuxi.bind(a),50)),this.positionAvuxi()):this.options.dynamicTransitPosition&&(c(window).scroll(b.Common.Utils.debounce(a.positionTransitIcon.bind(a),50)),this.positionTransitIcon());this.subscribeForUpdatingPolicyInfo("HotelPolicyInformation","hotelPolicyInfo")},positionTransitIcon:function(){this.transitToggle&&this.transitToggle.length&&this.transitToggle.css({top:Math.max(this.options.minHeaderHeight+this.options.buttonMargin,this.options.maxHeaderHeight+
this.options.buttonMargin-c(window).scrollTop())})},positionAvuxi:function(){this.positionTransitIcon();var a=c(".vxmb.vxclear");if(a&&a.length){var b=this.transitToggle.height()+1.5*this.options.buttonMargin;a.css({"margin-top":Math.max(b,this.options.maxHeaderHeight-this.options.minHeaderHeight+b-c(window).scrollTop())})}else window.setTimeout(this.positionAvuxi.bind(this),50)},loadMapCmp2:function(a){var c=this;a&&a.cmp2Items&&a.cmp2Items.length&&this.mapCmp2&&this.mapCmp2.length&&b.ajax.execute("hotels/results/HotelMapCompareTo",
{data:{compareToItems:JSON.stringify(a.cmp2Items),searchId:a.searchId,showAllButton:!b.Common.Utils.Browsers.isIE(11)},appendTo:this.mapCmp2,replace:!0}).then(function(){c.mapCmp2.addClass("hasData");c.checkMapCmp2Impression()}).fail(function(){c.mapCmp2.removeClass("hasData")})},checkMapCmp2Impression:function(){this.mapCmp2&&this.mapCmp2.length&&this.mapCmp2.hasClass("visible")&&this.mapCmp2.hasClass("loaded")&&this.mapCmp2.hasClass("hasData")&&b.events.publish("hotels.map.cmp2.impression")},hide:function(){var a=
this,d=c.Deferred(),e=d.promise();this.unbindWindowEvents();this.hasAnimation()?(this.element.on(b.Common.Utils.Browsers.ANIMATION_END,function(){d.resolve();a.element.off(b.Common.Utils.Browsers.ANIMATION_END)}),this.element.addClass("animate")):d.resolve();e.then(function(){a.element.addClass("is-hidden");b.events.publish("right.rail.hideAnimationDone")})},show:function(){this.bindWindowEvents();this.element.removeClass("animate");this.element.removeClass("is-hidden");this.onScroll()},hasAnimation:function(){return"0s"!==
this.element.css("animationDuration")},updateRailWidth:function(a){a&&a.hasOwnProperty("isMapOpen")&&(a.isMapOpen?(this.element.css("width","auto"),b.events.publish("pinnedContent.reset")):this.element.css("width",this.options.defaultRailWidth))}})})(R9,jQuery);(function(g,f){g.createComponentClass("common.kn.DisplaySra",{options:{slots:null,slotKeyDelim:"",slotsLoadedTimerMS:400,deferGPTLoad:!1,deferUserInteractMS:3E3,eventsEnable:null,eventsDisable:null,lazyLoad:!1,lazyFetch:-999,lazyRender:-999,renderIfNotEmpty:!1,checkRegisteredSlotMatch:!0,altAdBlockedContent:!1,dataSharingOptOut:!1},enabled:1,delayedGptApiCt:0,hasSlots:0,pendingSlotInfo:null,registeredSlots:null,definedSlots:null,allSlotsRegistered:null,allSlotsRegisteredTimerID:null,allSlotsLoaded:null,
boundSlotRenderedListener:null,boundWindowSmartAdResize:null,pageTargetingLast:null,dfpHideData:null,adBlocked:null,useSlotGroups:!1,intersectionObserver:null,observingSlots:null,waitingSlotGroups:null,init:function(){this.pendingSlotInfo=[];this.registeredSlots={};this.definedSlots={};this.hasSlots=f.isArray(this.options.slots)&&this.options.slots.length},addEventHandlers:function(){this.hasSlots&&(this.subscribe("displayad.sra.register",this.onSraSlotRegisterEvent.bind(this)),this.subscribe("displayad.sra.unregisterAll",
this.unregisterAllSlots.bind(this)),this.subscribe("displayad.sra.destroy",this.onSraSlotDestroyEvent.bind(this)),this.subscribe("displayad.sra.slots.broadcast",this.onSraSlotsBroadcast.bind(this)),this.subscribe("resultspage.adinfo.empty",this.publishAllAdsRequests.bind(this)),this.subscribe("resultspage.ads.update",this.onResultsPageAdsUpdate.bind(this)),this.subscribe("resultspage.ads.options",this.onResultsPageAdsPoll.bind(this)),this.subscribe("adblock.detected",this.onAdBlockDetected.bind(this)),
this.options.eventsEnable&&this.options.eventsEnable.pop&&this.options.eventsEnable.length&&(this.enabled=0,this.subscribe(this.options.eventsEnable,this.onSraEnable.bind(this))),this.options.eventsDisable&&this.options.eventsDisable.pop&&this.options.eventsDisable.length&&this.subscribe(this.options.eventsDisable,this.onSraDisable.bind(this)))},inlineComponentsReady:function(){if(this.hasSlots){g.events.publish("displayad.sra.slots.broadcast",{owner:this,slots:[].concat(this.options.slots)});var a=
this,b=g.question.ask("adblock.detected");if(b&&b.adblock)this.onAdBlockDetected();else this.options.deferGPTLoad?g.events.when("ajaxComponent.highPriority.initialized",function(){a.loadGPT()}):this.loadGPT()}},destroy:function(){f(window).off(this.getWindowMessageEventName());this.boundWindowSmartAdResize&&this.boundWindowSmartAdResize===window.resizeIframeToContents&&(window.resizeIframeToContents=null);this.boundWindowSmartAdResize=null;this.base();this.cleanupSlots()},loadGPT:function(){this.loadedGPT||
(this.loadedGPT=1,(new g.common.kn.Mixin).loadGPT())},onSraSlotDestroyEvent:function(a){if(a&&a.adDivId){var b=this;this.pendingSlotInfo=this.pendingSlotInfo.filter(function(b){return b&&b.adDivId!==a.adDivId});Object.keys(this.registeredSlots).forEach(function(c){c&&b.registeredSlots[c]&&b.registeredSlots[c].adDivId===a.adDivId&&delete b.registeredSlots[c]});this.destroyDefinedSlot(a.adDivId)}},destroyDefinedSlot:function(a){if(window.googletag){var b=this;googletag.cmd.push(function(){b.definedSlots&&
b.definedSlots[a]&&(b.intersectionObserver&&b.intersectionObserver.unobserve(document.getElementById(a)),b.observingSlots&&b.observingSlots.hasOwnProperty(a)&&delete b.observingSlots[a],googletag.destroySlots([b.definedSlots[a]]),delete b.definedSlots[a])})}},onSraSlotsBroadcast:function(a){a&&this!==a.owner&&f.isArray(a.slots)&&(this.options.slots=this.options.slots.filter(function(b){return 0>a.slots.indexOf(b)}),1>this.options.slots.length&&(this.hasSlots=0,this.cleanupSlots(),this.registeredSlots=
{},this.pendingSlotInfo=[],this.enabled=this.allSlotsRegistered=0))},onSraEnable:function(){this.enabled||(this.enabled=1,this.checkLoadSlots())},onSraDisable:function(){this.enabled&&(this.enabled=0,this.cleanupSlots())},setupPrivacyProcessing:function(){this.options.dataSharingOptOut&&googletag.pubads().setPrivacySettings({restrictDataProcessing:!0})},handleMissingOrigin:function(a){this.loggedMissingParams||(this.loggedMissingParams=1,a&&this.logError("Ad params without origin"))},onSraSlotRegisterEvent:function(a){a&&
a.adDivId?a.adBlockOptions?(this.augmentPageOptions(a),a.adBlockOptions.origin?this.updateSlotDataAndLoad(a):this.handleMissingOrigin(a.gptAdID)):a.isAvoidResults?this.logError("No ad targeting for non-results ad"):(this.pendingSlotInfo.push(a),this.publishOneAdsRequest(a)):this.logError("Missing adOptions ID")},publishAllAdsRequests:function(){var a=[];this.pendingSlotInfo&&this.pendingSlotInfo.length&&(a=this.pendingSlotInfo.filter(function(a){return a&&!a.isAvoidResults}));a=a.concat(Object.values(this.registeredSlots).map(function(a){return a&&
!a.isAvoidResults?a:null}));a.forEach(this.publishOneAdsRequest.bind(this))},publishOneAdsRequest:function(a){a&&!a.isAvoidResults&&g.events.publish("ads.request",{adType:"displayAd",pageLocation:a.pageLocation,now:!a.gptAdID,events:["searchform.submit","resultsHeader.changed","filters.changed","paginator.change"],minRefreshRate:this.options.minRefreshRate})},onResultsPageAdsUpdate:function(a){if(this.enabled){var b=this,c=new g.common.kn.Mixin,d=function(a,c){Object.keys({gptAdID:null,gptTargetID:null,
gptAdWidth:null,gptAdHeight:null,gptAdSizes:null,gptPageURL:null,adBlockOptions:null,pageOptions:null,slotGroup:0}).forEach(function(b){c.hasOwnProperty(b)&&"undefined"!==typeof c[b]&&(a[b]=c[b])});b.augmentPageOptions(a);return a};this.pendingSlotInfo&&this.pendingSlotInfo.length&&this.pendingSlotInfo.forEach(function(e){if(e){var h=c.findAdDataForType("displayAd",e.pageLocation,a);h&&h.adBlockOptions&&h.adBlockOptions.origin&&b.hasSlots&&0<=b.options.slots.indexOf(b.makeSlotKey(h))&&b.updateSlotDataAndLoad(d(e,
h))}});this.pendingSlotInfo.length&&(this.pendingSlotInfo=this.pendingSlotInfo.filter(function(a){return!Object.values(b.registeredSlots).some(function(b){return!b||a.adDivId===b.adDivId})}));this.pendingSlotInfo.length&&f.isEmptyObject(this.registeredSlots)&&this.pendingSlotInfo.some(function(a){return a&&!a.isAvoidResults})&&this.hasSlots?this.publishAllAdsRequests():Object.values(this.registeredSlots).forEach(function(e){var h=c.findAdDataForType("displayAd",e.pageLocation,a);h&&b.updateSlotDataAndLoad(d(e,
h))})}},makeSlotKey:function(a){var b=this.getAdSizes(a);return b[0][0]+"x"+b[0][1]+this.options.slotKeyDelim+a.pageLocation+this.options.slotKeyDelim+a.adBlockOptions.origin},updateSlotDataAndLoad:function(a){var b=this;if(a&&a.adBlockOptions&&a.adDivId&&(a=f.extend({slotKey:this.makeSlotKey(a),adSize:this.getAdSizes(a),adDivId:a.adDivId,smartAd:null},a),a.slotKey&&this.hasSlots&&!(0>this.options.slots.indexOf(a.slotKey)))){var c=this.registeredSlots[a.slotKey];c&&c.adDivId!==a.adDivId&&this.definedSlots&&
this.definedSlots[c.adDivId]&&this.destroyDefinedSlot(c.adDivId);this.registeredSlots[a.slotKey]=f.extend({},a);!this.allSlotsRegistered&&0<this.options.slotsLoadedTimerMS&&(clearTimeout(this.allSlotsRegisteredTimerID),this.allSlotsRegisteredTimerID=setTimeout(function(){var a=g.question.ask("adblock.detected");a&&a.adblock||b.setAllSlotsRegistered()},this.options.slotsLoadedTimerMS));this.checkLoadSlots()}},onSlotRenderedEvent:function(a){this.enabled&&(g.events.publish("displayad.loaded",{slotElementId:a.slot.getSlotElementId()}),
!0===this.options.renderIfNotEmpty&&!1===a.isEmpty&&f("#"+a.slot.getSlotElementId()).show())},checkLoadSlots:function(){if(this.enabled&&this.hasSlots){if(this.options.checkRegisteredSlotMatch)for(var a,b=0;b<this.options.slots.length;b++){if((a=this.options.slots[b])&&!this.registeredSlots[a])return}else if(!this.registeredSlots||f.isEmptyObject(this.registeredSlots))return;this.setAllSlotsRegistered()}},unregisterAllSlots:function(){this.registeredSlots={};this.pendingSlotInfo=[];this.allSlotsRegistered=
0;clearTimeout(this.allSlotsRegisteredTimerID)},setAllSlotsRegistered:function(){this.allSlotsRegistered=1;clearTimeout(this.allSlotsRegisteredTimerID);this.loadAllSlots()},loadAllSlots:function(a){if(this.enabled){var b=this.adBlocked&&this.options.altAdBlockedContent;this.adBlocked&&!b?this.replaceAllAdBlockedSlots():window.googletag&&(window.googletag.apiReady||b)?a?(this.setupAllSlots(),this.allSlotsLoaded=1):this.deferUserInteractID?this.handleDelayedSlotLoad():this.handleDelayedSlotLoad(null,
1):this.handleDelayedSlotLoad(1)}},handleDelayedSlotLoad:function(a,b){var c=this,d=b;this.delayedSlotLoadID&&clearTimeout(this.delayedSlotLoadID);this.delayedSlotLoadID=setTimeout(function(){if(a&&(c.delayedGptApiCt+=1,100<=c.delayedGptApiCt)){var b=g.question.ask("adblock.detected"),h=c.options.altAdBlockedContent;100!==c.delayedGptApiCt||h||b&&b.adblock||g.Analytics.api.trackEvent({category:"sra",action:"error",label:"gptapi"});if(h)d=!0;else return}c.loadAllSlots(d)},200)},onResultsPageAdsPoll:function(){if(this.options.deferUserInteractMS&&
!f.isEmptyObject(this.definedSlots)){var a=this;this.deferUserInteractID&&clearTimeout(this.deferUserInteractID);this.deferUserInteractID=setTimeout(function(){a.deferUserInteractID=null},this.options.deferUserInteractMS)}},compareSlotOrder:function(a,b){a=parseInt(a&&a.adBlockOptions&&a.adBlockOptions.tile);b=parseInt(b&&b.adBlockOptions&&b.adBlockOptions.tile);return isNaN(a)?isNaN(b)?0:1:isNaN(b)?-1:a-b},setupAllSlots:function(){var a=this,b,c=Object.values(this.registeredSlots);g.config.getBoolean("ui.ads.orderSlots")&&
(c=c.sort(this.compareSlotOrder));c.forEach(function(c){!c||a.pageTargetingLast&&a.sameObjectProperties(a.pageTargetingLast,c.pageOptions,["tile"])||(a.pageTargetingLast=f.extend({},c.pageOptions),b=c)});this.pageTargetingLast?"function"!==typeof googletag.pubads?this.logError("Bad googletag pubads"):(this.setWindowEvents(),googletag.cmd.push(function(){b&&a.setupPageTargeting(b);a.boundSlotRenderedListener||(a.boundSlotRenderedListener=a.onSlotRenderedEvent.bind(a),googletag.pubads().addEventListener("slotRenderEnded",
a.boundSlotRenderedListener));c.forEach(function(b){b&&a.setupSlot(b);a.allSlotsLoaded&&f("#"+b.adDivId).show()});a.allSlotsLoaded?a.useSlotGroups?(a.waitingSlotGroups=!0,a.refreshSlotGroups()):googletag.pubads().refresh():(a.useSlotGroups&&googletag.pubads().disableInitialLoad(),googletag.enableServices(),Object.keys(a.definedSlots).forEach(function(a){a&&googletag.display(a)}),a.useSlotGroups&&(a.waitingSlotGroups=!0,a.refreshSlotGroups()))})):this.errPageOptions||(this.errPageOptions=1,this.logError("Missing slot data page options"))},
refreshSlotGroups:function(){var a=this,b=this.observingSlots,c,d,e;this.waitingSlotGroups&&(f.isEmptyObject(b)?this.waitingSlotGroups=this.waitingSlotGroups||!0:(c=Object.values(this.registeredSlots).filter(function(a){return a&&b[a.adDivId]}).map(function(a){return a.slotGroup||-1}).filter(function(b,c,d){return d.indexOf(b)===c&&(!0===a.waitingSlotGroups||0<=a.waitingSlotGroups.indexOf(b))}),c.length&&(d=[],c.forEach(function(b){d=d.concat(Object.values(a.registeredSlots).filter(function(a){return-1===
b?!a.slotGroup:a.slotGroup===b}).map(function(b){return a.definedSlots[b.adDivId]}))}),e=Object.values(this.registeredSlots).filter(function(a){return 0>c.indexOf(a.slotGroup||-1)}).map(function(a){return a.slotGroup||-1}).filter(function(a,b,c){return c.indexOf(a)===b}),e.length?!0===this.waitingSlotGroups?this.waitingSlotGroups=e:(this.waitingSlotGroups=this.waitingSlotGroups.filter(function(a){return 0<=e.indexOf(a)}),this.waitingSlotGroups.length||(this.waitingSlotGroups=!1)):this.waitingSlotGroups=
!1,d.length&&googletag.cmd.push(function(){googletag.pubads().refresh(d)}))))},onObserverEvent:function(a){var b=this;this.observingSlots&&a&&a.forEach(function(a){a&&a.target&&a.target.id&&(b.observingSlots[a.target.id]=a.isIntersecting)});this.refreshSlotGroups()},setupSlotGroupObserver:function(a){if(!(a.slotGroup&&"IntersectionObserver"in window))return!1;var b=document.getElementById(a.adDivId);if(!b)return!1;this.intersectionObserver||(this.intersectionObserver=new IntersectionObserver(this.onObserverEvent.bind(this),
{root:null,threshold:.1}),this.observingSlots={});this.observingSlots.hasOwnProperty(a.adDivId)||(this.observingSlots[a.adDivId]=!1,this.intersectionObserver.observe(b));return!0},augmentPageOptions:function(a){a&&a.pageOptions&&("undefined"===typeof a.pageOptions.xp&&(a.pageOptions.xp=g.globals.experiment),a.isAvoidResults&&"undefined"===typeof a.pageOptions.host&&(a.pageOptions.host="http://"+window.location.hostname))},setupPageTargeting:function(a){var b=window.googletag;b.pubads().clearTargeting();
b.pubads().enableSingleRequest();this.options.gptIframeTitle&&b.setAdIframeTitle(this.options.gptIframeTitle);this.options.isForceSafeFrame&&(this.options.altAdBlockedContent&&this.adBlocked?b.pubads().setForceSafeFrame(!1):b.pubads().setForceSafeFrame(!0));this.setupPrivacyProcessing();if(this.options.lazyLoad){var c={};!isNaN(this.options.lazyFetch)&&-1<=this.options.lazyFetch&&(c.fetchMarginPercent=this.options.lazyFetch);!isNaN(this.options.lazyRender)&&-1<=this.options.lazyRender&&(c.renderMarginPercent=
this.options.lazyRender);b.pubads().enableLazyLoad(c)}a.gptPageURL&&b.pubads().set("page_url",a.gptPageURL);b.pubads().collapseEmptyDivs();Object.keys(a.pageOptions).forEach(function(c){c&&b.pubads().setTargeting(c,a.pageOptions[c])})},setupSlot:function(a){if(a&&a.adDivId&&a.adBlockOptions){var b=this.definedSlots[a.adDivId],c;b||(c=1,b=googletag.defineSlot(a.gptTargetID,a.adSize,a.adDivId));b?(this.setupSlotGroupObserver(a)&&(this.useSlotGroups=!0),b.clearTargeting(),Object.keys(a.adBlockOptions).forEach(function(c){c&&
b.setTargeting(c,a.adBlockOptions[c])}),c&&(b.addService(googletag.pubads()),this.definedSlots[a.adDivId]=b)):this.errSlotDefine||(this.errSlotDefine=1,this.logError("defineSlot failed"))}else this.errSlotOptions||(this.errSlotOptions=1,this.logError("Missing slot ID or data ad options"))},cleanupSlots:function(){this.boundSlotRenderedListener=this.pageTargetingLast=null;this.intersectionObserver&&(this.intersectionObserver.disconnect(),this.intersectionObserver=null,this.useSlotGroups=!1,this.waitingSlotGroups=
this.observingSlots=null);if(window.googletag&&googletag.cmd){var a=this;googletag.cmd.push(function(){var b=[];Object.keys(a.definedSlots).forEach(function(c){b.push(a.definedSlots[c]);delete a.definedSlots[c]});b.length&&googletag.destroySlots(b);a.definedSlots={};a.allSlotsLoaded=0})}},onAdBlockDetected:function(){this.adBlocked||(this.adBlocked=1,this.replaceAllAdBlockedSlots())},replaceAllAdBlockedSlots:function(){if(this.enabled&&!this.options.altAdBlockedContent){var a=this;Object.values(this.registeredSlots).forEach(function(b){a.replaceAdBlockedContent(b)})}},
replaceAdBlockedContent:function(a){var b,c=" width\x3d'%s' height\x3d'%s' ",d=a&&a.adDivId?f("#"+a.adDivId):null;a&&a.adBlockedURL&&a.gptAdID&&d?(b=this.getAdSizes(a),c=f.isArray(b)?b[0]&&f.isArray(b[0])?c.format(b[0][0],b[0][1]):c.format(b[0],b[1]):c.format(a.gptAdWidth,a.gptAdHeight),d.html("\x3ciframe class\x3d'had-frame' frameborder\x3d'0' "+c+" scrolling\x3d'no' src\x3d'"+a.adBlockedURL+"'\x3e\x3c/iframe\x3e")):d&&d.hide()},setWindowEvents:function(){var a=this,b=this.getWindowMessageEventName(),
c;this.dfpHideData={};Object.values(this.registeredSlots).forEach(function(b){b&&b.adBlockOptions&&b.adBlockOptions.pos&&b.adBlockOptions.origin&&(c=b.adBlockOptions.origin.match(/\w+\.\w*\.(\w+)\./))&&1<c.length&&c[1]&&(a.dfpHideData[c[1]+"."+b.adBlockOptions.pos+".NoAd"]=f.extend({},b))});f(window).off(b).on(b,this.onWindowMessage.bind(this))},getWindowMessageEventName:function(){return"message.displayad-"+this.id()},onWindowMessage:function(a){var b,c,d;this.enabled&&a&&a.originalEvent&&((c=this.options.smartAdWinMessageHosts||
"")&&(c=c.replace(/(http(s)?:)?\/\//g,window.location.protocol+"//")),c+=","+window.location.protocol+"//"+window.location.host,this.dfpHideData&&a.originalEvent.data&&this.dfpHideData[a.originalEvent.data]?(c=this.dfpHideData[a.originalEvent.data])&&c.adDivId&&(f("#"+c.adDivId).hide(),g.config.getBoolean("ui.horizon.ads.trackCollapse",!0)&&g.Analytics.api.trackEvent({category:"sra",action:"adcollapse",label:c.pageLocation})):a.originalEvent.origin&&0<=c.indexOf(a.originalEvent.origin)&&this.options.smartAdWinMessageID&&
a.originalEvent.data[this.options.smartAdWinMessageID]&&((d=a.originalEvent.data[this.options.smartAdWinMessageID].pos)?(b=this,Object.values(this.registeredSlots).forEach(function(c){c.adBlockOptions&&d===c.adBlockOptions.pos&&b.kickoffSmartAd(a.originalEvent.data[b.options.smartAdWinMessageID],c)})):this.logError("No pos for smartad data: "+d)))},kickoffSmartAd:function(a,b){if(g.config.getBoolean("ui.horizon.ads.loadSmartAd",!0)&&a&&b&&b.adDivId&&(a.searchid||(a.searchid=this.options&&this.options.pageOptions?
this.options.pageOptions.searchid:null),a.provider_code&&a.searchid)){var c=this.getSmartAdURL(a);if(c){this.boundWindowSmartAdResize||(this.boundWindowSmartAdResize=this.onSmartAdGlobalResize.bind(this),window.resizeIframeToContents=this.boundWindowSmartAdResize);window.R9.Ads=window.R9.Ads||{};window.R9.Ads.SmartAd=window.R9.Ads.SmartAd||{slots:{R0:{},R1:{},M0:{}},adjustBannerContainerSize:f.noop()};var d="",e=b.adBlockOptions&&b.adBlockOptions.origin;"string"===typeof a.sz&&(d=(d=a.sz.split("x"))&&
2===d.length&&parseInt(d[0])&&parseInt(d[1])?" width\x3d'"+d[0]+"' height\x3d'"+d[1]+"' ":"");b.smartAd=f.extend({rank:b.gptAdID?b.gptAdID.substr(b.gptAdID.length-1,1):null,origin:e&&1<e.length?e.substr(e.length-2,2):null,reloaded:0,sized:0},a);this.subscriptions&&this.subscriptions["search.poll.response"]||this.subscribe("search.poll.response",this.onSmartAdSearchPoll.bind(this));f("#"+b.adDivId).html("\x3ciframe class\x3d'smartad-frame' frameborder\x3d'0' "+d+" scrolling\x3d'no' src\x3d'"+c+"'\x3e\x3c/iframe\x3e")}else g.Analytics.api.trackEvent({category:"smartad",
action:"urlfail",label:b.pageLocation})}},onSmartAdSearchPoll:function(a){if(a&&a.completed){this.unsubscribe("search.poll.response");var b=this;Object.values(this.registeredSlots).forEach(function(a){a&&a.smartAd&&!a.smartAd.reloaded&&(a.smartAd.reloaded=1,a.smartAd.sized=0,setTimeout(function(){a.smartAd&&f("#"+a.adDivId).find(".smartad-frame").attr("src",b.getSmartAdURL(a.smartAd,"false")+"\x26reload\x3d1")},100))})}},onSmartAdGlobalResize:function(){var a=this;Object.values(this.registeredSlots).forEach(function(b){a.resizeSmartAd(b)})},
resizeSmartAd:function(a){if(a&&a.adDivId&&a.smartAd&&!a.smartAd.sized){var b=f("#"+a.adDivId),c=b.find("iframe.smartad-frame").first(),d,e,h;if(c.length){try{d=c.contents().find("body")}catch(k){return}a.smartAd.sized=1;a=c.outerWidth();e=c.outerHeight();h=d.outerWidth();d=d.outerHeight();2>h||2>d?b.hide():(a!==h&&c.attr("width",h),e!==d&&c.attr("height",d),b.outerWidth()!==h&&(b.width("auto"),b.css("max-width","none")),b.outerHeight()!==d&&(b.height("auto"),b.css("max-height","none")))}}},getSmartAdURL:function(a,
b){if(!a)return null;"true"!==b&&"false"!==b&&(b="true");var c=a.rank||0,d=a.origin||"R0",e=a.provider_code?encodeURIComponent(a.provider_code):"",f=a.click_tracking?encodeURIComponent(a.click_tracking):"",g=a.sz?encodeURIComponent(a.sz):"";return"/h/ads/smartad?provider_code\x3d"+e+"\x26searchid\x3d"+a.searchid+"\x26clicktracking\x3d"+f+"\x26sz\x3d"+g+"\x26rank\x3d"+c+"\x26logimpr\x3d"+b+"\x26strm\x3d\x26pageorigin_location\x3d"+d+"\x26isstreaming\x3d"},getAdSizes:function(a){var b;a.gptAdSizes&&
(b=this.validateAdSizes(a.gptAdSizes));return b||this.validateAdSizes([parseInt(a.gptAdWidth),parseInt(a.gptAdHeight)])},validateAdSizes:function(a){var b=function(a){return!isNaN(a)&&0<a&&9999>a&&a===parseInt(a,10)},c=function(a){return a&&a.pop&&2===a.length&&b(a[0])&&b(a[1])};if(!a||!a.pop)return null;if(c(a))return a;for(var d=0;d<a.length;d++)if(!c(a[d]))return null;return a},sameObjectProperties:function(a,b,c){if(!a||!b)return!1;var d;c=c||[];for(d in a)if(a.hasOwnProperty(d)&&!b.hasOwnProperty(d))return!1;
for(d in b)if(b.hasOwnProperty(d)){if(!a.hasOwnProperty(d))return!1;if(!(0<=c.indexOf(d))&&a[d]!==b[d]){var e=a[d];if(e=e!==e)e=b[d],e=e!==e;if(!e)return!1}}return!0},logError:function(a){g.config.getBoolean("ui.ads.sra.log",!0)&&this.log.error(a)}})})(window.R9,window.jQuery);(function(c){c.createComponentClass("common.compareto.v3.ResultPage",{options:{searchId:"",vertical:""},init:function(){var a=this.options.searchId;if(a)window["@r9/cmp2-ui"].onResultPage({placement:null,requestInformation:null,type:this.getVertical(),searchId:a})},getVertical:function(){var a="";switch(this.options.vertical){case "flights":a="F";break;case "hotels":a="H";break;case "cars":a="C";break;case "packages":a="P";break;case "cruises":a="R";break;case "trains":a="T"}return a},addEventHandlers:function(){var a=
this,d=a.options;a.subscribe("resultspage.cleanup",function(){d.searchId=null});a.subscribe("resultspage.searchId.changed",function(b){b&&b.searchId&&b.searchId!==d.searchId&&(c.ComponentManager.removeSingleton(a._namespace),c.ajax.execute("common/compareto/v3/ResultPage",{data:{searchId:b.searchId,vertical:d.vertical}}))})}})})(window.R9);(function(e,g){var h=e.config.getBoolean("ui.whisky.modal.enabled",!1);e.createComponentClass("common.booking.ClickoutController","framework.JavaScriptComponent",{options:{postClickDelay:200},resultsOrderLogString:null,searchIdExpirationCheckFailed:!1,hotelCarsPostClickXSellRequested:!1,addEventHandlers:function(){this.base();var a=this;this.subscribe("clickout.open",function(b){a.searchIdExpirationCheckFailed?(e.Analytics.api.trackEvent("searchidexpired/bestclick"),e.events.publish("results.expired")):
a.open(b)});this.subscribe("clickout.resultsOrder.update",function(b){a.resultsOrderLogString=b});this.subscribe("searchid.expiration.check.failed",function(){a.searchIdExpirationCheckFailed=!0});this.subscribe("resultspage.cleanup",function(){a.searchIdExpirationCheckFailed=!1})},open:function(a){var b=a.data||{},c=g(a.element),d=a.event;a=a.callback||g.noop;var f=d&&(d.metaKey||d.ctrlKey);c.length&&("A"!==c.get(0).nodeName&&(c=c.find("a").eq(0)),b.target=b.target||c.attr("target"),b.url=b.url||
c.attr("href"),b.name=b.name||c.data("name"),b.code=b.code||c.data("code"),b.splitProvider=b.splitProvider||c.data("split-provider"),b.element=c,b.showWhiskyModal=!!b.showWhiskyModal,void 0===b.clickoutWarningDialog&&(b.clickoutWarningDialog=c.data("clickout-warning-dialog")),void 0===b.clickoutAlternateOptionsDialog&&(b.clickoutAlternateOptionsDialog=c.data("clickout-alternate-options-dialog")));d&&d.preventDefault();b.noExternalRedirect=this.isNoExternalRedirect(b);"undefined"===typeof b.showAfterclick&&
(b.showAfterclick=!b.noExternalRedirect);b.noExternalRedirect?this.postClick(b,a,f):(b.target=b.target||"_blank",(c="self"===b.target)&&this.postClick(b,a,f),d=b.url,this.resultsOrderLogString&&(d+=(1>d.indexOf("?")?"?":"\x26")+"resultsOrder\x3d"+encodeURIComponent(this.resultsOrderLogString)),"undefined"===typeof b.code||"BOOKINGDOTCOMPV"!==b.code&&"BOOKINGDOTCOMGENIUS"!==b.code&&"BOOKINGDOTCOMGENIUSCORE"!==b.code||!0!==e.question.ask("hotels_bdc_should_clickout")?(h&&b.showWhiskyModal?e.events.publish("cars.whisky.modal.startWatching",
{url:d+"\x26_kw_whiskyModal\x3dtrue"}):window.open(d,b.target),c||setTimeout(this.postClick.bind(this,b,a,f),this.options.postClickDelay)):e.events.publish("genius.show.interstitial",b))},postClick:function(a,b,c){a.clickoutDetailsDialog||a.clickoutAlternateOptionsDialog||a.clickoutInline||e.events.publish(["multibook.providerClicked","provider.book.click"],g.extend({resultId:a.resultId,uiResultId:a.uiResultId,providerName:a.name,providerCode:a.code,splitProvider:a.splitProvider,clickoutDetailsDialog:a.clickoutDetailsDialog,
clickoutInline:a.clickoutInline,clickoutWarningDialog:a.clickoutWarningDialog,clickoutAlternateOptionsDialog:a.clickoutAlternateOptionsDialog,afterclickIgnore:!a.showAfterclick||c},a.customPostClickData));!this.publishAlternateClickout(a)&&a.splitProvider&&e.events.publish("multibook.splitProvider.click",{resultId:a.resultId,element:a.element});!a.noExternalRedirect&&"flights"===this.options.vertical&&e.config.getBoolean("ui.post.click.xsell.enabled",!1)&&this.launchPostClickXSell(a);b(a)},publishAlternateClickout:function(a){var b=
!1,c,d,f;if(a.splitProvider&&!a.clickoutInline&&!a.clickoutDetailsDialog)return!1;a.clickoutDetailsDialog?f="multibook.modalDetailsDialog.show":a.clickoutInline?(d={activeTab:"rates",force:!0},f="flightResult.details.clickout.toggleOpen"):a.clickoutAlternateOptionsDialog?f="multibook.clickoutAlternateOptions.show":a.clickoutWarningDialog&&(f="multibook.clickoutWarning.show");if(f){d=g.extend(d||{},a);c=g.extend(d,this.getSubscriptionResetData(function(){b=!0}));e.events.publish(f,d);if(!b)this.onClickoutWarningFailure(c);
e.events.publish("track.result.details.open",{resultId:a.resultId,source:"cta"});return!0}return!1},getSubscriptionResetData:function(a){return{clickoutWarningDialog:!1,clickoutAlternateOptionsDialog:!1,clickoutDetailsDialog:!1,clickoutInline:!1,noExternalRedirect:!1,verifySubscriptionCallback:a}},isNoExternalRedirect:function(a){return a.noExternalRedirect||a.splitProvider||a.clickoutWarningDialog||a.clickoutDetailsDialog||a.clickoutInline||a.clickoutAlternateOptionsDialog},onClickoutWarningFailure:function(a){var b=
g.extend({},a,this.getSubscriptionResetData(void 0)),c;try{c=JSON.stringify(a)}finally{this.open({data:b}),this.log.error("Failed to open clickout dialog. Subscription for result "+a.resultId+" not registered.\nPublish data: "+c)}},launchPostClickXSell:function(a){if(!this.hotelCarsPostClickXSellRequested){this.hotelCarsPostClickXSellRequested=!0;e.Analytics.api.trackEvent("flight-hotel-xsell/impression");var b=a.element.parents(".Base-Results-HorizonResult");b.length&&e.ajax.execute("flights/results/xsells/HotelCarsPostClickXSell",
{data:{searchId:a.searchId},appendTo:b,insertBefore:!0,replace:!1})}}})})(R9,jQuery);(function(b,d){b.createComponentClass("common.booking.SearchIdExpirationChecker","framework.JavaScriptComponent",{options:{},searchId:null,searchIdLikelyValid:!0,checkTimer:null,init:function(){this.options.searchId&&(this.searchId=this.options.searchId)},addEventHandlers:function(){var a=this;this.base();this.subscribe("resultspage.streaming.done",this.searchEnded.bind(this));this.subscribe("resultspage.refreshed",this.searchEndedWait.bind(this));this.subscribe(["search.startSearch","resultspage.searchId.changed",
"search.expired","results.expired"],this.clearCheckTimer.bind(this));d("a.bookingLink").click(function(){return a.interceptClick()})},interceptClick:function(){if(this.searchIdLikelyValid)return!0;b.Analytics.api.trackEvent("searchidexpired/booklink");b.events.publish("results.expired");return!1},clearCheckTimer:function(){this.checkTimer&&(clearTimeout(this.checkTimer),this.checkTimer=null)},searchEndedWait:function(a){var b=this;setTimeout(function(){b.searchEnded(a)},100)},searchEnded:function(a){this.clearCheckTimer();
a&&a.searchId?(this.searchId=a.searchId,this.searchIdLikelyValid=!0,this.startCheckTimer()):a&&"streaming"in a&&!a.streaming?this.startCheckTimer():this.searchId=null},startCheckTimer:function(){if(!this.checkTimer){var a=this;this.checkTimer=setTimeout(function(){a.validateFromServer();a.checkTimer=null},this.options.checkTimeout)}},validateFromServer:function(){if(this.searchId){var a=this;d.ajax({type:"POST",url:"/s/horizon/common/booking/SearchIdValidationAction",headers:{"X-CSRF":b.globals.formtoken},
data:{searchId:this.searchId},success:function(c){c&&(a.searchIdLikelyValid=!c.isExpired,c.isExpired&&b.events.publish("searchid.expiration.check.failed"))}})}}})})(R9,jQuery);(function(b,a){b.createComponentClass("common.authentication.LoginOptionsDialog",{trackingCategory:"anon-trips-login",trackingLabel:null,init:function(){this.optionsDialog=this.element.dialog().getWidget();this.confirmationDialog=a("#"+this.id("confirmation")).dialog().getWidget()},addEventHandlers:function(){b.events.subscribe("show.login.options.dialog",a.proxy(this.openDialog,this));a("#"+this.id("regularAuth")).click(a.proxy(this.regularAuth,this));a("#"+this.id("guestAuth")).click(a.proxy(this.guestAuth,
this));a("#"+this.id("guestConfirmation")).click(a.proxy(this.continueAsGuest,this));a("#"+this.id("googleAuth")).click(a.proxy(this.googleAuth,this));a("#"+this.id("fbAuth")).click(a.proxy(this.fbAuth,this));a("#"+this.id("signUp")).click(a.proxy(this.signUp,this))},openDialog:function(a){a=a||{};this.trackingLabel=a.trackingLabel||null;a.forceLogin||!this.stayAnon?this.showDialog():this.continueAsGuest()},showDialog:function(){this.track("display-dialog");var c=this;a.when(b.Social.FB.ensureAPILoaded(),
b.Social.Google.ensureAPILoaded()).always(function(){c.optionsDialog.open()})},closeOptionsDialog:function(){b.events.unsubscribe("continue.as.guest");this.optionsDialog.close()},regularAuth:function(){this.track("use-email-address");this.closeOptionsDialog();b.authentication.showLogin()},continueAsGuest:function(){this.track("continue-as-guest");this.confirmationDialog.close();b.events.publish("continue.as.guest");this.stayAnon=!0;this.closeOptionsDialog()},guestAuth:function(){this.track("guest-confirm");
this.optionsDialog.close();b.config.getBoolean("ui.trips.anon.second-step-dialog.enabled",!1)?this.continueAsGuest():this.confirmationDialog.open()},signUp:function(){this.track("guest-sign-me-up");this.confirmationDialog.close();this.optionsDialog.open()},fbAuth:function(){this.closeOptionsDialog();b.events.subscribe("fbauth.login.success",function(){window.location.reload(!0)});b.authentication.external.facebook.login(null,null,null,null,{category:this.trackingCategory,label:this.trackingLabel})},
googleAuth:function(){this.closeOptionsDialog();b.events.subscribe("googleauth.login.success",function(){window.location.reload(!0)});b.authentication.external.google.login(null,null,null,{category:this.trackingCategory,label:this.trackingLabel})},track:function(a){b.Analytics.api.trackEvent({category:this.trackingCategory,action:a,label:this.trackingLabel})}})})(R9,jQuery);(function(c,d){c.createComponentClass("hotels.results.HotelPriceAlertsController","framework.JavaScriptComponent",{options:{anonUser:!0,showUnconfirmedWarning:!1,driveByAnon:!1,initialFormData:null,alertSavedMessage:null,alertSavedMessageShort:null,alertUpdatedMessage:null,alertManageLinkMessage:null,showManageLink:!0,searchId:"",hotelId:""},alertFormData:{city:"",cityId:"",hId:"",checkInDate:null,formattedCheckinDate:null,checkOutDate:null,formattedCheckoutDate:null,numRooms:0,guests:0,adults:0,
children:0,alertid:null},startDate:null,endDate:null,alertId:null,init:function(){this.alertFormData=d.extend({},this.alertFormData,this.options.initialFormData);this.options.initialFormData&&(this.startDate=moment(this.alertFormData.checkInDate),this.endDate=moment(this.alertFormData.checkOutDate));this.options.hotelId&&(this.alertFormData.hId=this.options.hotelId)},addEventHandlers:function(){var a=this;this.base();this.subscribe("hotels.results.alerts.create",this.createPriceAlert.bind(this));
this.subscribe("hotels.results.alerts.delete",this.deletePriceAlert.bind(this));this.subscribe("hotels.results.existingAlert",function(b){a.alertFormData.alertid=b;a.alertId=b});this.subscribe(["searchform.submit","inlineSearchFormUpdated"],function(b){a.updateFormData(b)});this.subscribe("resultspage.searchId.changed",function(b){a.options.searchId=b.searchId});this.subscribe("search.poll.response",function(b){(b=b.existingAlertId)&&0<b?(a.alertFormData.alertid=b,a.alertId=b):(a.alertFormData.alertid=
null,a.alertId=null)});this.subscribe("common.results.resendConfirmationEmail",this.resendConfirmationEmail.bind(this))},updateFormData:function(a){this.alertFormData.checkInDate=a.checkInDate;this.alertFormData.checkOutDate=a.checkOutDate;this.startDate=moment(this.alertFormData.checkInDate);this.endDate=moment(this.alertFormData.checkOutDate);this.alertFormData.guests=a.guests?a.guests:a.adults+a.children;this.alertFormData.numRooms=a.rooms;this.alertFormData.cityId=a.cityId;this.alertFormData.city=
a.location;this.alertFormData.hId=a.hotelId},createPriceAlert:function(a){this.options.driveByAnon&&this.options.anonUser?this.showDriveByAnon(a):this.options.showUnconfirmedWarning?c.events.publish("common.results.unconfirmedWarning",{sendEmailBeforeOpeningDialog:!0}):this.addPriceAlert(a)},showDriveByAnon:function(a){c.ajax.execute("hotels/results/HotelPriceAlertDriveBy",{data:{searchId:this.options.searchId,sourceId:a&&a.sourceId?a.sourceId:null},replace:!0})},addPriceAlert:function(a){if(this.options.anonUser){var b=
{promoType:"alert",promo:"pricealert",sourceId:this.options.sourceId,showSingleImage:!0,messageParams:[this.alertFormData.city,[this.alertFormData.checkInDate,this.alertFormData.checkOutDate].join(" - ")],success:this.handleWatch.bind(this)};c.authentication.showLogin(b)}else this.handleWatch();a&&a.vsLog&&c.Analytics.api.trackEvent(a.vsLog);c.Analytics.api.trackEvent({category:"Price-Alert",action:"create",value:"new"})},deletePriceAlert:function(a){this.options.anonUser?window.location="/alerts":
(this.showFeedbackMessage=!0,this.deleteEmailPriceAlert());a&&a.vsLog&&c.Analytics.api.trackEvent(a.vsLog);c.Analytics.api.trackEvent({category:"Price-Alert",action:"delete",value:this.alertFormData.alertid})},deleteEmailPriceAlert:function(){var a=this,b={action:"delete",alertid:a.alertFormData.alertid};this.alertFormData.hid?c.events.publish("trips.hotels.removeHotel",{hid:this.alertFormData.hid}):d.ajax({type:"POST",url:"/h/hermes/prefs/ajax/alert/v1",headers:{"X-CSRF":c.globals.formtoken},data:b,
success:function(){a.alertId="";a.alertFormData.alertid=""},error:function(a,b){c.events.publish("error.alert",{messages:b})}})},showAlertAuth:function(a,b){var e=this;a=d.extend({},a,{promoType:"alerts"});a={promo:"priceAlert",promoType:a.promoType,username:a.username,success:function(){c.authentication.cached_dialog.close();e.showFeedbackMessage=!0;e.alertFormData.createFromButton=!0;setTimeout(function(){window.location.reload()},1E4)}};b?c.authentication.showLogin(a):c.authentication.showSignup(a)},
handleWatch:function(){var a=this,b={method:"post",headers:{"X-CSRF":c.globals.formtoken},data:{dt:"0"===this.alertFormData.hId||""===this.alertFormData.hId?4:5,startDate:this.startDate.format(c.globals.apiDateFormat),endDate:this.endDate.format(c.globals.apiDateFormat),sendFrequency:1,"deliveryType[]":"email",citycode:this.alertFormData.cityId,hid:this.alertFormData.hId,rooms:this.alertFormData.numRooms,guests:this.alertFormData.guests||this.alertFormData.adults+this.alertFormData.children,email:!0}};
this.alertFormData.hid?(c.events.publish("trips.hotels.saveHotel",{hid:this.alertFormData.hid}),c.events.publish("alertsaved.success",{searchId:a.options.searchId})):d.ajax("/h/hermes/prefs/ajax/alert/v1",b).then(function(b){b.success&&(a.alertId=b.alertId,a.alertFormData.alertid=b.alertId,c.events.publish("alertsaved.success",{searchId:a.options.searchId}))})},resendConfirmationEmail:function(a){var b=d.Deferred();a&&a.email&&(this.alertFormData.email=a.email);d.ajax({type:"POST",headers:{"X-CSRF":c.globals.formtoken},
url:"/trips/mustconfirm/resend",data:this.serialize(),dataType:"script",error:function(a,d){c.events.publish("error.alert",{messages:d});b.reject()},success:function(){b.resolve()}})},serialize:function(){var a=this;return Object.keys(a.alertFormData).map(function(b){var c=a.alertFormData[b];return null===c||void 0===c||""===c?"":encodeURIComponent(b)+"\x3d"+encodeURIComponent(c)}).join("\x26")}})})(R9,jQuery);(function(a,b){a.createComponentClass("common.tags.ResultScreenDataLayer",{options:{},init:function(){this.options.attachMainParams&&this.answer("tags.dataLayer.hasCustomHandler",function(){return!0})},inlineComponentsReady:function(){a.events.publish("tags.dataLayer.push",this.options)}})})(R9,jQuery);(function(a,b){a.createComponentClass("hotels.results.HotelResultsDataLayer","common.tags.ResultScreenDataLayer",{})})(R9,jQuery);(function(b){b.createComponentClass("common.kn.AAX",{options:{pubId:"",version:"",hostname:""},loaded:!1,scriptInited:!1,flagNextPage:!1,adBlocked:!1,init:function(){},addEventHandlers:function(){this.subscribe(["adblock.detected"],this.onAdBlocked.bind(this));this.subscribe(["resultspage.ads.options"],b.Common.Utils.debounce(this.nextPage.bind(this),1E3))},inlineComponentsReady:function(){var c=b.question.ask("adblock.detected");if(c&&c.adblock)this.onAdBlocked()},onAdBlocked:function(){this.adBlocked||
(this.adBlocked=1,this.loadScript())},nextPage:function(){window.aax&&window.aax.cmd&&this.scriptInited?window.aax.cmd.push(function(){this.scriptInited&&window.aax&&window.aax.incrementPage&&(this.flagNextPage=!1,window.aax.incrementPage())}.bind(this)):this.flagNextPage=!0},loadScript:function(){if(!this.loaded){this.loaded=!0;window.aax=window.aax||{};window.aax.cmd=window.aax.cmd||[];var c=this,d=this.options,a=window.aax;a.cmd.push(function(){window.aax&&window.aax.getAbpStatus&&window.aax.getAbpStatus()&&
(c.scriptInited=!0,c.flagNextPage&&c.nextPage())});a.initTime=(new Date).getTime();a.pubId=d.pubId;a.ver=d.version;a.hst=d.hostname||window.location.hostname;var d="https://c.aaxads.com/aax.js?pub\x3d"+a.pubId+"\x26hst\x3d"+a.hst+"\x26ver\x3d"+a.ver,a=document.createElement("script"),b=document.getElementsByTagName("script")[0];a.type="text/javascript";a.async=!0;a.src=d;b.parentNode.insertBefore(a,b)}}})})(window.R9);(function(c,e,f){var g=c.config.getBoolean("ui.horizon.results.searchPoll.includePollNumberInQuery",!0),h={trains:"trains/results/TrainsSearchPoll",flights:"flights/results/FlightSearchPoll",hotels:"hotels/results/HotelSearchPoll",packages:"packages/results/PackageSearchPoll",cars:"cars/results/CarSearchPoll",deals:"deals/results/DealSearchPoll",cruises:"cruises/results/CruiseSearchPoll",rentals:"rentals/results/RentalSearchPoll",activities:"activities/results/ActivitiesSearchPoll",cityhotels:"hotels/cityhotels/CityHotelsPoll",
restaurants:"restaurants/results/RestaurantSearchPoll",essentials:"essentials/results/EssentialsSearchPoll"},k={trains:"trains/results/TrainsResultDetails",flights:"flights/results/FlightResultDetails",hotels:"hotels/results/HotelResultDetails",packages:"packages/results/PackageResultDetails",rentals:"rentals/results/HotelResultDetails",activities:"activities/results/ActivitiesResultDetails"};c.publish("base.results.AjaxSearchPoll",f.extend({searchUrl:null,detailsUrl:null,options:{vertical:null,searchId:null,
appendTo:null},pollNumber:0,searchId:null,constructor:function(a){this.options=e.extend({},this.options,a);if(!a.vertical)throw"AjaxSearchPoll requires a vertical to be properly initialized";this.searchId=this.options.searchId;this.searchUrl=h[this.options.vertical];this.detailsUrl=k[this.options.vertical];"cityhotels"===this.options.vertical&&this.options.citycode&&(this.searchUrl+="?citycode\x3d"+this.options.citycode)},fetchResults:function(a,b){a=e.extend({data:e.extend({searchId:this.searchId,
poll:!0,pollNumber:this.pollNumber},a||{}),appendTo:this.options.appendTo,replace:!1,logServerErrors:c.config.getBoolean("ui.ajax.logServerErrors.searchPoll",!1),enforceCaptcha:c.config.getBoolean("ui.ajax.enforceCaptcha.searchPoll",!0)},b||{});c.config.getBoolean("ui.ssajax.last.action.abort",!1)&&(a.data.ajaxts=(new Date).getTime());b=this.searchUrl;g&&(b+="?p\x3d"+this.pollNumber);this.searchId=a.data.searchId;this.pollNumber++;return c.ajax.execute(b,a)},fetchDetails:function(a,b){b={data:{resultId:a,
searchId:this.searchId},appendTo:b,enforceCaptcha:c.config.getBoolean("ui.ajax.enforceCaptcha.inlineDetails",!0)};if(null===b.searchId)throw"Cannot request result details for %s: No searchId tied to this instance of AjaxSaerchPoll.".format(a);return c.ajax.execute(this.detailsUrl,b)}}));c.publish("resultsMetaData",{PROPERTIES:"code selected minPrice count displayValue displayOrder resetState defaultSelectedState dynamicFilteredStatus ignoreOnly hideOnly href noSelect disabled cssClass showAllState noPrice pluralDisplayValue minDuration minDurationValue meta".split(" "),
publish:function(a){a.hasOwnProperty("filtersData")&&this.remapFilters(a.filtersData);c.events.publish("search.poll.response",a)},remapFilters:function(a){for(var b=Object.keys(a),c=0;c<b.length;c++){var d=a[b[c]];d.valueMap||d.headingValueMap?this.remapValueSetFilter(d):(d.legValues||d.legHeadingValues)&&this.remapPerLegValueSetFilter(d)}},remapValueSetFilter:function(a){if(a.valueMap)Object.values(a.valueMap).forEach(this.remapValueData.bind(this));else if(a.headingValueMap)for(var b in a.headingValueMap)Object.values(a.headingValueMap[b]).forEach(this.remapValueData.bind(this))},
remapPerLegValueSetFilter:function(a){if(a.legValues)Object.values(a.legValues).forEach(this.remapValueSetFilter.bind(this));else if(a.legHeadingValues)for(var b=0;b<a.legHeadingValues.length;b++)Object.values(a.legHeadingValues[b]).forEach(this.remapValueSetFilter.bind(this))},remapValueData:function(a){for(var b=a.rawState?a.rawState.split(";"):[],c=0;c<b.length;c++){var d=b[c];d.length&&(a[this.PROPERTIES[c]]=this.castValue(this.PROPERTIES[c],d))}if(a.hasOwnProperty("dynamicFilteredStatus")){a.filtered=
!1;a.partiallyFiltered=!1;switch(a.dynamicFilteredStatus){case 1:a.filtered=!0;break;case 2:a.partiallyFiltered=!0}delete a.dynamicFilteredStatus}a.hasOwnProperty("noPrice")&&a.noPrice&&(a[a.noPrice]=!0,delete a.noPrice);delete a.rawState},castValue:function(a,b){switch(a){case "code":case "displayValue":case "minPrice":case "pluralDisplayValue":case "cssClass":case "minDuration":case "href":case "noPrice":return b;case "selected":case "count":case "displayOrder":case "showAllState":case "resetState":case "defaultSelectedState":case "minDurationValue":case "dynamicFilteredStatus":return parseInt(b);
case "ignoreOnly":case "hideOnly":case "noSelect":case "disabled":return"1"===b;default:return b}}})})(R9,jQuery,base2.Base);(function(f,k,l){var m=f.config.getBoolean("ui.horizon.resultspage.reconcile.openDetails",!0),n=f.config.getBoolean("ui.horizon.resultspage.reconcile.openDialogs",!0);f.publish("base.results.ResultsPageDOMUtils",{mergeOpenResults:function(a,d){if(m){var c=a.find(".Base-Results-HorizonResult.DetailOpen");c.length&&this.mergeOpenDetails(c,a)}n&&(c=k(".Common-Widgets-Dropdown-DropdownDialog-Content.open"),c.length&&this.mergeOpenDialogs(c,a,d))},mergeOpenDialogs:function(a,d,c){for(var b=0;b<a.length;b++){var e=
a[b].getAttribute("data-dropdown-owner");if(e&&d.find("#"+e).length){e=c.find("#"+a[b].id);if(e.length){var g=e.attr("id").split("-")[0],h=k("#"+g),g=c.find("#"+g);if(h.length&&g.length&&h.index()===g.index()){a[b].setAttribute("reconcile-ignore","attributes");f.dom.merge(a[b],e[0]);e[0].remove();continue}}a[b].remove()}}},mergeOpenDetails:function(a,d){for(var c=0;c<a.length;c++)if(!d.find("#"+a[c].id).hasClass("DetailOpen")){a[c].setAttribute("reconcile-ignore","attributes");var b=a[c].getElementsByClassName("detailsWrapper");
1===b.length&&(b[0].setAttribute("reconcile-ignore","all"),b=b[0].getElementsByClassName("detailsContent"),b.length&&b[0].children.length&&b[0].children[0].setAttribute("do-not-destroy","true"))}}});f.publish("base.results.AdsHelper",l.extend({adRequestInfo:null,adsResponseDate:null,adUpdateTimerID:null,constructor:function(a){this.adRequestInfo={}},updateAds:function(a){f.config.getBoolean("ui.ads.copyPollAdsData",!0)&&(a=k.extend(!0,{},a));if(f.config.getBoolean("ui.ads.nowAfterResponse",!0)&&this.adRequestInfo)for(var d in this.adRequestInfo)if(this.adRequestInfo.hasOwnProperty(d)){var c=
this.adRequestInfo[d];if(c)for(var b=0;b<c.length;b++)c[b].now=0}this.adsResponseDate=Date.now();window.clearTimeout(this.adUpdateTimerID);this.adUpdateTimerID=setTimeout(function(){f.events.publish("resultspage.ads.update",a)},f.config.getInt("ui.horizon.resultspage.ads.updateDelay",100))},requiresAdsPoll:function(){if(!f.config.getBoolean("ui.horizon.resultspage.requireAdsPoll",!0)||this.adsResponseDate||!this.adRequestInfo)return!1;for(var a in this.adRequestInfo)if(this.adRequestInfo.hasOwnProperty(a)){var d=
this.adRequestInfo[a];if(d&&d.pop)for(var c=0;c<d.length;c++)if(d[c].now)return!0}return!1},clearAdRequestInfo:function(a){this.adRequestInfo&&(this.adRequestInfo[a]=[])},onSetupAdsRequest:function(a){if(a&&a.adType&&a.pageLocation){this.adRequestInfo||(this.adRequestInfo={});this.adRequestInfo[a.adType]||(this.adRequestInfo[a.adType]=[]);for(var d=this.adRequestInfo[a.adType],c,b=0;b<d.length;b++)d[b]&&d[b].pageLocation===a.pageLocation&&(c=1,d[b]=a);c||d.push(a)}},setAdRequestSearchOptions:function(a,
d){if(a&&this.adRequestInfo){var c="",b="",e,g,h=function(a){if(!a||!a.length)return"";for(var c="",b,e=0;e<a.length;e++)(b=a[e])&&b.pageLocation&&(!isNaN(b.minRefreshRate)&&(0<b.minRefreshRate||0===b.minRefreshRate)&&(g=void 0===g?b.minRefreshRate:Math.min(g,b.minRefreshRate)),b.now||b.events&&b.events.pop&&"string"===typeof d&&0<=b.events.indexOf(d))&&(f.config.getBoolean("ui.ads.nowAfterResponse",!0)||(b.now=0),c+=b.pageLocation+",");return c};for(e in this.adRequestInfo)this.adRequestInfo.hasOwnProperty(e)&&
("displayAd"===e?c=h(this.adRequestInfo[e]):"textAd"===e&&(b=h(this.adRequestInfo[e])));d&&f.events.publish("resultspage.ads.options");!a.forceRefreshAds&&this.adsResponseDate&&0<g&&Date.now()-this.adsResponseDate<g||(b&&(a.textAdPageLocations=b.substr(0,b.length-1)),c&&(a.displayAdPageLocations=c.substr(0,c.length-1)),a.existingAds=!!this.adsResponseDate)}}}))})(R9,jQuery,base2.Base);(function(c,e){var l=/attempt=([0-9]+)/,m=/lastms=([0-9]{13})/,p=c.config.getBoolean("ui.ajax.logServerErrors.searchPoll",!1);c.createComponentClass("base.results.ResultsPage",{searchRunner:null,searchId:null,priceType:null,searchStartParams:null,vertical:null,urlSearchStartSupported:!1,loggingPrefix:"resultspage",poll:{pollingId:null,sent:0,activeRequest:null,ended:!1,nextPollTimeoutId:null,firstPhaseCompleted:!1,consecutiveEmptyResponses:0,lastPollTotalCount:-1,started:null,usingPreservedFilters:!1,
reason:"POLL"},filterState:null,urlFilterState:null,filtersData:null,useUrlFilterState:!0,useViewStateFilterState:!0,resultsList:e(),listBody:e(),listCol:null,progressBar:null,paginator:null,viewState:null,leftRail:null,rightRail:null,backToTop:null,clientTimeoutId:null,idleTimeoutId:null,secondPhaseTimeoutId:null,frenchWarning:null,ariaResultMsgWidget:null,ajaxAppendTo:null,preserveFilters:!1,preservedFilters:null,adsHelper:null,lastLimitedDateMs:null,lastLimitedMinMS:18E5,activeRequests:{},options:{infinite:!1,
button:!1,startSearchImmediately:!1,searchParams:null,ajaxParams:null,poll:!0,pageNumber:1,searchId:null,completed:!1,sortMode:null,quickLinkType:null,ascending:null,priceType:null,centerPointLat:null,centerPointLong:null,urlFilterState:null,pollingTimeout:16E3,exponentialBackoffDelay:!1,pollDelay:250,maxPollDelay:5E3,pollingId:null,windowScroll:"",persistWindowScroll:!1,filtersData:null,quickLinkData:null,useTwoPhasePolling:!1,visible:!1,useBuzz:!1,fastCover:!1,showExpiredResultsMessage:!0,secondPhaseWait:null,
secondPhaseTimeout:null,idleExpireMinutes:120,enforceIdleTimeout:!0,showFilteredButSimilar:!1,scrollTopOnFilterChange:!1,defaultSortType:null,useUrlSortMode:!1,msg:{expired_search:"",filters_removed:""},ariaMsg:{resultsLoading:"",resultsReady:"",noResultsFound:""},nonClearablePreservedFilters:[],forceLoadingTreatmentSkip:!1,placeholderDelay:0,defaultPaddingLeft:30,watchedResultId:"",animateInlineSearch:!0,useActiveRequestsMap:!1},init:function(){this.appendResults=this.options.infinite||this.options.button;
this.filterState={};this.viewState={openDetails:{}};this.leftRail=this.getChildElement("leftRail");this.rightRail=this.getChildElement("rightRail");this.backToTop=this.getChildElement("backToTop");this.resultsList=this.getChildElement("list");this.listBody=this.element.find(".listBody");this.listCol=this.getChildElement("listCol");this.resultsListCover=this.listBody.find(".resultsListCover");this.loadingMessage=this.element.find(".loadingMessage");this.progressBar=this.getChildElement("progress");
this.frenchWarning=this.getChildElement("frenchWarning");this.searchId=this.options.searchId;this.priceType=this.options.priceType;this.poll.pollingId=this.options.pollingId;this.urlFilterState=this.options.urlFilterState;this.searchStartParams=this.options.searchStartParams||{};this.ariaResultMsgWidget=this.getChildElement("aria-result-msg").getWidget();c.events.publish("paginator.hide");this.options.filtersData&&c.resultsMetaData.remapFilters(this.options.filtersData)},addEventHandlers:function(){var a=
this,b=null,d=function(){null!==b&&clearTimeout(b);b=setTimeout(function(){c.action.execute("common/utils/history/UserStateUpdateAction",{storageType:"viewState",searchId:a.searchId,key:"openDetails",value:JSON.stringify(a.viewState.openDetails)})},1E3)};this.subscribe(["searchform.submit","multilocale.search.submit"],this.startSearchFromSearchForm.bind(this));var g=this.onFilterStateChange.bind(this);g.priority=0;this.subscribe("filters.changed",g);this.subscribe("filters.changed.all",this.onAllFilterStateChange.bind(this));
g=this.preprocessResponse.bind(this);g.priority=0;this.subscribe("search.poll.response",g);this.subscribe("resultspage.filters.sync",this.syncFilterState.bind(this));this.subscribe("paginator.change",this.onPaginatorChange.bind(this));this.subscribe("resultsHeader.changed",this.onResultsListHeaderChange.bind(this));this.subscribe("resultspage.view.setvisible",this.setVisible.bind(this));this.subscribe("resultspage.results.refresh",this.refreshResults.bind(this));this.subscribe("resultspage.transition.remove",
this.removeTransitionClass.bind(this));this.subscribe(["result.details.opened","result.details.tab.changed"],function(b){a.viewState.openDetails[b.resultId]=b.activeTab||"overview";d()});this.subscribe("result.details.closed",function(b){delete a.viewState.openDetails[b.resultId];d()});this.subscribe("searchForm.changed",this.toggleSearchFormChanged.bind(this));this.subscribe("unbind.scroll.search.event",this.toggleSearchFormChanged.bind(this,!1));this.subscribe(["results.expired","user.refresh.expired"],
this.reloadExpiredResults.bind(this));this.subscribe("resultspage.showLowest",function(){c.events.publish("filters.reset",{type:"showAll"});c.events.publish("resultsHeader.sortType.set",{sortCode:"price_a"})});this.subscribe("ads.request",function(b){a.getAdsHelper().onSetupAdsRequest(b)});this.subscribe("results.quickLinkType.setDefault",function(b){b.hasOwnProperty("quickLinkType")&&(a.options.quickLinkType=b.quickLinkType)});this.answer("resultspage.filterState.is",function(b){return b&&a.filterState?
a.filterState[b]:a.filterState});this.answer("resultspage.filterData.get",function(){return a.filtersData?a.filtersData:a.options.filtersData});this.answer("resultspage.priceType.get",function(){return a.priceType});this.answer("resultspage.sortMode.get",function(){return a.options.sortMode});this.answer("resultspage.searchFailed",function(){return a.listBody.hasClass("failed")});this.answer("resultspage.urlFilterState.get",function(){return a.urlFilterState});this.answer("resultspage.leftMargin",
this.getPageContainerLeftMargin.bind(this));this.answer("resultspage.poll.ended",function(){return a.poll.ended});this.answer("resultspage.searchId.get",function(){return a.searchId});this.appendResults&&(this.backToTop.click(this.setupBackToTopClick.bind(this)),this.subscribe("resultspage.pageNumber.changed",this.setupBackToTopPosition.bind(this)));this.subscribe("results.leftRail.toggleCollapsed",this.toggleLeftRailCollapsed.bind(this));e(window.document).on("mouseleave.horizonResult",function(){c.events.publish("document.mouseLeave")});
e(window).on("keydown.landmark_nav",function(b){var c=b.which,d=b.shiftKey,g=b.altKey,f=b.metaKey;b=b.ctrlKey;if(9===c&&g&&f||9===c&&g&&b)if(b=e("*:focus"),c=e("[role\x3dform],[role\x3dsearch],[role\x3dmain]"),g=d?-1:c.length,f=d?c.length-1:0,d=d?-1:1,b.length){var n=b.closest("[role\x3dform],[role\x3dsearch],[role\x3dmain]");n.length?(b=e(n[0]).index("[role\x3dform],[role\x3dsearch],[role\x3dmain]"),d=b+d,d===g&&(d=f),c[d].focus()):(d=a.nextInDOM("[role\x3dform],[role\x3dsearch],[role\x3dmain]",
b))&&d.focus()}else c[0].focus()})},nextInDOM:function(a,b){for(b=this.getNext(b);0!==b.length;){var c=this.searchFor(a,b);if(null!=c)return c;b=this.getNext(b)}return null},getNext:function(a){return 0<a.next().length?a.next():this.getNext(a.parent())},inlineComponentsReady:function(){c.config.getBoolean("ui.rp.alwaysReqAdSetup",!0)&&c.events.publish("resultspage.adinfo.empty");this.options.visible&&c.events.publish("resultspage.view.setvisible",!0);if(this.options.searchId){c.utils.performance.setEnabled(this.shouldTrackStreamingPerformance());
this.setupStreaming(this.options.searchId,this.options.completed);if(this.options.windowScroll&&0<this.options.windowScroll.length&&this.options.persistWindowScroll){var a=this.options.windowScroll.split(";");e(window).scrollTop(a[0]);e(window).scrollLeft(a[1])}null!==this.options.quickLinkData&&c.events.publish("resultspage.quickLinkData.changed",this.options.quickLinkData)}else this.options.startSearchImmediately&&this.startSearch(this.options.searchParams,this.options.ajaxParams)},searchFor:function(a,
b){var c=this;if(b.is(a))return b;var g=null;b.children().each(function(){g=c.searchFor(a,e(this));if(null!=g)return!1});return g},setVisible:function(a){(this.options.visible=a)?this.element.addClass("ResultsVisible"):this.element.removeClass("ResultsVisible");this.setColumnsVisible(a,400)},setupStreaming:function(a,b){this.searchId=this.options.searchId;this.searchRunner=new c.base.results.AjaxSearchPoll({searchId:a,vertical:this.vertical,appendTo:this.ajaxAppendTo?this.ajaxAppendTo:this.resultsList,
replace:!this.appendResults});c.events.publish("resultspage.searchId.changed",{searchId:this.searchId,searchStartParams:this.searchStartParams});window.SearchID=this.searchId;null!==this.options.filtersData&&(this.filtersData=this.options.filtersData,c.events.publish("resultspage.filtersData.changed",this.filtersData));b&&this.getAdsHelper().requiresAdsPoll()&&(b=!1);this.logSmartyInteractions();b&&c.config.getBoolean("ui.horizon.resultspage.%s.handleCompleted".format(this.vertical||"base"),!1)?this.endPolling():
(c.events.publish("resultspage.streaming.start"),this.listBody.addClass("streaming-in-progress"),this.resultsReason="init",this.poll.reason="POLL",this.getResults(),this.startedStreaming())},logSmartyInteractions:function(){c.config.getBoolean("ui.smarty.r9LogOptions",!0)&&this.searchId&&c.events.publish("smartylogger.log.searchId",this.searchId)},startSearchFromSearchForm:function(a){if(!(a&&a.stopSearch&&a.navigateToResults))if(this.resultsReason="searchform.submit",a.tab!==this.vertical)c.Analytics.api.trackEvent("resultspage/search/vertical-mismatch"),
window.location.href=a.url;else{if(a.searchFormFilterState){var b="";Object.keys(a.searchFormFilterState).each(function(c){b&&(b+=";");b+=c+"\x3d"+a.searchFormFilterState[c]});this.urlFilterState=b;this.useViewStateFilterState=this.useUrlFilterState=!!b;delete a.filterState}else this.urlFilterState=null;a.preserveFilters?(this.preserveFilters=!0,this.useUrlFilterState=!1,this.urlFilterState&&this.urlFilterState.split(";").forEach(function(a){a=a.split("\x3d");this.filterState[a[0]]=a[1]},this),this.setPreservedFilterState(a)):
(this.preservedFilters=null,this.preserveFilters=!1);delete a.searchFormFilterState;this.options.visible&&this.options.animateInlineSearch&&this.bounceResults();a.navigateToResults||this.startSearch(a)}},startSearch:function(a){this.ariaResultMsgWidget.activateLoadMessage(this.options.ariaMsg.resultsLoading);this.resultsList.attr("aria-busy",!0);if(a.url&&c.authentication.needsRefresh)window.location="/"===a.url[0]?a.url:"/"+a.url;else{c.Vestigo&&c.Vestigo.view();c.events.publish("search.startSearch",
a);c.events.publish("resultspage.streaming.start",a);this.resultsList.removeClass("hidden");this.searchRunner=new c.base.results.AjaxSearchPoll({vertical:this.vertical,appendTo:this.ajaxAppendTo?this.ajaxAppendTo:this.resultsList});this.searchId&&this.cleanupExistingSearch(a);this.poll.sent=0;this.poll.ended=!this.options.poll;this.poll.pollingId=""+Math.floor(65536*Math.random())+1;this.poll.lastPollTotalCount=-1;this.poll.consecutiveEmptyResponses=0;this.preservedFilters&&Object.keys(this.preservedFilters).length&&
(this.poll.usingPreservedFilters=!0);this.options.pageNumber=1;var b=e.extend(this.options.searchParams,a);this.getAdsHelper().setAdRequestSearchOptions(b,this.resultsReason);this.searchStartParams=b;c.utils.performance.setEnabled(this.shouldTrackStreamingPerformance());c.utils.performance.clearMarks(["search_start","first_result","first_phase_complete","polling_complete","first_result_rendered"]);this.getResults(0,b);this.skipLoadingTreatment()||this.addTransitionClass(a)}},abortPollActiveRequests:function(){var a=
this;this.options.useActiveRequestsMap&&this.activeRequests?Object.keys(this.activeRequests).forEach(function(b){a.activeRequests[b].abort();delete a.activeRequests[b]}):this.poll.activeRequest&&this.poll.activeRequest.abort()},cleanupExistingSearch:function(){this.abortPollActiveRequests();c.events.publish("resultspage.cleanup",this.searchId);this.stopIdleTimeout();this.destroyOldResults();this.resultsList.find("#searchResultsList").html("");this.listBody.removeClass("failed").attr("aria-hidden",
!1);this.searchId=null;this.poll.pollingId=null;this.preserveFilters||(this.filterState={});this.priceType=null;c.events.publish("paginator.hide");this.poll.firstPhaseCompleted=!1;this.poll.lastPollTotalCount=-1;this.poll.consecutiveEmptyResponses=0;this.poll.reason=null;this.poll.usingPreservedFilters=!1;this.options.filtersData=null;this.options.completed=!1;this.searchStartParams={};this.lastLimitedDateMs=null;!this.preservedFilters&&this.options.defaultSortType&&this.resetSortTypeForNewSearch(this.options.defaultSortType);
this.options.watchedResultId=null},resetSortTypeForNewSearch:function(a,b){this.options.sortMode=null;c.events.publish("resultsHeader.sortType.set",{sortCode:a,silent:"boolean"===typeof b?b:!0})},destroyOldResults:function(){c.ComponentManager.remove(this.resultsList.find("#searchResultsList"),!1);var a=this.element.find("#savedResultsListContainer");a.length&&c.ComponentManager.remove(a,!1)},destroyBuzzResults:function(){},beforeAppendNewResults:function(){},beforeUpdateDOM:function(a,b){a=e(a.parsedContent);
if(b)return this.beforeAppendNewResults();0===a.length&&c.config.getBoolean("ui.horizon.rp.skipEmptyPoll",!0)||(!this.poll.ended&&a.find(".Base-Results-HorizonResult").length&&c.utils.performance.mark("first_result"),this.doCustomUpdate({append:b})&&c.base.results.ResultsPageDOMUtils.mergeOpenResults(this.listBody,a),this.destroyOldResults(a))},publishAfterUpdateDOMEvent:function(){},getResults:function(a,b,d,g){var f=this;b=b||{};var h=e.extend(this.getFetchResultsOpts(b.fetchOpsParams),b);a=void 0!==
a?a:this.options.pollDelay;var k={beforeScript:function(){f.beforeUpdateDOM(this.response,h.append)},replace:!h.append,afterUpdateDOM:function(){f.publishAfterUpdateDOMEvent();f.poll.ended&&f.removeTransitionClass();if(h.append&&c.config.getBoolean("ui.resultspage.aria.focusOnPaginate",!0)){var a=f.resultsList.find("#"+f.options.searchId+"-"+f.options.pageNumber).children("[tabbable]").eq(0);a.length&&a.get(0).focus()}"function"===typeof g&&g()}};this.preservedFilters&&Object.keys(this.preservedFilters).length&&
(h.filterState=JSON.stringify(this.preservedFilters));this.doCustomUpdate(h)&&(k=e.extend(k,{customUpdate:f.updateDOM.bind(this)}));k=this.addCustomPollAjaxParams(k);d&&(h.isSecondPhase=!1);this.abortPollActiveRequests();b.resetFilters&&(h=e.extend({},h,{useViewStateFilterState:!1}));d=function(){c.utils.performance.mark("search_start");f.poll.sent++;var a=f.poll.sent,b=f.searchRunner.fetchResults(h,k);b.then(function(b,c){f.checkSearchExpired(b,c);f.options.useActiveRequestsMap?delete f.activeRequests[a]:
delete f.poll.activeRequest}).fail(function(a,b){var c=e.extend({type:"ajax"},a||{});a.type&&(c.ajaxErrorType=a.type);b&&!c.status&&(c.status=b);f.handleError(c)});f.options.useActiveRequestsMap?f.activeRequests[a]=b:f.poll.activeRequest=b;c.events.publish("resultspage.requestResults")};clearTimeout(this.poll.nextPollTimeoutId);0<a||c.config.getBoolean("ui.horizon.resultspage.pollTimeout.always",!1)?this.poll.nextPollTimeoutId=setTimeout(d,a):d()},checkSearchExpired:function(a,b){b&&202===b.status&&
(this.endPolling(),c.events.publish("search.expired"))},doCustomUpdate:function(){return!1},addCustomPollAjaxParams:function(a){return a},endPolling:function(a,b){var d="pausedetails"===a;this.ariaResultMsgWidget.deactivateLoadMessage(this.options.ariaMsg.resultsReady);this.poll.ended||(d||(c.utils.performance.mark("polling_complete"),this.poll.ended=!0,this.log.console("Ended polling")),this.removeTransitionClass(),this.listBody.removeClass("streaming-in-progress"),this.stopClientTimeout(),this.stopSecondPhaseTimeout(),
d||(c.events.publish("resultspage.streaming.done",{searchId:this.searchId,reason:a,error:b}),a&&(b&&"object"===typeof b&&b.type&&(a+="/"+b.type),c.Analytics.api.trackEvent({category:"ResultsPage",action:"search_finished",label:a})),this.useViewStateFilterState=this.useUrlFilterState=!1),this.resultsList.attr("aria-busy",!1))},clearPreservedFilters:function(){this.preservedFilters=null;this.preserveFilters=!1},handleError:function(a){if(!a||"object"!==typeof a||0!==a.status&&!a.aborted){if("object"===
typeof a){if(a.searchExpired&&!a.avoidReload){this.reloadExpiredResults();return}if(a.type){var b=a.message||a.status;"ajax"===a.type?(p||!a.status||500>a.status)&&this.log.error("RP ajax error:"+(b?" ("+b+")":""),a):"limitreload"===a.type&&c.config.getBoolean("ui.rp.limitReloadError",!1)?this.log.error(a.message,a):c.Analytics.api.trackEvent({category:this.loggingPrefix,action:"error",label:a.type,value:b})}}this.endPolling("error",a);this.resultsList.addClass("hidden");c.events.publish("paginator.hide");
this.removeTransitionClass();this.listBody.addClass("failed").attr("aria-hidden",!0);c.events.publish("search.searchFailed",a);a&&"noresults"===a.type&&a.response&&a.response.filtersData&&(a=Object.keys(a.response.filtersData),0<a.length&&(a.forEach(function(a){c.events.publish("filter.show",{name:a})}),c.events.publish("resultspage.filterList.show")))}},getFetchResultsOpts:function(a){a=e.extend(a||{},{applyFilters:!0,filterState:null,useViewStateFilterState:this.useViewStateFilterState,pageNumber:this.options.pageNumber,
watchedResultId:this.options.watchedResultId});a.append=1<this.options.pageNumber&&this.appendResults;null!==this.poll.pollingId&&(a.pollingId=this.poll.pollingId);null!==this.options.sortMode&&(a.sortMode=this.options.sortMode,null!==this.options.ascending&&(a.ascending=this.options.ascending));null!==this.priceType&&(a.priceType=this.priceType);this.useUrlFilterState&&this.urlFilterState?a.filterState=this.urlFilterState:this.filterState&&0<Object.keys(this.filterState).length&&(a.filterState=JSON.stringify(this.filterState));
this.changingFilter&&(a.changingFilter=JSON.stringify(this.changingFilter),this.changingFilter=null);if(this.options.persistWindowScroll&&this.poll.ended&&(!this.appendResults||1===this.options.pageNumber)){var b=e(window).scrollTop().toFixed(),c=e(window).scrollLeft().toFixed();a.windowScroll=""+(0<b?b:0)+";"+(0<c?c:0)}!this.poll.ended&&-1<this.poll.lastPollTotalCount&&(a.lastPollTotalCount=this.poll.lastPollTotalCount);a.requestReason="string"===typeof this.poll.reason?this.poll.reason:"POLL";this.options.phoenixRising&&
(a.phoenixRising=!0);a.isSecondPhase=this.poll.firstPhaseCompleted;this.getAdsHelper().setAdRequestSearchOptions(a,this.resultsReason);a.openDetails=this.viewState.openDetails;return a},setupNewlyCreatedSearch:function(a){this.searchRunner.searchId=this.searchId=a.searchId;this.log.console("setting up searchId",this.searchId);c.events.publish("resultspage.searchId.changed",{searchId:this.searchId,searchStartParams:this.searchStartParams});window.SearchID=this.searchId;"pageTitle"in a&&(document.title=
a.pageTitle);"viewState"in a&&"priceType"in a.viewState&&(this.priceType=a.viewState.priceType,c.events.publish("resultspage.priceType.changed",{priceType:this.priceType}));this.logSmartyInteractions();this.options.pollingTimeout=a.uiTimeout;this.startedStreaming()},firstResultsRendered:function(){},isFirstResults:function(a,b){return a&&b&&0<b.totalCount&&0>this.poll.lastPollTotalCount},preprocessResponse:function(a){if(this.searchId||"searchId"in a){var b=this.options.poll&&!this.poll.ended,d=this.isFirstResults(b,
a);if(a&&(!this.poll.firstPhaseCompleted||!a.secondPhaseWait||a.completed||a.error)){this.log.console("received response",a);!this.searchId&&"searchId"in a&&"string"===typeof a.searchId&&this.setupNewlyCreatedSearch(a);d&&(c.events.publish("resultspage.streaming.firstResults"),this.firstResultsRendered(a));this.options.completed=a.completed;if(a.error){b={type:"server",message:a.errorMessage,searchExpired:a.searchExpired};a.searchStartError&&(b={type:"query",userDisplayMessage:a.queryErrors.reduce(function(a,
b){return a+"\x3c/br\x3e"+b})});this.handleError(b);return}var g="isCustomTicket"in a&&a.isCustomTicket;"isMultiAirport"in a&&c.events.publish("resultspage.multiAirport.changed",a.isMultiAirport);if("filtersData"in a){this.filtersData=a.filtersData;var e=function(){this.log.time("filterUpdate");c.events.publish("resultspage.filtersData.changed",a.filtersData);c.events.publish("%s.resultspage.filtersData.changed.done".format(this.vertical),a.filtersData);this.log.timeEnd("filterUpdate")}.bind(this);
b&&d&&c.config.getBoolean("ui.horizon.resultspage.delayFilterPaint",!0)?setTimeout(e,c.config.getInt("ui.horizon.resultspage.delayFilterPaint.time",100)):e()}"urlFilterState"in a&&!this.useUrlFilterState&&(this.urlFilterState=a.urlFilterState,this.options.useUrlFilterState&&!g&&this.updateUrlFilterState(a.urlFilterState));"quickLinkData"in a&&c.events.publish("resultspage.quickLinkData.changed",a.quickLinkData);"sortMode"in a&&(this.options.useUrlSortMode&&!g&&this.updateUrlSortState(a.sortMode),
c.events.publish("resultspage.sortMode.changed",{customTicket:g,sortCode:a.sortMode}));"taxesEstimated"in a&&c.events.publish("resultspage.taxesEstimated.changed",{taxesEstimated:a.taxesEstimated});"viewState"in a&&"priceType"in a.viewState&&c.events.publish("resultspage.priceType.changed",{priceType:a.viewState.priceType});"warnDestinationCC"in a&&c.events.publish("resultspage.warnDestinationCC.changed",{warnDestinationCC:a.warnDestinationCC});"swindle"in a&&c.Common&&c.Common.SwindlePublisher&&
c.Common.SwindlePublisher.publish(a.swindle);a.ads&&(this.resultsReason=null,this.getAdsHelper().updateAds(a.ads));if(a.completed){if(0===a.totalCount&&0===a.filteredCount){this.handleError({type:"noresults",message:"Finished search but failed to find results",response:a});this.ariaResultMsgWidget.deactivateLoadMessage(this.options.ariaMsg.noResultsFound);return}this.endPolling("completed",null,a);b=this.options.poll&&!this.poll.ended}if(this.checkFilteredCount(a)||a.error)this.removeTransitionClass(),
a.allResultsWereFiltered&&!this.options.showFilteredButSimilar&&this.listBody.addClass("failed").attr("aria-hidden",!0);this.setFirstPhaseCompleted(a);(a.completed||0<a.filteredCount&&0<a.totalCount)&&c.events.publish("resultspage.results.count.changed",{filtered:a.filteredCount,total:a.totalCount});c.events.publish("paginator.update",{pageNumber:a.pageNumber,pageCount:a.pageCount});c.events.publish("resultspage.refreshed",{streaming:!a.completed});this.didReceiveResults(a);this.poll.ended&&c.events.publish("paginator.getmoreresults.completed")}b&&
this.setupNextPollRequest(a,d);this.updateCubaWarning(a);this.resultsList.removeClass("hidden")}},checkFilteredCount:function(a){return 0<a.filteredCount||a.allResultsWereFiltered},setupNextPollRequest:function(a,b){"totalCount"in a&&0<a.totalCount&&a.totalCount!==this.poll.lastPollTotalCount?(this.poll.consecutiveEmptyResponses=0,this.poll.lastPollTotalCount=a.totalCount):this.poll.consecutiveEmptyResponses++;var c=this.options.pollDelay;!a.cached&&this.options.exponentialBackoffDelay&&(c=this.options.pollDelay+
1E3*Math.log(this.poll.consecutiveEmptyResponses+1));a=Math.min(c,this.options.maxPollDelay);this.poll.firstPhaseCompleted&&0<=this.options.secondPhaseWait&&(a=this.options.secondPhaseWait);b&&(a=0);this.poll.reason="POLL";this.getResults(a)},setFirstPhaseCompleted:function(a){this.poll.firstPhaseCompleted!==a.firstPhaseCompleted&&(this.poll.firstPhaseCompleted=a.firstPhaseCompleted,this.poll.firstPhaseCompleted&&(c.events.publish("resultspage.streaming.firstPhase.done"),this.startSecondPhaseTimeout(),
c.utils.performance.mark("first_phase_complete")))},syncState:function(a,b){null===b.state?delete a[b.name]:b.name&&(a[b.name]=b.state)},syncFilterState:function(a){this.syncState(this.filterState,a);this.preserveFilters&&a.syncPreservedState&&this.syncPreservedFilters(a)},syncPreservedFilters:function(a){this.syncState(this.preservedFilters,a)},setPageNumber:function(a){this.options.pageNumber!==a&&(this.options.pageNumber=a,c.events.publish("resultspage.pageNumber.changed",a),c.action.execute("common/utils/history/UserStateUpdateAction",
{storageType:"viewState",searchId:self.searchId,key:"pageNumber",value:a.toString()}))},onFilterStateChange:function(a){this.useViewStateFilterState=this.useUrlFilterState=!1;this.resultsList.removeClass("hidden");this.syncFilterState(a);this.preserveFilters&&!a.syncPreservedState&&this.syncPreservedFilters(a);a.name&&a.changeData&&(this.changingFilter=e.extend({name:a.name},a.changeData));a.skipPageReset||this.setPageNumber(1);this.resultsReason="filters.changed";this.poll.reason="FILTER";a.reset&&
(this.poll.reason+=".RESET");this.refreshResults(a)},onAllFilterStateChange:function(a){var b=this;this.useUrlFilterState=!1;this.resultsList.removeClass("hidden");Object.entries(a.allChanges).forEach(function(a){b.syncFilterState({name:a[0],state:a[1]})});a.changingFilter&&(this.changingFilter=e.extend({},a.changingFilter));this.resultsReason="filters.changed";this.poll.reason="FILTER";this.refreshResults()},onPaginatorChange:function(a){a.append||e(window).scrollTop(0).trigger("scroll");c.Analytics.api.trackEvent("page/"+
a.pageNumber);this.setPageNumber(a.pageNumber);this.resultsReason="paginator.change";this.poll.reason="PAGINATE";this.refreshResults({append:a.append})},onResultsListHeaderChange:function(a){a.rpIgnore||(void 0!==a.sort?(this.options.sortMode=a.sort.sortType,this.options.ascending=a.sort.ascending,this.poll.reason="SORT",c.Analytics.api.trackEvent(this.loggingPrefix+"/sort/"+(a.sort.ascending?"":"-")+a.sort.sortType)):void 0!==a.priceType?(this.priceType=this.options.priceType=a.priceType,this.poll.reason=
"PRICETYPE",c.Analytics.api.trackEvent(this.loggingPrefix+"/priceType/"+a.priceType)):this.poll.reason="SORT",void 0!==a.reviewType&&(this.options.reviewType=a.reviewType,c.Analytics.api.trackEvent(this.loggingPrefix+"/reviewType/"+a.reviewType)),void 0!==a.quickLinkType&&(this.options.quickLinkType=a.quickLinkType,c.Analytics.api.trackEvent(this.loggingPrefix+"/quickLinkType/"+a.quickLinkType)),this.updateFrenchWarning(),this.setPageNumber(1),this.resultsReason="resultsHeader.changed",this.refreshResults())},
updateFrenchWarning:function(){this.frenchWarning&&this.frenchWarning.toggleClass("hidden",this.options.defaultSortType&&-1===this.options.defaultSortType.indexOf(this.options.sortMode))},updateCubaWarning:function(a){var b=this.getChildElement("cubaWarning"),c=this.getChildElement("cubaWarningWrapper");a.hasOwnProperty("cubanQuery")&&a.cubanQuery?(b.addClass("visible"),c.addClass("visible").attr("aria-hidden",!1)):b.hasClass("visible")&&(c.removeClass("visible","aria-hidden",!0),b.addClass("visible"))},
addTransitionClass:function(a){if(!this.options.forceLoadingTreatmentSkip||!this.skipLoadingTreatment()){var b=[];this.options.blurTransition&&(b.push("blur"),this.resultsList.addClass("blur"));this.options.spinnerTransition&&b.push("loading");this.options.fastCover?(this.resultsListCover.addClass(b.join(" ")),a&&a.overlayTop&&this.resultsListCover.css("top",a.overlayTop-this.listBody.position().top)):this.listBody.addClass(b.join(" "))}},removeTransitionClass:function(){this.options.blurTransition&&
this.resultsList.removeClass("blur");this.resultsListCover.removeClass("loading blur").css("top",null);this.listBody.removeClass("loading blur");this.loadingMessage.addClass("hidden")},refreshResults:function(a){if(this.searchRunner){!this.searchId&&c.config.getBoolean("horizon.resultspage.dontRefreshBeforeSearchStart",!0)&&this.searchStartParams&&(a=e.extend({},a,this.searchStartParams));a&&a.customRequest&&(this.resultsReason=a.customRequest,"details.unpause"===this.resultsReason&&(this.listBody.addClass("streaming-in-progress"),
this.poll.reason="POLL"));this.ariaResultMsgWidget.activateLoadMessage(this.options.ariaMsg.resultsLoading);var b=this.poll.reason&&-1<this.poll.reason.indexOf("FILTER")?200:0,d=a&&a.afterUpdateFn;d&&delete a.afterUpdateFn;this.getResults(b,a,!0,d);"undefined"!==typeof a&&"undefined"!==typeof a.append&&a.append||(c.dom.schedule(this.addTransitionClass.bind(this,a)),this.listBody.removeClass("failed").attr("aria-hidden",!1))}},reloadExpiredResults:function(){this.addTransitionClass();this.log.console("reloading expired results");
this.options.showExpiredResultsMessage&&(this.options.msg.expired_search&&this.loadingMessage.text(this.options.msg.expired_search),this.resultsListCover.addClass("expired"),this.loadingMessage.removeClass("hidden"));c.Analytics.api.trackEvent(this.loggingPrefix+"/searchexpired");var a;if(c.config.getInt("ui.rp.limitExpiredReload",!0)){if(a=this.limitedReloadUrl(),!a)return}else a=this.mergeFilterStateWithUrl(this.urlFilterState);window.location.href=a},stopSearch:function(a){e.get("/s/sparkle?action\x3dkillseeker\x26searchid\x3d%s\x26formtoken\x3d%s".format(a||
this.searchId,c.globals.formtoken))},clientTimeout:function(){this.log.console("client timed out");if(c.config.getBoolean("ui.horizon.rp.streaming.timeout.reload",!0)){this.stopSearch();var a=this.limitedReloadUrl();a&&(this.handleError({type:"timeout",message:"Reached polling timeout without completing"}),window.location=this.mergeStateWithUrl("true","force",a))}},limitedReloadUrl:function(){var a=l.exec(window.location.search),b=1;if(a&&1<a.length&&(b=window.parseInt(a[1])+1,!isNaN(b)&&b>c.config.getInt("ui.horizon.rp.streaming.timeout.reload.limit",
3))){a=(a=m.exec(window.location.search))&&1<a.length?window.parseInt(a[1]):this.lastLimitedDateMs;if(!isNaN(a)&&0<a&&0<this.lastLimitedMinMS&&Date.now()-a>this.lastLimitedMinMS)return this.lastLimitedDateMs=null,this.mergeFilterStateWithUrl(this.urlFilterState).replace(l,"").replace(m,"");this.handleError({type:"limitreload",message:"Reached max consecutive poll timeouts",attempts:b,last:a,searchExpired:!0,avoidReload:!0});return null}this.lastLimitedDateMs=Date.now();return this.mergeStateWithUrl(""+
this.lastLimitedDateMs,"lastms",this.mergeStateWithUrl(""+b,"attempt"))},startSecondPhaseTimeout:function(){var a=this;c.config.getBoolean("ui.horizon.killSecondPhase",!1)&&(this.stopSecondPhaseTimeout(),this.secondPhaseTimeoutId=window.setTimeout(function(){a.poll.ended||(a.stopSearch(),window.setTimeout(function(){a.endPolling("2ftimeout")},5E3))},this.options.secondPhaseTimeout-5E3))},stopSecondPhaseTimeout:function(){window.clearTimeout(this.secondPhaseTimeoutId);this.secondPhaseTimeoutId=null},
startIdleTimeout:function(a){this.idleTimeoutId=window.setTimeout(function(){e(window).one("mousemove",function(){c.events.publish("results.expired")})},a)},stopIdleTimeout:function(){window.clearTimeout(this.idleTimeoutId);this.idleTimeoutId=null},startClientTimeout:function(a){var b=this;a+=5E3;var c=this.searchId;this.stopClientTimeout();this.clientTimeoutId=window.setTimeout(function(){c===b.searchId&&b.clientTimeout()},a)},stopClientTimeout:function(){window.clearTimeout(this.clientTimeoutId);
this.clientTimeoutId=null},startedStreaming:function(){this.options.enforceIdleTimeout&&this.startIdleTimeout(6E4*this.options.idleExpireMinutes);null===this.clientTimeoutId&&this.startClientTimeout(2*this.options.pollingTimeout);var a=c.storage.get("search_submit_pageId"),b="RP";a&&"results"!==a&&(b="FD",c.storage.remove("search_submit_pageId"));c.Analytics.api.trackEvent({category:"ResultsPage",action:"search_started",label:b})},didReceiveResults:function(){},updateDOM:function(a){try{this.log.time("updateDOM");
for(var b=0;b<a.children.length;b++)if(!c.dom.merge(this.element.find("#"+a.children[b].id).get(0),a.children[b]))return!1;return!0}catch(d){return!1}finally{this.log.timeEnd("updateDOM")}},checkFilteredCountForPreservedFilters:function(a){var b=this;if(this.preserveFilters){var d={};this.options.nonClearablePreservedFilters.forEach(function(a){b.preservedFilters.hasOwnProperty(a)&&(d[a]=b.preservedFilters[a])});this.clearPreservedFilters();if(0===a.filtered||a.filtered<this.options.removeFiltersThreshold&&
a.total>=this.options.removeFiltersThreshold)c.Widgets.Toaster.addToast(this.options.msg.filters_removed,{button:!0,escaped:!1,auto:!0,theme:"centered filters-cleared-toast"}),this.preservedFilters=0<Object.keys(d).length?d:null,this.filterState=0<Object.keys(d).length?d:{},this.refreshResults({resetFilters:!0})}},mergeStateWithUrl:function(a,b,c){if(b){var d=c||window.location.href.split("#")[0],e="string"!==typeof a;c=d.split("?");if(1<c.length){for(var h=c[1].split("\x26"),k=!1,d=0;d<h.length;d++)h[d].startsWith(b)&&
(k=e?null:b+"\x3d"+a,-1<h[d].indexOf(";map")&&(k=(k||"")+";"+h[d].split(";")[1]),h[d]=k,k=!0);k||e||h.push(b+"\x3d"+a);a=h.filter(function(a){return"string"===typeof a&&a.length});b=a.length?"?":"";for(d=0;d<a.length;d++)";map"!==a[d]&&0!==d&&(b+="\x26"),b+=a[d];d=c[0]+b}else e||(d+="?"+b+"\x3d"+a);return d}},mergeFilterStateWithUrl:function(a){return this.mergeStateWithUrl(a,"fs")},mergeSortStateWithUrl:function(a){return this.mergeStateWithUrl(a,"sort")},updateUrlFilterState:function(a){window.history&&
window.history.replaceState&&window.history.replaceState(null,null,this.mergeFilterStateWithUrl(a))},updateUrlSortState:function(a){window.history&&window.history.replaceState&&window.history.replaceState(null,null,this.mergeSortStateWithUrl(a))},toggleLeftRailCollapsed:function(){this.element.find(".col-left-rail").toggleClass("collapsed")},shouldTrackStreamingPerformance:function(){return c.config.getBoolean("ui.horizon.resultspage.streamingPerformance.trackForAllSearches",!0)},getAdsHelper:function(){this.adsHelper||
(this.adsHelper=new c.base.results.AdsHelper);return this.adsHelper},skipLoadingTreatment:function(){return!1},destroy:function(){this.base();c.events.publish("resultspage.JavaScriptComponent.cleanup",this.vertical);e(window).off("scroll.searchAndScrollListener")},setColumnsVisible:function(a,b){var c=this,e=function(){a?(c.listCol.removeClass("hidden"),c.leftRail.removeClass("hidden"),c.rightRail.removeClass("hidden")):(c.listCol.addClass("hidden"),c.leftRail.addClass("hidden"),c.rightRail.addClass("hidden"))};
b?setTimeout(e.bind(c),b):e()},setPreservedFilterState:function(){this.preservedFilters=e.extend({},this.filterState)},bounceResults:function(){var a=this.listCol.get(0),b=this.leftRail.get(0),c=this.rightRail.get(0);a.classList.remove("reload");a.classList.add("reload");b&&b.classList.add("reload");c&&c.classList.add("reload");setTimeout(function(){b&&b.classList.remove("reload");c&&c.classList.remove("reload");a&&a.classList.remove("reload")},2E3)},getPageContainerLeftMargin:function(){var a=this.element.find(".pageContainer").first(),
b=Number(a.css("padding-left").replace("px","")),b=0===b?this.options.defaultPaddingLeft:b;return Number(a.css("margin-left").replace("px",""))+b},toggleSearchFormChanged:function(a){e(window).off("scroll.searchAndScrollListener");if(a&&this.options.visible)e(window).on("scroll.searchAndScrollListener",c.Common.Utils.debounce(this.toggleScrollSearchBanner.bind(this,!0),100));else this.toggleScrollSearchBanner(!1)},scrollSearchBannerThreshold:200,toggleScrollSearchBanner:function(a){c.events.publish("scrollSearchBanner.toggleVisibility",
a&&e(window).scrollTop()>this.scrollSearchBannerThreshold)},setupBackToTopClick:function(){"parentIFrame"in window?window.parentIFrame.scrollTo(0,0):e(window).scrollTop(0).trigger("scroll");c.Analytics.api.trackEvent({subPageId:"ResultsPage",category:"backToTop",action:"click"})},setupBackToTopPosition:function(){"parentIFrame"in window?this.setupBackToTopPositionForCrossDomainIFrames():this.setupBackToTopPositionDefault()},setupBackToTopPositionDefault:function(){var a=this,b=e(window).scrollTop();
e(window).unbind("scroll.backToTop").bind("scroll.backToTop",function(){var c=e(this).scrollTop();c>2*e(this).height()&&b>c?a.backToTop.addClass("visible"):a.backToTop.removeClass("visible");b=c})},setupBackToTopPositionForCrossDomainIFrames:function(){var a=this,b=0,c=!1;setInterval(function(){window.parentIFrame.getPageInfo(function(d){var e=d.scrollTop;a.backToTop.removeClass("visible");e===b&&e>2*d.clientHeight&&c?(a.backToTop.addClass("visible"),a.backToTop.css({position:"absolute",bottom:"auto"}),
a.backToTop.css({top:d.scrollTop-d.offsetTop+d.clientHeight-85+"px"})):(c=b>e,b=e)})},500)}})})(R9,jq||jQuery);(function(b,d){function a(a){this.searchId=a.searchId;this.hotelId=a.hotelId;this.containerElement=a.containerElement;this.minimumDelay=a.minimumDelay||c.minimumDelay;this.spacingDelay=a.spacingDelay||c.spacingDelay;this.toastLength=a.toastLength||c.toastLength;this.url=a.url||c.url;this.messages=[];this.timeoutId=null;if(!this.searchId)throw console.error("Cannot instantiate an UrgencyMessaging object without a valid search ID."),Error("Cannot instantiate an UrgencyMessaging object without a valid search ID.");
}var c={minimumDelay:4E3,spacingDelay:2E3,toastLength:6E3,url:"/s/run/hotelbookmsg"};a.prototype.fetchAndDisplay=function(){var a=this,b=0;this.timeoutId=setTimeout(function(){2===++b&&a.showNextMessage()},a.minimumDelay);var c={searchid:a.searchId};a.hotelId&&(c.hid=a.hotelId,a.containerElement&&(c.inline=!0));d.ajax({type:"POST",dataType:"json",url:a.url,data:c,success:function(c){a.messages=c;2===++b&&a.showNextMessage()},error:function(a,b,c){console.error("UrgencyMessaging.fetchAndDisplay failed: "+
b)}})};a.prototype.showNextMessage=function(){var a=this;if(a.messages&&0<a.messages.length){var c=a.messages.shift();b.Widgets.Toaster.addToast(c.message,{escaped:!0,delay:a.toastLength,icon:c.icon||null,containerElement:a.containerElement});a.timeoutId=setTimeout(function(){a.showNextMessage()},a.spacingDelay)}};a.prototype.cleanUp=function(){clearTimeout(this.timeoutId);b.Widgets.Toaster.removeAllToasts()};b.Hotels=b.Hotels||{};b.Hotels.UrgencyMessaging=a})(R9,jq);
(function(b,d){b.createComponentClass("hotels.results.HotelResultsPage","base.results.ResultsPage",{vertical:"hotels",urgencyMessenger:void 0,resultsBannerId:void 0,loggingPrefix:"hotelresultspage",usedHighlightsArray:null,buzzListCache:{},topHotelsContainer:null,complicated:null,horizontalFiltersWrapper:null,horizontalFiltersWrapperFixed:null,insightsWrapper:null,filtersPinned:!1,dualViewMapPinned:!0,pageView:"list",bestplaceholder:null,nonInstantBookingBannerVisible:!1,mapViewOpened:!1,options:{},
_options:{showUrgencyBubbles:!0,urgencyOnscreenMillis:6E3,location:null,showResultsBanner:!1,pastBookingAjaxEnabled:!1,showHackerStayCallout:!1,useTopBannerContainer:!1,suppressRegionDistance:!1,sortAmbianceCodes:null,dualReactMapEnabled:!1,permanentlyPinnedFilters:!1,horizontalFiltersStickyV2:!1,mapVersionCode:"fullscreen",hotelTagsEnabled:!1,showMap:!1,drawOnMapEnabled:!1,isMomondo:!1,countryCode:"",resultsPlaceholderEnabled:!1,horizontalFiltersScrollOffsetY:157,dualViewFooterScrollOffsetY:636,
dualViewMapOffsetX:764,contentWidth:1340,edgeToEdgeMap:!1,showVerified:!1,premiumHomesEnabled:!1,premiumHomesCtids:[],minNumNightsForPremium:1,citySpecificMinNights:{},minDaysOutPremium:2,covidLoadingModal:!1,manualScrolling:!1},init:function(){this.options=d.extend(this._options,this.options);this.options.ajaxParams={customUpdate:this.updateDOM.bind(this)};this.base();this.searchId&&this.fetchUrgencyMessaging();!this.options.visible&&this.options.useBuzz&&this.fetchBuzzResults();this.usedHighlightsArray=
[];this.topHotelsContainer=d("#bestHotelContainer");this.complicated=d("#complicatedTax");if(this.options.horizontalFiltersStickyV2||"dualview"===this.options.mapVersionCode)this.horizontalFiltersWrapper=this.getChildElement("horizontalFiltersWrapper"),this.horizontalFiltersWrapperFixed=this.getChildElement("horizontalFiltersWrapperFixed");this.options.resultsPlaceholderEnabled&&(this.resultsPlaceholder=this.getChildElement("placeholder"),this.bestplaceholder=this.getChildElement("bestplaceholder"));
this.insightsWrapper=d("#insightsWrapper");this.setupHotelsComparePromo();this.showPlaceholders()},addEventHandlers:function(){var a=this;this.base();!a.options.visible&&a.options.useBuzz&&a.subscribe("hotels.frontdoor.form.location",function(b){!a.options.visible&&b.cityId&&(a.destroyBuzzResults(),a.fetchBuzzResults(b.cityId))});this.subscribe("hotels.showUrgencyBubbles.value",function(b){"boolean"===typeof b&&(a._options.showUrgencyBubbles=b,!b&&a.urgencyMessenger&&a.urgencyMessenger.cleanUp())});
this.subscribe("hotels.rp.fullScreenMap.opened",function(){a.element.addClass("MapOpen");b.events.publish("horizontalFilters.resizeContent")});this.subscribe("hotels.rp.fullScreenMap.closed",function(){a.element.removeClass("MapOpen");b.events.publish("horizontalFilters.resizeContent")});this.subscribe("resultspage.cleanup",function(){a.element.removeClass("MapOpen");b.events.publish("horizontalFilters.resizeContent");a.topHotelsContainer&&a.topHotelsContainer.html("")});this.subscribe(["show.right.rail.map.item"],
function(b){a.showMapResultItem(b)});if(this.options.rentalsXSellTopEnabled||this.options.rentalsXSellBottomEnabled)this.subscribe("resultspage.searchId.changed",function(b){a.fetchRentalsXSell(b.searchId)}),this.subscribe("search.startSearch",function(){a.clearRentalXSell()});this.options.emergencyAlertsEnabled&&(this.subscribe("resultspage.searchId.changed",function(b){a.fetchEmergencyAlerts(b.searchId)}),this.subscribe("search.startSearch",function(){a.clearEmergencyAlerts()}));this.options.nonInstantBookingBannerEnabled&&
this.subscribe("search.startSearch",function(){a.nonInstantBookingBannerVisible=!1;a.clearNonInstantBookingBanner()});this.subscribe("search.startSearch",this.showPlaceholders.bind(this));this.subscribe("search.startSearch",function(){a.insightsWrapper&&a.insightsWrapper.html("")});this.subscribe("resultspage.streaming.done",this.hidePlaceholders.bind(this));this.subscribe("resultspage.streaming.done",this.logIfEmployeeVerified.bind(this));this.subscribe("resultspage.streaming.done",this.positionFiltersList.bind(this));
this.options.premiumHomesEnabled&&this.subscribe("resultspage.streaming.start",this.showPremiumContent.bind(this));this.subscribe("inlineSearchFormUpdated",function(){a.options.pinnedHid=null});b.config.getBoolean("ui.horizon.hotels.useBuzzForInlineSearches",!0)&&this.subscribe("inlineSearchFormUpdated",function(b){a.fetchBuzzResults(b.cityId)});a.options.suppressRegionDistance&&this.subscribe("search.poll.response",function(a){a.regionSearch?(jq("div.Common-Results-Filters-DistanceFilter:not(.Common-Results-Filters-FilterDropdownDialog-Content)").hide(),
b.events.publish("results.distance.sort.hide")):(jq("div.Common-Results-Filters-DistanceFilter:not(.Common-Results-Filters-FilterDropdownDialog-Content)").show(),b.events.publish("results.distance.sort.show"))});"dualview"===this.options.mapVersionCode?(this.subscribe("hotels.results.dualViewMap.toggle",this.toggleDualViewMap.bind(this)),this.setupStickyDualViewMap(),this.options.showMap&&(this.toggleDualViewMap(),setTimeout(function(){b.events.publish("hotels.results.dualViewMap.open")},1E3))):"fullscreendrawer"===
this.options.mapVersionCode&&(this.subscribe("hotels.results.dualViewMap.toggle",this.toggleFullscreenDrawerMap.bind(this)),this.options.showMap&&(this.toggleFullscreenDrawerMap(),setTimeout(function(){b.events.publish("hotels.results.dualViewMap.open")},1E3)));this.subscribe("hotels.taxes.complicated.show",function(){a.complicated.removeClass("hidden");a.complicated.find(".complex").addClass("hidden");var b=a.complicated.find("."+a.options.countryCode);b&&0!==b.length?b.removeClass("hidden"):a.complicated.find(".ALL").removeClass("hidden")});
this.subscribe("hotels.taxes.complicated.hide",function(){a.complicated.addClass("hidden");a.complicated.find(".complex").addClass("hidden")});this.registerEvent("click",this.getChildElement("comparePromoClose"),function(){a.getChildElement("hotelComparePromo").hide()});if(this.options.horizontalFiltersStickyV2||"dualview"===this.options.mapVersionCode)this.setupStickyHorizontalFilters(),b.question.answer("hotels.results.filtersPinned",function(){return a.filtersPinned});this.options.hotelTagsEnabled&&
(this.subscribe("hotels.results.hotelTags.filters.change",this.updateHotelTagsDisplay.bind(this)),this.subscribe("hotels.results.dualViewMap.open",this.updateHotelTagsDisplay.bind(this,{visible:!1})),this.subscribe("hotels.results.dualViewMap.closed",this.updateHotelTagsDisplay.bind(this,{visible:!0})));this.options.drawOnMapEnabled&&this.subscribe("hotels.results.callStartSearch",this.startSearch.bind(this));if(this.options.isMomondo){var a=this,c=this.getChildElement("expandMapTrigger");this.subscribe("hotels.map.fullscreen.close",
function(){a.element.removeClass("map-expanded")});c.click(function(){b.events.publish("hotels.map.fullscreen.open");a.element.addClass("map-expanded")})}this.answer("inlineSearch.height",function(){return a.getChildElement("inlineSearch").is(":visible")?a.getChildElement("inlineSearch").outerHeight():0});this.answer("hotels.resultspage.pageView",function(){return a.pageView});this.answer("hotels.resultspage.pageView.shouldLogFilter",function(b){return null!=b&&b.hasOwnProperty("filterEl")?(b=d(b.filterEl).hasClass("horizontal"))&&
"map"===a.pageView||!b&&"list"===a.pageView:!1});this.options.covidLoadingModal&&this.subscribe("resultspage.streaming.start",function(){setTimeout(function(){b.events.publish("hotels.results.covid.loadingModal.show")},700)});this.answer("hotels.resultspage.isMapViewOpened",function(){return a.mapViewOpened})},logIfEmployeeVerified:function(){this.options.showVerified&&b.Analytics.api.trackEvent({subPageId:"ResultsPage",category:"employeeVerified",action:"shown/"+this.searchId})},inlineComponentsReady:function(){this.base();
var a=b.storage.get("R9ScrollY");a&&(this.options.manualScrolling?b.events.subscribe("resultspage.streaming.done",function(){window.scrollTo(0,a);b.storage.remove("R9ScrollY")}):(window.scrollTo(0,a),b.storage.remove("R9ScrollY")));this.positionFiltersList()},startSearch:function(a){this.base(a);this.showPlaceholders()},showPlaceholders:function(a){this.options.resultsPlaceholderEnabled&&(a||"undefined"===typeof a?(d("#searchResultsList").addClass("hidden"),this.resultsPlaceholder.addClass("visible"),
this.bestplaceholder&&this.bestplaceholder.addClass("visible")):(this.resultsPlaceholder.removeClass("visible"),d("#searchResultsList").removeClass("hidden"),this.bestplaceholder&&this.bestplaceholder.removeClass("visible")))},hidePlaceholders:function(){this.showPlaceholders(!1)},onFilterStateChange:function(a){this.base(a);this.options.scrollTopOnFilterChange&&window.scrollTo(0,0)},checkFilteredCountForPreservedFilters:function(){var a=this;this.preserveFilters&&(this.options.nonClearablePreservedFilters.forEach(function(b){a.preservedFilters.hasOwnProperty(b)}),
this.clearPreservedFilters())},showMapResultItem:function(a){var c=this,d=this.getChildElement("mapitem");d.html('\x3cdiv style\x3d"height:665px;"\x3e\x26nbsp;\x3c/div\x3e');d.css({display:"block",minHeight:"202px"});b.ajax.execute("hotels/results/HotelSideMapResultItem",{appendTo:d,replace:!0,data:{searchId:a.searchId,resultId:a.resultId,isSeo:b.globals.isSeo},afterScript:function(){c.element.find(".map-result-item-close").on("click",function(){d.html("");d.css({display:"none",minHeight:"0"})})}}).then(function(a,
c){202===c.status&&b.events.publish("results.expired")});b.Analytics.api.trackEvent("fullscreenmap/openDetails")},destroyBuzzResults:function(){this.resultsList.find(".buzzResult, .placeholder").remove()},didReceiveResults:function(a){a.completed?(b.events.ready("hotels.results.search.finished",a),this.fetchUrgencyMessaging(),this.checkFilteredCountForPreservedFilters({filtered:a.filteredCount,total:a.totalCount}),this.options.showHackerStayCallout&&a.containsHackerStay&&b.events.publish("hotels.results.hackerStayCallout.show"),
d("#searchResultsList").addClass("finished"),this.buzzPromise&&this.buzzPromise.abort&&this.buzzPromise.abort()):b.events._globals["hotels.results.search.finished"]&&(b.events.unready("hotels.results.search.finished"),d("#searchResultsList").hasClass("finished")&&d("#searchResultsList").removeClass("finished"));if(a.showPriceAlerts){var c={view:"create"};a.existingAlertId&&(c.view="edit");b.events.publish("hotels.priceAlert.setview",c)}a.hasOwnProperty("resultsOrderLogString")&&b.events.publish("clickout.resultsOrder.update",
a.resultsOrderLogString);a.hasOwnProperty("paginatorText")&&b.events.publish("paginator.text.set",a.paginatorText);this.options.countryCode=a.countryCode;a.taxesComplicated?b.events.publish("hotels.taxes.complicated.show"):b.events.publish("hotels.taxes.complicated.hide");a.showAmbianceSort?b.events.publish("hotels.curatedSortSelector.show"):b.events.publish("hotels.curatedSortSelector.hide");a.comparisonModalParams&&b.events.publish("hotels.results.compare.modal.reset",a.comparisonModalParams);this.options.dualReactMapEnabled&&
this.publishReactMapEvents(a)},publishReactMapEvents:function(a){(a.searchStartedThisPoll||a.completed)&&b.events.publish("hotels.results.react.searchUpdated",{searchId:a.searchId,priceMode:a.priceMode,savedHids:a.savedResultIds?a.savedResultIds.map(function(a){return parseInt(a,10)}):null,filtersData:a.completed?a.encodedFilteredBitset:null});if(a.filtersData&&a.filtersData.location){a=a.filtersData.location;var c="adr"===a.lmType;a.lmId||c?b.events.publish("hotels.results.react.pinnedLandmark",
{pinnedLandmark:a}):b.events.publish("hotels.results.react.clearPinnedLandmark")}else b.events.publish("hotels.results.react.clearPinnedLandmark")},cleanupExistingSearch:function(){this.base();this.urgencyMessenger&&(this.urgencyMessenger.cleanUp(),this.urgencyMessenger=void 0)},onResultsListHeaderChange:function(a){this.options.sortAmbianceCodes=a.sort&&"ambiance"===a.sort.sortType?a.sortCode.replace("ambiance_",""):null;this.base(a)},mergeSortStateWithUrl:function(a){var b;b=a&&-1<a.indexOf("ambiance_")&&
this.options.sortAmbianceCodes?this.mergeStateWithUrl(this.options.sortAmbianceCodes,"amb"):this.mergeStateWithUrl(!0,"amb");return this.mergeStateWithUrl(a,"sort",b)},getFetchResultsOpts:function(){var a=this.base();null!==this.options.reviewType&&(a.reviewType=this.options.reviewType);null!==this.options.quickLinkType&&(a.quickLinkType=this.options.quickLinkType);null!==this.options.centerPointLat&&null!==this.options.centerPointLong&&(a.centerPointLat=this.options.centerPointLat,a.centerPointLong=
this.options.centerPointLong);null!==this.options.pinnedHid&&(a.pinnedHid=this.options.pinnedHid);this.options.sortAmbianceCodes&&(a.ambianceCodes=this.options.sortAmbianceCodes);a.collectFilteredHids=this.options.dualReactMapEnabled;return a},handleError:function(a){this.base(a);this.options.useBuzz&&this.destroyBuzzResults()},preprocessResponse:function(a){this.base(a);(this.searchId||"searchId"in a)&&a&&(!1===this.poll.firstPhaseCompleted||a.completed)&&b.events.publish("resultspage.update.location");
a&&"showPriceAlerts"in a&&b.events.publish("hotels.results.priceAlertEnabled",{visible:a.showPriceAlerts,enabled:a.priceAlertsEnabled});this.options.nonInstantBookingBannerEnabled&&a.containsNonInstantBookingProviders&&this.fetchNonInstantBookingBanner();this.options.neighborhoodCardEnabled&&this.populateNeighborhoodCard(a)},populateNeighborhoodCard:function(a){b.events.publish("hotels.results.neighborhood-information",{name:a.sharingData?a.sharingData.cityName:"",imageUrl:a.sharingData?a.sharingData.cityImageUrl:
"",neighborhoods:d.extend({},a.neighborhoods),nhFilter:d.extend({},a.filtersData.neighborhoods),searchId:this.searchId})},fetchUrgencyMessaging:function(){if(void 0===this.urgencyMessenger&&this.options.showUrgencyBubbles&&this.searchId&&this.options.sparkleUrgencyMessage)try{this.urgencyMessenger=this.makeUrgencyMessenger(),this.urgencyMessenger.fetchAndDisplay()}catch(a){}},makeUrgencyMessenger:function(a){var c={searchId:this.searchId,containerElement:document.body,url:"/s/run/hotelbookmsg",toastLength:this.options.urgencyOnscreenMillis};
void 0!==a&&(c.hotelId=a,c.url+="/hid",c.containerElement=document.getElementById(a));return new b.Hotels.UrgencyMessaging(c)},endPolling:function(){this.base.apply(this,arguments);this.fetchResultsBannerPercentage();d("#searchResultsList").addClass("finished")},fetchResultsBannerPercentage:function(){var a=this;this.options.showResultsBanner&&this.searchId&&this.resultsBannerId!==this.searchId&&(this.resultsBannerId=this.searchId,d.ajax({type:"POST",dataType:"json",url:"/s/run/hotelbookmsg/fillrate",
data:{searchid:this.searchId},success:function(b){b&&b.hasOwnProperty("fillRate")&&.3<b.fillRate&&.9>=b.fillRate&&a.fetchResultsBanner(b)},error:function(a,b){console.error("FillRate.fetchAndDisplay failed: "+b)}}))},clearRentalXSell:function(){this.options.rentalsXSellTopEnabled&&this.getChildElement("rentalXSellTop").empty();this.options.rentalsXSellBottomEnabled&&this.getChildElement("rentalXSellBottom").empty()},fetchRentalsXSell:function(a){a&&(this.options.rentalsXSellTopEnabled&&b.ajax.execute("hotels/results/RentalsXSell",
{data:{searchId:this.searchId,aboveResults:!0},appendTo:this.getChildElement("rentalXSellTop"),replace:!0}),this.options.rentalsXSellBottomEnabled&&b.ajax.execute("hotels/results/RentalsXSell",{data:{searchId:this.searchId,aboveResults:!1},appendTo:this.getChildElement("rentalXSellBottom"),replace:!0}))},fetchEmergencyAlerts:function(a){a&&b.ajax.execute("hotels/results/HotelQueryAlerts",{data:{searchId:a},appendTo:this.getChildElement("emergencyAlertsContainer"),replace:!0})},clearEmergencyAlerts:function(){this.getChildElement("emergencyAlertsContainer").empty()},
clearNonInstantBookingBanner:function(){this.options.nonInstantBookingBannerEnabled&&this.getChildElement("nonInstantBookingBanner").empty()},fetchNonInstantBookingBanner:function(){var a=sessionStorage.getItem("nonInstantBannerHidden");this.nonInstantBookingBannerVisible||a||(this.nonInstantBookingBannerVisible=!0,b.Analytics.api.trackEvent({category:"nonInstantBookingBanner",action:"show"}),b.ajax.execute("hotels/results/NonInstantBookingBanner",{appendTo:this.getChildElement("nonInstantBookingBanner"),
replace:!0}))},logPromiseError:function(a){console.error(a)},fetchResultsBanner:function(a){var c;c=a.hasOwnProperty("cityID")?a.cityID:this.getSearchCityId();a.hasOwnProperty("fillRate")&&null!==c&&(a=parseInt(Math.round(100*a.fillRate),10),c={searchId:this.searchId,cityId:c,percentage:a},a=this.options.useTopBannerContainer?"resultBannerContainerTop":"resultBannerContainer",b.ajax.execute("hotels/results/HotelResultsBanner",{data:c,appendTo:this.getChildElement(a),replace:!0}),this.options.flexDatesCardLayout&&
(a=this.options.useTopBannerContainer?"flexDatesContainerTop":"flexDatesContainer",b.ajax.execute("hotels/results/CityFillRateAlternativeDates",{data:c,appendTo:this.getChildElement(a),replace:!0})))},getSearchCityId:function(){return b.question.ask("hotels.rp.searchform.citycode")||b.question.ask("hotels.fd.searchform.citycode")},getSearchNumNights:function(){return b.question.ask("hotels.rp.searchform.numNights")||b.question.ask("hotels.fd.searchform.numNights")},getSearchDaysOut:function(){return b.question.ask("hotels.rp.searchform.daysOut")||
b.question.ask("hotels.fd.searchform.daysOut")},fetchBuzzResults:function(a){var c=this,e=a||b.question.ask("hotels.fd.searchform.citycode")||b.question.ask("hotels.rp.searchform.citycode");a="city"===b.question.ask("hotels.results.searchType");e&&a&&(this.buzzListCache[e]?(d("#searchResultsList").replaceWith(this.buzzListCache[e].clone()),this.removeTransitionClass()):e&&0<e&&(this.buzzPromise=b.ajax.execute("hotels/results/HotelBuzzResultsList",{data:{cityId:e},appendTo:c.resultsList,replace:!0,
afterScript:function(){var a=d("#searchResultsList");a.find(".buzzResult").length&&(c.buzzListCache[e]=a.clone(),c.removeTransitionClass())}}),this.subscribe("searchform.submit",function(){c.buzzPromise.abort()})))},removeTransitionClass:function(){this.hidePlaceholders();this.base()},doCustomUpdate:function(a){return!a.append&&b.config.getBoolean("ui.horizon.hotels.resultspage.mergeDOM",!0)},getHotelIdsOnPage:function(){var a=this.element.find(".Hotels-Results-HotelResultItem");return a.length?a.map(function(){return d(this).data("resultid")}).get():
[]},firstResultsRendered:function(){this.options.useBuzz&&(this.doCustomUpdate({})||this.destroyBuzzResults())},skipLoadingTreatment:function(){return this.options.resultsPlaceholderEnabled||this.options.useBuzz&&0<this.resultsList.find(".Hotels-Results-HotelResultItem").length},toggleDualViewMap:function(){var a=this;this.element.hasClass("dual-view-map")?(this.filtersPinned&&(this.horizontalFiltersWrapper.append(this.horizontalFiltersWrapperFixed.children().detach()),this.horizontalFiltersWrapperFixed.removeClass("fixed"),
this.filtersPinned=!1),this.element.removeClass("dual-view-map"),this.element.addClass("dual-view-map-slide-out"),a.options.edgeToEdgeMap&&this.element.removeClass("edge-to-edge-map"),setTimeout(function(){a.element.removeClass("dual-view-map-slide-in");a.element.removeClass("dual-view-map-slide-out");b.events.publish("hotels.results.dualViewMap.finished-closing-animation")},500),b.events.publish("hotels.results.dualViewMap.closed"),this.pageView="list",this.mapViewOpened=!1):(this.element.addClass("dual-view-map-slide-in"),
setTimeout(function(){a.element.addClass("dual-view-map")},this.options.dualReactMapEnabled?0:500),a.options.edgeToEdgeMap&&this.element.addClass("edge-to-edge-map"),b.events.publish("hotels.results.dualViewMap.open"),this.pageView="map",this.mapViewOpened=!0);this.toggleDualReactMap();b.events.publish("hotels.results.dualViewMap.initMap")},toggleDualReactMap:function(){if(this.options.dualReactMapEnabled){var a="list"===this.pageView;b.Analytics.api.trackEvent({category:"reactMap",action:a?"hide":
"show"});window.scrollTo(0,0);a?(jq(".pageGrid").css("display","flex"),jq(".react-map-view").css("display","none"),jq("footer").css("display","block"),this.backToTop.removeClass("mapView"),this.options.permanentlyPinnedFilters&&(jq(".inlineSearch").css("display","block"),this.horizontalFiltersWrapper.append(this.horizontalFiltersWrapperFixed.children().detach()),this.horizontalFiltersWrapperFixed.removeClass("fixed"),this.filtersPinned=!1)):(this.backToTop.addClass("mapView"),jq(".pageGrid").css("display",
"none"),jq(".react-map-view").css("display","flex"),jq("footer").css("display","none"),b.events.publish("hotels.results.reactmap.recenter"),this.options.permanentlyPinnedFilters&&(jq(".inlineSearch").css("display","none"),this.horizontalFiltersWrapperFixed.append(this.horizontalFiltersWrapper.children().detach()).addClass("fixed"),this.filtersPinned=!0))}},toggleFullscreenDrawerMap:function(){var a=this,c=this.element.hasClass("map-open");this.element.hasClass("map-closed")?(this.element.removeClass("map-closed"),
this.element.addClass("map-open"),this.element.addClass("map-open-animating"),setTimeout(function(){a.element.removeClass("map-open-animating");b.events.publish("hotels.results.dualViewMap.finished-opening-animation")},2E3),b.events.publish("hotels.results.dualViewMap.open")):c&&(this.element.removeClass("map-open"),this.element.addClass("map-closed"),this.element.addClass("map-closed-animating"),setTimeout(function(){a.element.removeClass("map-closed-animating");b.events.publish("hotels.results.dualViewMap.finished-closing-animation")},
2E3),b.events.publish("hotels.results.dualViewMap.closed"));b.events.publish("hotels.results.dualViewMap.initMap")},updateHotelTagsDisplay:function(a){if(a||a.hasOwnProperty("visible")){var b=this.element.hasClass("dual-view-map");this.element.toggleClass("tags-list-enabled",a.visible&&!b)}},setupHotelsComparePromo:function(){var a=this.getChildElement("hotelComparePromo");this.checkShowHotelsCompareBanner()&&(a.show(),this.disableHotelsCompareBanner())},disableHotelsCompareBanner:function(){b.storage.set("disableHotelsCompareBanner",
"true")},checkShowHotelsCompareBanner:function(){return b.storage.get("disableHotelsCompareBanner")?!1:!0},setupStickyHorizontalFilters:function(){window.addEventListener("scroll",this.positionFiltersList.bind(this))},showPremiumContent:function(){var a=this.getSearchCityId(),c=this.getSearchNumNights(),d=this.getSearchDaysOut();this.isPremiumEnabled(a,c,d)&&b.events.publish("hotels.results.showPremiumContent",{premiumCount:0,cityId:a})},isPremiumEnabled:function(a,b,d){var c=this._options.citySpecificMinNights[a];
return a&&0<=this._options.premiumHomesCtids.indexOf(a)&&b&&b>=this.options.minNumNightsForPremium&&("undefined"===typeof c||c<=b)&&d&&d>=this.options.minDaysOutPremium},positionFiltersList:function(){if(!this.options.permanentlyPinnedFilters){var a=this.options.horizontalFiltersScrollOffsetY,c=!1;!this.filtersPinned&&window.pageYOffset>a&&this.element.hasClass("dual-view-map")?(this.horizontalFiltersWrapperFixed.append(this.horizontalFiltersWrapper.children().detach()).addClass("fixed"),c=!this.filtersPinned,
this.filtersPinned=!0):this.filtersPinned&&window.pageYOffset<=a&&(this.horizontalFiltersWrapper.append(this.horizontalFiltersWrapperFixed.children().detach()),this.horizontalFiltersWrapperFixed.removeClass("fixed"),c=this.filtersPinned,this.filtersPinned=!1);c&&b.events.publish("hotels.results.horizontalFilters.pinned",{filtersPinned:this.filtersPinned})}},setupStickyDualViewMap:function(){var a=this;window.addEventListener("scroll",function(){var b=a.element.hasClass("dual-view-map");a.updateDualViewMapYPosition(b);
b&&!a.options.edgeToEdgeMap&&d(window).width()<a.options.contentWidth&&a.getChildElement("rightRail").css("transform","translateX("+(a.options.dualViewMapOffsetX-window.scrollX)+"px)")});d(window).resize(function(){d(window).width()>=a.options.contentWidth&&a.getChildElement("rightRail").css("transform","")});this.subscribe(["hotel.result.click","hotel.inline.detail.loaded","hotel.inline.detail.heightChanged","horizontal.multibook.showOverflow","dialog.close"],function(){setTimeout(function(){a.updateDualViewMapYPosition(a.element.hasClass("dual-view-map"))},
400)});this.subscribe("paginator.update",function(){a.updateDualViewMapYPosition(a.element.hasClass("dual-view-map"))})},updateDualViewMapYPosition:function(a){var b=this.options.dualViewFooterScrollOffsetY;this.dualViewMapPinned&&a&&this.calcScrollYOffset()<=b?(this.getChildElement("rightRail").addClass("dual-view-map-fixed-bottom"),this.dualViewMapPinned=!1):this.dualViewMapPinned||a&&!(this.calcScrollYOffset()>b)||(this.getChildElement("rightRail").removeClass("dual-view-map-fixed-bottom"),this.dualViewMapPinned=
!0)},calcScrollYOffset:function(){return d(document).height()-d(window).height()-d(window).scrollTop()},toggleMapVisibility:function(a){"open"===a?(this.rightRail.classList.add("map-expanded"),this.hotelsResultsHotelResultsPage.classList.add("map-expanded")):(this.rightRail.classList.remove("map-expanded"),this.hotelsResultsHotelResultsPage.classList.remove("map-expanded"))},mergeStateWithUrl:function(a,b,d){return this.base(a,b,d)}})})(R9,jQuery);(function(b,c){b.createComponentClass("hotels.results.brands.hotelscombined.HotelResultsPage","hotels.results.HotelResultsPage",{content:null,openMapButton:null,resetFilters:null,mapWrapper:null,breadcrumb:null,searchForm:null,recentlyViewed:null,coverBonus:null,wasShown:!1,currentPosition:0,otherPropLabel:null,otherPropLabelVisible:!1,options:{updateBreadcrumbs:null,otherPropLabelString:"",otherPropLabelStyle:""},smartyEvent:null,showingMap:!1,inlineComponentsReady:function(){this.base();this.options.updateBreadcrumbs&&
this.updateCrumbs()},init:function(){this.base();this.options.manualScrolling&&"scrollRestoration"in history&&(history.scrollRestoration="manual");this.content=this.getChildElement("content");this.mapWrapper=this.getChildElement("mapWrapper");this.breadcrumb=this.getChildElement("breadcrumb-container");this.openMapButton=this.getChildElement("openMapButton");this.resetFilters=this.getChildElement("resetFilters");this.searchForm=this.getChildElement("searchForm");this.recentlyViewed=this.getChildElement("recentlyViewed");
this.coverBonus=this.getChildElement("coverBonus");this.getChildElement("cover")[0].classList.add("loading");this.swapClasses(this.coverBonus,"hidden","shownBlock");this.otherPropLabel=document.createElement("div");this.otherPropLabel.innerHTML=this.options.otherPropLabelString;this.otherPropLabel.className=this.options.otherPropLabelStyle},addEventHandlers:function(){this.base();var a=this;this.options.updateBreadcrumbs&&(this.smartyEvent=b.events.subscribe("smarty.setitem.complete",this.updateCrumbs.bind(this)));
this.subscribe("searchform.submit",this.onSubmit.bind(this));this.subscribe("simpleHeader.fullScreenMap.open",function(a){b.events.publish("hotels.rp.fullScreenMap.toggle",a)});this.openMapButton.on("click",function(){b.events.publish("hotels.rp.fullScreenMap.toggle",{includeHeader:!0})});this.resetFilters.on("click",function(){b.events.publish("filters.reset",{type:"showAll"});b.events.publish("resultsHeader.sortType.set",{sortCode:"price_a"})});this.subscribe("hotels.rp.fullScreenMap.closed",function(){a.handleMapClose()});
this.subscribe("hotels.rp.fullScreenMap.opened",function(){a.handleMapOpen()});this.subscribe("resultspage.streaming.firstResults",function(){a.showingMap||a.swapClasses(a.openMapButton,"hidden","shown")});this.subscribe(["search.startSearch","resultspage.cleanup"],function(){a.swapClasses(a.openMapButton,"shown","hidden");a.swapClasses(a.coverBonus,"hidden","shownBlock")});b.config.getBoolean("ui.hc.hide.loader.after.first.phase",!0)&&this.subscribe("resultspage.streaming.firstPhase.done",function(){a.swapClasses(a.coverBonus,
"shownBlock","hidden")});this.subscribe("resultspage.streaming.done",function(){a.swapClasses(a.coverBonus,"shownBlock","hidden");c(".more_hotels_tip").css("display","block")});this.subscribe("search.startSearch",function(){a.getChildElement("cover")[0].classList.add("loading");c(".more_hotels_tip").css("display","none")});b.question.forget("results.mapToggle.includeHeaderInMap");this.answer("results.mapToggle.includeHeaderInMap",function(){return!0});b.question.forget("pinnedContent.height");this.answer("pinnedContent.height",
function(){return 200});b.question.forget("header.height");this.answer("header.height",function(){return 90})},preprocessResponse:function(a){this.base(a);this.otherPropLabelVisible&&(this.otherPropLabel.parentNode.removeChild(this.otherPropLabel),this.otherPropLabelVisible=!1);"defaultRadius"in a&&b.events.publish("resultspage.check.radius",{defaultRadius:a.defaultRadius,availabilityRadius:a.availabilityRadius});if("firstDiffRadiusHid"in a)for(var e=this.element.find(".Hotels-Results-HotelResultItem"),
d=0;d<e.length;d++)c(e[d]).data("resultid")===a.firstDiffRadiusHid&&(e[d].parentNode.insertBefore(this.otherPropLabel,e[d]),this.otherPropLabelVisible=!0)},handleMapOpen:function(){c("body").addClass("mapBody full").removeClass("wide");this.currentPosition=document.documentElement.scrollTop;this.swapClasses(this.content,"","inMap");this.swapClasses(this.mapWrapper,"hidden","shownBlock");this.swapClasses(this.breadcrumb,"shown","hidden");this.swapClasses(this.openMapButton,"shown","hidden");this.swapClasses(this.searchForm,
"shownBlock","hidden");this.swapClasses(this.recentlyViewed,"shownBlock","hidden");c(window).scrollTop(0);this.showingMap=!0},handleMapClose:function(){this.swapClasses(this.content,"inMap","");this.swapClasses(this.mapWrapper,"shownBlock","hidden");this.swapClasses(this.openMapButton,"hidden","shown");this.swapClasses(this.breadcrumb,"hidden","shown");this.swapClasses(this.searchForm,"hidden","shownBlock");this.swapClasses(this.recentlyViewed,"hidden","shownBlock");c(window).scrollTop(this.currentPosition);
this.showingMap=!1},onSubmit:function(){this.smartyEvent&&(b.events.unsubscribe("smarty.setitem.complete",this.smartyEvent),this.smartyEvent=null);this.updateCrumbs()},isFormValid:function(a){return b.question.ask("htc.hotels.form."+(a?"rp":"frontdoor")+".isValid")},getSearchUrl:function(a){return b.question.ask("htc.hotels.form."+(a?"rp":"frontdoor")+".serializeAndBuild")},updateCrumbs:function(){var a="RP"===b.question.ask("SearchPage.view");this.isFormValid(a)&&(a=this.getSearchUrl(a),b.ajax.execute("hotels/results/brands/hotelscombined/HotelResultsBreadcrumbs",
{data:{searchUrl:a,updateUrl:!0},appendTo:this.getChildElement("breadcrumb-container"),replace:!0}))}})})(R9,jQuery);(function(a,c){a.createComponentClass("common.kn.BlockerDetector",{wasBlocked:null,options:{selfAdsUrl:null,remoteAdsImgUrl:null},init:function(){var b=this;a.question.answer("adblock.detected",function(){return{adblock:b.wasBlocked}});a.events.when("ajaxComponent.highPriority.initialized",function(){b.options.selfAdsUrl&&c.ajax(b.options.selfAdsUrl,{complete:function(a,c){"error"===c&&b.blocked()}});if(b.options.remoteAdsImgUrl){var a=new Image;a.onerror=function(){b.blocked()};a.style="height:0;width:0;display:block";
a.src=b.options.remoteAdsImgUrl;a.alt="";document.body.appendChild(a)}})},blocked:function(){this.wasBlocked||(this.wasBlocked=1,a.Analytics.api.trackEvent("shields-up/detected"),a.events.publish("adblock.detected"),a.globals.adBlock=1)}})})(R9,jQuery);(function(a){a.createComponentClass("common.layout.SiteWideMessage",$.extend({},a.Common.RedirectMessage.prototype,{redirectMessage:void 0,options:{redirectFromTo:void 0,redirectFromToAlt:void 0,upgradeBrowserEnabled:!1},upgradeId:void 0,init:function(){var a=this;this.upgradeId=this.id("upgrade");this.containerId=this.id();this.redirectFromTo=this.options.redirectFromTo;this.redirectFromToAlt=this.options.redirectFromToAlt;this.updateRedirectUrl();this.bindRedirectAdt();this.answer("languageBar.height",
function(){return a.element.outerHeight(!0)})},addEventHandlers:function(){this.subscribe("frontdoor.view.changed",this.updateRedirectUrl.bind(this));null!==document.getElementById(this.upgradeId)&&a.ajax.execute("common/upgrade/UpgradeBrowser",{appendTo:this.upgradeId});this.registerEvent("click",this.element.find(".js-close"),function(){$(this).closest(".js-msgContainer").slideUp("slow");var a=$(this).attr("data-mc");setMetaCookie(a,!0)})}}))})(R9);function ConsentHandler(c){this.consentExpires=c&&0<=c.consentExpires?c.consentExpires:15552E6;this.declinedExpires=6048E5;this.CONSENT_NAME="DATA_CONSENT"}ConsentHandler.prototype.setConsentToCookie=function(c,d){d="undefined"===typeof d?!0:d;var a=new Date;a.setTime(a.getTime()+this.consentExpires);document.cookie=this.CONSENT_NAME+"\x3d"+d+";path\x3d/;expires\x3d"+a;c&&c({dataConsent:d})};
ConsentHandler.prototype.setDeclinedConsentCookie=function(c){var d=new Date;d.setTime(d.getTime()+this.declinedExpires);document.cookie=this.CONSENT_NAME+"\x3dfalse;path\x3d/;expires\x3d"+d;c&&c({dataConsent:!1})};ConsentHandler.prototype.getConsentFromCookie=function(){if(document.cookie){var c=this.CONSENT_NAME+"\x3dtrue";return document.cookie.split(";").some(function(d){return d&&d.trim&&d.trim()===c})}return!1};
ConsentHandler.prototype.getConsentCookieValue=function(){var c=this;if(document.cookie){var d=document.cookie.split(";").filter(function(a){return a&&a.trim&&0===a.trim().indexOf(c.CONSENT_NAME)});if(d.length)return"true"===d[0].trim().split("\x3d")[1]?!0:!1}return null};
(function(c,d){c.createComponentClass("common.tags.DataLayer",{ENDUSER_CONSENT_NAME:"DATA_ENDUSER_CONSENT",SHARING_CONSENT_NAME:"consent",consented:!1,ready:!1,consentHandler:null,consentEvents:null,gtmSourceSetup:!1,gtm:null,queue:null,options:{useStandardizedConsent:!1,useConsentSetup:!1,consentExpires:0,noConsentDefersLoad:!1},affiliateDataLayerSchema:{common:"presentation placement locale vertical screenId eventName event currency dataConsent dataSharingOptOut kmkid".split(" "),clickOut:["eventName",
"startDate","endDate","price"],expandDetails:["eventName","screenId","price"],flight:{results:"startDate endDate originAirportCode originCityName originCountryCode destinationAirportCode destinationCityName destinationCountryCode cabinClass roundTrip tripType totalTravelers adultTravelers youthTravelers childTravelers seatInfantTravelers lapInfantTravelers legs".split(" "),clickOut:"originAirportCode originCityName originCountryCode destinationAirportCode destinationCityName destinationCountryCode roundTrip tripType totalTravelers seniorTravelers adultTravelers youthTravelers childTravelers seatInfantTravelers lapInfantTravelers airlineName cabinClass legs".split(" ")},
hotel:{results:"rooms guests cityName countryCode hotelName adultTravelers childTravelers startDate endDate".split(" "),details:"hotelName starRating rooms guests cityName countryCode startDate endDate".split(" "),clickOut:"hotelName starRating rooms guests cityName countryCode startDate endDate".split(" ")},car:{results:"pickupTime dropoffTime sameLocation pickupAirportCode pickupCityName pickupCountryCode dropoffAirportCode dropoffCityName dropoffCountryCode".split(" "),clickOut:["carClass"]},packagetour:{results:"originAirportCode originCityName originCountryCode destinationAirportCode destinationCityName destinationCountryCode totalTravelers seniorTravelers adultTravelers youthTravelers childTravelers infantTravelers".split(" "),
clickOut:"originCityId originRegionName originRegionCode destinationCityId destinationRegionName destinationRegionCode hotelId brandName brandId parentBrandId".split(" ")},unknown:{}},init:function(a){c.globals.analytics.gtmDisabled||(this.queue=[],this.options.useStandardizedConsent||(this.options.useConsentSetup?(this.consentHandler=new ConsentHandler({consentExpires:this.options.consentExpires}),this.consented=this.consentHandler.getConsentFromCookie()):this.consented=!0),this.consentEvents=c.config.getString("ui.horizon.cookie.consent.events",
"").split(","),this.gtm=d(a)[0],d(this.gtm).on("load",d.proxy(this.onLoadIFrame,this)))},inlineComponentsReady:function(){c.globals.analytics.gtmDisabled||(!this.getConsent()&&this.options.noConsentDefersLoad||this.loadGtm(),c.question.ask("tags.dataLayer.hasCustomHandler")||this.updateDataLayer(this.getMainLayerParams()))},addEventHandlers:function(){if("undefined"!==typeof window.R9&&c.globals&&c.globals.analytics&&!0!==c.globals.analytics.gtmDisabled){var a=this;this.options.useStandardizedConsent?
this.subscribe(["gdpr.cookie.declined"].concat(this.consentEvents),this.onConsentChange.bind(this)):this.options.useConsentSetup&&(this.subscribe(this.consentEvents,this.consentSuccess.bind(this)),this.subscribe("gdpr.cookie.declined",this.declinedConsent.bind(this)));this.subscribe("sharing.cookie.update",this.sharingConsentUpdate.bind(this));c.events.subscribe("frontdoor.view.changed",function(){if(a.ready)try{var b=a.gtm.contentWindow;b.history&&b.history.replaceState&&b.history.replaceState("",
document.title,location.href);b.document.title=document.title}catch(l){}});this.subscribe("tags.dataLayer.push",function(b){b=b||{};b.attachMainParams&&(b=d.extend(a.getMainLayerParams(),b));b.hasOwnProperty("dataConsent")||(b.dataConsent=a.getConsent());delete b.attachMainParams;b.affiliateGoogleTagManagerId&&""!==b.affiliateGoogleTagManagerId&&(b.dataConsent=a.getEndUserConsentFromCookie(),b=a.getAffiliateDataLayer(b));c.config.getBoolean("ui.gtm.force.datalayer.presentation",!0)&&(b.presentation=
a.options.apPresentation);a.updateDataLayer(b)});this.subscribe("gtm.enduser.consent",function(b){b&&(a.setEndUserConsentCookie(),a.loadGtm())});this.options.useStandardizedConsent||c.question.answer("horizon.cookie.consent.value",function(){return a.consentHandler.getConsentCookieValue()})}},onLoadIFrame:function(){setTimeout(this.processQueue.bind(this),1)},processQueue:function(){this.ready=!0;for(var a=0;a<this.queue.length;a++)this.queue[a]&&this.updateDataLayer(this.queue[a])},cleanUndefinedVars:function(a){d.each(a,
function(b,c){""!==c&&null!==c||delete a[b]})},updateDataLayer:function(a){a&&!a.hasOwnProperty("dataConsent")&&(a.dataConsent=this.getConsent());if(this.ready)try{this.log.console("updating data layer",a);var b=this.gtm.contentWindow;b.unifiedDataLayer||(b.unifiedDataLayer=[]);this.cleanUndefinedVars(a);b.unifiedDataLayer.push(a)}catch(l){}else this.queue.push(a)},onConsentChange:function(){this.updateDataLayer({dataConsent:this.getConsent()});this.loadGtm()},consentSuccess:function(){var a=this;
!this.consented&&this.consentHandler&&this.consentHandler.setConsentToCookie(function(b){a.consented=!0;a.updateDataLayer(b);a.loadGtm()})},declinedConsent:function(){var a=this;this.consentHandler&&this.consentHandler.setDeclinedConsentCookie(function(b){a.consented=!1;a.updateDataLayer(b);a.loadGtm()},!1)},sharingConsentUpdate:function(){this.updateDataLayer({dataSharingOptOut:this.getDataSharingOptOutFromCookieValue()});this.loadGtm()},isIframe:function(){try{return window.self!==window.top}catch(a){return!0}},
getDataSharingOptOutFromCookieValue:function(){if(document.cookie){var a=("; "+document.cookie).split("; "+this.SHARING_CONSENT_NAME+"\x3d");if(2===a.length)return 1===a.pop().split(";").shift()}return!1},getEndUserConsentFromCookie:function(){if(document.cookie){var a=this.ENDUSER_CONSENT_NAME+"\x3dtrue";return document.cookie.split(";").some(function(b){return b&&b.trim&&b.trim()===a})}return!1},setEndUserConsentCookie:function(){var a=new Date,b=0<=this.options.consentExpires?this.options.consentExpires:
15552E6;a.setTime(a.getTime()+b);document.cookie=this.ENDUSER_CONSENT_NAME+"\x3dtrue;path\x3d/;expires\x3d"+a},isEndUserConsent:function(){var a=this.getEndUserConsentFromCookie(),b=window;if(!a){var c=b.setInterval(function(){"parentIFrame"in b&&(b.clearInterval(c),c=null,b.parentIFrame.sendMessage({action:"getGTMEndUserConsent"}))},500);b.setTimeout(function(){c&&b.clearInterval(c)},15E3)}return a},loadGtm:function(){if(!this.gtmSourceSetup){this.gtmSourceSetup=!0;var a=window.location,b="",c="",
d=this.options.affiliateGTMEndUserConsentFeature,e=this.options.affiliateGoogleTagManagerId;if(e&&(b=-1<a.search.indexOf("?")?"\x26":"?",c="gtmid\x3d"+e,d&&this.isIframe()&&!this.isEndUserConsent())){this.gtmSourceSetup=!1;return}a="/ugtm{pathname}{search}{hash}{sign}{gtmid}".replace("{pathname}",a.pathname).replace("{search}",a.search).replace("{hash}",a.hash).replace("{sign}",b).replace("{gtmid}",c);this.gtm.src=a}},cloneDataLayer:function(a,b){var c={};a.forEach(function(a){b.hasOwnProperty(a)&&
(c[a]=b[a])});return c},getAffiliateDataLayer:function(a){var b=c.globals.analytics||{},d=b.screenId||b.pageId||"unknown",f=b.vertical||"unknown",b=a.eventName||"screenView",e=this.affiliateDataLayerSchema,h=e.common||[],k="undefined"!==typeof e[f],d=k?e[f][d]:[],g={};k&&(h=h.concat(d),g=this.cloneDataLayer(h,a),a.hasOwnProperty("presentation")&&(g.presentation=this.options.apPresentation),"clickOut"===b&&(f=e[b].concat(e[f][b]),g=this.cloneDataLayer(f,a)),"expandDetails"===b&&(g=this.cloneDataLayer(e[b],
a)));return g},getMainLayerParams:function(){var a=c.globals.analytics||{},b=d.extend({},this.options,{vertical:a.vertical||"unknown",screenId:a.screenId||a.pageId||"unknown",subScreenId:a.subScreenId||a.subPageId,eventName:this.options.eventName||"screenView",dataConsent:this.getConsent(),placement:c.globals.placement||"",presentation:this.options.apPresentation});["apPresentation","useConsentSetup","consentExpires","noConsentDefersLoad"].forEach(function(a){delete b[a]});return b},getConsent:function(){if(this.options.useStandardizedConsent)try{return window["@r9/gdpr"].hasConsented()}catch(a){return this.log.error("GDPR not available in DataLayer",
a),!1}else if(this.options.useConsentSetup)return this.consentHandler.getConsentFromCookie();return!0}})})(R9,jQuery);(function(a,c){a.createComponentClass("common.privacy.StyleJamHeaderCookiesMessage",{options:{gdprEnabled:!1,ajaxComponent:"common/privacy/AjaxStyleJamHeaderCookiesMessage"},init:function(){var b=this.options.ajaxComponent||"common/privacy/AjaxStyleJamHeaderCookiesMessage",d={type:"GET",replace:!0,combinable:a.config.getBoolean("ui.horizon.common.header.cookieMessage.combinable",!1),cacheable:a.config.getBoolean("ui.horizon.common.header.cookieMessage.cacheable",!1)};if(this.options.gdprEnabled){var e=
window["@r9/gdpr"];e&&e.canShowConsentDialog()&&(b=a.config.getString("ui.horizon.common.gdpr.cookie.consent.dialog.url","common/gdpr/CookieConsentV2"),d={type:"GET",appendTo:c("body")})}this.toggleCookiesMessageLoading(!0);a.ajax.execute(b,d).always(this.toggleCookiesMessageLoading.bind(this,!1))},toggleCookiesMessageLoading:function(b){a.globals.testMode&&(b?c("body").attr("data-test-cookie-message-loading",""):c("body").removeAttr("data-test-cookie-message-loading"))}})})(window.R9,window.jQuery);(function(b,a){b.createComponentClass("common.currency.StyleJamCurrencyMessage",{options:{displayLater:!1,displayImmediately:!1,cookieName:"hideCurrencyMessage"},isVisible:!1,closeBtn:void 0,init:function(b){this.closeBtn=a("#"+this.id("close"));this.options.displayImmediately?this.showMessage():this.options.displayLater&&(this.subscribe("resultspage.view.setvisible",a.proxy(this.showMessage,this)),this.subscribe("header.view.set",{view:"results"},a.proxy(this.showMessage,this)),this.subscribe("pageContainers.changed",
{state:"results"},a.proxy(this.showMessage,this)),this.subscribe("resultspage.routed",a.proxy(this.showMessage,this)))},addEventHandlers:function(){this.closeBtn.bind("click",a.proxy(this.close,this))},showMessage:function(){this.isVisible||(this.element.slideDown("slow"),window.setMetaCookie(this.options.cookieName,!0),this.isVisible=!0)},close:function(){this.element.slideUp("slow")}})})(window.R9,window.jQuery);(function(c,d){c.createComponentClass("common.ccpa.CCPAConsent",{URL:"/i/api/account/dataSharing/v1/optOut",options:{visible:!1,isLoggedIn:!1,manageUrl:"/privacy/manage"},dialog:null,dialogElement:null,action:null,allowDataSharing:!0,init:function(){var a=this,b={preventClosingClickBubble:!0,onClose:this.dialogClose.bind(this),closeOnModalClick:!0,hasKeyboardControl:!1};this.dialogElement=this.getChildElement("ccpa-consent-dialog");this.dialog=this.dialogElement.dialog(b).getWidget();this.action=
this.getChildElement("ccpa-action").checkbox({change:function(){a.updateConsent(this.getValue())}}).getWidget()},addEventHandlers:function(){d(document).on("click","#ccpa-privacy-manage",this.handleLinkClick.bind(this))},handleLinkClick:function(a){a.preventDefault();this.open()},updateConsent:function(a){this.vsLog("optOut",a?"On":"Off");d.ajax({type:"PUT",dataType:"json",url:this.URL,success:function(a){this.updateConsentSuccess(a,!0)}.bind(this),data:JSON.stringify({allowDataSharing:!a}),headers:{"X-CSRF":c.globals.formtoken},
contentType:"application/json"})},getConsentStatus:function(a,b){d.ajax({type:"GET",dataType:"json",url:this.URL,success:a&&a.bind(this),error:b&&b.bind(this),headers:{"X-CSRF":c.globals.formtoken},contentType:"application/json"})},updateConsentSuccess:function(a,b){this.allowDataSharing=a.allowDataSharing;this.action.setChecked(!this.allowDataSharing);b&&(c.events.publish("sharing.cookie.update"),c.events.publish("consent.share.update"),c.events.publish("consent.ccpa.sync",this.allowDataSharing))},
open:function(){this.options.visible?this.getConsentStatus(function(a){this.updateConsentSuccess(a);this.dialog.open();this.vsLog("dialog","show")},function(){this.openPrivacyManage()}):this.openPrivacyManage()},openPrivacyManage:function(){window.open(this.options.manageUrl,"_self")},canShow:function(){return this.options.visible},dialogClose:function(){this.vsLog("dialog","hide")},vsLog:function(a,b){c.Analytics.api.trackEvent({category:"ccpa",action:"consent",label:a,value:b})}})})(R9,jQuery);(function(a,d){a.createComponentClass("common.authentication.PromotedSignup","framework.JavaScriptComponent",{options:{showForcedSignup:!1,isMultiLocaleMandatorySignup:!1},init:function(){},inlineComponentsReady:function(){var c=this.options.isMultiLocaleMandatorySignup;this.options.showForcedSignup&&setTimeout(function(){if(c)a.authentication.showSignup({promo:"multilocale",preventClose:!0,type:"login"});else{var b=window.location.href;-1===b.lastIndexOf("/maps/hotelnew")&&-1===b.lastIndexOf("/reset/")&&
-1===b.lastIndexOf("/mobile")&&setMetaCookie("forced-signup-shown","true",function(){a.config.getBoolean("ui.forcedsignup.enabled",!1)&&a.authentication.showSignup({promo:"promotedsignupv2"})})}},10)}})})(R9,jq||jQuery);(function(a,b){a.createComponentClass("common.utils.admin.Tools",{options:{showExperimentSwitchTool:!1,showFeaturesSwitchTool:!1,showCookieControlTool:!1,showFindTemplateTool:!1,seoIndexDisabled:!1,currentExperiments:null,icon:null},legacyAdminToolsInstance:null,constructor:function(a,d,e){this._id=a;this.options=b.extend({},this.options,b.extend(d||{},e||{}));this.init()},init:function(){this.legacyAdminToolsInstance=a.Admin.AdminTools.getInstance({classNameMainContainer:"Common-Utils-Admin-Tools layer-sticky r9-admin-main"},
!0);this.options.showExperimentSwitchTool&&this.legacyAdminToolsInstance.addTool(new a.Admin.Tools.ExperimentTool({currentExperiments:this.options.currentExperiments}));this.options.showFeaturesSwitchTool&&this.legacyAdminToolsInstance.addTool(new a.Admin.Tools.FeatureTool);this.options.showCookieControlTool&&this.legacyAdminToolsInstance.addTool(new a.Admin.Tools.CookieTool);this.options.showServerTimingTool&&this.legacyAdminToolsInstance.addTool(new a.Admin.Tools.ServerTimingTool);this.options.showFindTemplateTool&&
this.legacyAdminToolsInstance.addTool(new a.Admin.Tools.FindTemplateTool);var c=this.getChildElement("chev").detach();if(c){var d=this;c.click(function(a){a.stopPropagation();a.stopImmediatePropagation();d.legacyAdminToolsInstance.getMenuContainer().toggleClass("collapsed")});this.legacyAdminToolsInstance.getMenuContainer().children().eq(0).prepend(c)}this.options.seoIndexDisabled&&(0<b("link[rel\x3d'canonical'][href$\x3d'/seonox']").length&&b("body").addClass("seonox"),b("a[href$\x3d'/seonox']").addClass("seonox"))}})})(window.R9,
window.jQuery);(function(b,c){b.createComponentClass("common.errors.ErrorDialog",{dialog:null,dialogEl:null,title:null,messages:null,init:function(){this.dialogEl=this.getChildElement("dialog");this.dialog=this.dialogEl.dialog({}).getWidget();this.title=this.getChildElement("title");this.messages=this.getChildElement("messages")},addEventHandlers:function(){var a=this;this.subscribe("error.alert",this.show.bind(this));b.events.when("error.alert",this.show.bind(this));this.subscribe("error.dismiss",this.hide.bind(this));
this.getChildElement("close").on("click keydown",function(c){c.keyCode!==b.globals.keyCodes.TAB&&a.dialog.close()})},show:function(a){var b=this;a.title?(this.title.html(a.title),this.dialogEl.addClass("hasTitle")):(this.title.html(""),this.dialogEl.removeClass("hasTitle"));this.messages.html("");a.messages&&(c.isArray(a.messages)||(a.messages=[a.messages]),c.each(a.messages,function(a,d){a=c("\x3cli\x3e").html(d);b.messages.append(a)}));this.dialog.open()},hide:function(){this.dialog.close()}})})(R9,
jQuery);(function(b,c){b.createComponentClass("common.core.brands.hotelscombined.brandonly.Tracking",{options:{visitorPath:"/Handlers/Visitor",pageViewPath:"/handlers/kayak/pageview"},init:function(){(new Image(1,1)).src=this.options.pageViewPath+"?cb\x3d"+(new Date).getTime()*Math.floor(1E3*Math.random());var a=document.cookie.split("visitor");1<a.length&&-1<a[1].split(";")[0].lastIndexOf("\x26tracked\x3dtrue")||c.ajax({url:this.options.visitorPath,dataType:"text",cache:!1,type:"POST"})},addEventHandlers:function(){}})})(window.R9,
window.jq||window.jQuery);(function(b,c){b.createComponentClass("common.layout.StandardBody",{pageContentEl:null,allowMove:!1,noMoveClasses:{results:!0},stateClasses:{results:"ResultsPageBody"},options:{useReactHeaderV2:!1,isResponsivePage:!1},init:function(){this.options.useReactHeaderV2&&(this.pageContentEl=this.getChildElement("pageContent"),this.allowMove=this.options.isResponsivePage)},addEventHandlers:function(){this.options.useReactHeaderV2&&(this.subscribe(["header.view.set","pageContainers.changed"],function(a){Object.prototype.hasOwnProperty.call(this.noMoveClasses,
a.view)&&(this.allowMove=!this.noMoveClasses[a.view],b.events.publish("page.layout.responsive.changed",{responsive:!1}),this.pageContentEl.removeClass("moved"))}.bind(this)),this.subscribe("resultspage.view.setvisible",function(){this.allowMove=!1;b.events.publish("page.layout.responsive.changed",{responsive:!1});this.pageContentEl.removeClass("moved")}.bind(this)),this.subscribe("navigation.drawer.open",this.handleMovePageContent.bind(this)))},handleMovePageContent:function(a){this.allowMove&&this.pageContentEl.toggleClass("moved",
!!a.open);a.isMobile&&c("body").toggleClass("hideOverflow modal-open",!!a.open)}})})(R9,jQuery);(function(g,d){g.createWidgetClass("tip.StyleJamTooltip",{presentations:{wrapper:"Tooltip__Wrapper Tooltip__Wrapper--fixed Tooltip__Wrapper--hidden",visible:"Tooltip__Wrapper--visible",hidden:"Tooltip__Wrapper--hidden",content:"Tooltip__Content",pointer:"Tooltip__Pointer",above:"Tooltip__Pointer Tooltip__Pointer--down",right:"Tooltip__Pointer Tooltip__Pointer--left",below:"Tooltip__Pointer Tooltip__Pointer--up",left:"Tooltip__Pointer Tooltip__Pointer--right"},$targetElem:null,$triggerElem:null,$tooltipElem:null,
$tooltipPointerElem:null,state:null,options:{targetElem:null,triggerElem:null,triggerEvent:"hover",position:"above",fallbackPosition:void 0,positionOffsetX:50,positionOffsetY:50,showDelay:0,hideDelay:1E3,content:null,preRendered:!1},init:function(){this.base();this.state={afID:null,scrolling:!1,scrollTicker:null,visible:!1,showTimeout:0,hideTimeout:0,widthSet:!1};this.$targetElem=d("#"+this.options.targetElem);this.$triggerElem=null!==this.options.triggerElem?d("#"+this.options.triggerElem):this.$targetElem;
this.$targetElem.length&&this.$triggerElem.length?(this.options.preRendered?(this.$tooltipElem=d("#"+this.id()),this.$tooltipPointerElem=this.getChildElement("pointer")):(this.$tooltipElem=d(this.createTooltipElement()),this.$tooltipPointerElem=this.$tooltipElem.children("#"+this.id("pointer"))),this.options.preRendered&&this.$tooltipElem.appendTo(d("body"))):console.warn("StyleJamTooltip: Couldn't locate target element with id: %s",this.options.targetElem)},addEventHandlers:function(){var a=this;
switch(this.options.triggerEvent){case "click":this.options.hideDelay=0;this.$triggerElem.on("click",function(){a.show()});d(document).on("click",function(b){if(a.state.visible){var c=a.$targetElem[0],e=a.$tooltipElem[0],c=b.target===c||a.isDescendant(c,b.target);b=b.target===e||a.isDescendant(e,b.target);c||b||a.hide()}});break;case "hover":this.$triggerElem.on("mouseenter",function(){a.show()}).on("mouseleave",function(){a.hide()}),this.$tooltipElem.on("mouseenter",function(){a.show()}).on("mouseleave",
function(){a.hide()});case "focus":this.$triggerElem.on("focus",function(){a.show()}).on("blur",function(){a.hide()})}this.setupOnScroll();this.subscribe("common.widgets.tooltip.closeAll",this.hide.bind(this))},createTooltipElement:function(){var a=document.createElement("div");a.setAttribute("id",this.id());a.setAttribute("class",this.getStlBlocks(this.presentations.wrapper));var b=document.createElement("div");b.setAttribute("class",this.getStlBlock(this.presentations.content));b.innerHTML=this.options.content;
var c=document.createElement("div");c.setAttribute("id",this.id("pointer"));c.setAttribute("class",this.getStlBlock(this.presentations.pointer));a.appendChild(b);a.appendChild(c);return a},setupOnScroll:function(){var a=this;this.registerEvent("scroll resize",d(window),function(){clearTimeout(a.state.scrollTicker);!a.state.scrolling&&a.state.visible&&(a.state.scrolling=!0,a.position());a.state.scrollTicker=setTimeout(function(){a.state.scrolling=!1;cancelAnimationFrame(a.state.afID)},150)})},show:function(){var a=
this;this.state.visible=!0;this.options.preRendered||this.$tooltipElem.appendTo(d("body"));this.state.widthSet||(this.$tooltipElem.width(this.$tooltipElem.width()),this.state.widthSet=!0);this.position();this.resetTimers();this.state.showTimeout=setTimeout(function(){a.swapClasses(a.$tooltipElem,a.presentations.hidden,a.presentations.visible)},this.options.showDelay)},hide:function(){var a=this;this.resetTimers();this.state.hideTimeout=setTimeout(function(){a.state.visible=!1;a.swapClasses(a.$tooltipElem,
a.presentations.visible,a.presentations.hidden);a.options.preRendered||a.$tooltipElem.remove()},this.options.hideDelay)},resetTimers:function(){clearTimeout(this.state.showTimeout);clearTimeout(this.state.hideTimeout)},position:function(){var a=this;this.state.scrolling&&(this.state.afID=requestAnimationFrame(function(){a.position()}));var b=this.$targetElem[0].getBoundingClientRect(),c=this.$tooltipElem[0].getBoundingClientRect(),e=this.$tooltipElem[0].currentStyle||window.getComputedStyle(this.$tooltipElem[0]);
c.x=c.left-parseFloat(e.marginLeft);c.width=c.width+parseFloat(e.marginLeft)+parseFloat(e.marginRight);c.height=c.height+parseFloat(e.marginTop)+parseFloat(e.marginBottom);b=this.getRenderPosition(this.options.position,b,c);this.$tooltipElem.css({top:b.y+"px",left:b.x+"px"})},getRenderPosition:function(a,b,c){var e=b.left+this.options.positionOffsetX/100*b.width-c.width/2,d=b.top+this.options.positionOffsetY/100*b.height-c.height/2,f={left:[d,b.left-c.width,this.getInnerHeight()-(d+c.height)],below:[e,
this.getInnerHeight()-(b.top+b.height+c.height),this.getInnerWidth()-(e+c.width)],right:[d,this.getInnerWidth()-(b.left+b.width+c.width),this.getInnerHeight()-(d+c.height)],above:[e,b.top-c.height,this.getInnerWidth()-(e+c.width)]};a=f[a].every(function(a){return 0<=a})?a:Object.keys(f).reduce(function(a,b){return f[a].map(function(a){return 0<a?0:a}).reduce(function(a,b){return a+b})>f[b].map(function(a){return 0<a?0:a}).reduce(function(a,b){return a+b})?a:b});a!==this.options.position&&this.options.fallbackPosition&&
(a=this.options.fallbackPosition);this.$tooltipPointerElem.attr("class","").addClass(this.getStlBlocks(this.presentations[a]));switch(a){case "above":return{x:e,y:b.top-c.height};case "right":return{x:b.left+b.width,y:d};case "below":return{x:e,y:b.top+b.height};case "left":return{x:b.left-c.width,y:d}}},isDescendant:function(a,b){for(b=b.parentNode;null!=b;){if(b==a)return!0;b=b.parentNode}return!1},getInnerWidth:function(){return window.innerWidth||document.documentElement.clientWidth||document.body.clientWidth},
getInnerHeight:function(){return window.innerHeight||document.documentElement.clientHeight||document.body.clientHeight}})})(R9,jQuery);(function(c,d){c.createWidgetClass("tip.RichToolTip",{closeButton:null,subNameSpace:"-richToolTip",initialized:!1,options:{toolTipTarget:"",onHover:!1,lightTheme:!1,showCloseButton:!1,shouldShowImmediately:!0,hoverOpenDelay:200,closeOnBodyClick:!0},init:function(){this.options.showCloseButton&&(this.closeButton=this.getChildElement("closeButton"))},addEventHandlers:function(){var a=this;this.options.showCloseButton&&this.registerEvent("click",this.closeButton,function(){c.events.publish("common.widgets.tooltip.closeSelf",
a.subNameSpace)});this.subscribe("common.widgets.richToolTip.remoteInit",function(){a.initialized||a.remoteInit();a.initialized=!0})},remoteInit:function(){var a=d("#"+this.options.toolTipTarget),b=d("#"+this.options.toolTipTarget+"-rendered-content").children().eq(0);a.length&&b.length&&(a.toolTip({position:"right",orientation:"middle",activation:this.options.onHover?"hover":"click",color:this.options.lightTheme?"white":"black",role:"note",subNameSpace:this.subNameSpace,extraClass:"Common-Widgets-Tip-RichToolTip-tooltip-content",
content:b,showImmediately:this.options.shouldShowImmediately,delay:this.options.hoverOpenDelay,closeOnBodyClick:this.options.closeOnBodyClick,onOpen:this.onOpen}),this.options.shouldShowImmediately&&(a=JSON.stringify("false"),b=moment().add(1,"days").toDate().toUTCString(),document.cookie="day-of-week-new-user\x3d"+a+"; path\x3d/; expires\x3d"+b))},onOpen:function(){var a=d(this.getContent().find("button"));a.length&&this.registerEvent("click",a,function(){c.events.publish("common.widgets.tooltip.closeSelf",
"-richToolTip")})}})})(R9,jQuery);(function(c,e){c.createComponentClass("common.seo.SeoMetaTags",{addEventHandlers:function(){this.checkForAdWordsSearch()},checkForAdWordsSearch:function(){c.globals.isSeo&&this.subscribe("cmp2.rendering.finished",function(a){if(a&&a.items&&a.items.length){if(a=window.location.search.substring(1)){a=a.split("\x26");var b=c.config.getString("ui.cmp2.dynamic.search.ads","");if(b)for(var b=b.split(","),d=0;d<b.length;d++)if(-1<a.indexOf("a\x3d"+b[d])){c.events.publish("cmp2.checkAll");break}}this.destroy()}}.bind(this))}})})(R9,
jQuery);(function(e,d){e.createComponentClass("common.core.FastlyTiming",{options:{runTest:!1,measurementUrl:"/fastly-timer",logUrl:"/s/run/fastlytimerlog"},init:function(){this.options.runTest&&this.runTimingRequest()},runTimingRequest:function(){d.ajax({type:"POST",url:this.options.measurementUrl,success:this.logResult.bind(this)})},logResult:function(c,a,b){b&&c&&c.cluster&&(a=b.getResponseHeader("x-served-by"),b=b.getResponseHeader("x-timer"),a&&b&&(a=a.split(" "),a=a[a.length-1].split("-"),d.ajax({type:"POST",
url:this.options.logUrl,data:{cluster:c.cluster,timer:b,fastlyNode:a[a.length-1]}})))}})})(R9,jQuery);(function(b,e){var f=function(a){if(a){a=a.charAt(0).toUpperCase()+a.slice(1);var b="s"===a.slice(-1)?a.slice(0,-1):a;return"."+a+"-Results-"+b+"ResultsPage"}},g=void 0!==window.history.pushState,h=[b.globals.keyCodes.UP,b.globals.keyCodes.DOWN,b.globals.keyCodes.LEFT,b.globals.keyCodes.RIGHT,b.globals.keyCodes.TAB];b.createComponentClass("base.search.SearchPage",{options:{msg:{resultPageTitle:""},isFD:!0,lazyLoadRP:!1,pageVertical:"",analyticsVertical:"",preloadResourcesForRP:!1,resultsPageComponentsMap:{},
addClassDuringTransition:!0},rpLoaded:!1,rpRequest:null,init:function(a){this.rpContainer=this.getChildElement("rp");this.options.isFD?this.options.lazyLoadRP&&this.preloadComponents():this.rpLoaded=!0;""!==this.options.msg.resultPageTitle&&(document.title=this.options.msg.resultPageTitle)},addEventHandlers:function(a){var c=this;this.subscribe("pageContainer.contentBlur",function(a){c.element.toggleClass("Blur",a)});a=this.handleSearchSubmit.bind(this);a.priority=1;this.subscribe(["searchform.submit",
"multilocale.search.submit"],a);this.subscribe("omni.vertical.changed",function(a){c.cleanupResultsPage();c.abortActiveResultsPageRequest();b.config.getBoolean("ui.horizon.omni.loadRpOnVerticalChange",!0)&&c.options.resultsPageComponentsMap&&c.options.resultsPageComponentsMap.hasOwnProperty(a)&&c.loadResultsPageComponent(a)});b.question.answer("SearchPage.view",function(){return c.options.isFD?"FD":"RP"});b.config.getBoolean("ui.keyboard.show-focus",!0)&&this.bindAccessibilityHandlers();if(b.config.getBoolean("ui.horizon.modal.no-ad-click",
!0)){var d=this.element;this.subscribe(["InputModal.opened","Select.opened","DatePicker.opened","DropdownDialog.open"],function(){d.addClass("modalOpen")});this.subscribe(["InputModal.closed","Select.closed","DatePicker.closed","DropdownDialog.close"],function(){d.removeClass("modalOpen")})}},abortActiveResultsPageRequest:function(){this.rpTimerId&&clearTimeout(this.rpTimerId);this.rpRequest&&(this.rpRequest.abort(),delete this.rpRequest)},handleSearchSubmit:function(a){a.url&&a.url.startsWith("http")&&
(window.location=a.url);this.abortActiveResultsPageRequest();var b=a.url&&a.url.startsWith("/")?a.url:"/"+a.url;this.useSamePageTransition(a)?(window.history.pushState({view:"rp"},"",b),this.options.isFD&&this.switchToRP()):window.location.href=b},useSamePageTransition:function(a){return!a.navigateToResults&&g&&this.rpLoaded&&this.isCorrectRpLoaded(a.vertical)&&!b.authentication.needsRefresh},getAdditionalRPBodyClass:function(){return"wide"},getRPBodyClass:function(){var a=this.getAdditionalRPBodyClass(),
b=(document.body.getAttribute("class")||"").split(" ");-1!==b.indexOf("react")&&(a+=" react");-1!==b.indexOf("react-st")&&(a+=" react-st");return a},switchToRP:function(a){b.Analytics.api.setVertical(this.options.analyticsVertical);b.Analytics.api.setPageId("results");"requestId"in b.globals&&(b.globals.requestId=b.globals.requestId.replace("frontdoor","results").replace("main",b.globals.vertical||this.options.analyticsVertical));var c=this;window.setTimeout(function(){b.events.publish("frontdoor.view.changed",
{view:"inline"});c.element.removeClass("vm-fd");c.element.addClass("vm-rp");b.events.publish("resultspage.view.setvisible",!0);b.events.publish("header.view.set",{view:"results"});b.events.publish("pageContainers.changed",{state:"results"});c.options.addClassDuringTransition?b.events.publish("body.addClass",c.getAdditionalRPBodyClass()):b.events.publish("body.setClass",c.getRPBodyClass());b.events.publish("HorizontalFilterList.setClass");b.events.publish("resultspage.routed",!0);c.rpContainer.removeClass("hiddenFD");
c.options.isFD=!1;c.cleanupFrontDoor()},10)},preloadComponents:function(){var a=this;if(this.options.lazyLoadRP){var c=function(){b.globals.vertical===a.options.pageVertical&&a.loadResultsPageComponent(a.options.pageVertical)};"complete"===document.readyState?c():b.events.when("page.initialized",c)}e(document).ready(function(){a.element.hasClass("vm-fd")&&a.options.preloadResourcesForRP&&b.resources.preload("common.booking","styles")})},loadResultsPageComponent:function(a){var c=this.options.resultsPageComponentsMap[a];
if(c&&c.component){this.abortActiveResultsPageRequest();this.cleanupResultsPage();var d=this;this.rpTimerId=setTimeout(function(){d.rpRequest=b.ajax.execute(c.component,{appendTo:d.rpContainer});d.rpRequest.then(function(){d.rpLoaded=!0;b.globals.vertical=a;d.options.analyticsVertical=c.analyticsVertical;delete d.rpRequest})},100)}},cleanupResultsPage:function(){b.ComponentManager.remove(this.rpContainer,!1);this.rpContainer&&this.rpContainer.empty();this.rpLoaded=!1},cleanupFrontDoor:function(){var a=
this;setTimeout(function(){b.ComponentManager.remove(a.id("fd"))},800)},isCorrectRpLoaded:function(a){return 1===this.getChildElement("rp").find(".Base-Results-ResultsPage").length&&1===this.getChildElement("rp").find(f(a)).length},bindAccessibilityHandlers:function(){this.toggleKeyboardFocus(!1);e(document).on("keydown.ada",function(a){!b.globals.keyboardNav&&-1<h.indexOf(a.keyCode)&&this.toggleKeyboardFocus(!0)}.bind(this));e(document).on("mousemove.ada",this.toggleKeyboardFocus.bind(this,!1))},
toggleKeyboardFocus:function(a){b.globals.keyboardNav=a?!0:!1}})})(R9,jq||jQuery);(function(c,d){c.createComponentClass("hotels.search.HotelSearchPage","base.search.SearchPage",{options:{preloadResourcesForRP:c.config.getBoolean("ui.horizon.searchpage.hotels.preloadStyles",!0),isMomondo:!1,redirectSearchTypesToMap:[],openMapEvent:null},isMapOpen:!1,addEventHandlers:function(){var a=this;this.base();this.subscribe("searchform.submit",function(b){var c=b.url;a.cachedSearchData=b;c&&a.element.find(".Common-Layout-CountryPicker-Content .country-grid .link,.Common-Layout-CountryPicker-Content .country-grid .link .languageLink").each(function(){var a=
d(this),b=a.data("href");a.attr("href",[this.origin,c].join("/")).attr("data-href",b.substring(0,b.indexOf("\x26url\x3d")+5)+"/"+c)})});this.subscribe("hotels.results.dualViewMap.open",function(){a.isMapOpen=!0});this.subscribe("hotels.results.dualViewMap.closed",function(){a.isMapOpen=!1});c.question.answer("hotels.results.dualViewMap.isOpen",function(){return a.isMapOpen});this.subscribe("resultspage.streaming.start",function(b){b?a.cachedSearchData=b:a.cachedSearchData||(a.cachedSearchData={locationType:c.question.ask("hotels.results.searchType")});
a.isLocationSearch(a.cachedSearchData)!==a.isMapOpen&&c.events.publish("hotels.results.dualViewMap.toggle")});a.options.isMomondo&&this.subscribe("resultspage.filtersData.changed",function(b){0===Object.keys(b).length&&b.constructor===Object?a.element.addClass("filters-loading"):(a.element.removeClass("filters-loading"),0===Object.keys(b.neighborhoods.valueMap).length&&b.neighborhoods.valueMap.constructor===Object?a.element.addClass("no-neighborhood-filter"):a.element.removeClass("filters-loading"))});
this.subscribe("hotels.results.dualViewMap.open",function(){a.element.removeClass("map-closed");a.element.parent().removeClass("map-closed");a.element.addClass("map-open");a.element.parent().addClass("map-open")});this.subscribe("hotels.results.dualViewMap.closed",function(){a.element.removeClass("map-open");a.element.addClass("map-closed");a.element.parent().addClass("map-closed");a.element.parent().removeClass("map-open")})},useSamePageTransition:function(a){return a.goToHotelDetailsPage&&a.hotelId?
(a.navigateToResults=!0,a.stopSearch=!0,!1):this.base(a)},isLocationSearch:function(a){if(a&&a.locationType&&this.options.openMapEvent)for(var b=0;b<this.options.redirectSearchTypesToMap.length;b++)if(a.locationType===this.options.redirectSearchTypesToMap[b])return!0;return!1}})})(R9,jQuery);(function(a){a.createComponentClass("hotels.search.brands.hotelscombined.HotelSearchPage","hotels.search.HotelSearchPage",{})})(window.R9);function validateEmail(a){if(!a||!a.match)return!1;a=a.match(/^[A-Z0-9._%+-]{1,63}@(?:[A-Z0-9-]+\.){1,125}[A-Z]{2,63}$/i);return!!(a&&a[0]&&a[0].length)}function replaceArgs(){for(var a=arguments[0],b=1;b<=arguments.length;b++)a=a.replace("{"+(b-1)+"}",arguments[b]);return a}R9.metacookie=R9.metacookie||{};R9.metacookie.saveQueue=R9.metacookie.saveQueue||[];
function saveQueuedMetaCookie(){if(0!=R9.metacookie.saveQueue.length){var a=R9.metacookie.saveQueue[0];jq.ajax({type:"POST",url:"/k/cookie",data:{action:"setmeta",metacookie:a.name,metavalue:a.value,formtoken:R9.globals.formtoken},complete:function(){R9.metacookie.saveQueue.shift();saveQueuedMetaCookie()},success:function(){a.callback()}})}}function setMetaCookie(a,b,c){R9.metacookie.saveQueue.push({name:a,value:b,callback:c||jq.noop});1==R9.metacookie.saveQueue.length&&saveQueuedMetaCookie()}
function deleteMetaCookie(a,b){"function"!==typeof b&&(b=$.noop);jq.ajax({type:"POST",url:"/k/cookie",data:{action:"deletemeta",metacookie:a,formtoken:R9.globals.formtoken},success:b})}jq.ajaxPrefilter("script",function(a){a.cache=!0});(function(c){c.createComponentClass("common.core.RealUserMeasurementsComponent",{options:{fullstoryEnabled:!1},trackedSubmit:!1,addEventHandlers:function(){this.base();this.subscribe("searchform.submit",this.onSearchSubmit.bind(this))},onSearchSubmit:function(a){if(!this.trackedSubmit&&this.options.fullstoryEnabled&&window&&"FS"in window&&a&&a.vertical){this.trackedSubmit=!0;a="did"+this.fixCase(a.vertical)+"Search_bool";var b={};b[a]=!0;FS.setUserVars(b)}},fixCase:function(a){return a.toLowerCase().replace(/(^| )(\w)/g,
function(a){return a.toUpperCase()})}})})(R9);(function(a,c){a.createComponentClass("common.core.MarketingId",{options:{syncUrl:"/s/run/kmkid/sync",setUrl:"/s/run/kmkid/set",suggestedKmkid:null,masterHost:null,runSyncScript:!1},init:function(){this.options.runSyncScript&&this.runSyncAndSet()},runSyncAndSet:function(){c.ajax({type:"POST",url:this.options.masterHost+this.options.syncUrl,data:{suggestedKmkid:this.options.suggestedKmkid},xhrFields:{withCredentials:!0},success:this.onSyncFinished.bind(this)})},onSyncFinished:function(b){b&&(window.R9&&
a.globals&&a.globals.analytics&&a.globals.analytics.pixelContext&&(a.globals.analytics.pixelContext.kmkid=b.kmkid),this.runSet(b.kmkid))},runSet:function(b){c.ajax({type:"POST",headers:{"X-CSRF":a.globals.formtoken},url:this.options.setUrl,data:{kmkid:b}})}})})(R9,jQuery);(function(d,f,e,c){d.createComponentClass("common.core.FullyInvisibleCaptcha",{options:{enabled:!1},init:function(){var a=this;this.options.enabled&&(this.setupCaptchaCallback(),this.initAPI().then(function(){a.fireCaptcha()}))},setupCaptchaCallback:function(){var a=this;c.onReCaptchaSubmit=function(b){a.captchaResult(b)};c.onReCaptchaError=function(a){console.log(a)}},initAPI:function(){var a=f.Deferred();c.recaptchaReady=function(){a.resolve()};var b=e.createElement("script");b.type="text/javascript";
b.async=!0;b.src="https://www.google.com/recaptcha/api.js?onload\x3drecaptchaReady\x26render\x3dexplicit";e.getElementById("recaptcha-root").appendChild(b);return a},fireCaptcha:function(){"undefined"!==typeof grecaptcha&&(grecaptcha.render("captcha",{},!0),grecaptcha.execute())},captchaResult:function(a){d.action.execute("common.core.FullyInvisibleCaptchaAction",{data:a})}})})(R9,jQuery,document,window);(function(e,d){e.createComponentClass("common.core.FastlyTiming",{options:{runTest:!1,measurementUrl:"/fastly-timer",logUrl:"/s/run/fastlytimerlog"},init:function(){this.options.runTest&&this.runTimingRequest()},runTimingRequest:function(){d.ajax({type:"POST",url:this.options.measurementUrl,success:this.logResult.bind(this)})},logResult:function(c,a,b){b&&c&&c.cluster&&(a=b.getResponseHeader("x-served-by"),b=b.getResponseHeader("x-timer"),a&&b&&(a=a.split(" "),a=a[a.length-1].split("-"),d.ajax({type:"POST",
url:this.options.logUrl,data:{cluster:c.cluster,timer:b,fastlyNode:a[a.length-1]}})))}})})(R9,jQuery);(new R9.logger).timeEnd("combined");