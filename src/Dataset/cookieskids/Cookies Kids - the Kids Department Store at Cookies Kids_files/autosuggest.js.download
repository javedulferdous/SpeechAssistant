'use strict';var getParameterByName=function(name,url){if(!url)url=window.location.href;name=name.replace(/[\[\]]/g,"\\$\x26");var regex=new RegExp("[?\x26]"+name+"(\x3d([^\x26#]*)|\x26|#|$)"),results=regex.exec(url);if(!results)return null;if(!results[2])return"";return decodeURIComponent(results[2].replace(/\+/g," "))};var parameter=getParameterByName("u_autosuggest")?getParameterByName("u_autosuggest"):"live";var ubx=document.createElement("link");ubx.rel="stylesheet";
ubx.href="//libraries.unbxdapi.com/"+"prod-cookieskids-com808271562744920"+"/"+parameter+"_autosuggest.css";(document.getElementsByTagName("head")[0]||document.getElementsByTagName("body")[0]).appendChild(ubx);var unbxdAutoSuggestFunction=function($,Handlebars,params){window.Unbxd=window.Unbxd||{};Unbxd.autosuggestVersion="1.0.1";if(!window.location.origin)window.location.origin=window.location.protocol+"//"+window.location.hostname+(window.location.port?":"+window.location.port:"");if(!Array.prototype.forEach)Array.prototype.forEach=function(callback,thisArg){var T,k;if(this==null)throw new TypeError(" this is null or not defined");var O=Object(this);var len=O.length>>>0;if(typeof callback!=="function")throw new TypeError(callback+
" is not a function");if(arguments.length>1)T=thisArg;var k=0;while(k<len){var kValue;if(k in O){kValue=O[k];callback.call(T,kValue,k,O)}k++}};if(!Array.prototype.indexOf)Array.prototype.indexOf=function(searchElement,fromIndex){var k;if(this==null)throw new TypeError('"this" is null or not defined');var O=Object(this);var len=O.length>>>0;if(len===0)return-1;var n=+fromIndex||0;if(Math.abs(n)===Infinity)n=0;if(n>=len)return-1;k=Math.max(n>=0?n:len-Math.abs(n),0);while(k<len){if(k in O&&O[k]===searchElement)return k;
k++}return-1};var topQuery="";var isMobile={Android:function(){return navigator.userAgent.match(/Android/i)},BlackBerry:function(){return navigator.userAgent.match(/BlackBerry/i)},iOS:function(){return navigator.userAgent.match(/iPhone|iPad|iPod/i)},Opera:function(){return navigator.userAgent.match(/Opera Mini/i)},Windows:function(){return navigator.userAgent.match(/IEMobile/i)},any:function(){return isMobile.Android()||isMobile.BlackBerry()||isMobile.iOS()||isMobile.Opera()||isMobile.Windows()}};
Handlebars.registerHelper("unbxdIf",function(v1,v2,options){return v1===v2?options.fn(this):options.inverse(this)});Handlebars.registerHelper("safestring",function(value){return new Handlebars.SafeString(value)});function autocomplete(input,options){this.input=input;this.init(input,options)}function debounce(func,wait,immediate){var timeout;return function(){var context=this,args=arguments;var later=function(){timeout=null;if(!immediate)func.apply(context,args)};var callNow=immediate&&!timeout;clearTimeout(timeout);
timeout=setTimeout(later,wait);if(callNow)func.apply(context,args)}}window.autoSuggestObj=$.extend(autocomplete.prototype,{default_options:{siteName:"demosite-u1407617955968",APIKey:"64a4a2592a648ac8415e13c561e44991",integrations:{},resultsClass:"unbxd-as-wrapper",minChars:3,delay:100,loadingClass:"unbxd-as-loading",mainWidth:0,sideWidth:180,zIndex:1E4,position:"absolute",sideContentOn:"right",template:"1column",theme:"#ff8400",mainTpl:["inFields","keywordSuggestions","topQueries","popularProducts"],
sideTpl:[],showCarts:true,cartType:"inline",onCartClick:function(obj){},hbsHelpers:null,onSimpleEnter:null,onItemSelect:null,noResultTpl:null,inFields:{count:2,fields:{"brand":3,"category":3,"color":3},header:"",tpl:"{{{safestring highlighted}}}"},topQueries:{count:2,hidden:false,header:"",tpl:"{{{safestring highlighted}}}"},keywordSuggestions:{count:2,header:"",tpl:"{{{safestring highlighted}}}"},suggestionsHeader:"",popularProducts:{count:2,price:true,priceFunctionOrKey:"price",name:true,nameFunctionOrKey:"title",
salePrice:false,salePriceKey:"",image:true,imageUrlOrFunction:"imageUrl",currency:"Rs.",header:"",view:"list",tpl:["{{#if ../showCarts}}",'{{#unbxdIf ../../cartType "inline"}}','\x3cdiv class\x3d"unbxd-as-popular-product-inlinecart"\x3e','\x3cdiv class\x3d"unbxd-as-popular-product-image-container"\x3e',"{{#if image}}",'\x3cimg src\x3d"{{image}}"/\x3e',"{{/if}}","\x3c/div\x3e",'\x3cdiv  class\x3d"unbxd-as-popular-product-name popular-title"\x3e','\x3cdiv style\x3d"table-layout:fixed;width:100%;display:table;"\x3e',
'\x3cdiv style\x3d"display:table-row"\x3e','\x3cdiv style\x3d"display:table-cell;text-overflow:ellipsis;overflow: hidden;white-space: nowrap;"\x3e',"{{{safestring highlighted}}}","\x3c/div\x3e","\x3c/div\x3e","\x3c/div\x3e","\x3c/div\x3e","{{#if price}}",'\x3cdiv class\x3d"unbxd-as-popular-product-price"\x3e',"{{#if salePrice}}",'\x3cspan class\x3d"regular-price"\x3e',"{{currency}}{{price}}","\x3c/span\x3e",'\x3cspan class\x3d"unbxd-as-discount"\x3e',"{{currency}}{{salePrice}}","\x3c/span\x3e","{{else}}",
"{{currency}}{{price}}","{{/if}}","\x3c/div\x3e","{{/if}}",'\x3cdiv class\x3d"unbxd-as-popular-product-quantity"\x3e','\x3cdiv class\x3d"unbxd-as-popular-product-quantity-container"\x3e',"\x3cspan\x3eQty\x3c/span\x3e",'\x3cinput class\x3d"unbxd-popular-product-qty-input" value\x3d"1"/\x3e',"\x3c/div\x3e","\x3c/div\x3e",'\x3cdiv class\x3d"unbxd-as-popular-product-cart-action"\x3e','\x3cbutton class\x3d"unbxd-as-popular-product-cart-button"\x3eAdd to cart\x3c/button\x3e',"\x3c/div\x3e","\x3c/div\x3e",
"{{else}}",'\x3cdiv class\x3d"unbxd-as-popular-product-info"\x3e','\x3cdiv class\x3d"unbxd-as-popular-product-image-container"\x3e',"{{#if image}}",'\x3cimg src\x3d"{{image}}"/\x3e',"{{/if}}","\x3c/div\x3e","\x3cdiv\x3e",'\x3cdiv  class\x3d"unbxd-as-popular-product-name popular-title"\x3e',"{{{safestring highlighted}}}","\x3c/div\x3e",'\x3cdiv class\x3d"unbxd-as-popular-product-cart"\x3e','\x3cdiv class\x3d"unbxd-as-popular-product-cart-action"\x3e','\x3cbutton class\x3d"unbxd-as-popular-product-cart-button"\x3eAdd to cart\x3c/button\x3e',
"\x3c/div\x3e",'\x3cdiv class\x3d"unbxd-as-popular-product-quantity"\x3e','\x3cdiv class\x3d"unbxd-as-popular-product-quantity-container"\x3e',"\x3cspan\x3eQty\x3c/span\x3e",'\x3cinput class\x3d"unbxd-popular-product-qty-input" value\x3d"1"/\x3e',"\x3c/div\x3e","\x3c/div\x3e","{{#if price}}",'\x3cdiv class\x3d"unbxd-as-popular-product-price"\x3e',"{{#if salePrice}}",'\x3cspan class\x3d"regular-price"\x3e',"{{currency}}{{price}}","\x3c/span\x3e",'\x3cspan class\x3d"unbxd-as-discount"\x3e',"{{currency}}{{salePrice}}",
"\x3c/span\x3e","{{else}}","{{currency}}{{price}}","{{/if}}","\x3c/div\x3e","{{/if}}","\x3c/div\x3e","\x3c/div\x3e","\x3c/div\x3e","{{/unbxdIf}}","{{else}}",'\x3cdiv class\x3d"unbxd-as-popular-product-info"\x3e','\x3cdiv class\x3d"unbxd-as-popular-product-image-container"\x3e',"{{#if image}}",'\x3cimg src\x3d"{{image}}"/\x3e',"{{/if}}","\x3c/div\x3e",'\x3cdiv  class\x3d"unbxd-as-popular-product-name popular-title"\x3e',"{{{safestring highlighted}}}","\x3c/div\x3e","{{#if price}}",'\x3cdiv class\x3d"unbxd-as-popular-product-price"\x3e',
"{{#if salePrice}}",'\x3cspan class\x3d"regular-price"\x3e',"{{currency}}{{price}}","\x3c/span\x3e",'\x3cspan class\x3d"unbxd-as-discount"\x3e',"{{currency}}{{salePrice}}","\x3c/span\x3e","{{else}}","{{currency}}{{price}}","{{/if}}","\x3c/div\x3e","{{/if}}","\x3c/div\x3e","{{/if}}"].join(""),viewMore:{enabled:false,tpl:"",redirect:function(){}}},filtered:false,platform:"com",resultsContainerSelector:null,processResultsStyles:null},$input:null,$results:null,timeout:null,previous:"",activeRow:-1,activeColumn:0,
keyb:false,compiledPopularProductHeader:"",hasFocus:false,lastKeyPressCode:null,ajaxCall:null,currentResults:[],currentTopResults:[],cache:{},params:{query:"*",filters:{}},selectedClass:"unbxd-ac-selected",scrollbarWidth:null,init:function(input,options){this.options=$.extend({},this.default_options,options);this.setDefaultPopularProductsOptions();this.setDefaultOptions();this.getPopularProductFields();this.$input=$(input).attr("autocomplete","off");this.$results=$("\x3cdiv/\x3e",{"class":this.options.resultsClass+
" "+"unbxd-as-overall-autosuggest"}).css("position",this.options.position==="relative"?"absolute":this.options.position).hide();if(this.options.zIndex>0)this.$results.css("zIndex",this.options.zIndex);if(typeof this.options.resultsContainerSelector=="string"&&this.options.resultsContainerSelector.length)$(this.options.resultsContainerSelector).append(this.$results);else $("body").append(this.$results);if(typeof this.options.hbsHelpers==="function")this.options.hbsHelpers.call(this);this.wire()},wire:function(){var self=
this;this.$input.bind("keydown.auto",this.keyevents());this.$input.bind("select.auto",function(){self.log("select : setting focus");self.hasFocus=true});$(".unbxd-as-wrapper").on("mouseover","ul.unbxd-as-maincontent",function(e){if($.contains(self.$results[0],e.target)&&self.options.filtered){$("."+self.selectedClass).removeClass(self.selectedClass);$(e.target).addClass(self.selectedClass);var $et=$(e.target),p=$et;self.hasFocus=false;if(e.target.tagName!=="LI")p=$et.parents("li");var dataValue=$(p).attr("data-value")?
$(p).attr("data-value"):"";var dataFiltername=$(p).attr("data-filtername")?$(p).attr("data-filtername"):"";var dataFiltervalue=$(p).attr("data-filtervalue")?$(p).attr("data-filtervalue"):"";if(!p||p.hasClass("unbxd-as-header")||p.hasClass("unbxd-as-popular-product")||p.hasClass("topproducts")||e.target.tagName==="INPUT")return;if(dataValue){var query=dataValue+(dataFiltername!=""?":"+dataFiltername+":"+dataFiltervalue:"");if(self.options.filtered&&self.options.popularProducts.header){var cmpldHeader=
Handlebars.compile(self.options.popularProducts.header);self.compiledPopularProductHeader=cmpldHeader({hoverSuggestion:dataValue})}var cmpld="";if(self.options.popularProducts.viewMore&&self.options.popularProducts.viewMore.enabled)cmpld=Handlebars.compile(self.preparefilteredPopularProducts()+self.options.popularProducts.viewMore.tpl);else cmpld=Handlebars.compile(self.preparefilteredPopularProducts());if(self.currentTopResults[query]&&self.currentTopResults[query].length>0)$(".unbxd-as-sidecontent").html(cmpld({data:self.currentTopResults[query],
showCarts:self.options.showCarts,cartType:self.options.cartType}));else $(".unbxd-as-sidecontent").html(cmpld({data:self.currentResults.POPULAR_PRODUCTS,showCarts:self.options.showCarts,cartType:self.options.cartType}))}if(self.options.popularProducts.view==="grid"&&self.options.popularProducts.rowCount)$(".unbxd-as-sidecontent").find("li.unbxd-as-popular-product-grid").css("width",100/self.options.popularProducts.rowCount+"%")}});$(document).bind("click.auto",function(e){if(e.target==self.input){self.log("clicked on input : focused");
self.hasFocus=true;if(self.previous===self.$input.val())self.showResults()}else if(e.target==self.$results[0]){self.log("clicked on results block : selecting");self.hasFocus=false}else if($(e.target).hasClass("unbxd-as-view-more"))self.options.popularProducts.viewMore.redirect(topQuery);else if($.contains(self.$results[0],e.target)){self.log("clicked on element for selection",e.target.tagName);var $et=$(e.target),p=$et;self.hasFocus=false;if(e.target.tagName!=="LI")p=$et.parents("li");if(!p||p.hasClass(".unbxd-as-header")||
e.target.tagName=="INPUT")return;if(e.target.tagName=="BUTTON"&&$et.hasClass("unbxd-as-popular-product-cart-button")&&typeof self.options.onCartClick=="function"){self.log("BUTTON click");var data=p.data();data.quantity=parseFloat(p.find("input.unbxd-popular-product-qty-input").val());self.addToAnalytics("click",{pr:parseInt(data.index)+1,pid:data.pid||null,url:window.location.href});self.options.onCartClick.call(self,data,self.currentResults.POPULAR_PRODUCTS[parseInt(data["index"])]._original)&&
self.hideResults();self.addToAnalytics("addToCart",{pid:data.pid||null,url:window.location.href});return}self.selectItem(p.data(),e)}else{self.hasFocus=false;self.hideResults()}})},keyevents:function(){var self=this;if(params&&params.selfServe)self.onChange();else return function(e){self.lastKeyPressCode=e.keyCode;self.lastKeyEvent=e;switch(e.keyCode){case 38:e.preventDefault();self.moveSelect(-1);break;case 40:e.preventDefault();self.moveSelect(1);break;case 39:if(self.activeRow>-1){e.preventDefault();
self.moveSide(1)}break;case 37:if(self.activeRow>-1){e.preventDefault();self.moveSide(-1)}break;case 9:case 13:if(self.selectCurrent(e))e.preventDefault();else self.hideResultsNow();break;default:self.activeRow=-1;self.hasFocus=true;if(self.timeout)clearTimeout(self.timeout);self.timeout=setTimeout(debounce(function(){self.onChange()},250),self.options.delay);break}}},moveSide:function(step){var newcolumn=this.activeColumn;if(this.options.template=="2column"){if(this.options.sideContentOn=="left"){this.activeColumn==
0&&step==-1&&(newcolumn=1);this.activeColumn==1&&step==1&&(newcolumn=0)}else{this.activeColumn==0&&step==1&&(newcolumn=1);this.activeColumn==1&&step==-1&&(newcolumn=0)}if(newcolumn!=this.activeColumn){this.activeColumn=newcolumn;this.activeRow=-1;this.moveSelect(1)}}},moveSelect:function(step){var lis=this.$results.find("ul."+(this.activeColumn?"unbxd-as-sidecontent":"unbxd-as-maincontent")).find("li:not(.unbxd-as-header)");if(!lis)return;this.activeRow+=step;if(this.activeRow<-1)this.activeRow=lis.size()-
1;else if(this.activeRow==-1)this.$input.focus();else if(this.activeRow>=lis.size()){this.activeRow=-1;this.$input.focus()}$("."+this.selectedClass).removeClass(this.selectedClass);$(lis[this.activeRow]).addClass(this.selectedClass);if(this.activeRow>=0&&this.activeRow<lis.size()){this.$input.val($(lis[this.activeRow]).data("value"));if(this.options.filtered&&this.activeColumn===0){var dataValue=$(lis[this.activeRow]).attr("data-value")?$(lis[this.activeRow]).attr("data-value"):"";var dataFiltername=
$(lis[this.activeRow]).attr("data-filtername")?$(lis[this.activeRow]).attr("data-filtername"):"";var dataFiltervalue=$(lis[this.activeRow]).attr("data-filtervalue")?$(lis[this.activeRow]).attr("data-filtervalue"):"";var query=dataValue+(dataFiltername!=""?":"+dataFiltername+":"+dataFiltervalue:"");if(this.options.filtered&&this.options.popularProducts.header){var cmpldHeader=Handlebars.compile(this.options.popularProducts.header);this.compiledPopularProductHeader=cmpldHeader({hoverSuggestion:dataValue})}var cmpld=
"";if(self.options.popularProducts.viewMore&&self.options.popularProducts.viewMore.enabled)cmpld=Handlebars.compile(self.preparefilteredPopularProducts()+self.options.popularProducts.viewMore.tpl);else cmpld=Handlebars.compile(self.preparefilteredPopularProducts());if(this.currentTopResults[query]&&this.currentTopResults[query].length>0)$(".unbxd-as-sidecontent").html(cmpld({data:this.currentTopResults[query],showCarts:this.options.showCarts,cartType:this.options.cartType}));else $(".unbxd-as-sidecontent").html(cmpld({data:this.currentResults.POPULAR_PRODUCTS,
showCarts:this.options.showCarts,cartType:this.options.cartType}))}}else if(this.activeRow==-1){this.$input.val(this.previous);if(this.options.filtered){var cmpld="";if(self.options.popularProducts.viewMore&&self.options.popularProducts.viewMore.enabled)cmpld=Handlebars.compile(self.preparefilteredPopularProducts()+self.options.popularProducts.viewMore.tpl);else cmpld=Handlebars.compile(self.preparefilteredPopularProducts());if(this.currentTopResults[this.previous]&&this.currentTopResults[this.previous].length>
0)$(".unbxd-as-sidecontent").html(cmpld({data:this.currentTopResults[this.previous],showCarts:this.options.showCarts,cartType:this.options.cartType}));else $(".unbxd-as-sidecontent").html(cmpld({data:this.currentResults.POPULAR_PRODUCTS,showCarts:this.options.showCarts,cartType:this.options.cartType}))}}},selectCurrent:function(e){var li=this.$results.find("li."+this.selectedClass),self=this;if(li.length){this.selectItem(li.data(),e);return true}else{if(typeof this.options.onSimpleEnter=="function"&&
(this.lastKeyPressCode==10||this.lastKeyPressCode==13)){this.lastKeyEvent.preventDefault();self.options.onSimpleEnter.call(self,e)}return false}},selectItem:function(data,e){if(!("value"in data))return;this.log("selected Item : ",data);var v=$.trim(data["value"]),prev=this.previous;this.previous=v;this.input.lastSelected=data;this.$results.html("");this.$input.val(v);this.hideResultsNow(this);this.addToAnalytics("search",{query:data.value,autosuggestParams:{autosuggest_type:data.type,autosuggest_suggestion:data.value,
field_value:data.filtervalue||null,field_name:data.filtername||null,src_field:data.source||null,pid:data.pid||null,unbxdprank:parseInt(data.index,10)+1||0,internal_query:prev}});if(typeof this.options.onItemSelect=="function"&&data.type!=="POPULAR_PRODUCTS_FILTERED")this.options.onItemSelect.call(this,data,this.currentResults[data.type][parseInt(data["index"])]._original,e);else if(data.type==="POPULAR_PRODUCTS_FILTERED")this.options.onItemSelect.call(this,data,this.currentTopResults[data.src][parseInt(data["index"])]._original,
e)},addToAnalytics:function(type,obj){if("Unbxd"in window&&"track"in window.Unbxd&&typeof window.Unbxd.track=="function"){this.log("Pushing data to analytics",type,obj);Unbxd.track(type,obj)}if(type!=="search")return;if("classical"in this.options.integrations)this.trackclassical(type,obj);if("universal"in this.options.integrations)this.trackuniversal(type,obj)},getEventAction:function(autosuggestType){var types={"IN_FIELD":"Scope_Click","POPULAR_PRODUCTS":"Pop_Click","KEYWORD_SUGGESTION":"TQ_Click",
"TOP_SEARCH_QUERIES":"TQ_Click","POPULAR_PRODUCTS_FILTERED":"Filtered_Pop_Click"};return types[autosuggestType]},getEventLabel:function(autosuggest){var params=autosuggest.autosuggestParams;var value=params.autosuggest_suggestion;var index=params.unbxdprank;var filter=params.field_name&&params.field_value?params.field_name+":"+params.field_value:undefined;var types={"IN_FIELD":value+(filter?"\x26filter\x3d"+filter:"")+"-"+index,"POPULAR_PRODUCTS":value+"-"+index,"KEYWORD_SUGGESTION":value+"-"+index,
"TOP_SEARCH_QUERIES":value+"-"+index,"POPULAR_PRODUCTS_FILTERED":value+"-"+index};return types[params.autosuggest_type]},trackclassical:function(type,obj){var key=this.options.integrations["classical"],eventAction=this.getEventAction(obj.autosuggestParams.autosuggest_type),eventLabel=this.getEventLabel(obj),value=1;if(key){if(key===true)key="_gaq";if(window[key])window[key].push(["_trackEvent","U_Autocomplete",eventAction,eventLabel,value,true])}},trackuniversal:function(type,obj){var key=this.options.integrations["universal"],
eventAction=this.getEventAction(obj.autosuggestParams.autosuggest_type),eventLabel=this.getEventLabel(obj),value=1;if(key){if(key===true)key="ga";if(window[key])window[key]("send","event","U_Autocomplete",eventAction,eventLabel,value,{"nonInteraction":1})}},showResults:function(){if(this.options.width)this.options.mainWidth=this.options.width;var pos=this.$input.offset();var totalWidth="";var mwidth="";if(this.options.platform=="io"){totalWidth=this.options.sideContentOn&&this.options.sideContentOn===
"left"?pos.left+this.$input.outerWidth():document.body.clientWidth-pos.left;if(totalWidth>document.body.clientWidth)totalWidth=document.body.clientWidth;if(totalWidth>788&&totalWidth<2E3)totalWidth=this.options.totalWidthPercent?this.options.totalWidthPercent*totalWidth/100:70*totalWidth/100;else if(totalWidth>2E3)totalWidth=45*totalWidth/100;if(this.options.template=="1column")mwidth=this.options.preferInputWidthMainContent?this.$input.outerWidth():60*totalWidth/100;else if(this.options.preferInputWidthMainContent)mwidth=
this.$input.outerWidth();else mwidth=this.options.mainWidthPercent?this.options.mainWidthPercent*totalWidth/100:30*totalWidth/100}var iWidth=this.options.mainWidth>0?this.options.mainWidth:totalWidth?mwidth:this.$input.innerWidth(),bt=parseInt(this.$input.css("border-top-width"),10),bl=parseInt(this.$input.css("border-left-width"),10),br=parseInt(this.$input.css("border-right-width"),10),pb=parseInt(this.$input.css("padding-bottom"),10),fwidth=parseInt(iWidth)-2+bl+br,fpos={top:pos.top+(isNaN(bt)?
0:bt)+this.$input.innerHeight()+"px",left:pos.left+"px"};this.$results.find("ul.unbxd-as-maincontent").css("width",fwidth+"px");this.$results.find("ul.unbxd-as-maincontent").css("box-sizing","border-box");if(this.scrollbarWidth==null)this.setScrollWidth();if(this.options.template=="2column"){var swidth=this.options.sideWidth!==this.default_options.sideWidth?this.options.sideWidth:totalWidth?totalWidth-fwidth:this.options.sideWidth;this.$results.find("ul.unbxd-as-sidecontent").css("width",swidth+"px");
this.$results.find("ul.unbxd-as-sidecontent").css("box-sizing","border-box");this.$results.removeClass("unbxd-as-extra-left unbxd-as-extra-right");this.$results.addClass("unbxd-as-extra-"+this.options.sideContentOn);if(this.$results.find("ul.unbxd-as-sidecontent").length>0&&this.options.sideContentOn=="left"){var lwidth=pos.left+this.$input.outerWidth()>document.body.clientWidth?document.body.clientWidth:pos.left+this.$input.outerWidth();fpos.left=lwidth-fwidth-swidth;if(fpos.left<0)fpos.left=0;fpos.left=
fpos.left+"px"}if(this.options.popularProducts.view==="grid"&&this.options.popularProducts.rowCount)this.$results.find("ul li.unbxd-as-popular-product-grid").css("width",100/this.options.popularProducts.rowCount+"%")}if(this.options.showCarts)this.$results.find(".unbxd-as-popular-product-cart-button").css("background-color",this.options.theme);if(typeof this.options.processResultsStyles=="function")fpos=this.options.processResultsStyles.call(this,fpos);this.$results.css(fpos).show()},setScrollWidth:function(){var scrollDiv=
document.createElement("div");scrollDiv.setAttribute("style","width: 100px;height: 100px;overflow: scroll;position: absolute;top: -9999px;");document.body.appendChild(scrollDiv);this.scrollbarWidth=scrollDiv.offsetWidth-scrollDiv.clientWidth;document.body.removeChild(scrollDiv)},hideResults:function(){if(this.timeout)clearTimeout(this.timeout);var self=this;this.timeout=setTimeout(function(){self.hideResultsNow()},200)},hideResultsNow:function(){this.log("hideResultsNow");if(this.timeout)clearTimeout(this.timeout);
this.$input.removeClass(this.options.loadingClass);if(this.$results.is(":visible"))this.$results.hide();if(this.ajaxCall)this.ajaxCall.abort()},addFilter:function(field,value){if(!(field in this.params.filters))this.params.filters[field]={};this.params.filters[field][value]=field;return this},removeFilter:function(field,value){if(value in this.params.filters[field])delete this.params.filters[field][value];if(Object.keys(this.params.filters[field]).length==0)delete this.params.filters[field];return this},
clearFilters:function(){this.params.filters={};return this},onChange:function(){if(this.lastKeyPressCode==46||this.lastKeyPressCode>8&&this.lastKeyPressCode<32){if(this.lastKeyPressCode==27&&typeof this.input.lastSelected=="object")this.$input.val(this.input.lastSelected.value);return this.$results.hide()}var v="";if(params&&params.selfServe)v="*";else v=this.$input.val();if(v==this.previous)return;this.params.q=v;this.previous=v;this.currentResults={};if(this.inCache(v)){this.log("picked from cache : "+
v);if(this.options.filtered&&this.options.popularProducts.header){var cmpldHeader=Handlebars.compile(this.options.popularProducts.header);this.compiledPopularProductHeader=cmpldHeader({hoverSuggestion:v})}this.currentResults=this.getFromCache(v);this.$results.html(this.prepareHTML());this.showResults()}else{if(this.ajaxCall)this.ajaxCall.abort();if(v.length>=this.options.minChars){this.$input.addClass(this.options.loadingClass);this.requestData(v)}else{this.$input.removeClass(this.options.loadingClass);
this.$results.hide()}}},getClass:function(object){return Object.prototype.toString.call(object).match(/^\[object\s(.*)\]$/)[1]},requestData:function(q){var self=this,url=self.autosuggestUrl();this.log("requestData",url);var params=this.getAjaxParams();params.url=url;this.ajaxCall=$.ajax(params).done(function(d){self.receiveData(d)}).fail(function(f){self.$input.removeClass(self.options.loadingClass);self.$results.hide()})},getHostDomainName:function(){if(this.options.platform==="com")return"//search.unbxdapi.com/";
else return"//search.unbxd.io/"},getAjaxParams:function(){var params={};if(this.options.platform==="io")params={dataType:"json",method:"get"};else params={dataType:"jsonp",jsonp:"json.wrf"};return params},autosuggestUrl:function(){var host_path=this.getHostNPath();var url="q\x3d"+encodeURIComponent(this.params.q);if(this.options.maxSuggestions)url+="\x26inFields.count\x3d"+this.options.maxSuggestions+"\x26topQueries.count\x3d"+this.options.maxSuggestions+"\x26keywordSuggestions.count\x3d"+this.options.maxSuggestions+
"\x26popularProducts.count\x3d"+this.options.popularProducts.count+"\x26indent\x3doff";else url+="\x26inFields.count\x3d"+this.options.inFields.count+"\x26topQueries.count\x3d"+this.options.topQueries.count+"\x26keywordSuggestions.count\x3d"+this.options.keywordSuggestions.count+"\x26popularProducts.count\x3d"+this.options.popularProducts.count+"\x26indent\x3doff";if(this.options.popularProducts.fields.length>0){var popularProductFields=this.options.popularProducts.fields.join(",");url=url+"\x26popularProducts.fields\x3d"+
popularProductFields}for(var x in this.params.filters)if(this.params.filters.hasOwnProperty(x)){var a=[];for(var y in this.params.filters[x])if(this.params.filters[x].hasOwnProperty(y))a.push((x+':"'+encodeURIComponent(y.replace(/(^")|("$)/g,""))+'"').replace(/"{2,}/g,'"'));url+="\x26filter\x3d"+a.join(" OR ")}return host_path+"?"+url},getHostNPath:function(){return this.getHostDomainName()+this.options.APIKey+"/"+this.options.siteName+"/autosuggest"},receiveData:function(data){if(data){this.$input.removeClass(this.options.loadingClass);
this.$results.html("");if(!this.hasFocus&&(params?!params.selfServe:true)||data.response.numberOfProducts==0||"error"in data)if(!this.options.noResultTpl)return this.hideResultsNow(this);this.processData(data);this.addToCache(this.params.q,this.currentResults);this.$results.html(this.prepareHTML());this.showResults()}else this.hideResultsNow(this)},max_suggest:function(data){var infield_result=0,topquery_result=0,keyword_result=0;var infield_sugg=Math.floor(this.options.maxSuggestions*.2);var keyword_sugg=
Math.floor(this.options.maxSuggestions*.4);var topquery_sugg=Math.ceil(this.options.maxSuggestions*.4);var keyword_rem=0,topquery_rem=0;for(var x=0;x<data.response.products.length;x++)if(data.response.products[x].doctype=="IN_FIELD")infield_result++;else if(data.response.products[x].doctype=="KEYWORD_SUGGESTION")keyword_result++;else if(data.response.products[x].doctype=="TOP_SEARCH_QUERIES")topquery_result++;if(infield_result<infield_sugg){var infield_rem=infield_sugg-infield_result;while(infield_rem>
0)if(keyword_result>keyword_sugg)if(keyword_result-keyword_sugg>=infield_rem){keyword_sugg=keyword_sugg+infield_rem;infield_rem=0}else{infield_rem=infield_rem-keyword_result+keyword_sugg;keyword_sugg=keyword_result}else if(topquery_result>topquery_sugg)if(topquery_result-topquery_sugg>=infield_rem){topquery_sugg=topquery_sugg+infield_rem;infield_rem=0}else{infield_rem=infield_rem-topquery_result+topquery_sugg;topquery_sugg=topquery_result}else infield_rem=0;infield_sugg=infield_result}if(topquery_result<
topquery_sugg){var topquery_rem=topquery_sugg-topquery_result;while(topquery_rem>0&&keyword_result>keyword_sugg)if(keyword_result>keyword_sugg)if(keyword_result-keyword_sugg>=topquery_rem){keyword_sugg=keyword_sugg+topquery_rem;topquery_rem=0}else{topquery_rem=topquery_rem-keyword_result+keyword_sugg;keyword_sugg=keyword_result}topquery_sugg=topquery_result}if(keyword_result<keyword_sugg){keyword_rem=keyword_sugg-keyword_result;while(keyword_rem>0&&topquery_result>topquery_sugg)if(topquery_result>
topquery_sugg)if(topquery_result-topquery_sugg>=keyword_rem){topquery_sugg=topquery_sugg+keyword_rem;keyword_rem=0}else{keyword_rem=keyword_rem-topquery_result+topquery_sugg;topquery_sugg=topquery_result}keyword_sugg=keyword_result}var count={};count["infields"]=infield_sugg;count["topquery"]=topquery_sugg;count["keyword"]=keyword_sugg;count["key_rem"]=keyword_rem;count["top_rem"]=topquery_rem;return count},isUnique:function(autosuggest,arr){try{autosuggest=autosuggest.toLowerCase();var unique=true;
for(var k=0;k<arr.length;k++){var suggestion=arr[k];if(Math.abs(suggestion.length-autosuggest.length)<3&&(suggestion.indexOf(autosuggest)!=-1||autosuggest.indexOf(suggestion)!=-1)){unique=false;break}}if(unique)arr.push(autosuggest);return unique}catch(e){return true}},isTempUnique:function(autosuggest,arr){autosuggest=autosuggest.toLowerCase();return arr.indexOf(autosuggest)===-1?arr.push(autosuggest):false},getfilteredPopularProducts:function(){var self=this,urlPath=this.getHostDomainName()+this.options.APIKey+
"/"+this.options.siteName+"/search",defaultSearchParams="indent\x3doff\x26facet\x3doff\x26analytics\x3dfalse\x26redirect\x3dfalse",url=urlPath+"?q\x3d"+encodeURIComponent(this.params.q)+"\x26rows\x3d"+this.options.popularProducts.count+"\x26"+defaultSearchParams;if(self.options.popularProducts.fields.length>0){var popularProductFields="\x26fields\x3d"+self.options.popularProducts.fields.join(",");url=url+popularProductFields}var params=this.getAjaxParams();params.url=url;$.ajax(params).done(function(d){var query=
self.params.q;self.processfilteredPopularProducts(query,d)});for(var i in this.currentResults)if(i!="POPULAR_PRODUCTS"&&this.currentResults.hasOwnProperty(i))for(var j in this.currentResults[i])if(this.currentResults[i].hasOwnProperty(j)){if(this.currentResults[i][j]["filtername"])url=urlPath+"?q\x3d"+encodeURIComponent(this.currentResults[i][j]["autosuggest"])+"\x26filter\x3d"+this.currentResults[i][j]["filtername"]+':"'+encodeURIComponent(this.currentResults[i][j]["filtervalue"])+'"\x26rows\x3d'+
this.options.popularProducts.count+popularProductFields+"\x26"+defaultSearchParams;else url=urlPath+"?q\x3d"+encodeURIComponent(this.currentResults[i][j]["autosuggest"])+"\x26rows\x3d"+this.options.popularProducts.count+popularProductFields+"\x26"+defaultSearchParams;var params=this.getAjaxParams();params.url=url;$.ajax(params).done(function(d){var query=d.searchMetaData.queryParams.q+(d.searchMetaData.queryParams.filter?":"+d.searchMetaData.queryParams.filter.replace(/"/g,""):"");self.processfilteredPopularProducts(query,
d)})}},processfilteredPopularProducts:function(query,d){this.currentTopResults[query]=[];if(d.hasOwnProperty("response")&&d.response.hasOwnProperty("products")&&d.response.products.length)for(var k=0;k<d.response.products.length;k++){var doc=d.response.products[k];var o={_original:doc,type:"POPULAR_PRODUCTS_FILTERED",src:query};if(this.options.popularProducts.name&&this.options.popularProducts.nameFunctionOrKey)o.autosuggest=doc[this.options.popularProducts.nameFunctionOrKey];else if(this.options.popularProducts.autosuggestName&&
doc[this.options.popularProducts.autosuggestName])o.autosuggest=doc[this.options.popularProducts.autosuggestName];else if(this.options.popularProducts.title&&doc[this.options.popularProducts.title])o.autosuggest=doc[this.options.popularProducts.title];else if(doc.title)o.autosuggest=doc.title;else o.autosuggest="";o.highlighted=this.highlightStr(o.autosuggest);if(this.options.popularProducts.price){if(typeof this.options.popularProducts.priceFunctionOrKey==="function")o.price=this.options.popularProducts.priceFunctionOrKey(doc);
else if(typeof this.options.popularProducts.priceFunctionOrKey==="string"&&this.options.popularProducts.priceFunctionOrKey)o.price=this.options.popularProducts.priceFunctionOrKey in doc?doc[this.options.popularProducts.priceFunctionOrKey]:null;else o.price="price"in doc?doc["price"]:null;if(this.options.popularProducts.currency)o.currency=this.options.popularProducts.currency}if(this.options.popularProducts.salePrice&&this.options.popularProducts.salePriceKey)o.salePrice=this.options.popularProducts.salePriceKey in
doc?doc[this.options.popularProducts.salePriceKey]:null;if(this.options.popularProducts.image)if(typeof this.options.popularProducts.imageUrlOrFunction==="function")o.image=this.options.popularProducts.imageUrlOrFunction(doc);else if(typeof this.options.popularProducts.imageUrlOrFunction==="string"&&this.options.popularProducts.imageUrlOrFunction)o.image=this.options.popularProducts.imageUrlOrFunction in doc?doc[this.options.popularProducts.imageUrlOrFunction]:null;this.currentTopResults[query].push(o)}},
processTopSearchQuery:function(doc){var o={autosuggest:doc.autosuggest,highlighted:this.highlightStr(doc.autosuggest),type:"TOP_SEARCH_QUERIES",_original:doc.doctype};this.currentResults.TOP_SEARCH_QUERIES.push(o)},processKeywordSuggestion:function(doc){var o={autosuggest:doc.autosuggest,highlighted:this.highlightStr(doc.autosuggest),type:"KEYWORD_SUGGESTION",_original:doc,source:doc.unbxdAutosuggestSrc||""};this.currentResults.KEYWORD_SUGGESTION.push(o)},setDefaultPopularProductsOptions:function(){if(!this.options.popularProducts.autosuggestName)this.options.popularProducts.autosuggestName=
"title";if(!this.options.popularProducts.title)this.options.popularProducts.title="autosuggest";if(!this.options.popularProducts.fields)this.options.popularProducts.fields=[];if(!this.options.popularProducts.rowCount&&this.options.platform==="io")this.options.popularProducts.rowCount=this.options.popularProducts.count/2},setDefaultOptions:function(){if(!this.options.inFields.type)this.options.inFields.type="separate"},getPopularProductFields:function(){var popularProductsFields=["doctype"];this.options.popularProducts.fields.push(this.options.popularProducts.title);
if(this.options.popularProducts.price&&typeof this.options.popularProducts.priceFunctionOrKey=="string"&&this.options.popularProducts.priceFunctionOrKey)popularProductsFields.push(this.options.popularProducts.priceFunctionOrKey);if(this.options.popularProducts.image)if(typeof this.options.popularProducts.imageUrlOrFunction=="string"&&this.options.popularProducts.imageUrlOrFunction)popularProductsFields.push(this.options.popularProducts.imageUrlOrFunction);if(this.options.popularProducts.fields.length>
0)this.options.popularProducts.fields=popularProductsFields.concat(this.options.popularProducts.fields);else this.options.popularProducts.fields=popularProductsFields;this.compiledPopularProductHeader=this.options.popularProducts.header},processPopularProducts:function(doc){var o={type:doc.doctype,pid:doc.uniqueId.replace("popularProduct_",""),_original:doc};if(this.options.popularProducts.name)o.autosuggest=doc[this.options.nameFunctionOrKey]?doc[this.options.nameFunctionOrKey]:doc[this.options.popularProducts.title]?
doc[this.options.popularProducts.title]:"";else o.autosuggest="";o.highlighted=this.highlightStr(o.autosuggest);if(this.options.popularProducts.price)if(typeof this.options.popularProducts.priceFunctionOrKey=="function")o.price=this.options.popularProducts.priceFunctionOrKey(doc);else if(typeof this.options.popularProducts.priceFunctionOrKey=="string"&&this.options.popularProducts.priceFunctionOrKey)o.price=this.options.popularProducts.priceFunctionOrKey in doc?doc[this.options.popularProducts.priceFunctionOrKey]:
null;else o.price="price"in doc?doc["price"]:null;if(this.options.popularProducts.salePrice&&this.options.popularProducts.salePriceKey)o.salePrice=this.options.popularProducts.salePriceKey in doc?doc[this.options.popularProducts.salePriceKey]:null;if(this.options.popularProducts.currency)o.currency=this.options.popularProducts.currency;if(this.options.popularProducts.image)if(typeof this.options.popularProducts.imageUrlOrFunction=="function")o.image=this.options.popularProducts.imageUrlOrFunction(doc);
else if(typeof this.options.popularProducts.imageUrlOrFunction=="string"&&this.options.popularProducts.imageUrlOrFunction)o.image=this.options.popularProducts.imageUrlOrFunction in doc?doc[this.options.popularProducts.imageUrlOrFunction]:null;if(this.options.filtered&&this.options.popularProducts.header){var cmpldHeader=Handlebars.compile(this.options.popularProducts.header);this.compiledPopularProductHeader=cmpldHeader({hoverSuggestion:this.params.q})}this.currentResults.POPULAR_PRODUCTS.push(o)},
processInFields:function(doc){var ins={},asrc=" "+doc.unbxdAutosuggestSrc+" ",highlightedtext=this.highlightStr(doc.autosuggest);for(var a in this.options.inFields.fields)if(a+"_in"in doc&&doc[a+"_in"].length&&asrc.indexOf(" "+a+" ")==-1)ins[a]=doc[a+"_in"].slice(0,parseInt(this.options.inFields.fields[a]));if(!$.isEmptyObject(ins)){this.currentResults.IN_FIELD.push({autosuggest:doc.autosuggest,highlighted:highlightedtext,type:"keyword",source:doc.unbxdAutosuggestSrc});var that=this;for(var a in ins)for(var b=
0;b<ins[a].length;b++)if(ins[a][b]!=="")this.currentResults.IN_FIELD.push({autosuggest:doc.autosuggest,highlighted:this.options.inFields.type==="separate"?that.prepareinFieldsKeyword(ins[a][b]):that.highlightStr(doc.autosuggest)+" in "+that.prepareinFieldsKeyword(ins[a][b]),type:doc.doctype,filtername:a,filtervalue:ins[a][b],_original:doc,source:doc.unbxdAutosuggestSrc})}else this.currentResults.KEYWORD_SUGGESTION.push({autosuggest:doc.autosuggest,highlighted:highlightedtext,type:"KEYWORD_SUGGESTION",
source:doc.unbxdAutosuggestSrc})},processData:function(data){var count;if(this.options.maxSuggestions)count=this.max_suggest(data);this.currentResults={KEYWORD_SUGGESTION:[],TOP_SEARCH_QUERIES:[],POPULAR_PRODUCTS:[],IN_FIELD:[]};var infieldsCount=0;var key_count=0,uniqueInfields=[],uniqueSuggestions=[];for(var x=0;x<data.response.products.length;x++){var doc=data.response.products[x],o={};if(this.options.maxSuggestions)if("TOP_SEARCH_QUERIES"==doc.doctype&&count["topquery"]>this.currentResults.TOP_SEARCH_QUERIES.length&&
this.isUnique(doc.autosuggest,uniqueSuggestions))this.processTopSearchQuery(doc);else if("IN_FIELD"==doc.doctype&&count["infields"]+count["key_rem"]+count["top_rem"]>infieldsCount&&this.isUnique(doc.autosuggest,uniqueInfields))if(count["infields"]>infieldsCount){infieldsCount++;this.processInFields(doc)}else{if(count["key_rem"]+count["top_rem"]>this.currentResults.KEYWORD_SUGGESTION.length&&this.isUnique(doc.autosuggest,uniqueSuggestions))this.processKeywordSuggestion(doc)}else if("KEYWORD_SUGGESTION"==
doc.doctype&&count["keyword"]>this.currentResults.KEYWORD_SUGGESTION.length&&this.isUnique(doc.autosuggest,uniqueInfields))this.processKeywordSuggestion(doc);else{if("POPULAR_PRODUCTS"==doc.doctype&&this.options.popularProducts.count>this.currentResults.POPULAR_PRODUCTS.length)this.processPopularProducts(doc)}else if("TOP_SEARCH_QUERIES"==doc.doctype&&this.options.topQueries.count>this.currentResults.TOP_SEARCH_QUERIES.length&&this.isUnique(doc.autosuggest,uniqueSuggestions))this.processTopSearchQuery(doc);
else if("IN_FIELD"==doc.doctype&&this.options.inFields.count>infieldsCount&&this.isTempUnique(doc.autosuggest,uniqueInfields))this.processInFields(doc);else if("KEYWORD_SUGGESTION"==doc.doctype&&this.options.keywordSuggestions.count>this.currentResults.KEYWORD_SUGGESTION.length&&this.isUnique(doc.autosuggest,uniqueSuggestions))this.processKeywordSuggestion(doc);else if("POPULAR_PRODUCTS"==doc.doctype&&this.options.popularProducts.count>this.currentResults.POPULAR_PRODUCTS.length)this.processPopularProducts(doc)}if(this.options.filtered)this.getfilteredPopularProducts();
var outLength=this.currentResults.POPULAR_PRODUCTS.length+this.currentResults.IN_FIELD.length;if(this.options.sortSuggestionsOnLength)for(var doc_type in this.currentResults)if(doc_type.toLowerCase()!="in_field")this.currentResults[doc_type].sort(function(x,y){return x.autosuggest.length>y.autosuggest.length?1:-1})},escapeStr:function(str){return str.replace(/([\\{}()|.?*+\-\^$\[\]])/g,"\\$1")},highlightStr:function(str){var output=str,q=$.trim(this.params.q+"");if(q.indexOf(" ")){var arr=q.split(" ");
for(var k in arr){if(!arr.hasOwnProperty(k))continue;var l=output.toLowerCase().lastIndexOf("\x3c/strong\x3e");if(l!=-1)l+=9;output=output.substring(0,l)+output.substring(l).replace(new RegExp(this.escapeStr(arr[k]),"gi"),function($1){return"\x3cstrong\x3e"+$1+"\x3c/strong\x3e"})}}else{var st=output.toLowerCase().indexOf(q);output=st>=0?output.substring(0,st)+"\x3cstrong\x3e"+output.substring(st,st+q.length)+"\x3c/strong\x3e"+output.substring(st+q.length):output}return output},prepareinFieldsKeyword:function(str){return'\x3cspan class\x3d"unbxd-as-suggestions-infields"\x3e'+
str+"\x3c/span\x3e"},prepareinFieldsHTML:function(){if(this.options.inFields.type==="inline")return"{{#if data.IN_FIELD}}"+(this.options.inFields.header?'\x3cli class\x3d"unbxd-as-header"\x3e'+this.options.inFields.header+"\x3c/li\x3e":"")+"{{#each data.IN_FIELD}}"+'{{#unbxdIf type "keyword"}}'+"{{else}}"+'\x3cli data-index\x3d"{{@index}}" data-type\x3d"{{type}}" data-value\x3d"{{autosuggest}}" data-filtername\x3d"{{filtername}}" data-filtervalue\x3d"{{filtervalue}}"  data-source\x3d"{{source}}"\x3e'+
(this.options.inFields.tpl?this.options.inFields.tpl:this.default_options.inFields.tpl)+"\x3c/li\x3e"+"{{/unbxdIf}}"+"{{/each}}"+"{{/if}}";else return"{{#if data.IN_FIELD}}"+(this.options.inFields.header?'\x3cli class\x3d"unbxd-as-header"\x3e'+this.options.inFields.header+"\x3c/li\x3e":"")+"{{#each data.IN_FIELD}}"+'{{#unbxdIf type "keyword"}}'+'\x3cli class\x3d"unbxd-as-keysuggestion" data-index\x3d"{{@index}}" data-value\x3d"{{autosuggest}}" data-type\x3d"IN_FIELD" data-source\x3d"{{source}}"\x3e'+
(this.options.inFields.tpl?this.options.inFields.tpl:this.default_options.inFields.tpl)+"\x3c/li\x3e"+"{{else}}"+'\x3cli class\x3d"unbxd-as-insuggestion" style\x3d"color:'+this.options.theme+';" data-index\x3d"{{@index}}" data-type\x3d"{{type}}" data-value\x3d"{{autosuggest}}" data-filtername\x3d"{{filtername}}" data-filtervalue\x3d"{{filtervalue}}"  data-source\x3d"{{source}}"\x3e'+"in "+(this.options.inFields.tpl?this.options.inFields.tpl:this.default_options.inFields.tpl)+"\x3c/li\x3e"+"{{/unbxdIf}}"+
"{{/each}}"+"{{/if}}"},preparekeywordSuggestionsHTML:function(){return"{{#if data.KEYWORD_SUGGESTION}}"+(this.options.keywordSuggestions.header?'\x3cli class\x3d"unbxd-as-header"\x3e'+this.options.keywordSuggestions.header+"\x3c/li\x3e":"")+"{{#each data.KEYWORD_SUGGESTION}}"+'\x3cli class\x3d"unbxd-as-keysuggestion" data-value\x3d"{{autosuggest}}" data-index\x3d"{{@index}}" data-type\x3d"{{type}}"  data-source\x3d"{{source}}"\x3e'+(this.options.keywordSuggestions.tpl?this.options.keywordSuggestions.tpl:
this.default_options.keywordSuggestions.tpl)+"\x3c/li\x3e"+"{{/each}}"+"{{/if}}"},preparetopQueriesHTML:function(){return"{{#if data.TOP_SEARCH_QUERIES}}"+(this.options.topQueries.header?'\x3cli class\x3d"unbxd-as-header"\x3e'+this.options.topQueries.header+"\x3c/li\x3e":"")+"{{#each data.TOP_SEARCH_QUERIES}}"+'\x3cli class\x3d"unbxd-as-keysuggestion" data-type\x3d"{{type}}" data-index\x3d"{{@index}}" data-value\x3d"{{autosuggest}}"\x3e'+(this.options.topQueries.tpl?this.options.topQueries.tpl:this.default_options.topQueries.tpl)+
"\x3c/li\x3e"+"{{/each}}"+"{{/if}}"},preparefilteredPopularProducts:function(){return(this.compiledPopularProductHeader?'\x3cli class\x3d"unbxd-as-header unbxd-as-popular-product-header"\x3e'+this.compiledPopularProductHeader+"\x3c/li\x3e":"")+"{{#data}}"+'\x3cli class\x3d"unbxd-as-popular-product '+(this.options.popularProducts.view==="grid"?"unbxd-as-popular-product-grid":"")+'" data-value\x3d"{{autosuggest}}" data-index\x3d"{{@index}}" data-type\x3d"{{type}}" data-pid\x3d"{{pid}}" data-src\x3d"{{src}}"\x3e'+
(this.options.popularProducts.tpl?this.options.popularProducts.tpl:this.default_options.popularProducts.tpl)+"\x3c/li\x3e"+"{{/data}}"},preparepopularProductsHTML:function(){return"{{#if data.POPULAR_PRODUCTS}}"+(this.compiledPopularProductHeader?'\x3cli class\x3d"unbxd-as-header unbxd-as-popular-product-header"\x3e'+this.compiledPopularProductHeader+"\x3c/li\x3e":"")+"{{#data.POPULAR_PRODUCTS}}"+'\x3cli class\x3d"unbxd-as-popular-product '+(this.options.popularProducts.view==="grid"?"unbxd-as-popular-product-grid":
"")+'" data-value\x3d"{{autosuggest}}" data-index\x3d"{{@index}}" data-type\x3d"{{type}}" data-pid\x3d"{{pid}}" \x3e'+(this.options.popularProducts.tpl?this.options.popularProducts.tpl:this.default_options.popularProducts.tpl)+"\x3c/li\x3e"+"{{/data.POPULAR_PRODUCTS}}"+"{{/if}}"},standardizeKeys:function(key){if(key==="inFields")key="IN_FIELD";else if(key==="popularProducts")key="POPULAR_PRODUCTS";else if(key==="topQueries")key="TOP_SEARCH_QUERIES";else key="KEYWORD_SUGGESTION";return key},prepareHTML:function(){var html=
'\x3cul class\x3d"unbxd-as-maincontent unbxd-as-suggestions-overall"\x3e',self=this,mainlen=0,sidelen=0;if(this.options.suggestionsHeader&&(self.currentResults["IN_FIELD"].length||self.currentResults["KEYWORD_SUGGESTION"].length||self.currentResults["TOP_SEARCH_QUERIES"].length))html=html+'\x3cli class\x3d"unbxd-as-header unbxd-as-suggestions-header"\x3e'+this.options.suggestionsHeader+"\x3c/li\x3e";if(!self.currentResults["IN_FIELD"].length&&!self.currentResults["KEYWORD_SUGGESTION"].length&&!self.currentResults["POPULAR_PRODUCTS"].length&&
!self.currentResults["TOP_SEARCH_QUERIES"].length&&this.options.noResultTpl)if(typeof this.options.noResultTpl==="function")html=html+"\x3cli\x3e"+this.options.noResultTpl.call(self,encodeURIComponent(self.params.q))+"\x3c/li\x3e";else if(typeof this.options.noResultTpl=="string")html=html+"\x3cli\x3e"+this.options.noResultTpl+"\x3c/li\x3e";this.options.mainTpl.forEach(function(key){key=self.standardizeKeys(key);mainlen=mainlen+self.currentResults[key].length});this.options.sideTpl.forEach(function(key){if(key===
"inFields")key="IN_FIELD";else if(key==="popularProducts")key="POPULAR_PRODUCTS";else if(key==="topQueries")key="TOP_SEARCH_QUERIES";else key="KEYWORD_SUGGESTION";sidelen=sidelen+self.currentResults[key].length});if(isMobile.any())this.options.template="1column";if(this.options.template==="2column"&&!this.options.sideTpl.length&&!this.options.mainTpl){this.options.sideTpl=["keywordSuggestions","topQueries"];this.options.mainTpl=["inFields","popularProducts"]}if(this.options.template==="2column")if(mainlen==
0&&sidelen!=0){html='\x3cul class\x3d"unbxd-as-sidecontent"\x3e';this.options.sideTpl.forEach(function(key){key="prepare"+key+"HTML";html=html+self[key]()})}else if(sidelen!=0){html='\x3cul class\x3d"unbxd-as-sidecontent"\x3e';this.options.sideTpl.forEach(function(key){key="prepare"+key+"HTML";html=html+self[key]()});if(this.options.popularProducts.viewMore&&this.options.popularProducts.viewMore.enabled)html=html+this.options.popularProducts.viewMore.tpl;html=html+'\x3c/ul\x3e\x3cul class\x3d"unbxd-as-maincontent unbxd-as-suggestions-overall"\x3e';
if(this.options.suggestionsHeader)html=html+'\x3cli class\x3d"unbxd-as-header unbxd-as-suggestions-header"\x3e'+this.options.suggestionsHeader+"\x3c/li\x3e"}this.options.mainTpl.forEach(function(key){if(self.currentResults[self.standardizeKeys(key)].length&&topQuery==="")topQuery=self.currentResults[self.standardizeKeys(key)][0]["autosuggest"];key="prepare"+key+"HTML";html=html+self[key]()});html=html+"\x3c/ul\x3e";var cmpld=Handlebars.compile(html);this.log("prepraing html :-\x3e template : "+this.options.template+
" ,carts : "+this.options.showCarts+" ,cartType : "+this.options.cartType);this.log("html data : ",this.currentResults);return cmpld({data:this.currentResults,showCarts:this.options.showCarts,cartType:this.options.cartType})},addToCache:function(q,processedData){if(!(q in this.cache))this.cache[q]=$.extend({},processedData)},inCache:function(q){return q in this.cache&&this.cache.hasOwnProperty(q)},getFromCache:function(q){return this.cache[q]},destroy:function(self){self.$input.unbind(".auto");self.input.lastSelected=
null;self.$input.removeAttr("autocomplete","off");self.$results.remove();self.$input.removeData("autocomplete")},setOption:function(name,value){var a=name.split(".");if(a.length>1){var o=this.options;for(var i=0;i<a.length-1;i++){if(!(a[i]in o))o[a[i]]={};o=o[a[i]]}o[a[a.length-1]]=value}else this.options[name]=value;this.previous="";this.$results.html("");this.cache={};this.cache.length=0},log:function(){}});$.fn.unbxdautocomplete=function(options){return this.each(function(){var self=this;try{this.auto=
new autocomplete(this,options)}catch(e){}})}};var unbxd_search_selector="#txtSearch1";if(parameter==="live"){var unbxd_Handlebars={};var unbxd_$={};var onloadCount=0;if(typeof Handlebars=="undefined"||Handlebars&&Handlebars.VERSION!=="2.0.0"){if(typeof Handlebars!=="undefined"){var temp_handlebars={};temp_handlebars=Handlebars;Handlebars.noConflict()}var unbxd_handlebars_script=document.createElement("script");unbxd_handlebars_script.setAttribute("src","//cdnjs.cloudflare.com/ajax/libs/handlebars.js/2.0.0/handlebars.min.js");document.head.appendChild(unbxd_handlebars_script);unbxd_handlebars_script.onload=
function(){onloadCount++;unbxd_Handlebars=Handlebars;if(onloadCount==2)autosuggest_init();Handlebars=temp_handlebars}}else{onloadCount++;unbxd_Handlebars=Handlebars;if(onloadCount==2)autosuggest_init()}if(typeof jQuery=="undefined"||jQuery&&jQuery.fn.jquery!=="1.10.2"){var unbxd_jquery_script=document.createElement("script");unbxd_jquery_script.setAttribute("src","//code.jquery.com/jquery-1.10.2.js");document.head.appendChild(unbxd_jquery_script);unbxd_jquery_script.onload=function(){onloadCount++;
unbxd_$=$.noConflict(true);if(onloadCount==2)autosuggest_init()}}else{onloadCount++;unbxd_$=$.noConflict(true);if(onloadCount==2)autosuggest_init()}function autosuggest_init(){unbxdAutoSuggestFunction(unbxd_$,unbxd_Handlebars);unbxd_$(function(){window.UnbxdApiKey="f42c6f2a2787084c59084b57a1687eee";unbxd_$(unbxd_search_selector).unbxdautocomplete({name:"autosuggest",siteName:"prod-cookieskids-com808271562744920",resultsClass:"unbxd-as-wrapper",suggestionsHeader:"Suggestions",minChars:1,delay:100,
loadingClass:"unbxd-as-loading",maxSuggestions:10,position:"absolute",sideContentOn:"left",template:"2column",theme:"#ff8400",mainTpl:["inFields","topQueries","keywordSuggestions"],sideTpl:["popularProducts"],showCarts:false,cartType:"inline",onCartClick:"",topQueries:{count:2,hidden:false,header:""},keywordSuggestions:{count:2,header:"",tpl:"{{{safestring highlighted}}}"},inFields:{count:2,header:"",type:"separate",fields:{"brand":3,"category":3,"color":3}},popularProducts:{count:6,rowCount:3,price:true,
priceFunctionOrKey:"price",image:true,imageUrlOrFunction:"imageUrl",currency:"$",header:"Popular Products",salePrice:false,salePriceKey:"",displayDensity:"displayDensity_default",title:"title",css_overallBackgroundColor:"#ffffff",css_overallFontFamily:"open-sans",css_popularProductHeaderFontSize:10,css_popularProductHeaderFontWeight:"100",css_popularProductHeaderColor:"#000000",css_titleFontSize:10,css_titleFontWeight:"100",css_titleColor:"#000000",css_titleAlignment:"center",css_priceFontSize:10,
css_priceFontWeight:"100",css_priceColor:"#000000",css_priceAlignment:"center",view:"grid",fields:["title","price","image","productUrl"],tpl:['\x3cdiv class\x3d"unbxd-as-popular-product-info  "\x3e','\x3cdiv class\x3d"unbxd-as-popular-product-image-container"\x3e',"{{#if image}}",'\x3cimg src\x3d"{{_original.imageUrl}}"/\x3e',"{{/if}}","\x3c/div\x3e",'\x3cdiv  class\x3d"unbxd-as-popular-product-name popular-title"\x3e',"{{#if _original.title}}","{{{_original.title}}}","{{/if}}","\x3c/div\x3e",'\x3cdiv class\x3d"unbxd-as-popular-price"\x3e',
"{{#if _original.price}}","{{currency}}{{{_original.price}}}","{{/if}}","\x3c/div\x3e","\x3c/div\x3e"].join("")},suggestionStyles:{css_suggestionsHeaderFontSize:10,css_suggestionsHeaderFontWeight:"100",css_suggestionsHeaderColor:"#000000",css_suggestionsHoverColor:"#ffffff",css_suggestionsFontSize:10,css_suggestionsFontWeight:"100",css_suggestionsColor:"#000000",css_infieldTypeFontSize:10,css_infieldTypeFontWeight:"100",css_infieldTypeColor:"#000000"},filtered:true,platform:"io",templateName:"Twin-boxed autosuggest, Scoped Suggestions (Infields) in a separate line, Popular Products in a grid",
APIKey:"1c8c3ff5d59cf85f256311199bad47bc",processResultsStyles:function(fpos){return fpos},onItemSelect:function(data,original){if(data.type=="IN_FIELD"&&data.filtername){window.location=relative_search_url+"?\x26q\x3d"+encodeURIComponent(data.value)+"\x26filter\x3d("+data.filtername+":"+encodeURIComponent('"'+data.filtervalue+'")');return}else if(data.type=="POPULAR_PRODUCTS"||data.type=="POPULAR_PRODUCTS_FILTERED")if("productUrl"in original){window.location=original.productUrl;return}window.location=
"/Search.aspx?k\x3d"+encodeURIComponent(data.value)}})})}};if(parameter==="draft"){var unbxd_Handlebars={};var unbxd_$={};var onloadCount=0;if(typeof Handlebars=="undefined"||Handlebars&&Handlebars.VERSION!=="2.0.0"){if(typeof Handlebars!=="undefined"){var temp_handlebars={};temp_handlebars=Handlebars;Handlebars.noConflict()}var unbxd_handlebars_script=document.createElement("script");unbxd_handlebars_script.setAttribute("src","//cdnjs.cloudflare.com/ajax/libs/handlebars.js/2.0.0/handlebars.min.js");document.head.appendChild(unbxd_handlebars_script);unbxd_handlebars_script.onload=
function(){onloadCount++;unbxd_Handlebars=Handlebars;if(onloadCount==2)autosuggest_init();Handlebars=temp_handlebars}}else{onloadCount++;unbxd_Handlebars=Handlebars;if(onloadCount==2)autosuggest_init()}if(typeof jQuery=="undefined"||jQuery&&jQuery.fn.jquery!=="1.10.2"){var unbxd_jquery_script=document.createElement("script");unbxd_jquery_script.setAttribute("src","//code.jquery.com/jquery-1.10.2.js");document.head.appendChild(unbxd_jquery_script);unbxd_jquery_script.onload=function(){onloadCount++;
unbxd_$=$.noConflict(true);if(onloadCount==2)autosuggest_init()}}else{onloadCount++;unbxd_$=$.noConflict(true);if(onloadCount==2)autosuggest_init()}function autosuggest_init(){unbxdAutoSuggestFunction(unbxd_$,unbxd_Handlebars);unbxd_$(function(){window.UnbxdApiKey="f42c6f2a2787084c59084b57a1687eee";unbxd_$(unbxd_search_selector).unbxdautocomplete({name:"autosuggest",siteName:"prod-cookieskids-com808271562744920",resultsClass:"unbxd-as-wrapper",suggestionsHeader:"Suggestions",minChars:1,delay:100,
loadingClass:"unbxd-as-loading",maxSuggestions:10,position:"absolute",sideContentOn:"left",template:"2column",theme:"#ff8400",mainTpl:["inFields","topQueries","keywordSuggestions"],sideTpl:["popularProducts"],showCarts:false,cartType:"inline",onCartClick:"",topQueries:{count:2,hidden:false,header:""},keywordSuggestions:{count:2,header:"",tpl:"{{{safestring highlighted}}}"},inFields:{count:2,header:"",type:"separate",fields:{"brand":3,"category":3,"color":3}},popularProducts:{count:6,rowCount:3,price:true,
priceFunctionOrKey:"price",image:true,imageUrlOrFunction:"imageUrl",currency:"$",header:"Popular Products",salePrice:false,salePriceKey:"",displayDensity:"displayDensity_default",title:"title",css_overallBackgroundColor:"#ffffff",css_overallFontFamily:"open-sans",css_popularProductHeaderFontSize:10,css_popularProductHeaderFontWeight:"100",css_popularProductHeaderColor:"#000000",css_titleFontSize:10,css_titleFontWeight:"100",css_titleColor:"#000000",css_titleAlignment:"center",css_priceFontSize:10,
css_priceFontWeight:"100",css_priceColor:"#000000",css_priceAlignment:"center",view:"grid",fields:["title","price","image","productUrl"],tpl:['\x3cdiv class\x3d"unbxd-as-popular-product-info  "\x3e','\x3cdiv class\x3d"unbxd-as-popular-product-image-container"\x3e',"{{#if image}}",'\x3cimg src\x3d"{{_original.imageUrl}}"/\x3e',"{{/if}}","\x3c/div\x3e",'\x3cdiv  class\x3d"unbxd-as-popular-product-name popular-title"\x3e',"{{#if _original.title}}","{{{_original.title}}}","{{/if}}","\x3c/div\x3e",'\x3cdiv class\x3d"unbxd-as-popular-price"\x3e',
"{{#if _original.price}}","{{currency}}{{{_original.price}}}","{{/if}}","\x3c/div\x3e","\x3c/div\x3e"].join("")},suggestionStyles:{css_suggestionsHeaderFontSize:10,css_suggestionsHeaderFontWeight:"100",css_suggestionsHeaderColor:"#000000",css_suggestionsHoverColor:"#ffffff",css_suggestionsFontSize:10,css_suggestionsFontWeight:"100",css_suggestionsColor:"#000000",css_infieldTypeFontSize:10,css_infieldTypeFontWeight:"100",css_infieldTypeColor:"#000000"},filtered:true,platform:"io",templateName:"Twin-boxed autosuggest, Scoped Suggestions (Infields) in a separate line, Popular Products in a grid",
APIKey:"1c8c3ff5d59cf85f256311199bad47bc",processResultsStyles:function(fpos){return fpos},onItemSelect:function(data,original){if(data.type=="IN_FIELD"&&data.filtername){window.location=relative_search_url+"?\x26q\x3d"+encodeURIComponent(data.value)+"\x26filter\x3d("+data.filtername+":"+encodeURIComponent('"'+data.filtervalue+'")');return}else if(data.type=="POPULAR_PRODUCTS"||data.type=="POPULAR_PRODUCTS_FILTERED")if("productUrl"in original){window.location=original.productUrl;return}window.location=
"/Search.aspx?k\x3d"+encodeURIComponent(data.value)}})})}};