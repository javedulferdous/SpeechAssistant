define(['jquery','underscore','Magento_Catalog/js/price-utils','Magento_Catalog/js/price-box'],function($,_,utils){'use strict';$.widget('mage.priceBox',$.mage.priceBox,{reloadPrice:function(){this._super();this.saveUpdatedPrices();},saveUpdatedPrices(){_.each(this.cache.displayPrices,function(price,priceCode){price.final=_.reduce(price.adjustments,function(memo,amount){return memo+amount;},price.amount);price.formatted=this.formatPrice(price.final);$('[data-price-type="'+priceCode+'"]',this.element).data('price',price);},this);this.element.trigger('afterUpdatePrice');},formatPrice:function(price){var priceFormat=(this.options.priceConfig&&this.options.priceConfig.priceFormat)||{};return utils.formatPrice(price,priceFormat);}});return $.mage.priceBox;});