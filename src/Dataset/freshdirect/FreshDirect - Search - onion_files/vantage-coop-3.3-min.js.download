!function(e){function t(){!function(e,t,n,r,a,o,c){e.fbq||(a=e.fbq=function(){a.callMethod?a.callMethod.apply(a,arguments):a.queue.push(arguments)},e._fbq||(e._fbq=a),a.push=a,a.loaded=!0,a.version="2.0",a.queue=[],o=t.createElement(n),o.async=!0,o.src=r,c=t.getElementsByTagName(n)[0],c.parentNode.insertBefore(o,c))}(e,document,"script","https://connect.facebook.net/en_US/fbevents.js");var t=n();try{t?fbq("init",S.pixelId,t):fbq("init",S.pixelId)}catch(r){}}function n(){var e={};return I?(I.customerEmail&&(e.em=I.customerEmail.toLowerCase()),I.customerFirstName&&(e.fn=I.customerFirstName.toLowerCase()),I.customerBillingAddress&&(I.customerBillingAddress.city&&(e.ct=I.customerBillingAddress.city.toLowerCase().replace(/ /g,"")),I.customerBillingAddress.country&&(e.country=I.customerBillingAddress.country),I.customerBillingAddress.state&&(e.st=I.customerBillingAddress.state),I.customerBillingAddress.postalCode&&(e.zp=I.customerBillingAddress.postalCode)),e):null}function r(){!function(e,t,n,r,a,o,c){e[a]||(e.GlobalSnowplowNamespace=e.GlobalSnowplowNamespace||[],e.GlobalSnowplowNamespace.push(a),e[a]=function(){(e[a].q=e[a].q||[]).push(arguments)},e[a].q=e[a].q||[],o=t.createElement(n),c=t.getElementsByTagName(n)[0],o.async=1,o.src=r,c.parentNode.insertBefore(o,c))}(e,document,"script","https://d2wa5sea6guof0.cloudfront.net/2.10.2.js","vantageSnowplow"),e.vantageSnowplow("newTracker","cf2","track2.vantageanalytics.com",{appId:S.storeId,platform:"web",cookieName:"_spva_",respectDoNotTrack:!0,userFingerprint:!0}),e.vantageSnowplow("trackPageView")}function a(){function t(){dataLayer.push(arguments)}var n=document.getElementsByTagName("head")[0],r=document.createElement("script");r.type="text/javascript",r.src="https://www.googletagmanager.com/gtag/js?id="+S.googleConversionTrackerId,r.async=!0,n.appendChild(r),e.dataLayer=e.dataLayer||[],e.gtag=t,e.gtag("js",new Date),e.gtag("config",S.googleConversionTrackerId,{conversion_cookie_prefix:"vantage"})}function o(e){var t=e;return"string"==typeof e&&(t=e.replace(/[^\d.-]/g,"")),t}function c(e){var t=o(e);if(t)return parseFloat(t)}function i(e){var t=o(e);if(t)return parseInt(t)}function s(e){var t=[];localStorage["vantage-tracked-orders"]&&(t=JSON.parse(localStorage["vantage-tracked-orders"])),t.indexOf(e)===-1&&t.push(String(e)),localStorage["vantage-tracked-orders"]=JSON.stringify(t)}function l(e){var t=JSON.parse(localStorage["vantage-tracked-orders"]);return t.indexOf(String(e))>=0}function d(e,t){return"string"==typeof e&&(e=e.trim()),"string"==typeof t&&(t=t.trim()),e||t?(e||"")+"~~"+(t||""):""}function u(e,t){e.forEach(function(e){t[e]={totalPrice:0,contentIds:[]};var n=h[e].vendor;t[n]={totalPrice:0,contentIds:[],sentToPixels:[]}})}function g(e,t,n,r){fbq("trackSingleCustom",e,t,{content_ids:n.contentIds,content_type:"product",value:n.totalPrice,currency:"USD",order_id:r})}function p(t,n){t&&e.gtag("event","conversion",{send_to:S.googleConversionTrackerId+"/"+t,value:n.totalPrice,currency:"USD"})}function v(e,t){var r=n();Object.keys(h).forEach(function(n){var a=h[n],o=h[n].vendor;if(e[n].totalPrice>0||e[o].totalPrice>0){if(a.pixelId)try{r?fbq("init",a.pixelId,r):fbq("init",a.pixelId)}catch(c){}if(e[n].totalPrice>0){var i="VantagePurchase_"+n+"_"+x;g(a.pixelId,i,e[n],t),p(a.suffix,e[n])}var s=e[o].sentToPixels.indexOf(a.pixelId)>=0;if(!s&&e[o].totalPrice>0){var l="VantagePurchase_"+o+"_"+x;g(a.pixelId,l,e[o],t),p(a.vendorSuffix,e[o]),e[o].sentToPixels.push(a.pixelId)}}})}function f(t,n,r,a){for(var o=0;o<t.length;o++){var s=d(t[o].brand,t[o].category);e.vantageSnowplow("addItem",n,t[o].sku,t[o].name,s,c(t[o].price||0),i(t[o].quantity||1));var l=t[o].brand;if(r.indexOf(l)>-1){var u=h[l].vendor,g=c(t[o].price||0),p=i(t[o].quantity||1);a[l].totalPrice+=g*p,a[l].contentIds.push(t[o].sku),a[u].totalPrice+=g*p,a[u].contentIds.push(t[o].sku)}}}function m(t,n,r,a,o,i,l){var d=[],g=[];i&&i.length>0&&(d=i.map(function(e){return e.sku}),g=i.map(function(e){return{id:e.sku,google_business_vertical:"custom"}})),fbq("trackSingleCustom",S.pixelId,"VantagePurchase",{content_ids:d,content_type:"product",value:r,currency:"USD",order_id:t}),C&&(e.gtag("event","conversion",{send_to:S.googleConversionTrackerId+"/"+S.googleSendToSuffix,value:r,currency:"USD"}),e.gtag("event","purchase",{send_to:S.googleConversionTrackerId,value:r,items:g,currency:"USD"}));var p={},m=[];h&&(m=Object.keys(h),u(m,p)),n&&e.vantageSnowplow("setUserId",n),e.vantageSnowplow("addTrans",t,S.storeId,c(r),c(a),c(o),l.city||null,l.state||null,l.country||null),i&&i.length>0&&(f(i,t,m,p),v(p,t)),e.vantageSnowplow("trackTrans"),s(t)}function k(t){fbq("trackSingleCustom",S.pixelId,"VantageViewContent",{content_ids:t,content_type:"product"}),C&&e.gtag("event","view_item",{send_to:S.googleConversionTrackerId,dynx_itemid:t})}function y(t,n,r,a,o,s){fbq("trackSingleCustom",S.pixelId,"VantageAddToCart",{content_ids:t,content_type:"product"}),C&&e.gtag("event","add_to_cart",{send_to:S.googleConversionTrackerId,dynx_itemid:t,dynx_totalvalue:a});var l=c(a)||0,d=i(o)||1;e.vantageSnowplow("trackAddToCart",t,n,r,l,d,s)}function w(t,n,r,a,o,s){var l=c(a)||0,d=i(o)||1;e.vantageSnowplow("trackRemoveFromCart",t,n,r,l,d,s)}var S=e.$vantage,I=e.$vantageCheckout,_=e.$vantageProduct,h=e.$vantageBrands,x=e.$vantageRetailerKey,C=S.googleConversionTrackerId&&"None"!==S.googleConversionTrackerId;S.initialized||(t(),fbq("trackSingle",S.pixelId,"PageView"),C&&a(),r()),localStorage["vantage-tracked-orders"]||(localStorage["vantage-tracked-orders"]=JSON.stringify([])),I&&!l(I.orderId)&&m(I.orderId||null,I.customerEmail||null,I.totalPrice||null,I.totalTax||null,I.totalShipping||null,I.lineItems||[],I.customerBillingAddress||{}),_&&k(_.productId),S.initialized=!0,S.trackViewContent=k,S.trackAddToCart=y,S.trackRemoveFromCart=w,S.trackPurchase=m,S.addTrackedOrder=s,S.wasOrderTracked=l}(window);