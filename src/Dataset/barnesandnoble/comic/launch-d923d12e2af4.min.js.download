// For license information, see `https://assets.adobedtm.com/d55bc227c346/0aaa96eebcd0/launch-d923d12e2af4.js`.
window._satellite=window._satellite||{},window._satellite.container={buildInfo:{minified:!0,buildDate:"2020-09-02T10:53:23Z",environment:"production",turbineBuildDate:"2020-08-10T20:14:17Z",turbineVersion:"27.0.0"},dataElements:{advertisingID:{defaultValue:"",storageDuration:"pageview",modulePath:"core/src/lib/dataElements/customCode.js",settings:{source:function(){return $("#relatedAd iframe").contents().find("#google-content-text-ad-1 img").prop("src").split("/")[4]}}},req_eVar15:{defaultValue:"",storageDuration:"pageview",modulePath:"core/src/lib/dataElements/customCode.js",settings:{source:function(){var e="",t=r_getByPath(window,"digitalData.product[0].attributes.referrer.searchTerm")||r_getByPath(window,"digitalData.product[0].attributes.referrer.pageName");if(t){var n=r_getByPath(window,"digitalData.product[0].attributes.referrer.pageNumber")+"~"+r_getByPath(window,"digitalData.product[0].attributes.referrer.positionIndex");n&&(e=(window.r_removeSpecialChars(t,!0)+"~"+n).trim())}return e}}},internalCampaign:{defaultValue:"",storageDuration:"pageview",modulePath:"core/src/lib/dataElements/customCode.js",settings:{source:function(){var e=null;return s_getP("digitalData.page.attributes.internalCampaignDescription")&&(e=s_getP("digitalData.page.attributes.internalCampaignPageType"),e+="|"+s_getP("digitalData.page.attributes.internalCampaignElement"),e+="|"+s_getP("digitalData.page.attributes.internalCampaignDescription"),e+="|"+s_getP("digitalData.page.attributes.internalCampaignCTA"),e+="|"+s_getP("digitalData.page.attributes.internalCampaignAdFormat")),e}}},productName:{defaultValue:"",modulePath:"core/src/lib/dataElements/javascriptVariable.js",settings:{path:"digitalData.product.0.productInfo.productName"}},pageType:{defaultValue:"",forceLowerCase:!0,cleanText:!0,modulePath:"core/src/lib/dataElements/javascriptVariable.js",settings:{path:"digitalData.page.pageInfo.pageType"}},subCategory2:{defaultValue:"",storageDuration:"pageview",modulePath:"core/src/lib/dataElements/javascriptVariable.js",settings:{path:"digitalData.page.category.subCategory.1"}},firstCartProduct:{defaultValue:"",storageDuration:"pageview",modulePath:"core/src/lib/dataElements/javascriptVariable.js",settings:{path:"window.digitalData.cart.item.0.productInfo.sku"}},referringUrl:{defaultValue:"",forceLowerCase:!0,storageDuration:"pageview",modulePath:"core/src/lib/dataElements/customCode.js",settings:{source:function(){var e=document.referrer;if(void 0!==e&&0<e.length&&-1<e.indexOf("tpc.googlesyndication.com")){var t=tp_objectpath_get(digitalData,"page.pageInfo.breadCrumbsHrefs");t&&1<t.length&&(e=t[t.length-2])}return e}}},subCategory1:{defaultValue:"",storageDuration:"pageview",modulePath:"core/src/lib/dataElements/javascriptVariable.js",settings:{path:"digitalData.page.category.subCategory.0"}},currentISODate:{defaultValue:"",modulePath:"core/src/lib/dataElements/customCode.js",settings:{source:function(){return(new Date).toISOString()}}},pageName:{defaultValue:"",modulePath:"core/src/lib/dataElements/customCode.js",settings:{source:function(){return"undefined"==typeof window.tp_objectpath_get?_satellite.getVar("pageNameNoDefault")||document.location.href:window.tp_objectpath_get(window,"digitalData.page.pageInfo.pageName",document.location.href)}}},isResponsive:{defaultValue:"false",forceLowerCase:!0,cleanText:!0,modulePath:"core/src/lib/dataElements/customCode.js",settings:{source:function(){return BNAnalytics.IsResponsive||!1}}},internalSearchTermsCorrections:{defaultValue:"",forceLowerCase:!0,cleanText:!0,storageDuration:"pageview",modulePath:"core/src/lib/dataElements/javascriptVariable.js",settings:{path:"digitalData.page.attributes.internalSearch.corrections"}},transactionTotal:{defaultValue:"",storageDuration:"pageview",modulePath:"core/src/lib/dataElements/javascriptVariable.js",settings:{path:"digitalData.transaction.total.transactionTotal"}},shoppingCartSKUs:{defaultValue:"",storageDuration:"pageview",modulePath:"core/src/lib/dataElements/customCode.js",settings:{source:function(){var e=[],t=s_getP("digitalData.cart.item");if(t)for(var n=0;n<t.length;n++)e.push(t[n].productInfo.sku);return e}}},cjevent:{defaultValue:"",cleanText:!0,storageDuration:"visitor",modulePath:"core/src/lib/dataElements/queryStringParameter.js",settings:{name:"cjevent",caseInsensitive:!0}},pageCategoryBreadcrumb:{defaultValue:"",storageDuration:"pageview",modulePath:"core/src/lib/dataElements/customCode.js",settings:{source:function(){var e=r_getByPath(window,"digitalData.page.category.hierarchy");return e&&(0===e.indexOf("/")&&(e=e.substring(1)),e=e.replace(/\//g,"|")),e}}},req_eVar10:{defaultValue:"",storageDuration:"pageview",modulePath:"core/src/lib/dataElements/customCode.js",settings:{source:function(){var e,t="";try{for(var n=0,a=digitalData.event.length;n<a;n++){var r=s_getP("digitalData.event["+n+"].eventInfo.eventAction");if(r&&"error"===r){var i=s_getP("digitalData.event["+n+"].attributes");if(!i.handled){e=i.errorMessage,digitalData.event[n].attributes.handled=!0;break}}}e&&(a=(_satellite.getVar("pageName")||"").length+(_satellite.getVar("pageType")||"").length)<200&&(t=e.substring(0,200-a).toLowerCase()+"|"+(_satellite.getVar("pageName")||"")+"|"+(_satellite.getVar("pageType")||""))}catch(o){}return t}}},userStoreID:{defaultValue:"",storageDuration:"pageview",modulePath:"core/src/lib/dataElements/javascriptVariable.js",settings:{path:"digitalData.user.0.profile.0.profileInfo.storeID"}},transactionFulfillmentShippingMethod:{defaultValue:"",forceLowerCase:!0,storageDuration:"pageview",modulePath:"core/src/lib/dataElements/customCode.js",settings:{source:function(){var e="";return s_getP("digitalData.transaction")&&(e=s_getP("digitalData.transaction.fulfillmentType")+"|"+s_getP("digitalData.transaction.shippingMethod")),e}}},pagePrimaryCategory:{defaultValue:"",storageDuration:"pageview",modulePath:"core/src/lib/dataElements/javascriptVariable.js",settings:{path:"digitalData.page.category.primaryCategory"}},shippingCity:{defaultValue:"",storageDuration:"pageview",modulePath:"core/src/lib/dataElements/javascriptVariable.js",settings:{path:"digitalData.transaction.profile.shippingAddress.city"}},platformName:{defaultValue:"BN",storageDuration:"pageview",modulePath:"core/src/lib/dataElements/javascriptVariable.js",settings:{path:"digitalData.session.platformName"}},hierarchy:{defaultValue:"",storageDuration:"pageview",modulePath:"core/src/lib/dataElements/javascriptVariable.js",settings:{path:"window.digitalData.page.category.hierarchy"}},productListFilterValue:{defaultValue:"",forceLowerCase:!0,storageDuration:"pageview",modulePath:"core/src/lib/dataElements/customCode.js",settings:{source:function(){var t="",e=s_getP("window.digitalData.page.attributes.productlist");return e&&e.filter&&e.filter.forEach(function(e){t=s.apl(t,e.value,"|",1)}),t}}},internalSearchType:{defaultValue:"",forceLowerCase:!0,cleanText:!0,storageDuration:"pageview",modulePath:"core/src/lib/dataElements/javascriptVariable.js",settings:{path:"digitalData.page.attributes.internalSearch.type"}},productIsSearchAugmented:{defaultValue:"",storageDuration:"pageview",modulePath:"core/src/lib/dataElements/javascriptVariable.js",settings:{path:"digitalData.product.0.attributes.referrer.isSearchAugmented"}},productFormat:{defaultValue:"",storageDuration:"pageview",modulePath:"core/src/lib/dataElements/customCode.js",settings:{source:function(){var e=window.r_findDigitalDataEvent("productFormatClick");return e?s_getP("attributes.formatName",e):null}}},transactionTotalShipping:{defaultValue:"0",storageDuration:"pageview",modulePath:"core/src/lib/dataElements/javascriptVariable.js",settings:{path:"digitalData.transaction.total.shipping"}},internalSearchTermAndMethod:{defaultValue:"",forceLowerCase:!0,cleanText:!0,storageDuration:"pageview",modulePath:"core/src/lib/dataElements/customCode.js",settings:{source:function(){return _satellite.getVar("internalSearchTerm")+"|"+_satellite.getVar("internalSearchType")}}},state:{defaultValue:"",storageDuration:"pageview",modulePath:"core/src/lib/dataElements/javascriptVariable.js",settings:{path:"digitalData.transaction.profile.shippingAddress.stateProvince"}},pagePrimaryCategoryId:{defaultValue:"",storageDuration:"pageview",modulePath:"core/src/lib/dataElements/javascriptVariable.js",settings:{path:"digitalData.page.category.primaryCategoryId"}},internalSearchOrginalTerm:{defaultValue:"",forceLowerCase:!0,cleanText:!0,storageDuration:"pageview",modulePath:"core/src/lib/dataElements/javascriptVariable.js",settings:{path:"digitalData.page.attributes.internalSearch.originalTerm"}},isVendorHostedSite:{defaultValue:"",storageDuration:"pageview",modulePath:"core/src/lib/dataElements/customCode.js",settings:{source:function(){var e=_satellite.getVar("locationHostName");return("www.barnesandnoble.com"!==e&&"m.barnesandnoble.com"!==e).toString()}}},userEmail:{defaultValue:"",forceLowerCase:!0,storageDuration:"pageview",modulePath:"core/src/lib/dataElements/javascriptVariable.js",settings:{path:"digitalData.user.0.profile.0.profileInfo.email"}},userIsMember:{defaultValue:"",storageDuration:"pageview",modulePath:"core/src/lib/dataElements/customCode.js",settings:{source:function(){var e=!1;if(s_getP("digitalData.user")){var t=s_getP("user.cohort");t&&(e="Non-Members"!==t)}return e.toString()}}},pagePath:{defaultValue:"",storageDuration:"pageview",modulePath:"core/src/lib/dataElements/pageInfo.js",settings:{attribute:"pathname"}},transactionTotalVoucherCode:{defaultValue:"",storageDuration:"pageview",modulePath:"core/src/lib/dataElements/javascriptVariable.js",settings:{path:"digitalData.transaction.total.voucherCode"}},internalSearchTerm:{defaultValue:"",forceLowerCase:!0,cleanText:!0,storageDuration:"pageview",modulePath:"core/src/lib/dataElements/javascriptVariable.js",settings:{path:"digitalData.page.attributes.internalSearch.term"}},shoppingCartTotalPrice:{defaultValue:"zero",storageDuration:"pageview",modulePath:"core/src/lib/dataElements/javascriptVariable.js",settings:{path:"digitalData.cart.price.basePrice"}},internalSearchResultsCount:{defaultValue:"zero",storageDuration:"pageview",modulePath:"core/src/lib/dataElements/customCode.js",settings:{source:function(){var e=0;return s_getP("digitalData.page.attributes.internalSearch.resultsCount")&&(e=digitalData.page.attributes.internalSearch.resultsCount),0==e?"zero":e}}},productType:{defaultValue:"",storageDuration:"pageview",modulePath:"core/src/lib/dataElements/javascriptVariable.js",settings:{path:"digitalData.product.0.category.productType"}},sessionID:{defaultValue:"",storageDuration:"pageview",modulePath:"core/src/lib/dataElements/customCode.js",settings:{source:function(){var e=window.r_getByPath(window,"digitalData.session.sessionID");if("undefined"!=typeof window.s_c_r){var t=window.s_c_r("JSESSIONID");t&&0<t.indexOf(".")&&(e=t.split(".")[0])}return e}}},breadCrumbs:{defaultValue:"",forceLowerCase:!0,storageDuration:"pageview",modulePath:"core/src/lib/dataElements/customCode.js",settings:{source:function(){var e="";return"undefined"!=typeof s_getP&&s_getP("window.digitalData.page.pageInfo.breadCrumbs")&&(e=window.digitalData.page.pageInfo.breadCrumbs.join(":")),e}}},transactionTotalPrice:{defaultValue:"",storageDuration:"pageview",modulePath:"core/src/lib/dataElements/customCode.js",settings:{source:function(){var e=s_getP("digitalData.transaction.total.basePrice"),t="";return void 0!==e?parseFloat(e).toFixed(2):t}}},userHashedEmailSha256:{defaultValue:"",storageDuration:"pageview",modulePath:"core/src/lib/dataElements/customCode.js",settings:{source:function(){var e=null;if("function"==typeof window._tph.utils.sha256){var t=window.s_getP("digitalData.user[0].profile[0].profileInfo.email");void 0!==t&&(e=window._tph.utils.sha256(window.r_utf8_encode(t.toLowerCase().trim())))}return e}}},pickUpInStoreStatus:{defaultValue:"",storageDuration:"pageview",modulePath:"core/src/lib/dataElements/javascriptVariable.js",settings:{path:"digitalData.product.0.attributes.pickupInStoreStatus"}},"DCR-productPhotoView":{defaultValue:"",storageDuration:"pageview",modulePath:"core/src/lib/dataElements/customCode.js",settings:{source:function(){return"Photo View|"+_satellite.getVar("sku")}}},destinationURL:{defaultValue:"",cleanText:!0,modulePath:"core/src/lib/dataElements/javascriptVariable.js",settings:{path:"digitalData.page.pageInfo.destinationURL"}},rating:{defaultValue:"zero",storageDuration:"pageview",modulePath:"core/src/lib/dataElements/customCode.js",settings:{source:function(){var e=0;return s_getP("digitalData.product[0].attributes.rating")&&(e=digitalData.product[0].attributes.rating),0==e?"zero":e}}},transactionTotalQuantity:{defaultValue:"zero",storageDuration:"pageview",modulePath:"core/src/lib/dataElements/customCode.js",settings:{source:function(){var e=s_getP("digitalData.transaction.item"),t="";if(void 0!==e)for(var n=t=0;n<e.length;n++)t+=parseInt(e[n].quantity);return t}}},eventName:{defaultValue:"",storageDuration:"pageview",modulePath:"core/src/lib/dataElements/javascriptVariable.js",settings:{path:"window.digitalData.event.0.eventInfo.eventName"}},"DCR-productFormat":{defaultValue:"",storageDuration:"pageview",modulePath:"core/src/lib/dataElements/customCode.js",settings:{source:function(){var e=window.r_findDigitalDataEvent("productFormatClick");return e&&e.attributes?e.attributes.formatName:null}}},transactionTotalItems:{defaultValue:"zero",storageDuration:"pageview",modulePath:"core/src/lib/dataElements/customCode.js",settings:{source:function(){var e=s_getP("digitalData.transaction.item"),t="";return void 0!==e&&(t=e.length),t}}},productPrimaryCategory:{defaultValue:"",storageDuration:"pageview",modulePath:"core/src/lib/dataElements/javascriptVariable.js",settings:{path:"digitalData.product.0.category.primaryCategory"}},deviceType:{defaultValue:"desktop",forceLowerCase:!0,cleanText:!0,storageDuration:"pageview",modulePath:"core/src/lib/dataElements/customCode.js",settings:{source:function(){return"true"===_satellite.getVar("isMobile")?"mobile":"desktop"}}},isMember:{defaultValue:"false",forceLowerCase:!0,storageDuration:"pageview",modulePath:"core/src/lib/dataElements/customCode.js",settings:{source:function(){var e=!1,t=_satellite.getVar("customerCohort");return t&&"non-members"!=t.toLowerCase()&&(e=!0),e}}},subCategory3:{defaultValue:"",storageDuration:"pageview",modulePath:"core/src/lib/dataElements/javascriptVariable.js",settings:{path:"digitalData.page.category.subCategory.2"}},transactionHasNOOKDevice:{defaultValue:"",storageDuration:"pageview",modulePath:"core/src/lib/dataElements/customCode.js",settings:{source:function(){var e=s_getP("digitalData.transaction.item"),t=["9781400699896","9781400697496","9781400697489","9781400697533","9781400697588","9781400697564","9781400697601"],n=!1;if(e)for(var a=0;a<e.length;a++)if(-1<t.indexOf(e[a].productInfo.sku)){n=!0;break}return n.toString()}}},referrerSearchTerm:{defaultValue:"",storageDuration:"pageview",modulePath:"core/src/lib/dataElements/javascriptVariable.js",settings:{path:"digitalData.product.0.attributes.referrer.searchTerm"}},previousPageName:{defaultValue:"",cleanText:!0,modulePath:"core/src/lib/dataElements/javascriptVariable.js",settings:{path:"digitalData.page.pageInfo.previousPageName"}},zip:{defaultValue:"",storageDuration:"pageview",modulePath:"core/src/lib/dataElements/javascriptVariable.js",settings:{path:"digitalData.transaction.profile.shippingAddress.postalCode"}},serverName:{defaultValue:"",storageDuration:"pageview",modulePath:"core/src/lib/dataElements/customCode.js",settings:{source:function(){var e="";if("undefined"!=typeof window.s_c_r){var t=window.s_c_r("JSESSIONID");t&&0<t.indexOf(".")&&(e=t.split(".")[1])}return e}}},locationHostName:{defaultValue:"",storageDuration:"pageview",modulePath:"core/src/lib/dataElements/customCode.js",settings:{source:function(){return window.location.host||window.location.hostname}}},transactionTotalTax:{defaultValue:"0",storageDuration:"pageview",modulePath:"core/src/lib/dataElements/customCode.js",settings:{source:function(){var e=s_getP("digitalData.transaction.total.priceWithTax"),t=s_getP("digitalData.transaction.total.basePrice"),n="";return void 0!==e&&void 0!==t&&(n=parseFloat(e-t).toFixed(2)),n}}},pageNameNoDefault:{defaultValue:"",forceLowerCase:!0,modulePath:"core/src/lib/dataElements/javascriptVariable.js",settings:{path:"digitalData.page.pageInfo.pageName"}},cartBasePrice:{defaultValue:"zero",cleanText:!0,storageDuration:"pageview",modulePath:"core/src/lib/dataElements/javascriptVariable.js",settings:{path:"digitalData.cart.price.basePrice"}},reviews:{defaultValue:"zero",storageDuration:"pageview",modulePath:"core/src/lib/dataElements/customCode.js",settings:{source:function(){var e=0;return s_getP("digitalData.product[0].attributes.reviews")&&(e=digitalData.product[0].attributes.reviews),0==e?"zero":e}}},transactionCustomerID:{defaultValue:"",storageDuration:"pageview",modulePath:"core/src/lib/dataElements/javascriptVariable.js",settings:{path:"digitalData.transaction.profile.profileInfo.profileID"}},transactionSKUs:{defaultValue:"",storageDuration:"pageview",modulePath:"core/src/lib/dataElements/customCode.js",settings:{source:function(){var e=[];if(window.r_getByPath(window,"digitalData.transaction.item"))for(i=0;i<digitalData.transaction.item.length;i++)e.push(window.r_getByPath(digitalData.transaction.item[i],"productInfo.sku","NONE"));return e.join(",")}}},customerKey:{defaultValue:"",cleanText:!0,storageDuration:"pageview",modulePath:"core/src/lib/dataElements/javascriptVariable.js",settings:{path:"digitalData.user.0.profile.0.profileInfo.customerKey"}},marketingCloudVisitorID:{defaultValue:"",storageDuration:"pageview",modulePath:"core/src/lib/dataElements/customCode.js",settings:{source:function(){return s.marketingCloudVisitorID||s.analyticsVisitorID}}},transactionAddresses:{defaultValue:"",storageDuration:"pageview",modulePath:"core/src/lib/dataElements/customCode.js",settings:{source:function(){var e="";return s_getP("digitalData.transaction.profile")&&(e=s_getP("digitalData.transaction.profile.address.country")+"|"+s_getP("digitalData.transaction.profile.address.stateProvince"),e+="|"+(s_getP("digitalData.transaction.profile.shippingAddress.country")||"")+"|"+(s_getP("digitalData.transaction.profile.shippingAddress.stateProvince")||"")),e}}},pickupInStoreFilterIsVisible:{defaultValue:"",storageDuration:"pageview",modulePath:"core/src/lib/dataElements/javascriptVariable.js",settings:{path:"digitalData.page.attributes.pickupInStoreFilterIsVisible"}},primaryCategory:{defaultValue:"",storageDuration:"pageview",modulePath:"core/src/lib/dataElements/javascriptVariable.js",settings:{path:"digitalData.page.category.primaryCategory"}},transactionHasPhysicalProduct:{defaultValue:"",storageDuration:"pageview",modulePath:"core/src/lib/dataElements/customCode.js",settings:{source:function(){var e=!1,t=s_getP("digitalData.transaction.item");if(t)for(i=0;i<t.length;i++)if(!0===t[i].attributes.isPhysicalProduct){e=!0;break}return e.toString()}}},customerCohort:{defaultValue:"",storageDuration:"pageview",modulePath:"core/src/lib/dataElements/javascriptVariable.js",settings:{path:"digitalData.user.0.cohort"}},geoRegion:{defaultValue:"",storageDuration:"pageview",modulePath:"core/src/lib/dataElements/javascriptVariable.js",settings:{path:"window.digitalData.page.pageInfo.geoRegion"}},shippingState:{defaultValue:"",storageDuration:"pageview",modulePath:"core/src/lib/dataElements/javascriptVariable.js",settings:{path:"digitalData.transaction.profile.shippingAddress.stateProvince"}},productPriceFloat:{defaultValue:"0.00",modulePath:"core/src/lib/dataElements/javascriptVariable.js",settings:{path:"digitalData.product.0.price.basePrice"}},productCategoryBreadcrumb:{defaultValue:"",storageDuration:"pageview",modulePath:"core/src/lib/dataElements/customCode.js",settings:{source:function(){var e=_satellite.getVar("productPrimaryCategory");if(e){var t=r_getByPath(window,"digitalData.product[0].category.subCategory");if(t)for(var n=0;n<t.length;n++)e+="|"+t[n]}return e}}},userHashedEmail:{defaultValue:"",storageDuration:"pageview",modulePath:"core/src/lib/dataElements/customCode.js",settings:{source:function(){var e="";if("function"==typeof window.r_md5&&"function"==typeof window.r_utf8_encode){var t=window.s_getP("digitalData.user[0].profile[0].profileInfo.email");void 0!==t&&(e=window.r_md5(window.r_utf8_encode(t.toLowerCase().trim()),!0))}return e}}},pageURL:{defaultValue:"",modulePath:"core/src/lib/dataElements/pageInfo.js",settings:{attribute:"url"}},profileID:{defaultValue:"",storageDuration:"pageview",modulePath:"core/src/lib/dataElements/javascriptVariable.js",settings:{path:"digitalData.user.0.profile.0.profileInfo.profileID"}},bookGraphProductSku:{defaultValue:"",storageDuration:"pageview",modulePath:"core/src/lib/dataElements/javascriptVariable.js",settings:{path:"digitalData.product.0.attributes.bookGraphProductSKU"}},sku:{defaultValue:"",storageDuration:"pageview",modulePath:"core/src/lib/dataElements/customCode.js",settings:{source:function(){var e="";return s_getP("digitalData.product")&&(e=window.r_getByPath(digitalData,"product[0].productInfo.sku")||window.r_getByPath(digitalData,"product[0].productInfo.skuId")||""),e}}},"DCR-productFormatTab":{defaultValue:"",storageDuration:"pageview",modulePath:"core/src/lib/dataElements/customCode.js",settings:{source:function(){var e=window.r_findDigitalDataEvent("formatsEditionsTabClick");return e&&e.attributes?e.attributes.formatName:null}}},productRatingReviews:{defaultValue:"zero:zero",forceLowerCase:!0,modulePath:"core/src/lib/dataElements/customCode.js",settings:{source:function(){return BNAnalytics.getProductRatingsAndReviews(s_getP("digitalData.product[0]"))}}},transactionHasDigitalProduct:{defaultValue:"",storageDuration:"pageview",modulePath:"core/src/lib/dataElements/customCode.js",settings:{source:function(){var e=!1,t=s_getP("digitalData.transaction.item");if(t)for(i=0;i<t.length;i++)if(!0===t[i].attributes.isDigitalProduct){e=!0;break}return e.toString()}}},productListSortValue:{defaultValue:"",forceLowerCase:!0,storageDuration:"pageview",modulePath:"core/src/lib/dataElements/customCode.js",settings:{source:function(){return $("select#sortProducts:first option:selected, select#sortProducts1:first option:selected").text()}}},transactionPaymentMethod:{defaultValue:"",storageDuration:"pageview",modulePath:"core/src/lib/dataElements/javascriptVariable.js",settings:{path:"digitalData.transaction.attributes.paymentMethod"}},language:{defaultValue:"",storageDuration:"pageview",modulePath:"core/src/lib/dataElements/javascriptVariable.js",settings:{path:"window.digitalData.page.pageInfo.language"}},productAvailability:{defaultValue:"",storageDuration:"pageview",modulePath:"core/src/lib/dataElements/customCode.js",settings:{source:function(){return BNAnalytics.getProductAvailability(s_getP("digitalData.product[0]"))}}},productPrice:{defaultValue:"zero",storageDuration:"pageview",modulePath:"core/src/lib/dataElements/customCode.js",settings:{source:function(){var e=s_getP("digitalData.product[0].price.basePrice");return e||(e=$("p.price").clone().children().remove().end().text().trim().replace("$",""))||(e=$(".pdp-totval").clone().children().remove().end().text().trim().replace("$","")),e}}},transactionTotalVoucherDiscount:{defaultValue:"0",storageDuration:"pageview",modulePath:"core/src/lib/dataElements/javascriptVariable.js",settings:{path:"digitalData.transaction.total.voucherDiscount"}},transactionID:{defaultValue:"",storageDuration:"pageview",modulePath:"core/src/lib/dataElements/javascriptVariable.js",settings:{path:"digitalData.transaction.transactionID"}},filterType:{defaultValue:"",storageDuration:"pageview",modulePath:"core/src/lib/dataElements/javascriptVariable.js",settings:{path:"window.digitalData.page.attributes.productlist.filter.0.type"}},productListViewMode:{defaultValue:"",forceLowerCase:!0,modulePath:"core/src/lib/dataElements/javascriptVariable.js",settings:{path:"digitalData.page.attributes.productList.viewMode"}},isCheckoutFunnel:{defaultValue:"",forceLowerCase:!0,cleanText:!0,storageDuration:"pageview",modulePath:"core/src/lib/dataElements/customCode.js",settings:{source:function(){var e=_satellite.getVar("pageName"),t=_satellite.getVar("pageType");return(0<=e.indexOf("checkout")||0<=t.indexOf("checkout")||0<=e.indexOf("cart")||0<=t.indexOf("cart")||0<=e.indexOf("receipt")||0<=t.indexOf("receipt")).toString()}}},transactionCheckoutType:{defaultValue:"",forceLowerCase:!0,storageDuration:"pageview",modulePath:"core/src/lib/dataElements/javascriptVariable.js",settings:{path:"digitalData.transaction.checkoutType"}},isMobile:{defaultValue:"false",forceLowerCase:!0,cleanText:!0,modulePath:"core/src/lib/dataElements/customCode.js",settings:{source:function(){return BNAnalytics.IsMobile}}}},extensions:{"adobe-analytics":{displayName:"Adobe Analytics",modules:{"adobe-analytics/src/lib/actions/sendBeacon.js":{name:"send-beacon",displayName:"Send Beacon",script:function(e,t,n,r){"use strict";var a=n("../sharedModules/getTracker"),i=function(e){return e&&e.nodeName&&"a"===e.nodeName.toLowerCase()},o=function(e){return i(e)?e.innerHTML:"link clicked"},s=function(e,t,n){if("page"===t.type)r.logger.info("Firing page view beacon."),e.t();else{var a={linkType:t.linkType||"o",linkName:t.linkName||o(n)};r.logger.info("Firing link track beacon using the values: "+JSON.stringify(a)+"."),e.tl(i(n)?n:"true",a.linkType,a.linkName)}};e.exports=function(t,n){return a().then(function(e){s(e,t,n.element)},function(e){r.logger.error("Cannot send beacon: "+e)})}}},"adobe-analytics/src/lib/actions/setVariables.js":{name:"set-variables",displayName:"Set Variables",script:function(e,t,n,a){"use strict";var r=n("../sharedModules/getTracker"),i=n("../helpers/applyTrackerVariables");e.exports=function(t,n){return r().then(function(e){a.logger.info("Set variables on the tracker."),i(e,t.trackerProperties),t.customSetup&&t.customSetup.source&&t.customSetup.source.call(n.element,n,e)},function(e){a.logger.error("Cannot set variables: "+e)})}}},"adobe-analytics/src/lib/actions/clearVariables.js":{name:"clear-variables",displayName:"Clear Variables",script:function(e,t,n,a){"use strict";var r=n("../sharedModules/getTracker");e.exports=function(){return r().then(function(e){e.clearVars&&(a.logger.info("Clear variables."),e.clearVars())},function(e){a.logger.error("Cannot clear variables: "+e)})}}},"adobe-analytics/src/lib/sharedModules/getTracker.js":{script:function(e,t,n,a){"use strict";var r,i=n("@adobe/reactor-cookie"),o=n("@adobe/reactor-promise"),s=n("@adobe/reactor-window"),c=n("../helpers/settingsHelper"),l=n("../helpers/augmenters"),d=n("../helpers/applyTrackerVariables"),u=n("../helpers/loadLibrary"),p=n("../helpers/generateVersion")(a.buildInfo.turbineBuildDate),g="beforeSettings",f=a.getSharedModule("adobe-mcid","mcid-instance"),m=function(e){return!e||"true"===i.get(e)},h=function(a){return o.all(l.map(function(e){var t;try{t=e(a)}catch(n){setTimeout(function(){throw n})}return o.resolve(t)})).then(function(){return a})},b=function(e){return f&&(a.logger.info("Setting MCID instance on the tracker."),e.visitor=f),e},v=function(e){return a.logger.info('Setting version on tracker: "'+p+'".'),"undefined"!=typeof e.tagContainerMarker?e.tagContainerMarker=p:"string"==typeof e.version&&e.version.substring(e.version.length-5)!=="-"+p&&(e.version+="-"+p),e},y=function(e,t,n){return t.loadPhase===g&&t.source&&(a.logger.info("Calling custom script before settings."),t.source.call(s,n)),d(n,e||{}),t.loadPhase!==g&&t.source&&(a.logger.info("Calling custom script after settings."),t.source.call(s,n)),n},w=function(e,t){return c.isAudienceManagementEnabled(e)&&(t.loadModule("AudienceManagement"),a.logger.info("Initializing AudienceManagement module"),t.AudienceManagement.setup(e.moduleProperties.audienceManager.config)),t},_=(r=a.getExtensionSettings(),m(r.trackingCookieName)?u(r).then(h).then(b).then(v).then(y.bind(null,r.trackerProperties,r.customSetup||{})).then(w.bind(null,r)):o.reject("EU compliance was not acknowledged by the user."));e.exports=function(){return _}},name:"get-tracker",shared:!0},"adobe-analytics/src/lib/sharedModules/augmentTracker.js":{name:"augment-tracker",shared:!0,script:function(e,t,n){"use strict";var a=n("../helpers/augmenters");e.exports=function(e){a.push(e)}}},"adobe-analytics/src/lib/helpers/settingsHelper.js":{script:function(e,t,n,a){"use strict";var r=n("@adobe/reactor-window"),i={LIB_TYPES:{MANAGED:"managed",PREINSTALLED:"preinstalled",REMOTE:"remote",CUSTOM:"custom"},MANAGED_LIB_PATHS:{APP_MEASUREMENT:"AppMeasurement.js",ACTIVITY_MAP:"AppMeasurement_Module_ActivityMap.js",AUDIENCE_MANAGEMENT:"AppMeasurement_Module_AudienceManagement.js"},getReportSuites:function(e){var t=e.production;return e[a.buildInfo.environment]&&(t=e[a.buildInfo.environment]),t.join(",")},isActivityMapEnabled:function(e){return!(e.libraryCode&&!e.libraryCode.useActivityMap&&!1===e.libraryCode.useActivityMap)},isAudienceManagementEnabled:function(e){var t=!1;return e&&e.moduleProperties&&e.moduleProperties.audienceManager&&e.moduleProperties.audienceManager.config&&r&&r._satellite&&r._satellite.company&&r._satellite.company.orgId&&(t=!0),t}};e.exports=i}},"adobe-analytics/src/lib/helpers/augmenters.js":{script:function(e){"use strict";e.exports=[]}},"adobe-analytics/src/lib/helpers/applyTrackerVariables.js":{script:function(e,t,n,o){"use strict";var r=n("@adobe/reactor-query-string"),i=n("@adobe/reactor-window"),s=/eVar([0-9]+)/,c=/prop([0-9]+)/,l=new RegExp("^(eVar[0-9]+)|(prop[0-9]+)|(hier[0-9]+)|campaign|purchaseID|channel|server|state|zip|pageType$"),d=function(e,t,n){return n.indexOf(e)===t},u=function(e,t,n){var a=Object.keys(t).filter(l.test.bind(l));return n&&a.push("events"),(a=a.concat((e.linkTrackVars||"").split(","))).filter(function(e,t){return"None"!==e&&e&&d(e,t,a)}).join(",")},p=function(e,t){var n=t.map(function(e){return e.name});return(n=n.concat((e.linkTrackEvents||"").split(","))).filter(function(e,t){return"None"!==e&&d(e,t,n)}).join(",")},a=function(e,t,n){e[t]=n[t].join(",")},g=function(r,e,t){var i=t.dynamicVariablePrefix||"D=";t[e].forEach(function(e){var t;if("value"===e.type)t=e.value;else{var n=s.exec(e.value);if(n)t=i+"v"+n[1];else{var a=c.exec(e.value);a&&(t=i+"c"+a[1])}}r[e.name]=t})},f={linkDownloadFileTypes:a,linkExternalFilters:a,linkInternalFilters:a,hierarchies:function(t,e,n){n[e].forEach(function(e){t[e.name]=e.sections.join(e.delimiter)})},props:g,eVars:g,campaign:function(e,t,n){if("queryParam"===n[t].type){var a=r.parse(i.location.search);e[t]=a[n[t].value]}else e[t]=n[t].value},events:function(e,t,n){var a=n[t].map(function(e){var t=e.name;return e.id&&(t=[t,e.id].join(":")),e.value&&(t=[t,e.value].join("=")),t});e[t]=a.join(",")}};e.exports=function(t,a){var r={};a=a||{},Object.keys(a).forEach(function(e){var t=f[e],n=a[e];t?t(r,e,a):r[e]=n}),r.events&&t.events&&0<t.events.length&&(r.events=t.events+","+r.events);var e=a&&a.events&&0<a.events.length,n=u(t,r,e);n&&(r.linkTrackVars=n);var i=p(t,a.events||[]);i&&(r.linkTrackEvents=i),o.logger.info('Applying the following properties on tracker: "'+JSON.stringify(r)+'".'),Object.keys(r).forEach(function(e){t[e]=r[e]})}}},"adobe-analytics/src/lib/helpers/loadLibrary.js":{script:function(e,t,n,a){"use strict";var r=n("@adobe/reactor-load-script"),i=n("@adobe/reactor-window"),o=n("@adobe/reactor-promise"),s=n("./settingsHelper"),c=n("./pollHelper"),l=function(e,t){if(!i.s_gi)throw new Error("Unable to create AppMeasurement tracker, `s_gi` function not found."+i.AppMeasurement);a.logger.info('Creating AppMeasurement tracker with these report suites: "'+t+'"');var n=i.s_gi(t);return e.libraryCode.scopeTrackerGlobally&&(a.logger.info("Setting the tracker as window.s"),i.s=n),n},d=function(e){var t=[];switch(e.libraryCode.type){case s.LIB_TYPES.MANAGED:t.push(a.getHostedLibFileUrl(s.MANAGED_LIB_PATHS.APP_MEASUREMENT)),s.isActivityMapEnabled(e)&&t.push(a.getHostedLibFileUrl(s.MANAGED_LIB_PATHS.ACTIVITY_MAP));break;case s.LIB_TYPES.CUSTOM:t.push(e.libraryCode.source);break;case s.LIB_TYPES.REMOTE:t.push("https:"===i.location.protocol?e.libraryCode.httpsUrl:e.libraryCode.httpUrl)}if(s.isAudienceManagementEnabled(e)){var n={namespace:i._satellite.company.orgId};e.moduleProperties.audienceManager.config.visitorService=n,t.push(a.getHostedLibFileUrl(s.MANAGED_LIB_PATHS.AUDIENCE_MANAGEMENT))}return t},u=function(e){return o.all(d(e).map(function(e){return a.logger.info("Loading script: "+e),r(e)}))},p=function(e,t){if(e.libraryCode.accounts)if(t.sa){var n=s.getReportSuites(e.libraryCode.accounts);a.logger.info(
'Setting the following report suites on the tracker: "'+n+'"'),t.sa(n)}else a.logger.warn("Cannot set report suites on tracker. `sa` method not available.");return t},g=function(e){if(i[e])return a.logger.info('Found tracker located at: "'+e+'".'),i[e];throw new Error('Cannot find the global variable name: "'+e+'".')};e.exports=function(e){var t=u(e);switch(e.libraryCode.type){case s.LIB_TYPES.MANAGED:var n=s.getReportSuites(e.libraryCode.accounts);return t.then(l.bind(null,e,n));case s.LIB_TYPES.PREINSTALLED:return t.then(c.poll.bind(null,i,e.libraryCode.trackerVariableName)).then(p.bind(null,e));case s.LIB_TYPES.CUSTOM:case s.LIB_TYPES.REMOTE:return t.then(g.bind(null,e.libraryCode.trackerVariableName)).then(p.bind(null,e));default:throw new Error("Cannot load library. Type not supported.")}}}},"adobe-analytics/src/lib/helpers/generateVersion.js":{script:function(e){"use strict";var t=8,n=function(e){return e.getUTCDate().toString(36)},a=function(e){return e.substr(e.length-1)},r=function(e){return Math.floor(e.getUTCHours()/t)},i=function(e){var t=(e.getUTCMonth()+1+12*r(e)).toString(36);return a(t)},o=function(e){return(e.getUTCFullYear()-2010).toString(36)};e.exports=function(e){var t=new Date(e);if(isNaN(t))throw new Error("Invalid date provided");return("L"+o(t)+i(t)+n(t)).toUpperCase()}}},"adobe-analytics/src/lib/helpers/pollHelper.js":{script:function(e,t,n,a){"use strict";var o=n("@adobe/reactor-promise"),s=40,c=250,l=function(e,t,n){a.logger.info('Found property located at: "'+t+'"].'),e(n)},r=function(r,i){return new o(function(e,t){if(r[i])return l(e,i,r[i]);var n=1,a=setInterval(function(){r[i]&&(l(e,i,r[i]),clearInterval(a)),s<=n&&(clearInterval(a),t(new Error('Bailing out. Cannot find the variable name: "'+i+'"].'))),n++},c)})};e.exports={poll:function(e,t){return a.logger.info('Waiting for the property to become accessible at: "'+t+'"].'),r(e,t)}}}}},settings:{orgId:"9A223704532965F10A490D44@AdobeOrg",customSetup:{source:function(e){e.account="undefined"!=typeof window.BNAnalytics?window.BNAnalytics.getReportingSuiteIDs():"banglobaldev",e.currencyCode="USD",e.linkTrackVars="None",e.linkTrackEvents="None",e.charSet="UTF-8",e.linkInternalFilters="javascript:,barnes.com,bn-web.com,barnesandnoble.com",e.usePlugins=!0,e.doPlugins=function f(e){if("undefined"!=typeof e.linkType)for(var t="prop5,prop9,prop7,prop10,prop12,prop15,prop50,prop55,prop61,prop69,prop70,eVar12,eVar66,eVar67,eVar68,eVar71,eVar100".split(","),n=0;n<t.length;n++)e.linkTrackVars=e.apl(e.linkTrackVars,t[n],",",1);BNAnalytics&&"function"==typeof BNAnalytics.HolidayGiftGuide.Init&&(BNAnalytics.HolidayGiftGuide.Init(),!0===BNAnalytics.HolidayGiftGuide.HasHolidayGiftGuidePageTypeReferrer()&&("category"===_satellite.getVar("pageType")?e.events=e.apl(e.events,"event222",",",2):"pdp"===_satellite.getVar("pageType")&&(e.eVar24="holiday gift guide~"+(_satellite.getVar("previousPageName")||e.getPreviousValue(e.pageName,"s_ppn"))))),e.prop1=_satellite.getVar("primaryCategory"),e.eVar1="D=c1",e.prop2=_satellite.getVar("subCategory1"),e.eVar2="D=c2",e.prop3=_satellite.getVar("subCategory2"),e.eVar3="D=c3",e.prop4=_satellite.getVar("subCategory3"),e.eVar4="D=c4",e.prop6=_satellite.getVar("pageType"),e.eVar6="D=c6",e.prop9=_satellite.getVar("geoRegion"),e.prop10=_satellite.getVar("language"),e.prop53=_satellite.getVar("breadCrumbs"),e.eVar58="D=v56",e.eVar59="D=v56",e.eVar66=_satellite.getVar("profileID"),e.eVar100="ADOBE-LAUNCH",e.prop50=_satellite.getVar("marketingCloudVisitorID"),e.prop55=document.location.hostname||document.location.host,e.channel=_satellite.getVar("pageType"),e.pageName=_satellite.getVar("pageName"),e.eVar11=_satellite.getVar("internalCampaign"),e.prop37="D=v11";var a=window.s_getQueryStr("st")||"",r=window.s_getQueryStr("sid")||"",i=window.s_getQueryStr("2sid")||"",o=window.s_getQueryStr("sourceid")||"",s=a||r||i||o?e.getValOnce(a+"|"+r+"|"+i+"|"+o,"s_extc"):"";s&&(e.campaign=s,e.eVar27=a,e.eVar28=r,e.eVar29=i,e.eVar30=o,e.eVar58=e.crossVisitParticipation(e.campaign,"s_cmp1","1","5",">","purchase"),e.eVar59=e.crossVisitParticipation(e.campaign,"s_cmp14","14","5",">","purchase"),e.eVar56=e.crossVisitParticipation(e.campaign,"s_cmp","30","5",">","purchase")),e.prop11=e.getTimeParting("h","-5")+"|"+e.getTimeParting("d","-5"),e.prop11&&(e.eVar13="D=c11"),e.prop9&&e.prop10&&(e.eVar9=e.prop9+"|"+e.prop10+"|"+_satellite.getVar("sessionID")),e.prop7=e.eVar7=e.getVisitNum(),"undefined"!=typeof e.linkType&&"o"!==e.linkType&&"d"!==e.linkType&&"e"!==e.linkType||(e.prop8=e.eVar8=e.getActionDepth("s_depth")),e.prop20=e.eVar20=e.getDaysSinceLastVisit("s_lv");var c=e.getPreviousValue(e.pageName,"s_ppn"),l=e.getPercentPageViewed(e.pageName);if(l&&"array"===window.tp_toType(l)&&l[0]==c&&(e.eVar26=l.join("|")),e.prop69="undefined"!=typeof Visitor?"VisitorAPI Present":"VisitorAPI Missing",e.prop12=e.getPlatform().device+"|"+(window.BNAnalytics.IsMobile?"mobile":"full"),e.prop12&&!e.eVar12&&(e.eVar12=e.prop12),e.prop5=e.eVar5=e.eVar66?"logged-in":"not logged-in",_satellite.getVar("req_eVar15")&&(e.prop15=_satellite.getVar("req_eVar15")),e.prop16=window.s_getLoadTime(),e.events=e.apl(e.events,"event95="+e.prop16,",",1),"b"===s_getP("digitalData.page.category.primaryCategory")&&(e.eVar25=_satellite.getVar("hierarchy")),e.eVar66=e.eVar66||_satellite.getVar("profileID"),e.prop53=e.prop53||_satellite.getVar("breadCrumbs"),e.eVar67=_satellite.getVar("customerKey"),e.eVar68=_satellite.getVar("customerCohort"),e.prop70=e.version,e.eVar71=e.pageName+"|"+_satellite.getVar("pagePath"),e.eVar71&&(e.prop71="D=v71"),e.eVar72=_satellite.getVar("previousPageName")||e.getPreviousValue(e.pageName,"s_ppn"),e.eVar72&&(e.prop72="D=v72"),e.eVar73=_satellite.getVar("pagePath"),e.eVar73&&(e.prop73="D=v73"),e.eVar74=_satellite.getVar("referringUrl"),e.eVar74&&(e.prop74="D=v74"),e.hier1=_satellite.getVar("breadCrumbs"),e.socialPlatforms(),e.pageURL&&-1<e.pageURL.indexOf("_requestid")&&"undefined"!=typeof window.r_removeQueryParam&&(e.pageURL=window.r_removeQueryParam("_requestid",e.pageURL)),!0===window.BNAnalytics.IsMobile)switch("skava"==_satellite.getVar("platformName")?e.events=e.apl(e.events,"event82",",",1):e.events=e.apl(e.events,"event83",",",1),window.s_c_r("Mobile-seg")){case"Skava-seg":e.events=e.apl(e.events,"event80",",",1);break;case"Control-A-seg":break;case"Control-B-seg":e.events=e.apl(e.events,"event81",",",1)}var d=window.s_getQueryStr("spklr")||"";d&&(e.eVar18=d),"function"==typeof s_getQueryStr&&s_getQueryStr("browsery")&&(e.eVar24=("browsery|"+s_getQueryStr("browsery")).toLowerCase());var u=e.getPreviousValue(e.channel,"gpvchannel",""),p=document.createElement("a");if(p.href=document.referrer,e.refDomain=p.hostname,"undefined"==typeof e.eVar24||!e.eVar24){var g=e.getPreviousValue(window.location.href,"gpv_pgURL");e.campaign?e.eVar24="external campaign referral":e.eVar11?e.eVar24=e.eVar11:"onsite search"==e.channel?e.eVar24="Internal search":"storefront"==e.channel?e.eVar24="storefront page":"category"==e.channel?e.eVar24="category page":"onsite search:results page"==e.eVar72?e.eVar24="Internal Search":"pdp"==e.channel&&"no value"!=u?e.eVar24=u:-1==e.refDomain.indexOf("barnesandnoble.com")?e.eVar24="external natural referal":e.eVar74?e.eVar24=e.eVar74:"no value"==g||""===g?e.eVar24="Catch All":"stacks:holiday gift guide"==e.channel?e.eVar24="stacks:holiday gift guide":e.eVar24=g}if("onsite search"!==_satellite.getVar("pageType")&&"category"!==_satellite.getVar("pageType")||!0===_satellite.getVar("pickupInStoreFilterIsVisible")&&(e.events=e.apl(e.events,"event155",",",1)),e.prop66=_satellite.getVar("userStoreID"),e.prop61=_satellite.getVar("currentISODate"),0===_satellite.getVar("pageType").indexOf("stacks:")&&0===e.pageName.indexOf("campaign:stacks ")&&0<_satellite.getVar("productListViewMode").length&&(e.events=e.apl(e.events,"event90",",",2),_satellite.getVar("productListViewMode")))switch(_satellite.getVar("productListViewMode")){case"cover":e.events=e.apl(e.events,"event88",",",2);break;case"list":e.events=e.apl(e.events,"event89",",",2)}},e.registerPostTrackCallback(function(){e.clearVars()}),e.crossVisitParticipation=new Function("v","cn","ex","ct","dl","ev","dv","var s=this,ce;if(typeof(dv)==='undefined')dv=0;if(s.events&&ev){var ay=s.split(ev,',');var ea=s.split(s.events,',');for(var u=0;u<ay.length;u++){for(var x=0;x<ea.length;x++){if(ay[u]==ea[x]){ce=1;}}}}if(!v||v==''){if(ce){s.c_w(cn,'');return'';}else return'';}v=escape(v);var arry=new Array(),a=new Array(),c=s.c_r(cn),g=0,h=new Array();if(c&&c!=''){arry=s.split(c,'],[');for(q=0;q<arry.length;q++){z=arry[q];z=s.repl(z,'[','');z=s.repl(z,']','');z=s.repl(z,\"'\",'');arry[q]=s.split(z,',')}}var e=new Date();e.setFullYear(e.getFullYear()+5);if(dv==0&&arry.length>0&&arry[arry.length-1][0]==v)arry[arry.length-1]=[v,new Date().getTime()];else arry[arry.length]=[v,new Date().getTime()];var start=arry.length-ct<0?0:arry.length-ct;var td=new Date();for(var x=start;x<arry.length;x++){var diff=Math.round((td.getTime()-arry[x][1])/86400000);if(diff<ex){h[g]=unescape(arry[x][0]);a[g]=[arry[x][0],arry[x][1]];g++;}}var data=s.join(a,{delim:',',front:'[',back:']',wrap:\"'\"});s.c_w(cn,data,e);var r=s.join(h,{delim:dl});if(ce)s.c_w(cn,'');return r;"),e.wd=window,e.pt=new Function("x","d","f","a","var s=this,t=x,z=0,y,r,l='length';while(t){y=t.indexOf(d);y=y<0?t[l]:y;t=t.substring(0,y);r=s[f](t,a);if(r)return r;z+=y+d[l];t=x.substring(z,x[l]);t=z<x[l]?t:''}return''"),e.getValOnce=new Function("v","c","e","t","var s=this,a=new Date,v=v?v:'',c=c?c:'s_gvo',e=e?e:0,i=t=='m'?60000:86400000,k=s.c_r(c);if(v){a.setTime(a.getTime()+e*i);s.c_w(c,v,e==0?0:a);}return v==k?'':v"),e.getQueryParam=new Function("p","d","u","var s=this,v='',i,t;d=d?d:'';u=u?u:(s.pageURL?s.pageURL:s.wd.location);if(u=='f')u=s.gtfs().location;while(p){i=p.indexOf(',');i=i<0?p.length:i;t=s.p_gpv(p.substring(0,i),u+'');if(t){t=t.indexOf('#')>-1?t.substring(0,t.indexOf('#')):t;}if(t)v+=v?d+t:t;p=p.substring(i==p.length?i:i+1)}return v"),e.p_gpv=new Function("k","u","var s=this,v='',i=u.indexOf('?'),q;if(k&&i>-1){q=u.substring(i+1);v=s.pt(q,'&','p_gvf',k)}return v"),e.p_gvf=new Function("t","k","if(t){var s=this,i=t.indexOf('='),p=i<0?t:t.substring(0,i),v=i<0?'True':t.substring(i+1);if(p.toLowerCase()==k.toLowerCase())return s.epa(v)}return ''"),e.getPreviousValue=new Function("v","c","el","var s=this,t=new Date,i,j,r='';t.setTime(t.getTime()+1800000);if(el){if(s.events){i=s.split(el,',');j=s.split(s.events,',');for(x in i){for(y in j){if(i[x]==j[y]){if(s.c_r(c)) r=s.c_r(c);v?s.c_w(c,v,t):s.c_w(c,'no value',t);return r}}}}}else{if(s.c_r(c)) r=s.c_r(c);v?s.c_w(c,v,t):s.c_w(c,'no value',t);return r}"),e.split=new Function("l","d","var i,x=0,a=new Array;while(l){i=l.indexOf(d);i=i>-1?i:l.length;a[x++]=l.substring(0,i);l=l.substring(i+d.length);}return a"),e.getValOnce=new Function("v","c","e","var s=this,k=s.c_r(c),a=new Date;e=e?e:0;if(v){a.setTime(a.getTime()+e*86400000);s.c_w(c,v,e?a:0);}return v==k?'':v"),e.getTimeParting=new Function("t","z","y","l","var s=this,d,A,B,C,D,W,X,Y,Z;d=new Date();A=d.getFullYear();if(A=='2011'){B='13';C='06'}if(A=='2012'){B='11';C='04'}if(A=='2013'){B='10';C='03'}if(A=='2014'){B='09';C='02'}if(A=='2015'){B='08';C='01'}if(A=='2016'){B='13';C='06'}if(A=='2017'){B='12';C='05'}if(!B||!C){B='08';C='01'}B='03/'+B+'/'+A;C='11/'+C+'/'+A;D=new Date('1/1/2000');if(D.getDay()!=6||D.getMonth()!=0){return'Data Not Available'}else{z=z?z:'0';z=parseFloat(z);B=new Date(B);C=new Date(C);W=new Date();if(W>B&&W<C&&l!='0'){z=z+1}W=W.getTime()+(W.getTimezoneOffset()*60000);W=new Date(W+(3600000*z));X=['Sunday','Monday','Tuesday','Wednesday','Thursday','Friday','Saturday'];B=W.getHours();C=W.getMinutes();if(C<10){C='0'+C};D=W.getDay();Z=X[D];A='weekday';X='00';if(C>30){X='30'};if(D==6||D==0){A='weekend'}W=B+':'+X;if(y&&y!=Y){return'Data Not Available'}else{if(t){if(t=='h'){return W}if(t=='m'){return B+':'+C+' '}if(t=='d'){return Z}if(t=='w'){return A}if(t=='f'){return B+':'+C+' '+' - '+Z}}else{return Z+', '+W}}}"),e.getNewRepeat=new Function("d","cn","var s=this,e=new Date(),cval,sval,ct=e.getTime();d=d?d:30;cn=cn?cn:'s_nr';e.setTime(ct+d*24*60*60*1000);cval=s.c_r(cn);if(cval.length==0){s.c_w(cn,ct+'-New',e);return'New';}sval=s.split(cval,'-');if(ct-sval[0]<30*60*1000&&sval[1]=='New'){s.c_w(cn,ct+'-New',e);return'New';}else{s.c_w(cn,ct+'-Repeat',e);return'Repeat';}"),e.getActionDepth=new Function("c","var s=this,v=1,t=new Date;t.setTime(t.getTime()+1800000);if(!s.c_r(c)){v=1}if(s.c_r(c)){v=s.c_r(c);v++}if(!s.c_w(c,v,t)){s.c_w(c,v,0)}return v;"),e.getVisitNum=new Function("tp","c","c2","var s=this,e=new Date,cval,cvisit,ct=e.getTime(),d;if(!tp){tp='m';}if(tp=='m'||tp=='w'||tp=='d'){eo=s.endof(tp),y=eo.getTime();e.setTime(y);}else {d=tp*86400000;e.setTime(ct+d);}if(!c){c='s_vnum';}if(!c2){c2='s_invisit';}cval=s.c_r(c);if(cval){var i=cval.indexOf('&vn='),str=cval.substring(i+4,cval.length),k;}cvisit=s.c_r(c2);if(cvisit){if(str){e.setTime(ct+1800000);s.c_w(c2,'true',e);return str;}else {return 'unknown visit number';}}else {if(str){str++;k=cval.substring(0,i);e.setTime(k);s.c_w(c,k+'&vn='+str,e);e.setTime(ct+1800000);s.c_w(c2,'true',e);return str;}else {s.c_w(c,e.getTime()+'&vn=1',e);e.setTime(ct+1800000);s.c_w(c2,'true',e);return 1;}}"),e.dimo=new Function("m","y","var d=new Date(y,m+1,0);return d.getDate();"),e.endof=new Function("x","var t=new Date;t.setHours(0);t.setMinutes(0);t.setSeconds(0);if(x=='m'){d=s.dimo(t.getMonth(),t.getFullYear())-t.getDate()+1;}else if(x=='w'){d=7-t.getDay();}else {d=1;}t.setDate(t.getDate()+d);return t;"),e.getDaysSinceLastVisit=new Function("c","var s=this,e=new Date(),es=new Date(),cval,cval_s,cval_ss,ct=e.getTime(),day=24*60*60*1000,f1,f2,f3,f4,f5;e.setTime(ct+3*365*day);es.setTime(ct+30*60*1000);f0='Cookies Not Supported';f1='First Visit';f2='More than 30 days';f3='More than 7 days';f4='Less than 7 days';f5='Less than 1 day';cval=s.c_r(c);if(cval.length==0){s.c_w(c,ct,e);s.c_w(c+'_s',f1,es);}else{var d=ct-cval;if(d>30*60*1000){if(d>30*day){s.c_w(c,ct,e);s.c_w(c+'_s',f2,es);}else if(d<30*day+1 && d>7*day){s.c_w(c,ct,e);s.c_w(c+'_s',f3,es);}else if(d<7*day+1 && d>day){s.c_w(c,ct,e);s.c_w(c+'_s',f4,es);}else if(d<day+1){s.c_w(c,ct,e);s.c_w(c+'_s',f5,es);}}else{s.c_w(c,ct,e);cval_ss=s.c_r(c+'_s');s.c_w(c+'_s',cval_ss,es);}}cval_s=s.c_r(c+'_s');if(cval_s.length==0) return f0;else if(cval_s!=f1&&cval_s!=f2&&cval_s!=f3&&cval_s!=f4&&cval_s!=f5) return '';else return cval_s;"),e.socialPlatforms=new Function("a","var s=this,g,K,D,E,F,i;g=s.referrer?s.referrer:document.referrer;g=g.toLowerCase();K=s.split(s.socPlatList,'|');for(i=0;i<K.length;i++){D=s.split(K[i],'>');if(g.indexOf(D[0])!=-1){s.contextData['a.socialcontentprovider']=D[1];}}"),e.socPlatList="facebook.com>Facebook|twitter.com>Twitter|t.co/>Twitter|youtube.com>Youtube|clipmarks.com>Clipmarks|dailymotion.com>Dailymotion|delicious.com>Delicious|digg.com>Digg|diigo.com>Diigo|flickr.com>Flickr|flixster.com>Flixster|fotolog.com>Fotolog|friendfeed.com>FriendFeed|google.com/buzz>Google Buzz|buzz.googleapis.com>Google Buzz|plus.google.com>Google+|hulu.com>Hulu|identi.ca>identi.ca|ilike.com>iLike|intensedebate.com>IntenseDebate|myspace.com>MySpace|newsgator.com>Newsgator|photobucket.com>Photobucket|plurk.com>Plurk|slideshare.net>SlideShare|smugmug.com>SmugMug|stumbleupon.com>StumbleUpon|tumblr.com>Tumblr|vimeo.com>Vimeo|wordpress.com>WordPress|xanga.com>Xanga|metacafe.com>Metacafe|pinterest.com>Pinterest",e.socialAuthors=new Function("","var s=this,g;g=s.referrer?s.referrer:document.referrer;if(g.indexOf('http://t.co/')===0||g.indexOf('https://t.co/')===0||g.indexOf('pinterest.com/pin')!==-1||g.indexOf('tumblr.com')!==-1||g.indexOf('youtube.com')!==-1){s.Integrate.add('SocialAuthor');s.Integrate.SocialAuthor.tEvar='reserved';s.Integrate.SocialAuthor.get('//sa-services.social.omniture.com/author/name?var=[VAR]&callback=s.socialAuthorSearch&rs='+encodeURIComponent(s_account)+'&q='+encodeURIComponent(g));s.Integrate.SocialAuthor.delay();s.Integrate.SocialAuthor.setVars=function(s,p){if(p.tEvar==='reserved'){s.contextData['a.socialauthor']=s.user;}else{s[p.tEvar]=s.user;}}}"),e.socialAuthorSearch=new Function("obj","var s=this;if(typeof obj==='undefined'||typeof obj.author==='undefined'){s.user='Not Found';}else{s.user=obj.author;}s.Integrate.SocialAuthor.ready();"),e.maxDelay="3000",e.loadModule("Integrate"),e.Integrate.onLoad=function(e){e.socialAuthors()},e.getPlatforms={device:["BlackBerry","Google TV","iPad","iPhone","iPod","Kindle","Kindle Fire~(?:Cloud9|Silk-Accelerated)","Intel Mac","Mac","Nook","PlayBook","PlayStation Vita","TouchPad","Transformer","Xoom","Android","Windows CE","PC~Windows"],OS:["Android","BlackBerry","CentOS","Debian","Fedora","FreeBSD","Gentoo","Haiku","Kubuntu","Linux Mint","Red Hat","SuSE","Ubuntu","Xubuntu","Cygwin","Symbian OS","hpwOS","webOS","Tablet OS","Linux","OS X","Macintosh","OpenBSD","Windows( [a-zA-Z0-9]+|)"],browser:["Nook Browser","Opera( Mini|)","Opera~OPR","Chrome","Chrome Mobile~(?:CriOS|CrMo)","Firefox~(?:Firefox|Minefield)","IE~MSIE","Safari"]},e.getPlatform=new Function("var s=this,w=window,P=s.getPlatforms||{},n=w.navigator||{},U='unknown',a=n.userAgent||'',s=w.screen||{},R={agent:a||U,locale:(n.language||'').toLowerCase()||U,device:U,OS:U,OSVer:U,browser:U,browserVer:U,width:s.width||0,height:s.height||0,density:Math.round(100*(w.devicePixelRatio||1))/100},p,i,m,I,j,V=function(a,m){var i=a.indexOf(m)+m.length,x=new RegExp('([/ :]+)([0-9.]+)','i').exec(a.substring(i));return x.length>2?x[2]:''};for(p in P){for(i=m=0;!m&&i<P[p].length;i++){I=P[p][i];j=I.indexOf('~')+1;m=new RegExp(I.substring(j)).exec(a);if(m){R[p]=j?I.substring(0,j-1):m[0];if(p=='browser'||p=='OS')R[p+'Ver']=V(a,m[0])}}}return R"),e.getCartOpen=new Function("c","var s=this,t=new Date,e=s.events?s.events:'',i=0;t.setTime(t.getTime()+1800000);if(s.c_r(c)||e.indexOf('scOpen')>-1){if(!s.c_w(c,1,t)){s.c_w(c,1,0)}}else{if(e.indexOf('scAdd')>-1){if(s.c_w(c,1,t)){i=1}else if(s.c_w(c,1,0)){i=1}}}if(i){e=e+',scOpen'}return e"),e.apl=new Function("L","v","d","u","var s=this,m=0;if(!L)L='';if(u){var i,n,a=s.split(L,d);for(i=0;i<a.length;i++){n=a[i];m=m||(u==1?(n==v):(n.toLowerCase()==v.toLowerCase()));}}if(!m)L=L?L+d+v:v;return L"),e.p_c=new Function("v","c","var x=v.indexOf('=');return c.toLowerCase()==v.substring(0,x<0?v.length:x).toLowerCase()?v:0"),e.p_gh=new Function("var s=this;if(!s.eo&&!s.lnk)return '';var o=s.eo?s.eo:s.lnk,y=s.ot(o),n=s.oid(o),x=o.s_oidt;if(s.eo&&o==s.eo){while(o&&!n&&y!='BODY'){o=o.parentElement?o.parentElement:o.parentNode;if(!o)return '';y=s.ot(o);n=s.oid(o);x=o.s_oidt}}return o.href?o.href:'';"),e.split=new Function("l","d","var i,x=0,a=new Array;while(l){i=l.indexOf(d);i=i>-1?i:l.length;a[x++]=l.substring(0,i);l=l.substring(i+d.length);}return a"),e.repl=new Function("x","o","n","var i=x.indexOf(o),l=n.length;while(x&&i>=0){x=x.substring(0,i)+n+x.substring(i+o.length);i=x.indexOf(o,i+l)}return x"),e.join=new Function("v","p","var s = this;var f,b,d,w;if(p){f=p.front?p.front:'';b=p.back?p.back:'';d=p.delim?p.delim:'';w=p.wrap?p.wrap:'';}var str='';for(var x=0;x<v.length;x++){if(typeof(v[x])=='object' )str+=s.join( v[x],p);else str+=w+v[x]+w;if(x<v.length-1)str+=d;}return f+str+b;"),e.governor=new Function("","var s=this;if(typeof s.hl=='undefined'){s.hl=60;}if(typeof s.ht=='undefined'){s.ht=60;}if(typeof s.he=='undefined'){s.he=60;}if(s.Util.cookieRead('s_hg')==8){var i=new Date(),y=i.getFullYear(),m=i.getMonth(),d=i.getDate(),i=new Date(y,m,d+s.he);s.Util.cookieWrite('s_hg',9,i);return;}var f=s.Util.cookieRead('s_hc'),g=Number(s.Util.cookieRead('s_ht')),h=Math.floor((new Date()).getTime()),ha=f!=''?f.split('|').map(Number):[0,0,0,0,0],i=ha.reduce(function(ha,b){return ha+b;},0),j=g==0?0:Math.floor(((h-g)/(s.ht/6))/1000);if(g==0)s.Util.cookieWrite('s_ht',h);if(i<s.hl){if(j>=1){if(j>=6){ha=[0,0,0,0,0];}else{for(var k=0;k<j;k++){ha.unshift(0);ha.pop();}}s.Util.cookieWrite('s_ht',h);}}else{s.Util.cookieWrite('s_hg',8);s.linkTrackVars+=',contextData.exceptionFlag';s.contextData['exceptionFlag']='true';s.tl(this,'o','exceptionFlag');}ha[0]++;s.Util.cookieWrite('s_hc',ha.join('|'));"),e.getPercentPageViewed=new Function("n","var s=this,W=window,EL=W.addEventListener,AE=W.attachEvent,E=['load','unload','scroll','resize','zoom','keyup','mouseup','touchend','orientationchange','pan'];W.s_Obj=s;s_PPVid=(n=='-'?s.pageName:n)||s.pageName||location.href;if(!W.s_PPVevent){s.s_PPVg=function(n,r){var k='s_ppv',p=k+'l',c=s.c_r(n||r?k:p),a=c.indexOf(',')>-1?c.split(',',10):[''],l=a.length,i;a[0]=unescape(a[0]);r=r||(n&&n!=a[0])||0;a.length=10;if(typeof a[0]!='string')a[0]='';for(i=1;i<10;i++)a[i]=!r&&i<l?parseInt(a[i])||0:0;if(l<10||typeof a[9]!='string')a[9]='';if(r){s.c_w(p,c);s.c_w(k,'?')}return a};W.s_PPVevent=function(e){var W=window,D=document,B=D.body,E=D.documentElement,S=window.screen||0,Ho='offsetHeight',Hs='scrollHeight',Ts='scrollTop',Wc='clientWidth',Hc='clientHeight',C=100,M=Math,J='object',N='number',s=W.s_Obj||W.s||0;e=e&&typeof e==J?e.type||'':'';if(!e.indexOf('on'))e=e.substring(2);s_PPVi=W.s_PPVi||0;if(W.s_PPVt&&!e){clearTimeout(s_PPVt);s_PPVt=0;if(s_PPVi<2)s_PPVi++}if(typeof s==J){var h=M.max(B[Hs]||E[Hs],B[Ho]||E[Ho],B[Hc]||E[Hc]),X=W.innerWidth||E[Wc]||B[Wc]||0,Y=W.innerHeight||E[Hc]||B[Hc]||0,x=S?S.width:0,y=S?S.height:0,r=M.round(C*(W.devicePixelRatio||1))/C,b=(D.pageYOffset||E[Ts]||B[Ts]||0)+Y,p=h>0&&b>0?M.round(C*b/h):0,O=W.orientation,o=!isNaN(O)?M.abs(o)%180:Y>X?0:90,L=e=='load'||s_PPVi<1,a=s.s_PPVg(s_PPVid,L),V=function(i,v,f,n){i=parseInt(typeof a==J&&a.length>i?a[i]:'0')||0;v=typeof v!=N?i:v;v=f||v>i?v:i;return n?v:v>C?C:v<0?0:v};if(new RegExp('(iPod|iPad|iPhone)').exec(navigator.userAgent||'')&&o){o=x;x=y;y=o}o=o?'P':'L';a[9]=L?'':a[9].substring(0,1);s.c_w('s_ppv',escape(W.s_PPVid)+','+V(1,p,L)+','+(L||!V(2)?p:V(2))+','+V(3,b,L,1)+','+X+','+Y+','+x+','+y+','+r+','+a[9]+(a[9]==o?'':o))}if(!W.s_PPVt&&e!='unload')W.s_PPVt=setTimeout(W.s_PPVevent,333)};for(var f=W.s_PPVevent,i=0;i<E.length;i++)if(EL)EL(E[i],f,false);else if(AE)AE('on'+E[i],f);f()};var a=s.s_PPVg();return!n||n=='-'?a[1]:a")}},libraryCode:{type:"managed",accounts:{staging:["banglobalstage"],production:["banglobalprod"],development:["banglobalqa"]},useActivityMap:!0,scopeTrackerGlobally:!0},trackerProperties:{props:[{name:"prop61",type:"value",value:"%currentISODate%"}],server:"%serverName%",channel:"%pageType%",charSet:"UTF-8",pageURL:"%pageURL%",pageName:"%pageName%",hierarchies:[{name:"hier1",sections:["%hierarchy%"],delimiter:","}],currencyCode:"USD",trackingServer:"barnes.d2.sc.omtrdc.net",trackInlineStats:!0,visitorNamespace:"barnes",trackDownloadLinks:!0,trackExternalLinks:!0,cookieDomainPeriods:"2",linkExternalFilters:["customer.barnesandnoble.com","customer.bn.com","stores.barnesandnoble.com"],linkInternalFilters:["tel:","barnes.com","barnesandnoble.com","bn-web.com","javascript:","mailto:"],trackingServerSecure:"barnes.d2.sc.omtrdc.net",linkDownloadFileTypes:["doc","docx","eps","jpg","png","svg","xls","ppt","pptx","pdf","xlsx","tab","csv","zip","txt","vsd","vxd","xml","js","css","rar","exe","wma","mov","avi","wmv","mp3","wav","m4v"]}},hostedLibFilesBaseUrl:"https://assets.adobedtm.com/extensions/EPbde2f7ca14e540399dcc1f8208860b7b/"},core:{displayName:"Core",modules:{"core/src/lib/dataElements/customCode.js":{name:"custom-code",displayName:"Custom Code",script:function(e){"use strict";e.exports=function(e,t){return e.source(t)}}},"core/src/lib/dataElements/javascriptVariable.js":{name:"javascript-variable",displayName:"JavaScript Variable",script:function(e,t,n){"use strict";var a=n("../helpers/getObjectProperty.js");e.exports=function(e){return a(window,e.path)}}},"core/src/lib/dataElements/queryStringParameter.js":{name:"query-string-parameter",displayName:"Query String Parameter",script:function(e,t,n){"use strict";var o=n("@adobe/reactor-window"),s=n("@adobe/reactor-query-string");e.exports=function(e){var t=s.parse(o.location.search);if(!e.caseInsensitive)return t[e.name];for(var n=e.name.toLowerCase(),a=Object.keys(t),r=0;r<a.length;r++){var i=a[r];if(i.toLowerCase()===n)return t[i]}}}},"core/src/lib/dataElements/pageInfo.js":{name:"page-info",displayName:"Page Info",script:function(e,t,n){"use strict";var a=n("@adobe/reactor-document");e.exports=function(e){switch(e.attribute){case"url":return a.location.href;case"hostname":return a.location.hostname;case"pathname":return a.location.pathname;case"protocol":return a.location.protocol;case"referrer":return a.referrer;case"title":return a.title}}}},"core/src/lib/events/directCall.js":{name:"direct-call",displayName:"Direct Call",script:function(e,t,n,i){"use strict";var o={};window._satellite=window._satellite||{},window._satellite.track=function(e,t){e=e.trim();var n=o[e];if(n){var a={identifier:e,detail:t};n.forEach(function(e){e(a)});var r=['Rules using the direct call event type with identifier "'+e+'" have been triggered'+(t?" with additional detail:":".")];t&&r.push(t),i.logger.log.apply(i.logger,r)}else i.logger.log('"'+e+'" does not match any direct call identifiers.')},e.exports=function(e,t){var n=o[e.identifier];n||(n=o[e.identifier]=[]),n.push(t)}}},"core/src/lib/actions/customCode.js":{name:"custom-code",displayName:"Custom Code",script:function(e,t,n,i){"use strict";var o,a,r,s,c=n("@adobe/reactor-document"),l=n("@adobe/reactor-promise"),d=n("./helpers/decorateCode"),u=n("./helpers/loadCodeSequentially"),p=n("../../../node_modules/postscribe/dist/postscribe"),g=n("./helpers/unescapeHtmlCode"),f=(a=function(e){p(c.body,e,{beforeWriteToken:function(t){var e=t.tagName&&t.tagName.toLowerCase();return o&&"script"===e&&(t.attrs.nonce=o),"script"!==e&&"style"!==e||(Object.keys(t.attrs||{}).forEach(function(e){t.attrs[e]=g(t.attrs[e])}),t.src&&(t.src=g(t.src))),t},error:function(e){i.logger.error(e.msg)}})},r=[],s=function(){if(c.body)for(;r.length;)a(r.shift());else setTimeout(s,20)},function(e){r.push(e),s()}),m=function(){if(c.currentScript)return c.currentScript.async;for(var e=c.querySelectorAll("script"),t=0;t<e.length;t++){var n=e[t];if(/(launch|satelliteLib)-[^\/]+.js(\?.*)?$/.test(n.src))return n.async}return!0}();e.exports=function(e,t){var n;o=i.getExtensionSettings().cspNonce;var a={settings:e,event:t},r=a.settings.source;if(r)return a.settings.isExternal?u(r).then(function(e){return e?(n=d(a,e),f(n.code),n.promise):l.resolve()}):(n=d(a,r),m||"loading"!==c.readyState?f(n.code):c.write&&!1===i.propertySettings.ruleComponentSequencingEnabled?c.write(n.code):f(n.code),n.promise)}}},"core/src/lib/events/click.js":{name:"click",displayName:"Click",script:function(e,t,n){"use strict";var i=n("@adobe/reactor-window"),o=n("./helpers/createBubbly")(),s=new(n("./helpers/weakMap")),c=function(e){for(;e;){var t=e.tagName;if(t&&"a"===t.toLowerCase()){var n=e.getAttribute("href"),a=e.getAttribute("target");return n&&(!a||"_self"===a||"_top"===a&&i.top===i||a===i.name)?e:void 0}e=e.parentNode}};document.addEventListener("click",o.evaluateEvent,!0),e.exports=function(a,r){o.addListener(a,function(e){var t=e.nativeEvent;if(!t.s_fe){if(a.anchorDelay&&!s.has(t)){var n=c(t.target);n&&(t.preventDefault(),setTimeout(function(){i.location=n.href},a.anchorDelay)),s.set(t,!0)}r(e)}})},e.exports.__reset=o.__reset}},"core/src/lib/conditions/customCode.js":{name:"custom-code",displayName:"Custom Code",script:function(e){"use strict";e.exports=function(e,t){return e.source.call(t.element,t,t.target)}}},"core/src/lib/events/pageBottom.js":{name:"page-bottom",displayName:"Page Bottom",script:function(e,t,n){"use strict";var a=n("./helpers/pageLifecycleEvents");e.exports=function(e,t){a.registerPageBottomTrigger(t)}}},"core/src/lib/conditions/valueComparison.js":{name:"value-comparison",displayName:"Value Comparison",script:function(e){"use strict";var a=function(e){return"number"==typeof e&&isFinite(e)},r=function(e){return"string"==typeof e||e instanceof String},i=function(e,t){return t&&r(e)?e.toLowerCase():e},o=function(e){return a(e)?String(e):e},s=function(e){return r(e)?Number(e):e},t=function(a){return function(e,t,n){return e=o(e),t=o(t),r(e)&&r(t)&&a(e,t,n)}},n=function(n){return function(e,t){return e=s(e),t=s(t),a(e)&&a(t)&&n(e,t)}},c=function(a){return function(e,t,n){return a(i(e,n),i(t,n))}},l={equals:c(function(e,t){return e==t}),doesNotEqual:function(){return!l.equals.apply(null,arguments)},contains:t(c(function(e,t){return-1!==e.indexOf(t)})),doesNotContain:function(){return!l.contains.apply(null,arguments)},startsWith:t(c(function(e,t){return 0===e.indexOf(t)})),doesNotStartWith:function(){return!l.startsWith.apply(null,arguments)},endsWith:t(c(function(e,t){return e.substring(e.length-t.length,e.length)===t})),doesNotEndWith:function(){return!l.endsWith.apply(null,arguments)},matchesRegex:t(function(e,t,n){return new RegExp(t,n?"i":"").test(e)}),doesNotMatchRegex:function(){return!l.matchesRegex.apply(null,arguments)},lessThan:n(function(e,t){return e<t}),lessThanOrEqual:n(function(e,t){return e<=t}),greaterThan:n(function(e,t){return t<e}),greaterThanOrEqual:n(function(e,t){return t<=e}),isTrue:function(e){return!0===e},isTruthy:function(e){return Boolean(e)},isFalse:function(e){return!1===e},isFalsy:function(e){return!e}};e.exports=function(e){return l[e.comparison.operator](e.leftOperand,e.rightOperand,Boolean(e.comparison.caseInsensitive))}}},"core/src/lib/conditions/pathAndQuerystring.js":{name:"path-and-querystring",displayName:"Path And Query String",script:function(e,t,n){"use strict";var a=n("@adobe/reactor-document"),r=n("../helpers/textMatch");e.exports=function(e){var n=a.location.pathname+a.location.search;return e.paths.some(function(e){var t=e.valueIsRegex?new RegExp(e.value,"i"):e.value;return r(n,t)})}}},"core/src/lib/events/libraryLoaded.js":{name:"library-loaded",displayName:"Library Loaded (Page Top)",script:function(e,t,n){"use strict";var a=n("./helpers/pageLifecycleEvents");e.exports=function(e,t){a.registerLibraryLoadedTrigger(t)}}},"core/src/lib/conditions/path.js":{name:"path",displayName:"Path Without Query String",script:function(e,t,n){"use strict";var a=n("@adobe/reactor-document"),r=n("../helpers/textMatch");e.exports=function(e){var n=a.location.pathname;return e.paths.some(function(e){var t=e.valueIsRegex?new RegExp(e.value,"i"):e.value;return r(n,t)})}}},"core/src/lib/events/domReady.js":{name:"dom-ready",displayName:"DOM Ready",script:function(e,t,n){"use strict";var a=n("./helpers/pageLifecycleEvents");e.exports=function(e,t){a.registerDomReadyTrigger(t)}}},"core/src/lib/events/windowLoaded.js":{name:"window-loaded",displayName:"Window Loaded",script:function(e,t,n){"use strict";var a=n("./helpers/pageLifecycleEvents");e.exports=function(e,t){a.registerWindowLoadedTrigger(t)}}},"core/src/lib/events/submit.js":{name:"submit",displayName:"Submit",script:function(e,t,n){"use strict";var a=n("./helpers/createBubbly")();document.addEventListener("submit",a.evaluateEvent,!0),e.exports=function(e,t){a.addListener(e,t)}}},"core/src/lib/helpers/getObjectProperty.js":{script:function(e){"use strict";e.exports=function(e,t){for(var n=t.split("."),a=e,r=0,i=n.length;r<i;r++){if(null==a)return undefined;a=a[n[r]]}return a}}},"core/src/lib/actions/helpers/decorateCode.js":{script:function(e,t,n){"use strict";var a=n("./decorators/decorateGlobalJavaScriptCode"),r=n("./decorators/decorateNonGlobalJavaScriptCode"),i={javascript:function(e,t){return e.settings.global?a(e,t):r(e,t)},html:n("./decorators/decorateHtmlCode")};e.exports=function(e,t){return i[e.settings.language](e,t)}}},"core/src/lib/actions/helpers/loadCodeSequentially.js":{script:function(e,t,n){"use strict";var a=n("@adobe/reactor-promise"),r=n("./getSourceByUrl"),i=a.resolve();e.exports=function(t){var e=new a(function(n){var e=r(t);a.all([e,i]).then(function(e){var t=e[0];n(t)})});return i=e}}},"core/node_modules/postscribe/dist/postscribe.js":{script:function(n,a){!function r(e,t){"object"==typeof a&&"object"==typeof n?n.exports=t():"function"==typeof define&&define.amd?define([],t):"object"==typeof a?a.postscribe=t():e.postscribe=t()}(this,function(){return function(n){function a(e){if(r[e])return r[e].exports;var t=r[e]={exports:{},id:e,loaded:!1};return n[e].call(t.exports,t,t.exports,a),t.loaded=!0,t.exports}var r={};return a.m=n,a.c=r,a.p="",a(0)}([function(e,t,n){"use strict";function a(e){return e&&e.__esModule?e:{"default":e}}var r=a(n(1));e.exports=r["default"]},function(e,t,n){"use strict";function a(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t["default"]=e,t}function r(e){return e&&e.__esModule?e:{"default":e}}function l(){}function d(){var e=c.shift();if(e){var t=o.last(e);t.afterDequeue(),e.stream=i.apply(undefined,e),
t.afterStreamStart()}}function i(e,t,a){function r(e){e=a.beforeWrite(e),m.write(e),a.afterWrite(e)}(m=new g["default"](e,a)).id=f++,m.name=a.name||m.id,u.streams[m.name]=m;var n=e.ownerDocument,i={close:n.close,open:n.open,write:n.write,writeln:n.writeln};p(n,{close:l,open:l,write:function s(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];return r(t.join(""))},writeln:function c(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];return r(t.join("")+"\n")}});var o=m.win.onerror||l;return m.win.onerror=function(e,t,n){a.error({msg:e+" - "+t+": "+n}),o.apply(m.win,[e,t,n])},m.write(t,function(){p(n,i),m.win.onerror=o,a.done(),m=null,d()}),m}function u(e,t,n){if(o.isFunction(n))n={done:n};else if("clear"===n)return c=[],m=null,void(f=0);n=o.defaults(n,s);var a=[e=/^#/.test(e)?window.document.getElementById(e.substr(1)):e.jquery?e[0]:e,t,n];return e.postscribe={cancel:function r(){a.stream?a.stream.abort():a[1]=l}},n.beforeEnqueue(a),c.push(a),m||d(),e.postscribe}t.__esModule=!0;var p=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e};t["default"]=u;var g=r(n(2)),o=a(n(4)),s={afterAsync:l,afterDequeue:l,afterStreamStart:l,afterWrite:l,autoFix:!0,beforeEnqueue:l,beforeWriteToken:function h(e){return e},beforeWrite:function b(e){return e},done:l,error:function v(e){throw new Error(e.msg)},releaseAsync:!1},f=0,c=[],m=null;p(u,{streams:{},queue:c,WriteStream:g["default"]})},function(e,t,n){"use strict";function a(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t["default"]=e,t}function r(e){return e&&e.__esModule?e:{"default":e}}function y(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function w(e,t){var n=T+t,a=e.getAttribute(n);return j.existy(a)?String(a):a}function _(e,t,n){var a=2<arguments.length&&n!==undefined?arguments[2]:null,r=T+t;j.existy(a)&&""!==a?e.setAttribute(r,a):e.removeAttribute(r)}t.__esModule=!0;var P=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e},k=r(n(3)),j=a(n(4)),C=!1,T="data-ps-",V="ps-style",D="ps-script",i=function(){function a(e,t){var n=1<arguments.length&&t!==undefined?arguments[1]:{};y(this,a),this.root=e,this.options=n,this.doc=e.ownerDocument,this.win=this.doc.defaultView||this.doc.parentWindow,this.parser=new k["default"]("",{autoFix:n.autoFix}),this.actuals=[e],this.proxyHistory="",this.proxyRoot=this.doc.createElement(e.nodeName),this.scriptStack=[],this.writeQueue=[],_(this.proxyRoot,"proxyof",0)}return a.prototype.write=function n(){var e;for((e=this.writeQueue).push.apply(e,arguments);!this.deferredRemote&&this.writeQueue.length;){var t=this.writeQueue.shift();j.isFunction(t)?this._callFunction(t):this._writeImpl(t)}},a.prototype._callFunction=function r(e){var t={type:"function",value:e.name||e.toString()};this._onScriptStart(t),e.call(this.win,this.doc),this._onScriptDone(t)},a.prototype._writeImpl=function i(e){this.parser.append(e);for(var t=void 0,n=void 0,a=void 0,r=[];(t=this.parser.readToken())&&!(n=j.isScript(t))&&!(a=j.isStyle(t));)(t=this.options.beforeWriteToken(t))&&r.push(t);0<r.length&&this._writeStaticTokens(r),n&&this._handleScriptToken(t),a&&this._handleStyleToken(t)},a.prototype._writeStaticTokens=function o(e){var t=this._buildChunk(e);return t.actual?(t.html=this.proxyHistory+t.actual,this.proxyHistory+=t.proxy,this.proxyRoot.innerHTML=t.html,C&&(t.proxyInnerHTML=this.proxyRoot.innerHTML),this._walkChunk(),C&&(t.actualInnerHTML=this.root.innerHTML),t):null},a.prototype._buildChunk=function d(e){for(var t=this.actuals.length,n=[],a=[],r=[],i=e.length,o=0;o<i;o++){var s=e[o],c=s.toString();if(n.push(c),s.attrs){if(!/^noscript$/i.test(s.tagName)){var l=t++;a.push(c.replace(/(\/?>)/," "+T+"id="+l+" $1")),s.attrs.id!==D&&s.attrs.id!==V&&r.push("atomicTag"===s.type?"":"<"+s.tagName+" "+T+"proxyof="+l+(s.unary?" />":">"))}}else a.push(c),r.push("endTag"===s.type?c:"")}return{tokens:e,raw:n.join(""),actual:a.join(""),proxy:r.join("")}},a.prototype._walkChunk=function s(){for(var e=void 0,t=[this.proxyRoot];j.existy(e=t.shift());){var n=1===e.nodeType;if(!n||!w(e,"proxyof")){n&&_(this.actuals[w(e,"id")]=e,"id");var a=e.parentNode&&w(e.parentNode,"proxyof");a&&this.actuals[a].appendChild(e)}t.unshift.apply(t,j.toArray(e.childNodes))}},a.prototype._handleScriptToken=function c(e){var t=this,n=this.parser.clear();n&&this.writeQueue.unshift(n),e.src=e.attrs.src||e.attrs.SRC,(e=this.options.beforeWriteToken(e))&&(e.src&&this.scriptStack.length?this.deferredRemote=e:this._onScriptStart(e),this._writeScriptToken(e,function(){t._onScriptDone(e)}))},a.prototype._handleStyleToken=function l(e){var t=this.parser.clear();t&&this.writeQueue.unshift(t),e.type=e.attrs.type||e.attrs.TYPE||"text/css",(e=this.options.beforeWriteToken(e))&&this._writeStyleToken(e),t&&this.write()},a.prototype._writeStyleToken=function u(e){var t=this._buildStyle(e);this._insertCursor(t,V),e.content&&(t.styleSheet&&!t.sheet?t.styleSheet.cssText=e.content:t.appendChild(this.doc.createTextNode(e.content)))},a.prototype._buildStyle=function t(e){var n=this.doc.createElement(e.tagName);return n.setAttribute("type",e.type),j.eachKey(e.attrs,function(e,t){n.setAttribute(e,t)}),n},a.prototype._insertCursor=function p(e,t){this._writeImpl('<span id="'+t+'"/>');var n=this.doc.getElementById(t);n&&n.parentNode.replaceChild(e,n)},a.prototype._onScriptStart=function g(e){e.outerWrites=this.writeQueue,this.writeQueue=[],this.scriptStack.unshift(e)},a.prototype._onScriptDone=function f(e){e===this.scriptStack[0]?(this.scriptStack.shift(),this.write.apply(this,e.outerWrites),!this.scriptStack.length&&this.deferredRemote&&(this._onScriptStart(this.deferredRemote),this.deferredRemote=null)):this.options.error({msg:"Bad script nesting or script finished twice"})},a.prototype._writeScriptToken=function m(e,t){var n=this._buildScript(e),a=this._shouldRelease(n),r=this.options.afterAsync;e.src&&(n.src=e.src,this._scriptLoadHandler(n,a?r:function(){t(),r()}));try{this._insertCursor(n,D),n.src&&!a||t()}catch(i){this.options.error(i),t()}},a.prototype._buildScript=function h(e){var n=this.doc.createElement(e.tagName);return j.eachKey(e.attrs,function(e,t){n.setAttribute(e,t)}),e.content&&(n.text=e.content),n},a.prototype._scriptLoadHandler=function b(t,n){function a(){t=t.onload=t.onreadystatechange=t.onerror=null}function r(){a(),null!=n&&n(),n=null}function i(e){a(),o(e),null!=n&&n(),n=null}function e(e,t){var n=e["on"+t];null!=n&&(e["_on"+t]=n)}var o=this.options.error;e(t,"load"),e(t,"error"),P(t,{onload:function s(){if(t._onload)try{t._onload.apply(this,Array.prototype.slice.call(arguments,0))}catch(e){i({msg:"onload handler failed "+e+" @ "+t.src})}r()},onerror:function c(){if(t._onerror)try{t._onerror.apply(this,Array.prototype.slice.call(arguments,0))}catch(e){return void i({msg:"onerror handler failed "+e+" @ "+t.src})}i({msg:"remote script failed "+t.src})},onreadystatechange:function l(){/^(loaded|complete)$/.test(t.readyState)&&r()}})},a.prototype._shouldRelease=function v(e){return!/^script$/i.test(e.nodeName)||!!(this.options.releaseAsync&&e.src&&e.hasAttribute("async"))},a}();t["default"]=i},function(n){!function a(e,t){n.exports=t()}(0,function(){return function(n){function a(e){if(r[e])return r[e].exports;var t=r[e]={exports:{},id:e,loaded:!1};return n[e].call(t.exports,t,t.exports,a),t.loaded=!0,t.exports}var r={};return a.m=n,a.c=r,a.p="",a(0)}([function(e,t,n){"use strict";function a(e){return e&&e.__esModule?e:{"default":e}}var r=a(n(1));e.exports=r["default"]},function(e,t,n){"use strict";function a(e){return e&&e.__esModule?e:{"default":e}}function r(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t["default"]=e,t}function d(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}t.__esModule=!0;var u=r(n(2)),p=r(n(3)),g=a(n(6)),i=n(5),f={comment:/^<!--/,endTag:/^<\//,atomicTag:/^<\s*(script|style|noscript|iframe|textarea)[\s\/>]/i,startTag:/^</,chars:/^[^<]/},o=function(){function c(e,t){var n=this,a=0<arguments.length&&e!==undefined?arguments[0]:"",r=1<arguments.length&&t!==undefined?arguments[1]:{};d(this,c),this.stream=a;var i=!1,o={};for(var s in u)u.hasOwnProperty(s)&&(r.autoFix&&(o[s+"Fix"]=!0),i=i||o[s+"Fix"]);i?(this._readToken=(0,g["default"])(this,o,function(){return n._readTokenImpl()}),this._peekToken=(0,g["default"])(this,o,function(){return n._peekTokenImpl()})):(this._readToken=this._readTokenImpl,this._peekToken=this._peekTokenImpl)}return c.prototype.append=function t(e){this.stream+=e},c.prototype.prepend=function n(e){this.stream=e+this.stream},c.prototype._readTokenImpl=function a(){var e=this._peekTokenImpl();if(e)return this.stream=this.stream.slice(e.length),e},c.prototype._peekTokenImpl=function r(){for(var e in f)if(f.hasOwnProperty(e)&&f[e].test(this.stream)){var t=p[e](this.stream);if(t)return"startTag"===t.type&&/script|style/i.test(t.tagName)?null:(t.text=this.stream.substr(0,t.length),t)}},c.prototype.peekToken=function e(){return this._peekToken()},c.prototype.readToken=function i(){return this._readToken()},c.prototype.readTokens=function o(e){for(var t=void 0;t=this.readToken();)if(e[t.type]&&!1===e[t.type](t))return},c.prototype.clear=function s(){var e=this.stream;return this.stream="",e},c.prototype.rest=function l(){return this.stream},c}();for(var s in(t["default"]=o).tokenToString=function(e){return e.toString()},o.escapeAttributes=function(e){var t={};for(var n in e)e.hasOwnProperty(n)&&(t[n]=(0,i.escapeQuotes)(e[n],null));return t},o.supports=u)u.hasOwnProperty(s)&&(o.browserHasFlaw=o.browserHasFlaw||!u[s]&&s)},function(e,t){"use strict";var n=!(t.__esModule=!0),a=!1,r=window.document.createElement("div");try{var i="<P><I></P></I>";r.innerHTML=i,t.tagSoup=n=r.innerHTML!==i}catch(o){t.tagSoup=n=!1}try{r.innerHTML="<P><i><P></P></i></P>",t.selfClose=a=2===r.childNodes.length}catch(o){t.selfClose=a=!1}r=null,t.tagSoup=n,t.selfClose=a},function(e,t,n){"use strict";function a(e){var t=e.indexOf("-->");if(0<=t)return new d.CommentToken(e.substr(4,t-1),t+3)}function r(e){var t=e.indexOf("<");return new d.CharsToken(0<=t?t:e.length)}function i(e){var o,s,c;if(-1!==e.indexOf(">")){var t=e.match(u.startTag);if(t){var n=(o={},s={},c=t[2],t[2].replace(u.attr,function(e,t,n,a,r,i){n||a||r||i?arguments[5]?(o[arguments[5]]="",s[arguments[5]]=!0):o[t]=arguments[2]||arguments[3]||arguments[4]||u.fillAttr.test(t)&&t||"":o[t]="",c=c.replace(e,"")}),{v:new d.StartTagToken(t[1],t[0].length,o,s,!!t[3],c.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,""))});if("object"===(void 0===n?"undefined":l(n)))return n.v}}}function o(e){var t=i(e);if(t){var n=e.slice(t.length);if(n.match(new RegExp("</\\s*"+t.tagName+"\\s*>","i"))){var a=n.match(new RegExp("([\\s\\S]*?)</\\s*"+t.tagName+"\\s*>","i"));if(a)return new d.AtomicTagToken(t.tagName,a[0].length+t.length,t.attrs,t.booleanAttrs,a[1])}}}function s(e){var t=e.match(u.endTag);if(t)return new d.EndTagToken(t[1],t[0].length)}t.__esModule=!0;var l="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};t.comment=a,t.chars=r,t.startTag=i,t.atomicTag=o,t.endTag=s;var d=n(4),u={startTag:/^<([\-A-Za-z0-9_]+)((?:\s+[\w\-]+(?:\s*=?\s*(?:(?:"[^"]*")|(?:'[^']*')|[^>\s]+))?)*)\s*(\/?)>/,endTag:/^<\/([\-A-Za-z0-9_]+)[^>]*>/,attr:/(?:([\-A-Za-z0-9_]+)\s*=\s*(?:(?:"((?:\\.|[^"])*)")|(?:'((?:\\.|[^'])*)')|([^>\s]+)))|(?:([\-A-Za-z0-9_]+)(\s|$)+)/g,fillAttr:/^(checked|compact|declare|defer|disabled|ismap|multiple|nohref|noresize|noshade|nowrap|readonly|selected)$/i}},function(e,t,n){"use strict";function s(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}t.__esModule=!0,t.EndTagToken=t.AtomicTagToken=t.StartTagToken=t.TagToken=t.CharsToken=t.CommentToken=t.Token=undefined;var c=n(5),a=t.Token=function a(e,t){s(this,a),this.type=e,this.length=t,this.text=""},r=(t.CommentToken=function(){function n(e,t){s(this,n),this.type="comment",this.length=t||(e?e.length:0),this.text="",this.content=e}return n.prototype.toString=function e(){return"<!--"+this.content},n}(),t.CharsToken=function(){function t(e){s(this,t),this.type="chars",this.length=e,this.text=""}return t.prototype.toString=function e(){return this.text},t}(),t.TagToken=function(){function i(e,t,n,a,r){s(this,i),this.type=e,this.length=n,this.text="",this.tagName=t,this.attrs=a,this.booleanAttrs=r,this.unary=!1,this.html5Unary=!1}return i.formatTag=function o(e,t){var n=1<arguments.length&&t!==undefined?arguments[1]:null,a="<"+e.tagName;for(var r in e.attrs)if(e.attrs.hasOwnProperty(r)){a+=" "+r;var i=e.attrs[r];"undefined"!=typeof e.booleanAttrs&&"undefined"!=typeof e.booleanAttrs[r]||(a+='="'+(0,c.escapeQuotes)(i)+'"')}return e.rest&&(a+=" "+e.rest),e.unary&&!e.html5Unary?a+="/>":a+=">",n!==undefined&&null!==n&&(a+=n+"</"+e.tagName+">"),a},i}());t.StartTagToken=function(){function o(e,t,n,a,r,i){s(this,o),this.type="startTag",this.length=t,this.text="",this.tagName=e,this.attrs=n,this.booleanAttrs=a,this.html5Unary=!1,this.unary=r,this.rest=i}return o.prototype.toString=function e(){return r.formatTag(this)},o}(),t.AtomicTagToken=function(){function i(e,t,n,a,r){s(this,i),this.type="atomicTag",this.length=t,this.text="",this.tagName=e,this.attrs=n,this.booleanAttrs=a,this.unary=!1,this.html5Unary=!1,this.content=r}return i.prototype.toString=function e(){return r.formatTag(this,this.content)},i}(),t.EndTagToken=function(){function n(e,t){s(this,n),this.type="endTag",this.length=t,this.text="",this.tagName=e}return n.prototype.toString=function e(){return"</"+this.tagName+">"},n}()},function(e,t){"use strict";function n(e,t){var n=1<arguments.length&&t!==undefined?arguments[1]:"";return e?e.replace(/([^"]*)"/g,function(e,t){return/\\/.test(t)?t+'"':t+'\\"'}):n}t.__esModule=!0,t.escapeQuotes=n},function(e,t){"use strict";function l(e){return e&&"startTag"===e.type&&(e.unary=a.test(e.tagName)||e.unary,e.html5Unary=!/\/>$/.test(e.text)),e}function d(e,t){var n=e.stream,a=l(t());return e.stream=n,a}function u(e,t){var n=t.pop();e.prepend("</"+n.tagName+">")}function p(){var e=[];return e.last=function(){return this[this.length-1]},e.lastTagNameEq=function(e){var t=this.last();return t&&t.tagName&&t.tagName.toUpperCase()===e.toUpperCase()},e.containsTagName=function(e){for(var t,n=0;t=this[n];n++)if(t.tagName===e)return!0;return!1},e}function n(n,a,t){function r(){var e=d(n,t);e&&o[e.type]&&o[e.type](e)}var i=p(),o={startTag:function s(e){var t=e.tagName;"TR"===t.toUpperCase()&&i.lastTagNameEq("TABLE")?(n.prepend("<TBODY>"),r()):a.selfCloseFix&&g.test(t)&&i.containsTagName(t)?i.lastTagNameEq(t)?u(n,i):(n.prepend("</"+e.tagName+">"),r()):e.unary||i.push(e)},endTag:function c(e){i.last()?a.tagSoupFix&&!i.lastTagNameEq(e.tagName)?u(n,i):i.pop():a.tagSoupFix&&(t(),r())}};return function e(){return r(),l(t())}}t.__esModule=!0,t["default"]=n;var a=/^(AREA|BASE|BASEFONT|BR|COL|FRAME|HR|IMG|INPUT|ISINDEX|LINK|META|PARAM|EMBED)$/i,g=/^(COLGROUP|DD|DT|LI|OPTIONS|P|TD|TFOOT|TH|THEAD|TR)$/i}])})},function(e,t){"use strict";function a(e){return null!=e}function n(e){return"function"==typeof e}function r(e,t,n){var a=void 0,r=e&&e.length||0;for(a=0;a<r;a++)t.call(n,e[a],a)}function i(e,t,n){for(var a in e)e.hasOwnProperty(a)&&t.call(n,a,e[a])}function o(n,e){return n=n||{},i(e,function(e,t){a(n[e])||(n[e]=t)}),n}function s(e){try{return Array.prototype.slice.call(e)}catch(a){var t=(n=[],r(e,function(e){n.push(e)}),{v:n});if("object"===(void 0===t?"undefined":p(t)))return t.v}var n}function c(e){return e[e.length-1]}function l(e,t){return!(!e||"startTag"!==e.type&&"atomicTag"!==e.type||!("tagName"in e)||!~e.tagName.toLowerCase().indexOf(t))}function d(e){return l(e,"script")}function u(e){return l(e,"style")}t.__esModule=!0;var p="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};t.existy=a,t.isFunction=n,t.each=r,t.eachKey=i,t.defaults=o,t.toArray=s,t.last=c,t.isTag=l,t.isScript=d,t.isStyle=u}])})}},"core/src/lib/actions/helpers/unescapeHtmlCode.js":{script:function(e,t,n){"use strict";var a=n("@adobe/reactor-document").createElement("div");e.exports=function(e){return a.innerHTML=e,a.textContent||a.innerText||e}}},"core/src/lib/actions/helpers/decorators/decorateGlobalJavaScriptCode.js":{script:function(e,t,n){"use strict";var a=n("@adobe/reactor-promise");e.exports=function(e,t){return{code:"<script>\n"+t+"\n</script>",promise:a.resolve()}}}},"core/src/lib/actions/helpers/decorators/decorateNonGlobalJavaScriptCode.js":{script:function(e,t,n){"use strict";var i=n("@adobe/reactor-promise"),o=0;e.exports=function(a,e){var r="_runScript"+ ++o,t=new i(function(e,n){_satellite[r]=function(t){delete _satellite[r],new i(function(e){e(t.call(a.event.element,a.event,a.event.target,i))}).then(e,n)}});return{code:'<script>_satellite["'+r+'"](function(event, target, Promise) {\n'+e+"\n});</script>",promise:t}}}},"core/src/lib/actions/helpers/decorators/decorateHtmlCode.js":{script:function(e,t,n,a){"use strict";var r=n("@adobe/reactor-promise"),i=0,o={};window._satellite=window._satellite||{},window._satellite._onCustomCodeSuccess=function(e){var t=o[e];t&&(delete o[e],t.resolve())},window._satellite._onCustomCodeFailure=function(e){var t=o[e];t&&(delete o[e],t.reject())};var s=function(e){return-1!==e.indexOf("${reactorCallbackId}")},c=function(e,t){return e.replace(/\${reactorCallbackId}/g,t)},l=function(e){return e.settings.isExternal};e.exports=function(e,t){var n;return l(e)&&(t=a.replaceTokens(t,e.event)),s(t)?(n=new r(function(e,t){o[String(i)]={resolve:e,reject:t}}),t=c(t,i),i+=1):n=r.resolve(),{code:t,promise:n}}}},"core/src/lib/actions/helpers/getSourceByUrl.js":{script:function(e,t,n){"use strict";var a=n("@adobe/reactor-load-script"),r=n("@adobe/reactor-promise"),i={},o={},s=function(e){return o[e]||(o[e]=a(e)),o[e]};_satellite.__registerScript=function(e,t){i[e]=t},e.exports=function(t){return i[t]?r.resolve(i[t]):new r(function(e){s(t).then(function(){e(i[t])},function(){e()})})}}},"core/src/lib/events/helpers/createBubbly.js":{script:function(e,t,n){"use strict";var a=n("./weakMap"),g=n("./matchesProperties"),f=n("./matchesSelector");e.exports=function(){var u=[],p=new a,e={addListener:function(e,t){u.push({settings:e,callback:t})},evaluateEvent:function(t,e){if(u.length&&!p.has(t)){for(var n=t.target,a=!1;n;){for(var r=!1,i=!1,o=0;o<u.length;o++){var s=u[o],c=s.settings.elementSelector,l=s.settings.elementProperties;if((!1!==s.settings.bubbleFireIfChildFired||!a)&&(n===t.target||!1!==s.settings.bubbleFireIfParent)&&(n===t.target||c||l&&Object.keys(l).length)&&(!c||f(n,c))&&(!l||g(n,l))){var d={};e?Object.keys(t).forEach(function(e){d[e]=t[e]}):d.nativeEvent=t,d.element=n,d.target=t.target,!1!==s.callback(d)&&(i=!0,s.settings.bubbleStop&&(r=!0))}}if(r)break;i&&(a=!0),n=n.parentNode}p.set(t,!0)}},__reset:function(){u=[]}};return e}}},"core/src/lib/events/helpers/weakMap.js":{script:function(e,t,n){"use strict";var a=n("@adobe/reactor-window").WeakMap;if(void 0===a){var r=Object.defineProperty,i=Date.now()%1e9;(a=function(){this.name="__st"+(1e9*Math.random()>>>0)+i+++"__"}).prototype={set:function(e,t){var n=e[this.name];return n&&n[0]===e?n[1]=t:r(e,this.name,{value:[e,t],writable:!0}),this},get:function(e){var t;return(t=e[this.name])&&t[0]===e?t[1]:undefined},"delete":function(e){var t=e[this.name];return!(!t||t[0]!==e||(t[0]=t[1]=undefined,0))},has:function(e){var t=e[this.name];return!!t&&t[0]===e}}}e.exports=a}},"core/src/lib/events/helpers/matchesProperties.js":{script:function(e,t,n){"use strict";var r=n("./../../helpers/textMatch"),i=function(e,t){return"@text"===t||"innerText"===t?e.textContent||e.innerText:t in e?e[t]:e.getAttribute?e.getAttribute(t):void 0};e.exports=function(a,e){return!e||e.every(function(e){var t=i(a,e.name),n=e.valueIsRegex?new RegExp(e.value,"i"):e.value;return r(t,n)})}}},"core/src/lib/events/helpers/matchesSelector.js":{script:function(e,t,n,r){"use strict";e.exports=function(e,t){var n=e.matches||e.msMatchesSelector;if(n)try{return n.call(e,t)}catch(a){return r.logger.warn("Matching element failed. "+t+" is not a valid selector."),!1}return!1}}},"core/src/lib/helpers/textMatch.js":{script:function(e){"use strict";e.exports=function(e,t){if(null==t)throw new Error("Illegal Argument: Pattern is not present");return null!=e&&("string"==typeof t?e===t:t instanceof RegExp&&t.test(e))}}},"core/src/lib/events/helpers/pageLifecycleEvents.js":{script:function(e,t,n){"use strict";var a=n("@adobe/reactor-window"),r=n("@adobe/reactor-document"),i=-1!==a.navigator.appVersion.indexOf("MSIE 10"),o="WINDOW_LOADED",s="DOM_READY",c="PAGE_BOTTOM",l=[c,s,o],d=function(e,t){return{element:e,target:e,nativeEvent:t}},u={};l.forEach(function(e){u[e]=[]});var p=function(e,t){l.slice(0,f(e)+1).forEach(function(e){m(t,e)})},g=function(){return"complete"===r.readyState?o:"interactive"===r.readyState?i?null:s:void 0},f=function(e){return l.indexOf(e)},m=function(t,e){u[e].forEach(function(e){h(t,e)}),u[e]=[]},h=function(e,t){var n=t.trigger,a=t.syntheticEventFn;n(a?a(e):null)};a._satellite=a._satellite||{},a._satellite.pageBottom=p.bind(null,c),r.addEventListener("DOMContentLoaded",p.bind(null,s),!0),a.addEventListener("load",p.bind(null,o),!0),a.setTimeout(function(){var e=g();e&&p(e)},0),e.exports={registerLibraryLoadedTrigger:function(e){e()},registerPageBottomTrigger:function(e){u[c].push({trigger:e})},registerDomReadyTrigger:function(e){u[s].push({trigger:e,syntheticEventFn:d.bind(null,r)})},registerWindowLoadedTrigger:function(e){u[o].push({trigger:e,syntheticEventFn:d.bind(null,a)})}}}}},hostedLibFilesBaseUrl:"https://assets.adobedtm.com/extensions/EP2e2f86ba46954a2b8a2b3bb72276b9f8/"}},company:{orgId:"9A223704532965F10A490D44@AdobeOrg"},property:{name:"B&N Classic",settings:{domains:["barnesandnoble.com","bn.com"],undefinedVarsReturnEmpty:!1,ruleComponentSequencingEnabled:!1}},rules:[{id:"RL16f08f983fff4b4484483b18135af26c",name:"Internal Search: Results Product Click",events:[{modulePath:"core/src/lib/events/directCall.js",settings:{identifier:"onInternalSearchResultsProductClick"},ruleOrder:50}],conditions:[],actions:[{modulePath:"adobe-analytics/src/lib/actions/setVariables.js",settings:{trackerProperties:{events:[{name:"event73"}],channel:"%pageType%"}}},{modulePath:"adobe-analytics/src/lib/actions/sendBeacon.js",settings:{type:"link",linkName:"internal_search_productclick",linkType:"o"}}]},{id:"RLbae0a3e662c54317aaa732f7ff290cd2",name:"ShoppingBag: View",events:[{modulePath:"core/src/lib/events/directCall.js",settings:{identifier:"onShoppingBagView"},ruleOrder:50}],conditions:[],actions:[{modulePath:"adobe-analytics/src/lib/actions/setVariables.js",settings:{customSetup:{source:function(e,t){t.products=window.BNAnalytics.getCartProductsForAdobeFromDL(),_tph.adobe.appendEvents(t,["scView",window.BNAnalytics.getCartOpen(t,"s_scOpen")]);for(var n=window.r_getByPath(window,"digitalData.cart.item",[]),a=0;a<n.length;a++)!0===window.r_getByPath(n[a],"attributes.isInStorePickup")?_tph.adobe.appendEvents(t,["event159"]):_tph.adobe.appendEvents(t,["event160"])}},trackerProperties:{channel:"%pageType%",pageURL:"%pageURL%",pageName:"%pageName%"}}},{modulePath:"adobe-analytics/src/lib/actions/sendBeacon.js",settings:{type:"link",linkName:"shopping_bag_view",linkType:"o"}}]},{id:"RLbb6d298cfbde4253b95ecddf08c1cda6",name:"Page: Modal View",events:[{modulePath:"core/src/lib/events/directCall.js",settings:{identifier:"onModalView"},ruleOrder:100}],conditions:[],actions:[{modulePath:"core/src/lib/actions/customCode.js",settings:{source:"https://assets.adobedtm.com/d55bc227c346/0aaa96eebcd0/e8941ef5612d/RC8274e1a6a54c46f7856eb5ef4d9e0917-source.min.js",language:"javascript",isExternal:!0}},{modulePath:"adobe-analytics/src/lib/actions/clearVariables.js",settings:{}},{modulePath:"adobe-analytics/src/lib/actions/setVariables.js",settings:{customSetup:{source:function(e,t){var n=tp_objectpath_get(e.detail,"page.pageInfo.pageName"),a=tp_objectpath_get(e.detail,"page.pageInfo.pageType");if(a&&0===a.indexOf("stacks:")&&(t.eVar24="stacks:holiday gift guide"),a&&"buy online pickup in store"===a){var r=!1;switch(n){case"store locator:find my store":t.events=t.apl(t.events,"event136",",",1),r=!0;break;case"store locator:change my store":t.events=t.apl(t.events,"event138",",",1),r=!0}if(!0===r){var i=tp_objectpath_get(digitalData,"page.attributes.searchResults",0);t.prop65="store locator "+tp_objectpath_get(digitalData,"page.attributes.searchType").toLowerCase()+tp_objectpath_get(digitalData,"page.attributes.searchTerm").toLowerCase().replace("|","_")+"|"+(0===parseInt(i)?"zero":i)}}}},trackerProperties:{channel:"%event.detail.page.pageInfo.pageType%",pageURL:"%event.detail.page.pageInfo.destinationURL%",pageName:"%event.detail.page.pageInfo.pageName%"}}},{modulePath:"adobe-analytics/src/lib/actions/sendBeacon.js",settings:{type:"page"}}]},{id:"RLbf8b46c6c9c244e1b1ffcbbb6351c6a8",name:"Product: Quick View",events:[{modulePath:"core/src/lib/events/directCall.js",settings:{identifier:"onProductQuickView"},ruleOrder:50}],conditions:[],actions:[{modulePath:"adobe-analytics/src/lib/actions/setVariables.js",settings:{customSetup:{source:function(e,t){t.linkTrackVars=t.apl(t.linkTrackVars,"products,events,eVar61,eVar62,eVar24",",",2),_tph.adobe.appendEvents(t,["prodView","event5"]);var n=window.r_findDigitalDataEvent("productQuickView");if(n){var a=window.r_getByPath(n,"attributes.product[0]");a&&(t.products=BNAnalytics.getCurrentProductsForAdobeFromDL(a),t.eVar61=BNAnalytics.getProductRatingsAndReviews(a),t.eVar62=BNAnalytics.getProductAvailability(a),0===_satellite.getVar("pageType").indexOf("stacks:")&&(t.eVar24="stacks:holiday gift guide"),t.pageName=window.r_getByPath(n,"attributes.page.pageInfo.pageName"),t.pageType=window.r_getByPath(n,"attributes.page.pageInfo.pageType"))}}},trackerProperties:{eVars:[{name:"eVar11",type:"value",value:"%internalCampaign%"}],props:[{name:"prop37",type:"alias",value:"eVar11"}],events:[{name:"prodView"},{name:"event5"}],channel:"%pageType%",pageName:"%pageName%"}}},{modulePath:"adobe-analytics/src/lib/actions/sendBeacon.js",settings:{type:"page"}},{modulePath:"core/src/lib/actions/customCode.js",settings:{source:"https://assets.adobedtm.com/d55bc227c346/0aaa96eebcd0/e8941ef5612d/RC5842f03275bb4ea0b2c7918ef0aaf1c0-source.min.js",language:"javascript",isExternal:!0}}]},{id:"RL82f28841296c41719e511c7f4e2a6651",name:"Email Signup",events:[{modulePath:"core/src/lib/events/directCall.js",settings:{identifier:"onEmailSignup"},ruleOrder:50}],conditions:[],actions:[{modulePath:"adobe-analytics/src/lib/actions/setVariables.js",settings:{trackerProperties:{events:[{name:"event45"}],channel:"%pageType%"}}},{modulePath:"adobe-analytics/src/lib/actions/sendBeacon.js",settings:{type:"link",linkName:"email_signup",linkType:"o"}}]},{id:"RL12081bed48214964b47fc1101037e671",name:"ShoppingBag: Coupon Code Applied",events:[{modulePath:"core/src/lib/events/directCall.js",settings:{identifier:"onShoppingBagCouponCodeApplied"},ruleOrder:50}],conditions:[],actions:[]},{id:"RLfb06a9b12a4943979cbec2d81313689f",name:"Product: Pick Up In Store",events:[{modulePath:"core/src/lib/events/directCall.js",settings:{identifier:"onAvailableForPickUpInStoreClick"},ruleOrder:50}],conditions:[],actions:[{modulePath:"adobe-analytics/src/lib/actions/setVariables.js",settings:{trackerProperties:{events:[{name:"event15"}],channel:"%pageType%"}}},{modulePath:"adobe-analytics/src/lib/actions/sendBeacon.js",settings:{type:"link",linkName:"pick_up_in_store",linkType:"o"}}]},{id:"RL4247c7ee163642f3ab88e031b11480ee",name:"Footer: Find a Store Click",events:[{modulePath:"core/src/lib/events/click.js",settings:{elementSelector:"footer .text-input--location",bubbleFireIfParent:!0,bubbleFireIfChildFired:!0},ruleOrder:50}],conditions:[{modulePath:"core/src/lib/conditions/customCode.js",settings:{source:function(){return!0}}}],actions:[{modulePath:"core/src/lib/actions/customCode.js",settings:{source:"https://assets.adobedtm.com/d55bc227c346/0aaa96eebcd0/e8941ef5612d/RC94d92419f8404ab5b80d91ddcd47e58d-source.min.js",language:"javascript",isExternal:!0}}]},{id:"RLc659b629e0da4c4dbf36b7df3c7ed60d",name:"WishList: Add Item",events:[{modulePath:"core/src/lib/events/directCall.js",settings:{identifier:"onAddItemToWishList"},ruleOrder:50}],conditions:[],actions:[{modulePath:"adobe-analytics/src/lib/actions/setVariables.js",settings:{trackerProperties:{events:[{name:"event18"}],channel:"%pageType%"}}},{modulePath:"adobe-analytics/src/lib/actions/sendBeacon.js",settings:{type:"link",linkName:"add_to_wishlist",linkType:"o"}}]},{id:"RL9ac86702668341848ec84a98439f0fdc",name:"Product: Find In Store",events:[{modulePath:"core/src/lib/events/directCall.js",settings:{identifier:"onFindInStoreClick"},ruleOrder:50}],conditions:[],actions:[{modulePath:"adobe-analytics/src/lib/actions/setVariables.js",settings:{trackerProperties:{events:[{name:"event16"}],channel:"%pageType%"}}},{modulePath:"adobe-analytics/src/lib/actions/sendBeacon.js",settings:{type:"link",linkName:"find_in_store",linkType:"o"}}]},{id:"RL88a1d69c543f484c87a12acc72dd3b81",name:"ShoppingBag: Page View",events:[{modulePath:"core/src/lib/events/directCall.js",settings:{identifier:"onShoppingBagPageView"},ruleOrder:50}],conditions:[],actions:[{modulePath:"adobe-analytics/src/lib/actions/setVariables.js",settings:{customSetup:{source:function(e,t){_tph.adobe.appendEvents(t,["scView",window.BNAnalytics.getCartOpen(t,"s_scOpen")])}},trackerProperties:{channel:"%pageType%"}}},{modulePath:"adobe-analytics/src/lib/actions/sendBeacon.js",settings:{type:"page"}}]},{id:"RL3b87fdc04eaa4462b19be0cd37bd818e",name:"Account: Create Failed",events:[{modulePath:"core/src/lib/events/directCall.js",settings:{identifier:"onCreateAccountFailed"},ruleOrder:50}],conditions:[],actions:[{modulePath:"adobe-analytics/src/lib/actions/setVariables.js",settings:{trackerProperties:{events:[{name:"event46"}],channel:"%pageType%"}}},{modulePath:"adobe-analytics/src/lib/actions/sendBeacon.js",settings:{type:"link",linkName:"account_create_failed",linkType:"o"}}]},{id:"RLfce9a09b37be4c33ba7618d6f1c1b6a8",name:"Page: Product Detail",events:[{modulePath:"core/src/lib/events/pageBottom.js",settings:{},ruleOrder:1},{modulePath:"core/src/lib/events/directCall.js",settings:{identifier:"onPageView"},ruleOrder:50}],conditions:[{modulePath:"core/src/lib/conditions/valueComparison.js",settings:{comparison:{operator:"equals",caseInsensitive:!0},leftOperand:"%pageType%",rightOperand:"pdp"}},{modulePath:"core/src/lib/conditions/pathAndQuerystring.js",settings:{paths:[{value:"^/w/",valueIsRegex:!0}]}},{modulePath:"core/src/lib/conditions/valueComparison.js",settings:{comparison:{operator:"isTruthy"},leftOperand:"%sku%"}}],actions:[{modulePath:"adobe-analytics/src/lib/actions/setVariables.js",settings:{customSetup:{source:function(e,t){t.linkTrackVars=t.apl(t.linkTrackVars,"events,eVar39,prop66,eVar31,eVar15",",",1),t.products=BNAnalytics.getProductsForAdobe(_satellite.getVar("productPrice")),_satellite.getVar("bookGraphProductSku")&&_tph.adobe.appendEvents(t,["event57"]),_tph.adobe.setVariables(t,{eVar31:_satellite.getVar("pickUpInStoreStatus")})}},trackerProperties:{eVars:[{name:"eVar11",type:"value",value:"%internalCampaign%"},{name:"eVar15",type:"value",value:"%req_eVar15%"},{name:"eVar31",type:"value",value:"%pickUpInStoreStatus%"},{name:"eVar61",type:"value",value:"%productRatingReviews%"},{name:"eVar62",type:"value",value:"%productAvailability%"}],props:[{name:"prop15",type:"alias",value:"eVar15"},{name:"prop37",type:"alias",value:"eVar11"},{name:"prop66",type:"value",value:"%userStoreID%"}],events:[{name:"prodView"},{name:"event6"}]}}},{modulePath:"core/src/lib/actions/customCode.js",settings:{
source:'// <img src="http://email.bn.com/C/<harmonyconversioneventId>?hEventName=Conversion&hQuantity=<usersupplied>&hAmount=<usersupplied>&hOrderId=<usersupplied>&hCustomerTransactionId=<usersupplied>&hCategory=<usersupplied>&hDateTime=<usersupplied>&hSubcategory=<usersupplied>" height="1" width="1"> \n// Only if the customer has the cookie, otherwise, 500 Error\nif (window.s_c_r(\'hConversionEventId\').length > 0) {\n    window.r_injectImage(\'//mail.barnesandnoble.com/C?hEventName=Conversion\', null, null, 100);\n}',language:"javascript"}},{modulePath:"core/src/lib/actions/customCode.js",settings:{source:"<!--\n# Step 2 - Location marker for the Power Pages (inline content)\n# Place the following DIV tag where you expect the Power Page content to show\n\n# Sample Link\nhttps://www.barnesandnoble.com/w/toys-games-lego-harry-potter-hogwarts-great-hall-75954/32910096?adobe_staging=true\n-->\n<script>\n  // Looks like sometimes these sections aren't available.\n  // So i'm walking my way from bottom to top\n  var wc_injected = false;\n\n  // Reviews\n  /*\n  if (wc_injected === false && $('#reviews').length > 0) {\n      $('<div id=\"wc-power-page\"></div>').insertAfter('#reviews');\n      wc_injected = true;\n  }*/\n\n  // Product Details (Desktop & Mobile)\nif (wc_injected === false && $('#pdp-tabs,#reviews,#recentlyViewed,.pdp_Description').length > 0) {\n    if (BNAnalytics.IsMobile == true) {\n        $('#pdp-tabs,#reviews,#recentlyViewed,.pdp_Description').first().before('<div id=\"wc-power-page\"></div>');\n    } else {\n        $('#pdp-tabs,#reviews,#recentlyViewed,.pdp_Description').first().after('<div id=\"wc-power-page\"></div>');\n    }\n    //$('<div id=\"wc-power-page\"></div>').insertAfter('#pdp-tabs,.pdp_Description:first-child');\n    wc_injected = true;\n} else {\n    r_dtm_warn('WebCollage: Unable to locate element for attachment.');\n}\n\n  // Recommendations\n  /*\n  if (wc_injected === false && $('#recommendations').length > 0) {\n      $('<div id=\"wc-power-page\"></div>').insertAfter('#recommendations');\n      wc_injected = true;\n  }\n  */\n</script>\n\n<!--\n# Step 1  - Load Webcollage API\n# Place this at the head of your product pages.\n-->\n<script src=\"https://scontent.webcollage.net/api/v2/product-content\"></script>\n\n<!--\n# Step 3 - Loading the Webcollage content\n# Replace PRODUCT_ID with the relevant product SKU, as provided in the feed. For example: '32910096'.\n-->\n<script>\nif (wc_injected == true) {\n    // load Mosaic contnet\n    Webcollage.loadProductContent('barnesandnoble', _satellite.getVar('sku'), {\n        \"mosaic-board\": {\n            containerSelector: \"div#prodImage\"\n        }\n    });\n\n    // load Power Page contnet\n    Webcollage.loadProductContent('barnesandnoble', _satellite.getVar('sku'), {\n        \"power-page\": {\n            autoPlayAndStop: true\n        }\n    });\n}\n</script>",language:"html"}}]},{id:"RL89cad5416cfc4e45b79ce05d1544f80d",name:"Page: Head: Desktop",events:[{modulePath:"core/src/lib/events/libraryLoaded.js",settings:{},ruleOrder:50}],conditions:[{modulePath:"core/src/lib/conditions/valueComparison.js",settings:{comparison:{operator:"isFalsy"},leftOperand:"%isMobile%"}},{modulePath:"core/src/lib/conditions/valueComparison.js",settings:{comparison:{operator:"isFalsy"},leftOperand:"%isResponsive%"}}],actions:[{modulePath:"core/src/lib/actions/customCode.js",settings:{source:"// Performance Team requested we prefetch and preconnect before loading these guys\n//------------------------------------------------------------------------------------->\nvar opt_prefetch = document.createElement('link');\nopt_prefetch.rel = 'prefetch';\nopt_prefetch.href = '//cdn.optimizely.com/js/11189840458.js';\ndocument.head.appendChild(opt_prefetch);\n\nvar opt_preconnect = document.createElement('link');\nopt_preconnect.rel = 'preconnect';\nopt_preconnect.href = '//logx.optimizely.com';\ndocument.head.appendChild(opt_preconnect);\n\nvar opt_script = document.createElement('script');\nopt_script.src = '//cdn.optimizely.com/js/11189840458.js';\ndocument.head.appendChild(opt_script);",language:"javascript"}}]},{id:"RLfeca5847ac1b4e6bb903a0810d00d6ed",name:"Stacks ViewMode Click",events:[{modulePath:"core/src/lib/events/directCall.js",settings:{identifier:"onStacksViewModeClick"},ruleOrder:50}],conditions:[],actions:[{modulePath:"adobe-analytics/src/lib/actions/setVariables.js",settings:{customSetup:{source:function(e,t){t.pageName=_satellite.getVar("pageName");var n=r_findDigitalDataEvent("stacksViewModeClick");n&&("list"===r_getByPath(n,"attributes.mode","cover")?_tph.adobe.appendEvents(t,["event89"]):_tph.adobe.appendEvents(t,["event88"]),t.pageName=window.r_getByPath(n,"attributes.page.pageInfo.pageName"),t.channel=window.r_getByPath(n,"attributes.page.pageInfo.pageType"))}},trackerProperties:{channel:"%pageType%",pageName:"%pageName%"}}},{modulePath:"adobe-analytics/src/lib/actions/sendBeacon.js",settings:{type:"page"}}]},{id:"RL79fa924409524df18f06be9d8ac9c0c9",name:"Page: Product List",events:[{modulePath:"core/src/lib/events/directCall.js",settings:{identifier:"onPageView"},ruleOrder:50},{modulePath:"core/src/lib/events/pageBottom.js",settings:{},ruleOrder:1}],conditions:[{modulePath:"core/src/lib/conditions/path.js",settings:{paths:[{value:"^/b/",valueIsRegex:!0}]}}],actions:[{modulePath:"adobe-analytics/src/lib/actions/setVariables.js",settings:{customSetup:{source:function(e,t){_satellite.getVar("productListFilterValue")&&(_tph.adobe.appendEvents(t,["event2"]),_tph.adobe.setVariables(t,{eVar16:_satellite.getVar("productListFilterValue")})),_satellite.getVar("productListSortValue")&&(_tph.adobe.appendEvents(t,["event3"]),_tph.adobe.setVariables(t,{eVar17:_satellite.getVar("productListSortValue")}))}},trackerProperties:{events:[{name:"event1"}]}}}]},{id:"RLa662902670624279b9b3dfce21a84a30",name:"Product: Reserve In Store",events:[{modulePath:"core/src/lib/events/directCall.js",settings:{identifier:"onReserveInStore"},ruleOrder:50}],conditions:[],actions:[{modulePath:"adobe-analytics/src/lib/actions/setVariables.js",settings:{customSetup:{source:function(e,t){var n=window.r_findDigitalDataEvent("reserveInStore");n&&_tph.adobe.appendEvents(t,[{event63:r_getByPath(n,"attributes.revenue")},{event64:r_getByPath(n,"attributes.quantity")}])}},trackerProperties:{channel:"%pageType%"}}},{modulePath:"adobe-analytics/src/lib/actions/sendBeacon.js",settings:{type:"link",linkName:"reserve_in_store",linkType:"o"}}]},{id:"RLcdfa627bb8094d4ca7059a0d11872c2b",name:"Page: Sign In",events:[{modulePath:"core/src/lib/events/pageBottom.js",settings:{},ruleOrder:50}],conditions:[{modulePath:"core/src/lib/conditions/path.js",settings:{paths:[{value:"^/account/login-frame.jsp",valueIsRegex:!0}]}}],actions:[{modulePath:"adobe-analytics/src/lib/actions/setVariables.js",settings:{trackerProperties:{events:[{name:"event41"}]}}}]},{id:"RLa52e923bf6c74e9ea2b2b8e492368c69",name:"Account: Sign In Failed",events:[{modulePath:"core/src/lib/events/directCall.js",settings:{identifier:"onSigninFailed"},ruleOrder:50}],conditions:[],actions:[{modulePath:"adobe-analytics/src/lib/actions/setVariables.js",settings:{customSetup:{source:function(){}},trackerProperties:{events:[{name:"event42"}],channel:"%pageType%"}}},{modulePath:"adobe-analytics/src/lib/actions/sendBeacon.js",settings:{type:"link",linkName:"sign_in_failed",linkType:"o"}}]},{id:"RL3864822b0d98494dab7bf93240dd6b8b",name:"Internal Search: Results View",events:[{modulePath:"core/src/lib/events/directCall.js",settings:{identifier:"onInternalSearch"},ruleOrder:50}],conditions:[],actions:[{modulePath:"adobe-analytics/src/lib/actions/setVariables.js",settings:{customSetup:{source:function(e,t){var n=window.r_findDigitalDataEvent("internalSearch");n&&_tph.adobe.setVariables(t,{eVar50:window.r_getByPath(n,"attributes.storeFront")});var a=_satellite.getVar("internalSearchResultsCount");!a||"0"!==a&&"zero"!==a||(_tph.adobe.setVariables(t,{prop22:"zero"}),_tph.adobe.appendEvents(t,["event50"]));var r=_satellite.getVar("internalSearchType");r&&"typeahead"===r&&_tph.adobe.appendEvents(t,["event13"]);for(var i=r_getByPath(window,"digitalData.product",[]),o=0;o<i.length;o++)if(1==r_getByPath(i[o],"attributes.isSearchAugmented",!1)){_tph.adobe.appendEvents(t,["event74"]);break}_satellite.getVar("internalSearchTerm").length<=0&&(t.abort=!0)}},trackerProperties:{eVars:[{name:"eVar21",type:"value",value:"%internalSearchTermAndMethod%"},{name:"eVar22",type:"value",value:"%internalSearchResultsCount%"},{name:"eVar23",type:"value",value:"%internalSearchTermsCorrections%"},{name:"eVar64",type:"value",value:"%internalSearchType%"}],props:[{name:"prop21",type:"alias",value:"eVar21"},{name:"prop22",type:"alias",value:"eVar22"},{name:"prop23",type:"alias",value:"eVar23"},{name:"prop64",type:"alias",value:"eVar64"}],events:[{name:"event49"}],channel:"%pageType%"}}},{modulePath:"adobe-analytics/src/lib/actions/sendBeacon.js",settings:{type:"link",linkName:"internal_search",linkType:"o"}},{modulePath:"core/src/lib/actions/customCode.js",settings:{source:"https://assets.adobedtm.com/d55bc227c346/0aaa96eebcd0/e8941ef5612d/RC21c76177e00b41d3a6a2f6759bb4e778-source.min.js",language:"javascript",isExternal:!0}}]},{id:"RL000925779adc45a8a70163c2274e018f",name:"Element: Social Share - Click",events:[{modulePath:"core/src/lib/events/click.js",settings:{elementSelector:".bn-share-link,.social a",bubbleFireIfParent:!0,bubbleFireIfChildFired:!0},ruleOrder:50}],conditions:[],actions:[{modulePath:"adobe-analytics/src/lib/actions/setVariables.js",settings:{customSetup:{source:function(){}},trackerProperties:{events:[{name:"event67"}],channel:"%pageType%"}}},{modulePath:"adobe-analytics/src/lib/actions/sendBeacon.js",settings:{type:"link",linkName:"SocialShareIcon",linkType:"o"}}]},{id:"RLdab3523fa1be44d3b72f8ad78c42a080",name:"Page: Blog - Reviews - Readouts - ALL",events:[{modulePath:"core/src/lib/events/domReady.js",settings:{},ruleOrder:50}],conditions:[{modulePath:"core/src/lib/conditions/path.js",settings:{paths:[{value:"^/readouts/*",valueIsRegex:!0},{value:"^/review/*",valueIsRegex:!0},{value:"^/blog/*",valueIsRegex:!0}]}}],actions:[{modulePath:"core/src/lib/actions/customCode.js",settings:{source:"https://assets.adobedtm.com/d55bc227c346/0aaa96eebcd0/e8941ef5612d/RC485fe16ac0b74ee88a4da2d86621a683-source.min.js",language:"javascript",isExternal:!0}}]},{id:"RLf310b2c3d5db4c8a8bb1128fdf4577a8",name:"BookGraph: Go Back Click",events:[{modulePath:"core/src/lib/events/directCall.js",settings:{identifier:"onBookGraphGoBackClick"},ruleOrder:50}],conditions:[],actions:[{modulePath:"adobe-analytics/src/lib/actions/setVariables.js",settings:{trackerProperties:{events:[{name:"event55"}]}}},{modulePath:"adobe-analytics/src/lib/actions/sendBeacon.js",settings:{type:"link",linkName:"bookgraph_goback_click",linkType:"o"}}]},{id:"RL3e4baddeb66144b0a6f502bf4936547a",name:"BOPIS: GEO Detection Success",events:[{modulePath:"core/src/lib/events/directCall.js",settings:{identifier:"onBopisGeoDetectionSuccess"},ruleOrder:50}],conditions:[],actions:[{modulePath:"adobe-analytics/src/lib/actions/setVariables.js",settings:{trackerProperties:{events:[{name:"event134"}]}}},{modulePath:"adobe-analytics/src/lib/actions/sendBeacon.js",settings:{type:"link",linkName:"bopis_geo_detection_success",linkType:"o"}}]},{id:"RLa776b5696faf4696b0d1d99a16517398",name:"Product: Write a Review Click",events:[{modulePath:"core/src/lib/events/click.js",settings:{elementSelector:" .bv-write-review",bubbleFireIfParent:!0,bubbleFireIfChildFired:!0},ruleOrder:50}],conditions:[{modulePath:"core/src/lib/conditions/valueComparison.js",settings:{comparison:{operator:"equals"},leftOperand:"%pageType%",rightOperand:"pdp"}}],actions:[{modulePath:"core/src/lib/actions/customCode.js",settings:{source:"https://assets.adobedtm.com/d55bc227c346/0aaa96eebcd0/e8941ef5612d/RCca80e2ff18914737a18736acce3baab8-source.min.js",language:"javascript",isExternal:!0}}]},{id:"RLc886bd4766fe4f8fa7ee656fd22407a9",name:"BOPIS: Store Selected",events:[{modulePath:"core/src/lib/events/directCall.js",settings:{identifier:"onBopisStoreSelected"},ruleOrder:50}],conditions:[],actions:[{modulePath:"adobe-analytics/src/lib/actions/setVariables.js",settings:{customSetup:{source:function(e,t){_tph.adobe.appendEvents(t,["event137"]);var n=window.r_findDigitalDataEvent("bopisStoreSelected",!0,!0);n&&(t.channel=window.r_getByPath(n,"attributes.page.pageInfo.pageType",_satellite.getVar("pageType")).toLowerCase(),_tph.adobe.setVariables(t,{prop66:window.r_getByPath(n,"attributes.storeId")}))}},trackerProperties:{}}},{modulePath:"adobe-analytics/src/lib/actions/sendBeacon.js",settings:{type:"link",linkName:"bopis_store_selected",linkType:"o"}}]},{id:"RLd15cead7a11644dda9efc4267bc9a5c0",name:"Page: Virtual View: All",events:[{modulePath:"core/src/lib/events/directCall.js",settings:{identifier:"onPageView"},ruleOrder:100}],conditions:[],actions:[{modulePath:"adobe-analytics/src/lib/actions/setVariables.js",settings:{customSetup:{source:function(e,t){var n=window.r_findDigitalDataEvent("pageView");if(n||(n=window.r_findDigitalDataEvent("onPageView")),n){var a=_satellite.getVar("pageName"),r=_satellite.getVar("pageType");if(t.channel=r,t.pageName=a,t.pageURL=_satellite.getVar("pageURL"),"cart"===_satellite.getVar("pageName")&&(t.pageURL=window.location.origin+"/checkout"),0===_satellite.getVar("pageType").indexOf("stacks:")&&_tph.adobe.setVariables(t,{eVar24:"stacks:holiday gift guide"}),"buy online pickup in store"===r){var i=!1;switch(a){case"store locator:find my store":_tph.adobe.appendEvents(t,["event136"]),i=!0;break;case"store locator:change my store":_tph.adobe.appendEvents(t,["event138"]),i=!0}if(!0===i){var o=window.r_getByPath(n,"attributes.page.attributes.searchResults",0);_tph.adobe.setVariables(t,{prop65:"store locator "+window.r_getByPath(n,"attributes.page.attributes.searchType").toLowerCase()+window.r_getByPath(n,"attributes.page.attributes.searchTerm").toLowerCase().replace("|","_")+"|"+(0===parseInt(o)?"zero":o)})}}}else _tph.log("Couldn't find details about pageView OR onPageView in digitalData.event so abort...","error"),t.abort=!0}},trackerProperties:{channel:"%pageType%",pageURL:"%pageURL%",pageName:"%pageName%"}}},{modulePath:"adobe-analytics/src/lib/actions/sendBeacon.js",settings:{type:"page"}}]},{id:"RLa7f62057f7f0441b8a541d5c2b6a68b4",name:"Page: Window Loaded - All",events:[{modulePath:"core/src/lib/events/windowLoaded.js",settings:{},ruleOrder:50}],conditions:[],actions:[{modulePath:"core/src/lib/actions/customCode.js",settings:{source:"https://assets.adobedtm.com/d55bc227c346/0aaa96eebcd0/e8941ef5612d/RCeeed9114b51641af907899d440a246d6-source.min.js",language:"javascript",isExternal:!0}},{modulePath:"core/src/lib/actions/customCode.js",settings:{source:"https://assets.adobedtm.com/d55bc227c346/0aaa96eebcd0/e8941ef5612d/RC5bec591f8630459fb29ff10793549ab3-source.min.js",language:"javascript",isExternal:!0}}]},{id:"RLa910a4d235c34ae4baa7916ed83bd790",name:"Glose: Read Sample Click",events:[{modulePath:"core/src/lib/events/directCall.js",settings:{identifier:"onGloseReadSampleClick"},ruleOrder:50}],conditions:[],actions:[{modulePath:"adobe-analytics/src/lib/actions/setVariables.js",settings:{trackerProperties:{events:[{name:"event96"}]}}},{modulePath:"adobe-analytics/src/lib/actions/sendBeacon.js",settings:{type:"link",linkName:"glose_readsample_click",linkType:"o"}}]},{id:"RL47a8482edccb4834865a7b5312b37795",name:"Page: Textbooks Category",events:[{modulePath:"core/src/lib/events/windowLoaded.js",settings:{},ruleOrder:50},{modulePath:"core/src/lib/events/directCall.js",settings:{identifier:"onPageView"},ruleOrder:50}],conditions:[{modulePath:"core/src/lib/conditions/path.js",settings:{paths:[{value:"^/b/textbooks/*",valueIsRegex:!0}]}}],actions:[{modulePath:"core/src/lib/actions/customCode.js",settings:{source:"https://assets.adobedtm.com/d55bc227c346/0aaa96eebcd0/e8941ef5612d/RC5ce3dd92ad9746929bc8917df5d0282e-source.min.js",language:"javascript",isExternal:!0}}]},{id:"RLc751b8705d424b79ac6a90c2660aacce",name:"Page: Head: Mobile",events:[{modulePath:"core/src/lib/events/libraryLoaded.js",settings:{},ruleOrder:50}],conditions:[{modulePath:"core/src/lib/conditions/valueComparison.js",settings:{comparison:{operator:"isTrue"},leftOperand:"%isMobile%"}},{modulePath:"core/src/lib/conditions/valueComparison.js",settings:{comparison:{operator:"isFalse"},leftOperand:"%isResponsive%"}}],actions:[{modulePath:"core/src/lib/actions/customCode.js",settings:{global:!1,source:"// Performance Team requested we prefetch and preconnect before loading these guys\n//------------------------------------------------------------------------------------->\nvar opt_prefetch = document.createElement('link');\nopt_prefetch.rel = 'prefetch';\nopt_prefetch.href = '//cdn.optimizely.com/js/11173471738.js';\ndocument.head.appendChild(opt_prefetch);\n\nvar opt_preconnect = document.createElement('link');\nopt_preconnect.rel = 'preconnect';\nopt_preconnect.href = '//logx.optimizely.com';\ndocument.head.appendChild(opt_preconnect);\n\nvar opt_script = document.createElement('script');\nopt_script.src = '//cdn.optimizely.com/js/11173471738.js';\ndocument.head.appendChild(opt_script);",language:"javascript"}}]},{id:"RL2909a3aa277c45b49f64cc5a364fd5ec",name:"Purchase",events:[{modulePath:"core/src/lib/events/directCall.js",settings:{identifier:"onPurchase"},ruleOrder:50}],conditions:[],actions:[{modulePath:"adobe-analytics/src/lib/actions/setVariables.js",settings:{customSetup:{source:function(e,t){if(_tph.adobe.setVariables(t,{products:null,purchaseID:null,transactionID:null}),_tph.adobe.appendEvents(t,["purchase"]),window.r_getByPath(window,"digitalData.transaction.item")){var n,a,r="";for(n=0;n<digitalData.transaction.item.length;n++){var i=digitalData.transaction.item[n];a=";"+i.productInfo.sku+";"+(i.quantity||1)+";"+(i.quantity||1)*i.price.basePrice,a+=";;evar32="+window.r_getByPath(i,"attributes.deliveryMethod","missing").toLowerCase(),t.products=(t.products?t.products+",":"")+a;var o=window.r_getByPath(i,"attributes.purchaseType");o&&(r=t.apl(r,o,"|",2))}var s=_satellite.getVar("transactionCheckoutType");(s&&-1<s.indexOf("instant_")||-1<r.indexOf("instant_"))&&_tph.adobe.appendEvents(t,["event19"]);var c=(1<digitalData.transaction.item.length?"combo:":"")+r;null!=c&&_tph.adobe.setVariables(t,{eVar19:c,prop19:"D=v19"})}_tph.adobe.appendEvents(t,[{event39:_satellite.getVar("transactionTotalTax")},{event40:_satellite.getVar("transactionTotalShipping")},{event84:_satellite.getVar("transactionTotalPrice")}]),0<_satellite.getVar("transactionTotalVoucherCode").length&&(_tph.adobe.appendEvents(t,["event224"]),_tph.adobe.setVariables(t,{prop32:_satellite.getVar("transactionTotalVoucherCode")+"|"+_satellite.getVar("pageName")})),t.purchaseID=_satellite.getVar("transactionID"),t.transactionID=t.purchaseID}},trackerProperties:{zip:"%zip%",eVars:[{name:"eVar41",type:"value",value:"%transactionID%"},{name:"eVar42",type:"value",value:"%transactionAddresses%"},{name:"eVar45",type:"value",value:"%transactionCheckoutType%"},{name:"eVar46",type:"value",value:"%transactionFulfillmentShippingMethod%"},{name:"eVar48",type:"value",value:"%transactionPaymentMethod%"},{name:"eVar66",type:"value",value:"%transactionCustomerID%"}],state:"%state%",events:[{name:"event34"},{name:"purchase"}],channel:"%pageType%",pageURL:"%pageURL%",pageName:"%pageName%",transactionID:"%transactionID%"}}},{modulePath:"adobe-analytics/src/lib/actions/sendBeacon.js",settings:{type:"link",linkName:"purchase",linkType:"o"}},{modulePath:"adobe-analytics/src/lib/actions/clearVariables.js",settings:{}}]},{id:"RL9391b9f29e014135a347d442835db654",name:"Internal Search: Results Product View",events:[{modulePath:"core/src/lib/events/directCall.js",settings:{identifier:"onInternalSearchResultsQuickView"},ruleOrder:50}],conditions:[],actions:[{modulePath:"adobe-analytics/src/lib/actions/setVariables.js",settings:{trackerProperties:{events:[{name:"event78"}],channel:"%pageType%"}}},{modulePath:"adobe-analytics/src/lib/actions/sendBeacon.js",settings:{type:"link",linkName:"internal_search_productview",linkType:"o"}}]},{id:"RLe7ac1990dc8d40b6921f3717ddc7829c",name:"BOPIS: Filter Selected",events:[{modulePath:"core/src/lib/events/directCall.js",settings:{identifier:"onBopisFilterSelected"},ruleOrder:50}],conditions:[],actions:[{modulePath:"adobe-analytics/src/lib/actions/setVariables.js",settings:{trackerProperties:{events:[{name:"event156"}]}}},{modulePath:"adobe-analytics/src/lib/actions/sendBeacon.js",settings:{type:"link",linkName:"bopis_filter_selected",linkType:"o"}}]},{id:"RL1b07930b4a5642a9b86fc1e9a5227bb6",name:"Internal Search: Results Quick View",events:[{modulePath:"core/src/lib/events/directCall.js",settings:{identifier:"onInternalSearchResultsQuickView"},ruleOrder:50}],conditions:[],actions:[{modulePath:"adobe-analytics/src/lib/actions/setVariables.js",settings:{trackerProperties:{events:[{name:"event77"}],channel:"%pageType%"}}},{modulePath:"adobe-analytics/src/lib/actions/sendBeacon.js",settings:{type:"link",linkName:"internal_search_quickview",linkType:"o"}}]},{id:"RLd081bee0cab74b1f87ab02073df369fe",name:"Error",events:[{modulePath:"core/src/lib/events/directCall.js",settings:{identifier:"onError"},ruleOrder:50}],conditions:[],actions:[{modulePath:"adobe-analytics/src/lib/actions/setVariables.js",settings:{customSetup:{source:function(e,t){_tph.adobe.appendEvents(t,["event36"]);var n=window.r_findDigitalDataEvent("error");if(n){var a=window.r_getByPath(n,"attributes.errorMessage","Unspecified Error Message");_tph.adobe.setVariables(t,{eVar10:a+"|"+_satellite.getVar("pageName")+"|"+_satellite.getVar("pageType")})}}},trackerProperties:{events:[{name:"event36"}],channel:"%pageType%"}}},{modulePath:"adobe-analytics/src/lib/actions/sendBeacon.js",settings:{type:"link",linkName:"error",linkType:"o"}}]},{id:"RLbead475678fc4e2481552845825c6cf5",name:"Social Network Click",events:[{modulePath:"core/src/lib/events/directCall.js",settings:{identifier:"onSocialNetworkClick"},ruleOrder:50}],conditions:[],actions:[{modulePath:"adobe-analytics/src/lib/actions/setVariables.js",settings:{customSetup:{source:function(e,t){var n=r_findDigitalDataEvent("socialNetworkIconClick",!0,!0);if(n){var a=window.r_getByPath(n,"attributes.networkName"),r="blog"===_satellite.getVar("pageType")?"event108":"event67",i="blog"===_satellite.getVar("pageType")?"event109":"event67";switch(a.toUpperCase()){case"TWITTER":_tph.adobe.appendEvents(t,[r]);break;case"FACEBOOK":_tph.adobe.appendEvents(t,[i])}"blog"!==_satellite.getVar("pageType")&&_tph.adobe.setVariables(t,{prop25:a.toLowerCase()+"|"+_satellite.getVar("pageType")})}}},trackerProperties:{}}},{modulePath:"adobe-analytics/src/lib/actions/sendBeacon.js",settings:{type:"link",linkName:"social_icon_click",linkType:"o"}}]},{id:"RL13b53f07603d482982025753d8103ec4",name:"Account: Sign In Complete",events:[{modulePath:"core/src/lib/events/directCall.js",settings:{identifier:"onSigninComplete"},ruleOrder:50}],conditions:[],actions:[{modulePath:"adobe-analytics/src/lib/actions/setVariables.js",settings:{customSetup:{source:function(){}},trackerProperties:{events:[{name:"event47"}]}}},{modulePath:"adobe-analytics/src/lib/actions/sendBeacon.js",settings:{type:"link",linkName:"sign_in_complete",linkType:"o"}}]},{id:"RL066960686dca485d9e20defb43e95bc1",name:"BOPIS: Optional Pickup Submit",events:[{modulePath:"core/src/lib/events/directCall.js",settings:{identifier:"onBopisOptionalPickupSubmit"},ruleOrder:50}],conditions:[],actions:[{modulePath:"adobe-analytics/src/lib/actions/setVariables.js",settings:{trackerProperties:{events:[{name:"event158"}]}}},{modulePath:"adobe-analytics/src/lib/actions/sendBeacon.js",settings:{type:"link",linkName:"bopis_optional_pickup_submit",linkType:"o"}}]},{id:"RL3e73986fffee4d1d9a3404cf211e2537",name:"Page: Bottom: All",events:[{modulePath:"core/src/lib/events/pageBottom.js",settings:{},ruleOrder:50}],conditions:[],actions:[{modulePath:"core/src/lib/actions/customCode.js",settings:{source:"if(r_isStagingMode() == true || r_isDebugMode() == true){\n  console.group('Page Bottom');\n  _tph.log('pageName: ' + _satellite.getVar('pageName'));\n  _tph.log('pageType: ' + _satellite.getVar('pageType'));\n  _tph.log('destinationURL: ' + _satellite.getVar('destinationURL'));\n  _tph.log('stagingMode: ' + r_isStagingMode());\n  _tph.log('debugMode: ' + r_isDebugMode());\n  _tph.log('previousPageName: ' + _satellite.getVar('previousPageName'));\n  console.groupEnd();\n}",language:"javascript"}},{modulePath:"core/src/lib/actions/customCode.js",settings:{source:"<script type=\"text/javascript\">\n//if (r_isStagingMode() === true || location.host.indexOf('www-qa') > -1 || BNAnalytics.IsDevelopment() === true) {\nif (r_isStagingMode() === true) {\n    var msg = 'Adobe Launch';\n  \tmsg += '<br />BNAnalytics: v' + BNAnalytics.Version;\n  \n    if (typeof(s) !== 'undefined') {\n      msg += '<br />Adobe S Object: v' + s.version\n    }\n\n    msg += '<br />Reporting Suites: ' + W[_globalObjectName].getReportingSuiteIDs();\n\n    if (typeof(_satellite) !== 'undefined') {\n        msg += '<br />Build: ' + (_satellite.buildDate || _satellite.buildInfo.buildDate);\n        msg += '<br />Environment: ' + _satellite.buildInfo.environment;\n    }\n  \n    msg += '<br />Platform: ' + tp_objectpath_get(window,'digitalData.session.platformName','unspecified');\n\n    var div = document.createElement('div');\n    div.style = 'bottom:0;font-weight: bold;padding: 10px;color: #333;background-color: #ffa500; position: fixed; z-index: 10;font-size: 12px;font-family:cursive;';\n    div.innerHTML = msg;\n    div.setAttribute('class', 'adobe_state');\n    document.body.insertBefore(div, document.body.firstChild);\n}\n</script>",language:"html"}},{modulePath:"adobe-analytics/src/lib/actions/setVariables.js",settings:{trackerProperties:{}}},{modulePath:"adobe-analytics/src/lib/actions/sendBeacon.js",settings:{type:"page"}},{modulePath:"core/src/lib/actions/customCode.js",settings:{
source:"/*jshint -W107*/\n/*global _satellite,s,window,s_getP*/\n\n// Combined Edition\n// Performance Team at BN wanted to reduce the number of additional network calls, therefore,\n// I've combined them into a single rule. It makes it hard to manage, however, performance is known\n// to increase conversion.\n\n// JS: Google Remarketing Async\n// Inject script immediately on the page\n//---------------------------------------------------------------------------------------------------->\n// window.r_injectScript('//www.googleadservices.com/pagead/conversion_async.js', null, null, 10);\n\n// JS: Google Adwords Global Site Tag\n//---------------------------------------------------------------------------------------------------->\n\n//window.r_injectScript('https://www.googletagmanager.com/gtag/js?id=AW-1043630002', function () {\n/*\nwindow.r_injectScript('https://www.googletagmanager.com/gtag/js?id=DC-8990534', function () {\n\twindow.dataLayer = window.dataLayer || [];\n\twindow.gtag = function () {\n\t\twindow.dataLayer.push(arguments);\n\t}\n\twindow.gtag('js', new Date());\n\t//window.gtag('config', 'AW-1043630002');\n\t//window.gtag('config', 'AW-1008154992');\n\t//window.gtag('config', 'AW-1026181156');\n\t//window.gtag('config', 'AW-962413977');\n  //window.gtag('config', 'DC-8990534', { 'groups': 'Adlucent' }); // Adlucent (BN-453)\n  //window.gtag('config', 'DC-8979439'); // Havas Agency (BN-453)\n});\n*/\n\n/*\n// JS: Dynamic Yield\n// Playing field was leveled as these guys are going against\n// each other and we want to ensure they all have an equal chance\n// DynamicYield,Evergage & Reflektion\n//---------------------------------------------------------------------------------------------------->\nwindow.DY = (window.DY || {});\nDY.recommendationContext\xa0 = \xa0 {\n\ttype: \xa0_satellite.getVar('pageType').toUpperCase(),\n\tdata: [],\n\tlng: _satellite.getVar('language')\n};\nDY.noCookies = true;\n\n// Determine data to pass\nswitch (_satellite.getVar('pageType')) {\ncase 'home':\n\tDY.recommendationContext.type = 'HOMEPAGE';\n\tbreak;\ncase 'category':\n\tDY.recommendationContext.data = _satellite.getVar('pageCategoryBreadcrumb').split('|');\n\tbreak;\ncase 'pdp':\n\tDY.recommendationContext.type = 'PRODUCT';\n\tDY.recommendationContext.data = [_satellite.getVar('sku')];\n\tbreak;\ncase 'cart':\n\tDY.recommendationContext.data = _satellite.getVar('shoppingCartSKUs');\n\tbreak;\ndefault:\n\tDY.recommendationContext.type = 'OTHER';\n\tbreak;\n}\n\nwindow.r_injectScript('//cdn.dynamicyield.com/api/8768416/api_dynamic.js', null, false, 0, 'Dynamic Yield Dynamic.js');\nwindow.r_injectScript('//cdn.dynamicyield.com/api/8768416/api_static.js', null, false, 0, 'Dynamic Yield Static.js');\n*/\n// JS: BounceX\n// https://rawsoft.atlassian.net/browse/BN-394\n// NOTE: Temp disabled to try out Cookie Size Issue\n//---------------------------------------------------------------------------------------------------->\n// window.r_injectScript('//tag.bounceexchange.com/2982/i.js');\n\n// BazaarVoice\n/* NOT YET\nif (typeof (BV) === 'undefined') {\n\twindow.r_injectScript('https://apps.bazaarvoice.com/deployments/barnesandnoble/main_site/production/en_US/bv.js', function () {\n\t\tr_dtm_notify('BazaarVoice Loaded.');\n\t});\n}\n*/\n\n/*\n// DELETE BounceX Cookie\nif (typeof(s_c_d) !== 'undefined' && typeof(s_getCookieDomain) !== 'undefined') {\n    s_c_d('bounceClientVisit2982', 'Thu, 01 Jan 1970 00:00:01 GMT', '/', s_getCookieDomain(), true);\n  \tr_dtm_warn('BounceEx Cookie Deleted');\n}\n*/\n\n\n/*\nImplementation of Referrer Breadcrumbs\nSupport the change of referrer due to the Endemic Ads Project\n*/\nif(typeof(_tph) !== 'undefined') {\n\n    // lets first store the current referrer/href in session storage\n    _tph.lists.push('referrers', document.referrer);\n    _tph.lists.push('hrefs', document.location.href);\n  \n    // trim and save last N entries\n    _tph.lists.trimEnd('referrers', 5);\n    _tph.lists.trimEnd('hrefs', 5);\n\n    // now lets write it into the data layer\n    tp_objectpath_set(window, 'digitalData.page.pageInfo.breadCrumbsReferrers', _tph.lists.get('referrers'));\n    tp_objectpath_set(window, 'digitalData.page.pageInfo.breadCrumbsHrefs', _tph.lists.get('hrefs'));\n}\n\n// Data Layer Adjustments\n// Support for vendors that only read from data layer such as SalesforceDMP\n//---------------------------------------------------------------------------------------------------->\nvar email = _satellite.getVar('userEmail');\nif (email) {\n    window.tp_objectpath_set(window, 'digitalData.user.0.profile.0.profileInfo.emailMD5', _satellite.getVar('userHashedEmail'));\n    window.tp_objectpath_set(window, 'digitalData.user.0.profile.0.profileInfo.emailSHA256', _satellite.getVar('userHashedEmailSha256'));\n}\n\n\n// JS: Facebook\n// https://rawsoft.atlassian.net/browse/BN-394\n//---------------------------------------------------------------------------------------------------->\n/*\n<!-- Facebook Pixel Code -->\n  !function(f,b,e,v,n,t,s)\n  {if(f.fbq)return;n=f.fbq=function(){n.callMethod?\n  n.callMethod.apply(n,arguments):n.queue.push(arguments)};\n  if(!f._fbq)f._fbq=n;n.push=n;n.loaded=!0;n.version='2.0';\n  n.queue=[];t=b.createElement(e);t.async=!0;\n  t.src=v;s=b.getElementsByTagName(e)[0];\n  s.parentNode.insertBefore(t,s)}(window, document,'script',\n  'https://connect.facebook.net/en_US/fbevents.js');\n  fbq('init', '1473148549574128'); // BN\n  fbq('init', '881772185228696'); // NOOK\n\t// Do not do pageviews here as we still have the old ways of doing it\n\t// no need to change it all now since we are going to move to Launch\n  //fbq('track', 'PageView');\n<!-- End Facebook Pixel Code -->\n*/\n\n// DOMNodeInserted\n//\t-\n//\t- onPaypalButtonClick\n//\t-\n// BN-487\n//\t-- Started with the need to track PayPal button click since its an iframe on\n// \tanother domain, we can't use jQuery. So we are listening for experimental dom node inserted\n// until we find a better option. Lastly, DTM will be placed shortly with Launch with Responsive project\n// which is the reason why we are scraping in the first place\n//---------------------------------------------------------------------------------------------------->\ndocument.addEventListener(\"DOMNodeInserted\", function(e) {\n    try {\n        var $this = $(e.target);\n        if ($this.hasClass('paypal-checkout-sandbox')) {\n            _satellite.track('onPayPalCheckoutButtonClick')\n        }\n    } catch (e) {}\n}, false);\n\n\n// Internal Campaign Element Updates\n// https://rawsoft.atlassian.net/browse/BN-541\n$(function(){var e=(r_isStagingMode()||r_isDebugMode());var d={};var f=0;var b=0;var a=[];if(e===true){console.group(\"Internal Campaigns (element updates)\")}var c=function(g){if(e===true&&typeof(tp_log)!==\"undefined\"){tp_log(g)}};$(\"a[onclick]\").each(function(){f++;var l=$(this);var g=l.attr(\"onclick\");if(g&&g.indexOf(\"set_cookie(\")>-1){var k=g.replace(\"set_cookie('\",\"\").replace(\");\",\"\").split(\"_\");if(k.length>0){var j=k[0];if(j.match(/N\\d+$/)===null){d[j]=(d[j]||0)+1;var h=(j+\"N\"+d[j]);var i=g.replace((j+\"_\"),(h+\"_\"));c(g);c(j+\" -> \"+h);c(i);c(\" \");l.attr(\"onclick\",i);b++}else{a.push(g)}}}});c(\"Found \"+f+\" elements and updated \"+b+\".\");if(a.length>0){c(JSON.stringify(a))}if(e===true){console.groupEnd()}}());\n\n/* SmarterHQ */\n/* https://rawsoft.atlassian.net/browse/BN-544 */ \n(function(w, d, s, sr, c) {\n    w[sr] = w[sr] || [];\n    var f = d.getElementsByTagName(s)[0],\n        j = d.createElement(s);\n    j.async = true;\n    j.src = d.location.protocol + '//d1n00d49gkbray.cloudfront.net/js/' + c + '.js';\n    f.parentNode.insertBefore(j, f);\n})(window, document, 'script', '_smtr', 'barnesandnoble');",language:"javascript"}}]},{id:"RLca6b6776b589421da0562f690059f387",name:"Account: Create Start",events:[{modulePath:"core/src/lib/events/directCall.js",settings:{identifier:"onCreateAccountStart"},ruleOrder:50}],conditions:[],actions:[{modulePath:"adobe-analytics/src/lib/actions/setVariables.js",settings:{trackerProperties:{events:[{name:"event43"}],channel:"%pageType%"}}},{modulePath:"adobe-analytics/src/lib/actions/sendBeacon.js",settings:{type:"link",linkName:"account_create_start",linkType:"o"}}]},{id:"RL915ebb88770f4cbca1a6468f183001b1",name:"BOPIS: Store Update",events:[{modulePath:"core/src/lib/events/directCall.js",settings:{identifier:"onBopisStoreUpdate"},ruleOrder:50}],conditions:[],actions:[{modulePath:"adobe-analytics/src/lib/actions/setVariables.js",settings:{customSetup:{source:function(e,t){t.events=t.apl(t.events,"event139",",",1);var n=window.r_findDigitalDataEvent("bopisStoreUpdate",!0,!0);n&&(t.channel=window.r_getByPath(n,"attributes.page.pageInfo.pageType",_satellite.getVar("pageType")).toLowerCase(),t.prop66=window.r_getByPath(n,"attributes.storeId"))}},trackerProperties:{}}},{modulePath:"adobe-analytics/src/lib/actions/sendBeacon.js",settings:{type:"link",linkName:"bopis_store_update",linkType:"o"}}]},{id:"RL27a3b3a1c1af406482fc4bae01898394",name:"Product: Format Dropdown Click",events:[{modulePath:"core/src/lib/events/directCall.js",settings:{identifier:"onProductFormatClick"},ruleOrder:50}],conditions:[],actions:[{modulePath:"adobe-analytics/src/lib/actions/setVariables.js",settings:{trackerProperties:{props:[{name:"prop13",type:"value",value:"%DCR-productFormat%"}],events:[{name:"event21"}]}}},{modulePath:"adobe-analytics/src/lib/actions/sendBeacon.js",settings:{type:"link",linkName:"format_dropdown",linkType:"o"}}]},{id:"RLce58c444196d4f00bf0db9b5153cc5b3",name:"Product: Photo View Click",events:[{modulePath:"core/src/lib/events/directCall.js",settings:{identifier:"onProductPhotoClick"},ruleOrder:50}],conditions:[],actions:[{modulePath:"adobe-analytics/src/lib/actions/setVariables.js",settings:{trackerProperties:{props:[{name:"prop28",type:"value",value:"%DCR-productPhotoView%"}],events:[{name:"event8"}],channel:"%pageType%"}}},{modulePath:"adobe-analytics/src/lib/actions/sendBeacon.js",settings:{type:"link",linkName:"product_photo_view",linkType:"o"}}]},{id:"RL9bd1b36a0bc748e48891ad5b9b6595c4",name:"Product: Format and Editions Tab Click",events:[{modulePath:"core/src/lib/events/directCall.js",settings:{identifier:"onFormatsEditionsTabClick"},ruleOrder:50}],conditions:[],actions:[{modulePath:"adobe-analytics/src/lib/actions/setVariables.js",settings:{trackerProperties:{props:[{name:"prop18",type:"value",value:"%DCR-productFormatTab%"}],events:[{name:"event7"}],channel:"%pageType%"}}},{modulePath:"adobe-analytics/src/lib/actions/sendBeacon.js",settings:{type:"link",linkName:"formats_editions_tab_click",linkType:"o"}}]},{id:"RL60f35fe6ae734f67a3eda94bf8fb4dc3",name:"Store: Find My Store Search Click",events:[{modulePath:"core/src/lib/events/directCall.js",settings:{identifier:"onFindMyStoreSearchClick"},ruleOrder:50}],conditions:[],actions:[{modulePath:"adobe-analytics/src/lib/actions/setVariables.js",settings:{customSetup:{source:function(e,t){_tph.adobe.appendEvents(t,["event136"]);var n=window.r_findDigitalDataEvent("findMyStoreSearchClick");if(n){var a=window.r_getByPath(n,"attributes.page.attributes.searchResults",0);_tph.adobe.setVariables(t,{prop65:"store locator "+window.r_getByPath(n,"attributes.page.attributes.searchType").toLowerCase()+" "+window.r_getByPath(n,"attributes.page.attributes.searchTerm").toLowerCase().replace("|","_")+"|"+(0===parseInt(a)?"zero":a)})}}},trackerProperties:{channel:"%pageType%"}}},{modulePath:"adobe-analytics/src/lib/actions/sendBeacon.js",settings:{type:"link",linkName:"find_my_store_search_click",linkType:"o"}}]},{id:"RL2b565ac9408d4042b687a8556dfd278b",name:"BookGraph: View",events:[{modulePath:"core/src/lib/events/directCall.js",settings:{identifier:"onBookGraphView"},ruleOrder:50}],conditions:[],actions:[{modulePath:"adobe-analytics/src/lib/actions/setVariables.js",settings:{trackerProperties:{events:[{name:"event53"}]}}},{modulePath:"adobe-analytics/src/lib/actions/sendBeacon.js",settings:{type:"link",linkName:"book_graph_view",linkType:"o"}}]},{id:"RLe37535c4516c47eeb0d58d52aa95a2fe",name:"Stacks NavList Item Click",events:[{modulePath:"core/src/lib/events/directCall.js",settings:{identifier:"onStacksNavListItemClick"},ruleOrder:50}],conditions:[],actions:[{modulePath:"adobe-analytics/src/lib/actions/setVariables.js",settings:{customSetup:{source:function(e,t){t.pageName=_satellite.getVar("pageName"),t.channel=_satellite.getVar("pageType")}},trackerProperties:{events:[{name:"event85"}],channel:"%pageType%"}}},{modulePath:"adobe-analytics/src/lib/actions/sendBeacon.js",settings:{type:"link",linkName:"stacks_nav_listitem_click",linkType:"o"}}]},{id:"RL009a8ce65fba43c5914d8af781264eca",name:"Page: Product Detail - Toys",events:[{modulePath:"core/src/lib/events/directCall.js",settings:{identifier:"onPageView"},ruleOrder:50},{modulePath:"core/src/lib/events/pageBottom.js",settings:{},ruleOrder:1}],conditions:[{modulePath:"core/src/lib/conditions/valueComparison.js",settings:{comparison:{operator:"equals",caseInsensitive:!0},leftOperand:"%pageType%",rightOperand:"pdp"}},{modulePath:"core/src/lib/conditions/valueComparison.js",settings:{comparison:{operator:"equals",caseInsensitive:!0},leftOperand:"%productPrimaryCategory%",rightOperand:"Toys"}}],actions:[{modulePath:"core/src/lib/actions/customCode.js",settings:{source:"<!--\n# Step 2 - Location marker for the Power Pages (inline content)\n# Place the following DIV tag where you expect the Power Page content to show\n\n# Sample Link\nhttps://www.barnesandnoble.com/w/toys-games-lego-harry-potter-hogwarts-great-hall-75954/32910096?adobe_staging=true\n-->\n<script>  \n  console.group('WebCollage (pdp) (toys)');\n\n  // Looks like sometimes these sections aren't available.\n  // So i'm walking my way from bottom to top\n  var wc_injected = false;\n\n  // Reviews\n  /*\n  if (wc_injected === false && $('#reviews').length > 0) {\n      $('<div id=\"wc-power-page\"></div>').insertAfter('#reviews');\n      wc_injected = true;\n  }*/\n\n  // Product Details (Desktop & Mobile)\n  if (wc_injected === false && $('#pdp-tabs,#reviews,#recentlyViewed,.pdp_Description').length > 0) {\n      if (BNAnalytics.IsMobile === true) {\n          $('#pdp-tabs,#reviews,#recentlyViewed,.pdp_Description').first().before('<div id=\"wc-power-page\"></div>');\n      } else {\n          // Desktop or Responsive\n          $('#pdp-tabs,#reviews,#recentlyViewed,.pdp_Description').first().after('<div id=\"wc-power-page\"></div>');\n      }\n      //$('<div id=\"wc-power-page\"></div>').insertAfter('#pdp-tabs,.pdp_Description:first-child');\n      wc_injected = true;\n      _tph.log('WebCollage: Injected.');\n  } else {\n      _tph.log('WebCollage: Unable to locate element for attachment.', 'warn');\n  }\n\n  // Recommendations\n  /*\n  if (wc_injected === false && $('#recommendations').length > 0) {\n      $('<div id=\"wc-power-page\"></div>').insertAfter('#recommendations');\n      wc_injected = true;\n  }\n  */\n\n  console.groupEnd();\n</script>\n\n<!--\n# Step 1  - Load Webcollage API\n# Place this at the head of your product pages.\n-->\n<script src=\"https://scontent.webcollage.net/api/v2/product-content\"></script>\n\n<!--\n# Step 3 - Loading the Webcollage content\n# Replace PRODUCT_ID with the relevant product SKU, as provided in the feed. For example: '32910096'.\n-->\n<script>\nif (wc_injected === true) {\n    console.group('WebCollage (pdp) (toys)');\n\n    _tph.log('loadProductContent mosaic-board');\n\n    // load Mosaic contnet\n    Webcollage.loadProductContent('barnesandnoble', _satellite.getVar('sku'), {\n        \"mosaic-board\": {\n            containerSelector: \"div#prodImage\"\n        }\n    });\n\n\n    _tph.log('loadProductContent power-page');\n\n    // load Power Page contnet\n    Webcollage.loadProductContent('barnesandnoble', _satellite.getVar('sku'), {\n        \"power-page\": {\n            autoPlayAndStop: true\n        }\n    });\n\n\n    console.groupEnd();\n}\n</script>",language:"html"}}]},{id:"RLfa137d7c53dd4d6d849a7f635c896580",name:"Footer: Find a Store Submit",events:[{modulePath:"core/src/lib/events/submit.js",settings:{elementSelector:".text-input--location>form",bubbleFireIfParent:!0,bubbleFireIfChildFired:!0},ruleOrder:50}],conditions:[],actions:[{modulePath:"core/src/lib/actions/customCode.js",settings:{source:"https://assets.adobedtm.com/d55bc227c346/0aaa96eebcd0/e8941ef5612d/RC5b7b8cc4526f40e69fa75a1ac906b50b-source.min.js",language:"javascript",isExternal:!0}}]},{id:"RLf74acdf0b53c46a5b19c344b42c5ba06",name:"Product: AVG Rating Click",events:[{modulePath:"core/src/lib/events/click.js",settings:{elementSelector:".bv_avgRating,.bv_numReviews_text",bubbleFireIfParent:!0,bubbleFireIfChildFired:!0},ruleOrder:50}],conditions:[{modulePath:"core/src/lib/conditions/valueComparison.js",settings:{comparison:{operator:"equals"},leftOperand:"%pageType%",rightOperand:"pdp"}}],actions:[{modulePath:"core/src/lib/actions/customCode.js",settings:{source:"https://assets.adobedtm.com/d55bc227c346/0aaa96eebcd0/e8941ef5612d/RCf259563541064f4e8157d9afad590951-source.min.js",language:"javascript",isExternal:!0}}]},{id:"RLbc2f40de98134f49b1abfd8870129d62",name:"BookGraph: Book Selected",events:[{modulePath:"core/src/lib/events/directCall.js",settings:{identifier:"onBookGraphBookSelected"},ruleOrder:50}],conditions:[],actions:[{modulePath:"adobe-analytics/src/lib/actions/setVariables.js",settings:{customSetup:{source:function(e,t){var n=window.r_findDigitalDataEvent("onBookGraphBookSelected");if(n){var a=window.r_getByPath(digitalData,"page.attributes.bookGraph.recommendations",[]),r=window.r_getByPath(n,"attributes.product");_tph.adobe.setVariables(t,{eVar40:window.r_getByPath(r[0],"productInfo.sku"),prop40:"D=v40"});for(var i=0;i<a.length;i++)t.list1=t.apl(t.list1,window.r_getByPath(a[i],"productInfo.sku"),",");_tph.adobe.appendEvents(t,["event52"])}}},trackerProperties:{events:[{name:"event52"}]}}},{modulePath:"adobe-analytics/src/lib/actions/sendBeacon.js",settings:{type:"link",linkName:"bookgraph_book_selection",linkType:"o"}}]},{id:"RL816b00a9fc0646a59516aad58efc83e5",name:"BookGraph: Additional Book Selected",events:[{modulePath:"core/src/lib/events/directCall.js",settings:{identifier:"onBookGraphAdditionalBookSelected"},ruleOrder:50}],conditions:[],actions:[{modulePath:"adobe-analytics/src/lib/actions/setVariables.js",settings:{customSetup:{source:function(e,t){var n=window.r_findDigitalDataEvent("onBookGraphAdditionalBookSelected");if(n){for(var a=window.r_getByPath(n,"attributes.bookGraph.recommendations",[]),r=0;r<a.length;r++)t.list1=t.apl(t.list1,window.r_getByPath(a[r],"productInfo.sku"),",");_tph.adobe.appendEvents(t,["event54"])}}},trackerProperties:{events:[{name:"event54"}]}}},{modulePath:"adobe-analytics/src/lib/actions/sendBeacon.js",settings:{type:"link",linkName:"bookgraph_additionalbook_selected",linkType:"o"}}]},{id:"RL8bc126c28ab34514bd5b048fc6669dd1",name:"Navigate",events:[{modulePath:"core/src/lib/events/directCall.js",settings:{identifier:"onNavigate"},ruleOrder:50}],conditions:[],actions:[{modulePath:"adobe-analytics/src/lib/actions/setVariables.js",settings:{customSetup:{source:function(){var e=window.r_findDigitalDataEvent("onNavigate");e&&(window.r_getByPath(e,"attributes.name"),window.r_getByPath(e,"attributes.location"),window.r_getByPath(e,"category.primaryCategory",""))}},trackerProperties:{channel:"%pageType%"}}},{modulePath:"adobe-analytics/src/lib/actions/sendBeacon.js",settings:{type:"link",linkName:"navigate",linkType:"o"}}]},{id:"RL974aa3aa640e4a8688c7986b5feb07f8",name:"ShoppingBag: Add Item",events:[{modulePath:"core/src/lib/events/directCall.js",settings:{identifier:"onShoppingBagAddItem"},ruleOrder:50}],conditions:[],actions:[{modulePath:"adobe-analytics/src/lib/actions/clearVariables.js",settings:{}},{modulePath:"adobe-analytics/src/lib/actions/setVariables.js",settings:{customSetup:{source:function(e,t){_tph.adobe.setVariables(t,{products:null}),t.products=window.r_getProductsForAdobeFromDLEvent("addToBag");var n=window.r_findDigitalDataEvent("addToBag");if(n){var a=window.r_getByPath(n,"attributes.product[0].attributes.purchaseType");a&&a.indexOf("instant_")<0&&_tph.adobe.appendEvents(t,window.BNAnalytics.getCartOpen(t,"s_scOpen").split(","))}}},trackerProperties:{events:[{name:"scAdd"}],channel:"%pageType%",pageName:"%pageName%"}}},{modulePath:"adobe-analytics/src/lib/actions/sendBeacon.js",settings:{type:"link",linkName:"Add to Bag",linkType:"o"}},{modulePath:"core/src/lib/actions/customCode.js",settings:{source:"https://assets.adobedtm.com/d55bc227c346/0aaa96eebcd0/e8941ef5612d/RC40f19f1d600a411fb22cad356633b030-source.min.js",language:"javascript",isExternal:!0}}]},{id:"RL2d862259c6e44dfb8bf9d89ad02d5afa",name:"ShoppingBag: Remove Item",events:[{modulePath:"core/src/lib/events/directCall.js",settings:{identifier:"onShoppingBagRemoveItem"},ruleOrder:50}],conditions:[],actions:[{modulePath:"adobe-analytics/src/lib/actions/clearVariables.js",settings:{}},{modulePath:"adobe-analytics/src/lib/actions/setVariables.js",settings:{customSetup:{source:function(e,t){_tph.adobe.setVariables(t,{products:null}),t.products=window.r_getProductsForAdobeFromDLEvent("removeFromBag"),_tph.adobe.appendEvents(t,window.BNAnalytics.getCartOpen(t,"s_scOpen").split(",")),_tph.adobe.appendEvents(t,["scRemove"])}},trackerProperties:{events:[{name:"scRemove"}],channel:"%pageType%"}}},{modulePath:"adobe-analytics/src/lib/actions/sendBeacon.js",settings:{type:"link",linkName:"Remove from Bag",linkType:"o"}}]},{id:"RLb10859cbd7be4084a0f549a4c883b737",name:"BookGraph: Start New Connection",events:[{modulePath:"core/src/lib/events/directCall.js",settings:{identifier:"onBookGraphStartNewConnection"},ruleOrder:50}],conditions:[],actions:[{modulePath:"adobe-analytics/src/lib/actions/setVariables.js",settings:{trackerProperties:{events:[{name:"event56"}]}}},{modulePath:"adobe-analytics/src/lib/actions/sendBeacon.js",settings:{type:"link",linkName:"bookgraph_new_connection",linkType:"o"}}]},{id:"RL5f4d9d5fb8214d28bd36a90724e0bc9c",name:"BookGraph: Explore Now Click",events:[{modulePath:"core/src/lib/events/directCall.js",settings:{identifier:"onBookGraphExploreNowClick"},ruleOrder:50}],conditions:[],actions:[{modulePath:"adobe-analytics/src/lib/actions/setVariables.js",settings:{trackerProperties:{events:[{name:"event61"}]}}},{modulePath:"adobe-analytics/src/lib/actions/sendBeacon.js",settings:{type:"link",linkName:"bookgraph_explorenow",linkType:"o"}}]},{id:"RL2eed37b6a8714ab09a8990504eff5e6a",name:"Account: Create Complete",events:[{modulePath:"core/src/lib/events/directCall.js",settings:{identifier:"onCreateAccountComplete"},ruleOrder:50}],conditions:[],actions:[{modulePath:"adobe-analytics/src/lib/actions/setVariables.js",settings:{trackerProperties:{events:[{name:"event44"}],channel:"%pageType%"}}},{modulePath:"adobe-analytics/src/lib/actions/sendBeacon.js",settings:{type:"link",linkName:"account_create_complete",linkType:"o"}}]},{id:"RL9ede6eeb54e34bc5a7c36b262990c2b3",name:"Checkout: View",events:[{modulePath:"core/src/lib/events/directCall.js",settings:{identifier:"onCheckoutView"},ruleOrder:50}],conditions:[],actions:[{modulePath:"adobe-analytics/src/lib/actions/clearVariables.js",settings:{}},{modulePath:"adobe-analytics/src/lib/actions/setVariables.js",settings:{customSetup:{source:function(e,t){var n=window.r_findDigitalDataEvent("checkoutView",!0,!0);if(n){var a=window.r_getByPath(n,"attributes.stepName"),r=window.r_getByPath(n,"attributes.stepValue");if(a)switch(a){case"start":case"regular-start":_tph.adobe.appendEvents(t,"event25,scCheckout".split(","));break;case"express-start":_tph.adobe.appendEvents(t,"event26,scCheckout".split(","));break;case"review-items":_tph.adobe.appendEvents(t,["event27"]);break;case"sign-in":case"signin":_tph.adobe.appendEvents(t,["event28"]);break;case"ship-to":_tph.adobe.appendEvents(t,["event29"]);break;case"shipping-method":_tph.adobe.appendEvents(t,["event30"]);break;case"shipping-preference":_tph.adobe.setVariables(t,{prop35:r});break;case"billing-info":_tph.adobe.appendEvents(t,["event31"]);break;case"coupon-info":_tph.adobe.appendEvents(t,["event32"]);break;case"payment-info":_tph.adobe.appendEvents(t,["event33"]);break;case"final-confirmation":case"final":_tph.adobe.appendEvents(t,["event34"])}}}},trackerProperties:{channel:"%pageType%",pageName:"%pageName%"}}},{modulePath:"adobe-analytics/src/lib/actions/sendBeacon.js",settings:{type:"link",linkName:"checkout_view",linkType:"o"}}]},{id:"RLb2cf3c71cc6c494999788874359f8bca",name:"Page: Head: All",events:[{modulePath:"core/src/lib/events/libraryLoaded.js",settings:{},ruleOrder:1}],conditions:[],actions:[{modulePath:"core/src/lib/actions/customCode.js",settings:{source:'<script type="text/javascript">\n    (function () {\n        // Add Instrumentation of XHR\n        // Only for the stacks project at this time as there are concerns of too many\n        // calls if we decide to track all XHR calls\n        // backup check for giftguide just in-case pageType stops working\n        // ----------------------------------------------------------------\n        if (_satellite.getVar(\'pageType\').indexOf(\'stacks:\') === 0 || window.location.host.indexOf(\'giftguide\') === 0) {\n            window.BOOMR_config = {\n                instrument_xhr: true\n            };\n        }\n        // End - Instrumentation of XHR\n        // ----------------------------------------------------------------\n\n        if (window.BOOMR && window.BOOMR.version) {\n            return;\n        }\n        var dom, doc, where, iframe = document.createElement(\'iframe\'),\n            win = window;\n\n        function boomerangSaveLoadTime(e) {\n            win.BOOMR_onload = (e && e.timeStamp) || new Date().getTime();\n        }\n        if (win.addEventListener) {\n            win.addEventListener("load", boomerangSaveLoadTime, false);\n        } else if (win.attachEvent) {\n            win.attachEvent("onload", boomerangSaveLoadTime);\n        }\n\n        iframe.src = "javascript:false";\n        iframe.title = "";\n        iframe.role = "presentation";\n        (iframe.frameElement || iframe).style.cssText = "width:0;height:0;border:0;display:none;";\n        where = document.getElementsByTagName(\'script\')[0];\n        where.parentNode.insertBefore(iframe, where);\n\n        try {\n            doc = iframe.contentWindow.document;\n        } catch (e) {\n            dom = document.domain;\n            iframe.src = "javascript:var d=document.open();d.domain=\'" + dom + "\';void(0);";\n            doc = iframe.contentWindow.document;\n        }\n        doc.open()._l = function () {\n            var js = this.createElement("script");\n            if (dom) this.domain = dom;\n            js.id = "boomr-if-as";\n            js.src = \'//c.go-mpulse.net/boomerang/\' +\n                \'MFWAJ-N9VRV-LJGEL-8H8XB-2XEMD\';\n            BOOMR_lstart = new Date().getTime();\n            this.body.appendChild(js);\n        };\n        doc.write(\'<body onload="document._l();">\');\n        doc.close();\n\n        // Add Instrumentation of XHR\n        // ----------------------------------------------------------------\n        /**\n         * Boomerang XHR whitelist\n         */\n        function addWhitelistFilter() {\n            if (window.BOOMR &&\n                window.BOOMR.version &&\n                window.BOOMR.plugins &&\n                window.BOOMR.plugins.AutoXHR &&\n                typeof BOOMR.plugins.AutoXHR.addExcludeFilter === "function") {\n\n                // This function is called for each XHR.\n                // Return true to ignore the XHR, or false to track the XHR.\n                function whitelistFilter(url) {\n\n                    // Example of tracking \'hello/api\'\n                    if (url.href && url.href.indexOf("/skavastream/") > -1) {\n                        return false;\n                    }\n\n                    // All other URLs will be ignored\n                    return true;\n                }\n\n                // Register the filter\n                BOOMR.plugins.AutoXHR.addExcludeFilter(whitelistFilter, window, "Whitelist Filter");\n\n                return true;\n            }\n        }\n\n        // try to add the filter, waiting for Boomerang to arrive on the page if it isn\'t yet\n        if (!addWhitelistFilter()) {\n            if (document.addEventListener) {\n                document.addEventListener("onBoomerangLoaded", addWhitelistFilter);\n            } else if (document.attachEvent) {\n                document.attachEvent("onpropertychange", function (e) {\n                    e = e || window.event;\n                    if (e && e.propertyName === "onBoomerangLoaded") {\n                        addWhitelistFilter();\n                    }\n                });\n            }\n        }\n        // End - Instrumentation of XHR\n        // ----------------------------------------------------------------\n    })();\n</script>',language:"html"}},{modulePath:"core/src/lib/actions/customCode.js",settings:{global:!0,
source:'/* TagPipes Helper Library, Generated from TagPipes */\n\n/**\n * TagPipes Helper Library\n * @param  {object} w         Window Object\n * @param  {undefined} undefined System undefined object\n * @return {object}           An unsuable object\n */\n\nwindow._tph=(function(b,c){var a={version:"0.92",logPrefix:"TP: "};return{setConfig:function(d,e){a[d]=e},version:function(){return a.version},log:function(e,d){if(typeof(console)!=="undefined"){switch(d){case"error":console.error(a.logPrefix+e);break;case"warn":case"warning":console.warn(a.logPrefix+e);break;default:console.log(a.logPrefix+e);break}}},isArray:(Array.isArray||function(d){return toStr.call(d)==="[object Array]"}),listeners:{arrayPush:function(d,e){if(!d||typeof(e)==="undefined"){return false}if(tp_toType(d)!=="array"){return false}_tph.log("Will listen to array push");d.push=function(){Array.prototype.push.apply(this,arguments);e.apply(this,arguments)};return true},arrayChangeByCount:function(d,e){}},queryParameters:{get:function(f,d,e){if(!d){d=true}if(!e){e=window.location.href}f=f.replace(/[\\[\\]]/g,"\\\\$&");var h=(d===true?new RegExp("[?&]"+f+"(=([^&#]*)|&|#|$)","i"):new RegExp("[?&]"+f+"(=([^&#]*)|&|#|$)"));var g=h.exec(e);if(!g){return null}if(!g[2]){return""}return decodeURIComponent(g[2].replace(/\\+/g," "))},all:function(j){var h={},f,e,g,d;if(!j){j=window.location.search}if(j.indexOf("?")===0){j=j.substring(1)}f=j.split("&");for(g=0,d=f.length;g<d;g++){e=f[g].split("=");h[e[0]]=e[1]}return h}},cookies:{get:function(e){if(!document.cookie){return false}var d=document.cookie.match("(^|;) ?"+e+"=([^;]*)(;|$)");return d?d[2]:null},set:function(e,f,h){if(!document.cookie){return false}var g=new Date();g.setTime(g.getTime()+24*60*60*1000*h);document.cookie=e+"="+f+";path=/;expires="+g.toGMTString()},remove:function(d){return cookies.set(d,"",-1)}},lists:{get:function(f){var e="tp_lists_"+f;var d=(_tph.storage.get(e,false)||"[]");return JSON.parse(d)},push:function(h,l){var f="tp_lists_"+h;var e=(_tph.storage.get(f,false)||"[]");var d=(_tph.isArray(l)?l:[l]);var j=JSON.parse(e);for(var g=0;g<d.length;g++){j.push(d[g])}_tph.storage.set(f,JSON.stringify(j),false)},trim:function(g,i,f){var e="tp_lists_"+g;var d=(_tph.storage.get(e,false)||"[]");var h=JSON.parse(d).slice(i,f);_tph.storage.set(e,JSON.stringify(h),false)},trimEnd:function(f,g){var e="tp_lists_"+f;var d=(_tph.storage.get(e,false)||"[]");var h=JSON.parse(d).slice(-1*g);_tph.storage.set(e,JSON.stringify(h),false)},},storage:{set:function(f,g,h,d){var e=(d||{});if(typeof(h)==="undefined"||!h){if(e.useLocalStorage===true&&window.localStorage){localStorage.setItem(f,g)}else{if(window.sessionStorage){sessionStorage.setItem(f,g)}else{}}}else{cookies.set(f,g)}},get:function(g,h,e){var f=(e||{});var d=null;if(typeof(h)==="undefined"||!h){if(f.useLocalStorage===true&&window.localStorage){d=localStorage.getItem(g)}else{if(window.sessionStorage){d=sessionStorage.getItem(g)}else{}}}else{d=cookies.get(g)}return d},remove:function(g,h,e){var f=(e||{});var d=null;if(typeof(h)==="undefined"||!h){if(f.useLocalStorage===true&&window.localStorage){localStorage.removeItem(g)}else{if(window.sessionStorage){sessionStorage.removeItem(g)}else{}}}else{return cookies.remove(g)}return d}}}}(window,undefined));(function(b,c){var a=Array.isArray||function(d){return toStr.call(d)==="[object Array]"};if(!b.tp_setSatelliteMode&&typeof(_satellite)!=="undefined"){b.tp_setSatelliteMode=function(e){if(_tph.queryParameters.get("adobe_debug")){var d=(_tph.queryParameters.get("adobe_debug").toLowerCase()==="true"?true:false);_satellite.setDebug(d);tp_log("Debug Mode Enabled = "+(d?"Yes":"No"))}if(_tph.queryParameters.get("adobe_staging")&&localStorage){var f=(_tph.queryParameters.get("adobe_staging").toLowerCase()==="true"?true:false);localStorage.setItem("sdsat_stagingLibrary",f);tp_log("Staging Mode Enabled = "+(f?"Yes":"No"))}}}if(!b.tp_findObjectInArrayByKey){b.tp_findObjectInArrayByKey=function(h,f,g){var e={index:-1,item:null};for(var d=0;d<h.length;d++){if(h[d][f]===g){e.index=d;e.item=h[d]}}return e}}if(!b.tp_toType){b.tp_toType=function(d){return(typeof(d))==="undefined"?"undefined":({}).toString.call(d).match(/\\s([a-zA-Z]+)/)[1].toLowerCase()}}if(!b.tp_isEmpty){b.tp_isEmpty=function(e){var d=false;switch(b.tp_toType(e)){case"undefined":case"null":d=true;break;case"array":if(e.length<=0){d=true}break;case"string":d=(e.length<=0?true:false);break;default:d=false}return d}}if(!b.tp_objectpath_hasOwnProperty){b.tp_objectpath_hasOwnProperty=function(d,e){if(d==null){return false}return Object.prototype.hasOwnProperty.call(d,e)}}if(!b.tp_objectpath_hasShallowProperty){b.tp_objectpath_hasShallowProperty=function(d,e){return((typeof e==="number"&&Array.isArray(d))||b.tp_objectpath_hasOwnProperty(d,e))}}if(!b.tp_objectpath_getShallowProperty){b.tp_objectpath_getShallowProperty=function(d,e){if(b.tp_objectpath_hasShallowProperty(d,e)){return d[e]}}}if(!b.tp_objectpath_getKey){b.tp_objectpath_getKey=function(e){var d=parseInt(e);if(d.toString()===e){return d}return e}}if(!b.tp_objectpath_get){b.tp_objectpath_get=function(h,g,d){if(typeof g==="number"){g=[g]}if(!g||g.length===0){return h}if(h==null){return d}if(typeof g==="string"){return b.tp_objectpath_get(h,g.split("."),d)}var f=b.tp_objectpath_getKey(g[0]);if(typeof(f)==="string"&&f.startsWith("[")&&f.endsWith("]")){f=f.replace("[","").replace("]","")}var e=b.tp_objectpath_getShallowProperty(h,f);if(e===void 0){return d}if(g.length===1){return e}return b.tp_objectpath_get(h[f],g.slice(1),d)}}if(!b.tp_objectpath_set){b.tp_objectpath_set=function(i,h,g,d){if(typeof h==="number"){h=[h]}if(!h||h.length===0){return i}if(typeof h==="string"){return b.tp_objectpath_set(i,h.split(".").map(b.tp_objectpath_getKey),g,d)}var f=h[0];if(typeof(f)==="string"&&f.startsWith("[")&&f.endsWith("]")){f=f.replace("[","").replace("]","")}var e=b.tp_objectpath_getShallowProperty(i,f);if(h.length===1){if(e===void 0||!d){i[f]=g}return e}if(e===void 0){if(typeof h[1]==="number"){i[f]=[]}else{i[f]={}}}return b.tp_objectpath_set(i[f],h.slice(1),g,d)}}if(!b.tp_hashCode){b.tp_hashCode=function(e){var f=0;if(e.length==0){return f}for(var d=0;d<e.length;d++){chr=e.charCodeAt(d);f=((f<<5)-f)+chr;f=f&f}return f}}if(!b.tp_log){b.tp_log=function(e,d){if(typeof(console)!=="undefined"){switch(d){case"error":console.error(e);break;case"warn":case"warning":console.warn(e);break;default:console.log(e);break}}}}if(!b.tp_objectMerge){b.tp_objectMerge=function(h,g,k,l){var d={};for(var e=0;e<h.length;e++){for(var j in h[e]){var f=h[e][j];if(k===false&&f==null){continue}if(l===false&&typeof(f)==="undefined"){continue}if(g&&e!==0){d[g+j]=f}else{d[j]=f}}}return d}}if(!b.tp_poll){b.tp_poll=function(g,j,f,h,e){var d=Number(new Date())+(h||2000);e=e||100;(function i(){if(g()){if(typeof(j)!=="undefined"&&j){j()}}else{if(Number(new Date())<d){window.setTimeout(i,e)}else{if(typeof(f)!=="undefined"&&f){f(new Error("timed out for "+g+": "+arguments))}}}})()}}if(!b.tp_interval){b.tp_interval=function(e,d){this.baseline=c;this.run=function(){if(this.baseline===c){this.baseline=new Date().getTime()}d();var f=new Date().getTime();this.baseline+=e;var g=e-(f-this.baseline);if(g<0){g=0}(function(h){h.timer=setTimeout(function(){h.run(f)},g)}(this))};this.stop=function(){clearTimeout(this.timer)}}}if(!b.tp_genUrlRandom){b.tp_genUrlRandom=function(e){var d=b.tp_objectMerge([{},e]);return(new Date().getTime()+(Math.random()*1000000))}}if(!b.tp_injectImage){b.tp_injectImage=function(g,i,h,f){var d=b.tp_objectMerge([{},f]);h=(typeof(h)==="undefined"?true:h);if(h&&h===true){g+=(g.indexOf("?")>-1?"&_=":"?_=")+b.tp_genUrlRandom()}var e=new window.Image();if(typeof(i)!=="undefined"){e.onload=i}e.style.display="none";e.style.width="1px";e.style.height="1px";e.src=g}}if(!b.tp_injectScript){b.tp_injectScript=function(d,g,f){if(b.jQuery){$.ajaxSetup({cache:!(f&&f===true)});$.getScript(d,g)}else{if(f&&f===true){d+=(d.indexOf("?")>-1?"&_=":"?_=")+b.tp_genUrlRandom()}var e=b.document.createElement("script");e.type="text/javascript";b.document.getElementsByTagName("head")[0].appendChild(script);if(typeof(g)!=="undefined"){e.onload=g}e.src=d}}}if(!b.tp_injectIFrame){b.tp_injectIFrame=function(d,g,f){if(f&&f===true){d+=(d.indexOf("?")>-1?"&_=":"?_=")+b.tp_genUrlRandom()}if(b.jQuery){$("<iframe />",{src:d,width:1,height:1,frameborder:0,style:"display:none"}).appendTo("body")}else{var e=document.createElement("iframe");document.body.appendChild(e);if(typeof(g)!=="undefined"){s.onload=g}if(navigator.userAgent.indexOf("MSIE")===-1){e.src=d}else{e.location=d}}}}if(!b.tp_findDigitalDataEvent){b.tp_findDigitalDataEvent=function(g,o,f,l){o=(o||false);f=(f||false);var n=null;try{var d=b.tp_objectpath_get(window,"digitalData.event",[]);if(l&&l===true){d=b.tp_objectpath_get(window,"digitalData.event",[]).slice(0).reverse()}if(d){for(var h=0,j=d.length;h<j;h++){var m=d[h];if(m.eventInfo.eventAction===g){if(o===false||(o===true&&(m.eventInfo.processed||false)===false)){if(f===true){d[h].eventInfo.processed=true}n=m;break}}}}}catch(k){b.tp_log(k.message,"error")}return n}}if(!b.tp_parseUrlHash){b.tp_parseUrlHash=function(e){e=(e||window.location.href);var h={};var d=e.slice(e.indexOf("#")+1).split("?");if(d.length>1){h.page=d[0];d=d[1].split("&")}else{d=d[0].split("&")}for(var f=0;f<d.length;f++){var g=d[f].split("=");if(g.length>1){h[g[0]]=g[1]}else{h[g[0]]=null}}return h}}}(window,undefined));\n\n/**\n\tTagPipes Helper Library - sha256 Utility\n */\n(function(a){a.utils=(a.utils||{});a.utils.sha256=function(l){if(typeof(l)==="undefined"||l===null||l.length<=0){return}function F(e,b){return(e>>>b)|(e<<(32-b))}var A=Math.pow;var p=A(2,32);var g="length";var y,x;var r="";var t=[];var f=l[g]*8;var d=a.utils.sha256.h=a.utils.sha256.h||[];var v=a.utils.sha256.k=a.utils.sha256.k||[];var n=v[g];var h={};for(var m=2;n<64;m++){if(!h[m]){for(y=0;y<313;y+=m){h[y]=m}d[n]=(A(m,0.5)*p)|0;v[n++]=(A(m,1/3)*p)|0}}l+="\\x80";while(l[g]%64-56){l+="\\x00"}for(y=0;y<l[g];y++){x=l.charCodeAt(y);if(x>>8){return}t[y>>2]|=x<<((3-y)%4)*8}t[t[g]]=((f/p)|0);t[t[g]]=(f);for(x=0;x<t[g];){var s=t.slice(x,x+=16);var c=d;d=d.slice(0,8);for(y=0;y<64;y++){var u=y+x;var o=s[y-15],q=s[y-2];var C=d[0],z=d[4];var E=d[7]+(F(z,6)^F(z,11)^F(z,25))+((z&d[5])^((~z)&d[6]))+v[y]+(s[y]=(y<16)?s[y]:(s[y-16]+(F(o,7)^F(o,18)^(o>>>3))+s[y-7]+(F(q,17)^F(q,19)^(q>>>10)))|0);var D=(F(C,2)^F(C,13)^F(C,22))+((C&d[1])^(C&d[2])^(d[1]&d[2]));d=[(E+D)|0].concat(d);d[4]=(d[4]+E)|0}for(y=0;y<8;y++){d[y]=(d[y]+c[y])|0}}for(y=0;y<8;y++){for(x=3;x+1;x--){var B=(d[y]>>(x*8))&255;r+=((B<16)?0:"")+B.toString(16)}}return r};return a})(_tph||{});\n\n/** \n * Configure TagPipes \n**/\n_tph.setConfig(\'logPrefix\', \'BN: \');\n\n/**\n\tTagPipes Helper Library - _satellite Extension\n\tAdobe DTM\n */\n(function(b,a,c){b.ext=(b.ext||{});b.ext._satellite={isDebugMode:function(){return(localStorage&&localStorage.getItem("sdsat_debug")==="true")},isStagingMode:function(){return(localStorage&&localStorage.getItem("sdsat_stagingLibrary")==="true")},setMode:function(e,d){if(typeof(e)!=="undefined"&&_satellite){if(e&&e==="staging"&&localStorage){localStorage.setItem("sdsat_stagingLibrary",d)}else{_satellite.setDebug(d)}}},attachDigitalData:function(e){var d=a.tp_objectMerge([{dcrMode:false,prefixWithOn:true},e]);b.listeners.arrayPush(window.digitalData.event,function(){b.log(JSON.stringify(arguments[0],null,2));if(typeof(d.dcrMode)!=="undefined"&&d.dcrMode===true){var f=a.tp_objectpath_get(arguments[0],"eventInfo.eventAction","unspecified");if(!f.startsWith("on")){f=("on"+f.charAt(0).toUpperCase()+f.slice(1))}b.log(\'Calling _satellite.track("\'+f+\'"); ...\');_satellite.track(f)}})}};return b})((_tph||{}),window,undefined);\n\n/**\n\tTagPipes Helper Library - Adobe Extension\n\tAdobe Analytics Extension\n */\n(function(a){a.adobe=(a.adobe||{});a.adobe.appendProduct=function(g,h,c){if(typeof(g)==="object"){var i=[];i.push(h.category||"");i.push(h.product||h.sku||h.id||h.name||"");i.push(h.quantity||h.qty||"");i.push(h.price.toString().replace(/^\\D+/g,""));var j=[];if(typeof(h.events)!=="undefined"){for(var b in h.events){if(!h.events.hasOwnProperty(b)){continue}j.push(b+"="+h.events[b])}}i.push(j.join("|"));var f=[];if(typeof(h.evars)!=="undefined"){for(var e in h.evars){if(!h.evars.hasOwnProperty(e)){continue}f.push(e+"="+h.evars[e])}}i.push(f.join("|"));a.adobe.appendEvents(g,[(c||"prodView")]);var d=(typeof(g.products)!=="undefined"?g.products.split(","):[]);d.push(i.join(";"));g.products=d.join(",")}};a.adobe.appendEvents=function(e,c){if(typeof(e)==="object"&&c&&c.length>0){e.linkTrackVars=e.apl(e.linkTrackVars,"events",",",1);for(var b=0;b<c.length;b++){if(typeof(c[b])==="string"){e.events=e.apl(e.events,c[b],",",1);e.linkTrackEvents=e.apl(e.linkTrackEvents,c[b],",",1)}else{var d=(Object.keys(c[b])[0]+"="+c[b][Object.keys(c[b])[0]]);e.events=e.apl(e.events,d,",",1);e.linkTrackEvents=e.apl(e.linkTrackEvents,Object.keys(c[b])[0],",",1)}}}};a.adobe.setVariables=function(b,d){if(typeof(b)==="object"&&typeof(d)==="object"){for(var c in d){if(d.hasOwnProperty(c)){b.linkTrackVars=b.apl(b.linkTrackVars,c,",",1);if(d[c]&&d[c].length>0){b[c]=d[c]}}}}};a.adobe.trackCustomLink=function(d,b,c,e){if(typeof(d)==="object"){a.adobe.appendEvents(d,c);a.adobe.setVariables(d,e);d.tl(false,"o",b)}};return a})(_tph||{});\n\n\n//_tph.log(\'TagPipes Helper Library Loaded -> v\' + _tph.version());',language:"javascript"}},{modulePath:"core/src/lib/actions/customCode.js",settings:{global:!0,
source:"// NOTE: This is a combination of preSlib & rawsoft_helper.js\n// This was requested by the performance team to help with performance\n\n// FILE: helper functions 140714h dtm.js\n// AUTHOR: Copyright 1996-2014 Adobe, Inc. All Rights Reserved\n// DESCRIPTION: Helper functions for data layer\n// UPDATED: 14.08.26\n// USAGE:\n// 1. Create a DTM Page Load Rule called \"Helper Functions\"\n// 2. Make sure \"Trigger rule at\" is set to \"Top of Page\" under \"Conditions\"\n// 3. Make sure \"Execuite Globally\" is checked\n// 4. Under \"Javascript/Third Party Tags\", add a new script under \"Sequential Javascript\" called \"Helper Functions\"\n// 5. Upload this file into the code window and check \"Execute Globally\"\n\n/************************** preSlib v1.50 - General Helper Functions *************************/\n\nvar W=eval('window');\n\n// preSlib enabler functions\nif(!W.s_is)W.s_is=function(x){var t=x===null?'null':typeof x;if(t=='object'&&typeof x.length=='number')t='array';return t}\nif(!W.s_isN)W.s_isN=function(x){return s_is(x)=='number'}\nif(!W.s_isS)W.s_isS=function(x){return s_is(x)=='string'}\nif(!W.s_MC)W.s_MC=function(a,c){try{if(s_isS(c))c=c=='lc'?-1:c=='uc'?1:0;if(!s_isN(c))c=c?1:0;a+='';a=c<0?a.toLowerCase(a):c>0?a.toUpperCase(a):a}catch(e){}return a}\nif(!W.s_LC)W.s_LC=function(a){return s_MC(a,'lc')}\nif(!W.s_UC)W.s_UC=function(a){return s_MC(a,'uc')}\nif(!W.s_scrubWS)W.s_scrubWS=function(t){try{if(t==null)t='';t=t.replace(/^\\s+/g,'').replace(/\\s+$/g,'').replace(/\\s+/g,' ')}catch(e){}return t}\nif(!W.s_split)W.s_split=function(l,d){var i,x=0,a=new Array;if(!d)d=',';while(l){i=l.indexOf(d);i=i>-1?i:l.length;a[x++]=l.substring(0,i);l=l.substring(i+d.length)}return a}\nif(!W.s_getHTMLtag)W.s_getHTMLtag=function(y){var a='',v='',g='',t='',f='',c='mc',p=arguments,l=p.length,i;if(!y)return f;if(l>1){i=s_LC(p[l-1]);if(i=='uc'||i=='lc'||i=='mc'){c=i;l--}}y=s_LC(y);if(l==2)g=s_LC(p[1]);else if(l>=3){a=s_LC(p[1]);v=s_MC(p[2],c);if(l>=4)g=s_MC(p[3],c)}if(document.getElementsByTagName)t=document.getElementsByTagName(y);if(typeof t!='object')return f;for(i=0;!f&&i<t.length;i++){f=t[i];if(a&&v&&s_MC(f.getAttribute(a),c)!=v)f=''}if(!f||typeof f!='object'||!g)return f;if(g!='text')return f.getAttribute(g);f=f.innerText||f.textContent||'';f=f.replace(/\\s*>\\s*/g,'>').replace(/^>+/,'').replace(/>+$/,'');return f}\nif(!W.s_parseUri)W.s_parseUri=function(u){if(u){u=u+'';u=u.indexOf(':')<0&&u.indexOf('//')!=0?(u.indexOf('/')==0?'/':'//')+u:u}var u=u?u+'':window.location.href,e,a=document.createElement('a'),p='',r={};a.setAttribute('href',u);for(e in a)if(typeof a[e]=='string')r[e]=a[e];delete a;p=r.pathname||'';if(p.indexOf('/')!=0)r.pathname='/'+p;return r}\nif(!W.s_indexOf)W.s_indexOf=function(t,s){var r;try{r=(s?s+'':'').indexOf(t)}catch(e){r=-1}return r}\n\n// preSlib utilities\nif(!W.s_getCharSet)W.s_getCharSet=function(){var v=s_getHTMLtag('meta','http-equiv','content-type','content'),i;if(!v)return'';i=v.indexOf('charset=');if(i==-1)return'';return s_UC(v.substring(i+8,99).replace(/[\\'\\\";, ].*/,''))}\nif(!W.s_getQueryStr)W.s_getQueryStr=function(n,u){var g,h,i,a='&',q=u||window.location.search,p=q.toLowerCase().replace(/\\?/g,a)+a;n=a+n.toLowerCase();g=n+'=';h=p.indexOf(g);if(h>-1){i=h+g.length;return decodeURIComponent(q.substring(i,p.indexOf(a,i)).replace(/\\+/g,' '))}g=n+a;return p.indexOf(g)>-1?' ':''}\nif(!W.s_apl)W.s_apl=function(l,v,d,u){var m=0;if(!l)l='';if(u){var i,n,a=s_split(l,d);for(i=0;i<a.length;i++){n=a[i];m=m||(u==1?(n==v):(s_LC(n)==s_LC(v)))}}if(!m)l=l?l+d+v:v;return l}\nif(!W.s_getShortHn)W.s_getShortHn=function(u){return s_LC(s_parseUri(u||window.location.href).hostname.replace(/^www-?[0-9]*\\./i,''))}\nif(!W.s_getOwnerHn)W.s_getOwnerHn=function(u){return s_LC(s_parseUri(u||window.location.href).hostname.replace(/^www[0-9]*\\./i,'').replace(/\\.(gov|edu|com|mil|org|net|int).*/,'').replace(/\\.[a-z][a-z]$/,'').replace(/.*\\./,''))}\nif(!W.s_getTLDlevels)W.s_getTLDlevels=function(u){var h=s_parseUri(u||window.location.href).hostname;return h.match(RegExp(\"\\\\.co\\\\..{2}$\",\"i\"))||h.match(RegExp(\"\\\\.(gov|edu|com|mil|org|net|int)\\\\..{2}$\",\"i\"))?3:2}\nif(!W.s_getCookieDomain)W.s_getCookieDomain=function(u){var h=s_parseUri(u||window.location.href).hostname,n=s_getTLDlevels(),a=s_split(h,'.'),i=a.length-n;for(h='';i<a.length;i++)h+='.'+a[i];return h}\nif(!W.s_c_w)W.s_c_w=function(n,v,e,d){if(W.s&&typeof W.s=='object'&&W.s.c_w&&!d)return W.s.c_w(n,v,e);v+='';var t=v?0:-60;if(t){e=new Date;e.setTime(e.getTime()+(t*1e3))}if(n)document.cookie=n+'='+escape(v||'[[B]]')+'; path=/'+(d?'; domain='+d:'')+(e?';  expires='+e.toGMTString():'');return n?s_c_r(n)==v:0}\nif(!W.s_c_r)W.s_c_r=function(n){if(W.s&&typeof W.s=='object'&&W.s.c_r)return W.s.c_r(n);var c=' '+document.cookie,i=c.indexOf(' '+n+'='),e=i<0?i:c.indexOf(';',i),v=i<0?'':unescape(c.substring(i+2+n.length,e<0?c.length:e));return v=='[[B]]'?'':v}\nif(!W.s_c_d)W.s_c_d=function(n,e,p,d,s){document.cookie=n+'='+escape('[[B]]')+(p?'; path='+p:'')+(d?'; domain='+d:'')+(e?'; expires=Thu, 01 Jan 1970 00:00:01 GMT':'; max-age=0')+(s?'; secure':'')}\nif(!W.s_getLoadTime)W.s_getLoadTime=function(){if(!window.s_loadT){var o=window.performance?performance.timing:0,a=o?o.requestStart:window.inHeadTS||0;s_loadT=a?Math.round(((o.domInteractive||new Date().getTime())-a)/100):''}return s_loadT}\nif(!W.s_clog)W.s_clog=function(){try{var A='array',O='object',X='undefined',F='function',U='null',a=arguments,al=a.length,i,j,k,v,l='',o=l,e=l,c=l,x=0,d=0,z=0,p,p1=[],q,f0=1,f1=1,f2=1,f3=1,m=1<<16,T=function(z){var t=z===null?U:typeof z;if(t==A)t=O;return t},W=function(o){try{c+=o+'\\n';if(window.s_Debug){if(T(s_debugW)!=O)s_debugW=window.open('','_debugWin','height=600,width=900,toolbar=no,directories=no,status=no,menubar=no,scrollbars=yes,resizable=yes');if(T(s_debugW)==O){if(T(s_debugD)!=O)s_debugD=s_debugW.document;if(T(s_debugD)==O){if(T(s_debugD.write)==F)s_debugD.write('<!DOCTYPE HTML PUBLIC \"-//W3C//DTD HTML 4.0 Transitional//EN\"><html><head><title>debugWin</title><style>* {font-family:Andale Mono,OCR A Extended,Consolas,monospace,serif;font-size:9pt;word-wrap:break-word;padding:0px} p {display:block;clear:both;margin:1px;width:100%;border:none;border-bottom:1px solid #dddddd;}</style></head><body>');if(T(s_debugD.write)==F)s_debugD.write('<p>'+o.replace(/[ \\t]/g,'&nbsp;').replace(/\\</gi,'&lt;').replace(/\\>/gi,'&gt;').replace(/\\n$/,'').replace(/\\n/gi,'<br/>')+'</p>');if(T(s_debugW.scrollBy)==F)s_debugW.scrollBy(0,100)}}}else if(T(console.log)==F||T(console.log)==O)console.log('%s',o)}catch(e){}},B=function(v){v=v+'';var j,b,r,w,c,f=1;for(j=0;j<v.length;j++){b=v.substr(j,1);r=b=='\\n';w=b<=' ';c=b<'A';if(r||(f&&c&&l.length>140)||(f&&l.length+v.substring(j).replace(/\\n.*/,'').length>140)){o+=l;z+=o.length;if(o.length>9999){W(o);o=''}else o+='\\n';l=r?'':'  ';x=!r;f=0}if(!r&&(!x||!w)){l+=b;x=f=0}}},P=function(v){var d=0,i,err=0,u=function(x,v){if(!f3&&d>0){B('\\n');for(k=0;k<=d;k++)B(p1.length>k&&p1[k]&&T(p1[k])=='string'?p1[k]:'');if(arguments.length==1)B(' = ')}if(arguments.length<2){var t=T(x);if(t=='string')B(\"'\"+x+\"'\");else if(t=='boolean')B(x?'true':'false');else if(t==F)B(F+'(){...}');else if(t==U)B(U);else if(t==X)B(X);else B(x+'')}else if(!f3)B((T(v)!='object'?'':T(v.length)=='number'?'[]':'{}'))},b=function(v){if(++d>99){d--;B(' !!!TOO DEEP TO DISPLAY!!!');return}var o=T(v)==O&&T(v.length)!='number',p,x,f=1,j=0;if(f3)B(o?'{':'[');for(p in v){j++;if(!f3)p1[d]=o?'.'+p:'['+p+']';else{B(f?'':',');if(o){B('\\n');for(i=0;i<d;i++)B(' ')}}if(j>1000){B('/* ERROR! TRUNCATED: TOO LARGE */');err=1}if(!err){if(o&&f3)B(p+': ');x=v[p];if(T(x)==O)b(x);else u(x)}f=0}d--;if(f3){if(o){B('\\n');for(i=0;i<d;i++)B(' ');B('}')}else B(']')}else if(j==0)u(x,v)};if(T(v)!=O)u(v);else b(v)},FN=function(c){var n='',v,j;try{if(c){c=c+'';if(!c.indexOf(F+' '))c=c.substring(9);j=c.indexOf('(');if(j>-1)c=c.substring(0,j);if(!c)c='anonymous';n=c}}catch(e){}return n};var cn='s_debug',dp=s_getQueryStr(cn);if(dp>''){dp=dp==' '?1:parseInt(dp)||0;s_c_w(cn,String(dp))}dp=s_c_r(cn);s_Debug=dp>''?parseInt(dp):window.s_Debug||0;for(i=0;i<al;i++){v=a[i];switch(v){case'-f':f0=0;break;case'+f':f0=1;break;case'+u':f1=1;break;case'-u':f1=0;break;case'+n':f2=1;break;case'-n':f2=0;break;case'+o':f3=1;break;case'-o':f3=0;break;case'arguments':v=arguments.callee.caller;for(j=v;j;j=j.caller)q=FN(j)+(q?'>'+q:'');B(q);P(v.arguments);break;case F:B(FN(arguments.callee.caller));break;case'stack':B(st());break;default:if(T(v)==O){for(p in v)if(z<m&&z>=0)if(isNaN(p))if(f3)B(p+'=');else p1[0]=p;P(v[p])}else B(v);break}B(' ')}o+=l;o=o.replace(/^[ \\t]*\\n/,'').replace(/[ \\t\\n]*$/,'');if(o)W(o)}catch(e){}return c}\n\n\n/************************** DATA LAYER AND DTM SUPPORT SECTION *************************/\n\nif(!Object.create){Object.create=function(o){var F=function(){};F.prototype=o;return new F()}}\nif(!W.s_logS)W.s_logS=function(S){var W=window,A=W.$AAD||{},f=A.$logLevel||0;if(f<2)return;var w='pageName,pageType,channel,hier1,hier2,hier3,hier4,hier5,server,pageURL,referrer,visitorID,purchaseID,transactionID,events,products,zip,state,linkTrackVars,linkTrackEvents,linkURL,linkName,campaign,list1,list2,list3',x=w.split(','),l=0,o={},A=function(n){if(typeof S[n]!='undefined'&&S[n]!==null&&S[n]+'')o[n]=S[n]};if(!S||typeof S!='object')s_log(2,'ERROR: Adobe Analytics s object undefined.');else{for(i=0;i<x.length;i++)A(x[i]);for(i=1;i<76;i++)A('eVar'+i);for(i=1;i<76;i++)A('prop'+i);s_log(2,'-o',{'s':o})}}\nif(!W.s_logE)W.s_logE=function(e,T){var W=window,A=W.$AAD||{},f=A.$logLevel,t='ERROR'+(T&&typeof T=='string'&&T?' in '+T:''),n=typeof e=='object'?(e.number||0)&0xffff:'',l='',m=e.message||e.description||'',d='',s='';if(typeof n=='number'){if(n)d=n+': ';if(e.name&&(f<2||(e.stack||'').indexOf(e.name)<0))d+=e.name;if(m&&(f<2||(e.stack||'').indexOf(m)<0))d+=(d?': ':'')+m;if(e.lineNumber)l+='Line '+e.lineNumber;if(e.columnNumber)l+=', Column'+e.columnNumber;if(e.fileName)l+=(l?' ':'')+'in '+e.fileName;if(e.stack&&f>=2)s=e.stack;s_log(0,t);if(d)s_log(0,d);if(l)s_log(0,l);if(s)s_log(0,s)}}\nif(!W.s_log)W.s_log=function(l){var W=window,A=W.$AAD||{},f=A.$logLevel,n=[],i,v,t;if(W.s_clog&&(typeof f=='number'?f:0)>=l){n.push('-o');for(i=1;i<arguments.length;i++){v=arguments[i];t=typeof v;switch(t){case'object':n.push([v]);break;case'function':break;default:n.push(v);break}}s_clog.apply(this,n)}return''}\nif(!W.s_logSep)W.s_logSep=function(n,c){if(!c)c='=';var t=function(n){return n<10?'0'+n:''+n},p=function(n){while(n-->0)o+=c},d=new Date(),o='';p(30);o+=' '+d.getFullYear()+'.'+t(d.getMonth()+1)+'.'+t(d.getDate())+' '+t(d.getHours())+':'+t(d.getMinutes())+':'+t(d.getSeconds())+'.'+t(parseInt(''+(d%1000)/10))+' ';p(30);s_log(n,o)}\nif(!W.s_startTimer)W.s_startTimer=function(){var n=new Date().getTime();W=window,O='object',A=W.$AAD&&typeof W.$AAD==O?W.$AAD:{};A.$msTimer=n}\nif(!W.s_stopTimer)W.s_stopTimer=function(){var n=new Date().getTime(),W=window,O='object',A=W.$AAD&&typeof W.$AAD==O?W.$AAD:{};var o=$AAD.$msTimer;A.$msTimer='';return o&&typeof o=='number'?n-o:0}\nif(!W.s_getP)W.s_getP=function(p,t){var v,u,S='string',N='number',B='boolean';if(arguments.length>0){try{v=eval('window.'+p);if(arguments.length>1&&typeof t==S){try{switch(t){case S:v=v.String();if(typeof v!=t)v='';break;case N:v=typeof v==S||typeof v==B||typeof v==N?v.Number():Number('');break;case B:v=v.Boolean();break;default:v=u;break}}catch(e){v=u}}}catch(e){v=u}}return v}\nif(!W.s_setP)W.s_setP=function(p,v){try{var o=window,r=new RegExp(\"\\\\[[\\'\\\"]?([^\\\\]\\'\\\"]+)[\\'\\\"]?\\\\]\"),i,a=arguments,l,e={name:'UserException'},I=function(v){return/^[0-9]+$/.test(v)?Number(v):v};s_log(4,'s_setP( \"'+p+'\" ,',v,')');if(a.length==2&&p&&typeof p=='string'){p=p.replace(/\\[\\]/g,'[@]');for(i=0;i<99&&p.match(r);i++)p=p.replace(r,'.$1');p=p.split('.');for(i=0,c=o;i<p.length-1;i++){a=I(p[i]);if(a=='@')a=o.length||0;if(typeof o[a]!='object'){n=I(p[i+1]);o[a]=n=='@'||!isNaN(n)?[]:{}}o=o[a]}a=I(p[i]);if(a=='@')a=o.length;o[a]=v}}catch(e){s_logE(e,'function s_setP('+(typeof p=='string'?'\"'+p+'\",':'?,')+(typeof v!='object'&&typeof v!='function'?v:'[object]')+')')}return v};\n\n\n// AUTHOR: Copyright 2004-2016 Rawsoft, Inc. All Rights Reserved\n// DESCRIPTION: Helper functions for data layer\n// UPDATED: 08/12/2017\n/************************** RAWSOFT CUSTOM FUNCTIONS *************************/\n\nvar _globalMessagePrefix = 'BN: ';\nvar _globalObjectName = 'BNAnalytics';\nvar W = eval('window');\nW[_globalObjectName] = (W[_globalObjectName] || {});\nW[_globalObjectName].Logs = (W[_globalObjectName].Logs || []);\nW[_globalObjectName].IsMobile = (W.location.pathname.toLowerCase().indexOf('/mobile') === 0 || W.location.host === 'm.barnesandnoble.com' || (s_getP('digitalData.page.pageInfo.isMobile') || false) || (s_getP('digitalData.page.pageInfo.isPhone') || false));\nW[_globalObjectName].IsResponsive = (_satellite.getVar('platformName').indexOf('responsive') > - 1 || W.location.host.indexOf('responsive-') > -1 || false);\nW[_globalObjectName].Version = 7.50;\n\n// DEFER\n// Should we delay scripts and other injections to keep page fast\n// Only do this if yottaa isn't running as it does the same thing, no need to repeat efforts\nW[_globalObjectName].DeferInjections = (_satellite.cookie.get('yottaaTest') && _satellite.cookie.get('yottaaTest') !== 'yottaa');\n\n// Whether or not debug messages should be logged\nW[_globalObjectName].EnableDebugLogging = true;\n\n/************************** BARNES AND NOBLE GLOBAL FUNCTIONS *************************/\n// Global functions, some of these could be data elements, those without parameters\n// UPDATE HERE BELOW\n\nW[_globalObjectName].isMember = function () {\n\tvar results = false,\n\t\tcc = _satellite.getVar('customerCohort');\n\tif (cc && cc.toLowerCase() != 'non-members') {\n\t\tresults = true;\n\t}\n\treturn results;\n};\n\nW[_globalObjectName].isProductPage = function () {\n\tvar success = false;\n\ttry {\n\t\tvar pt = _satellite.getVar('pageType');\n\t\tvar sku = _satellite.getVar('sku');\n\t\tsuccess = (pt === 'pdp' || pt === 'product') && (typeof (sku) !== 'undefined') && sku.length > 0;\n\t} catch (e) {}\n\treturn success;\n};\n\nW[_globalObjectName].getProductsForAdobe = function (price) {\n\t// This only works for the PD Page, so only use it then\n\tvar prods = '';\n\ttry {\n\t\t// use classifications\n\t\tvar req_eVar15 = (_satellite.getVar('req_eVar15') || '');\n\t\tvar req_eVar62 = (_satellite.getVar('productAvailability') || '');\n\t\tvar req_eVar61 = (_satellite.getVar('productRatingReviews') || '');\n\t\tvar req_eVar39 = (_satellite.getVar('bookGraphProductSku') + '~' + _satellite.getVar('sku'));\n\t\tvar req_eVar31 = (_satellite.getVar('pickUpInStoreStatus') || '');\n\n\t\tvar eventN = [];\n\t\tif (_satellite.getVar('productIsSearchAugmented') == true) {\n\t\t\teventN.push('event75=1');\n\t\t}\n\n\t\tvar eVarN = [];\n\t\teVarN.push(\"evar61=\" + req_eVar61);\n\t\teVarN.push(\"evar62=\" + req_eVar62);\n\t\teVarN.push(\"evar15=\" + req_eVar15);\n\t\teVarN.push(\"evar39=\" + req_eVar39);\n\t\teVarN.push(\"evar31=\" + req_eVar31);\n\t\teVarN.push(\"evar37=\" + _satellite.getVar('referrerSearchTerm'));\n\n\t\t// \"Category;Product;Quantity;Price;eventN=X[|eventN2=X2];eVarN=merch_category[|eVarN2=merch_category2]\"\n\t\tprods += \";\" + _satellite.getVar('sku') + \";;\" + (price || _satellite.getVar('productPrice')) + \";\" + eventN.join('|') + \";\" + eVarN.join('|');\n\n\t} catch (e) {}\n\treturn prods;\n};\n\nW[_globalObjectName].getCartProductsForAdobeFromDL = function () {\n\tvar cart = window.s_getP('digitalData.cart'),\n\t\tprods = '';\n\tif (cart && cart.item) {\n\t\tvar i, p;\n\t\tfor (i = 0; i < cart.item.length; i++) { //for each item in cart\n\t\t\t// + ';;' + (cart.item[i].price.basePrice || 'zero');\n\t\t\t//p = \";\" + cart.item[i].productInfo.sku;\n\t\t\tp = W[_globalObjectName].getCurrentProductsForAdobeFromDL(cart.item[i]);\n\t\t\tif (p) {\n\t\t\t\tprods = (prods ? (prods + ',') : '') + p;\n\t\t\t}\n\t\t}\n\t}\n\treturn prods;\n};\n\nW[_globalObjectName].getCurrentProductsForAdobeFromDL = function (prod) {\n\t// NOTE: Incomplete for Jira(3611,3612,3613) - price missing\n\t// BUG: The format of digitalData.product & digibalData.event.product is not the same\n\t// \"Category;Product;Quantity;Price;eventN=X[|eventN2=X2];eVarN=merch_category[|eVarN2=merch_category2]\"\n\tprod = (prod || window.s_getP('digitalData.product[0]'));\n\tvar products = '';\n\ttry {\n\t\tvar rating = W.r_getByPath(prod, 'attributes.rating', 'zero');\n\t\tvar reviews = W.r_getByPath(prod, 'attributes.reviews', 'zero');\n\t\tvar rating_reviews = (rating + ':' + reviews);\n\t\tvar qty = W.r_getByPath(prod, 'productInfo.quantity', '1');\n\n\t\tvar pickUpInStoreStatus = W.r_getByPath(prod, 'attributes.pickupInStoreStatus', '');\n\t\tvar productAvailability = W[_globalObjectName].getProductAvailability(prod);\n\t\tvar isInStorePickup = W.r_getByPath(prod, 'attributes.isInStorePickup', false);\n\n\t\t// format the data\n\t\tvar price = W.r_getByPath(prod, 'price.basePrice', 0);\n\n\t\t// product syntax Event\n\t\tvar eventN = (isInStorePickup ? 'event159=1' : 'event160=1');\n\t\tvar eVarN = \"evar61=\" + rating_reviews + \"|evar62=\" + productAvailability + \"|evar31=\" + pickUpInStoreStatus;\n\n\t\t// build the string\n\t\tproducts = (typeof (prod.category) != 'undefined' ? prod.category.productType : '');\n\t\tproducts += \";\" + prod.productInfo.sku + \";\" + qty + \";\" + (price || 'zero') + \";\" + eventN + \";\" + eVarN;\n\n\t\t// NOTE: WE need to update this to throw onError instead since we are not using FoxMetrics anymore\n\t\t// DEBUG: Looks like we are having scenarios where sku is missing for product views\n\t\t// add to cart, cart view and etc...\n\t\tif (typeof (_fxm) !== 'undefined' && W.r_getByPath(prod, 'productInfo.sku', '') === '') {\n\t\t\tthrow 'Missing SKU in data layer.';\n\t\t}\n\t} catch (e) {\n\t\t// NOTE: WE need to update this to throw onError instead since we are not using FoxMetrics anymore\n\t\tif (typeof (_fxm) !== 'undefined') {\n\t\t\t_fxm.events.push(['_fxm.pages.error', e.message, e.code]);\n\t\t}\n\t}\n\n\treturn products;\n};\n\n\n\n\nW[_globalObjectName].getCartOpen = function (s, cookieName) {\n\t// Will append scOpen if needed\n\t// The adobe plugin does not work and secondly there are other unique scenarios for BN\n\t// We will however use the same cookie name to keep things consistent\n\tvar sEvents = (s.events ? s.events : ''),\n\t\tt = new Date();\n\n\t// every 30 minutes - session time\n\tt.setTime(t.getTime() + 1800000);\n\n\t// do we have scAdd\n\tif (sEvents.indexOf('scAdd') > -1 && sEvents.indexOf('scOpen') < 0 && !s.c_r(cookieName)) {\n\t\tsEvents += ',scOpen';\n\t\tif (!s.c_w(cookieName, 1, t)) {\n\t\t\ts.c_w(cookieName, 1, 0);\n\t\t}\n\t}\n\n\t// do we have scView\n\tif (sEvents.indexOf('scView') > -1 && sEvents.indexOf('scOpen') < 0 && !s.c_r(cookieName)) {\n\t\tvar cartItems = window.s_getP('digitalData.cart.item');\n\t\tif (cartItems && cartItems.length > 0) {\n\t\t\tsEvents += ',scOpen';\n\t\t\tif (!s.c_w(cookieName, 1, t)) {\n\t\t\t\ts.c_w(cookieName, 1, 0);\n\t\t\t}\n\t\t}\n\t}\n\n\t// If the user makes a purchase then reset scOpen\n\tif (sEvents.indexOf('purchase') > -1) {\n\t\tt = new Date();\n\t\tt.setTime(t.getTime() + 10000);\n\t\tif (s.c_r(cookieName) || sEvents.indexOf('scOpen') > -1) {\n\t\t\tif (!s.c_w(cookieName, '', t)) {\n\t\t\t\ts.c_w(cookieName, '', 0);\n\t\t\t}\n\t\t}\n\t}\n\n\treturn sEvents;\n};\n\nW[_globalObjectName].getReportingSuiteIDs = function() {\n    /// <summary>\n    /// Configuring the appropriate reporting suites based on current domain\n    /// DTM automatically looks for \"s_account\" if its found and not empty but not used.\n    /// </summary>\n    /// <returns type=\"\">comma delimited suite id's</returns>\n\n    var isMobile = W[_globalObjectName].IsMobile;\n    var env = (isMobile === true ? 'mobile' : 'full');\n    var sa = 'banglobaldev';\n\n    switch (W.location.hostname.toLowerCase()) {\n        case 'www.barnesandnoble.com':\n        case 'barnesandnoble.com':\n        case 'nook.barnesandnoble.com':\n        case 'stores.barnesandnoble.com':\n        case 'www.nookarticles.com':\n        case 'm.barnesandnoble.com':\n        case 'apps.barnesandnoble.com':\n        case 'giftguide.barnesandnoble.com':\n        case 'read.barnesandnoble.com':\n        case 'specialists.barnesandnoble.com':\n            sa = 'banglobalprod';\n            break;\n        case 'www-dev.barnesandnoble.com':\n        case 'responsive-dev.barnesandnoble.com':\n            sa = 'banglobaldev';\n            break;\n        case 'www-test.barnesandnoble.com':\n        case 'qa-apps.barnesandnoble.com':\n        case 'www-r17.barnesandnoble.com':\n        case 'responsive-qa.barnesandnoble.com':\n            sa = 'banglobalqa';\n            break;\n        case 'faf.barnesandnoble.com':\n            sa = 'banglobalstage';\n            break;\n        case 'mpreprod.barnesandnoble.com':\n        case 'http://mbarnesandnoble.skavaone.com/':\n            sa = 'banglobaldev';\n            break;\n        default:\n            sa = 'banglobaldev';\n            break;\n    }\n\n    // The business wants to exclude all users that match the following rules\n    // as they have been determined to be mostly bots, pipe them into a different\n    // report suite. If the need to drop the call arises, the change needs to be made\n    // in doPlugins.\n    //if(typeof(navigator.platform) !== 'undefined' && navigator.platform === 'Linux x86_64'){\n    //if(r_getByPath(window,'navigator.platform') === 'Linux x86_64'){\n    //\tsa='banglobalbots';\n    //}\n\n    return sa;\n};\n\nW[_globalObjectName].IsDevelopment = function () {\n\t// Are we in production?\n\tvar isDev = true;\n\tswitch (W.location.hostname.toLowerCase()) {\n\tcase 'www.barnesandnoble.com':\n\tcase 'barnesandnoble.com':\n\tcase 'nook.barnesandnoble.com':\n\tcase 'stores.barnesandnoble.com':\n\tcase 'apps.barnesandnoble.com':\n\tcase 'm.barnesandnoble.com':\n\tcase 'help.barnesandnoble.com':\n\tcase 'affiliates.barnesandnoble.com':\n\tcase 'careers.barnesandnoble.com':\n\t\tisDev = false;\n\t\tbreak;\n\tdefault:\n\t\tbreak;\n\t}\n\treturn isDev;\n};\n\nW[_globalObjectName].getProductAvailability = function (product) {\n\tvar results;\n\tif (product && product.attributes) {\n\t\t// NOTE: There are only two options now, this will need updates once more is added such as pre-order\n\t\t// or maybe we have a new digitalData.product.attributes.availability Jira Ticket\n\t\tif (product.attributes.notifyWhenStocked) {\n\t\t\tresults = 'notify when in stock';\n\t\t}\n\t\tif (product.attributes.outOfStock) {\n\t\t\tresults = 'out of stock';\n\t\t}\n\t}\n\treturn (results || 'in stock');\n};\n\nW[_globalObjectName].getProductRatingsAndReviews = function (product) {\n\tvar results = 'zero:zero';\n\tif (product && product.attributes) {\n\t\tvar rating = (product.attributes.rating || 'zero');\n\t\tvar reviews = (product.attributes.reviews || 'zero');\n\t\tresults = (rating + ':' + reviews);\n\t}\n\treturn results;\n};\n\n/************************** BARNES AND NOBLE GLOBAL FUNCTIONS *************************/\n// TODO: Need to convert these to use W[_globalObjectName]\n\nif (!W.r_getShoppingCartSkus) {\n\tW.r_getShoppingCartSkus = function () {\n\t\tvar skus = [];\n\t\tif (digitalData.cart && digitalData.cart.item) {\n\t\t\tfor (var i = 0; i < digitalData.cart.item.length; i++) {\n\t\t\t\tskus.push(digitalData.cart.item[i].productInfo.sku);\n\t\t\t}\n\t\t}\n\t\treturn skus;\n\t};\n}\n\nif (!W.r_getTransactionSkus) {\n\tW.r_getTransactionSkus = function () {\n\t\tvar skus = [];\n\t\tvar items = window.r_getByPath(window, 'digitalData.transaction.item');\n\t\tif (items) {\n\t\t\tfor (var i = 0; i < digitalData.transaction.item.length; i++) {\n\t\t\t\tskus.push(digitalData.transaction.item[i].productInfo.sku);\n\t\t\t}\n\t\t}\n\t\treturn skus;\n\t};\n}\n\nif (!W.r_getTransactionTotalQuantity) {\n\tW.r_getTransactionTotalQuantity = function () {\n\t\tvar totalQty = 0;\n\t\tvar items = window.r_getByPath(window, 'digitalData.transaction.item');\n\t\tif (items) {\n\t\t\tfor (var i = 0; i < digitalData.transaction.item.length; i++) {\n\t\t\t\ttotalQty += digitalData.transaction.item[i].quantity;\n\t\t\t}\n\t\t}\n\t\treturn totalQty;\n\t};\n}\n\nif (!W.r_getProductsForAdobeFromDLEvent) {\n\tW.r_getProductsForAdobeFromDLEvent = function (eventAction) {\n\t\t// pulls the last event that matches the specified eventAction\n\t\t// and then parse it for product data into Adobe product data format.\n\t\tvar evt = window.r_findDigitalDataEvent(eventAction);\n\t\tvar products = '';\n\t\tif (evt) {\n\t\t\tproducts = W[_globalObjectName].getCurrentProductsForAdobeFromDL(evt.attributes.product[0]);\n\t\t}\n\t\treturn products;\n\t};\n}\n\n/************************** RAWSOFT CUSTOM UTILITY FUNCTIONS *************************/\n// DO NOT UPDATE HERE BELOW\n/*************************************************************************************/\n\n// FASTMD5 (r_md5(data,ascii,arrayOutput)) - in a closure\n// ascii - set true if data consists only of ASCII chars to improve performance\n// arrayOutput - if true, then the result is an array of chars (not a string)\n(function (g) {\n\tvar $0 = [], // result\n\t\t$1 = [], // tail\n\t\t$2 = [], // blocks\n\t\t$3 = [], // s1\n\t\t$4 = (\"0123456789abcdef\").split(\"\"), // hex\n\t\t$5 = [], // s2\n\t\t$6 = [], // state\n\t\t$7 = false, // is state created\n\t\t$8 = 0, // len_cache\n\t\t$9 = 0, // len\n\t\tBUF = [];\n\n\t// use Int32Array if defined\n\tif (g.Int32Array) {\n\t\t$1 = new Int32Array(16);\n\t\t$2 = new Int32Array(16);\n\t\t$3 = new Int32Array(4);\n\t\t$5 = new Int32Array(4);\n\t\t$6 = new Int32Array(4);\n\t\tBUF = new Int32Array(4);\n\t} else {\n\t\tvar i;\n\t\tfor (i = 0; i < 16; i++) {\n\t\t\t$1[i] = $2[i] = 0;\n\t\t}\n\t\tfor (i = 0; i < 4; i++) {\n\t\t\t$3[i] = $5[i] = $6[i] = BUF[i] = 0;\n\t\t}\n\t}\n\n\t// fill s1\n\t$3[0] = 128;\n\t$3[1] = 32768;\n\t$3[2] = 8388608;\n\t$3[3] = -2147483648;\n\n\t// fill s2\n\t$5[0] = 0;\n\t$5[1] = 8;\n\t$5[2] = 16;\n\t$5[3] = 24;\n\n\tfunction encode(s) {\n\t\tvar utf = \"\",\n\t\t\tenc = \"\",\n\t\t\tstart = 0,\n\t\t\tend = 0;\n\n\t\tfor (var i = 0, j = s.length; i < j; i++) {\n\t\t\tvar c = s.charCodeAt(i);\n\n\t\t\tif (c < 128) {\n\t\t\t\tend++;\n\t\t\t\tcontinue;\n\t\t\t} else if (c < 2048) {\n\t\t\t\tenc = String.fromCharCode((c >> 6) | 192, (c & 63) | 128);\n\t\t\t} else {\n\t\t\t\tenc = String.fromCharCode((c >> 12) | 224, ((c >> 6) & 63) | 128, (c & 63) | 128);\n\t\t\t}\n\n\t\t\tif (end > start) {\n\t\t\t\tutf += s.slice(start, end);\n\t\t\t}\n\n\t\t\tutf += enc;\n\t\t\tstart = end = i + 1;\n\t\t}\n\n\t\tif (end > start) {\n\t\t\tutf += s.slice(start, j);\n\t\t}\n\n\t\treturn utf;\n\t}\n\n\tfunction md5_update(s) {\n\t\tvar i, I;\n\n\t\ts += \"\";\n\t\t$7 = false;\n\t\t$8 = $9 = s.length;\n\n\t\tif ($9 > 63) {\n\t\t\tgetBlocks(s.substring(0, 64));\n\t\t\tmd5cycle($2);\n\t\t\t$7 = true;\n\n\t\t\tfor (i = 128; i <= $9; i += 64) {\n\t\t\t\tgetBlocks(s.substring(i - 64, i));\n\t\t\t\tmd5cycleAdd($2);\n\t\t\t}\n\n\t\t\ts = s.substring(i - 64);\n\t\t\t$9 = s.length;\n\t\t}\n\n\t\t$1[0] = $1[1] = $1[2] = $1[3] =\n\t\t\t$1[4] = $1[5] = $1[6] = $1[7] =\n\t\t\t$1[8] = $1[9] = $1[10] = $1[11] =\n\t\t\t$1[12] = $1[13] = $1[14] = $1[15] = 0;\n\n\t\tfor (i = 0; i < $9; i++) {\n\t\t\tI = i & 3;\n\t\t\tif (I === 0) {\n\t\t\t\t$1[i >> 2] = s.charCodeAt(i);\n\t\t\t} else {\n\t\t\t\t$1[i >> 2] |= s.charCodeAt(i) << $5[I];\n\t\t\t}\n\t\t}\n\t\t$1[i >> 2] |= $3[i & 3];\n\n\t\tif (i > 55) {\n\t\t\tif ($7) {\n\t\t\t\tmd5cycleAdd($1);\n\t\t\t} else {\n\t\t\t\tmd5cycle($1);\n\t\t\t\t$7 = true;\n\t\t\t}\n\n\t\t\treturn md5cycleAdd([0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, $8 << 3, 0]);\n\t\t}\n\n\t\t$1[14] = $8 << 3;\n\n\t\tif ($7) {\n\t\t\tmd5cycleAdd($1);\n\t\t} else {\n\t\t\tmd5cycle($1);\n\t\t}\n\t}\n\n\tfunction getBlocks(s) {\n\t\tfor (var i = 16; i--;) {\n\t\t\tvar I = i << 2;\n\t\t\t$2[i] = s.charCodeAt(I) + (s.charCodeAt(I + 1) << 8) + (s.charCodeAt(I + 2) << 16) + (s.charCodeAt(I + 3) << 24);\n\t\t}\n\t}\n\n\tfunction md5(data, ascii, arrayOutput) {\n\t\tmd5_update(ascii ? data : encode(data));\n\n\t\tvar tmp = $6[0];\n\t\t$0[1] = $4[tmp & 15];\n\t\t$0[0] = $4[(tmp >>= 4) & 15];\n\t\t$0[3] = $4[(tmp >>= 4) & 15];\n\t\t$0[2] = $4[(tmp >>= 4) & 15];\n\t\t$0[5] = $4[(tmp >>= 4) & 15];\n\t\t$0[4] = $4[(tmp >>= 4) & 15];\n\t\t$0[7] = $4[(tmp >>= 4) & 15];\n\t\t$0[6] = $4[(tmp >>= 4) & 15];\n\n\t\ttmp = $6[1];\n\t\t$0[9] = $4[tmp & 15];\n\t\t$0[8] = $4[(tmp >>= 4) & 15];\n\t\t$0[11] = $4[(tmp >>= 4) & 15];\n\t\t$0[10] = $4[(tmp >>= 4) & 15];\n\t\t$0[13] = $4[(tmp >>= 4) & 15];\n\t\t$0[12] = $4[(tmp >>= 4) & 15];\n\t\t$0[15] = $4[(tmp >>= 4) & 15];\n\t\t$0[14] = $4[(tmp >>= 4) & 15];\n\n\t\ttmp = $6[2];\n\t\t$0[17] = $4[tmp & 15];\n\t\t$0[16] = $4[(tmp >>= 4) & 15];\n\t\t$0[19] = $4[(tmp >>= 4) & 15];\n\t\t$0[18] = $4[(tmp >>= 4) & 15];\n\t\t$0[21] = $4[(tmp >>= 4) & 15];\n\t\t$0[20] = $4[(tmp >>= 4) & 15];\n\t\t$0[23] = $4[(tmp >>= 4) & 15];\n\t\t$0[22] = $4[(tmp >>= 4) & 15];\n\n\t\ttmp = $6[3];\n\t\t$0[25] = $4[tmp & 15];\n\t\t$0[24] = $4[(tmp >>= 4) & 15];\n\t\t$0[27] = $4[(tmp >>= 4) & 15];\n\t\t$0[26] = $4[(tmp >>= 4) & 15];\n\t\t$0[29] = $4[(tmp >>= 4) & 15];\n\t\t$0[28] = $4[(tmp >>= 4) & 15];\n\t\t$0[31] = $4[(tmp >>= 4) & 15];\n\t\t$0[30] = $4[(tmp >>= 4) & 15];\n\n\t\treturn arrayOutput ? $0 : $0.join(\"\");\n\t}\n\n\tfunction R(q, a, b, x, s1, s2, t) {\n\t\ta += q + x + t;\n\t\treturn ((a << s1 | a >>> s2) + b) << 0;\n\t}\n\n\tfunction md5cycle(k) {\n\t\tmd5_rounds(0, 0, 0, 0, k);\n\n\t\t$6[0] = (BUF[0] + 1732584193) << 0;\n\t\t$6[1] = (BUF[1] - 271733879) << 0;\n\t\t$6[2] = (BUF[2] - 1732584194) << 0;\n\t\t$6[3] = (BUF[3] + 271733878) << 0;\n\t}\n\n\tfunction md5cycleAdd(k) {\n\t\tmd5_rounds($6[0], $6[1], $6[2], $6[3], k);\n\n\t\t$6[0] = (BUF[0] + $6[0]) << 0;\n\t\t$6[1] = (BUF[1] + $6[1]) << 0;\n\t\t$6[2] = (BUF[2] + $6[2]) << 0;\n\t\t$6[3] = (BUF[3] + $6[3]) << 0;\n\t}\n\n\tfunction md5_rounds(a, b, c, d, k) {\n\t\tvar bc, da;\n\n\t\tif ($7) {\n\t\t\ta = R(((c ^ d) & b) ^ d, a, b, k[0], 7, 25, -680876936);\n\t\t\td = R(((b ^ c) & a) ^ c, d, a, k[1], 12, 20, -389564586);\n\t\t\tc = R(((a ^ b) & d) ^ b, c, d, k[2], 17, 15, 606105819);\n\t\t\tb = R(((d ^ a) & c) ^ a, b, c, k[3], 22, 10, -1044525330);\n\t\t} else {\n\t\t\ta = k[0] - 680876937;\n\t\t\ta = ((a << 7 | a >>> 25) - 271733879) << 0;\n\t\t\td = k[1] - 117830708 + ((2004318071 & a) ^ -1732584194);\n\t\t\td = ((d << 12 | d >>> 20) + a) << 0;\n\t\t\tc = k[2] - 1126478375 + (((a ^ -271733879) & d) ^ -271733879);\n\t\t\tc = ((c << 17 | c >>> 15) + d) << 0;\n\t\t\tb = k[3] - 1316259209 + (((d ^ a) & c) ^ a);\n\t\t\tb = ((b << 22 | b >>> 10) + c) << 0;\n\t\t}\n\n\t\ta = R(((c ^ d) & b) ^ d, a, b, k[4], 7, 25, -176418897);\n\t\td = R(((b ^ c) & a) ^ c, d, a, k[5], 12, 20, 1200080426);\n\t\tc = R(((a ^ b) & d) ^ b, c, d, k[6], 17, 15, -1473231341);\n\t\tb = R(((d ^ a) & c) ^ a, b, c, k[7], 22, 10, -45705983);\n\t\ta = R(((c ^ d) & b) ^ d, a, b, k[8], 7, 25, 1770035416);\n\t\td = R(((b ^ c) & a) ^ c, d, a, k[9], 12, 20, -1958414417);\n\t\tc = R(((a ^ b) & d) ^ b, c, d, k[10], 17, 15, -42063);\n\t\tb = R(((d ^ a) & c) ^ a, b, c, k[11], 22, 10, -1990404162);\n\t\ta = R(((c ^ d) & b) ^ d, a, b, k[12], 7, 25, 1804603682);\n\t\td = R(((b ^ c) & a) ^ c, d, a, k[13], 12, 20, -40341101);\n\t\tc = R(((a ^ b) & d) ^ b, c, d, k[14], 17, 15, -1502002290);\n\t\tb = R(((d ^ a) & c) ^ a, b, c, k[15], 22, 10, 1236535329);\n\n\t\ta = R(((b ^ c) & d) ^ c, a, b, k[1], 5, 27, -165796510);\n\t\td = R(((a ^ b) & c) ^ b, d, a, k[6], 9, 23, -1069501632);\n\t\tc = R(((d ^ a) & b) ^ a, c, d, k[11], 14, 18, 643717713);\n\t\tb = R(((c ^ d) & a) ^ d, b, c, k[0], 20, 12, -373897302);\n\t\ta = R(((b ^ c) & d) ^ c, a, b, k[5], 5, 27, -701558691);\n\t\td = R(((a ^ b) & c) ^ b, d, a, k[10], 9, 23, 38016083);\n\t\tc = R(((d ^ a) & b) ^ a, c, d, k[15], 14, 18, -660478335);\n\t\tb = R(((c ^ d) & a) ^ d, b, c, k[4], 20, 12, -405537848);\n\t\ta = R(((b ^ c) & d) ^ c, a, b, k[9], 5, 27, 568446438);\n\t\td = R(((a ^ b) & c) ^ b, d, a, k[14], 9, 23, -1019803690);\n\t\tc = R(((d ^ a) & b) ^ a, c, d, k[3], 14, 18, -187363961);\n\t\tb = R(((c ^ d) & a) ^ d, b, c, k[8], 20, 12, 1163531501);\n\t\ta = R(((b ^ c) & d) ^ c, a, b, k[13], 5, 27, -1444681467);\n\t\td = R(((a ^ b) & c) ^ b, d, a, k[2], 9, 23, -51403784);\n\t\tc = R(((d ^ a) & b) ^ a, c, d, k[7], 14, 18, 1735328473);\n\t\tb = R(((c ^ d) & a) ^ d, b, c, k[12], 20, 12, -1926607734);\n\n\t\tbc = b ^ c;\n\t\ta = R(bc ^ d, a, b, k[5], 4, 28, -378558);\n\t\td = R(bc ^ a, d, a, k[8], 11, 21, -2022574463);\n\t\tda = d ^ a;\n\t\tc = R(da ^ b, c, d, k[11], 16, 16, 1839030562);\n\t\tb = R(da ^ c, b, c, k[14], 23, 9, -35309556);\n\t\tbc = b ^ c;\n\t\ta = R(bc ^ d, a, b, k[1], 4, 28, -1530992060);\n\t\td = R(bc ^ a, d, a, k[4], 11, 21, 1272893353);\n\t\tda = d ^ a;\n\t\tc = R(da ^ b, c, d, k[7], 16, 16, -155497632);\n\t\tb = R(da ^ c, b, c, k[10], 23, 9, -1094730640);\n\t\tbc = b ^ c;\n\t\ta = R(bc ^ d, a, b, k[13], 4, 28, 681279174);\n\t\td = R(bc ^ a, d, a, k[0], 11, 21, -358537222);\n\t\tda = d ^ a;\n\t\tc = R(da ^ b, c, d, k[3], 16, 16, -722521979);\n\t\tb = R(da ^ c, b, c, k[6], 23, 9, 76029189);\n\t\tbc = b ^ c;\n\t\ta = R(bc ^ d, a, b, k[9], 4, 28, -640364487);\n\t\td = R(bc ^ a, d, a, k[12], 11, 21, -421815835);\n\t\tda = d ^ a;\n\t\tc = R(da ^ b, c, d, k[15], 16, 16, 530742520);\n\t\tb = R(da ^ c, b, c, k[2], 23, 9, -995338651);\n\n\t\ta = R(c ^ (b | ~d), a, b, k[0], 6, 26, -198630844);\n\t\td = R(b ^ (a | ~c), d, a, k[7], 10, 22, 1126891415);\n\t\tc = R(a ^ (d | ~b), c, d, k[14], 15, 17, -1416354905);\n\t\tb = R(d ^ (c | ~a), b, c, k[5], 21, 11, -57434055);\n\t\ta = R(c ^ (b | ~d), a, b, k[12], 6, 26, 1700485571);\n\t\td = R(b ^ (a | ~c), d, a, k[3], 10, 22, -1894986606);\n\t\tc = R(a ^ (d | ~b), c, d, k[10], 15, 17, -1051523);\n\t\tb = R(d ^ (c | ~a), b, c, k[1], 21, 11, -2054922799);\n\t\ta = R(c ^ (b | ~d), a, b, k[8], 6, 26, 1873313359);\n\t\td = R(b ^ (a | ~c), d, a, k[15], 10, 22, -30611744);\n\t\tc = R(a ^ (d | ~b), c, d, k[6], 15, 17, -1560198380);\n\t\tb = R(d ^ (c | ~a), b, c, k[13], 21, 11, 1309151649);\n\t\ta = R(c ^ (b | ~d), a, b, k[4], 6, 26, -145523070);\n\t\td = R(b ^ (a | ~c), d, a, k[11], 10, 22, -1120210379);\n\t\tc = R(a ^ (d | ~b), c, d, k[2], 15, 17, 718787259);\n\t\tb = R(d ^ (c | ~a), b, c, k[9], 21, 11, -343485551);\n\n\t\tBUF[0] = a;\n\t\tBUF[1] = b;\n\t\tBUF[2] = c;\n\t\tBUF[3] = d;\n\t}\n\n\tg.r_md5 = (g.r_md5 || md5);\n\n}(window));\n\n\nif (!W.r_utf8_encode) {\n\tW.r_utf8_encode = function (data) {\n\t\treturn window.unescape(window.encodeURIComponent(data));\n\t};\n}\n\nif (!W.r_utf8_decode) {\n\tW.r_utf8_decode = function (data) {\n\t\treturn window.decodeURIComponent(window.escape(data));\n\t};\n}\n\nif (!W.r_removeQueryParam) {\n\tW.r_removeQueryParam = function (key, sourceURL) {\n\t\tvar rtn = sourceURL.split(\"?\")[0],\n\t\t\tparam, params_arr = [],\n\t\t\tqueryString = (sourceURL.indexOf(\"?\") !== -1) ? sourceURL.split(\"?\")[1] : \"\";\n\t\tif (queryString !== \"\") {\n\t\t\tparams_arr = queryString.split(\"&\");\n\t\t\tfor (var i = params_arr.length - 1; i >= 0; i -= 1) {\n\t\t\t\tparam = params_arr[i].split(\"=\")[0];\n\t\t\t\tif (param === key) {\n\t\t\t\t\tparams_arr.splice(i, 1);\n\t\t\t\t}\n\t\t\t}\n\t\t\trtn = (params_arr.length > 0 ? (rtn + \"?\" + params_arr.join(\"&\")) : rtn);\n\t\t}\n\t\treturn rtn;\n\t};\n}\n\nif (!W.r_round) {\n\tW.r_round = function (value, decimals, enforce) {\n\t\tvar num = Number(Math.round(value + 'e' + decimals) + 'e-' + decimals);\n\t\tif (!enforce) {\n\t\t\treturn num;\n\t\t}\n\n\t\tvar exponent = Math.pow(10, decimals);\n\t\tnum = Math.round((num * exponent)).toString();\n\t\treturn Number(num.slice(0, -1 * decimals) + '.' + num.slice(-1 * decimals));\n\t};\n}\n\nif (!W.r_extractDomain) {\n\tW.r_extractDomain = function (url) {\n\t\tvar domain = (url.indexOf(\"//\") > -1) ? url.split('/')[2] : url.split('/')[0];\n\t\tdomain = domain.split(':')[0];\n\t\treturn domain || url;\n\t};\n}\n\nif (!W.r_injectImage) {\n\tW.r_injectImage = function (url, callback, cacheBuster, delay) {\n\t\tdelay = ((typeof (delay) === 'undefined' || W[_globalObjectName].DeferInjections !== true) ? 0 : delay);\n\t\twindow.setTimeout(function () {\n\t\t\tif (cacheBuster && cacheBuster === true) {\n\t\t\t\turl += '&_=' + new Date().getTime();\n\t\t\t}\n\t\t\tvar img = new window.Image();\n\t\t\tif (typeof (callback) !== 'undefined') {\n\t\t\t\timg.onload = callback;\n\t\t\t}\n\t\t\timg.style.display = 'none';\n\t\t\timg.style.width = \"1px\";\n\t\t\timg.style.height = \"1px\";\n\t\t\timg.src = url;\n\n\t\t\t// log message to console for debug purposes\n\t\t\tif (delay > 0 && url) {\n\t\t\t\twindow.r_dtm_notify('DEFER: ' + url + ' for ' + delay + 'ms.');\n\t\t\t}\n\t\t}, delay);\n\t};\n}\n\nif (!W.r_injectScript) {\n\tW.r_injectScript = function (url, callback, cacheBuster, delay, title) {\n\t\tdelay = ((typeof (delay) === 'undefined' || W[_globalObjectName].DeferInjections !== true) ? 0 : delay);\n\t\twindow.setTimeout(function () {\n\n\t\t\t// if we have a url, load it first async before doing anything else\n\t\t\tif (typeof (url) === 'string') {\n\t\t\t\tif (W.jQuery) {\n\t\t\t\t\t$.ajaxSetup({\n\t\t\t\t\t\tcache: !(cacheBuster && cacheBuster === true)\n\t\t\t\t\t});\n\t\t\t\t\t$.getScript(url, callback);\n\t\t\t\t} else {\n\t\t\t\t\t// append cache buster if needed\n\t\t\t\t\tif (cacheBuster && cacheBuster === true) {\n\t\t\t\t\t\turl += (url.indexOf('?') > 0 ? '&_=' : '?_=') + new Date().getTime();\n\t\t\t\t\t}\n\t\t\t\t\t// inject script\n\t\t\t\t\tvar s = document.createElement('script');\n\t\t\t\t\ts.type = 'text/javascript';\n\t\t\t\t\t$(document).find('body').append(s);\n\t\t\t\t\tif (typeof (callback) !== 'undefined') {\n\t\t\t\t\t\ts.onload = callback;\n\t\t\t\t\t}\n\t\t\t\t\ts.async = true;\n\t\t\t\t\ts.src = url;\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\t// if there is no url but we do have a callback then execute it\n\t\t\t\tif (typeof (callback) === 'function') {\n\t\t\t\t\tcallback();\n\t\t\t\t}\n\t\t\t}\n\n\t\t\t// log message to console for debug purposes\n\t\t\tif (delay > 0) {\n\t\t\t\tif (url) {\n\t\t\t\t\twindow.r_dtm_notify('DEFER: ' + url + ' for ' + delay + 'ms.');\n\t\t\t\t} else {\n\t\t\t\t\twindow.r_dtm_notify('DEFER: ' + (title || 'Script') + ' for ' + delay + 'ms.');\n\t\t\t\t}\n\t\t\t}\n\t\t}, delay);\n\t};\n}\n\nif (!W.r_injectIFrame) {\n\tW.r_injectIFrame = function (url, callback, cacheBuster, delay) {\n\t\t// although Iframes load async, they do block onload, so lets try and optimize\n\t\tdelay = ((typeof (delay) === 'undefined' || W[_globalObjectName].DeferInjections !== true) ? 0 : delay);\n\t\twindow.setTimeout(function () {\n\t\t\tif (window.jQuery) {\n\t\t\t\t$('<iframe />', {\n\t\t\t\t\tsrc: url,\n\t\t\t\t\twidth: 1,\n\t\t\t\t\theight: 1,\n\t\t\t\t\tframeborder: 0,\n\t\t\t\t\tstyle: 'display:none'\n\t\t\t\t}).appendTo('body');\n\t\t\t} else {\n\t\t\t\tvar iframe = document.createElement('iframe');\n\t\t\t\t//  width=\"1\" height=\"1\" frameborder=\"0\" style=\"display:none\"\n\t\t\t\t$(document).find('body').append(iframe);\n\t\t\t\tif (typeof (callback) !== 'undefined') {\n\t\t\t\t\ts.onload = callback;\n\t\t\t\t}\n\t\t\t\tif (navigator.userAgent.indexOf(\"MSIE\") === -1) {\n\t\t\t\t\tiframe.src = url;\n\t\t\t\t} else {\n\t\t\t\t\tiframe.location = url;\n\t\t\t\t}\n\n\t\t\t}\n\t\t\t// log message to console for debug purposes\n\t\t\tif (delay > 0 && url) {\n\t\t\t\twindow.r_dtm_notify('DEFER: ' + url + ' for ' + delay + 'ms.');\n\t\t\t}\n\t\t}, delay);\n\t};\n}\n\nif (!W.r_dtm_warn) {\n    W.r_dtm_warn = function(text) {\n        if (window.r_isStagingMode() === true || window.r_isDebugMode() === true) {\n            if (typeof(console) !== 'undefined') {\n                console.warn(_globalMessagePrefix + text);\n            } else {\n                _satellite.notify(text, 2);\n            }\n        }\n        W[_globalObjectName].Logs.push({\n            message: text,\n            type: 'warn'\n        });\n    };\n}\n\nif (!W.r_dtm_error) {\n    W.r_dtm_error = function(text) {\n        if (window.r_isStagingMode() === true || window.r_isDebugMode() === true) {\n            if (typeof(console) !== 'undefined') {\n                console.error(_globalMessagePrefix + text);\n            } else {\n                _satellite.notify(text, 3);\n            }\n        }\n        W[_globalObjectName].Logs.push({\n            message: text,\n            type: 'error'\n        });\n    };\n}\n\nif (!W.r_dtm_notify) {\n    W.r_dtm_notify = function(text) {\n        if (window.r_isStagingMode() === true || window.r_isDebugMode() === true) {\n            if (typeof(console) !== 'undefined') {\n                console.log(_globalMessagePrefix + text);\n            } else {\n                _satellite.notify(text, 1);\n            }\n        }\n        W[_globalObjectName].Logs.push({\n            message: text,\n            type: 'info'\n        });\n    };\n}\n\nif (!W.r_poll) {\n\tW.r_poll = function (fn, callback, errback, timeout, interval) {\n\t\tvar endTime = Number(new Date()) + (timeout || 2000);\n\t\tinterval = interval || 100;\n\n\t\t(function p() {\n\t\t\t// If the condition is met, we're done!\n\t\t\tif (fn()) {\n\t\t\t\tif (typeof (callback) !== 'undefined' && callback) {\n\t\t\t\t\tcallback();\n\t\t\t\t}\n\t\t\t}\n\t\t\t// If the condition isn't met but the timeout hasn't elapsed, go again\n\t\t\telse if (Number(new Date()) < endTime) {\n\t\t\t\twindow.setTimeout(p, interval);\n\t\t\t}\n\t\t\t// Didn't match and too much time, reject!\n\t\t\telse {\n\t\t\t\tif (typeof (errback) !== 'undefined' && errback) {\n\t\t\t\t\terrback(new Error('timed out for ' + fn + ': ' + arguments));\n\t\t\t\t}\n\t\t\t}\n\t\t})();\n\t};\n}\n\nif (!W.r_injectIFrameSafeMode) {\n\tW.r_injectIFrameSafeMode = function (url, callback) {\n\t\tW.r_poll(function () {\n\t\t\tif (document.readyState === 'complete') {\n\t\t\t\tW.r_injectIFrame(url, callback);\n\t\t\t\treturn true;\n\t\t\t}\n\t\t\treturn false;\n\t\t});\n\t};\n}\n\nif (!W.r_injectIFrameAsync) {\n\tW.r_injectIFrameAsync = function (url, callback) {\n\t\tvar d = document;\n\t\tvar iframe = d.body.appendChild(d.createElement('iframe')),\n\t\t\tdoc = iframe.contentWindow.document;\n\n\t\t// style the iframe with some CSS\n\t\tiframe.style.cssText = \"position:absolute;width:0px;height:0px;left:0px;display:none;\";\n\n\t\t// now modify iframe content itself\n\t\tdoc.open().write('<body onload=\"var d = document;d.getElementsByTagName(\\'head\\')[0].appendChild(d.createElement(\\'script\\')).src=\\'' + url + '\\'\">');\n\n\t\t// prep for call back\n\t\tif (typeof (callback) !== 'undefined') {\n\t\t\tdoc.onload = callback;\n\t\t}\n\n\t\t// load iframe\n\t\tdoc.close();\n\t};\n}\n\nif (!W.r_isStagingMode) {\n\tW.r_isStagingMode = function () {\n\t\tif (localStorage) {\n\t\t\treturn localStorage.getItem('sdsat_stagingLibrary') === 'true';\n\t\t}\n\t\treturn false;\n\t};\n}\n\nif (!W.r_isDebugMode) {\n\tW.r_isDebugMode = function () {\n\t\tif (localStorage) {\n\t\t\treturn localStorage.getItem('sdsat_debug') === 'true';\n\t\t}\n\t\treturn false;\n\t};\n}\n\nif (!W.r_findDigitalDataEvent) {\n\tW.r_findDigitalDataEvent = function (eventAction, ifNotProcessed, flagAsProcessed) {\n\t\t// Pulls the first/oldest event from digitalData that matches the eventAction specified\n\t\t// We may need to flag these object as \"processed\" and exclude then in loop\n\t\tifNotProcessed = (ifNotProcessed || false);\n\t\tflagAsProcessed = (flagAsProcessed || false);\n\t\tvar this_evt = null;\n\t\ttry {\n\t\t\tvar eventList = window.s_getP('digitalData.event');\n\t\t\tif (eventList) {\n\t\t\t\tfor (var i = 0, len = eventList.length; i < len; i++) {\n\t\t\t\t\tvar evt = eventList[i];\n\t\t\t\t\tif (evt.eventInfo.eventAction === eventAction) {\n\t\t\t\t\t\tif (ifNotProcessed === false || (ifNotProcessed === true && (evt.eventInfo.processed || false) === false)) {\n\t\t\t\t\t\t\tif (flagAsProcessed === true) {\n\t\t\t\t\t\t\t\teventList[i].eventInfo.processed = true;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tthis_evt = evt;\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t} catch (e) {\n\t\t\tW.r_dtm_error(e.message);\n\t\t}\n\t\treturn this_evt;\n\t};\n}\n\nif (!W.r_getByPath) {\n\tW.r_getByPath = function (obj, path, defaultValue) {\n\t\tif (typeof (obj) !== 'object') {\n\t\t\treturn defaultValue;\n\t\t}\n\n\t\tfor (var i = 0, path = path.split(/[\\[\\]\\.]/), len = path.length; i < len; i++) {\n\t\t\tif (path[i] && obj) {\n\t\t\t\tobj = obj[path[i]];\n\t\t\t}\n\t\t}\n\n\t\treturn (typeof (defaultValue) !== 'undefined' && !obj) ? defaultValue : obj;\n\t};\n}\n\nif (!W.r_validateDirectCallRule) W.r_validateDirectCallRule = function (name, ticket, objectPaths, actionName, actionObjectPaths, printIfFound) {\n\tif (window.r_isStagingMode() === true) {\n\n\t\tvar ticketPrefix = (ticket || 'NoTicketSpecified'),\n\t\t\ti = 0,\n\t\t\thasError = false,\n\t\t\tverbose = (printIfFound || true);\n\n\t\twindow.r_dtm_notify(ticketPrefix + ': ' + name);\n\n\t\t// check that all these object paths exist\n\t\tif (objectPaths && typeof (objectPaths) === 'object') {\n\t\t\tfor (i = 0; i < objectPaths.length; i++) {\n\t\t\t\tif (!window.r_getByPath(window, objectPaths[i])) {\n\t\t\t\t\twindow.r_dtm_error(ticketPrefix + ': Not Defined: ' + objectPaths[i]);\n\t\t\t\t\thasError = true;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\t// Check digitalData.events\n\t\tif (actionName) {\n\t\t\tvar dlEvent = window.r_findDigitalDataEvent(actionName, true);\n\t\t\tif (!dlEvent || dlEvent === null) {\n\t\t\t\twindow.r_dtm_error(ticketPrefix + ': Event Not Found: ' + actionName);\n\t\t\t} else if (window.r_getByPath(dlEvent, 'eventInfo.processed', 'false') === true) {\n\t\t\t\twindow.r_dtm_error(ticketPrefix + ': Event Processed: ' + actionName);\n\t\t\t} else {\n\t\t\t\tif (actionObjectPaths && typeof (actionObjectPaths) === 'object') {\n\t\t\t\t\tfor (i = 0; i < actionObjectPaths.length; i++) {\n\t\t\t\t\t\tif (!window.r_getByPath(dlEvent, actionObjectPaths[i])) {\n\t\t\t\t\t\t\twindow.r_dtm_error(ticketPrefix + ': Missing Event Property: ' + actionObjectPaths[i]);\n\t\t\t\t\t\t\thasError = true;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\t// print\n\t\t\t\tif (verbose === true) {\n\t\t\t\t\twindow.r_dtm_notify(JSON.stringify(dlEvent, undefined, 2));\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n};\n\nif (!W.r_getRandomOrd) {\n\tW.r_getRandomOrd = function () {\n\t\t// Only used for floodlight pixels ord=, tend to be a common number\n\t\t// that is needed\n\t\treturn (String(Math.random())) * 10000000000000;\n\t};\n}\n\nif (!W.r_removeSpecialChars) {\n\tW.r_removeSpecialChars = function (content, toLower) {\n\t\t/// Remove all special chars\n\t\tvar results = window.decodeURIComponent(content).replace(/[`~!@#%^&*()_|+\\=\xf7\xbf?;:'\",<>\\{\\}\\[\\]\\\\\\/]/gi, '');\n\t\tif (toLower && toLower === true && results) {\n\t\t\tresults = results.toLowerCase();\n\t\t}\n\t\treturn results;\n\t};\n}\n\nif (!W.r_createElement) {\n\tW.r_createElement = function (type, attributes, innerHTML) {\n\t\t// Create an element, very useful if needed before JQuery is loaded\n\t\tvar el = document.createElement(type);\n\t\tif (attributes) {\n\t\t\tfor (var k in attributes) {\n\t\t\t\tif (attributes.hasOwnProperty(k)) {\n\t\t\t\t\tel.setAttribute(k, attributes[k]);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\tif (innerHTML) {\n\t\t\tel.innerHTML = innerHTML;\n\t\t}\n\t\treturn el;\n\t};\n}\n\nif (!W.r_hashCode) {\n\tW.r_hashCode = function (data) {\n\t\tvar hash = 0;\n\t\tif (data.length == 0) {\n\t\t\treturn hash;\n\t\t}\n\t\tfor (var i = 0; i < data.length; i++) {\n\t\t\tchar = data.charCodeAt(i);\n\t\t\thash = ((hash << 5) - hash) + char;\n\t\t\thash = hash & hash; // Convert to 32bit integer\n\t\t}\n\t\treturn hash;\n\t};\n}\n\n/************************** RAWSOFT CUSTOM QA FUNCTIONS *************************/\n\nif (_tph.queryParameters.get('adobe_debug', true)) {\n    var debugMode = (_tph.queryParameters.get('adobe_debug', true).toLowerCase() === 'true' ? true : false);\n    _satellite.setDebug(debugMode);\n    window.r_dtm_notify('Debug Mode Enabled = ' + (debugMode ? 'Yes' : 'No'));\n\n    // lets listen to all pushes into digitalData, print them and call DCR's\n    // We are not firing DCRMode at this moment because the developers are already\n    // doing _satellite.track from the old code base but we may need to optimize that in the future.\n    _tph.ext._satellite.attachDigitalData({dcrMode:false});\n\n    // set debug mode while we are working\n    _tph.ext._satellite.setMode('debug',true);\n}\n\nif (_tph.queryParameters.get('adobe_staging', true) && localStorage) {\n    var stagingMode = (_tph.queryParameters.get('adobe_staging', true).toLowerCase() === 'true' ? true : false);\n    localStorage.setItem('sdsat_stagingLibrary', stagingMode);\n    window.r_dtm_notify('Staging Mode Enabled = ' + (stagingMode ? 'Yes' : 'No'));\n}\n\n",
language:"javascript"}},{modulePath:"core/src/lib/actions/customCode.js",settings:{source:'<script type="text/javascript">var inHeadTS=(new Date()).getTime();</script>',language:"html"}},{modulePath:"core/src/lib/actions/customCode.js",settings:{source:"if (_tph.queryParameters.get('hConversionEventId')) {\n  \t// this cookie is currently set on mail.barnesandnoble.com and passed\n  \t// on as a query params over when the user clicks on a link\n  \t// if we call the Epsilon marketing pixel without this cookie it returns a 500 error\n  \t// this used to work but for some reason after friday's code release the \n  \t// cookie is not being set anymore and that's were this comes in.\n    _satellite.setCookie('hConversionEventId', _tph.queryParameters.get('hConversionEventId'), 30);\n}",language:"javascript"}},{modulePath:"core/src/lib/actions/customCode.js",settings:{global:!1,source:"// https://rawsoft.atlassian.net/browse/BN-388\n// Trigger _satellite so it stores it at the session level\n// No other lookback period was specified in the ticket so I'm using session for now\nif(_tph.queryParameters.get('cjevent', true)){\n  var cje = _satellite.getVar('cjevent');\n}",language:"javascript"}},{modulePath:"core/src/lib/actions/customCode.js",settings:{source:"/*\n// Holiday Gift Guide Dec 2019\n// Temporary solution for the holidays\n// https://my.tagpipes.com/dplo/barnesandnoble/aa/b_n_desktop/doc/5d5da11f9a67ea134cd337e2\n//--------------------------------------------------------------------------------------*/\nBNAnalytics.HolidayGiftGuide = (function() {\n\n    var isInit = false;\n\n    var getCleanPageName = function(name) {\n        return name.replace('-', ' ').trim().toLowerCase();\n    };\n\n    var getCleanPageType = function() {\n        var pageType = window.s_getP('digitalData.page.pageInfo.pageType');\n\n        // TEMP: hack\n        if (pageType === 'stacks:holiday gift guide') {\n            pageType = 'holiday gift guide';\n        }\n\n        return pageType;\n    };\n\n    var hasHolidayGiftGuidePageTypeReferrer = function() {\n        var results = false;\n        if (typeof(_satellite.cookie.get('bn_hgg_breadcrumbs')) !== 'undefined') {\n            var crumbs = _satellite.cookie.get('bn_hgg_breadcrumbs').split('|');\n            if (crumbs.length > 1) {\n                // remove the last as we don't care about the current page type\n                crumbs.pop();\n\n                // check if the previous 2 is 'holiday gift guide'\n                results = crumbs.indexOf('holiday gift guide') > -1;\n            }\n        }\n        return results;\n    };\n\n    var handlePageTypeBreadcrumbs = function() {\n\n        //_tph.log('Build PageType Breadcrumbs');\n\n        // lets keep track of bread crumbs in a cookie\n        // this way we can tell which page type they came from so we can attribute ecommerce events\n        // the existing bread crumbs doesn't work, so a new basic one was written\n        // we should consider using _tph.storage later as BN already has enough cookies\n        var crumbs = [];\n        var pageType = getCleanPageType();\n\n        // a way to manage breadcrumbs by page types and cookies\n        if (typeof(_satellite.cookie.get('bn_hgg_breadcrumbs')) !== 'undefined') {\n            crumbs = _satellite.cookie.get('bn_hgg_breadcrumbs').split('|');\n        }\n\n        // save to cookie if the last entry is not the same as the current\n        // we only want to keep uniques by page type\n        if (pageType && crumbs[crumbs.length - 1] !== pageType) {\n            crumbs.push(pageType);\n\n            // lets only keep the last 3\n            if (crumbs.length > 3) {\n                crumbs.shift();\n            }\n\n            _satellite.cookie.set('bn_hgg_breadcrumbs', crumbs.join('|'));\n        }\n    };\n\n    var handleCategoryClickCookie = function() {\n        // if the previous action was a category click\n        if (typeof(_satellite.cookie.get('bn_hgg_category_click')) !== 'undefined') {\n            s.events = s.apl(s.events, 'event221', ',', 2);\n            _satellite.cookie.remove('bn_hgg_category_click');\n        }\n    };\n\n    var handleCategoryClick = function(pathname) {\n\n        // this actually functions very weirdly\n        // on the first click its a full page load and from their on they are dynamic views\n        // so we have to handle both\n        // https://my.tagpipes.com/dplb/barnesandnoble/aa/b_n_desktop/doc/5d5da11f9a67ea134cd337e2/59bad4e79a67ea0e98544bcb\n\n        // first full page\n        $('#myTopnav .tabsWrapper.specialtyItem .groupText>a').on('click', function() {\n            _satellite.cookie.set('bn_hgg_category_click', new Date());\n        });\n\n        // following dynamic pages - use virtual page view\n        $('#myTopnav .tabsWrapper.specialtyItem a.groupLink').on('click', function() {\n\n            //_tph.log('a.groupLink -> click');\n\n            var $this = $(this);\n            var pageName = getCleanPageName($this.data('cta'));\n            if ($this.data('cta') !== 'special-values') {\n\n                // we must be in holiday gift guide\n                window.s_setP('digitalData.page.pageInfo.pageType', 'holiday gift guide');\n                window.s_setP('digitalData.page.pageInfo.pageName', 'holiday gift guide:' + pageName);\n\n                var pg_event = { 'eventInfo': {}, 'category': {}, 'attributes': { 'page': { 'pageInfo': {} } } };\n                pg_event.attributes.page.pageInfo.destinationURL = $this.prop('href');\n                pg_event.attributes.page.pageInfo.pageName = 'holiday gift guide:' + pageName;\n                pg_event.attributes.page.pageInfo.pageType = 'holiday gift guide';\n                pg_event.attributes.page.pageInfo.previousPageName = _satellite.getVar('pageName');\n                pg_event.category.primaryCategory = 'Pages';\n                pg_event.eventInfo.eventAction = 'pageView';\n                pg_event.eventInfo.eventName = 'Virtual Page View';\n                pg_event.eventInfo.timeStamp = new Date();\n\n                digitalData.event = (digitalData.event || []);\n                digitalData.event.push(pg_event);\n\n                s.events = s.apl(s.events, 'event221', ',', 2);\n                _satellite.track('onPageView');\n            }\n        });\n    };\n\n    var setPageInfo = function(pathname) {\n\n        var pageName = s_getP('digitalData.page.pageInfo.pageName');\n\n        window.s_setP('digitalData.page.pageInfo.pageType', 'holiday gift guide');\n        s.channel = 'holiday gift guide';\n\n        switch (window.location.pathname.toLowerCase()) {\n            case '/h/holiday-gift-guide':\n                // https://www.barnesandnoble.com/h/holiday-gift-guide\n                pageName = 'holiday gift guide:home';\n                break;\n            case '/h/holiday-gift-guide-lists':\n                // https://www.barnesandnoble.com/h/holiday-gift-guide-lists?list=for-teens-and-ya\n                var cat_name = getCleanPageName(s_getQueryStr('list'));\n                pageName = 'holiday gift guide:' + cat_name;\n                break;\n            default:\n                break;\n        }\n\n        // set page name\n        s.pageName = pageName;\n        window.s_setP('digitalData.page.pageInfo.pageName', pageName);\n    };\n\n    return {\n        HasHolidayGiftGuidePageTypeReferrer: function() {\n            return hasHolidayGiftGuidePageTypeReferrer();\n        },\n        Init: function() {\n\n            //console.group('Holiday Gift Guide');\n\n            // if it has't been initalized and its the holidaygift guide pages\n            if (isInit === false && window.location.pathname.toLowerCase().startsWith('/h/holiday-gift-guide')) {\n\n                //_tph.log('Init');\n                //_tph.log('Path -> ' + window.location.pathname.toLowerCase());\n\n                // set data layer page name, type, etc..\n                setPageInfo(window.location.pathname.toLowerCase());\n\n                // handle when the user clicks on a category\n                handleCategoryClickCookie();\n                handleCategoryClick();\n\n                isInit = true;\n            } else {\n                //_tph.log('Already Init, will skip.');\n            }\n\n            // handle breadcrumbs for all pages\n            handlePageTypeBreadcrumbs();\n\n            //console.groupEnd();\n        }\n    };\n}());\n",language:"javascript"}}]},{id:"RL2139bab0f4ea470d9a2ddf48853f740b",name:"BOPIS: Text When Item Is Ready Submit",events:[{modulePath:"core/src/lib/events/directCall.js",settings:{identifier:"onBopisTextWhenItemIsReadySubmit"},ruleOrder:50}],conditions:[],actions:[{modulePath:"adobe-analytics/src/lib/actions/setVariables.js",settings:{trackerProperties:{events:[{name:"event157"}]}}},{modulePath:"adobe-analytics/src/lib/actions/sendBeacon.js",settings:{type:"link",linkName:"bopis_text_when_ready",linkType:"o"}}]},{id:"RL008c3d814fc94e90b0fb07bbd71c1748",name:"BOPIS: GEO Detection Failed",events:[{modulePath:"core/src/lib/events/directCall.js",settings:{identifier:"onBopisGeoDetectionFailed"},ruleOrder:50}],conditions:[],actions:[{modulePath:"adobe-analytics/src/lib/actions/setVariables.js",settings:{trackerProperties:{events:[{name:"event135"}]}}},{modulePath:"adobe-analytics/src/lib/actions/sendBeacon.js",settings:{type:"link",linkName:"bopis_geo_detection_failed",linkType:"o"}}]},{id:"RLb85cfbd9066f4e4fa0c6043d9f93ce7f",name:"Page: Thank You",events:[{modulePath:"core/src/lib/events/pageBottom.js",settings:{},ruleOrder:1}],conditions:[{modulePath:"core/src/lib/conditions/valueComparison.js",settings:{comparison:{operator:"equals",caseInsensitive:!0},leftOperand:"%pageName%",rightOperand:"receipt:thank-you"}},{modulePath:"core/src/lib/conditions/path.js",settings:{paths:[{value:"^/checkout/thank-you.jsp",valueIsRegex:!0}]}}],actions:[{modulePath:"core/src/lib/actions/customCode.js",settings:{source:"// ATG-7861\n// Order Total to support Soasta mPulse RUM Tracking\n// Requirement for Soasta that this variable should only\n// be available on this page and on this instance, so I couldn't attach it to anything\ns_setP('window.mPulse.transactionTotalPrice', window.r_round((_satellite.getVar('transactionTotalPrice') || '0'),2,true));",language:"javascript"}},{modulePath:"core/src/lib/actions/customCode.js",settings:{source:"<script type=\"text/javascript\">\n/*jslint plusplus: false, nomen: true, plusplus: true, white: true */\n/*global window,$,W,_satellite,jQuery */\n\n// DEBUG Edition\n// Troubleshooting CJ Issues\ntry {\n\tvar params = {\n\t\tCID: '1530285',\n\t\tOID: _satellite.getVar('transactionID'),\n\t\tCURRENCY: 'USD',\n\t\tCOUPON: _satellite.getVar('transactionTotalVoucherCode'),\n    DISCOUNT: _satellite.getVar('transactionTotalVoucherDiscount')\n\t};\n\tvar i = 0,\n\t\tphysicalProducts = 0,\n\t\tdigitalProducts = 0,\n\t\tunsupportedProducts = 0,\n\t\tcombinedProducts = 0,\n\t\titems = window.r_getByPath(window, 'digitalData.transaction.item');\n\t//\n\tif (items) {\n\t\tvar physicalParams = {\n\t\t\tcontainerTagId: '10906',\n\t\t\tTYPE: '372641'\n\t\t};\n\t\tvar digitalParams = {\n\t\t\tcontainerTagId: '10907',\n\t\t\tTYPE: '372642'\n\t\t};\n\n\t\t// new going in for a two weeks test\n\t\tvar combinedParams = {\n\t\t\tcontainerTagId: '23015',\n\t\t\tTYPE: '397483'\n\t\t};\n\n\t\t// each item check\n\t\tfor (i = 0; i < items.length; i++) {\n\t\t\tvar attr = items[i].attributes;\n\t\t\tif (attr) {\n\n\t\t\t\tvar isPhysical = (typeof (attr.isPhysicalProduct) !== 'undefined' && attr.isPhysicalProduct === true);\n\t\t\t\tvar isDigital = (typeof (attr.isDigitalProduct) !== 'undefined' && attr.isDigitalProduct === true);\n\t\t\t\tvar isNOOK = (typeof (attr.isNOOKProduct) !== 'undefined' && attr.isNOOKProduct === true);\n\n\t\t\t\tvar sku = items[i].productInfo.sku;\n\t\t\t\tvar price = items[i].price.basePrice;\n\t\t\t\tvar qty = items[i].quantity;\n\t\t\t\tvar deptCode = items[i].productInfo.departmentCode;\n\n\t\t\t\t// Truncate SKUs (iTEM) for Marketplace purchases\n\t\t\t\tif (sku && sku.length >= 13) {\n\t\t\t\t\tvar cleanSKU = sku.replace(/^0+/, '');\n\t\t\t\t\tif (cleanSKU.indexOf('267') === 0 || cleanSKU.indexOf('268') === 0 || cleanSKU.indexOf('269') === 0) {\n\t\t\t\t\t\tsku = cleanSKU.substring(0, 3);\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\t// Check by product type\n\t\t\t\tif (isPhysical === true) {\n\t\t\t\t\t// Physical Products\n\t\t\t\t\tphysicalProducts++;\n\t\t\t\t\tphysicalParams['ITEM' + physicalProducts] = sku;\n\t\t\t\t\tphysicalParams['AMT' + physicalProducts] = price;\n\t\t\t\t\tphysicalParams['QTY' + physicalProducts] = qty;\n\t\t\t\t\tphysicalParams['CATEGORY' + physicalProducts] = deptCode;\n\t\t\t\t} else if (isDigital === true || isNOOK === true) {\n\t\t\t\t\t// Digital Products\n\t\t\t\t\tdigitalProducts++;\n\t\t\t\t\tdigitalParams['ITEM' + digitalProducts] = sku;\n\t\t\t\t\tdigitalParams['AMT' + digitalProducts] = price;\n\t\t\t\t\tdigitalParams['QTY' + digitalProducts] = qty;\n\t\t\t\t\tdigitalParams['CATEGORY' + digitalProducts] = deptCode;\n\t\t\t\t} else {\n\t\t\t\t\t// Do nothing\n\t\t\t\t\t// Increment counter that will allow us to see, how many products\n\t\t\t\t\t// did not fall into either category above\n\t\t\t\t\tunsupportedProducts++;\n\t\t\t\t}\n\n\t\t\t\t// Combined Products\n\t\t\t\tif (isPhysical === true || isDigital === true || isNOOK === true) {\n\t\t\t\t\tcombinedProducts++;\n\t\t\t\t\tcombinedParams['ITEM' + combinedProducts] = sku;\n\t\t\t\t\tcombinedParams['AMT' + combinedProducts] = price;\n\t\t\t\t\tcombinedParams['QTY' + combinedProducts] = qty;\n\t\t\t\t\tcombinedParams['CATEGORY' + combinedProducts] = deptCode;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\t// https://rawsoft.atlassian.net/browse/BN-388\n\t\t// CJ Event ID Tracking\n\t\tif (_satellite.getVar('cjevent')) {\n\t\t\tparams['cjevent'] = _satellite.getVar('cjevent');\n\t\t}\n\n\t\t// CJ Pixels IFrame\n\t\tif (physicalProducts > 0) {\n\t\t\tW.r_injectIFrame('https://www.emjcd.com/tags/c?' + decodeURIComponent($.param(jQuery.extend(params, physicalParams))));\n\t\t}\n\n\t\t// CJ Pixels IFrame\n\t\tif (digitalProducts > 0) {\n\t\t\tW.r_injectIFrame('https://www.emjcd.com/tags/c?' + decodeURIComponent($.param(jQuery.extend(params, digitalParams))));\n\t\t}\n\n\t\t// CJ Pixels IFrame (2017 NEW)\n\t\tif (combinedProducts > 0) {\n\t\t\tW.r_injectIFrame('https://www.emjcd.com/tags/c?' + decodeURIComponent($.param(jQuery.extend(params, combinedParams))));\n\t\t}\n\t}\n} catch (e) {\n\t/* error logging here - REMOVED */\n}\n</script>",language:"html"}},{modulePath:"core/src/lib/actions/customCode.js",settings:{source:'<script type="text/javascript">\n   window["optimizely"] = window["optimizely"] || [];\n\n   window["optimizely"].push({\n     "type": "event",\n     "eventName": "purchase",\n     "tags": {\n       "revenue": (parseFloat(_satellite.getVar(\'transactionTotal\')||0)*100)\n     }\n   });\n</script>',language:"html"}},{modulePath:"core/src/lib/actions/customCode.js",settings:{source:"<script type=\"text/javascript\">\n    if (_satellite.getVar('transactionHasNOOKDevice') === 'true') {\n        var revenue = _satellite.getVar('transactionTotal');\n        var orderId = _satellite.getVar('transactionID');\n        var productsOrdered = window.r_getTransactionSkus().join();\n        var totalQty = window.r_getTransactionTotalQuantity();\n        var numOfItems = _satellite.getVar('transactionTotalItems');\n        var taxes = _satellite.getVar('transactionTotalTax');\n        var shipping = _satellite.getVar('transactionTotalShipping');\n        var city = _satellite.getVar('shippingCity');\n        var state = _satellite.getVar('shippingState');\n        var dt = new Date().getTime();\n        var ean = window.r_getTransactionSkus().join();\n        var costs = 0;\n        //\n        window.r_injectIFrame('https://4921982.fls.doubleclick.net/activityi;src=4921982;type=newch0;cat=newsa0;qty=' + totalQty + ';cost=' + revenue + ';u1=' + orderId + ';u2=' + productsOrdered + ';u3=' + numOfItems + ';u4=' + revenue + ';u5=' + taxes + ';u6=' + shipping + ';u7=' + costs + ';u8=' + city + ';u9=' + state + ';u10=' + dt + ';u11=' + ean + ';ord=' + orderId + '?');\n    }\n</script>",language:"html"}},{modulePath:"core/src/lib/actions/customCode.js",settings:{source:"/* \nConversion Tracking Setup \nhttps://rawsoft.atlassian.net/browse/BN-391\n*/\nwindow.r_poll(function() {\n    // Wait for a certain period for mitr to be loaded\n    // A bit of custom work to save performance\n    return typeof(mitr) !== 'undefined';\n}, function() {\n    // Coupon\n    var voucherCode = _satellite.getVar('transactionTotalVoucherCode');\n    if (voucherCode) {\n        mitr('addPromo', {\n            code: voucherCode,\n            description: null\n        });\n    }\n\n    // Products\n    var items = window.r_getByPath(window, 'digitalData.transaction.item');\n    if (items) {\n        for (i = 0; i < items.length; i++) {\n            var item = items[i];\n            mitr('addProduct', {\n                sku: item.productInfo.sku,\n                name: item.productInfo.productName,\n                price: item.price.basePrice,\n                quantity: item.quantity,\n                other: null\n            });\n        }\n    }\n\n    // Transaction\n    mitr('send', 'conversion', {\n        revenue: _satellite.getVar('transactionTotal'),\n        identifier: _satellite.getVar('transactionID')\n    });\n}, null, 3000, 500);",language:"javascript"}},{modulePath:"core/src/lib/actions/customCode.js",settings:{source:'<script type="text/javascript">\n/*jslint plusplus: false, nomen: true, plusplus: true, white: true */\n/*global window,$,W,_satellite,jQuery */\n\n//tp_log(\'window.bvCallback PRE\');\n\nwindow.bvCallback = function (BV) {\n  \n  //tp_log(\'window.bvCallback\');\n\n\tvar bvItems = [];\n\tvar items = window.r_getByPath(window, \'digitalData.transaction.item\');\n\tif (items) {\n\t\tfor (i = 0; i < items.length; i++) {\n\t\t\tvar item = items[i];\n\t\t\tbvItems.push({\n\t\t\t\t"name": item.productInfo.productName,\n\t\t\t\t"productId": (item.productInfo.sku || item.productInfo.productID || item.productInfo.productId), //(ExternalId in product feed)\n\t\t\t\t"price": item.price.basePrice.toString(),\n\t\t\t\t"quantity": item.quantity.toString(),\n\t\t\t\t"category": window.r_getByPath(item,\'category.primaryCategory\'),\n\t\t\t\t"discount": "0"\n\t\t\t});\n\t\t}\n\t}\n\n\tBV.pixel.trackTransaction({\n\t\t"orderId": _satellite.getVar(\'transactionID\'),\n\t\t"total": _satellite.getVar(\'transactionTotal\'), //(sum of all products\' items * price with discounts applied, without the $ sign)\n\t\t"currency": "USD",\n\t\t"tax": _satellite.getVar(\'transactionTotalTax\'), //(tax amount without the $ sign)\n\t\t"shipping": _satellite.getVar(\'transactionTotalShipping\'), //(shipping amount without the $ sign)\n\t\t"items": bvItems,\n\t\t"email": _satellite.getVar(\'userHashedEmailSha256\'), //Optional PII parameters\n\t\t"locale": "en_US",\n\t\t"nickname": ""\n\t});\n};\n</script>',language:"html"}},{modulePath:"core/src/lib/actions/customCode.js",settings:{source:"// Only if the customer has the cookie, otherwise, 500 Error\nif (window.s_c_r('hConversionEventId').length > 0) {\n    window.r_injectImage('//mail.barnesandnoble.com/C?hEventName=Purchase&hAmount=' + _satellite.getVar('transactionTotalPrice') + '&hQuantity=' + digitalData.transaction.item.length + '&hOrderId=' + _satellite.getVar('transactionID') + '&hCustomerTransactionId=' + _satellite.getVar('transactionID'));\n}",language:"javascript"}}]},{id:"RL874b0990d05d417f96b656f044233b52",name:"Page: Bottom: All - No Iframe",events:[{modulePath:"core/src/lib/events/pageBottom.js",settings:{},ruleOrder:50}],conditions:[{modulePath:"core/src/lib/conditions/customCode.js",settings:{source:function(){return window.self===window.top}}}],actions:[{modulePath:"core/src/lib/actions/customCode.js",settings:{source:"(function() {\n    // Do not insert in DEV environements\n    if (BNAnalytics.IsDevelopment() === false) {\n        // lets determine the domain script needed\n        var domain_script = (BNAnalytics.IsMobile ? '5d21ef1e-e3e2-4291-adb9-234d70eb3484' : 'f61a5dc2-e9f6-4a63-8c0d-4ad6a98230aa')\n\n        // Get the first script element on the page\n        var ref = window.document.getElementsByTagName('script')[0];\n\n        // Create a new script element\n        var script = window.document.createElement('script');\n\n        // Set the script element `src`\n        script.src = 'https://cdn.cookielaw.org/scripttemplates/otSDKStub.js';\n\n        // attributes\n        script.setAttribute('data-domain-script', domain_script);\n        script.setAttribute('charset', 'UTF-8');\n\n        // Inject the script into the DOM\n        ref.parentNode.insertBefore(script, ref);\n\n        // function\n        window.OptanonWrapper = function() {}\n    }\n}());",language:"javascript"}}]},{id:"RL22cfed2a69f1469c839cb5720575ebca",name:"WishList: Create",events:[{modulePath:"core/src/lib/events/directCall.js",settings:{identifier:"onCreateWishList"},ruleOrder:50}],conditions:[],actions:[{modulePath:"adobe-analytics/src/lib/actions/setVariables.js",settings:{trackerProperties:{events:[{name:"event17"}],channel:"%pageType%"}}},{modulePath:"adobe-analytics/src/lib/actions/sendBeacon.js",settings:{type:"link",linkName:"create_wishlist",linkType:"o"}}]},{id:"RL6798984af33a49e58438b76e2df0f057",name:"Experience Click",events:[{modulePath:"core/src/lib/events/directCall.js",settings:{identifier:"onExperienceClick"},ruleOrder:50}],conditions:[],actions:[{modulePath:"adobe-analytics/src/lib/actions/clearVariables.js",settings:{}},{modulePath:"adobe-analytics/src/lib/actions/setVariables.js",settings:{customSetup:{source:function(e,t){t.linkTrackVars=t.apl(t.linkTrackVars,"eVar81",",",1),t.eVar81=window.r_getByPath(e.detail.attributes,"vendor")+"|"+window.r_getByPath(e.detail.attributes,"campaignName")+"|"+window.r_getByPath(e.detail.attributes,"experienceName")+"|"+window.r_getByPath(e.detail.attributes,"variationName")+"|"+window.r_getByPath(e.detail.attributes,"objectName")}},trackerProperties:{events:[{name:"event93"}]}}},{modulePath:"adobe-analytics/src/lib/actions/sendBeacon.js",settings:{type:"link",linkName:"experience_click",linkType:"o"}}]},{id:"RL7dff6aa70fbb4754a7ce1570cae983a4",name:"Experience Submit",events:[{modulePath:"core/src/lib/events/directCall.js",settings:{identifier:"onExperienceSubmit"},ruleOrder:50}],conditions:[],actions:[{modulePath:"adobe-analytics/src/lib/actions/clearVariables.js",settings:{}},{modulePath:"adobe-analytics/src/lib/actions/setVariables.js",settings:{customSetup:{source:function(e,t){t.linkTrackVars=t.apl(t.linkTrackVars,"eVar81",",",1),t.eVar81=window.r_getByPath(e.detail.attributes,"vendor")+"|"+window.r_getByPath(e.detail.attributes,"campaignName")+"|"+window.r_getByPath(e.detail.attributes,"experienceName")+"|"+window.r_getByPath(e.detail.attributes,"variationName")+"|"+window.r_getByPath(e.detail.attributes,"objectName")}},trackerProperties:{events:[{name:"event163"}]}}},{modulePath:"adobe-analytics/src/lib/actions/sendBeacon.js",settings:{type:"link",linkName:"experience_submit",linkType:"o"}}]},{id:"RL9dcd2dcb09a14cc68344bd96690d086f",name:"Experience View",events:[{modulePath:"core/src/lib/events/directCall.js",settings:{identifier:"onExperienceView"},ruleOrder:50}],conditions:[],actions:[{modulePath:"adobe-analytics/src/lib/actions/clearVariables.js",settings:{}},{modulePath:"adobe-analytics/src/lib/actions/setVariables.js",settings:{customSetup:{source:function(e,t){var n=window.r_getByPath(e.detail.attributes,"vendor");t.linkTrackVars=t.apl(t.linkTrackVars,"eVar81",",",1),t.eVar81=window.r_getByPath(e.detail.attributes,"vendor")+"|"+window.r_getByPath(e.detail.attributes,"campaignName")+"|"+window.r_getByPath(e.detail.attributes,"experienceName")+"|"+window.r_getByPath(e.detail.attributes,"variationName")+"|"+window.r_getByPath(e.detail.attributes,"objectName");var a="_exp_bn_"+r_hashCode(t.eVar81);"1"===_satellite.cookie.get(a)?(t.abort=!0,r_dtm_notify(n+" Experience Aborted")):(_satellite.cookie.set(a,"1"),r_dtm_notify(n+" Set for Session"))}},trackerProperties:{events:[{name:"event92"}],channel:"%pageType%"}}},{modulePath:"adobe-analytics/src/lib/actions/sendBeacon.js",settings:{type:"link",linkName:"experience_view",linkType:"o"}}]}]};var _satellite=function(){"use strict";function e(e,t){return e(t={exports:{}},t.exports),t.exports}function t(t){var n=this.constructor;return this.then(function(e){return n.resolve(t()).then(function(){return e})},function(e){return n.resolve(t()).then(function(){return n.reject(e)})})}function l(e){return Boolean(e&&"undefined"!=typeof e.length)}function a(){}function r(e,t){return function(){e.apply(t,arguments)}}function i(e){if(!(this instanceof i))throw new TypeError("Promises must be constructed via new");if("function"!=typeof e)throw new TypeError("not a function");this._state=0,this._handled=!1,this._value=undefined,this._deferreds=[],p(e,this)}function o(a,r){for(;3===a._state;)a=a._value;0!==a._state?(a._handled=!0,i._immediateFn(function(){var e=1===a._state?r.onFulfilled:r.onRejected;if(null!==e){var t;try{t=e(a._value)}catch(n){return void c(r.promise,n)}s(r.promise,t)}else(1===a._state?s:c)(r.promise,a._value)})):a._deferreds.push(r)}function s(e,t){try{if(t===e)throw new TypeError("A promise cannot be resolved with itself.");if(t&&("object"==typeof t||"function"==typeof t)){var n=t.then;if(t instanceof i)return e._state=3,e._value=t,void d(e);if("function"==typeof n)return void p(r(n,t),e)}e._state=1,e._value=t,d(e)}catch(a){c(e,a)}}function c(e,t){e._state=2,e._value=t,d(e)}function d(e){2===e._state&&0===e._deferreds.length&&i._immediateFn(function(){e._handled||i._unhandledRejectionFn(e._value)});for(var t=0,n=e._deferreds.length;t<n;t++)o(e,e._deferreds[t]);e._deferreds=null}function u(e,t,n){this.onFulfilled="function"==typeof e?e:null,this.onRejected="function"==typeof t?t:null,this.promise=n}function p(e,t){var n=!1;try{e(function(e){n||(n=!0,s(t,e))},function(e){n||(n=!0,c(t,e))})}catch(a){if(n)return;n=!0,c(t,a)}}function g(e){if(null===e||e===undefined)throw new TypeError("Object.assign cannot be called with null or undefined");return Object(e)}function n(){try{if(!Object.assign)return!1;var e=new String("abc");if(e[5]="de","5"===Object.getOwnPropertyNames(e)[0])return!1;for(var t={},n=0;n<10;n++)t["_"+String.fromCharCode(n)]=n;if("0123456789"!==Object.getOwnPropertyNames(t).map(function(e){return t[e]}).join(""))return!1;var a={};return"abcdefghijklmnopqrst".split("").forEach(function(e){a[e]=e}),"abcdefghijklmnopqrst"===Object.keys(Object.assign({},a)).join("")}catch(r){return!1}}function m(e,t){return Object.prototype.hasOwnProperty.call(e,t)}if(window.atob){var f=function(e){var n=[];return e.forEach(function(t){t.events&&t.events.forEach(function(e){n.push({rule:t,event:e})})}),n.sort(function(e,t){return e.event.ruleOrder-t.event.ruleOrder})},h="debug",b=function(t,e){var n=function(){return"true"===t.getItem(h)},a=function(e){t.setItem(h,e)},r=[],i=function(e){r.push(e)};return e.outputEnabled=n(),{onDebugChanged:i,getDebugEnabled:n,setDebugEnabled:function(t){n()!==t&&(a(t),e.outputEnabled=t,r.forEach(function(e){e(t)}))}}},v="Module did not export a function.",y=function(i,o){return function(e,t,n){n=n||[];var a=i.getModuleExports(e.modulePath);if("function"!=typeof a)throw new Error(v);var r=o(e.settings||{},t);return a.bind(null,r).apply(null,n)}},w=function(e){return"string"==typeof e?e.replace(/\s+/g," ").trim():e},_={LOG:"log",INFO:"info",DEBUG:"debug",WARN:"warn",ERROR:"error"},P="\ud83d\ude80",k=10===parseInt((/msie (\d+)/.exec(navigator.userAgent.toLowerCase())||[])[1])?"[Launch]":P,j=!1,C=function(e){if(j&&window.console){var t=Array.prototype.slice.call(arguments,1);t.unshift(k),e!==_.DEBUG||window.console[e]||(e=_.INFO),window.console[e].apply(window.console,t)}},T=C.bind(null,_.LOG),V=C.bind(null,_.INFO),D=C.bind(null,_.DEBUG),S=C.bind(null,_.WARN),E=C.bind(null,_.ERROR),x={log:T,info:V,debug:D,warn:S,error:E,get outputEnabled(){return j},set outputEnabled(e){j=e},createPrefixedLogger:function(e){var t="["+e+"]";return{log:T.bind(null,t),info:V.bind(null,t),debug:D.bind(null,t),warn:S.bind(null,t),error:E.bind(null,t)}}},I=e(function(a){!function(e){if(a.exports=e(),!!0){var t=window.Cookies,n=window.Cookies=e();n.noConflict=function(){return window.Cookies=t,n}}}(function(){function c(){for(var e=0,t={};e<arguments.length;e++){var n=arguments[e];for(var a in n)t[a]=n[a]}return t}function d(e){return e.replace(/(%[0-9A-Z]{2})+/g,decodeURIComponent)}function e(l){function s(){}function n(e,t,n){if("undefined"!=typeof document){"number"==typeof(n=c({path:"/"},s.defaults,n)).expires&&(n.expires=new Date(1*new Date+864e5*n.expires)),n.expires=n.expires?n.expires.toUTCString():"";try{var a=JSON.stringify(t);/^[\{\[]/.test(a)&&(t=a)}catch(o){}t=l.write?l.write(t,e):encodeURIComponent(String(t)).replace(/%(23|24|26|2B|3A|3C|3E|3D|2F|3F|40|5B|5D|5E|60|7B|7D|7C)/g,decodeURIComponent),e=encodeURIComponent(String(e)).replace(/%(23|24|26|2B|5E|60|7C)/g,decodeURIComponent).replace(/[\(\)]/g,escape);var r="";for(var i in n)n[i]&&(r+="; "+i,!0!==n[i]&&(r+="="+n[i].split(";")[0]));return document.cookie=e+"="+t+r}}function t(e,t){if("undefined"!=typeof document){for(var n={},a=document.cookie?document.cookie.split("; "):[],r=0;r<a.length;r++){var i=a[r].split("="),o=i.slice(1).join("=");t||'"'!==o.charAt(0)||(o=o.slice(1,-1));try{var s=d(i[0]);if(o=(l.read||l)(o,s)||d(o),t)try{o=JSON.parse(o)}catch(c){}if(n[s]=o,e===s)break}catch(c){}}return e?n[e]:n}}return s.set=n,s.get=function(e){return t(e,!1)},s.getJSON=function(e){return t(e,!0)},s.remove=function(e,t){n(e,"",c(t,{expires:-1}))},s.defaults={},s.withConverter=e,s}return e(function(){})})}),O={get:I.get,set:I.set,remove:I.remove},N=window,A="com.adobe.reactor.",B=function(a,e){var r=A+(e||"");return{getItem:function(e){try{return N[a].getItem(r+e)}catch(t){return null}},setItem:function(e,t){try{return N[a].setItem(r+e,t),!0}catch(n){return!1}}}},R="_sdsat_",L="dataElements.",W="dataElementCookiesMigrated",M=B("localStorage"),F=B("sessionStorage",L),$=B("localStorage",L),U={PAGEVIEW:"pageview",SESSION:"session",VISITOR:"visitor"},q={},H=function(e){var t;try{t=JSON.stringify(e)}catch(n){}return t},z=function(e,t,n){var a;switch(t){case U.PAGEVIEW:return void(q[e]=n);case U.SESSION:return void((a=H(n))&&F.setItem(e,a));case U.VISITOR:return void((a=H(n))&&$.setItem(e,a))}},G=function(e,t){var n=O.get(R+e);n!==undefined&&z(e,t,n)},Q={setValue:z,getValue:function(e,t){var n;switch(t){case U.PAGEVIEW:return q.hasOwnProperty(e)?q[e]:null;case U.SESSION:return null===(n=F.getItem(e))?n:JSON.parse(n);case U.VISITOR:return null===(n=$.getItem(e))?n:JSON.parse(n)}},migrateCookieData:function(t){M.getItem(W)||(Object.keys(t).forEach(function(e){G(e,t[e].storageDuration)}),M.setItem(W,!0))}},Y=function(e,t,n,a){return"Failed to execute data element module "+e.modulePath+" for data element "+t+". "+n+(a?"\n"+a:"")},J=function(s,c,l,d){return function(e,t){var n=c(e);if(!n)return d?"":undefined;var a,r=n.storageDuration;try{a=s.getModuleExports(n.modulePath)}catch(o){return void x.error(Y(n,e,o.message,o.stack))}if("function"==typeof a){var i;try{i=a(l(n.settings,t),t)}catch(o){return void x.error(Y(n,e,o.message,o.stack))}return r&&(null!=i?Q.setValue(e,r,i):i=Q.getValue(e,r)),null==i&&null!=n.defaultValue&&(i=n.defaultValue),"string"==typeof i&&(n.cleanText&&(i=w(i)),n.forceLowerCase&&(i=i.toLowerCase())),i}x.error(Y(n,e,"Module did not export a function."))}},K={text:function(e){return e.textContent},cleanText:function(e){return w(e.textContent)}},X=function(e,t,n){for(var a,r=e,i=0,o=t.length;i<o;i++){if(null==r)return undefined;var s=t[i];if(n&&"@"===s.charAt(0)){var c=s.slice(1);r=K[c](r)}else if(r.getAttribute&&(a=s.match(/^getAttribute\((.+)\)$/))){var l=a[1];r=r.getAttribute(l)}else r=r[s]}return r},Z=function(i,o,s){return function(e,t){var n;if(o(e))n=s(e,t);else{var a=e.split("."),r=a.shift();"this"===r?t&&(n=X(t.element,a,!0)):"event"===r?t&&(n=X(t,a)):"target"===r?t&&(n=X(t.target,a)):n=X(i[r],a)}return n}},ee=function(n,a){return function(e){var t=e.split(".")[0];return Boolean(a(e)||"this"===t||"event"===t||"target"===t||n.hasOwnProperty(t))}},te=function(e,t,n){var a={exports:{}};return e.call(a.exports,a,a.exports,t,n),a.exports},ne=function(){var o={},n=function(e){var t=o[e];if(!t)throw new Error("Module "+e+" not found.");return t},e=function(){Object.keys(o).forEach(function(e){try{a(e)}catch(n){
var t="Error initializing module "+e+". "+n.message+(n.stack?"\n"+n.stack:"");x.error(t)}})},a=function(e){var t=n(e);return t.hasOwnProperty("exports")||(t.exports=te(t.definition.script,t.require,t.turbine)),t.exports};return{registerModule:function(e,t,n,a,r){var i={definition:t,extensionName:n,require:a,turbine:r};i.require=a,o[e]=i},hydrateCache:e,getModuleExports:a,getModuleDefinition:function(e){return n(e).definition},getModuleExtensionName:function(e){return n(e).extensionName}}},ae=!1,re=function(a){return function(t,n){var e=a._monitors;e&&(ae||(x.warn("The _satellite._monitors API may change at any time and should only be used for debugging."),ae=!0),e.forEach(function(e){e[t]&&e[t](n)}))}},ie=function(r,i,o){var n,a,s,c,l=[],d=function(e,t,n){if(!r(t))return e;l.push(t);var a=i(t,n);return l.pop(),null==a&&o?"":a};return n=function(e,n){var t=/^%([^%]+)%$/.exec(e);return t?d(e,t[1],n):e.replace(/%(.+?)%/g,function(e,t){return d(e,t,n)})},a=function(e,t){for(var n={},a=Object.keys(e),r=0;r<a.length;r++){var i=a[r],o=e[i];n[i]=c(o,t)}return n},s=function(e,t){for(var n=[],a=0,r=e.length;a<r;a++)n.push(c(e[a],t));return n},c=function(e,t){return"string"==typeof e?n(e,t):Array.isArray(e)?s(e,t):"object"==typeof e&&null!==e?a(e,t):e},function(e,t){return 10<l.length?(x.error("Data element circular reference detected: "+l.join(" -> ")),e):c(e,t)}},oe=function(r){return function(e,t){if("string"==typeof e)r[arguments[0]]=t;else if(arguments[0]){var n=arguments[0];for(var a in n)r[a]=n[a]}}},se=setTimeout;i.prototype["catch"]=function(e){return this.then(null,e)},i.prototype.then=function(e,t){var n=new this.constructor(a);return o(this,new u(e,t,n)),n},i.prototype["finally"]=t,i.all=function(t){return new i(function(r,i){function o(t,e){try{if(e&&("object"==typeof e||"function"==typeof e)){var n=e.then;if("function"==typeof n)return void n.call(e,function(e){o(t,e)},i)}s[t]=e,0==--c&&r(s)}catch(a){i(a)}}if(!l(t))return i(new TypeError("Promise.all accepts an array"));var s=Array.prototype.slice.call(t);if(0===s.length)return r([]);for(var c=s.length,e=0;e<s.length;e++)o(e,s[e])})},i.resolve=function(t){return t&&"object"==typeof t&&t.constructor===i?t:new i(function(e){e(t)})},i.reject=function(n){return new i(function(e,t){t(n)})},i.race=function(r){return new i(function(e,t){if(!l(r))return t(new TypeError("Promise.race accepts an array"));for(var n=0,a=r.length;n<a;n++)i.resolve(r[n]).then(e,t)})},i._immediateFn="function"==typeof setImmediate&&function(e){setImmediate(e)}||function(e){se(e,0)},i._unhandledRejectionFn=function jt(e){"undefined"!=typeof console&&console&&console.warn("Possible Unhandled Promise Rejection:",e)};var ce=window.Promise||i["default"]||i,le=function(l,n,a){return function(s,t,c,e){return e.then(function(){var i,o=s.delayNext;return new ce(function(e,t){var n=l(s,c,[c]);if(!o)return e();var a=s.timeout,r=new ce(function(e,t){i=setTimeout(function(){t(new Error("A timeout occurred because the action took longer than "+a/1e3+" seconds to complete. "))},a)});ce.race([n,r]).then(e,t)})["catch"](function(e){return clearTimeout(i),e=n(e),a(s,t,e),ce.reject(e)}).then(function(){clearTimeout(i)})})}},de=function(c,n,a,r,l){return function(o,t,s,e){return e.then(function(){var i;return new ce(function(e,t){var n=c(o,s,[s]),a=o.timeout,r=new ce(function(e,t){i=setTimeout(function(){t(new Error("A timeout occurred because the condition took longer than "+a/1e3+" seconds to complete. "))},a)});ce.race([n,r]).then(e,t)})["catch"](function(e){return clearTimeout(i),e=n(e),r(o,t,e),ce.reject(e)}).then(function(e){if(clearTimeout(i),!a(o,e))return l(o,t),ce.reject()})})}},ue=ce.resolve(),pe=function(a,r,e){return function(t,n){return t.conditions&&t.conditions.forEach(function(e){ue=a(e,t,n,ue)}),t.actions&&t.actions.forEach(function(e){ue=r(e,t,n,ue)}),ue=(ue=ue.then(function(){e(t)}))["catch"](function(){})}},ge=function(e){return Boolean(e&&"object"==typeof e&&"function"==typeof e.then)},fe=function(o,s,c,l){return function(e,t){var n;if(e.conditions)for(var a=0;a<e.conditions.length;a++){n=e.conditions[a];try{var r=o(n,t,[t]);if(ge(r))throw new Error("Rule component sequencing must be enabled on the property for this condition to function properly.");if(!s(n,r))return c(n,e),!1}catch(i){return l(n,e,i),!1}}return!0}},me=function(n,a){return function(e,t){n(e,t)&&a(e,t)}},he=function(n){return function(e){var t=n.getModuleDefinition(e.modulePath);return t&&t.displayName||e.modulePath}},be=function(r){return function(e){var t=e.rule,n=e.event,a=r.getModuleDefinition(n.modulePath).name;return{$type:r.getModuleExtensionName(n.modulePath)+"."+a,$rule:{id:t.id,name:t.name}}}},ve=function(s,c,l,d,u,p){return function(n,e){var a=e.rule,t=e.event;t.settings=t.settings||{};try{var r=u(e);c(t,null,[function i(e){var t=l(r,e);n(function(){s(t,a)})}])}catch(o){p.error(d(t,a,o))}}},ye=function(r,i,o,s){return function(e,t,n){var a=i(e);o.error(r(a,t.name,n)),s("ruleActionFailed",{rule:t,action:e})}},we=function(r,i,o,s){return function(e,t,n){var a=i(e);o.error(r(a,t.name,n)),s("ruleConditionFailed",{rule:t,condition:e})}},_e=function(a,r,i){return function(e,t){var n=a(e);r.log('Condition "'+n+'" for rule "'+t.name+'" was not met.'),i("ruleConditionFailed",{rule:t,condition:e})}},Pe=function(t,n){return function(e){t.log('Rule "'+e.name+'" fired.'),n("ruleCompleted",{rule:e})}},ke=function(i,o,s){return function(e,t){var n;if(e.actions)for(var a=0;a<e.actions.length;a++){n=e.actions[a];try{i(n,t,[t])}catch(r){return void o(n,e,r)}}s(e)}},je=function(n,a,r,i){return function(e,t){i("ruleTriggered",{rule:t}),n?r(t,e):a(t,e)}},Ce=function(e,t,n){return'Failed to execute "'+e+'" for "'+t+'" rule. '+n.message+(n.stack?"\n"+n.stack:"")},Te=function(e,t){return t&&!e.negate||!t&&e.negate},Ve=[],De=!1,Se=function(e){De?e():Ve.push(e)},Ee=function(e,t,n){e(t).forEach(function(e){n(Se,e)}),De=!0,Ve.forEach(function(e){e()}),Ve=[]},xe=function(e){if(e||(e=new Error("The extension triggered an error, but no error information was provided.")),!(e instanceof Error)){var t="object"==typeof e?JSON.stringify(e):String(e);e=new Error(t)}return e},Ie=Object.getOwnPropertySymbols,Oe=Object.prototype.hasOwnProperty,Ne=Object.prototype.propertyIsEnumerable,Ae=n()?Object.assign:function(e){for(var t,n,a=g(e),r=1;r<arguments.length;r++){for(var i in t=Object(arguments[r]))Oe.call(t,i)&&(a[i]=t[i]);if(Ie){n=Ie(t);for(var o=0;o<n.length;o++)Ne.call(t,n[o])&&(a[n[o]]=t[n[o]])}}return a},Be=function(e,t){return Ae(t=t||{},e),t.hasOwnProperty("type")||Object.defineProperty(t,"type",{get:function(){return x.warn("Accessing event.type in Adobe Launch has been deprecated and will be removed soon. Please use event.$type instead."),t.$type}}),t},Re=function(c,l){return function(e,t){var n=c[e];if(n){var a=n.modules;if(a)for(var r=Object.keys(a),i=0;i<r.length;i++){var o=r[i],s=a[o];if(s.shared&&s.name===t)return l.getModuleExports(o)}}}},Le=function(e,t){return function(){return t?e(t):{}}},We=function(n,a){return function(e){if(a){var t=e.split(".");t.splice(t.length-1||1,0,"min"),e=t.join(".")}return n+e}},Me=".js",Fe=function(e){return e.substr(0,e.lastIndexOf("/"))},$e=function(e,t){return-1!==e.indexOf(t,e.length-t.length)},Ue=function(e,t){$e(t,Me)||(t+=Me);var n=t.split("/"),a=Fe(e).split("/");return n.forEach(function(e){e&&"."!==e&&(".."===e?a.length&&a.pop():a.push(e))}),a.join("/")},qe=document,He=function(n,a){return new ce(function(e,t){a.onload=function(){e(a)},a.onerror=function(){t(new Error("Failed to load script "+n))}})},ze=function(e){var t=document.createElement("script");t.src=e,t.async=!0;var n=He(e,t);return document.getElementsByTagName("head")[0].appendChild(t),n},Ge=function(e,t,n,a){t=t||"&",n=n||"=";var r={};if("string"!=typeof e||0===e.length)return r;var i=/\+/g;e=e.split(t);var o=1e3;a&&"number"==typeof a.maxKeys&&(o=a.maxKeys);var s=e.length;0<o&&o<s&&(s=o);for(var c=0;c<s;++c){var l,d,u,p,g=e[c].replace(i,"%20"),f=g.indexOf(n);0<=f?(l=g.substr(0,f),d=g.substr(f+1)):(l=g,d=""),u=decodeURIComponent(l),p=decodeURIComponent(d),m(r,u)?Array.isArray(r[u])?r[u].push(p):r[u]=[r[u],p]:r[u]=p}return r},Qe=function(e){switch(typeof e){case"string":return e;case"boolean":return e?"true":"false";case"number":return isFinite(e)?e:"";default:return""}},Ye=function(n,a,r,e){return a=a||"&",r=r||"=",null===n&&(n=undefined),"object"==typeof n?Object.keys(n).map(function(e){var t=encodeURIComponent(Qe(e))+r;return Array.isArray(n[e])?n[e].map(function(e){return t+encodeURIComponent(Qe(e))}).join(a):t+encodeURIComponent(Qe(n[e]))}).join(a):e?encodeURIComponent(Qe(e))+r+encodeURIComponent(Qe(n)):""},Je=e(function(e,t){t.decode=t.parse=Ge,t.encode=t.stringify=Ye}),Ke=(Je.decode,Je.parse,Je.encode,Je.stringify,"@adobe/reactor-"),Xe={cookie:O,document:qe,"load-script":ze,"object-assign":Ae,promise:ce,"query-string":{parse:function(e){return"string"==typeof e&&(e=e.trim().replace(/^[?#&]/,"")),Je.parse(e)},stringify:function(e){return Je.stringify(e)}},window:N},Ze=function(a){return function(e){if(0===e.indexOf(Ke)){var t=e.substr(Ke.length),n=Xe[t];if(n)return n}if(0===e.indexOf("./")||0===e.indexOf("../"))return a(e);throw new Error('Cannot resolve module "'+e+'".')}},et=function(e,o,s,c,l){var d=e.extensions,u=e.buildInfo,p=e.property.settings;if(d){var g=Re(d,o);Object.keys(d).forEach(function(a){var r=d[a],e=Le(c,r.settings);if(r.modules){var t=x.createPrefixedLogger(r.displayName),n=We(r.hostedLibFilesBaseUrl,u.minified),i={buildInfo:u,getDataElementValue:l,getExtensionSettings:e,getHostedLibFileUrl:n,getSharedModule:g,logger:t,propertySettings:p,replaceTokens:c,onDebugChanged:s.onDebugChanged,get debugEnabled(){return s.getDebugEnabled()}};Object.keys(r.modules).forEach(function(n){var e=r.modules[n],t=Ze(function(e){var t=Ue(n,e);return o.getModuleExports(t)});o.registerModule(n,e,a,t,i)})}}),o.hydrateCache()}return o},tt=function(e,t,n,a,r){var i=x.createPrefixedLogger("Custom Script");e.track=function(e){x.log('"'+e+'" does not match any direct call identifiers.')},e.getVisitorId=function(){return null},e.property={name:t.property.name},e.company=t.company,e.buildInfo=t.buildInfo,e.logger=i,e.notify=function(e,t){switch(x.warn("_satellite.notify is deprecated. Please use the `_satellite.logger` API."),t){case 3:i.info(e);break;case 4:i.warn(e);break;case 5:i.error(e);break;default:i.log(e)}},e.getVar=a,e.setVar=r,e.setCookie=function(e,t,n){var a="",r={};n&&(a=", { expires: "+n+" }",r.expires=n);var i='_satellite.setCookie is deprecated. Please use _satellite.cookie.set("'+e+'", "'+t+'"'+a+").";x.warn(i),O.set(e,t,r)},e.readCookie=function(e){return x.warn('_satellite.readCookie is deprecated. Please use _satellite.cookie.get("'+e+'").'),O.get(e)},e.removeCookie=function(e){x.warn('_satellite.removeCookie is deprecated. Please use _satellite.cookie.remove("'+e+'").'),O.remove(e)},e.cookie=O,e.pageBottom=function(){},e.setDebug=n;var o=!1;Object.defineProperty(e,"_container",{get:function(){return o||(x.warn("_satellite._container may change at any time and should only be used for debugging."),o=!0),t}})},nt=window._satellite;if(nt&&!window.__satelliteLoaded){window.__satelliteLoaded=!0;var at=nt.container;delete nt.container;var rt=at.property.settings.undefinedVarsReturnEmpty,it=at.property.settings.ruleComponentSequencingEnabled,ot=at.dataElements||{};Q.migrateCookieData(ot);var st,ct=function(e){return ot[e]},lt=ne(),dt=J(lt,ct,function(){return st.apply(null,arguments)},rt),ut={},pt=oe(ut),gt=ee(ut,ct),ft=Z(ut,ct,dt);st=ie(gt,ft,rt);var mt=b(B("localStorage"),x);tt(nt,at,mt.setDebugEnabled,ft,pt),et(at,lt,mt,st,dt);var ht=re(nt),bt=y(lt,st),vt=he(lt),yt=_e(vt,x,ht),wt=we(Ce,vt,x,ht),_t=ye(Ce,vt,x,ht),Pt=Pe(x,ht),kt=ve(je(it,me(fe(bt,Te,yt,wt),ke(bt,_t,Pt)),pe(de(bt,xe,Te,wt,yt),le(bt,xe,_t),Pt),ht),bt,Be,Ce,be(lt),x);Ee(f,at.rules||[],kt)}return nt}console.warn("Adobe Launch is unsupported in IE 9 and below.")}();