var trackRuleOfferred,trackRuleOfferredCount=0;if("object"!=typeof rnChat&&(rnChat=new Object),"object"!=typeof rnChat.proc&&(rnChat.proc=new Boolean,rnChat.modules=new Object,rnChat.vars=new Object,rnChat.timers=new Object,rnChat.xhr=new Object),"undefined"!=typeof ATGSvcs&&function(){var r=function(e){e.rule&&(trackRuleOfferred=!0,trackRuleOfferredCount++)};ATGSvcs.eventSubscribe({eeOffered:function(e,t){r(t)}})}(),0==rnChat.proc){if(rnChat.proc=!0,null==document.getElementById("rnChat")&&(rnChat.vars.scratch=document.createElement("div"),rnChat.vars.scratch.id="rnChat",rnChat.vars.scratch.style="display: none;",document.body.appendChild(rnChat.vars.scratch)),void 0===rightNowDomainName)var rightNowDomainName,rightNowWidgetDomainName;for(location.href.match(/(zeus\.fds|(dev|tst.)\.custhelp)\.com/g)?(location.href.match(/tst1\.custhelp\.com/g)?(rightNowDomainName="https://macys--tst1.custhelp.com",rightNowWidgetDomainName="https://macys--tst1.widget.custhelp.com",rnChat.env="TST1"):(rightNowDomainName="https://macys--dev.custhelp.com",rightNowWidgetDomainName="https://macys--dev.widget.custhelp.com",rnChat.env="DEV"),rnChat.modules=[rightNowWidgetDomainName+"/euf/assets/js/ee/chat_rules_fn.dev.js?d=‭‭‭2F02C8684F‬"]):(rightNowDomainName="https://www.customerservice-macys.com",rightNowWidgetDomainName="https://macys.widget.custhelp.com",rnChat.env="PROD",rnChat.modules=[rightNowWidgetDomainName+"/euf/assets/js/ee/chat_rules_fn.min.js?d=‭‭‭2F02C8684F‬"]),rnChat.getCookie=function(e){var t=("; "+document.cookie).split("; "+e+"=");if(2==t.length)return t.pop().split(";").shift()},i=1;i<rnChat.modules.length;i++){var script=document.createElement("script");script.src=rnChat.modules[i],document.head.appendChild(script)}if(console.log("-- chat_rules_init loaded --"),"object"!=typeof macysns)var macysns={calledChatTest:0,x:0},PAChatimages=new Array;if("object"!=typeof rn_prodArray){var rn_prodArray=[],obj={ID:0,chats:!1,hours:!1,queuing:!1};rn_prodArray.push(obj)}deferredOfferDataCapture=function(){var e={83:"incidents.c$bagid",84:"incidents.c$carttotal",86:"incidents.c$customerid",87:"incidents.c$credit_dept",88:"incidents.c$sales_dept",89:"incidents.c$sales_proactive_dept",90:"incidents.c$chat_page_url",91:"incidents.c$chat_error_message",92:"incidents.c$chat_productids",93:"incidents.c$rulename",94:"incidents.c$chat_accepted_domain_var",95:"incidents.c$detect_reactive_chat",96:"incidents.c$chat_error_message_long",105:"incidents.c$sales_fob_name",106:"incidents.c$sales_cat_name",108:"incidents.c$chat_product_saleprice"},t=window[_vsq._widgets[0]];if(t){var r=_vsq._dataFields,a="";for(var s in r)if(r[s]&&0<r[s].length){if(0===s.indexOf("contacts.")||0===s.indexOf("incidents."))continue;a+="/"+e[s]+"/"+encodeURIComponent(r[s])}t.data.custom_fields_in_url=a,t.data.common_fields_in_url="",r["contacts.first_name"]&&""!=r["contacts.first_name"]&&(t.data.common_fields_in_url+="/contacts.first_name/"+encodeURIComponent(r["contacts.first_name"])),r["contacts.last_name"]&&""!=r["contacts.last_name"]&&(t.data.common_fields_in_url+="/contacts.last_name/"+encodeURIComponent(r["contacts.last_name"])),r["contacts.email"]&&""!=r["contacts.email"]&&(t.data.common_fields_in_url+="/contacts.email/"+encodeURIComponent(r["contacts.email"])),r["incidents.prod"]&&""!=r["incidents.prod"]&&(t.data.common_fields_in_url+="/p/"+encodeURIComponent(r["incidents.prod"]))}if(_vsq&&_vsq._spacWidgets[0]&&_vsq._spacWidgets[0].instanceId){var n=window[_vsq._spacWidgets[0].instanceId];if(n){var o=new RightNow.Client.EventObject(n.instanceId,_vsq._spacWidgets[0].instanceId),i=(r=_vsq._dataFields,{});for(var s in r)r[s]&&"object"!=typeof r[s]&&"function"!=typeof r[s]&&"symbol"!=typeof r[s]&&(0===s.indexOf("contacts.")||0===s.indexOf("incidents.")?i[s]=encodeURIComponent(r[s]):i[s]=r[s]);o.data={dataFields:i},RightNow.Client.Event.evt_updateCustomFieldsRequest.fire(o)}}};try{var rnPageTitle=document.title.replace("–","-");rnChat.vars.domain=location.hostname.replace(/^www1/,"www"),rnChat.vars.url=location.href.substr(0,255).toString(),_vsq._dataFields[94]=rnChat.vars.domain,_vsq._dataFields[90]=rnChat.vars.url,document.getElementById("productMktData")&&(rnChat.vars.prodJSON=document.getElementById("productMktData").text.replace(/(\t|\r|\n)/g," "),rnChat.vars.price=JSON.parse(rnChat.vars.prodJSON).offers[0].price,rnChat.vars.brand=JSON.parse(rnChat.vars.prodJSON).brand.name,_vsq._dataFields[108]=rnChat.vars.price),-1<location.href.indexOf("?ID=")?(rnChat.vars.webId=location.href.split("?ID=")[1].split(/[^0-9]/)[0],_vsq._dataFields[92]=rnChat.vars.webId):"string"==typeof utag.data["qp.ID"]&&(rnChat.vars.webId=Number(utag.data["qp.ID"]),_vsq._dataFields[92]=rnChat.vars.webId),-1<location.href.indexOf("CategoryID=")&&(rnChat.vars.webCategoryId=Number(location.href.split("CategoryID=")[1].split(/[^0-9]/)[0])),"string"==typeof utag.data["qp.CategoryID"]&&(rnChat.vars.webCategoryId=Number(utag.data["qp.CategoryID"])),"string"==typeof utag_data.full_category_name&&0<utag_data.full_category_name.length&&(rnChat.vars.webCategoryName=utag_data.full_category_name,_vsq._dataFields[106]=rnChat.vars.webCategoryName),function(){rn_webCategoriesArray=[[5449,"Women","Dresses",""],[166444,"Women","Petites","Athleisure"],[57535,"Women","Petites","Coats"],[55596,"Women","Petites","Dresses"],[55600,"Women","Petites","Jackets & Blazers"],[55603,"Women","Petites","Jeans"],[69640,"Women","Petites","Jumpsuits & Rompers"],[46905,"Women","Petites","Leggings"],[167445,"Women","Petites","New Arrivals"],[65931,"Women","Petites","Pajamas & Robes"],[55607,"Women","Petites","Pants & Capris"],[55608,"Women","Petites","Shorts"],[55609,"Women","Petites","Skirts"],[55612,"Women","Petites","Sweaters"],[72627,"Women","Petites","Swimwear"],[55613,"Women","Petites","Tops"],[166446,"Women","Petites","Trendy"],[55610,"Women","Petites","Wear To Work"],[34051,"Women","Plus Sizes","Activewear"],[34049,"Women","Plus Sizes","Coats"],[37038,"Women","Plus Sizes","Dresses"],[128042,"Women","Plus Sizes","Graphic Tees"],[46203,"Women","Plus Sizes","Jackets & Blazers"],[40438,"Women","Plus Sizes","Jeans"],[43910,"Women","Plus Sizes","Jumpsuits & Rompers"],[72479,"Women","Plus Sizes","Leggings"],[55773,"Women","Plus Sizes","Lingerie & Shapewear"],[132942,"Women","Plus Sizes","Maternity"],[167442,"Women","Plus Sizes","New Arrivals"],[32921,"Women","Plus Sizes","Pajamas & Robes"],[34053,"Women","Plus Sizes","Pants & Capris"],[111421,"Women","Plus Sizes","Petites"],[37e3,"Women","Plus Sizes","Shorts"],[34057,"Women","Plus Sizes","Skirts"],[67545,"Women","Plus Sizes","Suits & Suit Seperates"],[40227,"Women","Plus Sizes","Sweaters"],[40227,"Women","Plus Sizes","Sweaters"],[34050,"Women","Plus Sizes","Swimwear"],[34048,"Women","Plus Sizes","Tops"],[32918,"Women","Plus Sizes","Trendy"],[4042,"Women","Plus Sizes","Wear To Work"]];for(var e=0;e<rn_webCategoriesArray.length;e++)rn_webCategoriesArray[e][0]==rnChat.vars.webCategoryId&&(rnChat.vars.webCategoryName=rn_webCategoriesArray[e][1]+" "+rn_webCategoriesArray[e][2],null!==rnChat.vars.webCategoryName.match(/Plus Size|Petite/)&&(_vsq._dataFields[93]="MCOM "+rn_webCategoriesArray[e][1]+" "+rn_webCategoriesArray[e][2]+" "+rn_webCategoriesArray[e][3]))}(),rnChat.getCookie("GCs")&&0<rnChat.getCookie("GCs").indexOf("UserName1_92_")&&(rnChat.vars.firstName=rnChat.getCookie("GCs").split("UserName1_92_")[1].split(/[0-9]/g)[0])}catch(e){console.log("-- brighttag bridge contains unexpeted entry ---"+e)}try{"number"==typeof _vsq._dataFields["incidents.prod"]?_vsq._dataFields["incidents.prod"]=_vsq._dataFields["incidents.prod"].toString():"string"!=typeof _vsq._dataFields["incidents.prod"]&&(_vsq._dataFields["incidents.prod"]="655")}catch(e){}}function setProductID(e){"object"!=typeof rnChat&&(rnChat=new Object,rnChat.vars=new Object,rnChat.vars.opsToggles=new Object,rnChat.vars.opsToggles.prodArray=[]);try{void 0===_vsq._dataFields["incidents.prod"]&&(_vsq._dataFields["incidents.prod"]="655"),void 0===e?e=Number(_vsq._dataFields["incidents.prod"]):_vsq._dataFields["incidents.prod"]=e.toString()}catch(e){}if("object"!=typeof rnChat.vars.opsToggles.prodArray||rnChat.vars.opsToggles.prodArray.length<=0){var t={ID:0,chats:!(rnChat.vars.opsToggles.prodArray=[]),hours:!1,queuing:!1};rnChat.vars.opsToggles.prodArray.push(t)}if(index=rnChat.vars.opsToggles.prodArray.map(function(e){return e.ID}).indexOf(parseInt(e)),"undefined"==typeof rn_calledArray||null===rn_calledArray){t={ID:parseInt(e),chats:!1,hours:!1,queuing:!1};rnChat.vars.opsToggles.prodArray.push(t),rn_calledArray=[],rn_calledArray.push(e),(a=document.createElement("script")).id="chat-jsonp-script-tag",a.src=rightNowDomainName+"/cgi-bin/macys.cfg/php/custom/chattest.php?ruleProductID="+e+"&callback=processJson",a.async=!1,a.type="text/javascript",document.body.appendChild(a),rnChat.vars.opsToggles.calledChatTest=1}else{var r=0;for(i=0;i<rn_calledArray.length;i++)rn_calledArray[i]===e&&(r=2);if(0===r){var a;t={ID:parseInt(e),chats:!1,hours:!1,queuing:!1};rnChat.vars.opsToggles.prodArray.push(t),rn_calledArray.push(e),(a=document.createElement("script")).id="chat-jsonp-script-tag",a.src=rightNowDomainName+"/cgi-bin/macys.cfg/php/custom/chattest.php?ruleProductID="+e+"&callback=processJson",a.async=!1,a.type="text/javascript",document.body.appendChild(a),rnChat.vars.opsToggles.calledChatTest=1}}return rnChat.vars.opsToggles.pageProductID=e,!0}function processJson(e){if("object"!=typeof rnChat.vars.opsToggles.prodArray)return!1;index=rnChat.vars.opsToggles.prodArray.map(function(e){return e.ID}).indexOf(parseInt(e.key5)),index<0||rnChat.vars.opsToggles.prodArray.splice(index,1);var t={ID:parseInt(e.key5),chats:e.key2,hours:e.key4,queuing:e.key3};rnChat.vars.opsToggles.prodArray.push(t),rnChat.vars.opsToggles.PassProductID=e.key5,rnChat.vars.opsToggles.displaychat=e.key1,rnChat.vars.opsToggles.allchatnotoff=e.key2,rnChat.vars.opsToggles.allowqueuing=e.key3,rnChat.vars.opsToggles.withinChatHours=e.key4}function allChatOffersOff(e){try{void 0===e&&(e=Number(_vsq._dataFields["incidents.prod"]))}catch(e){}if("object"!=typeof rnChat.vars.opsToggles.prodArray||rnChat.vars.opsToggles.prodArray.length<=0)return!1;var t;if("undefined"===e)return!1;for(i=0;i<rnChat.vars.opsToggles.prodArray.length;i++){rnChat.vars.opsToggles.prodArray[i].ID==e&&(t=rnChat.vars.opsToggles.prodArray[i],i=rnChat.vars.opsToggles.prodArray.length+1)}return!(!rnChat.vars.opsToggles.prodArray||!t||!0!==t.chats)}function allowQueuing(e){try{void 0===e&&(e=Number(_vsq._dataFields["incidents.prod"]))}catch(e){}if("object"!=typeof rnChat.vars.opsToggles.prodArray||rnChat.vars.opsToggles.prodArray.length<=0)return!1;var t;if("undefined"===e)return!1;for(i=0;i<rnChat.vars.opsToggles.prodArray.length;i++){rnChat.vars.opsToggles.prodArray[i].ID==e&&(t=rnChat.vars.opsToggles.prodArray[i],i=rnChat.vars.opsToggles.prodArray.length+1)}return!(!rnChat.vars.opsToggles.prodArray||!t||!0!==t.queuing)}function NoQueuing(e){try{void 0===e&&(e=Number(_vsq._dataFields["incidents.prod"]))}catch(e){}if("object"!=typeof rnChat.vars.opsToggles.prodArray||rnChat.vars.opsToggles.prodArray.length<=0)return!1;var t;if("undefined"==e)return!1;for(i=0;i<rnChat.vars.opsToggles.prodArray.length;i++){rnChat.vars.opsToggles.prodArray[i].ID==e&&(t=rnChat.vars.opsToggles.prodArray[i],i=rnChat.vars.opsToggles.prodArray.length+1)}return!(!rnChat.vars.opsToggles.prodArray||!t||!1!==t.queuing)}function withinChatHours(e){try{void 0===e&&(e=Number(_vsq._dataFields["incidents.prod"]))}catch(e){}if("object"!=typeof rnChat.vars.opsToggles.prodArray||rnChat.vars.opsToggles.prodArray.length<=0)return!1;var t;if("undefined"==e)return!1;for(i=0;i<rnChat.vars.opsToggles.prodArray.length;i++){rnChat.vars.opsToggles.prodArray[i].ID==e&&(t=rnChat.vars.opsToggles.prodArray[i],i=rnChat.vars.opsToggles.prodArray.length+1)}return!(!rnChat.vars.opsToggles.prodArray||!t||!0!==t.hours)}function outsideChatHours(e){if("object"!=typeof rnChat.vars.opsToggles.prodArray||rnChat.vars.opsToggles.prodArray.length<=0)return!1;var t;if("undefined"==e)return!1;for(i=0;i<rnChat.vars.opsToggles.prodArray.length;i++){rnChat.vars.opsToggles.prodArray[i].ID==e&&(t=rnChat.vars.opsToggles.prodArray[i],i=rnChat.vars.opsToggles.prodArray.length+1)}return!(!rnChat.vars.opsToggles.prodArray||!t||!1!==t.hours)}function elementExists(e){return!!document.getElementById(e)}function rnChatFunc(e,t){rnChat[e](t)}function rnChatSuppress(e){document.cookie="noChat=RNTLIVE; expires="+new Date(Date.now()+6e4*e).toUTCString()+";path=/"}function rnChatCCLModal(){if(0<document.querySelectorAll("#overlay-chat-modal").length){var e=document.querySelectorAll("#overlay-chat-modal")[0];if(0<document.querySelectorAll(".rn_ConditionalChatLink .rn_ChatAvailable a").length){if(0==e.classList.contains("visible")&&"string"==typeof _vsq._dataFields["incidents.prod"])(e=document.querySelectorAll("#overlay-chat-modal")[0]).querySelector("button#overlay-chat-action-accept").addEventListener("click",function(){e.classList.remove("visible"),document.querySelectorAll(".rn_ConditionalChatLink .rn_ChatAvailable a")[0].click()},!1),e.querySelector("a.overlay-close-btn").addEventListener("click",function(){e.classList.remove("visible")},!1),e.removeAttribute("style"),e.classList.add("prod-"+_vsq._dataFields["incidents.prod"]),e.classList.add("visible")}else 1==e.classList.contains("visible")&&(e.classList.remove("visible"),e.style.display="none")}}function rnRCadd(e,t,r,a){if(0<$("#"+e).length||"new"==e){if(0==$("#rnowChatLinkContainer_"+t).length){var s='<div id="rnowChatLinkContainer_'+t+'"><div id="rnowChatLink_'+t+'" ><div id="rnowChatLinkInfo_'+t+'"/></div></div>';switch(a){case"append":0==$("#rnowChatLinkContainer_"+t).length?0!==$("#qnasSummary").length?$(s).insertBefore("#qnasSummary"):0!==$("#pdpreviews").length&&$("#pdpreviews").prepend(s):$("#"+e).append(s);break;case"after":$(s).insertAfter("#"+e);break;case"before":$(s).insertBefore("#"+e);break;default:$("#"+e).prepend(s)}}return"string"==typeof r&&$("#rnowChatLinkContainer_"+t).addClass("rnowRAChat_"+r),!0}return!1}function rnRCinsertId(e,t){return $(e).attr("id",t),!0}function minSalePrice(e){try{return Number(rnChat.vars.price)>=e}catch(e){return console.log("-- salePrice variable does NOT exist ---"),!1}}function rnGetGender(){try{null!==document.title.match(/Femme|Her|Women|Parfum|Perfume|Profumo/g)&&document.getElementById("rn_Dialog_0").parentNode.parentNode.setAttribute("gender","women"),null!==document.title.match(/Homme|Him|Men|Cologne|Colonia/g)&&document.getElementById("rn_Dialog_0").parentNode.parentNode.setAttribute("gender","men")}catch(e){}}rnChat.vars.opsToggles=new Object;