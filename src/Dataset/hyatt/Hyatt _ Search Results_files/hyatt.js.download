!function(){var t="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:"undefined"!=typeof window?window:"undefined"!=typeof global?global:{};function e(t,e,i,n){return new(i||(i=Promise))((function(o,r){function s(t){try{c(n.next(t))}catch(t){r(t)}}function a(t){try{c(n.throw(t))}catch(t){r(t)}}function c(t){var e;t.done?o(t.value):(e=t.value,e instanceof i?e:new i((function(t){t(e)}))).then(s,a)}c((n=n.apply(t,e||[])).next())}))}Object.create;Object.create;var i=function(){var i=this,n={exports:this};function o(t){switch(typeof t){case"undefined":return!0;case"string":return""===t.trim();case"number":return isNaN(t);case"object":if(null==t)return!0;if(t.constructor===Object)return 0===Object.keys(t).length;if(Array.isArray(t))return 0===t.length}return!1}i.__esModule=!0,i.isEmpty=o;i.Strings=class{static noWhitespace(t){return t&&"string"==typeof t?t.replace(/\s+/g,""):""}static startWith(t,e){return t?t.substring(0,e.length)===e:t===e}static endsWith(t,e){return t.substring(t.length-e.length,t.length)===e}static isEmpty(t){return null==t||0===t.trim().length}static isLowerCase(t){return t===t.toLowerCase()&&t!==t.toUpperCase()}static isUpperCase(t){return t===t.toUpperCase()&&t!==t.toLowerCase()}static kebabCase(t){return t.replace(/([A-Z][a-z]+)/g,"$1-").toLowerCase().replace(/-$/,"")}};class r{static keys(t){return Object.keys(t)}static values(t){return Object.keys(t).map((e=>t[e]))}static entries(t){return Object.keys(t).map((e=>[e,t[e]]))}static removeEmpty(t){return t&&t.constructor===Object?Object.keys(t).reduce(((e,i)=>{const n=r.removeEmpty(t[i]);return o(n)||(e[i]=n),e}),{}):t}static sort(t){return t?Array.isArray(t)?t.map(r.sort):t.constructor===Object?Object.keys(t).sort().reduce(((e,i)=>{const n=t[i];return e[i]=r.sort(n),e}),{}):t:t}static toLowerCase(t){return"string"==typeof t?t.toLowerCase():Array.isArray(t)?t.map(r.toLowerCase):a((()=>t.constructor===Object))?Object.entries(t).reduce(((t,[e,i])=>(t[e]=r.toLowerCase(i),t)),{}):t}}i.Objects=r;i.Maps=class{static entries(t){if(t.entries)return t.entries();const e=[];return t.forEach(((t,i)=>{e.push([i,t])})),e}};class s{static from(t){return Array.from(t)}static find(t,e){if(t.find)return t.find(e);const[i]=t.filter(e);return i}static toObject(t){return t.reduce(((t,e)=>(Object.keys(e).forEach((i=>{i in t||(t[i]=e[i])})),t)),{})}static flatten(t){return t.reduce(((t,e)=>t.concat(e)),[])}static flatMap(t,e){return t.flatMap?t.flatMap(e):s.flatten(t.map(e))}static unique(t){return Array.from(new Set(t))}static clean(t){return t.filter(Boolean)}static trim(t){return t.map((t=>t.trim()))}static includes(t,e){return"includes"in t?t.includes(e):-1!==t.indexOf(e)}static last(t){return t[t.length-1]}static safeReverse(t){return t.slice().reverse()}}i.Arrays=s;function a(t,e){try{const i=t();return void 0===i?e:i}catch(t){return e}}function c(t,e){const i=e.toLowerCase(),n=s.find(Object.keys(t),(t=>t.toLowerCase()===i));if(!n)return;const o=t[n];return"string"==typeof o?o.trim():o}function l(t,...e){if(!t)return[];if(Array.isArray(t))return s.clean(s.flatten(t.map((t=>l(t,...e)))));if("object"==typeof t){const[i,...n]=e,o=c(t,i);return"object"==typeof o?l(o,...n):Boolean(o)?[o]:[]}return[]}i.Elements=class{static path(t){let e=[t];for(;t.parentElement;)t=t.parentElement,e.push(t);return e}},i.get=a,i.getAsync=function(t,i){return e(this,void 0,void 0,(function*(){try{const e=yield t();return void 0===e?i:e}catch(t){return i}}))},i.getValue=c,i.getAll=l,i.extract=function(t,e){return s.flatten(e.map((e=>s.clean(s.unique(l(t,...e.split(".")))))))};const d="undefined"!=typeof self?self:"undefined"!=typeof window?window:void 0!==t?t:void 0!==n?n:Function("return this")();function g(t,e,i,n=(t=>t)){const o=[];let r,s=0;for(;null!=(r=t.exec(e));)o.push(n(e.substring(s,r.index))),o.push(i(r)),s=t.lastIndex;return o.push(n(e.substring(s))),o.join("")}function u(t){return t.substr(0,1).toUpperCase()+t.substr(1).toLowerCase()}function h(t){return JSON.stringify(r.sort(t))}i.globalThis=d,i.accumulateMultipleValues=function(t,e,i){const n=t[e];return void 0===n?t[e]=i:Array.isArray(n)?-1==n.indexOf(i)&&n.push(i):t[e]=[n,i],t},i.regexReplace=g,i.titleCase=function(t){return g(/\w+/g,t,(t=>u(t[0])))},i.caseWord=u,i.stableJson=h,i.same=function(t,e){return h(t)===h(e)},i.sameIgnoringCase=function(t,e){return h(r.toLowerCase(t))===h(r.toLowerCase(e))},i.limit=function(t,e){return t.slice(0,e)};const p=/\s+/g;return i.cleanSpaces=function(t){return t.trim().replace(p," ")},n.exports}.call({});function n(t,e=!0){return t?(0==t.indexOf("?")&&(t=t.substring(1,t.length)),t.split("&").map((function(t){return t.split("=")})).reduce((function(t,n){const o=n[0],r=n[1];if(!o)return t;const s=r?i.get((()=>decodeURIComponent(r.replace(/\+/g,"%20"))),void 0):r,a=e?function(t){try{return JSON.parse(t)}catch(e){return t}}(s):s;return i.accumulateMultipleValues(t,o,a)}),{})):{}}function o(t,e=!0){return Object.keys(i.Objects.removeEmpty(t)).map((i=>{const n=t[i],o=e?function(t){return"string"==typeof t?t:JSON.stringify(t)}(n):n;return`${i}=${encodeURIComponent(o)}`})).join("&")}class r{constructor(t){const e=r.RFC_3986.exec(t);if(!e)throw new Error("Invalid Uri: "+t);const[,,i,,n,o,,a,,c]=e;this.scheme=i,this.authority=n?new s(n):void 0,this.path=o,this.query=a,this.fragment=c}toString(){const t=[];return void 0!==this.scheme&&t.push(this.scheme,":"),void 0!==this.authority&&t.push("//",this.authority.toString()),t.push(this.path),void 0!==this.query&&t.push("?",this.query),void 0!==this.fragment&&t.push("#",this.fragment),t.join("")}get host(){return this.authority&&this.authority.host}get port(){return this.authority&&this.authority.port}get userInfo(){return this.authority&&this.authority.userInfo}}r.RFC_3986=/^(([^:/?#]+):)?(\/\/([^/?#]*))?([^?#]*)(\?([^#]*))?(#(.*))?/;class s{constructor(t){const e=s.RFC_3986.exec(t);if(!e)throw new Error("Invalid Authority: "+t);const[,i,n,o]=e;this.userInfo=i,this.host=n,this.port=o}toString(){const t=[];return void 0!==this.userInfo&&t.push(this.userInfo,"@"),void 0!==this.host&&t.push(this.host),void 0!==this.port&&t.push(":",this.port),t.join("")}}s.RFC_3986=/(?:([^@]+)@)?([^:]+)(?::([\d]+))?/;class a{constructor(t=console.log,e=console.error,i=console.debug||console.log){this.log=t,this.error=e,this.debug=i}}class c{constructor(){this.log=()=>{},this.error=()=>{},this.debug=()=>{}}}const l="triptease-debug";function d(t,e="triptease-debug"){const o=i.get((()=>{var i;return n(null===(i=t.location)||void 0===i?void 0:i.search,!1)[e]}))||i.get((()=>{var i;return n(new r(null===(i=t.location)||void 0===i?void 0:i.originalHref).query,!1)[e]}))||i.get((()=>{var e,i;return null===(i=null===(e=t.process)||void 0===e?void 0:e.env)||void 0===i?void 0:i.DEBUG}))||i.get((()=>{var i;return(null===(i=t.localStorage)||void 0===i?void 0:i.getItem)&&t.localStorage.getItem(e)}))||"";return i.get((()=>o.substring(0,256)),"")}function g(t){const e=t.replace(/\./g,"\\.").replace(/\*/g,".*");return new RegExp("^"+e+"$")}function u(t,e=i.globalThis){try{const i=function(t){return d(t,l).split(",").map((t=>t.trim()))}(e),n=i.filter((t=>"!"===t[0])).map((t=>t.substr(1)));return n.length>0?!n.some((e=>g(e).test(t))):i.some((e=>"true"===e||g(e).test(t)))}catch(t){return!1}}class h{constructor(t){this.name=t,this.console=new a}debug(t,...e){this.console.debug(`[${this.name}] ${t}`,...e)}log(t,...e){this.console.log(`[${this.name}] ${t}`,...e)}error(t,...e){this.console.error(`[${this.name}] ${t}`,...e)}}function p(t,e=i.globalThis){return u(t,e)?new h(t):new c}class m{now(){return new Date}}function f(t){return new Promise((e=>{this.setTimeout((()=>{e()}),t)}))}class b{constructor(t=new m){this.clock=t,this.delay=f.bind(this),this.delay=f}task(t){return e(this,void 0,void 0,(function*(){return yield this.delay(0),t()}))}setTimeout(t,e){return setTimeout(t,e)}clearTimeout(t){clearTimeout(t)}setInterval(t,e){return setInterval(t,e)}clearInterval(t){clearInterval(t)}requestIdleCallback(t,e){const i=e?e.timeout:1;let n=this.clock.now().getTime()+i;const o=this;return this.setTimeout((()=>{t({didTimeout:!1,timeRemaining:()=>Math.max(0,50-(o.clock.now().getTime()-n))})}),i)}cancelIdleCallback(t){this.clearTimeout(t)}}new b;function y(t=i.globalThis){return t.triptease=t.triptease||{},t.triptease.onboard=t.triptease.onboard||{},{triptease:t.triptease,onboard:t.triptease.onboard}}const w=p("events");class v{constructor(){this.handlers=[],this.fire=t=>e(this,void 0,void 0,(function*(){w.log(`Firing handlers(${this.handlers.length})`,t),yield Promise.all(this.handlers.map((t=>e(this,void 0,void 0,(function*(){try{yield t()}catch(t){w.log("Error while firing handler",t)}})))))}))}listen(t){return e(this,void 0,void 0,(function*(){this.handlers.push(t)}))}}class k{constructor(){this.value=!1}}class O{constructor(t,i){this.delegate=t,this.running=i,this.fire=t=>e(this,void 0,void 0,(function*(){this.running.value?w.debug("Already running - skipping",t):(this.running.value=!0,yield this.delegate.fire(),this.running.value=!1)}))}listen(t){return e(this,void 0,void 0,(function*(){if(yield this.delegate.listen(t),this.running.value){w.debug("Already running - firing immediately");try{yield t()}catch(t){w.debug(t)}}}))}}class E{constructor(t,i){this.window=t,this.delegate=i,this.first=!0,this.fire=t=>e(this,void 0,void 0,(function*(){!this.window.document.hidden||this.first?(yield this.delegate.fire(),this.first=!1):w.debug("Document hidden - skipping",t)}))}listen(t){return e(this,void 0,void 0,(function*(){yield this.delegate.listen(t)}))}}class j{constructor(t,e){this.window=t,this.handle=e}start(){return e(this,void 0,void 0,(function*(){this.window.addEventListener("visibilitychange",this.handle),this.window.addEventListener("popstate",this.handle),this.window.addEventListener("hashchange",this.handle),this.window.addEventListener("pageshow",this.handle),this.window.addEventListener("pagehide",this.handle),"complete"!==this.window.document.readyState?this.window.document.addEventListener("DOMContentLoaded",this.handle):yield this.handle("Document already loaded")}))}stop(){return e(this,void 0,void 0,(function*(){this.window.removeEventListener("visibilitychange",this.handle),this.window.removeEventListener("popstate",this.handle),this.window.removeEventListener("hashchange",this.handle),this.window.removeEventListener("pageshow",this.handle),this.window.removeEventListener("pagehide",this.handle),this.window.document.removeEventListener("DOMContentLoaded",this.handle)}))}}class x{constructor(t=0,e=0,i=0,n=0){this.value=t,this.count=e,this.difference=i,this.percentage=n}calculate(t){const e=this.count+1,i=t-this.value,n=i/this.value,o=this.value+i/e;return new x(o,e,i,n)}}class S{constructor(t,i,n=.2,o=new b){this.handle=t,this.running=i,this.idleThreshold=n,this.timers=o,this.lastState=!1,this.busy=!1,this.average=new x,this.idleHandler=t=>{const e=t.timeRemaining();this.running.value?this.busy=!1:0===e?this.busy=!0:(this.average=this.average.calculate(e),this.busy=this.average.percentage<-this.idleThreshold),this.busy?this.idleId=void 0:this.idleId=this.timers.requestIdleCallback(this.idleHandler,0===e?void 0:{timeout:e})},this.intervalHandler=()=>e(this,void 0,void 0,(function*(){this.stateHasChanged()&&this.isIdle()&&(w.debug("Browser idle"),yield this.handle("Idle")),this.average=new x,this.lastState=this.busy,this.idleId||(this.idleId=this.timers.requestIdleCallback(this.idleHandler))}))}start(){return e(this,void 0,void 0,(function*(){this.intervalId=this.timers.setInterval(this.intervalHandler,1e3),this.idleId=this.timers.requestIdleCallback(this.idleHandler)}))}stop(){return e(this,void 0,void 0,(function*(){this.intervalId&&this.timers.clearInterval(this.intervalId),this.idleId&&this.timers.cancelIdleCallback(this.idleId)}))}isIdle(){return!this.busy}stateHasChanged(){return this.lastState!==this.busy}}class I{constructor(t,i){this.timers=t,this.delegate=i,this.timeoutMs=1e3,this.timerId=0,this.fire=t=>e(this,void 0,void 0,(function*(){w.debug(`Event observed, waiting for ${this.timeoutMs} ms quiet`,t),this.timers.clearInterval(this.timerId),this.timerId=this.timers.setTimeout((()=>e(this,void 0,void 0,(function*(){w.debug("Event quiet period ended, firing event",t),yield this.delegate(t)}))),this.timeoutMs)}))}}const $={characterData:!0,attributes:!0,childList:!0};class C{constructor(t){this.handle=t,this.observer=new MutationObserver(this.handle)}start(){return e(this,void 0,void 0,(function*(){}))}stop(){return e(this,void 0,void 0,(function*(){this.observer.disconnect()}))}static observe(t,e=$){if(!("MutationObserver"in i.globalThis))return t;const n=q(i.globalThis).mutation;return t instanceof HTMLInputElement||t instanceof HTMLSelectElement?t.addEventListener("change",n.handle):n.observer.observe(t,e),t}}class A{constructor(t,e=new b){this.window=t;const i=new k;this.sink=new E(t,new O(new v,i)),this.fire=new I(e,this.sink.fire).fire,this.mutation=new C(this.fire),this.sources=[new S(this.fire,i),this.mutation,new j(t,this.fire)]}listen(t){return e(this,void 0,void 0,(function*(){yield this.sink.listen(t)}))}start(){return e(this,void 0,void 0,(function*(){yield Promise.all(this.sources.map((t=>t.start())))}))}stop(){return e(this,void 0,void 0,(function*(){this.sources.forEach((t=>t.stop()))}))}}function q(t){const e=y(t).triptease;return e.events=e.events||new A(t)}class L{constructor(t,e,i=H,n=p("messaging")){this.listener=t,this.target=e,this.allowedOrigins=i,this.logger=n}addListener(t){this.listener&&this.listener.addEventListener("message",(e=>{this.disallowedOrigin(e)||function(t){try{const{target:e,method:i}=R(t.type);if(e&&i)return!0}catch(t){}return!1}(e.data)&&t(e.data,new L(void 0,e.source||this.target))}))}disallowedOrigin(t){return t.origin&&this.allowedOrigins.length>0&&-1===this.allowedOrigins.indexOf(new r(t.origin).host)}send(t){this.target.postMessage(t,"*")}}const H=["onboard.triptease.io","localhost"],M=/^(.*)\.([^.]+)$/;function R(t){const[,e,i]=t.match(M)||[];return{target:e,method:i}}function B(t){const e={};return function(...i){const n=JSON.stringify(i),o=e[n];return void 0!==o?o:e[n]=t(...i)}}function T(t,e,i){return{name:t,message:e,stack:null!=i?i:""}}class P{constructor(t){this.window=t}listen(t){this.window.addEventListener("error",(function(e){t(e.error)}))}}var U,z,D,N;class F{constructor(t,e,i="script",n){this.name=t,this.url=e,this.type=i,this.startMessage=n}}(z=U||(U={})).Search="Search",z.RoomsAndRates="RoomsAndRates",z.Confirmation="Confirmation",z.Payment="Payment",z.Group="Group",z.Partial="Partial",z.Unknown="Unknown",(N=D||(D={})).Singleton="Singleton",N.ApplicationHost="ApplicationHost",N.DataSource="DataSource";class W{static get(){return i.get((()=>{const t="3428.30504";return"v"+t}),"latest")}}function G(t){return e(this,void 0,void 0,(function*(){if("undefined"!=typeof fetch){const e=yield fetch(t.url,{method:t.method,headers:t.headers,body:t.body,credentials:t.options&&t.options.credentials?"include":"omit"});return{status:e.status,body:yield e.text()}}{const e=new XMLHttpRequest;return e.open(t.method,t.url,!0),t.headers&&Object.keys(t.headers).forEach((i=>{e.setRequestHeader(i,t.headers[i])})),t.options&&t.options.credentials&&(e.withCredentials=!0),e.send(t.body),new Promise(((t,i)=>{e.addEventListener("load",(i=>{t({status:e.status,body:e.responseText})})),e.addEventListener("error",(t=>{i(t)}))}))}}))}class V{constructor(t){this.logger=t,this.workers={}}createWorker(t,i){return e(this,void 0,void 0,(function*(){const e=this.workers[t];return e||(this.workers[t]=yield this.create(i,{name:t}))}))}create(t,i){return e(this,void 0,void 0,(function*(){try{return new Worker(t,i)}catch(e){this.logger.debug("Failed to create Worker switching to Blob Worker because:",e.message);const n=`location.originalHref = "${t}";\n`,o=(yield G({method:"GET",url:t})).body,r=new Blob([n,o],{type:"application/javascript"});return new Worker(URL.createObjectURL(r),i)}}))}}class _{constructor(t,e=p("application-starter"),i=new V(e),n=new J(t,e)){this.window=t,this.logging=e,this.workerFactory=i,this.waiter=n}start(t){return e(this,void 0,void 0,(function*(){this.logging.debug(`ApplicationStarter starting app "${t.name}" (${t.type}), ${t.url}`);const e=this.window.document;if("worker"===t.type){const e=yield this.workerFactory.createWorker(t.name,t.url);return t.startMessage&&(yield this.waiter.waitForMessage(t.startMessage,e)),this.logging.debug("ApplicationStarter returning worker"),e}const i=e.querySelector(`${t.type}[name="${t.name}"]`);if(i)return this.logging.debug(`ApplicationStarter app "${t.name}" previously started returning that`),i;const n=e.createElement(t.type);n.setAttribute("name",t.name),n.src=t.url;const o=_.DefaultOptions[t.type];return Object.keys(o).forEach((t=>{n.setAttribute(t.toLowerCase(),o[t])})),this.addElement(n),t.startMessage?yield this.waiter.waitForMessage(t.startMessage):"script"===t.type&&(yield this.waiter.waitForLoadEvent(n)),n}))}addElement(t){(this.window.document.body||this.window.document.documentElement).appendChild(t)}}_.DefaultOptions={script:{defer:"",async:"",crossOrigin:"anonymous"},iframe:{style:"display: none;",sandbox:"allow-scripts allow-same-origin",title:"blank","aria-hidden":"true"}};class J{constructor(t,e){this.window=t,this.logging=e}waitForLoadEvent(t){return this.logging.debug("MessageWaiter waiting for load/error event for",t),new Promise(((e,i)=>{t.addEventListener("load",e),t.addEventListener("error",i)}))}waitForMessage(t,e=this.window){return this.logging.debug("MessageWaiter waiting for message",t),new Promise((i=>{this.logging.debug("MessageWaiter creating handler");const n=o=>{try{const r=o.data&&o.data.type,s=r===t;this.logging.debug(`ApplicationStarter message received "${r}", expecting "${t}", matched: ${s}`),s&&(e.removeEventListener("message",n),i(o.data))}catch(t){this.logging.debug("ApplicationStarter error in parsing message",t,o)}};this.logging.debug("MessageWaiter adding listener"),e.addEventListener("message",n)}))}}class K{constructor(t,e=new m){this.browserWindow=t,this.clock=e}get(t){const e=this.browserWindow.document.cookie.match(new RegExp(`(^| )${t}=([^;]+)`));if(e)return i.get((()=>decodeURIComponent(e[2])))}set(t,e,i,n,o){const r=[`${encodeURIComponent(t)}=${encodeURIComponent(e)}`,i?`; max-age=${i}; expires=${new Date(this.clock.now().getTime()+1e3*i).toUTCString()}`:"",n?"; path="+n:"",o?"; domain="+o:""].join("");this.browserWindow.document.cookie=r}}function Z(t,e){for(e=t="";t++<36;e+=51*t&52?(15^t?8^Math.random()*(20^t?16:4):4).toString(16):"-");return e}class X{constructor(t,e=G,i=new K(t)){this.browserWindow=t,this.httpClient=e,this.cookie=i,this.identityDataCookieName="triptease-identity-data",this.identityDataCookieAge=25200,this.domainUserIdName="tt-domain-user-id",this.domainUserIdAge=15768e4}getIdentity(){return e(this,void 0,void 0,(function*(){const t=yield this.httpClient({url:"https://api.triptease.io/identity-service/identity",method:"GET",options:{credentials:!0}}),e=JSON.parse(t.body),i=this.getLocalIdentity();return i&&!0===e.isFreshSession?Object.assign(Object.assign({},i),{domainUserId:this.getOrCreateDomainId()}):(this.storeLocalIdentity(e),Object.assign(Object.assign({},e),{domainUserId:this.getOrCreateDomainId()}))}))}storeLocalIdentity(t){this.cookie.set(this.identityDataCookieName,this.browserWindow.btoa(JSON.stringify(t)),this.identityDataCookieAge,"/")}getLocalIdentity(){const t=this.cookie.get(this.identityDataCookieName);if(t)return JSON.parse(this.browserWindow.atob(t))}getOrCreateDomainId(){try{const t=this.browserWindow.localStorage.getItem(this.domainUserIdName)||this.cookie.get(this.domainUserIdName);if(t)return t}catch(t){}const t=Z();try{this.browserWindow.localStorage.setItem(this.domainUserIdName,t)}catch(t){}return this.cookie.set(this.domainUserIdName,t,this.domainUserIdAge),t}}class Y{generate(t){if(void 0!==t)throw new Error("UuidGenerator does not support custom lengths");return Z().replace(/-/g,"")}}class Q{constructor(t,e){this.messaging=t,this.idGenerator=e}get(t,i,n){return(...t)=>e(this,void 0,void 0,(function*(){const e=this.idGenerator.generate(),{payload:n}=yield this.messaging.handle({type:"triptease.onboard.request",requestType:String(i),payload:t,correlationId:e});if((o=n)&&"object"==typeof o&&"name"in o&&"string"==typeof o.name&&"message"in o&&"string"==typeof o.message&&"stack"in o&&"string"==typeof o.stack)throw n;var o;return n}))}}function tt(t,e=new Y){return new Proxy({},new Q(t,e))}class et{constructor(t,i=tt(t)){this.proxy=i,this.applicationConfig=B((t=>e(this,void 0,void 0,(function*(){return yield this.proxy.applicationConfig(t)})))),this.generateConfig=B((t=>e(this,void 0,void 0,(function*(){return yield this.proxy.generateConfig(t)}))))}}class it{constructor(){this.scripts=[]}static create(t){const e=y(t).onboard,i=e.stackScriptFinder;return i||(e.stackScriptFinder=new it)}capture(){try{throw new Error}catch(t){if(!t.stack)return;const e=t.stack.match(/(https?.*):\d+:\d+/);if(!e)return;const i=e[1];this.scripts.push(new r(i))}}get(){return this.scripts}}function nt(t){return e(this,void 0,void 0,(function*(){const e=t[t.GoogleAnalyticsObject||"ga"];return"function"!=typeof e?[]:yield new Promise((t=>e((()=>t(i.Arrays.unique(e.getAll().map((t=>t.get("trackingId")))))))))}))}function ot(t){return i.Arrays.unique(Array.from(t.document.querySelectorAll("script[src*=googletagmanager]")).map((t=>{const{query:e}=new r(t.src),{id:i}=n(e);return i})))}const rt={name:"onboard",version:W.get()},st=/^\d{4}-\d{2}-\d{2}(?:T\d{2}:\d{2}:\d{2}\.\d{3}Z)?$/;function at(t,e,n){if(e(t))return n(t);switch(typeof t){case"undefined":return;case"object":if(null===t)return null;if(Array.isArray(t))return t.map((t=>at(t,e,n)));if(t.constructor===Object)return i.Objects.keys(t).sort().reduce(((i,o)=>{const r=t[o];return i[o]=at(r,e,n),i}),{})}return t}function ct(t){return function(t){return at(t,(t=>"string"==typeof t&&st.test(t)),(t=>{const e=new Date(t);return isNaN(e.valueOf())?t:e}))}(JSON.parse(t))}class lt{static parse(t){return ct(t)}static stringify(t){return JSON.stringify(this.validate(t))}static validate(t){return at(t,(t=>{const e=typeof t;switch(e){case"undefined":case"string":case"number":case"boolean":return!0;case"object":if(null===t)return!0;if(Array.isArray(t))return!1;if(t.constructor===Object)return!1;if("toJSON"in t)return!0}throw new Error(`Illegal JsonValue: ${e} ${t} `)}),(t=>t))}}class dt{static same(t,e){return lt.stringify(t)===lt.stringify(e)}static isSuperset(t,e){return null===t||null===e?dt.same(t,e):Array.isArray(t)&&Array.isArray(e)?!(t.length>e.length)&&t.every((t=>e.some((e=>dt.isSuperset(t,e))))):i.get((()=>t.constructor===Object))&&i.get((()=>e.constructor===Object))?Object.keys(t).reduce(((i,n)=>i&&dt.isSuperset(t[n],e[n])),!0):dt.same(t,e)}static compress(t){const e=dt.groupValues(t);return this.compressGrouped(e)}static compressGrouped(t){return Object.entries(t).reduce((({shared:t,unique:e},[n,o])=>{if(i.get((()=>o.constructor===Object))){const i=dt.compressGrouped(o);Object.keys(i.shared).length>0&&(t[n]=i.shared),i.unique.forEach(((t,i)=>{e[i]=e[i]||{},Object.keys(t).length>0&&(e[i][n]=t)}))}return Array.isArray(o)&&o.forEach(((r,s)=>{e[s]=e[s]||{},1===i.Arrays.unique(o.map((t=>lt.stringify(t)))).length?t[n]=r:void 0!==r&&(e[s][n]=r)})),{shared:t,unique:e}}),{shared:{},unique:[]})}static groupValues(t){const e=Array.from(t.reduce(((t,e)=>Object.keys(e).reduce(((t,e)=>t.add(e)),t)),new Set)),[n,o]=t.reduce(((t,n)=>e.reduce((([t,e],o)=>{const r=n[o];return i.get((()=>r.constructor===Object))?(e[o]=e[o]||[],e[o].push(r)):(t[o]=t[o]||[],t[o].push(r)),[t,e]}),t)),[{},{}]),r=Object.entries(o).reduce(((t,[e,i])=>(t[e]=dt.groupValues(i),t)),{});return Object.assign(Object.assign({},n),r)}static decompress(t){return t.unique.map((e=>this.merge(t.shared,e)))}static merge(t,e){return[...Object.keys(t),...Object.keys(e)].reduce(((n,o)=>{const r=t[o],s=e[o];return i.get((()=>r.constructor===Object))&&i.get((()=>s.constructor===Object))?n[o]=dt.merge(r,s):n[o]=null!=s?s:r,n}),{})}}function gt(t){return{title:t.document.title,locale:t.document.documentElement.lang||t.document.documentElement.getAttribute("xml:lang")||"",url:t.location.href,urlParsed:ut(t.location.href),referrer:t.document.referrer,referrerParsed:ut(t.document.referrer),characterSet:t.document.characterSet}}function ut(t){if(!t)return{};const{scheme:e,host:o,path:s,query:a,fragment:c}=new r(t);return i.Objects.removeEmpty({scheme:e,host:o,path:s,query:a,queryParsed:n(a,!1),fragment:c})}class ht{constructor(t,e=new m){this.window=t,this.clock=e;try{this.timezone=Intl.DateTimeFormat().resolvedOptions().timeZone}catch(t){this.timezone=""}}buildMessage(t){return e(this,void 0,void 0,(function*(){const n=i.get((()=>this.window.triptease.onboard.bootstrap.identity)),o=this.clock.now();return dt.merge({createdAt:o,messageId:Z(),userId:i.get((()=>n.userId)),sessionId:i.get((()=>n.sessionId)),domainUserId:i.get((()=>n.domainUserId)),context:{library:rt,userAgent:this.window.navigator.userAgent,locale:this.window.navigator.language,page:gt(this.window),screen:{width:this.window.screen.width,height:this.window.screen.height},timezone:this.timezone,google:yield i.getAsync((()=>function(t){return e(this,void 0,void 0,(function*(){return{ga:yield nt(t),gtm:ot(t)}}))}(this.window)),{})}},t)}))}}function pt(t){return t&&"object"==typeof t&&"triptease.onboard.request"===t.type&&"string"==typeof t.requestType&&"string"==typeof t.correlationId&&Array.isArray(t.payload)}function mt(t){return t&&"object"==typeof t&&"triptease.onboard.response"===t.type&&"string"==typeof t.correlationId}function ft(t,e){return{type:"triptease.onboard.response",correlationId:t,payload:e}}function bt(t,e){return ft(t,T("MissingHandler","No handler for "+e))}const yt=p("messaging");class wt{constructor(){this.handlers=new Map}register(t,e){return t.forEach((t=>{if(this.hasHandlerFor(t))throw new Error(`Method name "${t}" already registered to a handler`);this.handlers.set(t,e)})),this}handle(t){return e(this,void 0,void 0,(function*(){const e=this.handlers.get(t.requestType);return e?(yt.debug("Matched message to handler",t,e),yield e.handle(t)):bt(t.correlationId,t.requestType)}))}hasHandlerFor(t){return this.handlers.has(t)}}const vt=p("messaging");class kt{constructor(t){this.target=t}handle(t){return e(this,void 0,void 0,(function*(){const e=this.target[t.requestType];if(!e)return vt.debug("No method found that matches method",t.requestType,this.target),bt(t.correlationId,t.requestType);try{vt.debug("Found method",t.requestType);const i=yield e.apply(this.target,t.payload);return ft(t.correlationId,i)}catch(e){return vt.debug("Error trying to in invoke method",t.requestType,e),function(t,e){return ft(t,T(e.name,e.message,e.stack))}(t.correlationId,e)}}))}}function Ot(t,...e){const n=i.getAll(t,...e);if(!n)return;const[o]=[...n].reverse();return o}function Et(t){const e=i.get((()=>function(t){const e=t.hostname.toLowerCase(),i=t.href.toLowerCase();return"gc.synxis.com"===e?"SynxisV1":"be.synxis.com"===e?"SynxisV2":-1!==e.indexOf("travelclick")?"TravelClick":-1!==e.indexOf("bookingbutton")||-1!==e.indexOf("book-directonline")?"SiteMinder":-1!==e.indexOf("firmdalehotels")?"Firmdale":-1!==e.indexOf("apxhotelsapartments")||-1!==e.indexOf("mews.li")?"Mews":-1!==e.indexOf("guestline.net")||-1!==e.indexOf("roomlynx.net")?"Guestline":-1!==e.indexOf("theluxcollective.com")||-1!==e.indexOf("luxresorts.com")?"Lux":-1!==e.indexOf("book-onlinenow.net")?"BookOnlineNow":-1!==e.indexOf("windsurfercrs.com")?"SHR":-1!==e.indexOf("leonardo-hotels")?"Leonardo":-1!==e.indexOf("bestwestern.fr")?"BestWesternFrance":-1!==e.indexOf("imperatore.it")?"Imperatore":-1!==e.indexOf("walkerhill.com")?"Walkerhill":-1!==i.indexOf("webrez.com")||-1!==e.indexOf("worldweb.com")||-1!==e.indexOf("webrez.com/v")?"WebRezPro":-1!==e.indexOf("hoteliers.com")?"Hoteliers":-1!==e.indexOf("doylecollection")?"DoyleCollection":-1!==i.indexOf("/bookcore/")?"Roiback":-1!==e.indexOf("nativeplaces.com")?"NativePlaces":-1!==e.indexOf("fattal-hotels")?"Fattal":-1!==i.indexOf("/cgi-bin/lansaweb")?"StationCasinosV1":"www.palms.com"===e?"StationCasinosV2":-1!==e.indexOf(".webhotel.")?"Opera":-1!==e.indexOf("constancehotels.com")?"ConstanceHotels":-1!==e.indexOf("online.bookvisit.")?"BookVisit":-1!==e.indexOf("direct-reservation")?"BusyRooms":-1!==e.indexOf("youngshotels")?"Youngs":"reservations.thekingsburyhotel.com"===e||"bookings.amayaresorts.com"===e?"Hayleys":"www.universalhotels.es"===e?"Hotetec":-1!==e.indexOf("www.secure-res.com")?"Vizergy":-1!==e.indexOf("loewshotels")?"Loews":-1!==i.indexOf("bookings.hamiltonisland.com.au/m/")?"HamiltonIslandMobile":-1!==i.indexOf("bookings.hamiltonisland.com.au/")?"HamiltonIsland":-1!==e.indexOf("regalhotel")?"RegalHotels":-1!==e.indexOf("marinabaysands")?"MarinaBaySands":-1!==e.indexOf("live.high-level-software")?"HighLevelSoftware":-1!==e.indexOf("book.my-rez")?"MyRez":-1!==e.indexOf("premiereserve.com")||-1!==e.indexOf("teg-hotels.com")?"Everly":-1!==e.indexOf("simplebooking")||-1!==e.indexOf("booking.crimsonhotel")?"SimpleBooking":-1!==e.indexOf("bookassist.com")?"BookAssist":-1!==e.indexOf("swissotel.com")?"Swissotel":-1!==e.indexOf("booking.africaalbidatourism.com")?"AfricaAlbida":-1!==e.indexOf("pphotels.com")||-1!==e.indexOf("erez.mmcmg.net")?"PrimePlaza":-1!==e.indexOf("onepagebooking.com")?"HotelNetSolutions":-1!==e.indexOf("reservhotel.com")?"ReserveHotel":-1!==e.indexOf("thorbooking.com")?"ThinkIn":-1!==i.indexOf("/irmng")?"IRM":-1!==e.indexOf("booking-channel.com")?"Hotusa":"www.venetian.com"===e?"Sandsvegas":"bookingresults.com"===e?"Silverbyte":-1!==e.indexOf("clock-software.com")||-1!==e.indexOf("villasriomar.com")?"Clock":-1!==e.indexOf("tajinnercircle.com")||-1!==e.indexOf("tajhotels.com")?"Taj":-1!==e.indexOf("booking.iberostartheclub.com")?"Iberostar":-1!==e.indexOf("services.comwell.com")?"Comwell":-1!==e.indexOf("elinapms.com")?"Elina":-1!==e.indexOf("booking.profitroom.com")?"Profitroom":-1!==e.indexOf("bookingexpert.it")?"Bookingexpert":-1!==e.indexOf("cloud-reservations.net")?"Hart":-1!==e.indexOf("irm1.net")?"RDP":-1!==e.indexOf(".palaceresorts.com")||-1!==e.indexOf(".moonpalace.com")||-1!==e.indexOf(".leblancsparesorts.com")||-1!==e.indexOf(".beachviewbarbados.com")||-1!==e.indexOf(".oceantwobarbados.com")||-1!==e.indexOf(".sea-breeze.com")||-1!==e.indexOf(".southbeachbarbados.com")?"Kognitiv":-1!==e.indexOf("iqwebbook.com")?"Innquest":-1!==e.indexOf("theguild.co")?"Guild":-1!==e.indexOf("innroad.com")?"Innroad":-1!==e.indexOf("furama.com")?"Furama":-1!==e.indexOf("www.germainhotels.com")?"GermainHotels":-1!==e.indexOf("reztrip")?"Reztrip":-1!==e.indexOf("nisekoportfolio.com")?"Bookeasy":-1!==e.indexOf("azimuthotels")&&-1===e.indexOf("reservations")?"Azimut":-1!==e.indexOf("steigenberger.com")||-1!==e.indexOf("intercityhotel.com")||-1!==e.indexOf("maxxhotel.com")||-1!==e.indexOf("jaz-hotel.com")?"DeutscheHospitality":-1!==e.indexOf("cloudbeds.com")?"CloudBeds":-1!==e.indexOf("coasthotels.com")?"Amadeus":-1!==e.indexOf("thehoxton.com")?"Hoxton":-1!==e.indexOf("lottehotel.com")?"LotteHotel":-1!==e.indexOf("kempinski.com")?"Kempinski":-1!==e.indexOf("derquebooking")?"DerqueBooking":-1!==e.indexOf("ovolohotels.com")?"Ovolo":-1!==e.indexOf("gleneagles.com")?"Gleneagles":-1!==e.indexOf("redplanethotels.com")?"RedPlanet":-1!==e.indexOf("banffjaspercollection.com")||-1!==e.indexOf("glacierparkcollection.com")?"PursuitCollection":-1!==e.indexOf("bestwestern.co.uk")?"BestWesternUk":-1!==e.indexOf("sbe.com")?"Sbe":-1!==e.indexOf("bode.co")?"Bode":-1!==e.indexOf("reserve-online.net")?"ReserveOnline":-1!==e.indexOf("secure-hotel-booking.com")?"Availpro":-1!==e.indexOf(".syshotelonline.it")?"SysHotelOnline":void 0}(t.location)));if(e)return{bookingEngine:e};const n=i.get((()=>function(t){if(t.document.querySelector('link[href*="be.synxis.com"]'))return"SynxisV2";if(i.get((()=>Object.keys(t._GlobalTokens).length),0))return 1==(Boolean(t.document.querySelector("#XbeViewPanel"))?1:2)?"SynxisV1":"SynxisV2";return i.get((()=>-1!==t.apiUrl.indexOf("travelclick")),!1)||i.get((()=>!!Ot(t.dataLayer,"ihHotelID")),!1)||i.get((()=>!!i.Arrays.find(i.Arrays.from(t.document.querySelectorAll('script[type="text/javascript"]')).map((t=>t.textContent)),(t=>-1!==t.indexOf("travelclick")))),!1)?"TravelClick":i.get((()=>t.document.querySelector('link[href*="vendors~about~booking~cancellation~checkout~confirmation~contact~policies~reservation"]')))||i.get((()=>"Modern"===Ot(t.dataLayer,"booking_engine")),!1)||i.get((()=>!!Ot(t.dataLayer,"tbb_prefix")),!1)||i.get((()=>!!Ot(t.dataLayer,"virtual_url")),!1)||i.get((()=>!!t.document.querySelector('meta[name="occupancy-includes-infants"]')),!1)?"SiteMinder":i.get((()=>t.dataLayer.some((t=>t.neobookings))),!1)?"NeoBookings":i.get((()=>"smart"===Ot(t.dataLayer,"context.application")),!1)?"AvailPro":i.get((()=>Boolean(t.document.querySelectorAll("iframe.mews-distributor").length)),!1)?"Mews":i.get((()=>Boolean(t.WSMAIN)),!1)?"SHR":i.get((()=>0!==i.Arrays.from(t.document.querySelectorAll("script")).filter((t=>-1!==t.src.indexOf("js/ehors"))).length),!1)?"EHORS":i.get((()=>t.document.querySelector("#clienId")),void 0)?"RMSCloud":null!==t.document.querySelector("body#ElinaPBE")?"Elina":null!==t.document.getElementById("bookingGadget")?"GuestCentric":Boolean(t.document.querySelector('div[id^="phMasterBody_"]'))?"UIBScrs":Boolean(t.document.querySelector('script[src*="UiBSJs"]'))?"UIBScrsV2":i.get((()=>Boolean(t.Mirai)),!1)?"Mirai":"paraty"===t.MAIN_SITE?"Paraty":t.document.querySelector('[href^="https://www.booking2hotels.com"]')||t.document.querySelector('.booking-engine img[src*="booking2hotels"]')?"Booking2Hotels":t.document.querySelector('script[src*="seekda"]')?"Seekda":t.document.querySelector('meta[name="author"][content*="alaric"]')?"Alaric":i.get((()=>-1!==t.top.location.hostname.toLowerCase().indexOf("hotel-llevant")),!1)?"Prestige":i.get((()=>-1!==t.document.querySelector('meta[name="description"]').content.indexOf("reztrip")),!1)?"Reztrip":i.get((()=>!!t.PROTELWBE5),!1)?"Protel":i.get((()=>-1!==t.document.title.indexOf("ThinkIn")))||t.RFH_Room_Booking?"ThinkIn":i.get((()=>t.document.querySelector('link[href*="/bookvisit/"]')))?"BookVisit":i.get((()=>t.document.querySelector('link[href*="webhotelier.net"]')))?"ReserveOnline":i.get((()=>t.document.querySelector("#availpro-tracker")))?"Availpro":void 0}(t)));if(n)return{bookingEngine:n};const o=function(t){const e=t.querySelector('script[src*="static.triptease.io/client-integrations/"]');if(!e)return;const i=e.src,n=i.match(/\/([^/]+).js$/);if(!n)return;const o=n[1];return o?{bookingEngine:o.toLowerCase(),originalUrl:i}:void 0}(t.document);return o||(r=t.document,{bookingEngine:i.get((()=>r.querySelector('script[src*="onboard.triptease.io/bootstrap.js"]').src.match(/fallback=([a-zA-Z]+)/)[1]),"Default")});var r}const jt=W.get(),xt=[{bookingEngine:"Default",script:`https://onboard.triptease.io/integrations/${jt}/default.js`},{bookingEngine:"Generic",script:`https://onboard.triptease.io/integrations/${jt}/generic.js`},{bookingEngine:"SynxisV1",script:`https://onboard.triptease.io/integrations/${jt}/synxis-v1.js`},{bookingEngine:"SynxisV2",script:`https://onboard.triptease.io/integrations/${jt}/synxis-v2.js`},{bookingEngine:"TravelClick",script:"https://onboard.triptease.io/integrations/latest/travelclick.js"},{bookingEngine:"iHotelierV2",script:`https://onboard.triptease.io/integrations/${jt}/travelclick.js`},{bookingEngine:"Firmdale",script:`https://onboard.triptease.io/integrations/${jt}/firmdale.js`},{bookingEngine:"SiteMinder",script:`https://onboard.triptease.io/integrations/${jt}/siteminder.js`},{bookingEngine:"Mews",script:`https://onboard.triptease.io/integrations/${jt}/mews.js`},{bookingEngine:"Guestline",script:`https://onboard.triptease.io/integrations/${jt}/guestline.js`},{bookingEngine:"Lux",script:"https://integration.triptease.io/client-integrations/platform/lux.js"},{bookingEngine:"BookOnlineNow",script:`https://onboard.triptease.io/integrations/${jt}/book-online-now.js`},{bookingEngine:"SHR",script:`https://onboard.triptease.io/integrations/${jt}/shr.js`},{bookingEngine:"Leonardo",script:"https://integration.triptease.io/client-integrations/platform/leonardo.js"},{bookingEngine:"BestWesternFrance",script:"https://integration.triptease.io/client-integrations/platform/best-western-france.js"},{bookingEngine:"Imperatore",script:"https://integration.triptease.io/client-integrations/platform/imperatore.js"},{bookingEngine:"Walkerhill",script:"https://integration.triptease.io/client-integrations/platform/walkerhill.js"},{bookingEngine:"WebRezPro",script:`https://onboard.triptease.io/integrations/${jt}/webrezpro.js`},{bookingEngine:"Hoteliers",script:"https://integration.triptease.io/client-integrations/platform/hoteliers.js"},{bookingEngine:"RMSCloud",script:"https://integration.triptease.io/client-integrations/platform/rmscloud.js"},{bookingEngine:"DoyleCollection",script:"https://integration.triptease.io/client-integrations/platform/doyle-collection.js"},{bookingEngine:"Elina",script:"https://integration.triptease.io/client-integrations/platform/elina.js"},{bookingEngine:"EHORS",script:"https://integration.triptease.io/client-integrations/platform/ehors.js"},{bookingEngine:"UIBScrs",script:"https://integration.triptease.io/client-integrations/platform/uibscrs.js"},{bookingEngine:"UIBScrsV2",script:`https://onboard.triptease.io/integrations/${jt}/uibscrs.js`},{bookingEngine:"Roiback",script:`https://onboard.triptease.io/integrations/${jt}/roiback.js`},{bookingEngine:"NativePlaces",script:"https://integration.triptease.io/client-integrations/platform/native-places.js"},{bookingEngine:"Mirai",script:`https://onboard.triptease.io/integrations/${jt}/mirai.js`},{bookingEngine:"Fattal",script:"https://integration.triptease.io/client-integrations/platform/fattal.js"},{bookingEngine:"Opera",script:"https://integration.triptease.io/client-integrations/platform/opera.js"},{bookingEngine:"BookVisit",script:"https://integration.triptease.io/client-integrations/platform/book-visit.js"},{bookingEngine:"GuestCentric",script:`https://onboard.triptease.io/integrations/${jt}/guest-centric.js`},{bookingEngine:"BusyRooms",script:"https://integration.triptease.io/client-integrations/platform/busy-rooms.js"},{bookingEngine:"Youngs",script:`https://onboard.triptease.io/integrations/${jt}/youngs.js`},{bookingEngine:"Hayleys",script:"https://integration.triptease.io/client-integrations/platform/hayleys.js"},{bookingEngine:"Hotetec",script:"https://integration.triptease.io/client-integrations/platform/hotetec.js"},{bookingEngine:"Vizergy",script:"https://integration.triptease.io/client-integrations/platform/vizergy.js"},{bookingEngine:"Loews",script:"https://integration.triptease.io/client-integrations/platform/loews.js"},{bookingEngine:"HamiltonIslandMobile",script:"https://integration.triptease.io/client-integrations/platform/hamilton-island-mobile.js"},{bookingEngine:"HamiltonIsland",script:`https://onboard.triptease.io/integrations/${jt}/hamiltonisland.js`},{bookingEngine:"RegalHotels",script:"https://integration.triptease.io/client-integrations/platform/regal-hotels.js"},{bookingEngine:"HighLevelSoftware",script:"https://integration.triptease.io/client-integrations/platform/high-level-software.js"},{bookingEngine:"MarinaBaySands",script:"https://integration.triptease.io/client-integrations/platform/marina-bay-sands.js"},{bookingEngine:"MyRez",script:"https://integration.triptease.io/client-integrations/platform/my-rez.js"},{bookingEngine:"Everly",script:"https://integration.triptease.io/client-integrations/platform/everly.js"},{bookingEngine:"SimpleBooking",script:"https://integration.triptease.io/client-integrations/platform/simple-booking.js"},{bookingEngine:"BookAssist",script:`https://onboard.triptease.io/integrations/${jt}/bookassist.js`},{bookingEngine:"Swissotel",script:"https://integration.triptease.io/client-integrations/platform/swissotel.js"},{bookingEngine:"PrimePlaza",script:"https://integration.triptease.io/client-integrations/platform/prime-plaza.js"},{bookingEngine:"HotelNetSolutions",script:`https://onboard.triptease.io/integrations/${jt}/hotel-net-solutions.js`},{bookingEngine:"ReserveHotel",script:`https://onboard.triptease.io/integrations/${jt}/reserve-hotel.js`},{bookingEngine:"NeoBookings",script:"https://integration.triptease.io/client-integrations/platform/neo-bookings.js"},{bookingEngine:"IRM",script:"https://integration.triptease.io/client-integrations/platform/irm.js"},{bookingEngine:"Hotusa",script:"https://integration.triptease.io/client-integrations/platform/hotusa.js"},{bookingEngine:"ThinkIn",script:"https://integration.triptease.io/client-integrations/platform/thinkin.js"},{bookingEngine:"Sandsvegas",script:"https://integration.triptease.io/client-integrations/platform/sandsvegas.js"},{bookingEngine:"Paraty",script:`https://onboard.triptease.io/integrations/${jt}/paraty.js`},{bookingEngine:"Silverbyte",script:"https://integration.triptease.io/client-integrations/platform/silverbyte.js"},{bookingEngine:"Clock",script:"https://integration.triptease.io/client-integrations/platform/clock.js"},{bookingEngine:"Iberostar",script:"https://integration.triptease.io/client-integrations/platform/iberostar.js"},{bookingEngine:"AfricaAlbida",script:`https://onboard.triptease.io/integrations/${jt}/africa-albida.js`},{bookingEngine:"ConstanceHotels",script:`https://onboard.triptease.io/integrations/${jt}/constance-hotels.js`},{bookingEngine:"Comwell",script:`https://onboard.triptease.io/integrations/${jt}/comwell.js`},{bookingEngine:"Profitroom",script:`https://onboard.triptease.io/integrations/${jt}/profitroom.js`},{bookingEngine:"Prestige",script:`https://onboard.triptease.io/integrations/${jt}/prestige.js`},{bookingEngine:"Bookingexpert",script:`https://onboard.triptease.io/integrations/${jt}/bookingexpert.js`},{bookingEngine:"Booking2Hotels",script:`https://onboard.triptease.io/integrations/${jt}/booking2hotels.js`},{bookingEngine:"Alaric",script:`https://onboard.triptease.io/integrations/${jt}/alaric.js`},{bookingEngine:"Hart",script:`https://onboard.triptease.io/integrations/${jt}/hart.js`},{bookingEngine:"StationCasinosV1",script:`https://onboard.triptease.io/integrations/${jt}/station-casinos-v1.js`},{bookingEngine:"StationCasinosV2",script:`https://onboard.triptease.io/integrations/${jt}/station-casinos-v2.js`},{bookingEngine:"RDP",script:"https://integration.triptease.io/client-integrations/platform/rdp.js"},{bookingEngine:"Kognitiv",script:`https://onboard.triptease.io/integrations/${jt}/kognitiv.js`},{bookingEngine:"Innquest",script:`https://onboard.triptease.io/integrations/${jt}/innquest.js`},{bookingEngine:"Guild",script:`https://onboard.triptease.io/integrations/${jt}/guild.js`},{bookingEngine:"Seekda",script:`https://onboard.triptease.io/integrations/${jt}/seekda.js`},{bookingEngine:"Innroad",script:`https://onboard.triptease.io/integrations/${jt}/innroad.js`},{bookingEngine:"Furama",script:`https://onboard.triptease.io/integrations/${jt}/furama.js`},{bookingEngine:"GermainHotels",script:`https://onboard.triptease.io/integrations/${jt}/germain-hotels.js`},{bookingEngine:"Taj",script:`https://onboard.triptease.io/integrations/${jt}/taj.js`},{bookingEngine:"Reztrip",script:`https://onboard.triptease.io/integrations/${jt}/reztrip.js`},{bookingEngine:"Bookeasy",script:`https://onboard.triptease.io/integrations/${jt}/bookeasy.js`},{bookingEngine:"Protel",script:`https://onboard.triptease.io/integrations/${jt}/protel.js`},{bookingEngine:"Azimut",script:`https://onboard.triptease.io/integrations/${jt}/azimut.js`},{bookingEngine:"DeutscheHospitality",script:`https://onboard.triptease.io/integrations/${jt}/deutsche-hospitality.js`},{bookingEngine:"CloudBeds",script:`https://onboard.triptease.io/integrations/${jt}/cloudbeds.js`},{bookingEngine:"Amadeus",script:`https://onboard.triptease.io/integrations/${jt}/amadeus.js`},{bookingEngine:"LotteHotel",script:`https://onboard.triptease.io/integrations/${jt}/lotte.js`},{bookingEngine:"Hoxton",script:`https://onboard.triptease.io/integrations/${jt}/hoxton.js`},{bookingEngine:"Kempinski",script:`https://onboard.triptease.io/integrations/${jt}/kempinski.js`},{bookingEngine:"DerqueBooking",script:`https://onboard.triptease.io/integrations/${jt}/derque-booking.js`},{bookingEngine:"Ovolo",script:`https://onboard.triptease.io/integrations/${jt}/ovolo.js`},{bookingEngine:"Gleneagles",script:`https://onboard.triptease.io/integrations/${jt}/gleneagles.js`},{bookingEngine:"RedPlanet",script:`https://onboard.triptease.io/integrations/${jt}/redplanet.js`},{bookingEngine:"PursuitCollection",script:`https://onboard.triptease.io/integrations/${jt}/pursuit-collection.js`},{bookingEngine:"BestWesternUk",script:`https://onboard.triptease.io/integrations/${jt}/best-western-uk.js`},{bookingEngine:"Sbe",script:`https://onboard.triptease.io/integrations/${jt}/sbe.js`},{bookingEngine:"Bode",script:`https://onboard.triptease.io/integrations/${jt}/bode.js`},{bookingEngine:"ReserveOnline",script:`https://onboard.triptease.io/integrations/${jt}/reserve-online.js`},{bookingEngine:"Availpro",script:`https://onboard.triptease.io/integrations/${jt}/availpro.js`},{bookingEngine:"SysHotelOnline",script:`https://onboard.triptease.io/integrations/${jt}/sys-hotel-online.js`}].reduce(((t,e)=>(t[St(e.bookingEngine)]=new F(e.bookingEngine,e.script,"script"),t)),{});function St(t){return t.replace("-","").toLowerCase()}const It=xt[St("Default")];function $t({bookingEngine:t,originalUrl:e}){const i=xt[St(t)];return i||(e?function(t,e){return new F(t,e.replace("static.triptease.io","integration.triptease.io"),"script")}(t,e):It)}const Ct=p("messaging");class At{constructor(t){this.messageHandler=t,this.promises=new Map,t&&t.addListener((t=>{if(mt(t)){const{correlationId:e}=t,i=this.promises.get(e);i&&(Ct.debug("Sender matched response",t),i.resolve(t),this.promises.delete(e))}}))}handle(t){return e(this,void 0,void 0,(function*(){return Ct.debug("Sending request",t),this.messageHandler&&this.messageHandler.send(t),new Promise(((e,i)=>{this.promises.set(t.correlationId,{resolve:e,reject:i})}))}))}}const qt=p("messaging");class Lt{constructor(t,e){this.listen=t,this.router=e,this.rules=[],t.addListener(this.handler.bind(this)),this.addRule(pt,(t=>t),(t=>t)),this.addRule(Ht,Mt,Rt)}registerAlias(t,e){if(!this.router.hasHandlerFor(e))throw new Error(`Illegal alias: Method "${e}" is not registered with router`);return this.addRule((i=t,t=>t.type===i),function(t){return e=>({type:"triptease.onboard.request",requestType:String(t),payload:[e],correlationId:e.correlationId||"fire-and-forget"})}(e),Rt);var i}handler(t,i){return e(this,void 0,void 0,(function*(){if(mt(t))return;qt.debug("listenOn received request",t);const e=this.rules.find((e=>e.predicate(t)));if(!e)return;const n=e.requestConverter(t),o=yield this.router.handle(n);t.correlationId&&t.correlationId===o.correlationId&&(qt.debug("listenOn sending response to sender",o),i.send(e.responseConverter(o)))}))}addRule(t,e,i){return this.rules.push({predicate:t,requestConverter:e,responseConverter:i}),this}}function Ht(t){return!pt(t)&&!!t.correlationId}function Mt(t){const{value:e,correlationId:i}=t,{method:n}=R(t.type);return{type:"triptease.onboard.request",requestType:n,payload:[e],correlationId:i}}function Rt(t){return{type:"triptease.onboard.response",correlationId:t.correlationId,value:t.payload}}class Bt{constructor(t,e=q(t),i=p("bootstrap"),n=new P(t),o=new _(t,i),r=new J(t,i),s=new X(t),a=it.create(t),c=new ht(t)){this.window=t,this.events=e,this.logger=i,this.errorListener=n,this.starter=o,this.waiter=r,this.identityHelper=s,this.stackScripts=a,this.messageBuilder=c,y(this.window).onboard.bootstrap=this}start(){return e(this,void 0,void 0,(function*(){this.logger.debug("Bootstrap starting"),this.stackScripts.capture(),this.errorListener.listen(this.handleGlobalError.bind(this));try{const[t,e]=yield Promise.all([this.identityHelper.getIdentity(),this.kernelFrame()]);this.identity=t;const i=e.contentWindow;if(!i)return void this.logger.log("Kernel frame did not generate a content window, aborting");const n=p("bootstrap.messaging"),o=new L(this.window,i,[...H,this.window.location.hostname],n),r=new At(o);this.kernel=new et(r),this.kernelHost=tt(r),this.analyticsApi=tt(new At(new L(void 0,this.window)));const s=new kt(this);new Lt(o,(new wt).register(["processEvent"],s)).registerAlias("triptease.event","processEvent"),yield this.events.listen(this.integrate.bind(this)),yield this.events.start()}catch(t){this.logger.error(t)}}))}reload(){return e(this,void 0,void 0,(function*(){this.logger.debug("Bootstrap reloading"),this.stackScripts.capture(),yield this.integrate()}))}kernelFrame(){return e(this,void 0,void 0,(function*(){const t=class{static application(t){const e=function(t=i.globalThis){const e=d(t,l);return i.Strings.isEmpty(e)?"":o({[l]:e})}();return new F("triptease.onboard.kernel",`https://onboard.triptease.io/kernel/${W.get()}/kernel-host.html?originHost=${t}${e?"&"+e:""}`,"iframe","triptease.onboard.kernel-host-started")}}.application(this.window.location.hostname);return yield this.starter.start(t)}))}integrate(){return e(this,void 0,void 0,(function*(){this.logger.log("Starting integrate()");try{const t=Et(this.window);y(this.window).onboard.bookingEngine=t.bookingEngine;const e=$t(t);yield this.starter.start(e)}catch(t){this.logger.log(t)}}))}handleGlobalError(t){t&&this.logger.error(t)}processEvent(t){return e(this,void 0,void 0,(function*(){const e=yield this.kernelHost.getPageState(),i=yield this.messageBuilder.buildMessage(dt.merge(t,e));this.analyticsApi.trackEvent(i)}))}}const Tt=p("bootstrap"),Pt=i.get((()=>window.triptease.onboard.bootstrap));e(void 0,void 0,void 0,(function*(){Pt?(Tt.log("Bootstrap reloading"),yield Pt.reload()):(Tt.log("Creating new bootsrap"),yield new Bt(window).start())}))}();