(window.webpackJsonp=window.webpackJsonp||[]).push([[5],{415:function(e,t,r){e.exports=angular.module("chApp.search",[r(794).name,r(797).name,r(805).name,r(812).name,r(823).name,r(827).name,r(829).name,r(831).name,r(833).name]).controller("SearchPageCtrl",r(835)).factory("exteriorImageIndexHelper",r(423)).factory("hotelHelper",r(369)).factory("hotelImageHelper",r(370)).service("resortBannerAnalytics",r(836)).factory("searchPriceFormatter",r(424)).factory("searchService",r(425)).factory("searchUpdateMetadata",r(426)).factory("searchUrlHelper",r(427)).service("searchAnalytics",r(837)).service("searchResultsProcessor",r(428)).service("searchResultsService",r(429)).service("crossSellGeoSearchService",r(430)).component("chReactSearchBreadcrumbs",r(838)).component("chReactSearchSummary",r(839))},794:function(e,t,r){e.exports=angular.module("chApp.search.destination",[]).component("chSearchDestinationBlade",r(795)).component("chReactSearchDestinationBlade",r(796)).factory("searchDestinationService",r(416))},795:function(e,t){function r(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var n=function(){function e(t,r,n,i,a,s,o){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.globalLoaderCounter=r,this.prerenderService=n,this.chPlaceDisplayFilter=t,this.searchConst=i,this.searchDestinationService=a,this.strings=s,this.urlParserService=o}var t,n,i;return e.$inject=["chPlaceDisplayFilter","globalLoaderCounter","prerenderService","searchConst","searchDestinationService","strings","urlParserService"],t=e,(n=[{key:"$onInit",value:function(){this.mobile={accordion:{isDestinationOpen:!0,isNearbyOpen:!1,isPoiOpen:!1},isRunningInPrerender:this.prerenderService.isRunningInPrerender(),showingDestinationInfoModal:!1},this.tabActive="info",this.destinationPoiNearIn=this.place.type===this.searchConst.CITY?this.strings.search.poiIn:this.strings.search.poiNear,this.placeDisplayName=this.chPlaceDisplayFilter(this.place),this.getDestinationInfo()}},{key:"getDestinationInfo",value:function(){var e=this;return this.searchDestinationService.getInfo(this.place,this.brand).then((function(t){if(t.results&&t.results.placeid)return e.destinationInfo=t.results.placeid,e.prerenderService.isRunningInPrerender()?e.getNearby():void 0;e.destinationInfo=null})).catch((function(){return e.destinationInfo=null})).finally((function(){e.onDestinationInfo&&e.onDestinationInfo({$destinationInfo:e.destinationInfo})}))}},{key:"getNearby",value:function(){var e=this;return this.globalLoaderCounter.inc(),this.searchDestinationService.getPlaces(this.place,this.brand).then((function(t){e.nearbyDestinations=t.results&&t.results.destinationids||[],e.pointsOfInterest=t.results&&t.results.poiids||[],e.hasNearbyDestinations=e.nearbyDestinations&&!!e.nearbyDestinations.length,e.hasPointsOfInterest=e.pointsOfInterest&&!!e.pointsOfInterest.length,e.addPlaceUrls(e.nearbyDestinations,t.placesData),e.addPlaceUrls(e.pointsOfInterest,t.poiData)})).finally(this.globalLoaderCounter.dec)}},{key:"addPlaceUrls",value:function(e,t){var r=this;e.forEach((function(e){e.targetUrl=e.thumbnailtargeturl||r.urlParserService.getSearchUrl(t.find((function(t){return e.placeid===t.id})))}))}}])&&r(t.prototype,n),i&&r(t,i),e}();e.exports={bindings:{brand:"<",onDestinationInfo:"&?",place:"="},controller:n,templateUrl:["siteConfig",function(e){return"/".concat(e.assetFingerprint,"/app/search/destination/search-destination-blade").concat(e.fileSuffix,".html")}]}},796:function(e,t){function r(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function n(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?r(Object(n),!0).forEach((function(t){i(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):r(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function i(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function a(){return(a=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e}).apply(this,arguments)}function s(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var o=function(){function e(t,r,n,i){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),a(this,{$rootScope:t,$scope:r,$window:n,reactHelper:i})}var t,r,i;return e.$inject=["$rootScope","$scope","$window","reactHelper"],t=e,(r=[{key:"$onInit",value:function(){var e=this;this.reactHelper.loadReactApp((function(){return e.loadReactSearchDestinationBlade()}))}},{key:"$onDestroy",value:function(){this.unsubscribe&&this.unsubscribe()}},{key:"loadReactSearchDestinationBlade",value:function(){var e=this,t=this.$window.React.createElement(this.$window.SearchDestinationBlade,{brand:this.brand,lazyLoad:!0,place:this.place},(function(t,r){return e.$rootScope.isMobile?e.$window.React.createElement(e.$window.SearchDestinationBladeMobile,n(n({},t),r)):e.$window.React.createElement(e.$window.SearchDestinationBladeDesktop,n(n({},t),r))})),r=this.$window.React.createElement(this.$window.Provider,{store:this.$window.store},t);this.unsubscribe=this.$window.store&&this.$window.store.subscribe((function(){e.unsubscribe();var t=e.$window.store.getState();e.onDestinationInfo({$destinationInfo:t.poi.placeid})})),this.reactHelper.renderToScope(r,document.getElementById("searchDestinationBlade"),this.$scope)}}])&&s(t.prototype,r),i&&s(t,i),e}();e.exports={bindings:{brand:"<",onDestinationInfo:"&?",place:"<"},controller:o,template:'<div id="searchDestinationBlade"></div>'}},797:function(e,t,r){e.exports=angular.module("chApp.search.filter-panel",[]).component("chFilterRatings",r(798)).component("chMultiCheckbox",r(800)).component("chSearchFilterPanel",r(801)).component("chRangeSlider",r(802)).component("chPriceRangeSlider",r(803)).component("chReactFilterRatings",r(804))},798:function(e,t,r){function n(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var i=function(){function e(t,r,n,i){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.$document=t,this.$rootScope=r,this.strings=i.search.results,this.eventsConst=n}var t,r,i;return e.$inject=["$document","$rootScope","eventsConst","strings"],t=e,(r=[{key:"$onInit",value:function(){var e=this;this.rating=Number(this.ratings),this.filterArray=[{ariaLabel:this.strings.starAndUp.replace("{rating}",1),index:1},{ariaLabel:this.strings.starAndUp.replace("{rating}",2),index:2},{ariaLabel:this.strings.starAndUp.replace("{rating}",3),index:3},{ariaLabel:this.strings.starAndUp.replace("{rating}",4),index:4}],this.rating>0?(this.ratings=this.rating,this.filterArray[this.ratings-1].ariaLabel=this.strings.clearFilter,this.ratingLabel=this.strings.ratingAndUp.replace("{rating}",this.ratings)):(this.ratings=null,this.ratingLabel=""),this.$rootScope.$on(this.eventsConst.PAGE_RESIZE,(function(){e.filterRatingMouseout()}))}},{key:"$onChanges",value:function(e){var t=Number(e.hoverRatings.currentValue),r=Number(e.hoverRatings.previousValue);r=isNaN(r)?0:r,0===t&&0!==r&&(this.ratingLabel="",this.filterArray[r-1].ariaLabel=this.strings.starAndUp.replace("{rating}",r))}},{key:"filterRatingClick",value:function(e){var t=this;e===this.ratings?(this.ratings=null,this.filterArray.forEach((function(e){e.ariaLabel=t.strings.starAndUp.replace("{rating}",e.index)})),this.$document[0].querySelector(".search-options-wrapper #BIRGLogo").focus(),this.filterRatingMouseout()):(this.ratings=e,this.ratingLabel=this.strings.ratingAndUp.replace("{rating}",e),this.filterArray.forEach((function(r){r.index===e?r.ariaLabel=t.strings.clearFilter:r.ariaLabel=t.strings.starAndUp.replace("{rating}",r.index)}))),this.hoverRatings=this.ratings}},{key:"filterRatingMouseover",value:function(e){this.ratingLabel=this.strings.ratingAndUp.replace("{rating}",e),this.hoverRatings=e}},{key:"filterRatingMouseout",value:function(){this.ratingLabel=null===this.ratings?"":this.strings.ratingAndUp.replace("{rating}",this.ratings),this.hoverRatings=this.ratings}}])&&n(t.prototype,r),i&&n(t,i),e}();e.exports={bindings:{hoverRatings:"<",ratings:"="},controller:i,template:r(799)}},799:function(e,t){e.exports='<div class="search-filter-ratings">\n  <button\n      ng-repeat="item in $ctrl.filterArray"\n      ng-attr-aria-label="{{item.ariaLabel}}"\n      class="btn-reset ch-icon-star"\n      ng-class="($ctrl.ratings >= item.index || $ctrl.hoverRatings >= item.index) ? \'\' : \'inactive-star\'"\n      ng-click="$ctrl.filterRatingClick(item.index)"\n      ng-mouseover="$ctrl.filterRatingMouseover(item.index)"\n      ng-mouseout="$ctrl.filterRatingMouseout()"></button>\n  <div class="text-center fs-10 rating-label">{{$ctrl.ratingLabel}}</div>\n</div>\n'},800:function(e,t){function r(e){return function(e){if(Array.isArray(e))return n(e)}(e)||function(e){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e))return Array.from(e)}(e)||function(e,t){if(!e)return;if("string"==typeof e)return n(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Array.from(e);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return n(e,t)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function n(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function i(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function a(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var s=function(){function e(t,r,n,i,a,s,o,c){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.$attrs=t,this.$location=r,this.$scope=n,this.featureFlags=i,this.omniture=a,this.prerenderService=s,this.searchConst=o,this.strings=c}var t,n,s;return e.$inject=["$attrs","$location","$scope","featureFlags","omniture","prerenderService","searchConst","strings"],t=e,(n=[{key:"$onInit",value:function(){var e=this;this.DOWN="down",this.UP="up",this.isPrerender=this.prerenderService.isRunningInPrerender(),this.arrowDirection=this.isPrerender?this.UP:this.DOWN,this.expanded=this.isPrerender,this.isFocused=[],this.label=this.isPrerender?this.strings.general.less:this.strings.general.more,this.limit=this.isPrerender?this.options.length:this.listLimit||this.options.length,this.ngModel.$render=function(){e.modelDelimiter?e.model=(e.ngModel.$viewValue||"").split(e.modelDelimiter).reduce((function(e,t){return t&&(e[t]=!0),e}),{}):e.model=e.ngModel.$viewValue},this.$scope.$watchCollection("$ctrl.model",(function(t){if(e.modelDelimiter&&t){var r="";angular.forEach(t,(function(t,n){t&&!e.isCheckboxParent(n)&&(r+=(r.length?e.modelDelimiter:"")+n,e.handleOptionCheck(e.filteredOptions.find((function(e){return e.code===n})),t))})),e.ngModel.$setViewValue(r||e.modelDefault)}else e.ngModel.$setViewValue(t||e.modelDefault)})),this.$scope.$watch("$ctrl.options",(function(){e.options&&(e.filteredOptions=e.getFilteredOptions())}),!0),this.options&&(this.filteredOptions=this.getFilteredOptions()),this.featureFlags.EXTENDED_STAY_SERP&&this.extendedStayOptions()}},{key:"isCheckboxParent",value:function(e){var t=this.searchConst.FILTERS.FILTER_GROUPINGS[this.groupingType];return t&&-1!==Object.keys(t).indexOf(e)}},{key:"handleOptionCheck",value:function(e,t){var r=this;if(this.groupingType&&e){var n=e.children,i=e.parent;(n||i)&&(n&&n.length>0?n.forEach((function(e){r.model[e]=t})):i&&!t?this.model[i.code]=!1:i&&i.children&&i.children.every((function(e){return r.model[e]}))&&(this.model[i.code]=!0))}}},{key:"getFilteredOptions",value:function(){var e=this,t=this.options.filter((function(t){return t[e.optionLabel]}));return this.groupingType&&this.featureFlags.WOODSPRING_MASTER&&(t=this.getGroupedOptions(t)),t}},{key:"getGroupedOptions",value:function(e){var t=this,n=JSON.parse(JSON.stringify(e)),a=this.searchConst.FILTERS.FILTER_GROUPINGS[this.groupingType];if(!a)return e;for(var s in a)s&&function(){var e=a[s],o=e.children,c=e.name,l=e.displayOrder;if(o&&o.length){var u,h=n.filter((function(e){return-1!==o.indexOf(e[t.optionValue])}));n=n.filter((function(e){return-1===o.indexOf(e[t.optionValue])}));var p=(i(u={},t.optionValue,s),i(u,t.optionLabel,"".concat(c," (").concat(h.reduce((function(e,t){return t.count+e}),0),")")),i(u,t.optionOrder,l),i(u,"children",h.map((function(e){return e.code}))),i(u,"tooltip",t.strings.search.results.filterBrandCategory[s]&&t.strings.search.results.filterBrandCategory[s].tooltip),u);if(h.forEach((function(e){e[t.optionOrder]+=l,e.parent=p})),h.length){var d,f=[p].concat(r(h));(d=n).push.apply(d,r(f))}}}();return n}},{key:"$onChanges",value:function(){this.options&&(this.filteredOptions=this.getFilteredOptions())}},{key:"extendedStayOptions",value:function(){this.isExtendedSerp=-1!==this.$location.path().indexOf("/extended-stay-hotels")}},{key:"toggleList",value:function(){var e="".concat(this.label,"_").concat(this.listLabel);this.arrowDirection===this.DOWN?(this.arrowDirection=this.UP,this.label=this.strings.general.less,this.limit=Math.max(this.options.length,this.filteredOptions.length)):(this.arrowDirection=this.DOWN,this.label=this.strings.general.more,this.limit=this.listLimit),this.omniture.sendAnalyticsViaCustomLink({},e)}}])&&a(t.prototype,n),s&&a(t,s),e}();e.exports={bindings:{groupingType:"<?",idPrefix:"@?",listLabel:"<?",listLimit:"<?",modelDefault:"=?",modelDelimiter:"<?",optionLabel:"@",optionOrder:"@",optionValue:"@",options:"="},controller:s,require:{ngModel:"ngModel"},templateUrl:["siteConfig",function(e){return"/".concat(e.assetFingerprint,"/app/search/filter-panel/multi-checkbox").concat(e.fileSuffix,".html")}],transclude:{checkboxTemplate:"?checkboxTemplate"}}},801:function(e,t){function r(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var n=function(){function e(t,r,n,i,a,s,o,c,l,u,h,p,d,f,g,m,S,v,y,R,C,E,A,b){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this._$filter=n,this._amenitiesData=l,this.$attrs=t,this.$document=r,this.$location=i,this.$rootScope=a,this.$scope=s,this.$scope.searchConst=v,this.$timeout=o,this.$window=c,this.brandConst=u,this.chPlaceDisplayFilter=h,this.deviceConst=p,this.featureFlags=d,this.globalLoaderCounter=f,this.keyboardConst=g,this.omniture=m,this.omnitureConst=S,this.searchConst=v,this.searchDestinationService=y,this.searchHelper=R,this.searchService=C,this.siteConfig=A,this.searchCriteriaData=E,this.strings=b,this.close=this.close.bind(this)}var t,n,i;return e.$inject=["$attrs","$document","$filter","$location","$rootScope","$scope","$timeout","$window","amenitiesData","brandConst","chPlaceDisplayFilter","deviceConst","featureFlags","globalLoaderCounter","keyboardConst","omniture","omnitureConst","searchConst","searchDestinationService","searchHelper","searchService","searchCriteriaData","siteConfig","strings"],t=e,(n=[{key:"$onInit",value:function(){var e=this;this.documentBody=angular.element(this.$document[0].body),this.isPanelEnabled=!!this.filters,this.filterTotal=0,this.workTravel=!(!this.searchCriteriaData||!this.searchCriteriaData.get())&&this.searchCriteriaData.get().workTravel,this.displayOrder="displayOrder.".concat(this.searchConst.DEFAULT_AMENITY_COUNTRY),this.isPanelEnabled&&(this.featureFlags.IWSR_MASTER&&-1===this.searchConst.RADIUS.indexOf(this.filters.searchRadius)&&(this.filters.searchRadius=this.searchHelper.getSearchRadius(this.filters.searchRadius)),this.onFilterChange&&this.$scope.$watch("$ctrl.filters",(function(t,r){angular.equals(t,r)||(e.$attrs.hasOwnProperty("mobileTemplate")&&(e.mobilePriceRangeChanged=t.priceLow!==r.priceLow||t.priceHigh!==r.priceHigh,e.mobilePriceRangeChanged&&e.mobileCalculatePriceRanges(e.filters.priceMin,e.filters.priceMax)),e.onFilterChange({$filters:t}))}),!0),this.featureFlags.FILTER_UI?(this.$scope.$on("updateSearchRadius",(function(t,r){e.filters.priceHigh=t.currentScope.$ctrl.filters.priceMax,e.filters.priceLow=t.currentScope.$ctrl.filters.priceMin,e.filters.searchRadius=r.distance,e.$rootScope.$broadcast("updatePriceSlider")})),this.$scope.$on("updatePriceValues",(function(t,r){e.filters.priceHigh=r.max,e.filters.priceLow=r.min})),this.$scope.$on("updateGuestRatings",(function(t,r){1!==Number(r)?e.filters.ratings=Number(r):e.filters.ratings=null})),this.distanceWithinHtml=this.searchService.isKm?this.strings.search.results.filterKilometersWithinHtml:this.strings.search.results.filterWithinHtml):this.distanceWithinHtml=this.searchService.isKm?this.strings.search.results.filterKilometersWithinHtml:this.strings.search.results.filterMilesWithinHtml,this.distanceWithinHtml=this.distanceWithinHtml.replace("{place}",this.chPlaceDisplayFilter(this.place)),this.distanceUnit=this.searchService.isKm?this.strings.search.results.filterPlaceKilometers:this.strings.search.results.filterPlaceMiles,this.$attrs.hasOwnProperty("mobileTemplate")&&(this.mobile={priceRanges:[],selectedTab:"availability"},this.mobileCalculatePriceRanges(this.filters.priceMin,this.filters.priceMax)),this._amenitiesData.get().then((function(t){e.filterAmenities=t.AMENITIES_TOP_FIVE_ORDER,e.calculateAmenityTotals(),e.calculateBrandTotals(),e.calculateFilterTotal(),e.featureFlags.SO_BIZ_TRAVEL_BOX&&e.workTravel?e.amenities=e._$filter("toArray")(e.filterAmenitiesTravel,!0).concat(e._$filter("toArray")(e.filterAmenities,!0)):e.amenities=e._$filter("toArray")(e.filterAmenities,!0)})),this.featureFlags.SO_SEARCH_POI_REFINEMENT&&this.getDestinationInfo(),this.setBrandOptions())}},{key:"calculateAmenityTotals",value:function(){for(var e in this.filterAmenitiesTravel={},this.filterAmenities)if(Object.prototype.hasOwnProperty.call(this.filterAmenities,e)){if(this.filterAmenities[e].displayName&&(this.filterAmenities[e].displayName=""),this.amenitiesTotals&&this.amenitiesTotals[e]){var t=this.amenitiesTotals[e].total;t>=0&&(this.filterAmenities[e].displayName="".concat(this.filterAmenities[e].name," (").concat(t,")"))}this.featureFlags.SO_BIZ_TRAVEL_BOX&&this.workTravel&&(this.filterAmenities[e].displayOrder.US=1e3+this.filterAmenities[e].displayOrder.US,this.reorderAmenities(e))}}},{key:"reorderAmenities",value:function(e){var t=this.searchConst.TOP_5_AMENITIES.indexOf(e);t>=0&&(this.filterAmenitiesTravel[e]=angular.copy(this.filterAmenities[e]),this.filterAmenitiesTravel[e].displayOrder.US=t,delete this.filterAmenities[e])}},{key:"calculateBrandTotals",value:function(){if(this.searchResults||this.siteConfig.deviceType!==this.deviceConst.MOBILE){this.brands=[];var e=[],t=this.filters.amenity?this.filters.amenity.split(","):[];for(var r in this.$rootScope.chConstants.brand.BRAND_DATA)if(Object.prototype.hasOwnProperty.call(this.$rootScope.chConstants.brand.BRAND_DATA,r)){var n={amenArray:t,brand:this.$rootScope.chConstants.brand.BRAND_DATA[r].code};(e=this.hotels.filter(this.filterHotelByBrand,n)).length&&this.brands.push({code:this.$rootScope.chConstants.brand.BRAND_DATA[r].code,count:e.length,displayOrder:this.$rootScope.chConstants.brand.BRAND_DATA[r].displayOrder,name:"".concat(this.$rootScope.chConstants.brand.BRAND_DATA[r].name," (").concat(e.length,")")})}}}},{key:"calculateFilterTotal",value:function(){this.filterTotal=0,this.filterTotal+=this.filters.brand?this.filters.brand.split(",").length:0,this.filterTotal+=this.filters.amenity?this.filters.amenity.split(",").length:0}},{key:"filterHotelByBrand",value:function(e){var t=!0;return this.amenArray&&e.amenityGroups&&this.amenArray.forEach((function(r){e.amenityGroups.find((function(e){return e.id===r}))||(t=!1)})),e&&t&&e.brandCode===this.brand}},{key:"$onChanges",value:function(e){this.calculateFilterTotal(),this.calculateAmenityTotals(),e.searchResults&&this.calculateBrandTotals()}},{key:"$onDestroy",value:function(){this.documentBody.off("mousedown",this.close)}},{key:"close",value:function(){this.isOpen=!1,this.documentBody.off("mousedown",this.close),this.onClose&&this.onClose(),this.isVacationRentals||this.omniture.sendAnalyticsViaCustomLink({},this.omnitureConst.HIDE_FILTERS)}},{key:"onKeyDown",value:function(e){e.which===this.keyboardConst.ESCAPE&&this.close()}},{key:"open",value:function(){this.calculateBrandTotals(),this.isOpen=!0,this.documentBody.on("mousedown",this.close),this.onOpen&&this.onOpen(),this.omniture.sendAnalyticsViaCustomLink({},this.omnitureConst.SHOW_FILTERS)}},{key:"clear",value:function(){this.onClear&&(this.onClear(),this.featureFlags.FILTER_UI&&(this.$rootScope.$broadcast("updatePriceSlider"),this.$rootScope.$broadcast("updateRangeSlider"),this.$rootScope.$broadcast("updateGuestRatingsFilters"),this.filters.priceHigh=null,this.filters.priceLow=null,this.filters.ratings=null,this.filters.searchRadius=null,this.$window.sessionStorage.removeItem("ngStorage-current_search-radius")))}},{key:"isFinite",value:function(e){function t(t){return e.apply(this,arguments)}return t.toString=function(){return e.toString()},t}((function(e){return isFinite(e)}))},{key:"stopPropagation",value:function(e){var t=this;"input-range__slider"===e.target.className||"input-range__track input-range__track--active"===e.target.className||"input-range__track input-range__track--background"===e.target.className?(this.documentBody.off("mousedown",this.close),this.$timeout((function(){return t.documentBody.on("mousedown",t.close)}),1500)):e.stopPropagation()}},{key:"toggleOpen",value:function(){this.isOpen?this.close():this.open()}},{key:"getDestinationInfo",value:function(){var e=this;return this.searchDestinationService.getInfo(this.place).then((function(t){if(t.results&&t.results.placeid)return e.destinationInfo=t.results.placeid,e.getNearby();e.destinationInfo=null})).catch((function(){return e.destinationInfo=null})).finally((function(){return e.onDestinationInfo&&e.onDestinationInfo({$destinationInfo:e.destinationInfo})}))}},{key:"getNearby",value:function(){var e=this;return this.searchDestinationService.getPlaces(this.place).then((function(t){e.pointsOfInterest=t||[],e.hasPointsOfInterest=e.pointsOfInterest&&!!e.pointsOfInterest.length}))}},{key:"mobileCalculatePriceRanges",value:function(e,t){var r=e,n="points"===this.filters.currencyType||"pointsPlusCash"===this.filters.currencyType?2e3:50;if(this.mobile.priceRanges=[{high:t,low:e}],r%n!=0&&e<(r=e+n-e%n)-1&&this.mobile.priceRanges.push({high:r-1,low:e}),r>e||r+n-1<t)for(var i=r;i<t;i+=n)this.mobile.priceRanges.push({high:Math.min(i+n-1,t),low:i});this.mobile.priceRanges.length>1&&this.mobile.priceRanges[1].low!==e&&(this.mobile.priceRanges[1].low=e),this.mobile.priceRanges.length>1&&this.mobile.priceRanges[this.mobile.priceRanges.length-1].high!==t&&(this.mobile.priceRanges[this.mobile.priceRanges.length-1].high=t)}},{key:"mobileIsPriceSelected",value:function(e){var t=this.filters.priceMin===this.filters.priceLow&&this.filters.priceMax===this.filters.priceHigh;return e&&!t&&this.filters.priceLow<=this.mobile.priceRanges[e].low&&this.filters.priceHigh>=this.mobile.priceRanges[e].high||!e&&t}},{key:"mobileUpdatePriceRange",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=this.filters.priceLow===this.filters.priceMin&&this.filters.priceHigh===this.filters.priceMax,r=this.filters.priceLow===this.mobile.priceRanges[e].low&&this.filters.priceHigh===this.mobile.priceRanges[e].high,n=Math.abs(this.mobile.priceLowIndex-e),i=Math.abs(this.mobile.priceHighIndex-e);r||0===e?(this.filters.priceLow=this.filters.priceMin,this.filters.priceHigh=this.filters.priceMax,this.mobile.priceLowIndex=this.mobile.priceHighIndex=0,this.mobile.priceLastLow=!1):t?(this.filters.priceLow=this.mobile.priceRanges[e].low,this.filters.priceHigh=this.mobile.priceRanges[e].high,this.mobile.priceLowIndex=this.mobile.priceHighIndex=e,this.mobile.priceLastLow=!1):n?i?n<i||n===i&&this.mobile.priceLastLow||this.mobile.priceRanges[e].high<this.filters.priceLow?(this.filters.priceLow=this.mobile.priceRanges[e].low,this.mobile.priceLastLow=!0,this.mobile.priceLowIndex=e):(this.filters.priceHigh=this.mobile.priceRanges[e].high,this.mobile.priceLastLow=!1,this.mobile.priceHighIndex=e):(this.filters.priceHigh=this.mobile.priceRanges[e-1].high,this.mobile.priceLastLow=!1,this.mobile.priceHighIndex=e-1):(this.filters.priceLow=this.mobile.priceRanges[e+1].low,this.mobile.priceLastLow=!0,this.mobile.priceLowIndex=e+1)}},{key:"setBrandOptions",value:function(){this.isExtendedSerp=this.featureFlags.EXTENDED_STAY_SERP&&-1!==this.$location.path().indexOf("/extended-stay-hotels");var e=this.brandConst.BRAND_CODE_GROUPS.EXTENDED_STAY;this.brandOptions=this.isExtendedSerp?this.brandConst.BRAND_DATA.filter((function(t){var r=t.code;return-1!==e.indexOf(r)})):this.brandConst.BRAND_DATA}}])&&r(t.prototype,n),i&&r(t,i),e}();e.exports={bindings:{amenitiesTotals:"<?",expanded:"=?",filters:"=?",hotels:"<?",isOpen:"=?",onClear:"&?",onClose:"&?",onFilterChange:"&?",onOpen:"&?",place:"<?",searchResults:"<?"},controller:n,templateUrl:["$attrs","siteConfig",function(e,t){var r=e.hasOwnProperty("mobileTemplate")?t.fileSuffix:"";return"/".concat(t.assetFingerprint,"/app/search/filter-panel/search-filter-panel").concat(r,".html")}]}},802:function(e,t){function r(){return(r=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e}).apply(this,arguments)}function n(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var i=function(){function e(t,n,i,a,s,o){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),r(this,{$element:t,$rootScope:n,$scope:i,$window:a,reactHelper:s,sessionStorageHelper:o})}var t,i,a;return e.$inject=["$element","$rootScope","$scope","$window","reactHelper","sessionStorageHelper"],t=e,(i=[{key:"$onInit",value:function(){var e=this;this.reactHelper.loadReactApp((function(){return e.loadReactRangeSlider()})),this.$scope.$on("updateRangeSlider",(function(){e.reactHelper.loadReactApp((function(){return e.loadReactRangeSlider()}))}))}},{key:"loadReactRangeSlider",value:function(){var e=this.sessionStorageHelper.getCurrentSearch();e.searchRadius=this.$scope.$parent.$ctrl.filters.searchRadius;var t=JSON.parse(JSON.stringify(this.$window.sessionStorage.getItem("ngStorage-current_search-radius")));t&&!e.searchRadius&&25!==t&&(e.searchRadius=t),this.$scope.value=e.searchRadius||25,this.$scope.prevValue=this.$scope.value,this.reRenderRangeSlider()}},{key:"reRenderRangeSlider",value:function(){var e=this,t=this.$window.React.createElement(this.$window.RangeSlider,{disabled:this.$scope.disabled,distanceUnit:this.$rootScope.currentLocale,onChange:function(){},onChangeComplete:function(t){e.updateSearchResults(t)},value:this.$scope.value});this.reactHelper.renderToScope(t,this.$element[0],this.$scope)}},{key:"disableSlider",value:function(){var e=this;this.$scope.value>this.$scope.prevValue&&(this.$scope.disabled=!0,this.$scope.prevValue=this.$scope.value,this.reRenderRangeSlider(),setTimeout((function(){e.$scope.disabled=!1,e.reRenderRangeSlider()}),3e3))}},{key:"updateSearchResults",value:function(e){this.$scope.value=e,this.disableSlider(),this.$window.sessionStorage.removeItem("ngStorage-current_search-radius"),this.$window.sessionStorage.setItem("ngStorage-current_search-radius",e),this.$scope.$emit("updateSearchRadius",{distance:e})}}])&&n(t.prototype,i),a&&n(t,a),e}();e.exports={bindings:{distanceUnit:"<",onChange:"&",onChangeComplete:"&",value:"<"},controller:i,template:'<div id="rangeSlider"></div>'}},803:function(e,t){function r(){return(r=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e}).apply(this,arguments)}function n(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var i=function(){function e(t,n,i,a,s,o){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),r(this,{$element:t,$rootScope:n,$scope:i,$window:a,reactHelper:s,sessionStorageHelper:o})}var t,i,a;return e.$inject=["$element","$rootScope","$scope","$window","reactHelper","sessionStorageHelper"],t=e,(i=[{key:"$onInit",value:function(){var e=this;this.reactHelper.loadReactApp((function(){return e.loadReactPriceSlider()})),this.$scope.$on("updatePriceSlider",(function(){e.reactHelper.loadReactApp((function(){return e.loadReactPriceSlider()}))})),this.$scope.$on("priceTypeFilterChange",(function(){e.reactHelper.loadReactApp((function(){return e.loadReactPriceSlider()}))}))}},{key:"loadReactPriceSlider",value:function(){var e=this,t=this.sessionStorageHelper.getCurrentSearch(),r=this.$scope.$parent.$ctrl.filters,n=r.currencyCode,i=r.priceHigh,a=r.priceLow,s=r.priceMax,o=r.priceMin,c=this.$window.React.createElement(this.$window.PriceSlider,{currencyCode:n||"USD",highValue:i||t.priceHigh,lowValue:a||t.priceLow,maxValue:s||1,minValue:o!==s?o:0,onChange:function(t){e.updateSearchResults(t)},soldOut:0===s});this.reactHelper.renderToScope(c,this.$element[0],this.$scope)}},{key:"updateSearchResults",value:function(e){this.$scope.$emit("updatePriceValues",e)}}])&&n(t.prototype,i),a&&n(t,a),e}();e.exports={bindings:{currencyCode:"<",highValue:"<",lowValue:"<",maxValue:"<",minValue:"<",onChange:"&",soldOut:"<"},controller:i,template:'<div id="priceRangeSlider"></div>'}},804:function(e,t){function r(){return(r=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e}).apply(this,arguments)}function n(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var i=function(){function e(t,n,i,a,s,o){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),r(this,{$element:t,$rootScope:n,$scope:i,$window:a,reactHelper:s,sessionStorageHelper:o})}var t,i,a;return e.$inject=["$element","$rootScope","$scope","$window","reactHelper","sessionStorageHelper"],t=e,(i=[{key:"$onInit",value:function(){var e=this;this.reactHelper.loadReactApp((function(){return e.loadReactFilterRatings()})),this.$scope.$on("updateGuestRatingsFilters",(function(){e.reactHelper.loadReactApp((function(){return e.loadReactFilterRatings()}))}))}},{key:"loadReactFilterRatings",value:function(){var e=this,t=this.sessionStorageHelper.getCurrentSearch(),r=this.$window.React.createElement(this.$window.FilterRatings,{onChange:function(t){e.updateSearchResults(t)},ratingsValue:t.ratings||1});this.reactHelper.renderToScope(r,this.$element[0],this.$scope)}},{key:"updateSearchResults",value:function(e){this.$scope.$emit("updateGuestRatings",e)}}])&&n(t.prototype,i),a&&n(t,a),e}();e.exports={bindings:{onChange:"&",ratingsValue:"<"},controller:i,template:'<div id="react-filter-ratings"></div>'}},805:function(e,t,r){e.exports=angular.module("chApp.search.form",[]).component("chRecentSearchComponent",r(806)).controller("SearchFormCtrl",r(807)).directive("chSearchForm",r(808)).directive("chLazyHotelSearchResults",r(809)).factory("currentLocationService",r(810)).factory("rateplanDropdownAnalytics",r(417)).filter("chIndicateValuesOver",r(811))},806:function(e,t){function r(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var n=function(){function e(t,r,n,i,a){var s,o,c,l=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),c=function(e){l.onRecentSearchClick(e),l.$scope.$parent.$parent.$broadcast("ch.rateplan.code.changed",e.ratePlanCode)},(o="handleSelectRecent")in(s=this)?Object.defineProperty(s,o,{value:c,enumerable:!0,configurable:!0,writable:!0}):s[o]=c,this.$rootscope=t,this.$scope=r,this.$state=n,this.$window=i,this.reactHelper=a}var t,n,i;return e.$inject=["$rootScope","$scope","$state","$window","reactHelper"],t=e,(n=[{key:"$onInit",value:function(){var e=this;this.reactHelper.loadReactApp((function(){return e.loadReactRecentSearchComponent()}))}},{key:"loadReactRecentSearchComponent",value:function(){var e=this.$window.React.createElement(this.$window.RecentSearchesDropdown,{onSelect:this.handleSelectRecent,scope:this.$scope}),t=this.$window.React.createElement(this.$window.Provider,{store:this.$window.store},e);this.reactHelper.renderToScope(t,document.getElementById("recentSearches"),this.$scope)}}])&&r(t.prototype,n),i&&r(t,i),e}();e.exports={bindings:{onRecentSearchClick:"<"},controller:n,template:'<div id="recentSearches"></div>'}},807:function(e,t){function r(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function n(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?r(Object(n),!0).forEach((function(t){i(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):r(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function i(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function a(){return(a=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e}).apply(this,arguments)}e.exports=["$document","$location","$rootScope","$scope","$state","$timeout","$window","amenitiesHelper","brandConst","cookieConst","cookieHelper","dateHelper","deviceConst","eventsConst","featureFlags","globalLoaderCounter","hotelHelper","objectHelper","ratesConst","routeConst","localeService","patternsConst","reactHelper","searchConst","searchCriteriaData","searchHelper","searchService","serviceEventConst","serviceEventsHelper","sessionStorageHelper","siteConfig","strings","urlParserService",function(e,t,r,i,s,o,c,l,u,h,p,d,f,g,m,S,v,y,R,C,E,A,b,P,O,T,D,w,_,$,L,I,N){var M=this;i.pageId=b.generatePageId();var H,U=this,F={};i.isHomePage=s.current&&s.current.name&&-1!==s.current.name.toLowerCase().indexOf("homepage"),i.isHomePage&&O.deleteValue("priceHigh");var k=angular.extend({},T.getDefaultParams(),O.get());function x(e){return P.BRAND_SEARCH[e].find((function(e){return i.search.placeName.toLowerCase().indexOf(e.toLowerCase())>-1}))}function B(){i.search.lat=null,i.search.lon=null}function j(){var e={};if(angular.forEach(P.BRAND_SEARCH,(function(t,r){var n;e.match||e.partialMatch||(e={brand:r,match:(n=r,P.BRAND_SEARCH[n].find((function(e){return i.search.placeName.toLowerCase()===e.toLowerCase()}))),partialMatch:x(r)})})),e.match)return t.path(C.BRAND_HOMEPAGES[e.brand]),!0;!function(e){if(e.partialMatch){var t=C.BRAND_HOMEPAGES[e.brand].replace(/^\//,"");i.search.brand=u.BRANDS[t]}}(e)}i.deniedCurrentLocation=!1,i.focused=!0,i.preferredLang=E.getLanguageCode().toLowerCase(),i.preferredLocale=E.getCountryCode().toLowerCase(),i.placeHolderText=I.search.placeHolder,i.isTravelProfessionalPage=t.path().indexOf("/travel-professionals")>=0,i.shouldLoadReactForm=m.MW_SEARCH&&!i.isTravelProfessionalPage,i.search||(i.search=angular.extend({},k)),i.collectChildAges=m.AMR_MWEB_MASTER&&!i.isHomePage&&i.childAgesRequired,i.childAges=i.collectChildAges&&k.ageOfMinors?k.ageOfMinors.split(","):[],i.$watch("search",(function(){var e=O.get(),t=T.getDefaultParams();i.$parent.searchPending=P.FORM_PARAMS.some((function(r){return i.search[r]!==(e[r]||t[r])})),i.search.placeName&&(i.searchUi.displayResultsStyle={display:"none"}),m.MAP_CURRENT_AREA_SEARCH&&m.MAPS_CLEANUP_SERP&&i.search.currentLocation&&(L.deviceType===f.MOBILE?r.$broadcast(g.UPDATE_HOTELS,I.general.hotelsNearMe):r.$broadcast(g.UPDATE_HOTELS,I.search.currentMapArea))}),!0),i.ratePlan={name:null},i.autosuggestDestinationParams={reactFormUpdate:!1,selectedFromDropDown:!1,selectedFromRecentSearch:!1},i.plusMinusDropdownMode=L.deviceType===f.MOBILE?"full":"compact",T.initializeSelectedPlaceFromLocation(i.search,F),i.searchUi={checkInDateDisplay:"",collapseToggle:function(){i.searchUi.formCollapse=!i.searchUi.formCollapse,i.searchUi.formCollapse||T.cleanupChildAges(i.childAges)},dateError:!1,displayResultsStyle:{display:"none"},dropdownStyle:{display:"block"},formCollapse:!1,getPlaceDisplayName:function(e){return T.getPlaceDisplayName(i.searchUi.searchPlaceOptions[e])},noResultText:"",placeError:!1,placeOptions:!1,searchPlaceOptions:[],searchSummary:!1,selectPlaceResultOptions:function(e){var t=i.searchUi.searchPlaceOptions[e];i.search.placeName=T.getPlaceDisplayName(t),i.$emit(g.SEARCH_FORM.MULTI_PLACE_SELECTED,t),i.searchUi.displayResultsStyle={display:"none"}},setSummary:function(e){i.searchUi.searchSummary=!!e,i.searchUi.searchSummary?i.searchUi.formCollapse=!0:i.searchUi.formCollapse=!1}},this.setCurrentLocationSetter=function(e,t){i.currentLocationSet=t.currentLocationSet,i.setCurrentLocation=t.setCurrentLocation},this.displayPlaceOptions=function(e,t){i.searchUi.searchPlaceOptions=t.places,i.searchUi.placeOptions=!0,i.searchUi.displayResultsStyle={display:"block"}},this.selectPlace=function(e,t){i.autosuggestDestinationParams.destinationEntered=i.search.placeName,i.autosuggestDestinationParams.selectedFromDropDown=!0,F=t},i.handleSelectRecent=function(e){a(i.search,n(n({},e),{},{originalRoomsNumber:e.rooms})),i.autosuggestDestinationParams.selectedFromRecentSearch=!0},this.resetSearchResult=function(){i.searchUi.displayResultsStyle={display:"none"},i.searchUi.noResultText="",i.searchUi.placeError=!1,i.searchUi.placeOptions=!1,i.searchUi.searchPlaceOptions=[]},this.refreshFromSession=function(){var e=P.DEFAULT_PARAMS;m.IWSR_MASTER&&a(e,{searchRadius:D.getDefaultSearchRadius()}),angular.extend(i.search,y.filterProperties(angular.copy(e),P.FORM_PARAMS_REGEX,!0),O.get()),i.$broadcast(g.RATE_FORM.RATE_UPDATED)},i.childAgeExceedsMax=function(e){return v.minorsAgeExceedsMax(e)},i.childAgeUpdated=function(){var e,t,r,n;i.isHomePage||(i.childAges=T.cleanupChildAges(i.childAges),e=!1,t=v.minorsAgeListIsEmpty(i.childAges),r=v.childAgesEntered(i.childAges),n=v.minorsAgeListExceedsMax(i.childAges),i.childAgesExceedMax=n,e=!(m.AMR_MWEB_MASTER&&i.search.minors&&(!i.childAges||i.childAges.length))||Boolean(t||!n&&r),i.childAgesComplete=e,i.search.ageOfMinors=i.childAgesComplete&&v.childAgesEntered(i.childAges)&&i.childAges.length?i.childAges.join(","):"")},i.updateChildCount=function(){if(m.AMR_MWEB_MASTER&&i.collectChildAges)return i.childAges.length=i.search.minors,i.childAgeUpdated(),i.childAges},i.integerOnly=T.integerOnly,i.updateChildCount(),i.reactFormUpdate=function(e){i.autosuggestDestinationParams.reactFormUpdate=!0,i.search=e,i.currentLocationSet=function(){return e.currentLocation},i.submitSearch()},i.submitMobileSearch=function(){i.collectChildAges&&!i.childAgesComplete||(i.currentLocationSet()||i.search.placeName||i.deniedCurrentLocation||!m.MWEB_DEFAULT_HOTELS_NEAR_ME||m.MW_SEARCH&&r.brand===u.DEFAULT?(i.submitSearch(),i.searchUi.searchSummary&&i.searchUi.collapseToggle()):i.setCurrentLocation().then((function(){i.deniedCurrentLocation=!0,i.submitSearch(),i.searchUi.searchSummary&&i.searchUi.collapseToggle()})))},i.submitSearch=function(){var e=m.IWSR_MASTER?D.getDefaultSearchRadius():P.DEFAULT_PARAMS.searchRadius;if(i.$parent.searchPending=!1,i.search.placeName&&angular.uppercase(i.search.placeName)===angular.uppercase(F.name)?(m.MAP_CURRENT_AREA_SEARCH||m.MAPS_CLEANUP_SERP||i.search.currentLocation||($.setMapZoomLevel(null),$.setMapCenter(null)),i.search.currentLocation=!1,Y(),m.IWSR_MASTER&&F.radius&&D.isKm&&a(F,{radius:Math.floor(F.radius/P.DISTANCE_CONVERSION.miToKm)}),i.search.searchRadius=+(F.radius||i.search.searchRadius||e)):(i.search.placeId=null,i.search.placeType=null,P.BRAND_LOCATION_AUTOSUGGEST[i.search.brand]&&(i.search.city=null),F={},i.search.currentLocation||B()),P.REGEX.PROPERTY_CODE.test(i.search.placeName)&&B(),T.checkRequiredLocationParams(i.search)){if(i.search.checkInDate&&(t=i.search.checkInDate,!(d.getDateFromString(t)>=d.getTodayDate())))return i.searchUi.dateError=!0,void W(I.search.errors.invalidCheckInDate);var t;if(!i.search.placeName||!j()){if((H=O.get().coop)&&O.update({coop:H}),m.AMR_MASTER){O.deleteValue("ageOfMinors");var n=$.getCurrentSearch();delete n.ageOfMinors,$.setCurrentSearch(n)}m.COOP_RANKING_SORT&&$.getCurrentSearch().coop&&(i.search.coop=$.getCurrentSearch().coop),function(){if(i.autosuggestDestinationParams.reactFormUpdate)return;i.autosuggestDestinationParams.selectedFromDropDown&&(i.search.selectedFromDropDown=i.autosuggestDestinationParams.selectedFromDropDown,i.search.destinationEntered=i.autosuggestDestinationParams.destinationEntered,i.search.selectedFromRecentSearch=!1);i.autosuggestDestinationParams.selectedFromDropDown||(i.search.destinationEntered=i.search.placeName,i.search.selectedFromDropDown=i.autosuggestDestinationParams.selectedFromDropDown,i.search.selectedFromRecentSearch=!1);i.autosuggestDestinationParams.selectedFromRecentSearch&&(i.search.selectedFromRecentSearch=i.autosuggestDestinationParams.selectedFromRecentSearch,i.search.destinationEntered=null,i.search.selectedFromDropDown=i.autosuggestDestinationParams.selectedFromDropDown)}(),O.update(i.search),i.search.clientId=$.getClientId();var s=D.getHotels(angular.copy(i.search),angular.copy(F)).then(V,W);if(m.MW_SEARCH&&r.isMobile&&r.brand===u.DEFAULT){var o=c.CompassSpinner;return o.destination=window.store.getState()?window.store.getState().search.placeName:"",o.withDelay(s)}S.inc(),s.finally(S.dec),r.loadPopUnderWindow&&r.loadPopUnderWindow()}}else W(I.search.errors.emptyPlacename)};var G=i.search.rooms;function V(e){e.results.hotelCount>0&&("OK"===e.results.status||"PARTIAL"===e.results.status)?(!function(e){F=T.updateSelectedPlace(F,e,(function(e){a(i.search,e),O.update(i.search)})),e.searchParams&&e.searchParams.group&&(i.search.brand=e.searchParams.group);var n=m.EXTENDED_STAY_SERP&&-1!==t.path().indexOf("/extended-stay-hotels"),o=L.deviceType===f.MOBILE,h=N.getSearchUrl(angular.copy(F),i.search.brand,l.getName(i.search.amenity),i.search.currentLocation,n);angular.extend(k,{destinationEntered:null,selectedFromDropDown:!1,selectedFromRecentSearch:!1});var p=T.formatSearchParams(k,i.search);$.setCurrentSearchUrl(h,p),$.setCurrentSearch(p);var d=t.path()===h&&!angular.equals(t.search(),p);e.searchParams&&e.searchParams.group?p.brand=u.BRAND_GROUPS[i.search.brand].join(","):e.searchParams&&e.searchParams.brandCodes&&(p.brand=e.searchParams.brandCodes.join(","));if(t.path(h).search(p),d){if(m.MW_SEARCH&&o&&r.brand===u.DEFAULT){var g=new Promise((function(e){s.reload(),e()})),S=c.CompassSpinner;S&&S.withDelay(g)}s.reload()}}(e),i.$broadcast(g.SEARCH_FORM.SEARCH_SUCCESS)):e.results.placeCount>0&&W(e.results)}function W(e){if(e.hotelId)return O.update(i.search),void(c.location.href=m.IWSR_MASTER&&!E.isDomestic()?"/".concat(L.locale,"/").concat(e.hotelId.toLowerCase()):"/".concat(e.hotelId.toLowerCase()));_.notify(w.FAILED_SEARCH,i.search.placeName),i.searchUi.displayResultsStyle={display:"block"},i.searchUi.dateError||(i.searchUi.noResultText=T.getErrorHtml(e,i.search.placeName),i.searchUi.placeError=!0),i.$broadcast(g.SEARCH_FORM.FORM_ERROR,["placename"])}function Y(){i.search.lat=F.lat,i.search.lon=F.lon,i.search.placeId=F.id,i.search.placeType=F.type,i.search.city=F.city,i.search.subdivision=F.subdivision,i.search.country=F.country}i.handleRoomCountChange=function(){i.search.rooms>P.GROUP_OPTIONS.maxRoomsPerGroup&&G!==i.search.rooms&&_.notify(w.MAX_ROOMS_SELECTED_POP),G=i.search.rooms,i.adjustForGroup()},i.adjustForGroup=function(){i.search.rooms>9?i.search.ratePlanCode=R.RATE_PLAN_CODES.GROUP:i.search.rooms<=9&&(m.CORPORATE_GROUP_BOOKINGS||(i.search.ratePlanCode=O.get().ratePlanCode))},i.handleGroupView=function(){var e=+i.search.rooms;return!angular.isNumber(e)||!isFinite(e)||e<P.GROUP_OPTIONS.minRoomsPerGroup},m.DESKTOP_RECENT_SEARCHES&&i.$on("chcom-autosuggest:showing",(function(e,t){var r=e.targetScope.placename;i.shouldShowRecentSearches=r.length<2&&t.focus&&!t.show&&!i.searchUi.placeError})),i.saveSearchCriteria=function(){i.search.placeName&&angular.uppercase(i.search.placeName)===angular.uppercase(F.name)&&(i.search.currentLocation=!1,Y()),O.update(i.search)},i.$on("$destroy",(function(){m.MAP_CURRENT_AREA_SEARCH&&!i.search.currentLocation&&($.setMapZoomLevel(),$.setMapCenter()),M.unsubscribe&&M.unsubscribe()})),this.init=function(){i.$on(g.SEARCH_FORM.CURRENT_LOCATION_READY,U.setCurrentLocationSetter),i.$on(g.SEARCH_FORM.MULTI_LOCATIONS,U.displayPlaceOptions),i.$on("chcom-autosuggest:selection",U.selectPlace),i.$on("chcom-autosuggest:submit",i.submitSearch),i.$on(g.SEARCH_FORM.MULTI_PLACE_SELECTED,U.selectPlace),i.$on(g.SEARCH_FORM.SEARCH_CRITERIA_UPDATED,U.refreshFromSession),i.$on(g.SEARCH_FORM.SEARCH_SUCCESS,(function(){i.searchUi.searchSummary&&(i.searchUi.formCollapse=!0)})),e.bind("click",U.resetSearchResult),i.searchUi.searchSummary&&(i.searchUi.formCollapse=!0)},this.init()}]},808:function(e,t){e.exports=["eventsConst","objectHelper","searchConst","searchCriteriaData","searchHelper","siteConfig",function(e,t,r,n,i,a){return{controller:"SearchFormCtrl",link:function(a,s,o){a.childAgesRequired="true"===o.childAgesRequired,a.isReactSearchForm=o.hasOwnProperty("isReactSearchForm"),void 0!==o.searchSummary&&a.searchUi.setSummary(o.searchSummary),"overrideCriteria"in o&&angular.extend(a.search,t.filterProperties(i.getDefaultParams(),r.FORM_PARAMS_REGEX,!0)),a.minRooms=Math.max(1,o.minRooms||1),a.search&&a.search.rooms&&a.search.rooms<a.minRooms&&(a.search.rooms=a.minRooms),o.ratePlan&&(a.search.ratePlanCode=o.ratePlan),a.searchResults&&angular.extend(a.search,a.searchResults.params),n&&n.get()&&n.get().workTravel&&(a.search.workTravel=!0),a.$on(e.SEARCH_FORM.FORM_ERROR,(function(e,t){var r,n=t.length;for(r=0;r<n;r++){var i=s[0].querySelectorAll('input[name="'.concat(t[r],'"]'));angular.element(i).addClass("form-error")}}))},replace:!0,restrict:"A",scope:!0,templateUrl:"/".concat(a.assetFingerprint,"/app/search/form/search-form").concat(a.fileSuffix,".html")}}]},809:function(e,t){e.exports=["$rootScope","$window","domHelper","eventsConst","prerenderService","searchConst",function(e,t,r,n,i,a){return{link:function(s,o){var c=a.LAZY_LOAD_SCROLL_PERCENTAGE,l=0;function u(){s.currentSearch.resultsFiltered.hotelsToShow=h()}function h(){var e=[];return s.currentSearch.resultsFiltered.hotels&&(e=s.currentSearch.resultsFiltered.hotels.filter((function(e,t){return t<l}))),e}i.isRunningInPrerender()?s.currentSearch.resultsFiltered.hotelsToShow=angular.copy(s.currentSearch.resultsFiltered.hotels):(l=a.LAZY_LOAD_COUNT,s.currentSearch.resultsFiltered.hotelsToShow=h()),e.$on(n.PAGE_SCROLL,(function(){r.isInView(o)&&o[0].offsetTop+o[0].offsetHeight-t.pageYOffset<=t.innerHeight*c&&!i.isRunningInPrerender()&&(l+=a.LAZY_LOAD_COUNT,s.currentSearch.resultsFiltered.hotelsToShow=h())})),e.$on(n.LAZY_SRC,u),e.$on(n.SORT_EVENT,u)},restrict:"A"}}]},810:function(e,t){e.exports=["$uibModal","geolocationService","globalLoaderCounter","siteConfig",function(e,t,r,n){var i,a={};function s(){return r.inc(),t.getCoords().then((function(e){a.lat=e.latitude,a.lon=e.longitude,a.isCurrentLocationFound=!0})).catch((function(){a.isCurrentLocationFound=!1,e.open({templateUrl:"/".concat(n.assetFingerprint,"/app/directives/current-location/current-location-modal.html")}).result.finally((function(){i&&i()}))})).finally(r.dec)}return{failedLocationAttempt:!1,getCoords:s,getCurrentLocation:function(){return Object.keys(a).length||s(),a},setFocusInputElement:function(e){i=e}}}]},811:function(e,t){e.exports=function(){return function(e,t){return e>t?"".concat(t+1,"+"):e}}},812:function(e,t,r){e.exports=angular.module("chApp.search.map",[]).directive("chMapDestinations",r(813)).directive("chMapDestinationsTable",r(814)).directive("chMapInfoBox",r(816)).directive("chMapDirections",r(817)).directive("chMapDirectionsLeaveNow",r(818)).directive("chMapMobile",r(819)).directive("chMapPanelManager",r(820)).factory("mapPanelManagerService",r(418)).factory("resultsMapDestinationsService",r(821)).factory("resultsMapDirectionsService",r(822)).factory("searchResultsMapPinFactory",r(419)).factory("searchResultsMapAPIFactory",r(420)).service("mapMobileService",r(421)).service("searchResultsMapService",r(422))},813:function(e,t){e.exports=["$document","$uibModal","deviceConst","resultsMapDestinationsService","siteConfig","strings",function(e,t,r,n,i,a){return{link:function(s,o){var c,l=i.deviceType===r.MOBILE,u={scope:s,size:"lg",templateUrl:"/".concat(i.assetFingerprint,"/app/search/map/results-map-destinations/results-map-destinations-modal.html"),windowTemplateUrl:"/".concat(i.assetFingerprint,"/app/bootstrap-ui/modal/generic.modal-window.html"),windowTopClass:"suggested-modal-pane"};function h(e){return Object.keys(s.parsedDestinations[e].subcategories||{}).sort()}l&&(u.windowTopClass+=" suggested-mobile"),s.parsedDestinations=n.parseDestinations(s.destinations),s.categoryKeys=Object.keys(s.parsedDestinations).sort(),s.currentCategory=s.categoryKeys[0],s.subcategoryKeys=h(s.currentCategory),s.categorySelectedText=a.hotel.selectCategory,s.status={},s.showDestinations=function(e){s.parsedDestinations[e]&&(s.currentCategory=e,s.subcategoryKeys=h(e),s.categorySelectedText=a.hotel.mapPanels[s.currentCategory])},s.focusDropdown=function(){c&&c.focus(),s.status.isOpen=!1},o.bind("click",(function(){s.suggestedModal=t.open(u),s.suggestedModal.rendered.then((function(){c=e[0].querySelector(".suggested-modal .dropdown-toggle")}))}))},restrict:"A",scope:{destinations:"="}}}]},814:function(e,t,r){e.exports=function(){return{link:function(e){e.getOrderString=function(e){return"".concat(e?"-":"+","distance")}},replace:!0,restrict:"E",scope:{destinations:"<"},template:r(815)}}},815:function(e,t){e.exports='<table>\n  <thead>\n    <tr>\n      <th>{{::$root.strings.hotel.mapPanels.name}}</th>\n      <th class="pointer">\n        <button ng-click="reverse = !reverse">\n          {{::$root.strings.hotel.mapPanels.distance}} \n          <span class="ch-icon" ng-class="{\'ch-icon-chevron-down\': !reverse, \'ch-icon-chevron-up\': reverse}"></span>\n        </button>\n      </th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr ng-repeat="destinationObject in destinations | orderBy:[getOrderString(reverse), \'name\']">\n      <td>{{destinationObject.name}}</td>\n      <td class="distance">{{destinationObject.distance}} {{destinationObject.distanceUnits}} {{destinationObject.direction}}</td>\n    </tr>\n  </tbody>\n</table>\n'},816:function(e,t){e.exports=["siteConfig",function(e){return{restrict:"E",templateUrl:"/".concat(e.assetFingerprint,"/app/search/map/results-map-pin-infobox/pininfobox-tmpl.html")}}]},817:function(e,t){e.exports=["$window","deviceConst","mapConst","mapPanelManagerService","resultsMapDirectionsService","siteConfig","strings",function(e,t,r,n,i,a,s){return{link:function(e){var o=r.MAP_IDS.hotelLargeMap,c=a.deviceType===t.MOBILE,l=c?"directionsRenderMobile":"directionsRenderDesktop",u=document.getElementById(l);e.isDirectionFormVisible=!c,e.destination="",e.reverseDirections=!0,e.panelObject=r.PANELS,e.panelService=n,e.routeTypes=r.ROUTE_TYPES,e.currentDirectionType=r.ROUTE_TYPES.driving,e.transitModeString=r.ROUTE_TYPES.transit,e.getCurrentLeaveObject=i.getCurrentLeaveTypeObject,e.isLeaveNowOpen=!1,e.isDirectionFormVisible=!0,e.hotelStrings=s.hotel.mapPanels,e.distanceUnit="",e.leaveNowDate=new Date,e.isXSWindow=window.innerWidth<r.MAP_BREAK_POINTS.small,e.toggleLeaveNow=function(){e.isLeaveNowOpen=!e.isLeaveNowOpen},e.showDirections=function(){e.isDirectionFormVisible=!0},e.reverseDrivingDirections=function(){e.reverseDirections=!e.reverseDirections,e.destination&&e.getDirections(e.destination)},e.getDirections=function(t){var s=e.map.entities.get(0);n.clearPanelMap(o,[s]),s.setOptions({zIndex:6});var c=i.getHotelAddressString(e.hotelAddress),l=e.reverseDirections?t:c,h=e.reverseDirections?c:t,p={distanceUnit:e.distanceUnit===e.hotelStrings.kilometers?Microsoft.Maps.Directions.DistanceUnit.kilometers:Microsoft.Maps.Directions.DistanceUnit.miles,routeMode:i.getRouteMode(e.currentDirectionType)};if(e.currentDirectionType===r.ROUTE_TYPES.transit){var d=i.getCurrentLeaveTimeData();p.transitOptions={timeType:e.getCurrentLeaveObject().leaveType,transitTime:i.getTransitTime(e.leaveNowDate,d.hour,d.minute,d.meridian)}}e.panelService.isDirectionsExpanded=l&&h&&"MOBILE"===a.deviceType,i.getDirections(l,h,u,p),n.closeOtherPanels(r.PANELS.mapDirections)},n.getMap(o).then((function(t){e.map=t,Microsoft.Maps.loadModule("Microsoft.Maps.Directions",{callback:function(){i.createDirectionsManager(e.map)}})})),e.$on(r.EVENTS.PANELS.clear,(function(e,t){t===o&&angular.element(u).contents().remove()}))},restrict:"A",scope:{hotelAddress:"=",hotelName:"@"},templateUrl:"/".concat(a.assetFingerprint,"/app/search/map/results-map-directions/results-map-directions.html")}}]},818:function(e,t){e.exports=["mapConst","resultsMapDirectionsService","siteConfig","strings",function(e,t,r,n){return{link:function(e){var r=!1,i=t.getCurrentLeaveTimeData();e.hotelStrings=n.hotel.mapPanels,e.leaveNowDate=new Date,e.todayDate=new Date,e.leaveTypeData=t.getLeaveTypeData(),e.currentLeaveObject=t.getCurrentLeaveTypeObject(),e.timeData=t.getTimeSelectData(),e.leaveTimeData=t.setLeaveTimeObjectToDate(e.todayDate,i),e.isCalendarOpened=!1,e.leaveTimeChange=function(){return r||(r=!0,e.selectLeaveObject(e.leaveTypeData[1])),r},e.selectLeaveObject=function(n){e.currentLeaveObject=t.setCurrentLeaveTypeObject(n),n.title===e.leaveTypeData[0].title?(r=!1,e.todayDate.getDay()===e.leaveNowDate.getDay()&&e.todayDate.getMonth()===e.leaveNowDate.getMonth()||(e.leaveNowDate=null,e.leaveNowDate=new Date),e.todayDate=new Date,e.leaveTimeData=t.setLeaveTimeObjectToDate(e.todayDate,e.leaveTimeData)):r=!0},e.openCalendar=function(t){t.preventDefault(),t.stopPropagation(),e.isCalendarOpened=!0},e.$watch((function(){return e.leaveNowDate.getTime()}),(function(){e.todayDate.getDay()!==e.leaveNowDate.getDay()||e.todayDate.getMonth()!==e.leaveNowDate.getMonth()?e.leaveTimeChange():e.selectLeaveObject(e.leaveTypeData[0])}))},restrict:"A",scope:{},templateUrl:"/".concat(r.assetFingerprint,"/app/search/map/results-map-directions/results-map-directions-leave-now.html")}}]},819:function(e,t){e.exports=["$window","siteConfig",function(e,t){return{link:function(r,n){var i=angular.element(document.querySelector(".hotel-map-container")),a=window.innerHeight,s=angular.element(document.querySelector(".search-results-map")),o=document.querySelector(".directions-container"),c="directions-map"===r.mapClass?160:55;function l(t){var n=e.getComputedStyle(o).getPropertyValue("height"),i=a-Number(n.split("px")[0]);t||"directions-map"!==r.mapClass?s.css({height:"".concat(i-c,"px")}):s.css({height:"".concat(i,"px")})}"MOBILE"===t.deviceType&&(n.on("click",(function(){l(),i.hasClass(r.mapClass)?(i.removeClass(r.mapClass),s.removeAttr("style")):i.addClass(r.mapClass)})),r.$watch("directionsExpanded",(function(e){e&&l(e)})))},restrict:"A",scope:{directionsExpanded:"=",mapClass:"@"}}}]},820:function(e,t){e.exports=["mapConst","mapPanelManagerService",function(e,t){return{link:function(r,n,i){r.panelService=t,r.panelObject=e.PANELS,r.hotelLargeMap=i.mapId||e.MAP_IDS.hotelLargeMap,r.isEmpty=function(e){return!Object.keys(e).length},t.registerPanels(r.$eval(i.chMapPanelManager)),window.innerWidth<e.MAP_BREAK_POINTS.small&&t.closeAllPanels()},restrict:"A"}}]},821:function(e,t){e.exports=["strings","transportationConst",function(e,t){var r=function(e){var t=[];return e.forEach((function(e){t.push(i(e))})),t},n=function(e,r){var n={};return e.forEach((function(e){var a=r?"AIR":e.code,s=t.TRANSPORTATION_TYPES[a]||"other";n[s]=n[s]||[],n[s].push(i(e))})),n};function i(t){var r=e.hotel.mapPanels.directionAbbreviations,n=t.directionFromHotel?r[t.directionFromHotel.toLowerCase()]:"",i=t.distanceFromHotel.units?r[t.distanceFromHotel.units.toLowerCase()]:"";return{direction:n,distance:t.distanceFromHotel.value,distanceUnits:i,name:t.name}}return{parseDestinations:function(e){if(!e)return null;var t={};for(var i in e)if(Object.prototype.hasOwnProperty.call(e,i)){var a=i.toLowerCase(),s=r(e[i]),o={airports:"transportation",attractions:"attractions",institutions:"businesses",lounges:"barsAndBistros",restaurants:"restaurants",transportations:"transportation"}[a];if(o)if("transportation"!==o)t[o]=s;else{var c=n(e[a],"airports"===a);t[o]=t[o]||{subcategories:{}},angular.extend(t[o].subcategories,c)}}return t}}}]},822:function(e,t){e.exports=["mapConst","strings",function(e,t){var r,n={hour:[1,2,3,4,5,6,7,8,9,10,11,12],meridian:["AM","PM"],minute:["00","05","10","15","20","25","30","35","40","45","50","55"]},i=[{leaveType:e.TIME_TYPES.now,title:t.hotel.mapPanels.leaveNow},{leaveType:e.TIME_TYPES.departure,title:t.hotel.mapPanels.leaveAt},{leaveType:e.TIME_TYPES.arrival,title:t.hotel.mapPanels.arriveBy}],a=i[0],s={hour:n.hour[11],meridian:n.meridian[1],minute:n.minute[0]};return{createDirectionsManager:function(e){return r||(r=new Microsoft.Maps.Directions.DirectionsManager(e)),r},getCurrentLeaveTimeData:function(){return s},getCurrentLeaveTypeObject:function(){return a},getDirections:function(e,t,n,i){var a=new Microsoft.Maps.Directions.Waypoint({address:e}),s=new Microsoft.Maps.Directions.Waypoint({address:t});r.resetDirections(),r.setRequestOptions(i),r.addWaypoint(a),r.addWaypoint(s),r.setRenderOptions({itineraryContainer:n}),r.calculateDirections()},getHotelAddressString:function(e){var t=e.line1||"",r=e.city||"",n=e.subdivision||"",i=e.postalCode||"";return"".concat(t," ").concat(r," ").concat(n," ").concat(i)},getLeaveTypeData:function(){return i},getRouteMode:function(t){switch(t){case e.ROUTE_TYPES.walking:return Microsoft.Maps.Directions.RouteMode.walking;case e.ROUTE_TYPES.transit:return Microsoft.Maps.Directions.RouteMode.transit;case e.ROUTE_TYPES.driving:default:return Microsoft.Maps.Directions.RouteMode.driving}},getTimeSelectData:function(){return n},getTransitTime:function(e,t,r,n){if(!e)return new Date;if(isNaN(t)||isNaN(r))return e;var i="PM"===(n||"AM")?Math.min(t+12,23):t;return e.setHours(i,r),e},setCurrentLeaveTypeObject:function(e){return a=e},setLeaveTimeObjectToDate:function(e,t){var r=e.getHours(),i=e.getMinutes();return t.hour=r>11?r-12:r,t.meridian=r>11?"PM":"AM",t.minute=n.minute[Math.floor(i/5)],t}}}]},823:function(e,t,r){e.exports=angular.module("chApp.search.results",[]).component("chFlashSaleBanner",r(824)).directive("chSearchResultsItem",r(825)).filter("chSearchResults",r(826))},824:function(e,t){e.exports={bindings:{hotel:"="},controller:["featureFlags",function(e){if(this.usingFlashSaleRate=!1,e.FLASH_SALE_MERCHANDISING_DESKTOP&&this.hotel.rateRanges&&this.hotel.rateRanges[0].min.ratePlanCategoryList)for(var t=0;t<this.hotel.rateRanges[0].min.ratePlanCategoryList.length;t++)"FLASH"===this.hotel.rateRanges[0].min.ratePlanCategoryList[t].category&&(this.usingFlashSaleRate=!0,this.savePercentage=this.hotel.rateRanges[0].min.savePercentage||100-this.hotel.priceData[0].cash/this.hotel.priceData[0].discount*100)}],controllerAs:"flashSaleBanner",templateUrl:["siteConfig",function(e){return"/".concat(e.assetFingerprint,"/app/search/results/flash-sale-banner.html")}]}},825:function(e,t){e.exports=["$filter","hotelImageHelper","selectedLangData","siteConfig","strings",function(e,t,r,n,i){var a=r.get().code;return{controller:["$location","$rootScope","$scope","apiParamsHelper","brandColorConst","brandConst","dateFilter","dateHelper","deviceConst","featureFlags","hotelHelper","hotelImageHelper","mapActiveHotelService","pagesConst","patternsConst","priceHelper","ratesConst","roomkeyService","searchDataService","searchResultsMapService","searchService","searchUrlHelper","urlParserService",function(t,r,s,o,c,l,u,h,p,d,f,g,m,S,v,y,R,C,E,A,b,P,O){s.getPercentCashDiscount=function(){var e=y.sortRateRangesByPrice(s.hotel.rateRanges),t=e.find((function(e){return"RACK"===e.min.ratePlanCode})).min.avgNightlyBeforeTax,r=e[0].min.avgNightlyBeforeTax;return i.search.item.bookNowSave.replace("{percent}",e[0].min.savePercentage||Math.round(y.calculateDiscountPercent(t,r)))},s.getPropertyPageUrlWithoutQueryString=function(e){return O.getPropertyPageUrl(e.address,e.brandCode,e.id,a,!1)},s.goToPropertyPage=function(e){t.path(O.getPropertyUrl(e.address,e.brandCode,e.id,a))},s.bookHotel=function(e){t.path(O.getPropertyRatesUrl(e.address,e.brandCode,e.id,a)),t.search({}),r.loadPopUnderWindow&&r.loadPopUnderWindow()},s.selectHotel=function(e,t,r){return!(!e||!s.splitView)&&(d.MAPS_CLEANUP_SERP&&!s.isMobile?void m.setActiveHotel(e,t,r):(A.lat=t,A.lon=r,A.hotelId=e,!0))},s.midScaleBrandColor=function(e,t){return d.DESKTOP_NEW_MIDSCALE_COLORS&&void 0!==c.BRAND_COLOR[e]?void 0!==c.BRAND_COLOR[e][t]?c.BRAND_COLOR[e][t]:c.BRAND_COLOR[e].default:"primary"},function(){var t=e("chPrice")(s.hotel);s.brandConst=l,s.price=t&&t[0]||{},s.imageStatus={error:!1},s.featureFlags=d,s.searchResultsClickTracking="CheckAvailability_",s.hotelAction=b.getHotelAction(s.searchParams,s.hotel),s.ctaUrl=P.getCtaUrl(s.hotelAction,s.hotel,s.searchParams),s.getPropertyRatesUrl=P.getPropertyRatesUrl,s.getPropertyPageUrl=P.getPropertyPageUrl,s.getPropertyGroupRequestUrl=P.getPropertyGroupRequestUrl,s.pageTracking=S.SEARCH_PAGE,s.hotelImageHelper=g,s.isMobile=n.deviceType===p.MOBILE,s.cpUser=r.cpUser,s.insideOfPointsWindow=y.insideOfPointsWindow(s.cpUser,s.searchParams),s.outsideOfPointsWindowText=y.outsideOfPointsWindowText(s.cpUser);var i=s.hotel;if(i.closureEndDate){i.closureEndDate=h.parseToUtcDate(i.closureEndDate);var a=h.withAddedDays(i.closureEndDate,1);i.closureEndDate=a}s.merchandising=g.getImageMerchandisingTag(s.hotel),s.price&&(s.price.cash||s.price.points)&&s.hotelAction!==r.chConstants.search.HOTEL_ACTION.CREATE_GROUP?s.ctaText=r.strings.general.checkAvailability:s.hotelAction===r.chConstants.search.HOTEL_ACTION.CREATE_GROUP?s.ctaText=r.strings.search.item.selectRooms:(s.searchResultsClickTracking="GetQuoteBTN_",s.ctaText=r.strings.search.item.getQuote),s.showSrdMaxOccupancyWarning=f.shouldHotelShowSrdOccupancyWarning(s.hotel,s.searchParams&&s.searchParams.ratePlanCode)&&s.hotelAction!==r.chConstants.search.HOTEL_ACTION.NONE,s.isAmrProperty=s.hotel&&f.isHotelAMResort(s.hotel),s.shouldShowGuestWarning=s.showSrdMaxOccupancyWarning&&s.searchParams&&f.shouldShowGuestWarning(s.searchParams.adults,s.searchParams.minors),d.CLOSED_USER_GROUP&&(s.cugDiscount=!d.CLOSED_USER_GROUP_V2&&y.isCugLowestPrice(s.hotel.rateRanges))}()}],replace:!0,restrict:"A",scope:{hotel:"=",index:"=",priceType:"<?",searchParams:"=",splitView:"=?"},templateUrl:"/".concat(n.assetFingerprint,"/app/search/results/search-results-item").concat(n.fileSuffix,".html")}}]},826:function(e,t,r){e.exports=["featureFlags","ratesConst","searchConst","searchService","soSmartBubbleService",function(e,t,n,i,a){var s,o=r(0);return function(r,c,l,u,h){if(!c)return r;var p=l===n.SORT_OPTIONS.DISTANCE,d=[n.SORT_OPTIONS.PRICE_ASCENDING,n.SORT_OPTIONS.PRICE_DESCENDING].indexOf(l)>=0,f=l===n.SORT_OPTIONS.RATING,g=l===n.SORT_OPTIONS.DISCOUNT_PERCENT,m=l===n.SORT_OPTIONS.DISCOUNT_DOLLAR;r&&(r=r.filter((function(e){return(!c.onlyAvailable||!n.UNAVAILABLE_PREFIX_REGEX.test(e.hotelSectionType))&&(n.UNAVAILABLE_PREFIX_REGEX.test(e.hotelSectionType)||!c.priceLow||c.priceLow<=c.priceMin||e.price>=c.priceLow)&&(n.UNAVAILABLE_PREFIX_REGEX.test(e.hotelSectionType)||!c.priceHigh||c.priceHigh>=c.priceMax||e.price<=c.priceHigh)&&(!c.ratings||e.rating&&e.rating.value>=c.ratings)&&(!h||!c.brand||c.brand.split(n.URL_PARAM_DELIMITER).indexOf(e.brandCode)>=0)&&(!h||!c.amenity||e.amenityGroups&&c.amenity.split(n.URL_PARAM_DELIMITER).every((function(t){return e.amenityGroups.some(o.byId(t))})))&&(t=c.searchRadius,i.isKm?!t||e.distanceValue<=Math.round(t*n.DISTANCE_CONVERSION.miToKm):!t||e.distanceValue<=t);var t}))).length>1&&(r.sort((function(e,r){return i=n.AVAILABILITY[e.hotelSectionType],a=n.AVAILABILITY[r.hotelSectionType],(i.available!==a.available?i.available?-1:1:i.available||c.coop||d||p||f?void 0:e.closureReason?1:-1)||function(){if(u&&t.DEFAULT_RATE_PLANS.indexOf(u)<0)return(r.ratePlanCode===u)-(e.ratePlanCode===u)}()||function(){if(c.coop&&!d&&!p&&!f&&e.coOpParticipant!==r.coOpParticipant)return e.coOpParticipant?-1:1}()||function(){var t=n.AVAILABILITY[e.hotelSectionType],i=n.AVAILABILITY[r.hotelSectionType];if(t.sortOrder!==i.sortOrder)return t.sortOrder-i.sortOrder}()||function(){if(d&&e.price!==r.price)return e.price?r.price?"-"!==l[0]?e.price-r.price:r.price-e.price:-1:1}()||function(){if(p)return e.distanceValue-r.distanceValue}()||function(){if(f)return(r.rating&&r.rating.value||0)-(e.rating&&e.rating.value||0)}()||function(){if(g)return e.price/(e.priceData[0].discount||e.price)-r.price/(r.priceData[0].discount||r.price)}()||function(){if(m){var t=(e.priceData[0].discount||e.price)-e.price;return(r.priceData[0].discount||r.price)-r.price-t}}()||e.originalIndex-r.originalIndex;var i,a})),s=!(p||d||f||m||g));var S=e.SO_SMART_BUBBLE?a.bubbleHotels(r,c,s):r;return!e.COOP_RANKING_SORT||!c.coop||d||p||f||S.sort((function(e,t){var r=!0===e.coOpParticipant&&"AVAILABLE_HOTELS"===e.hotelSectionType,n=!0===t.coOpParticipant&&"AVAILABLE_HOTELS"===t.hotelSectionType;return r&&n?e.relevanceRank-t.relevanceRank||e.relevance-t.relevance:r||n?r?-1:1:0})),S}}]},827:function(e,t,r){e.exports=angular.module("chApp.search.resortBanner",[]).component("chBanner",r(828))},828:function(e,t){function r(){return(r=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e}).apply(this,arguments)}function n(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var i=function(){function e(t,n,i,a,s,o,c){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),r(this,{$rootScope:t,$window:n,eventsConst:i,hotelConst:a,omniture:s,omnitureConst:o,strings:c})}var t,i,a;return e.$inject=["$rootScope","$window","eventsConst","hotelConst","omniture","omnitureConst","strings"],t=e,(i=[{key:"$onInit",value:function(){this.url=this.destination.targetUrl,this.destination.type===this.hotelConst.BANNER_TYPES.VACATION_RENTALS&&(this.logoUrl="/".concat(siteConfig.assetFingerprint,"/assets/images/vr-logo.svg"),this.bannerHeading=this.strings.search.rentalsBanner.bannerHeading,this.bannerSearchButton=this.strings.search.rentalsBanner.bannerSearchButton),this.destination.type===this.hotelConst.BANNER_TYPES.WOOD_SPRING&&(this.logoUrl="/".concat(siteConfig.assetFingerprint,"/assets/images/ws-logo.svg"),this.bannerHeading=this.strings.search.woodSpringBanner.bannerHeading,this.bannerSearchButton=this.strings.search.woodSpringBanner.bannerSearchButton)}},{key:"goToSearch",value:function(){this.omniture.sendAnalyticsViaCustomLink({},this.omnitureConst.SEARCH_RESULTS_BANNER),this.destination.type===this.hotelConst.BANNER_TYPES.VACATION_RENTALS&&this.$rootScope.$emit(this.eventsConst.RENTALS_BANNER_CLICK),this.$window.open(this.url,"_blank")}}])&&n(t.prototype,i),a&&n(t,a),e}();e.exports={bindings:{destination:"<?",splitView:"<?"},controller:i,templateUrl:["$attrs","siteConfig",function(e,t){return"/".concat(t.assetFingerprint,"/app/search/banner/banner").concat(t.fileSuffix,".html")}]}},829:function(e,t,r){e.exports=angular.module("chApp.search.sortPanel",[]).component("chSearchSortPanel",r(830))},830:function(e,t){function r(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var n=function(){function e(t,r,n,i){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.$document=t,this.$scope=r,this.$scope.searchConst=n,this.openedToggles={},this.strings=i}var t,n,i;return e.$inject=["$document","$scope","searchConst","strings"],t=e,(n=[{key:"$onInit",value:function(){var e=this;this.onSortChange&&this.$scope.$watch("$ctrl.sort",(function(t,r){t!==r&&e.onSortChange({$sort:t})}))}},{key:"focusToggle",value:function(e,t){if(e)this.openedToggles[t]=!0;else if(this.openedToggles[t]){var r=this.$document[0].getElementById(t);!e&&r&&r.focus()}}},{key:"getSelectedSortOption",value:function(){var e=this.$scope.searchConst.SORT_OPTIONS,t=e.DISCOUNT_DOLLAR,r=e.DISCOUNT_PERCENT,n=e.DISTANCE,i=e.PRICE_ASCENDING,a=e.PRICE_DESCENDING,s=e.RELEVANCE,o=this.strings.search.results,c=o.filterDiscountByDollar,l=o.filterDiscountByPercent,u=o.filterDistance,h=o.filterPointsHighToLow,p=o.filterPointsLowToHigh,d=o.filterPriceHighToLow,f=o.filterPriceLowToHigh,g=o.filterRelevance;switch(this.sort){case s:return g;case a:return this.showPoints?h:d;case i:return this.showPoints?p:f;case n:return u;case r:return l;case t:return c}}}])&&r(t.prototype,n),i&&r(t,i),e}();e.exports={bindings:{clickEmitPage:"@?",config:"<?",currencyCode:"=",onSortChange:"&?",showPoints:"<?",sort:"="},controller:n,templateUrl:["$attrs","siteConfig",function(e,t){return"/".concat(t.assetFingerprint,"/app/search/sort-panel/search-sort-panel").concat(t.fileSuffix,".html")}]}},831:function(e,t,r){e.exports=angular.module("chApp.search.statusBar",[]).component("chSearchStatusBar",r(832))},832:function(e,t){function r(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var n=function(){function e(t,r,n,i,a){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.chPlaceDisplayFilter=r,this.featureFlags=n,this.searchHelper=i,this.strings=a,this.isExtendedSerp=this.featureFlags.EXTENDED_STAY_SERP&&-1!==t.path().indexOf("/extended-stay-hotels")}var t,n,i;return e.$inject=["$location","chPlaceDisplayFilter","featureFlags","searchHelper","strings"],t=e,(n=[{key:"$onInit",value:function(){this.isExtendedSerp&&(this.subtitle=this.strings.search.results.filterBrandCategory.extendedStay.tooltip,this.brandGroupDisplay=this.strings.search.results.extendedStay),this.setBrandAmenityDisplay(),this.setHotelCount(),this.setPlaceDisplay(),this.triggerStatusUpdate()}},{key:"$onChanges",value:function(e){(e.brand||e.amenity)&&this.setBrandAmenityDisplay(),e.hotels&&this.setHotelCount(),e.place&&this.setPlaceDisplay(),this.triggerStatusUpdate()}},{key:"setBrandAmenityDisplay",value:function(){this.brandAmenityDisplay=this.searchHelper.getBrandAmenityDisplay(this.brand,this.amenity,this.amenities)}},{key:"setHotelCount",value:function(){this.hotelCount=this.searchHelper.getHotelCount(this.hotels)}},{key:"setPlaceDisplay",value:function(){this.placeDisplayName=this.chPlaceDisplayFilter(this.place)}},{key:"triggerStatusUpdate",value:function(){this.onStatusChange&&this.onStatusChange({$brandAmenity:this.brandAmenityDisplay,$hotelCount:this.hotelCount,$placeDisplay:this.placeDisplayName})}}])&&r(t.prototype,n),i&&r(t,i),e}();e.exports={bindings:{amenities:"<",amenity:"<",brand:"<",hotels:"<",onStatusChange:"&?",place:"<"},controller:n,templateUrl:["siteConfig",function(e){return"/".concat(e.assetFingerprint,"/app/search/status-bar/search-status-bar").concat(e.fileSuffix,".html")}]}},833:function(e,t,r){e.exports=angular.module("chApp.search.viewPanel",[]).directive("chSearchViewPanel",r(834))},834:function(e,t){var r={isActive:!0,list:!0,map:!0,split:!0};e.exports=["$timeout","analyticsManager","omniture","omnitureConst","searchConst","siteConfig",function(e,t,n,i,a,s){return{link:function(s){s.updateState=function(r){var o;(r===a.VIEW_OPTIONS.MAP&&(s.focusList=!1,e((function(){return s.focusList=!0}))),s.viewOnPanel&&(s.viewOnPanel.view=r),s.currentView!==r||s.viewOnPanel)&&(s.lastView=s.currentView,s.currentView=r,s.onViewChange&&s.onViewChange({$view:r}),t.usingNewAnalytics||(n.getPreviousPageName().split("Error").length>1?(o=i.OMNITURE_PAGE_NAME_ERROR.replace("%page%",r),n.reSendAnalyticsViaPageLoad({pageName:o,prop54:"viewBy".concat(r)})):(o=i.OMNITURE_PAGE_NAME.replace("%page%",r),0,n.reSendAnalyticsViaPageLoad({pageName:o,prop19:0,prop54:"viewBy".concat(r)}))))},s.searchConst=a,s.initialView&&(s.currentView=s.initialView),s.focusList=!1,s.searchViewConfig=angular.extend({},r,s.searchViewConfig)},scope:{clickEmitPage:"@?",currentView:"=?view",initialView:"@",mobileSuppression:"=?",onViewChange:"&?",searchViewConfig:"=?",viewOnPanel:"=?"},templateUrl:"/".concat(s.assetFingerprint,"/app/search/view-panel/search-view-panel.html")}}]},835:function(e,t){function r(){return(r=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e}).apply(this,arguments)}function n(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var i=function(){function e(t,n,i,a,s,o,c,l,u,h,p,d,f,g,m,S,v,y,R,C,E,A,b,P,O,T,D,w,_,$){var L=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e);var I=_.deviceType===u.MOBILE,N=!d.LAZY_LOAD_RESORT_BANNER||y.isRunningInPrerender(),M=d.EXTENDED_STAY_SERP&&-1!==n.path().indexOf("/extended-stay-hotels"),H=function(e){e&&e.browserwindowtitle?w.updateSearchResultsDestinationMeta(e):w.updateSearchResultsMeta(O.place,O.filters,O.hotelsFiltered)};r(this,{$document:t,$location:n,$scope:s,$timeout:c,$window:l,domHelper:h,featureFlags:d,priceTypeService:R,searchResults:O,searchResultsService:D,searchUpdateMetadata:w},{isResortBannerLoaded:N,updateMetaTags:H}),r(s,{searchConst:b,searchResults:O,searchResultsMapService:T,siteConfig:_},{childAgesRequired:D.locationRequiresChildAges(),isDestinationBladeLoaded:y.isRunningInPrerender(),isExtendedStay:M,isMobile:I,searchPending:!1,sendFilterOmniture:function(){s.isFilterPanelOpen?g.sendAnalyticsViaCustomLink({},m.HIDE_FILTERS):g.sendAnalyticsViaCustomLink({},m.SHOW_FILTERS)},toggleFilterPanel:function(){s.isFilterPanelOpen=!s.isFilterPanelOpen,L.loadDestinationBlade(!0)},updateMetaTags:H},d.MAPS_CLEANUP_SERP&&!I&&{mapActiveHotelService:f}),w.updatePropertySearchNoIndex();if(function(){O.on("update_url",w.updatePropertySearchNoIndex),O.on("paginate",(function(){L.dispatchDTMEvent(),O.view===b.VIEW_OPTIONS.SPLIT&&s.$$postDigest((function(){return s.$broadcast(p.STICKY_CHECK)}))})),O.on("update_search_criteria",(function(){return s.$broadcast(p.SEARCH_FORM.SEARCH_CRITERIA_UPDATED)}));var e=a.$on(p.PAGE_SCROLL,(function(){return L.loadDestinationBlade(!0)})),t=a.$on(p.RENTALS_BANNER_DISPLAY,(function(e,t){l.dataLayer&&l.dataLayer.push({ecommerce:{regionName:t},event:p.RENTALS_BANNER_DISPLAY})})),r=a.$on(p.RENTALS_BANNER_CLICK,(function(){E.init(s,"ClickRentalsNearbyBTN"),a.$emit(p.ANALYTICS_PAGE_LOADED,v.RENTALS_SEARCH_PAGE)})),n=s.$on(p.LOGGED_IN_OR_OUT,(function(){O.params.ratePlanCode===C.RATE_PLAN_CODES.SRD&&(P.clear(),o.reload())})),i=s.$on(p.LOGGED_IN,(function(){S.loaded(v.LOGGED_IN_SEARCH_PAGE)})),c=s.$on("$destroy",(function(){e(),t(),r(),n(),i(),c()}))}(),function(){if(O.filters.brand&&c((function(){return H()})),i.when($.getPromise()).then((function(){A.init(s),c((function(){d.SO_SMART_BUBBLE&&O.resultsFilterPromise?O.resultsFilterPromise.then((function(){a.$emit(p.ANALYTICS_PAGE_LOADED,v.SEARCH_PAGE),S.loaded(v.SEARCH_PAGE,O)})):(a.$emit(p.ANALYTICS_PAGE_LOADED,v.SEARCH_PAGE),S.loaded(v.SEARCH_PAGE,O))}))})),d.MW_SEARCH&&a.isMobile){var e=window,t=e.CompassSpinner,r=e.Spinner;t&&t.count&&t.decrement(),r&&r.count&&r.decrement()}y.isRunningInPrerender()||L.lazyLoadContent()}(),this.priceTypeService.shouldUsePriceType()){s.priceType=R.initializePriceType();var U=a.$on("priceTypeChanged",(function(e,t){s.ratePlanCode=t.ratePlanCode;var r=function(){s.priceType=t.index,L.priceTypeService.setPriceType(s.priceType),L.searchResultsService.setParams({ratePlanCode:t.ratePlanCode}),A.shouldFireAnalytics=!1,L.searchResults.updateFiltersPrices(),s.$broadcast("priceTypeFilterChange")};s.priceType<3&&3===t.index||3===s.priceType&&3!==t.index?(r(),L.searchResultsService.search(),o.reload()):r()}));s.$on("$destroy",(function(){U()}))}else this.priceTypeService.invalidatePriceType()}var t,i,a;return e.$inject=["$document","$location","$q","$rootScope","$scope","$state","$timeout","$window","deviceConst","domHelper","eventsConst","featureFlags","mapActiveHotelService","omniture","omnitureConst","pageEventsHelper","pagesConst","prerenderService","priceTypeService","ratesConst","resortBannerAnalytics","searchAnalytics","searchConst","searchDataService","searchResults","searchResultsMapService","searchResultsService","searchUpdateMetadata","siteConfig","siteOpService"],t=e,(i=[{key:"dispatchDTMEvent",value:function(){var e=this.$document[0].querySelector("div.list");e&&e.dispatchEvent(new this.$window.CustomEvent("loadNewSearchResult",{detail:{hotels:this.searchResults.hotelsInView}}))}},{key:"isElementVisible",value:function(e){if(!e||!e.getBoundingClientRect())return!1;var t=e.getBoundingClientRect(),r=Math.max(this.$document[0].documentElement.clientHeight,window.innerHeight);return t.bottom>=0&&t.top-r<0}},{key:"lazyLoadContent",value:function(){var e=this;this.$timeout((function(){e.loadDestinationBlade(!1)}),400)}},{key:"loadDestinationBlade",value:function(e){if(!this.$scope.isDestinationBladeLoaded)if(e)this.$scope.isDestinationBladeLoaded=!0;else{var t=angular.element(this.$document[0].getElementById("search-destination-blade"));t.length&&this.domHelper.isInView(t)&&(this.$scope.isDestinationBladeLoaded=!0)}}}])&&n(t.prototype,i),a&&n(t,a),e}();e.exports=i},836:function(e,t){e.exports=["$compile","$location","$rootScope","analyticsConst","analyticsManager","cpUserData","dateHelper","eventsConst","omniture","omnitureConst","pagesConst","ratesConst",function(e,t,r,n,i,a,s,o,c,l,u,h){return{init:function(e,t){i.initialize(),c.clearPreviousProperties(),i.setPageDefaults({ADS_SERVED:function(){return"".concat(e.searchResults.ratePlanCode===h.RATE_PLAN_CODES.SRD&&a.get().signedIn&&"ELIGIBLE"===a.get().pointsPlusCashAccountStatus.statusCode?l.POINTS_PLUS_CASH:null,"|VR Ad")},CLICK_TRACKING:function(){return t},LENGTH_OF_STAY:function(){return s.subtractDates(e.searchResults.params.checkOutDate,e.searchResults.params.checkInDate)},PAGE_NAME:function(){return"".concat(l.PAGE_NAME.HOTEL_LIST," - ").concat(e.searchResults.view," ")+l.VIEW},PLACENAME:function(){return e.searchResults.place.placeName},RATE_PLAN_CODE:function(){return e.searchResults.params.ratePlanCode},SEARCH_AUTOSUGGEST_PLACE_TYPE:l.RENTALS.SEARCH_TYPE,SEARCH_COUNTRY:function(){return e.searchResults.place.placeName&&e.searchResults.place.placeName.replace(/.*?([A-Z]+)?$/,"$1")}},u.RENTALS_SEARCH_PAGE)}}}]},837:function(e,t){e.exports=["$filter","$rootScope","$timeout","amenitiesConst","analyticsConst","analyticsManager","arrayHelper","brandConst","cpUserData","dateHelper","eventsConst","featureFlags","omniture","omnitureConst","pagesConst","ratePlanHelper","ratesConst","searchConst","searchCriteriaData","searchResultsService","searchService","sessionStorageHelper",function(e,t,r,n,i,a,s,o,c,l,u,h,p,d,f,g,m,S,v,y,R,C){return{hasInitialized:!1,init:function(h){var g=this,E=v.get();this.scope=h,this.searchCriteria=E,a.initialize(),this.scope=h,C.getCurrentSearch().currentLocation&&(a.currentLocationObject.value=d.CURRENT_LOCATION);var A=h.$watch("searchResults.filters",(function(e,i){angular.equals(e,i)||(g.shouldFireAnalytics?(a.clickTracking&&"FilterClear"!==a.clickTracking.value&&Object.keys(e).some((function(t){if(!angular.equals(e[t],i&&i[t])){var r="",c=["amenity","brand","ratings"];if(c.pop(),r="ratings"===t?e[t]:"",c.indexOf(t)>=0)switch(r=s.diff(e[t]?e[t].split(S.URL_PARAM_DELIMITER):[],i[t]?i[t].split(S.URL_PARAM_DELIMITER):[])[0],t){case"amenity":r=(n.AMENITIES[r]||{}).name.replace(/[ ,]/g,"")||"";break;case"brand":r=(o.BRAND_NAMES[r]||"").replace(/ /g,"")}return a.clickTracking.value={priceHigh:"FilterPriceRange".concat(e.priceLow,"_").concat(e.priceHigh),priceLow:"FilterPriceRange".concat(e.priceLow,"_").concat(e.priceHigh),searchRadius:"FilterLocation".concat(e[t])}[t]||"Filter".concat(t.charAt(0).toUpperCase()+t.slice(1)).concat(r),!0}return!1})),r((function(){t.$emit(u.ANALYTICS_PAGE_LOADED,f.SEARCH_PAGE)}),1e3)):g.shouldFireAnalytics=!0)}),!0);if(y.on("preInit",A),!this.hasInitialized){this.hasInitialized=!0;var b=function(){return t.values.ratePlans.find((function(e){return e.ratePlanCode===y.params.ratePlanCode}))},P=R.getBookingHistory(),O={bookedBrands:Object.keys(P.bookedBrands).join("|"),bookedHotels:Object.keys(P.bookedHotels).join("|"),viewedBrands:Object.keys(P.viewedBrands).join("|"),viewedHotels:Object.keys(P.viewedHotels).join("|")};a.setPageDefaults({ADS_SERVED:function(){return"".concat(y.params.ratePlanCode===m.RATE_PLAN_CODES.SRD&&c.get().signedIn&&"ELIGIBLE"===c.get().pointsPlusCashAccountStatus.statusCode?d.POINTS_PLUS_CASH:null,"|").concat(y.showWoodSpringBanner&&y.woodSpringDestination.name?"WoodspringBanner":"","|").concat(y.resort.name?"VR Ad":"")},DAYS_PRIOR_TO_ARRIVAL:function(){return l.subtractDates(y.params.checkInDate,l.asString(l.getTodayDate())).toString()},DESTINATION_ENTERED:function(){return!0==!y.params.selectedFromRecentSearch&&y.params.destinationEntered&&void 0!==t.referrerState.prior?y.params.destinationEntered:" "},HOTEL_LIST_CODES:function(){return y.hotelsFiltered.map((function(e){return e.id})).join("|")},HOTEL_LIST_FULL_PRICE:function(){return y.hotelsFiltered.map((function(e){return e.priceData&&(!1===e.priceData[0].discount?"FP":e.priceData[0].discount)||"NA"})).join(" ")},HOTEL_LIST_PRICE:function(){return y.hotelsFiltered.map((function(e){return e.price||"NA"})).join("|")},HOTEL_LIST_RATE_PLAN_DESCRIPTION:function(){return y.params.rooms>=10&&d.GROUP_RATE||b()&&b().secondaryName||b()&&b().name||"NA"},HOTEL_LIST_RATE_PLANS:function(){return y.hotelsFiltered.map((function(e){return e.rateRanges&&e.rateRanges.length&&e.rateRanges[0].min&&e.rateRanges[0].min.ratePlanCode||e.ratePlanCode||"NA"})).join(" ")},LENGTH_OF_STAY:function(){return l.subtractDates(y.params.checkOutDate,y.params.checkInDate)||void 0},OCCUPANCY:function(){var e=a.formatChildAgesAnalytics(g.searchCriteria.ageOfMinors);return"".concat(y.params.rooms,":").concat(y.params.adults,"|").concat(y.params.minors).concat(e)},PAGE_NAME:function(){p.clearPreviousProperties();var e="".concat(d.PAGE_NAME.HOTEL_LIST," - ").concat(y.view," ");return y.hotels.length?e+d.VIEW:(T.value="0 ".concat(d.HOTELS_NEAR),e+d.VIEW_ERROR)},PLACENAME:function(){return y.place.placeName&&y.place.placeName.toLowerCase()||a.currentLocationObject&&a.currentLocationObject.value},RATE_PLAN_CODE:function(){return y.params.ratePlanCode},RELEVANCE_SCORE:function(){return y.hotelsFiltered.map((function(t){return e("number")(t.relevance,2)})).join("|")},RESERVATION_MULTI_SINGLE_ROOM:function(){return y.params.rooms>1?d.ROOM.MULTI:d.ROOM.SINGLE},SEARCH_AUTOSUGGEST_PLACE_TYPE:function(){return void 0===t.referrerState.prior&&"".concat(i.strings.AUTOSUGGEST_PREFIX_URL," - ").concat(y.place.placeType)||!0===y.params.selectedFromRecentSearch&&"".concat(i.strings.AUTOSUGGEST_PREFIX_RECENT_SEARCH," - ").concat(y.place.placeType)||!1===y.params.selectedFromDropDown&&"".concat(i.strings.AUTOSUGGEST_PREFIX_NOT_SELECTED," - ").concat(y.place.placeType)||!0===y.params.selectedFromDropDown&&"".concat(i.strings.AUTOSUGGEST_PREFIX_SELECTED," - ").concat(y.place.placeType)||a.currentLocationObject&&a.currentLocationObject.value&&d.CURRENT_LOCATION||" "},SEARCH_BRAND_CODE:function(){return y.filters.brand},SEARCH_CHECK_IN_DATE:function(){return y.params.checkInDate},SEARCH_COUNTRY:function(){return y.place.placeName&&y.place.placeName.replace(/.*?([A-Z]+)?$/,"$1")},SEARCH_DISTANCE:function(){return y.hotelsFiltered.map((function(t){return e("number")(t.distanceValue,2)})).join("|")},STORED_BRANDS_BOOKED:function(){return O.bookedBrands},STORED_BRANDS_VIEWED:function(){return O.viewedBrands},STORED_PROPS_BOOKED:function(){return O.bookedHotels},STORED_PROPS_VIEWED:function(){return O.viewedHotels},TRIP_TYPE:function(){return g.searchCriteria.workTravel?S.BUSINESS:""}},f.SEARCH_PAGE);var T=a.create({analyticsConst:i.ERROR_MESSAGES,events:[{name:u.ANALYTICS_PAGE_LOADED}],reset:!0,value:"",view:f.SEARCH_PAGE}).register()}},scope:{},shouldFireAnalytics:!0}}]},838:function(e,t){function r(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var n=function(){function e(t,r,n,i,a,s,o,c,l,u){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.$location=t,this.$rootScope=r,this.$scope=n,this.$window=i,this.brandConst=a,this.featureFlags=s,this.loadReact=o,this.reactHelper=c,this.strings=l,this.urlParserService=u}var t,n,i;return e.$inject=["$location","$rootScope","$scope","$window","brandConst","featureFlags","loadReact","reactHelper","strings","urlParserService"],t=e,(n=[{key:"$onInit",value:function(){var e=this;this.loadReact().then((function(){e.loadBreadcrumbs()}))}},{key:"loadBreadcrumbs",value:function(){var e=this.urlParserService.getSearchObject(this.$location.path(),this.$location.search()),t=e.brand,r=e.city,n=e.poi,i=e.stateCountry,a=this.featureFlags.EXTENDED_STAY_SERP&&-1!==this.$location.path().indexOf("/extended-stay-hotels")?this.strings.search.results.extendedStay:t&&this.brandConst.BRAND_NAMES[t]||null,s=this.$rootScope.currentPath,o=this.$window.React.createElement(this.$window.SearchBreadcrumbs,{brandName:a,city:r,poi:n,searchUrl:s,stateCountry:i}),c=this.reactHelper.generateProviderElement(o);this.reactHelper.renderToScope(c,document.getElementById("breadcrumbs"),this.$scope)}},{key:"$onDestroy",value:function(){var e=this;this.$scope.$on("$destroy",(function(){e.$window.ReactModalService&&(e.$window.ReactModalService.modals=[]);var t=document.getElementById("breadcrumbs");t&&e.$window.ReactDOM.unmountComponentAtNode(t)}))}}])&&r(t.prototype,n),i&&r(t,i),e}();e.exports={bindings:{},controller:n,template:'<div id="breadcrumbs"></div>'}},839:function(e,t){function r(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var n=function(){function e(t,r,n,i,a,s,o,c){var l,u,h,p=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),h=function(){var e=p.urlParserService.getSearchObject(p.$location.path(),p.$location.search()).poi,t=p.searchCriteriaData.get(),r=t.brand,n=t.currentLocation,i=t.placeName,a=t.placeType,s=p.city||t.city,o=p.subdivision||t.subdivision,c=p.reactHelper.generatePageId();window.store.dispatch({searchParams:{currentLocation:n,placeName:i,placeType:a},type:"UPDATE_SEARCH_PARAMS"});var l=p.$rootScope.currentPath,u=p.$window.React.createElement(p.$window.Provider,{store:p.$window.store},p.$window.React.createElement(p.$window.SearchSummary,{brand:r,city:s,isPoi:!!e,onSubmit:p.onSubmit,pageId:c,searchUrl:l,subdivision:o,updateSearchResultsParams:function(e){return p.searchResultsService&&p.searchResultsService.setPlace(e).updateSearchCriteria().setParams(e)}}));p.reactHelper.renderToScope(u,document.getElementById("react-search-summary"),p.$scope)},(u="loadSearchSummary")in(l=this)?Object.defineProperty(l,u,{value:h,enumerable:!0,configurable:!0,writable:!0}):l[u]=h,this.$location=t,this.$rootScope=r,this.$scope=n,this.$window=i,this.reactHelper=a,this.searchCriteriaData=s,this.searchResultsService=o,this.urlParserService=c}var t,n,i;return e.$inject=["$location","$rootScope","$scope","$window","reactHelper","searchCriteriaData","searchResultsService","urlParserService"],t=e,(n=[{key:"$onInit",value:function(){this.reactHelper.loadReactApp().then(this.loadSearchSummary)}},{key:"$onDestroy",value:function(){var e=this;this.$scope.$on("$destroy",(function(){e.$window.ReactModalService&&(e.$window.ReactModalService.modals=[]);var t=document.getElementById("react-search-summary");t&&e.$window.ReactDOM.unmountComponentAtNode(t)}))}}])&&r(t.prototype,n),i&&r(t,i),e}();e.exports={bindings:{city:"=",onSubmit:"=",subdivision:"="},controller:n,template:'<div id="react-search-summary"></div>'}}}]);