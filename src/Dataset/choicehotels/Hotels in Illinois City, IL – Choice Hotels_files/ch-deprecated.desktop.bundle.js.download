(window.webpackJsonp=window.webpackJsonp||[]).push([[7],Array(171).concat([function(e,t,r){var n=r(461);n.templates=n.templates.concat([{html:r(643),key:"/{ASSET_FINGERPRINT}/app/account/membership/cp-member.modal.html"},{html:r(363),key:"/{ASSET_FINGERPRINT}/shared/cug-price-tag/cug-price-tag.html"},{html:r(364),key:"/{ASSET_FINGERPRINT}/app/directives/currency-dropdown/currency-dropdown.html"},{html:r(351),key:"/{ASSET_FINGERPRINT}/app/search/modals/hotel-map.modal.html"},{html:r(365),key:"/{ASSET_FINGERPRINT}/app/directives/login-modal/login-modal.html"},{html:r(352),key:"/{ASSET_FINGERPRINT}/shared/price-cta/price-cta.html"},{html:r(644),key:"/{ASSET_FINGERPRINT}/app/promotions/promotions-form.html"},{html:r(645),key:"/{ASSET_FINGERPRINT}/app/rates-mobile/item/rate-item.html"},{html:r(353),key:"/{ASSET_FINGERPRINT}/app/search/form/search-form.html"},{html:r(366),key:"/{ASSET_FINGERPRINT}/app/search/results/search-results-item.html"}]),e.exports=n},,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,function(e,t){e.exports=["featureFlags","phoneConst",function(e,t){return{link:function(r,n,o,a){function i(t,r){return!(!e.SO_GDP_ERRORS||t)||(t||"").replace(/\D/g,"").length<=r}e.SO_GDP_ERRORS||(o.hasOwnProperty("id")&&o.id===t.BUSINESS_PHONE?a.$validators.maxlength=function(e){return i(e,t.MAX_LENGTH_BUSINESS)}:a.$validators.maxlength=function(e){return i(e,t.MAX_LENGTH_DEFAULT)},a.$validators.minlength=function(r){return!(!e.SO_GDP_ERRORS||r)||(0===(r||"").length||(r||"").replace(/\D/g,"").length>=t.MIN_LENGTH_DEFAULT)})},require:"ngModel"}}]},,,function(e,t){e.exports='<div class="modal-container hotel-map-overlay">\n  <div class="modal-header z-index-100 clearfix">\n    <div class="modal-close pull-right" ng-click="$close()">\n      <span class="ch-icon ch-icon-close"></span>\n      <span class="close-text">Close</span>\n    </div>\n  </div>\n\n  <div class="row result">\n    <div class="preview col-md-4">\n      <div class="logo-badge z-index-100">\n        <ch-brand-logo\n            brand-code="{{::pinSelected.hotel.brandCode}}"\n            country-code="{{::pinSelected.hotel.address.country}}"\n            product-code="{{::pinSelected.hotel.productCode}}"\n            ng-if="::$root.isLogoEnabled(pinSelected.hotel)"\n            size="xs"></ch-brand-logo>\n      </div>\n\n      <img ng-src="{{pinSelected.hotel | chThumbnail:$root.chConstants.search.THUMBNAIL_BASE_URL}}" itemprop="image"\n           ch-image-error class="thumbnail-image img-responsive"\n           ng-if="!imageStatus.error" alt="{{::pinSelected.hotel.name}} {{::$root.strings.hotel.summaryHotel}}"\n           title="{{::pinSelected.hotel.name}} {{::$root.strings.hotel.summaryHotel}}">\n      <div ng-include="\'/\' + assetFingerprint + \'/shared/image-fallback.html\'"\n           ng-if="imageStatus.error" include-replace></div>\n\n      <ch-birg-logo ng-if="!$root.featureFlags.AMR_MASTER || !hotelHelper || !hotelHelper.shouldHideLPG(pinSelected && pinSelected.hotel)" logo-width="290"></ch-birg-logo>\n    </div>\n\n    <div class="info col-md-4">\n      <h6 ng-click="$close()">\n        <a ng-href="{{getPropertyPageUrl(pinSelected.hotel)}}">{{pinSelected.hotel.name}}</a>\n      </h6>\n\n      <div class="address" ng-bind-html="pinSelected.hotel.address | chAddress"></div>\n\n      <div class="proximity">\n        <ch-distance-switch-display distance-value="pinSelected.hotel.distanceValue"></ch-distance-switch-display>\n      </div>\n\n      <div ng-click="$close()">\n        <ch-ratings model="pinSelected.hotel.rating" hotel-url="getPropertyPageUrl(pinSelected.hotel)"></ch-ratings>\n      </div>\n\n      <div class="amenities" ng-show="pinSelected.hotel.amenityGroups.length > 0">\n        <strong>{{::$root.strings.hotel.mapFeaturedAmenities}}:</strong>\n        <span>{{pinSelected.hotel.amenityGroups | chAmenities:3:true}}</span>\n      </div>\n    </div>\n\n    <div class="cta col-md-4 text-uppercase">\n      <ch-price-cta cta-url="::pinSelected.ctaUrl" hotel="pinSelected.hotel" hotel-action="::pinSelected.hotelAction" map-view="true">\n        {{pinSelected.hotelAction === $root.chConstants.search.HOTEL_ACTION.GET_QUOTE ? pinSelected.ctaText : $root.strings.general.checkAvailability}}\n      </ch-price-cta>\n    </div>\n  </div>\n</div>\n'},,,,,,,,function(e,t){e.exports=function(){return{link:function(e,t,r){e.$watch(r.thumbnailScroll,(function(e){if(e){var r=t[0],n=r.parentNode,o=r.offsetLeft,a=o+r.offsetWidth,i=n.offsetWidth,s=n.scrollLeft,c=s;o<s?c=o:a>s+i&&(c=a-i-n.offsetLeft),c<0&&(c=0),n.scrollLeft!==c&&(n.scrollLeft=c)}}))},restrict:"A"}}},function(e,t){e.exports=["$anchorScroll","$location",function(e,t){return{link:function(r,n,o){if(t.hash()){var a=o.scrollOffset,i=void 0===a?0:a;e.yOffset=parseInt(i,10),e()}},restrict:"A"}}]},function(e,t){e.exports=["$http","$q","$timeout","patternsConst","strings",function(e,t,r,n,o){var a=0;return{tokenizeCreditCard:function i(s,c){var l=t.defer();return function(r,o){var a=t.defer();function i(e){a.reject(e)}function s(e){a.resolve(e)}!function(e){return n.ccTokenOrMask.test(e)}(r)?e.get("/webapi/token/metadata",{cache:!1}).then((function(t){(function(t,r,n){var o={creditCardNumber:t,expiryDate:r,keyAlias:n.keyAlias,requestTimeStamp:n.timeStamp,signature:n.signature};return e.post("/hotel-pt",o,{headers:{Accept:"application/json","Content-Type":"application/json; charset=UTF-8"}}).then((function(e){return e.data.data}))})(r,o,t.data).then(s).catch(i)})).catch(i):a.resolve(r);return a.promise}(s,c).then((function(e){return l.resolve(e)})).catch((function(e){r((function(){var t=e.data.faults,r=t&&"invalid parameter"===t[0].message&&"creditCardNumber"===t[0].propertyPath;a<2&&!r?(a++,i(s,c).then((function(e){return l.resolve(e)})).catch((function(e){return l.reject(e)}))):(a=0,(t=t||{}).message=o.general.errors.serverConnectionError,e.data={faults:t},l.reject(e))}),500)})),l.promise}}}]},function(e,t){e.exports=["$location","$q","$stateParams","deviceConst","featureFlags","groupService","hotelService","reasonConst","searchConst","siteConfig","routeConst",function(e,t,r,n,o,a,i,s,c,l,u){var d;if(r.groupCode)d=r.groupCode.toUpperCase();else{var p=e.path().split("/"),m=p.indexOf("groups");d=p[++m].toUpperCase()}return a.getGroup(d).then((function(r){function a(t){return r.hotel=t,r.pickupUrl=e.path(),r}function s(e){return t.reject(e)}return o.RATES_PAGE_PERFORMANCE_OPTIMIZATION&&l.deviceType===n.DESKTOP?i.getHotelV2(r.hotelId,c.HOTELV2_GROUP_PARAMS.include).then(a,s):i.getHotel(r.hotelId,"rating,amenities,relative_media,cms,payment_forms").then(a,s)}),(function(e){return e.reason=s.GROUP_NOT_FOUND,e.outputErrors&&(e.outputErrors.GROUP_IS_IN_THE_PAST?e.reason=s.GROUP_IS_IN_THE_PAST:e.outputErrors.GROUP_HAS_BEEN_CANCELLED?e.reason=s.GROUP_HAS_BEEN_CANCELLED:e.outputErrors.GROUP_HAS_NO_ROOMS&&(e.reason=s.GROUP_HAS_NO_ROOMS)),e.redirectLocation=u.GROUPS_LANDING_PATH,t.reject(e)}))}]},function(e,t){e.exports='<div class="cug-price-tag text-left" ng-class="{\'small-size\': cugPriceTag.smallSize}"\n     uib-popover-template="::cugPriceTag.tooltipTemplateUrl"\n     popover-placement="{{!cugPriceTag.disableTooltip ? cugPriceTag.getTooltipPlacement() : \'\'}}"\n     popover-trigger="none"\n     popover-is-open="cugPriceTag.tooltipOpen">\n  <div class="cug-body">\n    <ch-price-tag\n        is-amr-property="cugPriceTag.isAmrProperty"\n        class="discount-price-tag"\n        discount="cugPriceTag.price.discount"\n        currency="cugPriceTag.price.currency"></ch-price-tag>\n    <ch-price-tag\n        is-amr-property="cugPriceTag.isAmrProperty"\n        class="price-tag"\n        cash="cugPriceTag.price.cash"\n        currency="cugPriceTag.price.currency"\n        reduced="true"></ch-price-tag>\n\n    <div>\n      <small class="strong cug-from text-uppercase">{{::$root.strings.search.item.perNight}}</small>\n    </div>\n  </div>\n</div>\n'},function(e,t){e.exports='<span uib-dropdown class="dropdown">\n  <button\n    uib-dropdown-toggle\n    class="btn-reset dropdown-toggle"\n    ng-click="checkRatePlan($event)"\n    so-omniture-click-tracking\n    ng-attr-id="SelectCurrency_{{defaultCurrency.code}}">\n    <span\n      class="text-no-transform fs-12 text-semibold"\n    >{{::strings.propertyRates.changeCurrencyNormal}}</span>\n    <span class=\'ch-icon ch-icon-chevron-down\'></span>\n  </button>\n  <ul uib-dropdown-menu class="dropdown-menu currency-dropdown">\n    <li ng-if="featureFlags.SO_CURRENCY_ORDER">\n      <a class="hotelDefaultCurrency" href="" ng-click="updateCurrency($root.hotelDefaultCurrency)"\n        so-omniture-click-tracking ng-attr-id="SelectCurrency_{{$root.hotelDefaultCurrency.code}}">\n        {{::strings.propertyRates.hotelDefaultCurrencyLabel}}\n      </a>\n    </li>\n    <li ng-if="featureFlags.SO_CURRENCY_ORDER" ng-repeat="topCurrency in top5Currencies">\n      <a href="" ng-click="updateCurrency(topCurrency)" ng-if="topCurrency.code !== \'CP_POINTS\'"\n        so-omniture-click-tracking ng-attr-id="SelectCurrency_{{topCurrency.code}}">\n        {{::topCurrency.description}}\n      </a>\n    </li>\n    <li ng-if="featureFlags.SO_CURRENCY_ORDER" ng-repeat="currency in currencies | toArray:false | orderBy:\'description\'">\n      <a href="" ng-click="updateCurrency(currency)" ng-if="currency.code !== \'CP_POINTS\' && currency.code != \'USD\' && \n      currency.code != \'CAD\' && currency.code != \'AUD\' && currency.code != \'EUR\' && currency.code != \'GBP\'"\n        so-omniture-click-tracking ng-attr-id="SelectCurrency_{{currency.code}}">\n        {{::currency.description}}\n      </a>\n    </li>\n    <li ng-if="!featureFlags.SO_CURRENCY_ORDER" ng-repeat="currency in currencies">\n      <a href="" ng-click="updateCurrency(currency)" ng-if="currency.code !== \'CP_POINTS\'"\n        so-omniture-click-tracking ng-attr-id="SelectCurrency_{{currency.code}}">\n        {{::currency.description}}\n      </a>\n    </li>\n  </ul>\n</span>\n'},function(e,t){e.exports='<div ng-if="opensOnLoad" ng-init="openModal()"></div>\n<a ng-if="isDirectLink" href=""\n   class="cp-switch nowrap text-no-transform selected text-semibold fs-12"\n   ng-click="openModal()"\n>{{::loginText}}</a>\n<button ng-if="isAButton" class="btn-cta cta-primary text-uppercase nowrap" ng-click="openModal()">{{::loginText}}</button>\n<div ng-transclude></div>\n'},function(e,t){e.exports='<div\n    class="row result"\n    data-seleniumid="result-{{::hotel.id | lowercase}}"\n    itemscope="itemscope"\n    itemtype="http://schema.org/Hotel"\n    ng-click="selectHotel(hotel.id, hotel.lat, hotel.lon)"\n    ng-mouseover="selectHotel(hotel.id, hotel.lat, hotel.lon)">\n\n  <h3 class="sr-only">\n    <a\n        data-seleniumid="propertyPageLink"\n        ng-href="{{::getPropertyPageUrl(hotel)}}">\n      {{::hotel.name}}\n    </a>\n  </h3>\n\n  <div\n      ch-gallery-lightbox\n      gallery-title="{{::hotel.name}}"\n      high-res="::hotel.highRes"\n      hotel-city="{{::hotel.address.city}}"\n      hotel-subdivision="{{::hotel.address.subdivision}}"\n      hotel-country="{{::hotel.address.country}}"\n      image-collection="::hotel.images"\n      ng-init="hasGallery = hotel.images.length > 1;"\n      page-tracking="{{pageTracking}}"\n      product-code="{{::hotel.productCode}}"\n      class="preview col-sm-4 col-md-3">\n    <div ng-include="\'/\' + $root.assetFingerprint + \'/app/search/results/includes/search-results-item-gallery.html\'"></div>\n  </div>\n\n  <div\n      class="info col-sm-4"\n      ng-class="{\n        \'col-md-6\': !splitView,\n        \'col-md-5\': splitView\n      }">\n    <div ng-include="\'/\' + $root.assetFingerprint + \'/app/search/results/includes/search-results-item-info.html\'"></div>\n  </div>\n\n  <div\n      class="cta col-sm-4 cta pull-right text-uppercase"\n      ng-class="{\'col-md-3\': !splitView}">\n    <ch-price-cta\n      is-amr-property="isAmrProperty"\n      cug-discount="::cugDiscount"\n      cta-url="::ctaUrl"\n      hotel-action="::hotelAction"\n      hotel="hotel"\n      price-type="priceType"\n      search-params="searchParams"\n      small-size="splitView"\n      tracking-id="searchResultsClickTracking + index">\n      {{::ctaText}}\n    </ch-price-cta>\n  </div>\n  <div\n    tabindex="0"\n    ng-if="showSrdMaxOccupancyWarning && featureFlags.AMR_MASTER"\n    ng-class="{\n      \'split-view\': splitView,\n      \'show-warning\': shouldShowGuestWarning\n    }"\n    class="srd-occupancy-warning">\n    <span class="srd-occupancy-message text-semibold fs-14">\n      <span class="ch-icon ch-icon-error fs-16 icon"></span>\n      {{::$root.strings.general.srdMaxOccupancyWarning}}\n    </span>\n  </div>\n</div>\n'},,,,,,,,,,,,,,,,,,,function(e,t){e.exports=["$scope","$rootScope","promotionsService","pagesConst","formHelper","globalLoaderCounter","$location","contentService","loyaltyAccountHelper","$anchorScroll",function(e,t,r,n,o,a,i,s,c,l){function u(t,r){t?s.getHTMLFragment(t,"module","en").then((function(t){e.bladeContent=t})):r&&i.path(r)}function d(t){a.inc(),t.email||delete t.email,r.subscribePromotion(t).then((function(t){e.response=t,e.responseMessage=t.outputErrors,u(e.replaceFormBladeUrl,e.successPageUrl)})).catch((function(t){e.response=t,e.responseMessage=t.outputErrors||t.inputErrors,u(e.replaceFormBladeErrorUrl,e.errorPageUrl)})).finally(a.dec)}this.autoRegistration=function(){var t=angular.copy(i.search());t.number&&t.first_name&&t.last_name&&(d({firstName:t.first_name,lastName:t.last_name,loyaltyAccountNumber:c.getAccountNumber(t.number),loyaltyProgramId:c.getProgramId(t.number),offerId:e.promotionId}),e.replaceFormBladeUrl&&(i.hash("promotionForm"),l()))},e.subscribePromotionLoggedUser=function(){d({email:t.cpUser.email,firstName:t.cpUser.firstName,lastName:t.cpUser.lastName,loyaltyAccountNumber:t.cpUser.loyaltyAccount.loyaltyAccountNumber,loyaltyProgramId:t.cpUser.loyaltyAccount.loyaltyProgramId,offerId:e.promotionId})},e.messageFilter=function(e,t){return o.errorFilter(e,t)},e.subscribeWithLogin=function(t){var n=t.password,o=t.username;if(t.$setValidity("service",!0),t.$valid){var i={password:n.$modelValue,username:o.$modelValue};a.inc(),r.promotionLogin(i).then((function(r){t.$setPristine(),d({email:r.email,firstName:r.firstName,lastName:r.lastName,loyaltyAccountNumber:r.loyaltyAccount.loyaltyAccountNumber,loyaltyProgramId:r.loyaltyAccount.loyaltyProgramId,offerId:e.promotionId})})).catch((function(){t.$setValidity("service",!1)})).finally(a.dec)}},e.subscribeWithRegister=function(t){if(t.$valid){var r=t.firstName,n=t.lastName,o=t.email,a=t.privilegesNumber.$viewValue;d({email:o.$modelValue,firstName:r.$modelValue,lastName:n.$modelValue,loyaltyAccountNumber:c.getAccountNumber(a),loyaltyProgramId:c.getProgramId(a),offerId:e.promotionId})}},e.response=null,e.loyaltyProgramId=0,e.loyaltyAccountNumber=0,e.firstName="",e.lastName="",e.email="",e.bladeContent=""}]},,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,function(e,t,r){e.exports={module:angular.module("chApp.deprecated",[r(462).name,r(529).name,r(532).name,r(543).name,r(546).name,r(551).name,r(553).name,r(561).name,r(382).name,r(383).name,r(628).name,r(631).name,r(634).name]),run:["resolverService",function(e){e.add("cpRedeemOptionsResolver",r(635)).add("cpRedeemResolver",r(636)).add("cpUserInitializedResolver",r(342)).add("cpUserResolver",r(637)).add("failResolver",r(638)).add("groupPickupResolver",r(362)).add("hotelStartingRatesResolver",r(15)).add("modifyUnsubscribeResolver",r(639))}],templates:[{html:r(341),key:"/{ASSET_FINGERPRINT}/app/bootstrap-ui/search-calendar/ch-calendar-popup.html"},{html:r(343),key:"/{ASSET_FINGERPRINT}/app/directives/plus-minus-dropdown/plus-minus-dropdown.html"},{html:r(344),key:"/{ASSET_FINGERPRINT}/app/search/form/rateplan-dropdown.html"},{html:r(640),key:"/{ASSET_FINGERPRINT}/app/directives/read-more/read-more.html"},{html:r(641),key:"/{ASSET_FINGERPRINT}/app/groups/scalable-circle.html"},{html:r(642),key:"/{ASSET_FINGERPRINT}/app/directives/user-member-status/user-member-status.html"}]}},function(e,t,r){e.exports=angular.module("chApp.account",[r(463).name,r(476).name,r(478).name,r(480).name,r(482).name,r(486).name,r(489).name,r(494).name,r(496).name,r(506).name,r(523).name,r(525).name])},function(e,t,r){e.exports=angular.module("chApp.account.editProfile",[]).controller("CPEditProfilePageCtrl",r(464)).directive("chEditAaaMembership",r(465)).directive("chEditCommunicationPreferences",r(466)).directive("chEditCompanyInformation",r(467)).directive("chEditCreditCard",r(468)).directive("chEditLogin",r(469)).directive("chEditLoyaltyPartners",r(470)).directive("chEditPersonalInformation",r(471)).directive("chEditProfileControls",r(472)).directive("chEditRoomPreferences",r(473)).directive("chEditYourExtras",r(474)).service("editProfileAnalytics",r(475))},function(e,t){e.exports=["$anchorScroll","$document","$location","$rootScope","$scope","$timeout","$window","clientFileService","contentService","countryDataUtils","cpUserData","editProfileAnalytics","eventsConst","featureFlags","globalLoaderCounter","guestInfoConst","loyaltyAccountHelper","loyaltyConst","membershipConstant","objectHelper","pagesConst","profileHelper","scrollHelper","siteConfig","strings","userHelper","userService","values","yourExtrasConst",function(e,t,r,n,o,a,i,s,c,l,u,d,p,m,g,f,h,E,v,y,C,P,A,b,R,S,I,T,O){var N;o.loadPrivacyPreferenceLabels=m.PRIVACY_PREFERENCE_NON_OPT?R.account.memberFormPrivacyByCountryNonOpt:R.cp.memberFormPrivacyByCountry,o.memberFormPrivacyByCountry=m.PRIVACY_PREFERENCE_NON_OPT?v.memberFormPrivacyByCountryNonOpt:v.memberFormPrivacyByCountry;var _=function(){N=a((function(){I.logout()}),b.profileSessionTimeout)};function D(){var e=angular.copy(u.get());o.cpMemberDraft||(o.cpMemberDraft={}),delete o.cpMemberDraft.creditCardType,delete o.cpMemberDraft.creditCardNumber,delete o.cpMemberDraft.creditCardName,delete o.cpMemberDraft.expirationMonth,delete o.cpMemberDraft.expirationYear,y.deepExtend(o.cpMemberDraft,e),function(e){o.cpMemberDraft&&o.cpMemberDraft.aaaNumber&&(o.cpMemberDraft.aaaNumber=e.aaaNumber||void 0)}(e),function(e){o.cpMemberDraft&&o.cpMemberDraft.choicePrivilegesLanguagePreference&&(o.cpMemberDraft.choicePrivilegesLanguagePreference=e.choicePrivilegesLanguagePreference||void 0)}(e),function(){o.cpMemberDraft.isMobileNumber=!(!o.cpMemberDraft.mobilePhones||!o.cpMemberDraft.mobilePhones[0]),o.cpMemberDraft.isMobileNumber&&angular.extend(o.cpMemberDraft,{homePhone:o.cpMemberDraft.mobilePhones[0].number,mobilePhone:o.cpMemberDraft.mobilePhones[0].number});m.GDC_UPDATE_PROFILE&&(o.privacyMobilePreferences||(o.privacyMobilePreferences={}),y.clear(o.privacyMobilePreferences),v.cpMemberFormPrivacyMobilePreferences.forEach((function(e){o.privacyMobilePreferences[e.id]=!!o.cpMemberDraft.isMobileNumber&&o.cpMemberDraft.mobilePhones[0].preferences[e.id],o.showSMSMobileOptionsTitle=!!o.cpMemberDraft.mobilePhones&&(o.showSMSMobileOptionsTitle||o.cpMemberDraft.mobilePhones[0].preferences[e.id])})))}(),function(e){o.cpMemberDraft&&o.cpMemberDraft.yourExtrasPreference&&(o.cpMemberDraft.yourExtrasPreference=e.yourExtrasPreference||void 0);o.isCPAccount=h.checkCPAccount(o.cpMemberDraft),o.cpMemberDraft.cpLoyaltyAccountNumber&&o.cpMemberDraft.cpLoyaltyProgramId&&I.getUserYourExtrasOptions().then((function(e){o.yourExtrasOptions=e}))}(e)}function M(e){var t=S.getUpdateUserRequestBody(u.get(),e);return o.submitErrors=[],I.editUser(t).then(k).catch(L).finally((function(){g.dec(),_()}))}function k(){o.membershipUpdated=!0,i.scrollTo(0,0),o.checkMissingRequiredFields(),o.toggleEditMode("",null,"saveBTN");var e,t=(e=l.getPrivacyPreferenceGroupWithCountries(o.cpMemberDraft.address.country,o.values.countries),o.memberFormPrivacyByCountry[e].options);P.setEmailOption(o.cpMemberDraft,t)}function L(e){var t=o.editMode?".".concat(o.editMode,".error"):"",r=C.EDIT_PROFILE+t;!function(e){o.submitErrors=[],o.inputErrors=!0,angular.forEach(e.data.inputErrors,(function(e,t){(o.cpForm[t]||{}).$setValidity?(o.cpForm[t].$setValidity(t,!1),o.guestInfoErrors[t]=e):o.submitErrors.push(e)}))}(e),S.verifyAkamaiResponse(e,o),angular.forEach(e.data.outputErrors,(function(e){-1===o.submitErrors.indexOf(e)&&o.submitErrors.push(e)})),o.emitSavingErrors(o.submitErrors,r),A.scrollToFirstError()}function w(t,n){o.editMode="personal",o.missingFields.push(n),o.cpForm&&(o.cpForm[t]||{}).$setValidity&&(o.cpForm[t].$setDirty(),o.cpForm[t].$setTouched(),o.guestInfoErrors[t]=n),m.PARTNER_HUB&&function(t){o.missingPartnerHubField===t?(r.hash(t),e()):delete o.missingPartnerHubField}(t)}function $(e){return E.PROGRAMS.find((function(t){return t.id===e}))}o.editUser=function(e){return a.cancel(N),g.inc(),e.clientId?function(e){var t=e;return s.getClientFile(e.clientId).then((function(){M(t)})).catch((function(e){L(e),g.dec(),_()}))}(e):M(e)},o.toggleEditMode=function(e,t,r){t||D(),e===O.optionId.airline||e===O.optionId.fuel||"yourExtrasOptions"===e?o.isEditing=!0:o.isEditing=!o.isEditing,function(){o.cpForm.confirmPassword&&o.cpForm.confirmPassword.$validate();o.cpForm.$setPristine(!0),o.submitErrors=[]}(),o.editMode=e===o.editMode?"":e,n.$emit("toggleEditMode"),o.emitToggleEvents(e,r)},o.cancelEditMode=function(){o.editMode="",o.isEditing=!1,D(),o.emitToggleEvents("","cancelBTN")},o.checkMissingRequiredFields=function(){o.missingFields=[],angular.forEach(f.REQUIRED_USER_FIELDS,(function(e,t){o.cpMemberDraft[t]||w(t,e)})),angular.forEach(f.REQUIRED_ADDRESS_FIELDS,(function(e,t){o.cpMemberDraft.address[t]||w(t,e)}))},o.getLoyaltyProgramName=function(e){return($(e)||{}).name},o.isInternalProgram=function(e){return!!$(e).internal},o.$on("$destroy",(function(){a.cancel(N)})),o.isEditing=!1,angular.extend(o,{editMode:"",guestInfoErrors:{},missingFields:[],showSMSMobileOptionsTitle:void 0,values:T}),D(),d.init(o),c.getHTMLFragment("choice-hotels/edit-profile","dynamicPages").then((function(e){o.cmsContent=e,n.$emit(p.ANALYTICS_PAGE_LOADED,C.EDIT_PROFILE)})),o.yourExtrasConst=O,_(),n.$emit(p.PAGE_LOADED)}]},function(e,t){var r=["$scope","formHelper",function(e,t){e.submit=function(){e.editUser({aaaNumber:e.cpMemberDraft.aaaNumber})},e.toggleAaaEditMode=function(r){delete e.cpMemberDraft.aaaNumber,e.toggleEditMode(r),t.clearError("aaaNumber",e.cpForm.aaaNumber)}}];e.exports=["siteConfig",function(e){return{controller:r,restrict:"E",scope:!0,templateUrl:"/".concat(e.assetFingerprint,"/app/account/edit-profile/edit-aaa-membership/edit-aaa-membership.html")}}]},function(e,t){var r=["$scope","countryDataUtils","guestInfoHelper","membershipConstant","profileHelper",function(e,t,r,n,o){e.toggleCommunicationPreferencesEditMode=function(t){e.toggleEditMode(t),o.setEmailOption(e.cpMemberDraft,e.emailPreferences)},e.setCommunicationPreferences=function(e,t,r){o.setCommunicationPreferences(e,t,r)},e.submit=function(){var t=e.emailPreferences.reduce((function(t,r){return t[r.id]=e.cpMemberDraft[r.id],t}),{});t.choicePrivilegesLanguagePreference=e.cpMemberDraft.choicePrivilegesLanguagePreference,e.showSMSMobileOptionsTitle=!1;var r=e.cpMemberDraft.isMobileNumber&&"US"===e.cpMemberDraft.address.country;n.cpMemberFormPrivacyMobilePreferences.forEach((function(n){t[n.id]=!!r&&e.privacyMobilePreferences[n.id],e.showSMSMobileOptionsTitle=e.showSMSMobileOptionsTitle||t[n.id]})),e.editUser(t)},e.privacyPreferenceGroup=t.getPrivacyPreferenceGroupWithCountries(e.cpMemberDraft.address.country,e.values.countries),e.emailPreferences=e.memberFormPrivacyByCountry[e.privacyPreferenceGroup].options,e.languages=r.getLangOptions(),o.setEmailOption(e.cpMemberDraft,e.emailPreferences),e.cpMemberFormPrivacyMobilePreferences=n.cpMemberFormPrivacyMobilePreferences}];e.exports=["siteConfig",function(e){return{controller:r,restrict:"E",scope:!0,templateUrl:"/".concat(e.assetFingerprint,"/app/account/edit-profile/edit-communication-preferences/edit-communication-preferences.html")}}]},function(e,t){var r=["$scope",function(e){e.submit=function(){e.$parent.cpForm.$valid&&e.editUser({clientId:e.cpMemberDraft.clientId,companyName:e.cpMemberDraft.companyName})},e.toggleCompanyInformationEditMode=function(t){e.cpMemberDraft.companyName="",e.cpMemberDraft.clientId="",e.toggleEditMode(t)}}];e.exports=["siteConfig",function(e){return{controller:r,restrict:"E",scope:!0,templateUrl:"/".concat(e.assetFingerprint,"/app/account/edit-profile/edit-company-information/edit-company-information.html")}}]},function(e,t){var r=["$scope","$rootScope","globalLoaderCounter","tokenizationService","dateHelper",function(e,t,r,n,o){function a(){angular.extend(e,{creditCardLastFour:(e.cpMemberDraft.creditCardNumber||"").substr(-4),creditCardType:e.cpMemberDraft.creditCardType,profileContainsCreditCard:!!e.cpMemberDraft.creditCardNumber})}function i(t){e.editUser(t).then((function(){a()}))}e.removeCreditCard=function(){angular.extend(e.cpMemberDraft,{creditCardName:"",creditCardNumber:"",creditCardType:"",expirationMonth:"",expirationYear:"",tokenKeyAlias:"",tokenResponseSignature:"",tokenResponseTimeStamp:""}),this.submit()},e.submit=function(){if(e.$parent.cpForm.$valid){var t={creditCardName:e.cpMemberDraft.creditCardName,creditCardNumber:e.cpMemberDraft.creditCardNumber,creditCardType:e.cpMemberDraft.creditCardType,creditCardUseForReservations:!0,expirationMonth:e.cpMemberDraft.expirationMonth,expirationYear:e.cpMemberDraft.expirationYear};t.creditCardNumber?function(e){var t=o.getCreditCardExpirationString(e.expirationMonth,e.expirationYear);return r.inc(),n.tokenizeCreditCard(e.creditCardNumber,t).then((function(t){angular.extend(e,{creditCardNumber:t.token||e.creditCardNumber,tokenKeyAlias:t.keyAlias,tokenResponseSignature:t.responseSignature,tokenResponseTimeStamp:t.responseTimeStamp})})).finally(r.dec)}(t).finally(i.bind(null,t)):i(t)}},function(){a(),e.acceptedPaymentCards=Object.keys(t.strings.general.creditCards).map((function(e){return{code:e,name:t.strings.general.creditCards[e]}}));var r=t.$on("toggleEditMode",a);e.$on("$destroy",r)}()}];e.exports=["siteConfig",function(e){return{controller:r,restrict:"E",scope:!0,templateUrl:"/".concat(e.assetFingerprint,"/app/account/edit-profile/edit-credit-card/edit-credit-card.html")}}]},function(e,t){var r=["$scope",function(e){function t(){angular.extend(e.cpMemberDraft,{confirmPassword:"",password:""})}e.submit=function(){e.$parent.cpForm.$valid&&e.editUser({confirmPassword:e.cpMemberDraft.confirmPassword,password:e.cpMemberDraft.password}).then(t)},e.toggleLoginEditMode=function(r){t(),e.toggleEditMode(r)}}];e.exports=["siteConfig",function(e){return{controller:r,restrict:"E",scope:!0,templateUrl:"/".concat(e.assetFingerprint,"/app/account/edit-profile/edit-login/edit-login.html")}}]},function(e,t){var r=["$scope","loyaltyConst","profileHelper",function(e,t,r){function n(){e.cpMemberDraft.loyaltyAccounts||(e.cpMemberDraft.loyaltyAccounts=[]);var r=e.cpMemberDraft.loyaltyAccounts.map((function(e){return e.loyaltyProgramId}));e.inactiveLoyaltyPrograms=t.PROGRAMS.filter((function(e){return!e.internal&&-1===r.indexOf(e.id)})).sort((function(e,t){return e.name.localeCompare(t.name)}))}function o(e){return t.PROGRAMS.find((function(t){return t.id===e}))||{}}e.addLoyaltyProgram=function(t){e.addedLoyaltyProgram=!0,e.status.isOpen=!1,e.cpMemberDraft.loyaltyAccounts.push({loyaltyProgramId:t.id}),1===e.cpMemberDraft.loyaltyAccounts.length&&e.selectLoyaltyProgram(e.cpMemberDraft.loyaltyAccounts[0]),n()},e.removeLoyaltyProgram=function(t){var r=e.cpMemberDraft.loyaltyAccounts.indexOf(t);e.cpMemberDraft.loyaltyAccounts.splice(r,1),e.cpMemberDraft.loyaltyProgramId===t.loyaltyProgramId&&(e.cpMemberDraft.loyaltyAccounts.length>0?e.selectLoyaltyProgram(e.cpMemberDraft.loyaltyAccounts[0]):(e.cpMemberDraft.loyaltyProgramId="",e.cpMemberDraft.loyaltyAccountNumber="")),(e.submitErrors||[]).forEach((function(){e.submitErrors.splice(0,1)})),n()},e.selectLoyaltyProgram=function(t){angular.extend(e.cpMemberDraft,{loyaltyAccountNumber:t.loyaltyAccountNumber,loyaltyProgramId:t.loyaltyProgramId})},e.getLoyaltyProgramName=function(e){return o(e).name},e.isInternalProgram=function(e){return!!o(e).internal},e.toggleLoyaltyEditMode=function(t){e.toggleEditMode(t),n()},e.submit=function(){var t=r.getLoyaltyAccountMap(e.cpMemberDraft.loyaltyAccounts),n={loyaltyAccounts:angular.toJson(t),preferredLoyaltyAccountNumber:t[e.cpMemberDraft.loyaltyProgramId]||"",preferredLoyaltyProgramId:e.cpMemberDraft.loyaltyProgramId};e.editUser(n)},e.status={isOpen:!1},n()}];e.exports=["siteConfig",function(e){return{controller:r,restrict:"E",scope:!0,templateUrl:"/".concat(e.assetFingerprint,"/app/account/edit-profile/edit-loyalty-partners/edit-loyalty-partners.html")}}]},function(e,t){var r=["$scope","featureFlags",function(e,t){e.submit=function(){if(e.$parent.cpForm.$valid){var r={address1:e.cpMemberDraft.address.line1,address2:e.cpMemberDraft.address.line2||void 0,address3:e.cpMemberDraft.address.line3||void 0,businessPhone:e.cpMemberDraft.businessPhone,city:e.cpMemberDraft.address.city,country:e.cpMemberDraft.address.country,county:e.cpMemberDraft.address.county,email:e.cpMemberDraft.email,homePhone:e.cpMemberDraft.homePhone,isMobileNumber:e.cpMemberDraft.isMobileNumber,postalCode:e.cpMemberDraft.address.postalCode,subdivision:e.cpMemberDraft.address.subdivision};t.GDC_UPDATE_PROFILE&&(r.isMobileNumber?(r.mobilePhone=r.homePhone,e.cpMemberDraft.mobilePhones||(r.sendReservationSMS=!0)):(delete e.cpMemberDraft.mobilePhones,r.mobilePhone="")),e.editUser(r)}},e.$watch("cpMemberDraft.address.country",(function(t){e.cpForm.postalCode&&(e.cpForm.postalCode.$setDirty(),e.cpForm.postalCode.$validate()),e.isUS="US"===t}))}];e.exports=["siteConfig",function(e){return{controller:r,restrict:"E",scope:!0,templateUrl:"/".concat(e.assetFingerprint,"/app/account/edit-profile/edit-personal-information/edit-personal-information.html")}}]},function(e,t){e.exports=["siteConfig",function(e){return{replace:!0,restrict:"E",scope:{cancelButtonToggle:"&",cancelButtonTrackingId:"=",cancelEditMode:"&?",cpForm:"=",editId:"@",editLabel:"=",editMode:"=",editSeleniumId:"@",saveButtonTrackingId:"=",saveDescribedBy:"@?",saveId:"@?",saveSeleniumId:"@",section:"@",submitEdit:"&",submitErrors:"=",toggleEditMode:"&",trackingId:"="},templateUrl:"/".concat(e.assetFingerprint,"/app/account/edit-profile/edit-profile-controls/edit-profile-controls.html")}}]},function(e,t){var r=["$scope","bedConst","objectHelper","strings",function(e,t,r,n){var o=t.BED_PREFERENCES;e.submit=function(){e.editUser({bedPreference:e.cpMemberDraft.bedPreference,numberOfBedsPreference:e.cpMemberDraft.numberOfBedsPreference,smokingPreference:e.cpMemberDraft.smokingPreference?"true":"false"})},e.setBedPreferenceCode=function(t){angular.extend(e.cpMemberDraft,{bedPreference:o[t].params.type,bedPreferenceCode:t,numberOfBedsPreference:o[t].params.rooms})},e.getBedPreferenceCode=function(e,t){return e?"".concat(t,"_").concat(e):"NO_PREFERENCE"},e.getPropertyByString=function(e){return r.getPropertyByString(n,e)},e.getBedPreferenceName=function(t){return e.getPropertyByString(o[t].name)}}];e.exports=["siteConfig",function(e){return{controller:r,restrict:"E",scope:!0,templateUrl:"/".concat(e.assetFingerprint,"/app/account/edit-profile/edit-room-preferences/edit-room-preferences.html")}}]},function(e,t){var r=["$document","$sce","$scope","featureFlags","loyaltyConst","strings","yourExtrasConst",function(e,t,r,n,o,a,i){var s,c;r.select=function(e){r.setYourExtrasPreference(e.optionId,e.optionId),e.optionId===i.optionId.airline&&r.setYourExtrasAirlineOptions()},r.selectAirlineRewards=function(){angular.extend(c,{yourExtrasPreference:i.optionId.airline,yourExtrasThirdPartyAccountNumber:r.cpMemberDraft.yourExtrasAirlineAccountNumber}),r.toggleEditMode("yourExtrasOptions",!0),r.cpMemberDraft.yourExtrasPreference=i.optionId.airline},r.selectFuelRewards=function(){r.cpMemberDraft.yourExtrasFuelRewardsOption?angular.extend(c,{yourExtrasFuelRewardsEmail:r.cpMemberDraft.email,yourExtrasPreference:i.optionId.fuel,yourExtrasThirdPartyAccountNumber:""}):angular.extend(c,{yourExtrasFuelRewardsEmail:r.cpMemberDraft.yourExtrasFuelRewardsEmail,yourExtrasPreference:i.optionId.fuel,yourExtrasThirdPartyAccountNumber:r.cpMemberDraft.yourExtrasFuelRewardsEmail}),r.toggleEditMode("yourExtrasOptions",!0),r.cpMemberDraft.yourExtrasPreference=i.optionId.fuel},r.setYourExtrasAirlineOptions=function(){delete r.cpMemberDraft.yourExtrasAirlineAccountNumber,delete r.cpMemberDraft.yourExtrasFuelRewardsOption,r.cpMemberDraft.yourExtrasAirlineOptions=[],r.cpMemberDraft.loyaltyAccounts.forEach((function(e){var t=o.PROGRAMS.find((function(t){return t.id===e.loyaltyProgramId}))||{};e.name=t.name,e.name===a.yourExtras.airlineFilterOption||"SW"===e.loyaltyProgramId&&n.SOUTHWEST_HIDE||r.cpMemberDraft.yourExtrasAirlineOptions.push(e),e.loyaltyAccountNumber===r.cpMemberDraft.yourExtrasThirdPartyAccountNumber&&r.cpMemberDraft.yourExtrasPreference===i.optionId.airline&&(r.cpMemberDraft.yourExtrasAirlineAccountNumber=e.loyaltyAccountNumber)})),r.cpMemberDraft.yourExtrasAirlineOptions.push({loyaltyAccountNumber:"loyalty",name:a.yourExtras.addAirline})},r.setYourExtrasFuelRewardsOption=function(){r.cpMemberDraft.yourExtrasFuelRewardsEmail=r.cpMemberDraft.yourExtrasFuelRewardsOption?"":s},r.setYourExtrasPreference=function(e,t){(function(e){return e===i.EDIT_MODES.airlineMilesEditMode||e===i.EDIT_MODES.fuelRewardsEditMode})(t)&&e!==r.cpMemberDraft.yourExtrasPreference&&delete r.cpMemberDraft.yourExtrasFuelRewardsOption,function(e){r.cpMemberDraft.yourExtrasPreference=r.cpMemberDraft.yourExtrasPreference===e?i.optionId.none:e,delete r.cpMemberDraft.yourExtrasAirlineAccountNumber,delete r.cpMemberDraft.yourExtrasFuelRewardsOption,angular.extend(c,{yourExtrasFuelRewardsEmail:r.cpMemberDraft.yourExtrasFuelRewardsEmail,yourExtrasPreference:r.cpMemberDraft.yourExtrasPreference})}(e)},r.submit=function(){if(r.cpMemberDraft.yourExtrasPreference!==i.optionId.fuel||void 0!==c.yourExtrasFuelRewardsEmail)return r.cpMemberDraft.yourExtrasPreference!==i.optionId.airline||c.yourExtrasThirdPartyAccountNumber&&""!==c.yourExtrasThirdPartyAccountNumber?void r.editUser(c):(r.setYourExtrasAirlineOptions(),void r.toggleEditMode(i.optionId.airline,!0));r.toggleEditMode(i.optionId.fuel,!0)},r.toggleLoyaltySection=function(e){"loyalty"===e&&r.toggleEditMode(e)},r.yourExtrasFuelAirlineConstants=i.EDIT_MODES,r.yourExtrasNoEmailWarning=t.trustAsHtml(a.yourExtras.noEmailWarning),r.yourExtrasNoPhoneWarning=t.trustAsHtml(a.yourExtras.noPhoneWarning),r.yourExtrasPreferencesOptionNONE=i.optionId.none,s=r.cpMemberDraft.yourExtrasFuelRewardsEmail,c={}}];e.exports=["siteConfig",function(e){return{controller:r,restrict:"E",scope:!0,templateUrl:"/".concat(e.assetFingerprint,"/app/account/edit-profile/edit-your-extras/edit-your-extras.html")}}]},function(e,t){e.exports=["$rootScope","analyticsConst","analyticsManager","eventsConst","omniture","omnitureConst","pagesConst",function(e,t,r,n,o,a,i){return{init:function(t){function s(){return JSON.stringify(t.emitSavingErrors.reason)}r.initialize(),o.clearPreviousProperties(),r.setPageDefaults({PAGE_NAME:function(){return a.PAGE_NAME.EDIT_PROFILE}},i.EDIT_PROFILE),angular.forEach(a.PAGE_NAME.EDIT_PROFILE_POP_UPS,(function(e,t){r.setPageDefaults({PAGE_NAME:function(){return e}},i[t])})),angular.forEach(a.PAGE_NAME.EDIT_PROFILE_POP_UPS_ERRORS,(function(e,t){r.setPageDefaults({ERROR_MESSAGES:s,PAGE_NAME:function(){return e}},i[t])})),t.emitToggleEvents=function(t,o){(t=t&&"cancelBTN"!==o?".".concat(t):"")||o||(r.clickTracking.value="Edit"),e.$emit(n.ANALYTICS_PAGE_LOADED,i.EDIT_PROFILE+t)},t.emitSavingErrors=function(o,a){var i=o[Object.keys(o)[0]];t.emitSavingErrors.reason=i,r.clickTracking.value="SaveChangesBTN",e.$emit(n.ANALYTICS_PAGE_LOADED,a)}}}}]},function(e,t,r){e.exports=angular.module("chApp.account.enroll",[]).controller("CPEnrollPageCtrl",r(477))},function(e,t){e.exports=["$location","$scope","$sessionStorage","cacheKeyConst","eventsConst","omniture","omnitureConst","privacyPreferencesConst",function(e,t,r,n,o,a,i,s){var c={aaaNumber:"",address:{address2:"",address3:"",addressType:"HOME",country:"",county:""},bedPreference:"",businessPhone:"",clientId:"",companyName:"",confirmPassword:"",emailNotification:!1,isMobileNumber:!0,password:"",privacyPreferences:{},smokingPreference:"",title:""};e.search().number&&(r[n.PROMO_REGISTRATION]=!0),angular.forEach(s,(function(e){c.privacyPreferences[e]=!1})),t.cpMember=angular.copy(c),t.updatePrivacyPreferencesDefaults=!0,t.$on(o.LOGGED_IN,(function(e,r){r.loyaltyAccountNumber||angular.extend(t.cpMember,r),a.sendAnalyticsViaPageLoad({eVar2:i.USER_TYPE.ENROLL_CP,events:"event1"})}))}]},function(e,t,r){e.exports=angular.module("chApp.account.forgotCredentials",[]).controller("ForgotCredentialsPageCtrl",r(479))},function(e,t){e.exports=["$scope","$document","$timeout","globalLoaderCounter","loyaltyAccountHelper","omniture","omnitureConst","strings","userHelper","userService",function(e,t,r,n,o,a,i,s,c,l){var u=e.forgotPasswordInfo={},d=e.forgotUsernameInfo={};function p(){e.forgotPasswordSuccessMessage=!1,e.forgotPasswordErrorMessage=!1,e.forgotUsernameSuccessMessage=!1,e.forgotUsernameErrorMessage=!1,e.accountLockedErrorMessage=!1}function m(e){var r=angular.element(t[0].querySelector(e));t.scrollToElement(r)}e.cpUserPostalToggle=function(t){t.preventDefault(),e.cpUserPostal.toggle=!e.cpUserPostal.toggle,r((function(){var e="cpInstead"===t.target.name?document.querySelector('button[name="postalInstead"]'):document.querySelector('button[name="cpInstead"]');e&&e.focus()}))},e.submitForgotPassword=function(t){if(t&&!1===t.$valid){t.$submitted=!0;var o=document.querySelector('form[name="forgotPasswordForm"] .ng-invalid');o&&o.focus()}else{var d={email:u.email,username:u.username};n.inc(),l.sendForgotPasswordEmail(d).then((function(){p(),e.forgotPasswordSuccessMessage=!0,m(".forgot-password-col"),a.sendAnalyticsViaCustomLink({linkTrackVars:"prop19,prop53,prop54",pageName:i.PAGE_NAME.FORGOT_CREDENTIALS_SUCCESS,prop53:a.getPreviousPageName(),prop54:"SubmitPASSBTN"})})).catch((function(t){c.verifyAkamaiResponse(t,e),p(),t.outputErrors&&t.outputErrors.FAILURE_FORGOT_PASSWORD?r((function(){e.accountLockedErrorMessage=!0,a.sendAnalyticsViaCustomLink({linkTrackVars:"prop19,prop53,prop54",pageName:i.PAGE_NAME.FORGOT_CREDENTIALS_ERROR,prop19:s.account.errors.forgotCredentialsAccountLockedError.replace(/<(?:.|\n)*?>/gm,""),prop53:i.PAGE_NAME.FORGOT_CREDENTIALS,prop54:"SubmitPASSBTN"})})):r((function(){e.forgotPasswordErrorMessage=!0,a.sendAnalyticsViaCustomLink({linkTrackVars:"prop19,prop53,prop54",pageName:i.PAGE_NAME.FORGOT_CREDENTIALS_ERROR,prop19:s.account.errors.forgotCredentialsError.replace(/<(?:.|\n)*?>/gm,""),prop53:i.PAGE_NAME.FORGOT_CREDENTIALS,prop54:"SubmitPASSBTN"})}))})).finally((function(){n.dec()}))}},e.submitForgotUsername=function(t){if(t&&!1===t.$valid){t.$submitted=!0;var n=document.querySelector('form[name="forgotUsernameForm"] .ng-invalid');n&&n.focus()}else{var u={email:d.email};d.address&&d.address.postalCode&&(u.postalCode=d.address.postalCode),d.cpNumber&&(u.loyaltyProgramId=o.getProgramId(d.cpNumber),u.loyaltyAccountNumber=o.getAccountNumber(d.cpNumber)),l.sendForgotUsernameEmail(u).then((function(){p(),e.forgotUsernameSuccessMessage=!0,m(".forgot-username-col"),a.sendAnalyticsViaCustomLink({linkTrackVars:"prop19,prop53,prop54",pageName:i.PAGE_NAME.FORGOT_CREDENTIALS_SUCCESS,prop53:a.getPreviousPageName(),prop54:"SubmitUSRBTN"})})).catch((function(t){c.verifyAkamaiResponse(t,e),p(),r((function(){e.forgotUsernameErrorMessage=!0,a.sendAnalyticsViaCustomLink({linkTrackVars:"prop19,prop53,prop54",pageName:i.PAGE_NAME.FORGOT_CREDENTIALS_ERROR,prop19:s.account.errors.forgotCredentialsError.replace(/<(?:.|\n)*?>/gm,""),prop53:a.getPreviousPageName(),prop54:"SubmitUSRBTN"})}))}))}},e.cpUserPostal={toggle:!1}}]},function(e,t,r){e.exports=angular.module("chApp.account.home",[]).controller("AccountPageCtrl",r(481))},function(e,t){e.exports=["$document","$location","$sce","$scope","$sessionStorage","$uibModal","$window","cacheKeyConst","contentService","countryDataUtils","choicePrivilegesConst","cpUser","dateHelper","favoritesService","globalLoaderCounter","hotelService","loyaltyAccountHelper","loyaltyConst","pageEventsHelper","pagesConst","reservationHelper","reservationService","reservationsConst","routeConst","selectedLangData","sessionStorageHelper","siteConfig","strings","urlParserService","userService","yourExtrasConst",function(e,t,r,n,o,a,i,s,c,l,u,d,p,m,g,f,h,E,v,y,C,P,A,b,R,S,I,T,O,N,_){var D=R.get().code;function M(){n.reservationDesktopSlides.length=0,n.reservationTabletSlides.length=0,n.currentReservations.forEach((function(e,t){t%3==0&&n.reservationDesktopSlides.push(n.currentReservations.slice(t,t+3)),t%2==0&&n.reservationTabletSlides.push(n.currentReservations.slice(t,t+2))})),k()}function k(){n.favoritesDesktopSlides.length=0,n.favoritesTabletSlides.length=0,n.currentFavorites.forEach((function(e,t){t%3==0&&n.favoritesDesktopSlides.push(n.currentFavorites.slice(t,t+3)),t%2==0&&n.favoritesTabletSlides.push(n.currentFavorites.slice(t,t+2))}))}angular.extend(n,{choicePrivilegesConst:u}),n.notSorted=function(e){return Object.keys(e||{})},n.goToReservation=function(e){C.goToReservation(e)},n.openYourExtrasValueBreakdownModal=function(){a.open({scope:n,size:"lg",templateUrl:"/".concat(I.assetFingerprint,"/app/account/modals/your-extras-earning-value-breakdown.modal.html")}).rendered.then((function(){e[0].querySelector(".modal-close").focus()}))},n.getPropertyPageUrl=function(e){var t=e.id||e.hotelId;return O.getPropertyUrl(e.address,e.brandCode,t,D)},n.deleteFavorite=function(e){m.deleteFavorite(e).then((function(){n.currentFavorites.forEach((function(t,r){t.id===e&&n.currentFavorites.splice(r,1)})),k()})).catch((function(){n.errorFor=e})).finally(g.dec)},n.currentReservations=[],n.pastReservations=[],n.reservationDesktopSlides=[],n.reservationTabletSlides=[],n.currentFavorites=[],n.favoritesDesktopSlides=[],n.favoritesTabletSlides=[],n.enrolled=t.search().enrolled||!1,n.countryDataUtils=l,g.inc(),P.getReservations(A.DAY_GROUPS.RECENT_STAYS,d).catch((function(e){return n.reservationSummariesErrors=(e||{}).outputErrors||{error:T.general.unknownError},e})).then((function(e){n.currentReservations=P.filterCancellations((e||{}).currentReservations)||[],n.pastReservations=(e||{}).pastReservations||[],M()})).finally(g.dec),n.cpUser.favoriteHotels&&n.cpUser.favoriteHotels.length>0&&angular.forEach(n.cpUser.favoriteHotels,(function(e){f.getHotel(e).then((function(e){n.currentFavorites.push(e)})).finally((function(){g.dec(),M()}))})),M(),c.getHTMLFragment(t.path(),"dynamicPages").then((function(e){n.cmsContent=e})),c.getHTMLFragment("choice-hotels/choice-privileges/promos","module").then((function(e){n.promotionsContent=e})),o[s.PROMO_REGISTRATION]&&(c.getHTMLFragment("choice-hotels/choice-privileges/promo-registration","module").then((function(e){n.promoRegistrationContent=e})),delete o[s.PROMO_REGISTRATION]),d.loyaltyProgramId&&d.loyaltyAccountNumber&&(n.isCPAccount=h.checkCPAccount(d),n.yourExtrasConst=_,n.isCPAccount?N.getUserYourExtrasEarningSummaries().then((function(e){n.transactionSummary=e,delete n.yourExtrasOptions;var t=T.yourExtras.notifyHtmlFormat.replace("{url}",n.transactionSummary.termsAndConditionsUrl);n.yourExtrasNotifyHtml=r.trustAsHtml(t)})):N.getUserYourExtrasOptions().then((function(e){n.yourExtrasOptions=e,delete n.transactionSummary}))),n.programs=["Air Canada","Air New Zealand"],i.scrollTo(0,0),S.getUserIsEnrollingInChoicePrivileges()&&(v.loaded(y.ENROLLED),S.setUserIsEnrollingInChoicePrivileges(!1))}]},function(e,t,r){e.exports=angular.module("chApp.account.membership",[]).constant("membershipConstant",r(483)).controller("MembershipCtrl",r(484)).controller("MembershipModalCtrl",r(485))},function(e,t){e.exports={cpMemberFormPrivacyMobilePreferences:[{default:!0,id:"sendReservationSMS"},{default:!1,id:"sendHotelTypeSMS"},{default:!1,id:"sendMarketingSMS"},{default:!1,id:"sendChoicePrivilegesSMS"}],memberFormPrivacyByCountry:{AU:{options:[{controlEmail:!0,default:!0,edit:!0,embeddedInString:!1,id:"sendEmail",join:!0,negativeStatement:!0},{default:!0,email:!0,id:"sendSurveyEmail",negativeStatement:!0},{default:!0,email:!0,id:"sendNewsletterEmail",negativeStatement:!0},{default:!0,email:!0,id:"sendPromotionalEmail",negativeStatement:!0},{default:!0,email:!0,id:"sendPartnerEmail",negativeStatement:!0},{default:!0,edit:!0,embeddedInString:!1,id:"sendDirectMail",join:!0,negativeStatement:!0},{default:!0,edit:!0,embeddedInString:!1,id:"partnerShare",join:!0,negativeStatement:!0}]},CA:{options:[{controlEmail:!0,default:!1,edit:!0,embeddedInString:!1,hiddenControl:!0,id:"sendEmail",join:!0},{default:!1,email:!0,id:"sendSurveyEmail"},{default:!1,email:!0,id:"sendNewsletterEmail"},{default:!1,email:!0,id:"sendPromotionalEmail"},{default:!1,email:!0,id:"sendPartnerEmail"}]},EU:{options:[{altHtml:!0,controlEmail:!0,default:!1,edit:!0,embeddedInString:!0,hiddenControl:!0,id:"sendEmail",join:!0},{default:!1,email:!0,id:"sendSurveyEmail"},{default:!1,email:!0,id:"sendNewsletterEmail"},{default:!1,email:!0,id:"sendPromotionalEmail"},{default:!1,email:!0,id:"sendPartnerEmail"},{default:!0,id:"sendDirectMail"}]},LA:{options:[{controlEmail:!0,default:!0,edit:!0,embeddedInString:!1,hiddenControl:!0,id:"sendEmail",join:!1,negativeStatement:!0},{default:!0,email:!0,id:"sendSurveyEmail",negativeStatement:!0},{default:!0,email:!0,id:"sendNewsletterEmail",negativeStatement:!0},{default:!0,email:!0,id:"sendPromotionalEmail",negativeStatement:!0},{default:!0,email:!0,id:"sendPartnerEmail",negativeStatement:!0},{default:!0,edit:!0,embeddedInString:!1,id:"sendDirectMail",join:!1,negativeStatement:!0},{default:!0,edit:!0,embeddedInString:!1,id:"partnerShare",join:!1,negativeStatement:!0}]},US:{options:[{altHtml:!0,controlEmail:!0,default:!0,edit:!0,embeddedInString:!1,id:"sendEmail",join:!1,negative:!0,negativeStatement:!0},{default:!0,edit:!0,email:!0,embeddedInString:!1,id:"sendSurveyEmail",join:!1},{default:!0,edit:!0,email:!0,embeddedInString:!1,id:"sendNewsletterEmail",join:!1},{default:!0,edit:!0,email:!0,embeddedInString:!1,id:"sendPromotionalEmail",join:!1},{default:!0,edit:!0,email:!0,embeddedInString:!1,id:"sendPartnerEmail",join:!1},{default:!0,edit:!0,embeddedInString:!1,id:"sendDirectMail",join:!1},{default:!0,edit:!0,embeddedInString:!1,id:"partnerShare",join:!1}]}},memberFormPrivacyByCountryNonOpt:{AU:{options:[{controlEmail:!0,default:!1,edit:!0,embeddedInString:!1,id:"sendEmail",join:!0,negativeStatement:!1},{default:!1,email:!0,id:"sendSurveyEmail",negativeStatement:!1},{default:!1,email:!0,id:"sendNewsletterEmail",negativeStatement:!1},{default:!1,email:!0,id:"sendPromotionalEmail",negativeStatement:!1},{default:!1,email:!0,id:"sendPartnerEmail",negativeStatement:!1},{default:!1,edit:!0,embeddedInString:!1,id:"sendDirectMail",join:!0,negativeStatement:!1},{default:!1,edit:!0,embeddedInString:!1,id:"partnerShare",join:!0,negativeStatement:!1}]},CA:{options:[{controlEmail:!0,default:!1,edit:!0,embeddedInString:!1,hiddenControl:!0,id:"sendEmail",join:!0},{default:!1,email:!0,id:"sendSurveyEmail"},{default:!1,email:!0,id:"sendNewsletterEmail"},{default:!1,email:!0,id:"sendPromotionalEmail"},{default:!1,email:!0,id:"sendPartnerEmail"},{default:!1,edit:!0,embeddedInString:!1,id:"sendDirectMail",join:!0},{default:!1,edit:!0,embeddedInString:!1,id:"partnerShare",join:!0}]},EU:{options:[{altHtml:!0,controlEmail:!0,default:!1,edit:!0,embeddedInString:!1,hiddenControl:!0,id:"sendEmail",join:!0},{default:!1,email:!0,id:"sendSurveyEmail"},{default:!1,email:!0,id:"sendNewsletterEmail"},{default:!1,email:!0,id:"sendPromotionalEmail"},{default:!1,email:!0,id:"sendPartnerEmail"},{default:!1,edit:!0,embeddedInString:!1,id:"sendDirectMail",join:!0},{default:!1,edit:!0,embeddedInString:!1,id:"partnerShare",join:!0}]},LA:{options:[{controlEmail:!1,default:!1,edit:!0,embeddedInString:!1,hiddenControl:!0,id:"sendEmail",join:!0,negativeStatement:!1},{default:!1,email:!0,id:"sendSurveyEmail",negativeStatement:!1},{default:!1,email:!0,id:"sendNewsletterEmail",negativeStatement:!1},{default:!1,email:!0,id:"sendPromotionalEmail",negativeStatement:!1},{default:!1,email:!0,id:"sendPartnerEmail",negativeStatement:!1},{default:!1,edit:!0,embeddedInString:!1,id:"sendDirectMail",join:!0,negativeStatement:!1},{default:!1,edit:!0,embeddedInString:!1,id:"partnerShare",join:!0,negativeStatement:!1}]},US:{options:[{altHtml:!0,controlEmail:!1,default:!0,edit:!0,embeddedInString:!1,id:"sendEmail",join:!0,negative:!0,negativeStatement:!1},{default:!0,edit:!0,email:!0,embeddedInString:!1,id:"sendSurveyEmail",join:!1},{default:!0,edit:!0,email:!0,embeddedInString:!1,id:"sendNewsletterEmail",join:!1},{default:!0,edit:!0,email:!0,embeddedInString:!1,id:"sendPromotionalEmail",join:!1},{default:!0,edit:!0,email:!0,embeddedInString:!1,id:"sendPartnerEmail",join:!1},{default:!0,edit:!0,embeddedInString:!1,id:"sendDirectMail",join:!0},{default:!0,edit:!0,embeddedInString:!1,id:"partnerShare",join:!0}]}}}},function(e,t){e.exports=["$document","$location","$rootScope","$scope","$templateCache","$timeout","$uibModal","$window","contentService","countriesData","countryDataUtils","eventsConst","featureFlags","globalLoaderCounter","guestInfoHelper","localesConst","localeService","membershipConstant","objectHelper","omniture","omnitureConst","patternsConst","profileHelper","routeConst","selectedLangData","sessionStorageHelper","siteConfig","strings","userHelper","userService",function(e,t,r,n,o,a,i,s,c,l,u,d,p,m,g,f,h,E,v,y,C,P,A,b,R,S,I,T,O,N){var _=n.$parent.cpMember,D=l.get(),M=["title","choicePrivilegesLanguagePreference","email","homePhone","firstName","lastName","businessPhone","middleName","mobilePhone","sendMarketingSMS","sendChoicePrivilegesSMS","sendHotelSMS","sendReservationSMS"],k=["county","city","country","subdivision","addressType","postalCode"];function L(){g.resetGuestInfo(n.cpMember),angular.extend(n.cpMember,_)}function w(e,t,r){return r.forEach((function(r){e[r]&&(t[r]=e[r])})),t}function $(){a((function(){var t=angular.element(e[0].querySelector(".help-block"));e.scrollToElementAnimated(t)}))}function x(){var e=w(n.cpMember,{},M),t=S.getApplGroup();t&&(e.enrollmentCode=t);var r,o,a,i=S.getReferralId();return i&&(e.referralId=i),r=e,e=angular.extend(r,n.cpMember.privacyPreferences),n.cpMember.address&&(e=w(n.cpMember.address,e,k),o=n.cpMember,a=e,o.address.line1&&(a.address1=o.address.line1),o.address.line2&&(a.address2=o.address.line2),o.address.line3&&(a.address3=o.address.line3),e=a),p.GDC_CREATE_PROFILE&&n.cpMember.isMobileNumber&&(e.mobilePhone=n.cpMember.homePhone,E.cpMemberFormPrivacyMobilePreferences.forEach((function(t){e[t.id]=n.cpMember[t.id]||!1}))),n.cpUser&&n.cpUser.signedIn?(e.username=n.credentials.username,e.password=n.credentials.password):(e.username=n.cpMember.username,e.password=n.cpMember.password),e}p.IWSR_MASTER&&!h.isDomestic()&&(_.address=g.createGuestInfo().address),n.sendCpCreateAnalytics=function(){n.formState.chooseUsername?n.submitErrors?y.sendAnalyticsViaCustomLink({linkTrackVars:"prop19,prop54",pageName:"New Membership Form - Error",prop19:T.account.errors.userAccountPostErrors.UNEXPECTED_FAILURE_ENROLL_CP,prop54:"CreateProfileBTN"}):y.sendAnalyticsViaCustomLink({evar2:"Online Profile - CP",events:"event2, event4",linkTrackVars:"prop53,prop54",pageName:"My Account",prop53:"New Membership Form",prop54:"CreateProfileBTN"}):y.sendAnalyticsViaCustomLink({evar2:"CP Enroll",events:"event1, event2, event4",linkTrackVars:"prop53,prop54",pageName:"My Account",prop53:"New Membership Form",prop54:"SubmitBTN"})},n.getProperty=v.getPropertyByString,angular.extend(n,{formUtils:{cmsContentPassword:null,getCmsContentPassword:function(){return n.formUtils.cmsContentPassword?n.formUtils.cmsContentPassword:(m.inc(),c.getHTMLFragment(n.modalNames.userpassword).then((function(e){return n.formUtils.cmsContentPassword=e,e}),(function(e){return n.formUtils.cmsContentPassword=e.data,e.data})).finally(m.dec))},inputErrors:{},memberFormCollapse:!0,modal:{close:function(){this.modalWindow.close()},modalWindow:null,show:function(){this.modalWindow=i.open({controller:"MembershipModalCtrl",resolve:{cmsContentModal:function(){return T[n.modalNames.MODAL_PARTNER]}},scope:n,size:"lg",templateUrl:"/".concat(I.assetFingerprint,"/app/account/membership/cp-member.modal.html")})}},outputErrors:null},modalNames:{MODAL_PARTNER:"cpMemberFormBusinessPartnerModal",MODAL_PASSWORD:"userpassword"},populateCredentials:function(e){n.credentials=e},postalCodePattern:function(e){return P.postalCodePatterns.postalCodeFor[e]||P.postalCodePatterns.postalCode},saveCredentials:function(e){e.submitted=!0,n.credentials={password:e.password.$viewValue,username:e.username.$viewValue}},submit:function(){if(n.inputErrors=!1,n.cpForm.$submitted=!0,n.cpForm.$valid){var e=x();m.inc();var r={password:e.password,username:e.username};n.cpMember.guestId&&(e.guestId=n.cpMember.guestId),N.createUser(e).then((function(){e.enrollmentCode&&S.setApplGroup(""),e.referralId&&S.setReferralId(""),S.setUserIsEnrollingInChoicePrivileges(!0),function(e){m.inc(),N.login(e).catch((function(e){O.verifyAkamaiResponse(e,n)})).then((function(){t.path(b.CP_HOME_PATH).search({enrolled:"true"})})).finally(m.dec)}(r)})).catch((function(e){O.verifyAkamaiResponse(e,n),function(e){n.submitErrors=[],n.inputErrors=!0,angular.forEach(e.data.inputErrors,(function(e,t){(n.cpForm[t]||{}).$setValidity?(n.cpForm[t].$setValidity(t,!1),n.guestInfoErrors[t]=e):n.submitErrors.push(e)}))}(e);var t=e.data.outputErrors;Object.keys(t||{}).forEach((function(e){t[e]&&-1===n.submitErrors.indexOf(t[e])&&"INVALID_USERNAME_ALREADY_EXISTS"!==e&&n.submitErrors.push(t[e]),"INVALID_USERNAME_ALREADY_EXISTS"===e&&(n.cpForm.username.$error={taken:!0}),"INVALID_LOYALTY_ACCOUNT_EXISTS_FOR_GUEST"===e&&p.CP_ENROLLMENT_IMPROVEMENTS&&(n.inputErrors=!1,n.submitErrors={},n.cpAccountAlreadyExists=!0),t&&y.sendAnalyticsViaPageLoad({pageName:C.PAGE_NAME.NEW_MEMBERSHIP_FORM_ERROR,prop19:t[e]})})),$()})).finally(m.dec)}else n.inputErrors=!0;n.inputErrors&&(n.inputErrorsFocusEligible=!1,a((function(){n.inputErrorsFocusEligible=!0})),$())}}),n.formState={chooseUsername:!1,signIn:!1},n.setCommunicationPreferences=function(e,t,r){A.setCommunicationPreferences(e,t,r)},n.close=function(e){n.setFormState(e);var t={chooseUsername:s.document.getElementById("link-chooseUsername"),signIn:s.document.getElementById("link-signIn")}[e]||void 0;t&&t.focus()},n.setFormState=function(e){angular.forEach(this.formState,(function(t,r,n){n[r]=r===e&&!t})),n.cpAccountAlreadyExists=!1},n.guestInfo={},n.cpMember={},n.guestInfoErrors={},L(),n.submitErrors=[],n.inputErrors=!1,n.profileContainsCreditCard=!!n.cpMember.creditCardNumber,n.languages=g.getLangOptions(),n.cpMember.choicePrivilegesLanguagePreference=p.CP_ENROLLMENT_UPDATES?h.getLanguageCode().toUpperCase():n.cpMember.choicePrivilegesLanguagePreference,n.memberFormPrivacyByCountry=p.PRIVACY_PREFERENCE_NON_OPT?E.memberFormPrivacyByCountryNonOpt:E.memberFormPrivacyByCountry,n.updatePrivacyPreferencesDefaults&&n.$watch("cpMember.address.country",(function(e){void 0===e&&(n.cpMember.address.country=D[0].code),function(e){if(Object.keys(n.cpMember.privacyPreferences).forEach((function(e){n.cpMember.privacyPreferences[e]=!1})),e){var t=u.getPrivacyPreferenceGroup(e);n.memberFormPrivacyByCountry[t]&&Object.keys(n.memberFormPrivacyByCountry[t].options).forEach((function(e){var r=n.memberFormPrivacyByCountry[t].options[e];n.cpMember.privacyPreferences[r.id]=r.default}))}}(e)})),n.cpMemberFormPrivacyMobilePreferences=E.cpMemberFormPrivacyMobilePreferences,n.loadPrivacyPreferenceLabels=p.PRIVACY_PREFERENCE_NON_OPT?T.account.memberFormPrivacyByCountryNonOpt:T.cp.memberFormPrivacyByCountry,n.$on(d.LOGGED_IN,(function(){L()})),t.search().appl_group&&S.setApplGroup(t.search().appl_group),t.search().ref_id&&S.setReferralId(t.search().ref_id),"createNewAccount"===t.search().createType?(n.setFormState("chooseUsername"),n.enrollInMembership=!1):(n.formState.chooseUsername=!1,n.enrollInMembership=!0)}]},function(e,t){e.exports=["$scope","cmsContentModal",function(e,t){e.cmsContentModal=t}]},function(e,t,r){e.exports=angular.module("chApp.account.missingStay",[]).controller("ReportMissingStayPageCtrl",r(487)).factory("reportMissingStayService",r(488)).directive("chValidatePhone",r(348))},function(e,t){e.exports=["$document","$filter","$scope","$state","countryDataUtils","cpUser","dateHelper","deviceConst","formHelper","loyaltyConst","reportMissingStayService","siteConfig",function(e,t,r,n,o,a,i,s,c,l,u,d){function p(){e.scrollToElementAnimated(e[0].querySelector("#submitErrors"),0,500)}r.$watch("accountType",(function(e){"cp"===e&&(r.missingStay.partnerLoyaltyProgramId||r.missingStay.partnerLoyaltyAccountNumber)&&(r.missingStay.partnerLoyaltyProgramId=null,r.missingStay.partnerLoyaltyAccountNumber=null)})),r.getFieldErrors=function(e){return c.errorFilter(r.form,e)},r.stopPropagation=function(e){e.stopPropagation(),e.stopImmediatePropagation()},r.submitForm=function(){r.form.$setSubmitted(),r.submitErrors={},r.success=!1,r.form.$valid?u.sendReport(r.missingStay).then((function(){r.success=!0})).catch((function(e){r.submitErrors=angular.extend({},e.inputErrors,e.outputErrors)})).finally(p):p()},r.resetForm=function(){n.reload()},r.countryDataUtils=o,r.programs=l.PROGRAMS.filter((function(e){return!e.internal})),r.today=i.getTodayDate(),r.yesterday=i.getYesterdayDate(),r.points=t("number")(a.loyaltyAccount.accountBalance,0),r.plusMinusDropdownMode=d.deviceType===s.MOBILE?"full":"compact",r.missingStay={businessPhone:"",checkInDate:i.getYesterdayString(),checkOutDate:i.getTodayString(),confirmationId:"",homePhone:a.homePhone||"",hotelId:"",nightlyRate:"",numberOfRooms:1,ratePlan:"RACK"},r.accountType="cp"}]},function(e,t){function r(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function n(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}e.exports=["$http","$locale","$q","featureFlags","localeService","urlEncodeObject",function(e,t,o,a,i,s){return{sendReport:function(a){var c=angular.extend(function(e){for(var t=1;t<arguments.length;t++){var o=null!=arguments[t]?arguments[t]:{};t%2?r(Object(o),!0).forEach((function(t){n(e,t,o[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(o)):r(Object(o)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(o,t))}))}return e}({preferredLocaleCode:t.id},i.getSiteNameObj()),a);return e({data:s(c),headers:{"content-type":"application/x-www-form-urlencoded"},method:"POST",url:"/webapi/user-account/missing-stay-report"}).then((function(e){return e.data})).catch((function(e){return o.reject(e.data)}))}}}]},function(e,t,r){e.exports=angular.module("chApp.account.partnerHub",[]).controller("PartnerHubPageCtrl",r(490)).directive("partnerHubIframe",r(491)).directive("partnerTransfer",r(492)).service("partnerHubAnalytics",r(493))},function(e,t){e.exports=["$document","$locale","$location","$rootScope","$sce","$scope","$state","$timeout","$uibModal","$window","ariaHiddenHelper","eventsConst","featureFlags","globalLoaderCounter","localeService","partnerHubAnalytics","partnerHubService","routeConst","sessionStorageHelper","siteConfig","strings","userService",function(e,t,r,n,o,a,i,s,c,l,u,d,p,m,g,f,h,E,v,y,C,P){var A,b,R,S,I=n.chConstants.ssoPointsTransactionsUrl,T=h.getSsoData(),O=v.getPartnerHubToken();function N(){A=s((function(){s.cancel(b),R=!0,function(){v.deletePartnerHubToken();var t=c.open({scope:a,templateUrl:"/".concat(y.assetFingerprint,"/app/account/partner-hub/partner-hub-timeout-modal.html"),windowTemplateUrl:"/".concat(y.assetFingerprint,"/app/bootstrap-ui/modal/generic.modal-window.html")});t.rendered.then((function(){var t=e[0].querySelector("#timeoutModal");u.isolate(t),t.focus(),P.logout(),f.emitErrors("".concat(C.partnerHub.sessionError," ").concat(C.partnerHub.sessionErrorLineOne," ").concat(C.partnerHub.sessionErrorLineTwo))})),t.closed.then((function(){a.$parent.buttonFocus="partnerHubTransferButton",u.restore(),r.url(E.CP_REDEEM.REWARDS_EXCHANGE)}))}()}),18e5)}e.bind("scroll",(function(){s.cancel(A),N(),S||(S=!0,P.refresh(),b=s((function(){S=!1}),9e5))})),a.$on("$destroy",(function(){s.cancel(A),s.cancel(b),e.unbind("scroll")})),a.$on(d.LOGGED_OUT,(function(){R||r.url("/")})),f.init(a),m.inc(),p.PARTNER_TRANSLATION||"en-us"!==t.id&&(g.setLocaleCookie("en-us"),l.location.href=E.CP_REDEEM.REWARDS_EXCHANGE_PARTNERS),T||O?(a.iframeUrl=o.trustAsResourceUrl("".concat(I,"?ssoSource=choice&ssoProduct=wallet&ssodata=").concat(T||O)),O||(v.setPartnerHubToken(T),h.deleteSsoData()),N()):r.url(E.CP_REDEEM.REWARDS_EXCHANGE)}]},function(e,t){e.exports=["$document","$location","$rootScope","$sce","$window","eventsConst","globalLoaderCounter","sessionStorageHelper","userService",function(e,t,r,n,o,a,i,s,c){return{link:function(t,n){var s,l=r.chConstants.ssoPointsPostMessageOrigin,u=e[0].getElementById("pointsIframe");function d(e){if(e.origin===l){var r=e.data;switch(r.type){case"UPDATE_HEIGHT":t.pointsIframeHeight="".concat(r.height,"px"),i.dec(),t.$apply();break;case"SCROLL_TO_TOP":o.scrollTo(0,0);break;case"TRANSACTION_EXCHANGE_SUCCESS":c.refresh()}}}function p(){s&&u.click()}function m(){s=!0}function g(){s=!1}o.addEventListener("message",d,!1),o.addEventListener("blur",p),u.addEventListener("mouseover",m),u.addEventListener("mouseout",g),t.$on("$destroy",(function(){o.removeEventListener("blur",p),o.removeEventListener("message",d),u.removeEventListener("mouseover",m),u.removeEventListener("mouseout",g)})),t.$on(a.LOGGED_OUT,(function(){n.remove()}))},restrict:"A"}}]},function(e,t){e.exports=["$document","$location","$rootScope","$timeout","$uibModal","ariaHiddenHelper","cpUserData","featureFlags","globalLoaderCounter","omniture","omnitureConst","partnerHubAnalytics","partnerHubService","routeConst","sessionStorageHelper","siteConfig","strings",function(e,t,r,n,o,a,i,s,c,l,u,d,p,m,g,f,h){return{link:function(r){var E=i.get(),v=g.getPartnerHubToken(),y=!1;function C(){var n;E.email||y?v?t.url(m.CP_REDEEM.REWARDS_EXCHANGE_PARTNERS):(c.inc(),p.getExtoken("PCOM",E.cpLoyaltyAccountNumber).then((function(){t.url(m.CP_REDEEM.REWARDS_EXCHANGE_PARTNERS)})).catch((function(){r.openTokenErrorModalHandler()})).finally(c.dec)):(y=!0,n=o.open({scope:r,templateUrl:"/".concat(f.assetFingerprint,"/app/account/partner-hub/partner-hub-email-error-modal.html"),windowTemplateUrl:"/".concat(f.assetFingerprint,"/app/bootstrap-ui/modal/generic.modal-window.html")}),r.$parent.missingPartnerHubField="email",r.updateProfile=function(){t.url(m.CP_UPDATE)},n.rendered.then((function(){var t=e[0].querySelector("#emailErrorModal");a.isolate(t),t.focus(),d.emitErrors("".concat(h.partnerHub.emailError," ").concat(h.partnerHub.emailErrorText))})),n.closed.then((function(){y=!1;var t=e[0].querySelector("#partnerHubTransferButton");a.restore(),t.focus()})))}c.dec(),d.init(r),r.openTokenErrorModalHandler=function(){var i=o.open({scope:r,size:"lg",templateUrl:"/".concat(f.assetFingerprint,"/app/account/partner-hub/partner-hub-token-error-modal.html"),transclude:!0,windowTemplateUrl:"/".concat(f.assetFingerprint,"/app/bootstrap-ui/modal/generic.modal-window.html")});d.emitErrors("".concat(h.partnerHub.extokenError," ").concat(h.partnerHub.errorLineOne," ").concat(h.partnerHub.errorLineTwo));var s=n((function(){i.close()}),1e4);i.rendered.then((function(){var t=e[0].querySelector("#tokenErrorEmail");a.isolate(t),t.focus()})),i.closed.then((function(){n.cancel(s);var t=e[0].querySelector("#partnerHubTransferButton");a.restore(),t.focus()})),r.redirectToLandingPage=function(){l.sendAnalyticsViaCustomLink({linkTrackVars:"prop54",prop54:"TryAgainBTN"},u.PAGE_NAME.REWARDS_EXCHANGE_HOME_ERROR),n.cancel(s),i.close(),t.url(m.CP_REDEEM.REWARDS_EXCHANGE)}},r.getCpUserData=function(){s.PARTNER_HUB&&(E=i.get()).signedIn&&C()},r.$on("loginModalClosed",(function(){a.restore(),s.PARTNER_HUB&&(E=i.get()).signedIn&&C()})),s.PARTNER_HUB&&"partnerHubTransferButton"===r.$parent.buttonFocus&&n((function(){e[0].querySelector("#".concat("partnerHubTransferButton")).getElementsByClassName("cta-primary")[0].focus()}))},restrict:"E"}}]},function(e,t){e.exports=["$rootScope","analyticsManager","eventsConst","omniture","omnitureConst",function(e,t,r,n,o){return{emitErrors:function(a){t.initialize(),n.clearPreviousProperties(),t.setPageDefaults({ERROR_MESSAGES:function(){return a.substring(0,100)},PAGE_NAME:o.PAGE_NAME.REWARDS_EXCHANGE_HOME_ERROR}),e.$emit(r.ANALYTICS_PAGE_LOADED,o.PAGE_NAME.REWARDS_EXCHANGE_HOME_ERROR)},init:function(){t.initialize(),n.clearPreviousProperties(),t.setPageDefaults({PAGE_NAME:function(){return o.PAGE_NAME.REWARDS_EXCHANGE_WALLET}})}}}]},function(e,t,r){e.exports=angular.module("chApp.account.recentActivity",[]).controller("RecentActivityPageCtrl",r(495))},function(e,t){e.exports=["$location","$scope","$window","contentService","reactHelper",function(e,t,r,n,o){var a=o.generatePageId();n.getHTMLFragment(e.path(),"dynamicPages").then((function(e){t.cmsContent=e})),o.loadReactApp((function(){var e=r.AccountActivity,n=r.Provider,i=r.React,s=r.store;o.renderToScope(i.createElement(n,{pageId:a,store:s},i.createElement(e)),"#ch-react-account-activity",t)}))}]},function(e,t,r){e.exports=angular.module("chApp.account.redeem",[]).controller("RedeemConfirmationPageCtrl",r(497)).controller("RedeemMerchantPageCtrl",r(498)).controller("RedeemPointsPageCtrl",r(499)).controller("RedeemReviewPageCtrl",r(500)).factory("redeemService",r(501)).factory("redeemHelper",r(502)).filter("redeemCategory",r(503)).filter("redeemReward",r(504)).filter("orderEliteCategories",r(505))},function(e,t){e.exports=["$location","$scope","contentService","cpRedeem","featureFlags","redeemConst","redeemHelper","redeemService","routeConst","sessionStorageHelper","strings",function(e,t,r,n,o,a,i,s,c,l,u){!function(){r.getHTMLFragment(e.path(),"dynamicPages").then((function(e){t.cmsContent=e})),angular.extend(t,{routeConst:c}),t.redeemCheckoutStatus=l.getRedeemStatus(),t.popularCategory=n.popularCategory,t.primaryRewards=n.primaryRewards,t.redemptionError=!1,t.totalQuantity=0,t.totalPoints=0,t.rewards=[];var d=e.search().merchantCode,p=n.redemptionMerchants.find((function(e){return d===e.code})).loyaltyRedemptionOptions;function m(){return o.DONATION_REDEMPTION&&i.isDonation(e.search().merchantCode,n.redemptionCategories,a.DONATION_GROUP)}angular.forEach(t.redeemCheckoutStatus,(function(e,r){angular.forEach(e.outputErrors,(function(e,r){u.account.errors.digitalGiftCardRedemptionErrors[r]?t.redemptionError=u.account.errors.digitalGiftCardRedemptionErrors[r]:u.account.errors.plasticGiftCardRedemptionErrors[r]&&(t.redemptionError=u.account.errors.plasticGiftCardRedemptionErrors[r])}));var n=p.filter((function(e){return e.awardId===r}));t.rewards.push(angular.extend(t.redeemCheckoutStatus[r],n[0])),1===e.maxRedeemQuantity&&s.clearCache()})),angular.forEach(t.rewards,(function(e){"OK"===e.status?(e.orderPoints=e.points*e.redemptions.length,e.transactionId="#".concat(e.redemptions[0].transactionId),t.totalPoints+=e.orderPoints,t.totalQuantity+=e.redemptions.length):(e.orderPoints=0,e.transactionId=u.general.nA)})),t.isDonationRewardType=m(),t.rewardTypeOptions=a.REWARD_TYPES,t.rewardType=t.rewards[0].digital?a.REWARD_TYPES.DIGITAL:a.REWARD_TYPES.PLASTIC,m()&&(t.rewardType=a.REWARD_TYPES.DONATION)}()}]},function(e,t){e.exports=["$location","$scope","$uibModal","arrayHelper","contentService","cpRedeem","cpUserData","featureFlags","globalLoaderCounter","redeemConst","redeemHelper","routeConst","sessionStorageHelper","siteConfig","strings","userService",function(e,t,r,n,o,a,i,s,c,l,u,d,p,m,g,f){function h(){t.userHasEmail=!!i.get().email}function E(){var e=t.rewardType===l.REWARD_TYPES.DIGITAL;t.loyaltyRedemptionOptions=t.merchant.loyaltyRedemptionOptions.filter((function(t){return t.digital===e})),t.loyaltyRedemptionOptions&&t.loyaltyRedemptionOptions[0]&&(t.rewardOption=t.loyaltyRedemptionOptions[0].description||"")}function v(){t.merchant.loyaltyRedemptionOptions.forEach((function(e){e.orderQuantity={id:0,value:0}})),t.updateTotals()}function y(){return s.DONATION_REDEMPTION&&u.isDonation(e.search().merchantCode,a.redemptionCategories,l.DONATION_GROUP)}function C(){return t.merchant.loyaltyRedemptionOptions.some((function(e){return!0===e.digital}))}t.createOptions=function(e){return n.times(e.maxRedeemQuantity+1,(function(e){return{id:e,value:e}}))},t.updateTotals=function(){if(t.totalQuantity=0,t.totalPoints=0,angular.forEach(t.merchant.loyaltyRedemptionOptions,(function(e){t.totalQuantity=t.totalQuantity+Number(e.orderQuantity.value),t.totalPoints=t.totalPoints+e.orderQuantity.value*e.points})),t.rewardType===l.REWARD_TYPES.DIGITAL&&t.totalQuantity>t.maxRedemptionQuantity)return r.open({scope:t,size:"md",templateUrl:"/".concat(m.assetFingerprint,"/app/account/redeem/modals/redeem-max-quantity-warning.html")})},t.buyRewards=function(){var r=[];angular.forEach(t.merchant.loyaltyRedemptionOptions,(function(e){e.orderQuantity.value>0&&r.push(e)})),r.length&&(p.setRedeemCheckout(r),e.path(d.CP_REDEEM.REVIEW))},t.selectRewardType=function(e){t.rewardType=e,v(),E()},t.selectRewardOption=function(e){t.rewardOption=e,v()},t.updateEmail=function(e){t.emailAddressError="",c.inc(),f.editUserField("email",e).then(h).catch((function(e){t.emailAddressError=e.data.inputErrors.email})).finally(c.dec)},t.isDonationRewardType=y(),angular.extend(t,{routeConst:d}),t.popularCategory=a.popularCategory,t.primaryRewards=a.primaryRewards,t.totalQuantity=0,t.totalPoints=0,t.maxRedemptionQuantity=2,h(),o.getHTMLFragment(e.path(),"dynamicPages").then((function(e){t.cmsContent=e})),o.getHTMLFragment("choice-hotels/choice-privileges/redeem-points/merchant-redemption-warning","module").then((function(e){t.cmsContentInfoHtml=e})),t.merchant=u.getMerchantByCode(e.search().merchantCode,a.redemptionMerchants),t.rewardTypeOptions=angular.copy(l.REWARD_TYPES),y()?(delete t.rewardTypeOptions.DIGITAL,delete t.rewardTypeOptions.PLASTIC):(delete t.rewardTypeOptions.DONATION,C()||delete t.rewardTypeOptions.DIGITAL),t.rewardType=s.CPREDEEM_DIGITAL?y()?l.REWARD_TYPES.DONATION:C()?l.REWARD_TYPES.DIGITAL:l.REWARD_TYPES.PLASTIC:l.REWARD_TYPES.PLASTIC,v(),E()}]},function(e,t){e.exports=["$filter","$location","$scope","$timeout","contentService","cpRedeem","cpUserData","globalLoaderCounter","localeService","patternsConst","redeemConst","routeConst","stringsHelper",function(e,t,r,n,o,a,i,s,c,l,u,d,p){function m(e){return e.toLowerCase().replace(l.allAmpersands,"and").replace(l.allCommas,"").replace(l.allWhiteSpace,"-")}r.handleCategorySelected=function(e){e?t.search("categoryCode",m(e.name)).replace():t.search({}).replace()},r.filterCategory=function(e){angular.forEach(r.redemptionCategories,(function(t){t.isCollapsed=!0,e&&t.name===e.name&&n((function(){t.isCollapsed=!1}))}))},r.hideCategory=function(e){return!e.merchantCodes.some((function(e){return r.primaryRewards[e]&&r.primaryRewards[e].hasDigitalOption}))},function(){angular.extend(r,{routeConst:d}),r.originalRewardCosts={50:16e3,100:32e3},r.redemptionCategories=a.redemptionCategories,r.popularCategory=a.popularCategory,r.primaryRewards=a.primaryRewards,r.showBookieWidget=!1,r.isCollapsed=!1,r.locale=c.getLocaleForUrl(),r.cpRedeemFilters={digital:!1,redeemable:!1},r.plasticOnlyCategories=[];var n=i.get(),l=n.firstName,u=n.lastName;r.userName=p.toTitleCase("".concat(l," ").concat(u)),r.availablePoints=e("number")(i.get().loyaltyAccount.accountBalance);var g=i.get().address.country;r.eligibleCpMember="CA"===g||"US"===g;var f=t.search().categoryCode;r.selectedCategory=r.redemptionCategories.find((function(e){return f===m(e.name)})),angular.forEach(r.redemptionCategories,(function(e){e.isCollapsed=f!==m(e.name)})),angular.forEach(r.redemptionCategories,(function(e){var t=!1;angular.forEach(e.merchantCodes,(function(e){r.primaryRewards[e]&&r.primaryRewards[e].hasDigitalOption&&(t=!0)})),t||r.plasticOnlyCategories.push(e.name)})),s.inc(),o.getHTMLFragment(t.path(),"dynamicPages").then((function(e){r.cmsContent=e})).finally(s.dec),["choice-hotels/choice-privileges/content_cp-2018_header","choice-hotels/choice-privileges/content_cp-gift-card-blade-2","choice-hotels/choice-privileges/content_cp-gift-card-blade-3","choice-hotels/choice-privileges/content_cp-gift-card-blade-4"].forEach((function(e,t){s.inc(),o.getHTMLFragment(e,"module").then((function(e){r["blade".concat(t+1)]=e})).finally(s.dec)}))}()}]},function(e,t){e.exports=["$location","$scope","contentService","cpRedeem","featureFlags","globalLoaderCounter","redeemConst","redeemHelper","redeemService","routeConst","sessionStorageHelper",function(e,t,r,n,o,a,i,s,c,l,u){var d={};function p(){return o.DONATION_REDEMPTION&&s.isDonation(e.search().merchantCode,n.redemptionCategories,i.DONATION_GROUP)}t.isDonationRewardType=p(),t.redeemPoints=function(){a.inc(),function t(r,n){var o=r[n];c.purchaseReward(o.awardId,parseInt(o.orderQuantity.value,10)).then((function(e){d[o.awardId]=e}),(function(e){d[o.awardId]=e})).finally((function(){n+1<r.length?t(r,n+1):(u.setRedeemStatus(d),u.deleteRedeemCheckout(),a.dec(),e.path(l.CP_REDEEM.CONFIRMATION))}))}(t.redeemCheckout,0)},function(){angular.extend(t,{routeConst:l}),t.popularCategory=n.popularCategory,t.primaryRewards=n.primaryRewards,t.totalPoints=0,t.totalQuantity=0,t.redeemCheckout=u.getRedeemCheckout(),t.rewardTypeOptions=i.REWARD_TYPES,t.rewardType=t.redeemCheckout[0].digital?i.REWARD_TYPES.DIGITAL:i.REWARD_TYPES.PLASTIC;var o=s.getMerchantByCode(e.search().merchantCode,n.redemptionMerchants);t.confirmationMessageHtml=t.redeemCheckout[0].digital?o.digitalConfirmationMessageHtml:o.confirmationMessageHtml,t.redeemCheckout.forEach((function(e){t.totalPoints+=e.orderQuantity.value*e.points,t.totalQuantity+=parseInt(e.orderQuantity.value,10)})),p()&&(t.rewardType=i.REWARD_TYPES.DONATION),r.getHTMLFragment(e.path(),"dynamicPages").then((function(e){t.cmsContent=e}))}()}]},function(e,t){function r(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function n(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?r(Object(n),!0).forEach((function(t){o(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):r(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function o(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}e.exports=["$http","$locale","$q","urlEncodeObject","$rootScope","cpUserData","eventsConst","featureFlags","localeService","userService","reasonConst",function(e,t,r,o,a,i,s,c,l,u,d){var p=n({include:"",preferredLocaleCode:t.id},l.getSiteNameObj()),m={};function g(){m={}}function f(t,n){var a=r.defer();function s(e){a.reject(e.data)}function c(e){"OK"===e.data.status?a.resolve(e.data):s(e)}function l(r){if(r.cpLoyaltyAccountNumber&&r.cpLoyaltyProgramId){p.loyaltyProgramId=r.cpLoyaltyProgramId,p.loyaltyAccountNumber=r.cpLoyaltyAccountNumber;var i=angular.extend({},p,n);e({data:o(i),headers:{"content-type":"application/x-www-form-urlencoded"},method:"POST",url:t}).then(c).catch(s)}else a.reject({reason:d.USER_HAS_NO_LOYALTY_INFO})}var m=i.get();return m&&m.cpLoyaltyAccountNumber&&m.cpLoyaltyProgramId?l(m):u.get().then(l),a.promise}function h(e,t){if(m[t])m["".concat(t,"Promise")].resolve(m[t]);else{var o=n({include:e},l.getSiteNameObj());m["".concat(t,"Promise")]||(m["".concat(t,"Promise")]=r.defer(),f("/webapi/user-account/redemption-options",o).then((function(e){m[t]=e[t],m["".concat(t,"Promise")].resolve(m[t])}),(function(e){m["".concat(t,"Promise")].reject(e)})))}return m["".concat(t,"Promise")].promise}function E(){return h("categories","redemptionCategories")}function v(){return h("merchants","redemptionMerchants")}return a.$on(s.LOGGED_OUT,g),{clearCache:g,getCategories:E,getMerchants:v,getRedemptionOptions:function(){m.redemptionCategories||m.redemptionMerchants?(m.redemptionCategories||E(),m.redemptionMerchants||v()):(m.redemptionCategoriesPromise=r.defer(),m.redemptionMerchantsPromise=r.defer(),f("/webapi/user-account/redemption-options",n({include:"categories,merchants"},l.getSiteNameObj())).then((function(e){m.redemptionCategories=e.redemptionCategories,m.redemptionMerchants=e.redemptionMerchants,m.redemptionCategoriesPromise.resolve(m.redemptionCategories),m.redemptionMerchantsPromise.resolve(m.redemptionMerchants)})))},purchaseReward:function(e,t){return f("/webapi/user-account/redeem-loyalty-award",n({awardId:e,awardQuantity:t},l.getSiteNameObj()))}}}]},function(e,t){e.exports=["$sce",function(e){return{getMerchantByCode:function(t,r){var n=r.find((function(e){return t===e.code}));return n&&("string"==typeof n.redemptionInstructionsHtml&&(n.redemptionInstructionsHtml=e.trustAsHtml(n.redemptionInstructionsHtml)),"string"==typeof n.digitalRedemptionInstructionsHtml&&(n.digitalRedemptionInstructionsHtml=e.trustAsHtml(n.digitalRedemptionInstructionsHtml)),"string"==typeof n.confirmationMessageHtml&&(n.confirmationMessageHtml=e.trustAsHtml(n.confirmationMessageHtml)),"string"==typeof n.digitalConfirmationMessageHtml&&(n.digitalConfirmationMessageHtml=e.trustAsHtml(n.digitalConfirmationMessageHtml))),n},isDonation:function(e,t,r){if(!Array.isArray(r)&&!Array.isArray(t))return!1;var n=[];return t.forEach((function(t){Array.isArray(t.merchantCodes)&&t.merchantCodes.indexOf(e)>=0&&r.indexOf(t.name)>=0&&n.push(t)})),n.length>0}}}]},function(e,t){e.exports=["siteConfig","deviceConst",function(e,t){return function(r,n,o,a){if(Array.isArray(a))return a;if(a)return[a];var i=e.deviceType===t.MOBILE,s="".concat(t.MOBILE.toLowerCase()," ");return(r||[]).filter((function(e){var t=0===e.name.toLowerCase().indexOf(s),r=-1===n.indexOf(e.name);return(!o||r)&&t===i}))}}]},function(e,t){e.exports=["cpUserData",function(e){return function(t,r,n,o){var a,i=[];return angular.forEach(r,(function(e){t[e]&&i.push(t[e])})),n&&(a=e.get()),i=i.filter((function(e){return(!n||e.points<=a.loyaltyAccount.accountBalance)&&(!o||e.hasDigitalOption)}))}}]},function(e,t){e.exports=["redeemConst",function(e){return function(t){return t.reduce((function(t,r){return-1!==r.name.indexOf(e.ELITE)?t.unshift(r):t.push(r),t}),[])}}]},function(e,t,r){e.exports=angular.module("chApp.account.reservations",[r(507).name,r(513).name]).component("chReactReservationManagerPage",r(517)).constant("reservationsConst",r(518)).controller("ReservationsPageCtrl",r(519)).directive("chFindReservationForm",r(520)).factory("reservationCheckoutData",r(376)).factory("reservationHelper",r(521)).factory("reservationService",r(349)).factory("unconsolidatedReservationHelper",r(522))},function(e,t,r){e.exports=angular.module("chApp.account.reservations.change",[]).controller("ChangeReservationPageCtrl",r(508)).component("chReactModifyReservationPage",r(509)).component("chReactModifyGuestdataPage",r(510)).component("chReactModifyGuestPaymentPage",r(511)).factory("changeReservationAnalytics",r(512))},function(e,t){e.exports=["$anchorScroll","$location","$rootScope","$sce","$scope","$stateParams","$window","changeReservationAnalytics","checkoutContextData","checkoutService","cpUserData","dateHelper","eventsConst","featureFlags","globalLoaderCounter","groupService","guestdataConst","guestdataFormatter","guestInfoHelper","guestService","hotelService","localeService","objectHelper","pagesConst","patternsConst","ratePlanHelper","ratesConst","reservationCheckoutData","reservationData","reservationService","routeConst","searchConst","searchCriteriaData","selectedLangData","serviceEventConst","serviceEventsHelper","sessionStorageHelper","strings","tokenizationService","urlParserService",function(e,t,r,n,o,a,i,s,c,l,u,d,p,m,g,f,h,E,v,y,C,P,A,b,R,S,I,T,O,N,_,D,M,k,L,w,$,x,G,F){var U,H,B,V,j=u.get(),Y=j.lastName||$.getRSVPLastname(),W=c.get(),q=k.get().code,K=["INVALID_CHECKOUT_CP_NUMBER_REQUIRED","INVALID_CHECKOUT_INSUFFICIENT_GUARANTEE","NONEXISTENT_CHECKOUT_CONTEXT"],z=["INVALID_CHECKOUT_AAA_RATE_PLAN_WITHOUT_AAA_NUMBER"];function Q(e){g.inc(),e.contextId=W.modifiableContextId,l.saveGuestIntoReservation(e).then((function(){o.reservation&&o.reservation.specialRequests&&N.storePendingReservationUpdates(W.modifiableContextId,{specialRequests:o.reservation.specialRequests}),t.path("".concat(m.IWSR_MASTER?P.addLocaleToPath(_.CHANGE_RESERVATION):_.CHANGE_RESERVATION,"/").concat(o.reservationId))})).finally(g.dec)}function X(e,t){var r=t?e:e.checkout,n={acceptedPaymentCards:e.acceptedPaymentCards||W.acceptedPaymentCards,checkInDate:r.checkInDate,checkOutDate:r.checkOutDate,clientId:r.clientId,contextId:r.contextId,modifiableContextId:r.contextId,ratePlan:r.ratePlan,rooms:r.rooms};o.guestForm&&o.guestForm.aaaNumber&&(c.newRateSelected&&!o.guestForm.aaaNumber.$modelValue&&o.guestForm.aaaNumber.$setDirty(),c.newRateSelected=!1),t||(delete r.rooms,delete n.rooms),W=angular.extend({},r,n),c.update(angular.extend({},c.get(),n)),o.acceptedPaymentCards=W.acceptedPaymentCards,o.reservation&&(angular.extend(o.reservation,W),o.reservation.ratePlan=S.getRatePlan(o.reservation.ratePlan)),m.MODIFY_RESERVATION_FLOW&&i.store&&i.store.dispatch({context:o.reservation,type:"CREATE_CHECKOUT_CONTEXT"}),o.modifiableContextId=r.contextId}function J(){B=O.get(),W.modifiableContextId?(g.inc(),l.getCurrentReservation({contextId:W.modifiableContextId,includeReservationQuote:W.centralPaymentRequired}).then((function(e){o.reservation=B.reservation,W.ratePlanDetail&&W.ratePlanDetail.name&&(o.reservation.ratePlanName=W.ratePlanDetail.name+S.getMemberStatus(W.ratePlanDetail)),X(e,!0),Z()})).finally(g.dec)):(o.reservation=B.reservation,X(T.get(),!1),Z())}function Z(){var e,t,n;H=o.reservation.guest&&o.reservation.guest.loyaltyProgramId,U=o.reservation.guest&&o.reservation.guest.loyaltyAccountNumber,angular.extend(o.reservation,W),angular.extend(o.reservation,N.getPendingReservationUpdates(W.contextId)),angular.extend(o.guestInfo,o.reservation.guest,{creditCardName:(e=o.reservation).creditCardName,creditCardNumber:e.creditCardNumber,creditCardType:e.creditCardType,expirationMonth:e.expirationMonth,expirationYear:e.expirationYear}),t=o.reservation.hotelId,g.inc(),C.getHotel(t,D.HOTEL_DEFAULT_PARAMS.include).then((function(e){o.hotel=e,o.acceptedPaymentCards=e.acceptedPaymentCards})).finally(g.dec),m.GDC_MODIFY_RESERVATION&&o.guestInfo.mobilePhones&&(n=o.guestInfo.mobilePhones[0])&&n.preferences&&(o.guestInfo.isMobileNumber=n.preferences.sendReservationSMS),o.isIwsGuaranteeMethodRequired=function(){if(!o.reservation)return!1;if(o.holdTypeGuaranteeObj="",ee()&&o.reservation.guaranteePolicyCode===h.GUARANTEE_METHOD.HOLD_TIME_4PM)return o.holdTypeGuaranteeObj={code:h.GUARANTEE_TYPE.HOLD_4P,name:r.strings.guestData.guaranteeMethodType4PMHold},!0;if(ee()&&o.reservation.guaranteePolicyCode===h.GUARANTEE_METHOD.HOLD_TIME_6PM)return o.holdTypeGuaranteeObj={code:h.GUARANTEE_TYPE.HOLD_6P,name:r.strings.guestData.guaranteeMethodType6PMHold},!0;return!1}(),te()}function ee(){return!!(m.IWSR_COUNTRY_MX&&m.IWSR_MASTER&&R.iwsMexicoLocales.test(siteConfig.locale)&&o.reservation&&o.reservation.guaranteeCode===h.GUARANTEE_CODE.HOLD_TIME)}function te(){o.guestInfo&&o.isIwsGuaranteeMethodRequired&&(o.guestInfo.guaranteeMethod||(o.guaranteeMethodOptions=[],h.GUARANTEE_METHOD_TYPES.forEach((function(e){var t={code:e.code,name:A.getPropertyByString(x,e.name)};o.guaranteeMethodOptions.push(t),o.guaranteeMethodOptions.push(o.holdTypeGuaranteeObj)})),["creditCardName","creditCardNumber","creditCardType","expirationMonth","expirationYear"].every((function(e){return!!o.reservation[e]}))?o.guestInfo.guaranteeMethod=h.GUARANTEE_TYPE.CREDIT_CARD:o.guestInfo.guaranteeMethod=o.holdTypeGuaranteeObj.code),o.guestInfo.guaranteeMethod===h.GUARANTEE_TYPE.HOLD_4P?o.iwsGuaranteeHoldType=h.GUARANTEE_METHOD.HOLD_TIME_4PM:o.guestInfo.guaranteeMethod===h.GUARANTEE_TYPE.HOLD_6P?o.iwsGuaranteeHoldType=h.GUARANTEE_METHOD.HOLD_TIME_6PM:o.iwsGuaranteeHoldType=null,o.showCreditCardFields())}function re(e){e&&e.guest&&(delete e.guest.creditCardName,delete e.guest.creditCardNumber,delete e.guest.creditCardType,delete e.guest.expirationMonth,delete e.guest.expirationYear)}o.redirectToRatesPage=function(){var e,n="".concat(_.CHANGE_RESERVATION,"/").concat(o.reservationId),a={adults:0,checkInDate:W.checkInDate,checkOutDate:W.checkOutDate,hotelId:o.hotel.id,minors:0,modify:"true",reservationId:o.reservationId,reservationRatePlanCode:o.reservation.rooms[0].ratePlanCode,returnPath:n,rooms:o.reservation.rooms?o.reservation.rooms.length:1};o.reservation.rooms[0].ratePlanCode===I.RATE_PLAN_CODES.SRD&&(a.lastName=o.reservation.guest.lastName,a.loyaltyAccountNumber=o.reservation.guest.loyaltyAccountNumber,a.loyaltyProgramId=o.reservation.guest.loyaltyProgramId);var i=F.getPropertyRatesUrl(o.hotel.address,o.hotel.brandCode,o.hotel.id,q);o.reservation.rooms.forEach((function(t,r){e=r?r+1:"",I.ROOM_QUERY_PARAMS.forEach((function(t){o.reservation.rooms[r][t]&&(r>0&&("adults"===t||"minors"===t)?a[t]+=o.reservation.rooms[r][t]:a[t+e]=o.reservation.rooms[r][t])}))})),m.SO_MOB_PRATES_NEW_JOIN||m.MW_PROPERTY_PAGE&&r.isMobile?t.path(i).hash(_.CHANGE_RESERVATION_HASH).search(a):(M.update(a),t.path(i).search(a))},o.cancel=function(){l.clearReservationContext(W.contextId),O.clear();var e=j.signedIn?_.CP_RESERVATIONS_DETAILS:_.NON_CP_RESERVATIONS_DETAILS;t.path("".concat(m.IWSR_MASTER?P.addLocaleToPath(e):e,"/").concat(o.reservationId))},o.runGuestInfoChanges=function(){var e,t={guest:(e=angular.copy(o.guestInfo),e&&(delete e.username,e.expirationMonth||delete e.expirationMonth,e.expirationYear||delete e.expirationYear,e.guaranteeMethod===h.GUARANTEE_TYPE.CREDIT_CARD&&(e.guaranteeMethod=h.GUARANTEE_METHOD.CREDIT_CARD),o.iwsGuaranteeHoldType&&(e.guaranteeMethod=o.iwsGuaranteeHoldType)),e)};m.GDC_MODIFY_RESERVATION&&(t=function(e){var t=angular.extend(e.guest,v.sendSMSSettings(e.guest));return t.mobilePhone=t.isMobileNumber?t.homePhone:"",delete t.mobilePhones,e}(t)),delete(t=function(e){U&&(e.guest.loyaltyAccountNumber=U);H&&(e.guest.loyaltyProgramId=H);return e}(t)).hotelId,delete t.ratePlan,delete t.checkInDate,delete t.checkOutDate,delete t.rooms,t.guaranteeMethod||(t.guaranteeMethod=t.guaranteeMethodSuggestion||h.GUARANTEE_METHOD_FOR_RATE_PLAN[W.ratePlan]||h.GUARANTEE_METHOD_DEFAULT),o.iwsGuaranteeHoldType&&(t.guaranteeMethod=o.iwsGuaranteeHoldType,re(t)),W.ratePlan===I.RATE_PLAN_CODES.SRD&&re(t),t.guest.isVirtualCreditCard=!o.reservation.cardRequired,o.guestInfo&&o.guestInfo.creditCardNumber?(g.inc(),G.tokenizeCreditCard(o.guestInfo.creditCardNumber,d.getCreditCardExpirationString(o.guestInfo.expirationMonth,o.guestInfo.expirationYear)).then((function(e){e&&(t.guest=function(e,t){e.creditCardNumber=t.token||e.cardToken||e.creditCardNumber||"",t.tokenResponseTimeStamp&&(e.tokenResponseTimeStamp=t.tokenResponseTimeStamp);t.responseSignature&&(e.responseSignature=t.responseSignature);t.keyAlias&&(e.tokenKeyAlias=t.keyAlias);return e}(t.guest,e))})).finally((function(){Q(t),g.dec()}))):Q(t)},o.changeGuestInfo=function(){!o.guestInfoForm||o.guestInfoForm.$valid?!o.guestForm||o.guestForm.$valid?(o.guestForm&&o.guestForm.cpNumber||{}).$modelValue&&!j.signedIn?y.getLoyaltyStatus({loyaltyAccountLastName:o.guestForm.lastName.$modelValue,loyaltyAccountNumber:o.guestForm.cpNumber.$modelValue}).then((function(e){o.guestForm.cpNumber.$setValidity("pattern",e.data.validCPNumber),e.data.validCPNumber&&o.guestForm.cpNumber.$setValidity("account",e.data.match),e.data.validCPNumber&&e.data.match?o.runGuestInfoChanges():o.guestForm.$submitted=!0})):o.runGuestInfoChanges():o.guestForm.$submitted=!0:o.guestInfoForm.$submitted=!0},o.acceptChanges=function(){var e,n={contextId:W.modifiableContextId,isModifyReservation:!0};g.inc(),angular.extend(n,N.getPendingReservationUpdates(W.contextId)),j.signedIn&&(n.guest=o.guestInfo,delete(e=n.guest).creditCardName,delete e.creditCardNumber,delete e.creditCardType,delete e.expirationMonth,delete e.expirationYear,A.removeUndefinedProperties(n.guest)),n.guest||(n.guest={}),n.guest.isVirtualCreditCard=!o.reservation.cardRequired,o.reservation&&o.reservation.specialRequests&&(n.specialRequests=o.reservation.specialRequests),o.reservation&&o.reservation.guaranteePolicyCode&&(n.guaranteeMethod=o.reservation.guaranteePolicyCode),l.completeReservation(n).then((function(){l.updateConfirmation({hotel:o.hotel}),t.path(_.CONFIRMATION).search({referalReserve:"true"})})).catch((function(e){w.notify(L.CHANGE_RESERVATION_ERROR),o.modifyReservationError=!0,o.modifyReservationErrorMessage=function(e){if(e&&e.data){var t=e.data,n=t.inputErrors,a=t.outputErrors;if(n){var i=z.find((function(e){return n[e]}));if(i)return n[i]}else if(a){var s=K.find((function(e){return a[e]}));if(s)return a[s]}}return r.strings.reservation.change.modifyReservationError.replace("{phoneNumber}",o.hotel.phone)}(e),r.$emit(p.ANALYTICS_PAGE_LOADED,b.MODIFY_RESERVATION_PAGE)})).finally(g.dec)},o.showCreditCardFields=function(e){if(o.iwsGuaranteeHoldType)return!1;var t=(e||o.checkout||{}).guaranteeMethod;return"PLANNER_PAYS"!==o.chargeRouting&&(W.ratePlan!==I.RATE_PLAN_CODES.SRD&&(!t||t!==h.GUARANTEE_METHOD.LOYALTY_POINTS))},o.$on(p.LOGGED_OUT,(function(){v.resetGuestInfo(o.guestInfo),o.checkout.guest=o.guestInfo})),o.$on(p.LOGGED_IN,(function(){Y=j.lastName,J()})),o.calculateSelectedNightlyRate=function(e){return E.calculateSelectedNightlyRate(e,o.reservation.currencyCode)},o.toggleReview=function(){o.hubState.reviewing=!o.hubState.reviewing,r.$emit(p.ANALYTICS_PAGE_LOADED,b.MODIFY_RESERVATION_PAGE)},o.showHideCreditFields=function(){te(),o.showCreditCardFields()},m.MODIFY_RESERVATION_FLOW&&m.RESERVATION_DETAILS_PAGE_REACT&&!r.isMobile||(o.reservationId=a.reservationId,o.guestInfo={},o.checkout={guest:o.guestInfo},o.checkout.ratePlan=W.ratePlan,o.modifiableContextId=W.modifiableContextId,o.guestDataAgreement1=n.trustAsHtml(r.strings.guestData.agreement1),o.hubState={reviewing:!1},Y?J():m.MODIFY_RESERVATION_FLOW&&i.store&&i.store.dispatch({context:W,type:"CREATE_CHECKOUT_CONTEXT"}),m.GDC_MODIFY_RESERVATION&&(o.showMobilePhoneLabel=!0),c.newRateSelected&&"S3A"===o.checkout.ratePlan&&!o.cpUser.aaaNumber&&t.path("".concat(m.IWSR_MASTER?P.addLocaleToPath(_.CHANGE_RESERVATION):_.CHANGE_RESERVATION,"/").concat(o.reservationId).concat(_.GUESTDATA)),s.init(o),m.MODIFY_RESERVATION_FLOW?r.$emit(p.ANALYTICS_PAGE_LOADED,b.MODIFY_RESERVATION_PAGE,p.PAGE_LOADED):r.$emit(p.ANALYTICS_PAGE_LOADED,b.MODIFY_RESERVATION_PAGE),(V=(B=O.get()).reservation?B.reservation.groupId:null)&&f.getGroup(V).then((function(e){o.chargeRouting=e.chargeRouting})))}]},function(e,t){function r(){return(r=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e}).apply(this,arguments)}function n(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var o=function(){function e(t,n,o,a){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),r(this,{$scope:t,$window:n,reactConst:o,reactHelper:a})}var t,o,a;return e.$inject=["$scope","$window","reactConst","reactHelper"],t=e,(o=[{key:"$onInit",value:function(){var e=this;this.reactHelper.loadReactApp((function(){return e.loadModifyReservationPage()}))}},{key:"loadModifyReservationPage",value:function(){var e=this.$window.React.createElement(this.$window.ModifyReservationPage),t=this.reactHelper.generateProviderElement(e);this.reactHelper.renderToScope(t,document.getElementById("modifyReservationPage"),this.$scope)}}])&&n(t.prototype,o),a&&n(t,a),e}();e.exports={controller:o,template:'<div id="modifyReservationPage"></div>'}},function(e,t){function r(){return(r=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e}).apply(this,arguments)}function n(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var o=function(){function e(t,n,o){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),r(this,{$scope:t,$window:n,reactHelper:o})}var t,o,a;return e.$inject=["$scope","$window","reactHelper"],t=e,(o=[{key:"$onInit",value:function(){var e=this;this.reactHelper.loadReactApp((function(){return e.loadModifyGuestdataPage()}))}},{key:"loadModifyGuestdataPage",value:function(){var e=this.$window.React.createElement(this.$window.ModifyGuestdataPage),t=this.reactHelper.generateProviderElement(e);this.reactHelper.renderToScope(t,document.getElementById("modifyGuestdataPage"),this.$scope)}}])&&n(t.prototype,o),a&&n(t,a),e}();e.exports={controller:o,template:'<div id="modifyGuestdataPage"></div>'}},function(e,t){function r(){return(r=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e}).apply(this,arguments)}function n(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var o=function(){function e(t,n,o){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),r(this,{$scope:t,$window:n,reactHelper:o})}var t,o,a;return e.$inject=["$scope","$window","reactHelper"],t=e,(o=[{key:"$onInit",value:function(){var e=this;this.reactHelper.loadReactApp((function(){return e.loadModifyGuestPaymentPage()}))}},{key:"loadModifyGuestPaymentPage",value:function(){var e=this.$window.React.createElement(this.$window.ModifyGuestPaymentPage),t=this.reactHelper.generateProviderElement(e);this.reactHelper.renderToScope(t,document.getElementById("modifyGuestPaymentPage"),this.$scope)}}])&&n(t.prototype,o),a&&n(t,a),e}();e.exports={controller:o,template:'<div id="modifyGuestPaymentPage"></div>'}},function(e,t){e.exports=["$location","$rootScope","$window","analyticsConst","analyticsManager","omniture","omnitureConst","pagesConst","routeConst",function(e,t,r,n,o,a,i,s,c){return{init:function(r){o.initialize(),a.clearPreviousProperties();var n=-1!==e.url().indexOf(c.GUESTDATA);o.setPageDefaults({ERROR_MESSAGES:function(){var e="";return r.modifyReservationError&&(e=r.modifyReservationErrorMessage||t.strings.reservation.change.modifyReservationError),e},PAGE_NAME:function(){return r.modifyReservationError?i.PAGE_NAME.MODIFY_RESERVATION_REVIEW_ERROR:n?i.PAGE_NAME.MODIFY_RESERVATION_GUEST_INFO:r.hubState&&r.hubState.reviewing?i.PAGE_NAME.MODIFY_RESERVATION_REVIEW:i.PAGE_NAME.MODIFY_RESERVATION}},s.MODIFY_RESERVATION_PAGE)}}}]},function(e,t,r){e.exports=angular.module("chApp.account.reservations.details",[]).controller("ReservationDetailsPageCtrl",r(514)).factory("reservationDetailsPageAnalytics",r(515)).component("chReactReservationDetailsPage",r(516))},function(e,t){e.exports=["$document","$location","$rootScope","$scope","$stateParams","$window","checkoutContextData","contentService","cpUserData","currencyHelper","dateHelper","exteriorImageIndexHelper","eventsConst","featureFlags","generateCalendarService","globalLoaderCounter","guestdataConst","guestdataFormatter","hotelHelper","hotelService","localeService","pagesConst","ratePlanHelper","reservationCheckoutData","reservationData","reservationDetailsPageAnalytics","reservationService","routeConst","selectedLangData","sessionStorageHelper","strings","urlParserService",function(e,t,r,n,o,a,i,s,c,l,u,d,p,m,g,f,h,E,v,y,C,P,A,b,R,S,I,T,O,N,_,D){n.reservation={},n.hotel={},n.reservationId=o.reservationId,n.pageName=P.RESERVATION_DETAILS,n.shouldHideCalendarInvite=!1,n.shouldHideGuaranteePolicy=!1;var M,k=N.getRSVPLastname(),L=O.get().code,w=N.getGroupAdminContext();function $(e){if(e.reservation.ratePlanDetail)n.reservation.ratePlan=e.reservation.ratePlanDetail,n.reservation.ratePlanName=n.reservation.ratePlan.name+A.getMemberStatus(e.reservation.ratePlanDetail);else{var t=e.reservation.ratePlan;t&&(n.reservation.ratePlan=A.getRatePlan(t),n.reservation.ratePlanName=n.reservation.ratePlan.name+A.getMemberStatus(t))}e.hotel&&(n.shouldHideGuaranteePolicy=m.AMR_MASTER&&v.shouldHideGuaranteePolicy(e.hotel),n.shouldHideCalendarInvite=v.shouldHideCalendarInvite(e.hotel)),n.propertyUrl=D.getPropertyUrl(e.hotel.address,e.hotel.brandCode,e.hotel.id,L),e.reservation.cancellationDeadline&&(n.cancellationDeadline=e.reservation.cancellationDeadline.split("[")[0].replace(/[+-]\d\d:\d\d/,""),n.cancellationTimeZone=e.hotel.address.city),e.reservation.totalAfterTax&&e.reservation.totalBeforeTax?n.taxes=(e.reservation.totalAfterTax-e.reservation.totalBeforeTax).toFixed(2):e.reservation.rooms&&(n.totalPoints=e.reservation.rooms.map((function(e){return e.points||0})).reduce((function(e,t){return e+t}),0))}function x(e){f.inc(),y.getHotel(e.id,"relative_media").then((function(e){n.hotel.images=e.images})).finally(f.dec)}n.isGroupAdmin=function(){return w&&w.adminId&&w.groupCode&&c.get().signedIn&&c.get().cpLoyaltyProgramId===w.cpLoyaltyProgramId&&c.get().cpLoyaltyAccountNumber===w.cpLoyaltyAccountNumber||!1},w&&(n.adminId=w.adminId,n.groupCode=w.groupCode,n.handleManageGroup=function(){N.deleteGroupAdminContext()}),n.getPaymentMethodHeader=function(e){var t=_.general;if(!m.AMR_PARTIAL_PAYMENTS)return t.paymentPolicy;switch(e){case h.PAYMENT_TYPE.FULL_PAYMENT:return t.paymentPolicyFull;case h.PAYMENT_TYPE.FLEXIBLE_PAYMENT:return t.paymentPolicyFlexible;default:return t.paymentPolicy}},n.calculateSelectedNightlyRate=function(e){return E.calculateSelectedNightlyRate(e,n.reservation.currencyCode)},n.toggleEditMode=function(e){n.editMode===e?n.editMode="":(n.editMode=e,n.cancelModel.email=n.reservation.guest&&n.reservation.guest.email||""),r.$emit(p.ANALYTICS_PAGE_LOADED,n.pageName)},n.cancelEdit=function(){n.editMode="",r.$emit(p.ANALYTICS_PAGE_LOADED,n.pageName)},n.changeReservation=function(){f.inc(),I.modifyReservation(n.reservationId,{lastName:k}).then((function(e){b.update(e),n.reservation.guest=e.checkout.guest,x(n.hotel),i.clear(),N.setRSVPLastname(k),t.path("".concat(m.IWSR_MASTER?C.addLocaleToPath(T.CHANGE_RESERVATION):T.CHANGE_RESERVATION,"/").concat(n.reservationId))})).catch((function(e){e.outputErrors&&e.outputErrors.INVALID_RESERVATION_NOT_MODIFIABLE&&(n.modificationFailed=!0)})).finally(f.dec)},n.cancelReservation=function(o){if(n.cancelSubmitted=!0,o.$valid){n.editMode="";var a={confirmationId:n.reservationId};n.cancelModel.email&&(a.email=n.cancelModel.email),k?(a.lastName=k,f.inc(),I.cancelReservation(a).then((function(t){n.reservation.cancellationId=t.cancellationId,n.reservationCancelled=!0,n.cancelInfoMessages=t.outputInfo,e.scrollTop(0,500)})).catch((function(){n.cancellationFailed=!0})).finally(f.dec)):t.url(T.CP_RESERVATIONS)}r.$emit(p.ANALYTICS_PAGE_LOADED,n.pageName)},n.print=function(){a.print()},n.generateCalendarFile=function(){var e="".concat(t.protocol(),"://").concat(t.host());n.reservation.hotel=n.hotel,g.generateCalendarFile(n.reservation,e,n.propertyUrl)},n.$on(p.LOGGED_OUT,(function(){t.path(T.CP_RESERVATIONS)})),m.RESERVATION_DETAILS_PAGE_REACT&&!r.isMobile||(S.init(n),r.$emit(p.ANALYTICS_PAGE_LOADED,n.pageName)),!m.RESERVATION_DETAILS_PAGE_REACT||r.isMobile?(n.getExteriorImageIndex=d.getExteriorImageIndex,function(){if(M=R.get(),!k||R.isEmpty()||!M.reservation||M.reservation.ratePlanDetail&&M.reservation.ratePlan!==M.reservation.ratePlanDetail.ratePlanCode)if(k){var e={confirmOrCancelId:n.reservationId,guestDataSource:"RESERVATION",lastName:k,searchType:"CONFIRMATION"};f.inc(),I.getReservation(e).then((function(e){R.update(e),e.reservation&&(n.reservation=e.reservation||{},n.hotel=e.hotel||{},n.shouldHideLPG=m.AMR_MASTER&&v.shouldHideLPG(n.hotel),n.isAMResort=m.AMR_MASTER&&v.isHotelAMResort(n.hotel),n.shouldShowTaxIncluded=n.reservation&&v.shouldShowTaxIncluded(n.reservation.totalAfterTax,n.reservation.totalBeforeTax,n.isAMResort),$(e),x(n.hotel))})).finally(f.dec)}else N.setRSVPConfirmId(+n.reservationId),t.url(T.CP_RESERVATIONS);else n.reservation=M.reservation||{},n.hotel=M.hotel||{},n.isAMResort=m.AMR_MASTER&&v.isHotelAMResort(n.hotel),n.shouldHideLPG=m.AMR_MASTER&&v.shouldHideLPG(n.hotel),n.shouldShowTaxIncluded=n.reservation&&v.shouldShowTaxIncluded(n.reservation.totalAfterTax,n.reservation.totalBeforeTax,n.isAMResort),x(n.hotel),$(M)}(),n.formatCurrency=l.formatCurrency,n.formatDateString=u.formatDateString,n.editMode="",n.cancelModel={email:c.get().email||""},s.getHTMLFragment("choice-hotels/reservation-cancellation-full-blade-promo","module").then((function(e){n.fullBladePromo=e}))):n.lastName=k}]},function(e,t){e.exports=["$rootScope","analyticsConst","analyticsManager","dateHelper","omniture","omnitureConst","pagesConst",function(e,t,r,n,o,a,i){return{init:function(t){r.initialize(),o.clearPreviousProperties();var s={ERROR_MESSAGES:function(){if(t.cancellationFailed)return e.strings.reservation.errors.cancellationError},EVENTS:function(){if(t.reservationCancelled){var e=n.getToday("yyMMdd");return"event43:".concat(t.reservation.cancellationId).concat(e)}},PAGE_NAME:function(){return t.editMode?a.PAGE_NAME.CANCEL_RESERVATION_POP:t.cancelSubmitted&&t.reservationCancelled?a.PAGE_NAME.CANCELLED_RESERVATION:t.cancelSubmitted&&t.reservation.cancelExpired?a.PAGE_NAME.CANCEL_RESERVATION_ERROR:a.PAGE_NAME.VIEW_RESERVATION}};r.setPageDefaults(s,i.RESERVATION_DETAILS)}}}]},function(e,t){function r(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var n=function(){function e(t,r,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.$scope=t,this.$window=r,this.reactHelper=n}var t,n,o;return e.$inject=["$scope","$window","reactHelper"],t=e,(n=[{key:"$onInit",value:function(){var e=this;this.reactHelper.loadReactApp().then((function(){e.loadReservationDetails()}))}},{key:"loadReservationDetails",value:function(){var e=this.$window.React.createElement(this.$window.ReservationDetailsPage,{confirmationId:this.confirmationId,lastName:this.lastName}),t=this.reactHelper.generateProviderElementWithPageContext(e,this.pageId);this.reactHelper.renderToScope(t,document.getElementById("react-reservation-details"),this.$scope)}}])&&r(t.prototype,n),o&&r(t,o),e}();e.exports={bindings:{confirmationId:"<",lastName:"<"},controller:n,template:'<div id="react-reservation-details"></div>'}},function(e,t){function r(){return(r=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e}).apply(this,arguments)}function n(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var o=function(){function e(t,n,o,a,i,s,c,l){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),r(this,{$location:t,$scope:n,$window:o,omniture:a,omnitureConst:i,reactHelper:s,reservationData:c,strings:l})}var t,o,a;return e.$inject=["$location","$scope","$window","omniture","omnitureConst","reactHelper","reservationData","strings"],t=e,(o=[{key:"$onInit",value:function(){var e=this.$location,t=this.$scope,r=this.$window,n=this.reactHelper,o=e.search(),a=Boolean(o&&o.bookOnGoogle);this.updateOmniturePageName(a),n.loadReactApp((function(){var e=r.React,o=r.ReservationManagerPage;n.renderToScope(n.generateProviderElement(e.createElement(o,{includesBookOnGoogle:a})),"#react-reservation-manager",t)}))}},{key:"updateOmniturePageName",value:function(e){var t=this.$scope,r=this.omniture,n=this.omnitureConst,o=this.strings;e?(t.omniturePageName=n.PAGE_NAME.FIND_RESERVATION_ERROR,r.reSendAnalyticsViaPageLoad({prop19:o.reservation.bookOnGoogleErrorText})):t.omniturePageName=n.PAGE_NAME.FIND_RESERVATION}}])&&n(t.prototype,o),a&&n(t,a),e}();e.exports={controller:o,templateUrl:["siteConfig",function(e){return"/".concat(e.assetFingerprint,"/app/account/reservations/react-reservation-manager-page/react-reservation-manager-page.html")}]}},function(e,t){e.exports={DAY_GROUPS:{ALL_STAYS:540,RECENT_STAYS:30},RESERVATION_STATUS:{CANCELLED:"Cancelled",NO_SHOW:"No show",SELL_CHECKED_OUT:"Sell-checked out"}}},function(e,t){e.exports=["$location","$rootScope","$scope","dateHelper","featureFlags","globalLoaderCounter","localeHelper","localeService","omniture","omnitureConst","reservationData","reservationCheckoutData","reservationService","routeConst","sessionStorageHelper","strings","unconsolidatedReservationHelper",function(e,t,r,n,o,a,i,s,c,l,u,d,p,m,g,f,h){function E(e){h.getErrorMessage(e).then((function(e){r.reservationErrors=e}))}function v(e){e.outputErrors?(e.outputErrors.UNEXPECTED_FAILURE_RESERVATION_INFO&&e.reservationSummaries?E(e):e.outputErrors.INVALID_RESERVATION_TYPE&&u.get().reservationSummaries&&E(u.get()),r.reservationErrors=e.outputErrors):e.inputErrors?r.reservationErrors=e.inputErrors:e.outputInfo?r.reservationErrors=e.outputInfo:"ERROR"===e.status&&(r.reservationErrors={INVALID_RESERVATION_ID:e.status})}r.initDate=n.getTodayDate(),r.isHotelReservationSearch=!0,r.reservations={confirmation:{confirmation:g.getRSVPConfirmId(),lastName:""},guest:{checkIn:r.initDate,creditCard:"",hotelCode:"",lastName:""}},g.setRSVPConfirmId(null),g.setRSVPLastname(null),r.submittedForm="",r.reservationErrors="",r.searchParams=e.search(),r.searchParams&&r.searchParams.bookOnGoogle?(r.omniturePageName=l.PAGE_NAME.FIND_RESERVATION_ERROR,c.reSendAnalyticsViaPageLoad({prop19:f.reservation.bookOnGoogleErrorText})):r.omniturePageName=l.PAGE_NAME.FIND_RESERVATION,r.dateFormat=i.getDateFormat(),r.submitReservations=function(i){var c={guestDataSource:"",lastName:"",searchType:""};if(r.reservationErrors="",r.submittedForm=i,r[r.submittedForm].$setSubmitted(),r[r.submittedForm].$valid)"reservationsConfirmationForm"===r.submittedForm?(c.searchType="CONFIRMATION",c.confirmOrCancelId=r.reservations.confirmation.confirmation,c.lastName=r.reservations.confirmation.lastName,c.guestDataSource="RESERVATION"):(c.searchType="HOTEL_STAY",c.hotelId=r.reservations.guest.hotelCode,c.lastName=r.reservations.guest.lastName,c.checkInDate=n.parseToIso(r.reservations.guest.checkIn).substring(0,10),c.creditCardNumber=r.reservations.guest.creditCard.replace(/\d(?=\d{4})/g,"9")),function(r){a.inc(),p.getReservation(r).then((function(n){if("ERROR"===n.status||n.outputInfo&&n.outputInfo.NONEXISTENT_RESERVATION_INFO)v(n),g.setRSVPLastname(null);else{var a=t.cpUser.signedIn?m.CP_RESERVATIONS_DETAILS:m.NON_CP_RESERVATIONS_DETAILS,i=n.reservation&&n.reservation.confirmationId||n.reservationSummaries&&n.reservationSummaries[0].confirmationId;u.update(n),g.setRSVPLastname(r.lastName),e.path("".concat(o.IWSR_MASTER?s.addLocaleToPath(a):a,"/").concat(i)),e.search({})}})).catch(v).finally(a.dec)}(c);else{var l=document.querySelector('form[name="'.concat(r.submittedForm,'"] .ng-invalid'));l&&l.focus()}},r.toggleReservationConfirmationPage=function(e){r.isHotelReservationSearch=e}}]},function(e,t){e.exports=["siteConfig",function(e){return{controller:"ReservationsPageCtrl",replace:!0,restrict:"E",templateUrl:"/".concat(e.assetFingerprint,"/app/account/reservations/find-reservation-form.html")}}]},function(e,t){e.exports=["$location","featureFlags","globalLoaderCounter","localeService","reservationData","routeConst","sessionStorageHelper",function(e,t,r,n,o,a,i){return{goToReservation:function(r){i.setRSVPLastname(r.lastName),o.clear();var s=r.confirmationId;!s&&r.externalConfirmationIdList&&(s=r.externalConfirmationIdList[0]),e.path("".concat(t.IWSR_MASTER?n.addLocaleToPath(a.CP_RESERVATIONS_DETAILS):a.CP_RESERVATIONS_DETAILS,"/").concat(s)),e.search({})}}}]},function(e,t){e.exports=["$q","hotelService","strings",function(e,t,r){return{getErrorMessage:function(n){var o,a,i=e.defer();return t.getHotel(n.reservationSummaries[0].hotelId).then((function(e){o=e,a="".concat(r.reservation.errors.UNCONSOLIDATED_RESERVATION,"\n").concat(o.name," ").concat(o.phone),i.resolve({UNCONSOLIDATED_RESERVATION_ERROR_MESSAGE:a})})),i.promise}}}]},function(e,t,r){e.exports=angular.module("chApp.account.resetPassword",[]).controller("ResetPasswordPageCtrl",r(524))},function(e,t){e.exports=["$location","$scope","$stateParams","$timeout","routeConst","userService",function(e,t,r,n,o,a){function i(){t.unexpectedErrorMessage=!1,t.resetPasswordSuccessMessage=!1,t.invalidMemberCredentials=!1}t.submitResetPassword=function(s){if(s&&!1===s.$valid)s.$submitted=!0;else{var c=r.userToken,l=t.password;a.sendResetPassword({password:l,token:c}).then((function(){i(),t.resetPasswordSuccessMessage=!0,n((function(){e.path("/")}),5e3)})).catch((function(r){i(),r.outputErrors.INVALID_LOYALTY_MEMBER_CREDENTIALS?t.invalidMemberCredentials=!0:(t.unexpectedErrorMessage=!0,n((function(){e.path(o.CP_FORGOT_CREDENTIALS)}),5e3))}))}}}]},function(e,t,r){e.exports=angular.module("chApp.account.unsubscribe",[]).controller("ModifyUnsubscribePageCtrl",r(526)).controller("UnsubscribePageCtrl",r(527)).factory("unsubscribeService",r(528))},function(e,t){e.exports=["$document","$rootScope","$scope","$uibModal","countryDataUtils","globalLoaderCounter","membershipConstant","modifyUnsubscribe","profileHelper","strings","unsubscribeService","values",function(e,t,r,n,o,a,i,s,c,l,u,d){r.email=s.email;var p,m=s.token;function g(){e.scrollTop(0,500)}a.inc(),u.getPreferencesWithToken(m).then((function(e){r.myPreferences=e.emailPreferences,r.privacyPreferenceGroup=o.getPrivacyPreferenceGroupWithCountries(e.country,d.countries),r.emailPreferences=i.memberFormPrivacyByCountry[r.privacyPreferenceGroup].options,p=e.guestId})).catch((function(){r.unsubscribeTokenError=!0})).finally(a.dec),r.savePreferences=function(){a.inc(),r.unsubscribeSuccess=!1,r.unsubscribeError=!1,r.unsubscribeTokenError=!1,r.unsubscribeErrorMessage="",angular.forEach(r.myPreferences,(function(e,t){var n=!1;angular.forEach(r.emailPreferences,(function(e){t===e.id&&e.edit&&(n=!0)})),n||delete r.myPreferences[t]})),u.savePreferences(r.email,r.myPreferences,p).then((function(){r.unsubscribeSuccess=!0,g()})).catch((function(e){r.unsubscribeError=!0,e&&e.outputErrors&&!e.outputErrors.UNAVAILABLE_EMAIL_PREFERENCES&&!e.outputErrors.UNEXPECTED_FAILURE_EMAIL_PREFERENCES?r.unsubscribeErrorMessage=e.outputErrors[Object.keys(e.outputErrors)[0]]:r.unsubscribeErrorMessage=l.account.errors.unsubscribeErrorMessage,g()})).finally(a.dec)},r.setCommunicationPreferences=function(e){c.setCommunicationPreferences(e,r.myPreferences,r.emailPreferences)},r.openBusinessPartners=function(){n.open({size:"lg",templateUrl:"/".concat(t.assetFingerprint,"/app/account/unsubscribe/business-partners.modal.html")})}}]},function(e,t){e.exports=["$scope","unsubscribeService","globalLoaderCounter","strings",function(e,t,r,n){e.unsubscribeInfo={},e.unsubscribeInfo.sendEmail=!1,e.unsubscribe=function(o){if(!o||!1!==o.$valid){var a={partnerShare:!e.unsubscribeInfo.sendEmail,sendEmail:!e.unsubscribeInfo.sendEmail,sendNewsletterEmail:!e.unsubscribeInfo.sendEmail,sendPartnerEmail:!e.unsubscribeInfo.sendEmail,sendPromotionalEmail:!e.unsubscribeInfo.sendEmail,sendSurveyEmail:!e.unsubscribeInfo.sendEmail};r.inc(),e.unsubscribeSuccess=!1,e.unsubscribeError=!1,e.unsubscribeErrorMessage="",t.savePreferences(e.unsubscribeInfo.email,a).then((function(){e.unsubscribeSuccess=!0})).catch((function(t){e.unsubscribeError=!0,t&&t.outputErrors&&!t.outputErrors.UNAVAILABLE_EMAIL_PREFERENCES&&!t.outputErrors.UNEXPECTED_FAILURE_EMAIL_PREFERENCES?e.unsubscribeErrorMessage=t.outputErrors[Object.keys(t.outputErrors)[0]]:e.unsubscribeErrorMessage=n.account.errors.unsubscribeErrorMessage})).finally(r.dec)}}}]},function(e,t){function r(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function n(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?r(Object(n),!0).forEach((function(t){o(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):r(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function o(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}e.exports=["$http","$locale","$q","featureFlags","localeService","urlEncodeObject",function(e,t,r,o,a,i){return{getPreferencesWithToken:function(o){var i=n({preferredLocaleCode:t.id,token:o},a.getSiteNameObj());return e.get("/webapi/user-account/email-preferences",{cache:!1,params:i}).then((function(e){return e.data})).catch((function(e){return r.reject(e.data)}))},savePreferences:function(o,s,c){var l=r.defer(),u=n({preferredLocaleCode:t.id},a.getSiteNameObj());return c?u.guestId=c:u.email=o,angular.extend(u,s),e({data:i(u),headers:{"content-type":"application/x-www-form-urlencoded"},method:"POST",url:"/webapi/user-account/email-preferences"}).then((function(e){l.resolve(e.data)}),(function(e){l.reject(e.data)})),l.promise}}}]},function(e,t,r){e.exports=angular.module("chApp.bookingAgent",[]).directive("chBookingAgentSignInForm",r(530)).factory("bookingAgentSignInService",r(531))},function(e,t){e.exports=["bookingAgentSignInService","siteConfig","globalLoaderCounter",function(e,t,r){return{link:function(t){function n(e){angular.extend(t.agentSignInData,{agentId:e.agentId,callCenterId:e.callCenterId,dutyCode:e.dutyCode,firstName:e.agentFirstName,password:null,signedIn:!0,surname:e.agentSurname})}function o(){delete t.signInErrors,delete t.signOutErrors,t.agentSignInData={signedIn:t.agentSignInData.signedIn}}angular.extend(t,{agentSignInData:{signedIn:!1},expanded:!1,signInAgent:function(){if(t.agentSignInForm.$setSubmitted(),delete t.signInErrors,t.agentSignInForm.$valid){var o=t.agentSignInData;r.inc(),e.signInAgent(o.agentId.toUpperCase(),o.password,o.dutyCode?o.dutyCode.toUpperCase():null,o.callCenterId?o.callCenterId.toUpperCase():null).then((function(e){n(e)})).catch((function(e){t.signInErrors=e.outputErrors})).finally(r.dec)}},signOutAgent:function(){t.agentSignOutForm.$setSubmitted(),delete t.signOutErrors,o(),r.inc(),e.signOutAgent().then((function(){t.agentSignInData.signedIn=!1})).catch((function(e){t.signOutErrors=e.outputErrors})).finally(r.dec)},toggleExpand:function(){o(),t.expanded?t.expanded=!1:(r.inc(),e.getSignedInAgent().then((function(e){n(e)})).finally((function(){r.dec(),t.expanded=!0})))}})},replace:!0,restrict:"E",templateUrl:"/".concat(t.assetFingerprint,"/app/booking-agent/booking-agent-sign-in-form.html")}}]},function(e,t){e.exports=["$http","$q","selectedLangData","urlEncodeObject",function(e,t,r,n){var o=r.get().code,a="".concat("/webapi/checkout","/agent");return{getSignedInAgent:function(){return e.get(a,{cache:!1}).then((function(e){return e.data}))},signInAgent:function(r,a,i,s){var c=t.defer(),l={"bookingAgent.agentId":r,"bookingAgent.password":a,preferredLanguageCode:o};return i&&(l["bookingAgent.dutyCode"]=i),s&&(l["bookingAgent.callCenterId"]=s),e.post("/webapi/checkout",n(l),{cache:!1,headers:{"Content-Type":"application/x-www-form-urlencoded"}}).then((function(e){c.resolve(e.data.checkout.bookingAgent)}),(function(e){c.reject(e.data)})),c.promise},signOutAgent:function(){return e.delete(a,{cache:!1})}}}]},function(e,t,r){e.exports=angular.module("chApp.choicePrivileges",[]).controller("ReferAFriendCtrl",r(533)).controller("DelinkedAccountErrorCtrl",r(534)).constant("barclaysApplicationConst",r(535)).directive("chBarclaysApplication",r(536)).directive("chReactGolfByChoice",r(538)).directive("chCpVisaBanner",r(539)).service("choicePrivilegesService",r(540)).service("cpVisaEligibilityService",r(541)).service("referAFriendHelper",r(542))},function(e,t){var r=["$controller","$location","$scope","choicePrivilegesService","cmsContent","cpUserData","eventsConst","formHelper","globalLoaderCounter","omniture","omnitureConst","pageEventsHelper","pagesConst","referAFriendHelper","scrollHelper",function(e,t,r,n,o,a,i,s,c,l,u,d,p,m,g){function f(){if(!r.referAFriendForm.$invalid){c.inc();var e=m.getRequestDataFromForm(r.referAFriendForm);n.referAFriend(e).then(h).catch(E).finally(c.dec)}}function h(){t.path("/choice-privileges/refer-a-friend/confirmation")}function E(e){var t;r.inputErrors=e.data.inputErrors,r.formErrorMessage=m.getFormErrorMessage(e.data.outputErrors),g.scrollToFirstError(),t=m.getOmnitureErrorString(r.referAFriendForm,r.inputErrors,r.formErrorMessage),l.sendAnalyticsViaPageLoad({pageName:u.PAGE_NAME.REFER_A_FRIEND_ERROR,prop19:t})}function v(e){return m.getValidationErrors(r.referAFriendForm,e,r.inputErrors)}angular.extend(this,e("ContentPageCtrl",{$location:t,$scope:r,cmsContent:o,eventsConst:i,pageEventsHelper:d,pagesConst:p})),r.referrals=new Array(m.NUMBER_OF_REFERRAL_INPUTS),r.submitForm=f,r.getValidationErrors=v}];e.exports=r},function(e,t){e.exports=["$scope","$window","reactHelper",function(e,t,r){var n=r.generatePageId();r.loadReactApp((function(){var o=t.DelinkedAccountError,a=t.Provider,i=t.React,s=t.store;r.renderToScope(i.createElement(a,{pageId:n,store:s},i.createElement(o)),"#ch-delinked-account-error",e)}))}]},function(e,t){e.exports={DECISION_CODE:{APPROVED:"APPROVED",PENDING:"PENDING"},POPUP:{name:"BarclaysApplication",settings:{height:745,left:385,resizable:"yes",scrollbars:"yes",toolbar:"no",top:185,width:945}},POSTBACK_KEY:"chTokenizedData",REFERRER_ID:{MINI_BANNER:"PTRFACHBPGDPT2517"},REQUIRED_FIELDS:{address:["line1","city","country"],guest:["firstName","lastName","address"]},SUPPORTED_FIELDS:["address","cpNumber","email","firstName","homePhone","lastName"]}},function(e,t,r){e.exports=["$window","barclaysService","barclaysApplicationConst","checkoutContextData","checkoutService","cpUserData","objectHelper","siteConfig","urlUtils",function(e,t,n,o,a,i,s,c,l){return{link:function(r){var u=o.get(),d=!1;function p(){(!i.get().signedIn&&r.guestData?t.postApplicationData(u.contextId,r.guestData):t.getApplicationData(u.contextId)).then((function(e){m(e.data)}),m)}function m(t){t=t||{};var o=document.createElement("form"),a=t.barclaysInstantCreditAppURL||c.barclays.instantCreditGenericURL;for(var i in r.isMiniBanner&&(a=l.addParameter(a,"referrerid",n.REFERRER_ID.MINI_BANNER)),o.action=a,o.method=t?"POST":"GET",o.target=n.POPUP.name,o.style.display="none",t.postParams)if(Object.prototype.hasOwnProperty.call(t.postParams,i)){var s=document.createElement("input");s.name=i,s.value=t.postParams[i],o.appendChild(s)}document.body.appendChild(o),o.submit(),document.body.removeChild(o),!d&&Object.keys(t).length>0&&(angular.element(e).on("storage",g),angular.element(e).on("message",g),d=!0)}function g(o){var a="";if("storage"===o.type&&o.key===n.POSTBACK_KEY)a=o.newValue;else{if("message"!==o.type||o.origin!==e.location.origin)return;a=o.data}r.$apply((function(){t.postBackNotify(a)})),f()}function f(){angular.element(e).off("storage",g),angular.element(e).off("message",g),e.localStorage.removeItem(n.POSTBACK_KEY),d=!1}r.$on("$destroy",f),r.handleClick=function(){var t;if(e.open("",n.POPUP.name,((t=angular.copy(n.POPUP.settings)).top+=e.screenY,t.left+=e.screenX,JSON.stringify(t).replace(/[{}"]/g,"").replace(/:/g,"="))),!r.guestData||r.isMiniBanner)return m();s.hasAllProperties(r.guestData,n.REQUIRED_FIELDS.guest)&&s.hasAllProperties(r.guestData.address,n.REQUIRED_FIELDS.address)?a.saveGuestIntoReservation({contextId:u.contextId,guest:s.pick(r.guestData,n.SUPPORTED_FIELDS)}).finally(p):p()}},replace:!0,restrict:"E",scope:{guestData:"<?",isMiniBanner:"<?"},template:r(537)}}]},function(e,t){e.exports='<button type="button" class="apply-now btn-transparent fs-14 text-semibold" ng-click="handleClick()">\n  {{$root.strings.cp.visaBanner.applyNow}}\n  <span class="ch-icon ch-icon-arrow-right"></span>\n</button>\n'},function(e,t){e.exports=["$window","loadReact","featureFlags","reactHelper",function(e,t,r,n){return{link:function(r){t().then((function(){n.loadReactApp((function(){var t=e.GolfByChoice,o=e.Provider,a=e.React,i=e.store;n.renderToScope(a.createElement(o,{store:i},a.createElement(t)),e.document.getElementById("ch-react-golf-by-choice"),r)}))}))},scope:!0,template:'<div id="ch-react-golf-by-choice"></div>'}}]},function(e,t){var r=["$locale","$scope","checkoutContextData","contentService","cpUserData","cpVisaBannerConst","cpVisaEligibilityService","deviceConst","eventsConst","featureFlags","guestdataAnalytics",function(e,t,r,n,o,a,i,s,c,l,u){var d=o.get();if(!i.showBanner())return null;function p(){var e=angular.copy(r.get());d=o.get(),t.isDiscountEligible=i.isDiscountEligible(d,e),t.isDiscountEligible&&(t.totalAfterTax=e.totalAfterTax),t.isBarclaysEligible=!d.signedIn||i.isValidCpUser(d)}angular.extend(t,{discountPrice:a.STATEMENT_CREDIT_AMOUNT,guestdataAnalytics:u,isBarclaysEligible:!0,isDiscountEligible:!1,totalAfterTax:0}),function(){n.getHTMLFragment(a.CMS_PATH_BANNER_GENERIC,"module").then((function(e){t.cpvBannerGeneric=e})),t.guestInfo&&n.getHTMLFragment(a.CMS_PATH_BANNER_DISCOUNT,"module").then((function(e){t.cpvBannerDiscount=e}));p()}(),t.$on(c.CP_USER_RETRIEVED,p)}];e.exports=["siteConfig",function(e){return{controller:r,replace:!0,restrict:"E",scope:{guestInfo:"<?guestData"},templateUrl:"/".concat(e.assetFingerprint,"/app/choice-privileges/cp-visa-banner/cp-visa-banner.html")}}]},function(e,t){function r(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function n(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}e.exports=["$http","$locale","cpUserData","featureFlags","localeService","objectHelper","urlEncodeObject",function(e,t,o,a,i,s,c){var l=function(e){for(var t=1;t<arguments.length;t++){var o=null!=arguments[t]?arguments[t]:{};t%2?r(Object(o),!0).forEach((function(t){n(e,t,o[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(o)):r(Object(o)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(o,t))}))}return e}({preferredLocaleCode:t.id},i.getSiteNameObj());return{referAFriend:function(t){return t=angular.extend({country:o.get().address.country},l,t),s.removeUndefinedProperties(t),e({data:c(t),headers:{"content-type":"application/x-www-form-urlencoded"},method:"POST",url:"/webapi/user-account/refer-loyalty-accounts"})}}}]},function(e,t){e.exports=["$locale","checkoutContextData","cpUserData","dateHelper","deviceConst","featureFlags","ratesConst","siteConfig",function(e,t,r,n,o,a,i,s){var c="en-us"===e.id,l=s.deviceType===o.DESKTOP;function u(e){return Object.keys(e).length>0&&e.hotel&&e.hotel.address&&"US"===e.hotel.address.country&&e.ratePlan!==i.RATE_PLAN_CODES.SRD&&e.ratePlan!==i.RATE_PLAN_CODES.PPC&&Math.floor(n.subtractDates(e.checkInDate,n.now()))>=14}function d(e){return"US"===e.address.country&&e.isBarclaysEligible}return{isDiscountEligible:function(e,t){return!!u(t)&&(!e.signedIn||d(e))},isValidCheckout:u,isValidCpUser:d,showBanner:function(){var e=r.get();return c&&a.CP_VISA_BANNER&&(a.CP_VISA_BANNER_MOBILE||l)&&(!e.signedIn||d(e))}}}]},function(e,t){e.exports=["formHelper","strings",function(e,t){function r(r,n,o){var a=e.errorFilter(r,r[n])||[];return a=a.map((function(e){return t.general.validationMessages[e]})),(o||{})[n]&&a.push(o[n]),a}return{NUMBER_OF_REFERRAL_INPUTS:5,getFormErrorMessage:function(e){return(e||{}).INVALID_LOYALTY_REFERRAL_CHOICE_PRIVILEGES_ACCOUNT_REQUIRED?e.INVALID_LOYALTY_REFERRAL_CHOICE_PRIVILEGES_ACCOUNT_REQUIRED:Object.keys(e||{}).length>0?t.general.errors.unexpected:null},getOmnitureErrorString:function(e,t,n){var o=["referral1FirstName","referral1Email","referral2FirstName","referral2Email","referral3FirstName","referral3Email","referral4FirstName","referral4Email","referral5FirstName","referral5Email"].map((function(n){return r(e,n,t)||[]})).reduce((function(e,t){return e.concat(t)}),[]);return n&&o.unshift(n),o.join().substr(0,100)},getRequestDataFromForm:function(e){for(var t,r,n={copyEmail:!!(e.copyEmail||{}).$modelValue},o=1;o<=5;o++)t="referral".concat(o,"FirstName"),r="referral".concat(o,"Email"),n[t]=(e[t]||{}).$modelValue,n[r]=(e[r]||{}).$modelValue;return n},getValidationErrors:r}}]},function(e,t,r){e.exports=angular.module("chApp.confirmation",[]).constant("confirmationConst",r(377)).controller("ConfirmationPageCtrl",r(544)).component("chReactWhatToExpect",r(545)).component("chReactConfirmationPage",r(378)).directive("chConfirmationEmail",r(379)).directive("chConfirmationEmailField",r(380)).factory("confirmationAnalytics",r(350)).factory("generateCalendarService",r(381))},function(e,t){function r(){return(r=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e}).apply(this,arguments)}e.exports=["$filter","$locale","$location","$rootScope","$stateParams","$scope","$transitions","$window","barclaysService","checkoutContextData","checkoutService","confirmationAnalytics","contentService","cookieConst","cookieHelper","cpUserData","cpVisaBannerConst","currencyHelper","dateHelper","eventsConst","exteriorImageIndexHelper","featureFlags","generateCalendarService","groupService","guestdataFormatter","hotelHelper","localeService","omniture","omnitureConst","pageEventsHelper","pagesConst","ratePlanHelper","ratesConst","selectedLangData","sessionStorageHelper","strings","thirdPartyMarketingService","urlParserService","userActivityDetailsService","userHelper",function(e,t,n,o,a,i,s,c,l,u,d,p,m,g,f,h,E,v,y,C,P,A,b,R,S,I,T,O,N,_,D,M,k,L,w,$,x,G,F,U){c.branch.closeJourney();var H=L.get().code;i.date=y.getTodayDate(),i.getExteriorImageIndex=P.getExteriorImageIndex,i.shouldHideCalendarInvite=!1,i.shouldHideGuaranteePolicy=!1,i.calculateSelectedNightlyRate=function(e){return S.calculateSelectedNightlyRate(e,i.reservation.currencyCode)},i.formatCurrency=function(e){return v.formatCurrency(e,i.reservation.currencyCode)},i.sendCpCreateAnalytics=function(){O.sendAnalyticsViaCustomLink({evar2:"Online Profile - CP",events:"event2, event4",linkTrackVars:"prop53,prop54",pageName:"My Account",prop53:"Confirm",prop54:"CreateProfileBTN"})},i.print=function(){c.print()},i.generateCalendarFile=function(){var e="".concat(n.protocol(),"://").concat(n.host());b.generateCalendarFile(i.reservation,e,i.propertyUrl)},i.cpUserData=h;var B,V=w.getGroupAdminContext();function j(t){if(U.verifyAkamaiResponse(t,i),t.enrollingInChoicePrivileges&&t.outputInfo){i.autoEnrollErrors=t.outputInfo;var n=e("userFriendlyErrorMessages")(i.autoEnrollErrors,$.account.errors.userAccountPostErrors);t.friendlyAutoEnrollErrors=e("toArray")(n)}t.hotel&&(i.propertyUrl=G.getPropertyUrl(t.hotel.address,t.hotel.brandCode,t.hotel.id,H)),i.reservation=t,i.shouldHideGuaranteePolicy=A.AMR_MASTER&&I.shouldHideGuaranteePolicy(t.hotel),i.shouldHideCalendarInvite=I.shouldHideCalendarInvite(t.hotel),i.isAMResort=I.isHotelAMResort(t.hotel),i.shouldShowTaxIncluded=I.shouldShowTaxIncluded(t.totalAfterTax,t.totalBeforeTax,i.isAMResort),c.store&&window.store.dispatch({confirmationData:i.reservation,type:"SET_CONFIRMATION_DATA"}),t.guest&&t.guest.cpNumber&&function(e){angular.extend(i,{createdNewCpProfile:!1,formState:{chooseUsername:!0},newCpUserData:{email:e.guest.email,firstName:e.guest.firstName,lastName:e.guest.lastName,loyaltyAccountNumber:e.guest.cpNumber,phoneNumber:e.guest.homePhone,postalCode:e.guest.address.postalCode}}),i.isGroupAdmin()&&(i.handleLoggedIn=function(){i.reservation.outputInfo&&i.reservation.outputInfo.INVALID_USERNAME_ALREADY_EXISTS&&delete i.reservation.outputInfo.INVALID_USERNAME_ALREADY_EXISTS,i.autoEnrollErrors&&i.autoEnrollErrors.INVALID_USERNAME_ALREADY_EXISTS&&delete i.autoEnrollErrors.INVALID_USERNAME_ALREADY_EXISTS,i.newCpUserData&&delete i.newCpUserData,delete i.formState,i.createdNewCpProfile=!0})}(t),i.didAutoSignin=i.isGroupAdmin()&&h.get().signedIn,(!A.CONFIRMATION_PAGE_REACT&&!o.isMobile||!A.MWEB_CONFIRMATION_PAGE_REACT&&o.isMobile)&&(p.init(i),o.$emit(C.ANALYTICS_PAGE_LOADED,D.CONFIRMATION)),t.ratePlanDetail?(i.reservation.ratePlan=t.ratePlanDetail,i.reservation.ratePlan.name+=M.getMemberStatus(i.reservation.ratePlan)):angular.isString(i.reservation.ratePlan)&&(i.reservation.ratePlan=r({},M.getRatePlan(i.reservation.ratePlan),i.reservation.ratePlan===k.RATE_PLAN_CODES.PPC?{name:$.confirmation.ppcRate}:{}))}V&&(i.adminId=V.adminId,i.groupCode=V.groupCode),i.handleManageGroup=function(){V&&w.deleteGroupAdminContext()},i.isGroupAdmin=function(){return i.reservation&&i.reservation.groupId&&i.reservation.centralGroupModifiable||V&&V.adminId&&h.get().signedIn&&h.get().cpLoyaltyProgramId===V.cpLoyaltyProgramId&&h.get().cpLoyaltyAccountNumber===V.cpLoyaltyAccountNumber||!1},i.pageName=N.PAGE_NAME.CONFIRM,B=d.getConfirmation()||R.getConfirmation()||window.store&&window.store.getState().checkoutContext,m.getHTMLFragment("choice-hotels/reservation-confirmation-full-blade-promo","module").then((function(e){i.fullBladePromo=e})),B&&(j(B),B.hotel&&F.saveToLocal(D.CONFIRMATION,B.hotel.id,B.hotel.brandCode),i.reservation.guest&&w.setRSVPLastname(i.reservation.guest.lastName),i.taxes=(i.reservation.totalAfterTax-i.reservation.totalBeforeTax).toFixed(2),i.paymentMethodPolicyText=B.paymentMethodPolicyText,i.reservation&&i.reservation.hotel&&(i.showWhatToExpect=!!$.confirmation.whatToExpect.brandCodes[i.reservation.hotel.brandCode]),i.shouldHideLPG=A.AMR_MASTER&&(I.shouldHideLPG(B&&B.hotel)||I.shouldHideLPG(i.reservation&&i.reservation.hotel)),l.cardUsedOnTransaction(B)&&A.INSTANT_CREDIT_DISCOUNT&&(i.isCpVisaCheckout=!0,i.cpVisaDiscountAmount=E.STATEMENT_CREDIT_AMOUNT,i.totalWithDiscount=i.reservation.totalAfterTax-E.STATEMENT_CREDIT_AMOUNT,f.deleteCPVisaBannerTypeCookie()),a.referalReserve?_.loaded(D.CHANGE_RESERVATION_CONFIRMATION_PAGE):(!A.CONFIRMATION_PAGE_REACT&&!o.isMobile||!A.MWEB_CONFIRMATION_PAGE_REACT&&o.isMobile)&&_.loaded(D.CONFIRMATION,B),x.clearCherpData()),i.reservation&&i.reservation.ratePlan&&i.reservation.ratePlanDetail&&(i.reservation.ratePlan=r({},i.reservation.ratePlan,i.reservation.ratePlanDetail)),i.reservation&&i.reservation.adminId&&(i.adminId=i.reservation.adminId,i.groupCode=i.reservation.groupId),u.clear(),o.isMobile&&A.MW_GUEST_DATA_PAGE&&s.onStart({},(function(e){"confirmationViews"===e.from().name&&"guestDataViews"===e.to().name&&n.path("/")})),s.onSuccess({},(function(){window.scrollTo(0,0)}))}]},function(e,t){function r(){return(r=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e}).apply(this,arguments)}function n(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var o=function(){function e(t,n,o){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),r(this,{$scope:t,$window:n,reactHelper:o})}var t,o,a;return e.$inject=["$scope","$window","reactHelper"],t=e,(o=[{key:"$onInit",value:function(){var e=this;this.reactHelper.loadReactApp((function(){return e.loadReactWhatToExpect()}))}},{key:"$onDestroy",value:function(){var e=document.getElementById("whatToExpect");e&&this.$window.ReactDOM.unmountComponentAtNode(e)}},{key:"loadReactWhatToExpect",value:function(){var e=this.$window.React.createElement(this.$window.WhatToExpect,{brandCode:this.brandCode,list:this.list,listTitle:this.listTitle,paragraphText:this.paragraphText,paragraphTitle:this.paragraphTitle}),t=this.$window.React.createElement(this.$window.Provider,{store:this.$window.store},e);this.reactHelper.renderToScope(t,document.getElementById("whatToExpect"),this.$scope)}}])&&n(t.prototype,o),a&&n(t,a),e}();e.exports={bindings:{brandCode:"@",list:"<",listTitle:"@",paragraphText:"@",paragraphTitle:"@"},controller:o,template:'<div id="whatToExpect"></div>'}},function(e,t,r){e.exports=angular.module("chApp.deals",[r(547).name]).directive("chRegisterPromoLink",r(550))},function(e,t,r){e.exports=angular.module("chApp.deals.birg",[]).controller("BirgPageCtrl",r(548)).factory("birgService",r(549)).directive("chValidatePhone",r(348))},function(e,t){e.exports=["$document","$filter","$scope","birgService","countryDataUtils","dateHelper","formHelper","localeHelper","omniture","omnitureConst","strings","values",function(e,t,r,n,o,a,i,s,c,l,u,d){function p(){e.scrollToElementAnimated(e[0].querySelector(".birg .header"),0,500)}r.getFieldErrors=function(e){return i.errorFilter(r.form,e)},r.objectHasKeys=function(e){return!!Object.keys(e||{}).length},r.resetForm=function(e){r.birgForm={choiceBookedRateCurrency:"USD",confirmation:"",country:"US",lowerRateCurrency:"USD"},r.submitResponse={},r.submitStatus=!1,r.form&&(r.form.$setUntouched(),r.form.$setPristine()),e&&(e.stopPropagation(),p())},r.stopPropagation=function(e){e.stopPropagation(),e.stopImmediatePropagation()},r.submitForm=function(){if(r.submitResponse={},r.form.$valid){var e=angular.extend({},r.birgForm,{checkInDate:a.asString(r.birgForm.checkInDate)});n.submit(e).then((function(){r.submitResponse={successMessage:u.birg.successMessageHtml},r.submitStatus=!0,c.reSendAnalyticsViaPageLoad(l.BIRG.SUCCESS)})).catch((function(e){r.submitResponse=angular.extend({},e.inputErrors,e.outputErrors),r.submitStatus=!1,c.reSendAnalyticsViaPageLoad({pageName:l.BIRG.FAILURE,prop19:e.outputErrors})})).finally(p)}else p()},function(){r.birgForm={},r.today=a.getTodayDate(),r.redemptionTypes=[{label:u.birg.redemptionType.physicalCard,value:"plastic"},{label:u.birg.redemptionType.digitalCard,value:"digital"}],c.sendAnalyticsViaPageLoad(l.BIRG.PAGE_LOAD),r.countryDataUtils=o,r.resetForm(),r.dateFormat=s.getDateFormat();var e=angular.copy(d.currencies);delete e.CP_POINTS,r.currencies=t("chAlphaBubbleUp")(t("toArray")(e),"description",["","US Dollar"])}()}]},function(e,t){e.exports=["$http","$q","selectedLangData","urlEncodeObject",function(e,t,r,n){return{submit:function(o){var a=angular.extend({preferredLanguageCode:r.get().code},o);return e({data:n(a),headers:{"content-type":"application/x-www-form-urlencoded"},method:"POST",url:"/webapi/birg/submit-best-internet-rate"}).then((function(e){return e.data})).catch((function(e){return t.reject(e.data)}))}}}]},function(e,t){e.exports=["$sessionStorage","cacheKeyConst",function(e,t){return{link:function(r,n){n.on("click",(function(){e[t.PROMO_REGISTRATION]=!0}))}}}]},function(e,t,r){e.exports=angular.module("chApp.feedback.link.override",[]).directive("chFeedbackLink",r(552))},function(e,t){e.exports=["$rootScope","eventsConst","$window",function(e,t,r){var n=["language","userAgent","product","platform","appVersion","appName","appCodeName","maxTouchPoints","vendorSub","vendor","productSub","cookieEnabled"];return{link:function(o,a,i){o.strings=e.strings;var s=i.href;e.$on(t.PAGE_LOADED,(function(){var e="\n\n".concat(o.strings.account.feedbackEmailStatement,"\n\n\n").concat(o.strings.account.feedbackEmailMessage,"\n\n");for(var t in r.navigator)-1!==n.indexOf(t)&&(e+="".concat(t,"=").concat(r.navigator[t],"\n"));a.attr("href",s+encodeURIComponent(e))}))},replace:!1,restrict:"A"}}]},function(e,t,r){e.exports=angular.module("chApp.groups",[]).component("chGroupRequestFormInputError",r(554)).component("chResendEmailContent",r(555)).controller("GroupRequestFormPageCtrl",r(557)).factory("groupRequestFormAnalytics",r(558)).directive("chGroupLookupForm",r(559)).directive("chResendEmailModal",r(560))},function(e,t){function r(){return(r=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e}).apply(this,arguments)}function n(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var o=function(){function e(t,n,o){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),r(this,{$scope:t,formHelper:n,strings:o})}var t,o,a;return e.$inject=["$scope","formHelper","strings"],t=e,(o=[{key:"$onInit",value:function(){this.parentForm=this.$scope.$parent.groupRequestForm,this.formInput=this.parentForm[this.name]}},{key:"getInputErrorKeys",value:function(){return this.formHelper.errorFilter(this.parentForm,this.formInput)}},{key:"getValidationMessage",value:function(e){return this.validationMessages&&this.validationMessages[e]||this.strings.general.validationMessages[e]||this.defaultMessage||this.strings.general.validationMessages.required}},{key:"hasErrors",value:function(){var e=this.getInputErrorKeys(),t=Boolean(e&&e.length),r=t?this.getValidationMessage(e[0]):"";return this.$scope.message=r,t}}])&&n(t.prototype,o),a&&n(t,a),e}();e.exports={bindings:{defaultMessage:"<",name:"@",validationMessages:"<"},controller:o,templateUrl:["siteConfig",function(e){return"/".concat(e.assetFingerprint,"/app/groups/group-request-form-input-error/group-request-form-input-error.html")}]}},function(e,t,r){function n(){return(n=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e}).apply(this,arguments)}function o(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var a=function(){function e(t,r,o,a,i,s,c,l,u,d){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),n(this,{$document:t,$rootScope:r,$scope:o,eventsConst:a,globalLoaderCounter:i,groupService:s,omniture:c,omnitureConst:l,pagesConst:u,resendEmailInfo:{},sharePrivateData:!1,strings:d})}var t,r,a;return e.$inject=["$document","$rootScope","$scope","eventsConst","globalLoaderCounter","groupService","omniture","omnitureConst","pagesConst","strings"],t=e,(r=[{key:"onSubmit",value:function(e){if(e&&!1===e.$valid){e.$submitted=!0;var t=this.$document[0].querySelector('form[name="resendEmailForm"] .ng-invalid');t&&t.focus()}else{this.successMessage="",this.errorMessage="";var r=this.resendEmailInfo,n={creditCardLastFour:r.creditCardLastFour,email:r.email,groupCode:r.groupCode,lastName:r.lastName};this.resendGroupEmail(n)}}},{key:"resendGroupEmail",value:function(e){var t=this;this.globalLoaderCounter.inc(),this.groupService.resendGroupPlannerEmail(e).then((function(){t.handleSuccessResponse(e),t.globalLoaderCounter.dec(),t.omniture.sendAnalyticsViaCustomLink({linkTrackVars:"prop53,prop54",pageName:t.pagesConst.RESEND_PLANNER_EMAIL,prop53:t.omnitureConst.GROUP_RESEND_EMAIL,prop54:"resendPlannerEmailBtn"})})).catch((function(e){t.handleErrors(e),t.globalLoaderCounter.dec(),t.omniture.sendAnalyticsViaCustomLink({linkTrackVars:"prop19,prop53,prop54",pageName:t.pagesConst.RESEND_PLANNER_EMAIL_ERROR,prop19:t.errorMessage,prop53:t.omnitureConst.GROUP_RESEND_EMAIL,prop54:"resendPlannerEmailBtn"})}))}},{key:"handleErrors",value:function(e){(e.outputErrors||e.inputErrors)&&(this.errorMessage=this.strings.group.errors.resendEmailError)}},{key:"handleSuccessResponse",value:function(e){this.successMessage=this.strings.group.emailSentMessage+e.email}}])&&o(t.prototype,r),a&&o(t,a),e}();e.exports={controller:a,template:r(556)}},function(e,t){e.exports='<form \n  name="resendEmailForm" \n  ch-guest-info="$ctrl.resendEmailInfo" \n  class="badged-container"\n  ng-submit="$ctrl.onSubmit(resendEmailForm)">\n  <fieldset>\n    <div id="resendEmailModal" class="container-fluid" ng-if="!$ctrl.successMessage">\n      <div class="flex jc-space-between">\n        <div class="flex">\n          <div class="text-uppercase">\n            {{::$root.strings.group.enterGroupDetails}}\n          </div>\n        </div>\n      </div>\n      <hr>\n      <div\n        class="flex ai-center text-error"\n        ng-if="$ctrl.errorMessage">\n        <div class="margin-top-10" style="font-size: 18px">{{::$ctrl.errorMessage}}</div>\n      </div>\n      <div>\n        <p ch-focus-if="!resendEmailForm.$valid && resendEmailForm.$submitted"\n          class="text-danger strong"\n          ng-if="!resendEmailForm.$valid && resendEmailForm.$submitted"\n          tabindex="-1">\n          {{::$root.strings.guestData.correctFields}}\n        </p>\n      </div>\n      <div class="row">\n        <div class="col-md-6">\n          <label for="groupCode" class="control-label">\n            <span>{{::$root.strings.group.groupCode}}</span>\n            <span>*</span>\n          </label>\n          <input \n              type="text" \n              id="groupCode" \n              name="groupCode"\n              ng-model="$ctrl.resendEmailInfo.groupCode"\n              class="form-control" \n              ng-required="true">\n        </div>\n        <div class="col-md-6">\n          <ch-guest-info-last-name></ch-guest-info-last-name>\n        </div>\n      </div>\n      <div class="row">\n        <div class="col-md-6">\n          <label for="plannerCCLastFour" class="control-label">\n            <span>{{::$root.strings.group.plannerCCLastFour}}</span>\n            <span>*</span>\n          </label>  \n          <input \n              type="number" \n              id="creditCardLastFour" \n              name="creditCardLastFour"\n              ng-model="$ctrl.resendEmailInfo.creditCardLastFour"\n              ng-minlength= "4"\n              ng-maxlength= "4"\n              class="form-control" \n              ng-required="true">\n        </div>\n        <div class="col-md-6">\n          <ch-guest-info-email></ch-guest-info-email>\n        </div>\n      </div>\n      <div class="text-bold text-center">\n        <button \n            class="btn btn-primary selected-button admin-btn" \n            type="submit" \n            aria-hidden="false" \n            so-omniture-click-tracking="{{$ctrl.omnitureConst.SEND_GUEST_BOOKING_EMAIL}}"\n            id="resendPlannerEmailSubmit">\n          {{::$root.strings.group.resend}}\n        </button>\n      </div>\n    </div>\n    <div id="resendEmailModal" class="container-fluid" ng-if="$ctrl.successMessage">\n      <div class="flex ai-center">\n        <div class="margin-top-10 fs-18">{{::$ctrl.successMessage}}</div>\n      </div>\n    </div>\n  </fieldset>\n</form>'},function(e,t){function r(){return(r=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e}).apply(this,arguments)}e.exports=["$scope","$rootScope","$locale","$location","$sce","$sessionStorage","$state","$stateParams","eventsConst","groupRequestFormAnalytics","hotelImageHelper","hotelService","pagesConst","searchCriteriaData","searchHelper","siteConfig",function(e,t,n,o,a,i,s,c,l,u,d,p,m,g,f,h){e.pageName=m.GROUP_REQUEST,u.init(e);var E=g.get();var v=t.chConstants.search.GROUP_OPTIONS.minRoomsPerGroup;r(e,{LANG:n.id.split("-")[0],LOCALE:n.id.split("-")[1],clearHotel:function(){e.selectedHotel=null},currencyData:{defaultCurrency:{code:"",description:"",symbol:""},selectedCurrency:{}},extraParams:{checkInParamName:h.groupRequest.checkInParameter,checkOutParamName:h.groupRequest.checkOutParameter,oid:h.groupRequest.oid,placeName:E.placeName,retUrl:"".concat(o.protocol(),"://").concat(o.host()).concat(t.chConstants.route.GROUP_REQUEST_FORM_REDIRECT)},groupData:r({groupContactEmail:null,groupContactFamilyName:null,groupContactGivenName:null,groupContactPhone:null,groupName:null,groupType:{code:"",text:""},numRooms:E.rooms?Math.max(v,E.rooms):v,perRoomBudget:null,roomTypePreference:{code:"",text:""}},f.getDateRange({checkInDate:E.checkInDate,checkOutDate:E.checkOutDate})),imageStatus:{error:!1},maxFieldLength:{email:80,givenName:40,groupName:255,phone:17,specialRequest:32e3,surname:80},plusMinusDropdownMode:"compact",submitError:!1,submitGroupRequest:function(r){if(!e.selectedHotel||!e.groupRequestForm.$valid){e.groupRequestForm.$setSubmitted(),r.preventDefault();var n=[];e.groupRequestForm.$error.required&&e.groupRequestForm.$error.required.forEach((function(e){n.push([e.$name,"Required"])})),e.groupRequestForm.$error.minlength&&e.groupRequestForm.$error.minlength.forEach((function(e){n.push([e.$name,"Please enter a valid ".concat(e.$name)])})),e.errorMessages=n,e.pageName=m.GROUP_REQUEST_CONFIRM_ERROR,t.$emit(l.ANALYTICS_PAGE_LOADED,m.GROUP_REQUEST)}},submitSuccess:!1,submitUrl:a.trustAsResourceUrl(h.groupRequest.url)});var y=s.current.params;y&&(e.submitSuccess=!!y.confirmation,e.submitSuccess?(e.pageName=m.GROUP_REQUEST_CONFIRM,e.selectedHotel=i.selectedHotel,t.$emit(l.ANALYTICS_PAGE_LOADED,m.GROUP_REQUEST)):c.hotelId||(e.pageName=m.GROUP_REQUEST,t.$emit(l.ANALYTICS_PAGE_LOADED,m.GROUP_REQUEST))),c.hotelId&&p.getHotel(c.hotelId,t.chConstants.search.GROUP_OPTIONS.groupRequestInclude).then((function(r){d.updateHotelImagesWithRenditions(r),e.selectedHotel=r,i.selectedHotel=e.selectedHotel,e.pageName=m.GROUP_REQUEST,t.$emit(l.ANALYTICS_PAGE_LOADED,m.GROUP_REQUEST),r.currency||(r.currency="USD");var n=t.values.currencies[r.currency];e.currencyData.defaultCurrency=e.currencyData.selectedCurrency=n}))}]},function(e,t){e.exports=["analyticsManager","omniture","pagesConst",function(e,t,r){return{init:function(n){e.initialize(),t.clearPreviousProperties(),e.setPageDefaults({CLICK_TRACKING:function(){return n.submitSuccess?"Submit Request":void 0},ERROR_MESSAGES:function(){return n.errorMessages?n.errorMessages:void 0},PAGE_NAME:function(){return n.pageName?n.pageName:r.GROUP_REQUEST},PROPERTY_ID:function(){return n.selectedHotel?n.selectedHotel.id:void 0}},r.GROUP_REQUEST)}}}]},function(e,t){e.exports=["$location","$stateParams","routeConst",function(e,t,r){return{link:function(n){n.showResendEmailModalValue=!1,n.lookupGroup=function(){n.groupLookupForm.$setSubmitted(),n.groupLookupForm.$valid&&(e.path(r.GROUP_PICKUP_PATH.replace(":groupId",n.groupLookup.groupId)).search({}),t.groupId=n.groupLookup.groupId)},n.showResendEmailModal=function(){n.showResendEmailModalValue=!0},n.closeResendEmailModal=function(){n.showResendEmailModalValue=!1},n.$parent.groupLookup={groupId:""}},replace:!0,restrict:"E",template:'<form class="group-lookup-form" name="groupLookupForm" method="GET" ng-submit="lookupGroup()" ng-transclude></form>',transclude:!0}}]},function(e,t){e.exports=["$state","modalService",function(e,t){return{link:function(e,r){t.openModal({closeCallback:function(){e.closeResendEmailModal()},closeOnLocationChange:!0,element:r[0],focusElement:"resendEmailModal",labelledBy:"resendEmail",secondaryClass:"resend-email-modal",size:"md",template:"<ch-resend-email-content></ch-resend-email-content>"},e)},restrict:"EA",scope:{closeResendEmailModal:"&"}}}]},function(e,t,r){e.exports=angular.module("chApp.guestdata",["ui.bootstrap.modal",r(562).name,r(566).name,r(583).name]).controller("GuestDataPageCtrl",r(585)).controller("ReactGuestDataCtrl",r(587)).controller("ReactGuestDataPageMobileCtrl",r(588)).component("chGuestDataRoomListComponent",r(589)).component("chGuestDataAgreementCheckbox",r(590)).factory("bingValidationService",r(591)).factory("guestdataAnalytics",r(592)).factory("GuestdataBookingGroupCreationService",r(593)).factory("GuestdataBookingGroupPickupService",r(594)).factory("GuestdataBookingService",r(595)).factory("GuestdataBookingPpcService",r(596))},function(e,t,r){e.exports=angular.module("chApp.guestdata.rapidBook",[]).component("chRapidBookControls",r(563)).component("chRapidBookEditLink",r(564)).service("rapidBookService",r(565))},function(e,t){e.exports={bindings:{guestForm:"=",guestInfo:"=",onCancel:"&",onUpdate:"&",section:"@"},controller:["$rootScope","rapidBookService","eventsConst","featureFlags",function(e,t,r,n){var o=this;o.service=t,o.update=function(){n.SO_GDP_ERRORS&&e.$broadcast(r.GDP_EVENT.FORM_SUBMIT),t.updatePanel(o.section,o.guestInfo,o.guestForm),o.onUpdate&&o.onUpdate()},o.cancel=function(){t.cancelEditMode(o.section,o.guestInfo),o.onCancel&&o.onCancel()}}],controllerAs:"controls",templateUrl:["siteConfig",function(e){return"/".concat(e.assetFingerprint,"/app/guestdata/rapid-book/rapid-book-controls.html")}]}},function(e,t){e.exports={bindings:{guestInfo:"=",section:"@"},controller:["rapidBookService",function(e){var t=this;t.activateEditMode=function(){e.activateEditMode(t.section,t.guestInfo)}}],controllerAs:"link",template:'<a ng-click="link.activateEditMode()" class="pull-right link-cta" href="">{{::$root.strings.general.updateLabel}}</a>'}},function(e,t){e.exports=["$rootScope","checkoutContextData","cpUserData","creditCardTypeDetectionService","dateHelper","eventsConst","featureFlags","guestdataConst","objectHelper","ratesConst","scrollHelper","tokenizationService","userHelper","userService",function(e,t,r,n,o,a,i,s,c,l,u,d,p,m){var g=["address.city","address.line1","address.postalCode","address.subdivision","creditCardName","creditCardNumber","creditCardType","email","expirationMonth","expirationYear","firstName","homePhone","lastName"],f=["aaaNumber"],h={creditCard:"(creditCard|expiration)",guest:"(address|line|aaa|country|city|subdivision|postalCode|email|Phone|isMobileNumber)"};function E(){var e,n=r.get();return C.bookingType===s.BOOKING_TYPE.STANDARD&&(!!n.signedIn&&((!C.validCardTypes||-1!==C.validCardTypes.indexOf(n.creditCardType))&&(!i.SO_GDP_SIGNED_IN&&(e=r.get(),g.concat(t.get().ratePlan===l.RATE_PLAN_CODES.S3A?f:[]).reduce((function(t,r){return!(!t||!c.getPropertyByString(e,r))}),!0)))))}function v(e){C.viewState[e].edit=!1,C.viewState[e].updateProfile=!1}function y(){C.isEnabled=E()}e.$on(a.LOGGED_IN_OR_OUT,y),e.$on(a.CP_USER_RETRIEVED,y);var C={activateEditMode:function(e,t){this.viewState[e].edit=!0,this.viewState[e].updateProfile=!1,function(e,t){var r=angular.copy(t);r=c.filterProperties(r,h[e]),C.viewState[e].backup=r}(e,t)},cancelEditMode:function(e,t){!function(e,t){c.filterProperties(t,h[e],!0),angular.merge(t,C.viewState[e].backup),C.viewState[e].backup=null}(e,t),v(e)},initializeViewState:function(e,t){this.validCardTypes=(t||[]).map((function(e){return e.code})),this.bookingType=e,y(),Object.keys(this.viewState).forEach(v)},isEnabled:!1,updatePanel:function(e,t,a){if(Object.keys(a).every((function(e){return-1!==e.indexOf("$")||!a[e].$invalid}))){if(C.viewState[e].updateProfile){var i=function(e,t){var r=c.filterProperties(angular.copy(t),h[e]);if("guest"===e){var n=t.address||{};angular.extend(r,{address1:n.line1,address2:n.line2,address3:n.line3,city:n.city,country:n.country,postalCode:n.postalCode,subdivision:n.subdivision}),r.isMobileNumber&&(r.mobilePhone=r.homePhone),delete r.address,delete r.mobilePhones}return r}(e,t),s=p.getUpdateUserRequestBody(r.get(),i);if((s||{}).creditCardNumber){var l=o.getCreditCardExpirationString(s.expirationMonth,s.expirationYear);d.tokenizeCreditCard(s.creditCardNumber,l).then((function(e){var r=e.token||s.cardToken||s.creditCardNumber;angular.extend(s,{creditCardNumber:r,tokenKeyAlias:e.keyAlias,tokenResponseSignature:e.responseSignature,tokenResponseTimeStamp:e.responseTimeStamp}),t&&(t.creditCardNumber=r.replace(/\d(?=\d{4})/g,"*")),a&&a.creditCardNumber&&(a.creditCardNumber.$modelValue=r.replace(/\d(?=\d{4})/g,"*")),m.editUser(s),n.destroyed()})).catch((function(){}))}else m.editUser(s)}v(e)}else u.scrollToFirstError()},viewState:{creditCard:{backup:{},edit:!1,updateProfile:!1},guest:{backup:{},edit:!1,updateProfile:!1}}};return C}]},function(e,t,r){e.exports=angular.module("chApp.guestdata.redesign",[r(567).name,r(570).name,r(572).name,r(575).name,r(577).name,r(580).name])},function(e,t,r){e.exports=angular.module("chApp.guestdata.gdpDateCard",[]).component("chGdpDateCard",r(568))},function(e,t,r){e.exports={bindings:{date:"<",dateTitle:"<",day:"<",time:"<"},template:r(569)}},function(e,t){e.exports='<div>\n  <div class="title flex flex-row jc-center ai-center">\n    <div class="flex-1 jc-center"><span class="ch-icon ch-icon-calendar"></span></div>\n    <span class="fs-15 flex-2" role="title">{{::$ctrl.dateTitle}}</span>\n  </div>\n  <div class="content">\n    <div class="day">{{::$ctrl.day}}</div>\n    <div class="date">\n      <p>\n        <span>{{::$ctrl.date}}</span><br/>\n        <span>{{::$ctrl.time}}</span>\n      </p>\n    </div>\n  </div>\n</div>\n'},function(e,t,r){e.exports=angular.module("chApp.guestdata.gdpPriceDetail",[]).component("chGdpPriceDetail",r(571))},function(e,t){function r(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var n=function(){function e(t,r,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.Math=t.Math,this.featureFlags=r,this.hotelHelper=n}var t,n,o;return e.$inject=["$window","featureFlags","hotelHelper"],t=e,(n=[{key:"$onInit",value:function(){this.nights=this.checkout.rooms[0].nights||0,this.isAMResortHotel=this.featureFlags.AMR_MASTER&&this.hotelHelper.isHotelAMResort(this.hotel),this.showCancellationPolicyText=this.checkout&&this.checkout.cancellationPenalties&&this.checkout.cancellationPenalties.length&&this.checkout.cancellationPolicyText,this.shouldShowTaxIncluded=this.checkout&&this.hotelHelper.shouldShowTaxIncluded(this.checkout.totalAfterTax,this.checkout.totalBeforeTax,this.isAMResortHotel)}}])&&r(t.prototype,n),o&&r(t,o),e}();e.exports={bindings:{checkout:"=",hotel:"=",openTaxesAndFees:"=",tax:"="},controller:n,templateUrl:["siteConfig",function(e){return"/".concat(e.assetFingerprint,"/app/guestdata/minimal-gdp/gdp-redesign-component/gdp-price-detail/gdp-price-detail.html")}]}},function(e,t,r){e.exports=angular.module("chApp.guestdata.gdpRoomCard",[]).component("chGdpRoomCard",r(573))},function(e,t,r){function n(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var o=function(){function e(t,r,n,o,a,i,s){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.isOpen=!1,this.extraBed="",this.extraCharge="",this.$filter=t,this.dateHelper=r,this.featureFlags=o,this.hotelHelper=a,this.ratesConst=i,this.siteConfig=s,this.isMobile=s.deviceType===n.MOBILE,this.isPointOnly=!1}var t,r,o;return e.$inject=["$filter","dateHelper","deviceConst","featureFlags","hotelHelper","ratesConst","siteConfig"],t=e,(r=[{key:"$onInit",value:function(){this.checkoutRoom.extraBed&&(this.extraBed=this.checkoutRoom.extraBed.toLowerCase(),this.extraCharge=this.checkoutRoom.roomCharges[0][this.extraBed]),this.isPointOnly=this.checkoutRoom.avgNightlyPoints&&!this.checkoutRoom.avgNightlyBeforeTax,this.showOccupancyMessagingMobile=this.featureFlags.AMR_MWEB_MASTER&&this.isMobile&&(this.featureFlags.AMR_OCCUPANCY_ALL||this.hotelHelper.isHotelAMResort(this.hotel)),this.showOccupancyMessagingDesktop=this.featureFlags.AMR_MASTER&&!this.isMobile&&(this.featureFlags.AMR_OCCUPANCY_ALL||this.hotelHelper.isHotelAMResort(this.hotel)),this.shouldShowGuestWarning=(this.showOccupancyMessagingMobile||this.showOccupancyMessagingDesktop)&&this.checkoutRoom&&this.hotelHelper.shouldHotelShowSrdOccupancyWarning(this.hotel,this.checkoutRoom.ratePlanCode)&&this.hotelHelper.shouldShowGuestWarning(this.checkoutRoom.adults,this.checkoutRoom.minors),this.addNightlyRates()}},{key:"removeRoom",value:function(){this.onRemoveRoom({index:this.roomIndex})}},{key:"addNightlyRates",value:function(){var e=this;this.nightlyRates=[],!this.checkoutRoom.roomCharges||this.checkoutRoom.roomCharges.length<=1||angular.forEach(this.checkoutRoom.roomCharges,(function(t){for(var r=e.dateHelper.getDateFromString(t.startDate),n=0;n<t.nights;n++){var o=e.dateHelper.withAddedDays(r,n);e.nightlyRates.push({cash:t.avgNightlyBeforeTax||t.avgNightlyAfterTax,date:e.$filter("date")(o,"EEEE, MMM d"),points:t.avgNightlyPoints})}}))}}])&&n(t.prototype,r),o&&n(t,o),e}();e.exports={bindings:{checkoutRoom:"<",currencyCode:"<",hotel:"<",onRemoveRoom:"&",roomIndex:"<"},controller:o,template:r(574)}},function(e,t){e.exports='<div\n    class="text-capitalize flex flex-col room-info-container"\n    ng-class="{\'without-point\': !$ctrl.checkoutRoom.points || !$ctrl.checkoutRoom.totalPoints}">\n  <div class="room-info flex flex-row jc-space-between">\n    <div class="room-info-description">\n      <h3 class="bed-description text-semibold">{{::$ctrl.checkoutRoom.roomMerchandising.title}}</h3>\n      <div class="feature-description">\n        <span ng-if="$ctrl.checkoutRoom.roomMerchandising.description">\n          {{::$ctrl.checkoutRoom.roomMerchandising.description}}<span ng-if="$ctrl.checkoutRoom.featuresDescription">,</span>\n        </span>\n        {{::$ctrl.checkoutRoom.featuresDescription}}<span ng-if="$ctrl.extraBed">, {{::$ctrl.extraBed}}\n        <ch-price-tag\n            class="text-thin extra-charge"\n            currency="$ctrl.currencyCode"\n            cash="$ctrl.extraCharge"></ch-price-tag></span>\n      </div>\n      <div\n        class="occupancy-messaging fs-12 text-semibold"\n        ng-if="$ctrl.showOccupancyMessagingDesktop || $ctrl.showOccupancyMessagingMobile"\n        ng-class="{\'show-warning\': $ctrl.shouldShowGuestWarning}">\n        <span ng-if="$ctrl.shouldShowGuestWarning" class="ch-icon ch-icon-error"></span>\n        {{::$root.strings.guestData.priceFor}}\n        <ng-pluralize ng-if="$ctrl.checkoutRoom.adults" count="$ctrl.checkoutRoom.adults" when="$root.strings.guestData.occupancyAdultsPluralize"></ng-pluralize>\n        <ng-pluralize ng-if="$ctrl.checkoutRoom.minors" count="$ctrl.checkoutRoom.minors" when="$root.strings.guestData.occupancyMinorsPluralize"></ng-pluralize>\n      </div>\n      <button\n          class="remove-room btn-transparent"\n          ng-click="$ctrl.removeRoom()"\n          so-omniture-click-tracking="RemoveRoomBtn">\n        {{::$root.strings.general.remove}}\n      </button>\n    </div>\n    <button\n        class="room-price btn-transparent"\n        ng-click="$ctrl.isOpen = !$ctrl.isOpen"\n        ng-disabled="::$ctrl.checkoutRoom.roomCharges.length == 1">\n      <ch-price-tag\n          currency="$ctrl.currencyCode"\n          currency-code="$ctrl.checkoutRoom.points"\n          points="$ctrl.checkoutRoom.avgNightlyPoints"\n          plus="\'+\'"\n          ng-attr-discount="($ctrl.checkoutRoom.rackPrice > $ctrl.checkoutRoom.avgNightlyBeforeTax && $root.featureFlags.SO_GDP_SAVINGS_2020_A) ? $ctrl.checkoutRoom.rackPrice : \'\'"\n          cash="$ctrl.checkoutRoom.avgNightlyBeforeTax"\n          decimals="true">\n      </ch-price-tag>\n      <div class="average-per-night text-right">\n        {{$ctrl.isPointOnly ? $root.strings.guestData.perNight : $root.strings.guestData.averagePerNight}}\n        <span\n            class="ch-icon"\n            ng-if="::$ctrl.checkoutRoom.roomCharges.length > 1"\n            ng-class="{\n              \'ch-icon-chevron-down\': !$ctrl.isOpen,\n              \'ch-icon-chevron-up\': $ctrl.isOpen\n            }"\n        ></span>\n      </div>\n    </button>\n  </div>\n</div>\n<div class="nightly-rate flex flex-row jc-space-between"\n     ng-if="$ctrl.isOpen"\n     ng-repeat="charge in $ctrl.nightlyRates track by $index"\n     ng-class="{\'detail-background-color\': $index % 2 === 0}">\n  <div>{{charge.date}}</div>\n  <ch-price-tag\n      currency="$ctrl.currencyCode"\n      currency-code="charge.points"\n      cash="charge.cash + ($ctrl.extraCharge ? $ctrl.extraCharge : 0)"\n      decimals="true"\n      points="charge.points">\n  </ch-price-tag>\n</div>\n'},function(e,t,r){e.exports=angular.module("chApp.guestdata.gdpRoomCardList",[]).component("chGdpRoomCardList",r(576))},function(e,t){function r(){return(r=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e}).apply(this,arguments)}function n(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var o=function(){function e(t,n,o,a,i,s,c,l,u,d,p,m,g,f,h,E,v,y){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),r(this,{$location:t,$rootScope:n,$stateParams:o,checkoutContextData:a,checkoutService:i,currenciesConst:s,deviceConst:c,eventsConst:l,featureFlags:u,gdpSavingsService:d,globalLoaderCounter:p,objectHelper:m,pagesConst:g,queryParamsConst:f,routeConst:h,selectedLangData:E,siteConfig:v,urlParserService:y})}var t,o,a;return e.$inject=["$location","$rootScope","$stateParams","checkoutContextData","checkoutService","currenciesConst","deviceConst","eventsConst","featureFlags","gdpSavingsService","globalLoaderCounter","objectHelper","pagesConst","queryParamsConst","routeConst","selectedLangData","siteConfig","urlParserService"],t=e,(o=[{key:"$onInit",value:function(){this.checkoutData=this.checkoutContextData.get(),this.isCollapse=this.checkout.rooms.length>=3,this.setReturnPath()}},{key:"toggleIsCollapse",value:function(){this.isCollapse=!this.isCollapse}},{key:"deleteReservation",value:function(){this.checkoutService.deleteReservation(this.checkout),this.checkoutContextData.clear(),this.gdpSavingsService.clearGdpSavings(),this.$location.replace().url(this.returnPath).search({})}},{key:"addRoom",value:function(){this.checkout.groupInfo?this.$location.path(this.checkout.groupInfo.pickupUrl):(this.$location.path(this.hotel.ratesPageUrl),this.$location.search(this.queryParamsConst.RATE_PLAN_CODE,this.checkoutData.ratePlan))}},{key:"removeRoom",value:function(e){var t=this;this.checkout.rooms.length<=1?this.deleteReservation():(this.globalLoaderCounter.inc(),this.checkoutService.deleteRoomFromReservation(this.checkout,e+1).then((function(e){t.updateLocalCheckout(e)})).catch((function(e){t.handleCheckoutErrors(e)})).catch((function(e){t.openServiceFailureModal(t.$rootScope.strings.guestData.errors.removeRoomError,e.data,"guestDataErrors")})).finally((function(){t.$rootScope.$broadcast(t.eventsConst.RESERVATION_SUMMARY_UPDATED),t.globalLoaderCounter.dec(),t.trackAnalytics(),t.featureFlags.SO_GDP_SAVINGS_V2&&t.checkout.currencyCode.toLowerCase()===t.currenciesConst.CURRENCY_CODES.USD&&t.updateRackTotals()})))}},{key:"updateLocalCheckout",value:function(e){delete e.guest,this.checkoutContextData.update(e),this.objectHelper.deepExtend(this.checkout,e)}},{key:"setReturnPath",value:function(){var e=this.checkout.groupInfo?this.checkout.groupInfo.pickupUrl:this.hotel.ratesPageUrl;this.$stateParams.groupId=this.checkout.groupInfo&&this.checkout.groupInfo.groupId,e||(e=this.getBaseUrl()),this.siteConfig.deviceType===this.deviceConst.MOBILE&&this.featureFlags.SO_MOB_PRATES_NEW_JOIN?this.returnPath="".concat(e,"#").concat(this.routeConst.CHANGE_RESERVATION_HASH):this.returnPath=e}},{key:"getBaseUrl",value:function(){return this.urlParserService.getPropertyRatesUrl(this.hotel.address,this.hotel.brandCode,this.hotel.id,this.selectedLangData.get().code)}},{key:"updateRackTotals",value:function(){var e=this;this.gdpSavingsService.calculateSavings(this.checkout.rooms),angular.forEach(this.checkout.rooms,(function(t){t.rackTotal=e.gdpSavingsService.getRackTotal(t)}))}},{key:"trackAnalytics",value:function(){this.$rootScope.$emit(this.eventsConst.ANALYTICS_PAGE_LOADED,this.pagesConst.GUEST_DATA)}}])&&n(t.prototype,o),a&&n(t,a),e}();e.exports={bindings:{checkout:"=",handleCheckoutErrors:"=",hotel:"=",openServiceFailureModal:"="},controller:o,restrict:"E",templateUrl:["siteConfig",function(e){return"/".concat(e.assetFingerprint,"/app/guestdata/minimal-gdp/gdp-redesign-component/gdp-room-card-list/gdp-room-card-list.html")}]}},function(e,t,r){e.exports=angular.module("chApp.guestdata.gdpStayDetail",[]).component("chGdpStayDetail",r(578))},function(e,t,r){function n(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(e)))return;var r=[],n=!0,o=!1,a=void 0;try{for(var i,s=e[Symbol.iterator]();!(n=(i=s.next()).done)&&(r.push(i.value),!t||r.length!==t);n=!0);}catch(e){o=!0,a=e}finally{try{n||null==s.return||s.return()}finally{if(o)throw a}}return r}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return o(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Array.from(e);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return o(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function o(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function a(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var i=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.totalPoints=null,this.isMegaNumber=!1,this.$scope=t}var t,r,o;return e.$inject=["$scope"],t=e,(r=[{key:"$onInit",value:function(){var e=this;this.$scope.$watchGroup(["$ctrl.checkout.totalAfterTax","$ctrl.checkout.totalPoints"],(function(t){var r=n(t,2),o=r[0],a=r[1];e.totalPoints=e.PointsFormatter(a),e.totalCash=e.CashFormatter(o)}))}},{key:"isPPC",value:function(){return!((this.checkout.totalPoints||this.checkout.totalAfterTax)&&(!this.checkout.totalPoints||!this.checkout.totalAfterTax))}},{key:"PointsFormatter",value:function(e){if(e)return e<1e3?e:(this.isMegaNumber=!0,"".concat(Math.round(e/1e3).toFixed(0),"K"))}},{key:"CashFormatter",value:function(e){if(e)return this.isPPC()?Math.round(e):e}}])&&a(t.prototype,r),o&&a(t,o),e}();e.exports={bindings:{checkout:"="},controller:i,template:r(579)}},function(e,t){e.exports='<div\n  class="detail-content flex jc-space-between"\n  ng-class="{\'without-point\': !$ctrl.checkout.totalPoints}">\n  <div class="flex jc-space-between">\n    <div class="padding-info">\n      <ng-pluralize\n          count="$ctrl.checkout.rooms[0].nights"\n          when="{\n            \'one\': $root.strings.guestData.minimalGdp.night,\n            \'other\': $root.strings.guestData.minimalGdp.nights\n          }"\n      ></ng-pluralize>: <span>{{$ctrl.checkout.rooms[0].nights}}</span>\n    </div>\n    <div class="padding-info">\n      <ng-pluralize\n          count="$ctrl.checkout.rooms.length"\n          when="{\n            \'one\': $root.strings.guestData.minimalGdp.room,\n            \'other\': $root.strings.guestData.minimalGdp.rooms\n          }"\n      ></ng-pluralize>: <span>{{$ctrl.checkout.rooms.length}}</span>\n    </div>\n  </div>\n  <div class="padding-info">\n    <span ng-if="!$ctrl.isPPC()">{{::$root.strings.guestData.totalLabel}}</span>\n    <span ng-if="$ctrl.isPPC()">{{::$root.strings.guestData.total}}</span>\n    <ch-price-tag\n      ng-class="{\'mega-number\': $ctrl.isMegaNumber}"\n      currency="$ctrl.checkout.currencyCode"\n      cash="$ctrl.totalCash"\n      points="$ctrl.totalPoints"\n      decimals="!$ctrl.isPPC()">\n    </ch-price-tag>\n  </div>\n</div>\n'},function(e,t,r){e.exports=angular.module("chApp.guestdata.gdpSummaryThumbnail",[]).component("chGdpSummaryThumbnail",r(581))},function(e,t,r){function n(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var o=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.exteriorImageIndexHelper=t}var t,r,o;return e.$inject=["exteriorImageIndexHelper"],t=e,(r=[{key:"$onInit",value:function(){var e=this.hotel.address,t=e.city,r=e.subdivision,n=e.postalCode,o=e.country,a=e.line1,i=this.hotel.images&&this.hotel.images[this.exteriorImageIndexHelper.getExteriorImageIndex(this.hotel.images)]||{};this.thumbnailUrl=i.thumbUrl,this.thumbnailUrlBackup=i.url,this.thumbnailCaption=i.seoAltText,this.hotelName=this.hotel.name,this.address1=a,this.address2=[t,r,n,o].join(", "),this.phone=this.hotel.phone}}])&&n(t.prototype,r),o&&n(t,o),e}();e.exports={bindings:{hotel:"<"},controller:o,template:r(582)}},function(e,t){e.exports='<div class="flex jc-space-between">\n  <div>\n    <div class="gdp-summary-fallback">\n      <img\n        ng-if="$ctrl.hotel.images"\n        ng-src="{{$ctrl.thumbnailUrl}}"\n        ng-attr-alt={{::$ctrl.thumbnailCaption}}\n        ch-image-error="{{::$ctrl.thumbnailUrlBackup}}"\n        itemprop="image">\n    </div>\n  </div>\n  <div class="thumbnail-detail">\n    <h3 class="h4 text-left fs-15 text-semibold">{{::$ctrl.hotelName}}</h3>\n    <address>\n      <div>{{::$ctrl.address1}}</div>\n      <div>{{::$ctrl.address2}}</div>\n      <div>{{::$ctrl.phone}}</div>\n    </address>\n  </div>\n</div>\n'},function(e,t,r){e.exports=angular.module("chApp.guestdata.noCpInlineError",[]).component("chNoCpInlineError",r(584))},function(e,t){function r(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var n=function(){function e(t,r,n,o){var a,i,s,c=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),s=function(){var e=c.$window.React.createElement(c.$window.Provider,{store:c.$window.store},c.$window.React.createElement(c.$window.ErrorMessage,{header:c.strings.cp.noCpAccount.header,message:"<div>\n          <p>".concat(c.strings.cp.noCpAccount.description,"</p>\n          <p><strong>").concat(c.strings.cp.noCpAccount.phone,"</strong></p>\n        </div>")}));c.reactHelper.renderToScope(e,document.getElementById("ch-no-cp-inline-error"),c.$scope)},(i="loadNoCpInlineError")in(a=this)?Object.defineProperty(a,i,{value:s,enumerable:!0,configurable:!0,writable:!0}):a[i]=s,this.$scope=t,this.$window=r,this.reactHelper=n,this.strings=o}var t,n,o;return e.$inject=["$scope","$window","reactHelper","strings"],t=e,(n=[{key:"$onInit",value:function(){this.reactHelper.loadReactApp().then(this.loadNoCpInlineError)}},{key:"$onDestroy",value:function(){var e=this;this.$scope.$on("$destroy",(function(){var t=document.getElementById("ch-no-cp-inline-error");t&&e.$window.ReactDOM.unmountComponentAtNode(t)}))}}])&&r(t.prototype,n),o&&r(t,o),e}();e.exports={controller:n,template:'<div id="ch-no-cp-inline-error"></div>'}},function(e,t,r){function n(){return(n=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e}).apply(this,arguments)}function o(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function a(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?o(Object(r),!0).forEach((function(t){i(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):o(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function i(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}e.exports=["$document","$locale","$q","$rootScope","$sce","$scope","$timeout","$transitions","$uibModal","$window","ariaHiddenHelper","barclaysApplicationConst","barclaysService","bingLocationApiConst","bingValidationService","brandConst","checkoutContextData","checkoutService","cookieHelper","countryDataUtils","cpUserData","cpVisaEligibilityService","currencyHelper","creditCardTypeDetectionService","dateHelper","deviceConst","exteriorImageIndexHelper","eventsConst","featureFlags","gdpSavingsService","globalLoaderCounter","guestdataAnalytics","GuestdataBookingGroupCreationService","GuestdataBookingGroupPickupService","GuestdataBookingPpcService","GuestdataBookingService","guestdataConst","guestdataFormatter","guestInfoHelper","hotelHelper","localeService","modalService","objectHelper","omniture","omnitureConst","pageEventsHelper","pagesConst","patternsConst","pricingDetails","ratesInventory","ratesConst","ratePlanHelper","rapidBookService","scrollHelper","searchCriteriaData","sessionStorageHelper","siteConfig","strings","thirdPartyMarketingService","travelAgentService","values",function(e,t,o,i,s,c,l,u,d,p,m,g,f,h,E,v,y,C,P,A,b,R,S,I,T,O,N,_,D,M,k,L,w,$,x,G,F,U,H,B,V,j,Y,W,q,K,z,Q,X,J,Z,ee,te,re,ne,oe,ae,ie,se,ce,le){p.branch.closeJourney();var ue,de,pe,me,ge=this,fe={GROUP_CREATION:w,GROUP_PICKUP:$,POINTS_PLUS_CASH:x,STANDARD:G};function he(){return c.holdTypeGuaranteeObj="",Ee()&&c.checkout.guaranteePolicyCode===F.GUARANTEE_METHOD.HOLD_TIME_4PM?(c.holdTypeGuaranteeObj={code:F.GUARANTEE_TYPE.HOLD_4P,name:ie.guestData.guaranteeMethodType4PMHold},!0):!(!Ee()||c.checkout.guaranteePolicyCode!==F.GUARANTEE_METHOD.HOLD_TIME_6PM)&&(c.holdTypeGuaranteeObj={code:F.GUARANTEE_TYPE.HOLD_6P,name:ie.guestData.guaranteeMethodType6PMHold},!0)}function Ee(){return c.isIwsMexico()&&"MX"===c.hotel.address.country&&!!c.checkout.travelAgentIATANumber}function ve(e){var t;if((t=c.guestInfo)&&t.address&&t.address.county&&t.address.country&&(A.getCounties(t.address.country)||delete c.guestInfo.address.county),ye(c.guestInfo),!c.generalErrors.INVALID_CHECKOUT_CP_NUMBER_REQUIRED||!A.getCountry(c.guestInfo.address.country).cpEligible||b.get().signedIn||c.guestInfo.cpNumber&&c.guestInfo.cpNumber.length||c.checkout.groupRoomCounts||c.checkout.enrollInChoicePrivileges)return!0;e.preventDefault(),c.shakeNotification=!0,l((function(){c.shakeNotification=!1}))}function ye(e){e&&e.address&&e.address.subdivision&&e.address.country&&(A.getStates(e.address.country)||(c.formContainer.guestForm.subdivision&&c.formContainer.guestForm.subdivision.$setValidity("required",!0),delete c.guestInfo.address.subdivision))}function Ce(){var e=y.get();return e.ratePlan===Z.RATE_PLAN_CODES.PPC?F.BOOKING_TYPE.POINTS_PLUS_CASH:e.groupInfo?F.BOOKING_TYPE.GROUP_PICKUP:e.groupRoomCounts?F.BOOKING_TYPE.GROUP_CREATION:F.BOOKING_TYPE.STANDARD}function Pe(){return se.isThirdPartyMarketingTravelAgentIATANumber(c.checkout.travelAgentIATANumber)}function Ae(){return ae.deviceType!==O.MOBILE&&!!y.get().groupInfo&&y.get().groupInfo.centralGroupModifiable}function be(){return D.IWSR_MASTER&&D.IWSR_COUNTRY_AU&&Q.gdpPrivacyPolicyLocales.test(t.id)}function Re(){return D.IWSR_MASTER&&D.IWSR_COUNTRY_AU&&Q.gdpGuaranteePolicyLocales.test(t.id)}function Se(e){e&&c.generalErrors&&c.generalErrors[e]&&delete c.generalErrors[e]}function Ie(){return(c.checkout.ratePlan===Z.RATE_PLAN_CODES.CUG||c.checkout.ratePlanCategory.indexOf(Z.RATE_PLAN_CODES.FENCED)>=0)&&((!c.guestInfo.address||A.getCountry(c.guestInfo.address.country).cpEligible)&&(!c.guestInfo.cpNumber||!c.guestInfo.cpNumber.length)&&!b.get().signedIn&&!c.checkout.groupRoomCounts&&!c.checkout.enrollInChoicePrivileges||!1)||!!c.guestInfo.cpNumber&&c.formContainer.guestForm.cpNumber.$invalid&&c.formContainer.guestForm.$submitted}function Te(){return ue.shouldShowCreditCardFields(c.checkout)}function Oe(){(c.guestInfo||{}).paymentMethod&&(c.hideCreditFields=c.guestInfo.paymentMethod===ie.general.paymentMethods.agency),Ne(),c.hideCreditFields&&c.guestInfo&&(c.guestInfo.creditCardName=c.guestInfo.creditCardType=c.guestInfo.creditCardNumber=c.guestInfo.expirationMonth=c.guestInfo.expirationYear="")}function Ne(){if(c.guestInfo&&c.isIwsGuaranteeMethodRequired)return c.guestInfo.guaranteeMethod?void(c.guestInfo.guaranteeMethod===F.GUARANTEE_TYPE.HOLD_4P?(c.hideCreditFields=!0,c.iwsGuaranteeHoldType=F.GUARANTEE_METHOD.HOLD_TIME_4PM):c.guestInfo.guaranteeMethod===F.GUARANTEE_TYPE.HOLD_6P?(c.hideCreditFields=!0,c.iwsGuaranteeHoldType=F.GUARANTEE_METHOD.HOLD_TIME_6PM):(c.hideCreditFields=!1,c.iwsGuaranteeHoldType=null)):(c.guaranteeMethodOptions=[],F.GUARANTEE_METHOD_TYPES.forEach((function(e){var t={code:e.code,name:Y.getPropertyByString(ie,e.name)};c.guaranteeMethodOptions.push(t),c.guaranteeMethodOptions.push(c.holdTypeGuaranteeObj)})),void(c.guestInfo.guaranteeMethod=F.GUARANTEE_TYPE.CREDIT_CARD))}function _e(){if(c.isGroupPickupPlanner)return n(c.guestInfo.address,{city:h.UNKNOWN,line1:h.UNKNOWN}),void(c.checkout.enablePrivacySettings=!0);var e,t=b.get();c.formContainer.guestForm&&"function"==typeof c.formContainer.guestForm.$setValidity&&c.formContainer.guestForm.$setValidity(),t.signedIn?function(){if(H.resetGuestInfo(c.guestInfo),angular.extend(c.guestInfo,t),c.guestInfo.address.subdivision&&c.formContainer.guestForm&&c.formContainer.guestForm.postalCode&&c.formContainer.guestForm.postalCode.$setDirty(),D.GDC_GUEST_DATA_PAGE){var e=Boolean((t.mobilePhones||[])[0]&&t.mobilePhones[0].number),r=e&&t.mobilePhones[0].preferences||{},n=function(e,t,r){return e.hasOwnProperty(t)?e[t]:r}.bind(null,r);angular.extend(c.guestInfo,{homePhone:e?t.mobilePhones[0].number:c.guestInfo.homePhone,isMobileNumber:e,sendChoicePrivilegesSMS:n("sendChoicePrivilegesSMS",!1),sendHotelTypeSMS:n("sendHotelTypeSMS",!1),sendMarketingSMS:n("sendMarketingSMS",!1),sendReservationSMS:n("sendReservationSMS",!0)})}t.cpLoyaltyProgramId&&t.cpLoyaltyAccountNumber&&(c.guestInfo.loyaltyProgramId=t.cpLoyaltyProgramId,c.guestInfo.loyaltyAccountNumber=t.cpLoyaltyAccountNumber),t.creditCardType&&y.get().acceptedPaymentCards&&(!!y.get().acceptedPaymentCards.find((function(e){return e.code===t.creditCardType}))||(delete c.guestInfo.creditCardNumber,delete c.guestInfo.creditCardName,delete c.guestInfo.creditCardType,delete c.guestInfo.expirationMonth,delete c.guestInfo.expirationYear))}():(e=oe.getDiscountCode()||P.getDiscountCookie()||{},c.hasDiscount=e.length,["firstName","lastName","email"].forEach((function(t){c.guestInfo[t]=e[t]||c.guestInfo[t]})),D.GDC_GUEST_DATA_PAGE&&(c.guestInfo.isMobileNumber=!0)),c.disabledEdit=!0}function De(t){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"md",n=d.open({scope:c,size:r,templateUrl:"/".concat(ae.assetFingerprint,"/app/guestdata/modals/").concat(t),windowTemplateUrl:"/".concat(ae.assetFingerprint,"/app/bootstrap-ui/modal/generic.modal-window.html")});n.rendered.then((function(){var t=e[0].querySelector("#modal-content");m.isolate(t),t.focus()}))}function Me(t,r,n){c.labelledby=r;var o=d.open({controller:["$scope",function(e){e.$on(_.MODAL_CLOSING,(function(){l((function(){i.$emit(_.MODAL_CLOSED)}))}))}],scope:c,size:"md",templateUrl:"/".concat(ae.assetFingerprint,"/app/guestdata/modals/").concat(t),windowTemplateUrl:"/".concat(ae.assetFingerprint,"/app/bootstrap-ui/modal/generic.modal-window.html")});o.rendered.then((function(){var t=e[0].querySelector("#modal-content");m.isolate(t),t.focus()})),o.closed.then((function(){m.restore(),angular.element(e[0].querySelector("#".concat(n)))[0].focus()})),c.focusCloseButton=function(t){t.preventDefault(),e[0].querySelector("#close-button").focus()}}function ke(e){e.preventDefault(),j.openModal({element:e.target,label:ie.general.groupPickupGuestPrivacy.title,secondaryClass:"cutoff-date-modal",templateUrl:"/app/guestdata/modals/guestdata-group-guest-sharing-reservation-details.modal.html"},c)}function Le(e,t,r){return c.serviceErrorModalData={errors:t,messagesKey:r,title:e},De("guestdata-service-error.modal.html")}function we(){if(D.SO_GDP_EDIT_DATES)return De("guestdata-change-date.modal.html")}function $e(){xe(),p.history.back()}function xe(){C.deleteReservation(c.checkout),y.clear(),M.clearGdpSavings()}function Ge(){var e=c.formContainer.guestForm&&c.formContainer.guestForm.$submitted&&!c.formContainer.guestForm.$valid?q.PAGE_NAME.GUEST_DATA_ERROR:q.PAGE_NAME.GUEST_DATA,t="".concat(e,"_Apply Barclays");W.sendAnalyticsViaCustomLink({linkTrackVars:"prop53,prop54",prop53:e,prop54:"applyBarclays"},t,!0)}function Fe(){if(D.SO_MINIMAL_GDP){var t;if(c.minimalGdp={autofillCollapse:!0,brandSprite:v.BRAND_SPRITES&&v.BRAND_SPRITES[c.hotel&&c.hotel.brandCode],checkBingSubdivisionValidation:function(){c.formContainer.guestForm&&c.formContainer.guestForm.subdivision.$setValidity("required",!0)},checkBingValidation:function(){Ye(!0)},collapseStickyHeader:!1,cpNumberCollapse:!0,creditCardNameUpdated:!1,mobileResDetailsCollapse:!1,nights:T.subtractDates(c.checkout.checkOutDate,c.checkout.checkInDate),pluralNightString:"Congratulations on claiming your reward",pointTotal:c.checkout.ratePlan===Z.RATE_PLAN_CODES.SRD&&Ue(),requestsCollapse:!0,showPostalCode:!(!c.checkout||!c.checkout.groupInfo||c.checkout.groupInfo.chargeRouting!==F.GROUP_BILLING.PLANNER_PAYS),showState:!1,submitReservationMinimal:Xe},c.$watch("formContainer.guestForm",(function(e,t){e||(c.formContainer.guestForm=t)})),ae.deviceType===O.MOBILE)c.$watch((function(){return e[0].activeElement.tagName}),(function(e){t&&l.cancel(t),t=l((function(){return c.minimalGdp.collapseStickyHeader="INPUT"===e}))}));!function(){var t=angular.element(e[0].getElementsByTagName("header")[0]),r=angular.element(e[0].getElementsByTagName("ch-mobile-header")[0]);c.isMobile&&r.addClass("hidden");t.addClass("hidden-xs hidden-sm"),u.onStart({},(function(){t.removeClass("hidden-xs hidden-sm"),r.removeClass("hidden")})),c.$on(_.LOGGED_IN,(function(){t.removeClass("hidden-xs hidden-sm"),r.removeClass("hidden")}))}(),angular.extend(c.getterSetters,{guestNameFunc:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";if(arguments.length)c.guestInfo.creditCardName=e.length>48?e.substring(0,48):e,c.minimalGdp.creditCardNameUpdated=!0;else if(!c.minimalGdp.creditCardNameUpdated){var t=c.guestInfo,r=t.firstName,n=t.lastName,o=r&&n&&"".concat(r," ").concat(n)||r||n||"";c.guestInfo.creditCardName=o.length>2?o:""}return c.guestInfo.creditCardName}})}}function Ue(){var e=b.get(),t=y.get().totalPoints;return(e&&e.loyaltyAccount&&e.loyaltyAccount.accountBalance)-t}function He(){Se("INVALID_CHECKOUT_CP_NUMBER_REQUIRED"),c.checkout.enrollInChoicePrivileges&&(c.minimalGdp.autofillCollapse=!0)}function Be(e){e.preventDefault(),c.minimalGdp.autofillCollapse=!c.minimalGdp.autofillCollapse,c.isGroupAdminPlanner&&!c.minimalGdp.autofillCollapse&&(c.checkout.enrollInChoicePrivileges=!1)}function Ve(t){return t.preventDefault(),e.scrollTopAnimated(250,250).then(je)}function je(){c.minimalGdp.autofillCollapse&&(c.minimalGdp.autofillCollapse=!1),c.checkout.enrollInChoicePrivileges&&(c.checkout.enrollInChoicePrivileges=!1),e[0].querySelector("#member-sign-in").focus()}function Ye(e){if(!D.SO_GDP_ERRORS){var t=ie.guestData.minimalGdp.validationMessages.postalCode;c.formContainer.guestForm.postalCode&&c.formContainer.guestForm.postalCode.$setValidity(t,e)}}function We(e){e&&!e.memberAppended&&(e.name+=ee.getMemberStatus(e),e.memberAppended=!0)}function qe(){c.minimalGdp.showState=!0,de=!0,Ye(!1)}function Ke(){var e=Q.postalCodePatterns.postalCodeFor[c.guestInfo.address.country]||Q.postalCodePatterns.postalCode;e&&c.guestInfo.address.postalCode&&Ye(e.test(c.guestInfo.address.postalCode))}function ze(){var e=c.formContainer.guestForm;return!function(){if(!c.checkout)return!1;var e=c.checkout,t=e.groupRoomCounts,r=e.groupInfo,n=e.prePaidNoCancel,o=e.cancelExpired,a=e.cancellationDeadline;return Boolean(!t&&!r&&(n||o||!a))}()||!0===e.prepaidAgreementCheckbox}function Qe(){var e=c.guestInfo&&c.guestInfo.address;e&&c.isAmrProperty&&c.addressesAreLinked&&n(c.checkout,{billingAddress1:e.line1,billingAddress2:e.line2,billingCity:e.city,billingCountry:e.country,billingPostalCode:e.postalCode,billingSubdivision:e.subdivision})}function Xe(){var e=A.getStates(c.guestInfo.address.country),t=c.formContainer.guestForm;if(ze()&&function(){var e=c.formContainer.guestForm;return!be()||!0===e.iwsPrivacyPolicyAgreementCheckbox}()&&function(){var e=c.formContainer.guestForm;return!Re()||!0===e.iwsGuaranteePolicyAgreementCheckbox}()&&t.email.$modelValue&&t.homePhone.$modelValue){var r,o=b.get();n(c.guestInfo.address,{city:c.guestInfo.address.city||o&&o.address&&o.address.city||h.UNKNOWN,line1:c.guestInfo.address.line1||o&&o.address&&o.address.line1||h.UNKNOWN,subdivision:c.guestInfo.address.subdivision||o&&o.address&&o.address.subdivision||h.UNKNOWN}),e||ye(c.guestInfo),A.getCountry(c.guestInfo.address.country).postalCoded&&!Q.gdpSkipBingCountryCodes.test(c.guestInfo.address.country)?(k.inc(),E.getBingData(c.guestInfo.address.country,c.guestInfo.address.postalCode,c.guestInfo.address.subdivision).then((function(t){if(!(r=t&&(e&&e.length?E.validate(t.formattedAddress,t.adminDistrict):E.validate(t.formattedAddress,t.countryRegion)))&&!c.minimalGdp.showState)return qe(),de=!0,void(c.formContainer.guestForm&&c.formContainer.guestForm.subdivision&&c.formContainer.guestForm.subdivision.$setValidity("required",!1));if(c.formContainer.guestForm&&c.formContainer.guestForm.subdivision&&c.guestInfo.address.subdivision&&c.formContainer.guestForm.subdivision.$setValidity("required",!0),c.formContainer.guestForm&&c.formContainer.guestForm.subdivision&&c.guestInfo.address.subdivision&&Ke(),e&&e.length&&!c.minimalGdp.showState&&t){var n=function(e,t,r){return e.filter((function(e){return e.name===t||e.name===r||e.code===t||e.code===r}))}(e,t.adminDistrict,t.adminDistrict2);n.length&&n[0].code?c.guestInfo.address.subdivision=n[0].code:qe()}t.locality&&(c.guestInfo.address.city=t.locality)})).finally((function(){k.dec(),(r||de)&&c.submitReservation()}))):c.submitReservation()}else t.$valid=!1}c.$on(_.RESERVATION_SUMMARY_UPDATED,(function(){M.calculateSavings(c.checkout.rooms),J&&J.rackLocalCurrency&&J.rackLocalCurrency.roomStayCharges&&c.checkout.rooms.map((function(e){var t=e.rackPrice=J.rackLocalCurrency.roomStayCharges.find((function(t){return t.roomCode===e.roomCode}));return t&&(e.rackPrice=t.avgNightlyBeforeTax),e})),c.checkout.totalSavings=oe.getGdpSavings().savingsTotal>0?oe.getGdpSavings().savingsTotal:oe.getGdpSavings().additional,c.minimalGdp.pointTotal=Ue(),We(c.currentRatePlan)})),me=Ce(),ue=new fe[me],K.preloaded(ue.PAGE_NAME),function(){var e,o=a({},y.get()),l=a(a({},H.createGuestInfo()),o.guest),u=ae.deviceType!==O.MOBILE&&!!y.get().groupRoomCounts,d=Ae(),p=(e=oe.getGroupAdminContext(),Ae()&&e&&b.get().signedIn&&b.get().cpLoyaltyProgramId===e.cpLoyaltyProgramId&&b.get().cpLoyaltyAccountNumber===e.cpLoyaltyAccountNumber||!1),m=(oe.getClientFile()||{}).isAllowedToUseVirtualCreditCard,g=r(586).replace(/\{headerString\}/gi,i.strings.guestData.guestInfo.virtualCreditCard).replace(/\{bodyString\}/gi,i.strings.guestData.guestInfo.virtualCreditCardTooltipBody),f=D.SO_GDP_VISA_LG2&&"USD"===o.currencyCode&&"US"===l.address.country&&"en-us"===t.id&&ae.deviceType!==O.MOBILE&&!m,h=Re(),E=be(),v=Q.gdpBookButtonAltTextLocales.test(ae.locale);l.address=a({},l.address),M.calculateSavings(o.rooms),J&&J.rackLocalCurrency&&J.rackLocalCurrency.roomStayCharges&&o.rooms.map((function(e){var t=J.rackLocalCurrency.roomStayCharges.find((function(t){return t.roomCode===e.roomCode}));return t&&(e.rackPrice=t.avgNightlyBeforeTax),e})),n(o,{billingCountry:!c.isAmrProperty&&"US",guest:l,prePaidNoCancel:(o.nonRefundable||!!o.cancelExpired)&&(o.guaranteePolicyCode===F.GUARANTEE_METHOD.DEPOSIT||o.guaranteePolicyCode===F.GUARANTEE_METHOD.PRE_PAYMENT),ratePlanCategory:o.rooms&&o.rooms.length&&o.rooms[0].ratePlanCategoryList&&o.rooms[0].ratePlanCategoryList.length&&o.rooms[0].ratePlanCategoryList.map((function(e){return e.category}))||[],specialRequests:"",totalSavings:oe.getGdpSavings().savingsTotal>0?oe.getGdpSavings().savingsTotal:oe.getGdpSavings().additional}),d&&(o.enablePrivacySettings="US"===l.address.country),p&&(o.groupInfo.guest=l),n(c,{IS_GDP_VISA:f,acceptedPaymentCards:o.acceptedPaymentCards,addressesAreLinked:!0,ageVerificationAgreement:s.trustAsHtml(ie.general.amrAgeVerificationAgreementHtml),ageVerificationAgreementError:ie.general.amrAgeVerificationAgreementError,assetFingerprint:ae.assetFingerprint,bestInternetRateGuaranteeMessage:s.trustAsHtml(D.SO_MINIMAL_GDP?ie.guestData.bestRateShortHtml:ie.guestData.bestRateHtml),changeDateRefresh:$e,changeDatesModal:we,checkout:o,cpPpcAgreementLabel:"".concat(ie.guestData.cpPpcAgreementText)+"<span class='strong'>".concat(ie.guestData.cpPpcAgreementSubtext,"</span>"),cugAgreement:s.trustAsHtml(ie.guestData.cugAgreementHtml),deleteReservation:xe,formContainer:{},formatCurrency:S.formatCurrency,generalErrors:{},getExteriorImageIndex:N.getExteriorImageIndex,getterSetters:{},guestDataAgreement1:s.trustAsHtml(ie.guestData.agreement1),guestDataStringsHelper:U.stringsHelper,guestInfo:l,guestInfoErrors:{},guestdataConst:F,handleChangeCheckboxEnrollInChoicePrivileges:He,handleCheckoutErrors:ue.handleCheckoutErrors.bind(ue),handleClickToggleMinimalSigninAutofill:Be,handleIwsGuarantee:Ne,handleOpenSharingReservationDetailsModal:ke,handleRedirectToSigninAutofill:Ve,hideCreditFields:!1,hotel:o.hotel,hotelHelper:B,isAllowedToUseVirtualCreditCard:m,isAmrProperty:B.isHotelAMResort(o.hotel),isGroupAdminPlanner:u,isGroupPickupGuest:d,isGroupPickupPlanner:p,isIwsGuaranteePolicyRequired:h,isIwsMexico:ue.isIwsMexico.bind(),isIwsPrivacyPolicyRequired:E,isMobile:ae.deviceType===O.MOBILE,isThirdPartyMarketingTravelAgent:Pe,iwsGuaranteeHoldType:null,iwsGuaranteePolicyAgreement:s.trustAsHtml(ie.guestData.iwsGuaranteePolicyAgreementHtml),iwsGuaranteePolicyAgreementError:s.trustAsHtml(ie.guestData.iwsGuaranteePolicyAgreementErrorHtml),iwsPrivacyPolicyAgreement:s.trustAsHtml(ie.guestData.iwsPrivacyPolicyAgreementHtml),iwsPrivacyPolicyAgreementError:s.trustAsHtml(ie.guestData.iwsPrivacyPolicyAgreementErrorHtml),mobileMinimalReservationSummaryPartial:ue.MOBILE_MINIMAL_RESERVATION_SUMMARY_PARTIAL,openModal:De,openRatePlanDetail:Me.bind(this,"guestdata-rate-plan-details.modal.html","currentRatePlan","openRatePlanDetail"),openServiceFailureModal:Le,openTaxesAndFees:Me.bind(this,"guestdata-taxes-fees.modal.html","taxesAndFeesHeader","openTaxesAndFees"),prepaidAgreement:s.trustAsHtml(ie.guestData.prepaidAgreementHtml),prepaidAgreementError:s.trustAsHtml(ie.guestData.prepaidAgreementErrorHtml),rapidBook:te,ratesConst:Z,redirectToSigninAutofill:je,removeGeneralErrorType:Se,reservationPaymentPolicyPartial:"/app/guestdata/payment-policy.html",reservationSummaryPartial:ue.RESERVATION_SUMMARY_PARTIAL(),scrollToFirstElement:re.scrollToFirstElement,sendCCBannerAnalytics:Ge,shakeNotification:ve,shouldHideLPG:D.AMR_MASTER&&B.shouldHideLPG(o.hotel),shouldShowCreditCardFields:Te,showCCFields:o.ratePlan===Z.RATE_PLAN_CODES.PPC||o.centralPaymentRequired&&(D.AMR_MWEB_MASTER||D.AMR_MASTER),showCPVBanner:Ce()!==F.BOOKING_TYPE.GROUP_CREATION&&Ce()!==F.BOOKING_TYPE.GROUP_PICKUP,showCPVMiniBanner:function(){return Ce()!==F.BOOKING_TYPE.GROUP_CREATION&&Ce()!==F.BOOKING_TYPE.GROUP_PICKUP&&D.SO_MINIMAL_GDP&&!m&&ae.deviceType!==O.MOBILE},showCUGNotification:Ie,showHideCreditFields:Oe,showIwsGuaranteeMethod:he,showMobilePhoneLabel:D.GDC_GUEST_DATA_PAGE,submitReservation:ue.submitReservation.bind(ue),termsAndConditions:s.trustAsHtml(ie.guestData.cpVisaMiniBanner.termsAndConditionsHtml),travelAgent:ce.get(),updateLinkedAddresses:Qe,useBookButtonAltText:v,values:le,virtualCreditCardTooltipHtml:g}),c.isIwsReservationsClubRequired=c.isIwsMexico(),c.isIwsGuaranteeMethodRequired=he(),Ne(),((c.travelAgent||{}).guaranteeWithAccount||c.isIwsReservationsClubRequired)&&(c.paymentMethods=ie.general.paymentMethods,c.guestInfo.paymentMethod=ie.general.paymentMethods.credit),c.isAmrProperty&&o.ratePlan===Z.RATE_PLAN_CODES.PPC&&(c.cpPpcAgreementLabel=ie.guestData.cpPpcAgreementTextAMR)}(),Fe(),ue.initialize(c,ge,X),function(){function e(e){c.checkout.enrollInChoicePrivileges=!!e}c.$watch("guestInfo.address.country",(function(t){e(!!V.isDomestic()&&F.ENROLL_IN_CHOICE_PRIVILEGES_DEFAULT[t]),c.isUS="US"===t,c.guestInfo.isMobileNumber=c.isUS,c.isGroupPickupGuest&&(c.checkout.enablePrivacySettings=c.isUS),c.formContainer.guestForm&&c.formContainer.guestForm.country&&c.formContainer.guestForm.country.$dirty&&delete c.guestInfo.address.subdivision,c.minimalGdp=c.minimalGdp||{},c.minimalGdp.showState=Q.gdpSkipBingCountryCodes.test(t)})),c.$watch("guestInfo.address.subdivision",(function(){c.guestInfo.address.subdivision&&c.formContainer.guestForm&&c.formContainer.guestForm.postalCode&&c.formContainer.guestForm.postalCode.$dirty&&Ke()})),c.$watch("guestInfo.cpNumber",(function(t){e(!!V.isDomestic()&&!t)})),c.$watch("cpUser.signedIn",(function(t){e(!!V.isDomestic()&&!t),_e()})),c.$watch("guestInfo.lastName",(function(){(c.formContainer.guestForm||{}).cpNumber&&c.formContainer.guestForm.cpNumber.$setValidity("account",!0)})),c.$watch("checkout.rooms",(function(e){!function(e){Array.isArray(e)&&e.length>0&&(c.shouldShowGuestWarning=e.some((function(e){var t=e.adults,r=e.minors;return B.shouldShowGuestWarning(t,r)})))}(e)})),c.$watch("guestInfo.address",(function(e){e&&Qe()})),c.$on(_.LOGGED_IN,(function(){_e(),c.formContainer.guestForm.$setPristine(),Ye(!1),K.loaded(ue.LOGGED_IN_PAGE_NAME,c.checkout),I.destroyed()})),c.$on(_.LOGGED_OUT,(function(){H.resetGuestInfo(c.guestInfo),c.formContainer.guestForm&&(c.formContainer.guestForm.$setUntouched(),c.formContainer.guestForm.$setPristine()),c.guestForm&&(c.guestForm.$setUntouched(),c.guestForm.$setPristine()),Fe(),I.destroyed()})),c.$on(_.BARCLAYS.POSTBACK_RECEIVED,(function(e,t){!function(e){c.showCPVBanner=!1,"PARTIAL"!==e.status||null===e.outputErrors?R.isValidCheckout(y.get())&&e.barclaysInstantCredit&&e.barclaysInstantCredit.decisionCode===g.DECISION_CODE.APPROVED&&angular.extend(c.guestInfo,f.getCardData(),{creditCardName:(c.guestInfo.firstName||"")+(c.guestInfo.lastName?" ".concat(c.guestInfo.lastName):""),updateCustomerProfile:b.get().signedIn}):Le(ie.cp.errors.barclaysPostBackError,{},"barclaysPostBackErrors")}(t)}))}(),te.initializeViewState(me,c.checkout.acceptedPaymentCards),ue.loadCmsContent(),c.checkout.rooms&&c.checkout.rooms.length||(P.getGuestDataCookie()?(ne.update(P.getGuestDataCookie()),c.noCheckoutContext=ie.guestData.noCheckoutDataWithCookieData,c.generalErrors.prop19=ie.guestData.noCheckoutDataWithCookieData.substring(0,100)):c.noCheckoutContext=c.generalErrors.prop19=ie.guestData.noCheckoutData,c.generalErrors.prop35="".concat(ie.guestData.noCheckoutDataWithCookieData.substring(0,74),":").concat(c.checkout.sessionStorageInternalID)),_e(),(pe=ue.getHotel().then((function(e){c.hotel=angular.extend({},c.hotel,e),c.isAmrProperty=B.isHotelAMResort(c.hotel),c.shouldHideLPG=D.AMR_MASTER&&B.shouldHideLPG(c.hotel),c.shouldHideGuaranteePolicy=D.AMR_MASTER&&B.shouldHideGuaranteePolicy(c.hotel),c.checkout.groupRoomCounts&&c.hotel&&(c.checkout.taxes=c.hotel.taxes,c.checkout.fees=c.hotel.fees),c.currentRatePlan=c.checkout.ratePlanDetail,We(c.currentRatePlan)})),k.inc(),o.all(pe).then((function(){K.loaded(ue.PAGE_NAME,c.checkout,c.hotel)})).catch(ue.fireGuestDataErrorPageEvent.bind(ue)).finally(k.dec)).finally((function(){L.init(c,X),i.$emit(_.ANALYTICS_PAGE_LOADED,z.GUEST_DATA)})),c.isWoodspring=D.WOODSPRING_MASTER&&c.hotel&&c.hotel.brandCode===v.BRAND_CODES.WOODSPRING,c.checkout&&B.shouldHotelShowSrdOccupancyWarning(c.hotel,c.checkout.ratePlan)&&(c.showSrdMaxOccupancyWarning=!0),c.checkout&&(c.isPointsBooking=c.checkout.ratePlan===Z.RATE_PLAN_CODES.SRD||c.checkout.ratePlan===Z.RATE_PLAN_CODES.PPC,c.isPPCBooking=c.checkout.ratePlan===Z.RATE_PLAN_CODES.PPC)}]},function(e,t){e.exports='<div>\n  <div class="tooltip-header">\n    {headerString}\n  </div>\n  <div class="tooltip-body">\n    {bodyString}\n  </div>\n  <br>\n</div>\n'},function(e,t){e.exports=["$scope","$timeout","$window","pagesConst","pageMetaData","reactHelper","strings",function(e,t,r,n,o,a,i){var s=a.generatePageId();a.loadReactApp((function(){var c=r.React.createElement(r.Provider,{store:r.store},r.React.createElement(r.GuestDataPageDesktop,{pageId:s,pageOnLoad:function(){a.pageLoad(n.REACT_GUEST_DATA),o.update({title:i.guestData.pageMetaDataTitleAlternative})}}));t((function(){return a.renderToScope(c,document.getElementById("react-guest-data"),e)}))}))}]},function(e,t){e.exports=["$document","$rootScope","$scope","$timeout","$window","reactHelper",function(e,t,r,n,o,a){var i=a.generatePageId();a.loadReactApp((function(){var e=o.React.createElement(o.Provider,{store:o.store},o.React.createElement(o.GuestDataPageMobile,{pageId:i,pageOnLoad:a.pageLoad,referrerState:t.referrerState}));n((function(){return a.renderToScope(e,document.getElementById("guest-data-page-mobile"),r)}))})),angular.element(e[0].getElementsByTagName("ch-mobile-header")[0]).addClass("hidden")}]},function(e,t){e.exports={bindings:{checkout:"=",handleCheckoutErrors:"=",hotel:"=",openServiceFailureModal:"="},controller:["$location","$rootScope","$scope","$stateParams","checkoutContextData","checkoutService","currenciesConst","deviceConst","eventsConst","featureFlags","gdpSavingsService","globalLoaderCounter","guestdataAnalytics","guestdataFormatter","objectHelper","omniture","pagesConst","queryParamsConst","ratesConst","routeConst","selectedLangData","siteConfig","strings","urlParserService",function(e,t,r,n,o,a,i,s,c,l,u,d,p,m,g,f,h,E,v,y,C,P,A,b){var R=this;p.setRoomListController(this);var S,I=l.SO_GDP_SAVINGS_V2&&R.checkout.currencyCode.toLowerCase()===i.CURRENCY_CODES.USD,T=o.get();function O(e){delete e.guest,o.update(e),g.deepExtend(R.checkout,e)}function N(){t.$emit(c.ANALYTICS_PAGE_LOADED,h.GUEST_DATA)}function _(){if(R.checkout.ratePlan===v.RATE_PLAN_CODES.PPC){var e=R.checkout.guest.pointsPlusCashAccountStatus;if(!e)return!1;if(e.pointsBalance-R.checkout.totalPoints<R.checkout.guest.pointsPlusCashAccountStatus.minimumPointsPerNight)return!1}return R.checkout.groupRoomCounts||R.checkout.rooms&&R.checkout.rooms.length<(v.MULTI_ROOM.MAX_ROOM_FOR_RATE[R.checkout.ratePlan]||v.MULTI_ROOM.MAX_ROOM)}function D(){u.calculateSavings(R.checkout.rooms),angular.forEach(R.checkout.rooms,(function(e){e.rackTotal=u.getRackTotal(e)}))}R.startEditingRoom=function(e){R.isEditing=!0,R.selectedRoomIndex&&R.cancelEditingRoom();var t=R.checkout.rooms[e];R.roomBeingEditedBackup=angular.copy(t),R.selectedRoomIndex=e,R.checkForRoomOccupancyError(t),N()},R.cancelEditingRoom=function(){R.isEditing=!1,R.returnFocus=!0,R.checkout.rooms[R.selectedRoomIndex]=R.roomBeingEditedBackup,R.selectedRoomIndex=null,delete R.roomBeingEditedBackup,N()},R.removeRoom=function(n){R.checkout.rooms.length<=1?(a.deleteReservation(R.checkout),o.clear(),u.clearGdpSavings(),e.replace().url(r.returnPath).search({})):(d.inc(),a.deleteRoomFromReservation(R.checkout,n+1).then(O).catch(R.handleCheckoutErrors).catch((function(e){R.openServiceFailureModal(A.guestData.errors.removeRoomError,e.data,"guestDataErrors")})).finally((function(){R.displayAddAnotherRoomButton=!!_(),t.$broadcast(c.RESERVATION_SUMMARY_UPDATED),d.dec(),N(),I&&D()})),t.isMobile&&(R.removeExpanded[n]=!1))},R.saveEditedRoom=function(){d.inc(),a.updateRoomInReservation(R.checkout,R.selectedRoomIndex+1).then(O).catch(R.handleCheckoutErrors).catch((function(e){R.checkout.rooms[R.selectedRoomIndex]=R.roomBeingEditedBackup,R.openServiceFailureModal(A.guestData.errors.modifyRoomError,e.data,"guestDataErrors")})).finally((function(){d.dec(),R.selectedRoomIndex=null,R.isEditing=!1,R.returnFocus=!0,I&&D()}))},R.calculateSelectedNightlyRate=function(e){return m.calculateSelectedNightlyRate(e,R.checkout.currencyCode)},R.checkForRoomOccupancyError=function(e){var t=e.capacity+(e.extraBed?1:0),r=e.capacity+(e.extraBedOption?1:0),n=+e.adults+ +e.minors;n>r?e.error="EXCEEDED":n>t?e.error="EXTRA_BED_REQUIRED":delete e.error,e.error&&N()},R.sendViewRateDetails=function(e){"true"===e.target.getAttribute("aria-expanded")&&f.sendAnalyticsViaCustomLink({},"ViewRateDetails")},S=R.checkout.groupInfo?R.checkout.groupInfo.pickupUrl:R.hotel.ratesPageUrl,n.groupId=R.checkout.groupInfo&&R.checkout.groupInfo.groupId,S||(S=b.getPropertyRatesUrl(R.hotel.address,R.hotel.brandCode,R.hotel.id,C.get().code)),P.deviceType===s.MOBILE&&l.SO_MOB_PRATES_NEW_JOIN?r.returnPath="".concat(S,"#").concat(y.CHANGE_RESERVATION_HASH):r.returnPath=S,R.isEditing=!1,R.editMode="modifyRoom",R.returnFocus=!1,R.displayAddAnotherRoomButton=!!_(),R.plusMinusDropdownMode="compact",R.selectedRoomIndex=null,R.roomListCollapse=!1,R.extraBedOptions=["","ROLLAWAY","CRIB"].map((function(e){return{code:e}})),R.checkout.ratePlan===v.RATE_PLAN_CODES.PPC&&r.$watch("roomList.checkout.guest.pointsPlusCashAccountStatus.pointsBalance",(function(){R.displayAddAnotherRoomButton=!!_()})),R.collapse=function(){R.roomListCollapse=!R.roomListCollapse},R.addAnotherRoom=function(){R.checkout.groupInfo?e.path(R.checkout.groupInfo.pickupUrl):(e.path(R.hotel.ratesPageUrl),e.search(E.RATE_PLAN_CODE,T.ratePlan))},I&&D(),l.SO_MINIMAL_GDP&&t.isMobile&&(R.removeExpanded=!1)}],controllerAs:"roomList",templateUrl:["siteConfig",function(e){return"/".concat(e.assetFingerprint,"/app/guestdata/guestdata-room-list.html")}]}},function(e,t){function r(){return(r=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e}).apply(this,arguments)}var n=0;e.exports={bindings:{errorDescription:"<",hasSubmitted:"<",label:"<",name:"@",optional:"<",value:"=?"},controller:function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),n++;var t="guest-data-agreement-checkbox-".concat(n),o="".concat(t,"-label"),a="".concat(t,"-error"),i="GuestDataAgreementLabel".concat(n);r(this,{focused:!1,inputErrorDataTrackId:"GuestDataAgreementCheckboxError".concat(n),inputErrorId:a,inputId:t,inputLabelDataTrackId:i,inputLabelId:o})},controllerAs:"checkbox",templateUrl:["siteConfig",function(e){return"/".concat(e.assetFingerprint)+"/app/guestdata/checkbox/guestdata-agreement-checkbox.component.html"}]}},function(e,t){e.exports=["$http","$q","bingLocationApiConst","stringsHelper","urlEncodeObject",function(e,t,r,n,o){function a(e){return(e=e.toString())&&e.length&&(e=e.replace(/[\u2018\u2019]/g,"'"),e=n.accentFold(e)),e}return{getBingData:function(n,i,s){var c=t.defer();"JP"===n&&(i=i.toString().substr(0,3));var l={countryRegion:n,incl:r.CISO2,jsonp:r.JSON_CALLBACK,key:r.API_KEY,postalCode:i};return s&&(l.adminDistrict=s),e.jsonp(r.SRC+o(l)).success((function(e){if(e&&e.resourceSets&&e.resourceSets.length&&e.resourceSets[0].resources&&e.resourceSets[0].resources.length&&e.resourceSets[0].resources[0].address){var t=e.resourceSets[0].resources[0].address,r={};for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(r[n]=a(t[n]));c.resolve(r)}else c.resolve(!1)})).error((function(){c.resolve(!1)})),c.promise},validate:function(e,t){return!!(e&&t&&e.indexOf(t)>-1&&e.length>t.length)}}}]},function(e,t){function r(e){return function(e){if(Array.isArray(e))return n(e)}(e)||function(e){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e))return Array.from(e)}(e)||function(e,t){if(!e)return;if("string"==typeof e)return n(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Array.from(e);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return n(e,t)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function n(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}e.exports=["$rootScope","$window","analyticsConst","analyticsManager","checkoutContextData","conversionTrackingService","cookieHelper","cpUserData","cpVisaEligibilityService","dateHelper","eventsConst","featureFlags","multiRoomHelper","omniture","omnitureConst","pagesConst","rapidBookService","ratesConst","searchConst","searchCriteriaData","strings",function(e,t,n,o,a,i,s,c,l,u,d,p,m,g,f,h,E,v,y,C,P){var A,b,R={address:{city:"",country:"",subdivision:""},brandCode:"",id:"",productCode:"",supplier:{code:""},unit:{typeCode:"",typeId:""}};function S(){return(A||{}).isEditing}function I(){return b.hotel||R}function T(){var e=(A||{}).selectedRoomIndex;return A&&A.checkout.rooms[e]}function O(){if(S()){var e=T();return e&&e.error?P.propertyRates.occupancyStatus[e.error]:void 0}}function N(e){var t=[],r=angular.merge({},b.generalErrors,b.guestInfoErrors);return e?t.push(r[e]):angular.forEach(r,(function(e){t.push(e)})),t}function _(){var e=a.get();return e.groupRoomCounts?m.getNumberOfRoomsFromGroupRoomCounts(e.groupRoomCounts):(e.rooms||[]).length}function D(){return _()*(e=a.get(),u.subtractDates(e.checkOutDate,e.checkInDate));var e}return o.setPageDefaults({ERROR_MESSAGES:P.guestData.cugOmnitureText,PAGE_NAME:h.GUEST_DATA_NOENROLL},h.GUEST_DATA_NOENROLL),o.setPageDefaults({PAGE_NAME:h.GUEST_DATA_ENROLL},h.GUEST_DATA_ENROLL),o.setPageDefaults({PAGE_NAME:h.BARCLAYS_APPLICATION_POP},h.BARCLAYS_APPLICATION_POP),{handleFormErrorAnalyticsOnSubmit:function(t,r){if(t&&(!t||t.$error)){var n=a.get();r=N(),(n.ratePlanCategory&&n.ratePlanCategory.indexOf(v.RATE_PLAN_CODES.PREPD)>=0||v.ADVANCE_PURCHASE_RATE_PLANS.indexOf(n.ratePlan)>=0&&!t.prepaidAgreementCheckbox)&&(r.length?r+=", ".concat(P.guestData.prepaidAgreementErrorHtml):r=P.guestData.prepaidAgreementErrorHtml);var i=(r||"")+P.guestData.correctFields+(function(e){return Object.keys(e.$error).reduce((function(t,r){var n={fieldsWithError:[],messageUserSees:""};return e.$error[r].forEach((function(e){var t,o;e.$name&&(n.fieldsWithError=n.fieldsWithError.concat(e.$name),n.messageUserSees=(t=e.$name,o=r,P.guestData.validationMessages[t]&&P.guestData.validationMessages[t][o]||P.general.validationMessages[o]||p.SO_MINIMAL_GDP&&P.guestData.minimalGdp.validationMessages[t]||"err=".concat(t)))})),t.concat(n)}),[]).reduce((function(e,t){return"".concat(e+(t.messageUserSees||"")+t.fieldsWithError.reduce((function(e,t){return"".concat(e,"|").concat(t)}),"")," ")}),"")}(t)||"");o.setPageDefaults({ERROR_MESSAGES:i.substr(0,100),PAGE_NAME:h.GUEST_DATA_ERROR},h.GUEST_DATA_ERROR),e.$emit(d.ANALYTICS_PAGE_LOADED,h.GUEST_DATA_ERROR)}},init:function(t){o.initialize(),g.clearPreviousProperties(),b=t;var m=a.get(),A=I(),R=A.address||{};if(p.SO_URGENCY_CANCELLATION_TIMER||p.SO_URGENCY_TIMER_ONLY){var M=e.$on(d.BOOKING_URGENCY.HOLD_ROOM,(function(t,r){b.holdRoom=r,e.$emit(d.ANALYTICS_PAGE_LOADED,h.GUEST_DATA)})),k=e.$on(d.BOOKING_URGENCY.SESSION_TIMEOUT,(function(t,r){b.sessionTimeout=r,e.$emit(d.ANALYTICS_PAGE_LOADED,h.GUEST_DATA)}));b.$on("$destroy",(function(){M(),k()}))}function L(){return l.isDiscountEligible(b.cpUser,b.checkout)?f.ADS.CPVISA_MATH:f.ADS.CPVISA}"XLY"===m.currencyCode&&(m.currencyCode="USD");var w={ADS_CLICKTHROUGH:function(){return b.hasDiscount?L():null},ADS_SERVED:function(){var e=[];if(m.ratePlan===v.RATE_PLAN_CODES.PPC&&e.push(f.POINTS_PLUS_CASH),E.isEnabled&&e.push(f.ADS.RAPID_BOOK),(!b.shouldShowCreditCardFields()||E.isEnabled)&&b.showCPVBanner){var t=L();s.setCPVisaBannerTypeCookie(t),e.push(t)}return b.showCPVMiniBanner()&&e.push(f.ADS.CPVISA_MINI_BANNER),e.join(",")},CLICK_TRACKING:function(){if(S()&&O()){var e=T();return"".concat(e.adults,"Adults").concat(e.minors,"Children")}return b.sessionTimeout||b.holdRoom?"Auto":o.clickTracking.value},CURRENCY_CODE:m.currencyCode,DAYS_PRIOR_TO_ARRIVAL:function(){var e=a.get();return u.subtractDates(e.checkInDate,u.getTodayDate()).toString()},DESTINATION_MARKET:"".concat(R.city,", ").concat(R.subdivision,", ").concat(R.country).toLowerCase(),ERROR_MESSAGES:function(){if(S()&&O())return O();var e=b.chLoginAccessDeniedReferenceAB||"",t=c.get().cpNoAccountError?P.cp.noCpAccount.header:null,n=[].concat(r(N()),[t]).join(",").substr(0,100);return n||e?"".concat(e).concat(e&&n?"|":"").concat(n||""):void 0},ERROR_MESSAGES_OMNITURE_INTERNAL:function(){var e=N(n.ERROR_MESSAGES_OMNITURE_INTERNAL.OMNITURE);if(b.generalErrors[n.ERROR_MESSAGES_OMNITURE_INTERNAL.OMNITURE]&&delete b.generalErrors[n.ERROR_MESSAGES_OMNITURE_INTERNAL.OMNITURE],e)return e.join(",").substr(0,100)},EVENTS:f.EVENT.SCADD,HOTEL_LIST_RATE_PLANS:m.ratePlan,OCCUPANCY:function(){var e=C.get(),t=e.adults,r=e.minors;return"".concat(_(),":").concat(t,"|").concat(r)},PAGE_NAME:function(){var e=y.GROUP_OPTIONS.minRoomsPerGroup,t=v.RATE_PLAN_CODES.PPC,r=S()?"GUEST_DATA_MODIFY_ROOM":m.groupInfo&&m.groupInfo.groupId?"GUEST_DATA_GROUP_PICKUP":_()>=e?"GUEST_DATA_GROUP_BOOKING":m.ratePlan===t?"GUEST_DATA_PPC":b.sessionTimeout?"GUEST_DATA_SESSION_TIMEOUT":b.holdRoom?"GUEST_DATA_HOLD_ROOM":"GUEST_DATA";return(!S()&&N().length||S()&&O())&&(r+="_ERROR"),f.PAGE_NAME[r]},PRODUCTS:function(){return[A.brandCode,I().id,D(),a.get().totalBeforeTax].join(";")},PROPERTY_BRAND_CODE:A.brandCode,PROPERTY_ID:A.id,PROPERTY_PRODUCT_CODE:A.productCode,RESERVATION_MULTI_SINGLE_ROOM:function(){return _()>1?f.ROOM.MULTI:f.ROOM.SINGLE},SEARCH_CHECK_IN_DATE:m.checkInDate,USER_HASHED_CP_ID:function(){return c.get().hashedCpId},PROPERTY_CODE:void 0,ROOM_CODES:void 0};o.setPageDefaults(w,h.GUEST_DATA),p.CONVERSION_TRACKING&&i.reportRemarketingGuestData(m)},setRoomListController:function(e){A=e},trackAnalyticsBarclaysApplyNow:function(){var e=b.checkout.enrollInChoicePrivileges?h.GUEST_DATA_ENROLL:h.GUEST_DATA_NOENROLL;g.sendAnalyticsViaCustomLink(e,f.CLICK_TRACKING.GUEST_DATA.CPVISA_APPLY,!0)},trackAnalyticsBarclaysTerms:function(){var e=b.checkout.enrollInChoicePrivileges?h.GUEST_DATA_ENROLL:h.GUEST_DATA_NOENROLL;g.sendAnalyticsViaCustomLink(e,f.CLICK_TRACKING.GUEST_DATA.BARCLAYS_TERMS,!0)},trackAnalyticsCUGMessage:function(){if(b.checkout.ratePlan===v.RATE_PLAN_CODES.CUG||b.checkout.ratePlan===v.RATE_PLAN_CODES.LADV&&b.generalErrors.INVALID_CHECKOUT_CP_NUMBER_REQUIRED){g.clearPreviousProperties();var t=b.checkout.enrollInChoicePrivileges;o.clickTracking.value=t?f.USER_TYPE.ENROLL_CUG:f.USER_TYPE.NO_ENROLL_CUG;var r=t?h.GUEST_DATA_ENROLL:h.GUEST_DATA_NOENROLL;e.$emit(d.ANALYTICS_PAGE_LOADED,r)}},trackAnalyticsOfferDetails:function(){g.clearPreviousProperties(),o.clickTracking.value=f.CLICK_TRACKING.GUEST_DATA.CPVISA_DETAILS,e.$emit(d.ANALYTICS_PAGE_LOADED,h.BARCLAYS_APPLICATION_POP)}}}]},function(e,t){e.exports=["groupService","GuestdataBookingService","strings",function(e,t,r){return t.extend({getCompleteReservationPayload:function(){for(var e=arguments.length,r=new Array(e),n=0;n<e;n++)r[n]=arguments[n];var o=t.prototype.getCompleteReservationPayload.apply(this,r),a=this.$scope.checkout;return o.rooms=a.rooms,o.hotelId=a.hotelId,o.ratePlan=a.ratePlan,o.checkInDate=a.checkInDate,o.checkOutDate=a.checkOutDate,o},makeCompleteReservationRequest:function(t){var n=this,o=this.$scope;return e.createGroup(t,"credit_card, planner").then((function(t){return e.updateConfirmation({hotel:o.hotel}),e.addRoomInformation(o.checkout.rooms)})).catch((function(e){var t=r.group.createError;throw n.fireGuestDataErrorPageEvent(e,t),o.openServiceFailureModal(t,e.data,"groupCreateErrors"),new Error(t)}))}})}]},function(e,t){e.exports=["checkoutService","GuestdataBookingService","guestdataConst",function(e,t,r){return t.extend({getAbortPageUrl:function(){return this.$scope.checkout.groupInfo.pickupUrl},getCompleteReservationPayload:function(){var e=t.prototype.getCompleteReservationPayload.apply(this);return e.groupId=e.groupInfo.groupId,delete e.groupInfo,e},makeCompleteReservationRequest:function(){for(var r=this.$scope,n=arguments.length,o=new Array(n),a=0;a<n;a++)o[a]=arguments[a];return t.prototype.makeCompleteReservationRequest.apply(this,o).then((function(t){return e.updateConfirmation({groupInfo:r.checkout.groupInfo}),t}))},shouldShowCreditCardFields:function(){return this.$scope.checkout.groupInfo.chargeRouting!==r.GROUP_BILLING.PLANNER_PAYS}})}]},function(e,t){function r(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(e)))return;var r=[],n=!0,o=!1,a=void 0;try{for(var i,s=e[Symbol.iterator]();!(n=(i=s.next()).done)&&(r.push(i.value),!t||r.length!==t);n=!0);}catch(e){o=!0,a=e}finally{try{n||null==s.return||s.return()}finally{if(o)throw a}}return r}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return n(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Array.from(e);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return n(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function n(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function o(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function a(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function i(){return(i=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e}).apply(this,arguments)}e.exports=["$document","$filter","$location","$q","$rootScope","$timeout","$window","checkoutContextData","checkoutService","contentService","cookieHelper","cpUserData","dateHelper","deviceConst","discountCodeConst","eventsConst","featureFlags","globalLoaderCounter","groupService","guestdataAnalytics","guestdataConst","guestService","hotelService","loadScript","objectHelper","pageMetaData","pagesConst","patternsConst","reactConst","regExHelper","routeConst","scrollHelper","searchCriteriaData","selectedLangData","serviceEventConst","serviceEventsHelper","sessionStorageHelper","siteConfig","strings","thirdPartyMarketingConst","thirdPartyMarketingService","tokenizationService","travelAgentData","urlParserService","userHelper",function(e,t,n,s,c,l,u,d,p,m,g,f,h,E,v,y,C,P,A,b,R,S,I,T,O,N,_,D,M,k,L,w,$,x,G,F,U,H,B,V,j,Y,W,q,K){var z=function(){},Q=H.deviceType===E.MOBILE;return z.extend=function(e){var t=function(){};return t.prototype=new z,angular.extend(t.prototype,e),t},angular.extend(z.prototype,{CONFIRMATION_PAGE_PATH:L.CONFIRMATION,LOGGED_IN_PAGE_NAME:_.LOGGED_IN_GUEST_DATA,MOBILE_MINIMAL_RESERVATION_SUMMARY_PARTIAL:C.SO_RES_SUMMARY_MOBILE?"/app/guestdata/minimal-gdp/minimal-gdp-reservation-summary-redesign-mobile.html":"/app/guestdata/minimal-gdp/minimal-reservation-summary-mobile.html",PAGE_NAME:_.GUEST_DATA,RESERVATION_SUMMARY_PARTIAL:function(){var e=d.get();return!C.SO_RES_SUMMARY_DESKTOP||e.groupRoomCounts||e.groupInfo?"/app/guestdata/reservation-summary.html":"/app/guestdata/minimal-gdp/minimal-gdp-reservation-summary-redesign.html"},checkoutService:p,deleteCreditCardRequestParams:function(e){delete e.guest.creditCardNumber,delete e.guest.creditCardName,delete e.guest.creditCardType,delete e.guest.expirationMonth,delete e.guest.expirationYear},fireGuestDataErrorPageEvent:function(e,t){this.$scope.chLoginAccessDeniedReferenceAB=K.verifyAkamaiResponse(e,this.$scope)&&"AB".concat(K.getBotManagerReferenceNumber());var r=Object.keys(this.$scope.generalErrors).length?this.$scope.generalErrors:t?{error:t}:{};return C.SO_GDP_ERRORS&&w.scrollToFirstError(200),angular.extend(r,this.$scope.guestInfoErrors),s.reject(e)},getAbortPageUrl:function(){return this.$scope.hotel.ratesPageUrl},getCompleteReservationPayload:function(){var e,t,r=this.$scope,n=U.getOutsideReferrerUrl()&&U.getOriginatingHotelId(),o=angular.copy(this.$scope.checkout),a=this.getGuestForm(),c=this.shouldShowCreditCardFields.bind(this),d=this.checkoutService;return angular.extend(o,{enrollInChoicePrivileges:f.get().signedIn?void 0:o.enrollInChoicePrivileges,guaranteeMethod:o.guaranteeMethod||o.guaranteeMethodSuggestion||R.GUARANTEE_METHOD_FOR_RATE_PLAN[o.ratePlan]||R.GUARANTEE_METHOD_DEFAULT,originatingHotelId:n?U.getOriginatingHotelId():void 0,referrerUrl:n?U.getOutsideReferrerUrl():void 0}),function(){if(o.guest&&o.guest.address){var e=o.guest.address,t=e.line1,r=e.line2,n=e.city,a=e.postalCode,s=e.subdivision;o.billingCity&&o.billingAddress1||i(o,{billingAddress1:t,billingAddress2:r,billingCity:n,billingPostalCode:a,billingSubdivision:s})}}(),function(){if(o.enrollInChoicePrivileges){var e=o.guest,t=e.username,n=e.password,a=r.clientReferral;t&&n&&i(o,{clientReferral:a,password:n,username:t})}else if(f.get().signedIn){var s=f.get(),c=s.cpLoyaltyAccountNumber,l=s.cpLoyaltyProgramId;i(o,{loyaltyAccountNumber:c,loyaltyProgramId:l})}}(),o.centralPaymentRequired&&(o.guest.paymentSessionId=o.contextId&&o.contextId.substring(0,31).replace("|",""),T("https://sdk.yapstone.com/js/v1/devicefingerprint.js",{cache:!1}).then((function(){s.all([l(1e3)]).then((function(){u.YAPSTONE.DEVICEFINGERPRINT.invokeDF(o.guest.paymentSessionId,"CHI","PAYMENT")}))}))),angular.extend(o.guest,{aaaNumber:o.guest.aaaNumber||void 0,expirationMonth:o.guest.expirationMonth||(a.expirationMonth||{}).$viewValue,expirationYear:o.guest.expirationYear||(a.expirationYear||{}).$viewValue,isVirtualCreditCard:r.guestInfo.isVirtualCreditCard,paymentSessionId:o.guest.paymentSessionId,updateCustomerProfile:r.guestInfo.updateCustomerProfile||!1}),delete o.guest.username,function(){if(C.GDC_GUEST_DATA_PAGE){var e="US"===o.guest.address.country;angular.extend(o.guest,{mobilePhone:o.guest.isMobileNumber?o.guest.homePhone:"",sendChoicePrivilegesSMS:e&&r.guestInfo.sendChoicePrivilegesSMS||!1,sendHotelTypeSMS:e&&r.guestInfo.sendHotelTypeSMS||!1,sendMarketingSMS:e&&r.guestInfo.sendMarketingSMS||!1,sendReservationSMS:o.guest.isMobileNumber&&e||!1})}}(),e=U.getDiscountCode()||g.getDiscountCookie()||{},(!(t=e.ratePlans||[]).length||t.find((function(e){return e.ratePlanCode===o.ratePlan})))&&(o.singleUseCode=e.suc,(e.discountStatus===v.VALID||e.discountStatus===v.UNCONSUMED)&&e.discountCode&&e.guid&&angular.extend(o,{discountGuid:e.guid,discountToken:e.discountCode})),function(){var e=r.travelAgent||{};d.optionallyAddTravelAgentIATANumber(o);var t=W.get()&&"T"!==(U.getClientFile()||{}).clientFileType?W.get().id:o.travelAgentIATANumber;angular.extend(o,{cjTrackingJson:o.travelAgentIATANumber===V.cjIATACode?j.getCookieValue():void 0,guaranteeMethod:e.guaranteeWithAccount&&r.hideCreditFields?R.GUARANTEE_METHOD.TRAVEL_AGENT_AGENCY:o.guaranteeMethod,travelAgentIATANumber:t})}(),r.hideCreditFields&&r.iwsGuaranteeHoldType&&(angular.extend(o,{guaranteeMethod:r.iwsGuaranteeHoldType}),o&o.guest&&(delete o.guest.creditCardNumber,delete o.guest.creditCardName,delete o.guest.creditCardType,delete o.guest.expirationMonth,delete o.guest.expirationYear)),function(){if(C.PRIVACY_PREFERENCE_NON_OPT&&!f.get().signedIn){var e="US"===o.guest.address.country;angular.extend(o.guest,{optOutOfMarketingEmail:!e,optOutOfMarketingMail:!e})}}(),c(o)||(delete o.creditCardSecurityCode,o.guest&&!C.SO_GDP_SIGNED_IN&&(delete o.guest.creditCardNumber,delete o.guest.creditCardName,delete o.guest.creditCardType,delete o.guest.expirationMonth,delete o.guest.expirationYear)),O.removeUndefinedProperties(o),O.removeUndefinedProperties(o.guest),delete o.hotelId,delete o.ratePlan,delete o.checkInDate,delete o.checkOutDate,delete o.rooms,o},getGuestForm:function(){return this.$scope.guestForm||this.controller.guestForm||this.$scope.formContainer.guestForm},getHotel:function(){var e,t=this.$scope.checkout.hotelId,r=this.$scope.checkout.groupRoomCounts,n=C.IWSR_MASTER?"".concat(R.GUESTDATA_HOTEL_DEFAULT_PARAMS.include,", cms"):R.GUESTDATA_HOTEL_DEFAULT_PARAMS.include;r&&(e={checkInDate:this.$scope.checkout.checkInDate,checkOutDate:this.$scope.checkout.checkOutDate},n="time,alerts,taxes_and_fees");return I.getHotel(t,n,e).then((function(e){return e.ratesPageUrl=q.getPropertyRatesUrl(e.address,e.brandCode,t,x.get().code),e}))},handleCheckoutErrors:function(e){var t=this.$scope,r=this.scrollTop,o=this.getGuestForm(),a=this.getAbortPageUrl();return t.disableSubmitButton=!1,t.chLoginAccessDeniedReferenceAB=K.verifyAkamaiResponse(e,t)&&"AB".concat(K.getBotManagerReferenceNumber,"|"),e.data&&!1===e.data.match?b.handleFormErrorAnalyticsOnSubmit(o,t.guestInfoErrors+t.generalErrors):e.data&&function(){function i(){d.clear(),delete t.checkout.contextId,n.replace().path(a).search({})}(e.data.inputErrors||e.data.outputErrors)&&(O.clear(t.generalErrors),angular.extend(t.generalErrors,e.data.outputErrors||e.data.outputInfo||{}),Object.keys(e.data.inputErrors||{}).forEach((function(r){o[r]&&o[r].$setValidity?(o[r].$setValidity(r,!1),t.guestInfoErrors[r]=e.data.inputErrors[r]):t.generalErrors[r]=e.data.inputErrors[r]})),b.handleFormErrorAnalyticsOnSubmit(o,t.guestInfoErrors+t.generalErrors),(e.data.outputErrors||{}).INVALID_CHECKOUT_CP_NUMBER_REQUIRED?C.SO_MINIMAL_GDP&&(Q||!f.get().signedIn)&&w.scrollToFirstWarning(200):(e.data.outputErrors||{}).NONEXISTENT_CHECKOUT_CONTEXT?t.openModal("guestdata-no-context-error.modal.html").result.finally((function(){i()})):(e.data.outputErrors||{}).INVALID_CHECKOUT_ROOM_OR_RATE?t.openModal("guestdata-invalid-checkout-rate.modal.html").result.finally((function(){i()})):!C.SO_MINIMAL_GDP||!Q&&f.get().signedIn?r():w.scrollToFirstWarning(200))}(),c.$emit(y.ANALYTICS_PAGE_LOADED,_.GUEST_DATA),s.reject(e)},initialize:function(e,t){this.controller=t,this.$scope=e,u.opGdpCountdownTimer=!e.checkout.groupRoomCounts&&!e.checkout.groupInfo,N.update({title:(e.hotel||{}).name?k.replaceStringByKeyValuePairs(B.guestData.pageMetaDataTitle,{hotel:e.hotel.name}):B.guestData.pageMetaDataTitleAlternative}),e.checkout.hotelId&&g.setGuestDataCookie(angular.extend({},$.get(),{placeName:e.checkout.hotelId}))},isIwsMexico:function(){return C.IWSR_COUNTRY_MX&&C.IWSR_MASTER&&D.iwsMexicoLocales.test(H.locale)},loadCmsContent:function(){var e=this.$scope;C.CP_VISA_BANNER||Q||(m.getHTMLFragment("choice-hotels/choice-privileges/ci_choice-privileges-signature-visa-promo","module").then((function(t){e.cpVisaSignaturePromoHtml=t})),m.getHTMLFragment("choice-hotels/choice-privileges/ci_choice-privileges-signature-visa-promo-footnotes","module").then((function(t){e.cpVisaSignaturePromoFootnotesHtml=t})))},makeCompleteReservationRequest:function(e){var t=this.$scope.hotel,r=this.checkoutService;return this.$scope.disableSubmitButton=!0,r.completeReservation(e).then((function(e){return r.updateConfirmation({hotel:t}),e})).catch(this.fireGuestDataErrorPageEvent.bind(this))},prepareIwsReservationsClub:function(e,t){this.isIwsMexico()&&e.reservationsClubNumber&&e.reservationsClubNumber.$modelValue&&(t.reservationsClubNumber=e.reservationsClubNumber.$modelValue)},scrollTop:function(){e.scrollTopAnimated(0,500)},shouldShowCreditCardFields:function(){if(!this.$scope)return!1;if((this.$scope.travelAgent||{}).guaranteeWithAccount&&this.$scope.hideCreditFields)return!1;if(this.$scope.iwsGuaranteeHoldType&&this.$scope.hideCreditFields)return!1;if((this.$scope.checkout||{}).confirmationId)return!1;var e=(this.$scope.checkout||{}).guaranteeMethod;return!e||e!==R.GUARANTEE_METHOD.LOYALTY_POINTS},submitReservation:function(){var e,t,i,c,m=this,g=this.getCompleteReservationPayload(),E=this.getGuestForm(),v=this.$scope,y=v.checkout.groupInfo,I=void 0===y?{}:y,T=I.chargeRouting,O=I.groupId;if(angular.forEach(E,(function(e,t){e&&e.hasOwnProperty("$modelValue")&&e.$error&&!0===e.$error[t]&&E[t].$setValidity(t,!0)})),E&&v.showCUGNotification()&&(v.generalErrors=v.generalErrors||{},v.generalErrors.INVALID_CHECKOUT_CP_NUMBER_REQUIRED=B.guestData.cugOmnitureText),E&&!1===E.$valid)return E.$setSubmitted(),b.handleFormErrorAnalyticsOnSubmit(E),void(C.SO_GDP_ERRORS?l((function(){return w.scrollToFirstError(200)})):C.SO_MINIMAL_GDP?w.scrollToFirstWarning(200):!0===E.prepaidAgreementCheckbox&&this.scrollTop());if(g.guest=function(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?o(Object(r),!0).forEach((function(t){a(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):o(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}({},g.guest),!(E.cpNumber||{}).$modelValue||f.get().signedIn||g.enrollInChoicePrivileges?!v.isGroupPickupPlanner||g.guest.firstName===f.get().firstName&&g.guest.lastName===f.get().lastName||(delete g.guest.cpNumber,delete g.guest.loyaltyAccount,delete g.guest.loyaltyAccountLastName,delete g.guest.loyaltyAccountNumber,delete g.guest.loyaltyProgramId):e=S.getLoyaltyStatus({loyaltyAccountLastName:g.guest.lastName,loyaltyAccountNumber:g.guest.cpNumber}).then((function(e){return E.cpNumber.$setValidity("pattern",e.data.validCPNumber),e.data.validCPNumber&&E.cpNumber.$setValidity("account",e.data.match),g.guest.loyaltyAccountNumber=e.data.cpnumber,g.guest.loyaltyAccount={eliteLevel:e.data.loyaltyAccountStatus},e})),O&&T===R.PLANNER_PAYS&&this.deleteCreditCardRequestParams(g),g.guest.creditCardNumber&&"IC"!==g.guest.creditCardType){var N=h.getCreditCardExpirationString(g.guest.expirationMonth,g.guest.expirationYear);t=Y.tokenizeCreditCard(g.guest.creditCardNumber,N).then((function(e){return angular.extend(g.guest,{creditCardNumber:e.token||g.guest.cardToken||g.guest.creditCardNumber,tokenKeyAlias:e.keyAlias,tokenResponseSignature:e.responseSignature,tokenResponseTimeStamp:e.responseTimeStamp}),e})).catch((function(e){return e}))}this.prepareIwsReservationsClub(E,g),p.deleteConfirmation(),A.deleteConfirmation(),P.inc(),s.all([e,t]).then((function(e){var t=r(e,1)[0];t&&t.data&&(i=!t.data.match),c=e[1]&&e[1].data&&e[1].data.faults&&e[1].data.faults.message})).finally((function(){var e=m.CONFIRMATION_PAGE_PATH;return i?(P.dec(),void m.handleCheckoutErrors({data:{match:!1}})):c?(P.dec(),void m.handleCheckoutErrors({data:{outputErrors:{noToken:c}}})):void m.makeCompleteReservationRequest(g).then((function(){v.checkout.hotel=v.hotel,d.update(v.checkout),u.store&&u.store.dispatch({type:M.ACTIONS.SET_UPDATE_CUSTOMER_PROFILE,updateCustomerProfile:v.guestInfo.updateCustomerProfile}),n.replace().path(e)})).catch(m.handleCheckoutErrors.bind(m)).finally(P.dec)}))}}),z}]},function(e,t){e.exports=["contentService","GuestdataBookingService","strings",function(e,t,r){return t.extend({getCompleteReservationPayload:function(){var e=t.prototype.getCompleteReservationPayload.apply(this);return e.loyaltyAccountLastName=e.guest.lastName,e},handleCheckoutErrors:function(e){e.data&&(e.data.inputErrors||e.data.outputErrors)&&((e.data.outputErrors||{}).hasOwnProperty("UNEXPECTED_FAILURE_CHECKOUT_BUT_POINTS_PURCHASED")&&(this.$scope.disableSubmitButton=!0),((e.data.outputErrors||{}).hasOwnProperty("UNAVAILABLE_LOYALTY_ASSETS")||(e.data.outputErrors||{}).hasOwnProperty("UNEXPECTED_FAILURE_LOYALTY_ASSET_PURCHASE"))&&this.$scope.openServiceFailureModal(r.booking.errors.ppcErrorsTitle,e.data,"ppcBookingErrors"));for(var n=arguments.length,o=new Array(n>1?n-1:0),a=1;a<n;a++)o[a-1]=arguments[a];t.prototype.handleCheckoutErrors.apply(this,[e].concat(o))},initialize:function(e){for(var r=arguments.length,n=new Array(r>1?r-1:0),o=1;o<r;o++)n[o-1]=arguments[o];t.prototype.initialize.apply(this,[e].concat(n)),e.ppcOptions={ppcAgreement:!1}},shouldShowCreditCardFields:function(){return!0}})}]},,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,function(e,t,r){e.exports=angular.module("chApp.promotions",[]).controller("PromotionsCtrl",r(385)).directive("chPromotions",r(629)).factory("promotionsService",r(630))},function(e,t,r){var n=r(385);e.exports=["siteConfig",function(e){return{controller:n,link:function(e,t,r,n){e.promotionId=r.promotionid,e.replaceFormBladeUrl=r.replaceFormBladeUrl,e.replaceFormBladeErrorUrl=r.replaceFormBladeErrorUrl,e.successPageUrl=r.successPageUrl,e.errorPageUrl=r.errorPageUrl,n.autoRegistration()},replace:!0,restrict:"E",scope:!1,templateUrl:"/".concat(e.assetFingerprint,"/app/promotions/promotions-form.html")}}]},function(e,t,r){function n(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function o(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?n(Object(r),!0).forEach((function(t){a(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):n(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function a(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var i=r(0);e.exports=["$http","$locale","$q","featureFlags","localeService","urlEncodeObject","cpUserData",function(e,t,r,n,a,s,c){var l="".concat("/webapi/user-account/","login"),u=c.get(),d=o({preferredLocaleCode:t.id},a.getSiteNameObj()),p={AU:"Choice Privileges Australasia",CE:"Choice Privileges Europe",CN:"Choice Privileges Canada",GP:"Choice Privileges",MC:"Choice Privileges Mexico"};function m(e){return"4"==="".concat(e.status)[0]&&(u.invalidCredentials=!0),r.reject(e)}return{promotionLogin:function(t){return t=angular.extend({},d,t),e({data:s(t),headers:{"content-type":"application/x-www-form-urlencoded"},method:"POST",url:l}).then((function(e){return function(e,t){var r=(e.data.loyaltyAccounts||[]).filter(i.byLoyaltyProgramId(p)),n=r.findIndex(i.byLoyaltyAccountNumber(e.data.guestProfile));n<0&&(n=0);return{address:e.data.guestProfile.address,email:e.data.guestProfile.email,firstName:e.data.guestProfile.firstName,lastName:e.data.guestProfile.lastName,loyaltyAccount:r[n]||{},username:t}}(e,t.username)})).catch(m)},subscribePromotion:function(n){var i=angular.extend(o({preferredLocaleCode:t.id},a.getSiteNameObj()),n),c=r.defer();return e({data:s(i),headers:{"content-type":"application/x-www-form-urlencoded"},method:"POST",url:"/webapi/user-account/promotion"}).then((function(e){"ERROR"===e.data.status?c.reject(e.data):c.resolve(e.data)}),(function(e){c.reject(e.data)})),c.promise}}}]},function(e,t,r){e.exports=angular.module("chApp.sso.points",[]).directive("ssoPointsBuyForm",r(632)).directive("ssoPointsGiftForm",r(633))},function(e,t){e.exports=["siteConfig",function(e){return{replace:!1,restrict:"EA",scope:!0,templateUrl:"/".concat(e.assetFingerprint,"/app/sso-points/sso-points-buy-form.html")}}]},function(e,t){e.exports=["siteConfig",function(e){return{replace:!1,restrict:"EA",scope:!0,templateUrl:"/".concat(e.assetFingerprint,"/app/sso-points/sso-points-gift-form.html")}}]},function(e,t,r){e.exports=angular.module("chApp.tokenization",[]).factory("tokenizationService",r(361))},function(e,t){e.exports=["redeemService",function(e){e.getRedemptionOptions()}]},function(e,t){e.exports=["$q","featureFlags","redeemService","redeemConst","cpUserData","loyaltyAccountHelper",function(e,t,r,n,o,a){var i={popularCategory:{},primaryRewards:{},redemptionCategories:[],redemptionMerchants:{}};return e.all([r.getMerchants(),r.getCategories()]).then((function(e){i.redemptionMerchants=e[0],i.redemptionMerchants.forEach((function(e){if(e.loyaltyRedemptionOptions&&(t.CPREDEEM_DIGITAL||(e.loyaltyRedemptionOptions=e.loyaltyRedemptionOptions.filter((function(e){return!1===e.digital}))),e.loyaltyRedemptionOptions[0])){var r=9999999999;e.loyaltyRedemptionOptions.forEach((function(n){n.points<r&&(n.requiresPartnerAccount||(i.primaryRewards[e.code]=angular.extend({desktopImageUrl:e.desktopImageUrl,imageAltText:e.imageAltText,merchantCode:e.code,name:e.name},n),t.CPREDEEM_DIGITAL&&(i.primaryRewards[e.code].hasDigitalOption=e.loyaltyRedemptionOptions.some((function(e){return!0===e.digital}))),r=n.points))}))}}));var r=o.get(),s=a.getEliteLevel(r);((t.ELITE_MEMBER_DISCOUNT&&s?e[1].filter((function(e){return e.name.toLowerCase()!==n.ALL_CATEGORY_DESKTOP.toLowerCase()&&e.name.toLowerCase()!==n.ALL_CATEGORY_MOBILE.toLowerCase()&&(!(e.name.toLowerCase().indexOf(n.ELITE.toLowerCase())>-1)||e.name.toLowerCase().indexOf(s.toLowerCase())>-1)})):e[1].filter((function(e){return e.name.toLowerCase()!==n.ALL_CATEGORY_DESKTOP.toLowerCase()&&e.name.toLowerCase()!==n.ALL_CATEGORY_MOBILE.toLowerCase()&&-1===e.name.toLowerCase().indexOf(n.ELITE.toLowerCase())}))).forEach((function(e){var t=!0;e.merchantCodes.forEach((function(r){t&&i.primaryRewards[r]&&(i.redemptionCategories.push(e),t=!1)})),e.name.toLowerCase()===n.MOST_POPULAR_CATEGORY.toLowerCase()&&(i.popularCategory=e)})),t.ELITE_MEMBER_DISCOUNT&&s)&&e[1].filter((function(e){return e.name.toLowerCase().indexOf(n.ELITE.toLowerCase())>-1&&e.name.toLowerCase().indexOf(s.toLowerCase())>-1})).reduce((function(e,t){return e.concat(t.merchantCodes)}),[]).filter((function(e,t,r){return r.indexOf(e)===t})).forEach((function(e){i.primaryRewards[e].elite=!0}));return i}))}]},function(e,t){e.exports=["cpUserData","userService","$q","reasonConst",function(e,t,r,n){var o=r.defer(),a=e.get();return a.signedIn?o.resolve(a):t.getUserHasLoggedIn()?t.get().then((function(){o.resolve(a)})).catch((function(){o.reject(n.USER_IS_NOT_SIGNED_IN)})):o.reject(n.USER_IS_NOT_SIGNED_IN),o.promise}]},function(e,t){e.exports=["$q",function(e){var t=e.defer();return t.reject(),t.promise}]},function(e,t){e.exports=["$location","reasonConst","$q",function(e,t,r){var n=r.defer(),o=e.search();return o.email&&o.token?n.resolve(o):n.reject(t.MODIFY_UNSUBSCRIBE_MISSING_DATA),n.promise}]},function(e,t){e.exports='<div class="read-more">\n  <button\n      ng-hide="autoHide && !showReadMore"\n      class="btn-reset link-cta"\n      ng-class="seeMoreClass"\n      ng-attr-id="buttonId"\n      ng-click="openModal()">\n    {{::readText}}\n  </button>\n  <div class="read-more-content" ng-transclude></div>\n</div>\n'},function(e,t){e.exports='<svg class="circle" viewBox="0 0 100 100" version="1.1" xmlns="http://www.w3.org/2000/svg">\n  <circle cx="50" cy="50" r="50"/>\n</svg>\n'},function(e,t){e.exports='<div class="cp-user-status">\n  <ul class="list-unstyled categories">\n    <li class="top-left gold" ng-class="{active: count >= levels[0] && count < levels[1]}">\n      <div class="caption text-center">\n        <div class="name">{{::strings.cp.categoriesGold}}</div>\n        <div>{{::levels[0]}} {{::strings.cp.nights}}</div>\n      </div>\n    </li>\n    <li class="top-right platinum" ng-class="{active: count >= levels[1] && count < levels[2]}">\n      <div class="caption text-center">\n        <div class="name">{{::strings.cp.categoriesPlatinum}}</div>\n        <div>{{::levels[1]}} {{::strings.cp.nights}}</div>\n      </div>\n    </li>\n    <li class="bottom-right diamond" ng-class="{active: count >= levels[2]}">\n      <div class="caption text-center">\n        <div class="name">{{::strings.cp.categoriesDiamond}}</div>\n        <div>{{::levels[2]}} {{::strings.cp.nights}}</div>\n      </div>\n    </li>\n    <li class="bottom-left" ng-class="{active: count < levels[0]}"></li>\n  </ul>\n  <div class="dial dial-spin-{{arc|number:0}}"></div>\n  <div class="status text-center">\n    <div>{{::strings.cp.myStatus}}</div>\n    <div class="cp-user-nights">\n      <ng-pluralize count="count" when="strings.cp.nightsPluralize"></ng-pluralize>\n    </div>\n  </div>\n</div>\n'},function(e,t){e.exports='<div class="modal-container">\n  <div class="modal-header">\n    <div class="modal-close clearfix" ng-click="formUtils.modal.close()">\n      <span class="ch-icon ch-icon-close"></span>\n      <span class="close-text">{{::strings.general.closeLabel}}</span>\n    </div>\n  </div>\n\n  <div class="modal-text">\n    <div class="modal-body">\n      <p ng-bind-html="cmsContentModal"></p>\n    </div>\n  </div>\n</div>\n'},function(e,t){e.exports='<main class="promotions" id="promotionForm">\n  <div class="forms-wrapper" ng-if="!response.status && !bladeContent">\n    <div class="container row">\n      <div ng-if="cpUser.signedIn" class="row">\n        <div class="text-center">\n          <h6>{{::strings.cp.promotions.registerSubtitle}}</h6>\n          <div class="row field">\n            <h4>{{::strings.guestData.welcomeGuest}} {{cpUser.firstName}} </h4>\n          </div>\n          <div class="row field">\n            <a class="btn-cta cta-primary" href="" ng-click="$event.preventDefault(); subscribePromotionLoggedUser();">{{::strings.cp.promotions.registerButton}}</a>\n          </div>\n          <div class="row field">\n            <a class="link-cta" href="" ng-click="$event.preventDefault(); $root.cpUserLogout();">{{::strings.cp.promotions.signOutButton}}</a>\n          </div>\n        </div>\n      </div>\n    </div>\n    <div class="form-separator-or">\n      <div class="forms bg-light-gray row">\n        <div class="container">\n          <div ng-if="!cpUser.signedIn">\n            <div class="col-sm-6 user-form">\n              <form name="promotionsLoginForm" novalidate ng-submit="subscribeWithLogin(promotionsLoginForm)">\n                <h6>{{::strings.cp.promotions.registerTitle}}</h6>\n                <div class="field">\n                  <div ng-class="{\'ng-invalid\': promotionsLoginForm.username.$invalid || promotionsLoginForm.$error.service}">\n                    <label for="username" class="control-label ">{{::strings.cp.username}}*</label>\n                    <input type="text" class="form-control" name="username" ng-model="login.username" required id="username">\n                    <div class="ng-errors pull-right">\n                      <div ng-if="promotionsLoginForm.username.$error.required">{{::strings.cp.usernameRequired}}</div>\n                      <div ng-if="promotionsLoginForm.$error.service">{{::strings.cp.userInvalidCredentials}}</div>\n                    </div>\n                  </div>\n                </div>\n                 <div class="field">\n                  <div ng-class="{\'ng-invalid\': promotionsLoginForm.username.$valid && promotionsLoginForm.password.$invalid}">\n                    <label for="password" class="control-label">{{::strings.cp.password}}*</label>\n                    <input type="password" class="form-control" name="password" autocomplete="off"\n                           ng-model="login.password" required\n                           ng-keyup="$event.keyCode === 13 && (subscribeWithLogin(promotionsLoginForm))"\n                           id="password">\n                    <div class="ng-errors pull-right">\n                      <div ng-if="promotionsLoginForm.password.$error.required">{{::strings.cp.passwordRequired}}</div>\n                    </div>\n                  </div>\n                </div>\n                <div class="field">\n                  <a class="link-cta" ng-href="{{::chConstants.route.CP_FORGOT_CREDENTIALS}}">{{::strings.cp.promotions.linkLeft}}</a>\n                </div>\n                <div class="field">\n                  <button class="btn-cta btn-primary" type="submit">{{::strings.cp.promotions.registerButton}}</button>\n                </div>\n              </form>        \n            </div>\n            <div class="col-sm-6 register-form">\n              <div class="or-separator">{{::strings.general.or}}</div>\n              <form name="promotionsRegisterForm" novalidate ng-submit="subscribeWithRegister(promotionsRegisterForm)">\n                <h6>{{::strings.cp.promotions.registerTitleRight}}</h6>\n                <div class="row field">\n                  <div class="col-md-6">\n                    <label for="firstName" class="control-label">{{::strings.guestData.guestInfo.firstName}}*</label>\n                    <input class="form-control" name="firstName" maxlength="100" ng-model="register.firstName" required\n                           id="firstName">\n                    <div class="ng-errors pull-right">\n                      <div ng-if="promotionsRegisterForm.firstName.$error.required">{{::strings.cp.usernameRequired}}</div>\n                    </div>\n                  </div>\n                  <div class="col-md-6">\n                    <label for="lastName" class="control-label">{{::strings.guestData.guestInfo.lastName}}*</label>\n                    <input class="form-control" name="lastName" maxlength="100" ng-model="register.lastName" required\n                           id="lastName">\n                    <div class="ng-errors pull-right">\n                      <div ng-if="promotionsRegisterForm.lastName.$error.required">{{::strings.cp.usernameRequired}}</div>\n                    </div>\n                  </div>\n                </div>\n                <div class="row field">\n                  <div class="col-md-6">\n                    <label for="email" class="control-label">{{::strings.account.recentActivity.emailAddress}}</label>\n                    <input class="form-control" type="email" name="email" maxlength="100" ng-model="register.email" email\n                           id="email">\n                    <div class="ng-errors pull-right">\n                      <div ng-if="promotionsRegisterForm.email.$error.email">{{::strings.hotel.errors.formErrors.email}}</div>\n                    </div>\n                  </div>\n                  <div class="col-md-6">\n                    <label for="privilegesNumber" class="control-label">{{::strings.cp.promotions.choicePrivilegesNumber}}*</label>\n                    <input type="text" class="form-control" name="privilegesNumber" cp-model ng-model="register.privilegesNumber"\n                            ng-minlength="3" required ng-maxlength="20" ng-pattern="chConstants.patterns.cpNumber"\n                            id="privilegesNumber">\n                    <p class="ng-errors pull-right" ng-repeat="err in messageFilter(promotionsRegisterForm, promotionsRegisterForm.privilegesNumber)">\n                      {{strings.guestData.validationMessages.cpNumber[err] || strings.general.validationMessages[err] || \'err=\'+err}}\n                    </p>\n                  </div>\n                </div>\n                <div class="field register-btn-spacer"></div>\n                <div class="field">\n                  <button class="btn-cta btn-primary" type="submit">{{::strings.cp.promotions.registerButton}}</button>\n                </div>\n              </form>\n            </div>\n          </div>\n        </div>\n      </div>\n    </div>\n  </div>\n  <div ng-if="bladeContent" ng-bind-html="bladeContent" ch-content-components></div>\n  <div ng-if="response.status && !bladeContent" class="row">\n    <div class="col-md-12">\n      <div ng-if="response.status != 200" class="text-center text-deep-red">\n        <div ng-repeat="message in responseMessage">\n          <h6>{{message}}</h6>\n        </div>\n      </div>\n      <div ch-search-form></div>\n    </div>\n  </div>\n</main>\n'},function(e,t){e.exports='<div\n    ng-click="rateCard.setSelectedRate(room, rate)"\n    class="rate-selection table-row table-row-middle"\n    ng-attr-data-seleniumid="{{::rate.ratePlanCode}}"\n    ng-class="{\'selected\': room.selectedRate.ratePlanCode === rate.ratePlanCode, \'disabled\': rate.disabled}"\n    ng-switch="rate.rateType">\n  <div class="rateplan-radio">\n    <div\n        class="radio-box"\n        ng-class="{\'selected\': isSelectedRatePlan(room, rate)}">\n      <span class="ch-icon ch-icon-check-alone"></span>\n      <input\n          type="radio"\n          ng-attr-name="radio{{room.code}}"\n          ng-attr-value="{{rate.ratePlanCode}}"\n          ng-checked="room.selectedRate.ratePlanCode == rate.ratePlanCode"\n          ng-disabled="rate.disabled"\n          ng-attr-name="radio{{room.code}}{{rate.ratePlanCode}}">\n    </div>\n  </div>\n\n  <div class="rateplan-detail" ng-switch-when="packages">\n    <div\n        class="rateplan-name"\n        ng-click="$event.stopPropagation();"\n        ng-if="results.packages[rate.ratePlanCode].name">\n      <span uib-dropdown uib-dropdown-toggle class="dropdown dropdown-toggle">\n        <span>{{results.packages[rate.ratePlanCode].name}}</span>\n        <a class="ch-icon ch-icon-chevron-down" ng-attr-name="rate-{{rate.ratePlanCode}}"></a>\n        <div uib-dropdown-menu class="dropdown-menu">\n          <h3 ng-if="results.packages[rate.ratePlanCode].packageAbstractHtml"\n              ng-bind-html="results.packages[rate.ratePlanCode].packageAbstractHtml">\n          </h3>\n          <p ng-bind-html="results.packages[rate.ratePlanCode].bodyHtml"></p>\n        </div>\n      </span>\n    </div>\n    <span class="rateplan-info" ng-bind-html="results.packages[rate.ratePlanCode].packageAbstractHtml"></span>\n  </div>\n\n  <div class="rateplan-detail" ng-switch-when="promotions">\n    <div\n        class="rateplan-name"\n        ng-click="$event.stopPropagation();"\n        ng-if="results.stay.rates[rate.ratePlanCode].name">\n      <span\n          uib-dropdown\n          uib-dropdown-toggle\n          class="dropdown dropdown-toggle">\n        <span>{{results.stay.rates[rate.ratePlanCode].name}}</span>\n        <a\n            class="ch-icon ch-icon-chevron-down"\n            ng-click="$event.stopPropagation();"\n            ng-attr-name="rate-{{rate.ratePlanCode}}">\n        </a>\n        <div uib-dropdown-menu class="dropdown-menu">\n          <h3 ng-if="results.promotions[rate.ratePlanCode].title"\n              ng-bind-html="results.promotions[rate.ratePlanCode].title"></h3>\n          <p ng-bind-html="results.promotions[rate.ratePlanCode].bodyHtml"></p>\n        </div>\n      </span>\n    </div>\n    <span class="rateplan-info" ng-bind-html="results.promotions[rate.ratePlanCode].title"></span>\n  </div>\n\n  <div class="rateplan-detail" ng-switch-default>\n    <div ng-switch="rate.disabled">\n      <div ng-switch-when="true">\n        <div class="rateplan-name text-muted" ng-click="$event.stopPropagation();">\n          {{ratePlan.name}}\n        </div>\n        <span class="rateplan-info text-muted">{{::strings.propertyRates.errors.notAvailable}}</span>\n      </div>\n      <div ng-switch-default>\n        <div class="rateplan-name" ng-click="$event.stopPropagation();">\n          <span\n              uib-dropdown\n              uib-dropdown-toggle\n              class="dropdown dropdown-toggle"\n              ng-if="!hasGroupRates && !groupInfo"\n              ng-class="{\'disabled\': !results.stay.rates[rate.ratePlanCodeAlias].longDescHtml}">\n            <span>{{results.stay.rates[rate.ratePlanCodeAlias].name}}</span>\n            <a\n                class="ch-icon ch-icon-chevron-down"\n                ng-attr-name="rate-{{rate.ratePlanCode}}"\n                ng-if="results.stay.rates[rate.ratePlanCodeAlias].longDescHtml">\n            </a>\n            <span\n                uib-dropdown-menu\n                class="dropdown-menu"\n                ng-bind-html="results.stay.rates[rate.ratePlanCodeAlias].longDescHtml">\n            </span>\n          </span>\n          <span ng-if="hasGroupRates || groupInfo">{{::strings.group.ratePlanName}}</span>\n        </div>\n        <span\n            class="rateplan-info"\n            ng-bind-html="results.stay.rates[rate.ratePlanCodeAlias].shortDescHtml"\n            ng-if="results.stay.rates[rate.ratePlanCodeAlias].shortDescHtml && !hasGroupRates && !groupInfo">\n        </span>\n        <span class="rateplan-info" ng-if="hasGroupRates || groupInfo">\n          {{::hasGroupRates || groupInfo.awardEligible ? strings.group.rateAwardEligible : strings.group.rateNotAwardEligible}}\n        </span>\n      </div>\n    </div>\n  </div>\n\n  <div class="rateplan-price" ng-if="!rate.disabled">\n    <ch-price-tag\n        currency="rate.currencyCode"\n        points="rate.avgNightlyPoints"\n        cash="rate.avgNightlyBeforeTax">\n    </ch-price-tag>\n  </div>\n</div>\n'}])]);