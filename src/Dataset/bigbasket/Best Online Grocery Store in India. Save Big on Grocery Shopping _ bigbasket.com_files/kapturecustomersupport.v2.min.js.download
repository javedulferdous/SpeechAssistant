/**
 * Kapchat customer web widget - v1.2.0
 * Author: Lamtei W (lamtei.minot@adjetter.com)
 * Copyright (c) Adjetter Media Networks Pvt Ltd

 * Third-party libraries
 * 
 * moment.js
 * Copyright (c) JS Foundation and other contributors
 * Authors : Tim Wood, Iskren Chernev, Moment.js contributors
 * License : MIT
 * 
 * strophejs
 * Copyright 2006-2008, OGG, LLC
 * License : MIT
 * 
 * crypto-js
 * Copyright (c) 2009-2013 Jeff Mott
 * Copyright (c) 2013-2016 Evan Vosberg
 * License : MIT
 * 
 * underscore.js
 * Copyright (c) 2009-2017 Jeremy Ashkenas, DocumentCloud and Investigative
 * License : MIT
*/
!function(t,e){var n={version:"2.7.0",areas:{},apis:{},inherit:function(t,e){for(var n in t)e.hasOwnProperty(n)||(e[n]=t[n]);return e},stringify:function(t){return void 0===t||"function"==typeof t?t+"":JSON.stringify(t)},parse:function(t){try{return JSON.parse(t)}catch(e){return t}},fn:function(t,e){n.storeAPI[t]=e;for(var i in n.apis)n.apis[i][t]=e},get:function(t,e){return t.getItem(e)},set:function(t,e,n){t.setItem(e,n)},remove:function(t,e){t.removeItem(e)},key:function(t,e){return t.key(e)},length:function(t){return t.length},clear:function(t){t.clear()},Store:function(t,e,i){var r=n.inherit(n.storeAPI,function(t,e,n){return 0===arguments.length?r.getAll():"function"==typeof e?r.transact(t,e,n):void 0!==e?r.set(t,e,n):"string"==typeof t||"number"==typeof t?r.get(t):t?r.setAll(t,e):r.clear()});r._id=t;try{e.setItem("_safariPrivate_","sucks"),r._area=e,e.removeItem("_safariPrivate_")}catch(t){}return r._area||(r._area=n.inherit(n.storageAPI,{items:{},name:"fake"})),r._ns=i||"",n.areas[t]||(n.areas[t]=r._area),n.apis[r._ns+r._id]||(n.apis[r._ns+r._id]=r),r},storeAPI:{area:function(t,e){var i=this[t];return i&&i.area||(i=n.Store(t,e,this._ns),this[t]||(this[t]=i)),i},namespace:function(t,e){if(!t)return this._ns?this._ns.substring(0,this._ns.length-1):"";var i=t,r=this[i];return r&&r.namespace||(r=n.Store(this._id,this._area,this._ns+i+"."),this[i]||(this[i]=r),e||r.area("session",n.areas.session)),r},isFake:function(){return"fake"===this._area.name},toString:function(){return"store"+(this._ns?"."+this.namespace():"")+"["+this._id+"]"},has:function(t){return this._area.has?this._area.has(this._in(t)):!!(this._in(t)in this._area)},size:function(){return this.keys().length},each:function(t,e){for(var i=0,r=n.length(this._area);i<r;i++){var s=this._out(n.key(this._area,i));if(void 0!==s&&!1===t.call(this,s,e||this.get(s)))break;r>n.length(this._area)&&(r--,i--)}return e||this},keys:function(t){return this.each(function(t,e){e.push(t)},t||[])},get:function(t,e){var i=n.get(this._area,this._in(t));return null!==i?n.parse(i):e||i},getAll:function(t){return this.each(function(t,e){e[t]=this.get(t)},t||{})},transact:function(t,e,n){var i=this.get(t,n),r=e(i);return this.set(t,void 0===r?i:r),this},set:function(t,e,i){var r=this.get(t);return null!==r&&!1===i?e:n.set(this._area,this._in(t),n.stringify(e),i)||r},setAll:function(t,e){var n,i;for(var r in t)i=t[r],this.set(r,i,e)!==i&&(n=!0);return n},add:function(t,e){var i=this.get(t);if(i instanceof Array)e=i.concat(e);else if(null!==i){var r=typeof i;if(r===typeof e&&"object"===r){for(var s in e)i[s]=e[s];e=i}else e=i+e}return n.set(this._area,this._in(t),n.stringify(e)),e},remove:function(t){var e=this.get(t);return n.remove(this._area,this._in(t)),e},clear:function(){return this._ns?this.each(function(t){n.remove(this._area,this._in(t))},1):n.clear(this._area),this},clearAll:function(){var t=this._area;for(var e in n.areas)n.areas.hasOwnProperty(e)&&(this._area=n.areas[e],this.clear());return this._area=t,this},_in:function(t){return"string"!=typeof t&&(t=n.stringify(t)),this._ns?this._ns+t:t},_out:function(t){return this._ns?t&&0===t.indexOf(this._ns)?t.substring(this._ns.length):void 0:t}},storageAPI:{length:0,has:function(t){return this.items.hasOwnProperty(t)},key:function(t){var e=0;for(var n in this.items)if(this.has(n)&&t===e++)return n},setItem:function(t,e){this.has(t)||this.length++,this.items[t]=e},removeItem:function(t){this.has(t)&&(delete this.items[t],this.length--)},getItem:function(t){return this.has(t)?this.items[t]:null},clear:function(){for(var t in this.items)this.removeItem(t)},toString:function(){return this.length+" items in "+this.name+"Storage"}}},i=n.Store("local",function(){try{return localStorage}catch(t){}}());i.local=i,i._=n,i.area("session",function(){try{return sessionStorage}catch(t){}}()),"function"==typeof e&&void 0!==e.amd?e("store2",[],function(){return i}):"undefined"!=typeof module&&module.exports?module.exports=i:(t.store&&(n.conflict=t.store),t.store=i)}(this,this.define);
!function(e){"use strict";function t(e,n){if(!(this instanceof t)){var r=new t(e,n);return r.open(),r}this.id=t.id++,this.setup(e,n),this.chainCallbacks(t._callbackChain)}function n(e,t){var n={};for(var r in e)r in t&&(n[r]=e[r],delete e[r]);return n}function r(e,t){var n={},r=new RegExp("^"+t+"([A-Z])(.*)");for(var i in e){var o=i.match(r);if(o){n[(o[1]+o[2].replace(/([A-Z])/g,"-$1")).toLowerCase()]=e[i]}}return n}if(void 0===e)return void("console"in window&&window.console.info("Too much lightness, Featherlight needs jQuery."));var i=[],o=function(t){return i=e.grep(i,function(e){return e!==t&&e.$instance.closest("body").length>0})},a={allowfullscreen:1,frameborder:1,height:1,longdesc:1,marginheight:1,marginwidth:1,name:1,referrerpolicy:1,scrolling:1,sandbox:1,src:1,srcdoc:1,width:1},s={keyup:"onKeyUp",resize:"onResize"},c=function(n){e.each(t.opened().reverse(),function(){if(!n.isDefaultPrevented()&&!1===this[s[n.type]](n))return n.preventDefault(),n.stopPropagation(),!1})},u=function(n){if(n!==t._globalHandlerInstalled){t._globalHandlerInstalled=n;var r=e.map(s,function(e,n){return n+"."+t.prototype.namespace}).join(" ");e(window)[n?"on":"off"](r,c)}};t.prototype={constructor:t,namespace:"featherlight",targetAttr:"data-featherlight",variant:null,resetCss:!1,background:null,openTrigger:"click",closeTrigger:"click",filter:null,root:"#kaptureChatWrapper",openSpeed:250,closeSpeed:250,closeOnClick:"background",closeOnEsc:!0,closeIcon:"&#10005;",loading:"",persist:!1,otherClose:null,beforeOpen:e.noop,beforeContent:e.noop,beforeClose:e.noop,afterOpen:e.noop,afterContent:e.noop,afterClose:e.noop,onKeyUp:e.noop,onResize:e.noop,type:null,contentFilters:["jquery","image","html","ajax","iframe","text","video"],setup:function(t,n){"object"!=typeof t||t instanceof e!=!1||n||(n=t,t=void 0);var r=e.extend(this,n,{target:t}),i=r.resetCss?r.namespace+"-reset":r.namespace,o=e(r.background||['<div class="'+i+"-loading "+i+'">','<div class="'+i+'-content">','<button class="'+i+"-close-icon "+r.namespace+'-close" aria-label="Close">',r.closeIcon,"</button>",'<div class="'+r.namespace+'-inner">'+r.loading+"</div>","</div>","</div>"].join("")),a="."+r.namespace+"-close"+(r.otherClose?","+r.otherClose:"");return r.$instance=o.clone().addClass(r.variant),r.$instance.on(r.closeTrigger+"."+r.namespace,function(t){var n=e(t.target);("background"===r.closeOnClick&&n.is("."+r.namespace)||"anywhere"===r.closeOnClick||n.closest(a).length)&&(r.close(t),t.preventDefault())}),this},getContent:function(){if(!1!==this.persist&&this.$content)return this.$content;var t=this,n=this.constructor.contentFilters,r=function(e){return t.$currentTarget&&t.$currentTarget.attr(e)},i=r(t.targetAttr),o=t.target||i||"",a=n[t.type];if(!a&&o in n&&(a=n[o],o=t.target&&i),o=o||r("href")||"",!a)for(var s in n)t[s]&&(a=n[s],o=t[s]);if(!a){var c=o;if(o=null,e.each(t.contentFilters,function(){return a=n[this],a.test&&(o=a.test(c)),!o&&a.regex&&c.match&&c.match(a.regex)&&(o=c),!o}),!o)return"console"in window&&window.console.error("Featherlight: no content filter found "+(c?' for "'+c+'"':" (no target specified)")),!1}return a.process.call(t,o)},setContent:function(t){var n=this;return t.is("iframe")&&n.$instance.addClass(n.namespace+"-iframe"),n.$instance.removeClass(n.namespace+"-loading"),n.$instance.find("."+n.namespace+"-inner").not(t).slice(1).remove().end().replaceWith(e.contains(n.$instance[0],t[0])?"":t),n.$content=t.addClass(n.namespace+"-inner"),n},open:function(t){var n=this;if(n.$instance.hide().appendTo(n.root),!(t&&t.isDefaultPrevented()||!1===n.beforeOpen(t))){t&&t.preventDefault();var r=n.getContent();if(r)return i.push(n),u(!0),n.$instance.fadeIn(n.openSpeed),n.beforeContent(t),e.when(r).always(function(e){n.setContent(e),n.afterContent(t)}).then(n.$instance.promise()).done(function(){n.afterOpen(t)})}return n.$instance.detach(),e.Deferred().reject().promise()},close:function(t){var n=this,r=e.Deferred();return!1===n.beforeClose(t)?r.reject():(0===o(n).length&&u(!1),n.$instance.fadeOut(n.closeSpeed,function(){n.$instance.detach(),n.afterClose(t),r.resolve()})),r.promise()},resize:function(e,t){if(e&&t){this.$content.css("width","").css("height","");var n=Math.max(e/(this.$content.parent().width()-1),t/(this.$content.parent().height()-1));n>1&&(n=t/Math.floor(t/n),this.$content.css("width",e/n+"px").css("height",t/n+"px"))}},chainCallbacks:function(t){for(var n in t)this[n]=e.proxy(t[n],this,e.proxy(this[n],this))}},e.extend(t,{id:0,autoBind:"[data-featherlight]",defaults:t.prototype,contentFilters:{jquery:{regex:/^[#.]\w/,test:function(t){return t instanceof e&&t},process:function(t){return!1!==this.persist?e(t):e(t).clone(!0)}},image:{regex:/\.(png|jpg|jpeg|gif|tiff|bmp|svg)(\?\S*)?$/i,process:function(t){var n=this,r=e.Deferred(),i=new Image,o=e('<img src="'+t+'" alt="" class="'+n.namespace+'-image" />');return i.onload=function(){o.naturalWidth=i.width,o.naturalHeight=i.height,r.resolve(o)},i.onerror=function(){r.reject(o)},i.src=t,r.promise()}},video:{regex:/\.(mp4)(\?\S*)?$/i,process:function(t){var n=this,r=document.createElement("video"),i=e.Deferred();if(r.canPlayType("video/mp4")||r.canPlayType("video/webm")||r.canPlayType("video/ogg")){r.setAttribute("src",t);var o=e(r).addClass(n.namespace+"-video");return o.on("loadeddata",function(){var e=this.videoWidth,t=this.videoHeight;this.videoHeight>400&&(e*=400/t,t=400),this.setAttribute("width",e),this.setAttribute("height",t),o.css({width:e+"px",height:t+"px"}),o.naturalWidth=e,o.naturalHeight=t,this.controls=!0,i.resolve(o)}).on("error",function(){i.reject(o)}),i.promise()}}},html:{regex:/^\s*<[\w!][^<]*>/,process:function(t){return e(t)}},ajax:{regex:/./,process:function(t){var n=e.Deferred(),r=e("<div></div>").load(t,function(e,t){"error"!==t&&n.resolve(r.contents()),n.fail()});return n.promise()}},iframe:{process:function(t){var i=new e.Deferred,o=e("<iframe/>"),s=r(this,"iframe"),c=n(s,a);return o.hide().attr("src",t).attr(c).css(s).on("load",function(){i.resolve(o.show())}).appendTo(this.$instance.find("."+this.namespace+"-content")),i.promise()}},text:{process:function(t){return e("<div>",{text:t})}}},functionAttributes:["beforeOpen","afterOpen","beforeContent","afterContent","beforeClose","afterClose"],readElementConfig:function(t,n){var r=this,i=new RegExp("^data-"+n+"-(.*)"),o={};return t&&t.attributes&&e.each(t.attributes,function(){var t=this.name.match(i);if(t){var n=this.value,a=e.camelCase(t[1]);if(e.inArray(a,r.functionAttributes)>=0)n=new Function(n);else try{n=JSON.parse(n)}catch(e){}o[a]=n}}),o},extend:function(t,n){var r=function(){this.constructor=t};return r.prototype=this.prototype,t.prototype=new r,t.__super__=this.prototype,e.extend(t,this,n),t.defaults=t.prototype,t},attach:function(t,n,r){var i=this;"object"!=typeof n||n instanceof e!=!1||r||(r=n,n=void 0),r=e.extend({},r);var o,a=r.namespace||i.defaults.namespace,s=e.extend({},i.defaults,i.readElementConfig(t[0],a),r),c=function(a){var c=e(a.currentTarget),u=e.extend({$source:t,$currentTarget:c},i.readElementConfig(t[0],s.namespace),i.readElementConfig(a.currentTarget,s.namespace),r),l=o||c.data("featherlight-persisted")||new i(n,u);"shared"===l.persist?o=l:!1!==l.persist&&c.data("featherlight-persisted",l),u.$currentTarget.blur&&u.$currentTarget.blur(),l.open(a)};return t.on(s.openTrigger+"."+s.namespace,s.filter,c),c},current:function(){var e=this.opened();return e[e.length-1]||null},opened:function(){var t=this;return o(),e.grep(i,function(e){return e instanceof t})},close:function(e){var t=this.current();if(t)return t.close(e)},_onReady:function(){var t=this;t.autoBind&&(e(t.autoBind).each(function(){t.attach(e(this))}),e(document).on("click",t.autoBind,function(n){if(!n.isDefaultPrevented()){t.attach(e(n.currentTarget))(n)}}))},_callbackChain:{onKeyUp:function(t,n){return 27===n.keyCode?(this.closeOnEsc&&e.featherlight.close(n),!1):t(n)},beforeOpen:function(t,n){return e(document.documentElement).addClass("with-featherlight"),this._previouslyActive=document.activeElement,this._$previouslyTabbable=e("a, input, select, textarea, iframe, button, iframe, [contentEditable=true]").not("[tabindex]").not(this.$instance.find("button")),this._$previouslyWithTabIndex=e("[tabindex]").not('[tabindex="-1"]'),this._previousWithTabIndices=this._$previouslyWithTabIndex.map(function(t,n){return e(n).attr("tabindex")}),this._$previouslyWithTabIndex.add(this._$previouslyTabbable).attr("tabindex",-1),document.activeElement.blur&&document.activeElement.blur(),t(n)},afterClose:function(n,r){var i=n(r),o=this;return this._$previouslyTabbable.removeAttr("tabindex"),this._$previouslyWithTabIndex.each(function(t,n){e(n).attr("tabindex",o._previousWithTabIndices[t])}),this._previouslyActive.focus(),0===t.opened().length&&e(document.documentElement).removeClass("with-featherlight"),i},onResize:function(e,t){return this.resize(this.$content.naturalWidth,this.$content.naturalHeight),e(t)},afterContent:function(e,t){var n=e(t);return this.$instance.find("[autofocus]:not([disabled])").focus(),this.onResize(t),n}}}),e.featherlight=t,e.fn.featherlight=function(e,n){return t.attach(this,e,n),this},e(document).ready(function(){t._onReady()})}(jQuery);
!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?module.exports=e():"function"==typeof define&&define.amd?define(e):t.moment=e()}(this,function(){"use strict";var t;function d(){return t.apply(null,arguments)}function a(t){return t instanceof Array||"[object Array]"===Object.prototype.toString.call(t)}function u(t){return null!=t&&"[object Object]"===Object.prototype.toString.call(t)}function c(t){return"number"==typeof t||"[object Number]"===Object.prototype.toString.call(t)}function l(t){return t instanceof Date||"[object Date]"===Object.prototype.toString.call(t)}function h(t,e){var n,i=[];for(n=0;n<t.length;++n)i.push(e(t[n],n));return i}function f(t,e){return Object.prototype.hasOwnProperty.call(t,e)}function p(t,e){for(var n in e)f(e,n)&&(t[n]=e[n]);return f(e,"toString")&&(t.toString=e.toString),f(e,"valueOf")&&(t.valueOf=e.valueOf),t}function m(t,e,n,i){return be(t,e,n,i,!0).utc()}function _(t){return null==t._pf&&(t._pf={empty:!1,unusedTokens:[],unusedInput:[],overflow:-2,charsLeftOver:0,nullInput:!1,invalidMonth:null,invalidFormat:!1,userInvalidated:!1,iso:!1,parsedDateParts:[],meridiem:null}),t._pf}var r=Array.prototype.some?Array.prototype.some:function(t){for(var e=Object(this),n=e.length>>>0,i=0;i<n;i++)if(i in e&&t.call(this,e[i],i,e))return!0;return!1};function g(t){if(null==t._isValid){var e=_(t),n=r.call(e.parsedDateParts,function(t){return null!=t}),i=!isNaN(t._d.getTime())&&e.overflow<0&&!e.empty&&!e.invalidMonth&&!e.invalidWeekday&&!e.nullInput&&!e.invalidFormat&&!e.userInvalidated&&(!e.meridiem||e.meridiem&&n);if(t._strict&&(i=i&&0===e.charsLeftOver&&0===e.unusedTokens.length&&void 0===e.bigHour),null!=Object.isFrozen&&Object.isFrozen(t))return i;t._isValid=i}return t._isValid}function v(t){var e=m(NaN);return null!=t?p(_(e),t):_(e).userInvalidated=!0,e}function s(t){return void 0===t}var o=d.momentProperties=[];function y(t,e){var n,i,r;if(s(e._isAMomentObject)||(t._isAMomentObject=e._isAMomentObject),s(e._i)||(t._i=e._i),s(e._f)||(t._f=e._f),s(e._l)||(t._l=e._l),s(e._strict)||(t._strict=e._strict),s(e._tzm)||(t._tzm=e._tzm),s(e._isUTC)||(t._isUTC=e._isUTC),s(e._offset)||(t._offset=e._offset),s(e._pf)||(t._pf=_(e)),s(e._locale)||(t._locale=e._locale),0<o.length)for(n in o)s(r=e[i=o[n]])||(t[i]=r);return t}var e=!1;function S(t){y(this,t),this._d=new Date(null!=t._d?t._d.getTime():NaN),this.isValid()||(this._d=new Date(NaN)),!1===e&&(e=!0,d.updateOffset(this),e=!1)}function w(t){return t instanceof S||null!=t&&null!=t._isAMomentObject}function b(t){return t<0?Math.ceil(t)||0:Math.floor(t)}function x(t){var e=+t,n=0;return 0!==e&&isFinite(e)&&(n=b(e)),n}function M(t,e,n){var i,r=Math.min(t.length,e.length),s=Math.abs(t.length-e.length),o=0;for(i=0;i<r;i++)(n&&t[i]!==e[i]||!n&&x(t[i])!==x(e[i]))&&o++;return o+s}function k(t){!1===d.suppressDeprecationWarnings&&"undefined"!=typeof console&&console.warn&&console.warn("Deprecation warning: "+t)}function n(r,s){var o=!0;return p(function(){if(null!=d.deprecationHandler&&d.deprecationHandler(null,r),o){for(var t,e=[],n=0;n<arguments.length;n++){if(t="","object"==typeof arguments[n]){for(var i in t+="\n["+n+"] ",arguments[0])t+=i+": "+arguments[0][i]+", ";t=t.slice(0,-2)}else t=arguments[n];e.push(t)}k(r+"\nArguments: "+Array.prototype.slice.call(e).join("")+"\n"+(new Error).stack),o=!1}return s.apply(this,arguments)},s)}var i={};function T(t,e){null!=d.deprecationHandler&&d.deprecationHandler(t,e),i[t]||(k(e),i[t]=!0)}function A(t){return t instanceof Function||"[object Function]"===Object.prototype.toString.call(t)}function C(t,e){var n,i=p({},t);for(n in e)f(e,n)&&(u(t[n])&&u(e[n])?(i[n]={},p(i[n],t[n]),p(i[n],e[n])):null!=e[n]?i[n]=e[n]:delete i[n]);for(n in t)f(t,n)&&!f(e,n)&&u(t[n])&&(i[n]=p({},i[n]));return i}function N(t){null!=t&&this.set(t)}d.suppressDeprecationWarnings=!1,d.deprecationHandler=null;var D=Object.keys?Object.keys:function(t){var e,n=[];for(e in t)f(t,e)&&n.push(e);return n};var O={};function H(t,e){var n=t.toLowerCase();O[n]=O[n+"s"]=O[e]=t}function L(t){return"string"==typeof t?O[t]||O[t.toLowerCase()]:void 0}function E(t){var e,n,i={};for(n in t)f(t,n)&&(e=L(n))&&(i[e]=t[n]);return i}var R={};function I(t,e){R[t]=e}function B(e,n){return function(t){return null!=t?(F(this,e,t),d.updateOffset(this,n),this):q(this,e)}}function q(t,e){return t.isValid()?t._d["get"+(t._isUTC?"UTC":"")+e]():NaN}function F(t,e,n){t.isValid()&&t._d["set"+(t._isUTC?"UTC":"")+e](n)}function j(t,e,n){var i=""+Math.abs(t),r=e-i.length;return(0<=t?n?"+":"":"-")+Math.pow(10,Math.max(0,r)).toString().substr(1)+i}var P=/(\[[^\[]*\])|(\\)?([Hh]mm(ss)?|Mo|MM?M?M?|Do|DDDo|DD?D?D?|ddd?d?|do?|w[o|w]?|W[o|W]?|Qo?|YYYYYY|YYYYY|YYYY|YY|gg(ggg?)?|GG(GGG?)?|e|E|a|A|hh?|HH?|kk?|mm?|ss?|S{1,9}|x|X|zz?|ZZ?|.)/g,Y=/(\[[^\[]*\])|(\\)?(LTS|LT|LL?L?L?|l{1,4})/g,z={},W={};function U(t,e,n,i){var r=i;"string"==typeof i&&(r=function(){return this[i]()}),t&&(W[t]=r),e&&(W[e[0]]=function(){return j(r.apply(this,arguments),e[1],e[2])}),n&&(W[n]=function(){return this.localeData().ordinal(r.apply(this,arguments),t)})}function X(t,e){return t.isValid()?(e=$(e,t.localeData()),z[e]=z[e]||function(i){var t,r,e,s=i.match(P);for(t=0,r=s.length;t<r;t++)W[s[t]]?s[t]=W[s[t]]:s[t]=(e=s[t]).match(/\[[\s\S]/)?e.replace(/^\[|\]$/g,""):e.replace(/\\/g,"");return function(t){var e,n="";for(e=0;e<r;e++)n+=s[e]instanceof Function?s[e].call(t,i):s[e];return n}}(e),z[e](t)):t.localeData().invalidDate()}function $(t,e){var n=5;function i(t){return e.longDateFormat(t)||t}for(Y.lastIndex=0;0<=n&&Y.test(t);)t=t.replace(Y,i),Y.lastIndex=0,n-=1;return t}var G=/\d/,J=/\d\d/,V=/\d{3}/,Q=/\d{4}/,Z=/[+-]?\d{6}/,K=/\d\d?/,tt=/\d\d\d\d?/,et=/\d\d\d\d\d\d?/,nt=/\d{1,3}/,it=/\d{1,4}/,rt=/[+-]?\d{1,6}/,st=/\d+/,ot=/[+-]?\d+/,at=/Z|[+-]\d\d:?\d\d/gi,ut=/Z|[+-]\d\d(?::?\d\d)?/gi,ct=/[0-9]*['a-z\u00A0-\u05FF\u0700-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF]+|[\u0600-\u06FF\/]+(\s*?[\u0600-\u06FF]+){1,2}/i,lt={};function ht(t,n,i){lt[t]=A(n)?n:function(t,e){return t&&i?i:n}}function dt(t,e){return f(lt,t)?lt[t](e._strict,e._locale):new RegExp(ft(t.replace("\\","").replace(/\\(\[)|\\(\])|\[([^\]\[]*)\]|\\(.)/g,function(t,e,n,i,r){return e||n||i||r})))}function ft(t){return t.replace(/[-\/\\^$*+?.()|[\]{}]/g,"\\$&")}var pt={};function mt(t,n){var e,i=n;for("string"==typeof t&&(t=[t]),c(n)&&(i=function(t,e){e[n]=x(t)}),e=0;e<t.length;e++)pt[t[e]]=i}function _t(t,r){mt(t,function(t,e,n,i){n._w=n._w||{},r(t,n._w,n,i)})}var gt=0,vt=1,yt=2,St=3,wt=4,bt=5,xt=6,Mt=7,kt=8,Tt=Array.prototype.indexOf?Array.prototype.indexOf:function(t){var e;for(e=0;e<this.length;++e)if(this[e]===t)return e;return-1};function At(t,e){return new Date(Date.UTC(t,e+1,0)).getUTCDate()}U("M",["MM",2],"Mo",function(){return this.month()+1}),U("MMM",0,0,function(t){return this.localeData().monthsShort(this,t)}),U("MMMM",0,0,function(t){return this.localeData().months(this,t)}),H("month","M"),I("month",8),ht("M",K),ht("MM",K,J),ht("MMM",function(t,e){return e.monthsShortRegex(t)}),ht("MMMM",function(t,e){return e.monthsRegex(t)}),mt(["M","MM"],function(t,e){e[vt]=x(t)-1}),mt(["MMM","MMMM"],function(t,e,n,i){var r=n._locale.monthsParse(t,i,n._strict);null!=r?e[vt]=r:_(n).invalidMonth=t});var Ct=/D[oD]?(\[[^\[\]]*\]|\s)+MMMM?/,Nt="January_February_March_April_May_June_July_August_September_October_November_December".split("_");var Dt="Jan_Feb_Mar_Apr_May_Jun_Jul_Aug_Sep_Oct_Nov_Dec".split("_");function Ot(t,e){var n;if(!t.isValid())return t;if("string"==typeof e)if(/^\d+$/.test(e))e=x(e);else if(!c(e=t.localeData().monthsParse(e)))return t;return n=Math.min(t.date(),At(t.year(),e)),t._d["set"+(t._isUTC?"UTC":"")+"Month"](e,n),t}function Ht(t){return null!=t?(Ot(this,t),d.updateOffset(this,!0),this):q(this,"Month")}var Lt=ct;var Et=ct;function Rt(){function t(t,e){return e.length-t.length}var e,n,i=[],r=[],s=[];for(e=0;e<12;e++)n=m([2e3,e]),i.push(this.monthsShort(n,"")),r.push(this.months(n,"")),s.push(this.months(n,"")),s.push(this.monthsShort(n,""));for(i.sort(t),r.sort(t),s.sort(t),e=0;e<12;e++)i[e]=ft(i[e]),r[e]=ft(r[e]);for(e=0;e<24;e++)s[e]=ft(s[e]);this._monthsRegex=new RegExp("^("+s.join("|")+")","i"),this._monthsShortRegex=this._monthsRegex,this._monthsStrictRegex=new RegExp("^("+r.join("|")+")","i"),this._monthsShortStrictRegex=new RegExp("^("+i.join("|")+")","i")}function It(t){return Bt(t)?366:365}function Bt(t){return t%4==0&&t%100!=0||t%400==0}U("Y",0,0,function(){var t=this.year();return t<=9999?""+t:"+"+t}),U(0,["YY",2],0,function(){return this.year()%100}),U(0,["YYYY",4],0,"year"),U(0,["YYYYY",5],0,"year"),U(0,["YYYYYY",6,!0],0,"year"),H("year","y"),I("year",1),ht("Y",ot),ht("YY",K,J),ht("YYYY",it,Q),ht("YYYYY",rt,Z),ht("YYYYYY",rt,Z),mt(["YYYYY","YYYYYY"],gt),mt("YYYY",function(t,e){e[gt]=2===t.length?d.parseTwoDigitYear(t):x(t)}),mt("YY",function(t,e){e[gt]=d.parseTwoDigitYear(t)}),mt("Y",function(t,e){e[gt]=parseInt(t,10)}),d.parseTwoDigitYear=function(t){return x(t)+(68<x(t)?1900:2e3)};var qt=B("FullYear",!0);function Ft(t){var e=new Date(Date.UTC.apply(null,arguments));return t<100&&0<=t&&isFinite(e.getUTCFullYear())&&e.setUTCFullYear(t),e}function jt(t,e,n){var i=7+e-n;return-((7+Ft(t,0,i).getUTCDay()-e)%7)+i-1}function Pt(t,e,n,i,r){var s,o,a=1+7*(e-1)+(7+n-i)%7+jt(t,i,r);return a<=0?o=It(s=t-1)+a:a>It(t)?(s=t+1,o=a-It(t)):(s=t,o=a),{year:s,dayOfYear:o}}function Yt(t,e,n){var i,r,s=jt(t.year(),e,n),o=Math.floor((t.dayOfYear()-s-1)/7)+1;return o<1?i=o+zt(r=t.year()-1,e,n):o>zt(t.year(),e,n)?(i=o-zt(t.year(),e,n),r=t.year()+1):(r=t.year(),i=o),{week:i,year:r}}function zt(t,e,n){var i=jt(t,e,n),r=jt(t+1,e,n);return(It(t)-i+r)/7}U("w",["ww",2],"wo","week"),U("W",["WW",2],"Wo","isoWeek"),H("week","w"),H("isoWeek","W"),I("week",5),I("isoWeek",5),ht("w",K),ht("ww",K,J),ht("W",K),ht("WW",K,J),_t(["w","ww","W","WW"],function(t,e,n,i){e[i.substr(0,1)]=x(t)});U("d",0,"do","day"),U("dd",0,0,function(t){return this.localeData().weekdaysMin(this,t)}),U("ddd",0,0,function(t){return this.localeData().weekdaysShort(this,t)}),U("dddd",0,0,function(t){return this.localeData().weekdays(this,t)}),U("e",0,0,"weekday"),U("E",0,0,"isoWeekday"),H("day","d"),H("weekday","e"),H("isoWeekday","E"),I("day",11),I("weekday",11),I("isoWeekday",11),ht("d",K),ht("e",K),ht("E",K),ht("dd",function(t,e){return e.weekdaysMinRegex(t)}),ht("ddd",function(t,e){return e.weekdaysShortRegex(t)}),ht("dddd",function(t,e){return e.weekdaysRegex(t)}),_t(["dd","ddd","dddd"],function(t,e,n,i){var r=n._locale.weekdaysParse(t,i,n._strict);null!=r?e.d=r:_(n).invalidWeekday=t}),_t(["d","e","E"],function(t,e,n,i){e[i]=x(t)});var Wt="Sunday_Monday_Tuesday_Wednesday_Thursday_Friday_Saturday".split("_");var Ut="Sun_Mon_Tue_Wed_Thu_Fri_Sat".split("_");var Xt="Su_Mo_Tu_We_Th_Fr_Sa".split("_");var $t=ct;var Gt=ct;var Jt=ct;function Vt(){function t(t,e){return e.length-t.length}var e,n,i,r,s,o=[],a=[],u=[],c=[];for(e=0;e<7;e++)n=m([2e3,1]).day(e),i=this.weekdaysMin(n,""),r=this.weekdaysShort(n,""),s=this.weekdays(n,""),o.push(i),a.push(r),u.push(s),c.push(i),c.push(r),c.push(s);for(o.sort(t),a.sort(t),u.sort(t),c.sort(t),e=0;e<7;e++)a[e]=ft(a[e]),u[e]=ft(u[e]),c[e]=ft(c[e]);this._weekdaysRegex=new RegExp("^("+c.join("|")+")","i"),this._weekdaysShortRegex=this._weekdaysRegex,this._weekdaysMinRegex=this._weekdaysRegex,this._weekdaysStrictRegex=new RegExp("^("+u.join("|")+")","i"),this._weekdaysShortStrictRegex=new RegExp("^("+a.join("|")+")","i"),this._weekdaysMinStrictRegex=new RegExp("^("+o.join("|")+")","i")}function Qt(){return this.hours()%12||12}function Zt(t,e){U(t,0,0,function(){return this.localeData().meridiem(this.hours(),this.minutes(),e)})}function Kt(t,e){return e._meridiemParse}U("H",["HH",2],0,"hour"),U("h",["hh",2],0,Qt),U("k",["kk",2],0,function(){return this.hours()||24}),U("hmm",0,0,function(){return""+Qt.apply(this)+j(this.minutes(),2)}),U("hmmss",0,0,function(){return""+Qt.apply(this)+j(this.minutes(),2)+j(this.seconds(),2)}),U("Hmm",0,0,function(){return""+this.hours()+j(this.minutes(),2)}),U("Hmmss",0,0,function(){return""+this.hours()+j(this.minutes(),2)+j(this.seconds(),2)}),Zt("a",!0),Zt("A",!1),H("hour","h"),I("hour",13),ht("a",Kt),ht("A",Kt),ht("H",K),ht("h",K),ht("HH",K,J),ht("hh",K,J),ht("hmm",tt),ht("hmmss",et),ht("Hmm",tt),ht("Hmmss",et),mt(["H","HH"],St),mt(["a","A"],function(t,e,n){n._isPm=n._locale.isPM(t),n._meridiem=t}),mt(["h","hh"],function(t,e,n){e[St]=x(t),_(n).bigHour=!0}),mt("hmm",function(t,e,n){var i=t.length-2;e[St]=x(t.substr(0,i)),e[wt]=x(t.substr(i)),_(n).bigHour=!0}),mt("hmmss",function(t,e,n){var i=t.length-4,r=t.length-2;e[St]=x(t.substr(0,i)),e[wt]=x(t.substr(i,2)),e[bt]=x(t.substr(r)),_(n).bigHour=!0}),mt("Hmm",function(t,e,n){var i=t.length-2;e[St]=x(t.substr(0,i)),e[wt]=x(t.substr(i))}),mt("Hmmss",function(t,e,n){var i=t.length-4,r=t.length-2;e[St]=x(t.substr(0,i)),e[wt]=x(t.substr(i,2)),e[bt]=x(t.substr(r))});var te,ee=B("Hours",!0),ne={calendar:{sameDay:"[Today at] LT",nextDay:"[Tomorrow at] LT",nextWeek:"dddd [at] LT",lastDay:"[Yesterday at] LT",lastWeek:"[Last] dddd [at] LT",sameElse:"L"},longDateFormat:{LTS:"h:mm:ss A",LT:"h:mm A",L:"MM/DD/YYYY",LL:"MMMM D, YYYY",LLL:"MMMM D, YYYY h:mm A",LLLL:"dddd, MMMM D, YYYY h:mm A"},invalidDate:"Invalid date",ordinal:"%d",ordinalParse:/\d{1,2}/,relativeTime:{future:"in %s",past:"%s ago",s:"a few seconds",m:"a minute",mm:"%d minutes",h:"an hour",hh:"%d hours",d:"a day",dd:"%d days",M:"a month",MM:"%d months",y:"a year",yy:"%d years"},months:Nt,monthsShort:Dt,week:{dow:0,doy:6},weekdays:Wt,weekdaysMin:Xt,weekdaysShort:Ut,meridiemParse:/[ap]\.?m?\.?/i},ie={},re={};function se(t){return t?t.toLowerCase().replace("_","-"):t}function oe(t){var e=null;if(!ie[t]&&"undefined"!=typeof module&&module&&module.exports)try{e=te._abbr,require("./locale/"+t),ae(e)}catch(t){}return ie[t]}function ae(t,e){var n;return t&&(n=s(e)?ce(t):ue(t,e))&&(te=n),te._abbr}function ue(t,e){if(null===e)return delete ie[t],null;var n=ne;if(e.abbr=t,null!=ie[t])T("defineLocaleOverride","use moment.updateLocale(localeName, config) to change an existing locale. moment.defineLocale(localeName, config) should only be used for creating a new locale See http://momentjs.com/guides/#/warnings/define-locale/ for more info."),n=ie[t]._config;else if(null!=e.parentLocale){if(null==ie[e.parentLocale])return re[e.parentLocale]||(re[e.parentLocale]=[]),re[e.parentLocale].push({name:t,config:e}),null;n=ie[e.parentLocale]._config}return ie[t]=new N(C(n,e)),re[t]&&re[t].forEach(function(t){ue(t.name,t.config)}),ae(t),ie[t]}function ce(t){var e;if(t&&t._locale&&t._locale._abbr&&(t=t._locale._abbr),!t)return te;if(!a(t)){if(e=oe(t))return e;t=[t]}return function(t){for(var e,n,i,r,s=0;s<t.length;){for(e=(r=se(t[s]).split("-")).length,n=(n=se(t[s+1]))?n.split("-"):null;0<e;){if(i=oe(r.slice(0,e).join("-")))return i;if(n&&n.length>=e&&M(r,n,!0)>=e-1)break;e--}s++}return null}(t)}function le(t){var e,n=t._a;return n&&-2===_(t).overflow&&(e=n[vt]<0||11<n[vt]?vt:n[yt]<1||n[yt]>At(n[gt],n[vt])?yt:n[St]<0||24<n[St]||24===n[St]&&(0!==n[wt]||0!==n[bt]||0!==n[xt])?St:n[wt]<0||59<n[wt]?wt:n[bt]<0||59<n[bt]?bt:n[xt]<0||999<n[xt]?xt:-1,_(t)._overflowDayOfYear&&(e<gt||yt<e)&&(e=yt),_(t)._overflowWeeks&&-1===e&&(e=Mt),_(t)._overflowWeekday&&-1===e&&(e=kt),_(t).overflow=e),t}var he=/^\s*((?:[+-]\d{6}|\d{4})-(?:\d\d-\d\d|W\d\d-\d|W\d\d|\d\d\d|\d\d))(?:(T| )(\d\d(?::\d\d(?::\d\d(?:[.,]\d+)?)?)?)([\+\-]\d\d(?::?\d\d)?|\s*Z)?)?$/,de=/^\s*((?:[+-]\d{6}|\d{4})(?:\d\d\d\d|W\d\d\d|W\d\d|\d\d\d|\d\d))(?:(T| )(\d\d(?:\d\d(?:\d\d(?:[.,]\d+)?)?)?)([\+\-]\d\d(?::?\d\d)?|\s*Z)?)?$/,fe=/Z|[+-]\d\d(?::?\d\d)?/,pe=[["YYYYYY-MM-DD",/[+-]\d{6}-\d\d-\d\d/],["YYYY-MM-DD",/\d{4}-\d\d-\d\d/],["GGGG-[W]WW-E",/\d{4}-W\d\d-\d/],["GGGG-[W]WW",/\d{4}-W\d\d/,!1],["YYYY-DDD",/\d{4}-\d{3}/],["YYYY-MM",/\d{4}-\d\d/,!1],["YYYYYYMMDD",/[+-]\d{10}/],["YYYYMMDD",/\d{8}/],["GGGG[W]WWE",/\d{4}W\d{3}/],["GGGG[W]WW",/\d{4}W\d{2}/,!1],["YYYYDDD",/\d{7}/]],me=[["HH:mm:ss.SSSS",/\d\d:\d\d:\d\d\.\d+/],["HH:mm:ss,SSSS",/\d\d:\d\d:\d\d,\d+/],["HH:mm:ss",/\d\d:\d\d:\d\d/],["HH:mm",/\d\d:\d\d/],["HHmmss.SSSS",/\d\d\d\d\d\d\.\d+/],["HHmmss,SSSS",/\d\d\d\d\d\d,\d+/],["HHmmss",/\d\d\d\d\d\d/],["HHmm",/\d\d\d\d/],["HH",/\d\d/]],_e=/^\/?Date\((\-?\d+)/i;function ge(t){var e,n,i,r,s,o,a=t._i,u=he.exec(a)||de.exec(a);if(u){for(_(t).iso=!0,e=0,n=pe.length;e<n;e++)if(pe[e][1].exec(u[1])){r=pe[e][0],i=!1!==pe[e][2];break}if(null==r)return void(t._isValid=!1);if(u[3]){for(e=0,n=me.length;e<n;e++)if(me[e][1].exec(u[3])){s=(u[2]||" ")+me[e][0];break}if(null==s)return void(t._isValid=!1)}if(!i&&null!=s)return void(t._isValid=!1);if(u[4]){if(!fe.exec(u[4]))return void(t._isValid=!1);o="Z"}t._f=r+(s||"")+(o||""),Se(t)}else t._isValid=!1}function ve(t,e,n){return null!=t?t:null!=e?e:n}function ye(t){var e,n,i,r,s=[];if(!t._d){var o,a;for(o=t,a=new Date(d.now()),i=o._useUTC?[a.getUTCFullYear(),a.getUTCMonth(),a.getUTCDate()]:[a.getFullYear(),a.getMonth(),a.getDate()],t._w&&null==t._a[yt]&&null==t._a[vt]&&function(t){var e,n,i,r,s,o,a,u;if(null!=(e=t._w).GG||null!=e.W||null!=e.E)s=1,o=4,n=ve(e.GG,t._a[gt],Yt(xe(),1,4).year),i=ve(e.W,1),((r=ve(e.E,1))<1||7<r)&&(u=!0);else{s=t._locale._week.dow,o=t._locale._week.doy;var c=Yt(xe(),s,o);n=ve(e.gg,t._a[gt],c.year),i=ve(e.w,c.week),null!=e.d?((r=e.d)<0||6<r)&&(u=!0):null!=e.e?(r=e.e+s,(e.e<0||6<e.e)&&(u=!0)):r=s}i<1||i>zt(n,s,o)?_(t)._overflowWeeks=!0:null!=u?_(t)._overflowWeekday=!0:(a=Pt(n,i,r,s,o),t._a[gt]=a.year,t._dayOfYear=a.dayOfYear)}(t),t._dayOfYear&&(r=ve(t._a[gt],i[gt]),t._dayOfYear>It(r)&&(_(t)._overflowDayOfYear=!0),n=Ft(r,0,t._dayOfYear),t._a[vt]=n.getUTCMonth(),t._a[yt]=n.getUTCDate()),e=0;e<3&&null==t._a[e];++e)t._a[e]=s[e]=i[e];for(;e<7;e++)t._a[e]=s[e]=null==t._a[e]?2===e?1:0:t._a[e];24===t._a[St]&&0===t._a[wt]&&0===t._a[bt]&&0===t._a[xt]&&(t._nextDay=!0,t._a[St]=0),t._d=(t._useUTC?Ft:function(t,e,n,i,r,s,o){var a=new Date(t,e,n,i,r,s,o);return t<100&&0<=t&&isFinite(a.getFullYear())&&a.setFullYear(t),a}).apply(null,s),null!=t._tzm&&t._d.setUTCMinutes(t._d.getUTCMinutes()-t._tzm),t._nextDay&&(t._a[St]=24)}}function Se(t){if(t._f!==d.ISO_8601){t._a=[],_(t).empty=!0;var e,n,i,r,s,o,a,u,c=""+t._i,l=c.length,h=0;for(i=$(t._f,t._locale).match(P)||[],e=0;e<i.length;e++)r=i[e],(n=(c.match(dt(r,t))||[])[0])&&(0<(s=c.substr(0,c.indexOf(n))).length&&_(t).unusedInput.push(s),c=c.slice(c.indexOf(n)+n.length),h+=n.length),W[r]?(n?_(t).empty=!1:_(t).unusedTokens.push(r),o=r,u=t,null!=(a=n)&&f(pt,o)&&pt[o](a,u._a,u,o)):t._strict&&!n&&_(t).unusedTokens.push(r);_(t).charsLeftOver=l-h,0<c.length&&_(t).unusedInput.push(c),t._a[St]<=12&&!0===_(t).bigHour&&0<t._a[St]&&(_(t).bigHour=void 0),_(t).parsedDateParts=t._a.slice(0),_(t).meridiem=t._meridiem,t._a[St]=function(t,e,n){var i;if(null==n)return e;return null!=t.meridiemHour?t.meridiemHour(e,n):(null!=t.isPM&&((i=t.isPM(n))&&e<12&&(e+=12),i||12!==e||(e=0)),e)}(t._locale,t._a[St],t._meridiem),ye(t),le(t)}else ge(t)}function we(t){var e,n,i,r,s=t._i,o=t._f;return t._locale=t._locale||ce(t._l),null===s||void 0===o&&""===s?v({nullInput:!0}):("string"==typeof s&&(t._i=s=t._locale.preparse(s)),w(s)?new S(le(s)):(l(s)?t._d=s:a(o)?function(t){var e,n,i,r,s;if(0===t._f.length)return _(t).invalidFormat=!0,t._d=new Date(NaN);for(r=0;r<t._f.length;r++)s=0,e=y({},t),null!=t._useUTC&&(e._useUTC=t._useUTC),e._f=t._f[r],Se(e),g(e)&&(s+=_(e).charsLeftOver,s+=10*_(e).unusedTokens.length,_(e).score=s,(null==i||s<i)&&(i=s,n=e));p(t,n||e)}(t):o?Se(t):void 0===(n=(e=t)._i)?e._d=new Date(d.now()):l(n)?e._d=new Date(n.valueOf()):"string"==typeof n?(i=e,null===(r=_e.exec(i._i))?(ge(i),!1===i._isValid&&(delete i._isValid,d.createFromInputFallback(i))):i._d=new Date(+r[1])):a(n)?(e._a=h(n.slice(0),function(t){return parseInt(t,10)}),ye(e)):"object"==typeof n?function(t){if(!t._d){var e=E(t._i);t._a=h([e.year,e.month,e.day||e.date,e.hour,e.minute,e.second,e.millisecond],function(t){return t&&parseInt(t,10)}),ye(t)}}(e):c(n)?e._d=new Date(n):d.createFromInputFallback(e),g(t)||(t._d=null),t))}function be(t,e,n,i,r){var s,o={};return!0!==n&&!1!==n||(i=n,n=void 0),(u(t)&&function(t){var e;for(e in t)return!1;return!0}(t)||a(t)&&0===t.length)&&(t=void 0),o._isAMomentObject=!0,o._useUTC=o._isUTC=r,o._l=n,o._i=t,o._f=e,o._strict=i,(s=new S(le(we(o))))._nextDay&&(s.add(1,"d"),s._nextDay=void 0),s}function xe(t,e,n,i){return be(t,e,n,i,!1)}d.createFromInputFallback=n("value provided is not in a recognized ISO format. moment construction falls back to js Date(), which is not reliable across all browsers and versions. Non ISO date formats are discouraged and will be removed in an upcoming major release. Please refer to http://momentjs.com/guides/#/warnings/js-date/ for more info.",function(t){t._d=new Date(t._i+(t._useUTC?" UTC":""))}),d.ISO_8601=function(){};var Me=n("moment().min is deprecated, use moment.max instead. http://momentjs.com/guides/#/warnings/min-max/",function(){var t=xe.apply(null,arguments);return this.isValid()&&t.isValid()?t<this?this:t:v()}),ke=n("moment().max is deprecated, use moment.min instead. http://momentjs.com/guides/#/warnings/min-max/",function(){var t=xe.apply(null,arguments);return this.isValid()&&t.isValid()?this<t?this:t:v()});function Te(t,e){var n,i;if(1===e.length&&a(e[0])&&(e=e[0]),!e.length)return xe();for(n=e[0],i=1;i<e.length;++i)e[i].isValid()&&!e[i][t](n)||(n=e[i]);return n}function Ae(t){var e=E(t),n=e.year||0,i=e.quarter||0,r=e.month||0,s=e.week||0,o=e.day||0,a=e.hour||0,u=e.minute||0,c=e.second||0,l=e.millisecond||0;this._milliseconds=+l+1e3*c+6e4*u+1e3*a*60*60,this._days=+o+7*s,this._months=+r+3*i+12*n,this._data={},this._locale=ce(),this._bubble()}function Ce(t){return t instanceof Ae}function Ne(t){return t<0?-1*Math.round(-1*t):Math.round(t)}function De(t,n){U(t,0,0,function(){var t=this.utcOffset(),e="+";return t<0&&(t=-t,e="-"),e+j(~~(t/60),2)+n+j(~~t%60,2)})}De("Z",":"),De("ZZ",""),ht("Z",ut),ht("ZZ",ut),mt(["Z","ZZ"],function(t,e,n){n._useUTC=!0,n._tzm=He(ut,t)});var Oe=/([\+\-]|\d\d)/gi;function He(t,e){var n=(e||"").match(t);if(null===n)return null;var i=((n[n.length-1]||[])+"").match(Oe)||["-",0,0],r=60*i[1]+x(i[2]);return 0===r?0:"+"===i[0]?r:-r}function Le(t,e){var n,i;return e._isUTC?(n=e.clone(),i=(w(t)||l(t)?t.valueOf():xe(t).valueOf())-n.valueOf(),n._d.setTime(n._d.valueOf()+i),d.updateOffset(n,!1),n):xe(t).local()}function Ee(t){return 15*-Math.round(t._d.getTimezoneOffset()/15)}function Re(){return!!this.isValid()&&(this._isUTC&&0===this._offset)}d.updateOffset=function(){};var Ie=/^(\-)?(?:(\d*)[. ])?(\d+)\:(\d+)(?:\:(\d+)(\.\d*)?)?$/,Be=/^(-)?P(?:(-?[0-9,.]*)Y)?(?:(-?[0-9,.]*)M)?(?:(-?[0-9,.]*)W)?(?:(-?[0-9,.]*)D)?(?:T(?:(-?[0-9,.]*)H)?(?:(-?[0-9,.]*)M)?(?:(-?[0-9,.]*)S)?)?$/;function qe(t,e){var n,i,r,s=t,o=null;return Ce(t)?s={ms:t._milliseconds,d:t._days,M:t._months}:c(t)?(s={},e?s[e]=t:s.milliseconds=t):(o=Ie.exec(t))?(n="-"===o[1]?-1:1,s={y:0,d:x(o[yt])*n,h:x(o[St])*n,m:x(o[wt])*n,s:x(o[bt])*n,ms:x(Ne(1e3*o[xt]))*n}):(o=Be.exec(t))?(n="-"===o[1]?-1:1,s={y:Fe(o[2],n),M:Fe(o[3],n),w:Fe(o[4],n),d:Fe(o[5],n),h:Fe(o[6],n),m:Fe(o[7],n),s:Fe(o[8],n)}):null==s?s={}:"object"==typeof s&&("from"in s||"to"in s)&&(r=function(t,e){var n;if(!t.isValid()||!e.isValid())return{milliseconds:0,months:0};e=Le(e,t),t.isBefore(e)?n=je(t,e):((n=je(e,t)).milliseconds=-n.milliseconds,n.months=-n.months);return n}(xe(s.from),xe(s.to)),(s={}).ms=r.milliseconds,s.M=r.months),i=new Ae(s),Ce(t)&&f(t,"_locale")&&(i._locale=t._locale),i}function Fe(t,e){var n=t&&parseFloat(t.replace(",","."));return(isNaN(n)?0:n)*e}function je(t,e){var n={milliseconds:0,months:0};return n.months=e.month()-t.month()+12*(e.year()-t.year()),t.clone().add(n.months,"M").isAfter(e)&&--n.months,n.milliseconds=+e-+t.clone().add(n.months,"M"),n}function Pe(i,r){return function(t,e){var n;return null===e||isNaN(+e)||(T(r,"moment()."+r+"(period, number) is deprecated. Please use moment()."+r+"(number, period). See http://momentjs.com/guides/#/warnings/add-inverted-param/ for more info."),n=t,t=e,e=n),Ye(this,qe(t="string"==typeof t?+t:t,e),i),this}}function Ye(t,e,n,i){var r=e._milliseconds,s=Ne(e._days),o=Ne(e._months);t.isValid()&&(i=null==i||i,r&&t._d.setTime(t._d.valueOf()+r*n),s&&F(t,"Date",q(t,"Date")+s*n),o&&Ot(t,q(t,"Month")+o*n),i&&d.updateOffset(t,s||o))}qe.fn=Ae.prototype;var ze=Pe(1,"add"),We=Pe(-1,"subtract");function Ue(t){var e;return void 0===t?this._locale._abbr:(null!=(e=ce(t))&&(this._locale=e),this)}d.defaultFormat="YYYY-MM-DDTHH:mm:ssZ",d.defaultFormatUtc="YYYY-MM-DDTHH:mm:ss[Z]";var Xe=n("moment().lang() is deprecated. Instead, use moment().localeData() to get the language configuration. Use moment().locale() to change languages.",function(t){return void 0===t?this.localeData():this.locale(t)});function $e(){return this._locale}function Ge(t,e){U(0,[t,t.length],0,e)}function Je(t,e,n,i,r){var s;return null==t?Yt(this,i,r).year:((s=zt(t,i,r))<e&&(e=s),function(t,e,n,i,r){var s=Pt(t,e,n,i,r),o=Ft(s.year,0,s.dayOfYear);return this.year(o.getUTCFullYear()),this.month(o.getUTCMonth()),this.date(o.getUTCDate()),this}.call(this,t,e,n,i,r))}U(0,["gg",2],0,function(){return this.weekYear()%100}),U(0,["GG",2],0,function(){return this.isoWeekYear()%100}),Ge("gggg","weekYear"),Ge("ggggg","weekYear"),Ge("GGGG","isoWeekYear"),Ge("GGGGG","isoWeekYear"),H("weekYear","gg"),H("isoWeekYear","GG"),I("weekYear",1),I("isoWeekYear",1),ht("G",ot),ht("g",ot),ht("GG",K,J),ht("gg",K,J),ht("GGGG",it,Q),ht("gggg",it,Q),ht("GGGGG",rt,Z),ht("ggggg",rt,Z),_t(["gggg","ggggg","GGGG","GGGGG"],function(t,e,n,i){e[i.substr(0,2)]=x(t)}),_t(["gg","GG"],function(t,e,n,i){e[i]=d.parseTwoDigitYear(t)}),U("Q",0,"Qo","quarter"),H("quarter","Q"),I("quarter",7),ht("Q",G),mt("Q",function(t,e){e[vt]=3*(x(t)-1)}),U("D",["DD",2],"Do","date"),H("date","D"),I("date",9),ht("D",K),ht("DD",K,J),ht("Do",function(t,e){return t?e._ordinalParse:e._ordinalParseLenient}),mt(["D","DD"],yt),mt("Do",function(t,e){e[yt]=x(t.match(K)[0])});var Ve=B("Date",!0);U("DDD",["DDDD",3],"DDDo","dayOfYear"),H("dayOfYear","DDD"),I("dayOfYear",4),ht("DDD",nt),ht("DDDD",V),mt(["DDD","DDDD"],function(t,e,n){n._dayOfYear=x(t)}),U("m",["mm",2],0,"minute"),H("minute","m"),I("minute",14),ht("m",K),ht("mm",K,J),mt(["m","mm"],wt);var Qe=B("Minutes",!1);U("s",["ss",2],0,"second"),H("second","s"),I("second",15),ht("s",K),ht("ss",K,J),mt(["s","ss"],bt);var Ze,Ke=B("Seconds",!1);for(U("S",0,0,function(){return~~(this.millisecond()/100)}),U(0,["SS",2],0,function(){return~~(this.millisecond()/10)}),U(0,["SSS",3],0,"millisecond"),U(0,["SSSS",4],0,function(){return 10*this.millisecond()}),U(0,["SSSSS",5],0,function(){return 100*this.millisecond()}),U(0,["SSSSSS",6],0,function(){return 1e3*this.millisecond()}),U(0,["SSSSSSS",7],0,function(){return 1e4*this.millisecond()}),U(0,["SSSSSSSS",8],0,function(){return 1e5*this.millisecond()}),U(0,["SSSSSSSSS",9],0,function(){return 1e6*this.millisecond()}),H("millisecond","ms"),I("millisecond",16),ht("S",nt,G),ht("SS",nt,J),ht("SSS",nt,V),Ze="SSSS";Ze.length<=9;Ze+="S")ht(Ze,st);function tn(t,e){e[xt]=x(1e3*("0."+t))}for(Ze="S";Ze.length<=9;Ze+="S")mt(Ze,tn);var en=B("Milliseconds",!1);U("z",0,0,"zoneAbbr"),U("zz",0,0,"zoneName");var nn=S.prototype;function rn(t){return t}nn.add=ze,nn.calendar=function(t,e){var n=t||xe(),i=Le(n,this).startOf("day"),r=d.calendarFormat(this,i)||"sameElse",s=e&&(A(e[r])?e[r].call(this,n):e[r]);return this.format(s||this.localeData().calendar(r,this,xe(n)))},nn.clone=function(){return new S(this)},nn.diff=function(t,e,n){var i,r,s,o;return this.isValid()&&(i=Le(t,this)).isValid()?(r=6e4*(i.utcOffset()-this.utcOffset()),"year"===(e=L(e))||"month"===e||"quarter"===e?(a=this,u=i,h=12*(u.year()-a.year())+(u.month()-a.month()),d=a.clone().add(h,"months"),u-d<0?(c=a.clone().add(h-1,"months"),l=(u-d)/(d-c)):(c=a.clone().add(h+1,"months"),l=(u-d)/(c-d)),o=-(h+l)||0,"quarter"===e?o/=3:"year"===e&&(o/=12)):(s=this-i,o="second"===e?s/1e3:"minute"===e?s/6e4:"hour"===e?s/36e5:"day"===e?(s-r)/864e5:"week"===e?(s-r)/6048e5:s),n?o:b(o)):NaN;var a,u,c,l,h,d},nn.endOf=function(t){return void 0===(t=L(t))||"millisecond"===t?this:("date"===t&&(t="day"),this.startOf(t).add(1,"isoWeek"===t?"week":t).subtract(1,"ms"))},nn.format=function(t){t||(t=this.isUtc()?d.defaultFormatUtc:d.defaultFormat);var e=X(this,t);return this.localeData().postformat(e)},nn.from=function(t,e){return this.isValid()&&(w(t)&&t.isValid()||xe(t).isValid())?qe({to:this,from:t}).locale(this.locale()).humanize(!e):this.localeData().invalidDate()},nn.fromNow=function(t){return this.from(xe(),t)},nn.to=function(t,e){return this.isValid()&&(w(t)&&t.isValid()||xe(t).isValid())?qe({from:this,to:t}).locale(this.locale()).humanize(!e):this.localeData().invalidDate()},nn.toNow=function(t){return this.to(xe(),t)},nn.get=function(t){return A(this[t=L(t)])?this[t]():this},nn.invalidAt=function(){return _(this).overflow},nn.isAfter=function(t,e){var n=w(t)?t:xe(t);return!(!this.isValid()||!n.isValid())&&("millisecond"===(e=L(s(e)?"millisecond":e))?this.valueOf()>n.valueOf():n.valueOf()<this.clone().startOf(e).valueOf())},nn.isBefore=function(t,e){var n=w(t)?t:xe(t);return!(!this.isValid()||!n.isValid())&&("millisecond"===(e=L(s(e)?"millisecond":e))?this.valueOf()<n.valueOf():this.clone().endOf(e).valueOf()<n.valueOf())},nn.isBetween=function(t,e,n,i){return("("===(i=i||"()")[0]?this.isAfter(t,n):!this.isBefore(t,n))&&(")"===i[1]?this.isBefore(e,n):!this.isAfter(e,n))},nn.isSame=function(t,e){var n,i=w(t)?t:xe(t);return!(!this.isValid()||!i.isValid())&&("millisecond"===(e=L(e||"millisecond"))?this.valueOf()===i.valueOf():(n=i.valueOf(),this.clone().startOf(e).valueOf()<=n&&n<=this.clone().endOf(e).valueOf()))},nn.isSameOrAfter=function(t,e){return this.isSame(t,e)||this.isAfter(t,e)},nn.isSameOrBefore=function(t,e){return this.isSame(t,e)||this.isBefore(t,e)},nn.isValid=function(){return g(this)},nn.lang=Xe,nn.locale=Ue,nn.localeData=$e,nn.max=ke,nn.min=Me,nn.parsingFlags=function(){return p({},_(this))},nn.set=function(t,e){if("object"==typeof t)for(var n=function(t){var e=[];for(var n in t)e.push({unit:n,priority:R[n]});return e.sort(function(t,e){return t.priority-e.priority}),e}(t=E(t)),i=0;i<n.length;i++)this[n[i].unit](t[n[i].unit]);else if(A(this[t=L(t)]))return this[t](e);return this},nn.startOf=function(t){switch(t=L(t)){case"year":this.month(0);case"quarter":case"month":this.date(1);case"week":case"isoWeek":case"day":case"date":this.hours(0);case"hour":this.minutes(0);case"minute":this.seconds(0);case"second":this.milliseconds(0)}return"week"===t&&this.weekday(0),"isoWeek"===t&&this.isoWeekday(1),"quarter"===t&&this.month(3*Math.floor(this.month()/3)),this},nn.subtract=We,nn.toArray=function(){var t=this;return[t.year(),t.month(),t.date(),t.hour(),t.minute(),t.second(),t.millisecond()]},nn.toObject=function(){var t=this;return{years:t.year(),months:t.month(),date:t.date(),hours:t.hours(),minutes:t.minutes(),seconds:t.seconds(),milliseconds:t.milliseconds()}},nn.toDate=function(){return new Date(this.valueOf())},nn.toISOString=function(){var t=this.clone().utc();return 0<t.year()&&t.year()<=9999?A(Date.prototype.toISOString)?this.toDate().toISOString():X(t,"YYYY-MM-DD[T]HH:mm:ss.SSS[Z]"):X(t,"YYYYYY-MM-DD[T]HH:mm:ss.SSS[Z]")},nn.inspect=function(){if(!this.isValid())return"moment.invalid(/* "+this._i+" */)";var t="moment",e="";this.isLocal()||(t=0===this.utcOffset()?"moment.utc":"moment.parseZone",e="Z");var n="["+t+'("]',i=0<this.year()&&this.year()<=9999?"YYYY":"YYYYYY",r=e+'[")]';return this.format(n+i+"-MM-DD[T]HH:mm:ss.SSS"+r)},nn.toJSON=function(){return this.isValid()?this.toISOString():null},nn.toString=function(){return this.clone().locale("en").format("ddd MMM DD YYYY HH:mm:ss [GMT]ZZ")},nn.unix=function(){return Math.floor(this.valueOf()/1e3)},nn.valueOf=function(){return this._d.valueOf()-6e4*(this._offset||0)},nn.creationData=function(){return{input:this._i,format:this._f,locale:this._locale,isUTC:this._isUTC,strict:this._strict}},nn.year=qt,nn.isLeapYear=function(){return Bt(this.year())},nn.weekYear=function(t){return Je.call(this,t,this.week(),this.weekday(),this.localeData()._week.dow,this.localeData()._week.doy)},nn.isoWeekYear=function(t){return Je.call(this,t,this.isoWeek(),this.isoWeekday(),1,4)},nn.quarter=nn.quarters=function(t){return null==t?Math.ceil((this.month()+1)/3):this.month(3*(t-1)+this.month()%3)},nn.month=Ht,nn.daysInMonth=function(){return At(this.year(),this.month())},nn.week=nn.weeks=function(t){var e=this.localeData().week(this);return null==t?e:this.add(7*(t-e),"d")},nn.isoWeek=nn.isoWeeks=function(t){var e=Yt(this,1,4).week;return null==t?e:this.add(7*(t-e),"d")},nn.weeksInYear=function(){var t=this.localeData()._week;return zt(this.year(),t.dow,t.doy)},nn.isoWeeksInYear=function(){return zt(this.year(),1,4)},nn.date=Ve,nn.day=nn.days=function(t){if(!this.isValid())return null!=t?this:NaN;var e,n,i=this._isUTC?this._d.getUTCDay():this._d.getDay();return null!=t?(e=t,n=this.localeData(),t="string"!=typeof e?e:isNaN(e)?"number"==typeof(e=n.weekdaysParse(e))?e:null:parseInt(e,10),this.add(t-i,"d")):i},nn.weekday=function(t){if(!this.isValid())return null!=t?this:NaN;var e=(this.day()+7-this.localeData()._week.dow)%7;return null==t?e:this.add(t-e,"d")},nn.isoWeekday=function(t){if(!this.isValid())return null!=t?this:NaN;if(null==t)return this.day()||7;var e,n,i=(e=t,n=this.localeData(),"string"==typeof e?n.weekdaysParse(e)%7||7:isNaN(e)?null:e);return this.day(this.day()%7?i:i-7)},nn.dayOfYear=function(t){var e=Math.round((this.clone().startOf("day")-this.clone().startOf("year"))/864e5)+1;return null==t?e:this.add(t-e,"d")},nn.hour=nn.hours=ee,nn.minute=nn.minutes=Qe,nn.second=nn.seconds=Ke,nn.millisecond=nn.milliseconds=en,nn.utcOffset=function(t,e){var n,i=this._offset||0;if(!this.isValid())return null!=t?this:NaN;if(null==t)return this._isUTC?i:Ee(this);if("string"==typeof t){if(null===(t=He(ut,t)))return this}else Math.abs(t)<16&&(t*=60);return!this._isUTC&&e&&(n=Ee(this)),this._offset=t,this._isUTC=!0,null!=n&&this.add(n,"m"),i!==t&&(!e||this._changeInProgress?Ye(this,qe(t-i,"m"),1,!1):this._changeInProgress||(this._changeInProgress=!0,d.updateOffset(this,!0),this._changeInProgress=null)),this},nn.utc=function(t){return this.utcOffset(0,t)},nn.local=function(t){return this._isUTC&&(this.utcOffset(0,t),this._isUTC=!1,t&&this.subtract(Ee(this),"m")),this},nn.parseZone=function(){if(null!=this._tzm)this.utcOffset(this._tzm);else if("string"==typeof this._i){var t=He(at,this._i);null!=t?this.utcOffset(t):this.utcOffset(0,!0)}return this},nn.hasAlignedHourOffset=function(t){return!!this.isValid()&&(t=t?xe(t).utcOffset():0,(this.utcOffset()-t)%60==0)},nn.isDST=function(){return this.utcOffset()>this.clone().month(0).utcOffset()||this.utcOffset()>this.clone().month(5).utcOffset()},nn.isLocal=function(){return!!this.isValid()&&!this._isUTC},nn.isUtcOffset=function(){return!!this.isValid()&&this._isUTC},nn.isUtc=Re,nn.isUTC=Re,nn.zoneAbbr=function(){return this._isUTC?"UTC":""},nn.zoneName=function(){return this._isUTC?"Coordinated Universal Time":""},nn.dates=n("dates accessor is deprecated. Use date instead.",Ve),nn.months=n("months accessor is deprecated. Use month instead",Ht),nn.years=n("years accessor is deprecated. Use year instead",qt),nn.zone=n("moment().zone is deprecated, use moment().utcOffset instead. http://momentjs.com/guides/#/warnings/zone/",function(t,e){return null!=t?("string"!=typeof t&&(t=-t),this.utcOffset(t,e),this):-this.utcOffset()}),nn.isDSTShifted=n("isDSTShifted is deprecated. See http://momentjs.com/guides/#/warnings/dst-shifted/ for more information",function(){if(!s(this._isDSTShifted))return this._isDSTShifted;var t={};if(y(t,this),(t=we(t))._a){var e=t._isUTC?m(t._a):xe(t._a);this._isDSTShifted=this.isValid()&&0<M(t._a,e.toArray())}else this._isDSTShifted=!1;return this._isDSTShifted});var sn=N.prototype;function on(t,e,n,i){var r=ce(),s=m().set(i,e);return r[n](s,t)}function an(t,e,n){if(c(t)&&(e=t,t=void 0),t=t||"",null!=e)return on(t,e,n,"month");var i,r=[];for(i=0;i<12;i++)r[i]=on(t,i,n,"month");return r}function un(t,e,n,i){"boolean"==typeof t?c(e)&&(n=e,e=void 0):(e=t,t=!1,c(n=e)&&(n=e,e=void 0)),e=e||"";var r,s=ce(),o=t?s._week.dow:0;if(null!=n)return on(e,(n+o)%7,i,"day");var a=[];for(r=0;r<7;r++)a[r]=on(e,(r+o)%7,i,"day");return a}sn.calendar=function(t,e,n){var i=this._calendar[t]||this._calendar.sameElse;return A(i)?i.call(e,n):i},sn.longDateFormat=function(t){var e=this._longDateFormat[t],n=this._longDateFormat[t.toUpperCase()];return e||!n?e:(this._longDateFormat[t]=n.replace(/MMMM|MM|DD|dddd/g,function(t){return t.slice(1)}),this._longDateFormat[t])},sn.invalidDate=function(){return this._invalidDate},sn.ordinal=function(t){return this._ordinal.replace("%d",t)},sn.preparse=rn,sn.postformat=rn,sn.relativeTime=function(t,e,n,i){var r=this._relativeTime[n];return A(r)?r(t,e,n,i):r.replace(/%d/i,t)},sn.pastFuture=function(t,e){var n=this._relativeTime[0<t?"future":"past"];return A(n)?n(e):n.replace(/%s/i,e)},sn.set=function(t){var e,n;for(n in t)A(e=t[n])?this[n]=e:this["_"+n]=e;this._config=t,this._ordinalParseLenient=new RegExp(this._ordinalParse.source+"|"+/\d{1,2}/.source)},sn.months=function(t,e){return t?a(this._months)?this._months[t.month()]:this._months[(this._months.isFormat||Ct).test(e)?"format":"standalone"][t.month()]:this._months},sn.monthsShort=function(t,e){return t?a(this._monthsShort)?this._monthsShort[t.month()]:this._monthsShort[Ct.test(e)?"format":"standalone"][t.month()]:this._monthsShort},sn.monthsParse=function(t,e,n){var i,r,s;if(this._monthsParseExact)return function(t,e,n){var i,r,s,o=t.toLocaleLowerCase();if(!this._monthsParse)for(this._monthsParse=[],this._longMonthsParse=[],this._shortMonthsParse=[],i=0;i<12;++i)s=m([2e3,i]),this._shortMonthsParse[i]=this.monthsShort(s,"").toLocaleLowerCase(),this._longMonthsParse[i]=this.months(s,"").toLocaleLowerCase();return n?"MMM"===e?-1!==(r=Tt.call(this._shortMonthsParse,o))?r:null:-1!==(r=Tt.call(this._longMonthsParse,o))?r:null:"MMM"===e?-1!==(r=Tt.call(this._shortMonthsParse,o))?r:-1!==(r=Tt.call(this._longMonthsParse,o))?r:null:-1!==(r=Tt.call(this._longMonthsParse,o))?r:-1!==(r=Tt.call(this._shortMonthsParse,o))?r:null}.call(this,t,e,n);for(this._monthsParse||(this._monthsParse=[],this._longMonthsParse=[],this._shortMonthsParse=[]),i=0;i<12;i++){if(r=m([2e3,i]),n&&!this._longMonthsParse[i]&&(this._longMonthsParse[i]=new RegExp("^"+this.months(r,"").replace(".","")+"$","i"),this._shortMonthsParse[i]=new RegExp("^"+this.monthsShort(r,"").replace(".","")+"$","i")),n||this._monthsParse[i]||(s="^"+this.months(r,"")+"|^"+this.monthsShort(r,""),this._monthsParse[i]=new RegExp(s.replace(".",""),"i")),n&&"MMMM"===e&&this._longMonthsParse[i].test(t))return i;if(n&&"MMM"===e&&this._shortMonthsParse[i].test(t))return i;if(!n&&this._monthsParse[i].test(t))return i}},sn.monthsRegex=function(t){return this._monthsParseExact?(f(this,"_monthsRegex")||Rt.call(this),t?this._monthsStrictRegex:this._monthsRegex):(f(this,"_monthsRegex")||(this._monthsRegex=Et),this._monthsStrictRegex&&t?this._monthsStrictRegex:this._monthsRegex)},sn.monthsShortRegex=function(t){return this._monthsParseExact?(f(this,"_monthsRegex")||Rt.call(this),t?this._monthsShortStrictRegex:this._monthsShortRegex):(f(this,"_monthsShortRegex")||(this._monthsShortRegex=Lt),this._monthsShortStrictRegex&&t?this._monthsShortStrictRegex:this._monthsShortRegex)},sn.week=function(t){return Yt(t,this._week.dow,this._week.doy).week},sn.firstDayOfYear=function(){return this._week.doy},sn.firstDayOfWeek=function(){return this._week.dow},sn.weekdays=function(t,e){return t?a(this._weekdays)?this._weekdays[t.day()]:this._weekdays[this._weekdays.isFormat.test(e)?"format":"standalone"][t.day()]:this._weekdays},sn.weekdaysMin=function(t){return t?this._weekdaysMin[t.day()]:this._weekdaysMin},sn.weekdaysShort=function(t){return t?this._weekdaysShort[t.day()]:this._weekdaysShort},sn.weekdaysParse=function(t,e,n){var i,r,s;if(this._weekdaysParseExact)return function(t,e,n){var i,r,s,o=t.toLocaleLowerCase();if(!this._weekdaysParse)for(this._weekdaysParse=[],this._shortWeekdaysParse=[],this._minWeekdaysParse=[],i=0;i<7;++i)s=m([2e3,1]).day(i),this._minWeekdaysParse[i]=this.weekdaysMin(s,"").toLocaleLowerCase(),this._shortWeekdaysParse[i]=this.weekdaysShort(s,"").toLocaleLowerCase(),this._weekdaysParse[i]=this.weekdays(s,"").toLocaleLowerCase();return n?"dddd"===e?-1!==(r=Tt.call(this._weekdaysParse,o))?r:null:"ddd"===e?-1!==(r=Tt.call(this._shortWeekdaysParse,o))?r:null:-1!==(r=Tt.call(this._minWeekdaysParse,o))?r:null:"dddd"===e?-1!==(r=Tt.call(this._weekdaysParse,o))?r:-1!==(r=Tt.call(this._shortWeekdaysParse,o))?r:-1!==(r=Tt.call(this._minWeekdaysParse,o))?r:null:"ddd"===e?-1!==(r=Tt.call(this._shortWeekdaysParse,o))?r:-1!==(r=Tt.call(this._weekdaysParse,o))?r:-1!==(r=Tt.call(this._minWeekdaysParse,o))?r:null:-1!==(r=Tt.call(this._minWeekdaysParse,o))?r:-1!==(r=Tt.call(this._weekdaysParse,o))?r:-1!==(r=Tt.call(this._shortWeekdaysParse,o))?r:null}.call(this,t,e,n);for(this._weekdaysParse||(this._weekdaysParse=[],this._minWeekdaysParse=[],this._shortWeekdaysParse=[],this._fullWeekdaysParse=[]),i=0;i<7;i++){if(r=m([2e3,1]).day(i),n&&!this._fullWeekdaysParse[i]&&(this._fullWeekdaysParse[i]=new RegExp("^"+this.weekdays(r,"").replace(".",".?")+"$","i"),this._shortWeekdaysParse[i]=new RegExp("^"+this.weekdaysShort(r,"").replace(".",".?")+"$","i"),this._minWeekdaysParse[i]=new RegExp("^"+this.weekdaysMin(r,"").replace(".",".?")+"$","i")),this._weekdaysParse[i]||(s="^"+this.weekdays(r,"")+"|^"+this.weekdaysShort(r,"")+"|^"+this.weekdaysMin(r,""),this._weekdaysParse[i]=new RegExp(s.replace(".",""),"i")),n&&"dddd"===e&&this._fullWeekdaysParse[i].test(t))return i;if(n&&"ddd"===e&&this._shortWeekdaysParse[i].test(t))return i;if(n&&"dd"===e&&this._minWeekdaysParse[i].test(t))return i;if(!n&&this._weekdaysParse[i].test(t))return i}},sn.weekdaysRegex=function(t){return this._weekdaysParseExact?(f(this,"_weekdaysRegex")||Vt.call(this),t?this._weekdaysStrictRegex:this._weekdaysRegex):(f(this,"_weekdaysRegex")||(this._weekdaysRegex=$t),this._weekdaysStrictRegex&&t?this._weekdaysStrictRegex:this._weekdaysRegex)},sn.weekdaysShortRegex=function(t){return this._weekdaysParseExact?(f(this,"_weekdaysRegex")||Vt.call(this),t?this._weekdaysShortStrictRegex:this._weekdaysShortRegex):(f(this,"_weekdaysShortRegex")||(this._weekdaysShortRegex=Gt),this._weekdaysShortStrictRegex&&t?this._weekdaysShortStrictRegex:this._weekdaysShortRegex)},sn.weekdaysMinRegex=function(t){return this._weekdaysParseExact?(f(this,"_weekdaysRegex")||Vt.call(this),t?this._weekdaysMinStrictRegex:this._weekdaysMinRegex):(f(this,"_weekdaysMinRegex")||(this._weekdaysMinRegex=Jt),this._weekdaysMinStrictRegex&&t?this._weekdaysMinStrictRegex:this._weekdaysMinRegex)},sn.isPM=function(t){return"p"===(t+"").toLowerCase().charAt(0)},sn.meridiem=function(t,e,n){return 11<t?n?"pm":"PM":n?"am":"AM"},ae("en",{ordinalParse:/\d{1,2}(th|st|nd|rd)/,ordinal:function(t){var e=t%10;return t+(1===x(t%100/10)?"th":1===e?"st":2===e?"nd":3===e?"rd":"th")}}),d.lang=n("moment.lang is deprecated. Use moment.locale instead.",ae),d.langData=n("moment.langData is deprecated. Use moment.localeData instead.",ce);var cn=Math.abs;function ln(t,e,n,i){var r=qe(e,n);return t._milliseconds+=i*r._milliseconds,t._days+=i*r._days,t._months+=i*r._months,t._bubble()}function hn(t){return t<0?Math.floor(t):Math.ceil(t)}function dn(t){return 4800*t/146097}function fn(t){return 146097*t/4800}function pn(t){return function(){return this.as(t)}}var mn=pn("ms"),_n=pn("s"),gn=pn("m"),vn=pn("h"),yn=pn("d"),Sn=pn("w"),wn=pn("M"),bn=pn("y");function xn(t){return function(){return this._data[t]}}var Mn=xn("milliseconds"),kn=xn("seconds"),Tn=xn("minutes"),An=xn("hours"),Cn=xn("days"),Nn=xn("months"),Dn=xn("years");var On=Math.round,Hn={s:45,m:45,h:22,d:26,M:11};var Ln=Math.abs;function En(){var t,e,n=Ln(this._milliseconds)/1e3,i=Ln(this._days),r=Ln(this._months);e=b((t=b(n/60))/60),n%=60,t%=60;var s=b(r/12),o=r%=12,a=i,u=e,c=t,l=n,h=this.asSeconds();return h?(h<0?"-":"")+"P"+(s?s+"Y":"")+(o?o+"M":"")+(a?a+"D":"")+(u||c||l?"T":"")+(u?u+"H":"")+(c?c+"M":"")+(l?l+"S":""):"P0D"}var Rn=Ae.prototype;return Rn.abs=function(){var t=this._data;return this._milliseconds=cn(this._milliseconds),this._days=cn(this._days),this._months=cn(this._months),t.milliseconds=cn(t.milliseconds),t.seconds=cn(t.seconds),t.minutes=cn(t.minutes),t.hours=cn(t.hours),t.months=cn(t.months),t.years=cn(t.years),this},Rn.add=function(t,e){return ln(this,t,e,1)},Rn.subtract=function(t,e){return ln(this,t,e,-1)},Rn.as=function(t){var e,n,i=this._milliseconds;if("month"===(t=L(t))||"year"===t)return e=this._days+i/864e5,n=this._months+dn(e),"month"===t?n:n/12;switch(e=this._days+Math.round(fn(this._months)),t){case"week":return e/7+i/6048e5;case"day":return e+i/864e5;case"hour":return 24*e+i/36e5;case"minute":return 1440*e+i/6e4;case"second":return 86400*e+i/1e3;case"millisecond":return Math.floor(864e5*e)+i;default:throw new Error("Unknown unit "+t)}},Rn.asMilliseconds=mn,Rn.asSeconds=_n,Rn.asMinutes=gn,Rn.asHours=vn,Rn.asDays=yn,Rn.asWeeks=Sn,Rn.asMonths=wn,Rn.asYears=bn,Rn.valueOf=function(){return this._milliseconds+864e5*this._days+this._months%12*2592e6+31536e6*x(this._months/12)},Rn._bubble=function(){var t,e,n,i,r,s=this._milliseconds,o=this._days,a=this._months,u=this._data;return 0<=s&&0<=o&&0<=a||s<=0&&o<=0&&a<=0||(s+=864e5*hn(fn(a)+o),a=o=0),u.milliseconds=s%1e3,t=b(s/1e3),u.seconds=t%60,e=b(t/60),u.minutes=e%60,n=b(e/60),u.hours=n%24,a+=r=b(dn(o+=b(n/24))),o-=hn(fn(r)),i=b(a/12),a%=12,u.days=o,u.months=a,u.years=i,this},Rn.get=function(t){return this[(t=L(t))+"s"]()},Rn.milliseconds=Mn,Rn.seconds=kn,Rn.minutes=Tn,Rn.hours=An,Rn.days=Cn,Rn.weeks=function(){return b(this.days()/7)},Rn.months=Nn,Rn.years=Dn,Rn.humanize=function(t){var e,n,i,r,s,o,a,u,c,l,h,d=this.localeData(),f=(n=!t,i=d,r=qe(e=this).abs(),s=On(r.as("s")),o=On(r.as("m")),a=On(r.as("h")),u=On(r.as("d")),c=On(r.as("M")),l=On(r.as("y")),(h=s<Hn.s&&["s",s]||o<=1&&["m"]||o<Hn.m&&["mm",o]||a<=1&&["h"]||a<Hn.h&&["hh",a]||u<=1&&["d"]||u<Hn.d&&["dd",u]||c<=1&&["M"]||c<Hn.M&&["MM",c]||l<=1&&["y"]||["yy",l])[2]=n,h[3]=0<+e,h[4]=i,function(t,e,n,i,r){return r.relativeTime(e||1,!!n,t,i)}.apply(null,h));return t&&(f=d.pastFuture(+this,f)),d.postformat(f)},Rn.toISOString=En,Rn.toString=En,Rn.toJSON=En,Rn.locale=Ue,Rn.localeData=$e,Rn.toIsoString=n("toIsoString() is deprecated. Please use toISOString() instead (notice the capitals)",En),Rn.lang=Xe,U("X",0,0,"unix"),U("x",0,0,"valueOf"),ht("x",ot),ht("X",/[+-]?\d+(\.\d{1,3})?/),mt("X",function(t,e,n){n._d=new Date(1e3*parseFloat(t,10))}),mt("x",function(t,e,n){n._d=new Date(x(t))}),d.version="2.17.1",t=xe,d.fn=nn,d.min=function(){return Te("isBefore",[].slice.call(arguments,0))},d.max=function(){return Te("isAfter",[].slice.call(arguments,0))},d.now=function(){return Date.now?Date.now():+new Date},d.utc=m,d.unix=function(t){return xe(1e3*t)},d.months=function(t,e){return an(t,e,"months")},d.isDate=l,d.locale=ae,d.invalid=v,d.duration=qe,d.isMoment=w,d.weekdays=function(t,e,n){return un(t,e,n,"weekdays")},d.parseZone=function(){return xe.apply(null,arguments).parseZone()},d.localeData=ce,d.isDuration=Ce,d.monthsShort=function(t,e){return an(t,e,"monthsShort")},d.weekdaysMin=function(t,e,n){return un(t,e,n,"weekdaysMin")},d.defineLocale=ue,d.updateLocale=function(t,e){if(null!=e){var n,i=ne;null!=ie[t]&&(i=ie[t]._config),(n=new N(e=C(i,e))).parentLocale=ie[t],ie[t]=n,ae(t)}else null!=ie[t]&&(null!=ie[t].parentLocale?ie[t]=ie[t].parentLocale:null!=ie[t]&&delete ie[t]);return ie[t]},d.locales=function(){return D(ie)},d.weekdaysShort=function(t,e,n){return un(t,e,n,"weekdaysShort")},d.normalizeUnits=L,d.relativeTimeRounding=function(t){return void 0===t?On:"function"==typeof t&&(On=t,!0)},d.relativeTimeThreshold=function(t,e){return void 0!==Hn[t]&&(void 0===e?Hn[t]:(Hn[t]=e,!0))},d.calendarFormat=function(t,e){var n=t.diff(e,"days",!0);return n<-6?"sameElse":n<-1?"lastWeek":n<0?"lastDay":n<1?"sameDay":n<2?"nextDay":n<7?"nextWeek":"sameElse"},d.prototype=nn,d}),function(t,e){"object"==typeof exports?module.exports=exports=e():"function"==typeof define&&define.amd?define([],e):t.CryptoJS=e()}(this,function(){var l,n,t,e,i,h,r,s,o,a,u,c,d,f,p,m,_,g,v,y,S,w,b,x,M,k,T,A,C,N,D,O,H,L,E,R,I,B,q,F,j,P,Y,z,W,U,X,$,G,J,V,Q,Z,K,tt,et,nt,it,rt,st,ot,at,ut,ct,lt,ht,dt,ft,pt,mt,_t,gt,vt,yt,St,wt,bt,xt,Mt,kt,Tt,At,Ct=Ct||(l=Math,n=Object.create||function(){function n(){}return function(t){var e;return n.prototype=t,e=new n,n.prototype=null,e}}(),e=(t={}).lib={},i=e.Base={extend:function(t){var e=n(this);return t&&e.mixIn(t),e.hasOwnProperty("init")&&this.init!==e.init||(e.init=function(){e.$super.init.apply(this,arguments)}),(e.init.prototype=e).$super=this,e},create:function(){var t=this.extend();return t.init.apply(t,arguments),t},init:function(){},mixIn:function(t){for(var e in t)t.hasOwnProperty(e)&&(this[e]=t[e]);t.hasOwnProperty("toString")&&(this.toString=t.toString)},clone:function(){return this.init.prototype.extend(this)}},h=e.WordArray=i.extend({init:function(t,e){t=this.words=t||[],this.sigBytes=null!=e?e:4*t.length},toString:function(t){return(t||s).stringify(this)},concat:function(t){var e=this.words,n=t.words,i=this.sigBytes,r=t.sigBytes;if(this.clamp(),i%4)for(var s=0;s<r;s++){var o=n[s>>>2]>>>24-s%4*8&255;e[i+s>>>2]|=o<<24-(i+s)%4*8}else for(s=0;s<r;s+=4)e[i+s>>>2]=n[s>>>2];return this.sigBytes+=r,this},clamp:function(){var t=this.words,e=this.sigBytes;t[e>>>2]&=4294967295<<32-e%4*8,t.length=l.ceil(e/4)},clone:function(){var t=i.clone.call(this);return t.words=this.words.slice(0),t},random:function(t){for(var e,n=[],i=function(e){e=e;var n=987654321,i=4294967295;return function(){var t=((n=36969*(65535&n)+(n>>16)&i)<<16)+(e=18e3*(65535&e)+(e>>16)&i)&i;return t/=4294967296,(t+=.5)*(.5<l.random()?1:-1)}},r=0;r<t;r+=4){var s=i(4294967296*(e||l.random()));e=987654071*s(),n.push(4294967296*s()|0)}return new h.init(n,t)}}),r=t.enc={},s=r.Hex={stringify:function(t){for(var e=t.words,n=t.sigBytes,i=[],r=0;r<n;r++){var s=e[r>>>2]>>>24-r%4*8&255;i.push((s>>>4).toString(16)),i.push((15&s).toString(16))}return i.join("")},parse:function(t){for(var e=t.length,n=[],i=0;i<e;i+=2)n[i>>>3]|=parseInt(t.substr(i,2),16)<<24-i%8*4;return new h.init(n,e/2)}},o=r.Latin1={stringify:function(t){for(var e=t.words,n=t.sigBytes,i=[],r=0;r<n;r++){var s=e[r>>>2]>>>24-r%4*8&255;i.push(String.fromCharCode(s))}return i.join("")},parse:function(t){for(var e=t.length,n=[],i=0;i<e;i++)n[i>>>2]|=(255&t.charCodeAt(i))<<24-i%4*8;return new h.init(n,e)}},a=r.Utf8={stringify:function(t){try{return decodeURIComponent(escape(o.stringify(t)))}catch(t){throw new Error("Malformed UTF-8 data")}},parse:function(t){return o.parse(unescape(encodeURIComponent(t)))}},u=e.BufferedBlockAlgorithm=i.extend({reset:function(){this._data=new h.init,this._nDataBytes=0},_append:function(t){"string"==typeof t&&(t=a.parse(t)),this._data.concat(t),this._nDataBytes+=t.sigBytes},_process:function(t){var e=this._data,n=e.words,i=e.sigBytes,r=this.blockSize,s=i/(4*r),o=(s=t?l.ceil(s):l.max((0|s)-this._minBufferSize,0))*r,a=l.min(4*o,i);if(o){for(var u=0;u<o;u+=r)this._doProcessBlock(n,u);var c=n.splice(0,o);e.sigBytes-=a}return new h.init(c,a)},clone:function(){var t=i.clone.call(this);return t._data=this._data.clone(),t},_minBufferSize:0}),e.Hasher=u.extend({cfg:i.extend(),init:function(t){this.cfg=this.cfg.extend(t),this.reset()},reset:function(){u.reset.call(this),this._doReset()},update:function(t){return this._append(t),this._process(),this},finalize:function(t){return t&&this._append(t),this._doFinalize()},blockSize:16,_createHelper:function(n){return function(t,e){return new n.init(e).finalize(t)}},_createHmacHelper:function(n){return function(t,e){return new c.HMAC.init(n,e).finalize(t)}}}),c=t.algo={},t);return f=(d=Ct).lib.WordArray,d.enc.Base64={stringify:function(t){var e=t.words,n=t.sigBytes,i=this._map;t.clamp();for(var r=[],s=0;s<n;s+=3)for(var o=(e[s>>>2]>>>24-s%4*8&255)<<16|(e[s+1>>>2]>>>24-(s+1)%4*8&255)<<8|e[s+2>>>2]>>>24-(s+2)%4*8&255,a=0;a<4&&s+.75*a<n;a++)r.push(i.charAt(o>>>6*(3-a)&63));var u=i.charAt(64);if(u)for(;r.length%4;)r.push(u);return r.join("")},parse:function(t){var e=t.length,n=this._map,i=this._reverseMap;if(!i){i=this._reverseMap=[];for(var r=0;r<n.length;r++)i[n.charCodeAt(r)]=r}var s=n.charAt(64);if(s){var o=t.indexOf(s);-1!==o&&(e=o)}return function(t,e,n){for(var i=[],r=0,s=0;s<e;s++)if(s%4){var o=n[t.charCodeAt(s-1)]<<s%4*2,a=n[t.charCodeAt(s)]>>>6-s%4*2;i[r>>>2]|=(o|a)<<24-r%4*8,r++}return f.create(i,r)}(t,e,i)},_map:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/="},function(l){var t=Ct,e=t.lib,n=e.WordArray,i=e.Hasher,r=t.algo,T=[];!function(){for(var t=0;t<64;t++)T[t]=4294967296*l.abs(l.sin(t+1))|0}();var s=r.MD5=i.extend({_doReset:function(){this._hash=new n.init([1732584193,4023233417,2562383102,271733878])},_doProcessBlock:function(t,e){for(var n=0;n<16;n++){var i=e+n,r=t[i];t[i]=16711935&(r<<8|r>>>24)|4278255360&(r<<24|r>>>8)}var s=this._hash.words,o=t[e+0],a=t[e+1],u=t[e+2],c=t[e+3],l=t[e+4],h=t[e+5],d=t[e+6],f=t[e+7],p=t[e+8],m=t[e+9],_=t[e+10],g=t[e+11],v=t[e+12],y=t[e+13],S=t[e+14],w=t[e+15],b=s[0],x=s[1],M=s[2],k=s[3];x=D(x=D(x=D(x=D(x=N(x=N(x=N(x=N(x=C(x=C(x=C(x=C(x=A(x=A(x=A(x=A(x,M=A(M,k=A(k,b=A(b,x,M,k,o,7,T[0]),x,M,a,12,T[1]),b,x,u,17,T[2]),k,b,c,22,T[3]),M=A(M,k=A(k,b=A(b,x,M,k,l,7,T[4]),x,M,h,12,T[5]),b,x,d,17,T[6]),k,b,f,22,T[7]),M=A(M,k=A(k,b=A(b,x,M,k,p,7,T[8]),x,M,m,12,T[9]),b,x,_,17,T[10]),k,b,g,22,T[11]),M=A(M,k=A(k,b=A(b,x,M,k,v,7,T[12]),x,M,y,12,T[13]),b,x,S,17,T[14]),k,b,w,22,T[15]),M=C(M,k=C(k,b=C(b,x,M,k,a,5,T[16]),x,M,d,9,T[17]),b,x,g,14,T[18]),k,b,o,20,T[19]),M=C(M,k=C(k,b=C(b,x,M,k,h,5,T[20]),x,M,_,9,T[21]),b,x,w,14,T[22]),k,b,l,20,T[23]),M=C(M,k=C(k,b=C(b,x,M,k,m,5,T[24]),x,M,S,9,T[25]),b,x,c,14,T[26]),k,b,p,20,T[27]),M=C(M,k=C(k,b=C(b,x,M,k,y,5,T[28]),x,M,u,9,T[29]),b,x,f,14,T[30]),k,b,v,20,T[31]),M=N(M,k=N(k,b=N(b,x,M,k,h,4,T[32]),x,M,p,11,T[33]),b,x,g,16,T[34]),k,b,S,23,T[35]),M=N(M,k=N(k,b=N(b,x,M,k,a,4,T[36]),x,M,l,11,T[37]),b,x,f,16,T[38]),k,b,_,23,T[39]),M=N(M,k=N(k,b=N(b,x,M,k,y,4,T[40]),x,M,o,11,T[41]),b,x,c,16,T[42]),k,b,d,23,T[43]),M=N(M,k=N(k,b=N(b,x,M,k,m,4,T[44]),x,M,v,11,T[45]),b,x,w,16,T[46]),k,b,u,23,T[47]),M=D(M,k=D(k,b=D(b,x,M,k,o,6,T[48]),x,M,f,10,T[49]),b,x,S,15,T[50]),k,b,h,21,T[51]),M=D(M,k=D(k,b=D(b,x,M,k,v,6,T[52]),x,M,c,10,T[53]),b,x,_,15,T[54]),k,b,a,21,T[55]),M=D(M,k=D(k,b=D(b,x,M,k,p,6,T[56]),x,M,w,10,T[57]),b,x,d,15,T[58]),k,b,y,21,T[59]),M=D(M,k=D(k,b=D(b,x,M,k,l,6,T[60]),x,M,g,10,T[61]),b,x,u,15,T[62]),k,b,m,21,T[63]),s[0]=s[0]+b|0,s[1]=s[1]+x|0,s[2]=s[2]+M|0,s[3]=s[3]+k|0},_doFinalize:function(){var t=this._data,e=t.words,n=8*this._nDataBytes,i=8*t.sigBytes;e[i>>>5]|=128<<24-i%32;var r=l.floor(n/4294967296),s=n;e[15+(i+64>>>9<<4)]=16711935&(r<<8|r>>>24)|4278255360&(r<<24|r>>>8),e[14+(i+64>>>9<<4)]=16711935&(s<<8|s>>>24)|4278255360&(s<<24|s>>>8),t.sigBytes=4*(e.length+1),this._process();for(var o=this._hash,a=o.words,u=0;u<4;u++){var c=a[u];a[u]=16711935&(c<<8|c>>>24)|4278255360&(c<<24|c>>>8)}return o},clone:function(){var t=i.clone.call(this);return t._hash=this._hash.clone(),t}});function A(t,e,n,i,r,s,o){var a=t+(e&n|~e&i)+r+o;return(a<<s|a>>>32-s)+e}function C(t,e,n,i,r,s,o){var a=t+(e&i|n&~i)+r+o;return(a<<s|a>>>32-s)+e}function N(t,e,n,i,r,s,o){var a=t+(e^n^i)+r+o;return(a<<s|a>>>32-s)+e}function D(t,e,n,i,r,s,o){var a=t+(n^(e|~i))+r+o;return(a<<s|a>>>32-s)+e}t.MD5=i._createHelper(s),t.HmacMD5=i._createHmacHelper(s)}(Math),m=(p=Ct).lib,_=m.WordArray,g=m.Hasher,v=p.algo,y=[],S=v.SHA1=g.extend({_doReset:function(){this._hash=new _.init([1732584193,4023233417,2562383102,271733878,3285377520])},_doProcessBlock:function(t,e){for(var n=this._hash.words,i=n[0],r=n[1],s=n[2],o=n[3],a=n[4],u=0;u<80;u++){if(u<16)y[u]=0|t[e+u];else{var c=y[u-3]^y[u-8]^y[u-14]^y[u-16];y[u]=c<<1|c>>>31}var l=(i<<5|i>>>27)+a+y[u];l+=u<20?1518500249+(r&s|~r&o):u<40?1859775393+(r^s^o):u<60?(r&s|r&o|s&o)-1894007588:(r^s^o)-899497514,a=o,o=s,s=r<<30|r>>>2,r=i,i=l}n[0]=n[0]+i|0,n[1]=n[1]+r|0,n[2]=n[2]+s|0,n[3]=n[3]+o|0,n[4]=n[4]+a|0},_doFinalize:function(){var t=this._data,e=t.words,n=8*this._nDataBytes,i=8*t.sigBytes;return e[i>>>5]|=128<<24-i%32,e[14+(i+64>>>9<<4)]=Math.floor(n/4294967296),e[15+(i+64>>>9<<4)]=n,t.sigBytes=4*e.length,this._process(),this._hash},clone:function(){var t=g.clone.call(this);return t._hash=this._hash.clone(),t}}),p.SHA1=g._createHelper(S),p.HmacSHA1=g._createHmacHelper(S),function(r){var t=Ct,e=t.lib,n=e.WordArray,i=e.Hasher,s=t.algo,o=[],y=[];!function(){function t(t){for(var e=r.sqrt(t),n=2;n<=e;n++)if(!(t%n))return!1;return!0}function e(t){return 4294967296*(t-(0|t))|0}for(var n=2,i=0;i<64;)t(n)&&(i<8&&(o[i]=e(r.pow(n,.5))),y[i]=e(r.pow(n,1/3)),i++),n++}();var S=[],a=s.SHA256=i.extend({_doReset:function(){this._hash=new n.init(o.slice(0))},_doProcessBlock:function(t,e){for(var n=this._hash.words,i=n[0],r=n[1],s=n[2],o=n[3],a=n[4],u=n[5],c=n[6],l=n[7],h=0;h<64;h++){if(h<16)S[h]=0|t[e+h];else{var d=S[h-15],f=(d<<25|d>>>7)^(d<<14|d>>>18)^d>>>3,p=S[h-2],m=(p<<15|p>>>17)^(p<<13|p>>>19)^p>>>10;S[h]=f+S[h-7]+m+S[h-16]}var _=i&r^i&s^r&s,g=(i<<30|i>>>2)^(i<<19|i>>>13)^(i<<10|i>>>22),v=l+((a<<26|a>>>6)^(a<<21|a>>>11)^(a<<7|a>>>25))+(a&u^~a&c)+y[h]+S[h];l=c,c=u,u=a,a=o+v|0,o=s,s=r,r=i,i=v+(g+_)|0}n[0]=n[0]+i|0,n[1]=n[1]+r|0,n[2]=n[2]+s|0,n[3]=n[3]+o|0,n[4]=n[4]+a|0,n[5]=n[5]+u|0,n[6]=n[6]+c|0,n[7]=n[7]+l|0},_doFinalize:function(){var t=this._data,e=t.words,n=8*this._nDataBytes,i=8*t.sigBytes;return e[i>>>5]|=128<<24-i%32,e[14+(i+64>>>9<<4)]=r.floor(n/4294967296),e[15+(i+64>>>9<<4)]=n,t.sigBytes=4*e.length,this._process(),this._hash},clone:function(){var t=i.clone.call(this);return t._hash=this._hash.clone(),t}});t.SHA256=i._createHelper(a),t.HmacSHA256=i._createHmacHelper(a)}(Math),function(){var t=Ct,r=t.lib.WordArray,e=t.enc;e.Utf16=e.Utf16BE={stringify:function(t){for(var e=t.words,n=t.sigBytes,i=[],r=0;r<n;r+=2){var s=e[r>>>2]>>>16-r%4*8&65535;i.push(String.fromCharCode(s))}return i.join("")},parse:function(t){for(var e=t.length,n=[],i=0;i<e;i++)n[i>>>1]|=t.charCodeAt(i)<<16-i%2*16;return r.create(n,2*e)}};function o(t){return t<<8&4278255360|t>>>8&16711935}e.Utf16LE={stringify:function(t){for(var e=t.words,n=t.sigBytes,i=[],r=0;r<n;r+=2){var s=o(e[r>>>2]>>>16-r%4*8&65535);i.push(String.fromCharCode(s))}return i.join("")},parse:function(t){for(var e=t.length,n=[],i=0;i<e;i++)n[i>>>1]|=o(t.charCodeAt(i)<<16-i%2*16);return r.create(n,2*e)}}}(),function(){if("function"==typeof ArrayBuffer){var t=Ct.lib.WordArray,r=t.init;(t.init=function(t){if(t instanceof ArrayBuffer&&(t=new Uint8Array(t)),(t instanceof Int8Array||"undefined"!=typeof Uint8ClampedArray&&t instanceof Uint8ClampedArray||t instanceof Int16Array||t instanceof Uint16Array||t instanceof Int32Array||t instanceof Uint32Array||t instanceof Float32Array||t instanceof Float64Array)&&(t=new Uint8Array(t.buffer,t.byteOffset,t.byteLength)),t instanceof Uint8Array){for(var e=t.byteLength,n=[],i=0;i<e;i++)n[i>>>2]|=t[i]<<24-i%4*8;r.call(this,n,e)}else r.apply(this,arguments)}).prototype=t}}(),function(t){var e=Ct,n=e.lib,i=n.WordArray,r=n.Hasher,s=e.algo,x=i.create([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,7,4,13,1,10,6,15,3,12,0,9,5,2,14,11,8,3,10,14,4,9,15,8,1,2,7,0,6,13,11,5,12,1,9,11,10,0,8,12,4,13,3,7,15,14,5,6,2,4,0,5,9,7,12,2,10,14,1,3,8,11,6,15,13]),M=i.create([5,14,7,0,9,2,11,4,13,6,15,8,1,10,3,12,6,11,3,7,0,13,5,10,14,15,8,12,4,9,1,2,15,5,1,3,7,14,6,9,11,8,12,2,10,0,4,13,8,6,4,1,3,11,15,0,5,12,2,13,9,7,10,14,12,15,10,4,1,5,8,7,6,2,13,14,0,3,9,11]),k=i.create([11,14,15,12,5,8,7,9,11,13,14,15,6,7,9,8,7,6,8,13,11,9,7,15,7,12,15,9,11,7,13,12,11,13,6,7,14,9,13,15,14,8,13,6,5,12,7,5,11,12,14,15,14,15,9,8,9,14,5,6,8,6,5,12,9,15,5,11,6,8,13,12,5,12,13,14,11,8,5,6]),T=i.create([8,9,9,11,13,15,15,5,7,7,8,11,14,14,12,6,9,13,15,7,12,8,9,11,7,7,12,7,6,15,13,11,9,7,15,11,8,6,6,14,12,13,5,14,13,13,7,5,15,5,8,11,14,14,6,14,6,9,12,9,12,5,15,8,8,5,12,9,12,5,14,6,8,13,6,5,15,13,11,11]),A=i.create([0,1518500249,1859775393,2400959708,2840853838]),C=i.create([1352829926,1548603684,1836072691,2053994217,0]),o=s.RIPEMD160=r.extend({_doReset:function(){this._hash=i.create([1732584193,4023233417,2562383102,271733878,3285377520])},_doProcessBlock:function(t,e){for(var n=0;n<16;n++){var i=e+n,r=t[i];t[i]=16711935&(r<<8|r>>>24)|4278255360&(r<<24|r>>>8)}var s,o,a,u,c,l,h,d,f,p,m,_=this._hash.words,g=A.words,v=C.words,y=x.words,S=M.words,w=k.words,b=T.words;l=s=_[0],h=o=_[1],d=a=_[2],f=u=_[3],p=c=_[4];for(n=0;n<80;n+=1)m=s+t[e+y[n]]|0,m+=n<16?N(o,a,u)+g[0]:n<32?D(o,a,u)+g[1]:n<48?O(o,a,u)+g[2]:n<64?H(o,a,u)+g[3]:L(o,a,u)+g[4],m=(m=E(m|=0,w[n]))+c|0,s=c,c=u,u=E(a,10),a=o,o=m,m=l+t[e+S[n]]|0,m+=n<16?L(h,d,f)+v[0]:n<32?H(h,d,f)+v[1]:n<48?O(h,d,f)+v[2]:n<64?D(h,d,f)+v[3]:N(h,d,f)+v[4],m=(m=E(m|=0,b[n]))+p|0,l=p,p=f,f=E(d,10),d=h,h=m;m=_[1]+a+f|0,_[1]=_[2]+u+p|0,_[2]=_[3]+c+l|0,_[3]=_[4]+s+h|0,_[4]=_[0]+o+d|0,_[0]=m},_doFinalize:function(){var t=this._data,e=t.words,n=8*this._nDataBytes,i=8*t.sigBytes;e[i>>>5]|=128<<24-i%32,e[14+(i+64>>>9<<4)]=16711935&(n<<8|n>>>24)|4278255360&(n<<24|n>>>8),t.sigBytes=4*(e.length+1),this._process();for(var r=this._hash,s=r.words,o=0;o<5;o++){var a=s[o];s[o]=16711935&(a<<8|a>>>24)|4278255360&(a<<24|a>>>8)}return r},clone:function(){var t=r.clone.call(this);return t._hash=this._hash.clone(),t}});function N(t,e,n){return t^e^n}function D(t,e,n){return t&e|~t&n}function O(t,e,n){return(t|~e)^n}function H(t,e,n){return t&n|e&~n}function L(t,e,n){return t^(e|~n)}function E(t,e){return t<<e|t>>>32-e}e.RIPEMD160=r._createHelper(o),e.HmacRIPEMD160=r._createHmacHelper(o)}(Math),b=(w=Ct).lib.Base,x=w.enc.Utf8,w.algo.HMAC=b.extend({init:function(t,e){t=this._hasher=new t.init,"string"==typeof e&&(e=x.parse(e));var n=t.blockSize,i=4*n;e.sigBytes>i&&(e=t.finalize(e)),e.clamp();for(var r=this._oKey=e.clone(),s=this._iKey=e.clone(),o=r.words,a=s.words,u=0;u<n;u++)o[u]^=1549556828,a[u]^=909522486;r.sigBytes=s.sigBytes=i,this.reset()},reset:function(){var t=this._hasher;t.reset(),t.update(this._iKey)},update:function(t){return this._hasher.update(t),this},finalize:function(t){var e=this._hasher,n=e.finalize(t);return e.reset(),e.finalize(this._oKey.clone().concat(n))}}),k=(M=Ct).lib,T=k.Base,A=k.WordArray,C=M.algo,N=C.SHA1,D=C.HMAC,O=C.PBKDF2=T.extend({cfg:T.extend({keySize:4,hasher:N,iterations:1}),init:function(t){this.cfg=this.cfg.extend(t)},compute:function(t,e){for(var n=this.cfg,i=D.create(n.hasher,t),r=A.create(),s=A.create([1]),o=r.words,a=s.words,u=n.keySize,c=n.iterations;o.length<u;){var l=i.update(e).finalize(s);i.reset();for(var h=l.words,d=h.length,f=l,p=1;p<c;p++){f=i.finalize(f),i.reset();for(var m=f.words,_=0;_<d;_++)h[_]^=m[_]}r.concat(l),a[0]++}return r.sigBytes=4*u,r}}),M.PBKDF2=function(t,e,n){return O.create(n).compute(t,e)},L=(H=Ct).lib,E=L.Base,R=L.WordArray,I=H.algo,B=I.MD5,q=I.EvpKDF=E.extend({cfg:E.extend({keySize:4,hasher:B,iterations:1}),init:function(t){this.cfg=this.cfg.extend(t)},compute:function(t,e){for(var n=this.cfg,i=n.hasher.create(),r=R.create(),s=r.words,o=n.keySize,a=n.iterations;s.length<o;){u&&i.update(u);var u=i.update(t).finalize(e);i.reset();for(var c=1;c<a;c++)u=i.finalize(u),i.reset();r.concat(u)}return r.sigBytes=4*o,r}}),H.EvpKDF=function(t,e,n){return q.create(n).compute(t,e)},j=(F=Ct).lib.WordArray,P=F.algo,Y=P.SHA256,z=P.SHA224=Y.extend({_doReset:function(){this._hash=new j.init([3238371032,914150663,812702999,4144912697,4290775857,1750603025,1694076839,3204075428])},_doFinalize:function(){var t=Y._doFinalize.call(this);return t.sigBytes-=4,t}}),F.SHA224=Y._createHelper(z),F.HmacSHA224=Y._createHmacHelper(z),U=(W=Ct).lib,X=U.Base,$=U.WordArray,(G=W.x64={}).Word=X.extend({init:function(t,e){this.high=t,this.low=e}}),G.WordArray=X.extend({init:function(t,e){t=this.words=t||[],this.sigBytes=null!=e?e:8*t.length},toX32:function(){for(var t=this.words,e=t.length,n=[],i=0;i<e;i++){var r=t[i];n.push(r.high),n.push(r.low)}return $.create(n,this.sigBytes)},clone:function(){for(var t=X.clone.call(this),e=t.words=this.words.slice(0),n=e.length,i=0;i<n;i++)e[i]=e[i].clone();return t}}),function(d){var t=Ct,e=t.lib,f=e.WordArray,i=e.Hasher,l=t.x64.Word,n=t.algo,N=[],D=[],O=[];!function(){for(var t=1,e=0,n=0;n<24;n++){N[t+5*e]=(n+1)*(n+2)/2%64;var i=(2*t+3*e)%5;t=e%5,e=i}for(t=0;t<5;t++)for(e=0;e<5;e++)D[t+5*e]=e+(2*t+3*e)%5*5;for(var r=1,s=0;s<24;s++){for(var o=0,a=0,u=0;u<7;u++){if(1&r){var c=(1<<u)-1;c<32?a^=1<<c:o^=1<<c-32}128&r?r=r<<1^113:r<<=1}O[s]=l.create(o,a)}}();var H=[];!function(){for(var t=0;t<25;t++)H[t]=l.create()}();var r=n.SHA3=i.extend({cfg:i.cfg.extend({outputLength:512}),_doReset:function(){for(var t=this._state=[],e=0;e<25;e++)t[e]=new l.init;this.blockSize=(1600-2*this.cfg.outputLength)/32},_doProcessBlock:function(t,e){for(var n=this._state,i=this.blockSize/2,r=0;r<i;r++){var s=t[e+2*r],o=t[e+2*r+1];s=16711935&(s<<8|s>>>24)|4278255360&(s<<24|s>>>8),o=16711935&(o<<8|o>>>24)|4278255360&(o<<24|o>>>8),(M=n[r]).high^=o,M.low^=s}for(var a=0;a<24;a++){for(var u=0;u<5;u++){for(var c=0,l=0,h=0;h<5;h++){c^=(M=n[u+5*h]).high,l^=M.low}var d=H[u];d.high=c,d.low=l}for(u=0;u<5;u++){var f=H[(u+4)%5],p=H[(u+1)%5],m=p.high,_=p.low;for(c=f.high^(m<<1|_>>>31),l=f.low^(_<<1|m>>>31),h=0;h<5;h++){(M=n[u+5*h]).high^=c,M.low^=l}}for(var g=1;g<25;g++){var v=(M=n[g]).high,y=M.low,S=N[g];if(S<32)c=v<<S|y>>>32-S,l=y<<S|v>>>32-S;else c=y<<S-32|v>>>64-S,l=v<<S-32|y>>>64-S;var w=H[D[g]];w.high=c,w.low=l}var b=H[0],x=n[0];b.high=x.high,b.low=x.low;for(u=0;u<5;u++)for(h=0;h<5;h++){var M=n[g=u+5*h],k=H[g],T=H[(u+1)%5+5*h],A=H[(u+2)%5+5*h];M.high=k.high^~T.high&A.high,M.low=k.low^~T.low&A.low}M=n[0];var C=O[a];M.high^=C.high,M.low^=C.low}},_doFinalize:function(){var t=this._data,e=t.words,n=(this._nDataBytes,8*t.sigBytes),i=32*this.blockSize;e[n>>>5]|=1<<24-n%32,e[(d.ceil((n+1)/i)*i>>>5)-1]|=128,t.sigBytes=4*e.length,this._process();for(var r=this._state,s=this.cfg.outputLength/8,o=s/8,a=[],u=0;u<o;u++){var c=r[u],l=c.high,h=c.low;l=16711935&(l<<8|l>>>24)|4278255360&(l<<24|l>>>8),h=16711935&(h<<8|h>>>24)|4278255360&(h<<24|h>>>8),a.push(h),a.push(l)}return new f.init(a,s)},clone:function(){for(var t=i.clone.call(this),e=t._state=this._state.slice(0),n=0;n<25;n++)e[n]=e[n].clone();return t}});t.SHA3=i._createHelper(r),t.HmacSHA3=i._createHmacHelper(r)}(Math),function(){var t=Ct,e=t.lib.Hasher,n=t.x64,i=n.Word,r=n.WordArray,s=t.algo;function o(){return i.create.apply(i,arguments)}var xt=[o(1116352408,3609767458),o(1899447441,602891725),o(3049323471,3964484399),o(3921009573,2173295548),o(961987163,4081628472),o(1508970993,3053834265),o(2453635748,2937671579),o(2870763221,3664609560),o(3624381080,2734883394),o(310598401,1164996542),o(607225278,1323610764),o(1426881987,3590304994),o(1925078388,4068182383),o(2162078206,991336113),o(2614888103,633803317),o(3248222580,3479774868),o(3835390401,2666613458),o(4022224774,944711139),o(264347078,2341262773),o(604807628,2007800933),o(770255983,1495990901),o(1249150122,1856431235),o(1555081692,3175218132),o(1996064986,2198950837),o(2554220882,3999719339),o(2821834349,766784016),o(2952996808,2566594879),o(3210313671,3203337956),o(3336571891,1034457026),o(3584528711,2466948901),o(113926993,3758326383),o(338241895,168717936),o(666307205,1188179964),o(773529912,1546045734),o(1294757372,1522805485),o(1396182291,2643833823),o(1695183700,2343527390),o(1986661051,1014477480),o(2177026350,1206759142),o(2456956037,344077627),o(2730485921,1290863460),o(2820302411,3158454273),o(3259730800,3505952657),o(3345764771,106217008),o(3516065817,3606008344),o(3600352804,1432725776),o(4094571909,1467031594),o(275423344,851169720),o(430227734,3100823752),o(506948616,1363258195),o(659060556,3750685593),o(883997877,3785050280),o(958139571,3318307427),o(1322822218,3812723403),o(1537002063,2003034995),o(1747873779,3602036899),o(1955562222,1575990012),o(2024104815,1125592928),o(2227730452,2716904306),o(2361852424,442776044),o(2428436474,593698344),o(2756734187,3733110249),o(3204031479,2999351573),o(3329325298,3815920427),o(3391569614,3928383900),o(3515267271,566280711),o(3940187606,3454069534),o(4118630271,4000239992),o(116418474,1914138554),o(174292421,2731055270),o(289380356,3203993006),o(460393269,320620315),o(685471733,587496836),o(852142971,1086792851),o(1017036298,365543100),o(1126000580,2618297676),o(1288033470,3409855158),o(1501505948,4234509866),o(1607167915,987167468),o(1816402316,1246189591)],Mt=[];!function(){for(var t=0;t<80;t++)Mt[t]=o()}();var a=s.SHA512=e.extend({_doReset:function(){this._hash=new r.init([new i.init(1779033703,4089235720),new i.init(3144134277,2227873595),new i.init(1013904242,4271175723),new i.init(2773480762,1595750129),new i.init(1359893119,2917565137),new i.init(2600822924,725511199),new i.init(528734635,4215389547),new i.init(1541459225,327033209)])},_doProcessBlock:function(t,e){for(var n=this._hash.words,i=n[0],r=n[1],s=n[2],o=n[3],a=n[4],u=n[5],c=n[6],l=n[7],h=i.high,d=i.low,f=r.high,p=r.low,m=s.high,_=s.low,g=o.high,v=o.low,y=a.high,S=a.low,w=u.high,b=u.low,x=c.high,M=c.low,k=l.high,T=l.low,A=h,C=d,N=f,D=p,O=m,H=_,L=g,E=v,R=y,I=S,B=w,q=b,F=x,j=M,P=k,Y=T,z=0;z<80;z++){var W=Mt[z];if(z<16)var U=W.high=0|t[e+2*z],X=W.low=0|t[e+2*z+1];else{var $=Mt[z-15],G=$.high,J=$.low,V=(G>>>1|J<<31)^(G>>>8|J<<24)^G>>>7,Q=(J>>>1|G<<31)^(J>>>8|G<<24)^(J>>>7|G<<25),Z=Mt[z-2],K=Z.high,tt=Z.low,et=(K>>>19|tt<<13)^(K<<3|tt>>>29)^K>>>6,nt=(tt>>>19|K<<13)^(tt<<3|K>>>29)^(tt>>>6|K<<26),it=Mt[z-7],rt=it.high,st=it.low,ot=Mt[z-16],at=ot.high,ut=ot.low;U=(U=(U=V+rt+((X=Q+st)>>>0<Q>>>0?1:0))+et+((X=X+nt)>>>0<nt>>>0?1:0))+at+((X=X+ut)>>>0<ut>>>0?1:0);W.high=U,W.low=X}var ct,lt=R&B^~R&F,ht=I&q^~I&j,dt=A&N^A&O^N&O,ft=C&D^C&H^D&H,pt=(A>>>28|C<<4)^(A<<30|C>>>2)^(A<<25|C>>>7),mt=(C>>>28|A<<4)^(C<<30|A>>>2)^(C<<25|A>>>7),_t=(R>>>14|I<<18)^(R>>>18|I<<14)^(R<<23|I>>>9),gt=(I>>>14|R<<18)^(I>>>18|R<<14)^(I<<23|R>>>9),vt=xt[z],yt=vt.high,St=vt.low,wt=P+_t+((ct=Y+gt)>>>0<Y>>>0?1:0),bt=mt+ft;P=F,Y=j,F=B,j=q,B=R,q=I,R=L+(wt=(wt=(wt=wt+lt+((ct=ct+ht)>>>0<ht>>>0?1:0))+yt+((ct=ct+St)>>>0<St>>>0?1:0))+U+((ct=ct+X)>>>0<X>>>0?1:0))+((I=E+ct|0)>>>0<E>>>0?1:0)|0,L=O,E=H,O=N,H=D,N=A,D=C,A=wt+(pt+dt+(bt>>>0<mt>>>0?1:0))+((C=ct+bt|0)>>>0<ct>>>0?1:0)|0}d=i.low=d+C,i.high=h+A+(d>>>0<C>>>0?1:0),p=r.low=p+D,r.high=f+N+(p>>>0<D>>>0?1:0),_=s.low=_+H,s.high=m+O+(_>>>0<H>>>0?1:0),v=o.low=v+E,o.high=g+L+(v>>>0<E>>>0?1:0),S=a.low=S+I,a.high=y+R+(S>>>0<I>>>0?1:0),b=u.low=b+q,u.high=w+B+(b>>>0<q>>>0?1:0),M=c.low=M+j,c.high=x+F+(M>>>0<j>>>0?1:0),T=l.low=T+Y,l.high=k+P+(T>>>0<Y>>>0?1:0)},_doFinalize:function(){var t=this._data,e=t.words,n=8*this._nDataBytes,i=8*t.sigBytes;return e[i>>>5]|=128<<24-i%32,e[30+(i+128>>>10<<5)]=Math.floor(n/4294967296),e[31+(i+128>>>10<<5)]=n,t.sigBytes=4*e.length,this._process(),this._hash.toX32()},clone:function(){var t=e.clone.call(this);return t._hash=this._hash.clone(),t},blockSize:32});t.SHA512=e._createHelper(a),t.HmacSHA512=e._createHmacHelper(a)}(),V=(J=Ct).x64,Q=V.Word,Z=V.WordArray,K=J.algo,tt=K.SHA512,et=K.SHA384=tt.extend({_doReset:function(){this._hash=new Z.init([new Q.init(3418070365,3238371032),new Q.init(1654270250,914150663),new Q.init(2438529370,812702999),new Q.init(355462360,4144912697),new Q.init(1731405415,4290775857),new Q.init(2394180231,1750603025),new Q.init(3675008525,1694076839),new Q.init(1203062813,3204075428)])},_doFinalize:function(){var t=tt._doFinalize.call(this);return t.sigBytes-=16,t}}),J.SHA384=tt._createHelper(et),J.HmacSHA384=tt._createHmacHelper(et),Ct.lib.Cipher||(it=(nt=Ct).lib,rt=it.Base,st=it.WordArray,ot=it.BufferedBlockAlgorithm,(at=nt.enc).Utf8,ut=at.Base64,ct=nt.algo.EvpKDF,lt=it.Cipher=ot.extend({cfg:rt.extend(),createEncryptor:function(t,e){return this.create(this._ENC_XFORM_MODE,t,e)},createDecryptor:function(t,e){return this.create(this._DEC_XFORM_MODE,t,e)},init:function(t,e,n){this.cfg=this.cfg.extend(n),this._xformMode=t,this._key=e,this.reset()},reset:function(){ot.reset.call(this),this._doReset()},process:function(t){return this._append(t),this._process()},finalize:function(t){return t&&this._append(t),this._doFinalize()},keySize:4,ivSize:4,_ENC_XFORM_MODE:1,_DEC_XFORM_MODE:2,_createHelper:function(){function r(t){return"string"==typeof t?yt:gt}return function(i){return{encrypt:function(t,e,n){return r(e).encrypt(i,t,e,n)},decrypt:function(t,e,n){return r(e).decrypt(i,t,e,n)}}}}()}),it.StreamCipher=lt.extend({_doFinalize:function(){return this._process(!0)},blockSize:1}),ht=nt.mode={},dt=it.BlockCipherMode=rt.extend({createEncryptor:function(t,e){return this.Encryptor.create(t,e)},createDecryptor:function(t,e){return this.Decryptor.create(t,e)},init:function(t,e){this._cipher=t,this._iv=e}}),ft=ht.CBC=function(){var t=dt.extend();function s(t,e,n){var i=this._iv;if(i){var r=i;this._iv=void 0}else r=this._prevBlock;for(var s=0;s<n;s++)t[e+s]^=r[s]}return t.Encryptor=t.extend({processBlock:function(t,e){var n=this._cipher,i=n.blockSize;s.call(this,t,e,i),n.encryptBlock(t,e),this._prevBlock=t.slice(e,e+i)}}),t.Decryptor=t.extend({processBlock:function(t,e){var n=this._cipher,i=n.blockSize,r=t.slice(e,e+i);n.decryptBlock(t,e),s.call(this,t,e,i),this._prevBlock=r}}),t}(),pt=(nt.pad={}).Pkcs7={pad:function(t,e){for(var n=4*e,i=n-t.sigBytes%n,r=i<<24|i<<16|i<<8|i,s=[],o=0;o<i;o+=4)s.push(r);var a=st.create(s,i);t.concat(a)},unpad:function(t){var e=255&t.words[t.sigBytes-1>>>2];t.sigBytes-=e}},it.BlockCipher=lt.extend({cfg:lt.cfg.extend({mode:ft,padding:pt}),reset:function(){lt.reset.call(this);var t=this.cfg,e=t.iv,n=t.mode;if(this._xformMode==this._ENC_XFORM_MODE)var i=n.createEncryptor;else{i=n.createDecryptor;this._minBufferSize=1}this._mode&&this._mode.__creator==i?this._mode.init(this,e&&e.words):(this._mode=i.call(n,this,e&&e.words),this._mode.__creator=i)},_doProcessBlock:function(t,e){this._mode.processBlock(t,e)},_doFinalize:function(){var t=this.cfg.padding;if(this._xformMode==this._ENC_XFORM_MODE){t.pad(this._data,this.blockSize);var e=this._process(!0)}else{e=this._process(!0);t.unpad(e)}return e},blockSize:4}),mt=it.CipherParams=rt.extend({init:function(t){this.mixIn(t)},toString:function(t){return(t||this.formatter).stringify(this)}}),_t=(nt.format={}).OpenSSL={stringify:function(t){var e=t.ciphertext,n=t.salt;if(n)var i=st.create([1398893684,1701076831]).concat(n).concat(e);else i=e;return i.toString(ut)},parse:function(t){var e=ut.parse(t),n=e.words;if(1398893684==n[0]&&1701076831==n[1]){var i=st.create(n.slice(2,4));n.splice(0,4),e.sigBytes-=16}return mt.create({ciphertext:e,salt:i})}},gt=it.SerializableCipher=rt.extend({cfg:rt.extend({format:_t}),encrypt:function(t,e,n,i){i=this.cfg.extend(i);var r=t.createEncryptor(n,i),s=r.finalize(e),o=r.cfg;return mt.create({ciphertext:s,key:n,iv:o.iv,algorithm:t,mode:o.mode,padding:o.padding,blockSize:t.blockSize,formatter:i.format})},decrypt:function(t,e,n,i){return i=this.cfg.extend(i),e=this._parse(e,i.format),t.createDecryptor(n,i).finalize(e.ciphertext)},_parse:function(t,e){return"string"==typeof t?e.parse(t,this):t}}),vt=(nt.kdf={}).OpenSSL={execute:function(t,e,n,i){i||(i=st.random(8));var r=ct.create({keySize:e+n}).compute(t,i),s=st.create(r.words.slice(e),4*n);return r.sigBytes=4*e,mt.create({key:r,iv:s,salt:i})}},yt=it.PasswordBasedCipher=gt.extend({cfg:gt.cfg.extend({kdf:vt}),encrypt:function(t,e,n,i){var r=(i=this.cfg.extend(i)).kdf.execute(n,t.keySize,t.ivSize);i.iv=r.iv;var s=gt.encrypt.call(this,t,e,r.key,i);return s.mixIn(r),s},decrypt:function(t,e,n,i){i=this.cfg.extend(i),e=this._parse(e,i.format);var r=i.kdf.execute(n,t.keySize,t.ivSize,e.salt);return i.iv=r.iv,gt.decrypt.call(this,t,e,r.key,i)}})),Ct.mode.CFB=function(){var t=Ct.lib.BlockCipherMode.extend();function s(t,e,n,i){var r=this._iv;if(r){var s=r.slice(0);this._iv=void 0}else s=this._prevBlock;i.encryptBlock(s,0);for(var o=0;o<n;o++)t[e+o]^=s[o]}return t.Encryptor=t.extend({processBlock:function(t,e){var n=this._cipher,i=n.blockSize;s.call(this,t,e,i,n),this._prevBlock=t.slice(e,e+i)}}),t.Decryptor=t.extend({processBlock:function(t,e){var n=this._cipher,i=n.blockSize,r=t.slice(e,e+i);s.call(this,t,e,i,n),this._prevBlock=r}}),t}(),Ct.mode.ECB=((St=Ct.lib.BlockCipherMode.extend()).Encryptor=St.extend({processBlock:function(t,e){this._cipher.encryptBlock(t,e)}}),St.Decryptor=St.extend({processBlock:function(t,e){this._cipher.decryptBlock(t,e)}}),St),Ct.pad.AnsiX923={pad:function(t,e){var n=t.sigBytes,i=4*e,r=i-n%i,s=n+r-1;t.clamp(),t.words[s>>>2]|=r<<24-s%4*8,t.sigBytes+=r},unpad:function(t){var e=255&t.words[t.sigBytes-1>>>2];t.sigBytes-=e}},Ct.pad.Iso10126={pad:function(t,e){var n=4*e,i=n-t.sigBytes%n;t.concat(Ct.lib.WordArray.random(i-1)).concat(Ct.lib.WordArray.create([i<<24],1))},unpad:function(t){var e=255&t.words[t.sigBytes-1>>>2];t.sigBytes-=e}},Ct.pad.Iso97971={pad:function(t,e){t.concat(Ct.lib.WordArray.create([2147483648],1)),Ct.pad.ZeroPadding.pad(t,e)},unpad:function(t){Ct.pad.ZeroPadding.unpad(t),t.sigBytes--}},Ct.mode.OFB=(wt=Ct.lib.BlockCipherMode.extend(),bt=wt.Encryptor=wt.extend({processBlock:function(t,e){var n=this._cipher,i=n.blockSize,r=this._iv,s=this._keystream;r&&(s=this._keystream=r.slice(0),this._iv=void 0),n.encryptBlock(s,0);for(var o=0;o<i;o++)t[e+o]^=s[o]}}),wt.Decryptor=bt,wt),Ct.pad.NoPadding={pad:function(){},unpad:function(){}},Mt=(xt=Ct).lib.CipherParams,kt=xt.enc.Hex,xt.format.Hex={stringify:function(t){return t.ciphertext.toString(kt)},parse:function(t){var e=kt.parse(t);return Mt.create({ciphertext:e})}},function(){var t=Ct,e=t.lib.BlockCipher,n=t.algo,c=[],l=[],h=[],d=[],f=[],p=[],m=[],_=[],g=[],v=[];!function(){for(var t=[],e=0;e<256;e++)t[e]=e<128?e<<1:e<<1^283;var n=0,i=0;for(e=0;e<256;e++){var r=i^i<<1^i<<2^i<<3^i<<4;r=r>>>8^255&r^99,c[n]=r;var s=t[l[r]=n],o=t[s],a=t[o],u=257*t[r]^16843008*r;h[n]=u<<24|u>>>8,d[n]=u<<16|u>>>16,f[n]=u<<8|u>>>24,p[n]=u;u=16843009*a^65537*o^257*s^16843008*n;m[r]=u<<24|u>>>8,_[r]=u<<16|u>>>16,g[r]=u<<8|u>>>24,v[r]=u,n?(n=s^t[t[t[a^s]]],i^=t[t[i]]):n=i=1}}();var y=[0,1,2,4,8,16,32,64,128,27,54],i=n.AES=e.extend({_doReset:function(){if(!this._nRounds||this._keyPriorReset!==this._key){for(var t=this._keyPriorReset=this._key,e=t.words,n=t.sigBytes/4,i=4*((this._nRounds=n+6)+1),r=this._keySchedule=[],s=0;s<i;s++)if(s<n)r[s]=e[s];else{var o=r[s-1];s%n?6<n&&s%n==4&&(o=c[o>>>24]<<24|c[o>>>16&255]<<16|c[o>>>8&255]<<8|c[255&o]):(o=c[(o=o<<8|o>>>24)>>>24]<<24|c[o>>>16&255]<<16|c[o>>>8&255]<<8|c[255&o],o^=y[s/n|0]<<24),r[s]=r[s-n]^o}for(var a=this._invKeySchedule=[],u=0;u<i;u++){s=i-u;if(u%4)o=r[s];else o=r[s-4];a[u]=u<4||s<=4?o:m[c[o>>>24]]^_[c[o>>>16&255]]^g[c[o>>>8&255]]^v[c[255&o]]}}},encryptBlock:function(t,e){this._doCryptBlock(t,e,this._keySchedule,h,d,f,p,c)},decryptBlock:function(t,e){var n=t[e+1];t[e+1]=t[e+3],t[e+3]=n,this._doCryptBlock(t,e,this._invKeySchedule,m,_,g,v,l);n=t[e+1];t[e+1]=t[e+3],t[e+3]=n},_doCryptBlock:function(t,e,n,i,r,s,o,a){for(var u=this._nRounds,c=t[e]^n[0],l=t[e+1]^n[1],h=t[e+2]^n[2],d=t[e+3]^n[3],f=4,p=1;p<u;p++){var m=i[c>>>24]^r[l>>>16&255]^s[h>>>8&255]^o[255&d]^n[f++],_=i[l>>>24]^r[h>>>16&255]^s[d>>>8&255]^o[255&c]^n[f++],g=i[h>>>24]^r[d>>>16&255]^s[c>>>8&255]^o[255&l]^n[f++],v=i[d>>>24]^r[c>>>16&255]^s[l>>>8&255]^o[255&h]^n[f++];c=m,l=_,h=g,d=v}m=(a[c>>>24]<<24|a[l>>>16&255]<<16|a[h>>>8&255]<<8|a[255&d])^n[f++],_=(a[l>>>24]<<24|a[h>>>16&255]<<16|a[d>>>8&255]<<8|a[255&c])^n[f++],g=(a[h>>>24]<<24|a[d>>>16&255]<<16|a[c>>>8&255]<<8|a[255&l])^n[f++],v=(a[d>>>24]<<24|a[c>>>16&255]<<16|a[l>>>8&255]<<8|a[255&h])^n[f++];t[e]=m,t[e+1]=_,t[e+2]=g,t[e+3]=v},keySize:8});t.AES=e._createHelper(i)}(),function(){var t=Ct,e=t.lib,n=e.WordArray,i=e.BlockCipher,r=t.algo,c=[57,49,41,33,25,17,9,1,58,50,42,34,26,18,10,2,59,51,43,35,27,19,11,3,60,52,44,36,63,55,47,39,31,23,15,7,62,54,46,38,30,22,14,6,61,53,45,37,29,21,13,5,28,20,12,4],l=[14,17,11,24,1,5,3,28,15,6,21,10,23,19,12,4,26,8,16,7,27,20,13,2,41,52,31,37,47,55,30,40,51,45,33,48,44,49,39,56,34,53,46,42,50,36,29,32],h=[1,2,4,6,8,10,12,14,15,17,19,21,23,25,27,28],d=[{0:8421888,268435456:32768,536870912:8421378,805306368:2,1073741824:512,1342177280:8421890,1610612736:8389122,1879048192:8388608,2147483648:514,2415919104:8389120,2684354560:33280,2952790016:8421376,3221225472:32770,3489660928:8388610,3758096384:0,4026531840:33282,134217728:0,402653184:8421890,671088640:33282,939524096:32768,1207959552:8421888,1476395008:512,1744830464:8421378,2013265920:2,2281701376:8389120,2550136832:33280,2818572288:8421376,3087007744:8389122,3355443200:8388610,3623878656:32770,3892314112:514,4160749568:8388608,1:32768,268435457:2,536870913:8421888,805306369:8388608,1073741825:8421378,1342177281:33280,1610612737:512,1879048193:8389122,2147483649:8421890,2415919105:8421376,2684354561:8388610,2952790017:33282,3221225473:514,3489660929:8389120,3758096385:32770,4026531841:0,134217729:8421890,402653185:8421376,671088641:8388608,939524097:512,1207959553:32768,1476395009:8388610,1744830465:2,2013265921:33282,2281701377:32770,2550136833:8389122,2818572289:514,3087007745:8421888,3355443201:8389120,3623878657:0,3892314113:33280,4160749569:8421378},{0:1074282512,16777216:16384,33554432:524288,50331648:1074266128,67108864:1073741840,83886080:1074282496,100663296:1073758208,117440512:16,134217728:540672,150994944:1073758224,167772160:1073741824,184549376:540688,201326592:524304,218103808:0,234881024:16400,251658240:1074266112,8388608:1073758208,25165824:540688,41943040:16,58720256:1073758224,75497472:1074282512,92274688:1073741824,109051904:524288,125829120:1074266128,142606336:524304,159383552:0,176160768:16384,192937984:1074266112,209715200:1073741840,226492416:540672,243269632:1074282496,260046848:16400,268435456:0,285212672:1074266128,301989888:1073758224,318767104:1074282496,335544320:1074266112,352321536:16,369098752:540688,385875968:16384,402653184:16400,419430400:524288,436207616:524304,452984832:1073741840,469762048:540672,486539264:1073758208,503316480:1073741824,520093696:1074282512,276824064:540688,293601280:524288,310378496:1074266112,327155712:16384,343932928:1073758208,360710144:1074282512,377487360:16,394264576:1073741824,411041792:1074282496,427819008:1073741840,444596224:1073758224,461373440:524304,478150656:0,494927872:16400,511705088:1074266128,528482304:540672},{0:260,1048576:0,2097152:67109120,3145728:65796,4194304:65540,5242880:67108868,6291456:67174660,7340032:67174400,8388608:67108864,9437184:67174656,10485760:65792,11534336:67174404,12582912:67109124,13631488:65536,14680064:4,15728640:256,524288:67174656,1572864:67174404,2621440:0,3670016:67109120,4718592:67108868,5767168:65536,6815744:65540,7864320:260,8912896:4,9961472:256,11010048:67174400,12058624:65796,13107200:65792,14155776:67109124,15204352:67174660,16252928:67108864,16777216:67174656,17825792:65540,18874368:65536,19922944:67109120,20971520:256,22020096:67174660,23068672:67108868,24117248:0,25165824:67109124,26214400:67108864,27262976:4,28311552:65792,29360128:67174400,30408704:260,31457280:65796,32505856:67174404,17301504:67108864,18350080:260,19398656:67174656,20447232:0,21495808:65540,22544384:67109120,23592960:256,24641536:67174404,25690112:65536,26738688:67174660,27787264:65796,28835840:67108868,29884416:67109124,30932992:67174400,31981568:4,33030144:65792},{0:2151682048,65536:2147487808,131072:4198464,196608:2151677952,262144:0,327680:4198400,393216:2147483712,458752:4194368,524288:2147483648,589824:4194304,655360:64,720896:2147487744,786432:2151678016,851968:4160,917504:4096,983040:2151682112,32768:2147487808,98304:64,163840:2151678016,229376:2147487744,294912:4198400,360448:2151682112,425984:0,491520:2151677952,557056:4096,622592:2151682048,688128:4194304,753664:4160,819200:2147483648,884736:4194368,950272:4198464,1015808:2147483712,1048576:4194368,1114112:4198400,1179648:2147483712,1245184:0,1310720:4160,1376256:2151678016,1441792:2151682048,1507328:2147487808,1572864:2151682112,1638400:2147483648,1703936:2151677952,1769472:4198464,1835008:2147487744,1900544:4194304,1966080:64,2031616:4096,1081344:2151677952,1146880:2151682112,1212416:0,1277952:4198400,1343488:4194368,1409024:2147483648,1474560:2147487808,1540096:64,1605632:2147483712,1671168:4096,1736704:2147487744,1802240:2151678016,1867776:4160,1933312:2151682048,1998848:4194304,2064384:4198464},{0:128,4096:17039360,8192:262144,12288:536870912,16384:537133184,20480:16777344,24576:553648256,28672:262272,32768:16777216,36864:537133056,40960:536871040,45056:553910400,49152:553910272,53248:0,57344:17039488,61440:553648128,2048:17039488,6144:553648256,10240:128,14336:17039360,18432:262144,22528:537133184,26624:553910272,30720:536870912,34816:537133056,38912:0,43008:553910400,47104:16777344,51200:536871040,55296:553648128,59392:16777216,63488:262272,65536:262144,69632:128,73728:536870912,77824:553648256,81920:16777344,86016:553910272,90112:537133184,94208:16777216,98304:553910400,102400:553648128,106496:17039360,110592:537133056,114688:262272,118784:536871040,122880:0,126976:17039488,67584:553648256,71680:16777216,75776:17039360,79872:537133184,83968:536870912,88064:17039488,92160:128,96256:553910272,100352:262272,104448:553910400,108544:0,112640:553648128,116736:16777344,120832:262144,124928:537133056,129024:536871040},{0:268435464,256:8192,512:270532608,768:270540808,1024:268443648,1280:2097152,1536:2097160,1792:268435456,2048:0,2304:268443656,2560:2105344,2816:8,3072:270532616,3328:2105352,3584:8200,3840:270540800,128:270532608,384:270540808,640:8,896:2097152,1152:2105352,1408:268435464,1664:268443648,1920:8200,2176:2097160,2432:8192,2688:268443656,2944:270532616,3200:0,3456:270540800,3712:2105344,3968:268435456,4096:268443648,4352:270532616,4608:270540808,4864:8200,5120:2097152,5376:268435456,5632:268435464,5888:2105344,6144:2105352,6400:0,6656:8,6912:270532608,7168:8192,7424:268443656,7680:270540800,7936:2097160,4224:8,4480:2105344,4736:2097152,4992:268435464,5248:268443648,5504:8200,5760:270540808,6016:270532608,6272:270540800,6528:270532616,6784:8192,7040:2105352,7296:2097160,7552:0,7808:268435456,8064:268443656},{0:1048576,16:33555457,32:1024,48:1049601,64:34604033,80:0,96:1,112:34603009,128:33555456,144:1048577,160:33554433,176:34604032,192:34603008,208:1025,224:1049600,240:33554432,8:34603009,24:0,40:33555457,56:34604032,72:1048576,88:33554433,104:33554432,120:1025,136:1049601,152:33555456,168:34603008,184:1048577,200:1024,216:34604033,232:1,248:1049600,256:33554432,272:1048576,288:33555457,304:34603009,320:1048577,336:33555456,352:34604032,368:1049601,384:1025,400:34604033,416:1049600,432:1,448:0,464:34603008,480:33554433,496:1024,264:1049600,280:33555457,296:34603009,312:1,328:33554432,344:1048576,360:1025,376:34604032,392:33554433,408:34603008,424:0,440:34604033,456:1049601,472:1024,488:33555456,504:1048577},{0:134219808,1:131072,2:134217728,3:32,4:131104,5:134350880,6:134350848,7:2048,8:134348800,9:134219776,10:133120,11:134348832,12:2080,13:0,14:134217760,15:133152,2147483648:2048,2147483649:134350880,2147483650:134219808,2147483651:134217728,2147483652:134348800,2147483653:133120,2147483654:133152,2147483655:32,2147483656:134217760,2147483657:2080,2147483658:131104,2147483659:134350848,2147483660:0,2147483661:134348832,2147483662:134219776,2147483663:131072,16:133152,17:134350848,18:32,19:2048,20:134219776,21:134217760,22:134348832,23:131072,24:0,25:131104,26:134348800,27:134219808,28:134350880,29:133120,30:2080,31:134217728,2147483664:131072,2147483665:2048,2147483666:134348832,2147483667:133152,2147483668:32,2147483669:134348800,2147483670:134217728,2147483671:134219808,2147483672:134350880,2147483673:134217760,2147483674:134219776,2147483675:0,2147483676:133120,2147483677:2080,2147483678:131104,2147483679:134350848}],f=[4160749569,528482304,33030144,2064384,129024,8064,504,2147483679],s=r.DES=i.extend({_doReset:function(){for(var t=this._key.words,e=[],n=0;n<56;n++){var i=c[n]-1;e[n]=t[i>>>5]>>>31-i%32&1}for(var r=this._subKeys=[],s=0;s<16;s++){var o=r[s]=[],a=h[s];for(n=0;n<24;n++)o[n/6|0]|=e[(l[n]-1+a)%28]<<31-n%6,o[4+(n/6|0)]|=e[28+(l[n+24]-1+a)%28]<<31-n%6;o[0]=o[0]<<1|o[0]>>>31;for(n=1;n<7;n++)o[n]=o[n]>>>4*(n-1)+3;o[7]=o[7]<<5|o[7]>>>27}var u=this._invSubKeys=[];for(n=0;n<16;n++)u[n]=r[15-n]},encryptBlock:function(t,e){this._doCryptBlock(t,e,this._subKeys)},decryptBlock:function(t,e){this._doCryptBlock(t,e,this._invSubKeys)},_doCryptBlock:function(t,e,n){this._lBlock=t[e],this._rBlock=t[e+1],p.call(this,4,252645135),p.call(this,16,65535),m.call(this,2,858993459),m.call(this,8,16711935),p.call(this,1,1431655765);for(var i=0;i<16;i++){for(var r=n[i],s=this._lBlock,o=this._rBlock,a=0,u=0;u<8;u++)a|=d[u][((o^r[u])&f[u])>>>0];this._lBlock=o,this._rBlock=s^a}var c=this._lBlock;this._lBlock=this._rBlock,this._rBlock=c,p.call(this,1,1431655765),m.call(this,8,16711935),m.call(this,2,858993459),p.call(this,16,65535),p.call(this,4,252645135),t[e]=this._lBlock,t[e+1]=this._rBlock},keySize:2,ivSize:2,blockSize:2});function p(t,e){var n=(this._lBlock>>>t^this._rBlock)&e;this._rBlock^=n,this._lBlock^=n<<t}function m(t,e){var n=(this._rBlock>>>t^this._lBlock)&e;this._lBlock^=n,this._rBlock^=n<<t}t.DES=i._createHelper(s);var o=r.TripleDES=i.extend({_doReset:function(){var t=this._key.words;this._des1=s.createEncryptor(n.create(t.slice(0,2))),this._des2=s.createEncryptor(n.create(t.slice(2,4))),this._des3=s.createEncryptor(n.create(t.slice(4,6)))},encryptBlock:function(t,e){this._des1.encryptBlock(t,e),this._des2.decryptBlock(t,e),this._des3.encryptBlock(t,e)},decryptBlock:function(t,e){this._des3.decryptBlock(t,e),this._des2.encryptBlock(t,e),this._des1.decryptBlock(t,e)},keySize:6,ivSize:2,blockSize:2});t.TripleDES=i._createHelper(o)}(),function(){var t=Ct,e=t.lib.StreamCipher,n=t.algo,i=n.RC4=e.extend({_doReset:function(){for(var t=this._key,e=t.words,n=t.sigBytes,i=this._S=[],r=0;r<256;r++)i[r]=r;r=0;for(var s=0;r<256;r++){var o=r%n,a=e[o>>>2]>>>24-o%4*8&255;s=(s+i[r]+a)%256;var u=i[r];i[r]=i[s],i[s]=u}this._i=this._j=0},_doProcessBlock:function(t,e){t[e]^=r.call(this)},keySize:8,ivSize:0});function r(){for(var t=this._S,e=this._i,n=this._j,i=0,r=0;r<4;r++){n=(n+t[e=(e+1)%256])%256;var s=t[e];t[e]=t[n],t[n]=s,i|=t[(t[e]+t[n])%256]<<24-8*r}return this._i=e,this._j=n,i}t.RC4=e._createHelper(i);var s=n.RC4Drop=i.extend({cfg:i.cfg.extend({drop:192}),_doReset:function(){i._doReset.call(this);for(var t=this.cfg.drop;0<t;t--)r.call(this)}});t.RC4Drop=e._createHelper(s)}(),Ct.mode.CTRGladman=function(){var t=Ct.lib.BlockCipherMode.extend();function c(t){if(255==(t>>24&255)){var e=t>>16&255,n=t>>8&255,i=255&t;255===e?(e=0,255===n?(n=0,255===i?i=0:++i):++n):++e,t=0,t+=e<<16,t+=n<<8,t+=i}else t+=1<<24;return t}var e=t.Encryptor=t.extend({processBlock:function(t,e){var n,i=this._cipher,r=i.blockSize,s=this._iv,o=this._counter;s&&(o=this._counter=s.slice(0),this._iv=void 0),0===((n=o)[0]=c(n[0]))&&(n[1]=c(n[1]));var a=o.slice(0);i.encryptBlock(a,0);for(var u=0;u<r;u++)t[e+u]^=a[u]}});return t.Decryptor=e,t}(),function(){var t=Ct,e=t.lib.StreamCipher,n=t.algo,r=[],u=[],c=[],i=n.Rabbit=e.extend({_doReset:function(){for(var t=this._key.words,e=this.cfg.iv,n=0;n<4;n++)t[n]=16711935&(t[n]<<8|t[n]>>>24)|4278255360&(t[n]<<24|t[n]>>>8);var i=this._X=[t[0],t[3]<<16|t[2]>>>16,t[1],t[0]<<16|t[3]>>>16,t[2],t[1]<<16|t[0]>>>16,t[3],t[2]<<16|t[1]>>>16],r=this._C=[t[2]<<16|t[2]>>>16,4294901760&t[0]|65535&t[1],t[3]<<16|t[3]>>>16,4294901760&t[1]|65535&t[2],t[0]<<16|t[0]>>>16,4294901760&t[2]|65535&t[3],t[1]<<16|t[1]>>>16,4294901760&t[3]|65535&t[0]];for(n=this._b=0;n<4;n++)d.call(this);for(n=0;n<8;n++)r[n]^=i[n+4&7];if(e){var s=e.words,o=s[0],a=s[1],u=16711935&(o<<8|o>>>24)|4278255360&(o<<24|o>>>8),c=16711935&(a<<8|a>>>24)|4278255360&(a<<24|a>>>8),l=u>>>16|4294901760&c,h=c<<16|65535&u;r[0]^=u,r[1]^=l,r[2]^=c,r[3]^=h,r[4]^=u,r[5]^=l,r[6]^=c,r[7]^=h;for(n=0;n<4;n++)d.call(this)}},_doProcessBlock:function(t,e){var n=this._X;d.call(this),r[0]=n[0]^n[5]>>>16^n[3]<<16,r[1]=n[2]^n[7]>>>16^n[5]<<16,r[2]=n[4]^n[1]>>>16^n[7]<<16,r[3]=n[6]^n[3]>>>16^n[1]<<16;for(var i=0;i<4;i++)r[i]=16711935&(r[i]<<8|r[i]>>>24)|4278255360&(r[i]<<24|r[i]>>>8),t[e+i]^=r[i]},blockSize:4,ivSize:2});function d(){for(var t=this._X,e=this._C,n=0;n<8;n++)u[n]=e[n];e[0]=e[0]+1295307597+this._b|0,e[1]=e[1]+3545052371+(e[0]>>>0<u[0]>>>0?1:0)|0,e[2]=e[2]+886263092+(e[1]>>>0<u[1]>>>0?1:0)|0,e[3]=e[3]+1295307597+(e[2]>>>0<u[2]>>>0?1:0)|0,e[4]=e[4]+3545052371+(e[3]>>>0<u[3]>>>0?1:0)|0,e[5]=e[5]+886263092+(e[4]>>>0<u[4]>>>0?1:0)|0,e[6]=e[6]+1295307597+(e[5]>>>0<u[5]>>>0?1:0)|0,e[7]=e[7]+3545052371+(e[6]>>>0<u[6]>>>0?1:0)|0,this._b=e[7]>>>0<u[7]>>>0?1:0;for(n=0;n<8;n++){var i=t[n]+e[n],r=65535&i,s=i>>>16,o=((r*r>>>17)+r*s>>>15)+s*s,a=((4294901760&i)*i|0)+((65535&i)*i|0);c[n]=o^a}t[0]=c[0]+(c[7]<<16|c[7]>>>16)+(c[6]<<16|c[6]>>>16)|0,t[1]=c[1]+(c[0]<<8|c[0]>>>24)+c[7]|0,t[2]=c[2]+(c[1]<<16|c[1]>>>16)+(c[0]<<16|c[0]>>>16)|0,t[3]=c[3]+(c[2]<<8|c[2]>>>24)+c[1]|0,t[4]=c[4]+(c[3]<<16|c[3]>>>16)+(c[2]<<16|c[2]>>>16)|0,t[5]=c[5]+(c[4]<<8|c[4]>>>24)+c[3]|0,t[6]=c[6]+(c[5]<<16|c[5]>>>16)+(c[4]<<16|c[4]>>>16)|0,t[7]=c[7]+(c[6]<<8|c[6]>>>24)+c[5]|0}t.Rabbit=e._createHelper(i)}(),Ct.mode.CTR=(Tt=Ct.lib.BlockCipherMode.extend(),At=Tt.Encryptor=Tt.extend({processBlock:function(t,e){var n=this._cipher,i=n.blockSize,r=this._iv,s=this._counter;r&&(s=this._counter=r.slice(0),this._iv=void 0);var o=s.slice(0);n.encryptBlock(o,0),s[i-1]=s[i-1]+1|0;for(var a=0;a<i;a++)t[e+a]^=o[a]}}),Tt.Decryptor=At,Tt),function(){var t=Ct,e=t.lib.StreamCipher,n=t.algo,r=[],u=[],c=[],i=n.RabbitLegacy=e.extend({_doReset:function(){for(var t=this._key.words,e=this.cfg.iv,n=this._X=[t[0],t[3]<<16|t[2]>>>16,t[1],t[0]<<16|t[3]>>>16,t[2],t[1]<<16|t[0]>>>16,t[3],t[2]<<16|t[1]>>>16],i=this._C=[t[2]<<16|t[2]>>>16,4294901760&t[0]|65535&t[1],t[3]<<16|t[3]>>>16,4294901760&t[1]|65535&t[2],t[0]<<16|t[0]>>>16,4294901760&t[2]|65535&t[3],t[1]<<16|t[1]>>>16,4294901760&t[3]|65535&t[0]],r=this._b=0;r<4;r++)d.call(this);for(r=0;r<8;r++)i[r]^=n[r+4&7];if(e){var s=e.words,o=s[0],a=s[1],u=16711935&(o<<8|o>>>24)|4278255360&(o<<24|o>>>8),c=16711935&(a<<8|a>>>24)|4278255360&(a<<24|a>>>8),l=u>>>16|4294901760&c,h=c<<16|65535&u;i[0]^=u,i[1]^=l,i[2]^=c,i[3]^=h,i[4]^=u,i[5]^=l,i[6]^=c,i[7]^=h;for(r=0;r<4;r++)d.call(this)}},_doProcessBlock:function(t,e){var n=this._X;d.call(this),r[0]=n[0]^n[5]>>>16^n[3]<<16,r[1]=n[2]^n[7]>>>16^n[5]<<16,r[2]=n[4]^n[1]>>>16^n[7]<<16,r[3]=n[6]^n[3]>>>16^n[1]<<16;for(var i=0;i<4;i++)r[i]=16711935&(r[i]<<8|r[i]>>>24)|4278255360&(r[i]<<24|r[i]>>>8),t[e+i]^=r[i]},blockSize:4,ivSize:2});function d(){for(var t=this._X,e=this._C,n=0;n<8;n++)u[n]=e[n];e[0]=e[0]+1295307597+this._b|0,e[1]=e[1]+3545052371+(e[0]>>>0<u[0]>>>0?1:0)|0,e[2]=e[2]+886263092+(e[1]>>>0<u[1]>>>0?1:0)|0,e[3]=e[3]+1295307597+(e[2]>>>0<u[2]>>>0?1:0)|0,e[4]=e[4]+3545052371+(e[3]>>>0<u[3]>>>0?1:0)|0,e[5]=e[5]+886263092+(e[4]>>>0<u[4]>>>0?1:0)|0,e[6]=e[6]+1295307597+(e[5]>>>0<u[5]>>>0?1:0)|0,e[7]=e[7]+3545052371+(e[6]>>>0<u[6]>>>0?1:0)|0,this._b=e[7]>>>0<u[7]>>>0?1:0;for(n=0;n<8;n++){var i=t[n]+e[n],r=65535&i,s=i>>>16,o=((r*r>>>17)+r*s>>>15)+s*s,a=((4294901760&i)*i|0)+((65535&i)*i|0);c[n]=o^a}t[0]=c[0]+(c[7]<<16|c[7]>>>16)+(c[6]<<16|c[6]>>>16)|0,t[1]=c[1]+(c[0]<<8|c[0]>>>24)+c[7]|0,t[2]=c[2]+(c[1]<<16|c[1]>>>16)+(c[0]<<16|c[0]>>>16)|0,t[3]=c[3]+(c[2]<<8|c[2]>>>24)+c[1]|0,t[4]=c[4]+(c[3]<<16|c[3]>>>16)+(c[2]<<16|c[2]>>>16)|0,t[5]=c[5]+(c[4]<<8|c[4]>>>24)+c[3]|0,t[6]=c[6]+(c[5]<<16|c[5]>>>16)+(c[4]<<16|c[4]>>>16)|0,t[7]=c[7]+(c[6]<<8|c[6]>>>24)+c[5]|0}t.RabbitLegacy=e._createHelper(i)}(),Ct.pad.ZeroPadding={pad:function(t,e){var n=4*e;t.clamp(),t.sigBytes+=n-(t.sigBytes%n||n)},unpad:function(t){for(var e=t.words,n=t.sigBytes-1;!(e[n>>>2]>>>24-n%4*8&255);)n--;t.sigBytes=n+1}},Ct}),function(){var t=this,e=t._,i=Array.prototype,o=Object.prototype,n=Function.prototype,r=i.push,u=i.slice,h=o.toString,s=o.hasOwnProperty,a=Array.isArray,c=Object.keys,l=n.bind,d=Object.create,f=function(){},p=function(t){return t instanceof p?t:this instanceof p?void(this._wrapped=t):new p(t)};"undefined"!=typeof exports?("undefined"!=typeof module&&module.exports&&(exports=module.exports=p),exports._=p):t._=p,p.VERSION="1.8.3";var m=function(r,s,t){if(void 0===s)return r;switch(null==t?3:t){case 1:return function(t){return r.call(s,t)};case 2:return function(t,e){return r.call(s,t,e)};case 3:return function(t,e,n){return r.call(s,t,e,n)};case 4:return function(t,e,n,i){return r.call(s,t,e,n,i)}}return function(){return r.apply(s,arguments)}},_=function(t,e,n){return null==t?p.identity:p.isFunction(t)?m(t,e,n):p.isObject(t)?p.matcher(t):p.property(t)};p.iteratee=function(t,e){return _(t,e,1/0)};var g=function(u,c){return function(t){var e=arguments.length;if(e<2||null==t)return t;for(var n=1;n<e;n++)for(var i=arguments[n],r=u(i),s=r.length,o=0;o<s;o++){var a=r[o];c&&void 0!==t[a]||(t[a]=i[a])}return t}},v=function(t){if(!p.isObject(t))return{};if(d)return d(t);f.prototype=t;var e=new f;return f.prototype=null,e},y=function(e){return function(t){return null==t?void 0:t[e]}},S=Math.pow(2,53)-1,w=y("length"),b=function(t){var e=w(t);return"number"==typeof e&&0<=e&&e<=S};function x(a){return function(t,e,n,i){e=m(e,i,4);var r=!b(t)&&p.keys(t),s=(r||t).length,o=0<a?0:s-1;return arguments.length<3&&(n=t[r?r[o]:o],o+=a),function(t,e,n,i,r,s){for(;0<=r&&r<s;r+=a){var o=i?i[r]:r;n=e(n,t[o],o,t)}return n}(t,e,n,r,o,s)}}p.each=p.forEach=function(t,e,n){var i,r;if(e=m(e,n),b(t))for(i=0,r=t.length;i<r;i++)e(t[i],i,t);else{var s=p.keys(t);for(i=0,r=s.length;i<r;i++)e(t[s[i]],s[i],t)}return t},p.map=p.collect=function(t,e,n){e=_(e,n);for(var i=!b(t)&&p.keys(t),r=(i||t).length,s=Array(r),o=0;o<r;o++){var a=i?i[o]:o;s[o]=e(t[a],a,t)}return s},p.reduce=p.foldl=p.inject=x(1),p.reduceRight=p.foldr=x(-1),p.find=p.detect=function(t,e,n){var i;if(void 0!==(i=b(t)?p.findIndex(t,e,n):p.findKey(t,e,n))&&-1!==i)return t[i]},p.filter=p.select=function(t,i,e){var r=[];return i=_(i,e),p.each(t,function(t,e,n){i(t,e,n)&&r.push(t)}),r},p.reject=function(t,e,n){return p.filter(t,p.negate(_(e)),n)},p.every=p.all=function(t,e,n){e=_(e,n);for(var i=!b(t)&&p.keys(t),r=(i||t).length,s=0;s<r;s++){var o=i?i[s]:s;if(!e(t[o],o,t))return!1}return!0},p.some=p.any=function(t,e,n){e=_(e,n);for(var i=!b(t)&&p.keys(t),r=(i||t).length,s=0;s<r;s++){var o=i?i[s]:s;if(e(t[o],o,t))return!0}return!1},p.contains=p.includes=p.include=function(t,e,n,i){return b(t)||(t=p.values(t)),("number"!=typeof n||i)&&(n=0),0<=p.indexOf(t,e,n)},p.invoke=function(t,n){var i=u.call(arguments,2),r=p.isFunction(n);return p.map(t,function(t){var e=r?n:t[n];return null==e?e:e.apply(t,i)})},p.pluck=function(t,e){return p.map(t,p.property(e))},p.where=function(t,e){return p.filter(t,p.matcher(e))},p.findWhere=function(t,e){return p.find(t,p.matcher(e))},p.max=function(t,i,e){var n,r,s=-1/0,o=-1/0;if(null==i&&null!=t)for(var a=0,u=(t=b(t)?t:p.values(t)).length;a<u;a++)n=t[a],s<n&&(s=n);else i=_(i,e),p.each(t,function(t,e,n){r=i(t,e,n),(o<r||r===-1/0&&s===-1/0)&&(s=t,o=r)});return s},p.min=function(t,i,e){var n,r,s=1/0,o=1/0;if(null==i&&null!=t)for(var a=0,u=(t=b(t)?t:p.values(t)).length;a<u;a++)(n=t[a])<s&&(s=n);else i=_(i,e),p.each(t,function(t,e,n){((r=i(t,e,n))<o||r===1/0&&s===1/0)&&(s=t,o=r)});return s},p.shuffle=function(t){for(var e,n=b(t)?t:p.values(t),i=n.length,r=Array(i),s=0;s<i;s++)(e=p.random(0,s))!==s&&(r[s]=r[e]),r[e]=n[s];return r},p.sample=function(t,e,n){return null==e||n?(b(t)||(t=p.values(t)),t[p.random(t.length-1)]):p.shuffle(t).slice(0,Math.max(0,e))},p.sortBy=function(t,i,e){return i=_(i,e),p.pluck(p.map(t,function(t,e,n){return{value:t,index:e,criteria:i(t,e,n)}}).sort(function(t,e){var n=t.criteria,i=e.criteria;if(n!==i){if(i<n||void 0===n)return 1;if(n<i||void 0===i)return-1}return t.index-e.index}),"value")};var M=function(o){return function(i,r,t){var s={};return r=_(r,t),p.each(i,function(t,e){var n=r(t,e,i);o(s,t,n)}),s}};p.groupBy=M(function(t,e,n){p.has(t,n)?t[n].push(e):t[n]=[e]}),p.indexBy=M(function(t,e,n){t[n]=e}),p.countBy=M(function(t,e,n){p.has(t,n)?t[n]++:t[n]=1}),p.toArray=function(t){return t?p.isArray(t)?u.call(t):b(t)?p.map(t,p.identity):p.values(t):[]},p.size=function(t){return null==t?0:b(t)?t.length:p.keys(t).length},p.partition=function(t,i,e){i=_(i,e);var r=[],s=[];return p.each(t,function(t,e,n){(i(t,e,n)?r:s).push(t)}),[r,s]},p.first=p.head=p.take=function(t,e,n){if(null!=t)return null==e||n?t[0]:p.initial(t,t.length-e)},p.initial=function(t,e,n){return u.call(t,0,Math.max(0,t.length-(null==e||n?1:e)))},p.last=function(t,e,n){if(null!=t)return null==e||n?t[t.length-1]:p.rest(t,Math.max(0,t.length-e))},p.rest=p.tail=p.drop=function(t,e,n){return u.call(t,null==e||n?1:e)},p.compact=function(t){return p.filter(t,p.identity)};var k=function(t,e,n,i){for(var r=[],s=0,o=i||0,a=w(t);o<a;o++){var u=t[o];if(b(u)&&(p.isArray(u)||p.isArguments(u))){e||(u=k(u,e,n));var c=0,l=u.length;for(r.length+=l;c<l;)r[s++]=u[c++]}else n||(r[s++]=u)}return r};function T(s){return function(t,e,n){e=_(e,n);for(var i=w(t),r=0<s?0:i-1;0<=r&&r<i;r+=s)if(e(t[r],r,t))return r;return-1}}function A(s,o,a){return function(t,e,n){var i=0,r=w(t);if("number"==typeof n)0<s?i=0<=n?n:Math.max(n+r,i):r=0<=n?Math.min(n+1,r):n+r+1;else if(a&&n&&r)return t[n=a(t,e)]===e?n:-1;if(e!=e)return 0<=(n=o(u.call(t,i,r),p.isNaN))?n+i:-1;for(n=0<s?i:r-1;0<=n&&n<r;n+=s)if(t[n]===e)return n;return-1}}p.flatten=function(t,e){return k(t,e,!1)},p.without=function(t){return p.difference(t,u.call(arguments,1))},p.uniq=p.unique=function(t,e,n,i){p.isBoolean(e)||(i=n,n=e,e=!1),null!=n&&(n=_(n,i));for(var r=[],s=[],o=0,a=w(t);o<a;o++){var u=t[o],c=n?n(u,o,t):u;e?(o&&s===c||r.push(u),s=c):n?p.contains(s,c)||(s.push(c),r.push(u)):p.contains(r,u)||r.push(u)}return r},p.union=function(){return p.uniq(k(arguments,!0,!0))},p.intersection=function(t){for(var e=[],n=arguments.length,i=0,r=w(t);i<r;i++){var s=t[i];if(!p.contains(e,s)){for(var o=1;o<n&&p.contains(arguments[o],s);o++);o===n&&e.push(s)}}return e},p.difference=function(t){var e=k(arguments,!0,!0,1);return p.filter(t,function(t){return!p.contains(e,t)})},p.zip=function(){return p.unzip(arguments)},p.unzip=function(t){for(var e=t&&p.max(t,w).length||0,n=Array(e),i=0;i<e;i++)n[i]=p.pluck(t,i);return n},p.object=function(t,e){for(var n={},i=0,r=w(t);i<r;i++)e?n[t[i]]=e[i]:n[t[i][0]]=t[i][1];return n},p.findIndex=T(1),p.findLastIndex=T(-1),p.sortedIndex=function(t,e,n,i){for(var r=(n=_(n,i,1))(e),s=0,o=w(t);s<o;){var a=Math.floor((s+o)/2);n(t[a])<r?s=a+1:o=a}return s},p.indexOf=A(1,p.findIndex,p.sortedIndex),p.lastIndexOf=A(-1,p.findLastIndex),p.range=function(t,e,n){null==e&&(e=t||0,t=0),n=n||1;for(var i=Math.max(Math.ceil((e-t)/n),0),r=Array(i),s=0;s<i;s++,t+=n)r[s]=t;return r};var C=function(t,e,n,i,r){if(!(i instanceof e))return t.apply(n,r);var s=v(t.prototype),o=t.apply(s,r);return p.isObject(o)?o:s};p.bind=function(t,e){if(l&&t.bind===l)return l.apply(t,u.call(arguments,1));if(!p.isFunction(t))throw new TypeError("Bind must be called on a function");var n=u.call(arguments,2),i=function(){return C(t,i,e,this,n.concat(u.call(arguments)))};return i},p.partial=function(r){var s=u.call(arguments,1),o=function(){for(var t=0,e=s.length,n=Array(e),i=0;i<e;i++)n[i]=s[i]===p?arguments[t++]:s[i];for(;t<arguments.length;)n.push(arguments[t++]);return C(r,o,this,this,n)};return o},p.bindAll=function(t){var e,n,i=arguments.length;if(i<=1)throw new Error("bindAll must be passed function names");for(e=1;e<i;e++)t[n=arguments[e]]=p.bind(t[n],t);return t},p.memoize=function(i,r){var s=function(t){var e=s.cache,n=""+(r?r.apply(this,arguments):t);return p.has(e,n)||(e[n]=i.apply(this,arguments)),e[n]};return s.cache={},s},p.delay=function(t,e){var n=u.call(arguments,2);return setTimeout(function(){return t.apply(null,n)},e)},p.defer=p.partial(p.delay,p,1),p.throttle=function(n,i,r){var s,o,a,u=null,c=0;r||(r={});var l=function(){c=!1===r.leading?0:p.now(),u=null,a=n.apply(s,o),u||(s=o=null)};return function(){var t=p.now();c||!1!==r.leading||(c=t);var e=i-(t-c);return s=this,o=arguments,e<=0||i<e?(u&&(clearTimeout(u),u=null),c=t,a=n.apply(s,o),u||(s=o=null)):u||!1===r.trailing||(u=setTimeout(l,e)),a}},p.debounce=function(e,n,i){var r,s,o,a,u,c=function(){var t=p.now()-a;t<n&&0<=t?r=setTimeout(c,n-t):(r=null,i||(u=e.apply(o,s),r||(o=s=null)))};return function(){o=this,s=arguments,a=p.now();var t=i&&!r;return r||(r=setTimeout(c,n)),t&&(u=e.apply(o,s),o=s=null),u}},p.wrap=function(t,e){return p.partial(e,t)},p.negate=function(t){return function(){return!t.apply(this,arguments)}},p.compose=function(){var n=arguments,i=n.length-1;return function(){for(var t=i,e=n[i].apply(this,arguments);t--;)e=n[t].call(this,e);return e}},p.after=function(t,e){return function(){if(--t<1)return e.apply(this,arguments)}},p.before=function(t,e){var n;return function(){return 0<--t&&(n=e.apply(this,arguments)),t<=1&&(e=null),n}},p.once=p.partial(p.before,2);var N=!{toString:null}.propertyIsEnumerable("toString"),D=["valueOf","isPrototypeOf","toString","propertyIsEnumerable","hasOwnProperty","toLocaleString"];function O(t,e){var n=D.length,i=t.constructor,r=p.isFunction(i)&&i.prototype||o,s="constructor";for(p.has(t,s)&&!p.contains(e,s)&&e.push(s);n--;)(s=D[n])in t&&t[s]!==r[s]&&!p.contains(e,s)&&e.push(s)}p.keys=function(t){if(!p.isObject(t))return[];if(c)return c(t);var e=[];for(var n in t)p.has(t,n)&&e.push(n);return N&&O(t,e),e},p.allKeys=function(t){if(!p.isObject(t))return[];var e=[];for(var n in t)e.push(n);return N&&O(t,e),e},p.values=function(t){for(var e=p.keys(t),n=e.length,i=Array(n),r=0;r<n;r++)i[r]=t[e[r]];return i},p.mapObject=function(t,e,n){e=_(e,n);for(var i,r=p.keys(t),s=r.length,o={},a=0;a<s;a++)o[i=r[a]]=e(t[i],i,t);return o},p.pairs=function(t){for(var e=p.keys(t),n=e.length,i=Array(n),r=0;r<n;r++)i[r]=[e[r],t[e[r]]];return i},p.invert=function(t){for(var e={},n=p.keys(t),i=0,r=n.length;i<r;i++)e[t[n[i]]]=n[i];return e},p.functions=p.methods=function(t){var e=[];for(var n in t)p.isFunction(t[n])&&e.push(n);return e.sort()},p.extend=g(p.allKeys),p.extendOwn=p.assign=g(p.keys),p.findKey=function(t,e,n){e=_(e,n);for(var i,r=p.keys(t),s=0,o=r.length;s<o;s++)if(e(t[i=r[s]],i,t))return i},p.pick=function(t,e,n){var i,r,s={},o=t;if(null==o)return s;p.isFunction(e)?(r=p.allKeys(o),i=m(e,n)):(r=k(arguments,!1,!1,1),i=function(t,e,n){return e in n},o=Object(o));for(var a=0,u=r.length;a<u;a++){var c=r[a],l=o[c];i(l,c,o)&&(s[c]=l)}return s},p.omit=function(t,e,n){if(p.isFunction(e))e=p.negate(e);else{var i=p.map(k(arguments,!1,!1,1),String);e=function(t,e){return!p.contains(i,e)}}return p.pick(t,e,n)},p.defaults=g(p.allKeys,!0),p.create=function(t,e){var n=v(t);return e&&p.extendOwn(n,e),n},p.clone=function(t){return p.isObject(t)?p.isArray(t)?t.slice():p.extend({},t):t},p.tap=function(t,e){return e(t),t},p.isMatch=function(t,e){var n=p.keys(e),i=n.length;if(null==t)return!i;for(var r=Object(t),s=0;s<i;s++){var o=n[s];if(e[o]!==r[o]||!(o in r))return!1}return!0};var H=function(t,e,n,i){if(t===e)return 0!==t||1/t==1/e;if(null==t||null==e)return t===e;t instanceof p&&(t=t._wrapped),e instanceof p&&(e=e._wrapped);var r=h.call(t);if(r!==h.call(e))return!1;switch(r){case"[object RegExp]":case"[object String]":return""+t==""+e;case"[object Number]":return+t!=+t?+e!=+e:0==+t?1/+t==1/e:+t==+e;case"[object Date]":case"[object Boolean]":return+t==+e}var s="[object Array]"===r;if(!s){if("object"!=typeof t||"object"!=typeof e)return!1;var o=t.constructor,a=e.constructor;if(o!==a&&!(p.isFunction(o)&&o instanceof o&&p.isFunction(a)&&a instanceof a)&&"constructor"in t&&"constructor"in e)return!1}i=i||[];for(var u=(n=n||[]).length;u--;)if(n[u]===t)return i[u]===e;if(n.push(t),i.push(e),s){if((u=t.length)!==e.length)return!1;for(;u--;)if(!H(t[u],e[u],n,i))return!1}else{var c,l=p.keys(t);if(u=l.length,p.keys(e).length!==u)return!1;for(;u--;)if(c=l[u],!p.has(e,c)||!H(t[c],e[c],n,i))return!1}return n.pop(),i.pop(),!0};p.isEqual=function(t,e){return H(t,e)},p.isEmpty=function(t){return null==t||(b(t)&&(p.isArray(t)||p.isString(t)||p.isArguments(t))?0===t.length:0===p.keys(t).length)},p.isElement=function(t){return!(!t||1!==t.nodeType)},p.isArray=a||function(t){return"[object Array]"===h.call(t)},p.isObject=function(t){var e=typeof t;return"function"===e||"object"===e&&!!t},p.each(["Arguments","Function","String","Number","Date","RegExp","Error"],function(e){p["is"+e]=function(t){return h.call(t)==="[object "+e+"]"}}),p.isArguments(arguments)||(p.isArguments=function(t){return p.has(t,"callee")}),"function"!=typeof/./&&"object"!=typeof Int8Array&&(p.isFunction=function(t){return"function"==typeof t||!1}),p.isFinite=function(t){return isFinite(t)&&!isNaN(parseFloat(t))},p.isNaN=function(t){return p.isNumber(t)&&t!==+t},p.isBoolean=function(t){return!0===t||!1===t||"[object Boolean]"===h.call(t)},p.isNull=function(t){return null===t},p.isUndefined=function(t){return void 0===t},p.has=function(t,e){return null!=t&&s.call(t,e)},p.noConflict=function(){return t._=e,this},p.identity=function(t){return t},p.constant=function(t){return function(){return t}},p.noop=function(){},p.property=y,p.propertyOf=function(e){return null==e?function(){}:function(t){return e[t]}},p.matcher=p.matches=function(e){return e=p.extendOwn({},e),function(t){return p.isMatch(t,e)}},p.times=function(t,e,n){var i=Array(Math.max(0,t));e=m(e,n,1);for(var r=0;r<t;r++)i[r]=e(r);return i},p.random=function(t,e){return null==e&&(e=t,t=0),t+Math.floor(Math.random()*(e-t+1))},p.now=Date.now||function(){return(new Date).getTime()};var L={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#x27;","`":"&#x60;"},E=p.invert(L),R=function(e){var n=function(t){return e[t]},t="(?:"+p.keys(e).join("|")+")",i=RegExp(t),r=RegExp(t,"g");return function(t){return t=null==t?"":""+t,i.test(t)?t.replace(r,n):t}};p.escape=R(L),p.unescape=R(E),p.result=function(t,e,n){var i=null==t?void 0:t[e];return void 0===i&&(i=n),p.isFunction(i)?i.call(t):i};var I=0;p.uniqueId=function(t){var e=++I+"";return t?t+e:e},p.templateSettings={evaluate:/<%([\s\S]+?)%>/g,interpolate:/<%=([\s\S]+?)%>/g,escape:/<%-([\s\S]+?)%>/g};var B=/(.)^/,q={"'":"'","\\":"\\","\r":"r","\n":"n","\u2028":"u2028","\u2029":"u2029"},F=/\\|'|\r|\n|\u2028|\u2029/g,j=function(t){return"\\"+q[t]};p.template=function(s,t,e){!t&&e&&(t=e),t=p.defaults({},t,p.templateSettings);var n=RegExp([(t.escape||B).source,(t.interpolate||B).source,(t.evaluate||B).source].join("|")+"|$","g"),o=0,a="__p+='";s.replace(n,function(t,e,n,i,r){return a+=s.slice(o,r).replace(F,j),o=r+t.length,e?a+="'+\n((__t=("+e+"))==null?'':_.escape(__t))+\n'":n?a+="'+\n((__t=("+n+"))==null?'':__t)+\n'":i&&(a+="';\n"+i+"\n__p+='"),t}),a+="';\n",t.variable||(a="with(obj||{}){\n"+a+"}\n"),a="var __t,__p='',__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,'');};\n"+a+"return __p;\n";try{var i=new Function(t.variable||"obj","_",a)}catch(t){throw t.source=a,t}var r=function(t){return i.call(this,t,p)},u=t.variable||"obj";return r.source="function("+u+"){\n"+a+"}",r},p.chain=function(t){var e=p(t);return e._chain=!0,e};var P=function(t,e){return t._chain?p(e).chain():e};p.mixin=function(n){p.each(p.functions(n),function(t){var e=p[t]=n[t];p.prototype[t]=function(){var t=[this._wrapped];return r.apply(t,arguments),P(this,e.apply(p,t))}})},p.mixin(p),p.each(["pop","push","reverse","shift","sort","splice","unshift"],function(e){var n=i[e];p.prototype[e]=function(){var t=this._wrapped;return n.apply(t,arguments),"shift"!==e&&"splice"!==e||0!==t.length||delete t[0],P(this,t)}}),p.each(["concat","join","slice"],function(t){var e=i[t];p.prototype[t]=function(){return P(this,e.apply(this._wrapped,arguments))}}),p.prototype.value=function(){return this._wrapped},p.prototype.valueOf=p.prototype.toJSON=p.prototype.value,p.prototype.toString=function(){return""+this._wrapped},"function"==typeof define&&define.amd&&define("underscore",[],function(){return p})}.call(this);var AesUtil=function(t,e){this.keySize=t/32,this.iterationCount=e};AesUtil.prototype.generateKey=function(t,e){return CryptoJS.PBKDF2(e,CryptoJS.enc.Hex.parse(t),{keySize:this.keySize,iterations:this.iterationCount})},AesUtil.prototype.encrypt=function(t,e,n,i){var r=this.generateKey(t,n);return CryptoJS.AES.encrypt(i,r,{iv:CryptoJS.enc.Hex.parse(e)}).ciphertext.toString(CryptoJS.enc.Base64)},AesUtil.prototype.decrypt=function(t,e,n,i){var r=this.generateKey(t,n),s=CryptoJS.lib.CipherParams.create({ciphertext:CryptoJS.enc.Base64.parse(i)});return CryptoJS.AES.decrypt(s,r,{iv:CryptoJS.enc.Hex.parse(e)}).toString(CryptoJS.enc.Utf8)};var Base64=function(){var l="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";return{encode:function(t){for(var e,n,i,r,s,o,a,u="",c=0;r=(e=t.charCodeAt(c++))>>2,s=(3&e)<<4|(n=t.charCodeAt(c++))>>4,o=(15&n)<<2|(i=t.charCodeAt(c++))>>6,a=63&i,isNaN(n)?o=a=64:isNaN(i)&&(a=64),u=u+l.charAt(r)+l.charAt(s)+l.charAt(o)+l.charAt(a),c<t.length;);return u},decode:function(t){var e,n,i,r,s,o,a="",u=0;for(t=t.replace(/[^A-Za-z0-9\+\/\=]/g,"");e=l.indexOf(t.charAt(u++))<<2|(r=l.indexOf(t.charAt(u++)))>>4,n=(15&r)<<4|(s=l.indexOf(t.charAt(u++)))>>2,i=(3&s)<<6|(o=l.indexOf(t.charAt(u++))),a+=String.fromCharCode(e),64!=s&&(a+=String.fromCharCode(n)),64!=o&&(a+=String.fromCharCode(i)),u<t.length;);return a}}}();(function(){var t=this,e=t._,i=Array.prototype,o=Object.prototype,n=Function.prototype,r=i.push,u=i.slice,h=o.toString,s=o.hasOwnProperty,a=Array.isArray,c=Object.keys,l=n.bind,d=Object.create,f=function(){},p=function(t){return t instanceof p?t:this instanceof p?void(this._wrapped=t):new p(t)};"undefined"!=typeof exports?("undefined"!=typeof module&&module.exports&&(exports=module.exports=p),exports._=p):t._=p,p.VERSION="1.8.3";var m=function(r,s,t){if(void 0===s)return r;switch(null==t?3:t){case 1:return function(t){return r.call(s,t)};case 2:return function(t,e){return r.call(s,t,e)};case 3:return function(t,e,n){return r.call(s,t,e,n)};case 4:return function(t,e,n,i){return r.call(s,t,e,n,i)}}return function(){return r.apply(s,arguments)}},_=function(t,e,n){return null==t?p.identity:p.isFunction(t)?m(t,e,n):p.isObject(t)?p.matcher(t):p.property(t)};p.iteratee=function(t,e){return _(t,e,1/0)};var g=function(u,c){return function(t){var e=arguments.length;if(e<2||null==t)return t;for(var n=1;n<e;n++)for(var i=arguments[n],r=u(i),s=r.length,o=0;o<s;o++){var a=r[o];c&&void 0!==t[a]||(t[a]=i[a])}return t}},v=function(t){if(!p.isObject(t))return{};if(d)return d(t);f.prototype=t;var e=new f;return f.prototype=null,e},y=function(e){return function(t){return null==t?void 0:t[e]}},S=Math.pow(2,53)-1,w=y("length"),b=function(t){var e=w(t);return"number"==typeof e&&0<=e&&e<=S};function x(a){return function(t,e,n,i){e=m(e,i,4);var r=!b(t)&&p.keys(t),s=(r||t).length,o=0<a?0:s-1;return arguments.length<3&&(n=t[r?r[o]:o],o+=a),function(t,e,n,i,r,s){for(;0<=r&&r<s;r+=a){var o=i?i[r]:r;n=e(n,t[o],o,t)}return n}(t,e,n,r,o,s)}}p.each=p.forEach=function(t,e,n){var i,r;if(e=m(e,n),b(t))for(i=0,r=t.length;i<r;i++)e(t[i],i,t);else{var s=p.keys(t);for(i=0,r=s.length;i<r;i++)e(t[s[i]],s[i],t)}return t},p.map=p.collect=function(t,e,n){e=_(e,n);for(var i=!b(t)&&p.keys(t),r=(i||t).length,s=Array(r),o=0;o<r;o++){var a=i?i[o]:o;s[o]=e(t[a],a,t)}return s},p.reduce=p.foldl=p.inject=x(1),p.reduceRight=p.foldr=x(-1),p.find=p.detect=function(t,e,n){var i;if(void 0!==(i=b(t)?p.findIndex(t,e,n):p.findKey(t,e,n))&&-1!==i)return t[i]},p.filter=p.select=function(t,i,e){var r=[];return i=_(i,e),p.each(t,function(t,e,n){i(t,e,n)&&r.push(t)}),r},p.reject=function(t,e,n){return p.filter(t,p.negate(_(e)),n)},p.every=p.all=function(t,e,n){e=_(e,n);for(var i=!b(t)&&p.keys(t),r=(i||t).length,s=0;s<r;s++){var o=i?i[s]:s;if(!e(t[o],o,t))return!1}return!0},p.some=p.any=function(t,e,n){e=_(e,n);for(var i=!b(t)&&p.keys(t),r=(i||t).length,s=0;s<r;s++){var o=i?i[s]:s;if(e(t[o],o,t))return!0}return!1},p.contains=p.includes=p.include=function(t,e,n,i){return b(t)||(t=p.values(t)),("number"!=typeof n||i)&&(n=0),0<=p.indexOf(t,e,n)},p.invoke=function(t,n){var i=u.call(arguments,2),r=p.isFunction(n);return p.map(t,function(t){var e=r?n:t[n];return null==e?e:e.apply(t,i)})},p.pluck=function(t,e){return p.map(t,p.property(e))},p.where=function(t,e){return p.filter(t,p.matcher(e))},p.findWhere=function(t,e){return p.find(t,p.matcher(e))},p.max=function(t,i,e){var n,r,s=-1/0,o=-1/0;if(null==i&&null!=t)for(var a=0,u=(t=b(t)?t:p.values(t)).length;a<u;a++)n=t[a],s<n&&(s=n);else i=_(i,e),p.each(t,function(t,e,n){r=i(t,e,n),(o<r||r===-1/0&&s===-1/0)&&(s=t,o=r)});return s},p.min=function(t,i,e){var n,r,s=1/0,o=1/0;if(null==i&&null!=t)for(var a=0,u=(t=b(t)?t:p.values(t)).length;a<u;a++)(n=t[a])<s&&(s=n);else i=_(i,e),p.each(t,function(t,e,n){((r=i(t,e,n))<o||r===1/0&&s===1/0)&&(s=t,o=r)});return s},p.shuffle=function(t){for(var e,n=b(t)?t:p.values(t),i=n.length,r=Array(i),s=0;s<i;s++)(e=p.random(0,s))!==s&&(r[s]=r[e]),r[e]=n[s];return r},p.sample=function(t,e,n){return null==e||n?(b(t)||(t=p.values(t)),t[p.random(t.length-1)]):p.shuffle(t).slice(0,Math.max(0,e))},p.sortBy=function(t,i,e){return i=_(i,e),p.pluck(p.map(t,function(t,e,n){return{value:t,index:e,criteria:i(t,e,n)}}).sort(function(t,e){var n=t.criteria,i=e.criteria;if(n!==i){if(i<n||void 0===n)return 1;if(n<i||void 0===i)return-1}return t.index-e.index}),"value")};var M=function(o){return function(i,r,t){var s={};return r=_(r,t),p.each(i,function(t,e){var n=r(t,e,i);o(s,t,n)}),s}};p.groupBy=M(function(t,e,n){p.has(t,n)?t[n].push(e):t[n]=[e]}),p.indexBy=M(function(t,e,n){t[n]=e}),p.countBy=M(function(t,e,n){p.has(t,n)?t[n]++:t[n]=1}),p.toArray=function(t){return t?p.isArray(t)?u.call(t):b(t)?p.map(t,p.identity):p.values(t):[]},p.size=function(t){return null==t?0:b(t)?t.length:p.keys(t).length},p.partition=function(t,i,e){i=_(i,e);var r=[],s=[];return p.each(t,function(t,e,n){(i(t,e,n)?r:s).push(t)}),[r,s]},p.first=p.head=p.take=function(t,e,n){if(null!=t)return null==e||n?t[0]:p.initial(t,t.length-e)},p.initial=function(t,e,n){return u.call(t,0,Math.max(0,t.length-(null==e||n?1:e)))},p.last=function(t,e,n){if(null!=t)return null==e||n?t[t.length-1]:p.rest(t,Math.max(0,t.length-e))},p.rest=p.tail=p.drop=function(t,e,n){return u.call(t,null==e||n?1:e)},p.compact=function(t){return p.filter(t,p.identity)};var k=function(t,e,n,i){for(var r=[],s=0,o=i||0,a=w(t);o<a;o++){var u=t[o];if(b(u)&&(p.isArray(u)||p.isArguments(u))){e||(u=k(u,e,n));var c=0,l=u.length;for(r.length+=l;c<l;)r[s++]=u[c++]}else n||(r[s++]=u)}return r};function T(s){return function(t,e,n){e=_(e,n);for(var i=w(t),r=0<s?0:i-1;0<=r&&r<i;r+=s)if(e(t[r],r,t))return r;return-1}}function A(s,o,a){return function(t,e,n){var i=0,r=w(t);if("number"==typeof n)0<s?i=0<=n?n:Math.max(n+r,i):r=0<=n?Math.min(n+1,r):n+r+1;else if(a&&n&&r)return t[n=a(t,e)]===e?n:-1;if(e!=e)return 0<=(n=o(u.call(t,i,r),p.isNaN))?n+i:-1;for(n=0<s?i:r-1;0<=n&&n<r;n+=s)if(t[n]===e)return n;return-1}}p.flatten=function(t,e){return k(t,e,!1)},p.without=function(t){return p.difference(t,u.call(arguments,1))},p.uniq=p.unique=function(t,e,n,i){p.isBoolean(e)||(i=n,n=e,e=!1),null!=n&&(n=_(n,i));for(var r=[],s=[],o=0,a=w(t);o<a;o++){var u=t[o],c=n?n(u,o,t):u;e?(o&&s===c||r.push(u),s=c):n?p.contains(s,c)||(s.push(c),r.push(u)):p.contains(r,u)||r.push(u)}return r},p.union=function(){return p.uniq(k(arguments,!0,!0))},p.intersection=function(t){for(var e=[],n=arguments.length,i=0,r=w(t);i<r;i++){var s=t[i];if(!p.contains(e,s)){for(var o=1;o<n&&p.contains(arguments[o],s);o++);o===n&&e.push(s)}}return e},p.difference=function(t){var e=k(arguments,!0,!0,1);return p.filter(t,function(t){return!p.contains(e,t)})},p.zip=function(){return p.unzip(arguments)},p.unzip=function(t){for(var e=t&&p.max(t,w).length||0,n=Array(e),i=0;i<e;i++)n[i]=p.pluck(t,i);return n},p.object=function(t,e){for(var n={},i=0,r=w(t);i<r;i++)e?n[t[i]]=e[i]:n[t[i][0]]=t[i][1];return n},p.findIndex=T(1),p.findLastIndex=T(-1),p.sortedIndex=function(t,e,n,i){for(var r=(n=_(n,i,1))(e),s=0,o=w(t);s<o;){var a=Math.floor((s+o)/2);n(t[a])<r?s=a+1:o=a}return s},p.indexOf=A(1,p.findIndex,p.sortedIndex),p.lastIndexOf=A(-1,p.findLastIndex),p.range=function(t,e,n){null==e&&(e=t||0,t=0),n=n||1;for(var i=Math.max(Math.ceil((e-t)/n),0),r=Array(i),s=0;s<i;s++,t+=n)r[s]=t;return r};var C=function(t,e,n,i,r){if(!(i instanceof e))return t.apply(n,r);var s=v(t.prototype),o=t.apply(s,r);return p.isObject(o)?o:s};p.bind=function(t,e){if(l&&t.bind===l)return l.apply(t,u.call(arguments,1));if(!p.isFunction(t))throw new TypeError("Bind must be called on a function");var n=u.call(arguments,2),i=function(){return C(t,i,e,this,n.concat(u.call(arguments)))};return i},p.partial=function(r){var s=u.call(arguments,1),o=function(){for(var t=0,e=s.length,n=Array(e),i=0;i<e;i++)n[i]=s[i]===p?arguments[t++]:s[i];for(;t<arguments.length;)n.push(arguments[t++]);return C(r,o,this,this,n)};return o},p.bindAll=function(t){var e,n,i=arguments.length;if(i<=1)throw new Error("bindAll must be passed function names");for(e=1;e<i;e++)t[n=arguments[e]]=p.bind(t[n],t);return t},p.memoize=function(i,r){var s=function(t){var e=s.cache,n=""+(r?r.apply(this,arguments):t);return p.has(e,n)||(e[n]=i.apply(this,arguments)),e[n]};return s.cache={},s},p.delay=function(t,e){var n=u.call(arguments,2);return setTimeout(function(){return t.apply(null,n)},e)},p.defer=p.partial(p.delay,p,1),p.throttle=function(n,i,r){var s,o,a,u=null,c=0;r||(r={});var l=function(){c=!1===r.leading?0:p.now(),u=null,a=n.apply(s,o),u||(s=o=null)};return function(){var t=p.now();c||!1!==r.leading||(c=t);var e=i-(t-c);return s=this,o=arguments,e<=0||i<e?(u&&(clearTimeout(u),u=null),c=t,a=n.apply(s,o),u||(s=o=null)):u||!1===r.trailing||(u=setTimeout(l,e)),a}},p.debounce=function(e,n,i){var r,s,o,a,u,c=function(){var t=p.now()-a;t<n&&0<=t?r=setTimeout(c,n-t):(r=null,i||(u=e.apply(o,s),r||(o=s=null)))};return function(){o=this,s=arguments,a=p.now();var t=i&&!r;return r||(r=setTimeout(c,n)),t&&(u=e.apply(o,s),o=s=null),u}},p.wrap=function(t,e){return p.partial(e,t)},p.negate=function(t){return function(){return!t.apply(this,arguments)}},p.compose=function(){var n=arguments,i=n.length-1;return function(){for(var t=i,e=n[i].apply(this,arguments);t--;)e=n[t].call(this,e);return e}},p.after=function(t,e){return function(){if(--t<1)return e.apply(this,arguments)}},p.before=function(t,e){var n;return function(){return 0<--t&&(n=e.apply(this,arguments)),t<=1&&(e=null),n}},p.once=p.partial(p.before,2);var N=!{toString:null}.propertyIsEnumerable("toString"),D=["valueOf","isPrototypeOf","toString","propertyIsEnumerable","hasOwnProperty","toLocaleString"];function O(t,e){var n=D.length,i=t.constructor,r=p.isFunction(i)&&i.prototype||o,s="constructor";for(p.has(t,s)&&!p.contains(e,s)&&e.push(s);n--;)(s=D[n])in t&&t[s]!==r[s]&&!p.contains(e,s)&&e.push(s)}p.keys=function(t){if(!p.isObject(t))return[];if(c)return c(t);var e=[];for(var n in t)p.has(t,n)&&e.push(n);return N&&O(t,e),e},p.allKeys=function(t){if(!p.isObject(t))return[];var e=[];for(var n in t)e.push(n);return N&&O(t,e),e},p.values=function(t){for(var e=p.keys(t),n=e.length,i=Array(n),r=0;r<n;r++)i[r]=t[e[r]];return i},p.mapObject=function(t,e,n){e=_(e,n);for(var i,r=p.keys(t),s=r.length,o={},a=0;a<s;a++)o[i=r[a]]=e(t[i],i,t);return o},p.pairs=function(t){for(var e=p.keys(t),n=e.length,i=Array(n),r=0;r<n;r++)i[r]=[e[r],t[e[r]]];return i},p.invert=function(t){for(var e={},n=p.keys(t),i=0,r=n.length;i<r;i++)e[t[n[i]]]=n[i];return e},p.functions=p.methods=function(t){var e=[];for(var n in t)p.isFunction(t[n])&&e.push(n);return e.sort()},p.extend=g(p.allKeys),p.extendOwn=p.assign=g(p.keys),p.findKey=function(t,e,n){e=_(e,n);for(var i,r=p.keys(t),s=0,o=r.length;s<o;s++)if(e(t[i=r[s]],i,t))return i},p.pick=function(t,e,n){var i,r,s={},o=t;if(null==o)return s;p.isFunction(e)?(r=p.allKeys(o),i=m(e,n)):(r=k(arguments,!1,!1,1),i=function(t,e,n){return e in n},o=Object(o));for(var a=0,u=r.length;a<u;a++){var c=r[a],l=o[c];i(l,c,o)&&(s[c]=l)}return s},p.omit=function(t,e,n){if(p.isFunction(e))e=p.negate(e);else{var i=p.map(k(arguments,!1,!1,1),String);e=function(t,e){return!p.contains(i,e)}}return p.pick(t,e,n)},p.defaults=g(p.allKeys,!0),p.create=function(t,e){var n=v(t);return e&&p.extendOwn(n,e),n},p.clone=function(t){return p.isObject(t)?p.isArray(t)?t.slice():p.extend({},t):t},p.tap=function(t,e){return e(t),t},p.isMatch=function(t,e){var n=p.keys(e),i=n.length;if(null==t)return!i;for(var r=Object(t),s=0;s<i;s++){var o=n[s];if(e[o]!==r[o]||!(o in r))return!1}return!0};var H=function(t,e,n,i){if(t===e)return 0!==t||1/t==1/e;if(null==t||null==e)return t===e;t instanceof p&&(t=t._wrapped),e instanceof p&&(e=e._wrapped);var r=h.call(t);if(r!==h.call(e))return!1;switch(r){case"[object RegExp]":case"[object String]":return""+t==""+e;case"[object Number]":return+t!=+t?+e!=+e:0==+t?1/+t==1/e:+t==+e;case"[object Date]":case"[object Boolean]":return+t==+e}var s="[object Array]"===r;if(!s){if("object"!=typeof t||"object"!=typeof e)return!1;var o=t.constructor,a=e.constructor;if(o!==a&&!(p.isFunction(o)&&o instanceof o&&p.isFunction(a)&&a instanceof a)&&"constructor"in t&&"constructor"in e)return!1}i=i||[];for(var u=(n=n||[]).length;u--;)if(n[u]===t)return i[u]===e;if(n.push(t),i.push(e),s){if((u=t.length)!==e.length)return!1;for(;u--;)if(!H(t[u],e[u],n,i))return!1}else{var c,l=p.keys(t);if(u=l.length,p.keys(e).length!==u)return!1;for(;u--;)if(c=l[u],!p.has(e,c)||!H(t[c],e[c],n,i))return!1}return n.pop(),i.pop(),!0};p.isEqual=function(t,e){return H(t,e)},p.isEmpty=function(t){return null==t||(b(t)&&(p.isArray(t)||p.isString(t)||p.isArguments(t))?0===t.length:0===p.keys(t).length)},p.isElement=function(t){return!(!t||1!==t.nodeType)},p.isArray=a||function(t){return"[object Array]"===h.call(t)},p.isObject=function(t){var e=typeof t;return"function"===e||"object"===e&&!!t},p.each(["Arguments","Function","String","Number","Date","RegExp","Error"],function(e){p["is"+e]=function(t){return h.call(t)==="[object "+e+"]"}}),p.isArguments(arguments)||(p.isArguments=function(t){return p.has(t,"callee")}),"function"!=typeof/./&&"object"!=typeof Int8Array&&(p.isFunction=function(t){return"function"==typeof t||!1}),p.isFinite=function(t){return isFinite(t)&&!isNaN(parseFloat(t))},p.isNaN=function(t){return p.isNumber(t)&&t!==+t},p.isBoolean=function(t){return!0===t||!1===t||"[object Boolean]"===h.call(t)},p.isNull=function(t){return null===t},p.isUndefined=function(t){return void 0===t},p.has=function(t,e){return null!=t&&s.call(t,e)},p.noConflict=function(){return t._=e,this},p.identity=function(t){return t},p.constant=function(t){return function(){return t}},p.noop=function(){},p.property=y,p.propertyOf=function(e){return null==e?function(){}:function(t){return e[t]}},p.matcher=p.matches=function(e){return e=p.extendOwn({},e),function(t){return p.isMatch(t,e)}},p.times=function(t,e,n){var i=Array(Math.max(0,t));e=m(e,n,1);for(var r=0;r<t;r++)i[r]=e(r);return i},p.random=function(t,e){return null==e&&(e=t,t=0),t+Math.floor(Math.random()*(e-t+1))},p.now=Date.now||function(){return(new Date).getTime()};var L={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#x27;","`":"&#x60;"},E=p.invert(L),R=function(e){var n=function(t){return e[t]},t="(?:"+p.keys(e).join("|")+")",i=RegExp(t),r=RegExp(t,"g");return function(t){return t=null==t?"":""+t,i.test(t)?t.replace(r,n):t}};p.escape=R(L),p.unescape=R(E),p.result=function(t,e,n){var i=null==t?void 0:t[e];return void 0===i&&(i=n),p.isFunction(i)?i.call(t):i};var I=0;p.uniqueId=function(t){var e=++I+"";return t?t+e:e},p.templateSettings={evaluate:/<%([\s\S]+?)%>/g,interpolate:/<%=([\s\S]+?)%>/g,escape:/<%-([\s\S]+?)%>/g};var B=/(.)^/,q={"'":"'","\\":"\\","\r":"r","\n":"n","\u2028":"u2028","\u2029":"u2029"},F=/\\|'|\r|\n|\u2028|\u2029/g,j=function(t){return"\\"+q[t]};p.template=function(s,t,e){!t&&e&&(t=e),t=p.defaults({},t,p.templateSettings);var n=RegExp([(t.escape||B).source,(t.interpolate||B).source,(t.evaluate||B).source].join("|")+"|$","g"),o=0,a="__p+='";s.replace(n,function(t,e,n,i,r){return a+=s.slice(o,r).replace(F,j),o=r+t.length,e?a+="'+\n((__t=("+e+"))==null?'':_.escape(__t))+\n'":n?a+="'+\n((__t=("+n+"))==null?'':__t)+\n'":i&&(a+="';\n"+i+"\n__p+='"),t}),a+="';\n",t.variable||(a="with(obj||{}){\n"+a+"}\n"),a="var __t,__p='',__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,'');};\n"+a+"return __p;\n";try{var i=new Function(t.variable||"obj","_",a)}catch(t){throw t.source=a,t}var r=function(t){return i.call(this,t,p)},u=t.variable||"obj";return r.source="function("+u+"){\n"+a+"}",r},p.chain=function(t){var e=p(t);return e._chain=!0,e};var P=function(t,e){return t._chain?p(e).chain():e};p.mixin=function(n){p.each(p.functions(n),function(t){var e=p[t]=n[t];p.prototype[t]=function(){var t=[this._wrapped];return r.apply(t,arguments),P(this,e.apply(p,t))}})},p.mixin(p),p.each(["pop","push","reverse","shift","sort","splice","unshift"],function(e){var n=i[e];p.prototype[e]=function(){var t=this._wrapped;return n.apply(t,arguments),"shift"!==e&&"splice"!==e||0!==t.length||delete t[0],P(this,t)}}),p.each(["concat","join","slice"],function(t){var e=i[t];p.prototype[t]=function(){return P(this,e.apply(this._wrapped,arguments))}}),p.prototype.value=function(){return this._wrapped},p.prototype.valueOf=p.prototype.toJSON=p.prototype.value,p.prototype.toString=function(){return""+this._wrapped},"function"==typeof define&&define.amd&&define("underscore",[],function(){return p})}).call(this);var kpBase64=function(){var l="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";return{encode:function(t){for(var e,n,i,r,s,o,a,u="",c=0;r=(e=t.charCodeAt(c++))>>2,s=(3&e)<<4|(n=t.charCodeAt(c++))>>4,o=(15&n)<<2|(i=t.charCodeAt(c++))>>6,a=63&i,isNaN(n)?o=a=64:isNaN(i)&&(a=64),u=u+l.charAt(r)+l.charAt(s)+l.charAt(o)+l.charAt(a),c<t.length;);return u},decode:function(t){var e,n,i,r,s,o,a="",u=0;for(t=t.replace(/[^A-Za-z0-9\+\/\=]/g,"");e=l.indexOf(t.charAt(u++))<<2|(r=l.indexOf(t.charAt(u++)))>>4,n=(15&r)<<4|(s=l.indexOf(t.charAt(u++)))>>2,i=(3&s)<<6|(o=l.indexOf(t.charAt(u++))),a+=String.fromCharCode(e),64!=s&&(a+=String.fromCharCode(n)),64!=o&&(a+=String.fromCharCode(i)),u<t.length;);return a}}}();Base64=function(){var l="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";return{encode:function(t){for(var e,n,i,r,s,o,a,u="",c=0;r=(e=t.charCodeAt(c++))>>2,s=(3&e)<<4|(n=t.charCodeAt(c++))>>4,o=(15&n)<<2|(i=t.charCodeAt(c++))>>6,a=63&i,isNaN(n)?o=a=64:isNaN(i)&&(a=64),u=u+l.charAt(r)+l.charAt(s)+l.charAt(o)+l.charAt(a),c<t.length;);return u},decode:function(t){var e,n,i,r,s,o,a="",u=0;for(t=t.replace(/[^A-Za-z0-9\+\/\=]/g,"");e=l.indexOf(t.charAt(u++))<<2|(r=l.indexOf(t.charAt(u++)))>>4,n=(15&r)<<4|(s=l.indexOf(t.charAt(u++)))>>2,i=(3&s)<<6|(o=l.indexOf(t.charAt(u++))),a+=String.fromCharCode(e),64!=s&&(a+=String.fromCharCode(n)),64!=o&&(a+=String.fromCharCode(i)),u<t.length;);return a}}}();!function(t){var e,n,i,r,s,o,a,u;if(e=this,n=function(){var l="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";return{encode:function(t){for(var e,n,i,r,s,o,a,u="",c=0;r=(e=t.charCodeAt(c++))>>2,s=(3&e)<<4|(n=t.charCodeAt(c++))>>4,o=(15&n)<<2|(i=t.charCodeAt(c++))>>6,a=63&i,isNaN(n)?(s=(3&e)<<4,o=a=64):isNaN(i)&&(a=64),u=u+l.charAt(r)+l.charAt(s)+l.charAt(o)+l.charAt(a),c<t.length;);return u},decode:function(t){var e,n,i,r,s,o,a="",u=0;for(t=t.replace(/[^A-Za-z0-9\+\/\=]/g,"");e=l.indexOf(t.charAt(u++))<<2|(r=l.indexOf(t.charAt(u++)))>>4,n=(15&r)<<4|(s=l.indexOf(t.charAt(u++)))>>2,i=(3&s)<<6|(o=l.indexOf(t.charAt(u++))),a+=String.fromCharCode(e),64!=s&&(a+=String.fromCharCode(n)),64!=o&&(a+=String.fromCharCode(i)),u<t.length;);return a}}},"function"==typeof define&&define.amd?define("strophe-base64",function(){return n()}):e.Base64=n(),i=this,r=function(){function a(t,e){t[e>>5]|=128<<24-e%32,t[15+(e+64>>9<<4)]=e;var n,i,r,s,o,a,u,c,l,h=new Array(80),d=1732584193,f=-271733879,p=-1732584194,m=271733878,_=-1009589776;for(n=0;n<t.length;n+=16){for(s=d,o=f,a=p,u=m,c=_,i=0;i<80;i++)h[i]=i<16?t[n+i]:y(h[i-3]^h[i-8]^h[i-14]^h[i-16],1),r=v(v(y(d,5),g(i,f,p,m)),v(v(_,h[i]),(l=i)<20?1518500249:l<40?1859775393:l<60?-1894007588:-899497514)),_=m,m=p,p=y(f,30),f=d,d=r;d=v(d,s),f=v(f,o),p=v(p,a),m=v(m,u),_=v(_,c)}return[d,f,p,m,_]}function g(t,e,n,i){return t<20?e&n|~e&i:t<40?e^n^i:t<60?e&n|e&i|n&i:e^n^i}function n(t,e){var n=u(t);16<n.length&&(n=a(n,8*t.length));for(var i=new Array(16),r=new Array(16),s=0;s<16;s++)i[s]=909522486^n[s],r[s]=1549556828^n[s];var o=a(i.concat(u(e)),512+8*e.length);return a(r.concat(o),672)}function v(t,e){var n=(65535&t)+(65535&e);return(t>>16)+(e>>16)+(n>>16)<<16|65535&n}function y(t,e){return t<<e|t>>>32-e}function u(t){for(var e=[],n=0;n<8*t.length;n+=8)e[n>>5]|=(255&t.charCodeAt(n/8))<<24-n%32;return e}function i(t){for(var e="",n=0;n<32*t.length;n+=8)e+=String.fromCharCode(t[n>>5]>>>24-n%32&255);return e}function r(t){for(var e,n,i="",r=0;r<4*t.length;r+=3)for(e=(t[r>>2]>>8*(3-r%4)&255)<<16|(t[r+1>>2]>>8*(3-(r+1)%4)&255)<<8|t[r+2>>2]>>8*(3-(r+2)%4)&255,n=0;n<4;n++)8*r+6*n>32*t.length?i+="=":i+="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".charAt(e>>6*(3-n)&63);return i}return{b64_hmac_sha1:function(t,e){return r(n(t,e))},b64_sha1:function(t){return r(a(u(t),8*t.length))},binb2str:i,core_hmac_sha1:n,str_hmac_sha1:function(t,e){return i(n(t,e))},str_sha1:function(t){return i(a(u(t),8*t.length))}}},"function"==typeof define&&define.amd?define("strophe-sha1",function(){return r()}):i.SHA1=r(),s=this,o=function(t){var h=function(t,e){var n=(65535&t)+(65535&e);return(t>>16)+(e>>16)+(n>>16)<<16|65535&n},e=function(t){for(var e=[],n=0;n<8*t.length;n+=8)e[n>>5]|=(255&t.charCodeAt(n/8))<<n%32;return e},a=function(t,e,n,i,r,s){return h((o=h(h(e,t),h(i,s)))<<(a=r)|o>>>32-a,n);var o,a},d=function(t,e,n,i,r,s,o){return a(e&n|~e&i,t,e,r,s,o)},f=function(t,e,n,i,r,s,o){return a(e&i|n&~i,t,e,r,s,o)},p=function(t,e,n,i,r,s,o){return a(e^n^i,t,e,r,s,o)},m=function(t,e,n,i,r,s,o){return a(n^(e|~i),t,e,r,s,o)},n=function(t,e){t[e>>5]|=128<<e%32,t[14+(e+64>>>9<<4)]=e;for(var n,i,r,s,o=1732584193,a=-271733879,u=-1732584194,c=271733878,l=0;l<t.length;l+=16)o=d(n=o,i=a,r=u,s=c,t[l+0],7,-680876936),c=d(c,o,a,u,t[l+1],12,-389564586),u=d(u,c,o,a,t[l+2],17,606105819),a=d(a,u,c,o,t[l+3],22,-1044525330),o=d(o,a,u,c,t[l+4],7,-176418897),c=d(c,o,a,u,t[l+5],12,1200080426),u=d(u,c,o,a,t[l+6],17,-1473231341),a=d(a,u,c,o,t[l+7],22,-45705983),o=d(o,a,u,c,t[l+8],7,1770035416),c=d(c,o,a,u,t[l+9],12,-1958414417),u=d(u,c,o,a,t[l+10],17,-42063),a=d(a,u,c,o,t[l+11],22,-1990404162),o=d(o,a,u,c,t[l+12],7,1804603682),c=d(c,o,a,u,t[l+13],12,-40341101),u=d(u,c,o,a,t[l+14],17,-1502002290),a=d(a,u,c,o,t[l+15],22,1236535329),o=f(o,a,u,c,t[l+1],5,-165796510),c=f(c,o,a,u,t[l+6],9,-1069501632),u=f(u,c,o,a,t[l+11],14,643717713),a=f(a,u,c,o,t[l+0],20,-373897302),o=f(o,a,u,c,t[l+5],5,-701558691),c=f(c,o,a,u,t[l+10],9,38016083),u=f(u,c,o,a,t[l+15],14,-660478335),a=f(a,u,c,o,t[l+4],20,-405537848),o=f(o,a,u,c,t[l+9],5,568446438),c=f(c,o,a,u,t[l+14],9,-1019803690),u=f(u,c,o,a,t[l+3],14,-187363961),a=f(a,u,c,o,t[l+8],20,1163531501),o=f(o,a,u,c,t[l+13],5,-1444681467),c=f(c,o,a,u,t[l+2],9,-51403784),u=f(u,c,o,a,t[l+7],14,1735328473),a=f(a,u,c,o,t[l+12],20,-1926607734),o=p(o,a,u,c,t[l+5],4,-378558),c=p(c,o,a,u,t[l+8],11,-2022574463),u=p(u,c,o,a,t[l+11],16,1839030562),a=p(a,u,c,o,t[l+14],23,-35309556),o=p(o,a,u,c,t[l+1],4,-1530992060),c=p(c,o,a,u,t[l+4],11,1272893353),u=p(u,c,o,a,t[l+7],16,-155497632),a=p(a,u,c,o,t[l+10],23,-1094730640),o=p(o,a,u,c,t[l+13],4,681279174),c=p(c,o,a,u,t[l+0],11,-358537222),u=p(u,c,o,a,t[l+3],16,-722521979),a=p(a,u,c,o,t[l+6],23,76029189),o=p(o,a,u,c,t[l+9],4,-640364487),c=p(c,o,a,u,t[l+12],11,-421815835),u=p(u,c,o,a,t[l+15],16,530742520),a=p(a,u,c,o,t[l+2],23,-995338651),o=m(o,a,u,c,t[l+0],6,-198630844),c=m(c,o,a,u,t[l+7],10,1126891415),u=m(u,c,o,a,t[l+14],15,-1416354905),a=m(a,u,c,o,t[l+5],21,-57434055),o=m(o,a,u,c,t[l+12],6,1700485571),c=m(c,o,a,u,t[l+3],10,-1894986606),u=m(u,c,o,a,t[l+10],15,-1051523),a=m(a,u,c,o,t[l+1],21,-2054922799),o=m(o,a,u,c,t[l+8],6,1873313359),c=m(c,o,a,u,t[l+15],10,-30611744),u=m(u,c,o,a,t[l+6],15,-1560198380),a=m(a,u,c,o,t[l+13],21,1309151649),o=m(o,a,u,c,t[l+4],6,-145523070),c=m(c,o,a,u,t[l+11],10,-1120210379),u=m(u,c,o,a,t[l+2],15,718787259),a=m(a,u,c,o,t[l+9],21,-343485551),o=h(o,n),a=h(a,i),u=h(u,r),c=h(c,s);return[o,a,u,c]};return{hexdigest:function(t){return function(t){for(var e="0123456789abcdef",n="",i=0;i<4*t.length;i++)n+=e.charAt(t[i>>2]>>i%4*8+4&15)+e.charAt(t[i>>2]>>i%4*8&15);return n}(n(e(t),8*t.length))},hash:function(t){return function(t){for(var e="",n=0;n<32*t.length;n+=8)e+=String.fromCharCode(t[n>>5]>>>n%32&255);return e}(n(e(t),8*t.length))}}},"function"==typeof define&&define.amd?define("strophe-md5",function(){return o()}):s.MD5=o(),a=this,u=function(){return{utf16to8:function(t){var e,n,i="",r=t.length;for(e=0;e<r;e++)0<=(n=t.charCodeAt(e))&&n<=127?i+=t.charAt(e):(2047<n?(i+=String.fromCharCode(224|n>>12&15),i+=String.fromCharCode(128|n>>6&63)):i+=String.fromCharCode(192|n>>6&31),i+=String.fromCharCode(128|n>>0&63));return i},addCookies:function(t){var e,n,i,r,s,o,a;for(e in t||{})a=o=s="",i="object"==typeof(n=t[e]),r=escape(unescape(i?n.value:n)),i&&(s=n.expires?";expires="+n.expires:"",o=n.domain?";domain="+n.domain:"",a=n.path?";path="+n.path:""),document.cookie=e+"="+r+s+o+a}}},"function"==typeof define&&define.amd?define("strophe-utils",function(){return u()}):a.stropheUtils=u(),function(t,e){if("function"!=typeof define||!define.amd)return e();define("strophe-polyfill",[],function(){return e()})}(0,function(){Function.prototype.bind||(Function.prototype.bind=function(t){var e=this,n=Array.prototype.slice,i=Array.prototype.concat,r=n.call(arguments,1);return function(){return e.apply(t||this,i.call(r,n.call(arguments,0)))}}),Array.isArray||(Array.isArray=function(t){return"[object Array]"===Object.prototype.toString.call(t)}),Array.prototype.indexOf||(Array.prototype.indexOf=function(t){var e=this.length,n=Number(arguments[1])||0;for((n=n<0?Math.ceil(n):Math.floor(n))<0&&(n+=e);n<e;n++)if(n in this&&this[n]===t)return n;return-1})}),function(t,e){if("function"==typeof define&&define.amd)define("strophe-core",["strophe-sha1","strophe-base64","strophe-md5","strophe-utils","strophe-polyfill"],function(){return e.apply(this,arguments)});else{var n=e(t.SHA1,t.Base64,t.MD5,t.stropheUtils);window.Strophe=n.Strophe,window.$build=n.$build,window.$iq=n.$iq,window.$msg=n.$msg,window.$pres=n.$pres,window.SHA1=n.SHA1,window.Base64=n.Base64,window.MD5=n.MD5,window.b64_hmac_sha1=n.SHA1.b64_hmac_sha1,window.b64_sha1=n.SHA1.b64_sha1,window.str_hmac_sha1=n.SHA1.str_hmac_sha1,window.str_sha1=n.SHA1.str_sha1}}(this,function(y,S,p,w){var d;function u(t,e){return new d.Builder(t,e)}function c(t){return new d.Builder("iq",t)}function n(t){return new d.Builder("presence",t)}return(d={VERSION:"1.2.7",NS:{HTTPBIND:"http://jabber.org/protocol/httpbind",BOSH:"urn:xmpp:xbosh",CLIENT:"jabber:client",AUTH:"jabber:iq:auth",ROSTER:"jabber:iq:roster",PROFILE:"jabber:iq:profile",DISCO_INFO:"http://jabber.org/protocol/disco#info",DISCO_ITEMS:"http://jabber.org/protocol/disco#items",MUC:"http://jabber.org/protocol/muc",SASL:"urn:ietf:params:xml:ns:xmpp-sasl",STREAM:"http://etherx.jabber.org/streams",FRAMING:"urn:ietf:params:xml:ns:xmpp-framing",BIND:"urn:ietf:params:xml:ns:xmpp-bind",SESSION:"urn:ietf:params:xml:ns:xmpp-session",VERSION:"jabber:iq:version",STANZAS:"urn:ietf:params:xml:ns:xmpp-stanzas",XHTML_IM:"http://jabber.org/protocol/xhtml-im",XHTML:"http://www.w3.org/1999/xhtml"},XHTML:{tags:["a","blockquote","br","cite","em","img","li","ol","p","span","strong","ul","body"],attributes:{a:["href"],blockquote:["style"],br:[],cite:["style"],em:[],img:["src","alt","style","height","width"],li:["style"],ol:["style"],p:["style"],span:["style"],strong:[],ul:["style"],body:[]},css:["background-color","color","font-family","font-size","font-style","font-weight","margin-left","margin-right","text-align","text-decoration"],validTag:function(t){for(var e=0;e<d.XHTML.tags.length;e++)if(t==d.XHTML.tags[e])return!0;return!1},validAttribute:function(t,e){if(void 0!==d.XHTML.attributes[t]&&0<d.XHTML.attributes[t].length)for(var n=0;n<d.XHTML.attributes[t].length;n++)if(e==d.XHTML.attributes[t][n])return!0;return!1},validCSS:function(t){for(var e=0;e<d.XHTML.css.length;e++)if(t==d.XHTML.css[e])return!0;return!1}},Status:{ERROR:0,CONNECTING:1,CONNFAIL:2,AUTHENTICATING:3,AUTHFAIL:4,CONNECTED:5,DISCONNECTED:6,DISCONNECTING:7,ATTACHED:8,REDIRECT:9,CONNTIMEOUT:10},LogLevel:{DEBUG:0,INFO:1,WARN:2,ERROR:3,FATAL:4},ElementType:{NORMAL:1,TEXT:3,CDATA:4,FRAGMENT:11},TIMEOUT:1.1,SECONDARY_TIMEOUT:.1,addNamespace:function(t,e){d.NS[t]=e},forEachChild:function(t,e,n){var i,r;for(i=0;i<t.childNodes.length;i++)(r=t.childNodes[i]).nodeType!=d.ElementType.NORMAL||e&&!this.isTagEqual(r,e)||n(r)},isTagEqual:function(t,e){return t.tagName==e},_xmlGenerator:null,_makeGenerator:function(){var t;return void 0===document.implementation.createDocument||document.implementation.createDocument&&document.documentMode&&document.documentMode<10?(t=this._getIEXmlDom()).appendChild(t.createElement("strophe")):t=document.implementation.createDocument("jabber:client","strophe",null),t},xmlGenerator:function(){return d._xmlGenerator||(d._xmlGenerator=d._makeGenerator()),d._xmlGenerator},_getIEXmlDom:function(){for(var e=null,t=["Msxml2.DOMDocument.6.0","Msxml2.DOMDocument.5.0","Msxml2.DOMDocument.4.0","MSXML2.DOMDocument.3.0","MSXML2.DOMDocument","MSXML.DOMDocument","Microsoft.XMLDOM"],n=0;n<t.length&&null===e;n++)try{e=new ActiveXObject(t[n])}catch(t){e=null}return e},xmlElement:function(t){if(!t)return null;var e,n,i,r=d.xmlGenerator().createElement(t);for(e=1;e<arguments.length;e++){var s=arguments[e];if(s)if("string"==typeof s||"number"==typeof s)r.appendChild(d.xmlTextNode(s));else if("object"==typeof s&&"function"==typeof s.sort)for(n=0;n<s.length;n++){var o=s[n];"object"==typeof o&&"function"==typeof o.sort&&void 0!==o[1]&&null!==o[1]&&r.setAttribute(o[0],o[1])}else if("object"==typeof s)for(i in s)s.hasOwnProperty(i)&&void 0!==s[i]&&null!==s[i]&&r.setAttribute(i,s[i])}return r},xmlescape:function(t){return t=(t=(t=(t=(t=t.replace(/\&/g,"&amp;")).replace(/</g,"&lt;")).replace(/>/g,"&gt;")).replace(/'/g,"&apos;")).replace(/"/g,"&quot;")},xmlunescape:function(t){return t=(t=(t=(t=(t=t.replace(/\&amp;/g,"&")).replace(/&lt;/g,"<")).replace(/&gt;/g,">")).replace(/&apos;/g,"'")).replace(/&quot;/g,'"')},xmlTextNode:function(t){return d.xmlGenerator().createTextNode(t)},xmlHtmlNode:function(t){var e;window.DOMParser?e=(new DOMParser).parseFromString(t,"text/xml"):((e=new ActiveXObject("Microsoft.XMLDOM")).async="false",e.loadXML(t));return e},getText:function(t){if(!t)return null;var e="";0===t.childNodes.length&&t.nodeType==d.ElementType.TEXT&&(e+=t.nodeValue);for(var n=0;n<t.childNodes.length;n++)t.childNodes[n].nodeType==d.ElementType.TEXT&&(e+=t.childNodes[n].nodeValue);return d.xmlescape(e)},copyElement:function(t){var e,n;if(t.nodeType==d.ElementType.NORMAL){for(n=d.xmlElement(t.tagName),e=0;e<t.attributes.length;e++)n.setAttribute(t.attributes[e].nodeName,t.attributes[e].value);for(e=0;e<t.childNodes.length;e++)n.appendChild(d.copyElement(t.childNodes[e]))}else t.nodeType==d.ElementType.TEXT&&(n=d.xmlGenerator().createTextNode(t.nodeValue));return n},createHtml:function(t){var e,n,i,r,s,o,a,u,c,l,h;if(t.nodeType==d.ElementType.NORMAL)if(r=t.nodeName.toLowerCase(),d.XHTML.validTag(r))try{for(n=d.xmlElement(r),e=0;e<d.XHTML.attributes[r].length;e++)if(s=d.XHTML.attributes[r][e],null!=(o=t.getAttribute(s))&&""!==o&&!1!==o&&0!==o)if("style"==s&&"object"==typeof o&&void 0!==o.cssText&&(o=o.cssText),"style"==s){for(a=[],u=o.split(";"),i=0;i<u.length;i++)l=(c=u[i].split(":"))[0].replace(/^\s*/,"").replace(/\s*$/,"").toLowerCase(),d.XHTML.validCSS(l)&&(h=c[1].replace(/^\s*/,"").replace(/\s*$/,""),a.push(l+": "+h));0<a.length&&(o=a.join("; "),n.setAttribute(s,o))}else n.setAttribute(s,o);for(e=0;e<t.childNodes.length;e++)n.appendChild(d.createHtml(t.childNodes[e]))}catch(t){n=d.xmlTextNode("")}else for(n=d.xmlGenerator().createDocumentFragment(),e=0;e<t.childNodes.length;e++)n.appendChild(d.createHtml(t.childNodes[e]));else if(t.nodeType==d.ElementType.FRAGMENT)for(n=d.xmlGenerator().createDocumentFragment(),e=0;e<t.childNodes.length;e++)n.appendChild(d.createHtml(t.childNodes[e]));else t.nodeType==d.ElementType.TEXT&&(n=d.xmlTextNode(t.nodeValue));return n},escapeNode:function(t){return"string"!=typeof t?t:t.replace(/^\s+|\s+$/g,"").replace(/\\/g,"\\5c").replace(/ /g,"\\20").replace(/\"/g,"\\22").replace(/\&/g,"\\26").replace(/\'/g,"\\27").replace(/\//g,"\\2f").replace(/:/g,"\\3a").replace(/</g,"\\3c").replace(/>/g,"\\3e").replace(/@/g,"\\40")},unescapeNode:function(t){return"string"!=typeof t?t:t.replace(/\\20/g," ").replace(/\\22/g,'"').replace(/\\26/g,"&").replace(/\\27/g,"'").replace(/\\2f/g,"/").replace(/\\3a/g,":").replace(/\\3c/g,"<").replace(/\\3e/g,">").replace(/\\40/g,"@").replace(/\\5c/g,"\\")},getNodeFromJid:function(t){return t.indexOf("@")<0?null:t.split("@")[0]},getDomainFromJid:function(t){var e=d.getBareJidFromJid(t);if(e.indexOf("@")<0)return e;var n=e.split("@");return n.splice(0,1),n.join("@")},getResourceFromJid:function(t){var e=t.split("/");return e.length<2?null:(e.splice(0,1),e.join("/"))},getBareJidFromJid:function(t){return t?t.split("/")[0]:null},log:function(t,e){},debug:function(t){this.log(this.LogLevel.DEBUG,t)},info:function(t){this.log(this.LogLevel.INFO,t)},warn:function(t){this.log(this.LogLevel.WARN,t)},error:function(t){this.log(this.LogLevel.ERROR,t)},fatal:function(t){this.log(this.LogLevel.FATAL,t)},serialize:function(t){var e;if(!t)return null;"function"==typeof t.tree&&(t=t.tree());var n,i,r=t.nodeName;for(t.getAttribute("_realname")&&(r=t.getAttribute("_realname")),e="<"+r,n=0;n<t.attributes.length;n++)"_realname"!=t.attributes[n].nodeName&&(e+=" "+t.attributes[n].nodeName+"='"+t.attributes[n].value.replace(/&/g,"&amp;").replace(/\'/g,"&apos;").replace(/>/g,"&gt;").replace(/</g,"&lt;")+"'");if(0<t.childNodes.length){for(e+=">",n=0;n<t.childNodes.length;n++)switch((i=t.childNodes[n]).nodeType){case d.ElementType.NORMAL:e+=d.serialize(i);break;case d.ElementType.TEXT:e+=d.xmlescape(i.nodeValue);break;case d.ElementType.CDATA:e+="<![CDATA["+i.nodeValue+"]]>"}e+="</"+r+">"}else e+="/>";return e},_requestId:0,_connectionPlugins:{},addConnectionPlugin:function(t,e){d._connectionPlugins[t]=e},Builder:function(t,e){"presence"!=t&&"message"!=t&&"iq"!=t||(e&&!e.xmlns?e.xmlns=d.NS.CLIENT:e||(e={xmlns:d.NS.CLIENT})),this.nodeTree=d.xmlElement(t,e),this.node=this.nodeTree}}).Builder.prototype={tree:function(){return this.nodeTree},toString:function(){return d.serialize(this.nodeTree)},up:function(){return this.node=this.node.parentNode,this},attrs:function(t){for(var e in t)t.hasOwnProperty(e)&&(void 0===t[e]?this.node.removeAttribute(e):this.node.setAttribute(e,t[e]));return this},c:function(t,e,n){var i=d.xmlElement(t,e,n);return this.node.appendChild(i),"string"!=typeof n&&"number"!=typeof n&&(this.node=i),this},cnode:function(t){var e,n=d.xmlGenerator();try{e=void 0!==n.importNode}catch(t){e=!1}var i=e?n.importNode(t,!0):d.copyElement(t);return this.node.appendChild(i),this.node=i,this},t:function(t){var e=d.xmlTextNode(t);return this.node.appendChild(e),this},h:function(t){var e=document.createElement("body");e.innerHTML=t;for(var n=d.createHtml(e);0<n.childNodes.length;)this.node.appendChild(n.childNodes[0]);return this}},d.Handler=function(t,e,n,i,r,s,o){this.handler=t,this.ns=e,this.name=n,this.type=i,this.id=r,this.options=o||{matchBare:!1},this.options.matchBare||(this.options.matchBare=!1),this.options.matchBare?this.from=s?d.getBareJidFromJid(s):null:this.from=s,this.user=!0},d.Handler.prototype={isMatch:function(t){var e,n=null;if(n=this.options.matchBare?d.getBareJidFromJid(t.getAttribute("from")):t.getAttribute("from"),e=!1,this.ns){var i=this;d.forEachChild(t,null,function(t){t.getAttribute("xmlns")==i.ns&&(e=!0)}),e=e||t.getAttribute("xmlns")==this.ns}else e=!0;var r=t.getAttribute("type");return!(!e||this.name&&!d.isTagEqual(t,this.name)||this.type&&(Array.isArray(this.type)?-1==this.type.indexOf(r):r!=this.type)||this.id&&t.getAttribute("id")!=this.id||this.from&&n!=this.from)},run:function(t){var e=null;try{e=this.handler(t)}catch(t){throw t.sourceURL?d.fatal("error: "+this.handler+" "+t.sourceURL+":"+t.line+" - "+t.name+": "+t.message):t.fileName?("undefined"!=typeof console&&(console.trace(),console.error(this.handler," - error - ",t,t.message)),d.fatal("error: "+this.handler+" "+t.fileName+":"+t.lineNumber+" - "+t.name+": "+t.message)):d.fatal("error: "+t.message+"\n"+t.stack),t}return e},toString:function(){return"{Handler: "+this.handler+"("+this.name+","+this.id+","+this.ns+")}"}},d.TimedHandler=function(t,e){this.period=t,this.handler=e,this.lastCalled=(new Date).getTime(),this.user=!0},d.TimedHandler.prototype={run:function(){return this.lastCalled=(new Date).getTime(),this.handler()},reset:function(){this.lastCalled=(new Date).getTime()},toString:function(){return"{TimedHandler: "+this.handler+"("+this.period+")}"}},d.Connection=function(t,e){this.service=t,this.options=e||{};var n=this.options.protocol||"";for(var i in 0===t.indexOf("ws:")||0===t.indexOf("wss:")||0===n.indexOf("ws")?this._proto=new d.Websocket(this):this._proto=new d.Bosh(this),this.jid="",this.domain=null,this.features=null,this._sasl_data={},this.do_session=!1,this.do_bind=!1,this.timedHandlers=[],this.handlers=[],this.removeTimeds=[],this.removeHandlers=[],this.addTimeds=[],this.addHandlers=[],this._authentication={},this._idleTimeout=null,this._disconnectTimeout=null,this.authenticated=!1,this.connected=!1,this.disconnecting=!1,this.do_authentication=!0,this.paused=!1,this.restored=!1,this._data=[],this._uniqueId=0,this._sasl_success_handler=null,this._sasl_failure_handler=null,this._sasl_challenge_handler=null,this.maxRetries=5,this._idleTimeout=setTimeout(function(){this._onIdle()}.bind(this),100),w.addCookies(this.options.cookies),d._connectionPlugins)if(d._connectionPlugins.hasOwnProperty(i)){var r=d._connectionPlugins[i],s=function(){};s.prototype=r,this[i]=new s,this[i].init(this)}},d.Connection.prototype={reset:function(){this._proto._reset(),this.do_session=!1,this.do_bind=!1,this.timedHandlers=[],this.handlers=[],this.removeTimeds=[],this.removeHandlers=[],this.addTimeds=[],this.addHandlers=[],this._authentication={},this.authenticated=!1,this.connected=!1,this.disconnecting=!1,this.restored=!1,this._data=[],this._requests=[],this._uniqueId=0},pause:function(){this.paused=!0},resume:function(){this.paused=!1},getUniqueId:function(t){var e="xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(t){var e=16*Math.random()|0;return("x"==t?e:3&e|8).toString(16)});return"string"==typeof t||"number"==typeof t?e+":"+t:e+""},connect:function(t,e,n,i,r,s,o){this.jid=t,this.authzid=d.getBareJidFromJid(this.jid),this.authcid=o||d.getNodeFromJid(this.jid),this.pass=e,this.servtype="xmpp",this.connect_callback=n,this.disconnecting=!1,this.connected=!1,this.authenticated=!1,this.restored=!1,this.domain=d.getDomainFromJid(this.jid),this._changeConnectStatus(d.Status.CONNECTING,null),this._proto._connect(i,r,s)},attach:function(t,e,n,i,r,s,o){if(!(this._proto instanceof d.Bosh))throw{name:"StropheSessionError",message:'The "attach" method can only be used with a BOSH connection.'};this._proto._attach(t,e,n,i,r,s,o)},restore:function(t,e,n,i,r){if(!this._sessionCachingSupported())throw{name:"StropheSessionError",message:'The "restore" method can only be used with a BOSH connection.'};this._proto._restore(t,e,n,i,r)},_sessionCachingSupported:function(){if(this._proto instanceof d.Bosh){if(!JSON)return!1;try{window.sessionStorage.setItem("_strophe_","_strophe_"),window.sessionStorage.removeItem("_strophe_")}catch(t){return!1}return!0}return!1},xmlInput:function(t){},xmlOutput:function(t){},rawInput:function(t){},rawOutput:function(t){},nextValidRid:function(t){},send:function(t){if(null!==t){if("function"==typeof t.sort)for(var e=0;e<t.length;e++)this._queueData(t[e]);else"function"==typeof t.tree?this._queueData(t.tree()):this._queueData(t);this._proto._send()}},flush:function(){clearTimeout(this._idleTimeout),this._onIdle()},sendIQ:function(t,r,s,e){var o=null,a=this;"function"==typeof t.tree&&(t=t.tree());var n=t.getAttribute("id");n||(n=this.getUniqueId("sendIQ"),t.setAttribute("id",n));var u=t.getAttribute("to"),c=this.jid,i=this.addHandler(function(t){o&&a.deleteTimedHandler(o);var e=!1,n=t.getAttribute("from");if(n!==u&&(u||n!==d.getBareJidFromJid(c)&&n!==d.getDomainFromJid(c)&&n!==c)||(e=!0),!e)throw{name:"StropheError",message:"Got answer to IQ from wrong jid:"+n+"\nExpected jid: "+u};var i=t.getAttribute("type");if("result"==i)r&&r(t);else{if("error"!=i)throw{name:"StropheError",message:"Got bad IQ type of "+i};s&&s(t)}},null,"iq",["error","result"],n);return e&&(o=this.addTimedHandler(e,function(){return a.deleteHandler(i),s&&s(null),!1})),this.send(t),n},_queueData:function(t){if(null===t||!t.tagName||!t.childNodes)throw{name:"StropheError",message:"Cannot queue non-DOMElement."};this._data.push(t)},_sendRestart:function(){this._data.push("restart"),this._proto._sendRestart(),this._idleTimeout=setTimeout(function(){this._onIdle()}.bind(this),100)},addTimedHandler:function(t,e){var n=new d.TimedHandler(t,e);return this.addTimeds.push(n),n},deleteTimedHandler:function(t){this.removeTimeds.push(t)},addHandler:function(t,e,n,i,r,s,o){var a=new d.Handler(t,e,n,i,r,s,o);return this.addHandlers.push(a),a},deleteHandler:function(t){this.removeHandlers.push(t);var e=this.addHandlers.indexOf(t);0<=e&&this.addHandlers.splice(e,1)},disconnect:function(t){if(this._changeConnectStatus(d.Status.DISCONNECTING,t),d.info("Disconnect was called because: "+t),this.connected){var e=!1;this.disconnecting=!0,this.authenticated&&(e=n({xmlns:d.NS.CLIENT,type:"unavailable"})),this._disconnectTimeout=this._addSysTimedHandler(3e3,this._onDisconnectTimeout.bind(this)),this._proto._disconnect(e)}else d.info("Disconnect was called before Strophe connected to the server"),this._proto._abortAllRequests()},_changeConnectStatus:function(t,e){for(var n in d._connectionPlugins)if(d._connectionPlugins.hasOwnProperty(n)){var i=this[n];if(i.statusChanged)try{i.statusChanged(t,e)}catch(t){d.error(n+" plugin caused an exception changing status: "+t)}}if(this.connect_callback)try{this.connect_callback(t,e)}catch(t){d.error("User connection callback caused an exception: "+t)}},_doDisconnect:function(t){"number"==typeof this._idleTimeout&&clearTimeout(this._idleTimeout),null!==this._disconnectTimeout&&(this.deleteTimedHandler(this._disconnectTimeout),this._disconnectTimeout=null),d.info("_doDisconnect was called"),this._proto._doDisconnect(),this.authenticated=!1,this.disconnecting=!1,this.restored=!1,this.handlers=[],this.timedHandlers=[],this.removeTimeds=[],this.removeHandlers=[],this.addTimeds=[],this.addHandlers=[],this._changeConnectStatus(d.Status.DISCONNECTED,t),this.connected=!1},_dataRecv:function(t,e){d.info("_dataRecv called");var n=this._proto._reqToData(t);if(null!==n){var i,r;for(this.xmlInput!==d.Connection.prototype.xmlInput&&(n.nodeName===this._proto.strip&&n.childNodes.length?this.xmlInput(n.childNodes[0]):this.xmlInput(n)),this.rawInput!==d.Connection.prototype.rawInput&&(e?this.rawInput(e):this.rawInput(d.serialize(n)));0<this.removeHandlers.length;)r=this.removeHandlers.pop(),0<=(i=this.handlers.indexOf(r))&&this.handlers.splice(i,1);for(;0<this.addHandlers.length;)this.handlers.push(this.addHandlers.pop());if(this.disconnecting&&this._proto._emptyQueue())this._doDisconnect();else{var s,o,a=n.getAttribute("type");if(null!==a&&"terminate"==a){if(this.disconnecting)return;return s=n.getAttribute("condition"),o=n.getElementsByTagName("conflict"),null!==s?("remote-stream-error"==s&&0<o.length&&(s="conflict"),this._changeConnectStatus(d.Status.CONNFAIL,s)):this._changeConnectStatus(d.Status.CONNFAIL,"unknown"),void this._doDisconnect(s)}var u=this;d.forEachChild(n,null,function(t){var e,n;for(n=u.handlers,u.handlers=[],e=0;e<n.length;e++){var i=n[e];try{!i.isMatch(t)||!u.authenticated&&i.user?u.handlers.push(i):i.run(t)&&u.handlers.push(i)}catch(t){d.warn("Removing Strophe handlers due to uncaught exception: "+t.message)}}})}}},mechanisms:{},_connect_cb:function(t,e,n){var i;d.info("_connect_cb was called"),this.connected=!0;try{i=this._proto._reqToData(t)}catch(t){if("badformat"!=t)throw t;this._changeConnectStatus(d.Status.CONNFAIL,"bad-format"),this._doDisconnect("bad-format")}if(i&&(this.xmlInput!==d.Connection.prototype.xmlInput&&(i.nodeName===this._proto.strip&&i.childNodes.length?this.xmlInput(i.childNodes[0]):this.xmlInput(i)),this.rawInput!==d.Connection.prototype.rawInput&&(n?this.rawInput(n):this.rawInput(d.serialize(i))),this._proto._connect_cb(i)!==d.Status.CONNFAIL)){var r;this._authentication.sasl_scram_sha1=!1,this._authentication.sasl_plain=!1,this._authentication.sasl_digest_md5=!1,this._authentication.sasl_anonymous=!1,this._authentication.legacy_auth=!1,r=i.getElementsByTagNameNS?0<i.getElementsByTagNameNS(d.NS.STREAM,"features").length:0<i.getElementsByTagName("stream:features").length||0<i.getElementsByTagName("features").length;var s,o,a=i.getElementsByTagName("mechanism"),u=[];if(r){if(0<a.length)for(s=0;s<a.length;s++)o=d.getText(a[s]),this.mechanisms[o]&&u.push(this.mechanisms[o]);this._authentication.legacy_auth=0<i.getElementsByTagName("auth").length,this._authentication.legacy_auth||0<u.length?!1!==this.do_authentication&&this.authenticate(u):this._proto._no_auth_received(e)}else this._proto._no_auth_received(e)}},authenticate:function(t){var e;for(e=0;e<t.length-1;++e){for(var n=e,i=e+1;i<t.length;++i)t[i].prototype.priority>t[n].prototype.priority&&(n=i);if(n!=e){var r=t[e];t[e]=t[n],t[n]=r}}var s=!1;for(e=0;e<t.length;++e)if(t[e].test(this)){this._sasl_success_handler=this._addSysHandler(this._sasl_success_cb.bind(this),null,"success",null,null),this._sasl_failure_handler=this._addSysHandler(this._sasl_failure_cb.bind(this),null,"failure",null,null),this._sasl_challenge_handler=this._addSysHandler(this._sasl_challenge_cb.bind(this),null,"challenge",null,null),this._sasl_mechanism=new t[e],this._sasl_mechanism.onStart(this);var o=u("auth",{xmlns:d.NS.SASL,mechanism:this._sasl_mechanism.name});if(this._sasl_mechanism.isClientFirst){var a=this._sasl_mechanism.onChallenge(this,null);o.t(S.encode(a))}this.send(o.tree()),s=!0;break}s||(null===d.getNodeFromJid(this.jid)?(this._changeConnectStatus(d.Status.CONNFAIL,"x-strophe-bad-non-anon-jid"),this.disconnect("x-strophe-bad-non-anon-jid")):(this._changeConnectStatus(d.Status.AUTHENTICATING,null),this._addSysHandler(this._auth1_cb.bind(this),null,null,null,"_auth_1"),this.send(c({type:"get",to:this.domain,id:"_auth_1"}).c("query",{xmlns:d.NS.AUTH}).c("username",{}).t(d.getNodeFromJid(this.jid)).tree())))},_sasl_challenge_cb:function(t){var e=S.decode(d.getText(t)),n=this._sasl_mechanism.onChallenge(this,e),i=u("response",{xmlns:d.NS.SASL});return""!==n&&i.t(S.encode(n)),this.send(i.tree()),!0},_auth1_cb:function(t){var e=c({type:"set",id:"_auth_2"}).c("query",{xmlns:d.NS.AUTH}).c("username",{}).t(d.getNodeFromJid(this.jid)).up().c("password").t(this.pass);return d.getResourceFromJid(this.jid)||(this.jid=d.getBareJidFromJid(this.jid)+"/strophe"),e.up().c("resource",{}).t(d.getResourceFromJid(this.jid)),this._addSysHandler(this._auth2_cb.bind(this),null,null,null,"_auth_2"),this.send(e.tree()),!1},_sasl_success_cb:function(t){if(this._sasl_data["server-signature"]){var e,n=S.decode(d.getText(t)).match(/([a-z]+)=([^,]+)(,|$)/);if("v"==n[1]&&(e=n[2]),e!=this._sasl_data["server-signature"])return this.deleteHandler(this._sasl_failure_handler),this._sasl_failure_handler=null,this._sasl_challenge_handler&&(this.deleteHandler(this._sasl_challenge_handler),this._sasl_challenge_handler=null),this._sasl_data={},this._sasl_failure_cb(null)}d.info("SASL authentication succeeded."),this._sasl_mechanism&&this._sasl_mechanism.onSuccess(),this.deleteHandler(this._sasl_failure_handler),this._sasl_failure_handler=null,this._sasl_challenge_handler&&(this.deleteHandler(this._sasl_challenge_handler),this._sasl_challenge_handler=null);var i=[],r=function(t,e){for(;t.length;)this.deleteHandler(t.pop());return this._sasl_auth1_cb.bind(this)(e),!1};return i.push(this._addSysHandler(function(t){r.bind(this)(i,t)}.bind(this),null,"stream:features",null,null)),i.push(this._addSysHandler(function(t){r.bind(this)(i,t)}.bind(this),d.NS.STREAM,"features",null,null)),this._sendRestart(),!1},_sasl_auth1_cb:function(t){var e,n;for(this.features=t,e=0;e<t.childNodes.length;e++)"bind"==(n=t.childNodes[e]).nodeName&&(this.do_bind=!0),"session"==n.nodeName&&(this.do_session=!0);if(!this.do_bind)return this._changeConnectStatus(d.Status.AUTHFAIL,null),!1;this._addSysHandler(this._sasl_bind_cb.bind(this),null,null,null,"_bind_auth_2");var i=d.getResourceFromJid(this.jid);return i?this.send(c({type:"set",id:"_bind_auth_2"}).c("bind",{xmlns:d.NS.BIND}).c("resource",{}).t(i).tree()):this.send(c({type:"set",id:"_bind_auth_2"}).c("bind",{xmlns:d.NS.BIND}).tree()),!1},_sasl_bind_cb:function(t){var e;if("error"==t.getAttribute("type"))return d.info("SASL binding failed."),0<t.getElementsByTagName("conflict").length&&(e="conflict"),this._changeConnectStatus(d.Status.AUTHFAIL,e),!1;var n,i=t.getElementsByTagName("bind");if(!(0<i.length))return d.info("SASL binding failed."),this._changeConnectStatus(d.Status.AUTHFAIL,null),!1;0<(n=i[0].getElementsByTagName("jid")).length&&(this.jid=d.getText(n[0]),this.do_session?(this._addSysHandler(this._sasl_session_cb.bind(this),null,null,null,"_session_auth_2"),this.send(c({type:"set",id:"_session_auth_2"}).c("session",{xmlns:d.NS.SESSION}).tree())):(this.authenticated=!0,this._changeConnectStatus(d.Status.CONNECTED,null)))},_sasl_session_cb:function(t){if("result"==t.getAttribute("type"))this.authenticated=!0,this._changeConnectStatus(d.Status.CONNECTED,null);else if("error"==t.getAttribute("type"))return d.info("Session creation failed."),this._changeConnectStatus(d.Status.AUTHFAIL,null),!1;return!1},_sasl_failure_cb:function(t){return this._sasl_success_handler&&(this.deleteHandler(this._sasl_success_handler),this._sasl_success_handler=null),this._sasl_challenge_handler&&(this.deleteHandler(this._sasl_challenge_handler),this._sasl_challenge_handler=null),this._sasl_mechanism&&this._sasl_mechanism.onFailure(),this._changeConnectStatus(d.Status.AUTHFAIL,null),!1},_auth2_cb:function(t){return"result"==t.getAttribute("type")?(this.authenticated=!0,this._changeConnectStatus(d.Status.CONNECTED,null)):"error"==t.getAttribute("type")&&(this._changeConnectStatus(d.Status.AUTHFAIL,null),this.disconnect("authentication failed")),!1},_addSysTimedHandler:function(t,e){var n=new d.TimedHandler(t,e);return n.user=!1,this.addTimeds.push(n),n},_addSysHandler:function(t,e,n,i,r){var s=new d.Handler(t,e,n,i,r);return s.user=!1,this.addHandlers.push(s),s},_onDisconnectTimeout:function(){return d.info("_onDisconnectTimeout was called"),this._changeConnectStatus(d.Status.CONNTIMEOUT,null),this._proto._onDisconnectTimeout(),this._doDisconnect(),!1},_onIdle:function(){for(var t,e,n;0<this.addTimeds.length;)this.timedHandlers.push(this.addTimeds.pop());for(;0<this.removeTimeds.length;)e=this.removeTimeds.pop(),0<=(t=this.timedHandlers.indexOf(e))&&this.timedHandlers.splice(t,1);var i=(new Date).getTime();for(n=[],t=0;t<this.timedHandlers.length;t++)e=this.timedHandlers[t],!this.authenticated&&e.user||(e.lastCalled+e.period-i<=0?e.run()&&n.push(e):n.push(e));this.timedHandlers=n,clearTimeout(this._idleTimeout),this._proto._onIdle(),this.connected&&(this._idleTimeout=setTimeout(function(){this._onIdle()}.bind(this),100))}},d.SASLMechanism=function(t,e,n){this.name=t,this.isClientFirst=e,this.priority=n},d.SASLMechanism.prototype={test:function(t){return!0},onStart:function(t){this._connection=t},onChallenge:function(t,e){throw new Error("You should implement challenge handling!")},onFailure:function(){this._connection=null},onSuccess:function(){this._connection=null}},d.SASLAnonymous=function(){},d.SASLAnonymous.prototype=new d.SASLMechanism("ANONYMOUS",!1,10),d.SASLAnonymous.test=function(t){return null===t.authcid},d.Connection.prototype.mechanisms[d.SASLAnonymous.prototype.name]=d.SASLAnonymous,d.SASLPlain=function(){},d.SASLPlain.prototype=new d.SASLMechanism("PLAIN",!0,20),d.SASLPlain.test=function(t){return null!==t.authcid},d.SASLPlain.prototype.onChallenge=function(t){var e=t.authzid;return e+="\0",e+=t.authcid,e+="\0",e+=t.pass,w.utf16to8(e)},d.Connection.prototype.mechanisms[d.SASLPlain.prototype.name]=d.SASLPlain,d.SASLSHA1=function(){},d.SASLSHA1.prototype=new d.SASLMechanism("SCRAM-SHA-1",!0,40),d.SASLSHA1.test=function(t){return null!==t.authcid},d.SASLSHA1.prototype.onChallenge=function(t,e,n){var i=n||p.hexdigest(1234567890*Math.random()),r="n="+w.utf16to8(t.authcid);return r+=",r=",r+=i,t._sasl_data.cnonce=i,r="n,,"+(t._sasl_data["client-first-message-bare"]=r),this.onChallenge=function(t,e){for(var n,i,r,s,o,a,u,c,l,h,d,f,p="c=biws,",m=t._sasl_data["client-first-message-bare"]+","+e+",",_=t._sasl_data.cnonce,g=/([a-z]+)=([^,]+)(,|$)/;e.match(g);){var v=e.match(g);switch(e=e.replace(v[0],""),v[1]){case"r":n=v[2];break;case"s":i=v[2];break;case"i":r=v[2]}}if(n.substr(0,_.length)!==_)return t._sasl_data={},t._sasl_failure_cb();for(m+=p+="r="+n,i=S.decode(i),i+="\0\0\0",l=w.utf16to8(t.pass),s=a=y.core_hmac_sha1(l,i),u=1;u<r;u++){for(o=y.core_hmac_sha1(l,y.binb2str(a)),c=0;c<5;c++)s[c]^=o[c];a=o}for(s=y.binb2str(s),h=y.core_hmac_sha1(s,"Client Key"),d=y.str_hmac_sha1(s,"Server Key"),f=y.core_hmac_sha1(y.str_sha1(y.binb2str(h)),m),t._sasl_data["server-signature"]=y.b64_hmac_sha1(d,m),c=0;c<5;c++)h[c]^=f[c];return p+=",p="+S.encode(y.binb2str(h))}.bind(this),r},d.Connection.prototype.mechanisms[d.SASLSHA1.prototype.name]=d.SASLSHA1,d.SASLMD5=function(){},d.SASLMD5.prototype=new d.SASLMechanism("DIGEST-MD5",!1,30),d.SASLMD5.test=function(t){return null!==t.authcid},d.SASLMD5.prototype._quote=function(t){return'"'+t.replace(/\\/g,"\\\\").replace(/"/g,'\\"')+'"'},d.SASLMD5.prototype.onChallenge=function(t,e,n){for(var i,r=/([a-z]+)=("[^"]+"|[^,"]+)(?:,|$)/,s=n||p.hexdigest(""+1234567890*Math.random()),o="",a=null,u="";e.match(r);)switch(i=e.match(r),e=e.replace(i[0],""),i[2]=i[2].replace(/^"(.+)"$/,"$1"),i[1]){case"realm":o=i[2];break;case"nonce":u=i[2];break;case"qop":i[2];break;case"host":a=i[2]}var c=t.servtype+"/"+t.domain;null!==a&&(c=c+"/"+a);var l=w.utf16to8(t.authcid+":"+o+":"+this._connection.pass),h=p.hash(l)+":"+u+":"+s,d="AUTHENTICATE:"+c,f="";return f+="charset=utf-8,",f+="username="+this._quote(w.utf16to8(t.authcid))+",",f+="realm="+this._quote(o)+",",f+="nonce="+this._quote(u)+",",f+="nc=00000001,",f+="cnonce="+this._quote(s)+",",f+="digest-uri="+this._quote(c)+",",f+="response="+p.hexdigest(p.hexdigest(h)+":"+u+":00000001:"+s+":auth:"+p.hexdigest(d))+",",f+="qop=auth",this.onChallenge=function(){return""}.bind(this),f},d.Connection.prototype.mechanisms[d.SASLMD5.prototype.name]=d.SASLMD5,d.SASLOAuthBearer=function(){},d.SASLOAuthBearer.prototype=new d.SASLMechanism("OAUTHBEARER",!0,80),d.SASLOAuthBearer.test=function(t){return null!==t.authcid},d.SASLOAuthBearer.prototype.onChallenge=function(t){var e="n,a=";return e+=t.authzid,e+=",",e+="",e+="auth=Bearer ",e+=t.pass,e+="",e+="",w.utf16to8(e)},d.Connection.prototype.mechanisms[d.SASLOAuthBearer.prototype.name]=d.SASLOAuthBearer,{Strophe:d,$build:u,$msg:function(t){return new d.Builder("message",t)},$iq:c,$pres:n,SHA1:y,Base64:S,MD5:p}}),function(t,e){if("function"!=typeof define||!define.amd)return e(Strophe,$build);define("strophe-bosh",["strophe-core"],function(t){return e(t.Strophe,t.$build)})}(0,function(l,e){return l.Request=function(t,e,n,i){this.id=++l._requestId,this.xmlData=t,this.data=l.serialize(t),this.origFunc=e,this.func=e,this.rid=n,this.date=NaN,this.sends=i||0,this.abort=!1,this.dead=null,this.age=function(){return this.date?(new Date-this.date)/1e3:0},this.timeDead=function(){return this.dead?(new Date-this.dead)/1e3:0},this.xhr=this._newXHR()},l.Request.prototype={getResponse:function(){var t=null;if(this.xhr.responseXML&&this.xhr.responseXML.documentElement){if("parsererror"==(t=this.xhr.responseXML.documentElement).tagName)throw l.error("invalid response received"),l.error("responseText: "+this.xhr.responseText),l.error("responseXML: "+l.serialize(this.xhr.responseXML)),"parsererror"}else if(this.xhr.responseText)throw l.error("invalid response received"),l.error("responseText: "+this.xhr.responseText),"badformat";return t},_newXHR:function(){var t=null;return window.XMLHttpRequest?(t=new XMLHttpRequest).overrideMimeType&&t.overrideMimeType("text/xml; charset=utf-8"):window.ActiveXObject&&(t=new ActiveXObject("Microsoft.XMLHTTP")),t.onreadystatechange=this.func.bind(null,this),t}},l.Bosh=function(t){this._conn=t,this.rid=Math.floor(4294967295*Math.random()),this.sid=null,this.hold=1,this.wait=60,this.window=5,this.errors=0,this._requests=[]},l.Bosh.prototype={strip:null,_buildBody:function(){var t=e("body",{rid:this.rid++,xmlns:l.NS.HTTPBIND});return null!==this.sid&&t.attrs({sid:this.sid}),this._conn.options.keepalive&&this._conn._sessionCachingSupported()&&this._cacheSession(),t},_reset:function(){this.rid=Math.floor(4294967295*Math.random()),this.sid=null,this.errors=0,this._conn._sessionCachingSupported()&&window.sessionStorage.removeItem("strophe-bosh-session"),this._conn.nextValidRid(this.rid)},_connect:function(t,e,n){this.wait=t||this.wait,this.hold=e||this.hold,this.errors=0;var i=this._buildBody().attrs({to:this._conn.domain,"xml:lang":"en",wait:this.wait,hold:this.hold,content:"text/xml; charset=utf-8",ver:"1.6","xmpp:version":"1.0","xmlns:xmpp":l.NS.BOSH});n&&i.attrs({route:n});var r=this._conn._connect_cb;this._requests.push(new l.Request(i.tree(),this._onRequestStateChange.bind(this,r.bind(this._conn)),i.tree().getAttribute("rid"))),this._throttledRequestHandler()},_attach:function(t,e,n,i,r,s,o){this._conn.jid=t,this.sid=e,this.rid=n,this._conn.connect_callback=i,this._conn.domain=l.getDomainFromJid(this._conn.jid),this._conn.authenticated=!0,this._conn.connected=!0,this.wait=r||this.wait,this.hold=s||this.hold,this.window=o||this.window,this._conn._changeConnectStatus(l.Status.ATTACHED,null)},_restore:function(t,e,n,i,r){var s=JSON.parse(window.sessionStorage.getItem("strophe-bosh-session"));if(!(null!=s&&s.rid&&s.sid&&s.jid)||null!=t&&l.getBareJidFromJid(s.jid)!=l.getBareJidFromJid(t))throw{name:"StropheSessionError",message:"_restore: no restoreable session."};this._conn.restored=!0,this._attach(s.jid,s.sid,s.rid,e,n,i,r)},_cacheSession:function(){this._conn.authenticated?this._conn.jid&&this.rid&&this.sid&&window.sessionStorage.setItem("strophe-bosh-session",JSON.stringify({jid:this._conn.jid,rid:this.rid,sid:this.sid})):window.sessionStorage.removeItem("strophe-bosh-session")},_connect_cb:function(t){var e,n,i=t.getAttribute("type");if(null!==i&&"terminate"==i)return e=t.getAttribute("condition"),l.error("BOSH-Connection failed: "+e),n=t.getElementsByTagName("conflict"),null!==e?("remote-stream-error"==e&&0<n.length&&(e="conflict"),this._conn._changeConnectStatus(l.Status.CONNFAIL,e)):this._conn._changeConnectStatus(l.Status.CONNFAIL,"unknown"),this._conn._doDisconnect(e),l.Status.CONNFAIL;this.sid||(this.sid=t.getAttribute("sid"));var r=t.getAttribute("requests");r&&(this.window=parseInt(r,10));var s=t.getAttribute("hold");s&&(this.hold=parseInt(s,10));var o=t.getAttribute("wait");o&&(this.wait=parseInt(o,10))},_disconnect:function(t){this._sendTerminate(t)},_doDisconnect:function(){this.sid=null,this.rid=Math.floor(4294967295*Math.random()),this._conn._sessionCachingSupported()&&window.sessionStorage.removeItem("strophe-bosh-session"),this._conn.nextValidRid(this.rid)},_emptyQueue:function(){return 0===this._requests.length},_hitError:function(t){this.errors++,l.warn("request errored, status: "+t+", number of errors: "+this.errors),4<this.errors&&this._conn._onDisconnectTimeout()},_no_auth_received:function(t){t=t?t.bind(this._conn):this._conn._connect_cb.bind(this._conn);var e=this._buildBody();this._requests.push(new l.Request(e.tree(),this._onRequestStateChange.bind(this,t.bind(this._conn)),e.tree().getAttribute("rid"))),this._throttledRequestHandler()},_onDisconnectTimeout:function(){this._abortAllRequests()},_abortAllRequests:function(){for(var t;0<this._requests.length;)(t=this._requests.pop()).abort=!0,t.xhr.abort(),t.xhr.onreadystatechange=function(){}},_onIdle:function(){var t=this._conn._data;if(this._conn.authenticated&&0===this._requests.length&&0===t.length&&!this._conn.disconnecting&&(l.info("no requests during idle cycle, sending blank request"),t.push(null)),!this._conn.paused){if(this._requests.length<2&&0<t.length){for(var e=this._buildBody(),n=0;n<t.length;n++)null!==t[n]&&("restart"===t[n]?e.attrs({to:this._conn.domain,"xml:lang":"en","xmpp:restart":"true","xmlns:xmpp":l.NS.BOSH}):e.cnode(t[n]).up());delete this._conn._data,this._conn._data=[],this._requests.push(new l.Request(e.tree(),this._onRequestStateChange.bind(this,this._conn._dataRecv.bind(this._conn)),e.tree().getAttribute("rid"))),this._throttledRequestHandler()}if(0<this._requests.length){var i=this._requests[0].age();null!==this._requests[0].dead&&this._requests[0].timeDead()>Math.floor(l.SECONDARY_TIMEOUT*this.wait)&&this._throttledRequestHandler(),i>Math.floor(l.TIMEOUT*this.wait)&&(l.warn("Request "+this._requests[0].id+" timed out, over "+Math.floor(l.TIMEOUT*this.wait)+" seconds since last activity"),this._throttledRequestHandler())}}},_onRequestStateChange:function(t,e){var n;if(l.debug("request id "+e.id+"."+e.sends+" state changed to "+e.xhr.readyState),e.abort)e.abort=!1;else if(4==e.xhr.readyState){n=0;try{n=e.xhr.status}catch(t){}if(void 0===n&&(n=0),this.disconnecting&&400<=n)return void this._hitError(n);var i=this._requests[0]==e,r=this._requests[1]==e;(0<n&&n<500||5<e.sends)&&(this._removeRequest(e),l.debug("request id "+e.id+" should now be removed")),200==n?((r||i&&0<this._requests.length&&this._requests[0].age()>Math.floor(l.SECONDARY_TIMEOUT*this.wait))&&this._restartRequest(0),this._conn.nextValidRid(Number(e.rid)+1),l.debug("request id "+e.id+"."+e.sends+" got 200"),t(e),this.errors=0):(l.error("request id "+e.id+"."+e.sends+" error "+n+" happened"),(0===n||400<=n&&n<600||12e3<=n)&&(this._hitError(n),400<=n&&n<500&&(this._conn._changeConnectStatus(l.Status.DISCONNECTING,null),this._conn._doDisconnect()))),0<n&&n<500||5<e.sends||this._throttledRequestHandler()}},_processRequest:function(e){var n=this,i=this._requests[e],r=-1;try{4==i.xhr.readyState&&(r=i.xhr.status)}catch(t){l.error("caught an error in _requests["+e+"], reqStatus: "+r)}if(void 0===r&&(r=-1),i.sends>this._conn.maxRetries)this._conn._onDisconnectTimeout();else{var t=i.age(),s=!isNaN(t)&&t>Math.floor(l.TIMEOUT*this.wait),o=null!==i.dead&&i.timeDead()>Math.floor(l.SECONDARY_TIMEOUT*this.wait),a=4==i.xhr.readyState&&(r<1||500<=r);if((s||o||a)&&(o&&l.error("Request "+this._requests[e].id+" timed out (secondary), restarting"),i.abort=!0,i.xhr.abort(),i.xhr.onreadystatechange=function(){},this._requests[e]=new l.Request(i.xmlData,i.origFunc,i.rid,i.sends),i=this._requests[e]),0===i.xhr.readyState){l.debug("request id "+i.id+"."+i.sends+" posting");try{i.xhr.open("POST",this._conn.service,!this._conn.options.sync),i.xhr.setRequestHeader("Content-Type","text/xml; charset=utf-8"),this._conn.options.withCredentials&&(i.xhr.withCredentials=!0)}catch(t){return l.error("XHR open failed."),this._conn.connected||this._conn._changeConnectStatus(l.Status.CONNFAIL,"bad-service"),void this._conn.disconnect()}var u=function(){if(i.date=new Date,n._conn.options.customHeaders){var t=n._conn.options.customHeaders;for(var e in t)t.hasOwnProperty(e)&&i.xhr.setRequestHeader(e,t[e])}i.xhr.send(i.data)};if(1<i.sends){var c=1e3*Math.min(Math.floor(l.TIMEOUT*this.wait),Math.pow(i.sends,3));setTimeout(function(){u()},c)}else u();i.sends++,this._conn.xmlOutput!==l.Connection.prototype.xmlOutput&&(i.xmlData.nodeName===this.strip&&i.xmlData.childNodes.length?this._conn.xmlOutput(i.xmlData.childNodes[0]):this._conn.xmlOutput(i.xmlData)),this._conn.rawOutput!==l.Connection.prototype.rawOutput&&this._conn.rawOutput(i.data)}else l.debug("_processRequest: "+(0===e?"first":"second")+" request has readyState of "+i.xhr.readyState)}},_removeRequest:function(t){var e;for(l.debug("removing request"),e=this._requests.length-1;0<=e;e--)t==this._requests[e]&&this._requests.splice(e,1);t.xhr.onreadystatechange=function(){},this._throttledRequestHandler()},_restartRequest:function(t){var e=this._requests[t];null===e.dead&&(e.dead=new Date),this._processRequest(t)},_reqToData:function(t){try{return t.getResponse()}catch(t){if("parsererror"!=t)throw t;this._conn.disconnect("strophe-parsererror")}},_sendTerminate:function(t){l.info("_sendTerminate was called");var e=this._buildBody().attrs({type:"terminate"});t&&e.cnode(t.tree());var n=new l.Request(e.tree(),this._onRequestStateChange.bind(this,this._conn._dataRecv.bind(this._conn)),e.tree().getAttribute("rid"));this._requests.push(n),this._throttledRequestHandler()},_send:function(){clearTimeout(this._conn._idleTimeout),this._throttledRequestHandler(),this._conn._idleTimeout=setTimeout(function(){this._onIdle()}.bind(this._conn),100)},_sendRestart:function(){this._throttledRequestHandler(),clearTimeout(this._conn._idleTimeout)},_throttledRequestHandler:function(){this._requests?l.debug("_throttledRequestHandler called with "+this._requests.length+" requests"):l.debug("_throttledRequestHandler called with undefined requests"),this._requests&&0!==this._requests.length&&(0<this._requests.length&&this._processRequest(0),1<this._requests.length&&Math.abs(this._requests[0].rid-this._requests[1].rid)<this.window&&this._processRequest(1))}},l}),function(t,e){if("function"!=typeof define||!define.amd)return e(Strophe,$build);define("strophe-websocket",["strophe-core"],function(t){return e(t.Strophe,t.$build)})}(0,function(c,i){return c.Websocket=function(t){this._conn=t,this.strip="wrapper";var e=t.service;if(0!==e.indexOf("ws:")&&0!==e.indexOf("wss:")){var n="";"ws"===t.options.protocol&&"https:"!==window.location.protocol?n+="ws":n+="wss",n+="://"+window.location.host,0!==e.indexOf("/")?n+=window.location.pathname+e:n+=e,t.service=n}},c.Websocket.prototype={_buildStream:function(){return i("open",{xmlns:c.NS.FRAMING,to:this._conn.domain,version:"1.0"})},_check_streamerror:function(t,e){var n;if(0===(n=t.getElementsByTagNameNS?t.getElementsByTagNameNS(c.NS.STREAM,"error"):t.getElementsByTagName("stream:error")).length)return!1;for(var i=n[0],r="",s="",o=0;o<i.childNodes.length;o++){var a=i.childNodes[o];if("urn:ietf:params:xml:ns:xmpp-streams"!==a.getAttribute("xmlns"))break;"text"===a.nodeName?s=a.textContent:r=a.nodeName}var u="WebSocket stream error: ";return u+=r||"unknown",s&&(u+=" - "+r),c.error(u),this._conn._changeConnectStatus(e,r),this._conn._doDisconnect(),!0},_reset:function(){},_connect:function(){this._closeSocket(),this.socket=new WebSocket(this._conn.service,"xmpp"),this.socket.onopen=this._onOpen.bind(this),this.socket.onerror=this._onError.bind(this),this.socket.onclose=this._onClose.bind(this),this.socket.onmessage=this._connect_cb_wrapper.bind(this)},_connect_cb:function(t){if(this._check_streamerror(t,c.Status.CONNFAIL))return c.Status.CONNFAIL},_handleStreamStart:function(t){var e=!1,n=t.getAttribute("xmlns");"string"!=typeof n?e="Missing xmlns in <open />":n!==c.NS.FRAMING&&(e="Wrong xmlns in <open />: "+n);var i=t.getAttribute("version");return"string"!=typeof i?e="Missing version in <open />":"1.0"!==i&&(e="Wrong version in <open />: "+i),!e||(this._conn._changeConnectStatus(c.Status.CONNFAIL,e),this._conn._doDisconnect(),!1)},_connect_cb_wrapper:function(t){if(0===t.data.indexOf("<open ")||0===t.data.indexOf("<?xml")){var e=t.data.replace(/^(<\?.*?\?>\s*)*/,"");if(""===e)return;var n=(new DOMParser).parseFromString(e,"text/xml").documentElement;this._conn.xmlInput(n),this._conn.rawInput(t.data),this._handleStreamStart(n)&&this._connect_cb(n)}else if(0===t.data.indexOf("<close ")){this._conn.rawInput(t.data),this._conn.xmlInput(t);var i=t.getAttribute("see-other-uri");i?(this._conn._changeConnectStatus(c.Status.REDIRECT,"Received see-other-uri, resetting connection"),this._conn.reset(),this._conn.service=i,this._connect()):(this._conn._changeConnectStatus(c.Status.CONNFAIL,"Received closing stream"),this._conn._doDisconnect())}else{var r=this._streamWrap(t.data),s=(new DOMParser).parseFromString(r,"text/xml").documentElement;this.socket.onmessage=this._onMessage.bind(this),this._conn._connect_cb(s,null,t.data)}},_disconnect:function(t){if(this.socket&&this.socket.readyState!==WebSocket.CLOSED){t&&this._conn.send(t);var e=i("close",{xmlns:c.NS.FRAMING});this._conn.xmlOutput(e);var n=c.serialize(e);this._conn.rawOutput(n);try{this.socket.send(n)}catch(t){c.info("Couldn't send <close /> tag.")}}this._conn._doDisconnect()},_doDisconnect:function(){c.info("WebSockets _doDisconnect was called"),this._closeSocket()},_streamWrap:function(t){return"<wrapper>"+t+"</wrapper>"},_closeSocket:function(){if(this.socket)try{this.socket.close()}catch(t){}this.socket=null},_emptyQueue:function(){return!0},_onClose:function(){this._conn.connected&&!this._conn.disconnecting?(c.error("Websocket closed unexpectedly"),this._conn._doDisconnect()):c.info("Websocket closed")},_no_auth_received:function(t){c.error("Server did not send any auth methods"),this._conn._changeConnectStatus(c.Status.CONNFAIL,"Server did not send any auth methods"),t&&(t=t.bind(this._conn))(),this._conn._doDisconnect()},_onDisconnectTimeout:function(){},_abortAllRequests:function(){},_onError:function(t){c.error("Websocket error "+t),this._conn._changeConnectStatus(c.Status.CONNFAIL,"The WebSocket connection could not be established or was disconnected."),this._disconnect()},_onIdle:function(){var t=this._conn._data;if(0<t.length&&!this._conn.paused){for(var e=0;e<t.length;e++){var n,i;if(null!==t[e])n="restart"===t[e]?this._buildStream().tree():t[e],i=c.serialize(n),this._conn.xmlOutput(n),this._conn.rawOutput(i),this.socket.send(i)}this._conn._data=[]}},_onMessage:function(t){var e,n,i='<close xmlns="urn:ietf:params:xml:ns:xmpp-framing" />';if(t.data===i)return this._conn.rawInput(i),this._conn.xmlInput(t),void(this._conn.disconnecting||this._conn._doDisconnect());if(0===t.data.search("<open ")){if(e=(new DOMParser).parseFromString(t.data,"text/xml").documentElement,!this._handleStreamStart(e))return}else n=this._streamWrap(t.data),e=(new DOMParser).parseFromString(n,"text/xml").documentElement;return this._check_streamerror(e,c.Status.ERROR)?void 0:this._conn.disconnecting&&"presence"===e.firstChild.nodeName&&"unavailable"===e.firstChild.getAttribute("type")?(this._conn.xmlInput(e),void this._conn.rawInput(c.serialize(e))):void this._conn._dataRecv(e,t.data)},_onOpen:function(){c.info("Websocket open");var t=this._buildStream();this._conn.xmlOutput(t.tree());var e=c.serialize(t);this._conn.rawOutput(e),this.socket.send(e)},_reqToData:function(t){return t},_send:function(){this._conn.flush()},_sendRestart:function(){clearTimeout(this._conn._idleTimeout),this._conn._onIdle.bind(this._conn)()}},c}),"function"==typeof define&&define.amd&&define("strophe",["strophe-core","strophe-bosh","strophe-websocket"],function(t){return t}),"function"!=typeof define||!define.amd)return t(Strophe,$build,$msg,$iq,$pres);var c=t;requirejs(["strophe"],function(t){c(t.Strophe,t.$build,t.$msg,t.$iq,t.$pres)})}(function(t,e,n,i,r){window.Strophe=t,window.$build=e,window.$msg=n,window.$iq=i,window.$pres=r}),function(e,r){var t=function(t,e){this.disco=t,r.extend(this,e)};t.prototype.parseRequest=function(t){return t.tree?r(e.serialize(t.tree())):r(t)},t.prototype.fromTo=function(t){var e=t.attr("from"),n=t.attr("id");return $iq({to:e,type:"result",id:n})},t.prototype.addFirstChild=function(t,e){var n=t.find("> *:eq(0)"),i={};0!==n.length&&(n.attr("xmlns")&&(i.xmlns=n.attr("xmlns")),n.attr("node")&&(i.node=n.attr("node")),r.isEmptyObject(i)?e.c(n[0].tagName):e.c(n[0].tagName,i))},t.prototype.reply=function(t){var e=this.parseRequest(t),n=this.fromTo(e);return this.addFirstChild(e,n),this.addContent(e,n),n},DiscoInfoNode=function(){t.apply(this,arguments)},DiscoInfoNode.prototype=new t,DiscoInfoNode.prototype.addContent=function(t,e){var n=this.features||this.disco.features,i=this.identity||this.disco.identity;e.c("identity",i).up(),r.each(n,function(t){e.c("feature",{var:t}).up()})},DiscoItemsNode=function(){t.apply(this,arguments)},DiscoItemsNode.prototype=new t,DiscoItemsNode.prototype.addContent=function(t,n){var e=this.items||this.disco.items;r.each(e,function(t,e){e.jid||(e.jid=this.disco._conn.jid),n.c("item",e).up()}.bind(this))},DiscoNodeNotFound=function(){t.apply(this,arguments)},DiscoNodeNotFound.prototype=new t,DiscoNodeNotFound.prototype.addContent=function(t,e){e.c("error",{type:"cancel"}),e.c("item-not-found",{xmlns:"urn:ietf:params:xml:ns:xmpp-stanzas"})},e.Disco={DiscoNode:t,DiscoInfoNode:DiscoInfoNode,DiscoNodeNotFound:DiscoNodeNotFound,noop:function(t){console&&console.log(t)}}}(Strophe,jQuery),function(e,i){var r=e.NS.DISCO_INFO,s=e.NS.DISCO_ITEMS,o=(e.Disco.DiscoNode,e.Disco.DiscoInfoNode),a=e.Disco.DiscoNodeNotFound,c=e.Disco.noop;function u(t,e,n){var i=n[0],r=n[1],s=n[2],o=n[3],a={xmlns:e};"function"==typeof r&&(o=s,s=r,r=void 0),r&&(a.node=r);var u=$iq({to:i,type:"get"}).c("query",a);t.sendIQ(u,s||c,o||c)}function n(t){var e=i("query",t).attr("node")||i("query",t).attr("xmlns"),n=this.features[e]||new a;i.isPlainObject(n)&&(n=new(i("query",t).attr("xmlns")===r?o:DiscoItemsNode)(this,n));return this._conn.send(n.reply(t)),!0}var t={_conn:null,init:function(t){this.jid=t.jid,this.features={},this.identity={name:"strophe"},this.features[r]=new o(this),this.features[s]=new DiscoItemsNode(this),this._conn=t},statusChanged:function(t){t===e.Status.CONNECTED&&(this._conn.addHandler(n.bind(this),r,"iq","get"),this._conn.addHandler(n.bind(this),s,"iq","get"))},info:function(t,e,n){u(this._conn,r,arguments)},items:function(t,e,n){u(this._conn,s,arguments)},addNode:function(t,e){if(this.features[t])throw t+" exists";this.features[t]=e}};e.addConnectionPlugin("disco",t)}(Strophe,jQuery),Strophe.addConnectionPlugin("ping",{_c:null,init:function(t){this._c=t,Strophe.addNamespace("PING","urn:xmpp:ping")},ping:function(t,e,n,i){var r=this._c.getUniqueId("ping"),s=$iq({type:"get",to:t,id:r}).c("ping",{xmlns:Strophe.NS.PING});this._c.sendIQ(s,e,n,i)},pong:function(t){var e=t.getAttribute("from"),n=t.getAttribute("id"),i=$iq({type:"result",to:e,id:n});this._c.sendIQ(i)},addPingHandler:function(t){return this._c.addHandler(t,Strophe.NS.PING,"iq","get")}}),function(){var g,n,v,u,y,s=[].slice,l=function(t,e){return function(){return t.apply(e,arguments)}},S=[].indexOf||function(t){for(var e=0,n=this.length;e<n;e++)if(e in this&&this[e]===t)return e;return-1};y={fill:function(t,e,n){var i,r,s,o;for(o=[],r=0,s=t.length;r<s;r++)i=t[r],o.push(e.push(i instanceof n?i:new n(i)));return o},createHtmlFieldCouple:function(t){var e,n;return e=$("<div>"),n="Strophe.x.Field-"+t.type+"-"+t.var,e.append("<label for='"+n+"'>"+(t.label||"")+"</label>").append($(t.toHTML()).attr("id",n)).append("<br />"),e.children()},getHtmlFields:function(t){return t=$(t),s.call(t.find("input")).concat(s.call(t.find("select")),s.call(t.find("textarea")))}},n=function(){function _(t){var e,n,i,r,s,o,a,u,c;if(this.toHTML=l(this.toHTML,this),this.toJSON=l(this.toJSON,this),this.toXML=l(this.toXML,this),this.fields=[],this.items=[],this.reported=[],t)if(o=t.type,0<=S.call(_._types,o)&&(this.type=t.type),this.title=t.title,this.instructions=t.instructions,y.fill=function(t,e,n){var i,r,s,o;for(o=[],r=0,s=t.length;r<s;r++)i=t[r],o.push(e.push(i instanceof n?i:new n(i)));return o},t.fields)t.fields&&y.fill(t.fields,this.fields,g);else if(t.items)for(t.items&&y.fill(t.items,this.items,v),n=0,r=(a=this.items).length;n<r;n++)for(i=0,s=(u=a[n].fields).length;i<s;i++)c=(e=u[i]).var,0<=S.call(this.reported,c)||this.reported.push(e.var)}return _._types=["form","submit","cancel","result"],_.prototype.type="form",_.prototype.title=null,_.prototype.instructions=null,_.prototype.toXML=function(){var t,e,n,i,r,s,o,a,u,c,l,h,d;if(i=$build("x",{xmlns:"jabber:x:data",type:this.type}),this.title&&i.c("title").t(this.title.toString()).up(),this.instructions&&i.c("instructions").t(this.instructions.toString()).up(),0<this.fields.length)for(r=0,a=(l=this.fields).length;r<a;r++)t=l[r],i.cnode(t.toXML()).up();else if(0<this.items.length){for(i.c("reported"),s=0,u=(h=this.reported).length;s<u;s++)n=h[s],i.c("field",{var:n}).up();for(i.up(),o=0,c=(d=this.items).length;o<c;o++)e=d[o],i.cnode(e.toXML()).up()}return i.tree()},_.prototype.toJSON=function(){var t,e,n,i,r,s,o,a,u;if(n={type:this.type},this.title&&(n.title=this.title),this.instructions&&(n.instructions=this.instructions),0<this.fields.length)for(n.fields=[],i=0,s=(a=this.fields).length;i<s;i++)t=a[i],n.fields.push(t.toJSON());else if(0<this.items.length)for(n.items=[],n.reported=this.reported,r=0,o=(u=this.items).length;r<o;r++)e=u[r],n.items.push(e.toJSON());return n},_.prototype.toHTML=function(){var t,e,n,i,r,s,o,a,u;if(e=$("<form data-type='"+this.type+"'>"),this.title&&e.append("<h1>"+this.title+"</h1>"),this.instructions&&e.append("<p>"+this.instructions+"</p>"),0<this.fields.length)for(i=0,s=(a=this.fields).length;i<s;i++)t=a[i],y.createHtmlFieldCouple(t).appendTo(e);else if(0<this.items.length)for(r=0,o=(u=this.items).length;r<o;r++)n=u[r],$(n.toHTML()).appendTo(e);return e[0]},_.fromXML=function(t){var e,i,r,n,s,o,a,u,c;return e=new _({type:(t=$(t)).attr("type")}),1===(c=t.find("title")).length&&(e.title=c.text()),1===(n=t.find("instructions")).length&&(e.instructions=n.text()),i=t.find("field"),0<(s=t.find("item")).length?e.items=function(){var t,e,n;for(n=[],t=0,e=s.length;t<e;t++)r=s[t],n.push(v.fromXML(r));return n}():0<i.length&&(e.fields=function(){var t,e,n;for(n=[],t=0,e=i.length;t<e;t++)o=i[t],n.push(g.fromXML(o));return n}()),1===(u=t.find("reported")).length&&(i=u.find("field"),e.reported=function(){var t,e,n;for(n=[],t=0,e=i.length;t<e;t++)a=i[t],n.push($(a).attr("var"));return n}()),e},_.fromHTML=function(t){var e,n,i,r,s,o,a,u,c,l,h,d,f,p,m;if(e=new _({type:(t=$(t)).attr("data-type")}),(u=t.find("h1").text())&&(e.title=u),(s=t.find("p").text())&&(e.instructions=s),o=t.find("fieldset"),i=y.getHtmlFields(t),0<o.length)for(e.items=function(){var t,e,n;for(n=[],t=0,e=o.length;t<e;t++)r=o[t],n.push(v.fromHTML(r));return n}(),c=0,h=(f=e.items).length;c<h;c++)for(l=0,d=(p=f[c].fields).length;l<d;l++)m=(n=p[l]).var,0<=S.call(e.reported,m)||e.reported.push(n.var);else 0<i.length&&(e.fields=function(){var t,e,n;for(n=[],t=0,e=i.length;t<e;t++)a=i[t],n.push(g.fromHTML(a));return n}());return e},_}(),g=function(){function a(t){var e,n;this.toHTML=l(this.toHTML,this),this.toXML=l(this.toXML,this),this.toJSON=l(this.toJSON,this),this.addOptions=l(this.addOptions,this),this.addOption=l(this.addOption,this),this.addValues=l(this.addValues,this),this.addValue=l(this.addValue,this),this.options=[],this.values=[],t&&(e=t.type,0<=S.call(a._types,e)&&(this.type=t.type.toString()),t.desc&&(this.desc=t.desc.toString()),t.label&&(this.label=t.label.toString()),this.var=(null!=(n=t.var)?n.toString():void 0)||"_no_var_was_defined_",this.required=!0===t.required||"true"===t.required,t.options&&this.addOptions(t.options),t.value&&(t.values=[t.value]),t.values&&this.addValues(t.values))}return a._types=["boolean","fixed","hidden","jid-multi","jid-single","list-multi","list-single","text-multi","text-private","text-single"],a._multiTypes=["list-multi","jid-multi","text-multi","hidden"],a.prototype.type="text-single",a.prototype.desc=null,a.prototype.label=null,a.prototype.var="_no_var_was_defined_",a.prototype.required=!1,a.prototype.addValue=function(t){return this.addValues([t])},a.prototype.addValues=function(i){var t,r,e;return e=this.type,((t=0<=S.call(a._multiTypes,e))||!t&&1===i.length)&&(this.values=s.call(this.values).concat(s.call(function(){var t,e,n;for(n=[],t=0,e=i.length;t<e;t++)r=i[t],n.push(r.toString());return n}()))),this},a.prototype.addOption=function(t){return this.addOptions([t])},a.prototype.addOptions=function(i){var r;return"list-single"!==this.type&&"list-multi"!==this.type||("object"!=typeof i[0]&&(i=function(){var t,e,n;for(n=[],t=0,e=i.length;t<e;t++)r=i[t],n.push(new u({value:r.toString()}));return n}()),y.fill(i,this.options,u)),this},a.prototype.toJSON=function(){var t,e,n,i,r;if(t={type:this.type,var:this.var,required:this.required},this.desc&&(t.desc=this.desc),this.label&&(t.label=this.label),this.values&&(t.values=this.values),this.options)for(t.options=[],n=0,i=(r=this.options).length;n<i;n++)e=r[n],t.options.push(e.toJSON());return t},a.prototype.toXML=function(){var t,e,n,i,r,s,o,a,u,c;if(t={type:this.type,var:this.var},this.label&&(t.label=this.label),i=$build("field",t),this.desc&&i.c("desc").t(this.desc).up(),this.required&&i.c("required").up(),this.values)for(r=0,o=(u=this.values).length;r<o;r++)n=u[r],i.c("value").t(n.toString()).up();if(this.options)for(s=0,a=(c=this.options).length;s<a;s++)e=c[s],i.cnode(e.toXML()).up();return i.tree()},a.prototype.toHTML=function(){var t,r,e,n,i,s,o,a,u,c,l,h,d;switch(this.type.toLowerCase()){case"list-single":case"list-multi":if(t=$("<select>"),"list-multi"===this.type&&t.attr("multiple","multiple"),0<this.options.length)for(o=0,u=(l=this.options).length;o<u;o++)if(n=l[o]){for(e=$(n.toHTML()),a=0,c=(h=this.values).length;a<c;a++)h[a].toString()===n.value.toString()&&e.attr("selected","selected");e.appendTo(t)}break;case"text-multi":case"jid-multi":t=$("<textarea>"),(i=function(){var t,e,n,i;for(i=[],t=0,e=(n=this.values).length;t<e;t++)r=n[t],i.push(r);return i}.call(this).join("\n"))&&t.text(i);break;case"text-single":case"boolean":case"text-private":case"hidden":case"fixed":case"jid-single":switch(t=$("<input>"),this.values&&t.val(this.values[0]),this.type.toLowerCase()){case"text-single":t.attr("type","text"),t.attr("placeholder",this.desc);break;case"boolean":t.attr("type","checkbox"),!(s=null!=(d=this.values[0])&&"function"==typeof d.toString?d.toString():void 0)||"true"!==s&&"1"!==s||t.attr("checked","checked");break;case"text-private":t.attr("type","password");break;case"hidden":t.attr("type","hidden");break;case"fixed":t.attr("type","text").attr("readonly","readonly");break;case"jid-single":t.attr("type","email")}break;default:t=$("<input type='text'>")}return t.attr("name",this.var),this.required&&t.attr("required",this.required),t[0]},a.fromXML=function(r){var s,o;return new a({type:(r=$(r)).attr("type"),var:r.attr("var"),label:r.attr("label"),desc:r.find("desc").text(),required:1===r.find("required").length,values:function(){var t,e,n,i;for(i=[],t=0,e=(n=r.find(">value")).length;t<e;t++)o=n[t],i.push($(o).text());return i}(),options:function(){var t,e,n,i;for(i=[],t=0,e=(n=r.find("option")).length;t<e;t++)s=n[t],i.push(u.fromXML(s));return i}()})},a._htmlElementToFieldType=function(t){var e;switch((t=$(t))[0].nodeName.toLowerCase()){case"textarea":e="text-multi";break;case"select":e="multiple"===t.attr("multiple")?"list-multi":"list-single";break;case"input":switch(t.attr("type")){case"checkbox":e="boolean";break;case"email":e="jid-single";break;case"hidden":e="hidden";break;case"password":e="text-private";break;case"text":e="readonly"===t.attr("readonly")?"fixed":"text-single"}}return e},a.fromHTML=function(r){var s,t,e,n;switch(r=$(r),t=new a({type:n=a._htmlElementToFieldType(r),var:r.attr("name"),required:"required"===r.attr("required")}),n){case"list-multi":case"list-single":t.values=function(){var t,e,n,i;for(i=[],t=0,e=(n=r.find("option:selected")).length;t<e;t++)s=n[t],i.push($(s).val());return i}(),t.options=function(){var t,e,n,i;for(i=[],t=0,e=(n=r.find("option")).length;t<e;t++)s=n[t],i.push(u.fromHTML(s));return i}();break;case"text-multi":case"jid-multi":""!==(e=r.text()).trim()&&(t.values=e.split("\n"));break;case"text-single":case"boolean":case"text-private":case"hidden":case"fixed":case"jid-single":""!==r.val().trim()&&(t.values=[r.val()])}return t},a}(),u=function(){function e(t){this.toHTML=l(this.toHTML,this),this.toJSON=l(this.toJSON,this),this.toXML=l(this.toXML,this),t&&(t.label&&(this.label=t.label.toString()),t.value&&(this.value=t.value.toString()))}return e.prototype.label="",e.prototype.value="",e.prototype.toXML=function(){return $build("option",{label:this.label}).c("value").t(this.value.toString()).tree()},e.prototype.toJSON=function(){return{label:this.label,value:this.value}},e.prototype.toHTML=function(){return $("<option>").attr("value",this.value).text(this.label||this.value)[0]},e.fromXML=function(t){return new e({label:$(t).attr("label"),value:$(t).text()})},e.fromHTML=function(t){return new e({value:$(t).attr("value"),label:$(t).text()})},e}(),v=function(){function e(t){this.toHTML=l(this.toHTML,this),this.toJSON=l(this.toJSON,this),this.toXML=l(this.toXML,this),this.fields=[],(null!=t?t.fields:void 0)&&y.fill(t.fields,this.fields,g)}return e.prototype.toXML=function(){var t,e,n,i,r;for(e=$build("item"),n=0,i=(r=this.fields).length;n<i;n++)t=r[n],e.cnode(t.toXML()).up();return e.tree()},e.prototype.toJSON=function(){var t,e,n,i,r;if(e={},this.fields)for(e.fields=[],n=0,i=(r=this.fields).length;n<i;n++)t=r[n],e.fields.push(t.toJSON());return e},e.prototype.toHTML=function(){var t,e,n,i,r;for(e=$("<fieldset>"),n=0,i=(r=this.fields).length;n<i;n++)t=r[n],y.createHtmlFieldCouple(t).appendTo(e);return e[0]},e.fromXML=function(t){var i,r;return t=$(t),r=t.find("field"),new e({fields:function(){var t,e,n;for(n=[],t=0,e=r.length;t<e;t++)i=r[t],n.push(g.fromXML(i));return n}()})},e.fromHTML=function(r){var s;return new e({fields:function(){var t,e,n,i;for(i=[],t=0,e=(n=y.getHtmlFields(r)).length;t<e;t++)s=n[t],i.push(g.fromHTML(s));return i}()})},e}(),Strophe.x={Form:n,Field:g,Option:u,Item:v},Strophe.addConnectionPlugin("x",{init:function(t){var e,n;if(Strophe.addNamespace("DATA","jabber:x:data"),null!=(null!=(e=t.disco)?e.addFeature:void 0)&&t.disco.addFeature(Strophe.NS.DATA),null!=(null!=(n=t.disco)?n.addNode:void 0))return t.disco.addNode(Strophe.NS.DATA,{items:[]})},parseFromResult:function(t){var e;return"x"===t.nodeName.toLowerCase()?n.fromXML(t):n.fromXML(null!=(e=$(t).find("x"))?e[0]:void 0)}})}.call(this),Strophe.addConnectionPlugin("receipts",{_conn:null,_msgQueue:{},_retries:{},_resendCount:10,_resendTime:9e3,init:function(t){this._conn=t,Strophe.addNamespace("RECEIPTS","urn:xmpp:receipts")},statusChanged:function(t){if(t===Strophe.Status.CONNECTED||t===Strophe.Status.ATTACHED){var e=this;setTimeout(function(){e.resendQueue()},5e3)}},sendMessage:function(t){var e=this._conn.getUniqueId();t.tree().setAttribute("id",e);var n=Strophe.xmlElement("request",{xmlns:Strophe.NS.RECEIPTS});return t.tree().appendChild(n),this._msgQueue[e]=t,this._retries[e]=0,this._conn.send(t),this.resendMessage(e),e},resendMessage:function(t){var e=this;setTimeout(function(){if(e._msgQueue[t]){if(!e._conn.connected)return void e.resendMessage(t);if(e._retries[t]++,e._retries[t]>e._resendCount)return;e._msgQueue[t].tree().setAttribute("from",e._conn.jid),e._conn.send(e._msgQueue[t]),e.resendMessage(t)}},this._resendTime)},addReceiptHandler:function(e,t,n,i){var r=this;this._conn.addHandler(function(t){return r._processReceipt(t),e(t)},Strophe.NS.RECEIPTS,"message",t,null,n,i)},_processReceipt:function(t){var e=t.getAttribute("id"),n=t.getAttribute("from"),i=t.getElementsByTagName("request"),r=t.getElementsByTagName("received");if(0<i.length){var s=$msg({to:n,from:this._conn.jid,id:this._conn.getUniqueId()}),o=Strophe.xmlElement("received",{xmlns:Strophe.NS.RECEIPTS,id:e});s.tree().appendChild(o),this._conn.send(s)}if(0<r.length){var a=r[0].getAttribute("id");a&&(delete this._msgQueue[a],delete this._retries[a])}},resendQueue:function(){if(this._conn.connected)for(var t in this._msgQueue)this._msgQueue.hasOwnProperty(t)&&this._conn.send(this._msgQueue[t]);else{var e=this;setTimeout(function(){e.resendQueue()},5e3)}},getUnreceivedMsgs:function(){var t=[];for(var e in this._msgQueue)this._msgQueue.hasOwnProperty(e)&&t.push(this._msgQueue[e]);return t},clearMessages:function(){this._msgQueue={}}}),function(){"use strict";Strophe.addConnectionPlugin("mam",{_c:null,_p:["with","start","end"],init:function(t){this._c=t,Strophe.addNamespace("MAM","urn:xmpp:mam:0")},query:function(t,e){var n=this._p,i={type:"set",id:t},r={xmlns:Strophe.NS.MAM};e.queryid&&(r.queryid=e.queryid,delete e.queryid);var s,o=$iq(i).c("query",r).c("x",{xmlns:"jabber:x:data"});for(o.c("field",{var:"FORM_TYPE"}).c("value").t("urn:xmpp:mam:0").up().up(),s=0;s<this._p.length;s++){var a=n[s],u=e[a];delete e[a],u&&o.c("field",{var:a}).c("value").t(u).up().up()}o.up();var c=e.onMessage;delete e.onMessage;var l=e.onComplete;return delete e.onComplete,o.cnode(new Strophe.RSM(e).toXML()),this._c.addHandler(c,Strophe.NS.MAM,"message",null),this._c.sendIQ(o,l)}})}(),Strophe.addNamespace("RSM","http://jabber.org/protocol/rsm"),Strophe.RSM=function(t){if(this.attribs=["max","first","last","after","before","index","count"],void 0!==t.xml)this.fromXMLElement(t.xml);else for(var e=0;e<this.attribs.length;e++){var n=this.attribs[e];this[n]=t[n]}},Strophe.RSM.prototype={toXML:function(){for(var t=$build("set",{xmlns:Strophe.NS.RSM}),e=0;e<this.attribs.length;e++){var n=this.attribs[e];void 0!==this[n]&&(t=t.c(n).t(this[n].toString()).up())}return t.tree()},next:function(t){return new Strophe.RSM({max:t,after:this.last})},previous:function(t){return new Strophe.RSM({max:t,before:this.first})},fromXMLElement:function(t){for(var e=0;e<this.attribs.length;e++){var n=this.attribs[e],i=t.getElementsByTagName(n)[0];null!=i&&(this[n]=Strophe.getText(i),"first"==n&&(this.index=i.getAttribute("index")))}}},Strophe.addConnectionPlugin("streamManagement",{logging:!0,returnWholeStanza:!1,autoSendCountOnEveryIncomingStanza:!1,requestResponseInterval:5,_c:null,_NS:"urn:xmpp:sm:3",_isStreamManagementEnabled:!1,_serverProcesssedStanzasCounter:null,_clientProcessedStanzasCounter:null,_clientSentStanzasCounter:null,_originalXMLOutput:null,_requestHandler:null,_incomingHandler:null,_requestResponseIntervalCount:0,_unacknowledgedStanzas:[],_acknowledgedStanzaListeners:[],addAcknowledgedStanzaListener:function(t){this._acknowledgedStanzaListeners.push(t)},enable:function(){this._c.send($build("enable",{xmlns:this._NS,resume:!1})),this._c.flush(),this._c.pause()},requestAcknowledgement:function(){this._requestResponseIntervalCount=0,this._c.send($build("r",{xmlns:this._NS}))},getOutgoingCounter:function(){return this._clientSentStanzasCounter},getIncomingCounter:function(){return this._clientProcessedStanzasCounter},init:function(t){this._c=t,Strophe.addNamespace("SM",this._NS),this._originalXMLOutput=this._c.xmlOutput,this._c.xmlOutput=this.xmlOutput.bind(this)},statusChanged:function(t){t!==Strophe.Status.CONNECTED&&t!==Strophe.Status.DISCONNECTED||(this._serverProcesssedStanzasCounter=0,this._clientProcessedStanzasCounter=0,this._clientSentStanzasCounter=0,this._isStreamManagementEnabled=!1,this._requestResponseIntervalCount=0,this._unacknowledgedStanzas=[],this._requestHandler&&this._c.deleteHandler(this._requestHandler),this._incomingHandler&&this._c.deleteHandler(this._incomingHandler),this._requestHandler=this._c.addHandler(this._handleServerRequestHandler.bind(this),this._NS,"r"),this._incomingHandler=this._c.addHandler(this._incomingStanzaHandler.bind(this)))},xmlOutput:function(t){for(var e,n=0;n<t.children.length;n++)e=t.children[n],(Strophe.isTagEqual(e,"iq")||Strophe.isTagEqual(e,"presence")||Strophe.isTagEqual(e,"message"))&&this._increaseSentStanzasCounter(e);return this._originalXMLOutput.call(this._c,t)},_incomingStanzaHandler:function(t){if(Strophe.isTagEqual(t,"enabled")&&t.getAttribute("xmlns")===this._NS&&(this._isStreamManagementEnabled=!0,this._c.resume()),(Strophe.isTagEqual(t,"iq")||Strophe.isTagEqual(t,"presence")||Strophe.isTagEqual(t,"message"))&&(this._increaseReceivedStanzasCounter(),this.autoSendCountOnEveryIncomingStanza&&this._answerProcessedStanzas()),Strophe.isTagEqual(t,"a")){var e=parseInt(t.getAttribute("h"));this._handleAcknowledgedStanzas(e,this._serverProcesssedStanzasCounter),this._serverProcesssedStanzasCounter=e,0<this.requestResponseInterval&&(this._requestResponseIntervalCount=0)}return!0},_handleAcknowledgedStanzas:function(t,e){var n=t-e;n<0&&this._throwError("New reported stanza count lower than previous. New: "+t+" - Previous: "+e),n>this._unacknowledgedStanzas.length&&this._throwError("Higher reported acknowledge count than unacknowledged stanzas. Reported Acknowledge Count: "+n+" - Unacknowledge Stanza Count: "+this._unacknowledgedStanzas.length+" - New: "+t+" - Previous: "+e);for(var i=0;i<n;i++)for(var r=this._unacknowledgedStanzas.shift(),s=0;s<this._acknowledgedStanzaListeners.length;s++)this._acknowledgedStanzaListeners[s](r);this.logging&&0<this._unacknowledgedStanzas.length&&console.warn("Unacknowledged stanzas",this._unacknowledgedStanzas)},_handleServerRequestHandler:function(){return this._answerProcessedStanzas(),!0},_answerProcessedStanzas:function(){this._isStreamManagementEnabled&&this._c.send($build("a",{xmlns:this._NS,h:this._clientProcessedStanzasCounter}))},_increaseSentStanzasCounter:function(t){this._isStreamManagementEnabled&&(this._unacknowledgedStanzas.push(this.returnWholeStanza?t:t.getAttribute("id")),this._clientSentStanzasCounter++,0<this.requestResponseInterval&&(this._requestResponseIntervalCount++,this._requestResponseIntervalCount===this.requestResponseInterval&&this.requestAcknowledgement()))},_increaseReceivedStanzasCounter:function(){this._isStreamManagementEnabled&&this._clientProcessedStanzasCounter++},_throwError:function(t){throw console.error(t),new Error(t)}}),function(e,r){var t=function(t,e){this.disco=t,r.extend(this,e)};t.prototype.parseRequest=function(t){return t.tree?r(e.serialize(t.tree())):r(t)},t.prototype.fromTo=function(t){var e=t.attr("from"),n=t.attr("id");return $iq({to:e,type:"result",id:n})},t.prototype.addFirstChild=function(t,e){var n=t.find("> *:eq(0)"),i={};0!==n.length&&(n.attr("xmlns")&&(i.xmlns=n.attr("xmlns")),n.attr("node")&&(i.node=n.attr("node")),r.isEmptyObject(i)?e.c(n[0].tagName):e.c(n[0].tagName,i))},t.prototype.reply=function(t){var e=this.parseRequest(t),n=this.fromTo(e);return this.addFirstChild(e,n),this.addContent(e,n),n},DiscoInfoNode=function(){t.apply(this,arguments)},DiscoInfoNode.prototype=new t,DiscoInfoNode.prototype.addContent=function(t,e){var n=this.features||this.disco.features,i=this.identity||this.disco.identity;e.c("identity",i).up(),r.each(n,function(t){e.c("feature",{var:t}).up()})},DiscoItemsNode=function(){t.apply(this,arguments)},DiscoItemsNode.prototype=new t,DiscoItemsNode.prototype.addContent=function(t,n){var e=this.items||this.disco.items;r.each(e,function(t,e){e.jid||(e.jid=this.disco._conn.jid),n.c("item",e).up()}.bind(this))},DiscoNodeNotFound=function(){t.apply(this,arguments)},DiscoNodeNotFound.prototype=new t,DiscoNodeNotFound.prototype.addContent=function(t,e){e.c("error",{type:"cancel"}),e.c("item-not-found",{xmlns:"urn:ietf:params:xml:ns:xmpp-stanzas"})},e.Disco={DiscoNode:t,DiscoInfoNode:DiscoInfoNode,DiscoNodeNotFound:DiscoNodeNotFound,noop:function(t){console&&console.log(t)}}}(Strophe,jQuery),function(e,i){var r=e.NS.DISCO_INFO,s=e.NS.DISCO_ITEMS,o=(e.Disco.DiscoNode,e.Disco.DiscoInfoNode),a=e.Disco.DiscoNodeNotFound,c=e.Disco.noop;function u(t,e,n){var i=n[0],r=n[1],s=n[2],o=n[3],a={xmlns:e};"function"==typeof r&&(o=s,s=r,r=void 0),r&&(a.node=r);var u=$iq({to:i,type:"get"}).c("query",a);t.sendIQ(u,s||c,o||c)}function n(t){var e=i("query",t).attr("node")||i("query",t).attr("xmlns"),n=this.features[e]||new a;i.isPlainObject(n)&&(n=new(i("query",t).attr("xmlns")===r?o:DiscoItemsNode)(this,n));return this._conn.send(n.reply(t)),!0}var t={_conn:null,init:function(t){this.jid=t.jid,this.features={},this.identity={name:"strophe"},this.features[r]=new o(this),this.features[s]=new DiscoItemsNode(this),this._conn=t},statusChanged:function(t){t===e.Status.CONNECTED&&(this._conn.addHandler(n.bind(this),r,"iq","get"),this._conn.addHandler(n.bind(this),s,"iq","get"))},info:function(t,e,n){u(this._conn,r,arguments)},items:function(t,e,n){u(this._conn,s,arguments)},addNode:function(t,e){if(this.features[t])throw t+" exists";this.features[t]=e}};e.addConnectionPlugin("disco",t)}(Strophe,jQuery),function(){var g,n,v,u,y,s=[].slice,l=function(t,e){return function(){return t.apply(e,arguments)}},S=[].indexOf||function(t){for(var e=0,n=this.length;e<n;e++)if(e in this&&this[e]===t)return e;return-1};y={fill:function(t,e,n){var i,r,s,o;for(o=[],r=0,s=t.length;r<s;r++)i=t[r],o.push(e.push(i instanceof n?i:new n(i)));return o},createHtmlFieldCouple:function(t){var e,n;return e=$("<div>"),n="Strophe.x.Field-"+t.type+"-"+t.var,e.append("<label for='"+n+"'>"+(t.label||"")+"</label>").append($(t.toHTML()).attr("id",n)).append("<br />"),e.children()},getHtmlFields:function(t){return t=$(t),s.call(t.find("input")).concat(s.call(t.find("select")),s.call(t.find("textarea")))}},n=function(){function _(t){var e,n,i,r,s,o,a,u,c;if(this.toHTML=l(this.toHTML,this),this.toJSON=l(this.toJSON,this),this.toXML=l(this.toXML,this),this.fields=[],this.items=[],this.reported=[],t)if(o=t.type,0<=S.call(_._types,o)&&(this.type=t.type),this.title=t.title,this.instructions=t.instructions,y.fill=function(t,e,n){var i,r,s,o;for(o=[],r=0,s=t.length;r<s;r++)i=t[r],o.push(e.push(i instanceof n?i:new n(i)));return o},t.fields)t.fields&&y.fill(t.fields,this.fields,g);else if(t.items)for(t.items&&y.fill(t.items,this.items,v),n=0,r=(a=this.items).length;n<r;n++)for(i=0,s=(u=a[n].fields).length;i<s;i++)c=(e=u[i]).var,0<=S.call(this.reported,c)||this.reported.push(e.var)}return _._types=["form","submit","cancel","result"],_.prototype.type="form",_.prototype.title=null,_.prototype.instructions=null,_.prototype.toXML=function(){var t,e,n,i,r,s,o,a,u,c,l,h,d;if(i=$build("x",{xmlns:"jabber:x:data",type:this.type}),this.title&&i.c("title").t(this.title.toString()).up(),this.instructions&&i.c("instructions").t(this.instructions.toString()).up(),0<this.fields.length)for(r=0,a=(l=this.fields).length;r<a;r++)t=l[r],i.cnode(t.toXML()).up();else if(0<this.items.length){for(i.c("reported"),s=0,u=(h=this.reported).length;s<u;s++)n=h[s],i.c("field",{var:n}).up();for(i.up(),o=0,c=(d=this.items).length;o<c;o++)e=d[o],i.cnode(e.toXML()).up()}return i.tree()},_.prototype.toJSON=function(){var t,e,n,i,r,s,o,a,u;if(n={type:this.type},this.title&&(n.title=this.title),this.instructions&&(n.instructions=this.instructions),0<this.fields.length)for(n.fields=[],i=0,s=(a=this.fields).length;i<s;i++)t=a[i],n.fields.push(t.toJSON());else if(0<this.items.length)for(n.items=[],n.reported=this.reported,r=0,o=(u=this.items).length;r<o;r++)e=u[r],n.items.push(e.toJSON());return n},_.prototype.toHTML=function(){var t,e,n,i,r,s,o,a,u;if(e=$("<form data-type='"+this.type+"'>"),this.title&&e.append("<h1>"+this.title+"</h1>"),this.instructions&&e.append("<p>"+this.instructions+"</p>"),0<this.fields.length)for(i=0,s=(a=this.fields).length;i<s;i++)t=a[i],y.createHtmlFieldCouple(t).appendTo(e);else if(0<this.items.length)for(r=0,o=(u=this.items).length;r<o;r++)n=u[r],$(n.toHTML()).appendTo(e);return e[0]},_.fromXML=function(t){var e,i,r,n,s,o,a,u,c;return e=new _({type:(t=$(t)).attr("type")}),1===(c=t.find("title")).length&&(e.title=c.text()),1===(n=t.find("instructions")).length&&(e.instructions=n.text()),i=t.find("field"),0<(s=t.find("item")).length?e.items=function(){var t,e,n;for(n=[],t=0,e=s.length;t<e;t++)r=s[t],n.push(v.fromXML(r));return n}():0<i.length&&(e.fields=function(){var t,e,n;for(n=[],t=0,e=i.length;t<e;t++)o=i[t],n.push(g.fromXML(o));return n}()),1===(u=t.find("reported")).length&&(i=u.find("field"),e.reported=function(){var t,e,n;for(n=[],t=0,e=i.length;t<e;t++)a=i[t],n.push($(a).attr("var"));return n}()),e},_.fromHTML=function(t){var e,n,i,r,s,o,a,u,c,l,h,d,f,p,m;if(e=new _({type:(t=$(t)).attr("data-type")}),(u=t.find("h1").text())&&(e.title=u),(s=t.find("p").text())&&(e.instructions=s),o=t.find("fieldset"),i=y.getHtmlFields(t),0<o.length)for(e.items=function(){var t,e,n;for(n=[],t=0,e=o.length;t<e;t++)r=o[t],n.push(v.fromHTML(r));return n}(),c=0,h=(f=e.items).length;c<h;c++)for(l=0,d=(p=f[c].fields).length;l<d;l++)m=(n=p[l]).var,0<=S.call(e.reported,m)||e.reported.push(n.var);else 0<i.length&&(e.fields=function(){var t,e,n;for(n=[],t=0,e=i.length;t<e;t++)a=i[t],n.push(g.fromHTML(a));return n}());return e},_}(),g=function(){function a(t){var e,n;this.toHTML=l(this.toHTML,this),this.toXML=l(this.toXML,this),this.toJSON=l(this.toJSON,this),this.addOptions=l(this.addOptions,this),this.addOption=l(this.addOption,this),this.addValues=l(this.addValues,this),this.addValue=l(this.addValue,this),this.options=[],this.values=[],t&&(e=t.type,0<=S.call(a._types,e)&&(this.type=t.type.toString()),t.desc&&(this.desc=t.desc.toString()),t.label&&(this.label=t.label.toString()),this.var=(null!=(n=t.var)?n.toString():void 0)||"_no_var_was_defined_",this.required=!0===t.required||"true"===t.required,t.options&&this.addOptions(t.options),t.value&&(t.values=[t.value]),t.values&&this.addValues(t.values))}return a._types=["boolean","fixed","hidden","jid-multi","jid-single","list-multi","list-single","text-multi","text-private","text-single"],a._multiTypes=["list-multi","jid-multi","text-multi","hidden"],a.prototype.type="text-single",a.prototype.desc=null,a.prototype.label=null,a.prototype.var="_no_var_was_defined_",a.prototype.required=!1,a.prototype.addValue=function(t){return this.addValues([t])},a.prototype.addValues=function(i){var t,r,e;return e=this.type,((t=0<=S.call(a._multiTypes,e))||!t&&1===i.length)&&(this.values=s.call(this.values).concat(s.call(function(){var t,e,n;for(n=[],t=0,e=i.length;t<e;t++)r=i[t],n.push(r.toString());return n}()))),this},a.prototype.addOption=function(t){return this.addOptions([t])},a.prototype.addOptions=function(i){var r;return"list-single"!==this.type&&"list-multi"!==this.type||("object"!=typeof i[0]&&(i=function(){var t,e,n;for(n=[],t=0,e=i.length;t<e;t++)r=i[t],n.push(new u({value:r.toString()}));return n}()),y.fill(i,this.options,u)),this},a.prototype.toJSON=function(){var t,e,n,i,r;if(t={type:this.type,var:this.var,required:this.required},this.desc&&(t.desc=this.desc),this.label&&(t.label=this.label),this.values&&(t.values=this.values),this.options)for(t.options=[],n=0,i=(r=this.options).length;n<i;n++)e=r[n],t.options.push(e.toJSON());return t},a.prototype.toXML=function(){var t,e,n,i,r,s,o,a,u,c;if(t={type:this.type,var:this.var},this.label&&(t.label=this.label),i=$build("field",t),this.desc&&i.c("desc").t(this.desc).up(),this.required&&i.c("required").up(),this.values)for(r=0,o=(u=this.values).length;r<o;r++)n=u[r],i.c("value").t(n.toString()).up();if(this.options)for(s=0,a=(c=this.options).length;s<a;s++)e=c[s],i.cnode(e.toXML()).up();return i.tree()},a.prototype.toHTML=function(){var t,r,e,n,i,s,o,a,u,c,l,h,d;switch(this.type.toLowerCase()){case"list-single":case"list-multi":if(t=$("<select>"),"list-multi"===this.type&&t.attr("multiple","multiple"),0<this.options.length)for(o=0,u=(l=this.options).length;o<u;o++)if(n=l[o]){for(e=$(n.toHTML()),a=0,c=(h=this.values).length;a<c;a++)h[a].toString()===n.value.toString()&&e.attr("selected","selected");e.appendTo(t)}break;case"text-multi":case"jid-multi":t=$("<textarea>"),(i=function(){var t,e,n,i;for(i=[],t=0,e=(n=this.values).length;t<e;t++)r=n[t],i.push(r);return i}.call(this).join("\n"))&&t.text(i);break;case"text-single":case"boolean":case"text-private":case"hidden":case"fixed":case"jid-single":switch(t=$("<input>"),this.values&&t.val(this.values[0]),this.type.toLowerCase()){case"text-single":t.attr("type","text"),t.attr("placeholder",this.desc);break;case"boolean":t.attr("type","checkbox"),!(s=null!=(d=this.values[0])&&"function"==typeof d.toString?d.toString():void 0)||"true"!==s&&"1"!==s||t.attr("checked","checked");break;case"text-private":t.attr("type","password");break;case"hidden":t.attr("type","hidden");break;case"fixed":t.attr("type","text").attr("readonly","readonly");break;case"jid-single":t.attr("type","email")}break;default:t=$("<input type='text'>")}return t.attr("name",this.var),this.required&&t.attr("required",this.required),t[0]},a.fromXML=function(r){var s,o;return new a({type:(r=$(r)).attr("type"),var:r.attr("var"),label:r.attr("label"),desc:r.find("desc").text(),required:1===r.find("required").length,values:function(){var t,e,n,i;for(i=[],t=0,e=(n=r.find(">value")).length;t<e;t++)o=n[t],i.push($(o).text());return i}(),options:function(){var t,e,n,i;for(i=[],t=0,e=(n=r.find("option")).length;t<e;t++)s=n[t],i.push(u.fromXML(s));return i}()})},a._htmlElementToFieldType=function(t){var e;switch((t=$(t))[0].nodeName.toLowerCase()){case"textarea":e="text-multi";break;case"select":e="multiple"===t.attr("multiple")?"list-multi":"list-single";break;case"input":switch(t.attr("type")){case"checkbox":e="boolean";break;case"email":e="jid-single";break;case"hidden":e="hidden";break;case"password":e="text-private";break;case"text":e="readonly"===t.attr("readonly")?"fixed":"text-single"}}return e},a.fromHTML=function(r){var s,t,e,n;switch(r=$(r),t=new a({type:n=a._htmlElementToFieldType(r),var:r.attr("name"),required:"required"===r.attr("required")}),n){case"list-multi":case"list-single":t.values=function(){var t,e,n,i;for(i=[],t=0,e=(n=r.find("option:selected")).length;t<e;t++)s=n[t],i.push($(s).val());return i}(),t.options=function(){var t,e,n,i;for(i=[],t=0,e=(n=r.find("option")).length;t<e;t++)s=n[t],i.push(u.fromHTML(s));return i}();break;case"text-multi":case"jid-multi":""!==(e=r.text()).trim()&&(t.values=e.split("\n"));break;case"text-single":case"boolean":case"text-private":case"hidden":case"fixed":case"jid-single":""!==r.val().trim()&&(t.values=[r.val()])}return t},a}(),u=function(){function e(t){this.toHTML=l(this.toHTML,this),this.toJSON=l(this.toJSON,this),this.toXML=l(this.toXML,this),t&&(t.label&&(this.label=t.label.toString()),t.value&&(this.value=t.value.toString()))}return e.prototype.label="",e.prototype.value="",e.prototype.toXML=function(){return $build("option",{label:this.label}).c("value").t(this.value.toString()).tree()},e.prototype.toJSON=function(){return{label:this.label,value:this.value}},e.prototype.toHTML=function(){return $("<option>").attr("value",this.value).text(this.label||this.value)[0]},e.fromXML=function(t){return new e({label:$(t).attr("label"),value:$(t).text()})},e.fromHTML=function(t){return new e({value:$(t).attr("value"),label:$(t).text()})},e}(),v=function(){function e(t){this.toHTML=l(this.toHTML,this),this.toJSON=l(this.toJSON,this),this.toXML=l(this.toXML,this),this.fields=[],(null!=t?t.fields:void 0)&&y.fill(t.fields,this.fields,g)}return e.prototype.toXML=function(){var t,e,n,i,r;for(e=$build("item"),n=0,i=(r=this.fields).length;n<i;n++)t=r[n],e.cnode(t.toXML()).up();return e.tree()},e.prototype.toJSON=function(){var t,e,n,i,r;if(e={},this.fields)for(e.fields=[],n=0,i=(r=this.fields).length;n<i;n++)t=r[n],e.fields.push(t.toJSON());return e},e.prototype.toHTML=function(){var t,e,n,i,r;for(e=$("<fieldset>"),n=0,i=(r=this.fields).length;n<i;n++)t=r[n],y.createHtmlFieldCouple(t).appendTo(e);return e[0]},e.fromXML=function(t){var i,r;return t=$(t),r=t.find("field"),new e({fields:function(){var t,e,n;for(n=[],t=0,e=r.length;t<e;t++)i=r[t],n.push(g.fromXML(i));return n}()})},e.fromHTML=function(r){var s;return new e({fields:function(){var t,e,n,i;for(i=[],t=0,e=(n=y.getHtmlFields(r)).length;t<e;t++)s=n[t],i.push(g.fromHTML(s));return i}()})},e}(),Strophe.x={Form:n,Field:g,Option:u,Item:v},Strophe.addConnectionPlugin("x",{init:function(t){var e,n;if(Strophe.addNamespace("DATA","jabber:x:data"),null!=(null!=(e=t.disco)?e.addFeature:void 0)&&t.disco.addFeature(Strophe.NS.DATA),null!=(null!=(n=t.disco)?n.addNode:void 0))return t.disco.addNode(Strophe.NS.DATA,{items:[]})},parseFromResult:function(t){var e;return"x"===t.nodeName.toLowerCase()?n.fromXML(t):n.fromXML(null!=(e=$(t).find("x"))?e[0]:void 0)}})}.call(this),Strophe.addConnectionPlugin("receipts",{_conn:null,_msgQueue:{},_retries:{},_resendCount:10,_resendTime:9e3,init:function(t){this._conn=t,Strophe.addNamespace("RECEIPTS","urn:xmpp:receipts")},statusChanged:function(t){if(t===Strophe.Status.CONNECTED||t===Strophe.Status.ATTACHED){var e=this;setTimeout(function(){e.resendQueue()},5e3)}},sendMessage:function(t){var e=this._conn.getUniqueId();t.tree().setAttribute("id",e);var n=Strophe.xmlElement("request",{xmlns:Strophe.NS.RECEIPTS});return t.tree().appendChild(n),this._msgQueue[e]=t,this._retries[e]=0,this._conn.send(t),this.resendMessage(e),e},resendMessage:function(t){var e=this;setTimeout(function(){if(e._msgQueue[t]){if(!e._conn.connected)return void e.resendMessage(t);if(e._retries[t]++,e._retries[t]>e._resendCount)return;e._msgQueue[t].tree().setAttribute("from",e._conn.jid),e._conn.send(e._msgQueue[t]),e.resendMessage(t)}},this._resendTime)},addReceiptHandler:function(e,t,n,i){var r=this;this._conn.addHandler(function(t){return r._processReceipt(t),e(t)},Strophe.NS.RECEIPTS,"message",t,null,n,i)},_processReceipt:function(t){var e=t.getAttribute("id"),n=t.getAttribute("from"),i=t.getElementsByTagName("request"),r=t.getElementsByTagName("received");if(0<i.length){var s=$msg({to:n,from:this._conn.jid,id:this._conn.getUniqueId()}),o=Strophe.xmlElement("received",{xmlns:Strophe.NS.RECEIPTS,id:e});s.tree().appendChild(o),this._conn.send(s)}if(0<r.length){var a=r[0].getAttribute("id");a&&(delete this._msgQueue[a],delete this._retries[a])}},resendQueue:function(){if(this._conn.connected)for(var t in this._msgQueue)this._msgQueue.hasOwnProperty(t)&&this._conn.send(this._msgQueue[t]);else{var e=this;setTimeout(function(){e.resendQueue()},5e3)}},getUnreceivedMsgs:function(){var t=[];for(var e in this._msgQueue)this._msgQueue.hasOwnProperty(e)&&t.push(this._msgQueue[e]);return t},clearMessages:function(){this._msgQueue={}}}),function(){"use strict";Strophe.addConnectionPlugin("mam",{_c:null,_p:["with","start","end"],init:function(t){this._c=t,Strophe.addNamespace("MAM","urn:xmpp:mam:0")},query:function(t,e){var n=this._p,i={type:"set",id:t},r={xmlns:Strophe.NS.MAM};e.queryid&&(r.queryid=e.queryid,delete e.queryid);var s,o=$iq(i).c("query",r).c("x",{xmlns:"jabber:x:data"});for(o.c("field",{var:"FORM_TYPE"}).c("value").t("urn:xmpp:mam:0").up().up(),s=0;s<this._p.length;s++){var a=n[s],u=e[a];delete e[a],u&&o.c("field",{var:a}).c("value").t(u).up().up()}o.up();var c=e.onMessage;delete e.onMessage;var l=e.onComplete;return delete e.onComplete,o.cnode(new Strophe.RSM(e).toXML()),this._c.addHandler(c,Strophe.NS.MAM,"message",null),this._c.sendIQ(o,l)}})}(),Strophe.addNamespace("RSM","http://jabber.org/protocol/rsm"),Strophe.RSM=function(t){if(this.attribs=["max","first","last","after","before","index","count"],void 0!==t.xml)this.fromXMLElement(t.xml);else for(var e=0;e<this.attribs.length;e++){var n=this.attribs[e];this[n]=t[n]}},Strophe.RSM.prototype={toXML:function(){for(var t=$build("set",{xmlns:Strophe.NS.RSM}),e=0;e<this.attribs.length;e++){var n=this.attribs[e];void 0!==this[n]&&(t=t.c(n).t(this[n].toString()).up())}return t.tree()},next:function(t){return new Strophe.RSM({max:t,after:this.last})},previous:function(t){return new Strophe.RSM({max:t,before:this.first})},fromXMLElement:function(t){for(var e=0;e<this.attribs.length;e++){var n=this.attribs[e],i=t.getElementsByTagName(n)[0];null!=i&&(this[n]=Strophe.getText(i),"first"==n&&(this.index=i.getAttribute("index")))}}};
!function(e){if("object"==typeof exports&&"undefined"!=typeof module)module.exports=e();else if("function"==typeof define&&define.amd)define([],e);else{var f;"undefined"!=typeof window?f=window:"undefined"!=typeof global?f=global:"undefined"!=typeof self&&(f=self),f.timesync=e()}}(function(){var define,module,exports;return function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a=typeof require=="function"&&require;if(!u&&a)return a(o,!0);if(i)return i(o,!0);var f=new Error("Cannot find module '"+o+"'");throw f.code="MODULE_NOT_FOUND",f}var l=n[o]={exports:{}};t[o][0].call(l.exports,function(e){var n=t[o][1][e];return s(n?n:e)},l,l.exports,e,t,n,r)}return n[o].exports}var i=typeof require=="function"&&require;for(var o=0;o<r.length;o++)s(r[o]);return s}({1:[function(require,module,exports){var head={task:void 0,next:null};var tail=head;var flushing=false;var requestFlush=void 0;var isNodeJS=false;function flush(){while(head.next){head=head.next;var task=head.task;head.task=void 0;var domain=head.domain;if(domain){head.domain=void 0;domain.enter()}try{task()}catch(e){if(isNodeJS){if(domain){domain.exit()}setTimeout(flush,0);if(domain){domain.enter()}throw e}else{setTimeout(function(){throw e},0)}}if(domain){domain.exit()}}flushing=false}if(typeof process!=="undefined"&&process.nextTick){isNodeJS=true;requestFlush=function(){process.nextTick(flush)}}else if(typeof setImmediate==="function"){if(typeof window!=="undefined"){requestFlush=setImmediate.bind(window,flush)}else{requestFlush=function(){setImmediate(flush)}}}else if(typeof MessageChannel!=="undefined"){var channel=new MessageChannel;channel.port1.onmessage=flush;requestFlush=function(){channel.port2.postMessage(0)}}else{requestFlush=function(){setTimeout(flush,0)}}function asap(task){tail=tail.next={task:task,domain:isNodeJS&&process.domain,next:null};if(!flushing){flushing=true;requestFlush()}}module.exports=asap},{}],2:[function(require,module,exports){"use strict";module.exports=require("./lib/core.js");require("./lib/done.js");require("./lib/es6-extensions.js");require("./lib/node-extensions.js")},{"./lib/core.js":3,"./lib/done.js":4,"./lib/es6-extensions.js":5,"./lib/node-extensions.js":6}],3:[function(require,module,exports){"use strict";var asap=require("asap");module.exports=Promise;function Promise(fn){if(typeof this!=="object")throw new TypeError("Promises must be constructed via new");if(typeof fn!=="function")throw new TypeError("not a function");var state=null;var value=null;var deferreds=[];var self=this;this.then=function(onFulfilled,onRejected){return new self.constructor(function(resolve,reject){handle(new Handler(onFulfilled,onRejected,resolve,reject))})};function handle(deferred){if(state===null){deferreds.push(deferred);return}asap(function(){var cb=state?deferred.onFulfilled:deferred.onRejected;if(cb===null){(state?deferred.resolve:deferred.reject)(value);return}var ret;try{ret=cb(value)}catch(e){deferred.reject(e);return}deferred.resolve(ret)})}function resolve(newValue){try{if(newValue===self)throw new TypeError("A promise cannot be resolved with itself.");if(newValue&&(typeof newValue==="object"||typeof newValue==="function")){var then=newValue.then;if(typeof then==="function"){doResolve(then.bind(newValue),resolve,reject);return}}state=true;value=newValue;finale()}catch(e){reject(e)}}function reject(newValue){state=false;value=newValue;finale()}function finale(){for(var i=0,len=deferreds.length;i<len;i++)handle(deferreds[i]);deferreds=null}doResolve(fn,resolve,reject)}function Handler(onFulfilled,onRejected,resolve,reject){this.onFulfilled=typeof onFulfilled==="function"?onFulfilled:null;this.onRejected=typeof onRejected==="function"?onRejected:null;this.resolve=resolve;this.reject=reject}function doResolve(fn,onFulfilled,onRejected){var done=false;try{fn(function(value){if(done)return;done=true;onFulfilled(value)},function(reason){if(done)return;done=true;onRejected(reason)})}catch(ex){if(done)return;done=true;onRejected(ex)}}},{asap:1}],4:[function(require,module,exports){"use strict";var Promise=require("./core.js");var asap=require("asap");module.exports=Promise;Promise.prototype.done=function(onFulfilled,onRejected){var self=arguments.length?this.then.apply(this,arguments):this;self.then(null,function(err){asap(function(){throw err})})}},{"./core.js":3,asap:1}],5:[function(require,module,exports){"use strict";var Promise=require("./core.js");var asap=require("asap");module.exports=Promise;function ValuePromise(value){this.then=function(onFulfilled){if(typeof onFulfilled!=="function")return this;return new Promise(function(resolve,reject){asap(function(){try{resolve(onFulfilled(value))}catch(ex){reject(ex)}})})}}ValuePromise.prototype=Promise.prototype;var TRUE=new ValuePromise(true);var FALSE=new ValuePromise(false);var NULL=new ValuePromise(null);var UNDEFINED=new ValuePromise(undefined);var ZERO=new ValuePromise(0);var EMPTYSTRING=new ValuePromise("");Promise.resolve=function(value){if(value instanceof Promise)return value;if(value===null)return NULL;if(value===undefined)return UNDEFINED;if(value===true)return TRUE;if(value===false)return FALSE;if(value===0)return ZERO;if(value==="")return EMPTYSTRING;if(typeof value==="object"||typeof value==="function"){try{var then=value.then;if(typeof then==="function"){return new Promise(then.bind(value))}}catch(ex){return new Promise(function(resolve,reject){reject(ex)})}}return new ValuePromise(value)};Promise.all=function(arr){var args=Array.prototype.slice.call(arr);return new Promise(function(resolve,reject){if(args.length===0)return resolve([]);var remaining=args.length;function res(i,val){try{if(val&&(typeof val==="object"||typeof val==="function")){var then=val.then;if(typeof then==="function"){then.call(val,function(val){res(i,val)},reject);return}}args[i]=val;if(--remaining===0){resolve(args)}}catch(ex){reject(ex)}}for(var i=0;i<args.length;i++){res(i,args[i])}})};Promise.reject=function(value){return new Promise(function(resolve,reject){reject(value)})};Promise.race=function(values){return new Promise(function(resolve,reject){values.forEach(function(value){Promise.resolve(value).then(resolve,reject)})})};Promise.prototype["catch"]=function(onRejected){return this.then(null,onRejected)}},{"./core.js":3,asap:1}],6:[function(require,module,exports){"use strict";var Promise=require("./core.js");var asap=require("asap");module.exports=Promise;Promise.denodeify=function(fn,argumentCount){argumentCount=argumentCount||Infinity;return function(){var self=this;var args=Array.prototype.slice.call(arguments);return new Promise(function(resolve,reject){while(args.length&&args.length>argumentCount){args.pop()}args.push(function(err,res){if(err)reject(err);else resolve(res)});var res=fn.apply(self,args);if(res&&(typeof res==="object"||typeof res==="function")&&typeof res.then==="function"){resolve(res)}})}};Promise.nodeify=function(fn){return function(){var args=Array.prototype.slice.call(arguments);var callback=typeof args[args.length-1]==="function"?args.pop():null;var ctx=this;try{return fn.apply(this,arguments).nodeify(callback,ctx)}catch(ex){if(callback===null||typeof callback=="undefined"){return new Promise(function(resolve,reject){reject(ex)})}else{asap(function(){callback.call(ctx,ex)})}}}};Promise.prototype.nodeify=function(callback,ctx){if(typeof callback!="function")return this;this.then(function(value){asap(function(){callback.call(ctx,null,value)})},function(err){asap(function(){callback.call(ctx,err)})})}},{"./core.js":3,asap:1}],7:[function(require,module,exports){"use strict";module.exports=typeof window==="undefined"||typeof window.Promise==="undefined"?require("promise"):window.Promise},{promise:2}],8:[function(require,module,exports){"use strict";module.exports=emitter;function emitter(obj){var _callbacks={};obj.emit=function(event,data){var callbacks=_callbacks[event];callbacks&&callbacks.forEach(function(callback){return callback(data)})};obj.on=function(event,callback){var callbacks=_callbacks[event]||(_callbacks[event]=[]);callbacks.push(callback);return obj};obj.off=function(event,callback){if(callback){var callbacks=_callbacks[event];var index=callbacks.indexOf(callback);if(index!==-1){callbacks.splice(index,1)}if(callbacks.length===0){delete _callbacks[event]}}else{delete _callbacks[event]}return obj};obj.list=function(event){return _callbacks[event]||[]};return obj}},{}],9:[function(require,module,exports){"use strict";exports.fetch=fetch;exports.post=post;Object.defineProperty(exports,"__esModule",{value:true});function fetch(method,url,body,headers,callback,timeout){try{var xhr=new XMLHttpRequest;xhr.onreadystatechange=function(){if(xhr.readyState==4){var contentType=xhr.getResponseHeader("Content-Type");if(contentType&&contentType.indexOf("json")!==-1){callback(null,JSON.parse(xhr.responseText),xhr.status)}else{callback(null,xhr.responseText,xhr.status)}}};if(headers){for(var name in headers){if(headers.hasOwnProperty(name)){xhr.setRequestHeader(name,headers[name])}}}xhr.ontimeout=function(err){callback(err,null,0)};xhr.open(method,url,true);xhr.timeout=timeout;if(typeof body==="string"){xhr.send(body)}else if(body){xhr.setRequestHeader("Content-Type","application/json");xhr.send(JSON.stringify(body))}else{xhr.send()}}catch(err){callback(err,null,0)}}function post(url,body,callback,timeout){fetch("POST",url,body,null,callback,timeout)}},{}],10:[function(require,module,exports){"use strict";var isBrowser=typeof window!=="undefined";module.exports=isBrowser?require("./request.browser"):require("./request.node")},{"./request.browser":9,"./request.node":11}],11:[function(require,module,exports){"use strict";var _interopRequire=function _interopRequire(obj){return obj&&obj.__esModule?obj["default"]:obj};exports.post=post;Object.defineProperty(exports,"__esModule",{value:true});var http=_interopRequire(require("http"));var https=_interopRequire(require("https"));var url=_interopRequire(require("url"));var parseUrl=url.parse;function post(url,body,callback,timeout){var data=body==="string"?body:JSON.stringify(body);var urlObj=parseUrl(url);var options={host:urlObj.hostname,port:urlObj.port,path:urlObj.path,method:"POST",headers:{"Content-Length":data.length}};if(body!=="string"){options.headers["Content-Type"]="application/json"}var proto=urlObj.protocol==="https:"?https:http;var req=proto.request(options,function(res){res.setEncoding("utf8");var result="";res.on("data",function(data){result+=data});res.on("end",function(){var contentType=res.headers["content-type"];var isJSON=contentType&&contentType.indexOf("json")!==-1;var body=isJSON?JSON.parse(result):result;callback&&callback(null,body,res.statusCode);callback=null})});req.on("error",function(err){callback&&callback(err,null,null);callback=null});req.on("socket",function(socket){socket.setTimeout(timeout,function(){req.abort()})});req.write(data);req.end()}},{http:undefined,https:undefined,url:undefined}],12:[function(require,module,exports){"use strict";exports.compare=compare;exports.add=add;exports.sum=sum;exports.mean=mean;exports.std=std;exports.variance=variance;exports.median=median;Object.defineProperty(exports,"__esModule",{value:true});function compare(a,b){return a>b?1:a<b?-1:0}function add(a,b){return a+b}function sum(arr){return arr.reduce(add)}function mean(arr){return sum(arr)/arr.length}function std(arr){return Math.sqrt(variance(arr))}function variance(arr){if(arr.length<2){return 0}var _mean=mean(arr);return arr.map(function(x){return Math.pow(x-_mean,2)}).reduce(add)/(arr.length-1)}function median(arr){if(arr.length<2){return arr[0]}var sorted=arr.slice().sort(compare);if(sorted.length%2===0){return(sorted[arr.length/2-1]+sorted[arr.length/2])/2}else{return sorted[(arr.length-1)/2]}}},{}],13:[function(require,module,exports){"use strict";var _interopRequire=function _interopRequire(obj){return obj&&obj.__esModule?obj["default"]:obj};var _interopRequireWildcard=function _interopRequireWildcard(obj){return obj&&obj.__esModule?obj:{default:obj}};exports.create=create;Object.defineProperty(exports,"__esModule",{value:true});var util=_interopRequireWildcard(require("./util.js"));var stat=_interopRequireWildcard(require("./stat.js"));var request=_interopRequireWildcard(require("./request/request"));var emitter=_interopRequire(require("./emitter.js"));var Promise=require("./Promise");function create(options){var timesync={options:{interval:60*60*1e3,timeout:1e4,delay:1e3,repeat:5,peers:[],server:null,now:Date.now},offset:0,_timeout:null,_inProgress:{},_isFirst:true,send:function send(to,data){try{request.post(to,data,function(err,res){if(err){emitError(err)}else{timesync.receive(to,res)}},timesync.options.timeout)}catch(err){emitError(err)}},receive:function receive(from,data){if(data===undefined){data=from;from=undefined}if(data&&data.id in timesync._inProgress){timesync._inProgress[data.id](data.result)}else if(data&&data.id!==undefined){timesync.send(from,{jsonrpc:"2.0",id:data.id,result:timesync.now()})}},rpc:function rpc(to,method,params){return new Promise(function(resolve,reject){var id=util.nextId();var timeout=setTimeout(function(){delete timesync._inProgress[id];reject(new Error("Timeout"))},timesync.options.timeout);timesync._inProgress[id]=function(data){clearTimeout(timeout);delete timesync._inProgress[id];resolve(data)};timesync.send(to,{jsonrpc:"2.0",id:id,method:method,params:params})})},sync:function sync(){timesync.emit("sync","start");var peers=timesync.options.server?[timesync.options.server]:timesync.options.peers;return Promise.all(peers.map(function(peer){return timesync._syncWithPeer(peer)})).then(function(all){var offsets=all.filter(function(offset){return timesync._validOffset(offset)});if(offsets.length>0){timesync.offset=stat.mean(offsets);timesync.emit("change",timesync.offset)}timesync.emit("sync","end")})},_validOffset:function _validOffset(offset){return offset!==null&&!isNaN(offset)&&isFinite(offset)},_syncWithPeer:function _syncWithPeer(peer){var all=[];function sync(){return timesync._getOffset(peer).then(function(result){return all.push(result)})}function waitAndSync(){return util.wait(timesync.options.delay).then(sync)}function notDone(){return all.length<timesync.options.repeat}return sync().then(function(){return util.whilst(notDone,waitAndSync)}).then(function(){var results=all.filter(function(result){return result!==null});var roundtrips=results.map(function(result){return result.roundtrip});var limit=stat.median(roundtrips)+stat.std(roundtrips);var filtered=results.filter(function(result){return result.roundtrip<limit});var offsets=filtered.map(function(result){return result.offset});return offsets.length>0?stat.mean(offsets):null})},_getOffset:function _getOffset(peer){var start=timesync.options.now();return timesync.rpc(peer,"timesync").then(function(timestamp){var end=timesync.options.now();var roundtrip=end-start;var offset=timestamp-end+roundtrip/2;if(timesync._isFirst){timesync._isFirst=false;timesync.offset=offset;timesync.emit("change",offset)}return{roundtrip:roundtrip,offset:offset}})["catch"](function(err){return null})},now:function now(){return timesync.options.now()+timesync.offset},destroy:function destroy(){clearTimeout(timesync._timeout)}};if(options){if(options.server&&options.peers){throw new Error('Configure either option "peers" or "server", not both.')}for(var prop in options){if(options.hasOwnProperty(prop)){if(prop==="peers"&&typeof options.peers==="string"){timesync.options.peers=options.peers.split(",").map(function(peer){return peer.trim()}).filter(function(peer){return peer!==""})}else{timesync.options[prop]=options[prop]}}}}emitter(timesync);function emitError(err){if(timesync.list("error").length>0){timesync.emit("error",err)}else{console.log("Error",err)}}if(timesync.options.interval!==null){timesync._timeout=setInterval(timesync.sync,timesync.options.interval);setTimeout(function(){timesync.sync()["catch"](function(err){return emitError(err)})},0)}return timesync}},{"./Promise":7,"./emitter.js":8,"./request/request":10,"./stat.js":12,"./util.js":14}],14:[function(require,module,exports){"use strict";exports.wait=wait;exports.repeat=repeat;exports.whilst=whilst;exports.nextId=nextId;Object.defineProperty(exports,"__esModule",{value:true});var Promise=require("./Promise");function wait(delay){return new Promise(function(resolve){setTimeout(resolve,delay)})}function repeat(fn,times){return new Promise(function(resolve,reject){var count=0;var results=[];function recurse(){if(count<times){count++;fn().then(function(result){results.push(result);recurse()})}else{resolve(results)}}recurse()})}function whilst(condition,callback){return new Promise(function(resolve,reject){function recurse(){if(condition()){callback().then(function(){return recurse()})}else{resolve()}}recurse()})}function nextId(){return _id++}var _id=0},{"./Promise":7}]},{},[13])(13)});
var Kapchat={ENV:{BOSH_SERVICE_URL:"https://chat.kapdesk.com/http-bind/",WEBSOCKET_SERVICE_URL:"wss://chat.kapdesk.com/service",SERVER_HOST:"https://www.adjetter.com",CSS_URL:"https://static-kapchat.s3.amazonaws.com/kapchatv2.min.css"}};Function.prototype.bindToEventHandler=function(){var t=this,n=Array.prototype.slice.call(arguments);return n.unshift(""),function(e){e=e||window.event,n[0]=e,t.apply(this,n)}},$.ajaxTransport("+binary",function(h,e,t){if(window.FormData&&(h.dataType&&"binary"==h.dataType||h.data&&(window.ArrayBuffer&&h.data instanceof ArrayBuffer||window.Blob&&h.data instanceof Blob)))return{send:function(e,t){var n=new XMLHttpRequest,i=h.url,a=h.type,s=h.async||!0,o=h.responseType||"blob",r=h.data||null,c=h.username||null,l=h.password||null;for(var d in n.addEventListener("load",function(){var e={};e[h.dataType]=n.response,t(n.status,n.statusText,e,n.getAllResponseHeaders())}),n.open(a,i,s,c,l),e)n.setRequestHeader(d,e[d]);n.responseType=o,n.send(r)},abort:function(){t.abort()}}});Kapchat=function(f,g,e){var m=g.ENV;g=g||{};var v="minimized",w="maximized";return g={__key:null,store:function(e){null===this.__key?console.log("Kapchat Store error: undefined key"):store.set(this.__key,e)},remove:function(){null!==this.__key&&store.remove(this.__key)},setWindowState:function(e){void 0!==e&&null===e?g.remove():"string"==typeof e&&g.store(e)},getWindowState:function(){return store.get(g.__key)},initialize:function(e){var a=null,n=e.customercode||null,s=e.key||null,o=e.iv||null,r=null,c=e.el||"kapchat-togglebtn",l=e.label||"Chat With Us",d=e.theme||"",t=(e.success,e.error||null),h="kaptureChatWrapper",i=e.context||null,u=null;if(null===s||"string"!=typeof s&&"function"==typeof t)t("Kapchat: Invalid support key");else if(null!==s||"function"==typeof t)if(null===n||"string"!=typeof n&&"function"==typeof t)t("Kapchat: Invalid customer code");else if(null!==n||"function"==typeof t)if(null!==o&&"string"==typeof o)this.__key="kapchat-"+b64_sha1("kapture-widget-store"),f(document).ready(function(){function t(i){if(0===f("#"+h).length){0===(r=f("#"+h)).length&&(r=f("<div>",{id:h}),f("body").append(r)),0===(a=f("#"+c)).length&&(a=f(".kaptureChatFlyout-togglebtn")),0===a.length?((a=f("<button>",{id:c,type:"button",class:"kapchat-btn kaptureChatFlyout-togglebtn "+d})).html(l+' <i class="kapchat">'),r.append(a)):a.addClass("kaptureChatFlyout-togglebtn");var e=m.SERVER_HOST+"/home/get-customer-supportchatweb.html",t={sk:s,cc:n,iv:o};f.ajax({url:e,data:t,type:"POST",dataType:"text html",beforeSend:function(){a.find("i").removeClass("kapchat-link-external").addClass("kapchat-spinner1 kapchat-spin")},complete:function(){a.find("i").removeClass("kapchat-spinner1 kapchat-spin").addClass("kapchat-link-external")},success:function(e,t){r.append(e),f("#kaptureChatFlyout").find(".chatbox").hide();var n=setInterval(function(){KaptureSupportClient.is_connected()&&(clearInterval(n),null!==i&&i===v?(f("#kaptureChatFlyout").find(".chatbox").hide(),a.show()):(a.hide(),f("#kaptureChatFlyout").find(".chatbox").show("fast")),f("#kaptureChatFlyout").find(".box").addClass(d),g.setWindowState(w),"function"==typeof callback&&callback(),a.on("click",_.debounce(function(){1===f("#kaptureChatFlyout").length&&f("#kaptureChatFlyout").find(".chatbox").show("fast")},1e3)))},500)},error:function(e){console.log("Kapchat Error: "+e.status)}})}}try{if(null!==i&&f("#"+i).on("click",function(e){1===f("#kaptureChatFlyout").length&&f("#kaptureChatFlyout").show(),p(w,t)}),u=g.getWindowState()||null,"object"==typeof g)return void(null!==u&&(u!==v&&u!==w||p(v,t)))}catch(e){console.warn("Error loading Kapchat: ",e)}});else{console.warn("Kapchat: Invalid parameter")}else{if("object"!=typeof console||"function"!=typeof console.error)throw new ReferenceError("Kapchat: Invalid customer code");console.error("Kapchat: Invalid customer code")}else{if("object"!=typeof console||"function"!=typeof console.error)throw new ReferenceError("Kapchat: Invalid support key");console.error("Kapchat: Invalid support key")}function p(t,n){0===f("#kapture-widget-sm").length?f.ajax({url:m.CSS_URL,dataType:"text",success:function(e){f('<style id="kapture-widget-sm"></style>').appendTo("head").html(e),n(t)},error:function(e){console.log("Kapchat: Init status: "+e.statusText)}}):n(t)}}},{initialize:function(e){g.initialize(e)},setWindowState:function(e){g.setWindowState(e)},getWindowState:function(){return g.getWindowState()},ENV:m}}(jQuery,Kapchat);var KaptureSupportClient=function(A,N,$,x,O,g){var p=O.ENV,a="minimized",j="maximized",s={sessionKey:"kapturesupportsessionkey",resourceKey:"kapturesupportresourcekey",setSessionId:function(e){var t=Base64.encode(s.sessionKey),n="";null==e?e="{}":n=JSON.stringify(e),window.sessionStorage.setItem(t,n)},getSessionId:function(){var e=Base64.encode(s.sessionKey);return null===window.sessionStorage.getItem(e)||""===window.sessionStorage.getItem(e)?null:JSON.parse(window.sessionStorage.getItem(e))},setResourceId:function(e){var t=Base64.encode(s.resourceKey),n="";null==e?e="{}":n=JSON.stringify(e),window.sessionStorage.setItem(t,n)},getResourceId:function(){var e=Base64.encode(s.resourceKey);return null===window.sessionStorage.getItem(e)?null:JSON.parse(window.sessionStorage.getItem(e))},setKey:function(e,t){null!=t?t=Base64.encode(t):null===t&&window.sessionStorage.removeItem(e),window.sessionStorage.setItem(e,t)},getKey:function(e){return null===e?null:Base64.decode(window.sessionStorage.getItem(e))},setItem:function(e,t){var n=Base64.encode(e),i="";null==t?t="{}":i=JSON.stringify(t),window.sessionStorage.setItem(n,i)},getItem:function(e){var t=Base64.encode(e);return null===window.sessionStorage.getItem(t)?null:JSON.parse(window.sessionStorage.getItem(t))},clearSession:function(e){window.sessionStorage.removeItem(Base64.encode(s.getSessionId())),window.sessionStorage.removeItem(s.sessionKey),void 0!==e&&window.sessionStorage.removeItem(e)}},o=function(e,t){if(o._running&&o.stop(),!t.requireBlur||!o.hasFocus){t.originalTitleInterval=t.originalTitleInterval||t.interval,o._running=!0,o._settings=t,o._initialText=document.title,document.title=e;var n=!0,i=function(){o._running&&(n=!n,document.title=n?e:o._initialText,o._intervalToken=setTimeout(i,n?t.interval:t.originalTitleInterval))};o._intervalToken=setTimeout(i,t.interval),t.stopOnMouseMove&&A(document).mousemove(function(e){A(this).unbind(e),o.stop()}),0<t.duration&&(o._timeoutToken=setTimeout(function(){o.stop()},t.duration))}};o.defaults={},o.stop=function(){o._running&&(clearTimeout(o._intervalToken),clearTimeout(o._timeoutToken),document.title=o._initialText,o._timeoutToken=null,o._intervalToken=null,o._initialText=null,o._running=!1,o._settings=null)},o.hasFocus=!0,o._running=!1,o._intervalToken=null,o._timeoutToken=null,o._initialText=null,o._settings=null,o._focus=function(){if(o.hasFocus=!0,o._running&&o._settings.stopOnFocus){var e=o._initialText;o.stop(),setTimeout(function(){o._running||(document.title=".",document.title=e)},1e3)}},o._blur=function(){o.hasFocus=!1},A(window).bind("focus",o._focus),A(window).bind("blur",o._blur);var n={},i={emit:function(e,t){A(n).trigger(e,t)},on:function(e,t,n){t.bind(e,n)},listen:function(e,t){A(n).bind(e,t)},off:function(e,t,n){t.unbind(e,n)}},r="mXoPQltfyvuB7EhEtNgjqo0MpjU3aq92WWMIBy2y",R="xmpp.adjetter.com",l="SUPPORT",d={0:"ERROR",1:"CONNECTING",2:"CONNFAIL",3:"AUTHENTICATING",4:"AUTHFAIL",5:"CONNECTED",6:"DISCONNECTED",7:"DISCONNECTING",8:"ATTACHED",9:"REDIRECT"};return i.log=function(e,t){var n;n="undefined"==typeof console||void 0===console.log?{log:function(){},error:function(){}}:console,i.debug&&("error"===t?n.log("ERROR: "+e):n.log(e))},i.initialize=function(e,t){"use strict";new A.Deferred;var k=this;"onpagehide"in window||("onbeforeunload"in window||window),x.log=function(e,t){k.log(e+" "+t,e)},x.error=function(e){k.log(e,"error")};var i=["max","first","last","after","before","index","count"],c=["with","start","end"];if(x.addNamespace("CARBONS","urn:xmpp:carbons:2"),x.addNamespace("CHATSTATES","http://jabber.org/protocol/chatstates"),x.addNamespace("CSI","urn:xmpp:csi:0"),x.addNamespace("XFORM","jabber:x:data"),x.addNamespace("HINTS","urn:xmpp:hints"),x.addNamespace("RECEIPTS","urn:xmpp:receipts"),x.addNamespace("MAM","urn:xmpp:mam:0"),x.addNamespace("RSM","http://jabber.org/protocol/rsm"),this.TIMEOUTS={PAUSED:1e4,INACTIVE:9e4},this.INACTIVE="inactive",this.ACTIVE="active",this.COMPOSING="composing",this.PAUSED="paused",this.GONE="gone",this.CHAT_STATUS_ONLINE="online",this.CHAT_STATUS_OFFLINE="offline",this.IMAGE_TYPES=["image/png","image/jpeg","image/gif","image/tiff","image/x-tiff","image/bmp"],this.VIDEO_TYPES="video/*",this.MAX_IMAGE_SIZE=5242880,this.MAX_VIDEO_SIZE=10485760,this.AGENT_PREFIX="emp",this.CUSTOMER_PREFIX="cus",this.user_settings=e,this.getUniqueId=function(){return Math.floor(139749825*Math.random()).toString()},this.getUniqueAlphaNumId=function(){return Math.random().toString(36).substring(2,8)+"-"+Math.floor(4294967296*(1+Math.random()))},this.generateResource=function(){return"BBApp-web-"+Math.floor(139749825*Math.random()).toString()},null===s.getSessionId()){var n=this.generateResource();s.setSessionId(n),s.setItem(n,e),s.setKey(s.sessionKey,n)}this.webSocketSupport=function(){return"WebSocket"in window||"MozWebSocket"in window},this.default_settings={username:g,password:g,name:g,support_id:g,support_name:g,archived_messages_page_size:15,message_archiving:"always",bpartner:g,lead_id:0,keepalive:!0},N.extend(this,this.default_settings),N.extend(this,N.pick(e,Object.keys(this.default_settings))),N.extend(this,{bare_jid:e.username+"@"+R,jid:e.username+"@"+R+"/"+s.getSessionId(),support_jid:e.support_id+"@"+R,last_agent_jid:g,last_ticket_id:g,last_event_agent_jid:g,last_agent_name:g,chat_state:g,__last_trigger_object:null,__last_trigger_timeout:0}),this.debug=!1,this.setUpXMLLogging=function(){x.log=function(e,t){k.log(t,e)},this.debug&&(this.connection.xmlInput=function(e){k.log(e.outerHTML)},this.connection.xmlOutput=function(e){k.log(e.outerHTML)})},void 0!==this.sound_file&&"undefined"!=typeof Audio&&(this.audio=new Audio(this.sound_file)),A.fx.off=!this.animate,this.callback=t||function(){},this.send_initial_presence=!0,this.msg_counter=0,this.connection=null,this.audio=null,this.keys=[],this.messages={},this.$el=A("#kaptureChatFlyout"),this.$content=this.$el.find(".chat-content"),this.$textarea=this.$el.find(".chat-textarea"),this.$button=A("#kapchat-togglebtn"),0===this.$button.length&&(this.$button=A(".kaptureChatFlyout-togglebtn")),this.settings=e,this.scrolled=!1,this.first_archive_id=null,this._message_handler=null,this.syncedtime=timesync.create({server:"https://chat.kapdesk.com:8443/timesync",interval:1e4,delay:3e5}),this.initConnection=function(e,t){try{this.log("initConnection():");var n=this.webSocketSupport()?p.WEBSOCKET_SERVICE_URL:p.BOSH_SERVICE_URL;if(this.connection=new x.Connection(n),void 0===e){this.log("jid: "+this.jid),this.log("password: "+this.password);try{this.connection.connect(this.jid,this.password,this.onConnectStatusChanged,t)}catch(e){this.log("Error: "+e)}}else this.connection.connect(this.jid,this.password,e,t)}catch(e){this.log("Kapchat Connection Error: ",e)}},this.resetConnection=function(){this.log("resetConnection():"),null!==this.connection&&void 0!==this.connection.disconnect&&(this.connection.disconnect(),this.connection.reset())},this.addClientFeatures=function(){return k.connection.disco.addFeature(x.NS.BOSH),k.connection.disco.addFeature(x.NS.DISCO_INFO),k.connection.disco.addFeature(x.NS.CARBONS),k.connection.disco.addFeature(x.NS.MAM),this},this.clearHelpMessages=function(){this.$el.find(".chat-error").remove(),this.$el.find(".chat-info").remove()},this.reconnect=N.debounce(function(e){k.connection.reconnecting=!0,k.connection.disconnect("re-connecting"),k.connection.reset(),k.log("The connection has dropped, attempting to reconnect.");var t=k.connection.pass||k.password;t||(k.password||k.log("Kapchat: Connection error: Invalid credentials"),k.disconnection_cause=x.Status.AUTHFAIL,k.onDisconnected());var n=x.getResourceFromJid(k.jid);k.jid=n?x.getBareJidFromJid(k.jid).toLowerCase()+"/"+n:k.jid.toLowerCase()+k.generateResource(),k.connection.connect(k.jid,t,k.onConnectStatusChanged)},1e3),this.onConnectStatusChanged=function(e,t){if(k.log("Status changed to: "+d[e]),e===x.Status.CONNECTED||e===x.Status.ATTACHED){k.disconnection_cause;k.connection.reconnecting?(k.log(e===x.Status.CONNECTED?"Reconnected":"Reattached"),k.emit("reconnected"),k.onReconnected()):(k.log(e===x.Status.CONNECTED?"Connected":"Attached"),k.onConnected()),delete k.disconnection_cause}else e===x.Status.DISCONNECTED?(k.log("The connection to the server has dropped"),k.setDisconnectionCause(e),k.onDisconnected(t)):e===x.Status.ERROR?k.log("An error occurred while connecting to the server."):e===x.Status.CONNECTING?k.log("Connecting"):e===x.Status.AUTHENTICATING?k.log("Authenticating"):e===x.Status.AUTHFAIL?k.log("Authentication failed"):e===x.Status.CONNFAIL?k.log("Connection failed"):e===x.Status.DISCONNECTING&&(k.log("Disconnecting..."),k.setDisconnectionCause(t))},this.onDisconnected=function(e){return k.showConnectionLoader(),k.disconnection_cause===x.Status.CONNFAIL?(k.reconnect(e),k.log("Reconnecting"),"reconnecting"):k.disconnection_cause===x.Status.DISCONNECTING||k.disconnection_cause===x.Status.DISCONNECTED?(window.setTimeout(N.partial(k.reconnect,e),1e3),k.log("Reconnecting in 3 seconds"),"reconnecting"):(delete k.connection.reconnecting,"disconnected")},this.showConnectionLoader=function(){this.$el.find(".chat-conn-loader").show()},this.hideConnectionLoader=function(){this.$el.find(".chat-conn-loader").hide()},this.setDisconnectionCause=function(e){void 0===k.disconnection_cause&&(k.disconnection_cause=e)},this.enableCarbons=function(){var e=new x.Builder("iq",{from:this.connection.jid,id:"enablecarbons",type:"set"}).c("enable",{xmlns:x.NS.CARBONS});this.connection.addHandler(function(e){0<A(e).find("error").length?k.log("ERROR: An error occured while trying to enable message carbons."):k.log("Message carbons have been enabled.")}.bind(this),null,"iq",null,"enablecarbons"),this.connection.send(e)},this.onConnected=function(){this.clearSpinner(),this.hideConnectionLoader(),this.enableCarbons(),this.setPreferences(),this.initStatusAndMessageListener(),this.emit("connected")},this.initStatusAndMessageListener=function(){this._message_handler=this.connection.addHandler(k.onMessage.bind(k),null,"message","chat"),this.connection.send($pres().tree())},this.onReconnected=function(){this.clearSpinner(),this.hideConnectionLoader(),this.enableCarbons(),this.setPreferences(),null!==this._message_handler&&this.connection.deleteHandler(this._message_handler),this._message_handler=this.connection.addHandler(k.onMessage.bind(k),null,"message","chat"),this.connection.send($pres().tree()),this.emit("reconnected"),k.$el.find(".chat-error").remove()},this.displayLastMessage=function(){var e=k.default_last_message||"This chat session has been closed.";k.showHelpMessage(e,"")},this.setChatStateEvent=function(){var e=this.last_agent_name?this.last_agent_name:"",t=this.last_agent_jid||null,n=this.last_event_agent_jid?x.getBareJidFromJid(this.last_event_agent_jid):null;void 0!==this.chat_state&&null!==t&&t===n&&(this.chat_state===k.COMPOSING?(this.clearChatStateEvent(),this.showChatEvent(k.COMPOSING,e)):(this.chat_state,k.PAUSED,this.clearChatStateEvent()))},this.showChatEvent=function(e,t){0===this.$content.find(".chat-state-event").length&&(this.$content.append('<div class="chat-state-event"><span class="chat-status"><div class="chat-indicator"><span class="dot"></span><span class="dot"></span><span class="dot"></span></div></span></div>'),this.scrollDown())},this.clearChatStateEvent=function(){this.$content.find(".chat-state-event").remove()},this.onChatEvent=function(e){},this.onMessage=function(e){try{k.log(e);try{var t,n,i,a,s,o,r,c,l=A(e),d=l.attr("from"),h=l.attr("to"),u=(x.getResourceFromJid(h),null),p=null,f=null,g=null,m=null;c=void 0!==l.find('result[xmlns="'+x.NS.MAM+'"]').attr("id"),1===l.find("markable").length&&(m=l.find("markable").attr("id"));var v=l.find(k.COMPOSING).length&&k.COMPOSING||l.find(k.PAUSED).length&&k.PAUSED||l.find(k.INACTIVE).length&&k.INACTIVE||l.find(k.ACTIVE).length&&k.ACTIVE||l.find(k.GONE).length&&k.GONE;if("string"==typeof v?(void 0!==this.chat_state_timeout&&(window.clearTimeout(this.chat_state_timeout),delete this.chat_state_timeout),this.last_event_agent_jid=l.attr("from"),v===k.COMPOSING?(this.chat_state=k.COMPOSING,this.chat_state_timeout=window.setTimeout(this.setChatStateEvent.bind(this),k.TIMEOUTS.PAUSED,k.PAUSED)):v===k.PAUSED&&(this.chat_state=k.PAUSED,this.chat_state_timeout=window.setTimeout(this.setChatStateEvent.bind(this),k.TIMEOUTS.INACTIVE,k.INACTIVE)),this.setChatStateEvent(v)):this.clearChatStateEvent(),(t=l.find("forwarded")).length&&(l=t.children("message"),n=t.children("delay"),d=l.attr("from"),h=l.attr("to")),x.getBareJidFromJid(h),i=x.getBareJidFromJid(d),a=x.getResourceFromJid(d),s=i===k.bare_jid,o=l.attr("id"),s?(x.getBareJidFromJid(h),x.getResourceFromJid(h)):(i,a),l.length){if(r=l.children("body"),void 0!==(f=l.children("archived").attr("id"))&&void 0!==N.findWhere(k.messages,{archive_id:f}))return!0;if(void 0!==o&&void 0!==N.findWhere(k.messages,{id:o}))return!0;if(null===k.first_archive_id&&(k.first_archive_id=f),1===r.length&&""!==r.text()){g=r.text();try{p=JSON.parse(g)}catch(e){console.log("Kapchat Parse Error: "+e)}}if(null!==p){var _=p.supportChatMessage,w=p.supportChatTrigger,b=p.supportChatEvent;if(u=void 0!==n?n.attr("stamp"):$().format(),void 0!==b)k.onChatEvent(b);else if(void 0===_||w){if(void 0!==p.supportChatTrigger){var y=p.supportChatTrigger,S=y.expiration?y.expiration:0,M=y.question?y.question:null,C=y.sentDate||0,T=$().valueOf(),I=0,E=0;0<C&&0<S&&null!==y.question&&(I=C+S,c?T<I?5e3<(E=I-T)?(this.clearTriggerModal(),this.showTriggerModal(M,E,p.supportChatMessage,o)):(d=(_=p.supportChatMessage).fromJid+"@"+R,g=_.message,k.showMessage(d,_.senderName,o,g,u,_.url,_.thumbnailurl,_.mime,_.label)):(g=(_=p.supportChatMessage).message,k.showMessage(d,_.senderName,o,g,u,_.url,_.thumbnailurl,_.mime,_.label)):this.showTriggerModal(M,S,p.supportChatMessage,o))}}else g=_.message,N.extend(_,{id:o,archive_id:f}),s=(d=_.fromJid+"@"+R)===k.bare_jid,d.startsWith(k.AGENT_PREFIX)&&!c&&(k.last_agent_jid=d,k.last_ticket_id=_.ticketId,k.last_agent_name=_.senderName),c||(this.sendAcknowledgement(m),s||k.renderTriggerAsMessage()),null===_||c||s||(k.$button.hide(),k.$el.find(".chatbox").show(),O.setWindowState(j),this.renderNewMessageAlert()),k.showMessage(d,_.senderName,o,g,u,_.url,_.thumbnailurl,_.mime,_.label),s||c||(k.playNotification(),k.flashAlert(),k.showMessageIndicator()),s&&!c&&this.clearNewMessageAlert()}}}catch(e){console.log("Kapchat error: ",e)}return!0}catch(e){k.log(e)}},this.renderTriggerAsMessage=function(){if(null!==this.__last_trigger_object){this.clearTriggerModal();var e=this.__last_trigger_object.fromJid+"@"+R,t=this.__last_trigger_object.message,n=this.__last_trigger_object.sent_date,i=this.__last_trigger_object.senderName,a=this.__last_trigger_object.msgid;k.showMessage(e,i,a,t,n,g,g,g,g),this.__last_trigger_object=null,this.__last_trigger_timeout=0}},this.showTriggerModal=function(e,t,n,i){var a,s,o,r;if(this.clearHelpMessages(),0<t&&null!==e){0<this.__last_trigger_timeout&&clearTimeout(this.__last_trigger_timeout),this.renderTriggerAsMessage();var c=A('<div class="chat-modal-popup chat-trigger"><div class="chat-modal-content">'+e+'</div><button class="chat-modal-button pure-button trigger-no-btn cancel-btn">No</button><button class="chat-modal-button pure-button trigger-yes-btn confirm-btn">Yes</button></div>');this.$el.find(".chat-body").append(c),this.__last_trigger_object=n,this.__last_trigger_object.msgid=i,a=n.fromJid+"@"+R,s=n.message,r=$().format(),o=n.senderName,this.__last_trigger_timeout=setTimeout(function(){k.$el.find(".chat-trigger").remove(),k.showMessage(a,n.senderName,i,s,r,g,g,g,g)},t),k.$el.find(".trigger-yes-btn").click(function(){k.__last_trigger_object=null,k.__last_trigger_timeout=0,k.clearTriggerModal(),k.showMessage(a,o,i,s,r,g,g,g,g),k.onKeyPressed("Yes")}),k.$el.find(".trigger-no-btn").click(function(){k.__last_trigger_object=null,k.__last_trigger_timeout=0,k.clearTriggerModal(),k.showMessage(a,o,i,s,r,g,g,g,g),k.onKeyPressed("No")})}},this.showChatModal=function(e,t){this.clearHelpMessages();var n=A('<div class="chat-modal-popup"><div class="chat-modal-content">'+e+'</div><button class="chat-modal-button pure-button cancel-btn">No</button><button class="chat-modal-button pure-button confirm-btn">Yes</button></div>');this.$el.find(".chat-body").append(n),k.$el.find(".confirm-btn").click(function(){"function"==typeof t&&t(),k.clearChatModal()}),k.$el.find(".cancel-btn").click(function(){k.clearChatModal()})},this.clearChatModal=function(){k.$el.find(".chat-modal-popup").remove()},this.clearTriggerModal=function(){k.$el.find(".chat-modal-popup").remove()},this.showFeedbackModal=function(e){},this.clearFeedbackModal=function(){k.$el.find(".chat-modal-popup").remove()},this.renderNewMessageAlert=function(){var e=$().format();0===this.$content.find(".unread-msg-alert").length&&(this.$content.append('<span class="unread-msg-alert" data-isodate="'+e+'">New Message(s)</span>'),this.scrollDown())},this.clearNewMessageAlert=function(){this.$content.find(".unread-msg-alert").remove()},this.sendAcknowledgement=function(e){var t=k.last_agent_jid||null;if(null!==t){var n=x.getBareJidFromJid(k.connection.jid),i=$().valueOf(),a=$msg({to:t,type:"chat",from:n,id:i}).c("received",{xmlns:"urn:xmpp:chat-markers:0",id:e}).up();k.connection.send(a)}},this.showMessage=function(e,t,n,i,a,s,o,r,c){if(1!==this.$content.find('.chat-message[data-msgid="'+n+'"]').length){var l,d,h=k.$el.find(".chat-content").children(".chat-message:first").data("isodate"),u=$(a)||$,p=k.$el.find(".chat-content").children(".chat-message:last").data("isodate");if(!h)return this.insertDayIndicator(u),void this.insertMessage(e,t,n,i,a,s,o,r,c);if(u.isAfter(p)||u.isSame(p))return u.isAfter(p,"day")&&this.insertDayIndicator(u),void this.insertMessage(e,t,n,i,a,s,o,r,c);if(u.isBefore(h)||u.isSame(h))return this.insertMessage(e,t,n,i,a,s,o,r,c,"prepend"),void(u.isBefore(h,"day")&&this.insertDayIndicator(u,"prepend"));u=u.format(),(l=N.map(k.$content.children(".chat-message"),function(e){return A(e).data("isodate")})).push(u),l.sort(),d=l.indexOf(u)-1,N.compose(this.scrollDownMessageHeight.bind(this),function(e){return e.insertAfter(k.$content.find('.chat-message[data-isodate="'+l[d]+'"]')),e}.bind(k))(this.renderMessage(e,t,n,i,a,s,o,r,c))}},this.insertDayIndicator=function(e,t){var n=$(e).startOf("day"),i='<time class="chat-date" data-isodate="'+n.format()+'">'+n.format("dddd MMM Do YYYY")+"</time>";t?k.$el.find(".chat-content").prepend(i):k.$el.find(".chat-content").append(i)},this.insertMessage=function(e,t,n,i,a,s,o,r,c,l){var d=l?k.$el.find(".chat-content").prepend:k.$el.find(".chat-content").append;N.compose(this.scrollDownMessageHeight.bind(this),function(e){return d.call(this.$content,e),e}.bind(this))(this.renderMessage(e,t,n,i,a,s,o,r,c))},this.renderMessage=function(e,t,n,i,a,s,o,r,c){var l,d;void 0!==s&&void 0!==r&&""!==s&&""!==r&&(l=!0,d=-1<i.lastIndexOf(".")?i.substring(i.indexOf(".")+1):"",c=void 0!==c&&""!==c.trim()?c:" ");var h=k.createMessageItem(e,t,n,i,a);return l&&this.renderAttachment(s,o,i,c,r,d,h),h},this.showHelpMessage=function(e,t){this.clearHelpMessages(),this.$el.find(".chat-body").append(A('<div class="chat-info"><a class="chat-info-dismiss" href="javascript:;">&#x2715;</a><i class="kapchat kapchat-'+(t||"info")+'"></i>  '+e+"</div>")),k.bindEventListener(this.$el.find(".chat-info-dismiss"))},this.createMessageItem=function(e,t,n,i,a){var s,o,r=$(a).format()||$(),c=$(a).calendar()||$().calendar();e===k.bare_jid?(s="right",o="me"):(s="left",o="them");var l=A("<div>",{class:"chat-message","data-isodate":r,"data-msgid":n}),d=A("<div>",{class:"chat-msg-author chat-msg-"+o}),h=A("<div>",{class:"time"}),u=A("<div>",{class:"user"}),p=A("<span>",{class:"chat-msg-content "+s});return i=i.replace(/\n/g,"<br>"),p.html(i),u.text(t),h.text(c),d.append(h).append(u),l.append(d).append(p),l},this.onKeyPressed=function(e){this.clearHelpMessages(),this.clearNewMessageAlert(),this.clearChatStateEvent();var t=0<this.$el.find('input[name="file"]').length;t&&(void 0===this.$el.find('input[name="file"]').prop("files")[0]&&(this.$el.find('input[name="file"]').remove(),this.$el.find(".chat-message-wrapper").get(0).reset(),t=!1));if(t)this.uploadAttachment(k.name,e,this.createAttachment);else if(""!==e.trim()){var n=k.syncedtime.now(),i=Math.round(Number(n)),a={fromJid:k.username,senderName:k.name,message:e,sentDate:i,supportId:k.support_id,leadId:k.lead_id};this.connection.connected&&this.sendMessage(a),k.$textarea.val("")}},this.sendMessage=function(e){e.message=e.message.replace(/<([\s\S]*?)>/gm,"");var t={key:r,type:l,supportChatMessage:e},n=k.getUniqueAlphaNumId(),i=$msg({from:k.connection.jid,to:k.support_jid,type:"chat",id:n}).c("body").t(JSON.stringify(t)).up();k.connection.send(i),this.saveMessage(n,e),k.showMessage(k.bare_jid,k.name,n,e.message,e.sentDate)},this.sendChatState=function(e){if(e!==g&&void 0!==k.last_agent_jid){var t=$msg({from:k.connection.jid,to:k.last_agent_jid,type:"chat"}).c(e,{xmlns:x.NS.CHATSTATES}).up().c("no-store",{xmlns:x.NS.HINTS}).up().c("no-permanent-store",{xmlns:x.NS.HINTS}).up();k.connection.send(t)}},this.setChatState=function(e){return void 0!==this.chat_state_timeout&&(window.clearTimeout(this.chat_state_timeout),delete this.chat_state_timeout),e===k.COMPOSING?this.chat_state_timeout=window.setTimeout(k.setChatState.bind(this),k.TIMEOUTS.PAUSED,k.PAUSED):e===k.PAUSED&&(this.chat_state_timeout=window.setTimeout(this.setChatState.bind(this),k.TIMEOUTS.INACTIVE,k.INACTIVE)),this.chat_state!==e&&(this.chat_state=e),this},this.closeChat=function(){this.showChatModal("Do you want to end the chat session?",function(){var e=k.syncedtime.now(),t=Math.round(Number(e)),n="@@user has closed this chat session.".replace("@@user",k.name),i={fromJid:k.username,senderName:k.name,message:n,sentDate:t,supportId:k.support_id,leadId:k.lead_id},a={key:r,type:l,supportChatMessage:i},s=k.getUniqueAlphaNumId();if(this.connection.connected){var o=$msg({from:k.connection.jid,to:k.support_jid,type:"chat",id:s}).c("body").t(JSON.stringify(a)).up().c("private",{xmlns:"urn:xmpp:carbons:2"}).up().c("no-copy-store",{xmlns:"urn:xmpp:hints"}).up().c("no-permanent-store",{xmlns:"urn:xmpp:hints"}).up();k.connection.send(o);try{k.closeConnection()}catch(e){}k.$el.hide(),k.$button.hide(),O.setWindowState(null)}}.bind(k))},this.escapeString=function(e){return(e+"").replace(/[\\"']/g,"\\$&").replace(/\u0000/g,"\\0")},this.showMessageIndicator=function(){this.scrolled&&this.$el.find(".chat-msg-indicator").show()},this.scrollDownMessageHeight=function(){var e=0,t=this.$el.find(".chat-message").find(".chat-msg-content")[0];return A(t).length&&(e=this.$el.find(".chat-message").find(".chat-msg-content")[0].scrollHeight+10||0,e+=this.$el.find(".chat-message").find(".chat-msg-author")[0].scrollHeight+10||0,this.$content.scrollTop(this.$content.scrollTop()+e)),this},this.scrollDown=function(){return this.$el.find(".chat-content").scrollTop(this.$el.find(".chat-content")[0].scrollHeight),this},this.showFileDialog=function(e){var t=null;if(0<this.$el.find('input[name="file"]').length&&(t=this.$el.find('input[name="file"]').prop("files")[0]),t||this.$el.find('input[name="file"]').remove(),0===A(".chat-attachment-wrapper").length){this.$el.find(".chat-message-wrapper").append('<input type="file" name="file" class="chat-attachment-files" style="display: none;">');var n=this.$el.find(".chat-attachment-files");n.on("click",function(){this.value=null}),n.on("change",function(e){k.clearHelpMessages(),k.renderAttachmentPreview()}),n.click()}else this.clearHelpMessages(),this.showHelpMessage("You can upload one file at a time","info")},this.removeAttachment=function(e){this.$el.find(".chat-attachment-wrapper").remove(),this.$el.find(".chat-attachment-files").remove(),this.$el.find(".chat-textarea").val("").focus().attr("placeholder","Write a message..."),this.$el.find('input[name="file"]').remove(),this.$el.find(".chat-message-wrapper").get(0).reset()},this.renderAttachmentPreview=function(e){var t=new FileReader,n=k.$el.find('input[name="file"]').prop("files")[0],i=new RegExp("^([a-zA-Z0-9\\s_\\-\\(\\)]{1,250})?(\\.[a-zA-z0-9]{1,10})$");if(n!=g&&""!=n.name){var a=n.name;if(!i.test(a))return void this.showHelpMessage("file name can be alphanumeric and special characters(_, -,parentheses and space) only.")}var s=n.type,o=N.contains(k.IMAGE_TYPES,n.type),r=new RegExp(k.VIDEO_TYPES).test(s);if(o||r){this.$el.find(".chat-textarea").attr("placeholder","Add caption...");this.$el.find(".chat-message-wrapper").prepend('<div class="chat-attachment-wrapper"><div class="chat-attachment-shelf" title="File attachment"><div class="preview-header"><span class="attachment-name"></span><span class="chat-attachment-type" title="Remove attachment"><a href="javascript:;" class="pull-right"><i class="kapchat kapchat-close"></i></a></span></div><div class="preview"><p class="preview-placeholder">Loading preview...</p></div></div></div>');var c=this.$el.find(".chat-attachment-files").val();c=(c=c.substring(c.lastIndexOf("\\")+1)).substring(c.lastIndexOf("/")+1);var l=k.$el.find(".chat-attachment-shelf");l.find(".attachment-name").text(c),l.find(".chat-attachment-type a").on("click",k.removeAttachment.bind(k));var d=URL.createObjectURL(n);if(o)t.addEventListener("load",function(){l.find(".preview-placeholder").remove(),l.find(".preview").append('<a href="'+t.result+'" title="Click to preview" data-featherlight="image"><img src="'+t.result+'" style="width: auto; max-width:283px;"></a>')},!1),n&&t.readAsDataURL(n);else if(r){var h=null,u=A('<canvas class="video-thumbnail"></canvas>').appendTo(k.$el.find(".chat-message-wrapper")),p=A('<video muted class="video-thumbnail"></video>').appendTo(k.$el.find(".chat-message-wrapper")),f=0;p.one("loadedmetadata loadeddata suspend",function(){3==++f&&p.one("seeked",function(){u.height(this.videoHeight),u.width(this.videoWidth);var e=this.videoWidth,t=this.videoHeight,n=this.videoWidth,i=this.videoHeight;296<e?(i=296/e*t,n=296):e<296&&250<t&&(n=(i=250)/t*e),u[0].getContext("2d").drawImage(this,0,0,n,i),h=u[0].toDataURL();var a=k.$el.find(".chat-attachment-shelf");a.find(".preview-placeholder").remove(),a.find(".preview").append('<a href="'+d+'" title="Click to preview" data-featherlight="video"><img class="img-thumbnail-preview" src="'+h+'" width="100%"></a>'),p.remove(),u.remove()}).prop("currentTime",1)}).prop("src",d)}}else void 0!==n&&k.$el.find('input[name="file"]').remove(),this.showHelpMessage("Unsupported file format")},this.base64ToBlob=function(e,t){t=t||"";for(var n=window.atob(e),i=[],a=0,s=n.length;a<s;a+=1024){for(var o=n.slice(a,a+1024),r=new Array(o.length),c=0;c<o.length;c++)r[c]=o.charCodeAt(c);var l=new Uint8Array(r);i.push(l)}return new Blob(i,{type:t})},this.uploadAttachment=function(t,n,e){var i=new FormData,a=this.$el.find('input[name="file"]').prop("files")[0],s=a.type,o=N.contains(k.IMAGE_TYPES,a.type),r=new RegExp(k.VIDEO_TYPES).test(s);if(o&&a.size>k.MAX_IMAGE_SIZE)return this.showHelpMessage("Image size cannot exceed 5 MB");if(r&&a.size>k.MAX_VIDEO_SIZE)return this.showHelpMessage("Video size cannot exceed 10 MB");if(!o&&!r)return this.showHelpMessage("Unsupported file type","error"),void this.removeAttachment();var c=k.$el.find(".img-thumbnail-preview"),l=void 0!==c?c.attr("src"):null;if(i.append("file[]",a),i.append("username",k.username),i.append("bpartner",k.bpartner),r&&null!==l){var d=l.replace(/^data:image\/(png|jpg);base64,/,""),h=k.base64ToBlob(d,"image/png");i.append("thumbnail",h)}var u=this;A.ajax({url:p.SERVER_HOST+"/home/add-chat-attachment.html",type:"POST",data:i,dataType:"text json",cache:!1,contentType:!1,processData:!1,beforeSend:function(){u.$el.find(".chat-attachment-type").remove(),u.$el.find(".chat-attachment-shelf").append('<div class="chat-attachment-image-loader"></div>'),k.$textarea.prop("disabled",!0),k.$el.find(".chat-btn-send").prop("disabled",!0)},success:function(e){if(null===e||null===e.url)return u.$el.find(".chat-attachment-type").remove(),u.$el.find(".chat-attachment-image-loader").remove(),u.$el.find(".preview-header").append('<span class="chat-attachment-type" title="Remove attachment"><a href="javascript:;" class="pull-right"><i class="kapchat kapchat-close"></i></a></span>'),u.$el.find(".chat-attachment-type a").on("click",k.removeAttachment.bind(k)),u.$el.find(".chat-textarea").val("").focus(),u.showHelpMessage("There was an error sending attachment","error");null!==e.url&&null!==e.thumbnailurl?u.createAttachment(t,e.url,e.thumbnailurl,n):u.createAttachment(t,e.url,n)},error:function(e,t,n){return"timeout"===t?(u.$el.find(".chat-attachment-type").remove(),u.$el.find(".chat-attachment-image-loader").remove(),u.$el.find(".preview-header").append('<span class="chat-attachment-type" title="Remove attachment"><a href="javascript:;" class="pull-right"><i class="kapchat kapchat-close"></i></a></span>'),u.$el.find(".chat-attachment-type a").on("click",k.removeAttachment.bind(k)),u.$el.find(".chat-textarea").val("").focus(),u.showHelpMessage("The attachment upload takes longer than usual. Please try again later","error")):(u.$el.find(".chat-attachment-type").remove(),u.$el.find(".chat-attachment-image-loader").remove(),u.$el.find(".preview-header").append('<span class="chat-attachment-type" title="Remove attachment"><a href="javascript:;" class="pull-right"><i class="kapchat kapchat-close"></i></a></span>'),u.$el.find(".chat-attachment-type a").on("click",k.removeAttachment.bind(k)),u.$el.find(".chat-textarea").val("").focus(),u.showHelpMessage("There was an error sending attachment","error"))},complete:function(){k.$textarea.prop("disabled",!1),k.$el.find(".chat-btn-send").prop("disabled",!1)},timeout:6e5})},this.createAttachment=function(e,t,n,i){if(void 0!==this.$el.find(".chat-attachment-files").prop("files")){var a=this.$el.find(".chat-attachment-files").prop("files")[0],s=a.type,o=a.name,r=Math.round(k.syncedtime.now()),c={fromJid:k.username,senderName:k.name,message:o,sentDate:r,supportId:k.support_id,leadId:k.lead_id,thumbnailurl:n,url:t,label:i,mime:s};this.connection.connected&&(k.sendAttachment(c),this.removeAttachment()),this.$el.find(".chat-textarea").val("").focus()}},this.sendAttachment=function(e){var t={key:r,type:l,supportChatMessage:e},n=k.getUniqueAlphaNumId(),i=$msg({from:k.connection.jid,to:k.support_jid,type:"chat",id:n}).c("body").t(JSON.stringify(t)).up();k.connection.send(i),this.saveMessage(n,e),k.showMessage(k.bare_jid,k.name,n,e.message,e.sentDate,e.url,e.thumbnailurl,e.mime,e.label)},this.renderAttachment=function(e,t,n,i,a,s,o){var r="",c=N.contains(k.IMAGE_TYPES,a);new RegExp(k.VIDEO_TYPES).test(a);c?(r='<p class="attachment-label">'+i+"</p>"+('<div class="chat-attachment-body thumbnail-preview"><a href="'+e+'" title="Click to preview" data-featherlight="image"><image src="'+e+'" alt="'+n+'"></a></div>')+('<a class="attachment-title" href="'+e+'" target="_blank"><i class="kapchat kapchat-file-download download"></i></a>'),o.find(".chat-msg-content").html(r)):(r='<p class="attachment-label">'+i+"</p>"+('<div class="chat-attachment-body thumbnail-preview">'+('<a href="javascript:;" title="Click to preview" class="video-preview" data-url="'+e+'">'+(t?'<img src="'+t+'" alt="'+n+'"/>':'<video src="'+e+'" alt="'+n+'"></video>')+"</a>")+"</div>")+('<a class="attachment-title" href="'+e+'" target="_blank"><i class="kapchat kapchat-file-download download"></i></a>'),o.find(".chat-msg-content").html(r),k.bindPreviewClick(o.find(".video-preview")))},this.initDOMEventListener=function(){k.on("keypress",k.$el.find("textarea"),function(e){var t=0<k.$el.find('.chat-message-wrapper input[name="file"]').length;if(13!==e.keyCode||e.shiftKey)k.sendChatState(k.COMPOSING);else{e.preventDefault();var n=A(this).val();(""!==n.trim()||t)&&(k.onKeyPressed(n),A(this).val("").focus()),k.sendChatState(k.ACTIVE)}}),k.on("click",k.$el.find(".chat-btn-send"),function(){var e=0<k.$el.find('.chat-message-wrapper input[name="file"]').length,t=k.$el.find("textarea").val();(""!==t.trim()||e)&&k.onKeyPressed(t)}),k.on("click",k.$el.find(".toggle-chatbox-button"),function(){k.$el.find(".chatbox").hide(),k.$button.show(),O.setWindowState(a)}),k.on("click",this.$button,function(){var e=A(this);k.$el.find(".chatbox").show("fast",function(){O.setWindowState(j),e.hide()})}),k.on("click",this.$el.find(".close-chatbox-button"),function(){k.closeChat()}),k.on("click",this.$el.find(".chat-msg-indicator"),function(){A(this).hide(),k.scrolled=!1,k.$el.find(".chat-content").animate({scrollTop:k.$el.find(".chat-content")[0].scrollHeight},300)}),k.on("scroll",this.$el.find(".chat-content"),k.onScroll.bind(k)),k.on("click",this.$el.find(".chat-file-upload a"),k.showFileDialog.bind(k)),k.on("click",this.$el.find(".chat-attachment-type a"),k.removeAttachment.bind(k))},this.bindEventListener=function(t){k.on("click",t,function(e){t.parent().remove()})},this.bindPreviewClick=function(n){n.on("click",function(e){var t=n.attr("data-url")||null;null!==t&&A.featherlight({video:t})})},this.closeConnection=function(){s.clearSession(),k.connection.connected&&k.connection.disconnect()},this.playNotification=N.debounce(function(){k.audio.play()},300),this.flashAlert=function(){var e=k.settings.name;o("You have a new message from "+e,{requireBlur:!0,stopOnFocus:!0,duration:3e4,interval:750,originalTitleInterval:null,stopOnMouseMove:!1})},this.saveMessage=function(e,t){k.keys.sort(function(e,t){return t-e});var n=N.first(k.keys);t.sentDate>n?k.keys.unshift(t.sentDate):k.keys.push(t.sentDate),k.messages[e]=t},this.removeKey=function(e){if(void 0!==k.keys){var t=k.keys.indexOf(e);-1<t&&k.keys.splice(t,1);var n=this.jid+"keys";s.setItem(n,k.keys)}},this.getMessages=function(){return s.getItem(k.jid+"messages")},this.getMessageKeys=function(){return s.getItem(k.jid+"keys")},this.clearMessages=function(){s.clearSession(Base64.encode(k.jid+"messages")),s.clearSession(Base64.encode(k.jid+"keys"))},this.fetchArchivedMessages=function(e,n){this.addSpinner(),k.queryForArchivedMessages(e,function(e){if(this.clearSpinner(),e.length){var t=A(N.first(e));this.first_archive_id=t.find("result").attr("id"),N.map(e,k.onMessage.bind(k))}k.emit("archive_fetched"),"function"==typeof n&&n()}.bind(this),function(){this.clearSpinner(),k.log("Error or timeout while trying to fetch archived messages","error")}.bind(this))},this.onScroll=N.debounce(function(e){e&&e.preventDefault&&e.preventDefault();var t=A(".chat-content").scrollTop(),n=A(e.target)[0].scrollHeight-t-A(".chat-content").innerHeight();0===A(e.target).scrollTop()&&0<n&&null!==this.first_archive_id&&(k.scrolled=!1,this.fetchArchivedMessages({before:this.first_archive_id,with:k.support_jid,max:k.archived_messages_page_size})),k.scrolled=62<n},300),this.addSpinner=function(){k.$el.find(".chat-content").prepend('<div class="chat-spinner"><span class="spinner"></span></div>')},this.clearSpinner=function(){k.$el.find(".chat-content").find(".chat-spinner").remove()},this.queryForArchivedMessages=function(a,s,e){var t,o=[];"function"==typeof a&&(e=s=a);var r=k.connection.getUniqueId(),n=$iq({type:"set"}).c("query",{xmlns:x.NS.MAM,queryid:r});void 0!==a&&(n.c("x",{xmlns:x.NS.XFORM,type:"submit"}).c("field",{var:"FORM_TYPE",type:"hidden"}).c("value").t(x.NS.MAM).up().up(),a.with&&!a.groupchat&&n.c("field",{var:"with"}).c("value").t(a.with).up().up(),N.each(["start","end"],function(e){if(a[e]){if(!(t=$(a[e])).isValid())throw new TypeError("archive.query: invalid date provided for: "+e);n.c("field",{var:e}).c("value").t(t.format()).up().up()}}),n.up(),a instanceof x.RSM?n.cnode(a.toXML()):N.intersection(i,N.keys(a)).length&&n.cnode(new x.RSM(a).toXML())),"function"==typeof s&&k.connection.addHandler(function(e){var t,n=A(e),i=n.find('fin[xmlns="'+x.NS.MAM+'"]');return i.length&&i.attr("queryid")===r?(t=new x.RSM({xml:i.find("set")[0]}),N.extend(t,N.pick(a,["max"])),N.extend(t,N.pick(a,c)),s(o,t),!1):(r===n.find("result").attr("queryid")&&o.push(e),!0)},x.NS.MAM),k.connection.sendIQ(n,null,e,1e4)},this.onMAMPrefsSet=function(){k.fetchArchivedMessages({before:k.first_archive_id||"",with:k.support_jid,max:k.archived_messages_page_size},k.scrollDown.bind(k))},this.onMAMError=function(e){A(e).find("feature-not-implemented").length?k.log("Message Archive Management (XEP-0313) not supported by this browser"):(k.log("An error occured while trying to set archiving preferences."),k.log(e))},this.onMAMPreferences=function(e){var n,t=A(e).find('prefs[xmlns="'+x.NS.MAM+'"]');t.attr("default");n=$iq({type:"set"}).c("prefs",{xmlns:x.NS.MAM,default:"always"}),t.children().each(function(e,t){n.cnode(t).up()}),k.connection.sendIQ(n,k.onMAMPrefsSet,k.onMAMError)},this.setPreferences=function(){k.connection.sendIQ($iq({type:"get"}).c("prefs",{xmlns:x.NS.MAM}),k.onMAMPreferences,k.onMAMError)},this.reload=function(){null!==k.connection&&k.connection.connected?k.resetConnection():k.initConnection()},this._initialize=function(e){void 0!==e&&null!==e.username&&"null"!==e.username?("undefined"!=typeof Audio&&(k.audio=new Audio("https://static-kapchat.s3.amazonaws.com/notification.mp3")),window.session=s,k.resetConnection(),k.initConnection(),k.addSpinner(),k.debug&&k.setUpXMLLogging(),k.initDOMEventListener()):console.log("Kapchat: Connection Error")},this.is_connected=function(){return!(k==g||k.connection==g||!k.connection.connected)},this._initialize(e)},{initialize:function(e,t){i.initialize(e,t)},reload:function(){i.reload()},now:function(){return i.syncedtime.now()},disconnect:function(){i.connection.disconnect()},is_connected:function(){return i.is_connected()}}}(jQuery,_,moment,Strophe,Kapchat);