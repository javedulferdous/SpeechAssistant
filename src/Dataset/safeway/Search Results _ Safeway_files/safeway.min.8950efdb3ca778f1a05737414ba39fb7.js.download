(function(){this.init=function(){if(void 0!=AB.AUTOCLIP_MESSAGES.getParameterByName("autoClipError")){var a="",b=AB.COMMON.getCookie("SWY_SYND_USER_INFO");b&&0<b.length&&(b=JSON.parse(b),b.hhid&&(a=b.hhid));b=AB.AUTOCLIP_MESSAGES.getParameterByName("HHID");if(void 0==$(this).data("initialized")&&b&&0<a.length&&b==a){var c=AB.AUTOCLIP_MESSAGES.getParameterByName("clipFailCode");if(void 0==c||null==c)c="";var d=AB.AUTOCLIP_MESSAGES.getParameterByName("autoClipError");a=parseInt(AB.AUTOCLIP_MESSAGES.getParameterByName("totalCoupons"));
b=0;AB.AUTOCLIP_MESSAGES.getParameterByName("couponsClipped")&&(b=parseInt(AB.AUTOCLIP_MESSAGES.getParameterByName("couponsClipped")));c=this.getDisplayMessage(c,d,a,b);"true"==AB.AUTOCLIP_MESSAGES.getParameterByName("autoClipError")?($(".acm-icon").html("\x3cimg alt\x3d'error' src\x3d'/etc/designs/wcax-commons/images/icons/Error_Icon.svg'\x3e"),$(".acm-message").html(c)):1<a?(1<=b?$(".acm-icon").html("\x3cimg alt\x3d'' src\x3d'/etc/designs/wcax-commons/images/icons/check.svg'\x3e"):$(".acm-icon").html("\x3cimg alt\x3d'' src\x3d'/etc/designs/wcax-commons/images/icons/Info_Icon.svg'\x3e"),
$(".acm-message").html(c)):1==a&&(1==b?$(".acm-icon").html("\x3cimg alt\x3d'' src\x3d'/etc/designs/wcax-commons/images/icons/check.svg'\x3e"):$(".acm-icon").html("\x3cimg alt\x3d'' src\x3d'/etc/designs/wcax-commons/images/icons/Info_Icon.svg'\x3e"),$(".acm-message").html(c));this.updateMsg("just-for-you-autoclip-messages");$(".acm-close",this).on("click",{parent:this},function(a){$(a.data.parent).addClass("d-none");a=window.location.href;a=AB.AUTOCLIP_MESSAGES.removeParameterByName(a,"autoclipError");
a=AB.AUTOCLIP_MESSAGES.removeParameterByName(a,"totalCoupons");a=AB.AUTOCLIP_MESSAGES.removeParameterByName(a,"couponsClipped");a=AB.AUTOCLIP_MESSAGES.removeParameterByName(a,"clipFailCode");window.location.href=a});$(this).removeClass("d-none");$(this).data("initialized",!0)}}};this.getDisplayMessage=function(a,b,c,d){var f="",m="",n="",l="",h="",g="",k="",p="",e="",q="";$("autoclip-messages").each(function(){m=$(this).data("single-clip-added");n=$(this).data("single-clip-expiry");l=$(this).data("single-clip-already-added");
h=$(this).data("single-clip-not-available");g=$(this).data("single-api-issue");k=$(this).data("multi-clip-all-added");p=$(this).data("multi-clip-atleast-one-added");e=$(this).data("multi-clip-none-added");q=$(this).data("multi-api-issue")});f="true"==b?a&&0<a.length?this.getClipCodeFailMessage(c,a,m,n,l,h,g,k,p,e,q):1<c?q:g:1<c?0==d?e:c==d?k:0<d?p:this.getClipCodeFailMessage(c,a,m,n,l,h,g,k,p,e,q):1==c&&0<d?m:this.getClipCodeFailMessage(c,a,m,n,l,h,g,k,p,e,q);f=f.replace("{couponsClipped}",d);f=f.replace("{clippedCoupons}",
d);return f=f.replace("{totalCoupons}",c)};this.getClipCodeFailMessage=function(a,b,c,d,f,m,n,l,h,g,k){c="";1<a&&-1<b.indexOf("5043")?c=g:1==a&&-1<b.indexOf("5043")?c=d:1==a&&-1<b.indexOf("5046")?c=f:1<a&&-1<b.indexOf("5046")?c=g:1==a&&0<b.length?c=m:1<a?c=k:1==a&&(c=n);return c};this.updateMsg=function(a){$("."+a).css("display","block");$("."+a).slideDown("slow");$("."+a).delay(2E4).slideUp("slow")};this.getParameterByName=function(a){return(a=RegExp("[?\x26]"+a+"\x3d([^\x26]*)","i").exec(window.location.search))&&
decodeURIComponent(a[1].replace(/\+/g," "))};this.removeParameterByName=function(a,b){return a.replace(new RegExp("[?\x26]"+b+"\x3d[^\x26]*"),"")}}).call(AB.AUTOCLIP_MESSAGES);
(function(){var a=document.getElementsByClassName("box-top-accordion"),b;for(b=0;b<a.length;b++)a[b].addEventListener("click",function(){this.classList.toggle("active");var a=this.nextElementSibling;a.style.display="block"===a.style.display?"none":"block"});this.federation=null;this.init=function(){this.federation=window.GeneralMills?window.GeneralMills.Federation:void 0};this.enroll=function(){this.federation?this.register(AB.userInfo.customerId,this.gmLoginRegisterSuccess,this.gmLoginRegisterError,
"web"):console.log("Error: General Mills registration/login failed")};this.onSuccess=function(){AB.BOXTOPS.updateLoyalty()};this.gmLoginRegisterSuccess=function(a){a&&a.hasOwnProperty("UserId")?AB.BOXTOPS.updateLoyalty(a.UserId):console.log("Error: General Mills UserId not found")};this.gmLoginRegisterError=function(a){console.log("Error: General Mills registration/login failed")};this.onError=function(){console.log("Called from GM federation: onError")};this.register=function(a,b,f,m){if(this.federation){m=
$("boxtop").data("boxtop-register");var c=$("boxtop").data("boxtop-redirect"),d=$("boxtop").data("boxtop-gmclientid"),h=$("boxtop").data("boxtop-federationjs").replace(/\.com.*/,".com");this.federation.login({loginUri:m,clientId:d,redirectUri:c,retailerAccountId:a,onGetUserDataSuccess:b,onGetUserDataError:f,graphHost:h})}else console.log("GM Federation is missing, cannot register.")};this.login=function(a,b,f,m){if(this.federation){m=$("boxtop").data("boxtop-login");var c=$("boxtop").data("boxtop-redirect"),
d=$("boxtop").data("boxtop-gmclientid");this.federation.login({loginUri:m,clientId:d,redirectUri:c,onGetUserDataSuccess:b,onGetUserDataError:f,retailerAccountId:a})}else console&&console.log("GM Federation is missing, cannot login.")};this.startEarning=function(){this.federation?this.login(AB.userInfo.customerId,this.gmLoginRegisterSuccess,this.gmLoginRegisterError,"web"):console.log("Error: General Mills registration/login failed")};this.updateLoyalty=function(a){var b={loyaltyPartners:[{name:"GeneralMills",
planNumber:""}]};b.loyaltyPartners[0].planNumber=a;$.ajax({type:"POST",headers:AB.ucaHttpOptions,url:AB.COMMON.ucaAPIPathWithCustomerId(AB.loyaltyPartnersPath),dataType:"json",data:JSON.stringify(b),success:function(a){AB.userInfo.boxTopAuth=!0;$("#enrollment-form").modal("hide");window.location.href=window.location.href.replace("state\x3d2","state\x3d3")},error:function(a,b,c){console.log(c)}})}}).call(AB.BOXTOPS);
(function(){this.init=function(){$("weekly-ad-widget").each(function(){var a=$(this),b={dataCoverDisplay:a.attr("data-cover-display"),dataHideCoverDisplayMobile:a.attr("data-hide-cover-display-mobile"),dataTitle:a.attr("data-title"),dataSearchText:a.attr("data-search-text"),dataCategory:a.attr("data-category"),dataSpecialEvent:a.attr("data-special-event")};void 0==a.data("initialized")&&(AB.WEEKLYADWIDGET.getWeeklyWidgetIDs(a,b),AB.WEEKLYADWIDGET.hideSpinner(a),a.data("initialized",!0))})};this.truncate=
function(a){return 50<a.length?(a=a.substring(0,50)+"...",a=a.substr(0,Math.min(a.length,a.lastIndexOf(" "))),a+"..."):a};this.successWeeklyAdWidgetIDs=function(a,b,c){data=c;this.initCarousal(a,b,data,0,15)};this.getWeeklyWidgetIDs=function(a,b){$.get("/content/dam/weekly-ad-widget/test-data-files/test_offers.json",this.successWeeklyAdWidgetIDs.bind(this,a,b))};this.hideSpinner=function(a){a.find(".carousel-content-loading").hide()};this.initCarousal=function(a,b,c,d,f){for(var m=a.find(".slick-list"),
n=a.find(".d-none .slick-card"),l=d;l<f;l++){var h=c.manufacturerCoupons[l],g=n.clone();g.find(".product-image img").attr({src:h.image,alt:h.brand});g.find(".product-title p").html(h.brand);var k=this.truncate(h.description);g.find(".product-detail p").html(k);g.find(".product-price").text("$13.29");var p={month:"short",day:"numeric"};k=(new Date(parseInt(h.startDate.match(/\d+/g,"")[0]))).toLocaleDateString("en-US",p);p=(new Date(parseInt(h.endDate.match(/\d+/g,"")[0]))).toLocaleDateString("en-US",
p);g.find(".product-expiry").text("Valid "+k+" - "+p);g.find(".disclaimer").text("(unless otherwise noted)");h="/justforu/offer-details."+h.couponID+"."+h.offerTs;g.find(".product-cta").attr("href",h);m.append(g)}weeklyAdIndex=d+f;this.initSlickCarousal(a,b)};this.initSlickCarousal=function(a,b){var c=a.find(".slick-list"),d=5,f=3;b.dataCoverDisplay&&(d=3,null==b.dataHideCoverDisplayMobile&&(f=2));c.on("afterChange",function(a,b,c){console.log(c)});c.on("edge",function(a,b,c){console.log("edge was hit -- Direction "+
c+" - ")});c.slick({slidesToScroll:1,lazyLoad:"ondemand",tail:!0,dots:!1,infinite:!1,cssEase:"linear",speed:300,centerMode:!1,variableWidth:!0,variableHeight:!0,mobileFirst:!0,accessibility:!0,swipe:!0,swipeToSlide:!0,responsive:[{breakpoint:0,settings:{slidesToShow:1,dots:!1,arrows:!0}},{breakpoint:480,settings:{slidesToShow:f,dots:!1,arrows:!0}},{breakpoint:768,settings:{slidesToShow:d-2,dots:!1,arrows:!0}},{breakpoint:992,settings:{slidesToShow:d-1,dots:!1,arrows:!0}},{breakpoint:1024,settings:{slidesToShow:d,
dots:!1,arrows:!0}}]});a.removeClass("d-none")}}).call(AB.WEEKLYADWIDGET);
(function(){this.hasGasGrocery=function(a){var b=$(".reward-table-reward-free-groceries-container-v2"),c=$(".reward-table-reward-per-gal-container-v2"),d=$(".reward-table-container-v2"),f=$(".reward-table-vertical-line-v2.line2"),m=$(".reward-table-vertical-line-v2"),n=$(".icon-image"),l=$(".banner-image"),h=$(".just-for-you-rewards-grid"),g="",k="",p="",e="",q="";a=a||AB.userInfo.j4u.storeData.storeRewards;null!=a&&"object"==typeof a&&(g=a.hasGroceryRewards,k=a.gasRewardsId,p=a.partnerFuelLogo,e=
a.partnerMaxRedemption,q=a.ownMaxRedemption);var r=void 0,t=AB.userInfo.banner;AB.COMMON.getURLParameterByName("banner",!1)?t=AB.COMMON.getURLParameterByName("banner",!1):a&&a.banner&&0<a.banner.length&&(t=a.banner);a=void 0;""===e&&""===q?k="":""===e?$(".reward-table-reward-partner-redeem-per-gal-v2").addClass("hide-j4u"):""===q&&$(".reward-table-reward-redeem-per-gal-v2").addClass("hide-j4u");switch(p){case "11050":case "Chevron":a="svg-icon-chevron-texaco";r="Chevron with Techron Logo";break;case "11048":case "Sunoco":a=
"svg-icon-sunoco";r="Sunoco Logo";break;case "11049":case "Shell":a="svg-icon-shell";r="Shell Logo";break;case "15333":case "Exxon":a="svg-icon-exxon-mobil";r="Exxon/Mobil Logo";break;default:m.addClass("hide-j4u")}""===k&&"true"===g?($(".reward-table-rewards-discounts-top-title-v2").html("Redeem your rewards for discounts on groceries"),b.removeClass("reward-table-reward-free-groceries-container-v2").addClass("grocery-dynamic"),c.addClass("hide-j4u"),f.addClass("hide-j4u"),$(".hide-gas").addClass("hide-j4u")):
""!==k&&"true"!==g?($(".reward-table-rewards-discounts-top-title-v2").html("Redeem your rewards for discounts on gas"),b.addClass("hide-j4u"),f.addClass("hide-j4u"),h.addClass("hide-j4u"),l.addClass("svg-icon-"+t+"-logo"),l.attr("role","img"),l.attr("aria-label",t),$(".hide-grocery").addClass("hide-j4u"),""===k?($(".reward-table-vertical-line-v2").addClass("hide-j4u"),c.removeClass("reward-table-reward-per-gal-container-v2").addClass("one-fuel-reward"),$(".reward-table-reward-redeem-per-gal-v2").html(q+
" OFF per/gal")):(""===q?($(".reward-table-vertical-line-v2").addClass("hide-j4u"),c.removeClass("reward-table-reward-per-gal-container-v2").addClass("one-fuel-reward"),$(".reward-table-reward-partner-redeem-per-gal-v2").html(e+" OFF per/gal"),l.addClass("hide-j4u")):($(".reward-table-reward-partner-redeem-per-gal-v2").html(e+" OFF per/gal   "),$(".reward-table-reward-redeem-per-gal-v2").html(q+" OFF per/gal"),c.removeClass("reward-table-reward-per-gal-container-v2").addClass("gas-dynamic")),n.addClass(a),
n.attr("aria-label",r))):""===k&&"true"!==g?(d.addClass("hide-j4u"),h.addClass("hide-j4u"),$(".hide-grocery ,.hide-gas").addClass("hide-j4u")):""!==k&&"true"===g&&(n.addClass(a),n.attr("aria-label",r),$(".reward-table-reward-partner-redeem-per-gal-v2").html(e+" OFF per/gal   "),$(".reward-table-reward-redeem-per-gal-v2").html(q+" OFF per/gal"),l.addClass("svg-icon-"+t+"-logo"),l.attr("role","img"),l.attr("aria-label",t),""===p&&($(".reward-table-vertical-line-v2").addClass("hide-j4u"),f.removeClass("hide-j4u"),
c.removeClass("reward-table-reward-per-gal-container-v2").addClass("one-fuel-with-grocery-reward"),$(".reward-table-reward-redeem-per-gal-v2").html(q+" OFF per/gal")),""===q&&($(".reward-table-vertical-line-v2").addClass("hide-j4u"),f.removeClass("hide-j4u"),c.removeClass("reward-table-reward-per-gal-container-v2").addClass("one-fuel-with-grocery-reward"),$(".reward-table-reward-partner-redeem-per-gal-v2").html(e+" OFF per/gal"),l.addClass("hide-j4u")))};this.deliveryOptionsPod=function(){if(1==$(".fulfillment-methods").data("dynamic-pods")){var a=
AB.userInfo.j4u.storeData.storeRewards;"object"==typeof a&&null!=a&&(a.hasGroceryDelivery&&"false"!=a.hasGroceryDelivery&&$(".fulfillment-method").removeClass("delivery-options"),a.hasDUG&&"false"!=a.hasDUG&&$(".fulfillment-method").removeClass("dug-options"))}else $(".fulfillment-method").removeClass("delivery-options"),$(".fulfillment-method").removeClass("dug-options")};this.preparePennzoil3StoreRewards=function(a){var b="",c="",d="",f="",m="",n="",l="",h="",g="",k="",p="";if(a.storeRewards){var e=
a.storeRewards;void 0!==e.storeId&&(b=e.storeId);void 0!==e.hasGroceryDelivery&&(c=e.hasGroceryDelivery);void 0!==e.hasDUG&&(d=e.hasDUG);void 0!==e.hasRushDelivery&&(f=e.hasRushDelivery);void 0!==e.rewardsProgramId&&(m="true",l=e.rewardsProgramId);void 0!==e.gasRewardsId&&(n=e.gasRewardsId);void 0!==e.polarisBannerName&&(p=e.polarisBannerName);SWY.CONFIGSERVICE.storeResolutionConfig.yextConfig.isStackingLimitFeature&&"true"===SWY.CONFIGSERVICE.storeResolutionConfig.yextConfig.isStackingLimitFeature?
n&&a.address&&a.address.zipcode&&(a=AB.GASGROCERY.callStackingLimit(a.address.zipcode),h=a.partnerFuelLogo,g=a.partnerMaxRedemption,k=a.ownMaxRedemption):k=g=h=""}AB.GASGROCERY.hasGasGrocery({storeId:b,hasGroceryDelivery:c,hasDUG:d,hasRushDelivery:f,hasGroceryRewards:m,gasRewardsId:n,rewardsProgramId:l,banner:p,partnerFuelLogo:h,partnerMaxRedemption:g,ownMaxRedemption:k})};this.callStackingLimit=function(a){var b="",c="",d="";$.ajax({header:AB.emrbRewardsHeader,url:AB.stackingLImitAPIPath+"?zipCode\x3d"+
a,async:!1,success:function(a){a.ack&&"0"===a.ack&&(b=a.partnerName?a.partnerName:"",c=a.partnerStackingLimit?"$"+parseFloat(a.partnerStackingLimit).toFixed(2):"",d=a.sfwyStackingLimit?"$"+parseFloat(a.sfwyStackingLimit).toFixed(2):"")},error:function(a){console.error("Stacking limit API failed to call with error: "+a)}});return{partnerFuelLogo:b,partnerMaxRedemption:c,ownMaxRedemption:d}};this.init=function(){var a=$(".reward-table-container-v2");SWY.CONFIGSERVICE&&0<a.length&&(a=AB.userInfo.j4u.storeId,
a=AB.COMMON.getURLParameterByName("store",!1)||a,AB.GASGROCERY.getStoreAddressFromXapi(a))};this.getStoreAddressFromXapi=function(a){$.get({url:AB.storeResolverStoreAddressEndpoint+"?storeid\x3d"+a,method:"GET",headers:AB.xAPIstoreResolverHttpOptions,dataType:"json",async:!1,success:function(a){a&&a.storeAddressModel&&!a.storeAddressModel.errors&&AB.GASGROCERY.preparePennzoil3StoreRewards(a.storeAddressModel)},error:function(a){console.log("Sorry we have problem retrieving store address",a)}})}}).call(AB.GASGROCERY);
AB.COMMON.siteJ4UPreInit=function(){};AB.COMMON.doJ4UInit=function(){AB.WEEKLYADWIDGET.init();AB.AUTOCLIP_MESSAGES.init();AB.GASGROCERY.init();AB.BOXTOPS.init()};