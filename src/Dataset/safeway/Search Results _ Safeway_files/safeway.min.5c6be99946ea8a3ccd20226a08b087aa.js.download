$("#forgotpassword").validator().on("submit",function(b){return b.isDefaultPrevented()?!1:tokenBasedForgetPassword()});
var tokenBasedForgetPassword=function(){var b={},c=AB.ucaCSMSHttpOptions;$("#submitBtn").attr("disabled",!0);$("#loaderSignIn").removeClass("mask").addClass("unmask");$("#signInLoadingEmpty").removeClass("unmask").addClass("mask");$(".no-account-error").addClass("d-none").hide();var d=$("#forgotpassword").serializeArray();$.each(d,function(){"emailId"==this.name&&(b[this.name]=this.value||"")});b.banner=AB.userInfo.banner;d=JSON.stringify(b);var e=$("#confirmLink").val();$.ajax({method:"DELETE",headers:c,
url:AB.csmsResetPasswordPath,data:d,dataType:"json",success:function(b){localStorage.setItem("analyticsPwdEmail",!0);window.location=e+".html";$("#loaderSignIn").removeClass("unmask").addClass("mask");$("#signInLoadingEmpty").removeClass("mask").addClass("unmask")},error:function(b,c,d){b=JSON.stringify(b.responseJSON);b=JSON.parse(b);var e=$("#forget-pwd-error");e.html("");var g="";b.subErrors&&0<b.subErrors.length?(c=b.subErrors[0],"CSMS0045"===b.errorCode?(g=e.attr("data-properties-error"),g&&
0<g.length||(g=c.message),$(".no-account-error").removeClass("d-none").show()):(g=c.message,$(".no-account-error").addClass("d-none").hide())):g="Apologies, our site is currently experiencing technical difficulties, please try again later.";AB.DATALAYER.setError(b.errorCode,"passwordResetError",g);g&&0<g.length&&(e.removeClass("d-none").show(),setTimeout(function(){e.append($("\x3cp\x3e\x3c/p\x3e").text(g))},100),setTimeout(function(){e.attr("tabindex",-1).focus()},200));console.log("Forgot password errorCode:",
b.errors);$("#loaderSignIn").removeClass("unmask").addClass("mask");$("#signInLoadingEmpty").removeClass("mask").addClass("unmask");$("#submitBtn").attr("disabled",!1)}});console.log("Redirect forgot password :",e);return!1};
function validateresetpasswordsubmit(){var b={},c="true",d=$("#resetpassword").serializeArray();$("#reset").attr("disabled",!0);var e=$("#confirmLink").val();$.each(d,function(){"emailId"==this.name&&(b[this.name]=this.value||"");"oldPassword"==this.name&&(b[this.name]=this.value||"");"password"==this.name&&(b[this.name]=this.value||"");("emailId"==this.name||"oldPassword"==this.name||"password"==this.name)&&0>=this.value.length&&(c="false")});if("true"==c){d=JSON.stringify(b);var f=AB.ucaHttpOptions;
$("#loaderSignIn").removeClass("mask").addClass("unmask");$("#signInLoadingEmpty").removeClass("unmask").addClass("mask");$.ajax({type:"PUT",headers:f,url:AB.resetPasswordPath,data:d,dataType:"json",success:function(b){window.location=e+".html";$("#loaderSignIn").removeClass("unmask").addClass("mask");$("#signInLoadingEmpty").removeClass("mask").addClass("unmask")},error:function(b,c,d){$("#loaderSignIn").removeClass("unmask").addClass("mask");$("#signInLoadingEmpty").removeClass("mask").addClass("unmask");
$("#reset").attr("disabled",!1);b=JSON.stringify(b.responseJSON);b=JSON.parse(b);c="\x3cul\x3e";d=!0;for(datos in b.subErrors)"newPassword"==b.subErrors[datos].field||"confPwd"==b.subErrors[datos].field?d&&(c+="The new password you've entered doesn't meet our password requirements, please try again.",d=!1):c+="\x3cli\x3e"+b.subErrors[datos].message+"\x3c/li\x3e";c+="\x3c/ul\x3e";$("#result").html(c).focus()}})}return!1}
(function(){this.init=function(){$(document).ready(function(){$("#loading").hide()});AB.COMMON.authorize()&&0<$(".main-wrap-purchases").length&&0<$(".main-wrap-currentOrder").length&&_loadErumsPurchasesInfo()};_loadErumsPurchasesInfo=function(){URL=AB.erumsApiOrdersSummary;headers=AB.ecommHttpOptionsErums;$.ajax({type:"GET",headers:headers,url:URL,dataType:"json",success:function(b){$("#loading").hide();b.pastOrders&&(b.orderHistory=b.pastOrders);b.currentOrders&&(b.currentOrder=b.currentOrders);
if("undefined"!==typeof b.currentOrder&&0<b.currentOrder.length){var c=0;$("#currentRowSkeleton").removeClass("mask");for(var d in b.currentOrder){this.currentOrderApiFlag=!0===b.currentOrder[d].isErumsEnabled?"eRUMS":".net";if("eRUMS"===this.currentOrderApiFlag){var e='\x3cdiv class\x3d"d-block d-md-none mt24 col-12 col-sm-12" aria-hidden\x3d"false" id\x3d"ucaCancelOrderDiv2"\x3e\x3c/div\x3e\x3cdiv class\x3d"edit-order-container mt14" role\x3d"row" aria-hidden\x3d"false"\x3e\x3cdiv class\x3d"float-left col-12 col-sm-12 col-md-4 col-lg-4 col-xl-4 ucaCancelPageTab" role\x3d"cell" aria-hidden\x3d"false"\x3e\x3cbutton data-CurrentOrder-Api \x3d"'+
this.currentOrderApiFlag+'"data-order-id\x3d"'+b.currentOrder[d].orderId+'" data-store-id\x3d"'+b.currentOrder[d].storeId+'" onclick\x3d"AB.UCACURRENTORDER.editOrder(\''+SWY.CONFIGSERVICE.erumsConfig["spa.editorder.endpoint"]+'\', this); AB.DATALAYER.pushEvent(\'edit_date_time\');" class\x3d"btn btn-default primarybutton mb20" role\x3d"link" tabindex\x3d"0" id\x3d"editDT'+b.currentOrder[d].orderId+'" aria-label\x3d"'+$("#editDateTimeValue").val()+" for Order Number "+b.currentOrder[d].orderId+'"\x3e'+
$("#editDateTimeValue").val()+"\x3c/button\x3e\x3c/div\x3e";var f='\x3cdiv class\x3d"float-left col-12 col-sm-12 col-md-4 col-lg-4 col-xl-4 ucaCancelPageTab" aria-hidden\x3d"false" role\x3d"cell"\x3e\x3cbutton data-CurrentOrder-Api \x3d "'+this.currentOrderApiFlag+'"data-order-id\x3d"'+b.currentOrder[d].orderId+'" data-store-id\x3d"'+b.currentOrder[d].storeId+'" onclick\x3d"AB.UCACURRENTORDER.editOrder(\''+$("#editCartLinkValue").val()+'\', this);" class\x3d"btn btn-default primarybutton mb20" role\x3d"link" tabindex\x3d"0" id\x3d"editCart'+
b.currentOrder[d].orderId+'" aria-label\x3d"'+$("#editCartValue").val()+" for Order Number "+b.currentOrder[d].orderId+'"\x3e'+$("#editCartValue").val()+"\x3c/button\x3e\x3c/div\x3e";var g='\x3cdiv class\x3d"float-right col-12 col-sm-12 col-md-4 col-lg-4 col-xl-4 ucaCancelPageTab" aria-hidden\x3d"false" role\x3d"cell"\x3e\x3cbutton data-CurrentOrder-Api \x3d "'+this.currentOrderApiFlag+'" id\x3d"ucaCancelOrder-'+b.currentOrder[d].orderId+'" data-order-id\x3d"'+b.currentOrder[d].orderId+'" data-store-id\x3d"'+
b.currentOrder[d].storeId+'" class\x3d"cancel-order cancel-text mt10 p0 noBgBrdr d-none d-md-block banner-link cancel-order-button float-right" data-toggle\x3d"modal" data-target\x3d"#cancelOrder" tabindex\x3d"0" aria-label\x3d"'+$("#cancelOrderValue").val()+" for Order Number "+b.currentOrder[d].orderId+'"\x3e'+$("#cancelOrderValue").val()+'\x3c/button\x3e\x3c/div\x3e\x3cdiv class\x3d"float-left col-12 col-sm-12 col-md-4 col-lg-4 col-xl-4 ucaCancelPageTab" aria-hidden\x3d"false" role\x3d"cell"\x3e\x3cbutton data-CurrentOrder-Api \x3d "'+
this.currentOrderApiFlag+'" id\x3d"ucaCancelOrderMobile-'+b.currentOrder[d].orderId+'" data-order-id\x3d"'+b.currentOrder[d].orderId+'" data-store-id\x3d"'+b.currentOrder[d].storeId+'" class\x3d"cancel-order text-center cancel-text mt24 p0 noBgBrdr btn-modal d-block d-md-none banner-link cancel-order-button" role\x3d"link" data-toggle\x3d"modal" data-target\x3d"#cancelOrder" tabindex\x3d"0" aria-label\x3d"'+$("#cancelOrderValue").val()+" for Order Number "+b.currentOrder[d].orderId+'"\x3e'+$("#cancelOrderValue").val()+
"\x3c/button\x3e\x3c/div\x3e\x3c/div\x3e"}else e='\x3cdiv class\x3d"d-block d-md-none mt24 col-xs-12" aria-hidden\x3d"false" id\x3d"ucaCancelOrderDiv2" role\x3d"presentation"\x3e\x3c/div\x3e\x3cdiv class\x3d"row edit-order-container mt14" role\x3d"presentation" aria-hidden\x3d"false"\x3e\x3cdiv class\x3d"float-left col-12 col-sm-12 col-md-4 col-lg-4 col-xl-4 ucaCancelPageTab" aria-hidden\x3d"false" role\x3d"presentation"\x3e\x3cbutton data-CurrentOrder-Api \x3d "'+this.currentOrderApiFlag+'"data-order-id\x3d"'+
b.currentOrder[d].orderId+'" data-store-id\x3d"'+b.currentOrder[d].storeId+'" onclick\x3d"AB.UCACURRENTORDER.editOrder(\''+$("#editDateTimeLinkValue").val()+'\', this); AB.DATALAYER.pushEvent(\'edit_date_time\');" class\x3d"btn btn-default primarybutton mb20" role\x3d"link" tabindex\x3d"0" id\x3d"editDT'+b.currentOrder[d].orderId+'" aria-label\x3d"'+$("#editDateTimeValue").val()+" for Order Number "+b.currentOrder[d].orderId+'"\x3e'+$("#editDateTimeValue").val()+"\x3c/button\x3e\x3c/div\x3e",f='\x3cdiv class\x3d"float-left col-12 col-sm-12 col-md-4 col-lg-4 col-xl-4 ucaCancelPageTab" aria-hidden\x3d"false" role\x3d"presentation"\x3e\x3cbutton data-CurrentOrder-Api \x3d "'+
this.currentOrderApiFlag+'"data-order-id\x3d"'+b.currentOrder[d].orderId+'" data-store-id\x3d"'+b.currentOrder[d].storeId+'" onclick\x3d"AB.UCACURRENTORDER.editOrder(\''+$("#editCartLinkValue").val()+'\', this);" class\x3d"btn btn-default primarybutton mb20" role\x3d"link" tabindex\x3d"0" id\x3d"editCart'+b.currentOrder[d].orderId+'" aria-label\x3d"'+$("#editCartValue").val()+" for Order Number "+b.currentOrder[d].orderId+'"\x3e'+$("#editCartValue").val()+"\x3c/button\x3e\x3c/div\x3e",g='\x3cdiv class\x3d"float-right col-12 col-sm-12 col-md-4 col-lg-4 col-xl-4 ucaCancelPageTab" aria-hidden\x3d"false" role\x3d"presentation"\x3e\x3cbutton data-CurrentOrder-Api \x3d "'+
this.currentOrderApiFlag+'" id\x3d"ucaCancelOrder-'+b.currentOrder[d].orderId+'" data-order-id\x3d"'+b.currentOrder[d].orderId+'" data-store-id\x3d"'+b.currentOrder[d].storeId+'" class\x3d"cancel-order cancel-text mt10 p0 noBgBrdr d-none d-md-block banner-link cancel-order-button float-right" data-toggle\x3d"modal" data-target\x3d"#cancelOrder" tabindex\x3d"0" aria-label\x3d"'+$("#cancelOrderValue").val()+" for Order Number "+b.currentOrder[d].orderId+'"\x3e'+$("#cancelOrderValue").val()+'\x3c/button\x3e\x3c/div\x3e\x3cdiv class\x3d"float-left col-12 col-sm-12 col-md-4 col-lg-4 col-xl-4 ucaCancelPageTab" aria-hidden\x3d"false" role\x3d"presentation"\x3e\x3cbutton data-CurrentOrder-Api \x3d "'+
this.currentOrderApiFlag+'" id\x3d"ucaCancelOrderMobile-'+b.currentOrder[d].orderId+'" data-order-id\x3d"'+b.currentOrder[d].orderId+'" data-store-id\x3d"'+b.currentOrder[d].storeId+'" class\x3d"cancel-order text-center cancel-text mt24 p0 noBgBrdr btn-modal d-block d-md-none banner-link cancel-order-button" role\x3d"link" data-toggle\x3d"modal" data-target\x3d"#cancelOrder" tabindex\x3d"0" aria-label\x3d"'+$("#cancelOrderValue").val()+" for Order Number "+b.currentOrder[d].orderId+'"\x3e'+$("#cancelOrderValue").val()+
"\x3c/button\x3e\x3c/div\x3e\x3c/div\x3e";if(0!=c){var h=$("#currentRowSkeleton .currentOrderList").last().clone().appendTo("#currentRowSkeleton");$("#current-date",h).html(b.currentOrder[d].slotSchedule);$("#current-orderId",h).html(b.currentOrder[d].orderId);var l=b.currentOrder[d].address.address1+" "+b.currentOrder[d].address.city+","+b.currentOrder[d].address.state+" "+b.currentOrder[d].address.zipCode;$("#current-address",h).html(l);$("#current-totalprice",h).html("$"+b.currentOrder[d].total);
$("#current-status",h).html(b.currentOrder[d].status);$("#btnRow",h).html(e+f+g);console.log(h)}else $("#current-date").html(b.currentOrder[d].slotSchedule),$("#current-orderId").html(b.currentOrder[d].orderId),l=b.currentOrder[d].address.address1+" "+b.currentOrder[d].address.city+","+b.currentOrder[d].address.state+" "+b.currentOrder[d].address.zipCode,$("#current-address",h).html(l),$("#current-totalprice").html("$"+b.currentOrder[d].total),$("#current-status").html(b.currentOrder[d].status),$("#btnRow").html(e+
f+g);c+=1;b.currentOrder[d].isEditable?($("#editCart"+b.currentOrder[d].orderId).removeClass("mask").addClass("unmask"),$("#editDT"+b.currentOrder[d].orderId).removeClass("mask").addClass("unmask")):($("#editCart"+b.currentOrder[d].orderId).removeClass("unmask").addClass("mask"),$("#editDT"+b.currentOrder[d].orderId).removeClass("unmask").addClass("mask"))}$("#loading").hide()}else h=$("#currentOrdersDiv").attr("data-errorMsg"),$("\x3cdiv\x3e\x3c/div\x3e",{text:h}).appendTo("#currentOrdersDiv"),$(".update-note").hide(),
$("#currentRowSkeleton").hide();if(null!=b&&"undefined"!==typeof b.orderHistory&&0<b.orderHistory.length){$("#orderRowSkeleton").removeClass("mask");for(var k in b.orderHistory)h=$("#orderRowSkeleton .pastOrderList").last().clone().appendTo("#orderRowSkeleton"),c={month:"short",day:"numeric",year:"numeric",hour12:"true",hour:"2-digit"},l=(new Date(b.orderHistory[k].slotStartTS)).toLocaleString("en-US",c),c=(new Date(b.orderHistory[k].slotEndTS)).toLocaleString("en-US",c),l.slice(0,10)==c.slice(0,
10)&&c.slice(13),$("#past-date",h).html(b.orderHistory[k].slotSchedule),$("#past-orderId",h).html(b.orderHistory[k].orderId),l=b.orderHistory[k].address.address1+" "+b.orderHistory[k].address.city+","+b.orderHistory[k].address.state+" "+b.orderHistory[k].address.zipCode,$("#past-address",h).html(l),$("#past-totalPrice",h).html("$"+b.orderHistory[k].total)}else b=$("#pastPurchases").attr("data-errorMsg"),$("\x3cdiv\x3e\x3c/div\x3e",{text:b}).appendTo("#noPastPurchases"),$("#pastPurchases").hide(),
$("#orderRowSkeleton").hide(),$("#loading").hide();this.pastOrderList=$("#orderRowSkeleton").find(".pastOrderList")[0];"undefined"!=typeof this.pastOrderList&&this.pastOrderList.remove()},error:function(b,c,d){$("\x3cdiv style\x3d'color:#dd1e25;'\x3eSorry, no orders available.\x3c/div\x3e").appendTo("#currentOrdersDiv");$(".current-orders-text").hide();$(".update-note").hide();$("#purchasesHeader").hide();$("#pastPurchases").hide();$("#loading").hide()}})};$("#cancelOrder").on("show.bs.modal",function(b){var c=
$(b.relatedTarget).data("order-id"),d=$(b.relatedTarget).data("currentorder-api");$(b.currentTarget).find('button[id\x3d"infoDone"]').attr({"data-currentorder-api":d,"data-order-id-modal":c})});this.cancelOrder=function(b){var c=AB.cancelOrderPath,d="POST",e=AB.ecommHttpOptions;"eRUMS"==b.getAttribute("data-CurrentOrder-Api")&&(c=AB.erumsApiCancelOrder,d="DELETE",e=AB.ecommHttpOptionsErums);b=b.getAttribute("data-order-id-modal");$.ajax({type:d,headers:e,url:c+b,dataType:"json",success:function(b){AB.DATALAYER.setLinkClickEvents("cancel-order",
!0);window.location.href=$("#cancelOrder").attr("data-ordersPageLink")+".html"},error:function(b,c,d){window.location=$("#cancelOrder").attr("data-ordersPageLink")+".html"}})};this.editOrder=function(b,c){if("eRUMS"==c.getAttribute("data-CurrentOrder-Api")){b=window.location.protocol+"//"+window.location.host+SWY.CONFIGSERVICE.erumsConfig["spa.editorder.endpoint"];var d="cart";-1!=c.id.indexOf("editDT")&&(d="slot");var e=c.getAttribute("data-order-id");c=c.getAttribute("data-store-id");b="false"==
SWY.CONFIGSERVICE.oktaConfig.tokenPassToDotNet?b+"/"+d+"/"+c+"/"+e:encodeURIComponent(b+"/"+d+"/"+c+"/"+e);SWY.ENFORCEMENT.sendRedirect(b,!1)}else e=c.getAttribute("data-order-id"),c=c.getAttribute("data-store-id"),b="false"==SWY.CONFIGSERVICE.oktaConfig.tokenPassToDotNet?b+"?StoreId\x3d"+c+"\x26OrderId\x3d"+e:encodeURIComponent(b+"?StoreId\x3d"+c+"\x26OrderId\x3d"+e),AB.COMMON.checkAndRedirectDotNetUrl(b)};this.showPendingOrderMessage=function(b,c){$(".update-note").css("display","block");this.getPendingOrderMsgFromAPI(c)};
this.getPendingOrderMsgFromAPI=function(b){$.ajax({type:"GET",headers:AB.ecommHttpOptions,url:AB.pendingOrderMessage,data:{filter:'{"StoreNo/StoreID":'+b+"}",sort_by:'{"ShiftNo"}'},dataType:"json",success:function(b){for(var c="",e=0;e<=b._embedded.length;e++)b._embedded[e]&&""!=b._embedded[e].Message&&(c+="\x3cli\x3e"+b._embedded[e].Message+"\x3c/li\x3e");$("#deliveryPendingOrder ul").html(c);$("#deliveryPendingOrder").css("display","block")},error:function(b,d,e){$("\x3cdiv /\x3e",{text:e}).appendTo(".main-wrap-currentOrder");
$("#loading").hide()}})}}).call(AB.UCACURRENTORDER);
(function(){this.validateName=function(b,c){1>=$("#"+b).val().length?($("#"+b).removeClass("valid").addClass("invalid"),$("#"+c).html("Please lengthen this text to 2 characters or more (you are currently using 1 character)").css("color","red")):$("#"+b).removeClass("invalid").addClass("valid")};this.enableUpdPhoneNoBtn=function(b,c){var d="";c?(AB.UCASERVICES.userProfile.phone&&0<AB.UCASERVICES.userProfile.phone.length&&-1!==AB.UCASERVICES.getPrimaryPhoneNumberIndex(AB.UCASERVICES.userProfile.phone)&&(d=
AB.UCASERVICES.userProfile.phone[AB.UCASERVICES.getPrimaryPhoneNumberIndex(AB.UCASERVICES.userProfile.phone)].number),c=$("#phoneNumber").val()):(d=$("#oldPhone").val()?$("#oldPhone").val():"",c=$("#deliveryPhoneNumber").val());d==c?$("#"+b).removeClass("btn-default").addClass("btn-disabled").prop("disabled",!0):($("#"+b).removeClass("btn-disabled").addClass("btn-default").removeAttr("disabled"),0<$("#invalied-phone").text().length?$("#"+b).removeClass("btn-default").addClass("btn-disabled").prop("disabled",
!0):$("#"+b).removeClass("btn-disabled").addClass("btn-default").removeAttr("disabled"))};this.validatechngfpassword=function(b,c,d){$("#"+c).empty();var e=$("#"+b).val().trim();1>e.length?$("#"+d).attr("aria-disabled","true"):$("#"+d).attr("aria-disabled","false");if(7>=e.length)$("#chpswd").addClass("has-error"),$("#showPass").attr("aria-invalid",!0),0>=e.length?$("#"+c).html("Please enter a password.").css("color","red"):$("#"+c).html("Please enter a password that contains at least 8 characters.").css("color",
"red"),$(".has-error .form-control").css("border","2px solid #dd1e25 !important");else{d=$("#input-firstName").val();var f=$("#input-lastName").val(),g=$("#emailIdaccount").val();if(/^[a-zA-Z0-9!@#$%^&*()_+|~=`{}[:;<>?,.\s]{8,12}$/.test(e)){var h=e.charAt(0);h.match(/^[!@#$%^&*()_+\-=\[\]{};':"\\|,.<>\/?]*$/)?(h=h.replace(/[-\/\\^$*+?.()|[\]{}]/g,"\\$\x26"),h=new RegExp(h,"g")):h=new RegExp(h,"gi");h=e.match(h).length}else $("#chpswd").addClass("has-error"),$("#showPass").attr("aria-invalid",!0),
$("#"+c).html("Only numbers, letters, spaces and special characters are allowed.").css("color","red"),$(".has-error .form-control").css("border","2px solid #dd1e25 !important");h==e.length?($("#chpswd").addClass("has-error"),$("#showPass").attr("aria-invalid",!0),$("#"+c).html("Password has repeated characters.").css("color","red"),$(".has-error .form-control").css("border","2px solid #dd1e25 !important")):(-1<e.indexOf(g)||-1<g.indexOf(e)||-1<e.indexOf(d)||-1<e.indexOf(f))&&"n-password"===b?($("#chpswd").addClass("has-error"),
$("#showPass").attr("aria-invalid",!0),$("#"+c).html("Password must not be the same as your email address, firstname, or lastname.").css("color","red"),$(".has-error .form-control").css("border","2px solid #dd1e25 !important")):$("#"+c).removeData()}};this.validateaddress=function(b,c){$("#"+c).empty();1>=$("#"+b).val().length?($("#addrss1").addClass("has-error"),$("#Address1").attr("aria-invalid",!0),$("#"+c).html("Use at least 2 characters.").css("color","red"),$(".has-error .form-control").css("border",
"2px solid #dd1e25 !important")):$("#"+c).removeData()};this.validateerroraddrss=function(b,c){0<$("#"+c).text().length?($("#"+b).addClass("has-error"),$("#Address1").attr("aria-invalid",!0),$(".has-error .form-control").css("border","2px solid #dd1e25 !important")):$("#"+c).empty()};this.validatepassword=function(b,c,d){$("#"+c).empty();b=$("#"+b).val().trim();1>b.length?$("#"+d).attr("aria-disabled","true"):$("#"+d).attr("aria-disabled","false");if(7>=b.length)$("#pswd").addClass("has-error"),$("#showPass").attr("aria-invalid",
!0),0>=b.length?$("#"+c).html("Please enter a password.").css("color","red"):$("#"+c).html("Please enter a password that contains at least 8 characters.").css("color","red"),$(".has-error .form-control").css("border","2px solid #dd1e25 !important");else{d=$("#input-firstName").val().toLowerCase();var e=$("#input-lastName").val().toLowerCase();var f=$("#emailId").val()?$("#emailId").val().toLowerCase():$("#input-email").val()?$("#input-email").val().toLowerCase():$("#emailIdaccount").val().toLowerCase();
var g=b.toLowerCase(),h=$("#c-password").val();console.log(b,f);if(/^[a-zA-Z0-9!@#$%^&*()_+|~=`{}[:;<>?,.\s]{8,12}$/.test(b)){var l=b.charAt(0);l.match(/^[!@#$%^&*()_+\-=\[\]{};':"\\|,.<>\/?]*$/)?(l=l.replace(/[-\/\\^$*+?.()|[\]{}]/g,"\\$\x26"),l=new RegExp(l,"g")):l=new RegExp(l,"gi");l=b.match(l).length;console.log("repeat count\x3d"+l)}else $("#pswd").addClass("has-error"),$("#showPass").attr("aria-invalid",!0),$("#"+c).html("Only Numbers, letters, spaces and special characters are allowed.").css("color",
"red"),$(".has-error .form-control").css("border","2px solid #dd1e25 !important");l==b.length?($("#pswd").addClass("has-error"),$("#showPass").attr("aria-invalid",!0),$("#"+c).html("Password has repeated characters.").css("color","red"),$(".has-error .form-control").css("border","2px solid #dd1e25 !important")):f&&(-1<g.indexOf(f)||-1<f.indexOf(g))||d&&-1<g.indexOf(d)||e&&-1<g.indexOf(e)?($("#pswd").addClass("has-error"),$("#showPass").attr("aria-invalid",!0),$("#"+c).html("Password must not be the same as your email address, firstname, or lastname.").css("color",
"red"),$(".has-error .form-control").css("border","2px solid #dd1e25 !important")):b===h?($("#pswd").addClass("has-error"),$("#showPass").attr("aria-invalid",!0),$("#"+c).html("The New Password cannot be same as current password").css("color","red"),$(".has-error .form-control").css("border","2px solid #dd1e25 !important")):$("#"+c).removeData()}};this.validateerrorpwsd=function(b,c){0<$("#"+c).text().length?($("#"+b).addClass("has-error"),$("#showPass").attr("aria-invalid",!0),$(".has-error .form-control").css("border",
"2px solid #dd1e25 !important")):$("#"+c).empty()};this.enableShowHidePwd=function(b,c,d){0<$("#"+c).val().length?$("#"+d).attr("aria-disabled","false"):$("#"+d).attr("aria-disabled","true")};this.validatefirstName=function(b,c){$("#"+c).empty();b=$("#"+b).val();var d=b.charAt(0);if(1>=b.length)return $("#firstn").addClass("has-error"),$("#input-firstName").attr("aria-invalid",!0),""==b.trim()?$("#"+c).html("Please enter your first name.").css("color","red"):$("#"+c).html("Please enter a first name that is between 2 - 30 characters.").css("color",
"red"),$(".has-error .form-control").css("border","2px solid #dd1e25 !important"),!1;1<b.length&&(""==b.trim()||" "===d)?d=/^[a-zA-Z]*$/:(b=b.replace(/ {1,}/g," "),$("#input-firstName").val(b),d=/^[a-zA-Z- ]*$/);$("#"+c).removeData();if(d.test(b))return!0;$("#firstn").addClass("has-error");$("#input-firstName").attr("aria-invalid",!0);""==b.trim()?$("#"+c).html("Please enter your first name.").css("color","red"):$("#"+c).html("Please enter a first name that includes only letters or hyphens.").css("color",
"red");$(".has-error .form-control").css("border","2px solid #dd1e25 !important")};this.validatelastName=function(b,c){$("#"+c).empty();b=$("#"+b).val();var d=b.charAt(0);if(1>=b.length)return regexl=/^[a-zA-Z]*$/,$("#lastn").addClass("has-error"),$("#input-lastName").attr("aria-invalid",!0),$(".has-error .form-control").css("border","2px solid #dd1e25 !important"),""==b.trim()?$("#"+c).html("Please enter your last name.").css("color","red"):$("#"+c).html("Please enter a last name that is between 2 - 30 characters.").css("color",
"red"),!1;1<b.length&&(""==b.trim()||" "===d)?regex=/^[a-zA-Z]*$/:(b=b.replace(/ {1,}/g," "),$("#input-lastName").val(b),$("#input-lastName").attr("aria-invalid",!0),regexl=/^[a-zA-Z- ]*$/);$("#"+c).removeData();if(regexl.test(b))return!0;""==b.trim()?$("#"+c).html("Please enter your last name.").css("color","red"):$("#"+c).html("Please enter a last name that includes only letters or hyphens.").css("color","red");$("#lastn").addClass("has-error");$("#input-lastName").attr("aria-invalid",!0);$(".has-error .form-control").css("border",
"2px solid #dd1e25 !important")};this.validateerrorfname=function(b,c){0<$("#"+c).text().length?($("#"+b).addClass("has-error"),$("#input-lastName").attr("aria-invalid",!0),$(".has-error .form-control").css("border","2px solid #dd1e25 !important")):$("#"+c).empty()};this.validateerrorlname=function(b,c){0<$("#"+c).text().length?($("#"+b).addClass("has-error"),$("#input-lastName").attr("aria-invalid",!0),$(".has-error .form-control").css("border","2px solid #dd1e25 !important")):$("#"+c).empty()};
this.validatePhoneNumber=function(b,c){console.log(c);$("#"+c).empty();var d=$("#"+b).val();/[0-9 -()+]+$/.test(d)?10>d.length?($("#"+b).removeClass("valid").addClass("invalid"),$("#input-clubCardNumber").attr("aria-invalid",!0),$("#"+c).html("Please enter a phone number that contains 10 digits.").css("color","red"),console.log("error")):$("#"+c).removeData():($("#"+b).removeClass("invalid").addClass("valid"),$("#input-clubCardNumber").attr("aria-invalid",!0),$("#"+c).html("Please enter a valid Phone Number.").css("color",
"red"),console.log("error"))};this.validateEmail=function(b,c){console.log(c);var d=$("#"+b).val(),e=/^(([^<>()\[\]\\.,;:\s@"]+(\.[^<>()\[\]\\.,;:\s@"]+)*)|(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/;50<d.length||!e.test(d)?($("#"+b).removeClass("valid").addClass("invalid"),$("#input-email").attr("aria-invalid",!0),$("#"+c).text("Enter a Valid Email"),$("#"+c).addClass("error"),console.log("email has class invalid")):($("#"+b).removeClass("invalid").addClass("valid"),
$("#"+c).text(""),console.log("email has class VALID"))};this.show=function(b){$("#"+b).removeClass("mask");$("#"+b+" input[type\x3d'text']").attr("required","required")};this.hide=function(b){$("#"+b).addClass("mask");$("#"+b+" input[type\x3d'text']").removeAttr("required")};this.checkStore=function(){""===$("#value-userEnteredAddress").val()?$("#store-error").html("Please Choose your store.").css("color","red"):$("#store-error").html("")};this.slideDown=function(b){console.log(b+"slideDown");$("#"+
b).slideDown()};this.slideUp=function(b){console.log(b+"slideUp");$("#"+b).slideUp()};this.passwordVisibility=function(b,c){b=document.getElementById(b);c=$("#"+c);"password"===b.type?(b.type="text",c.text("Hide")):(b.type="password",c.text("Show"))};this.showHide=function(b,c,d){"password"===$("#"+c).attr("type")?($("#"+d).text("Hide"),$("#"+c).attr("type","text"),$("#"+c).focus(),$("#"+d).attr("aria-label","Hide password")):($("#"+d).text("Show"),$("#"+c).attr("type","password"),$("#"+c).focus(),
$("#"+d).attr("aria-label","Show password"));b.preventDefault()};this.showHideEnter=function(b,c,d){"13"==b.keyCode&&("Show"===$("#"+d).text()&&0!==$("#"+c).val().length?($("#"+d).text("Hide"),$("#"+c).attr("type","text"),$("#"+c).focus(),$("#"+d).attr("aria-label","Hide password")):"Hide"===$("#"+d).text()&&0!==$("#"+c).val().length&&($("#"+d).text("Show"),$("#"+c).attr("type","password"),$("#"+c).focus(),$("#"+d).attr("aria-label","Show password")))};this.showPasswordBtnDisabled=function(b,c,d){0!==
$("#"+d).val().length?$("#"+c).attr("aria-disabled","false"):$("#"+c).attr("aria-disabled","true")};this.trimSpace=function(b){var c=$("#"+b).val();void 0!=c&&null!=c&&""!=c&&(c=c.replace(/\s+/g," ").trim(),$("#"+b).val(c))};this.uncheck=function(b){$("."+b).prop("checked",!1)};this.updateMsg=function(b,c){$("#"+b).css("display","block");$(window).scrollTop(0);$("#"+b).slideDown("slow");$("#"+b).delay(5E3).slideUp("slow");window.setTimeout(function(){$("#"+b).append('\x3cdiv class\x3d"sr-only" id\x3d"'+
b+'-msg"\x3e'+$("#"+b).html()+"\x3c/div\x3e")},100);window.setTimeout(function(){$("#"+b+"-msg").remove()},200)};this.pwdValidate=function(b,c){b=$("#"+b).val();var d=b.charAt(0);8<=b.length&&12>=b.length&&(b.match(new RegExp(d,"gi")).length==b.length?($("#showPass").attr("aria-invalid",!0),$("#"+c).html('\x3cul class\x3d"list-unstyled"\x3e\x3cli\x3eEnter a valid password.\x3c/li\x3e\x3c/ul\x3e').css("color","red"),$("#"+c).parent().addClass("has-danger has-error")):0!=b.length&&$("#"+c).html(""))};
this.enableUpdBtn=function(b,c,d){if($("#"+d).prop("defaultValue")!=$("#"+d).val())$("#"+b).removeClass("btn-disabled").addClass("btn-default").removeAttr("disabled");else{var e=0;console.log(c.length);1<c.length?($("#"+c+" .form-control").each(function(){$(this).prop("defaultValue")!=$(this).val()&&e++}),0<e?$("#"+b).removeClass("btn-disabled").addClass("btn-default").removeAttr("disabled"):$("#"+b).removeClass("btn-default").addClass("btn-disabled").prop("disabled",!0)):$("#"+b).removeClass("btn-default").addClass("btn-disabled").prop("disabled",
!0)}};this.enableUpdPersonalInfoBtn=function(b,c,d,e){c=$("#"+c).text();d=$("#"+d).text();e=$("#"+e).text();var f=$("#input-firstName").val().trim(),g=$("#input-lastName").val().trim(),h=$("#emailIdaccount").val().trim(),l=AB.UCASERVICES.userProfile.firstName,k=AB.UCASERVICES.userProfile.lastName,q=AB.UCASERVICES.userProfile.emailId,n=!0;0<c.length||0<d.length||0<e.length?$("#"+b).addClass("disabled").prop("disabled",!0):""==f||""==g||""==h||1>=f.length||1>=g.length?$("#"+b).addClass("disabled").prop("disabled",
!0):f==l&&g==k&&h==q?$("#"+b).addClass("disabled").prop("disabled",!0):($("#"+b).removeClass("disabled").addClass("btn-default").removeAttr("disabled"),n=!1);return n};this.enableFulfillmentPreferenceButton=function(b,c){var d=AB.UCAADDRESSPREFERENCE.deliveryPhoneNumber;b=$("#"+b).val();b!==d&&10>=b.length?$("#"+c).removeClass("disabled").addClass("btn-default").removeAttr("disabled"):$("#"+c).addClass("disabled").prop("disabled",!0)};this.enableNotInYourAreaButton=function(b,c){5<=$("#"+b).val().length?
$("#"+c).removeClass("disabled").addClass("btn-default").removeAttr("disabled"):$("#"+c).addClass("disabled").prop("disabled",!0)};this.enablePwdBtn=function(b,c,d){console.warn($("#"+b).val());console.warn($("#"+c).val());$("#"+b).val().trim()===$("#"+c).val().trim()?$("#"+d).prop("disabled",!0):$("#"+b).val().trim()!==$("#"+c).val().trim()&&8<=$("#"+c).val().trim().length?$("#"+d).prop("disabled",!1):8<=$("#"+b).val().trim().length&&40>=$("#"+b).val().trim().length?$("#"+c).prop("disabled",!1):
($("#"+c).prop("disabled",!0),$("#"+c).val(""));0<$("#"+c).val().length?($("#npShow").attr("aria-disabled","false"),$("#npShow").attr("tabindex","0")):($("#npShow").attr("aria-disabled","true"),$("#npShow").attr("tabindex","-1"))};this.enableResetPassButton=function(b,c){8<=$("#"+b).val().length&&0>=$("#error-email.help-block.with-errors").find(".list-unstyled li").text().length?$("#"+c).removeClass("disabled").addClass("btn-default").removeAttr("disabled"):$("#"+c).addClass("disabled").prop("disabled",
!0)};this.enablePwdResetBtn=function(b,c,d,e){$("#"+e).hasClass("valid")&&$("#"+c).hasClass("valid")&&1<=$("#"+b).val().length?$("#"+d).removeClass("btn-disabled").addClass("btn-default").removeAttr("disabled"):(console.log(b),$("#"+d).removeClass("btn-default").addClass("btn-disabled").prop("disabled",!0))};this.validateLoyaltyParternersForm=function(b){var c=$("#alaska-airline-number").is(":empty"),d=$("#oldAANumber").val(),e=$("#alaska-airline-number").val();d?d&&d!=e?$("#"+b).removeClass("btn-disabled").addClass("btn-default").removeAttr("disabled"):
$("#"+b).removeClass("btn-default").addClass("btn-disabled").prop("disabled",!0):c&&d==e&&$("#loyaltyAcceptRadioBtn").prop("checked",!0)?($("#"+b).removeClass("btn-default").addClass("btn-disabled").prop("disabled",!0),$("#loyaltyDeclineRadioBtn").prop("checked",!0)):d&&d!=e||$("#loyaltyAcceptRadioBtn").prop("checked")?$("#"+b).removeClass("btn-disabled").addClass("btn-default").removeAttr("disabled"):$("#"+b).removeClass("btn-default").addClass("btn-disabled").prop("disabled",!0)};this.disableEnrollBtn=
function(b){$("#"+b).removeClass("btn-default").addClass("btn-disabled").prop("disabled",!0)};this.tcCheckEnableBtn=function(b,c,d){var e=0;console.log(c.length);var f=$(".form-control");console.log(f.length);if(1<c.length)if($("#"+c+" .form-control").each(function(){""!=$(this).val()&&e++}),console.log(e),e>=c.length-1)switch($("#"+d).is(":checked")){case !0:$("#"+b).removeClass("btn-disabled").addClass("btn-default").removeAttr("disabled");break;case !1:$("#"+b).removeClass("btn-default").addClass("btn-disabled").prop("disabled",
!0)}else $("#"+b).removeClass("btn-default").addClass("btn-disabled").prop("disabled",!0)};this.tcCheckEnableBtnShort=function(b,c){switch($("#"+c).is(":checked")){case !0:0<$("#error-email").text().length?$("#"+b).removeClass("primarybutton").addClass("btn-disabled").prop("disabled",!0):$("#"+b).removeClass("btn-disabled").addClass("primarybutton").removeAttr("disabled");break;case !1:$("#"+b).removeClass("primarybutton").addClass("btn-disabled").prop("disabled",!0)}};this.enablePwdUpdBtn=function(b,
c,d){b=$("#"+b).text();c=$("#"+c).text();var e=$("#c-password").val(),f=$("#n-password").val();0<b.length||0<c.length?$("#"+d).removeClass("btn-default").addClass("btn-disabled").prop("disabled",!0):""==e||""==f?$("#"+d).removeClass("btn-default").addClass("btn-disabled").prop("disabled",!0):$("#"+d).removeClass("btn-disabled").addClass("btn-default").removeAttr("disabled")};this.displayBlock=function(b){$("."+b).css("display","block")};this.displayNone=function(b){$("."+b).css("display","none")};
this.enableUpdBtnCheckBox=function(b,c){this.uncheck(b);b=$("#J4U").is(":checked")?"S":"U";var d=$("#EmailSave").is(":checked")?"S":"U";var e=$("#GroceryDel").is(":checked")?"S":"U";var f=$("#ProdRecall").is(":checked")?"S":"U";$("#J4Ui").val()==b&&$("#EmailSavei").val()==d&&$("#GroceryDeli").val()==e&&$("#ProdRecalli").val()==f?$("#"+c).removeClass("primarybutton").addClass("btn-disabled").prop("disabled",!0):$("#"+c).removeClass("btn-disabled").addClass("primarybutton").removeAttr("disabled")};
this.modelshow=function(b){$("#"+b).modal("show")};this.modelhide=function(b){$("#"+b).modal("hide")};this.accessibilityModalFocusing=function(b){$("#"+b).on("shown",function(){$("#"+b).focus()})};this.enableSignInBtn=function(b,c,d){8<$("#"+c).val().length?$("#"+b+" .form-control").each(function(){8<=$(this).val().length?$("#"+d).removeClass("btn-disabled").addClass("btn-default").removeAttr("disabled"):$("#"+d).removeClass("btn-default").addClass("btn-disabled").prop("disabled",!0)}):$("#"+d).removeClass("btn-default").addClass("btn-disabled").prop("disabled",
!0)};this.resetPhoneInfoModalFocus=function(){$("#ucaPhoneInfoModalbtn").focus()};this.tcCheckdeltaEnableButton=function(b,c,d,e){var f=0;$(".form-control");1<d.length&&($("#"+d+" .form-control").each(function(){""!=$(this).val()&&f++}),2<=f&&($("#"+e).is(":checked")?($("#"+c).prop("disabled",!1),$("#"+c).removeClass("disabled"),$("#"+c).addClass("primarybutton")):($("#"+c).removeClass("primarybutton"),$("#"+c).prop("disabled",!0),$("#"+c).addClass("btn-default disabled"))));b.stopPropagation();$("#deltareg").unbind("focusout")};
this.validateFormSubmit=function(b){var c=!0,d=$(b).find("[required]");b=$(b).find(".uca-form-submit-btn");for(var e=0;e<d.length;e++)if($(d[e]).parent().hasClass("checkBox")){if(!d[e].checked){c=!1;break}}else if(!$(d[e]).val()){c=!1;break}0!=$(".has-error").length&&(c=!1);c?b.removeClass("btn-disabled").removeClass("disabled").addClass("primarybutton").removeAttr("disabled"):b.removeClass("primarybutton").addClass("btn-disabled").prop("disabled",!0)};this.clearErrorMessage=function(b){console.log(b);
$("#"+b).closest(".form-group").removeClass("has-error has-danger");$("#"+b).siblings().find("ul.list-unstyled").remove()};this.fgtPassClearFormErrorMessageOnFocus=function(){$("#forget-pwd-error").html("").addClass("d-none").hide()};this.enableDisabledInputField=function(b,c){0<$("#"+b).val().trim().length?(8<=$("#"+b).val().trim().length&&40>=$("#"+b).val().trim().length&&$("#"+c).removeAttr("disabled"),$("#cpShow").attr("aria-disabled","false")):($("#"+c).prop("disabled",!0),$("#"+c).val(""),$("#cpShow").attr("aria-disabled",
"true"))};$('form[data-toggle\x3d"validator"]').validator({custom:{address1zippwdminlength:function(b){var c=b.data("address1zippwdminlength");if(b.val().length<c)return b.get(0).hasAttribute("analytics-enabled")&&(0==b.val().length&&b.get(0).hasAttribute("data-required-error")?AB.DATALAYER.setError("8118","createAccountError",b.get(0).getAttribute("data-required-error")):AB.DATALAYER.setError("8118","createAccountError","Please enter "+c+" numbers or more.")),"Please enter "+c+" numbers or more."},
firstnameminchars:function(b){var c=b.data("firstnameminchars");if(b.val().length<c)return"Please enter a first name that is between 2 - 30 characters."},firstnamepattern:function(b){var c=b.val().replace(/ {1,}/g," ");$("#input-firstName").val(c);if(!(new RegExp(b.data("firstnamepattern"))).test(c))return"Please enter a first name that includes only letters or hyphens."},lastnameminchars:function(b){var c=b.data("lastnameminchars");if(b.val().length<c)return"Please enter a last name that is between 2 - 30 characters."},
lastnamepattern:function(b){var c=b.val().replace(/ {1,}/g," ");$("#input-lastName").val(c);if(!(new RegExp(b.data("lastnamepattern"))).test(c))return"Please enter a last name that includes only letters or hyphens."},phoneccminlength:function(b){var c=b.data("phoneccminlength"),d=b.data("limit-error");if(b.val().length<c)return b.get(0).hasAttribute("analytics-enabled")&&(0==$.trim(b.val()).length&&b.get(0).hasAttribute("data-required-error")?AB.DATALAYER.setError("9057","createAccountError",b.get(0).getAttribute("data-required-error")):
AB.DATALAYER.setError("9057","createAccountError","Please enter a phone number or Club Card that contains at least 10 digits.")),d||"Please enter a phone number or Club Card that contains at least 10 digits."},phoneccpattern:function(b){var c=b.data("required-error");if(!(new RegExp(b.data("phoneccpattern"))).test(b.val()))return b.get(0).hasAttribute("analytics-enabled")&&AB.DATALAYER.setError("9057","createAccountError","Please enter a Club Card or phone number that doesn't start with a 0 or 1."),
c||"Please enter a Club Card or phone number that doesn't start with a 0 or 1."},isphonevalid:function(b){var c=b.data("isphonevalid");b=b.data("limit-error");if($("#pOrCcValidate").val()!==c)return b||"Please enter a phone number or Club Card that contains at least 10 digits."},emailpattern:function(b){var c=b.val().trim();if(!(new RegExp(b.data("emailpattern"))).test(c))return b.get(0).hasAttribute("analytics-enabled")&&(0==$.trim(b.val()).length&&b.get(0).hasAttribute("data-required-error")?AB.DATALAYER.setError("5759",
"createAccountError",b.get(0).getAttribute("data-required-error")):AB.DATALAYER.setError("5759","createAccountError","Please enter a valid email address.")),"Please enter a valid email address."},samePassword:function(b){if($("#c-password").val().trim()==b.val().trim())return"Your new password cannot be the same as your old password, please enter a different password."},validpwdpattern:function(b){var c=$("#input-firstName").val().toLowerCase(),d=$("#input-lastName").val().toLowerCase();if(0<$("#emailId").length){var e=
$("#emailId").val().toLowerCase();if(-1!==e.indexOf("@")&&-1!==e.indexOf(".")){var f=e.split("@");var g=f[0];f=f[1];f=f.split(".");f=f[0]}}else 0<$("#input-email").length&&(e=$("#input-email").val().toLowerCase(),-1!==e.indexOf("@")&&-1!==e.indexOf(".")&&(f=e.split("@"),g=f[0],f=f[1],f=f.split("."),f=f[0]));var h=b.val().toLowerCase(),l=h.charAt(0);l.match(/^[!@#$%^&*()_+\-=\[\]{};':"\\|,.<>\/?]*$/)?(l=l.replace(/[-\/\\^$*+?.()|[\]{}]/g,"\\$\x26"),l=new RegExp(l,"g")):l=new RegExp(l,"gi");l=h.match(l).length;
console.log("repeat count\x3d"+l);var k=new RegExp(b.data("validpwdpattern"));if(c&&-1<h.indexOf(c)||d&&-1<h.indexOf(d)||g&&-1<h.indexOf(g)||f&&-1<h.indexOf(f)||e&&-1<e.indexOf(h))return b.get(0).hasAttribute("analytics-enabled")&&AB.DATALAYER.setError("8118","createAccountError","Password must not be the same as your email address, firstname, or lastname."),"Password must not be the same as your email address, firstname, or lastname.";if(l==h.length)return b.get(0).hasAttribute("analytics-enabled")&&
AB.DATALAYER.setError("8118","createAccountError","Password has repeated characters."),"Password has repeated characters.";if(!k.test(b.val()))return b.get(0).hasAttribute("analytics-enabled")&&(0==$.trim(b.val()).length&&b.get(0).hasAttribute("data-required-error")?AB.DATALAYER.setError("8118","createAccountError",b.get(0).getAttribute("data-required-error")):AB.DATALAYER.setError("8118","createAccountError","Only Numbers, letters, spaces and special characters are allowed.")),"Only Numbers, letters, spaces and special characters are allowed."},
validatepwdpattern:function(b){var c=b.data("passwordlengthrequirement");if(b.val().trim().length<c){var d="Please enter a password.";b.get(0).hasAttribute("analytics-enabled")&&(0===b.val().trim().length&&b.get(0).hasAttribute("data-required-error")?AB.DATALAYER.setError("8118","createAccountError",b.get(0).getAttribute("data-required-error")):AB.DATALAYER.setError("8118","createAccountError","Please enter a password that contains at least "+c+" characters."));1<=b.val().trim().length&&(d="Please enter a password that contains at least "+
c+" characters.");return d}if(!(new RegExp(b.data("validatepwdpattern"))).test(b.val().trim()))return b.get(0).hasAttribute("analytics-enabled")&&AB.DATALAYER.setError("8118","createAccountError","Password must contain at least one character and one number."),"Password must contain at least one character and one number."}}}).off("input.bs.validator focus.bs.validator");this.validatePasswordLength=function(b,c){8<=$("#"+b).val().trim().length&&40>=$("#"+b).val().trim().length?($("#"+c).addClass("valid-password"),
$("#valid-password-tick").removeClass("mask"),this.passwordReqirementMet||(setTimeout(function(){$("#password-req-msg").text("Password requirements have been met")},50),this.passwordReqirementMet=!0)):($("#"+c).removeClass("valid-password"),$("#valid-password-tick").addClass("mask"),this.passwordReqirementMet&&(setTimeout(function(){$("#password-req-msg").text("")},50),this.passwordReqirementMet=!1))};this.defaultError=function(b){!b||400!==b.status&&403!==b.status&&401!==b.status||SWY.ENFORCEMENT.singleSignOnUser(window.location.href)};
this.checkUpdatePasswordError=function(){var b=$("#error-c-pwd").text(),c=$("#error-n-pwd").text(),d=!1;if(0<b.length||0<c.length)d=!0;return d}}).call(AB.VALIDATION);var Cities_Arry="bangor orono augusta portland camden verona bucksport hampden brewer hermon kennebunkport acadia barharbor presqueisle etna waterville scaroborough perry eastport freeport".split(" "),Names_Arry="annie brielle bill arvind sumit sriram ashutosh lee tahla umair jen bernardo sean gerard harsha uma hatim edwin shamal girish".split(" ");
$("#unifiedRegistration").validator().on("submit",function(b){var c=$("#input-firstName").val().trim(),d=$("#input-lastName").val().trim(),e=$("#input-email").val().trim(),f=$("#showPass").val().trim(),g=$("#input-clubCardNumber").val().trim();0>=c.length||$("#error-fname")&&0<$("#error-fname")[0].innerHTML.length?$("#input-firstName").focus():0>=d.length||$("#error-lname")&&0<$("#error-lname")[0].innerHTML.length?$("#input-lastName").focus():0>=e.length||$("#error-email")&&0<$("#error-email")[0].innerHTML.length?
$("#input-email").focus():0>=f.length||$("#error-password")&&0<$("#error-password")[0].innerHTML.length?$("#showPass").focus():(0>=g.length||$("#error-phoneOrClubcard")&&0<$("#error-phoneOrClubcard")[0].innerHTML.length)&&$("#input-clubCardNumber").focus();if(!b.isDefaultPrevented()){$("title").val("test");var h={},l={},k={},q="",n={},p="true",m="false";b=AB.userInfo.preferenceMode;c=$("#unifiedRegistration").serializeArray();"J4U"===b&&(b="Preferred");$.each(c,function(){h[this.name]?(h[this.name].push||
(h[this.name]=[h[this.name]]),h[this.name].push(this.value||"")):(":cq_csrf_token"!=this.name&&(h[this.name]=this.value.trim()||""),("phone"===this.name||"firstName"===this.name||"lastName"===this.name||"zipCode"===this.name||"emailId"===this.name||"password"===this.name)&&0>=this.value.length&&(p="false"),"phone"===this.name&&10<this.value.length&&(q=this.value,h.clubCardNumber=q||""),"phone"===this.name&&(10>=this.value.length?(l.type="mobile",l.number=this.value):(l.type="mobile",l.number=""),
h[this.name]=[l]),"stores"===this.name&&(n.storeId=AB.userInfo.j4u.storeId,n.storePreference="Preferred"),"preferences"===this.name&&("on"===this.value&&(k.emailOffers="Y"),"off"===this.value&&(k.emailOffers="N"),k.stores=[n],h[this.name]=k||"",m="true"),"terms"===this.name&&(h[this.name]="on"===this.value?"Y":"N"))});"false"===m&&(k.emailOffers="",k.stores=[n],h.preferences=k||"",m="true");h.sourceProgram=AB.GETPROFILE.sourceOfRegistration||"";n.storeId=AB.userInfo.j4u.storeId;n.storePreference=
b||"Preferred";h.stores=AB.userInfo.j4u.storeId||SWY.CONFIGSERVICE.storeResolutionConfig.bannerDefaultStoreId;h.zipCode=AB.userInfo.j4u.zipcode||SWY.CONFIGSERVICE.storeResolutionConfig.bannerDefaultZipcode;h.banner=AB.userInfo.banner||"";"true"===p&&(b=JSON.stringify(h),$("#unifiedRegistration #loaderSignIn").removeClass("mask").addClass("unmask"),$("#unifiedRegistration #signInLoadingEmpty").removeClass("unmask").addClass("mask"),$.ajax({type:"POST",headers:AB.ucaHttpOptions,url:AB.shortRegPath,
data:b,dataType:"json",success:function(b,c,d){if("200"==d.status||"201"==d.status||"206"==d.status)localStorage.setItem("create-account-success",!0),d.responseJSON&&d.responseJSON.authorization&&d.responseJSON.authorization.sessionToken&&d.responseJSON.authorization.sessionToken.token?(AB.COMMON.userNotifyReloadPage("Account successfully created! You are now signed in."),c=AB.COMMON.getCookie("ECommRedirectURL"),AB.INSTANTALLOCATION.isEligibleForOffer&&c&&-1!==c.indexOf("/justforu/coupons-deals.html?")&&
_updateCoretationDate(b,d),b=SWY.CONFIGSERVICE.getOktaConfig().issuer+"/v1/authorize?client_id\x3d"+SWY.CONFIGSERVICE.getOktaConfig().clientId+"\x26redirect_uri\x3d"+SWY.CONFIGSERVICE.getOktaConfig().redirectUri+"\x26response_type\x3dcode\x26response_mode\x3dquery\x26state\x3dspooky-system-"+Cities_Arry[Math.floor(Math.random()*Cities_Arry.length)]+"-"+Names_Arry[Math.floor(Math.random()*Names_Arry.length)]+"\x26nonce\x3dovJgrUobDYQKhiownVT9jU1GvtkRdpC4Eoyal2SfgGu6ezXG5b03393l08xbDGw8\x26scope\x3dopenid%20profile%20email%20offline_access%20used_credentials\x26sessionToken\x3d",
b+=d.responseJSON.authorization.sessionToken.token,SWY.CONFIGSERVICE.checkLocalStorageRefresh(),window.location.href=b):SWY.ENFORCEMENT.sendRedirect(SWY.configService.wwwSignInPagePath,!0);d&&d.responseJSON&&d.responseJSON.errorCode&&AB.DATALAYER.setError(d&&d.responseJSON&&d.responseJSON.errorCode||"","createAccountError",d&&d.responseJSON&&d.responseJSON.message||"")},error:function(b,c,d){c="";if(0===b.status)c="Sorry, we're having technical difficulties, please check back later.";else if(b.responseJSON)for(datos in b.responseJSON)if("errors"===
datos&&b.responseJSON[datos][0].fieldName&&0<b.responseJSON[datos][0].fieldName.length){"phoneNumber"===b.responseJSON[datos][0].fieldName&&(c+=b.responseJSON[datos][0].message);"clubCardNumber"===b.responseJSON[datos][0].fieldName&&(c+=b.responseJSON[datos][0].message);if("userId"===b.responseJSON[datos][0].fieldName||-1!=b.responseJSON[datos][0].message.indexOf("Invalid Email Address"))c+="Please enter a valid email address.";"lastName"===b.responseJSON[datos][0].fieldName&&(c+=b.responseJSON[datos][0].message);
"firstName"===b.responseJSON[datos][0].fieldName&&(c+=b.responseJSON[datos][0].message);"zipCode"===b.responseJSON[datos][0].fieldName&&(c+=b.responseJSON[datos][0].message);if("password"===b.responseJSON[datos][0].fieldName||"confPwd"===b.responseJSON[datos][0].fieldName)c+=b.responseJSON[datos][0].message}else c="errorCode"===datos&&"IACUA0002"===a.responseJSON[datos]?"Please select your local store to continue.":"Sorry, we're having technical difficulties and working on fixing them, please check back later.";
else c="Sorry, we're having technical difficulties and working on fixing them, please check back later.";$("#result").html("\x3cspan\x3e"+c+"\x3c/span\x3e");AB.DATALAYER.setError(b&&b.responseJSON&&b.responseJSON.errorCode||"","createAccountError",c||d||"");$("#unifiedRegistration #loaderSignIn").removeClass("unmask").addClass("mask");$("#unifiedRegistration #signInLoadingEmpty").removeClass("mask").addClass("unmask")}}))}return!1});
(function(){this.sourceOfRegistration=this.regEmailRequest=this.regPhoneRequest="";this.init=function(){0<$(".main-wrap-delta-reg").length&&(_getrofile(),_getLocationInfo());0<$(".main-wrap-registration").length&&_getLocationInfo();0<$(".acc-page-delivery-address").length&&_getLocationInfo();0<$(".main-wrap-reg-short").length&&(_autoFillZipAndStore(),_getSourceOfReg())};_getrofile=function(){$.ajax({type:"GET",headers:AB.ucaHttpOptions,url:AB.COMMON.ucaAPIPathWithCustomerId(AB.getprofileAddressPath),
dataType:"json",success:function(b,c,d){b=JSON.stringify(d.responseJSON);b=JSON.parse(b);$("#zipCode").val(AB.COMMON.getURLParameterByName("zipcode"));for(var e in b.phone)$("#phone").val(b.phone[e].number);$("#emailId").val(b.clubCardNumber);$("#emailId").val(b.emailId);$("#lastName").val(b.lastName);$("#firstName").val(b.firstName);$("#result").html("")},error:function(b,c,d){c="";for(datos in b.responseJSON)c+=b.responseJSON[datos]+"\x3cbr\x3e";$("#result").html(c)}})};_autoFillZipAndStore=function(){AB.userInfo&&
!$.isEmptyObject(AB.userInfo.j4u.storeData.storeLocation)?$("#shortRegZIP").val(AB.userInfo.j4u.storeData.storeLocation.zipcode):$.isEmptyObject(SWY.CONFIGSERVICE.storeResolutionConfig.bannerDefaultZipcode)||$("#shortRegZIP").val(SWY.CONFIGSERVICE.storeResolutionConfig.bannerDefaultZipcode);$.isEmptyObject($("#shortRegZIP").val())||5!=$("#shortRegZIP").val().length||_getLocationGeoSearch()};_getSourceOfReg=function(){var b=new URLSearchParams(location.search);AB.GETPROFILE.sourceOfRegistration=b.get("source")}}).call(AB.GETPROFILE);
function tcCheckEnableButton(b,c,d,e){var f=0;$(".form-control");1<d.length&&($("#"+d+" .form-control").each(function(){""!=$(this).val()&&f++}),f>d.length-2&&($("#"+e).is(":checked")?($("#"+c).prop("disabled",!1),$("#"+c).removeClass("btn-disabled disabled"),$("#"+c).addClass("primarybutton")):($("#"+c).removeClass("primarybutton"),$("#"+c).prop("disabled",!0),$("#"+c).addClass("btn-disabled"))));b.stopPropagation();$("#fullreg").unbind("focusout")}
function tcCheckdeltaEnableButton(b,c,d,e){$("#"+c).prop("disabled",!1);$("#"+c).removeClass("btn-disabled disabled");$("#"+c).addClass("primarybutton");b.stopPropagation();$("#deltareg").unbind()}
_getLocationInfo=function(){var b=SWY.CONFIGSERVICE.getDatapowerConfig().datapowerBasePath+"/api/uca/cities/"+AB.COMMON.getURLParameterByName("zipcode");$.ajax({type:"GET",headers:AB.ucaHttpOptions,dataType:"json",url:b,success:function(b){var c=document.getElementById("selectCity");AB.locationInfo=b;if(null!=b&&1<AB.locationInfo.cities.length){$("#zipCode").val(AB.COMMON.getURLParameterByName("zipcode"));$("#multicity").val("true");$("#regzip").html(AB.COMMON.getURLParameterByName("zipcode"));$("#inputstate").val(AB.locationInfo.state);
$("#regstate").html(AB.locationInfo.state);$("#citys").hide();$("input#city:hidden").remove();var e=0,f;for(f in AB.locationInfo.cities){var g=document.createElement("option");g.text=AB.locationInfo.cities[e];g.value=AB.locationInfo.cities[e];c.options.add(g,f);e++}}null!=b&&1==AB.locationInfo.cities.length&&($("#selectCity").prop("required",!1),$("#citym").remove(),$("#zipCode").val(AB.COMMON.getURLParameterByName("zipcode")),$("#inputcity").val(AB.locationInfo.cities[0]),$("#multicity").val("false"),
$("#inputstate").val(AB.locationInfo.state),$("#regcity").html(AB.locationInfo.cities[0]),$("#regzip").html(AB.COMMON.getURLParameterByName("zipcode")),$("#regstate").html(AB.locationInfo.state))},error:function(b,d,e){console.error("Invalid request response.")}})};
_getLocationGeoSearch=function(){var b=$("#shortRegZIP").val();if(0<$(".main-wrap-reg-short").length&&5==b.length){var c=AB.userInfo.banner?AB.userInfo.banner:SWY.CONFIGSERVICE.getResolvedBanner();if(c&&SWY.CONFIGSERVICE.storeResolutionConfig){var d=SWY.CONFIGSERVICE.storeResolutionConfig.yextConfig,e=d.geoSearchAPIPath,f=d.apiKey,g=d.version,h=d.limit;d=d.radius;c=encodeURIComponent('[{"custom95965": {"equalTo":["'+c+'"]}}]');$.ajax({type:"GET",headers:AB.ucaHttpOptions,dataType:"json",url:e+"?api_key\x3d"+
f+"\x26v\x3d"+g+"\x26location\x3d"+b+"\x26limit\x3d"+h+"\x26radius\x3d"+d+"\x26filters\x3d"+c,success:function(b){var c=document.getElementById("selectpicker");c.options.length=0;if(null!=b&&0<b.response.count){for(var d in b.response.locations){var e=document.createElement("option");e.text=b.response.locations[d].address+" "+b.response.locations[d].state;e.value=b.response.locations[d].id;c.options.add(e,d)}$("#selectpicker").prop("disabled",!1);$("#zpfld").removeClass("has-error");$("#shortRegZIP").attr("aria-invalid",
!1);$("#error-zip").empty();$(".zip-container").closest(".has-error").removeClass("has-error").find("#error-zip").empty()}else $("#zpfld").addClass("has-error"),$("#shortRegZIP").attr("aria-invalid",!0),$("#error-zip").html('\x3cul class\x3d"list-unstyled"\x3e\x3cli\x3eNo stores found. Please try another 5-digit ZIP code.\x3c/li\x3e\x3c/ul\x3e').css("color","red"),$(".has-error .form-control").css("border","2px solid #dd1e25 !important");$("#selectpicker").closest("form").trigger("change.bs.validator")},
error:function(b,c,d){console.log("Invalid request response.")}})}}$("#selectpicker").focus()};
_updateCoretationDate=function(b,c){var d=AB.COMMON.getCookie("ECommRedirectURL"),e="";c.getResponseHeader("X-Swy-Correlation-Id")&&(e+="\x26eventCorrelationId\x3d"+c.getResponseHeader("X-Swy-Correlation-Id")+"\x26");if(b.accountStatuses)for(store in b.accountStatuses)"ONLINE_ENROLLMENT"===b.accountStatuses[store].type&&b.accountStatuses[store].effectiveTimePeriods[0]&&b.accountStatuses[store].effectiveTimePeriods[0].startDate&&(e+="eventDateTime\x3d"+(b.accountStatuses[store].effectiveTimePeriods[0].startDate+
"T"+b.accountStatuses[store].effectiveTimePeriods[0].startTime+"Z"));b=d+encodeURIComponent(e);AB.COMMON.setCookie("ECommRedirectURL",b,0)};$("#shortRegZIP").keypress(function(b){if(13==b.keyCode)return _getLocationGeoSearch(),!1});
$("#shortreg").validator().on("valid.bs.validator invalid.bs.validator",function(b){var c=!0;console.warn($("#shortreg").data("bs.validator").isIncomplete());$("#shortreg").data("bs.validator").isIncomplete()?($("#create-account-btn").attr("aria-disabled","true"),c=!0):($("#create-account-btn").attr("aria-disabled","false"),c=!1);$.each($("#shortreg").data("bs.validator").$inputs,function(b){b.tooShort&&($("#create-account-btn").attr("aria-disabled","true"),c=!0)});$("#create-account-btn").attr("aria-disabled",
String(c))});
$("#shortreg").validator().on("submit",function(b){if(!b.isDefaultPrevented()){$("title").val("test");var c={},d={},e={},f="",g={},h="true",l="false";b=$("#shortreg").serializeArray();$.each(b,function(){c[this.name]?(c[this.name].push||(c[this.name]=[c[this.name]]),c[this.name].push(this.value||"")):(":cq_csrf_token"!=this.name&&(c[this.name]=this.value||""),("phone"==this.name||"firstName"==this.name||"lastName"==this.name||"zipCode"==this.name||"emailId"==this.name||"password"==this.name)&&0>=
this.value.length&&(h="false"),"phone"==this.name&&10<this.value.length&&(f=this.value,c.clubCardNumber=f||""),"phone"==this.name&&(10>=this.value.length?(d.type="mobile",d.number=this.value):(d.type="mobile",d.number=""),c[this.name]=[d]),"stores"==this.name&&(g.storeId=this.value,g.storePreference="Preferred"),"preferences"==this.name&&("on"==this.value&&(e.emailOffers="Y"),"off"==this.value&&(e.emailOffers="N"),e.stores=[g],c[this.name]=e||"",l="true"),"terms"==this.name&&(c[this.name]="on"==this.value?
"Y":"N"))});"false"==l&&(e.emailOffers="",e.stores=[g],c.preferences=e||"",l="true");c.sourceProgram=AB.GETPROFILE.sourceOfRegistration||"";"true"==h&&(b=JSON.stringify(c),$("#loaderSignIn").removeClass("mask").addClass("unmask"),$("#signInLoadingEmpty").removeClass("unmask").addClass("mask"),$("#create-account-btn").prop("disabled",!0).addClass("button-disable-color"),$.ajax({type:"POST",headers:AB.ucaHttpOptions,url:AB.shortRegPath,data:b,dataType:"json",success:function(b,c,d){if("200"==d.status||
"201"==d.status||"206"==d.status)localStorage.setItem("short_registration_success",!0),d.responseJSON&&d.responseJSON.authorization&&d.responseJSON.authorization.sessionToken&&d.responseJSON.authorization.sessionToken.token?(b=SWY.CONFIGSERVICE.getOktaConfig().issuer+"/v1/authorize?client_id\x3d"+SWY.CONFIGSERVICE.getOktaConfig().clientId+"\x26redirect_uri\x3d"+SWY.CONFIGSERVICE.getOktaConfig().redirectUri+"\x26response_type\x3dcode\x26response_mode\x3dquery\x26state\x3dspooky-system-"+Cities_Arry[Math.floor(Math.random()*
Cities_Arry.length)]+"-"+Names_Arry[Math.floor(Math.random()*Names_Arry.length)]+"\x26nonce\x3dovJgrUobDYQKhiownVT9jU1GvtkRdpC4Eoyal2SfgGu6ezXG5b03393l08xbDGw8\x26scope\x3dopenid%20profile%20email%20offline_access%20used_credentials\x26sessionToken\x3d",b+=d.responseJSON.authorization.sessionToken.token,SWY.CONFIGSERVICE.checkLocalStorageRefresh(),window.location.href=b):SWY.ENFORCEMENT.sendRedirect(SWY.configService.wwwSignInPagePath,!0);AB.DATALAYER.pushEvent("short_registration_error")},error:function(b,
c,d){c="";for(datos in b.responseJSON)if("errors"==datos){"phoneNumber"==b.responseJSON[datos][0].fieldName&&(c+=b.responseJSON[datos][0].message);"clubCardNumber"==b.responseJSON[datos][0].fieldName&&(c+=b.responseJSON[datos][0].message);if("userId"==b.responseJSON[datos][0].fieldName||-1!=b.responseJSON[datos][0].message.indexOf("Invalid Email Address"))c+="The email address you entered is already associated with an account. Please re-enter the email address or call Customer Care at 1-877-258-2799.";
"lastName"==b.responseJSON[datos][0].fieldName&&(c+=b.responseJSON[datos][0].message);"firstName"==b.responseJSON[datos][0].fieldName&&(c+=b.responseJSON[datos][0].message);"zipCode"==b.responseJSON[datos][0].fieldName&&(c+=b.responseJSON[datos][0].message);if("password"==b.responseJSON[datos][0].fieldName||"confPwd"==b.responseJSON[datos][0].fieldName)c+=b.responseJSON[datos][0].message}else"errorCode"==datos&&"IACUA0002"==a.responseJSON[datos]?c+="Please select your local store to continue.":"errorCode"==
datos&&"IACUA0002"==a.responseJSON[datos]&&(c+="Please select your local store to continue.");$("#result").html("\x3cli\x3e"+c+"\x3c/li\x3e");AB.DATALAYER.pushEvent("short_registration_error");$("#loaderSignIn").removeClass("unmask").addClass("mask");$("#signInLoadingEmpty").removeClass("mask").addClass("unmask");$("#create-account-btn").prop("disabled",!1).removeClass("button-disable-color").attr("aria-disabled","false");$("#create-account-btn").addClass("disabled")}}))}return!1});
$(function(){$("#input-clubCardNumber").blur(function(){var b=$.trim($("#input-clubCardNumber").val()).replace(/[\ \-\(\)]/g,"");$("#input-clubCardNumber").val(b);"object"==typeof AB.GETPROFILE.regPhoneRequest?AB.GETPROFILE.regPhoneRequest.abort():AB.GETPROFILE.regPhoneRequest="";$("#pOrCcValidate").val("");$("#p0rCcValidate").focusout();if(10<=b.length&&19>=b.length)if(isNaN(b))$("#error-phoneOrClubcard").html('\x3cul class\x3d"list-unstyled"\x3e\x3cli\x3e You\'ve entered a phone number or Club Card that includes characters other than numbers, please try again.\x3c/li\x3e\x3c/ul\x3e'),
$("#input-clubCardNumber").parent().addClass("has-error"),$("#input-clubCardNumber").attr("aria-invalid",!0),$("#input-clubCardNumber").parent().css("border","2px solid #dd1e25 !important");else if(10!==b.length||"0"!==b.charAt(0)&&"1"!==b.charAt(0)){var c=document.getElementById("error-phoneOrClubcard"),d=SWY.CONFIGSERVICE.datapowerConfig.cncServiceBasePath+"/api/uca/ccphone/"+b;$("#phoneProgressIcon").removeClass("mask");c.innerHTML="";AB.GETPROFILE.regPhoneRequest=$.ajax({type:"GET",headers:AB.ucaHttpOptions,
url:d,success:function(c,d,g){$("#phoneProgressIcon").addClass("mask");c.notInUse?($("#pOrCcValidate").val(b),$("#pOrCcValidate").focusout()):(c=$("#shortreg"),d=$("#unifiedRegistration"),c=0<d.length?d:c,d=c.attr("data-signin"),g=c.attr("data-contactSuport"),c.attr("data-recoverPassword"),c='An account is already linked with the Club Card/phone number you\'ve entered. Please \x3ca style\x3d"text-decoration: underline;color: #dd1e25;" href\x3d" '+d+'"\x3esign in\x3c/a\x3e here, or for additional help contact \x3ca style\x3d"text-decoration: underline;color: #dd1e25;" href\x3d"'+
g+'"\x3eCustomer Support\x3c/a\x3e here.',$("#error-phoneOrClubcard").append('\x3cul class\x3d"list-unstyled"\x3e\x3cli\x3e'+c+"\x3c/li\x3e\x3c/ul\x3e"),$("#input-clubCardNumber").parent().addClass("has-error"),$("#input-clubCardNumber").attr("aria-invalid",!0),$("#input-clubCardNumber").parent().css("border","2px solid #dd1e25 !important"),$("#pOrCcValidate").val(""),$("#pOrCcValidate").focusout(),AB.DATALAYER.setError("9057","createAccountError","An account is already linked with the Club Card/phone number you've entered. Please sign in here, or for additional help contact Customer Support here."))},
error:function(b,c,d){c="";var e=(d=$("#input-clubCardNumber").data("required-error"))||"Please enter a Club Card or phone number that doesn\x26#x27;t start with a 0 or 1.";$("#phoneProgressIcon").addClass("mask");if(0===b.status)e="Sorry, we're having technical difficulties, please check back later.";else if(b.responseJSON){for(datos in b.responseJSON)"subErrors"==datos&&(c+=b.responseJSON[datos][0].message+"\x3cbr\x3e");c||(e=406===b.status?d||"Please enter a Club Card or phone number that doesn\x26#x27;t start with a 0 or 1.":
"Sorry, we're having technical difficulties and working on fixing them, please check back later.")}else e="Sorry, we're having technical difficulties and working on fixing them, please check back later.";$("#error-phoneOrClubcard").html('\x3cul class\x3d"list-unstyled"\x3e\x3cli\x3e'+e+"\x3c/li\x3e\x3c/ul\x3e");$("#input-clubCardNumber").parent().addClass("has-error");$("#input-clubCardNumber").attr("aria-invalid",!0);$("#input-clubCardNumber").parent().css("border","2px solid #dd1e25 !important");
AB.DATALAYER.setError("9057","createAccountError",e)}})}else $("#error-phoneOrClubcard").html('\x3cul class\x3d"list-unstyled"\x3e\x3cli\x3ePlease enter a Club Card or phone number that doesn\x26#x27;t start with a 0 or 1.\x3c/li\x3e\x3c/ul\x3e'),$("#input-clubCardNumber").parent().addClass("has-error"),$("#input-clubCardNumber").attr("aria-invalid",!0),$("#input-clubCardNumber").parent().css("border","2px solid #dd1e25 !important")})});
$(function(){$("#input-email").blur(function(){if("true"===$("#unifiedRegistration").attr("data-isFormTriggered")&&("object"==typeof AB.GETPROFILE.regEmailRequest?AB.GETPROFILE.regEmailRequest.abort():AB.GETPROFILE.regEmailRequest="",$("#emailIdvalidate").val(""),$("#emailIdvalidate").focusout(),0<$.trim($("#input-email").val()).length&&0==$("#error-email ul").length)){var b=$(this).val().trim(),c=document.getElementById("error-email"),d=SWY.CONFIGSERVICE.datapowerConfig.cncServiceBasePath+"/api/uca/email",
e={emailAddress:""},f=/^[a-zA-Z0-9.!#$%&\u2019*+/=?^_`{|}~-]+@[a-zA-Z0-9-]+\.([a-zA-Z0-9-.]+)$/;c.innerHTML="";b&&f.test(b)?($("#emailProgressIcon").removeClass("mask"),e.emailAddress=b,AB.GETPROFILE.regEmailRequest=$.ajax({type:"POST",headers:AB.ucaHttpOptions,url:d,dataType:"json",data:JSON.stringify(e),success:function(c,d,e){AB.GETPROFILE.regEmailRequest="";$("#emailProgressIcon").addClass("mask");if(c.notInUse)$("#emailIdvalidate").val(b),$("#emailIdvalidate").focusout();else{d=$("#shortreg");
e=$("#unifiedRegistration");var g=0<e.length?e:d;e=g.attr("data-signin");d=g.attr("data-contactSuport");g=g.attr("data-recoverPassword");e='You already have an account linked to the email entered, please sign in \x3ca style\x3d"text-decoration: underline;color: #dd1e25;" href\x3d" '+e+'"\x3e here \x3c/a\x3e or reset your password \x3ca style\x3d"text-decoration: underline;color: #dd1e25;" href\x3d"'+g+'" onclick\x3d"AB.DATALAYER.setForgotPasswordCookie()"\x3ehere\x3c/a\x3e if needed.';d='The email address entered is currently linked to a deactivated account.\t\t\t\t\t\t\t\tPlease use a different email address or contact Customer Support \x3ca style\x3d"text-decoration: underline;color: #dd1e25;" href\x3d"'+
d+'"\x3ehere\x3c/a\x3e.';NaN;void 0!==c.isAccountStatusActive&&!1===c.isAccountStatusActive?$("#error-email").append('\x3cul class\x3d"list-unstyled"\x3e\x3cli\x3e'+d+"\x3c/li\x3e\x3c/ul\x3e"):$("#error-email").append('\x3cul class\x3d"list-unstyled"\x3e\x3cli\x3e'+e+"\x3c/li\x3e\x3c/ul\x3e");$("#input-email").parent().addClass("has-error");$("#input-email").attr("aria-invalid",!0);$("#input-email").parent().css("border","2px solid #dd1e25 !important");$("#emailIdvalidate").val("");$("#emailIdvalidate").focusout();
$("#input-email").is(":visible")&&AB.DATALAYER.setError("5759","createAccountError","You already have an account, please sign in or reset your password if needed.")}},error:function(b,c,d){c="";d="Please enter a valid email address.";$("#emailProgressIcon").addClass("mask");if(0===b.status)d="Sorry, we're having technical difficulties, please check back later.";else if(b.responseJSON){for(datos in b.responseJSON)"subErrors"==datos&&(c+=b.responseJSON[datos][0].message+"\x3cbr\x3e");c||(d="Sorry, we're having technical difficulties and working on fixing them, please check back later.")}else d=
"Sorry, we're having technical difficulties and working on fixing them, please check back later.";$("#error-email").append('\x3cul class\x3d"list-unstyled"\x3e\x3cli\x3e'+d+"\x3c/li\x3e\x3c/ul\x3e");$("#error-email").parent().addClass("has-error");$("#error-email").attr("aria-invalid",!0);$(this).is(":visible")&&AB.DATALAYER.setError("5759","createAccountError",d)}})):($("#error-email").append('\x3cul class\x3d"list-unstyled"\x3e\x3cli\x3e Please enter a valid email address.\x3c/li\x3e\x3c/ul\x3e'),
$("#error-email").parent().addClass("has-error"),$("#error-email").attr("aria-invalid",!0),$(this).is(":visible")&&AB.DATALAYER.setError("5759","createAccountError","Please enter a valid email address."))}})});function showValidationError(b,c){$("#"+b).parent().addClass("has-error");$("#"+b).attr("aria-invalid",!0);$("#"+b).next(".with-errors").html(c);$("#"+b).parent().css("border","2px solid #dd1e25 !important");$("#"+b).closest("form").trigger("change.bs.validator")}
$(function(){$("#phoneNumber").blur(function(){var b="";AB.UCASERVICES.userProfile.phone&&0<AB.UCASERVICES.userProfile.phone.length&&-1!==AB.UCASERVICES.getPrimaryPhoneNumberIndex(AB.UCASERVICES.userProfile.phone)&&(b=AB.UCASERVICES.userProfile.phone[AB.UCASERVICES.getPrimaryPhoneNumberIndex(AB.UCASERVICES.userProfile.phone)].number);var c=$.trim($("#phoneNumber").val()).replace(/[\ \-\(\)]/g,"");$("#phoneNumber").val(c);"object"==typeof AB.GETPROFILE.regPhoneRequest?AB.GETPROFILE.regPhoneRequest.abort():
AB.GETPROFILE.regPhoneRequest="";$("#pOrCcValidate").val("");$("#p0rCcValidate").focusout();if(0==c.length&&0==$("#invalied-phone ul").length)$("#account-phone").addClass("has-error"),$("#phoneNumber").attr("aria-invalid",!0),$("#invalied-phone").append('\x3cul class\x3d"list-unstyled"\x3e\x3cli\x3ePlease enter your phone number.\x3c/li\x3e\x3c/ul\x3e'),$(".has-error .form-control").css("border","2px solid #dd1e25 !important"),$("#update-phone-Btn").removeClass("btn-default").addClass("btn-disabled").prop("disabled",
!0);else if(0<c.length&&10>c.length)$("#account-phone").addClass("has-error"),$("#phoneNumber").attr("aria-invalid",!0),$("#invalied-phone").append('\x3cul class\x3d"list-unstyled"\x3e\x3cli\x3ePlease enter a phone number that contains 10 digits.\x3c/li\x3e\x3c/ul\x3e'),$(".has-error .form-control").css("border","2px solid #dd1e25 !important"),$("#update-phone-Btn").removeClass("btn-default").addClass("btn-disabled").prop("disabled",!0);else if(c!=b){b=document.getElementById("invalied-phone");var d=
SWY.CONFIGSERVICE.datapowerConfig.cncServiceBasePath+"/api/uca/ccphone/"+c;b.innerHTML="";0==$("#invalied-phone ul").length&&10===c.length?"0"===c.charAt(0)||"1"===c.charAt(0)?($("#account-phone").addClass("has-error"),$("#phoneNumber").attr("aria-invalid",!0),$("#invalied-phone").append('\x3cul class\x3d"list-unstyled"\x3e\x3cli\x3ePlease enter a phone number that doesn\x26#x27;t start with a 0 or 1.\x3c/li\x3e\x3c/ul\x3e'),$(".has-error .form-control").css("border","2px solid #dd1e25 !important"),
$("#update-phone-Btn").removeClass("btn-default").addClass("btn-disabled").prop("disabled",!0)):($("#phoneProgressIcon").removeClass("mask"),AB.GETPROFILE.regPhoneRequest=$.ajax({type:"GET",headers:AB.ucaHttpOptions,url:d,success:function(b,d,g){$("#phoneProgressIcon").addClass("mask");b.notInUse?$("#pOrCcValidate").val(c):($("#account-phone").addClass("has-error"),$("#phoneNumber").attr("aria-invalid",!0),$("#invalied-phone").append('\x3cul class\x3d"list-unstyled"\x3e\x3cli\x3eThe phone number entered is already linked to an existing account, please enter a different phone number.\x3c/li\x3e\x3c/ul\x3e'),
$("#update-phone-Btn").removeClass("btn-default").addClass("btn-disabled").prop("disabled",!0),$(".has-error .form-control").css("border","2px solid #dd1e25 !important"),$("#pOrCcValidate").val(""));$("#pOrCcValidate").focusout()},error:function(b,c,d){AB.VALIDATION.defaultError(b);b=0===b.status?"Sorry, we're having technical difficulties, please check back later.":406===b.status?"Please enter a valid phone number":"Sorry, we're having technical difficulties and working on fixing them, please check back later.";
$("#phoneProgressIcon").addClass("mask");$("#account-phone").addClass("has-error");$("#phoneNumber").attr("aria-invalid",!0);$("#invalied-phone").append('\x3cul class\x3d"list-unstyled"\x3e\x3cli\x3e'+b+"\x3c/li\x3e\x3c/ul\x3e");$("#update-phone-Btn").removeClass("btn-default").addClass("btn-disabled").prop("disabled",!0);$(".has-error .form-control").css("border","2px solid #dd1e25 !important")}})):($("#account-phone").addClass("has-error"),$("#phoneNumber").attr("aria-invalid",!0),$("#invalied-phone").append('\x3cul class\x3d"list-unstyled"\x3e\x3cli\x3ePlease enter your phone number.\x3c/li\x3e\x3c/ul\x3e'),
$(".has-error .form-control").css("border","2px solid #dd1e25 !important"),$("#update-phone-Btn").removeClass("btn-default").addClass("btn-disabled").prop("disabled",!0))}})});
$(function(){$("#emailIdaccount").blur(function(){"object"==typeof AB.GETPROFILE.regEmailRequest?AB.GETPROFILE.regEmailRequest.abort():AB.GETPROFILE.regEmailRequest="";$("#emailIdvalidate").val("");$("#emailIdvalidate").focusout();var b=AB.UCASERVICES.userProfile.emailId;$("#error-email").empty();if($.trim($("#emailIdaccount").val())==b){var c=$(this).val();$("#emailIdvalidate").val(c);$("#emailIdvalidate").focusout()}else if(0<$.trim($("#emailIdaccount").val()).length&&0==$("#error-email ul").length){c=
$(this).val().trim();b=document.getElementById("error-email");var d=SWY.CONFIGSERVICE.datapowerConfig.cncServiceBasePath+"/api/uca/email",e={emailAddress:""};b.innerHTML="";/^[a-zA-Z0-9.!#$%&\u2019*+/=?^_`{|}~-]+@[a-zA-Z0-9-]+\.([a-zA-Z0-9-.]+)$/.test(c)?(e.emailAddress=c,$("#emailProgressIcon").removeClass("mask"),AB.GETPROFILE.regEmailRequest=$.ajax({type:"POST",headers:AB.ucaHttpOptions,url:d,dataType:"json",data:JSON.stringify(e),success:function(b,d,e){AB.GETPROFILE.regEmailRequest="";$("#emailProgressIcon").addClass("mask");
b.notInUse?($("#emailIdvalidate").val(c),$("#emailIdvalidate").focusout(),$("#update-personal-info-Btn").removeClass("btn-disabled").addClass("btn-default").prop("disabled",!1)):($("#emailIddivaccount").addClass("has-error"),$("#emailIdaccount").attr("aria-invalid",!0),$("#error-email").append('\x3cul class\x3d"list-unstyled"\x3e\x3cli\x3eThe email address entered is already linked to an existing account, please enter a different email address.\x3c/li\x3e\x3c/ul\x3e'),$(".has-error .form-control").css("border",
"2px solid #dd1e25 !important"),$("#update-personal-info-Btn").removeClass("btn-default").addClass("btn-disabled").prop("disabled",!0),$("#emailIdvalidate").val(""),$("#emailIdvalidate").focusout())},error:function(b,c,d){$("#emailProgressIcon").addClass("mask");AB.VALIDATION.defaultError(b);b=0===b.status?"Sorry, we're having technical difficulties, please check back later.":400===b.status?"Please enter a valid email address.":"Sorry, we're having technical difficulties and working on fixing them, please check back later.";
$("#emailProgressIcon").addClass("mask");$("#emailIddivaccount").addClass("has-error");$("#emailIdaccount").attr("aria-invalid",!0);$("#error-email").append('\x3cul class\x3d"list-unstyled"\x3e\x3cli\x3e'+b+"\x3c/li\x3e\x3c/ul\x3e");$(".has-error .form-control").css("border","2px solid #dd1e25 !important");$("#update-personal-info-Btn").removeClass("btn-default").addClass("btn-disabled").prop("disabled",!0)}})):($("#emailIddivaccount").addClass("has-error"),$("#emailIdaccount").attr("aria-invalid",
!0),$("#error-email").append('\x3cul class\x3d"list-unstyled"\x3e\x3cli\x3e Please enter a valid email address. \x3c/li\x3e\x3c/ul\x3e'),$(".has-error .form-control").css("border","2px solid #dd1e25 !important"),$("#update-personal-info-Btn").removeClass("btn-default").addClass("btn-disabled").prop("disabled",!0),$("#emailIdvalidate").val(""),$("#emailIdvalidate").focusout())}else $("#error-email").html("Please enter your email address.")})});
$("#masterUnCheckId").change(function(){$("#J4U").prop("checked",!1);$("#EmailSave").prop("checked",!1);$("#GroceryDel").prop("checked",!1);$("#ProdRecall").prop("checked",!1);"U"==$("#J4Ui").val()&&"U"==$("#EmailSavei").val()&&"U"==$("#GroceryDeli").val()&&"U"==$("#ProdRecalli").val()?$("#updateBtn").removeClass("primarybutton").addClass("btn-disabled").prop("disabled",!0):$("#updateBtn").removeClass("btn-disabled").addClass("primarybutton").removeAttr("disabled")});
$("#J4U").change(function(){1==$(this).prop("checked")&&$("#masterUnCheckId").prop("checked",!1)});$("#EmailSave").change(function(){1==$(this).prop("checked")&&$("#masterUnCheckId").prop("checked",!1)});$("#GroceryDel").change(function(){1==$(this).prop("checked")&&$("#masterUnCheckId").prop("checked",!1)});$("#ProdRecall").change(function(){1==$(this).prop("checked")&&$("#masterUnCheckId").prop("checked",!1)});
$("#terms-nc").change(function(b){$("#terms-nc").is(":checked")?($("#create-account-btn-unified").removeClass("disabled"),$("#create-account-btn-unified").removeAttr("disabled")):($("#create-account-btn-unified").addClass("disabled"),$("#create-account-btn-unified").attr("disabled","disabled"));b.stopPropagation()});
(function(){this.init=function(){0<$(".main-wrap-rewards").length&&AB.ucaRewardsTrigger&&_loadRewardsInfo(!1)};_loadRewardsInfo=function(b){if(!0===b){b=AB.emrbRewardsHeader;var c=AB.emrbGetRewardSummary}else b=!0===SWY.CONFIGSERVICE.checkPropertyInFeatureFlagConfig("rewardsApiV2")?AB.ucaHttpOptionsV2UpdatedHeader:AB.ucaHttpOptions,c=AB.COMMON.ucaAPIPathWithCustomerId(AB.rewardsInfoPath);$.ajax({type:"GET",headers:b,url:c,dataType:"json",success:function(b,c,f){b=JSON.stringify(f.responseJSON);b=
JSON.parse(b);AB.UCAREWARDS.renderRewardPoints(b)},error:function(b,c,f){AB.UCAREWARDS.renderRewardsError(f)}});$("p").children("br")&&$("p").children("br").attr("role","presentation")};this.renderRewardsError=function(b){$("#as-of-text").html("as of "+(new Date).toLocaleString("en-US",{month:"2-digit",day:"2-digit",year:"2-digit",hour12:"true",hour:"2-digit",minute:"2-digit"}).replace(","," at "));console.log(b)};this.renderRewardPoints=function(b){if(0<$(".main-wrap-rewards").length){b.savings&&
b.savings.currentYearSavings&&b.savings.lifetimeSavings&&($("#ytd-savings").html("$"+b.savings.currentYearSavings.toFixed(2)),$("#life-savings").html("$"+b.savings.lifetimeSavings.toFixed(2)));if(b.rewards){var c=b.rewards,d=0<=c.rewardPoints?c.rewardPoints:"0";if(AB.UCAREWARDS.useOrDeleteSummary()){c=JSON.parse(localStorage.abRewardsSummary);var e=c.rewardsAvailable;c=c.rewardsExpire}else e=0<=c.rewardsAvailable?c.rewardsAvailable:"0",c=0<=c.rewardsExpire?c.rewardsExpire:"0";$("#rewards-avail").html(d);
$("#rewards-balance").html(e);$("#expiring-rewards").html(c)}if(b.links&&0<b.links.length)for(var f in b.links)"self"===b.links[f].rel&&$("#usemyrewardsID").attr("href",b.links[f].href);$("#as-of-text").html("as of "+(new Date).toLocaleString("en-US",{month:"2-digit",day:"2-digit",year:"2-digit",hour12:"true",hour:"2-digit",minute:"2-digit"}).replace(","," at "));$("#updateRewards").removeAttr("disabled")}};this.hasGroceryRewards=function(){var b=$("#useMyRewardsId"),c="",d=AB.userInfo.j4u.storeData.storeRewards;
"object"==typeof d&&null!=d&&(c=d.hasGroceryRewards);"true"!=c?(console.log("grocery value is false"),b.addClass("mask")):(console.log("grocery value is true"),b.addClass("unmask"))};this.useOrDeleteSummary=function(){var b=!1;if(AB.COMMON.isLSCompatible()){var c=localStorage.abRewardsSummary;AB.UCAREWARDS.checkSummaryTime(c)?b=!0:c&&(localStorage.removeItem("abRewardsSummary"),b=!1)}return b};this.checkSummaryTime=function(b){return b&&Date.now()-JSON.parse(b).savedTime<=window.AB.rewardSummaryTime}}).call(AB.UCAREWARDS);
(function(){this.init=function(){AB.UCASERVICES.userProfile={};0<$(".personal-information-text").length&&AB.UCASERVICES.getUserProfileInfo();0<$(".main-wrap-alaska-airlines").length&&AB.UCASERVICES.getLoyaltyPartners()};var b=this;this.loyaltyPartnersCB=function(b){for(loyaltyPartner in b.loyaltyPartners)if("AlaskaAirlineMileagePlan"==b.loyaltyPartners[loyaltyPartner].name){var c=(new Date(b.loyaltyPartners[loyaltyPartner].enrollmentDate)).toLocaleString("en-US",{month:"long",day:"numeric",year:"numeric"});
$("#enrolled-date").html(c);var e=b.loyaltyPartners[loyaltyPartner].planNumber,f="********"+e.substr(e.length-4),g=$("#alaska-airline-number");$("#oldAANumber").val(e);g.val(f);g.focus(function(){g.val(e)});g.blur(function(){$("#oldAANumber").val()==$("#alaska-airline-number").val()&&g.val(f)});c=$("#enrollBtn").attr("data-enrolled-update");$("#enrollBtn").html(c);$("#enrolled").removeClass("d-none");$("#enroll").hide();$("#enrolled").show()}};this.getLoyaltyPartners=function(){$.ajax({type:"GET",
headers:AB.ucaHttpOptions,url:AB.COMMON.ucaAPIPathWithCustomerId(AB.loyaltyPartnersPath),dataType:"json",success:function(c){b.loyaltyPartnersCB(c)},error:function(b,d,e){console.log(e)}})};this.getLoyaltyPartnersBoxTops=function(b){$.ajax({type:"GET",headers:AB.ucaHttpOptions,url:AB.COMMON.ucaAPIPathWithCustomerId(AB.loyaltyPartnersPath),dataType:"json",success:function(c){b(c)},error:function(c,e,f){b(f)}})};this.updateLoyalty=function(){AB.UCASERVICES.validateSession(function(){$("#enrollBtn").removeClass("btn-default").addClass("btn-disabled").prop("disabled",
!0);var c={loyaltyPartners:[{name:"AlaskaAirlineMileagePlan",planNumber:""}]};c.loyaltyPartners[0].planNumber=$("#alaska-airline-number").val();var d="POST",e=AB.ucaHttpOptions;$("#oldAANumber").val()&&(d="PATCH",e=AB.ucaHttpOptionsPatch);$.ajax({type:d,headers:e,url:AB.COMMON.ucaAPIPathWithCustomerId(AB.loyaltyPartnersPath),dataType:"json",data:JSON.stringify(c),success:function(c){$("#errorMsg").empty();AB.VALIDATION.updateMsg("update-msg",this.id);b.loyaltyPartnersCB(c);AB.DATALAYER.pushEvent("edit_accept_partner")},
error:function(b,c,d){AB.VALIDATION.defaultError(b);b&&0===b.status?$("#errorMsg").html("\x3cstrong\x3e\x3cli\x3e Sorry, we're having technical difficulties, please check back later.\x3c/li\x3e\x3c/strong\x3e"):b.responseJSON.subErrors?($("#errorMsg").html("\x3cstrong\x3e\x3cli\x3e"+b.responseJSON.subErrors["0"].message+"\x3c/li\x3e\x3c/strong\x3e"),console.log(b.responseJSON.subErrors["0"].message)):($("#errorMsg").html("\x3cstrong\x3e\x3cli\x3e Sorry, we're having technical difficulties and working on fixing them, please check back later.\x3c/li\x3e\x3c/strong\x3e"),
console.log(d));AB.DATALAYER.pushEvent("edit_decline_partner")}})})};this.updateProfile=function(){if(!AB.VALIDATION.enableUpdPersonalInfoBtn("update-personal-info-Btn","error-fname","error-lname","error-email")){$("#loaderSignIn").removeClass("mask").addClass("unmask");$("#signInLoadingEmpty").removeClass("unmask").addClass("mask");$("#update-personal-info-Btn").prop("disabled",!0).addClass("button-disable-color");var b=AB.UCASERVICES.userProfile.firstName,d=AB.UCASERVICES.userProfile.lastName,e=
AB.UCASERVICES.userProfile.emailId,f=$("#input-firstName").val(),g=$("#input-lastName").val(),h=$("#emailIdaccount").val(),l=!1,k={};if(b!==f){var q=!0;k.oldFirstName=b;k.firstName=f}else k.firstName=b,k.oldFirstName=b;d!==g?(l=!0,k.oldLastName=d,k.lastName=g):(k.lastName=d,k.oldLastName=d);e!==h?(k.oldEmailId=e,k.emailId=h):(k.emailId=e,k.oldEmailId=e);$.ajax({type:"PATCH",headers:AB.ucaHttpOptionsPatch,url:AB.COMMON.ucaAPIPathWithCustomerId(AB.userProfilePath),dataType:"json",data:JSON.stringify(k),
success:function(b){if(!b.errors&&($("#updateErrorMsg").empty(),k.oldEmailId!=k.emailId)){$("#email-confirmation-path").val();AB.DATALAYER.pushEvent("edit_email");if(k.oldFirstName!=k.firstName||k.oldLastName!=k.lastName)document.getElementsByClassName("sidebar__user-welcome__message")[0].innerText="Hi "+k.firstName,AB.DATALAYER.pushEvent("name_update");SWY.ENFORCEMENTUTILS.updateReInitSite("www");window.location.reload();AB.COMMON.userNotifyReloadPage("You have successfully updated your email.");
return}q&&!l&&AB.COMMON.userNotify("You have successfully updated your first name.");l&&!q&&AB.COMMON.userNotify("You have successfully updated your last name.");q&&l&&AB.COMMON.userNotify("You have successfully updated your first name and last name.");$("#input-firstName").val(b.firstName);$("#input-lastName").val(b.lastName);$("#emailIdaccount").val(b.emailId);$("#phoneNumber").val(b.phone&&0<b.phone.length&&-1!==AB.UCASERVICES.getPrimaryPhoneNumberIndex(b.phone)?b.phone[AB.UCASERVICES.getPrimaryPhoneNumberIndex(b.phone)].number:
"");$("#cc-number").html(b.clubCardNumber);k.oldFirstName==k.firstName&&k.oldLastName==k.lastName||AB.DATALAYER.pushEvent("name_update");(b=JSON.parse(AB.COMMON.getCookie("SWY_SHARED_PII_SESSION_INFO")))&&b.name&&(b.name=k.firstName,AB.COMMON.setCookie("SWY_SHARED_PII_SESSION_INFO",JSON.stringify(b),0));AB.COMMON.getUserInfo();$("#loaderSignIn").removeClass("unmask").addClass("mask");$("#signInLoadingEmpty").removeClass("mask").addClass("unmask");$("#update-personal-info-Btn").prop("disabled",!0).removeClass("button-disable-color").attr("aria-disabled",
"false");$("#update-personal-info-Btn").addClass("disabled")},error:function(b,c,d){if(0===b.status)b="Sorry, we're having technical difficulties, please check back later.";else if(500===b.status||502===b.status)b="Sorry, we're having technical difficulties and working on fixing them, please check back later.";else{AB.VALIDATION.defaultError(b);return}$("#updateErrorMsg").html("\x3cstrong\x3e\x3cli\x3e"+b+"\x3c/li\x3e\x3c/strong\x3e");$("#loaderSignIn").removeClass("unmask").addClass("mask");$("#signInLoadingEmpty").removeClass("mask").addClass("unmask");
$("#update-personal-info-Btn").prop("disabled",!1).removeClass("button-disable-color").attr("aria-disabled","false");$("#update-personal-info-Btn").addClass("disabled")}})}};this.updatePhone=function(){$("#loaderSignInUpdatePhone").removeClass("mask").addClass("unmask");$("#signInLoadingEmptyUpdatePhone").removeClass("unmask").addClass("mask");$("#update-phone-Btn").prop("disabled",!0).addClass("button-disable-color");var b={};AB.UCASERVICES.userProfile.phone&&0<AB.UCASERVICES.userProfile.phone.length&&
-1!==AB.UCASERVICES.getPrimaryPhoneNumberIndex(AB.UCASERVICES.userProfile.phone)?b.oldPhone=AB.UCASERVICES.userProfile.phone[AB.UCASERVICES.getPrimaryPhoneNumberIndex(AB.UCASERVICES.userProfile.phone)]:b.oldPhone={};b.phone={};b.phone.purpose="Primary";b.phone.number=$("#phoneNumber").val();$.ajax({type:"PATCH",headers:AB.ucaHttpOptionsPatch,url:AB.COMMON.ucaAPIPathWithCustomerId(AB.userProfilePath),dataType:"json",data:JSON.stringify(b),success:function(b){$("#phoneUpdateErrorMsg").empty();b.errors||
AB.COMMON.userNotify("You have successfully updated your phone number.");var c=-1;AB.UCASERVICES.userProfile&&b.phone&&0<b.phone.length&&(c=AB.UCASERVICES.getPrimaryPhoneNumberIndex(b.phone),AB.UCASERVICES.userProfile.phone&&0<AB.UCASERVICES.userProfile.phone.length&&(AB.UCASERVICES.userProfile.phone[0].number=-1!==c?b.phone[c].number:""));$("#input-firstName").val(b.firstName);$("#input-lastName").val(b.lastName);$("#emailIdaccount").val(b.emailId);$("#phoneNumber").val(b.phone&&0<b.phone.length&&
-1!==c?b.phone[c].number:"");$("#cc-number").html(b.clubCardNumber);AB.DATALAYER.pushEvent("edit_phone_number");$("#loaderSignInUpdatePhone").removeClass("unmask").addClass("mask");$("#signInLoadingEmptyUpdatePhone").removeClass("mask").addClass("unmask");$("#update-phone-Btn").prop("disabled",!0).removeClass("button-disable-color").attr("aria-disabled","false");$("#update-phone-Btn").addClass("disabled")},error:function(b,c,f){AB.VALIDATION.defaultError(b);c="Sorry, we're having technical difficulties and working on fixing them, please check back later.";
0===b.status?(c="Sorry, we're having technical difficulties, please check back later.",$("#phoneUpdateErrorMsg").html("\x3cstrong\x3e\x3cli\x3e"+c+"\x3c/li\x3e\x3c/strong\x3e")):b.responseJSON.subErrors?($("#phoneUpdateErrorMsg").html("\x3cstrong\x3e\x3cli\x3e"+b.responseJSON.subErrors["0"].message+"\x3c/li\x3e\x3c/strong\x3e"),console.log(b.responseJSON.subErrors["0"].message)):($("#phoneUpdateErrorMsg").html("\x3cstrong\x3e\x3cli\x3e"+c+"\x3c/li\x3e\x3c/strong\x3e"),console.log(f));$("#loaderSignInUpdatePhone").removeClass("unmask").addClass("mask");
$("#signInLoadingEmptyUpdatePhone").removeClass("mask").addClass("unmask");$("#update-phone-Btn").prop("disabled",!1).removeClass("button-disable-color").attr("aria-disabled","false");$("#update-phone-Btn").addClass("disabled")}})};this.updatePassword=function(){if(!AB.VALIDATION.checkUpdatePasswordError()){$("#loaderSignInUpdatePassword").removeClass("mask").addClass("unmask");$("#signInLoadingEmptyUpdatePassword").removeClass("unmask").addClass("mask");$("#update-password-Btn").prop("disabled",
!0).addClass("button-disable-color");var b={};b.oldEmailId=AB.UCASERVICES.userProfile.emailId;b.emailId=$("#emailIdaccount").val();b.newPassword=$("#n-password").val();b.oldPassword=$("#c-password").val();$.ajax({type:"PATCH",headers:AB.ucaHttpOptionsPatch,url:AB.COMMON.ucaAPIPathWithCustomerId(AB.userProfilePath),dataType:"json",data:JSON.stringify(b),success:function(b){$("#passwordUpdateErrorMsg").empty();SWY.ENFORCEMENTUTILS.updateReInitSite("www");window.location.reload();AB.COMMON.userNotifyReloadPage("You have successfully updated your password.");
$("#input-firstName").val(b.firstName);$("#input-lastName").val(b.lastName);$("#emailIdaccount").val(b.emailId);$("#phoneNumber").val(b.phone&&0<b.phone.length&&-1!==AB.UCASERVICES.getPrimaryPhoneNumberIndex(b.phone)?b.phone[AB.UCASERVICES.getPrimaryPhoneNumberIndex(b.phone)].number:"");$("#cc-number").html(b.clubCardNumber);AB.DATALAYER.pushEvent("update_password");$("#loaderSignInUpdatePassword").removeClass("unmask").addClass("mask");$("#signInLoadingEmptyUpdatePassword").removeClass("mask").addClass("unmask");
$("#update-password-Btn").prop("disabled",!0).removeClass("button-disable-color").attr("aria-disabled","false");$("#update-password-Btn").addClass("disabled")},error:function(b,c,f){AB.VALIDATION.defaultError(b);c="Sorry, we're having technical difficulties and working on fixing them, please check back later.";0===b.status?(c="Sorry, we're having technical difficulties, please check back later.",$("#passwordUpdateErrorMsg").html("\x3cstrong\x3e\x3cli\x3e"+c+"\x3c/li\x3e\x3c/strong\x3e")):void 0==
b.responseJSON?$("#passwordUpdateErrorMsg").html("\x3cstrong\x3e\x3cli\x3e"+c+"\x3c/li\x3e\x3c/strong\x3e"):b&&b.responseJSON&&"IACUA0005"===b.responseJSON.errorCode&&0<b.responseJSON.subErrors.length&&"oldPassword"===b.responseJSON.subErrors["0"].field?$("#passwordUpdateErrorMsg").html("\x3cstrong\x3e\x3cli\x3e Your current password doesn't match our records, please try again. \x3c/li\x3e\x3c/strong\x3e"):b&&b.responseJSON&&"IACUA0005"===b.responseJSON.errorCode&&0<b.responseJSON.subErrors.length&&
"newPassword"===b.responseJSON.subErrors["0"].field?$("#passwordUpdateErrorMsg").html("\x3cstrong\x3e\x3cli\x3e Your new password cannot be the same as your old password, please enter a different password.\x3c/li\x3e\x3c/strong\x3e"):b.responseJSON.subErrors?($("#passwordUpdateErrorMsg").html("\x3cstrong\x3e\x3cli\x3e"+b.responseJSON.subErrors["0"].message+"\x3c/li\x3e\x3c/strong\x3e"),console.log(b.responseJSON.subErrors["0"].message)):($("#passwordUpdateErrorMsg").html("\x3cstrong\x3e\x3cli\x3e"+
c+"\x3c/li\x3e\x3c/strong\x3e"),console.log(f));$("#loaderSignInUpdatePassword").removeClass("unmask").addClass("mask");$("#signInLoadingEmptyUpdatePassword").removeClass("mask").addClass("unmask");$("#update-password-Btn").prop("disabled",!1).removeClass("button-disable-color").attr("aria-disabled","false");$("#update-password-Btn").addClass("disabled")}})}};this.getUserProfileInfo=function(){$.ajax({type:"GET",headers:AB.ucaHttpOptions,url:AB.COMMON.ucaAPIPathWithCustomerId(AB.userProfilePath),
dataType:"json",success:function(b){$("#input-firstName").val(b.firstName);$("#input-lastName").val(b.lastName);$("#emailIdaccount").val(b.emailId);$("#emailIdvalidate").val(b.emailId);$("#phoneNumber").val(b.phone&&0<b.phone.length&&-1!==AB.UCASERVICES.getPrimaryPhoneNumberIndex(b.phone)?b.phone[AB.UCASERVICES.getPrimaryPhoneNumberIndex(b.phone)].number:"");$("#cc-number").html(b.clubCardNumber);AB.UCASERVICES.userProfile=b},error:function(b,d,e){console.log(e)}})};this.validateSession=function(b){AB.COMMON.authorize()&&
(SWY.ENFORCEMENT.isTokenActive()?b():SWY.ENFORCEMENT.checkAuthorizedCookie()?$.get(AB.userInfoPath).subscribe(function(c){AB.userInfoPath.updateTokenRefreshProperty();b()},function(b){$("#sessionTimeoutModal").modal({show:!0})}):$("#sessionTimeoutModal").modal({show:!0}))};this.getPrimaryPhoneNumberIndex=function(b){var c=-1;return c=b.map(function(b){return b.purpose}).indexOf("Primary")}}).call(AB.UCASERVICES);
(function(){this.init=function(){0<$(".main-wrap-fulfillment").length&&SWY.CONFIGSERVICE.isWCMModeDisabled()&&(_getFulfillmentPreferences(),AB.userInfo.j4u.userData&&AB.userInfo.j4u.userData.hasAlternateId&&$("#deliveryPhoneDiv").show())};_getFulfillmentPreferences=function(){$.ajax({type:"GET",headers:AB.ucaSubHttpOptions,url:AB.COMMON.ucaAPIPathWithCustomerId(AB.fulfillmentPreferences),dataType:"json",success:function(b,c,d){b=JSON.stringify(d.responseJSON);b=JSON.parse(b);"undefined"!==typeof $("#deliveryaddress")&&
_fillDeliveryAddress(b);"undefined"!==typeof $("#dugStore")&&_fillStoreLocations(b);AB.userInfo.j4u.userData&&AB.userInfo.j4u.userData.hasAlternateId&&"undefined"!==typeof $("#deliveryPhoneNumber")&&_fillPhonenumber(b)},error:function(b,c,d){console.log(d);window.AB.COMMON.redirectErrorPage()}})};_fillDeliveryAddress=function(b){"undefined"!==typeof b.addresses?"undefined"!==typeof b.addresses[0].address2?$("#deliveryaddress").html(b.addresses[0].address1+" "+b.addresses[0].address2+"\x3cbr\x3e"+
b.addresses[0].city+" "+b.addresses[0].state+" "+b.addresses[0].zipCode):$("#deliveryaddress").html(b.addresses[0].address1+"\x3cbr\x3e"+b.addresses[0].city+" "+b.addresses[0].state+" "+b.addresses[0].zipCode):(b=$("#deliveryaddress").attr("data-errorMsg"),$("#deliveryaddress").html(b))};_fillStoreLocations=function(b){var c=!1;if("undefined"!==typeof b.stores){for(store in b.stores)"DriveUp"==b.stores[store].storePreference&&(c=!0,"undefined"!==typeof b.stores[store].address.address2?$("#dugStore").html(b.stores[store].address.address1+
" "+b.stores[store].address.address2+"\x3cbr\x3e"+b.stores[store].address.city+" "+b.stores[store].address.state+" "+b.stores[store].address.zipCode):$("#dugStore").html(b.stores[store].address.address1+"\x3cbr\x3e"+b.stores[store].address.city+" "+b.stores[store].address.state+" "+b.stores[store].address.zipCode));c||(b=$("#dugStore").attr("data-errorMsg"),$("#dugStore").html(b))}else b=$("#dugStore").attr("data-errorMsg"),$("#dugStore").html(b)};_fillPhonenumber=function(b){var c=!1;if(b.profile&&
"undefined"!==typeof b.profile.emails[0].text){if($("#emailId").val(b.profile.emails[0].text),"undefined"!==typeof $("#deliveryPhoneNumber"))for(addressType in b.addresses){for(phoneType in b.addresses[addressType].phone)if("Delivery"==b.addresses[addressType].phone[phoneType].purpose){$("#deliveryPhoneNumber").val(b.addresses[addressType].phone[phoneType].number);$("#oldPhone").val(b.addresses[addressType].phone[phoneType].number);AB.UCAFULFILLMENTPREFERENCE.deliveryPhoneNumber=b.addresses[addressType].phone[phoneType].number;
c=!0;break}if(c)break}}else b=$("#dugStore").attr("data-errorMsg"),$("#dugStore").html(b)};this.updateAddress=function(b,c){localStorage.setItem("edit_delivery_address",!0);if("undefined"!==typeof AB.userInfo.j4u.userData.hasAlternateId||""!==typeof AB.userInfo.j4u.userData.hasAlternateId)AB.userInfo.j4u.userData.hasAlternateId?(AB.COMMON.setCookie("ECommRedirectURL",location.pathname,0),window.location.href=b+".html"):(AB.COMMON.setCookie("ECommRedirectURL",window.location.origin+location.pathname,
0),window.location.href=window.location.origin+"/shop")};this.validatephonenumber=function(){AB.UCASERVICES.validateSession(function(){var b={},c={},d={},e=$("#updatephonenumber").serializeArray();$.each(e,function(){b[this.name]?(b[this.name].push||(b[this.name]=[b[this.name]]),b[this.name].push(this.value||"")):(":cq_csrf_token"!=this.name&&(b[this.name]=this.value||""),"oldPhone"==this.name&&(c.purpose="Delivery",c.number=this.value,b[this.name]=c||AB.UCAFULFILLMENTPREFERENCE.deliveryPhoneNumber),
"phone"==this.name&&(d.purpose="Delivery",d.number=this.value.replace(/[^\d\+]/g,""),b[this.name]=d||""),"emailId"==this.name&&(b[this.name]=this.value||""))});e=JSON.stringify(b);var f=AB.ucaHttpOptionsPatch;$("#loaderSignIn").removeClass("mask").addClass("unmask");$("#signInLoadingEmpty").removeClass("unmask").addClass("mask");$.ajax({type:"PATCH",headers:f,url:AB.COMMON.ucaAPIPathWithCustomerId(AB.profileAddressPath),data:e,dataType:"json",success:function(b){for(datos in b.responseJSON);AB.VALIDATION.updateMsg("update-msg",
this.id);$("#loaderSignIn").removeClass("unmask").addClass("mask");$("#signInLoadingEmpty").removeClass("mask").addClass("unmask")},error:function(b,c,d){b.responseJSON.subErrors?($("#errorMsg").html(b.responseJSON.subErrors["0"].message),console.log(b.responseJSON.subErrors["0"].message)):($("#errorMsg").html(d),console.log(d));$("#loaderSignIn").removeClass("unmask").addClass("mask");$("#signInLoadingEmpty").removeClass("mask").addClass("unmask")}})})}}).call(AB.UCAFULFILLMENTPREFERENCE);
function zipCodeValidation(){var b=$("#zip").val();""==b.trim()?($("#zipcode").addClass("has-error"),$("#error-zip").append('\x3cul class\x3d"list-unstyled"\x3e\x3cli\x3eZIP Code is required.\x3c/li\x3e\x3c/ul\x3e'),$(".has-error .form-control").css("border","2px solid #dd1e25 !important")):5!=b.length?($("#zipcode").addClass("has-error"),$("#error-zip").append('\x3cul class\x3d"list-unstyled"\x3e\x3cli\x3eInvalid ZIP Code.\x3c/li\x3e\x3c/ul\x3e'),$(".has-error .form-control").css("border","2px solid #dd1e25 !important")):
isNaN(b)?($("#zipcode").addClass("has-error"),$("#error-zip").append('\x3cul class\x3d"list-unstyled"\x3e\x3cli\x3eZIP Code must contain numeric characters only.\x3c/li\x3e\x3c/ul\x3e'),$(".has-error .form-control").css("border","2px solid #dd1e25 !important")):($("#zipcode").removeClass("has-error"),$("#error-zip").empty())}
function toggleContinueBtn(){var b=$("#zip");-1<b.parent().attr("class").indexOf("has-error")||5!=b.val().length||isNaN(b.val())?($("#continueBtn").prop("disabled",!0),$("#continueBtn").addClass("btn-disabled")):($("#continueBtn").prop("disabled",!1),$("#continueBtn").removeClass("btn-disabled"))}
(function(){this.init=function(){_getLocationInfofulfillmentpref()};_getLocationInfofulfillmentpref=function(){var b=SWY.CONFIGSERVICE.storeResolutionConfig.yextConfig.geoSearchAPIPath+"?api_key\x3d"+SWY.CONFIGSERVICE.storeResolutionConfig.yextConfig.apiKey+"\x26v\x3d20180530\x26location\x3d"+AB.COMMON.getURLParameterByName("zipcode")+"\x26amp;limit\x3d1";0<$(".main-wrap-delivery-address-update").length&&$.get(b).done(function(b){$("#city").val(b.response.geo.locality);$("#state").val(b.response.geo.region);
$("#zipCode").val(AB.COMMON.getURLParameterByName("zipcode"));$("#regcity").html(b.response.geo.locality);$("#regstate").html(b.response.geo.region);$("#regzip").html(b.response.geo.zip);$("#regzip").html(AB.COMMON.getURLParameterByName("zipcode"))}).fail(function(b){})};this.validatezipcode=function(){AB.UCASERVICES.validateSession(function(){var b=$("#zip").val();$.get(AB.storeInfoPath+"?zipcode\x3d"+b+"\x26banner\x3d"+AB.userInfo.banner).done(function(c){window.location.href=c?c.banner?$("#zip").attr("data-updateAddressLink")+
"?zipcode\x3d"+b:$("#zip").attr("data-noServiceAreaLink"):$("#zip").attr("data-noServiceAreaLink")})})};this.validateupdateaddress=function(){AB.UCASERVICES.validateSession(function(){var b={},c={},d=$("#updateadd").serializeArray();$.each(d,function(){b[this.name]?(b[this.name].push||(b[this.name]=[b[this.name]]),b[this.name].push(this.value||"")):(":cq_csrf_token"!=this.name&&(b[this.name]=this.value||""),"addressType"==this.name&&("residential"==this.value&&(c.name=1),"business"==this.value&&(c.name=
2),b[this.name]=c||""))});d=JSON.stringify(b);$.ajax({type:"POST",headers:AB.ucaHttpOptionsV2,url:AB.COMMON.ucaAPIPathWithCustomerId(AB.deliveryAddressPath),data:d,dataType:"json",success:function(c){for(datos in c.responseJSON);if(b.addressType&&b.addressType.name)switch(b.addressType.name){case 1:localStorage.setItem("addressType","residential");break;case 2:localStorage.setItem("addressType","business")}SWY.ENFORCEMENTUTILS.updateReInitSite("www");SWY.ENFORCEMENTUTILS.updateReInitSite("wwwlocal");
window.location.href=$("#updateadd").attr("data-fulfillmentPrefLink")+".html"},error:function(b,c,d){$("#errorMsg").html("\x3cli\x3eThe address you entered could not be validated against U.S Postal Service records. Please correct your entry below.\x3c/li\x3e")}})})}}).call(AB.UCAUPDATEDELIVERYADDRESS);
(function(){this.checkboxIdPrefix="cb-";this.init=function(){var b;0<$(".comm-pref-wrapper-v2-js").length&&(!AB.userInfo||"R"!==AB.userInfo.userType&&"C"!==AB.userInfo.userType?(b=AB.COMMUNICATIONPREF_V2._getEmailTokenParameter(!0))?(b=AB.anonymousUnsubscribe+"?token\x3d"+b,AB.COMMUNICATIONPREF_V2._getSubscriptionDetails(b)):SWY.CONFIGSERVICE.isWCMModeDisabled()&&(window.location.href="/"):(b=AB.COMMON.ucaAPIPathWithCustomerId(AB.subscriptionDetailsPath),AB.COMMUNICATIONPREF_V2._getSubscriptionDetails(b)))};
this._getSubscriptionDetails=function(b){$.ajax({type:"GET",headers:AB.ucaHttpOptions,url:b,dataType:"json",success:function(b,d,e){AB.COMMUNICATIONPREF_V2._renderSubscriptions(e.responseJSON)},error:function(b,d,e){d="";for(datos in b.responseJSON)d+=b.responseJSON[datos]+"\x3cbr\x3e";$("#update-msg").html(d)}})};this.commPrefSubmit=function(){var b=[],c={};$(".comm-pref-wrapper-v2-js .comm-pref-subs-list-js").find('input[type\x3d"checkbox"]').each(function(){var c={};c.subscriptionCode=$(this).data("subscriptioncode")||
"";c.oldSubscriptionStatusCode=$(this).data("lastselectedval")||"";c.subscriptionStatusCode=$(this).is(":checked")?"S":"U";b.push(c)});c.subscriptionDetails=b||"";var d=AB.COMMUNICATIONPREF_V2._getEmailTokenParameter(!1);if(d){var e=AB.anonymousUnsubscribe;c.token=d;c.sourceSystemCode="SUBSC";c.campaignCd=AB.COMMON.getURLParameterByName("campaignCd")?AB.COMMON.getURLParameterByName("campaignCd"):"";c.emailDate=AB.COMMON.getURLParameterByName("emailDate")?AB.COMMON.getURLParameterByName("emailDate"):
"";c.themeNm=AB.COMMON.getURLParameterByName("themeNm")?AB.COMMON.getURLParameterByName("themeNm"):""}else e=AB.COMMON.ucaAPIPathWithCustomerId(AB.subscriptionDetailsPath),c.emailId=$("#emailId").html(),c.sourceSystemCode="PORT";$.ajax({type:"PATCH",headers:AB.ucaHttpOptionsPatch,url:e,data:JSON.stringify(c),dataType:"json",success:function(b){AB.VALIDATION.updateMsg("update-msg",this.id);AB.COMMUNICATIONPREF_V2._renderSubscriptions(b);$("#updateBtn").removeClass("primarybutton").addClass("btn-disabled").prop("disabled",
!0);AB.DATALAYER.pushEvent("edit_subscribe_lists")},error:function(b,c,d){AB.VALIDATION.defaultError(b);b&&0===b.status?$("#update-msg").html("Sorry, we're having technical difficulties, please check back later."):$("#update-msg").html("Sorry, we're having technical difficulties and working on fixing them, please check back later.");$("#update-msg").css({display:"block",color:"red"})}})};this._renderSubscriptions=function(b){$("#emailId").html(b.emailId);var c=$(".comm-pref-wrapper-v2-js .comm-pref-subs-list-js"),
d="["+(c.data("subscription-list")||"")+"]";c.empty();var e=$("#subscription-checkbox-tmpl").html(),f="";b=AB.COMMUNICATIONPREF_V2._sortSubscriptions(b.subscriptionDetails);for(sequenceNumber in b){var g=b[sequenceNumber],h=g.subscriptionCode,l=this._getSubscriptionLabelByCode(d,h)||g.subscriptionDescription;l=l||h;g=g.subscriptionStatusCode;var k="S"===g?"checked":"";f+=e.replace(/\{\{id\}\}/gi,this.checkboxIdPrefix+h).replace(/\{\{subscriptionCode\}\}/gi,h).replace(/\{\{lastSelectedVal\}\}/gi,g).replace(/\{\{subscriptionLabel\}\}/gi,
l).replace(/\{\{checkedStatus\}\}/gi,k)}c.html(f)};this._sortSubscriptions=function(b){var c={};for(pref in b)c[b[pref].sequenceNumber]=b[pref];var d={};Object.keys(c).sort().forEach(function(b){d[b]=c[b]});return d};this._sortSubscriptions=function(b){var c={};for(pref in b)c[b[pref].sequenceNumber]=b[pref];var d={};Object.keys(c).sort().forEach(function(b){d[b]=c[b]});return d};this._getSubscriptionLabelByCode=function(b,c){b=JSON.parse(b);for(subIndex in b)if(b[subIndex].subscriptionCode.toLowerCase()===
c.toLowerCase())return b[subIndex].subscriptionLabel;return""};this._getEmailTokenParameter=function(b){var c=/[?&](deeplinkuid|emailToken)=([^&]*)/.exec(window.location.search);return c?b?encodeURIComponent(c[2]):c[2]:null};this.enableUpdBtnCheckBox=function(b){void 0===b&&$("#cb-unsubscribe-all").prop("checked",!1);var c=!1;$(".comm-pref-wrapper-v2-js .comm-pref-subs-list-js").find('input[type\x3d"checkbox"]').each(function(){void 0!==b&&$(this).prop("checked",!1);var d=$(this).data("lastselectedval")||
"U",e=$(this).is(":checked")?"S":"U";c||(c=d!==e)});void 0!==b&&(c=$("#cb-unsubscribe-all").is(":checked"));c?$("#updateBtn").removeClass("btn-disabled").addClass("primarybutton").removeAttr("disabled"):$("#updateBtn").removeClass("primarybutton").addClass("btn-disabled").prop("disabled",!0)}}).call(AB.COMMUNICATIONPREF_V2);
(function(){this.init=function(){if(0<$(".comm-pref-wrapper-v1-js").length)if(AB.userInfo&&AB.userInfo.j4u&&("R"===AB.userInfo.userType||"C"===AB.userInfo.userType))_getSubscriptionDetails();else{var b=AB.COMMUNICATIONPREF.getEmailTokenParameter(!0);b?_getAnonymousSubscriptionDetails(b):SWY.CONFIGSERVICE.isWCMModeDisabled()&&(window.location.href="/")}};_getAnonymousSubscriptionDetails=function(b){$.ajax({type:"GET",headers:AB.ucaHttpOptions,url:AB.anonymousUnsubscribe+"?token\x3d"+b,dataType:"json",
success:function(b,d,e){b="";d=JSON.stringify(e.responseJSON);d=JSON.parse(d);"undefined"!==typeof document.getElementById("emailId")&&(document.getElementById("emailId").innerHTML=d.emailId);var c={};for(pref in d.subscriptionDetails)c[d.subscriptionDetails[pref].subscriptionCode]=d.subscriptionDetails[pref].subscriptionStatusCode;d=JSON.stringify(c);d=JSON.parse(d);"S"==d.EmailSave?($("#EmailSave").prop("checked",!0),$("#EmailSavei").val("S")):($("#EmailSave").prop("checked",!1),$("#EmailSavei").val("U"));
"S"==d.J4U?($("#J4U").prop("checked",!0),$("#J4Ui").val("S")):($("#J4U").prop("checked",!1),$("#J4Ui").val("U"));"S"==d.GroceryDel?($("#GroceryDel").prop("checked",!0),$("#GroceryDeli").val("S")):($("#GroceryDel").prop("checked",!1),$("#GroceryDeli").val("U"));"S"==d.ProdRecall?($("#ProdRecall").prop("checked",!0),$("#ProdRecalli").val("S")):($("#ProdRecall").prop("checked",!1),$("#ProdRecalli").val("U"));for(datos in e.responseJSON)b+=e.responseJSON[datos]+"\x3cbr\x3e";$("#result").html(b)},error:function(b,
d,e){d="";for(datos in b.responseJSON)d+=b.responseJSON[datos]+"\x3cbr\x3e";$("#result").html(d)}})};_getSubscriptionDetails=function(){$.ajax({type:"GET",headers:AB.ucaHttpOptions,url:AB.COMMON.ucaAPIPathWithCustomerId(AB.subscriptionDetailsPath),dataType:"json",success:function(b,c,d){b="";c=JSON.stringify(d.responseJSON);c=JSON.parse(c);"undefined"!==typeof document.getElementById("emailId")&&$("#emailId").html(c.emailId);var e={};for(pref in c.subscriptionDetails)e[c.subscriptionDetails[pref].subscriptionCode]=
c.subscriptionDetails[pref].subscriptionStatusCode;c=JSON.stringify(e);c=JSON.parse(c);"S"==c.EmailSave?($("#EmailSave").prop("checked",!0),$("#EmailSavei").val("S")):($("#EmailSave").prop("checked",!1),$("#EmailSavei").val("U"));"S"==c.J4U?($("#J4U").prop("checked",!0),$("#J4Ui").val("S")):($("#J4U").prop("checked",!1),$("#J4Ui").val("U"));"S"==c.GroceryDel?($("#GroceryDel").prop("checked",!0),$("#GroceryDeli").val("S")):($("#GroceryDel").prop("checked",!1),$("#GroceryDeli").val("U"));"S"==c.ProdRecall?
($("#ProdRecall").prop("checked",!0),$("#ProdRecalli").val("S")):($("#ProdRecall").prop("checked",!1),$("#ProdRecalli").val("U"));for(datos in d.responseJSON)b+=d.responseJSON[datos]+"\x3cbr\x3e";$("#result").html(b)},error:function(b,c,d){"412"==b.responseJSON.status?$("#emailId").html(AB.userInfo.userId):b.responseJSON.subErrors?($("#result").html(b.responseJSON.subErrors["0"].message),console.log(b.responseJSON.subErrors["0"].message)):($("#result").html(d),console.log(d))}})};this.commPrefSubmit=
function(){AB.UCASERVICES.validateSession(function(){var b=[],c={};var d=$("#J4U").is(":checked")?{subscriptionCode:"J4U",subscriptionStatusCode:"S"}:{subscriptionCode:"J4U",subscriptionStatusCode:"U"};d.oldSubscriptionStatusCode=$("#J4Ui").val()||"";b[0]=d;d=$("#EmailSave").is(":checked")?{subscriptionCode:"EmailSave",subscriptionStatusCode:"S"}:{subscriptionCode:"EmailSave",subscriptionStatusCode:"U"};d.oldSubscriptionStatusCode=$("#EmailSavei").val()||"";b[1]=d;d=$("#GroceryDel").is(":checked")?
{subscriptionCode:"GroceryDel",subscriptionStatusCode:"S"}:{subscriptionCode:"GroceryDel",subscriptionStatusCode:"U"};d.oldSubscriptionStatusCode=$("#GroceryDeli").val()||"";b[2]=d;d=$("#ProdRecall").is(":checked")?{subscriptionCode:"ProdRecall",subscriptionStatusCode:"S"}:{subscriptionCode:"ProdRecall",subscriptionStatusCode:"U"};d.oldSubscriptionStatusCode=$("#ProdRecalli").val()||"";b[3]=d;c.subscriptionDetails=b||"";(d=AB.COMMUNICATIONPREF.getEmailTokenParameter(!1))?(b=AB.anonymousUnsubscribe,
c.token=d,c.sourceSystemCode="SUBSC",c.campaignCd=AB.COMMON.getURLParameterByName("campaignCd")?AB.COMMON.getURLParameterByName("campaignCd"):"",c.emailDate=AB.COMMON.getURLParameterByName("emailDate")?AB.COMMON.getURLParameterByName("emailDate"):"",c.themeNm=AB.COMMON.getURLParameterByName("themeNm")?AB.COMMON.getURLParameterByName("themeNm"):""):(b=AB.COMMON.ucaAPIPathWithCustomerId(AB.subscriptionDetailsPath),c.emailId=$("#emailId").html(),c.sourceSystemCode="PORT");$.ajax({type:"PATCH",headers:AB.ucaHttpOptionsPatch,
url:b,data:JSON.stringify(c),dataType:"json",success:function(b){AB.VALIDATION.updateMsg("update-msg",this.id);b=JSON.stringify(b);b=JSON.parse(b);"undefined"!==typeof $("#emailId")&&$("#emailId").html(b.emailId);var c={};for(pref in b.subscriptionDetails)c[b.subscriptionDetails[pref].subscriptionCode]=b.subscriptionDetails[pref].subscriptionStatusCode;b=JSON.stringify(c);b=JSON.parse(b);"S"==b.EmailSave?($("#EmailSave").prop("checked",!0),$("#EmailSavei").val("S")):($("#EmailSave").prop("checked",
!1),$("#EmailSavei").val("U"));"S"==b.J4U?($("#J4U").prop("checked",!0),$("#J4Ui").val("S")):($("#J4U").prop("checked",!1),$("#J4Ui").val("U"));"S"==b.GroceryDel?($("#GroceryDel").prop("checked",!0),$("#GroceryDeli").val("S")):($("#GroceryDel").prop("checked",!1),$("#GroceryDeli").val("U"));"S"==b.ProdRecall?($("#ProdRecall").prop("checked",!0),$("#ProdRecalli").val("S")):($("#ProdRecall").prop("checked",!1),$("#ProdRecalli").val("U"));$("#updateBtn").removeClass("primarybutton").addClass("btn-disabled").prop("disabled",
!0);AB.DATALAYER.pushEvent("edit_subscribe_lists")},error:function(b,c,d){$("#update-msg").html(b.responseJSON.error);$("#update-msg").css({display:"block"})}})})};$("#masterUnCheck").click(function(){$(this).is(":checked")&&$(".grpCheck input[type\x3dcheckbox]").each(function(){$(this).prop("checked",!1)})});this.getEmailTokenParameter=function(b){var c=/[?&](deeplinkuid|emailToken)=([^&]*)/.exec(window.location.search);return c?b?encodeURIComponent(c[2]):c[2]:null}}).call(AB.COMMUNICATIONPREF);
AB=AB||{};AB.UCAADDRESSPREFERENCE={};
(function(){this.defaultServerError="Sorry, we're having technical difficulties and working on fixing them, please check back later.";this.offlineErrorMessage="Sorry, we're having technical difficulties, please check back later.";this.maxAddressLimit=13;this.maxAddressLimitMessage="The number of saved addresses linked to your account have reached the maximum limit. If you'd like to save another address please delete one of your currently saved addresses.";this.deliveryPhoneNumber="";this.init=function(){var b=
$(".uca-multiple-addresses-wrapper");if(b&&0<b.length){AB.UCAADDRESSPREFERENCE._addressPreferenceInit();$(".add-address-button").on("click",AB.UCAADDRESSPREFERENCE.addAddressInit);$("#address-not-deliverable-modal .modal-notify-button").on("click",AB.UCAADDRESSPREFERENCE.notifyDeliveryAvailable);b=$("#multi-address-form");var c=$(".multi-address-cancel-link"),d=$("#update-phone-address-form"),e=$(".multi-addresses-dashboard");b.on("submit",AB.UCAADDRESSPREFERENCE.submitAddUpdateAddress);b.find('input[name\x3d"zipCode"]').on("keyup focusout",
AB.UCAADDRESSPREFERENCE.onChangeZipCodeValue);b.find('input[name\x3d"addressType"]').on("click change",AB.UCAADDRESSPREFERENCE.onToggleBusinessType);c.on("click",AB.UCAADDRESSPREFERENCE.refreshComponent);d.on("submit",AB.UCAADDRESSPREFERENCE.submitUpdatePhoneNumber);0<e.length&&e.attr("data-max-address-limit")&&(AB.UCAADDRESSPREFERENCE.maxAddressLimit=parseInt(e.attr("data-max-address-limit")))}};this._addressPreferenceInit=function(){AB.UCAADDRESSPREFERENCE.getFulfillment()};this.getFulfillment=
function(){var b=AB.ucaSubHttpOptions,c=AB.COMMON.ucaAPIPathWithCustomerId(AB.fulfillmentPreferences),d=$("#form-error-message").hide().addClass("d-none");$("#delivery-address-busy-loading").show().removeClass("mask");$("#pickup-store-busy-loading").show().removeClass("mask");$.ajax({type:"GET",url:c,headers:b,dataType:"json",success:function(b,c,d){AB.UCAADDRESSPREFERENCE._fillAddressSection(b);AB.UCAADDRESSPREFERENCE._fillPickupStoreSection(b);AB.UCAADDRESSPREFERENCE._fillPhoneNumber(b);$(".multi-addresses-dashboard").focus()},
error:function(b){e(b);b&&0===b.status?d.removeClass("d-none").show().text(AB.UCAADDRESSPREFERENCE.offlineErrorMessage):d.removeClass("d-none").show().text(AB.UCAADDRESSPREFERENCE.defaultServerError);$("div.fulfillment-data-load").hide()}})};this._fillAddressSection=function(b){var c=b.multiAddressEnabled||!1,d=$("button.add-address-button"),e=$("p.max-address-reach-copy"),g=$(".delivery-address-wrapper").html("");if(b.addresses&&0!==b.addresses.length){$("#deliveryAddressErrorMessage").addClass("d-none").hide();
for(var f=$("#deliveryAddressTemplate").find(".delivery-address-box"),p=0;p<b.addresses.length&&p<AB.UCAADDRESSPREFERENCE.maxAddressLimit;p++){var m=f.clone();m.find(".address-wrapper").attr("id","address-wrapper-"+p);m.find(".address-type").attr("id","address-type-"+p);var r=b.addresses[p];r.purposes&&0<r.purposes.length&&-1!==r.purposes.indexOf("DELIVERY")&&(r.addressType&&"2"===r.addressType.name?(m.find(".address-type").text("Business"),m.find(".business-name").removeClass("d-none").text(r.addressName)):
m.find(".address-type").text("Residential"),m.find(".address-1").text(r.address1),m.find(".address-2").text(r.address2),m.find(".address-city").text(r.city),m.find(".address-state").text(r.state),m.find(".address-zip").text(r.zipCode),m.find("a.update-link").data("address",r).on("click",AB.UCAADDRESSPREFERENCE.addAddressInit),m.find("a.update-link").attr("aria-describedby","address-wrapper-"+p+" address-type-"+p),m.find("a.delete-link").data("address",r).on("click",AB.UCAADDRESSPREFERENCE.deleteAddress),
m.find("a.delete-link").attr("aria-describedby","address-wrapper-"+p+" address-type-"+p),g.append(m))}c?b.addresses.length<AB.UCAADDRESSPREFERENCE.maxAddressLimit?(d.show(),e.hide()):(d.hide(),e.show()):d.hide()}else $("#deliveryAddressErrorMessage").removeClass("d-none").show(),d.show();c||$("a.delete-link").parent().hide();$("#delivery-address-busy-loading").hide().addClass("mask")};this._fillPhoneNumber=function(b){var c=$("#deliveryPhoneDiv");b.profile&&b.profile.emails&&0<b.profile.emails.length&&
c.find('input[name\x3d"emailId"]').val(b.profile.emails[0].text);if(b.profile&&b.profile.phone&&0<b.profile.phone.length&&b.profile.phone[0].purpose&&"Delivery"===b.profile.phone[0].purpose){var d="";b.profile.phone[0].number&&(d=b.profile.phone[0].number);c.find('input[name\x3d"oldPhone"]').val(d);c.find('input[name\x3d"phone"]').val(d);AB.UCAADDRESSPREFERENCE.deliveryPhoneNumber=d}};this._fillPickupStoreSection=function(c){var d=$(".pickup-store-wrapper").html(""),e=$("#deliveryAddressTemplate .select-store-box").clone(),
g=null;if(c.stores&&0<c.stores.length)for(var f=0;f<c.stores.length;f++){var n=c.stores[f];if("driveup"===n.storePreference.toLowerCase()){g=n;break}}g?(e.find(".address-1").text(g.address.address1),e.find(".address-2").text(g.address.address2),e.find(".city").text(g.address.city),e.find(".state").text(g.address.state),e.find(".zip").text(g.address.zipCode),e.find(".image img").attr("src",b(g.banner))):(e.find(".error-select-store").removeClass("d-none").show(),e.find(".select-store-address").addClass("d-none").hide());
e.find(".select-store-link a").on("click",function(b){b.preventDefault();b.stopPropagation();window.storeFulfillmentModal.zone.run(function(){window.storeFulfillmentModal.component.setModalDisplayData(2,"modal-tab-pickup")})});$("#pickup-store-busy-loading").hide().addClass("mask");d.append(e)};var b=function(b){return b?(b=b.toLowerCase().split(" ").join(""),"safeway"===b?"/etc/designs/wcax-commons/images/icons/Safeway_RGB.svg":"randalls"===b?"/etc/designs/wcax-commons/images/icons/Randalls_RGB.svg":
"pavilions"===b?"/etc/designs/wcax-commons/images/icons/Pavilions_RGB.svg":"tomthumb"===b?"/etc/designs/wcax-commons/images/icons/TomThumb_RGB.svg":"vons"===b?"/etc/designs/wcax-commons/images/icons/Vons_RGB.svg":"carrsqc"===b?"/etc/designs/wcax-commons/images/icons/carrs-color.svg":"albertsons"===b?"/etc/designs/wcax-commons/images/icons/Albertsons_RGB.svg":"acmemarkets"===b?"/etc/designs/wcax-commons/images/icons/acme-color.svg":"starmarket"===b?"/etc/designs/wcax-commons/images/icons/star-market-color.svg":
"shaws"===b?"/etc/designs/wcax-commons/images/icons/shaws-color.svg":"jewelosco"===b?"/etc/designs/wcax-commons/images/icons/JewelOsco_RGB.svg":"/etc/designs/wcax-commons/images/icons/Safeway_RGB.svg"):"/etc/designs/wcax-commons/images/icons/Safeway_RGB.svg"};this.addAddressInit=function(b){AB.UCAADDRESSPREFERENCE.zipCode="";b.preventDefault();b.stopPropagation();b=$(".add-update-address-section h2");window.scrollTo(0,0);var c=$(this).data("address"),d=$("#multi-address-form");d[0].reset();c?(b.text("Update Delivery Address"),
$.when(AB.UCAADDRESSPREFERENCE.loadZipCodeInfo(c.zipCode)).done(function(){c.addressType&&"1"===c.addressType.name?d.find('input[name\x3d"addressType"][value\x3d"residence"]').prop("checked",!0).click():d.find('input[name\x3d"addressType"][value\x3d"business"]').prop("checked",!0).click();d.find('input[name\x3d"addressId"]').val(c.addressId);d.find('input[name\x3d"businessName"]').val(c.addressName);d.find('input[name\x3d"address1"]').val(c.address1);d.find('input[name\x3d"address2"]').val(c.address2);
d.find('input[name\x3d"zipCode"]').val(c.zipCode);d.find('select[name\x3d"city"]').val(c.city);d.find('select[name\x3d"state"]').val(c.state)})):(b.text("Add Delivery Address"),d.find('input[name\x3d"addressType"][value\x3d"residence"]').prop("checked",!0).click(),d.find('input[name\x3d"addressId"]').val(""));AB.UCAADDRESSPREFERENCE.onToggleBusinessType();$(".multi-addresses-dashboard").addClass("d-none");$(".add-update-address-section").removeClass("d-none");b.focus()};this.submitAddUpdateAddress=
function(b){if(b.isDefaultPrevented())return!1;b.preventDefault();b.stopPropagation();var e=$(".btn img#add-update-address-loading");e.show();var g=$("#add-update-form-error-message").addClass("d-none").hide();b=AB.ucaHttpOptionsV2;var f=AB.COMMON.ucaAPIPathWithCustomerId(AB.deliveryAddressPath),q=$("#multi-address-form"),n=d($("#multi-address-form :input").serializeArray()),p=!1,m={purposes:["Delivery"]};g.text("");n.addressId&&0<n.addressId.length&&(m.addressId=n.addressId,p=!0);m.addressType={};
"residence"===n.addressType?m.addressType.name="1":(m.addressType.name="2",m.addressName=n.businessName);m.address1=n.address1;m.address2=n.address2;m.zipCode=n.zipCode;q.find("select#citySelect").is(":visible")?m.city=q.find("select#citySelect").val():m.city=q.find("input#cityTxt").val();m.state=n.state;q=JSON.stringify(m);$.ajax({type:"POST",url:f,data:q,headers:b,dataType:"json",success:function(b,c,d){p?(AB.COMMON.userNotify("Address is updated successfully."),AB.DATALAYER.setLinkClickEvents("multiaddress-update-success",
!0)):(AB.COMMON.userNotify("New address is added successfully."),AB.DATALAYER.setLinkClickEvents("multiaddress-add-success",!0));AB.UCAADDRESSPREFERENCE.refreshComponent();e.hide()},error:function(b){if(0===b.status)c(g,AB.UCAADDRESSPREFERENCE.offlineErrorMessage);else if(403===b.status||401===b.status)c(g),setTimeout(function(){window.location.reload()},400);else{var d=$(".add-update-address-section").attr("data-usp-error-message");(b=b.responseJSON)?b.errors&&0<b.errors.length?(b=b.errors[0],"IAUC0057"===
b.code?$("#address-not-deliverable-modal").modal():"IAUC0051"===b.code?c(g,d):"IAUC0090"===b.code?c(g,AB.UCAADDRESSPREFERENCE.maxAddressLimitMessage):c(g),AB.DATALAYER.setError(b.code,"multiaddress-error",b.message)):c(g):c(g)}e.hide()}})};var c=function(b,c){c=c||AB.UCAADDRESSPREFERENCE.defaultServerError;"string"===typeof b&&(b=$("#"+b));b=$(b);b.removeClass("d-none").show();setTimeout(function(){b.text(c)},50)};this.submitUpdatePhoneNumber=function(b){if(b.isDefaultPrevented())return!1;b.preventDefault();
b.stopPropagation();var c=$("#form-error-message");c.html("").addClass("d-none").hide();var d=$("#update-phone-address-form");b=AB.COMMON.ucaAPIPathWithCustomerId(AB.profileAddressPath);var g=AB.ucaHttpOptionsPatch,f={oldPhone:{purpose:"Delivery"},phone:{purpose:"Delivery"}},n=d.find('input[name\x3d"emailId"]').val();n&&0<n.length&&(f.emailId=n);f.oldPhone.number=d.find('input[name\x3d"oldPhone"]').val();f.phone.number=d.find("input#updateDeliveryPhoneNumber").val();"0"===f.phone.number.charAt(0)||
"1"===f.phone.number.charAt(0)?($("#deliveryPhoneDiv").addClass("has-error has-danger"),$("#update-phone-submit").attr("aria-invalid",!0),$("#invalied-phone").append('\x3cul class\x3d"list-unstyled"\x3e\x3cli\x3ePlease enter a phone number that doesn\x26#x27;t start with a 0 or 1.\x3c/li\x3e\x3c/ul\x3e'),$("#update-phone-submit").addClass("disabled").prop("disabled",!0)):(d=JSON.stringify(f),$.ajax({type:"PATCH",url:b,data:d,headers:g,dataType:"json",success:function(b,c,d){AB.COMMON.userNotify("Phone number has been successfully updated.");
AB.UCAADDRESSPREFERENCE.refreshComponent();$("#deliveryPhoneDiv").hasClass("has-error")&&$("#deliveryPhoneDiv").removeClass("has-error");$("#update-phone-submit").addClass("disabled").prop("disabled",!0)},error:function(b){e(b);b&&0===b.status?c.text(AB.UCAADDRESSPREFERENCE.offlineErrorMessage).removeClass("d-none").show():c.text(AB.UCAADDRESSPREFERENCE.defaultServerError).removeClass("d-none").show();window.scrollTo(0,0)}}))};this.deleteAddress=function(b){b.preventDefault();b.stopPropagation();
var c=$(this).data("address"),d=$("#form-error-message").hide().addClass("d-none");if(c&&c.addressId&&0<c.addressId.length){b=AB.ucaHttpOptionsV2;var g=AB.COMMON.ucaAPIPathWithCustomerId(AB.deliveryAddressPath);c={addressId:c.addressId};c=JSON.stringify(c);$.ajax({type:"DELETE",url:g,data:c,headers:b,dataType:"json",success:function(b,c,d){AB.COMMON.userNotify("Successfully Deleted the address.");AB.DATALAYER.setLinkClickEvents("multiaddress-delete-success",!0);AB.UCAADDRESSPREFERENCE.refreshComponent()},
error:function(b){e(b);b&&0===b.status?d.removeClass("d-none").show().text(AB.UCAADDRESSPREFERENCE.offlineErrorMessage):d.removeClass("d-none").show().text(AB.UCAADDRESSPREFERENCE.defaultServerError);window.scrollTo(0,0)}})}else console.error("Address ID is missing from the Address object")};this.refreshComponent=function(b){b&&(b.preventDefault(),b.stopPropagation());AB.UCAADDRESSPREFERENCE._addressPreferenceInit();$(".multi-addresses-dashboard").removeClass("d-none").show().focus();$(".add-update-address-section").addClass("d-none")};
var d=function(b){for(var c={},d=0;d<b.length;d++)c[b[d].name]=b[d].value;return c},e=function(b){!b||403!==b.status&&401!==b.status||SWY.ENFORCEMENT.singleSignOnUser(window.location.href)};this.onToggleBusinessType=function(b){b=$('input[name\x3d"addressType"]:checked').val();var c=$("div.business-name-wrapper"),d=$("#multi-address-form");"business"===b?(c.removeClass("d-none"),d.find('input[name\x3d"businessName"]').attr("required","")):(c.addClass("d-none"),d.find('input[name\x3d"businessName"]').removeAttr("required"))};
this.onChangeZipCodeValue=function(){var b=$(this).val();AB.VALIDATION.clearErrorMessage(this.id);if(b&&5<=b.length&&b!==AB.UCAADDRESSPREFERENCE.zipCode){var c=/^\d{5}(-\d{4})?$/;/[A-Za-z]/i.test(b)?f("zip-code","Please enter a ZIP Code that contains only numbers."):c.test(b)?AB.UCAADDRESSPREFERENCE.loadZipCodeInfo(b):f("zip-code","Please enter a valid ZIP Code.")}else f("zip-code","")};this.loadZipCodeInfo=function(b){return $.ajax({type:"GET",headers:AB.xAPIstoreResolverHttpOptions,dataType:"json",
url:AB.storeResolverZipToCityEndpoint+"?zipcode\x3d"+b,success:function(b){b&&b.geo&&(b.geo.errors&&0<b.geo.errors.length?"1504"===b.geo.errors[0].code?f("zip-code","Please enter a valid ZIP Code."):f("zip-code",""):(b.geo.region&&0<b.geo.region.length&&$('select#selectState[name\x3d"state"]').val(b.geo.region),b.geo.address2&&0<b.geo.address2.length&&($('input#cityTxt[name\x3d"city"]').val(b.geo.address2),AB.VALIDATION.clearErrorMessage("cityTxt")),b.geo.postalCode&&0<b.geo.postalCode.length&&(AB.UCAADDRESSPREFERENCE.zipCode=
b.geo.postalCode),f("zip-code","")))},error:function(b,c,d){0===b.status?f("zip-code",AB.UCAADDRESSPREFERENCE.offlineErrorMessage):b.responseJSON?(b=b.responseJSON,b.geo&&b.geo.errors&&0<b.geo.errors.length&&f("zip-code","Please enter a valid ZIP Code.")):f("zip-code","")}})};var f=function(b,c){(b=document.getElementById(b))&&b.setCustomValidity(c)};this.notifyDeliveryAvailable=function(){var b=AB.ucaHttpOptionsUpdateProfile,c=AB.COMMON.ucaAPIPathWithCustomerId(AB.storeAddressPath),d={postalCodes:[{purposes:["NOTIFYME"],
postalCode:$('input[name\x3d"zipCode"]').val(),bannerId:SWY.CONFIGSERVICE.getResolvedBanner()}]};d=JSON.stringify(d);$.ajax({type:"POST",headers:b,url:c,data:d,dataType:"json",success:function(b){AB.COMMON.userNotify("Successfully registered your email address for notification");AB.UCAADDRESSPREFERENCE.refreshComponent()},error:function(b){console.error(b)}})}}).call(AB.UCAADDRESSPREFERENCE);AB=AB||{};AB.UCASUBSCRIPTIONSERVICES={};
(function(){this.invalidReasonCode="Cancellation reason is invalid.";this.cancelDuringBatchProcess="Subscription is renewing and cannot be cancelled.";this.cancelWithinBufferTime="Your plan is currently being renewed and cannot be cancelled at this time.";this.serverError="Internal server error occured.";this.unknownError="Unknown error. Please contact the support team for resolution.";this.subsPaymentError="Your enrollment cannot be processed. Please update your payment method and try again.";this.subsDefaultError=
"Sorry, we're having technical difficulties and working on fixing them, please check back later.";this.init=function(){SWY.CONFIGSERVICE.isWCMModeDisabled()||(0<$("#ds-summary-wrapper").length?($("#sub-summary-payment").show(),$("#sub-summary-view-plans").hide(),$("#sub-summary-select-plans").show(),$("#sub-summ-terms").show(),$("#sub-summary").show(),$("#subscriptionOptions").show()):0<$("#deliverySubscriptionLandingId").length?($("#dsNewSubscriberBanner").show(),$("#dsExistingSubscriberBanner").show(),
$("#subscriptionOptions").show()):0<$("#deliverySubscriptionConfirmation").length&&($("#dsConfFirstOrderDiscountId").show(),$("#dsConfPrevOrderDiscountId").show()));var b=AB&&AB.userInfo&&-1!=["C","M","R"].indexOf(AB.userInfo.userType);b?b&&SWY.CONFIGSERVICE.isWCMModeDisabled()&&(0<$("#ds-summary-wrapper").length&&(AB.COMMON.getURLParameterByName("gid")?AB.UCASUBSCRIPTIONSERVICES._loadConfirmationPage(AB.COMMON.getURLParameterByName("gid")):AB.UCASUBSCRIPTIONSERVICES._lookforsubscription(!1,!1)),
0<$("#deliverySubscriptionLandingId").length&&($("#deliverySubscriptionLandingId").hasClass("delivery-subscription-wrapper")&&$(".full-bleed-row").css("clear","both"),AB.UCASUBSCRIPTIONSERVICES._getSubscriberOrderCount()),0<$("#deliverySubscriptionConfirmation").length&&($("#deliverySubscriptionConfirmation").hasClass("delivery-subscription-wrapper")&&$(".full-bleed-row").css("clear","both"),AB.UCASUBSCRIPTIONSERVICES._loadConfirmationPage(AB.COMMON.getURLParameterByName("gid"))),0<$("#deliverySubscriptionfaqId").length&&
$("#deliverySubscriptionfaqId").hasClass("delivery-subscription-wrapper")&&"true"==AB.COMMON.getURLParameterByName("isDSManage")&&$("#dsContinuefaqsId").attr("href",SWY.CONFIGSERVICE.DSConfig.dsManageUrl)):(b=$("#myNavbar ul li a:contains('Delivery')"),0<b.length&&(b.hide(),b.removeAttr("href"),$("#deliverySubMainTitleId").hide()));0<$(".delivery-subscription-banner").length&&AB.UCASUBSCRIPTIONSERVICES._initDeliverySubscriptionBanner()};this._errorHandling=function(b,c,d){if(b&&d&&d.errorCode)switch(d.errorCode){case "OSMS-SUBSCRIPTION-0009":b=
this.invalidReasonCode;break;case "OSMS-SUBSCRIPTION-00013":b=this.cancelDuringBatchProcess;break;case "OSMS-SUBSCRIPTION-00014":b=this.cancelWithinBufferTime;break;case "OSMS-SUBSCRIPTION-0007":b=this.serverError;break;case "OSMS-SUBSCRIPTION-0000":b=this.unknownError;break;case "OSMS-SUBSCRIPTION-00021":b=this.subsPaymentError;break;default:b=this.subsDefaultError}else b=this.subsDefaultError;$("#"+c).text(b);$("#loading").hide()};this._initDeliverySubscriptionBanner=function(){var b=$("#ds-banner-busy-loading");
b.show().removeClass("mask");var c=$(".delivery-subscription-banner"),d="",e="";e="";AB.COMMON.getURLParameterByName("subscriptioncode")?e=AB.COMMON.getURLParameterByName("subscriptioncode"):AB.COMMON.getURLParameterByName("sid")&&(e=AB.COMMON.getURLParameterByName("sid"));d=AB.deliverySubJavaHttpOptions;e=SWY.CONFIGSERVICE.DSConfig.dsJavaBasePath+SWY.CONFIGSERVICE.DSConfig.dsJavaUserEnrollmentDetails+"/"+AB.userInfo.customerId+"/"+e;var f=$("#ds-subscribe-submit");d=$.ajax({url:e,headers:d,method:"GET",
success:function(d){if(d){f.data("subscriptionInfo",d);d.subsciptionEnrollmentBtnCaption&&0<d.subsciptionEnrollmentBtnCaption.length&&f.text(d.subsciptionEnrollmentBtnCaption);d.subscriptionCaption&&0<d.subscriptionCaption.length?c.find(".plan-title").html($("\x3cp\x3e\x3c/p\x3e").text(d.subscriptionCaption)):c.find(".plan-title").html("");d.pricingDetailLine1&&0<d.pricingDetailLine1.length?c.find(".plan-rate").html($("\x3cp\x3e\x3c/p\x3e").text(d.pricingDetailLine1)):c.find(".plan-rate").html("");
d.pricingDetailLine2&&0<d.pricingDetailLine2.length?c.find(".plan-detail").html($("\x3cp\x3e\x3c/p\x3e").text(d.pricingDetailLine2)):c.find(".plan-detail").html("");var e=c.find(".switch-link a");d.switchPlanSubscriptionCode&&0<d.switchPlanSubscriptionCode.length?e.attr("href",location.pathname+"?sid\x3d"+d.switchPlanSubscriptionCode):e.attr("href","#");d.subscriptionCaptionSwitch&&0<d.subscriptionCaptionSwitch.length&&e.text(d.subscriptionCaptionSwitch);d.subscriptionTrialActiveMessage&&0<d.subscriptionTrialActiveMessage.length&&
c.find(".detail-end-on").html($("\x3cp\x3e\x3c/p\x3e").text(d.subscriptionTrialActiveMessage));d.renewalDateFormatted&&0<d.renewalDateFormatted.length&&(c.find(".detail-date").html($("\x3cp\x3e\x3c/p\x3e").text(d.renewalDateFormatted)),$(".detail-bill-info").removeClass("mask").addClass("unmask"));d.showSubscriptionTerms&&$(".ds-disclaimer-section").removeClass("d-none");b.hide().addClass("mask");c.removeClass("d-none")}else AB.UCASUBSCRIPTIONSERVICES._errorHandling(200,"ds-banner-error",null),b.hide().addClass("mask")},
error:function(d,e,f){console.error(f);AB.UCASUBSCRIPTIONSERVICES._errorHandling(d.status,"ds-banner-error",d.responseJSON);b.hide().addClass("mask");c.hide()}});f.data("enrollment-request",d);$(".delivery-subscription-banner").on("completed-wcma-call",AB.UCASUBSCRIPTIONSERVICES._triggerWCMACallComplete)};this._triggerWCMACallComplete=function(b,c){var d=$("#ds-subscribe-submit"),e=$("#ds-banner-submit-busy-loading");b=d.data("enrollment-request");$.when(b,c).done(function(b,c){var f=b[0];b=c[0];
var g=null;if(b.tenders)for(c=0;c<b.tenders.length;c++)if("DELIVERY_SUBSCRIPTION"===b.tenders[c].primaryPurpose){g=b.tenders[c];break}b=$(".terms-condition-submit-section");if(g){b.removeClass("d-none").show();var k=$("input#terms-nc").on("change",function(){$(this).is(":checked")?d.removeAttr("disabled"):d.attr("disabled","true")});d.data("tender",g).on("click",function(b){if($("#cvv-form").validator("validate").has(".has-error").length)return b.preventDefault(),b.stopPropagation(),d.removeAttr("disabled"),
!1;$("#ds-banner-submit-error").html("");k.attr("disabled","true");e.removeClass("mask").show();d.attr("disabled",!0);b={creditCardInfo:{ccToken:g.token,cvv:$("#cvv-inputField").val(),expDate:g.expiryDate,fullName:g.holderName,type:g.cardType,zip:g.postalCode,tenderId:g.id},gid:f.gid,promotionFee:25,subscriptionCode:f.subscriptionCode,termsVersionId:f.subscriptionTermsId};b=JSON.stringify(b);var c=SWY.CONFIGSERVICE.DSConfig.dsJavaBasePath+SWY.CONFIGSERVICE.DSConfig.dsJavaSubscriptionCreate.replace("{gid}",
f.gid);$.ajax({type:"POST",headers:AB.deliverySubJavaHttpOptions,url:c,data:b,success:function(b,c,g){g=b.Data;b=!1;g&&(c=g.newSubscriber,g=g.subscriptionStatus,"Cancelled"===g&&(b=c=!0),g=$(".delivery-subscription-banner").attr("data-confirmation-redirect-url"),!0===c&&!0===b&&(window.location.href=g+"?reEnrolluser\x3dtrue"),!0===c&&!1===b&&(window.location.href=g+"?gid\x3d"+f.gid),!1===c&&(SWY&&SWY.CONFIGSERVICE&&SWY.CONFIGSERVICE.DSConfig&&SWY.CONFIGSERVICE.DSConfig.dsManageUrl&&(g=SWY.CONFIGSERVICE.DSConfig.dsManageUrl),
window.location.href=g+"?gid\x3d"+f.gid));d.removeAttribute("disabled");e.addClass("mask").hide()},error:function(b,c,f){AB.UCASUBSCRIPTIONSERVICES.defaultError(b);AB.UCASUBSCRIPTIONSERVICES._errorHandling(b.status,"ds-banner-submit-error",b.responseJSON);d.removeAttr("disabled");e.addClass("mask").hide();k.removeAttr("disabled");console.error("Delivery Subscription Error",b,f)}})})}else b.addClass("d-none").hide()})};this._lookforsubscription=function(b,c){$("#loading").show();void 0==AB.UCASUBSCRIPTIONSERVICES.subscriptionservice&&
(AB.UCASUBSCRIPTIONSERVICES.subscriptionservice={});var d={url:AB.COMMON.ucaAPIPathWithCustomerId(SWY.CONFIGSERVICE.DSConfig.dsPreferenceEndPoint),method:"GET",cache:!1,headers:AB.ucaHttpOptions,success:function(d){$("#loading").hide();if(b||$.isEmptyObject(d)||$.isEmptyObject(d.preferences[0])||c)if(b||!$.isEmptyObject(d.preferences[0])||c)if(!b||$.isEmptyObject(d)||$.isEmptyObject(d.preferences[0])||c||$.isEmptyObject(d.preferences[0].optChoices[0])||"CANCELLED"==d.preferences[0].optChoices[0].choice)AB.UCASUBSCRIPTIONSERVICES._callSubscriptionPlans(!0,
!1);else return window.location.href=SWY.CONFIGSERVICE.DSConfig.dsManageUrl;else AB.UCASUBSCRIPTIONSERVICES._callSubscriptionPlans(!1,!1);else AB.UCASUBSCRIPTIONSERVICES._loadASOfText(),AB.UCASUBSCRIPTIONSERVICES._enableManageSubscriptionPlan(),AB.UCASUBSCRIPTIONSERVICES._landManageubscriptionPage(d)},error:function(b,c,d){console.error(d);AB.UCASUBSCRIPTIONSERVICES._errorHandling(b.status,"errorMessage",b.responseJSON)}};$.ajax(d).done(function(b){console.log(b)})};this._callSubscriptionPlans=function(b,
c){$("#loading").show();var d="",e="";SWY.CONFIGSERVICE.DSConfig.dsJavaEnabledFlag?(d=AB.deliverySubJavaHttpOptions,e=SWY.CONFIGSERVICE.DSConfig.dsJavaBasePath+SWY.CONFIGSERVICE.DSConfig.dsJavaServiceRestEndpoint):(d=AB.deliverySubHttpOptions,e=SWY.CONFIGSERVICE.DSConfig.dsServiceRestEndpoint);$.ajax({url:e,method:"GET",headers:d,success:function(d){$("#loading").hide();AB.UCASUBSCRIPTIONSERVICES._loadPlansData(d,b,c)},error:function(b,c,d){console.log(d);AB.UCASUBSCRIPTIONSERVICES._errorHandling(b.status,
"errorMessage",b.responseJSON)}}).done(function(b){console.log(b)})};this._landManageubscriptionPage=function(b){$("#loading").hide();AB.UCASUBSCRIPTIONSERVICES.maskedAccountNumber={};var c=!0;$.each(b.preferences,function(d,e){$.isEmptyObject(b)||$.isEmptyObject(e)||$.isEmptyObject(e.effectiveTimePeriods)||"CANCELLED"==e.optChoices[0].choice||"PENDING_ACTIVATION"==e.optChoices[0].choice||(c=!1,$("#sub-summary").show(),$("#sub-summary-payment").show(),$("#sub-summary-view-plans").hide(),$("#sub-summ-terms").show(),
$("#dsmanageFaqsId").show(),$("#subscription-type").html("TRIAL"==e.optChoices[0].choice||"PENDING_CANCELLATION"==e.optChoices[0].choice?"trial"==e.effectiveTimePeriods[0].type.toLowerCase()?e.effectiveTimePeriods[0].type.toLowerCase():e.type.replace("PLAN","").toLowerCase():e.type.replace("PLAN","").toLowerCase()),$("#subscription-enddate").html(AB.UCASUBSCRIPTIONSERVICES.convertDate(e.effectiveTimePeriods[0].endDate)),"trial"==e.optChoices[0].choice.toLowerCase()?($(".planTypeId").html(e.type?e.type.replace("PLAN",
"").toLowerCase():""),$("#autoEnrollId").show(),$("#cancelDSPlanId").removeAttr("disabled"),$("#cancelDSPlanId").on("click"),$("#subscriptionValidityId").show(),$("#autoEnrollId").show()):($("#subscriptionValidityId").hide(),$("#autoEnrollId").hide()),"suspended"==e.optChoices[0].choice.toLowerCase()?($("#failurePaymentId").show(),$("#dsManageChangePlanId").attr("disabled","disabled"),$("#dsManageChangePlanId").off("click"),$("#successPaymentId").hide()):($("#failurePaymentId").hide(),$("#successPaymentId").show()),
"PENDING_CANCELLATION"==e.optChoices[0].choice&&"CANCEL_PLAN"==e.optChoices[0].reasonCode&&($("#cancelDSPlanId").attr("disabled","disabled"),$("#cancelDSPlanId").off("click"),$("#dsManageChangePlanId").attr("disabled","disabled"),$("#dsManageChangePlanId").off("click")),"CHANGE_PLAN"==e.optChoices[0].reasonCode&&($("#dsManageChangePlanId").attr("disabled","disabled"),$("#dsManageChangePlanId").off("click")))});c&&(AB.UCASUBSCRIPTIONSERVICES._enableSelectPlan(),AB.UCASUBSCRIPTIONSERVICES._callSubscriptionPlans(!1,
!1))};this.convertDate=function(b){var c=new Date(b);if(!isNaN(c.getTime())){b=c.getUTCFullYear().toString().substr(-2);var d=c.getUTCMonth()+1;c=c.getUTCDate();return d+"/"+c+"/"+b}};this._callChangeSubscriptionPlan=function(){$("#sub-summary-view-plans").hide();$("#sub-summary").hide();$("#sub-summary-payment").hide();$("#sub-summary-cancel-plans").hide();$("#sub-summ-terms").hide();$("#dsmanageFaqsId").hide();AB.UCASUBSCRIPTIONSERVICES._callSubscriptionPlans(!1,!0)};this._callFreeTrailDotNet=function(b){SWY.CONFIGSERVICE.DSConfig.dsJavaEnabledFlag?
window.location.href=AB.deliverySubAemPaymentURL+$(b).attr("data-sub-code"):AB.COMMON.checkAndRedirectDotNetUrl(AB.deliverySubDotnetPaymentURL+$(b).attr("data-sub-code"))};this._enableSelectPlan=function(){$("#dsChangeorSelectPlanLblId").html("Select Plan");$("#dsChangeorSelectPlanLblId").attr("aria-label","Select Plan");$("#sub-summary-view-plans").hide();$("#sub-summary").hide();$("#sub-summary-payment").hide();$("#sub-summary-select-plans").show();$("#subscriptionOptions").show();$("#sub-summary-cancel-plans").hide();
$("#dsChangeorSelectPlanLblId").focus()};this._enableChangePlan=function(){$("#dsChangeorSelectPlanLblId").html("Change Plan");$("#dsChangeorSelectPlanLblId").attr("aria-label","Change Plan");$("#sub-summary-view-plans").hide();$("#sub-summary").hide();$("#sub-summary-payment").hide();$("#sub-summary-select-plans").show();$("#sub-summary-cancel-plans").hide();$("#sub-summ-terms").show();$("#dsmanageFaqsId").hide();$("#dsChangeorSelectPlanLblId").focus()};this._enableManageSubscriptionPlan=function(){$("#sub-summary").show();
$("#sub-summary-payment").show();$("#sub-summary-view-plans").hide();$("#dsmanageFaqsId").show();$("#sub-summ-terms").show()};this._loadPlansData=function(b,c,d){var e=!1;c||!b.Data.returningCustomer||d?c||b.Data.returningCustomer||d?c||b.Data.returningCustomer||!d?c&&($("#deliverySubscriptionLandingId").show(),$("#subscriptionOptions").show(),$("#dsBottomId").show()):(AB.UCASUBSCRIPTIONSERVICES._enableChangePlan(),$("#subscriptionOptions").show(),$("#dsmanageFaqsId").show()):($("#sub-summary-payment").hide(),
$("#sub-summary-view-plans").show(),$("#sub-summ-terms").show(),$("#dsmanageFaqsId").hide(),$("#sub-summary-select-plans").hide(),$("#sub-summary-cancel-plans").hide(),$("#dsManageChangePlanId").off("click"),$("#cancelDSPlanId").off("click"),$("#dsmanageFaqsId").show()):($("#sub-summary").hide(),$("#sub-summary-payment").hide(),$("#sub-summary-view-plans").hide(),$("#sub-summary-view-plan").hide(),$("#sub-summ-terms").show(),$("#dsmanageFaqsId").hide(),$("#sub-summary-select-plans").show(),$("#subscriptionOptions").show(),
$("#sub-summary-cancel-plans").hide(),$("#dsmanageFaqsId").show());if(b.Data&&b.Data.subscriptions){$.each(b.Data.subscriptions,function(b,c){"Annual Plan"==c.caption?($("#dsAnnualPlanId").html(c.pricingDetail),$("#dsAnnualPlanCTAId").attr("data-sub-code",c.code)):"Monthly Plan"==c.caption&&($("#dsMonthlyPlanId").html(c.pricingDetail),$("#dsMonthlyPlanCTAId").attr("data-sub-code",c.code))});if(1==b.Data.returningCustomer)return $("#dsAnnualPlanCTAId").html("Select Plan"),$("#dsAnnualPlanCTAId").attr("aria-label",
"Select Annual Plan"),$("#dsMonthlyPlanCTAId").html("Select Plan"),$("#dsMonthlyPlanCTAId").attr("aria-label","Select Monthly Plan"),!1;$.each(b.Data.subscriptions,function(b,c){if(c.selected){e=!0;if("Annual Plan"==c.caption)return $("#dsMonthlyPlanCTAId").html("Select Plan"),$("#dsMonthlyPlanCTAId").attr("aria-label","Select Monthly Plan"),$("#dsAnnualPlanCTAId").attr("disabled","disabled"),$("#dsAnnualPlanCTAId").off("click"),$("#dsAnnualPlanCTAId").html("Current Plan"),$("#dsAnnualPlanCTAId").attr("aria-label",
"Current Annual Plan"),!1;if("Monthly Plan"==c.caption)return $("#dsMonthlyPlanCTAId").html("Current Plan"),$("#dsMonthlyPlanCTAId").attr("aria-label","Current Monthly Plan"),$("#dsAnnualPlanCTAId").html("Select Plan"),$("#dsAnnualPlanCTAId").attr("aria-label","Select Annual Plan"),$("#dsMonthlyPlanCTAId").attr("disabled","disabled"),$("#dsMonthlyPlanCTAId").off("click"),!1}});e||($("#dsAnnualPlanCTAId").html("Start Free Trial"),$("#dsAnnualPlanCTAId").attr("aria-label","Annual Plan start free trial"),
$("#dsMonthlyPlanCTAId").html("Start Free Trial"),$("#dsMonthlyPlanCTAId").attr("aria-label","Monthly Plan start free trial"))}};this._loadConfirmationPage=function(b){$("#loading").show();var c="",d="";SWY.CONFIGSERVICE.DSConfig.dsJavaEnabledFlag?(c=AB.deliverySubJavaHttpOptions,d=SWY.CONFIGSERVICE.DSConfig.dsJavaBasePath+SWY.CONFIGSERVICE.DSConfig.dsJavaUserApiEndpoint.replace("{gid}",b)):(c=AB.deliverySubHttpOptions,d=SWY.CONFIGSERVICE.DSConfig.dsUserApiEndpoint.replace("{gid}",b));$.ajax({url:d,
method:"GET",headers:c,success:function(b){$("#loading").hide();$.isEmptyObject(b.Data)||(0<$("#dsConfirmationRenewlDt").length?0==b.Data.shopSiteOrderCount?$("#dsConfFirstOrderDiscountId").show():$("#dsConfPrevOrderDiscountId").show():0<$("#newChangePlanDateId").length&&($("#sub-summary-view-plans").hide(),$("#sub-summary").hide(),$("#sub-summary-payment").hide(),$("#sub-summary-select-plans").hide(),$("#sub-summ-terms").hide(),$("#sub-summary-cancel-plans").hide(),$("#sub-summary-cancel-plans-confirmation").hide(),
$("#sub-summary-change-plans-confirmation").show(),$("#newChangePlanDateId").html(AB.COMMON.formatDate(b.Data.pendingRenewalDate)),$("#currentPlanDateId").html(AB.COMMON.formatDate(b.Data.curentPlanExpiryDate))))},error:function(b,c,d){console.log(d);AB.UCASUBSCRIPTIONSERVICES._errorHandling(b.status,"errorMessage",b.responseJSON)}}).done(function(b){console.log(b)})};this._enableCancelPlan=function(b){$("#sub-summary-view-plans").hide();$("#sub-summary").hide();$("#sub-summary-payment").hide();$("#sub-summary-select-plans").hide();
$("#sub-summ-terms").hide();$("#dsmanageFaqsId").hide();1==$("#dsCancelReasons \x3e option").length?AB.UCASUBSCRIPTIONSERVICES._loadCancelPlan():($("#dsCancelReasons").prop("selectedIndex",0),$("#sub-summary-cancel-plans").show(),$("#dsCancelPlanCTAId").attr("disabled",!0))};this._loadCancelPlan=function(){$("#loading").show();var b="",c="";SWY.CONFIGSERVICE.DSConfig.dsJavaEnabledFlag?(b=AB.deliverySubJavaHttpOptions,c=SWY.CONFIGSERVICE.DSConfig.dsJavaBasePath+SWY.CONFIGSERVICE.DSConfig.dsJavaCancelReasonsApiEndpoint):
(b=AB.ucaHttpOptions,c=SWY.CONFIGSERVICE.DSConfig.dsCancelReasonsApiEndpoint);$.ajax({url:c,method:"GET",headers:b,success:function(b){$("#loading").hide();$("#dsCancelPlanCTAId").attr("disabled",!0);$.isEmptyObject(b.Data)||($("#dsCancelReasons").prop("selectedIndex",0),$("#sub-summary-cancel-plans").show(),$("#dsCancelPlanId").focus(),$.each(b.Data,function(b,c){b=new Option(c.Reason,c.ID);$("#dsCancelReasons").append(b)}))},error:function(b,c,f){console.log(f);AB.UCASUBSCRIPTIONSERVICES._errorHandling(b.status,
"errorMessage",b.responseJSON)}}).done(function(b){console.log(b)})};this._cancelSubscriptionPlan=function(){$("#sub-summary-cancel-plans").hide();$("#loading").show();var b=AB.userInfo.customerId,c="",d="",e="DELETE",f={ReasonCode:$(dsCancelReasons).val()};SWY.CONFIGSERVICE.DSConfig.dsJavaEnabledFlag?(c=AB.deliverySubJavaHttpOptions,d=SWY.CONFIGSERVICE.DSConfig.dsJavaBasePath+SWY.CONFIGSERVICE.DSConfig.dsJavaUserApiEndpoint.replace("{gid}",b),d=d.replace("get","cancel"),e="POST",f={reasonCode:$(dsCancelReasons).val()}):
(c=AB.deliverySubHttpOptions,d=SWY.CONFIGSERVICE.DSConfig.dsUserApiEndpoint.replace("{gid}",b));b={url:d,method:e,headers:c,data:JSON.stringify(f),success:function(b){$("#loading").hide();$.isEmptyObject(b.Data)||($("#sub-summary-cancel-plans-confirmation").show(),$("#dsCancelConTopTitleId").focus(),$("#cancelConfTillId").html(AB.COMMON.formatDate(b.Data.curentPlanExpiryDate)))},error:function(b,c,d){console.log(d);AB.UCASUBSCRIPTIONSERVICES._errorHandling(b.status,"errorMessage",b.responseJSON)}};
$.ajax(b).done(function(b){console.log(b)})};this._keepPlanLoad=function(){$("#sub-summary-cancel-plans").hide();$("#sub-summ-terms").hide();$("#dsmanageFaqsId").hide();$("#sub-summary-cancel-plans-confirmation").hide();AB.UCASUBSCRIPTIONSERVICES._enableManageSubscriptionPlan();$("#deliverySubMainTitleId").focus()};this._enableCancelPlanCTA=function(b){$("#dsCancelPlanCTAId").attr("disabled",-1==$(b).val())};this._loadASOfText=function(){$("#ds-as-of-text").html("as of "+(new Date).toLocaleString("en-US",
{month:"2-digit",day:"2-digit",year:"2-digit",hour12:"true",hour:"2-digit",minute:"2-digit"}).replace(","," at "))};this._getSubscriberOrderCount=function(){$("#sub-summary-cancel-plans").hide();$("#loading").show();var b=0;SWY.CONFIGSERVICE.DSConfig.dsJavaEnabledFlag?(null!=localStorage.getItem("abOrderCount")&&(b=localStorage.getItem("abOrderCount")),0<b?$("#dsExistingSubscriberBanner").show():$("#dsNewSubscriberBanner").show(),AB.UCASUBSCRIPTIONSERVICES._lookforsubscription(!0,!1)):(b={url:SWY.CONFIGSERVICE.DSConfig.dsUserShopOrderCountApiEndpoint,
method:"POST",headers:AB.deliverySubHttpOptions,data:JSON.stringify({userId:AB.userInfo.userId}),success:function(b){$("#loading").hide();$.isEmptyObject(b)||(0<b.TotalOrderCount?$("#dsExistingSubscriberBanner").show():$("#dsNewSubscriberBanner").show());AB.UCASUBSCRIPTIONSERVICES._lookforsubscription(!0,!1)},error:function(b,d,e){console.log(e);AB.UCASUBSCRIPTIONSERVICES._errorHandling(b.status,"errorMessage",b.responseJSON)}},$.ajax(b).done(function(b,d,e){console.log(e.status)}))};this.defaultError=
function(b){!b||403!==b.status&&401!==b.status||SWY.ENFORCEMENT.singleSignOnUser(window.location.href)};this._subscriptionCardStatus=function(b){var c="",d="";SWY.CONFIGSERVICE.DSConfig.dsJavaEnabledFlag?(c=AB.deliverySubJavaHttpOptions,d=SWY.CONFIGSERVICE.DSConfig.dsJavaBasePath+SWY.CONFIGSERVICE.DSConfig.dsJavaUserApiEndpoint.replace("{gid}",b)):(c=AB.deliverySubHttpOptions,d=SWY.CONFIGSERVICE.DSConfig.dsUserApiEndpoint.replace("{gid}",b));$.ajax({url:d,method:"GET",headers:c,success:function(b){$.isEmptyObject(b.Data)||
(b=b.Data.status)&&"Suspended"===b&&0<$("#dsCardSuspended").length&&$("#dsCardSuspended").removeClass("mask").addClass("unmask")},error:function(b,c,d){console.log(d);AB.UCASUBSCRIPTIONSERVICES._errorHandling(b.status,"errorMessage",b.responseJSON)}}).done(function(b){console.log(b)})}}).call(AB.UCASUBSCRIPTIONSERVICES);AB=AB||{};AB.INSTANTALLOCATION={};
(function(){this.queryParams={};this.init=function(){var b=$(".instant-allocation-banner"),c={};AB.INSTANTALLOCATION.isEligibleForOffer=!1;b&&0<b.length&&SWY.QUERYSTRING.hasParam("ck",window.location.search)&&SWY.QUERYSTRING.hasParam("cd",window.location.search)&&(SWY.QUERYSTRING.queryParams.cd&&(c.encryptedData=SWY.QUERYSTRING.queryParams.cd),SWY.QUERYSTRING.queryParams.ck&&(c.keyAliasName=SWY.QUERYSTRING.queryParams.ck),SWY.QUERYSTRING.queryParams.ch&&(c.hash=SWY.QUERYSTRING.queryParams.ch),SWY.QUERYSTRING.queryParams.cmpid&&
(c.plainText=SWY.QUERYSTRING.queryParams.cmpid),b=JSON.stringify(c),AB.INSTANTALLOCATION._decryptionApiInit(b))};this._decryptionApiInit=function(b){console.log("Decryption called:::::"+b);var c=AB.ucaDecryptionApiHttpOptions,d=AB.profileTokenDecryptionService;$("#delivery-address-busy-loading").show().removeClass("mask");$("#pickup-store-busy-loading").show().removeClass("mask");$.ajax({type:"POST",url:d,headers:c,data:b,dataType:"json",success:function(b,c,d){b=AB.INSTANTALLOCATION._getStoreEnrolmentData(b);
console.log("Store enrollment data:::::"+b.uuid+"storeEnrolmentData.storeID:::"+b.storeId+"userStoreData.guid::::"+b.guid+"storeEnrolmentData.phoneNumber::::"+b.phoneNumber);AB.INSTANTALLOCATION._offerEligibility(b)},error:function(b){console.error("Decryption API Failed::"+b)}})};this._getStoreEnrolmentData=function(b){var c={};if(b&&b.encryptedProfileResponse&&b.encryptedProfileResponse.accountStatuses)for(store in b.encryptedProfileResponse.accountStatuses)"STORE_ENROLLMENT"===b.encryptedProfileResponse.accountStatuses[store].type&&
(b.encryptedProfileResponse.accountStatuses[store].source&&b.encryptedProfileResponse.accountStatuses[store].source.storeId&&(c.storeId=b.encryptedProfileResponse.accountStatuses[store].source.storeId),b.encryptedProfileResponse.phones&&0<b.encryptedProfileResponse.phones.length&&b.encryptedProfileResponse.phones[0].number&&(c.phoneNumber=b.encryptedProfileResponse.phones[0].number),b.encryptedProfileResponse.alternateIds&&0<b.encryptedProfileResponse.alternateIds.length&&"GUID"===b.encryptedProfileResponse.alternateIds[0].type&&
(c.guid=b.encryptedProfileResponse.alternateIds[0].value),b.header&&b.header.aggregateId&&(c.uuid=b.header.aggregateId));return c};this._offerEligibility=function(b){var c="";if(b&&b.storeId){var d=(new Date(new Date)).toISOString();c=b.storeId;console.log("Offer Eligibility called:::::"+b);var e=AB.j4UEligibilityOfferOption;c=AB.eligibleOfferDetailxAPIPath+"?eventDateTime\x3d"+encodeURIComponent(d)+"\x26eventSource\x3dweb\x26storeId\x3d"+c;$.ajax({type:"GET",url:c,headers:e,dataType:"json",success:function(c,
d,e){c.eventEligibilityDetails.eligible&&($(".instant-allocation-banner-container").removeClass("mask"),AB.INSTANTALLOCATION._updateCreateAccountFields(b),0<c.eventOfferInfos.length&&c.eventOfferInfos[0]&&c.eventOfferInfos[0].offerId&&$(".offer-detail-text").attr("href","/justforu/offer-details."+c.eventOfferInfos[0].offerId+".html"),AB.INSTANTALLOCATION._updateEcomRedirectCookie(JSON.stringify(c)))},error:function(b){console.error("Offer eligibility API failed::"+b)}})}};this._updateCreateAccountFields=
function(b){var c=document.getElementById("input-clubCardNumber");if(b){var d={info:{COMMON:{},J4U:{}}};c.value=b.phoneNumber;$("#input-clubCardNumber").blur();$("#input-clubCardNumber").attr("readonly","readonly");AB.userInfo.j4u.storeId=b.storeId;d.info.J4U.storeId=b.storeId;d.info.COMMON.preference="J4U";AB.COMMON.updateUserSession(d);$("#unifiedRegistration").append('\x3cinput type\x3d"hidden" name\x3d"GUID" id\x3d"GUID"  value\x3d"" /\x3e');$("#unifiedRegistration").append('\x3cinput type\x3d"hidden" name\x3d"UUID" id\x3d"UUID" value\x3d"" /\x3e');
c=document.getElementById("GUID");d=document.getElementById("UUID");c.value=b.guid;d.value=b.uuid}};this._updateEcomRedirectCookie=function(b){b=JSON.parse(b);var c="";b&&(b.eventEligibilityDetails&&b.eventEligibilityDetails.eventName&&(c+="eventName\x3d"+b.eventEligibilityDetails.eventName+"\x26",AB.INSTANTALLOCATION.isEligibleForOffer=!0),b.eventEligibilityDetails&&b.eventEligibilityDetails.storeInfo.regionId&&(c+="division\x3d"+b.eventEligibilityDetails.storeInfo.regionId+"\x26"),b.eventOfferInfos&&
0<b.eventOfferInfos.length&&b.eventOfferInfos[0].offerId&&(c+="offerId\x3d"+b.eventOfferInfos[0].offerId+"\x26"),b.eventOfferInfos&&0<b.eventOfferInfos.length&&b.eventOfferInfos[0].externalOfferId&&(c+="externalOfferId\x3d"+b.eventOfferInfos[0].externalOfferId+"\x26"),b.eventEligibilityDetails&&b.eventEligibilityDetails.storeInfo&&b.eventEligibilityDetails.storeInfo.storeId&&(c+="storeId\x3d"+b.eventEligibilityDetails.storeInfo.storeId));b=encodeURIComponent("/justforu/coupons-deals.html?"+c);AB.COMMON.setCookie("ECommRedirectURL",
b,0)}}).call(AB.INSTANTALLOCATION);AB=AB||{};AB.PAYEEZY={};
(function(){this.tid="";this.init=function(){if(0<$(".uca-payeezy-payment-wrapper").length){var c=b();$(".delivery-subscription-banner").trigger("completed-wcma-call",[c])}};var b=function(){var b=AB.payeezyHttpOptions;$(".card-available").addClass("mask");$(".payment-page-title").addClass("mask");$(".payeezy-loader").addClass("mask");return $.ajax({type:"GET",headers:b,dataType:"json",url:AB.COMMON.ucaAPIPathWithCustomerId(AB.creditCardInfoPath),success:function(b,c,f){$(".card-available").removeClass("mask");
$(".payment-page-title").removeClass("mask");$(".payeezy-loader").removeClass("mask");b=JSON.stringify(b);if((b=JSON.parse(b))&&b.tenders&&0<b.tenders.length)for(c=0;c<b.tenders.length;c++)"shop"===b.tenders[c].primaryPurpose.toLowerCase()?(f=b.tenders[c].maskedNumber.substring(b.tenders[c].maskedNumber.length-4),AB.PAYEEZY.tidShopCard=b.tenders[c].id,$("#cardHolder-name").text(b.tenders[c].holderName),$("#card-type").text(b.tenders[c].cardType),$("#card-ending-in").text(f),$(".card-unavailable-row").addClass("mask"),
$(".card-available-row").removeClass("mask"),$(".card-available").removeClass("mask")):"delivery_subscription"===b.tenders[c].primaryPurpose.toLowerCase()&&(f=b.tenders[c].maskedNumber.substring(b.tenders[c].maskedNumber.length-4),AB.PAYEEZY.tidDSCard=b.tenders[c].id,AB.PAYEEZY.cardHolderName=b.tenders[c].holderName,AB.PAYEEZY.cCardType=b.tenders[c].cardType,AB.PAYEEZY.ccToken=b.tenders[c].token,AB.PAYEEZY.cardExpirationDate=b.tenders[c].expiryDate.replace("/",""),AB.PAYEEZY.cardZipcode=b.tenders[c].postalCode,
AB.PAYEEZY.id=b.tenders[c].id,$("#dscardHolder-name").text(AB.PAYEEZY.cardHolderName),$("#dscard-type").text(AB.PAYEEZY.cCardType),$("#dscard-ending-in").text(f),$(".dscard-available-row").removeClass("mask"),$(".dsCreditcard-available").removeClass("mask"),$(".dscard-unavailable-row").addClass("mask"),$(".cvv-row").removeClass("mask"),$(".terms-condition-submit-section").removeClass("mask"),$(".update-button").removeClass("mask"),AB.userInfo.customerId&&AB.UCASUBSCRIPTIONSERVICES._subscriptionCardStatus(AB.userInfo.customerId));
else $(".card-unavailable-row").removeClass("mask"),$(".dscard-unavailable-row").removeClass("mask")},error:function(b,c,f){$("#server-error-message").removeClass("mask");$(".card-available").addClass("mask");$(".payment-page-title").addClass("mask")}})};this.generateIframe=function(b,d){$("#loaderSignIn").removeClass("mask");$("#signInLoadingEmpty").addClass("mask");var c=AB.userInfo.SWY_SHOP_TOKEN,f=AB.userInfo.customerId,g=Math.floor(1E3+9E3*Math.random()),h=AB.PAYEEZY.tidShopCard,l=AB.PAYEEZY.tidDSCard,
k=SWY.CONFIGSERVICE.DSConfig.dsPaymentmethodDomain+"/api/v1/payment/";"ACC_SHOP"===b&&"add"===d?AB.PAYEEZY.showIframe(k+f+g+"/"+f+"?module\x3d"+b+"\x26oktaToken\x3d"+c):"ACC_SHOP"===b&&"update"===d?AB.PAYEEZY.showIframe(k+f+g+"/"+f+"/"+h+"?module\x3d"+b+"\x26oktaToken\x3d"+c):"DELIVERY_SUBSCRIPTION"===b&&"add"===d?AB.PAYEEZY.showDSIframe(k+f+g+"/"+f+"?module\x3d"+b+"\x26oktaToken\x3d"+c):"DELIVERY_SUBSCRIPTION"===b&&"update"===d?AB.PAYEEZY.showDSIframe(k+f+g+"/"+f+"/"+l+"?module\x3d"+b+"\x26oktaToken\x3d"+
c):console.error("Error Occured")};this.showIframe=function(b){document.querySelector("#frame").setAttribute("src",b);$("#frame").on("load",function(){$("#loaderiFrame").addClass("mask");$("#iFrameLoadingEmpty").removeClass("mask");AB.PAYEEZY.iframeLoaded()});$("#frame").removeClass("mask");$(".card-available-row").addClass("mask");$(".card-unavailable-row").addClass("mask")};this.showDSIframe=function(b){document.querySelector("#frameDS").setAttribute("src",b);$("#frameDS").on("load",function(){$("#loaderiFrameds").addClass("mask");
$("#iFrameLoadingEmptyds").removeClass("mask");AB.PAYEEZY.iframeLoaded()});$("#frameDS").removeClass("mask");$(".dscard-unavailable-row").addClass("mask");$(".dscard-available-row").addClass("mask");$(".cvv-row").addClass("mask");$(".terms-condition-submit-section").addClass("mask")};$("#cvv-form").validator().on("submit",function(b){if(!b.isDefaultPrevented()){b=AB.deliverySubJavaHttpOptions;var c={createdBy:AB.PAYEEZY.cardHolderName,creditCardInfo:{ccToken:AB.PAYEEZY.ccToken,cvv:$("#cvv-inputField").val(),
expDate:AB.PAYEEZY.cardExpirationDate,fullName:AB.PAYEEZY.cardHolderName,type:AB.PAYEEZY.cCardType,zip:AB.PAYEEZY.cardZipcode,tenderId:AB.PAYEEZY.id},gid:AB.userInfo.customerId};$("#loaderButtonUpdateCVV").removeClass("mask");$("#cvv-payment-subscription-error").html("");$.ajax({type:"POST",headers:b,url:SWY.CONFIGSERVICE.DSConfig.dsJavaBasePath+SWY.CONFIGSERVICE.DSConfig.dsJavaSubscriptionReinstate.replace("{gid}",AB.userInfo.customerId),data:JSON.stringify(c),success:function(b,c,d){$("#loaderButtonUpdateCVV").addClass("mask");
$("#dsCardSuspended").addClass("mask");AB.COMMON.userNotify("Your Subscription payment information has been updated successfully.")},error:function(b,c,d){AB.PAYEEZY.defaultError(b);AB.UCASUBSCRIPTIONSERVICES._errorHandling(b.status,"cvv-payment-subscription-error",b.responseJSON);$("#loaderButtonUpdateCVV").addClass("mask")}})}return!1});this.defaultError=function(b){!b||403!==b.status&&401!==b.status||SWY.ENFORCEMENT.singleSignOnUser(window.location.href)};this.iframeLoaded=function(){var b=document.getElementById("frame"),
d=document.getElementById("frameDS"),e=window.innerWidth;if(b||d)b.height="",d.height="",991<=e?(b.height=b.scrollHeight+350+"px",d.height=d.scrollHeight+350+"px"):768<=e&&991>e?(b.height=b.scrollHeight+500+"px",d.height=d.scrollHeight+500+"px"):767>=e&&420<e?(b.height=b.scrollHeight+550+"px",d.height=d.scrollHeight+550+"px"):420>=e?(b.height=b.scrollHeight+550+"px",d.height=d.scrollHeight+550+"px"):(b.height=b.scrollHeight+350+"px",d.height=d.scrollHeight+350+"px")}}).call(AB.PAYEEZY);
window.addEventListener("resize",AB.PAYEEZY.iframeLoaded);var eventMethod=window.addEventListener?"addEventListener":"attachEvent",receiveMessage=window[eventMethod],paymentiFrame=document.getElementById("frame"),subscriptioniFrame=document.getElementById("frameDS"),isIframePresent=!0,paymentiFrameDoc,subscriptionFrameDoc,messageEvent;
$("#frame").ready(function(){paymentiFrame=document.getElementById("frame");null!=paymentiFrame&&(0<paymentiFrame.length&&(paymentiFrameDoc=paymentiFrame.contentWindow||paymentiFrame.contentDocument,receiveMessage.source!==paymentiFrameDoc&&(isIframePresent=!1)),messageEvent="attachEvent"===eventMethod?"onmessage":"message",!0===isIframePresent&&receiveMessage(messageEvent,function(b){String.prototype.includes||(String.prototype.includes=function(b,d){if(b instanceof RegExp)throw TypeError("first argument must not be a RegExp");
void 0===d&&(d=0);return-1!==this.indexOf(b,d)});if("https://token-qa1.albertsons.com https://token-qa2.albertsons.com https://token-qa3.albertsons.com https://token-acceptance.albertsons.com https://token-perf.albertsons.com https://token-stage.albertsons.com https://token-prod.albertsons.com https://token.albertsons.com".split(" ").includes(b.origin)&&"string"===typeof b.data)switch(b.data){case "cancel":"frame"===b.currentTarget.document.activeElement.id&&($("#frame").addClass("mask"),$(".card-unavailable-row").removeClass("mask"));
break;case "cancelChange":"frame"===b.currentTarget.document.activeElement.id&&($("#frame").addClass("mask"),$(".card-available-row").removeClass("mask"));break;case "success":window.location.reload()}console.log("Message from iFrame:",b.data)},!1))});
$("#frameDS").ready(function(){subscriptioniFrame=document.getElementById("frameDS");null!=subscriptioniFrame&&(0<subscriptioniFrame.length&&(subscriptionFrameDoc=subscriptionFrameDoc.contentWindow||subscriptionFrameDoc.contentDocument,receiveMessage.source!==subscriptionFrameDoc&&(isIframePresent=!1)),messageEvent="attachEvent"===eventMethod?"onmessage":"message",!0===isIframePresent&&receiveMessage(messageEvent,function(b){String.prototype.includes||(String.prototype.includes=function(b,d){if(b instanceof
RegExp)throw TypeError("first argument must not be a RegExp");void 0===d&&(d=0);return-1!==this.indexOf(b,d)});if("https://token-qa1.albertsons.com https://token-qa2.albertsons.com https://token-qa3.albertsons.com https://token-acceptance.albertsons.com https://token-perf.albertsons.com https://token-stage.albertsons.com https://token-prod.albertsons.com https://token.albertsons.com".split(" ").includes(b.origin)&&"string"===typeof b.data)switch(b.data){case "cancel":"frameDS"===b.currentTarget.document.activeElement.id&&
($("#frameDS").addClass("mask"),$(".dscard-unavailable-row").removeClass("mask"));break;case "cancelChange":"frameDS"===b.currentTarget.document.activeElement.id&&($("#frameDS").addClass("mask"),$(".dscard-available-row").removeClass("mask"),$(".cvv-row").removeClass("mask"),$(".terms-condition-submit-section").removeClass("mask"));break;case "success":window.location.reload()}console.log("Message from iFrame:",b.data)},!1))});AB.COMMON.siteUCAPreInit=function(){};
AB.COMMON.doUCAInit=function(){AB.UCASERVICES.init();AB.UCACURRENTORDER.init();AB.UCAREWARDS.init();AB.COMMUNICATIONPREF_V2.init();AB.COMMUNICATIONPREF.init();AB.GETPROFILE.init();AB.UCAFULFILLMENTPREFERENCE.init();AB.UCAUPDATEDELIVERYADDRESS.init();AB.UCAADDRESSPREFERENCE.init();AB.UCASUBSCRIPTIONSERVICES.init();AB.INSTANTALLOCATION.init();AB.PAYEEZY.init()};