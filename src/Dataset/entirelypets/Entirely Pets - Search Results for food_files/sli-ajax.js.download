if(/#/.test(window.location)&&!/#\/search/.test(window.location)){if(/\?/.test(window.location)){if(/\?#/.test(window.location.href)||/#\?/.test(window.location.href)){window.location=window.location.href.replace("#","").replace(/&ts=[^&]+/,"")}else{if(/\?.*#/.test(window.location.href)){window.location=window.location.href.replace("#","&").replace(/&ts=[^&]+/,"")}}}else{window.location=window.location.href.replace("#","?").replace(/&ts=[^&]+/,"")}}(function(window,document){window.SLI=window.SLI||{};var TEMPLATE_ID_REGEX=/([&\?]ts=)[^&;"']+/g;
var PID_REPLACE_REGEX=/(<[^>]+)data-tb-pid=""/;SLI.replaceParamInUrl=function(url,param,value){var separator=url.indexOf("?")==-1?"?":"&";var paramBit=separator+param+"=";var hasValue=!!value;var newHref=hasValue?url+paramBit+value:url;var pos=SLI.paramPosition(url,param);if(pos.start){newHref=url.substring(0,pos.start-(hasValue?0:paramBit.length))+value;if(pos.end){newHref+=url.substring(pos.end)}}return newHref};SLI.backToTop=function(){SLI.jQuery.scrollTo(0,800)};SLI.setTitle=function(title){document.title=title
};SLI.load=function(content,selector,backtotop){var searchId=SLI.config.search.templateId||"custom";content=(content||"").replace(TEMPLATE_ID_REGEX,"$1"+searchId);var $el=SLI.jQuery(selector);$el.toggle(content.length>0).html(content);if(backtotop){SLI.jQuery(selector).find(backtotop).off();SLI.jQuery(selector).find(backtotop).on("click",SLI.backToTop)}return SLI};function RefinementControl(options){if(!options){throw new Error("Need to pass options")}var url=window.location.href||"";this._baseUrl=url;if(typeof SLI.config.ajax.enabled==="undefined"){SLI.config.ajax.enabled=true
}var state=this.extractState(url);this._url=state.url;this._modified={};this.$spinner=options.spinner||SLI.jQuery('<div class="sli_ajax_spinner"></div>');this.products='[data-tb-sid="st_results-ajax"],[data-sli-selector="products-container"],[data-tb-spinner="true"]';history.replaceState(state,document.title,document.location.href)}RefinementControl.prototype={extractState:function(queryString){var state={};state.url=queryString;return state},currentState:function(){return{url:this._url}},getCurrentPage:function(){return this._url
},setCurrentPage:function(url){if(this._url==url){return}this._url=url;this._modified.url=true},resetQuery:function(keyword,action,params){var url=this.getCurrentPage();var view=SLI.paramFromUrl(url,"view");var searchString="?w="+keyword;if(view!==""){searchString+="&view="+view}var newUrl=action+searchString;if(params){newUrl=newUrl+params}if(typeof SLI.alterSearchUrl==="function"){newUrl=SLI.alterSearchUrl(newUrl)}this.setCurrentPage(newUrl);this.pageRefresh(this.currentState(),false,newUrl)},setPageRefresh:function(url){this.setCurrentPage(url);
this.pageRefresh(this.currentState(),false,url)},pageRefresh:function(state,back,ajaxUrl){if(this._xhr){this._xhr.abort()}if(!ajaxUrl){ajaxUrl=state.url}var templateId=SLI.config.search.templateId||"custom",ajaxId=SLI.config.ajax.templateId||"ajax",racId=SLI.config.rac?(SLI.config.rac.templateId||"rac"):null,url;if(ajaxUrl.indexOf("ts="+racId)!==-1){var friendlyUrl=SLI.paramFromUrl(ajaxUrl,"url");friendlyUrl=decodeURIComponent(friendlyUrl);friendlyUrl=friendlyUrl.replace("&tsv=ajax","");url=ajaxUrl;ajaxUrl=friendlyUrl;
this.setCurrentPage(ajaxUrl)}else{var separator=ajaxUrl.indexOf("?")==-1?"?":"&";url=ajaxUrl+separator+"tsv=ajax"}var this_R=this;var $blank=SLI.jQuery('<div class="sli_spin_wrapper"></div>').append(this.$spinner);SLI.jQuery(this.products).html($blank);this._xhr=SLI.jQuery.ajax({url:url,method:"GET",dataType:"text",cache:true,ifModified:true}).done(function(data){data=data.replace(TEMPLATE_ID_REGEX,"$1"+templateId);var parsedData;try{parsedData=JSON.parse(data)}catch(err){window.console&&console.log(err);window.location=SLI.replaceParamInUrl(SLI.replaceParamInUrl(url,"tsv",""),"ts",templateId);
return}if(window.location.href.indexOf("sli_jump=1")===-1&&parsedData.jumpurl){window.location=parsedData.jumpurl;return}var parentChildOrder=parsedData.childorder;var parentChildOrderKeys=Object.keys(parentChildOrder);if(parentChildOrderKeys.length<2){var failover=true;if(parentChildOrder.length===1&&parentChildOrderKeys[0]!==""){failover=false}if(failover){window.console&&console.log("No child order in ajax response");window.location=SLI.replaceParamInUrl(SLI.replaceParamInUrl(url,"ts",templateId),"tsv","");
return}}if(!back&&history&&history.pushState){history.pushState(state,null,ajaxUrl)}parsedData.components.forEach(function(component){if(!component.name){return}var existingSelector='[data-tb-cid="'+component.id+'"][data-tb-pid="'+component.pid+'"]';var setPid=component.content.replace(PID_REPLACE_REGEX,'$1data-tb-pid="'+component.pid+'"');if(component.id&&SLI.jQuery(existingSelector).length>0){SLI.jQuery(existingSelector).remove()}if(component.target==="outer"){parentChildOrder[component.parent.id][component.pid]={type:"OUTER",content:setPid};
return}var parentSelector='[data-tb-cid="'+component.parent.id+'"][data-tb-sid="'+component.parent.element+'"],[data-tb-cid="'+component.parent.id+'"] [data-tb-sid="'+component.parent.element+'"]';var insertSelector=component.query;var targetNode=SLI.jQuery(parentSelector).find(insertSelector).first();var parentNode=SLI.jQuery(parentSelector);if(component.target==="append"){if(component.query.length===0){parentChildOrder[component.parent.id][component.pid]={type:"APPEND",target:parentNode,content:setPid}}else{parentChildOrder[component.parent.id][component.pid]={type:"APPEND",target:targetNode,content:setPid}
}return}if(component.target==="prepend"){if(component.query.length===0){parentChildOrder[component.parent.id][component.pid]={type:"PREPEND",target:parentNode,content:setPid}}else{parentChildOrder[component.parent.id][component.pid]={type:"PREPEND",target:targetNode,content:setPid}}return}if(!targetNode||targetNode.length===0){return}if(component.target==="inner"){parentChildOrder[component.parent.id][component.pid]={type:"INNER",target:targetNode,content:setPid}}if(component.target==="after"){parentChildOrder[component.parent.id][component.pid]={type:"AFTER",target:targetNode,content:setPid}
}if(component.target==="before"){parentChildOrder[component.parent.id][component.pid]={type:"BEFORE",target:targetNode,content:setPid}}});var outerComments=getOuterComments();var untouch=[];SLI.jQuery.each(parentChildOrder,function(index,parent){if(parent.length==0){return}SLI.jQuery.each(parent,function(index,placement){if(placement.type){switch(placement.type){case"OUTER":var commentNode=outerComments[index];if(commentNode){SLI.jQuery(commentNode).after(placement.content)}break;case"APPEND":SLI.jQuery(placement.target).append(placement.content);
break;case"PREPEND":SLI.jQuery(placement.target).prepend(placement.content);break;case"AFTER":var afterNode=SLI.jQuery(placement.target).nextAll("[data-tb-pid]").last();if(afterNode.length===0){SLI.jQuery(placement.target).after(placement.content);break}SLI.jQuery(afterNode).after(placement.content);break;case"BEFORE":var beforeNode=SLI.jQuery(placement.target).prevAll("[data-tb-pid]").first();if(beforeNode.length===0){SLI.jQuery(placement.target).before(placement.content);break}SLI.jQuery(beforeNode).after(placement.content);
break;case"INNER":var touched=SLI.jQuery(placement.target).data("touched");if(touched){SLI.jQuery(placement.target).append(placement.content)}else{SLI.jQuery(placement.target).html(placement.content);SLI.jQuery(placement.target).data("touched",true);untouch.push(SLI.jQuery(placement.target))}break}}})});SLI.jQuery.each(untouch,function(index,elem){elem.data("touched",false)});SLI.jQuery(document).trigger({type:"sli-ajax-complete",message:"ajax-completed",ajaxData:parsedData.javascript,time:new Date()});this_R._modified={}
}).fail(function(jqXHR,textStatus){if(textStatus!=="abort"){window.location=ajaxUrl}})},rebuildState:function(state){this._url=state.url;this._modified={url:true};this.pageRefresh(state,true)}};function IEVersion(){var myNav=navigator.userAgent.toLowerCase();return(myNav.indexOf("msie")!=-1)?parseInt(myNav.split("msie")[1]):false}SLI.RefinementControl=RefinementControl;var CLICK="click",CHANGE="change",SUBMIT="submit";var r;SLI.jQuery(function(){var IE_VERSION=IEVersion();if(IE_VERSION&&IE_VERSION<10){SLI.config.ajax.enabled=false
}else{r=SLI.controller=new SLI.RefinementControl({products:SLI.jQuery(SLI.config.ajax.productsDiv)})}function checkDomain(newHref){var searchRegex=/^([^\?]+)/,lnRegex=window.location.protocol+"//"+window.location.host+SLI.config.ajax.lnpath,lnRegexSearch=window.location.protocol+"//"+window.location.host+"/search",ajaxUrl=false,queryParams=[],currentQueryParams=[],currentQueryStr=window.location.search,currentQueryArr=currentQueryStr.replace("?","").split("&"),queryChanged=false,locationMatch;if(SLI.config.ajax.ln){if(newHref.indexOf(lnRegex)!==-1){return true
}else{if(newHref.indexOf(lnRegexSearch)!==-1){return true}else{return false}}}else{if(locationMatch=searchRegex.exec(newHref)){var domainCheck=window.location.protocol+"//"+window.location.host+window.location.pathname;if(locationMatch[1]===domainCheck){return true}else{return false}}else{return false}}}function fireAjax(url,element){var queryType=SLI.paramFromUrl(url,"p");var racClick=SLI.paramFromUrl(url,"rt");if(queryType!=="R"){r.setPageRefresh(url);return true}else{if(racClick!=="racclick"&&racClick!==""){r.setPageRefresh(url);
return true}else{return false}}}function submitForm(ajaxUrl,action,form){var racElementSelected=false;if(SLI.jQuery("#sli_autocomplete li ul li").hasClass("sli_ac_active")){racElementSelected=true}if(!racElementSelected){var params="";if(SLI.config.search.templateId!=="custom"){params+="&ts="+SLI.config.search.templateId}var keyword=encodeURIComponent(form.w.value);if(keyword===""){}else{if(!ajaxUrl||!SLI.config.ajax.enabled){var searchUrl=action+"?w="+keyword+params;if(typeof SLI.alterSearchUrl==="function"){searchUrl=SLI.alterSearchUrl(searchUrl)
}window.location=searchUrl}else{r.resetQuery(keyword,action,params)}}}}SLI.ajaxFormSubmit=function(form){var ajaxUrl=checkDomain(form.action);SLI.jQuery(form.w).blur();submitForm(ajaxUrl,form.action,form);return false};SLI.ajaxSearchSubmit=function(url){if(SLI.config.ajax.enabled){var ajaxUrl=checkDomain(url);if(!ajaxUrl){window.location=url}else{if(!fireAjax(url,this)){window.location=url}}}else{window.location=url}};if(SLI.config.ajax.enabled){window.onpopstate=function(event){if(!event.state){return}r.rebuildState(event.state)
};SLI.jQuery("body").on(CLICK,'a:not([href*="?p=R"]):not([href*="&p=R"]), .sli_ac_suggestions a',function(e,options){options=options||{};if(!options.continue_normal){var ajaxUrl=checkDomain(this.getAttribute("href"));if(!ajaxUrl){return true}else{if(!fireAjax(this.getAttribute("href"),this)){return true}else{return false}}}else{return true}})}});function getOuterComments(){var arr=[];SLI.jQuery("*:not(iframe)").contents().filter(function(){if(this.nodeType==8&&this.nodeValue.indexOf("tb-")===0){var value=this.nodeValue.trim();
if(value.length<4){return false}arr[value.substring(3)]=this;return true}return false});return arr}SLI.jQuery.extend({sliAnimateOutCustom:undefined})})(window,document);function sli_setTitle(title){SLI.setTitle(title)}function sli_loadContent(content,location,scrollToTop){SLI.load(content,location,scrollToTop)};