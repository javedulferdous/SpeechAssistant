function RecentSearches(theSearchURL){var default_cookieName="_slirecent";var default_daystolive=180;var default_cookiePath="path=/";var default_cookieDomain="";var default_maxSearchTermLength=200;var default_URLsetter="?";var invalid_search_terms=new Array("*");var valid_search_term;var maxSearchTermLength=default_maxSearchTermLength;var __SLI_cookieName=default_cookieName;var cookiePath=default_cookiePath;var cookieDomain=default_cookieDomain;var urlSetter=default_URLsetter;var expirydate;var existingSearches=new Array();
this.getListRecentSearches=function(){getCurrentCookieData();var searchURL=theSearchURL+urlSetter+"p=Q&rs=1&rstotal="+existingSearches.length+"&w=";var locationInList;if(existingSearches!=null){var recentDiv="<h3 class='sli_facet_heading'>Recent Searches:</h3><div id='sli_recentsearchlist'>\n";recentDiv+="<ul id='sli_recentsearchterms'>\n";for(var i=existingSearches.length-1;i>=0;i--){locationInList=(i-existingSearches.length)*-1;var value=decodeURIComponent(existingSearches[i]);var reg=new RegExp(/[^\^]+/i);
var keyword=reg.exec(value);var areg=new RegExp(/\^([0-9|-]+)/i);var date=value.match(areg);var searchdate=date[1];var link='<a href="'+searchURL+keyword+"&rsdate="+searchdate+"&rsloc="+locationInList+'">';recentDiv+="<li class='recentkeyword'>\n"+link+keyword+"</a>\n</li>\n"}recentDiv+="</ul>\n<span id='sli_clearrecent'><a href='javascript:rs.deleteExistingSearches()'>Clear List</a></span></div>";return recentDiv}};this.deleteExistingSearches=function(){if(deleteCookie()==1){document.getElementById("sli_recentsearchlist").style.display="none";
existingSearches=""}};this.addSearchTerm=function(theKeyword){if(isValidSearchTerm(theKeyword)==false){return""}else{addSearchTermToExisitngSearches();calcualteExpiryDate();writeToCookie()}};this.setDomain=function(theDomain){if(theDomain&&(trim(theDomain)!="")){cookieDomain=theDomain}else{cookieDomain=default_cookieDomain}};this.getDomain=function(){return cookieDomain};this.setAjaxSearch=function(){urlSetter="#"};function isValidSearchTerm(theSearchTerm){theSearchTerm=checkSearchLength(trim(theSearchTerm));
var encodedSearchTerm=encodeURIComponent(theSearchTerm);if(encodedSearchTerm==""){return false}for(var i=0;i<invalid_search_terms.length;i++){if(encodedSearchTerm==invalid_search_terms[i]){return false}}valid_search_term=encodedSearchTerm;return true}function checkSearchLength(searchTerm){if(searchTerm.length>maxSearchTermLength){searchTerm=searchTerm.substr(0,maxSearchTermLength)}return searchTerm}function isTermAlreadyInList(){var returnValue=0;if(valid_search_term!=""){for(var i=0;i<existingSearches.length;
i++){var testValue=existingSearches[i];testValue=testValue.replace(/\^.*/g,"");if((testValue.toLowerCase())==(valid_search_term.toLowerCase())){existingSearches.splice(i,1);return true}}}return false}function todaysDate(){var today=new Date();var day=today.getDate();var month=today.getMonth()+1;var year=today.getFullYear();if(day<10){day="0"+day}if(month<10){month="0"+month}var date=year+"-"+month+"-"+day;return date}function addSearchTermToExisitngSearches(){var updatedlist;var theDate=todaysDate();getCurrentCookieData();
if(existingSearches==null||existingSearches.length==0){existingSearches=new Array()}else{isTermAlreadyInList();if(existingSearches.length==10){existingSearches.shift()}}existingSearches.push(valid_search_term+"^"+theDate)}function trim(stringToTrim){return stringToTrim.replace(/^\s+|\s+$/g,"")}function calcualteExpiryDate(daystolive){var myDate=new Date();var valid_daystolive;if(daystolive==undefined){valid_daystolive=default_daystolive}else{try{if(isInt(daystolive)==false){throw ("date1")}else{valid_daystolive=daystolive
}}catch(err){if(err=="date1"){valid_daystolive=default_daystolive}else{}}}try{myDate.setDate(myDate.getDate()+valid_daystolive)}catch(err){myDate.getDate()}myDate=myDate.toGMTString();expirydate=myDate}function isInt(value){if(trim(value)!=""){return(value%1)==0}else{return false}}function getCurrentCookieData(){var cookieSearchTerms=readCookie(__SLI_cookieName);try{if(cookieSearchTerms==null||cookieSearchTerms==""){throw ("errRead1")}else{var cookieSearchTermArray=cookieSearchTerms.split(",");existingSearches=cookieSearchTermArray;
return cookieSearchTermArray}}catch(err){if(err=="errRead1"){return null}else{return null}}}function readCookie(name){var nameEQ=name+"=";var ca=document.cookie.split(";");for(var i=0;i<ca.length;i++){var c=ca[i];while(c.charAt(0)==" "){c=c.substring(1,c.length)}if(c.indexOf(nameEQ)==0){return c.substring(nameEQ.length,c.length)}}return null}function deleteCookie(){var cookieString=__SLI_cookieName+"=;-1;domain="+cookieDomain;return updateCookie(cookieString)}function writeToCookie(){var cookieString=__SLI_cookieName+"="+existingSearches+"; expires="+expirydate+"; "+cookiePath+"; domain="+cookieDomain;
updateCookie(cookieString)}function updateCookie(cookieString){try{document.cookie=cookieString;return 1}catch(err){return 0}}};