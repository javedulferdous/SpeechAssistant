"use strict";define(["debounce","viewport","columboConstants"],function(e,t,n){var r;return function r(){var a={},i={constants:{DEBOUNCE_TIMEOUT:500},parent_flag:"data-columbo-parent",selectors:{viewedElements:"[data-component-tracked-viewed]",clickedElements:"[data-component-tracked-clicked]",focusedElements:"[data-component-tracked-focused]",hoveredElements:"[data-component-tracked-hovered]",pageRoot:"page-container",textField:'input[type="text"]',breadCrumbsItem:".breadcrumbs_item",selectedOption:"option[selected]",productVariationsParent:".productVariations_dropdown"}},l=function e(){a.viewedElements=Array.from(document.querySelectorAll(a.config.selectors.viewedElements)),a.clickedElements=Array.from(document.querySelectorAll(a.config.selectors.clickedElements)),a.focusedElements=Array.from(document.querySelectorAll(a.config.selectors.focusedElements)),a.hoveredElements=Array.from(document.querySelectorAll(a.config.selectors.hoveredElements)),a.trackedElementsConfig=a.getTrackedElementsConfig()},o=function e(){return a.viewedElements.map(function(e){return a.getNewConfigObj(e)})},c=function t(n){n.forEach(function(t){var n;Array.from(document.querySelectorAll(t.trigger.className)).forEach(function(t){t.addEventListener("scroll",e(function(){return a.addTracking(a.focusCallback,a.blurCallback)},a.config.constants.DEBOUNCE_TIMEOUT)),t.addEventListener("resize",e(function(){return a.addTracking(a.focusCallback,a.blurCallback)},a.config.constants.DEBOUNCE_TIMEOUT))})})},u=function e(t,n){return n.filter(function(e){if(-1===t.indexOf(e))return e})},s=function e(){a.maybeNewViewedElements=Array.from(document.querySelectorAll(a.config.selectors.viewedElements));var t=a.getDiffElements(a.viewedElements,a.maybeNewViewedElements);0!==t.length&&(t.forEach(function(e){var t=a.getNewConfigObj(e);a.trackedElementsConfig.push(t),a.viewedElements.push(e)}),a.addTracking(a.focusCallback,a.blurCallback))},d=function e(t){return JSON.parse(JSON.stringify(t))},f=function e(t,n){var r=arguments.length>2&&void 0!==arguments[2]&&arguments[2];try{return r?Number(t.getAttribute(n)):t.getAttribute(n)}catch(e){return null}},m=function e(t){var n=t.querySelectorAll(a.config.selectors.textField)[0];if(n)return n.value?n.value:null;return null},g=function e(){var t="",n=document.getElementsByClassName(a.config.selectors.pageRoot)[0];if(n){var r=n.querySelectorAll(a.config.selectors.breadCrumbsItem),i=true,l=false,o=void 0;try{for(var c=r[Symbol.iterator](),u;!(i=(u=c.next()).done);i=true){var s=u.value;try{t+="/"+s.getElementsByTagName("a")[0].innerHTML}catch(e){t+="/"+s.innerHTML}}}catch(e){l=true,o=e}finally{try{!i&&c.return&&c.return()}finally{if(l)throw o}}}if(t.length>0)return t;return null},E=function e(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"img",r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"src",a=4,i=true,l=false,o=void 0;try{for(var c=t.querySelectorAll(n)[Symbol.iterator](),u;!(i=(u=c.next()).done);i=true){var s=u.value;if(s.getAttribute(r).length>a)return s.getAttribute(r)}}catch(e){l=true,o=e}finally{try{!i&&c.return&&c.return()}finally{if(l)throw o}}return null},v=function e(t){if(!a.isParentElement(t))return null;var n=a.getChildElementInfo(t,"a","href");if(n){if(!n.includes("//")||n.includes(window.location.host))return{link:n,is_external_link:false};return{link:n,is_external_link:true}}return null},y=function e(t){var n=t.querySelector(a.config.selectors.productVariationsParent);if(n){var r=n.querySelector(a.config.selectors.selectedOption),i=Array.from(t.getElementsByTagName("option")).slice();return{quantity:i.length,rank:i.indexOf(r)}}var l=Array.from(t.parentElement.getElementsByClassName(t.className)).slice();if(l.length>0)return{quantity:l.length,rank:l.indexOf(t)};return{quantity:0,rank:0}},k=function e(t){try{var n;if(Array.from(t.attributes).map(function(e){return e.name}).includes(i.parent_flag))return true}catch(e){return false}return false},p=function e(t){if(a.isParentElement(t)){var n={product_group_id:a.safeGetValue(t.querySelector("div[data-master-id]"),"data-master-id"),selected_variant_sku:a.safeGetValue(t.querySelector("div[data-child-id]"),"data-child-id")};return[a.removeNulls(Object.assign(n,a.getRankData(t)))]}return null},b=function e(t,n){return!t.includes(n["name"])},C=function e(t){var r=n.filterAtts,a=Array.from(t.attributes).filter(function(e){return b(r,e)}),i=[],l=true,o=false,c=void 0;try{for(var u=a[Symbol.iterator](),s;!(l=(s=u.next()).done);l=true){var d=s.value;i.push({name:d["name"],value:d["value"]})}}catch(e){o=true,c=e}finally{try{!l&&u.return&&u.return()}finally{if(o)throw c}}if(i.length>0)return i;return null},w=function e(t){for(var n in t)null!==t[n]&&void 0!==t[n]||delete t[n];return t},h=function e(t){var n=Object.assign({html_element:a.safeGetValue(t,"data-context"),widget_id:a.safeGetValue(t,"data-widget-id",true),list_path:a.getListPath(),items:a.getItems(t),text:a.getTextFieldData(t)},a.getLinkData(t));return[a.removeNulls(n)]},T=function e(t){return t.className.split(" ")[0]},N=function e(n){return a.removeNulls({subtype:a.getClassName(n),is_interaction:false,contents:a.getContents(n),attributes:a.getAttributes(n),viewport_width:Math.round(t.getMaxClientOrInnerWidth()),viewport_height:Math.round(t.getMaxClientOrInnerHeight()),from_viewport_top:Math.round(t.getFromViewportTop(n)),from_viewport_left:Math.round(t.getFromViewportLeft(n))})},D=function e(t,n,r){t.forEach(function(e){var t=a.getData(e);t.type="click",e.addEventListener("click",function(){return r(n,t)})})},O=function e(t,n){a.maybeNewClickedElements=Array.from(document.querySelectorAll(a.config.selectors.clickedElements));var r=a.getDiffElements(a.clickedElements,a.maybeNewClickedElements);0!==r.length&&(a.addElementClickedTracking(r,t,n),a.clickedElements=a.clickedElements.concat(r))},_=function e(t,n){a.findNewClickedTracking(t,n),a.addElementClickedTracking(a.clickedElements,t,n),window.setInterval(function(){a.findNewClickedTracking(t,n)},a.config.constants.DEBOUNCE_TIMEOUT)},A=function e(t){var n={};return n.element=t,n.isViewed=false,n.isFirstTimeSeen=true,n},S=function e(t){return t?window.getComputedStyle(t).getPropertyValue("display"):null},V=function e(t,n,r,a){t.isFirstTimeSeen=false,t.isViewed=true,t.isElementDisplayable=r,n.type="focus",a(n)},B=function e(t,n,r,a){t.isElementDisplayable=r,t.isViewed=false,n.type="blur",a(n)},I=function e(t){var n=a.getDisplayProperty(t),r=a.getDisplayProperty(t.parentNode),i,l;return""!==n&&"none"!==n&&(""!==r&&"none"!==r)},U=function e(t,n){var r=a.deepClone(t);return r.key+="Focus",r.publish.event+="-focus",function(e){n(r,e)}},q=function e(t,n){var r=a.deepClone(t);return r.key+="Blur",r.publish.event+="-blur",function(e){n(r,e)}},x=function e(n,r){a.trackedElementsConfig.forEach(function(e){var i=e.element,l=a.isElementDisplayable(i),o=a.getData(i);if(e.isElementDisplayable&&!l&&a.sendBlurEvent(e,o,l,r),l){var c=t.isElementVisible(i);c&&!e.isViewed&&a.sendFocusEvent(e,o,l,n),c||!e.isViewed||e.isFirstTimeSeen||a.sendBlurEvent(e,o,l,r)}})},L=function t(n,r){a.focusCallback=a.getFocusCallback(n,r),a.blurCallback=a.getBlurCallback(n,r),"complete"===document.readyState?a.addTracking(a.focusCallback,a.blurCallback):window.addEventListener("load",function(){return a.addTracking(a.focusCallback,a.blurCallback)}),window.addEventListener("scroll",e(function(){return a.addTracking(a.focusCallback,a.blurCallback)},a.config.constants.DEBOUNCE_TIMEOUT)),window.addEventListener("resize",e(function(){return a.addTracking(a.focusCallback,a.blurCallback)},a.config.constants.DEBOUNCE_TIMEOUT)),window.setInterval(a.updateViewedConfig,a.config.constants.DEBOUNCE_TIMEOUT)},M=function e(t,n){a.focusedElements.map(function(e){var r=a.getData(e),i=a.getData(e);r.type="input-focus",i.type="input-blur",e.addEventListener("focus",function(){return n(t,r)}),e.addEventListener("blur",function(){return n(t,i)})})},F=function t(n,r){a.hoveredElements.map(function(t){var i=a.getData(t),l=a.getData(t);i.type="mouseenter",l.type="mouseleave",t.addEventListener("mouseenter",e(function(){return r(n,i)},a.config.constants.DEBOUNCE_TIMEOUT)),t.addEventListener("mouseleave",e(function(){return r(n,l)},a.config.constants.DEBOUNCE_TIMEOUT))})};return a.init=l,a.config=i,a.addElementClickedTracking=D,a.addTracking=x,a.createCustomDivSpies=c,a.elementViewed=L,a.elementClicked=_,a.elementFocused=M,a.elementHovered=F,a.deepClone=d,a.findNewClickedTracking=O,a.getBlurCallback=q,a.getData=N,a.getContents=h,a.getClassName=T,a.getNewConfigObj=A,a.getDisplayProperty=S,a.getDiffElements=u,a.getFocusCallback=U,a.getTrackedElementsConfig=o,a.isElementDisplayable=I,a.sendFocusEvent=V,a.sendBlurEvent=B,a.updateViewedConfig=s,a.getTextFieldData=m,a.safeGetValue=f,a.getRankData=y,a.getContents=h,a.getAttributes=C,a.getListPath=g,a.getChildElementInfo=E,a.getLinkData=v,a.getItems=p,a.removeNulls=w,a.isParentElement=k,a.getContents=h,a.init(),a}});
//# sourceMappingURL=columbo-events-f92d7364ad.js.map
