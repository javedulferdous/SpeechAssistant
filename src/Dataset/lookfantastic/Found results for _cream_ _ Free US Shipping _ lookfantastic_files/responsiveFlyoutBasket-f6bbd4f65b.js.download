"use strict";define(["app","componentHelper","$console","$window"],function(e,t,o,n){var a;return function a(){var s={},r={selectors:{basketHeaderButton:"#responsiveFlyoutBasket_openBasketButtonMobile",accountHeaderButton:"#responsiveAccountHeader_openAccountButtonMobile",basketOverlay:".responsiveFlyoutBasket_overlay",deviceStateEl:"[data-device-state]",continueShoppingButton:"[data-close-basket]",basketSummaryButton:"[data-js-element=responsiveFlyoutBasket_basketSummary_link]",basketItems:"[data-scroll]",openFlyoutPanel:"[data-js-element=responsiveFlyoutBasket_openBasketPanel]"},classNames:{basketHeaderButtonExpanded:"responsiveFlyoutBasket_openBasketButtonMobile-expanded",basketSummaryShadowClass:"responsiveFlyoutBasket_basketSummary-shadow"}},i=function t(o){return s.element=o,s.basketHeaderButton=s.element.querySelector(s.config.selectors.basketHeaderButton),s.accountHeaderButton=document.querySelector(s.config.selectors.accountHeaderButton),s.deviceStateEl=s.element.querySelector(s.config.selectors.deviceStateEl),s.deviceState=window.getComputedStyle(s.deviceStateEl,":before").getPropertyValue("content").replace(/\"/g,""),s.basketOverlay=document.querySelector(s.config.selectors.basketOverlay),s.continueShoppingButton=s.element.querySelectorAll(s.config.selectors.continueShoppingButton),s.basketSummaryButton=s.element.querySelector(s.config.selectors.basketSummaryButton),s.basketItemsContainer=s.element.querySelector(s.config.selectors.basketItems),s.openFlyoutPanel=s.element.querySelector(s.config.selectors.openFlyoutPanel),s.headerBreakpoint=1200,s.windowWidthPrevious=s.getWindowWidth(),s.mobileLayout=s.windowWidthPrevious<s.headerBreakpoint,e.subscribe("ajaxBasket/updateGlobalBasketItemsCount",s.ajaxBasketItems),e.subscribe("globalBasketItemsCount/updateGlobalBasketItemsCount",s.ajaxBasketItems),e.subscribe("header/closeBasketResponsive",s.toggleBasketFlyoutMenu),s.bind(),s},u=function e(){s.continueShoppingButton&&Array.from(s.continueShoppingButton).map(function(e){return e.addEventListener("click",s.toggleBasketFlyoutMenu)}),s.basketItemsContainer&&s.basketItemsContainer.addEventListener("scroll",s.addRemoveShadow),s.basketHeaderButton.addEventListener("click",s.toggleBasketFlyoutMenu),s.basketOverlay.addEventListener("click",s.toggleBasketFlyoutMenu),s.deviceStateCondition(s.deviceState),window.addEventListener("resize",s.resizeEvent)},l=function e(){return s.basketItemsContainer.scrollTop},d=function e(){s.scrollPosition()>5?s.basketSummaryButton.classList.add(s.config.classNames.basketSummaryShadowClass):s.basketSummaryButton.classList.remove(s.config.classNames.basketSummaryShadowClass)},c=function t(){s.basketItemsContainer.scrollTop=0,e.publish("columbo/track","responsiveFlyoutBasket","hover","desktop open")},p=function t(){e.ajax.get({url:"/responsiveFlyoutBasket.bsk",dataType:"JSON",success:s.updateBasketItems,error:s.updateBasketItemsError})},k=function e(o){var n=s.element.parentElement;n&&(n.innerHTML=o,t.reloadAllComponents(n))},m=function e(t){o.error(t)},b=function t(){s.expanded=!("true"===s.basketHeaderButton.getAttribute("aria-expanded")),"true"===s.accountHeaderButton.getAttribute("aria-expanded")&&e.publish("header/closeAccountResponsive"),s.basketHeaderButton.setAttribute("aria-expanded",s.expanded),s.basketItemsContainer&&s.resetScrollPosition(),s.expanded?(document.addEventListener("keydown",s.escapeListener),document.body.classList.add("popup-no-scroll")):(document.removeEventListener("keydown",s.escapeListener),document.body.classList.remove("popup-no-scroll"))},y=function e(t){"Escape"!==t.key&&"Esc"!==t.key||s.toggleBasketFlyoutMenu()},B=function e(){return n.innerWidth},v=function e(){var t=window.getComputedStyle(s.deviceStateEl,":before").getPropertyValue("content").replace(/\"/g,"");s.deviceStateCondition(t),s.windowWidthCurrent=s.getWindowWidth(),s.mobileLayout&&s.windowWidthCurrent>s.headerBreakpoint&&s.expanded&&s.toggleBasketFlyoutMenu(),s.mobileLayout=s.windowWidthCurrent<s.headerBreakpoint},S=function e(t){if(!s.basketItemsContainer)return;"desktop"===t?s.openFlyoutPanel.addEventListener("mouseenter",s.resetScrollPosition):s.openFlyoutPanel.removeEventListener("mouseenter",s.resetScrollPosition)};return s.config=r,s.init=i,s.bind=u,s.scrollPosition=l,s.addRemoveShadow=d,s.resetScrollPosition=c,s.ajaxBasketItems=p,s.updateBasketItems=k,s.updateBasketItemsError=m,s.toggleBasketFlyoutMenu=b,s.getWindowWidth=B,s.resizeEvent=v,s.deviceStateCondition=S,s.escapeListener=y,s}});
//# sourceMappingURL=responsiveFlyoutBasket-f6bbd4f65b.js.map
