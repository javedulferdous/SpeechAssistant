"use strict";define(["app","$console","$window"],function(e,n,t){var r;return function r(){var s={config:{selectors:{component:"[data-component=subscribeAndSaveContracts]",dropdown:"#subscribeAndSaveContracts_dropdown"},channels:{showSubscribeAndSaveContracts:"subscribeAndSaveContracts/show",updateSubscribeAndSaveContracts:"subscribeAndSaveContracts/update",subscribeAndSaveContractsChange:"subscribeAndSave/contractsChange",changeContractIdSubscribeAndSaveContracts:"subscribeAndSaveContracts/changeContractId",noContractsAvailable:"subscribeAndSaveProductInBasket/noContracts"},attributes:{isVisible:"data-visible",isBasketPage:"data-basket-page",productId:"data-product-id"}},init:function(n,t){s.element=n,s.dropdown=n.querySelector(s.config.selectors.dropdown),t?e.publish(s.config.channels.subscribeAndSaveContractsChange):s.subscribeToChannels(),s.bind()},bind:function(){s.dropdown.addEventListener("change",function(){s.changeDropdown(true)})},subscribeToChannels:function(){e.subscribe(s.config.channels.showSubscribeAndSaveContracts,s.showSubscribeAndSaveContracts),e.subscribe(s.config.channels.updateSubscribeAndSaveContracts,s.updateSubscribeAndSaveContracts)},showSubscribeAndSaveContracts:function(n){s.element.setAttribute(s.config.attributes.isVisible,n),n?s.changeDropdown(n):e.publish(s.config.channels.changeContractIdSubscribeAndSaveContracts,"",n)},updateSubscribeAndSaveContracts:function(n){var t="/"+n+".subscribeAndSave?enableSubscribeAndSave=true";e.ajax.get({url:t,success:s.successHandler,error:s.errorHandler})},errorHandler:function(){n.error("ERROR: Could not retrieve new subscribeAndSaveContracts")},successHandler:function(e){var n=s.element.parentNode;n.innerHTML=e;var t=n.querySelector(s.config.selectors.component);s.init(t,true)},changeDropdown:function(n){var r=s.dropdown.value;if("true"===s.element.getAttribute(s.config.attributes.isBasketPage)){var a=s.element.parentElement.getAttribute(s.config.attributes.productId);t.location="/my.basket?page=basket&section=checkout&counter=1&buy="+a+"&subscriptionContractId="+r+"&enableSubscribeAndSave=true"}else e.publish(s.config.channels.noContractsAvailable,s.dropdown.disabled),e.publish(s.config.channels.changeContractIdSubscribeAndSaveContracts,r,n)}};return s}});
//# sourceMappingURL=subscribeAndSaveContracts-929f10943c.js.map
