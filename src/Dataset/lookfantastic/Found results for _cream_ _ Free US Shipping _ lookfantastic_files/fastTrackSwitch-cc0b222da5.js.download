"use strict";define(["app","$console","elementViewed"],function(t,e,a){var c;return function c(){var n={};n.elementViewed=a;var r={selectors:{toggle:".fastTrackSwitch_toggle",productId:"data-product-id",linkedProductId:"data-linked-product-id",switchState:"data-switch-enabled",infoMessage:".fastTrackSwitch_infoMessage",index:"data-index",responsiveProductListPage:"responsiveProductListPage_fastTrackSwitch"},channels:{stateChange:"fastTrackSwitch/stateChange",update:"fastTrackSwitch/update",fastTrackInfoToggle:"fastTrackInfoBox/toggle",DSTracking:"columbo/track"}},i="fast_track_switch",s="click",o="fast_track",d="Fast Track Engagement",l="Clicked Fast Track Toggle",u="Viewed Fast Track Toggle",g=function e(a,c,r){return n.element=a,n.parent=n.element.parentNode,n.toggle=n.element.querySelector(n.config.selectors.toggle),n.productId=n.element.getAttribute(n.config.selectors.productId),n.linkedProductId=n.element.getAttribute(n.config.selectors.linkedProductId),n.switchState=n.element.getAttribute(n.config.selectors.switchState),n.index=n.element.getAttribute(n.config.selectors.index),n.infoMessage=n.element.querySelector(n.config.selectors.infoMessage),c||(t.subscribe(n.config.channels.update,n.updateFastTrackSwitch),n.elementViewed(n.element,n.fastTrackSwitchViewed)),r&&n.publishSwitchStateInformation(),n.addEventListeners(),n},f=function t(){n.toggle&&n.toggle.addEventListener("change",n.toggleStateChanged)},h=function t(){n.infoMessage&&n.infoMessage.classList.toggle("show"),n.setCookie("fastTrackSwitchCookie","false"===n.switchState?"enableSwitch":"disableSwitch"),n.parent&&!n.parent.classList.contains(n.config.selectors.responsiveProductListPage)?(n.displayHideFastTrackInfoBox(),n.getFastTrackSwitch(n.productId,true,true)):n.publishSwitchStateInformation("false"===n.switchState)},k=function t(e){"true"===n.switchState&&("0"!==n.linkedProductId?n.getFastTrackSwitch(e):n.productId!==e&&n.getFastTrackSwitch(e,true))},w=function t(e,a){var c="/",n=new Date;n.setFullYear(n.getFullYear()+1),document.cookie=e+"="+a+"; expires="+n.toUTCString()+"; path=/"},S=function e(a,c,r){var i="/update.fasttrackupdate?productId="+a;c&&(i+="&stateChange=true"),t.ajax.get({url:i,success:true===r?n.updateAndPublish:n.fastTrackSwitchSuccessHandler,error:n.fastTrackSwitchErrorHandler})},p=function t(e){var a=n.constructNewFastTrackSwitch(e);n.init(a,true,true)},T=function t(e){var a=n.constructNewFastTrackSwitch(e);n.init(a,true)},b=function t(){e.error("ERROR: Could not retrieve new fastTrackSwitch")},m=function e(){t.publish(n.config.channels.fastTrackInfoToggle,"toggle")},I=function t(e){var a=n.element.parentNode;return a.innerHTML=e,a.querySelector("[data-component=fastTrackSwitch]")},v=function e(a){var c=n.switchState;null!=a&&(c=a?"true":"false"),t.publish(n.config.channels.stateChange,n.productId,n.linkedProductId,c),t.publish(n.config.channels.DSTracking,"fast_track_switch","click","fast_track",c),t.publish("tracking/record",d,l)},F=function e(){t.publish("tracking/record",d,u)};return n.config=r,n.init=g,n.addEventListeners=f,n.toggleStateChanged=h,n.updateFastTrackSwitch=k,n.setCookie=w,n.getFastTrackSwitch=S,n.fastTrackSwitchSuccessHandler=T,n.fastTrackSwitchErrorHandler=b,n.publishSwitchStateInformation=v,n.displayHideFastTrackInfoBox=m,n.constructNewFastTrackSwitch=I,n.updateAndPublish=p,n.fastTrackSwitchViewed=F,n}});
//# sourceMappingURL=fastTrackSwitch-cc0b222da5.js.map
