"use strict";define(["app","$window","accessibleModalHelper","accessibilityFocusHelper"],function(t,e,n,o){var a=function t(e){try{return new Event(e)}catch(t){var n=document.createEvent("Event");return n.initEvent(e,false,false),n}},i=function t(e,n){var o=n.getAttribute("data-variation-id");return e.querySelector('input[type="hidden"][data-variation-id="'+o+'"]')},r;return function n(){var r=this,c=this,u="unavailable",d={variationOptions:{selector:"[data-dropdown=productVariation]",containerSelector:"[data-variation-container=productVariations]",radioSelector:"[data-radio]",variationId:"data-variation-id",masterProductId:"data-master-id",childProductId:"data-child-id",linkedProductId:"data-linked-product-id",currentQuantityInBasket:"data-information-current-quantity-basket",maximumAllowedQuantityInBasket:"data-information-maximum-allowed-quantity",informationUrl:"data-information-url",enableChildSkuDescription:"data-enable-child-sku-description",linkedDropdown:"[data-linked-variation=true]",variationButtonsSelector:"[data-option-id]"},subscriptionComponent:{selector:"[data-component=subscriptionComponent]"},colorSwatches:{selector:"[data-color-swatch]",dataSelected:"data-selected",ariaLabel:"aria-label",selectedClassLight:"productVariations_colorSwatch-selected-light",selectedClassDark:"productVariations_colorSwatch-selected-dark",borderedClass:"productVariations_colorSwatch-bordered",dataValueId:"data-value-id",dataDisabled:"data-disabled",colorHexSumThreshold:48,linkProductId:"data-linked-product-id",optionUnavailable:"data-option-unavailable"},colorDropdown:{selector:"[data-dropdown-type=color]"},subscribeChannels:{variations:"productVariations/variationData",image:"productSingleImage/newImage",imageMultiple:"productMultipleImages/newImage",price:"productPrice/newPrice",tags:"productTags/new",stock:"productStockInformation/newStockInformation",releaseDate:"productReleaseDate/newReleaseDate",addToBasketButton:"productAddToBasketButton/newButton",moreInformation:"productViewMoreInformation/newUrl",information:"productInformation/newInformation",fullDescription:"fullProductDescription/new",productQuantityInput:"productQuantity/productQuantity",productName:"productName/update",productPlatform:"productPlatform/update",recentlyViewed:"productRecentlyViewed/update",productReviews:"productReviews/newProductReviews",productReviewStars:"productReviewStars/update",productAddToWishlist:"productAddToWishlist/update",productFrequentlyBoughtTogether:"productFrequentlyBoughtTogether/update",loyaltyPointsMessage:"loyaltyPointsMessage/update",fastTrackSwitchStateChange:"fastTrackSwitch/stateChange",fastTrackSwitchUpdate:"fastTrackSwitch/update",instalmentInfo:"productInstalmentPayment/newInstalmentInfo",papUpdate:"pap/update",BNPLProvidersInfo:"productBuyNowPayLaterProviders/providersInfo",disableQuantityInput:"productQuantityInput/disable",subscribeAndSaveContractsUpdate:"subscribeAndSaveContracts/update"},publishChannels:{DSTracking:"columbo/track"},externalSelectors:{productNameTitle:".productName_title",productPrice:".productPrice_price",quantityInputLabel:"[data-quantity-input-container]",quantityInput:"[data-quantity-input-container] input",fastTrackSwitch:".fastTrack_onProductPage"},attrs:{disableWishlist:"data-disable-wishlist",hasSelection:"data-has-selection",uniqueVariationId:"data-variation-unique-id",linkedChildProductId:"data-linked-child-product-id",subscribeAndSave:"data-subscribe-and-save"},trackingEventSubtype:{size:"size_selector",shade:"shade_selector",variationDropdown:"product_variations_dropdown",colorSwatch:"colorSwatchClicked"},announcementDelay:500},l=function e(n,o){return c.element=n,c.app=t,c.innerContainer=c.element.querySelector(c.config.variationOptions.containerSelector),c.disableWishlist=c.element.getAttribute(c.config.attrs.disableWishlist),c.childProductId=c.innerContainer.getAttribute(c.config.variationOptions.childProductId),c.linkedChildProductId=c.innerContainer.getAttribute(c.config.attrs.linkedChildProductId),c.linkedProductId=c.innerContainer.getAttribute(c.config.variationOptions.linkedProductId),c.hasSelection=c.innerContainer.getAttribute(c.config.attrs.hasSelection),c.informationUrl=c.innerContainer.getAttribute(c.config.variationOptions.informationUrl),c.enableChildSkuDescription=c.innerContainer.getAttribute(c.config.variationOptions.enableChildSkuDescription),c.masterProductId=c.element.getAttribute(c.config.variationOptions.masterProductId),c.colorSwatches=c.element.querySelectorAll(c.config.colorSwatches.selector),c.colorDropdown=c.element.querySelector(c.config.colorDropdown.selector),c.variationOptions=c.element.querySelectorAll(c.config.variationOptions.selector),c.linkedDropdown=c.element.querySelector(c.config.variationOptions.linkedDropdown),c.subscriptionComponentEl=c.element.querySelector(c.config.subscriptionComponent.selector),c.radios=c.element.querySelectorAll(c.config.variationOptions.radioSelector),c.variationButtons=c.element.querySelectorAll(c.config.variationOptions.variationButtonsSelector),c.backgroundColor=window.getComputedStyle(c.element).getPropertyValue("background-color"),c.quantityInputData={numberOfItemsInBasket:c.innerContainer.getAttribute(c.config.variationOptions.currentQuantityInBasket),maximumNumberOfItemsToAdd:c.innerContainer.getAttribute(c.config.variationOptions.maximumAllowedQuantityInBasket)},o||t.subscribe(c.config.subscribeChannels.fastTrackSwitchStateChange,c.fastTrackSwitchStateChanged),c.radioOnLoad(),c.addEventListeners(),c.updateVariationData(),c.changeProductInformation(),c.publishQuantityInputData(c.quantityInputData.numberOfItemsInBasket)&&c.publishQuantityInputData(c.quantityInputData.maximumNumberOfItemsToAdd)&&t.publish(c.config.subscribeChannels.productQuantityInput,c.quantityInputData,true),c.subscriptionComponentEl&&require(["subscriptionComponent"],function(t){return c.subscriptionComponent=t}),c},s=function t(){c.colorDropdown&&(c.colorDropdown.addEventListener("change",c.changeColorDropdown),c.selectSwatchOnLoad(c.colorDropdown.value));for(var e=function t(e,n){var o=c.colorSwatches[e],a;null!==o.getAttribute(c.config.colorSwatches.dataDisabled)||o.addEventListener("click",function(){return c.clickColorSwatch(o)}),c.colorIsSameAsBg(o)&&c.addBorderToColorSwatch(o)},n=0,o=c.colorSwatches.length;n<o;n++)e(n,o);for(var n=0,o=c.variationOptions.length;n<o;n++)c.variationOptions[n].addEventListener("change",c.variationsChange);for(var a=0,i=c.variationButtons.length;a<i;a++)c.variationButtons[a].addEventListener("click",c.setVariation);for(var r=0;r<c.radios.length;r++){var u=c.radios[r];u.addEventListener("change",c.radioChange.bind(null,u))}c.linkedDropdown&&c.linkedDropdown.addEventListener("change",c.linkedDropdownChange)},p=function e(n){var o=n.currentTarget,i=document.querySelector('input[data-variation-id="'+o.getAttribute("data-variation-id")+'"]');i&&o&&(i.value=o.getAttribute("data-option-id"),c.updateFallbackProductId(o.getAttribute(c.config.variationOptions.linkedProductId),o.classList.contains("unavailable")),i.dispatchEvent(a("change")),c.elementToReturnFocusTo=o);var r=o.hasAttribute(c.config.variationOptions.linkedProductId)&&"default"!==o.getAttribute(c.config.variationOptions.linkedProductId)?o.getAttribute(c.config.variationOptions.linkedProductId):c.innerContainer.getAttribute(c.config.variationOptions.childProductId);t.publish(c.config.publishChannels.DSTracking,c.config.trackingEventSubtype.size,"click",r)},h=function e(n,o,a){c.elementToReturnFocusTo=c.elementToReturnFocusTo?c.elementToReturnFocusTo:n.target||n,c.updateFallbackProductId(null,null,n),c.currentLinkedProductId&&"default"!==c.currentLinkedProductId&&"0"!==c.currentLinkedProductId&&(c.masterProductId=c.currentLinkedProductId);var i="/"+c.masterProductId+".variations?";""!==c.enableChildSkuDescription&&(i=i.concat("&enableChildProductDescription="+c.enableChildSkuDescription));var r=document.querySelector(c.config.externalSelectors.fastTrackSwitch);r&&(i+="&useCookieForFastTrackFiltration="+r.getAttribute("data-switch-enabled"));var u=c.innerContainer.getAttribute(c.config.attrs.subscribeAndSave);u&&(i+="&enableSubscribeAndSave="+u),t.ajax.post({url:i,send:a?null:JSON.stringify(c.constructPostData()),requestHeader:{header:"Content-Type",value:"application/json"},success:true===o?c.variationSuccessHandlerForFastTrack:c.variationSuccessHandler,error:c.variationErrorHandler})},g=function t(){[].filter.call(c.radios,function(t){return t.checked}).forEach(function(t){i(c.element,t).value=t.value})},f=function t(e){if(!e.checked)return;var n=i(c.element,e);n.value=e.value,c.elementToReturnFocusTo=e,c.updateFallbackProductId(e.getAttribute(c.config.colorSwatches.linkProductId),e.classList.contains("unavailable")),n.dispatchEvent(a("change"))},b=function t(){for(var e={selected:0},n=0,o=c.variationOptions.length;n<o;n++){var a=c.variationOptions[n];e["variation"+(n+1)]=a.getAttribute(c.config.variationOptions.variationId),e["option"+(n+1)]=a.value,a.value&&e.selected++}return e},v=function t(e){e&&"default"!==e&&c.updateLinkedSkuChannels(e),c.unavailableOptionClicked?c.updateGeneralComponents(c.linkedChildProductId):c.updateGeneralComponents(c.childProductId)},m=function t(e){c.changeProductImage(e),c.changeProductPrice(e),c.changeReleaseDate(e),c.changeProductTags(e),c.changeProductViewMoreInformation(e),c.updateSubscriptionComponent(),c.changeProductInformation(e),c.updateFastTrackSwitch(e),c.changeLoyaltyPoints(e),c.changeProductInstalmentPayment(e),c.changeProductBNPLProviders(e),c.changeProductStockInformation(e),c.changeProductQuantityInput(),"true"===c.enableChildSkuDescription&&c.updateFullProductDescription(e,c.enableChildSkuDescription),c.changeAddToBasketButton(e),c.disableWishlist||c.changeProductAddToWishlist(e),c.updateSubscribeAndSaveContracts(e)},S=function t(n){if(c.updateChildId(n),c.updateVariationData(n),c.updateProductPageComponents(c.currentLinkedProductId),c.elementToReturnFocusTo){var a=c.elementToReturnFocusTo.getAttribute(c.config.attrs.uniqueVariationId),i=document.querySelector("["+c.config.attrs.uniqueVariationId+'="'+a+'"]');o.focus(i),c.elementToReturnFocusTo=false}e.setTimeout(function(){c.announceNewProductInformation()},c.config.announcementDelay)},C=function e(){var n=function t(e){return e?e.innerText.trim().replace(/\n/g," "):""},o=function t(e){return e?e.value:""},a=n(document.querySelector(c.config.externalSelectors.productNameTitle)),i=n(document.querySelector(c.config.externalSelectors.productPrice)),r=n(document.querySelector(c.config.externalSelectors.quantityInputLabel)),u=o(document.querySelector(c.config.externalSelectors.quantityInput)),d=a+" "+i+",",l;c.element.querySelectorAll("[data-product-variation]").forEach(function(t){var e=t.querySelector("[data-product-variation-type]"),o=e.getAttribute("data-product-variation-type");if("radio"===o){var a=n(e.querySelector("label")),i=n(e.querySelector("button[data-selected]"));d=d+" "+a+" "+i+","}else if("color"===o||"dropdown"===o){var r=n(e.querySelector("label")),c=e.querySelector("option[selected]"),u=c&&c.innerText?n(c):"";d=d+" "+r+" "+u+","}else if("cards"===o){var l=e.querySelector("[checked][data-announce-value]"),s=l&&l.getAttribute("data-announce-value");d=d+" "+s+","}}),d=d+" "+r+" "+u,t.publish("accessibility/announce","assertive",d)},k=function t(){console.error("ERROR: Could not retrieve variation data for product: "+c.masterProductId)},P=function e(n){var o=document.createElement("html");o.innerHTML=n;var a=o.querySelector(c.config.variationOptions.containerSelector),i=c.element.querySelector(c.config.variationOptions.containerSelector);c.element.removeChild(i),c.element.appendChild(a);var r=a.parentElement,u=a.getAttribute(c.config.variationOptions.linkedProductId);"0"!==u&&r.setAttribute(c.config.variationOptions.masterProductId,u),c.init(r,true),t.publish(c.config.subscribeChannels.productQuantityInput,c.quantityInputData,true)},w=function e(){for(var n={variationLength:c.variationOptions.length,variations:[]},o=0;o<c.variationOptions.length;o++){var a=c.variationOptions[o];if(!a.value)continue;n.variations.push(a.value)}t.publish(c.config.subscribeChannels.variations,n,true)},I=function e(n){t.publish(c.config.subscribeChannels.image,n,true),t.publish(c.config.subscribeChannels.imageMultiple,{productId:c.childProductId,variation:false})},y=function e(n){t.publish(c.config.subscribeChannels.price,n,true)},A=function e(n){t.publish(c.config.subscribeChannels.instalmentInfo,n,true)},T=function e(n){return t.publish(c.config.subscribeChannels.BNPLProvidersInfo,n,true)},D=function e(n){t.publish(c.config.subscribeChannels.stock,n,true)},O=function e(n){t.publish(c.config.subscribeChannels.releaseDate,n,true)},q=function e(n){t.publish(c.config.subscribeChannels.addToBasketButton,n,c.unavailableOptionClicked&&c.linkedChildProductId===c.masterProductId)},L=function e(n){t.publish(c.config.subscribeChannels.tags,n,true)},F=function e(){t.publish(c.config.subscribeChannels.moreInformation,c.informationUrl,true)},B=function e(n){t.publish(c.config.subscribeChannels.information,n,true)},E=function e(n){t.publish(c.config.subscribeChannels.productReviews,n,true)},V=function e(n){t.publish(c.config.subscribeChannels.productReviewStars,n,true)},R=function e(n){t.publish(c.config.subscribeChannels.productName,n,true)},N=function e(n){t.publish(c.config.subscribeChannels.productPlatform,n)},x=function e(n,o){t.publish(c.config.subscribeChannels.fullDescription,n,o,true)},Q=function e(n){t.publish(c.config.subscribeChannels.recentlyViewed,n,true)},H=function e(n){t.publish(c.config.subscribeChannels.productFrequentlyBoughtTogether,n,true)},U=function e(n){t.publish(c.config.subscribeChannels.productAddToWishlist,n,c.unavailableOptionClicked&&c.linkedChildProductId===c.masterProductId)},M=function e(n){t.publish(c.config.subscribeChannels.loyaltyPointsMessage,n)},_=function e(n){t.publish(c.config.subscribeChannels.fastTrackSwitchUpdate,n,true)},W=function e(n){t.publish(c.config.subscribeChannels.papUpdate,n)},j=function e(){t.publish(c.config.subscribeChannels.disableQuantityInput,c.unavailableOptionClicked&&c.linkedChildProductId===c.masterProductId)},z=function e(n){t.publish(c.config.subscribeChannels.subscribeAndSaveContractsUpdate,n)},G=function t(e){return c.backgroundColor===window.getComputedStyle(e).getPropertyValue("background-color")},J=function t(e){e&&""!==e&&c.updateColorSwatch(e,false)},K=function e(n){t.element.addClass(c.config.colorSwatches.borderedClass,n)},$=function e(){for(var n=0,o=c.colorSwatches.length;n<o;n++){var a=c.colorSwatches[n];t.element.setAttribute(c.config.colorSwatches.dataSelected,"false",a),t.element.removeClass(c.config.colorSwatches.selectedClassLight,a),t.element.removeClass(c.config.colorSwatches.selectedClassDark,a),c.removeSelectedLabel(a)}},X=function e(n){var o=t.element.getAttribute(c.config.colorSwatches.optionUnavailable,n);c.deselectAllColorSwatches(),c.selectColorSwatch(n),c.updateColorDropdown(t.element.getAttribute(c.config.colorSwatches.dataValueId,n)),c.updateFallbackProductId(t.element.getAttribute(c.config.colorSwatches.linkProductId,n),"true"===o),c.variationsChange(n),t.publish(c.config.publishChannels.DSTracking,c.config.trackingEventSubtype.shade,"click",c.innerContainer.getAttribute(c.config.variationOptions.childProductId))},Y=function e(){c.updateColorSwatch(r.value,true),t.publish(c.config.publishChannels.DSTracking,c.config.trackingEventSubtype.variationDropdown,"click",c.innerContainer.getAttribute(c.config.variationOptions.childProductId))},Z=function t(e){c.colorDropdown.value=e},tt=function e(n){t.element.setAttribute(c.config.colorSwatches.dataSelected,"true",n),c.addSelectedLabel(n);var o,a=n.getAttribute("style").split(": ")[1];c.getColorSum(a)<=c.config.colorSwatches.colorHexSumThreshold?t.element.addClass(c.config.colorSwatches.selectedClassLight,n):t.element.addClass(c.config.colorSwatches.selectedClassDark,n)},et=function t(e){for(var n=e.split(""),o=0,a=0;a<n.length;a++)n[a]>="0"&&n[a]<="9"?o+=Number(n[a]):n[a]>="a"&&n[a]<="f"?o+=Number(n[a].charCodeAt(0)-"a".charCodeAt(0)+10):n[a]>="A"&&n[a]<="F"&&(o+=Number(n[a].charCodeAt(0)-"A".charCodeAt(0)+10));return o},nt=function e(n,o){c.deselectAllColorSwatches();for(var a=0,i=c.colorSwatches.length;a<i;a++){var r=c.colorSwatches[a];if(t.element.getAttribute(c.config.colorSwatches.dataValueId,r)===n){if(o){var u=t.element.getAttribute(c.config.colorSwatches.linkProductId,r);"default"!==u&&c.updateLinkedSkuChannels(u)}return c.selectColorSwatch(r),void 0}}},ot=function t(){if(c.subscriptionComponentEl=c.element.querySelector(c.config.subscriptionComponent.selector),!c.subscriptionComponentEl)return;c.subscriptionComponentEl.componentObject=new c.subscriptionComponent,c.subscriptionComponentEl.componentObject.init(c.subscriptionComponentEl)},at=function t(){var e,n=c.linkedDropdown.options[c.linkedDropdown.selectedIndex].getAttribute(c.config.colorSwatches.linkProductId);n&&"default"!==n&&c.updateLinkedSkuChannels(n)},it=function e(n){t.publish("tracking/record","Linked SKU Engagement","Clicked away from "+c.childProductId,"Clicked on"+n),t.publish(c.config.publishChannels.DSTracking,c.config.trackingEventSubtype.colorSwatch,"click",n),c.updateReviews(n),c.updateReviewStars(n),"true"!==c.enableChildSkuDescription&&c.updateFullProductDescription(n,c.enableChildSkuDescription),c.updateProductName(n),c.updateProductPlatform(n),c.changeProductRecentlyViewed(n),c.changeProductFrequentlyBoughtTogether(n),c.updatePap(n)},rt=function e(n){var o,a=n.getAttribute(c.config.colorSwatches.ariaLabel)+" selected";t.element.setAttribute(c.config.colorSwatches.ariaLabel,a,n)},ct=function e(n){var o,a=t.element.getAttribute(c.config.colorSwatches.ariaLabel,n).replace(" selected","");t.element.setAttribute(c.config.colorSwatches.ariaLabel,a,n)},ut=function t(e,n,o){var a=document.querySelector(c.config.externalSelectors.fastTrackSwitch);"true"!==c.hasSelection?c.variationsChange(a,true,true):"true"===o?e===c.childProductId?c.variationsChange(a,true):("0"!==n&&n!==c.linkedProductId&&c.updateLinkedSkuChannels(n),c.retrieveFastTrackQualifiedVariations(e)):c.variationsChange(a,true)},dt=function e(n){var o="/"+c.masterProductId+".fasttrackupdate?childProductId="+n+"&useCookieForFastTrackFiltration=true";t.ajax.get({url:o,success:c.variationSuccessHandler,error:c.variationErrorHandler})},lt=function t(e){c.updateChildId(e),c.updateVariationData(e),c.changeProductPrice(c.childProductId)},st=function t(e){return e&&"0"!==e},pt=function t(e,n,o){if(o){var a=o.currentTarget?o.currentTarget.options&&o.currentTarget.options[o.currentTarget.selectedIndex]||o.currentTarget:o;a.getAttribute(c.config.variationOptions.linkedProductId)&&(c.currentLinkedProductId=a.getAttribute(c.config.variationOptions.linkedProductId),c.unavailableOptionClicked=a.classList.contains("unavailable"))}else c.currentLinkedProductId=e,c.unavailableOptionClicked=n};c.init=l,c.config=d,c.selectSwatchOnLoad=J,c.variationsChange=h,c.radioChange=f,c.radioOnLoad=g,c.setVariation=p,c.variationSuccessHandler=S,c.variationErrorHandler=k,c.constructPostData=b,c.updateChildId=P,c.addEventListeners=s,c.updateVariationData=w,c.changeProductImage=I,c.changeProductPrice=y,c.changeProductStockInformation=D,c.changeReleaseDate=O,c.changeAddToBasketButton=q,c.changeProductTags=L,c.changeProductViewMoreInformation=F,c.changeProductInformation=B,c.changeLoyaltyPoints=M,c.clickColorSwatch=X,c.deselectAllColorSwatches=$,c.getColorSum=et,c.updateColorDropdown=Z,c.changeColorDropdown=Y,c.updateColorSwatch=nt,c.selectColorSwatch=tt,c.colorIsSameAsBg=G,c.addBorderToColorSwatch=K,c.updateSubscriptionComponent=ot,c.updateLinkedSkuChannels=it,c.updateReviews=E,c.updateFullProductDescription=x,c.updateProductName=R,c.updateProductPlatform=N,c.changeProductRecentlyViewed=Q,c.changeProductAddToWishlist=U,c.changeProductFrequentlyBoughtTogether=H,c.updateReviewStars=V,c.announceNewProductInformation=C,c.addSelectedLabel=rt,c.removeSelectedLabel=ct,c.linkedDropdownChange=at,c.fastTrackSwitchStateChanged=ut,c.retrieveFastTrackQualifiedVariations=dt,c.variationSuccessHandlerForFastTrack=lt,c.updateFastTrackSwitch=_,c.publishQuantityInputData=st,c.changeProductInstalmentPayment=A,c.changeProductBNPLProviders=T,c.updatePap=W,c.updateGeneralComponents=m,c.updateFallbackProductId=pt,c.updateProductPageComponents=v,c.changeProductQuantityInput=j,c.updateSubscribeAndSaveContracts=z}});
//# sourceMappingURL=productVariations-94d1eff36f.js.map
