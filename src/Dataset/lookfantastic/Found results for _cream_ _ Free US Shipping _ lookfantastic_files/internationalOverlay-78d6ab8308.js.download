"use strict";define(["app","siteObj","cookie","ePopup","queryString"],function(e,t,o,n,i){var r;return(new function r(){var s=this,c,a,u={chosenSubsite:o.get(t.subsiteCode+"_chosenSubsite_V6"),referringSite:t.siteCode+"_"+t.siteDefaultLocale,subsiteCode:t.subsiteCode,legacyChosenCountry:o.get("chosenCountry"),countrySelected:window.location.search.indexOf("countrySelected=Y")>-1,contentUrl:t.siteURL+t.siteDefaultLocale+"/"+t.currencyType+"/"+t.customerLocation+"/switchLocale.overlay",getUrlForSave:function e(o){return t.siteURL+t.siteDefaultLocale+"/"+t.currencyType+"/sessionSettingsSave.session?internationaloverlay=true&subsitecode="+o}},l=function t(){if(s.config.chosenSubsite!==s.config.subsiteCode)if("AD"===s.config.legacyChosenCountry)o.remove("chosenCountry",{path:"/"}),s.saveSettings(s.config.subsiteCode,false);else if(s.config.countrySelected)s.saveSettings(s.config.subsiteCode,false);else{var n,r=i.parse(window.location.search).overrideCustomerLocation;r&&(s.config.contentUrl+="?overrideCustomerLocation="+r),e.ajax.get({url:s.config.contentUrl,success:function e(t){s.showLocalePopup(t)},error:function e(){console.log("Failed to load locale popup")}})}return s},g=function o(i,r){if(i.length>0){a||(a=r||new n(i,"internationalOverlay_popup",true)),e.publish("tracking/record","locale popup","Show","Location: "+t.customerLocation);var u=document.querySelectorAll(".internationalOverlay_stayButton");u.length>0&&e.element.on("click",s.stayHere(a),u[0]),c=e.subscribe("epopup/default-close",s.stayHere(a));var l=document.querySelectorAll(".internationalOverlay_goButton");l.length>0&&e.element.on("click",s.goThere(a),l[0])}},f=function t(o){return function(){c.remove(),e.publish("tracking/record","locale popup","Stay On Site","Location: "+s.config.subsiteCode),s.saveSettings(s.config.subsiteCode,false),o.close()}},p=function t(o){return function(){var t,n=document.querySelector(".internationalOverlay").getAttribute("data-suggested-subsite");e.publish("tracking/record","locale popup","Goto Site","Location: "+n),s.saveSettings(n,true),o.close()}},d=function t(o,n){e.ajax.get({url:s.config.getUrlForSave(o),success:function e(){s.settingsSaved(n)}})},y=function t(o){e.publish("sessionSettings/save"),o&&s.reloadPage()},S=function e(){var t=i.parse(window.location.search);t.feature="locale-popup",t.referringSite=s.config.referringSite,window.location.search=i.stringify(t)};s.config=u,s.init=l,s.showLocalePopup=g,s.stayHere=f,s.goThere=p,s.saveSettings=d,s.settingsSaved=y,s.reloadPage=S}).init()});
//# sourceMappingURL=internationalOverlay-78d6ab8308.js.map
