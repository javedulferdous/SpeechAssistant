"use strict";define(["app","gtmEvents","enhancedEcommerce","formTimer","siteObj"],function(t,e,r,c,o){var i,n=new function e(){var i=this;function n(){var e=document.getElementsByTagName("body")[0],n="product"===o.type||"product"===o.page,a="list"===o.type,s=t.element.hasClass("pagenotfound",e);try{t.select(".trackwidget a, a.trackwidget").on("click",function(){t.publish("tracking/widget",this)})}catch(e){t.publish("javascript/error","gtmEventsError","widget tracking",e)}try{t.select(".bundle-button a").on("click",function(){t.publish("tracking/pyop",this)})}catch(e){t.publish("javascript/error","gtmEventsError","pyop tracking",e)}try{s&&t.publish("tracking/record","List page 404:"+o.siteCode,"URL:"+window.location.pathname)}catch(e){t.publish("javascript/error","gtmEventsError","404",e)}try{a&&document.querySelectorAll(".emptylist").length&&t.publish("tracking/record","List Empty:"+o.siteCode,"URL:"+window.location.pathname)}catch(e){t.publish("javascript/error","gtmEventsError","List Empty",e)}try{n&&document.querySelectorAll(".related").length>0&&t.element.on("click",function(){var e=t.select(this).getAttribute("rel");t.publish("tracking/record","Related Product Clicked: "+o.siteCode,"Product ID: "+e)},document.querySelectorAll(".productlist .item a"))}catch(e){t.publish("javascript/error","gtmEventsError","Related Product Clicked",e)}try{t.select(".item .item-promo-icon a").on("click",function(){t.publish("tracking/record","Related Product Clicked: "+o.siteCode,"Product ID: "+t.select(this).closest(".item").getAttribute("rel"));var e=this,r=t.element.closest(".item",this),c=t.element.getAttribute("rel",r),i=t.element.getText(this),n=r.querySelector(".product-name a"),a=t.element.getAttribute("title",n),s=t.element.getText(n);t.publish("tracking/record","promotion product icon - "+i,c,a,s)})}catch(e){t.publish("javascript/error","gtmEventsError","promotion product icon",e)}try{t.select(".item .product-promo-text a, .item .item-promo a").on("click",function(){var e=this,r=t.element.closest(".item",this),c=t.element.getAttribute("rel",r),o=t.element.getText(this),i=r.querySelector(".product-name a"),n=t.element.getAttribute("title",i),a=t.element.getText(true,r.querySelector(".product-name .product-type"));t.publish("tracking/record","promotion product text - "+o,c,n,a)})}catch(e){t.publish("javascript/error","gtmEventsError","promotion product text",e)}try{t.select(".youmightlike .item a").on("click",function(){var e=this,r=t.element.closest(".item",this),c=t.element.getAttribute("rel",r),o=t.element.getText(r.querySelector(".youmightlike .panel-head span")),i=t.element.trim(t.element.getAttribute("title",r.querySelector(".product-name a"))),n=t.element.getText(true,r.querySelector(".product-name .product-type"));t.publish("tracking/record","you might like",o,c+" - "+i+n)})}catch(e){t.publish("javascript/error","gtmEventsError","you might like",e)}try{t.select(".related .item a").on("click",function(){var e=this,r=t.element.closest(".item",this).element,c=t.element.getAttribute("rel",r),o=t.select(this).closest(".panel-head span").getText(true),i=t.element.trim(t.element.getAttribute("title",r.querySelector(".product-name a"))),n=t.element.getText(true,r.querySelector(".product-name .product-type"));t.publish("tracking/record","related",o,c+" - "+i+n)})}catch(e){t.publish("javascript/error","gtmEventsError","related",e)}try{t.select(".boughtafterviewing .item a").on("click",function(){var e=this,r=t.element.closest(".item",this).element,c=t.element.getAttribute("rel",r),o=t.element.getText(t.element.closest(".panel-head span",this),true),i=t.element.trim(t.element.getAttribute("title",r.querySelector(".product-name a"))),n=t.element.getText(true,r.querySelector(".product-name .product-type"));t.publish("tracking/record","bought after viewing",o,c+" - "+i+n)})}catch(e){t.publish("javascript/error","gtmEventsError","bought after viewing",e)}try{t.select(".basket .not-too-late-to-add .item a").on("click",function(){var e=this,r=t.element.closest(".item",this).element,c=t.element.getAttribute("rel",r),o=t.element.getText(true,document.querySelector(".not-too-late-to-add .panel-head .not-too-late")),i=t.element.trim(t.element.getAttribute("title",r.querySelector(".product-name a"))),n=t.element.getText(true,r.querySelector(".product-name .product-type"));t.publish("tracking/record","Basket Up Sell",o,c+" - "+i+n)})}catch(e){t.publish("javascript/error","gtmEventsError","Basket Up Sell",e)}try{t.select("#facets-panel p.facets-title").on("click",function(){var e=this;t.publish("tracking/record","Facets","open / close panel",t.element.getAttribute("class",this).replace("facets-title facet-",""))})}catch(e){t.publish("javascript/error","gtmEventsError","Facets open/close",e)}try{!document.querySelectorAll("body.basket").length||""===o.basketMessage&&""===o.discountCodeApplied||("discount.code.applied"===o.discountCodeApplied&&t.publish("tracking/record","Discount codes","Valid",o.basketDiscountCode),"discount.code.invalid"===o.basketMessage&&t.publish("tracking/record","Discount codes","Not Valid",o.basketDiscountCode),"discount.code.inactive"===o.basketMessage&&t.publish("tracking/record","Discount codes","Inactive",o.basketDiscountCode),"discount.code.badproduct"===o.basketMessage&&t.publish("tracking/record","Discount codes","Not Applicable to Basket Content",o.basketDiscountCode),"discount.code.better.offer.applied"===o.basketMessage&&t.publish("tracking/record","Discount codes","Better Offer Applied",o.basketDiscountCode),"discount.code.customer.invalidexpired"===o.basketMessage&&t.publish("tracking/record","Discount codes","Not Valid",o.basketDiscountCode),"discount.code.customer.invalidforuser"===o.basketMessage&&t.publish("tracking/record","Discount codes","Not Valid",o.basketDiscountCode),"discount.code.customer.not.logged.in"===o.basketMessage&&t.publish("tracking/record","Discount codes","Customer Not Logged In",o.basketDiscountCode),"discount.code.customer.notloggedin"===o.basketMessage&&t.publish("tracking/record","Discount codes","Customer Not Logged In",o.basketDiscountCode),"discount.code.expired"===o.basketMessage&&t.publish("tracking/record","Discount codes","Expired",o.basketDiscountCode),"discount.code.gift.not.in.stock"===o.basketMessage&&t.publish("tracking/record","Discount codes","Gift Not In Stock",o.basketDiscountCode),"discount.code.gift.offer.not.in.stock.postfix"===o.basketMessage&&t.publish("tracking/record","Discount codes","Gift Not In Stock",o.basketDiscountCode),"discount.code.gift.offer.not.in.stock.prefix"===o.basketMessage&&t.publish("tracking/record","Discount codes","Gift Not In Stock",o.basketDiscountCode),"discount.code.not.applied"===o.basketMessage&&t.publish("tracking/record","Discount codes","Not Applicable to Basket Content",o.basketDiscountCode),"discount.code.unqualified"===o.basketMessage&&t.publish("tracking/record","Discount codes","Not Applicable to Basket Content",o.basketDiscountCode),"discount.code.Not.Applicable.to.Basket.Content"===o.basketMessage&&t.publish("tracking/record","Discount codes","Not Applicable to Basket Content",o.basketDiscountCode),(o.basketMessage||o.discountCodeApplied)&&t.publish("tracking/record","Basket Message",o.basketMessage,o.basketDiscountCode))}catch(e){t.publish("tracking/record","gtmEventsError","Discount codes",e.message)}try{for(var l=document.querySelectorAll(".bannertrack"),u=[],d=0;d<l.length;d++)u.push(l[d].parentNode);t.select(u).on("click",function(){var e=this.parentNode,r=t.element.getAttribute("alt",e.querySelector("img")),c=t.element.getAttribute("rel",e);""===r&&(r="Misc"),t.publish("tracking/record","banner track",c,c+" "+r)})}catch(e){t.publish("javascript/error","gtmEventsError","banner track",e)}try{t.select("#left-rail .panel a").on("click",function(){var r=this,c=t.element.getText(true,this),o=t.element.getAttribute("id",e);""===c&&(c="noText"),""===o&&(o="noDept"),t.publish("tracking/record","Left Nav","Nav Click","Left Nav - "+o+" - "+c)})}catch(e){t.publish("javascript/error","gtmEventsError","Left Nav Nav click",e)}try{var g=document.querySelectorAll(".checkoutStartForm");t.select(g).on("click",function(){t.publish("tracking/record","Link","Go To Checkout")},g)}catch(e){t.publish("tracking/record","gtmEventsError",'Mobile go to checkout "form" tag',e.message)}try{t.select(document.getElementsByTagName("a")).containsString("checkoutStart.account","href").on("click",function(){t.publish("tracking/record","Link","Go to Checkout")})}catch(e){t.publish("javascript/error","gtmEventsError",'Link go to checkout "a" tag',e)}try{t.select(document.getElementsByTagName("a")).containsString("my.basket","href").on("click",function(){var e=this,r=t.element.getText(true,this);""===r&&(r="noText"),t.publish("tracking/record","Link","Go to Basket",r)})}catch(e){t.publish("javascript/error","gtmEventsError","Link go to basket",e)}try{document.getElementsByTagName("button").length>0&&t.select(document.getElementsByTagName("button")).containsString("gotocheckout","class").on("click",function(){t.publish("tracking/record","Link","Go To Checkout")})}catch(e){t.publish("javascript/error","gtmEventsError","Link go to checkout button",e)}try{t.select(".carousel-upsell .productbuy").on("click",function(){t.publish("tracking/record","click","Added the product SKU ("+t.element.closest(".item",this).getAttribute("rel")+") to the basket.")})}catch(e){t.publish("javascript/error","gtmEventsError","Added the product SKU",e)}try{if("undefined"!=typeof twttr){var p={click:"",tweet:"",retweet:"source_tweet_id",follow:"screen_name",favorite:"tweet_id"},m=function e(r){if(r){var c="click"===r.type?r.region:r.data?r.data[p[r.type]]:"",o=window.location.href;t.publish("tracking/record","twitter",r.type,c+" - "+o)}};for(var h in p)p.hasOwnProperty(h)&&window.twttr.events.bind(h,m)}}catch(e){t.publish("javascript/error","gtmEventsError","twitter",e)}try{"undefined"!=typeof FB&&(window.FB.Event.subscribe("edge.create",function(e){t.publish("tracking/record","facebook","like",e)}),window.FB.Event.subscribe("message.send",function(e){t.publish("tracking/record","facebook","send",e)}),window.FB.Event.subscribe("edge.remove",function(e){t.publish("tracking/record","unlike",e)}))}catch(e){t.publish("javascript/error","gtmEventsError","facebook tracking",e)}try{var k=document.querySelectorAll(".sticky-social-item a");t.on("click",function(){var e=this,r=this.querySelector(".sticky-social-text");t.publish("tracking/record","click","sticky social icon "+t.element.getText(true,r))},k)}catch(e){t.publish("tracking/record","gtmEventsError","sticky social icon",e.message)}try{var b=document.querySelectorAll(".gotocheckout-top");t.on("click",function(){t.publish("tracking/record","Basket | Navigation","Checkout","Checkout Button Top")},b)}catch(e){t.publish("tracking/record","gtmEventsError","Checkout Button Top",e.message)}try{var v=document.querySelectorAll(".gotocheckout-bottom");t.on("click",function(){t.publish("tracking/record","Basket | Navigation","Checkout","Checkout Button Bottom")},v)}catch(e){t.publish("tracking/record","gtmEventsError","Checkout Button Bottom",e.message)}try{if("basket"===o.page){var y=document.querySelectorAll(".quickview-buy");t.on("click",function(){var e=this,r=this.getAttribute("href"),c=i.splitOn(r,"/"),o=c[4],n=c[5],a=i.splitOn(n,".")[0];t.publish("tracking/record","Basket | Recommendation","Overlay Viewed",o+" | "+a)},y)}}catch(e){t.publish("tracking/record","gtmEventsError","Overlay Viewed",e.message)}try{var f=document.getElementById("basket-delivery-options"),E=o.customerLocation;t.on("change",function(){var e=f.options[f.selectedIndex].value;t.publish("tracking/record","Testing","LF Basket Test",E+" | "+e)},f)}catch(e){t.publish("tracking/record","gtmEventsError","Delivery Country Change",e.message)}try{var C=document.querySelectorAll(".back-to-mobile a");t.on("click",function(){t.publish("tracking/record","Back to mobile","click")},C)}catch(e){t.publish("tracking/record","gtmEventsError","Back to mobile",e.message)}var w=document.querySelectorAll(".js-ajax-basket").length?".js-basket, .js-ajax-basket":null;try{if("basket"===o.page&&"true"===o.features.enhancedEcommerce){var S=document.querySelectorAll(w||".auto-basketaction-add");t.on("click",function(t){r.sendValues(t,"auto-basketaction-add","addToCart","add")},S)}}catch(e){t.publish("tracking/record","gtmEventsError","add to cart",e.message)}try{if("basket"===o.page&&"true"===o.features.enhancedEcommerce){var A=document.querySelectorAll(w||".auto-basketaction-delete");t.on("click",function(t){r.sendValues(t,"auto-basketaction-delete","removeFromCart","remove")},A)}}catch(e){t.publish("tracking/record","gtmEventsError","remove from cart",e.message)}try{if("basket"===o.page&&"true"===o.features.enhancedEcommerce){var T=document.querySelectorAll(w||".auto-basketaction-trash");t.on("click",function(t){r.sendValues(t,"auto-basketaction-trash","removeFromCart","remove",true)},T)}}catch(e){t.publish("tracking/record","gtmEventsError","remove from cart",e.message)}try{if(("list"===o.type||"search"===o.section)&&"true"===o.features.enhancedEcommerce){var q=document.querySelectorAll(".js-enhanced-ecommerce");t.on("click",function(t){r.sendValues(t,"productbuy","addToCart","add")},q)}}catch(e){t.publish("tracking/record","gtmEventsError","add to cart",e.message)}try{if("product"===o.type&&"true"===o.features.enhancedEcommerce){var j=null,D=document.querySelectorAll(".js-enhanced-ecommerce button.js-buynow"),N=document.querySelectorAll(".js-enhanced-ecommerce .productbuy"),x=null;N.length?(j=N,x="productbuy"):D.length&&(j=D,x="js-buynow"),null!==j&&t.on("click",function(t){r.sendValues(t,x,"addToCart","add")},j)}}catch(e){t.publish("tracking/record","gtmEventsError","add to cart",e.message)}try{if(o.features.formTimer){var B=document.querySelector(".js-formTimer"),M;(new c).init(B)}}catch(e){t.publish("tracking/record","gtmEventsError","form timer",e.message)}try{t.select(".section-nav a, header a").on("click",function(e){var r=this.innerText||this.textContent||"",c=this.href||"";t.publish("tracking/record","Navigation Header","Clicked "+r,c)})}catch(e){t.publish("javascript/error","gtmEventsError","widget tracking",e)}try{t.select('[data-track*="product-thumb-box"]').on("click",function(e){var r=e.target.alt||t.element.closest(".product-title").innerText,c=i.splitSrc(e)||[],o=c[c.length-1],n=i.splitOn(i.splitOn(o,".")[0],"-")[0];t.publish("tracking/record","Product Page Navigation",r+" | Click Product Thumbnail",n)})}catch(e){t.publish("javascript/error","gtmEventsError","Product Thumbnail Tracking")}try{t.select('[data-track*="main-product-image"]').on("click",function(e){var r=e.target.alt||e.target.querySelector("img").alt,c=i.splitSrc(e)||i.splitSrc(e.target.querySelector("img"))||[],o=c[c.length-1],n=i.splitOn(i.splitOn(o,".")[0],"-")[0];t.publish("tracking/record","Product Page Navigation",r+" | Click Main Product Image",n)})}catch(e){t.publish("javascript/error","gtmEventsError","Product Thumbnail Tracking")}try{if(document.querySelectorAll('[data-track*="ads-panel"]').length){var L=window.location.host+window.location.pathname;t.publish("tracking/record","Adverts",L+" | Ad Shown")}}catch(e){t.publish("javascript/error","gtmEventsError","Ad Impressions Tracking")}try{t.select('[data-track*="product-image"]').on("click",function(e){var r=window.location.host+window.location.pathname,c=i.splitSrc(e)||i.splitSrc(e.target.querySelector("img"))||i.splitHref(e)||[],o=c[c.length-1],n=i.splitOn(i.splitOn(o,".")[0],"-")[0],a=i.splitOn(window.location.pathname,".");"list"===a[a.length-1]&&t.publish("tracking/record","List Page Navigation",r+" | Click Product Image",n)})}catch(e){t.publish("javascript/error","gtmEventsError","List Page Navigation Tracking")}try{t.select(".rsArrow").on("click",function(){var e=window.location.hostname+window.location.pathname,r=e+" Carousel";t.publish("tracking/record","Carousel Navigation",e+" | Click Arrow",r)})}catch(e){t.publish("javascript/error","Carousel Navigation","click")}try{t.select(".rsBullet").on("click",function(e){var r=window.location.hostname+window.location.pathname,c=r+" Carousel";t.publish("tracking/record","Carousel Navigation",r+" | Click Dot",c)})}catch(e){t.publish("javascript/error","Carousel Navigation","click")}}function a(t,e){return t?t.split(e||" "):[]}function s(t){var e=t&&t.target?i.splitOn(t.target.src,"/"):[];return e.length?e:null}function l(t){var e=t&&t.target?i.splitOn(t.target.href,"/"):[];return e.length?e:null}i.init=n,i.splitOn=a,i.splitHref=l,i.splitSrc=s};return n.init(),n});
//# sourceMappingURL=gtm-script-esl-e6c92533e9.js.map
