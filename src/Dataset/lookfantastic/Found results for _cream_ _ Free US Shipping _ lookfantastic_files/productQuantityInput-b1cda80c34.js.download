"use strict";define(["app"],function(t){var e;return function e(){var a={},n={classes:{showClass:"showClass",hideClass:"hideClass",inputError:"productQuantityInput_error"},selectors:{productQuantityInputBlock:"[data-product-quantity-input-block]",inputMessageBlock:"[data-message-block]",inputMessageBlockQuantities:"[data-message-block-quantities]",inputMessageBasketLimit:"[data-message=basketLimit]",inputMessageBasketSingleItem:"[data-message=basketSingleItem]",inputMessageBasketMultipleItems:"[data-message=basketMultipleItems]",inputSelector:"[data-quantity-input]",increaseSelector:"[data-quantity-button=increase]",decreaseSelector:"[data-quantity-button=decrease]",maximumQuantityMessageSelector:"[data-quantity-message=maximumValue]",maximumQuantityParentSelector:"[data-quantity-message=maximumValueParent]",currentQuantityMessageSelector:"[data-quantity-message=currentQuantityInBasket]",currentQuantityMessageParentSelector:"[data-quantity-message=currentQuantityInBasketParent]",visibilityWrapper:"[data-product-quantity-visibilty-wrapper]"},subscribeChannels:{quantity:"productQuantityInput/quantityData",disable:"productQuantityInput/disable",updateVisibility:"productQuantity/updateVisbilty",productQuantity:"productQuantity/productQuantity",productAdded:"addedToBasketModal/productAdded"},quantityMaxLength:2,quantityBoxMaximumItems:99,quantityMaximumAllowedLength:5e3},u=function t(e){if(a.element=e,a.element){a.productQuantityInputBlock=a.element.querySelector(a.config.selectors.productQuantityInputBlock),a.quantityInput=a.element.querySelector(a.config.selectors.inputSelector),a.increaseButton=a.element.querySelector(a.config.selectors.increaseSelector),a.decreaseButton=a.element.querySelector(a.config.selectors.decreaseSelector),a.maximumQuantityMessage=a.element.parentElement.querySelector(a.config.selectors.maximumQuantityMessageSelector),a.maximumQuantityParent=a.element.parentElement.querySelector(a.config.selectors.maximumQuantityParentSelector),a.currentQuantityMessage=a.element.parentElement.querySelector(a.config.selectors.currentQuantityMessageSelector),a.currentQuantityMessageParents=a.element.parentElement.querySelectorAll(a.config.selectors.currentQuantityMessageParentSelector),a.messageBlock=a.element.parentElement.querySelector(a.config.selectors.inputMessageBlock),a.messageBlockQuantities=a.element.parentElement.querySelector(a.config.selectors.inputMessageBlockQuantities),a.inputMessageBasketLimit=a.element.parentElement.querySelector(a.config.selectors.inputMessageBasketLimit),a.inputMessageBasketSingleItem=a.element.parentElement.querySelector(a.config.selectors.inputMessageBasketSingleItem),a.inputMessageBasketMultipleItems=a.element.parentElement.querySelector(a.config.selectors.inputMessageBasketMultipleItems),a.visibilityWrapper=document.querySelector(a.config.selectors.visibilityWrapper),a.quantityValue=1,a.addEventListeners(),a.publishQuantity();var n={numberOfItemsInBasket:a.currentQuantityMessage.textContent,maximumNumberOfItemsToAdd:a.maximumQuantityMessage.textContent};a.showQuantityInputMessage(n),a.subscribe()}return a},s=function e(){t.subscribe(a.config.subscribeChannels.updateVisibility,a.updateVisbilty),t.subscribe(a.config.subscribeChannels.productQuantity,a.showQuantityInputMessage),t.subscribe(a.config.subscribeChannels.productAdded,a.updateQuantityInBasket),t.subscribe(a.config.subscribeChannels.disable,a.updateComponentState)},i=function t(){a.quantityInput.addEventListener("input",a.validateLength),a.quantityInput.addEventListener("change",a.changeEvent),a.increaseButton.addEventListener("click",a.increaseQuantity),a.decreaseButton.addEventListener("click",a.decreaseQuantity)},l=function t(e){var n=e.target;n.value.length>a.config.quantityMaxLength&&(n.value=n.value.substring(0,a.config.quantityMaxLength))},r=function e(){t.publish(a.config.subscribeChannels.quantity,{value:a.quantityValue,max:a.quantityMaximum,inBasket:a.quantityInBasket},true)},o=function t(){a.quantityValue=a.parseQuantityValue(a.quantityInput.value)},m=function t(){a.updateQuantityValue();var e=a.quantityValue;e++<a.quantityInput.max&&(a.quantityValue=e,a.quantityInput.value=e,a.publishQuantity()),a.handleQuantityButtons(),a.showMaximumQuantityMessage(),a.updateAddToBasketButtonState()},c=function t(){a.updateQuantityValue();var e=a.quantityValue;e-- >a.quantityInput.min&&(a.quantityValue=e,a.quantityInput.value=e,a.publishQuantity()),a.handleQuantityButtons(),a.showMaximumQuantityMessage(),a.updateAddToBasketButtonState()},y=function t(){a.updateQuantityValue(),a.quantityValue+a.quantityInBasket>a.quantityMaximum&&(a.quantityValue=a.quantityMaximum-a.quantityInBasket,a.quantityInput.value=a.quantityValue),a.publishQuantity(),a.handleQuantityButtons(),a.updateAddToBasketButtonState(),a.showMaximumQuantityMessage()},d=function t(){if(0!==a.quantityInBasket&&a.quantityInBasket===a.quantityMaximum)return a.inputBoxFeedback("error"),a.disableQuantityInput(),void 0;a.inputBoxFeedback("default"),a.quantityInput.disabled=false,a.quantityValue+a.quantityInBasket>=a.quantityMaximum||a.quantityValue>=a.config.quantityBoxMaximumItems?(a.increaseButton.disabled=true,a.addLabelledByToButton(a.increaseButton),a.inputBoxFeedback("error")):(a.increaseButton.disabled=false,a.removeLabelledByFromButton(a.increaseButton),a.inputBoxFeedback("default")),a.quantityValue<=1?a.decreaseButton.disabled=true:a.decreaseButton.disabled=false},p=function e(){a.quantityMaximum===a.config.quantityMaximumAllowedLength||0===a.quantityMaximum||a.quantityMaximum>a.quantityValue&&0===a.quantityInBasket?(t.element.addClass(a.config.classes.hideClass,a.maximumQuantityParent),t.element.removeClass(a.config.classes.showClass,a.maximumQuantityParent)):(t.element.removeClass(a.config.classes.hideClass,a.maximumQuantityParent),t.element.addClass(a.config.classes.showClass,a.maximumQuantityParent))},g=function t(e){var n=parseInt(e,10);if(isNaN(n))return a.quantityInput.value=1,1;return n},q=function t(){a.quantityValue=parseInt(a.quantityValue,10),a.quantityInBasket=parseInt(a.quantityInBasket,10),a.quantityMaximum=parseInt(a.quantityMaximum,10)},B=function t(){a.quantityInput.disabled=true,a.increaseButton.disabled=true,a.decreaseButton.disabled=true},b=function t(e){a.quantityInBasket+=e.productQuantity;var n={numberOfItemsInBasket:a.quantityInBasket,maximumNumberOfItemsToAdd:a.quantityMaximum};a.showQuantityInputMessage(n)},I=function e(n){a.quantityMaximum=null===n.maximumNumberOfItemsToAdd||isNaN(n.maximumNumberOfItemsToAdd)||""===n.maximumNumberOfItemsToAdd?a.config.quantityMaximumAllowedLength:parseInt(n.maximumNumberOfItemsToAdd),a.quantityInBasket=null===n.numberOfItemsInBasket||isNaN(n.numberOfItemsInBasket)||""===n.numberOfItemsInBasket?1:parseInt(n.numberOfItemsInBasket),a.quantityMaximum-a.quantityInBasket>0&&a.quantityValue+a.quantityInBasket>a.quantityMaximum&&(a.quantityMaximum===a.quantityInBasket?(a.quantityValue=1,a.quantityInput.value=1):(a.quantityValue=a.quantityMaximum-a.quantityInBasket,a.quantityInput.value=a.quantityValue)),a.handleQuantityButtons(),a.updateAddToBasketButtonState(),a.quantityMaximum<a.config.quantityMaximumAllowedLength&&t.element.addClass(a.config.classes.showClass,a.maximumQuantityParent),a.maximumQuantityMessage.textContent=a.quantityMaximum,a.currentQuantityMessage.textContent=a.quantityInBasket,a.quantityInBasket>0&&a.quantityMaximum<a.config.quantityMaximumAllowedLength?t.element.addClass(a.config.classes.showClass,a.messageBlockQuantities):t.element.removeClass(a.config.classes.showClass,a.messageBlockQuantities),a.quantityInBasket>1?(t.element.removeClass(a.config.classes.showClass,a.inputMessageBasketSingleItem),t.element.addClass(a.config.classes.showClass,a.inputMessageBasketMultipleItems)):1===a.quantityInBasket&&(t.element.removeClass(a.config.classes.showClass,a.inputMessageBasketMultipleItems),t.element.addClass(a.config.classes.showClass,a.inputMessageBasketSingleItem)),a.showMaximumQuantityMessage(),a.publishQuantity()},f=function t(e,a){var n;e.messages.length>0&&a(e.messages.slice(-1)[0])},M=function e(n){"error"===n?t.element.addClass(a.config.classes.inputError,a.productQuantityInputBlock):t.element.removeClass(a.config.classes.inputError,a.productQuantityInputBlock)},k=function e(n){a.messageBlock.id&&t.element.setAttribute("aria-labelledby",a.messageBlock.id,n)},Q=function e(a){t.element.removeAttribute("aria-labelledby",a)},x=function t(e){if(!a.visibilityWrapper)return;a.visibilityWrapper.setAttribute("data-show",""+!!e)},h=function t(e){e?a.element.classList.add("disabled"):a.element.classList.remove("disabled")};return a.init=u,a.config=n,a.addEventListeners=i,a.validateLength=l,a.publishQuantity=r,a.updateQuantityValue=o,a.increaseQuantity=m,a.decreaseQuantity=c,a.parseQuantityValue=g,a.changeEvent=y,a.showQuantityInputMessage=I,a.disableQuantityInput=B,a.updateAddToBasketButtonState=q,a.showMaximumQuantityMessage=p,a.handleQuantityButtons=d,a.updateQuantityInBasket=b,a.checkSubscribeMessages=f,a.inputBoxFeedback=M,a.addLabelledByToButton=k,a.removeLabelledByFromButton=Q,a.updateVisbilty=x,a.updateComponentState=h,a.subscribe=s,a}});
//# sourceMappingURL=productQuantityInput-b1cda80c34.js.map
