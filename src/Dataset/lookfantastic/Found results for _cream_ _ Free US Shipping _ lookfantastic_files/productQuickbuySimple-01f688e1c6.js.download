"use strict";var _slicedToArray=function(){function t(t,e){var a=[],r=true,o=false,s=void 0;try{for(var d=t[Symbol.iterator](),n;!(r=(n=d.next()).done);r=true)if(a.push(n.value),e&&a.length===e)break}catch(t){o=true,s=t}finally{try{!r&&d["return"]&&d["return"]()}finally{if(o)throw s}}return a}return function(e,a){if(Array.isArray(e))return e;if(Symbol.iterator in Object(e))return t(e,a);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}();define(["app","module"],function(t,e){var a=function a(){var o={},s={dataAttributes:{productIdSelector:"data-product-id",siteIdSelector:"data-site-id",fromWishlist:"data-from-wishlist",defaultLocaleSelector:"data-default-locale",subsiteCodeSelector:"data-subsite-code",headerBasketSelector:"header-basket",basketItemsSelector:"basket-items",basketQuantityClass:"header-menu-basket-counter",recommendationContext:"data-context",recommendationParent:"[data-component=productRecommendations]"},subscribeChannels:{addedToBasket:"productAddedToBasket/loadSuccess"},soldOutClass:"productQuickbuySimple-soldOut"},d=function t(a){return o.element=a,o.element&&(o.productId=o.element.getAttribute(o.config.dataAttributes.productIdSelector),o.siteId=o.element.getAttribute(o.config.dataAttributes.siteIdSelector),o.defaultLocale=o.element.getAttribute(o.config.dataAttributes.defaultLocaleSelector),o.subsiteCode=o.element.getAttribute(o.config.dataAttributes.subsiteCodeSelector),o.fromWishlist=o.element.getAttribute(o.config.dataAttributes.fromWishlist),o.element.addEventListener("click",o.triggerAddToBasket)),o.basketHeaderClass=e.config().basketHeaderClass||o.config.dataAttributes.headerBasketSelector,o.basketHeaderID=e.config().basketHeaderID||false,o.basketItemsContainerClass=e.config().basketItemsContainerClass||o.config.dataAttributes.basketItemsSelector,o.context=o.getRecommendationContext(),o},n=function t(e,a){var r;e.messages.length>0&&a(e.messages.slice(-1)[0])},i=function e(a){a.preventDefault(),t.publish("addedToBasketModal/hideError","",false),t.publish("productQuickbuy/hideError","",false),t.publish("productQuickbuy/startLoading","",false),t.publish("tracking/record","Product | AddToBasket","clicked",o.productId);var r={productId:o.productId,siteId:o.siteId,siteDefaultLocale:o.defaultLocale,siteSubsiteCode:o.subsiteCode,variationLength:0,quantity:1,fromWishlist:o.fromWishlist};o.context&&(r["rctxt"]=o.context),o.postAddToBasket(r)},u=function e(a){a&&Object.keys(a).length>0&&t.ajax.get({url:"/basketinterface.json?"+r(a),success:o.addToBasketSuccess,error:o.addToBasketError})},c=function e(){t.publish("productQuickbuy/stopLoading","",false),t.publish("productQuickbuy/showError","",false),t.publish("addedToBasketModal/showError","",false)},l=function e(a){var r=JSON.parse(a),s=o.getLastAddedItemData(r.simpleBasket);t.publish("productQuickbuy/hideModal","",false),t.publish("addedToBasketModal/productAdded",s,false),t.publish("globalBasketItemsCount/updateGlobalBasketItemsCount",s.basketTotalItems),t.publish("BasketItemAdded",r)},m=function t(e){var a=e.lastAddedItem,r={productId:a.productId,productTitle:a.productTitle,productUrl:a.productURL,productQuantity:e.lastAddedQuantity,productQuantityRequested:e.lastAddedQuantityRequested,productPrice:a.price,basketTotalPrice:e.totalprice,recommendations:e.recommendations,basketTotalItems:e.totalUnits,message:e.message,lastAddedMaxPerOrder:a.maxPerOrder,loyaltySchemePoints:e.loyaltySchemePoints},o="";return a.productImages&&a.productImages.largeproduct&&(o=a.productImages.largeproduct),r.productImageUrl=o,r},p=function t(){Element.prototype.matches||(Element.prototype.matches=Element.prototype.msMatchesSelector||Element.prototype.webkitMatchesSelector),Element.prototype.closest||(Element.prototype.closest=function(t){var e=this;if(!document.documentElement.contains(e))return null;do{if(e.matches(t))return e;e=e.parentElement||e.parentNode}while(null!==e&&1===e.nodeType);return null});var e=o.element.closest(o.config.dataAttributes.recommendationParent);return e?e.getAttribute(o.config.dataAttributes.recommendationContext):""};return o.init=d,o.config=s,o.checkSubscribeMessages=n,o.triggerAddToBasket=i,o.postAddToBasket=u,o.addToBasketSuccess=l,o.addToBasketError=c,o.getLastAddedItemData=m,o.getRecommendationContext=p,o},r=function t(e){return Object.entries(e).map(function(t){var e=_slicedToArray(t,2),a,r;return e[0]+"="+e[1]}).join("&")};return a});
//# sourceMappingURL=productQuickbuySimple-01f688e1c6.js.map
