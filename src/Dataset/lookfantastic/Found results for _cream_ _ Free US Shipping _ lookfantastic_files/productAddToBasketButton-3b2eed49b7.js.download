"use strict";define(["app","productAddToBasket","$window"],function(t,e,n){var a;return function a(){var s=this,r={selectors:{component:"[data-component=productAddToBasketButton]",productAddToBasketButton:"[data-product-add-to-basket-button]",isSticky:"[data-issticky]",productAddToBasket:".productAddToBasket"},attr:{hasDigitalOrPhysicalOption:"data-has-digital-or-physical-sku",hasAlternativeWording:"data-has-alternative-wording-enabled",disabled:"disabled",purchaseMethod:"data-basket-purchase-method"},classes:{stickClass:"productAddToBasket-sticky"},subscribeChannels:{addToBasketButton:"productAddToBasketButton/newButton"}},o=function e(n){return s.element=n,t.subscribe(s.config.subscribeChannels.addToBasketButton,s.updateButton),s.addEventListeners(),s},i=function t(){s.element&&s.element.querySelector(r.selectors.isSticky)&&(n.addEventListener("scroll",s.callStickEvent),s.callStickEvent())},c=function t(){var e=s.getStickyBtnWrapper();s.stickEvent(e)},d=function t(){var e=document.querySelector(r.selectors.isSticky);if(e)return e.parentElement;return null},u=function t(e){if(e){var a=n.innerHeight,s,o;e.getBoundingClientRect().bottom<a&&!e.classList.contains(r.classes.stickClass)&&e.classList.add(r.classes.stickClass),e.parentElement.getBoundingClientRect().top+e.clientHeight>=a&&e.classList.contains(r.classes.stickClass)&&e.classList.remove(r.classes.stickClass)}},l=function n(a){var r=document.createElement("div");r.innerHTML=a;var o=r.querySelector(s.config.selectors.component),i,c;o.hasAttribute(s.config.attr.hasDigitalOrPhysicalOption)&&(s.element.parentNode.replaceChild(o,s.element),s.element=o);var d=o.querySelector(s.config.selectors.productAddToBasketButton),u=s.element.querySelector(s.config.selectors.productAddToBasketButton);if(d){s.element.removeChild(u),s.element.appendChild(d);var l=d.querySelector("[data-component=productAddToBasket]");if(l){var p=r.querySelector("[data-linked-product]");if(p)var k=p.getAttribute("data-product-id");l.componentObject=(new e).init(l,k)}}if(!o.hasAttribute("data-linked-product")){var v="true"===o.getAttribute("data-has-quantity-input");t.publish("productQuantity/updateVisbilty",v)}l&&t.publish("subscribeAndSaveProductInBasket/showMessage",l.getAttribute(s.config.attr.purchaseMethod)),s.callStickEvent()},p=function e(n,a){if(a){var r=s.element.querySelector(s.config.selectors.productAddToBasket);r&&r.setAttribute(s.config.attr.disabled,"true")}else{var o=void 0;s.element&&(o=s.element.hasAttribute(s.config.attr.hasAlternativeWording));var i="/"+n+".addtobasketbutton";o&&(i+="?useAlternativeCTAWording=true"),t.ajax.get({url:i,success:s.newButtonReceived,error:s.newButtonErrorHandler})}},k=function t(){console.error("ERROR: Could not retrieve child product add to basket button")};return s.init=o,s.config=r,s.addEventListeners=i,s.stickEvent=u,s.newButtonReceived=l,s.updateButton=p,s.newButtonErrorHandler=k,s.getStickyBtnWrapper=d,s.callStickEvent=c,s}});
//# sourceMappingURL=productAddToBasketButton-3b2eed49b7.js.map
