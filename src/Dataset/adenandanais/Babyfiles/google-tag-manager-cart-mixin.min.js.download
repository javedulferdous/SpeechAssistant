define(['jquery','Magento_GoogleTagManager/js/google-analytics-universal-cart','Magento_GoogleTagManager/js/google-analytics-universal','Magento_Customer/js/customer-data',],function($,GoogleAnalyticsUniversalCart,GoogleAnalyticsUniversal,customerData){'use strict';return function(targetWidget){$.widget('mage.gtmCart',targetWidget,{_create:function(){this.googleAnalyticsUniversalCart=new GoogleAnalyticsUniversalCart({dlCurrencyCode:this.options.dlCurrencyCode,dataLayer:this.options.dataLayer,cookieAddToCart:this.options.cookieAddToCart,cookieRemoveFromCart:this.options.cookieRemoveFromCart});this.googleAnalyticsUniversal=new GoogleAnalyticsUniversal({blockNames:this.options.blockNames,dlCurrencyCode:this.options.dlCurrencyCode,dataLayer:this.options.dataLayer,staticImpressions:this.options.staticImpressions,staticPromotions:this.options.staticPromotions,updatedImpressions:this.options.updatedImpressions,updatedPromotions:this.options.updatedPromotions});this.cartItemsCache=[];this._initActions();this._setListeners();this._setCartDataListener();this.googleAnalyticsUniversal.updatePromotions();this.googleAnalyticsUniversal.updateImpressions();this.googleAnalyticsUniversalCart.parseAddToCartCookies();this.googleAnalyticsUniversalCart.subscribeProductsUpdateInCart();this.googleAnalyticsUniversalCart.listenMinicartReload();this.options.dataLayer.push({'ecommerce':{'impressions':0,'promoView':0}});},_setCartDataListener:function(){let cartItems=customerData.get('cart')().items;if(Array.isArray(cartItems)){this.cartItemsCache=cartItems.slice();}
this._super();}});return $.mage.gtmCart;}});