var iStockUrl='https://';iStockUrl+='istock.myshopapps.com/ajax/';if(typeof iStockSelectClass==='undefined'){var iStockSelectClass="#product-select, .selector-wrapper > select,  .single-option-selector, .single-option-selector__radio"}
if(typeof iStockWraperClass==='undefined'){var iStockWraperClass='form'}
if(typeof iStockVarSelector==='undefined'){var iStockVarSelector='[name=id]'}
if(typeof iStockAllowResubscribe==='undefined'){var iStockAllowResubscribe=!0}
var iStockShopId=0;var iStockavlDtFormat='';var istExcludeProd='';var istExcludeVar='';var availDates=[];var iStockProduct={};var iStockpHandle='';var iStockVariant={};var iStockVarIdOld=0;if(typeof(Storage)!=="undefined"&&sessionStorage.iStockShop){if(sessionStorage.iStockShopId){iStockShopId=sessionStorage.iStockShopId}
if(sessionStorage.iStockavlDtFormat){iStockavlDtFormat=sessionStorage.iStockavlDtFormat}
if(sessionStorage.istExcludeProd){istExcludeProd=sessionStorage.istExcludeProd}
if(sessionStorage.istExcludeVar){istExcludeVar=sessionStorage.istExcludeVar}}
function iStockValidateEmail(emailId){var regex=/^([a-zA-Z0-9_.+-])+\@(([a-zA-Z0-9-])+\.)+([a-zA-Z0-9]{2,4})+$/;return regex.test(emailId)}
function istockGetVariant(iStockVarId,iStockVariants){var istockGetVariant=!1;jQuery.each(iStockVariants,function(key,value){if(value.id==iStockVarId){istockGetVariant=value}});return istockGetVariant}
function istockNotifyClick(istockBtnObj){istockBtnObj.addClass("disabled");istockBtnObj.attr("disabled","disabled");var istockFormWrap=istockBtnObj.parents(iStockWraperClass);istockFormWrap.find('.iStock-msg').removeClass('iStock-error').hide();var emailId=istockFormWrap.find('.iStock-email-id').val();console.log('Adding :: '+iStockProduct.title+' : '+iStockVariant.title+' : '+emailId+' : '+iStockProduct.id+' : '+iStockVariant.id);if(!iStockValidateEmail(emailId)){istockFormWrap.find('.iStock-msg').html(iStockErrorMsg).addClass('iStock-error').show();setTimeout(function(){istockBtnObj.removeClass("disabled");istockBtnObj.attr("disabled",!1)},500)}else{jQuery.ajax({url:iStockUrl+'add_notify.php',data:{shopId:iStockShopId,cust:emailId,vid:iStockVariant.id,pid:iStockProduct.id,vTitle:iStockVariant.title,pTitle:iStockProduct.title},dataType:'jsonp',jsonpCallback:'iStockAddNotifyCallback',success:function(json){if(json.insertId!=0){istockFormWrap.find('.iStock-msg').html(iStockSuccessMsg).show();istockFormWrap.find('input.iStock-email-id').val('')}
if(typeof iStockAddFn!=='undefined'&&typeof iStockAddFn==='function'){iStockAddFn()}},error:function(err){}}).done(function(){istockBtnObj.removeClass("disabled");istockBtnObj.attr("disabled",!1)})}}
function iStockUrlParam(pname){var results=new RegExp('[\?&]'+pname+'=([^&#]*)').exec(window.location.href);if(results!=null){return results[1]||0}
return results}
function iStockResubscribe(istockFormWrap){var emailId=decodeURIComponent(iStockUrlParam('customer'));if(emailId!=null&&iStockValidateEmail(emailId)){istockFormWrap.find('.iStock-email-id').val(emailId);istockNotifyClick(jQuery(istockFormWrap).find('.iStock-notify-btn'));var sPageURL=window.location.href;var sUpdateUrl=sPageURL.split('?');window.history.replaceState(null,null,sUpdateUrl[0])}}
function istockSetVistited(istockFormWrap){var iStockVarId=parseInt(istockFormWrap.find(iStockVarSelector).val());var emailId=decodeURIComponent(iStockUrlParam('customer'));if(iStockVarId!=null&&emailId!=null&&iStockValidateEmail(emailId)){jQuery.ajax({url:iStockUrl+'set_visited.php',data:{shopId:iStockShopId,vid:iStockVarId,cust:emailId},dataType:'jsonp',jsonpCallback:'iStockSetVisitedCallback',success:function(jsonDt){console.log('set visited : '+JSON.stringify(jsonDt.updated))}})}}
function istockNotifyShow(product,istockFormWrap){var iStockVarId=parseInt(istockFormWrap.find(iStockVarSelector).val());if(iStockVarId!=null&&iStockVarId!=iStockVarIdOld){var iStockProductId=product.id;if(istExcludeProd.indexOf(iStockProductId)>=0){console.log('product excluded ::'+iStockProductId);return!1}else if(istExcludeVar.indexOf(iStockVarId)>=0){console.log('variant excluded ::'+iStockVarId);return!1}
iStockVariant=istockGetVariant(iStockVarId,product.variants);var istockShowNotify=!1;if(iStockVariant){if(iStockAllowPreorder){var preordertag=product.tags;if(typeof iStockVariantObj!=='undefined'&&Object.keys(iStockVariantObj).length>0){if(iStockVariantObj.inventory_policy=='continue'&&iStockVariantObj.inventory_quantity<=0){istockShowNotify=!0}else if(iStockVariantObj.available==!1){istockShowNotify=!0}}else if(preordertag.indexOf("istock-preorder")!=-1){istockShowNotify=!0}else if(iStockVariant.available==!1){istockShowNotify=!0}}else if(iStockVariant.available==!1){istockShowNotify=!0}}
console.log('istockNotifyShow : '+istockShowNotify+' :: '+iStockVarId);if(istockShowNotify){iStockVarIdOld=iStockVarId;if(typeof availDates[iStockVarId]!=='undefined'){if(availDates[iStockVarId].type=='0'){istockFormWrap.find(".iStock-availability").show().find("label").show()}else{istockFormWrap.find(".iStock-availability").show().find("label").hide()}
istockFormWrap.find(".iStock-availability").find("span").html(availDates[iStockVarId].val)}else{istockFormWrap.find(".iStock-availability").hide()}
istockFormWrap.find(".iStock-wrapper").show();if(typeof istockNotifyShowFn!=="undefined"&&typeof istockNotifyShowFn==='function'){istockNotifyShowFn()}
if(iStockAllowResubscribe){iStockResubscribe(istockFormWrap)}}else{iStockVarIdOld=0;istockFormWrap.find(".iStock-wrapper").hide()}}else{iStockVarIdOld=0;istockFormWrap.find(".iStock-wrapper").hide()}}
function istockgetProduct(handle,istockFormWrap){if(jQuery.isEmptyObject(iStockProduct)||iStockProduct.handle!=handle){jQuery.getJSON('/products/'+handle+'.js',function(product){iStockProduct=product;console.log('istockgetProduct : '+iStockProduct.title);var currentiStockWrap=istockFormWrap.find('.iStock-wrapper');if(currentiStockWrap.attr('handle')==''||currentiStockWrap.attr('handle')!=handle){currentiStockWrap.attr('handle',iStockProduct.handle)}
iStockProductId=iStockProduct.id;jQuery.ajax({url:iStockUrl+'check-availability.php',data:{shopId:iStockShopId,pid:iStockProductId},dataType:'jsonp',jsonpCallback:'iStockGetAvaildtCallback',success:function(jsonDt){availDates=jsonDt}}).done(function(){istockNotifyShow(iStockProduct,istockFormWrap)})})}else{istockNotifyShow(iStockProduct,istockFormWrap)}}
function istockInitQv(qvObj,handle){iStockVarIdOld=0;setTimeout(function(){jQuery("body").addClass('iStock-qvopen');var iStockQvWrap=jQuery(iStockQvWrapper+':visible');if(iStockQvWrap.find(iStockVarSelector).length>0){jQuery(".iStock-wrapper").hide().find('.iStock-msg').hide();istockgetProduct(handle,iStockQvWrap);if(typeof istockInitQvFn!=="undefined"&&typeof istockInitQvFn==='function'){istockInitQvFn()}}else{istockInitQv(qvObj,handle)}},300)}
function istockCloseQv(){jQuery("body").removeClass('iStock-qvopen');setTimeout(function(){var istockFormWrap=jQuery('.iStock-wrapper').parents(iStockWraperClass+':visible');iStockpHandle=istockFormWrap.find('.iStock-wrapper').attr("handle");if(iStockpHandle!=='undefined'){istockgetProduct(iStockpHandle,istockFormWrap)}},300)}
function istockInit(){var iCanUseOn=!!jQuery.fn.on;if(iCanUseOn){jQuery("body").on('click','.iStock-notify-btn',function(event){istockNotifyClick(jQuery(this))});jQuery("body").on('change',iStockSelectClass,function(){jQuery(".iStock-wrapper").hide().find('.iStock-msg').hide();var istockFormWrap=jQuery(this).parents(iStockWraperClass);setTimeout(function(){istockNotifyShow(iStockProduct,istockFormWrap)},300)});if(typeof iStockQvButton!=='undefined'&&typeof iStockQvWrapper!=='undefined'){jQuery("body").on('click',iStockQvButton,function(){istockInitQv(jQuery(this),jQuery(this).attr("handle"))});if(typeof iStockQvCloseButton!=='undefined'){jQuery(document).on("click",'body.iStock-qvopen',function(e){if(jQuery(e.target).is(iStockQvCloseButton)||jQuery(e.target).parents().not(iStockQvWrapper)){istockCloseQv()}})}}}
if(typeof(Storage)!=="undefined"){if(sessionStorage.iStockShop&&sessionStorage.iStockShop==iStockShop){if(iStockIsProductpage){var istockFormWrap=jQuery('.iStock-wrapper').parents(iStockWraperClass+':visible');iStockpHandle=istockFormWrap.find('.iStock-wrapper').attr("handle");if(iStockpHandle!=='undefined'){istockgetProduct(iStockpHandle,istockFormWrap)}
istockSetVistited(istockFormWrap)}}else{jQuery.ajax({url:iStockUrl+'istock_init.php',data:{shop:iStockShop},dataType:'jsonp',jsonpCallback:'iStockCallgetSessionback',success:function(json){if(json.length==0){return!1}
iStockShop=sessionStorage.iStockShop=json.iStockShop;iStockShopId=sessionStorage.iStockShopId=json.iStockShopId;iStockavlDtFormat=sessionStorage.iStockavlDtFormat=json.iStockavlDtFormat;istExcludeProd=sessionStorage.istExcludeProd=json.istExcludeProd;istExcludeVar=sessionStorage.istExcludeVar=json.istExcludeVar;if(iStockIsProductpage){var istockFormWrap=jQuery('.iStock-wrapper').parents(iStockWraperClass+':visible');iStockpHandle=istockFormWrap.find('.iStock-wrapper').attr("handle");istockgetProduct(iStockpHandle,istockFormWrap)}},error:function(jqXHR,textStatus,errorThrown){}})}}
if(typeof istockInitFn!=="undefined"&&typeof istockInitFn==='function'){istockInitFn()}}
if(window.addEventListener){window.addEventListener("load",istockInit,!1)}else if(window.attachEvent){window.attachEvent("onload",istockInit)}else{window.onload=istockInit}