(function webpackUniversalModuleDefinition(root,factory){if(typeof exports==='object'&&typeof module==='object')
module.exports=factory(require("jquery"));else if(typeof define==='function'&&define.amd)
define("bootstrap-colorpicker",["jquery"],factory);else if(typeof exports==='object')
exports["bootstrap-colorpicker"]=factory(require("jquery"));else
root["bootstrap-colorpicker"]=factory(root["jQuery"]);})(window,function(__WEBPACK_EXTERNAL_MODULE__0__){return(function(modules){var installedModules={};function __webpack_require__(moduleId){if(installedModules[moduleId]){return installedModules[moduleId].exports;}
var module=installedModules[moduleId]={i:moduleId,l:false,exports:{}};modules[moduleId].call(module.exports,module,module.exports,__webpack_require__);module.l=true;return module.exports;}
__webpack_require__.m=modules;__webpack_require__.c=installedModules;__webpack_require__.d=function(exports,name,getter){if(!__webpack_require__.o(exports,name)){Object.defineProperty(exports,name,{enumerable:true,get:getter});}};__webpack_require__.r=function(exports){if(typeof Symbol!=='undefined'&&Symbol.toStringTag){Object.defineProperty(exports,Symbol.toStringTag,{value:'Module'});}
Object.defineProperty(exports,'__esModule',{value:true});};__webpack_require__.t=function(value,mode){if(mode&1)value=__webpack_require__(value);if(mode&8)return value;if((mode&4)&&typeof value==='object'&&value&&value.__esModule)return value;var ns=Object.create(null);__webpack_require__.r(ns);Object.defineProperty(ns,'default',{enumerable:true,value:value});if(mode&2&&typeof value!='string')for(var key in value)__webpack_require__.d(ns,key,function(key){return value[key];}.bind(null,key));return ns;};__webpack_require__.n=function(module){var getter=module&&module.__esModule?function getDefault(){return module['default'];}:function getModuleExports(){return module;};__webpack_require__.d(getter,'a',getter);return getter;};__webpack_require__.o=function(object,property){return Object.prototype.hasOwnProperty.call(object,property);};__webpack_require__.p="";return __webpack_require__(__webpack_require__.s=7);})
([(function(module,exports){module.exports=__WEBPACK_EXTERNAL_MODULE__0__;}),(function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});var _createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value"in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor);}}return function(Constructor,protoProps,staticProps){if(protoProps)defineProperties(Constructor.prototype,protoProps);if(staticProps)defineProperties(Constructor,staticProps);return Constructor;};}();var _jquery=__webpack_require__(0);var _jquery2=_interopRequireDefault(_jquery);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj};}
function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function");}}
var Extension=function(){function Extension(colorpicker){var options=arguments.length>1&&arguments[1]!==undefined?arguments[1]:{};_classCallCheck(this,Extension);this.colorpicker=colorpicker;this.options=options;if(!(this.colorpicker.element&&this.colorpicker.element.length)){throw new Error('Extension: this.colorpicker.element is not valid');}
this.colorpicker.element.on('colorpickerCreate.colorpicker-ext',_jquery2.default.proxy(this.onCreate,this));this.colorpicker.element.on('colorpickerDestroy.colorpicker-ext',_jquery2.default.proxy(this.onDestroy,this));this.colorpicker.element.on('colorpickerUpdate.colorpicker-ext',_jquery2.default.proxy(this.onUpdate,this));this.colorpicker.element.on('colorpickerChange.colorpicker-ext',_jquery2.default.proxy(this.onChange,this));this.colorpicker.element.on('colorpickerInvalid.colorpicker-ext',_jquery2.default.proxy(this.onInvalid,this));this.colorpicker.element.on('colorpickerShow.colorpicker-ext',_jquery2.default.proxy(this.onShow,this));this.colorpicker.element.on('colorpickerHide.colorpicker-ext',_jquery2.default.proxy(this.onHide,this));this.colorpicker.element.on('colorpickerEnable.colorpicker-ext',_jquery2.default.proxy(this.onEnable,this));this.colorpicker.element.on('colorpickerDisable.colorpicker-ext',_jquery2.default.proxy(this.onDisable,this));}
_createClass(Extension,[{key:'resolveColor',value:function resolveColor(color){var realColor=arguments.length>1&&arguments[1]!==undefined?arguments[1]:true;return false;}},{key:'onCreate',value:function onCreate(event){}},{key:'onDestroy',value:function onDestroy(event){this.colorpicker.element.off('.colorpicker-ext');}},{key:'onUpdate',value:function onUpdate(event){}},{key:'onChange',value:function onChange(event){}},{key:'onInvalid',value:function onInvalid(event){}},{key:'onHide',value:function onHide(event){}},{key:'onShow',value:function onShow(event){}},{key:'onDisable',value:function onDisable(event){}},{key:'onEnable',value:function onEnable(event){}}]);return Extension;}();exports.default=Extension;module.exports=exports.default;}),(function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.ColorItem=exports.HSVAColor=undefined;var _createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value"in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor);}}return function(Constructor,protoProps,staticProps){if(protoProps)defineProperties(Constructor.prototype,protoProps);if(staticProps)defineProperties(Constructor,staticProps);return Constructor;};}();var _color=__webpack_require__(16);var _color2=_interopRequireDefault(_color);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj};}
function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function");}}
var HSVAColor=function(){function HSVAColor(h,s,v,a){_classCallCheck(this,HSVAColor);this.h=isNaN(h)?0:h;this.s=isNaN(s)?0:s;this.v=isNaN(v)?0:v;this.a=isNaN(h)?1:a;}
_createClass(HSVAColor,[{key:'toString',value:function toString(){return this.h+', '+this.s+'%, '+this.v+'%, '+this.a;}}]);return HSVAColor;}();var ColorItem=function(){_createClass(ColorItem,[{key:'api',value:function api(fn){for(var _len=arguments.length,args=Array(_len>1?_len-1:0),_key=1;_key<_len;_key++){args[_key-1]=arguments[_key];}
if(arguments.length===0){return this._color;}
var result=this._color[fn].apply(this._color,args);if(!(result instanceof _color2.default)){return result;}
return new ColorItem(result,this.format);}},{key:'original',get:function get(){return this._original;}}],[{key:'HSVAColor',get:function get(){return HSVAColor;}}]);function ColorItem(){var color=arguments.length>0&&arguments[0]!==undefined?arguments[0]:null;var format=arguments.length>1&&arguments[1]!==undefined?arguments[1]:null;_classCallCheck(this,ColorItem);this.replace(color,format);}
_createClass(ColorItem,[{key:'replace',value:function replace(color){var format=arguments.length>1&&arguments[1]!==undefined?arguments[1]:null;format=ColorItem.sanitizeFormat(format);this._original={color:color,format:format,valid:true};this._color=ColorItem.parse(color);if(this._color===null){this._color=(0,_color2.default)();this._original.valid=false;return;}
this._format=format?format:ColorItem.isHex(color)?'hex':this._color.model;}},{key:'isValid',value:function isValid(){return this._original.valid===true;}},{key:'setHueRatio',value:function setHueRatio(h){this.hue=(1-h)*360;}},{key:'setSaturationRatio',value:function setSaturationRatio(s){this.saturation=s*100;}},{key:'setValueRatio',value:function setValueRatio(v){this.value=(1-v)*100;}},{key:'setAlphaRatio',value:function setAlphaRatio(a){this.alpha=1-a;}},{key:'isDesaturated',value:function isDesaturated(){return this.saturation===0;}},{key:'isTransparent',value:function isTransparent(){return this.alpha===0;}},{key:'hasTransparency',value:function hasTransparency(){return this.hasAlpha()&&this.alpha<1;}},{key:'hasAlpha',value:function hasAlpha(){return!isNaN(this.alpha);}},{key:'toObject',value:function toObject(){return new HSVAColor(this.hue,this.saturation,this.value,this.alpha);}},{key:'toHsva',value:function toHsva(){return this.toObject();}},{key:'toHsvaRatio',value:function toHsvaRatio(){return new HSVAColor(this.hue/360,this.saturation/100,this.value/100,this.alpha);}},{key:'toString',value:function toString(){return this.string();}},{key:'string',value:function string(){var format=arguments.length>0&&arguments[0]!==undefined?arguments[0]:null;format=ColorItem.sanitizeFormat(format?format:this.format);if(!format){return this._color.round().string();}
if(this._color[format]===undefined){throw new Error('Unsupported color format: \''+format+'\'');}
var str=this._color[format]();return str.round?str.round().string():str;}},{key:'equals',value:function equals(color){color=color instanceof ColorItem?color:new ColorItem(color);if(!color.isValid()||!this.isValid()){return false;}
return this.hue===color.hue&&this.saturation===color.saturation&&this.value===color.value&&this.alpha===color.alpha;}},{key:'getClone',value:function getClone(){return new ColorItem(this._color,this.format);}},{key:'getCloneHueOnly',value:function getCloneHueOnly(){return new ColorItem([this.hue,100,100,1],this.format);}},{key:'getCloneOpaque',value:function getCloneOpaque(){return new ColorItem(this._color.alpha(1),this.format);}},{key:'toRgbString',value:function toRgbString(){return this.string('rgb');}},{key:'toHexString',value:function toHexString(){return this.string('hex');}},{key:'toHslString',value:function toHslString(){return this.string('hsl');}},{key:'isDark',value:function isDark(){return this._color.isDark();}},{key:'isLight',value:function isLight(){return this._color.isLight();}},{key:'generate',value:function generate(formula){var hues=[];if(Array.isArray(formula)){hues=formula;}else if(!ColorItem.colorFormulas.hasOwnProperty(formula)){throw new Error('No color formula found with the name \''+formula+'\'.');}else{hues=ColorItem.colorFormulas[formula];}
var colors=[],mainColor=this._color,format=this.format;hues.forEach(function(hue){var levels=[hue?(mainColor.hue()+hue)%360:mainColor.hue(),mainColor.saturationv(),mainColor.value(),mainColor.alpha()];colors.push(new ColorItem(levels,format));});return colors;}},{key:'hue',get:function get(){return this._color.hue();},set:function set(value){this._color=this._color.hue(value);}},{key:'saturation',get:function get(){return this._color.saturationv();},set:function set(value){this._color=this._color.saturationv(value);}},{key:'value',get:function get(){return this._color.value();},set:function set(value){this._color=this._color.value(value);}},{key:'alpha',get:function get(){var a=this._color.alpha();return isNaN(a)?1:a;},set:function set(value){this._color=this._color.alpha(Math.round(value*100)/100);}},{key:'format',get:function get(){return this._format?this._format:this._color.model;},set:function set(value){this._format=ColorItem.sanitizeFormat(value);}}],[{key:'parse',value:function parse(color){if(color instanceof _color2.default){return color;}
if(color instanceof ColorItem){return color._color;}
var format=null;if(color instanceof HSVAColor){color=[color.h,color.s,color.v,isNaN(color.a)?1:color.a];}else{color=ColorItem.sanitizeString(color);}
if(color===null){return null;}
if(Array.isArray(color)){format='hsv';}
try{return(0,_color2.default)(color,format);}catch(e){return null;}}},{key:'sanitizeString',value:function sanitizeString(str){if(!(typeof str==='string'||str instanceof String)){return str;}
if(str.match(/^[0-9a-f]{2,}$/i)){return'#'+str;}
if(str.toLowerCase()==='transparent'){return'#FFFFFF00';}
return str;}},{key:'isHex',value:function isHex(str){if(!(typeof str==='string'||str instanceof String)){return false;}
return!!str.match(/^#?[0-9a-f]{2,}$/i);}},{key:'sanitizeFormat',value:function sanitizeFormat(format){switch(format){case'hex':case'hex3':case'hex4':case'hex6':case'hex8':return'hex';case'rgb':case'rgba':case'keyword':case'name':return'rgb';case'hsl':case'hsla':case'hsv':case'hsva':case'hwb':case'hwba':return'hsl';default:return'';}}}]);return ColorItem;}();ColorItem.colorFormulas={complementary:[180],triad:[0,120,240],tetrad:[0,90,180,270],splitcomplement:[0,72,216]};exports.default=ColorItem;exports.HSVAColor=HSVAColor;exports.ColorItem=ColorItem;}),(function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});var sassVars={'bar_size_short':16,'base_margin':6,'columns':6};var sliderSize=sassVars.bar_size_short*sassVars.columns+sassVars.base_margin*(sassVars.columns-1);exports.default={customClass:null,color:false,fallbackColor:false,format:'auto',horizontal:false,inline:false,container:false,popover:{animation:true,placement:'bottom',fallbackPlacement:'flip'},debug:false,input:'input',addon:'.colorpicker-input-addon',autoInputFallback:true,useHashPrefix:true,useAlpha:true,template:'<div class="colorpicker">\n      <div class="colorpicker-saturation"><i class="colorpicker-guide"></i></div>\n      <div class="colorpicker-hue"><i class="colorpicker-guide"></i></div>\n      <div class="colorpicker-alpha">\n        <div class="colorpicker-alpha-color"></div>\n        <i class="colorpicker-guide"></i>\n      </div>\n    </div>',extensions:[{name:'preview',options:{showText:true}}],sliders:{saturation:{selector:'.colorpicker-saturation',maxLeft:sliderSize,maxTop:sliderSize,callLeft:'setSaturationRatio',callTop:'setValueRatio'},hue:{selector:'.colorpicker-hue',maxLeft:0,maxTop:sliderSize,callLeft:false,callTop:'setHueRatio'},alpha:{selector:'.colorpicker-alpha',childSelector:'.colorpicker-alpha-color',maxLeft:0,maxTop:sliderSize,callLeft:false,callTop:'setAlphaRatio'}},slidersHorz:{saturation:{selector:'.colorpicker-saturation',maxLeft:sliderSize,maxTop:sliderSize,callLeft:'setSaturationRatio',callTop:'setValueRatio'},hue:{selector:'.colorpicker-hue',maxLeft:sliderSize,maxTop:0,callLeft:'setHueRatio',callTop:false},alpha:{selector:'.colorpicker-alpha',childSelector:'.colorpicker-alpha-color',maxLeft:sliderSize,maxTop:0,callLeft:'setAlphaRatio',callTop:false}}};module.exports=exports.default;}),(function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});var _typeof=typeof Symbol==="function"&&typeof Symbol.iterator==="symbol"?function(obj){return typeof obj;}:function(obj){return obj&&typeof Symbol==="function"&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj;};var _createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value"in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor);}}return function(Constructor,protoProps,staticProps){if(protoProps)defineProperties(Constructor.prototype,protoProps);if(staticProps)defineProperties(Constructor,staticProps);return Constructor;};}();var _Extension2=__webpack_require__(1);var _Extension3=_interopRequireDefault(_Extension2);var _jquery=__webpack_require__(0);var _jquery2=_interopRequireDefault(_jquery);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj};}
function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function");}}
function _possibleConstructorReturn(self,call){if(!self){throw new ReferenceError("this hasn't been initialised - super() hasn't been called");}return call&&(typeof call==="object"||typeof call==="function")?call:self;}
function _inherits(subClass,superClass){if(typeof superClass!=="function"&&superClass!==null){throw new TypeError("Super expression must either be null or a function, not "+typeof superClass);}subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,enumerable:false,writable:true,configurable:true}});if(superClass)Object.setPrototypeOf?Object.setPrototypeOf(subClass,superClass):subClass.__proto__=superClass;}
var defaults={colors:null,namesAsValues:true};var Palette=function(_Extension){_inherits(Palette,_Extension);_createClass(Palette,[{key:'colors',get:function get(){return this.options.colors;}}]);function Palette(colorpicker){var options=arguments.length>1&&arguments[1]!==undefined?arguments[1]:{};_classCallCheck(this,Palette);var _this=_possibleConstructorReturn(this,(Palette.__proto__||Object.getPrototypeOf(Palette)).call(this,colorpicker,_jquery2.default.extend(true,{},defaults,options)));if(!Array.isArray(_this.options.colors)&&_typeof(_this.options.colors)!=='object'){_this.options.colors=null;}
return _this;}
_createClass(Palette,[{key:'getLength',value:function getLength(){if(!this.options.colors){return 0;}
if(Array.isArray(this.options.colors)){return this.options.colors.length;}
if(_typeof(this.options.colors)==='object'){return Object.keys(this.options.colors).length;}
return 0;}},{key:'resolveColor',value:function resolveColor(color){var realColor=arguments.length>1&&arguments[1]!==undefined?arguments[1]:true;if(this.getLength()<=0){return false;}
if(Array.isArray(this.options.colors)){if(this.options.colors.indexOf(color)>=0){return color;}
if(this.options.colors.indexOf(color.toUpperCase())>=0){return color.toUpperCase();}
if(this.options.colors.indexOf(color.toLowerCase())>=0){return color.toLowerCase();}
return false;}
if(_typeof(this.options.colors)!=='object'){return false;}
if(!this.options.namesAsValues||realColor){return this.getValue(color,false);}
return this.getName(color,this.getName('#'+color));}},{key:'getName',value:function getName(value){var defaultValue=arguments.length>1&&arguments[1]!==undefined?arguments[1]:false;if(!(typeof value==='string')||!this.options.colors){return defaultValue;}
for(var name in this.options.colors){if(!this.options.colors.hasOwnProperty(name)){continue;}
if(this.options.colors[name].toLowerCase()===value.toLowerCase()){return name;}}
return defaultValue;}},{key:'getValue',value:function getValue(name){var defaultValue=arguments.length>1&&arguments[1]!==undefined?arguments[1]:false;if(!(typeof name==='string')||!this.options.colors){return defaultValue;}
if(this.options.colors.hasOwnProperty(name)){return this.options.colors[name];}
return defaultValue;}}]);return Palette;}(_Extension3.default);exports.default=Palette;module.exports=exports.default;}),(function(module,exports,__webpack_require__){"use strict";module.exports={"aliceblue":[240,248,255],"antiquewhite":[250,235,215],"aqua":[0,255,255],"aquamarine":[127,255,212],"azure":[240,255,255],"beige":[245,245,220],"bisque":[255,228,196],"black":[0,0,0],"blanchedalmond":[255,235,205],"blue":[0,0,255],"blueviolet":[138,43,226],"brown":[165,42,42],"burlywood":[222,184,135],"cadetblue":[95,158,160],"chartreuse":[127,255,0],"chocolate":[210,105,30],"coral":[255,127,80],"cornflowerblue":[100,149,237],"cornsilk":[255,248,220],"crimson":[220,20,60],"cyan":[0,255,255],"darkblue":[0,0,139],"darkcyan":[0,139,139],"darkgoldenrod":[184,134,11],"darkgray":[169,169,169],"darkgreen":[0,100,0],"darkgrey":[169,169,169],"darkkhaki":[189,183,107],"darkmagenta":[139,0,139],"darkolivegreen":[85,107,47],"darkorange":[255,140,0],"darkorchid":[153,50,204],"darkred":[139,0,0],"darksalmon":[233,150,122],"darkseagreen":[143,188,143],"darkslateblue":[72,61,139],"darkslategray":[47,79,79],"darkslategrey":[47,79,79],"darkturquoise":[0,206,209],"darkviolet":[148,0,211],"deeppink":[255,20,147],"deepskyblue":[0,191,255],"dimgray":[105,105,105],"dimgrey":[105,105,105],"dodgerblue":[30,144,255],"firebrick":[178,34,34],"floralwhite":[255,250,240],"forestgreen":[34,139,34],"fuchsia":[255,0,255],"gainsboro":[220,220,220],"ghostwhite":[248,248,255],"gold":[255,215,0],"goldenrod":[218,165,32],"gray":[128,128,128],"green":[0,128,0],"greenyellow":[173,255,47],"grey":[128,128,128],"honeydew":[240,255,240],"hotpink":[255,105,180],"indianred":[205,92,92],"indigo":[75,0,130],"ivory":[255,255,240],"khaki":[240,230,140],"lavender":[230,230,250],"lavenderblush":[255,240,245],"lawngreen":[124,252,0],"lemonchiffon":[255,250,205],"lightblue":[173,216,230],"lightcoral":[240,128,128],"lightcyan":[224,255,255],"lightgoldenrodyellow":[250,250,210],"lightgray":[211,211,211],"lightgreen":[144,238,144],"lightgrey":[211,211,211],"lightpink":[255,182,193],"lightsalmon":[255,160,122],"lightseagreen":[32,178,170],"lightskyblue":[135,206,250],"lightslategray":[119,136,153],"lightslategrey":[119,136,153],"lightsteelblue":[176,196,222],"lightyellow":[255,255,224],"lime":[0,255,0],"limegreen":[50,205,50],"linen":[250,240,230],"magenta":[255,0,255],"maroon":[128,0,0],"mediumaquamarine":[102,205,170],"mediumblue":[0,0,205],"mediumorchid":[186,85,211],"mediumpurple":[147,112,219],"mediumseagreen":[60,179,113],"mediumslateblue":[123,104,238],"mediumspringgreen":[0,250,154],"mediumturquoise":[72,209,204],"mediumvioletred":[199,21,133],"midnightblue":[25,25,112],"mintcream":[245,255,250],"mistyrose":[255,228,225],"moccasin":[255,228,181],"navajowhite":[255,222,173],"navy":[0,0,128],"oldlace":[253,245,230],"olive":[128,128,0],"olivedrab":[107,142,35],"orange":[255,165,0],"orangered":[255,69,0],"orchid":[218,112,214],"palegoldenrod":[238,232,170],"palegreen":[152,251,152],"paleturquoise":[175,238,238],"palevioletred":[219,112,147],"papayawhip":[255,239,213],"peachpuff":[255,218,185],"peru":[205,133,63],"pink":[255,192,203],"plum":[221,160,221],"powderblue":[176,224,230],"purple":[128,0,128],"rebeccapurple":[102,51,153],"red":[255,0,0],"rosybrown":[188,143,143],"royalblue":[65,105,225],"saddlebrown":[139,69,19],"salmon":[250,128,114],"sandybrown":[244,164,96],"seagreen":[46,139,87],"seashell":[255,245,238],"sienna":[160,82,45],"silver":[192,192,192],"skyblue":[135,206,235],"slateblue":[106,90,205],"slategray":[112,128,144],"slategrey":[112,128,144],"snow":[255,250,250],"springgreen":[0,255,127],"steelblue":[70,130,180],"tan":[210,180,140],"teal":[0,128,128],"thistle":[216,191,216],"tomato":[255,99,71],"turquoise":[64,224,208],"violet":[238,130,238],"wheat":[245,222,179],"white":[255,255,255],"whitesmoke":[245,245,245],"yellow":[255,255,0],"yellowgreen":[154,205,50]};}),(function(module,exports,__webpack_require__){var cssKeywords=__webpack_require__(5);var reverseKeywords={};for(var key in cssKeywords){if(cssKeywords.hasOwnProperty(key)){reverseKeywords[cssKeywords[key]]=key;}}
var convert=module.exports={rgb:{channels:3,labels:'rgb'},hsl:{channels:3,labels:'hsl'},hsv:{channels:3,labels:'hsv'},hwb:{channels:3,labels:'hwb'},cmyk:{channels:4,labels:'cmyk'},xyz:{channels:3,labels:'xyz'},lab:{channels:3,labels:'lab'},lch:{channels:3,labels:'lch'},hex:{channels:1,labels:['hex']},keyword:{channels:1,labels:['keyword']},ansi16:{channels:1,labels:['ansi16']},ansi256:{channels:1,labels:['ansi256']},hcg:{channels:3,labels:['h','c','g']},apple:{channels:3,labels:['r16','g16','b16']},gray:{channels:1,labels:['gray']}};for(var model in convert){if(convert.hasOwnProperty(model)){if(!('channels'in convert[model])){throw new Error('missing channels property: '+model);}
if(!('labels'in convert[model])){throw new Error('missing channel labels property: '+model);}
if(convert[model].labels.length!==convert[model].channels){throw new Error('channel and label counts mismatch: '+model);}
var channels=convert[model].channels;var labels=convert[model].labels;delete convert[model].channels;delete convert[model].labels;Object.defineProperty(convert[model],'channels',{value:channels});Object.defineProperty(convert[model],'labels',{value:labels});}}
convert.rgb.hsl=function(rgb){var r=rgb[0]/255;var g=rgb[1]/255;var b=rgb[2]/255;var min=Math.min(r,g,b);var max=Math.max(r,g,b);var delta=max-min;var h;var s;var l;if(max===min){h=0;}else if(r===max){h=(g-b)/delta;}else if(g===max){h=2+(b-r)/delta;}else if(b===max){h=4+(r-g)/delta;}
h=Math.min(h*60,360);if(h<0){h+=360;}
l=(min+max)/2;if(max===min){s=0;}else if(l<=0.5){s=delta/(max+min);}else{s=delta/(2-max-min);}
return[h,s*100,l*100];};convert.rgb.hsv=function(rgb){var rdif;var gdif;var bdif;var h;var s;var r=rgb[0]/255;var g=rgb[1]/255;var b=rgb[2]/255;var v=Math.max(r,g,b);var diff=v-Math.min(r,g,b);var diffc=function(c){return(v-c)/6/diff+1/2;};if(diff===0){h=s=0;}else{s=diff/v;rdif=diffc(r);gdif=diffc(g);bdif=diffc(b);if(r===v){h=bdif-gdif;}else if(g===v){h=(1/3)+rdif-bdif;}else if(b===v){h=(2/3)+gdif-rdif;}
if(h<0){h+=1;}else if(h>1){h-=1;}}
return[h*360,s*100,v*100];};convert.rgb.hwb=function(rgb){var r=rgb[0];var g=rgb[1];var b=rgb[2];var h=convert.rgb.hsl(rgb)[0];var w=1/255*Math.min(r,Math.min(g,b));b=1-1/255*Math.max(r,Math.max(g,b));return[h,w*100,b*100];};convert.rgb.cmyk=function(rgb){var r=rgb[0]/255;var g=rgb[1]/255;var b=rgb[2]/255;var c;var m;var y;var k;k=Math.min(1-r,1-g,1-b);c=(1-r-k)/(1-k)||0;m=(1-g-k)/(1-k)||0;y=(1-b-k)/(1-k)||0;return[c*100,m*100,y*100,k*100];};function comparativeDistance(x,y){return(Math.pow(x[0]-y[0],2)+
Math.pow(x[1]-y[1],2)+
Math.pow(x[2]-y[2],2));}
convert.rgb.keyword=function(rgb){var reversed=reverseKeywords[rgb];if(reversed){return reversed;}
var currentClosestDistance=Infinity;var currentClosestKeyword;for(var keyword in cssKeywords){if(cssKeywords.hasOwnProperty(keyword)){var value=cssKeywords[keyword];var distance=comparativeDistance(rgb,value);if(distance<currentClosestDistance){currentClosestDistance=distance;currentClosestKeyword=keyword;}}}
return currentClosestKeyword;};convert.keyword.rgb=function(keyword){return cssKeywords[keyword];};convert.rgb.xyz=function(rgb){var r=rgb[0]/255;var g=rgb[1]/255;var b=rgb[2]/255;r=r>0.04045?Math.pow(((r+0.055)/1.055),2.4):(r/12.92);g=g>0.04045?Math.pow(((g+0.055)/1.055),2.4):(g/12.92);b=b>0.04045?Math.pow(((b+0.055)/1.055),2.4):(b/12.92);var x=(r*0.4124)+(g*0.3576)+(b*0.1805);var y=(r*0.2126)+(g*0.7152)+(b*0.0722);var z=(r*0.0193)+(g*0.1192)+(b*0.9505);return[x*100,y*100,z*100];};convert.rgb.lab=function(rgb){var xyz=convert.rgb.xyz(rgb);var x=xyz[0];var y=xyz[1];var z=xyz[2];var l;var a;var b;x/=95.047;y/=100;z/=108.883;x=x>0.008856?Math.pow(x,1/3):(7.787*x)+(16/116);y=y>0.008856?Math.pow(y,1/3):(7.787*y)+(16/116);z=z>0.008856?Math.pow(z,1/3):(7.787*z)+(16/116);l=(116*y)-16;a=500*(x-y);b=200*(y-z);return[l,a,b];};convert.hsl.rgb=function(hsl){var h=hsl[0]/360;var s=hsl[1]/100;var l=hsl[2]/100;var t1;var t2;var t3;var rgb;var val;if(s===0){val=l*255;return[val,val,val];}
if(l<0.5){t2=l*(1+s);}else{t2=l+s-l*s;}
t1=2*l-t2;rgb=[0,0,0];for(var i=0;i<3;i++){t3=h+1/3*-(i-1);if(t3<0){t3++;}
if(t3>1){t3--;}
if(6*t3<1){val=t1+(t2-t1)*6*t3;}else if(2*t3<1){val=t2;}else if(3*t3<2){val=t1+(t2-t1)*(2/3-t3)*6;}else{val=t1;}
rgb[i]=val*255;}
return rgb;};convert.hsl.hsv=function(hsl){var h=hsl[0];var s=hsl[1]/100;var l=hsl[2]/100;var smin=s;var lmin=Math.max(l,0.01);var sv;var v;l*=2;s*=(l<=1)?l:2-l;smin*=lmin<=1?lmin:2-lmin;v=(l+s)/2;sv=l===0?(2*smin)/(lmin+smin):(2*s)/(l+s);return[h,sv*100,v*100];};convert.hsv.rgb=function(hsv){var h=hsv[0]/60;var s=hsv[1]/100;var v=hsv[2]/100;var hi=Math.floor(h)%6;var f=h-Math.floor(h);var p=255*v*(1-s);var q=255*v*(1-(s*f));var t=255*v*(1-(s*(1-f)));v*=255;switch(hi){case 0:return[v,t,p];case 1:return[q,v,p];case 2:return[p,v,t];case 3:return[p,q,v];case 4:return[t,p,v];case 5:return[v,p,q];}};convert.hsv.hsl=function(hsv){var h=hsv[0];var s=hsv[1]/100;var v=hsv[2]/100;var vmin=Math.max(v,0.01);var lmin;var sl;var l;l=(2-s)*v;lmin=(2-s)*vmin;sl=s*vmin;sl/=(lmin<=1)?lmin:2-lmin;sl=sl||0;l/=2;return[h,sl*100,l*100];};convert.hwb.rgb=function(hwb){var h=hwb[0]/360;var wh=hwb[1]/100;var bl=hwb[2]/100;var ratio=wh+bl;var i;var v;var f;var n;if(ratio>1){wh/=ratio;bl/=ratio;}
i=Math.floor(6*h);v=1-bl;f=6*h-i;if((i&0x01)!==0){f=1-f;}
n=wh+f*(v-wh);var r;var g;var b;switch(i){default:case 6:case 0:r=v;g=n;b=wh;break;case 1:r=n;g=v;b=wh;break;case 2:r=wh;g=v;b=n;break;case 3:r=wh;g=n;b=v;break;case 4:r=n;g=wh;b=v;break;case 5:r=v;g=wh;b=n;break;}
return[r*255,g*255,b*255];};convert.cmyk.rgb=function(cmyk){var c=cmyk[0]/100;var m=cmyk[1]/100;var y=cmyk[2]/100;var k=cmyk[3]/100;var r;var g;var b;r=1-Math.min(1,c*(1-k)+k);g=1-Math.min(1,m*(1-k)+k);b=1-Math.min(1,y*(1-k)+k);return[r*255,g*255,b*255];};convert.xyz.rgb=function(xyz){var x=xyz[0]/100;var y=xyz[1]/100;var z=xyz[2]/100;var r;var g;var b;r=(x*3.2406)+(y*-1.5372)+(z*-0.4986);g=(x*-0.9689)+(y*1.8758)+(z*0.0415);b=(x*0.0557)+(y*-0.2040)+(z*1.0570);r=r>0.0031308?((1.055*Math.pow(r,1.0/2.4))-0.055):r*12.92;g=g>0.0031308?((1.055*Math.pow(g,1.0/2.4))-0.055):g*12.92;b=b>0.0031308?((1.055*Math.pow(b,1.0/2.4))-0.055):b*12.92;r=Math.min(Math.max(0,r),1);g=Math.min(Math.max(0,g),1);b=Math.min(Math.max(0,b),1);return[r*255,g*255,b*255];};convert.xyz.lab=function(xyz){var x=xyz[0];var y=xyz[1];var z=xyz[2];var l;var a;var b;x/=95.047;y/=100;z/=108.883;x=x>0.008856?Math.pow(x,1/3):(7.787*x)+(16/116);y=y>0.008856?Math.pow(y,1/3):(7.787*y)+(16/116);z=z>0.008856?Math.pow(z,1/3):(7.787*z)+(16/116);l=(116*y)-16;a=500*(x-y);b=200*(y-z);return[l,a,b];};convert.lab.xyz=function(lab){var l=lab[0];var a=lab[1];var b=lab[2];var x;var y;var z;y=(l+16)/116;x=a/500+y;z=y-b/200;var y2=Math.pow(y,3);var x2=Math.pow(x,3);var z2=Math.pow(z,3);y=y2>0.008856?y2:(y-16/116)/7.787;x=x2>0.008856?x2:(x-16/116)/7.787;z=z2>0.008856?z2:(z-16/116)/7.787;x*=95.047;y*=100;z*=108.883;return[x,y,z];};convert.lab.lch=function(lab){var l=lab[0];var a=lab[1];var b=lab[2];var hr;var h;var c;hr=Math.atan2(b,a);h=hr*360/2/Math.PI;if(h<0){h+=360;}
c=Math.sqrt(a*a+b*b);return[l,c,h];};convert.lch.lab=function(lch){var l=lch[0];var c=lch[1];var h=lch[2];var a;var b;var hr;hr=h/360*2*Math.PI;a=c*Math.cos(hr);b=c*Math.sin(hr);return[l,a,b];};convert.rgb.ansi16=function(args){var r=args[0];var g=args[1];var b=args[2];var value=1 in arguments?arguments[1]:convert.rgb.hsv(args)[2];value=Math.round(value/50);if(value===0){return 30;}
var ansi=30
+((Math.round(b/255)<<2)|(Math.round(g/255)<<1)|Math.round(r/255));if(value===2){ansi+=60;}
return ansi;};convert.hsv.ansi16=function(args){return convert.rgb.ansi16(convert.hsv.rgb(args),args[2]);};convert.rgb.ansi256=function(args){var r=args[0];var g=args[1];var b=args[2];if(r===g&&g===b){if(r<8){return 16;}
if(r>248){return 231;}
return Math.round(((r-8)/247)*24)+232;}
var ansi=16
+(36*Math.round(r/255*5))
+(6*Math.round(g/255*5))
+Math.round(b/255*5);return ansi;};convert.ansi16.rgb=function(args){var color=args%10;if(color===0||color===7){if(args>50){color+=3.5;}
color=color/10.5*255;return[color,color,color];}
var mult=(~~(args>50)+1)*0.5;var r=((color&1)*mult)*255;var g=(((color>>1)&1)*mult)*255;var b=(((color>>2)&1)*mult)*255;return[r,g,b];};convert.ansi256.rgb=function(args){if(args>=232){var c=(args-232)*10+8;return[c,c,c];}
args-=16;var rem;var r=Math.floor(args/36)/5*255;var g=Math.floor((rem=args%36)/6)/5*255;var b=(rem%6)/5*255;return[r,g,b];};convert.rgb.hex=function(args){var integer=((Math.round(args[0])&0xFF)<<16)
+((Math.round(args[1])&0xFF)<<8)
+(Math.round(args[2])&0xFF);var string=integer.toString(16).toUpperCase();return'000000'.substring(string.length)+string;};convert.hex.rgb=function(args){var match=args.toString(16).match(/[a-f0-9]{6}|[a-f0-9]{3}/i);if(!match){return[0,0,0];}
var colorString=match[0];if(match[0].length===3){colorString=colorString.split('').map(function(char){return char+char;}).join('');}
var integer=parseInt(colorString,16);var r=(integer>>16)&0xFF;var g=(integer>>8)&0xFF;var b=integer&0xFF;return[r,g,b];};convert.rgb.hcg=function(rgb){var r=rgb[0]/255;var g=rgb[1]/255;var b=rgb[2]/255;var max=Math.max(Math.max(r,g),b);var min=Math.min(Math.min(r,g),b);var chroma=(max-min);var grayscale;var hue;if(chroma<1){grayscale=min/(1-chroma);}else{grayscale=0;}
if(chroma<=0){hue=0;}else
if(max===r){hue=((g-b)/chroma)%6;}else
if(max===g){hue=2+(b-r)/chroma;}else{hue=4+(r-g)/chroma+4;}
hue/=6;hue%=1;return[hue*360,chroma*100,grayscale*100];};convert.hsl.hcg=function(hsl){var s=hsl[1]/100;var l=hsl[2]/100;var c=1;var f=0;if(l<0.5){c=2.0*s*l;}else{c=2.0*s*(1.0-l);}
if(c<1.0){f=(l-0.5*c)/(1.0-c);}
return[hsl[0],c*100,f*100];};convert.hsv.hcg=function(hsv){var s=hsv[1]/100;var v=hsv[2]/100;var c=s*v;var f=0;if(c<1.0){f=(v-c)/(1-c);}
return[hsv[0],c*100,f*100];};convert.hcg.rgb=function(hcg){var h=hcg[0]/360;var c=hcg[1]/100;var g=hcg[2]/100;if(c===0.0){return[g*255,g*255,g*255];}
var pure=[0,0,0];var hi=(h%1)*6;var v=hi%1;var w=1-v;var mg=0;switch(Math.floor(hi)){case 0:pure[0]=1;pure[1]=v;pure[2]=0;break;case 1:pure[0]=w;pure[1]=1;pure[2]=0;break;case 2:pure[0]=0;pure[1]=1;pure[2]=v;break;case 3:pure[0]=0;pure[1]=w;pure[2]=1;break;case 4:pure[0]=v;pure[1]=0;pure[2]=1;break;default:pure[0]=1;pure[1]=0;pure[2]=w;}
mg=(1.0-c)*g;return[(c*pure[0]+mg)*255,(c*pure[1]+mg)*255,(c*pure[2]+mg)*255];};convert.hcg.hsv=function(hcg){var c=hcg[1]/100;var g=hcg[2]/100;var v=c+g*(1.0-c);var f=0;if(v>0.0){f=c/v;}
return[hcg[0],f*100,v*100];};convert.hcg.hsl=function(hcg){var c=hcg[1]/100;var g=hcg[2]/100;var l=g*(1.0-c)+0.5*c;var s=0;if(l>0.0&&l<0.5){s=c/(2*l);}else
if(l>=0.5&&l<1.0){s=c/(2*(1-l));}
return[hcg[0],s*100,l*100];};convert.hcg.hwb=function(hcg){var c=hcg[1]/100;var g=hcg[2]/100;var v=c+g*(1.0-c);return[hcg[0],(v-c)*100,(1-v)*100];};convert.hwb.hcg=function(hwb){var w=hwb[1]/100;var b=hwb[2]/100;var v=1-b;var c=v-w;var g=0;if(c<1){g=(v-c)/(1-c);}
return[hwb[0],c*100,g*100];};convert.apple.rgb=function(apple){return[(apple[0]/65535)*255,(apple[1]/65535)*255,(apple[2]/65535)*255];};convert.rgb.apple=function(rgb){return[(rgb[0]/255)*65535,(rgb[1]/255)*65535,(rgb[2]/255)*65535];};convert.gray.rgb=function(args){return[args[0]/100*255,args[0]/100*255,args[0]/100*255];};convert.gray.hsl=convert.gray.hsv=function(args){return[0,0,args[0]];};convert.gray.hwb=function(gray){return[0,100,gray[0]];};convert.gray.cmyk=function(gray){return[0,0,0,gray[0]];};convert.gray.lab=function(gray){return[gray[0],0,0];};convert.gray.hex=function(gray){var val=Math.round(gray[0]/100*255)&0xFF;var integer=(val<<16)+(val<<8)+val;var string=integer.toString(16).toUpperCase();return'000000'.substring(string.length)+string;};convert.rgb.gray=function(rgb){var val=(rgb[0]+rgb[1]+rgb[2])/3;return[val/255*100];};}),(function(module,exports,__webpack_require__){"use strict";var _typeof=typeof Symbol==="function"&&typeof Symbol.iterator==="symbol"?function(obj){return typeof obj;}:function(obj){return obj&&typeof Symbol==="function"&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj;};var _Colorpicker=__webpack_require__(8);var _Colorpicker2=_interopRequireDefault(_Colorpicker);var _jquery=__webpack_require__(0);var _jquery2=_interopRequireDefault(_jquery);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj};}
var plugin='colorpicker';_jquery2.default[plugin]=_Colorpicker2.default;_jquery2.default.fn[plugin]=function(option){var fnArgs=Array.prototype.slice.call(arguments,1),isSingleElement=this.length===1,returnValue=null;var $elements=this.each(function(){var $this=(0,_jquery2.default)(this),inst=$this.data(plugin),options=(typeof option==='undefined'?'undefined':_typeof(option))==='object'?option:{};if(!inst){inst=new _Colorpicker2.default(this,options);$this.data(plugin,inst);}
if(!isSingleElement){return;}
returnValue=$this;if(typeof option==='string'){if(option==='colorpicker'){returnValue=inst;}else if(_jquery2.default.isFunction(inst[option])){returnValue=inst[option].apply(inst,fnArgs);}else{returnValue=inst[option];}}});return isSingleElement?returnValue:$elements;};_jquery2.default.fn[plugin].constructor=_Colorpicker2.default;}),(function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});var _createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value"in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor);}}return function(Constructor,protoProps,staticProps){if(protoProps)defineProperties(Constructor.prototype,protoProps);if(staticProps)defineProperties(Constructor,staticProps);return Constructor;};}();var _Extension=__webpack_require__(1);var _Extension2=_interopRequireDefault(_Extension);var _options=__webpack_require__(3);var _options2=_interopRequireDefault(_options);var _extensions=__webpack_require__(9);var _extensions2=_interopRequireDefault(_extensions);var _jquery=__webpack_require__(0);var _jquery2=_interopRequireDefault(_jquery);var _SliderHandler=__webpack_require__(13);var _SliderHandler2=_interopRequireDefault(_SliderHandler);var _PopupHandler=__webpack_require__(14);var _PopupHandler2=_interopRequireDefault(_PopupHandler);var _InputHandler=__webpack_require__(15);var _InputHandler2=_interopRequireDefault(_InputHandler);var _ColorHandler=__webpack_require__(22);var _ColorHandler2=_interopRequireDefault(_ColorHandler);var _PickerHandler=__webpack_require__(23);var _PickerHandler2=_interopRequireDefault(_PickerHandler);var _AddonHandler=__webpack_require__(24);var _AddonHandler2=_interopRequireDefault(_AddonHandler);var _ColorItem=__webpack_require__(2);var _ColorItem2=_interopRequireDefault(_ColorItem);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj};}
function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function");}}
var colorPickerIdCounter=0;var root=typeof self!=='undefined'?self:undefined;var Colorpicker=function(){_createClass(Colorpicker,[{key:'color',get:function get(){return this.colorHandler.color;}},{key:'format',get:function get(){return this.colorHandler.format;}},{key:'picker',get:function get(){return this.pickerHandler.picker;}}],[{key:'Color',get:function get(){return _ColorItem2.default;}},{key:'Extension',get:function get(){return _Extension2.default;}}]);function Colorpicker(element,options){_classCallCheck(this,Colorpicker);colorPickerIdCounter+=1;this.id=colorPickerIdCounter;this.lastEvent={alias:null,e:null};this.element=(0,_jquery2.default)(element).addClass('colorpicker-element').attr('data-colorpicker-id',this.id);this.options=_jquery2.default.extend(true,{},_options2.default,options,this.element.data());this.disabled=false;this.extensions=[];this.container=this.options.container===true||this.options.container!==true&&this.options.inline===true?this.element:this.options.container;this.container=this.container!==false?(0,_jquery2.default)(this.container):false;this.inputHandler=new _InputHandler2.default(this);this.colorHandler=new _ColorHandler2.default(this);this.sliderHandler=new _SliderHandler2.default(this);this.popupHandler=new _PopupHandler2.default(this,root);this.pickerHandler=new _PickerHandler2.default(this);this.addonHandler=new _AddonHandler2.default(this);this.init();(0,_jquery2.default)(_jquery2.default.proxy(function(){this.trigger('colorpickerCreate');},this));}
_createClass(Colorpicker,[{key:'init',value:function init(){this.addonHandler.bind();this.inputHandler.bind();this.initExtensions();this.colorHandler.bind();this.pickerHandler.bind();this.sliderHandler.bind();this.popupHandler.bind();this.pickerHandler.attach();this.update();if(this.inputHandler.isDisabled()){this.disable();}}},{key:'initExtensions',value:function initExtensions(){var _this=this;if(!Array.isArray(this.options.extensions)){this.options.extensions=[];}
if(this.options.debug){this.options.extensions.push({name:'debugger'});}
this.options.extensions.forEach(function(ext){_this.registerExtension(Colorpicker.extensions[ext.name.toLowerCase()],ext.options||{});});}},{key:'registerExtension',value:function registerExtension(ExtensionClass){var config=arguments.length>1&&arguments[1]!==undefined?arguments[1]:{};var ext=new ExtensionClass(this,config);this.extensions.push(ext);return ext;}},{key:'destroy',value:function destroy(){var color=this.color;this.sliderHandler.unbind();this.inputHandler.unbind();this.popupHandler.unbind();this.colorHandler.unbind();this.addonHandler.unbind();this.pickerHandler.unbind();this.element.removeClass('colorpicker-element').removeData('colorpicker','color').off('.colorpicker');this.trigger('colorpickerDestroy',color);}},{key:'show',value:function show(e){this.popupHandler.show(e);}},{key:'hide',value:function hide(e){this.popupHandler.hide(e);}},{key:'toggle',value:function toggle(e){this.popupHandler.toggle(e);}},{key:'getValue',value:function getValue(){var defaultValue=arguments.length>0&&arguments[0]!==undefined?arguments[0]:null;var val=this.colorHandler.color;val=val instanceof _ColorItem2.default?val:defaultValue;if(val instanceof _ColorItem2.default){return val.string(this.format);}
return val;}},{key:'setValue',value:function setValue(val){if(this.isDisabled()){return;}
var ch=this.colorHandler;if(ch.hasColor()&&!!val&&ch.color.equals(val)||!ch.hasColor()&&!val){return;}
ch.color=val?ch.createColor(val,this.options.autoInputFallback):null;this.trigger('colorpickerChange',ch.color,val);this.update();}},{key:'update',value:function update(){if(this.colorHandler.hasColor()){this.inputHandler.update();}else{this.colorHandler.assureColor();}
this.addonHandler.update();this.pickerHandler.update();this.trigger('colorpickerUpdate');}},{key:'enable',value:function enable(){this.inputHandler.enable();this.disabled=false;this.picker.removeClass('colorpicker-disabled');this.trigger('colorpickerEnable');return true;}},{key:'disable',value:function disable(){this.inputHandler.disable();this.disabled=true;this.picker.addClass('colorpicker-disabled');this.trigger('colorpickerDisable');return true;}},{key:'isEnabled',value:function isEnabled(){return!this.isDisabled();}},{key:'isDisabled',value:function isDisabled(){return this.disabled===true;}},{key:'trigger',value:function trigger(eventName){var color=arguments.length>1&&arguments[1]!==undefined?arguments[1]:null;var value=arguments.length>2&&arguments[2]!==undefined?arguments[2]:null;this.element.trigger({type:eventName,colorpicker:this,color:color?color:this.color,value:value?value:this.getValue()});}}]);return Colorpicker;}();Colorpicker.extensions=_extensions2.default;exports.default=Colorpicker;module.exports=exports.default;}),(function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.Palette=exports.Swatches=exports.Preview=exports.Debugger=undefined;var _Debugger=__webpack_require__(10);var _Debugger2=_interopRequireDefault(_Debugger);var _Preview=__webpack_require__(11);var _Preview2=_interopRequireDefault(_Preview);var _Swatches=__webpack_require__(12);var _Swatches2=_interopRequireDefault(_Swatches);var _Palette=__webpack_require__(4);var _Palette2=_interopRequireDefault(_Palette);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj};}
exports.Debugger=_Debugger2.default;exports.Preview=_Preview2.default;exports.Swatches=_Swatches2.default;exports.Palette=_Palette2.default;exports.default={'debugger':_Debugger2.default,'preview':_Preview2.default,'swatches':_Swatches2.default,'palette':_Palette2.default};}),(function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});var _createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value"in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor);}}return function(Constructor,protoProps,staticProps){if(protoProps)defineProperties(Constructor.prototype,protoProps);if(staticProps)defineProperties(Constructor,staticProps);return Constructor;};}();var _get=function get(object,property,receiver){if(object===null)object=Function.prototype;var desc=Object.getOwnPropertyDescriptor(object,property);if(desc===undefined){var parent=Object.getPrototypeOf(object);if(parent===null){return undefined;}else{return get(parent,property,receiver);}}else if("value"in desc){return desc.value;}else{var getter=desc.get;if(getter===undefined){return undefined;}return getter.call(receiver);}};var _Extension2=__webpack_require__(1);var _Extension3=_interopRequireDefault(_Extension2);var _jquery=__webpack_require__(0);var _jquery2=_interopRequireDefault(_jquery);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj};}
function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function");}}
function _possibleConstructorReturn(self,call){if(!self){throw new ReferenceError("this hasn't been initialised - super() hasn't been called");}return call&&(typeof call==="object"||typeof call==="function")?call:self;}
function _inherits(subClass,superClass){if(typeof superClass!=="function"&&superClass!==null){throw new TypeError("Super expression must either be null or a function, not "+typeof superClass);}subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,enumerable:false,writable:true,configurable:true}});if(superClass)Object.setPrototypeOf?Object.setPrototypeOf(subClass,superClass):subClass.__proto__=superClass;}
var Debugger=function(_Extension){_inherits(Debugger,_Extension);function Debugger(colorpicker){var options=arguments.length>1&&arguments[1]!==undefined?arguments[1]:{};_classCallCheck(this,Debugger);var _this=_possibleConstructorReturn(this,(Debugger.__proto__||Object.getPrototypeOf(Debugger)).call(this,colorpicker,options));_this.eventCounter=0;if(_this.colorpicker.inputHandler.hasInput()){_this.colorpicker.inputHandler.input.on('change.colorpicker-ext',_jquery2.default.proxy(_this.onChangeInput,_this));}
return _this;}
_createClass(Debugger,[{key:'log',value:function log(eventName){var _console;for(var _len=arguments.length,args=Array(_len>1?_len-1:0),_key=1;_key<_len;_key++){args[_key-1]=arguments[_key];}
this.eventCounter+=1;var logMessage='#'+this.eventCounter+': Colorpicker#'+this.colorpicker.id+' ['+eventName+']';(_console=console).debug.apply(_console,[logMessage].concat(args));this.colorpicker.element.trigger({type:'colorpickerDebug',colorpicker:this.colorpicker,color:this.color,value:null,debug:{debugger:this,eventName:eventName,logArgs:args,logMessage:logMessage}});}},{key:'resolveColor',value:function resolveColor(color){var realColor=arguments.length>1&&arguments[1]!==undefined?arguments[1]:true;this.log('resolveColor()',color,realColor);return false;}},{key:'onCreate',value:function onCreate(event){this.log('colorpickerCreate');return _get(Debugger.prototype.__proto__||Object.getPrototypeOf(Debugger.prototype),'onCreate',this).call(this,event);}},{key:'onDestroy',value:function onDestroy(event){this.log('colorpickerDestroy');this.eventCounter=0;if(this.colorpicker.inputHandler.hasInput()){this.colorpicker.inputHandler.input.off('.colorpicker-ext');}
return _get(Debugger.prototype.__proto__||Object.getPrototypeOf(Debugger.prototype),'onDestroy',this).call(this,event);}},{key:'onUpdate',value:function onUpdate(event){this.log('colorpickerUpdate');}},{key:'onChangeInput',value:function onChangeInput(event){this.log('input:change.colorpicker',event.value,event.color);}},{key:'onChange',value:function onChange(event){this.log('colorpickerChange',event.value,event.color);}},{key:'onInvalid',value:function onInvalid(event){this.log('colorpickerInvalid',event.value,event.color);}},{key:'onHide',value:function onHide(event){this.log('colorpickerHide');this.eventCounter=0;}},{key:'onShow',value:function onShow(event){this.log('colorpickerShow');}},{key:'onDisable',value:function onDisable(event){this.log('colorpickerDisable');}},{key:'onEnable',value:function onEnable(event){this.log('colorpickerEnable');}}]);return Debugger;}(_Extension3.default);exports.default=Debugger;module.exports=exports.default;}),(function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});var _createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value"in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor);}}return function(Constructor,protoProps,staticProps){if(protoProps)defineProperties(Constructor.prototype,protoProps);if(staticProps)defineProperties(Constructor,staticProps);return Constructor;};}();var _get=function get(object,property,receiver){if(object===null)object=Function.prototype;var desc=Object.getOwnPropertyDescriptor(object,property);if(desc===undefined){var parent=Object.getPrototypeOf(object);if(parent===null){return undefined;}else{return get(parent,property,receiver);}}else if("value"in desc){return desc.value;}else{var getter=desc.get;if(getter===undefined){return undefined;}return getter.call(receiver);}};var _Extension2=__webpack_require__(1);var _Extension3=_interopRequireDefault(_Extension2);var _jquery=__webpack_require__(0);var _jquery2=_interopRequireDefault(_jquery);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj};}
function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function");}}
function _possibleConstructorReturn(self,call){if(!self){throw new ReferenceError("this hasn't been initialised - super() hasn't been called");}return call&&(typeof call==="object"||typeof call==="function")?call:self;}
function _inherits(subClass,superClass){if(typeof superClass!=="function"&&superClass!==null){throw new TypeError("Super expression must either be null or a function, not "+typeof superClass);}subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,enumerable:false,writable:true,configurable:true}});if(superClass)Object.setPrototypeOf?Object.setPrototypeOf(subClass,superClass):subClass.__proto__=superClass;}
var Preview=function(_Extension){_inherits(Preview,_Extension);function Preview(colorpicker){var options=arguments.length>1&&arguments[1]!==undefined?arguments[1]:{};_classCallCheck(this,Preview);var _this=_possibleConstructorReturn(this,(Preview.__proto__||Object.getPrototypeOf(Preview)).call(this,colorpicker,_jquery2.default.extend(true,{},{template:'<div class="colorpicker-bar colorpicker-preview"><div /></div>',showText:true,format:colorpicker.format},options)));_this.element=(0,_jquery2.default)(_this.options.template);_this.elementInner=_this.element.find('div');return _this;}
_createClass(Preview,[{key:'onCreate',value:function onCreate(event){_get(Preview.prototype.__proto__||Object.getPrototypeOf(Preview.prototype),'onCreate',this).call(this,event);this.colorpicker.picker.append(this.element);}},{key:'onUpdate',value:function onUpdate(event){_get(Preview.prototype.__proto__||Object.getPrototypeOf(Preview.prototype),'onUpdate',this).call(this,event);if(!event.color){this.elementInner.css('backgroundColor',null).css('color',null).html('');return;}
this.elementInner.css('backgroundColor',event.color.toRgbString());if(this.options.showText){this.elementInner.html(event.color.string(this.options.format||this.colorpicker.format));if(event.color.isDark()&&event.color.alpha>0.5){this.elementInner.css('color','white');}else{this.elementInner.css('color','black');}}}}]);return Preview;}(_Extension3.default);exports.default=Preview;module.exports=exports.default;}),(function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});var _createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value"in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor);}}return function(Constructor,protoProps,staticProps){if(protoProps)defineProperties(Constructor.prototype,protoProps);if(staticProps)defineProperties(Constructor,staticProps);return Constructor;};}();var _get=function get(object,property,receiver){if(object===null)object=Function.prototype;var desc=Object.getOwnPropertyDescriptor(object,property);if(desc===undefined){var parent=Object.getPrototypeOf(object);if(parent===null){return undefined;}else{return get(parent,property,receiver);}}else if("value"in desc){return desc.value;}else{var getter=desc.get;if(getter===undefined){return undefined;}return getter.call(receiver);}};var _Palette2=__webpack_require__(4);var _Palette3=_interopRequireDefault(_Palette2);var _jquery=__webpack_require__(0);var _jquery2=_interopRequireDefault(_jquery);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj};}
function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function");}}
function _possibleConstructorReturn(self,call){if(!self){throw new ReferenceError("this hasn't been initialised - super() hasn't been called");}return call&&(typeof call==="object"||typeof call==="function")?call:self;}
function _inherits(subClass,superClass){if(typeof superClass!=="function"&&superClass!==null){throw new TypeError("Super expression must either be null or a function, not "+typeof superClass);}subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,enumerable:false,writable:true,configurable:true}});if(superClass)Object.setPrototypeOf?Object.setPrototypeOf(subClass,superClass):subClass.__proto__=superClass;}
var defaults={barTemplate:'<div class="colorpicker-bar colorpicker-swatches">\n                    <div class="colorpicker-swatches--inner"></div>\n                </div>',swatchTemplate:'<i class="colorpicker-swatch"><i class="colorpicker-swatch--inner"></i></i>'};var Swatches=function(_Palette){_inherits(Swatches,_Palette);function Swatches(colorpicker){var options=arguments.length>1&&arguments[1]!==undefined?arguments[1]:{};_classCallCheck(this,Swatches);var _this=_possibleConstructorReturn(this,(Swatches.__proto__||Object.getPrototypeOf(Swatches)).call(this,colorpicker,_jquery2.default.extend(true,{},defaults,options)));_this.element=null;return _this;}
_createClass(Swatches,[{key:'isEnabled',value:function isEnabled(){return this.getLength()>0;}},{key:'onCreate',value:function onCreate(event){_get(Swatches.prototype.__proto__||Object.getPrototypeOf(Swatches.prototype),'onCreate',this).call(this,event);if(!this.isEnabled()){return;}
this.element=(0,_jquery2.default)(this.options.barTemplate);this.load();this.colorpicker.picker.append(this.element);}},{key:'load',value:function load(){var _this2=this;var colorpicker=this.colorpicker,swatchContainer=this.element.find('.colorpicker-swatches--inner'),isAliased=this.options.namesAsValues===true&&!Array.isArray(this.colors);swatchContainer.empty();_jquery2.default.each(this.colors,function(name,value){var $swatch=(0,_jquery2.default)(_this2.options.swatchTemplate).attr('data-name',name).attr('data-value',value).attr('title',isAliased?name+': '+value:value).on('mousedown.colorpicker touchstart.colorpicker',function(e){var $sw=(0,_jquery2.default)(this);colorpicker.setValue(isAliased?$sw.attr('data-name'):$sw.attr('data-value'));});$swatch.find('.colorpicker-swatch--inner').css('background-color',value);swatchContainer.append($swatch);});swatchContainer.append((0,_jquery2.default)('<i class="colorpicker-clear"></i>'));}}]);return Swatches;}(_Palette3.default);exports.default=Swatches;module.exports=exports.default;}),(function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});var _createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value"in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor);}}return function(Constructor,protoProps,staticProps){if(protoProps)defineProperties(Constructor.prototype,protoProps);if(staticProps)defineProperties(Constructor,staticProps);return Constructor;};}();var _jquery=__webpack_require__(0);var _jquery2=_interopRequireDefault(_jquery);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj};}
function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function");}}
var SliderHandler=function(){function SliderHandler(colorpicker){_classCallCheck(this,SliderHandler);this.colorpicker=colorpicker;this.currentSlider=null;this.mousePointer={left:0,top:0};this.onMove=_jquery2.default.proxy(this.defaultOnMove,this);}
_createClass(SliderHandler,[{key:'defaultOnMove',value:function defaultOnMove(top,left){if(!this.currentSlider){return;}
var slider=this.currentSlider,cp=this.colorpicker,ch=cp.colorHandler;var color=!ch.hasColor()?ch.getFallbackColor():ch.color.getClone();slider.guideStyle.left=left+'px';slider.guideStyle.top=top+'px';if(slider.callLeft){color[slider.callLeft](left/slider.maxLeft);}
if(slider.callTop){color[slider.callTop](top/slider.maxTop);}
cp.setValue(color);cp.popupHandler.focus();}},{key:'bind',value:function bind(){var sliders=this.colorpicker.options.horizontal?this.colorpicker.options.slidersHorz:this.colorpicker.options.sliders;var sliderClasses=[];for(var sliderName in sliders){if(!sliders.hasOwnProperty(sliderName)){continue;}
sliderClasses.push(sliders[sliderName].selector);}
this.colorpicker.picker.find(sliderClasses.join(', ')).on('mousedown.colorpicker touchstart.colorpicker',_jquery2.default.proxy(this.pressed,this));}},{key:'unbind',value:function unbind(){(0,_jquery2.default)(this.colorpicker.picker).off({'mousemove.colorpicker':_jquery2.default.proxy(this.moved,this),'touchmove.colorpicker':_jquery2.default.proxy(this.moved,this),'mouseup.colorpicker':_jquery2.default.proxy(this.released,this),'touchend.colorpicker':_jquery2.default.proxy(this.released,this)});}},{key:'pressed',value:function pressed(e){if(this.colorpicker.isDisabled()){return;}
this.colorpicker.lastEvent.alias='pressed';this.colorpicker.lastEvent.e=e;if(!e.pageX&&!e.pageY&&e.originalEvent&&e.originalEvent.touches){e.pageX=e.originalEvent.touches[0].pageX;e.pageY=e.originalEvent.touches[0].pageY;}
var target=(0,_jquery2.default)(e.target);var zone=target.closest('div');var sliders=this.colorpicker.options.horizontal?this.colorpicker.options.slidersHorz:this.colorpicker.options.sliders;if(zone.is('.colorpicker')){return;}
this.currentSlider=null;for(var sliderName in sliders){if(!sliders.hasOwnProperty(sliderName)){continue;}
var slider=sliders[sliderName];if(zone.is(slider.selector)){this.currentSlider=_jquery2.default.extend({},slider,{name:sliderName});break;}else if(slider.childSelector!==undefined&&zone.is(slider.childSelector)){this.currentSlider=_jquery2.default.extend({},slider,{name:sliderName});zone=zone.parent();break;}}
var guide=zone.find('.colorpicker-guide').get(0);if(this.currentSlider===null||guide===null){return;}
var offset=zone.offset();this.currentSlider.guideStyle=guide.style;this.currentSlider.left=e.pageX-offset.left;this.currentSlider.top=e.pageY-offset.top;this.mousePointer={left:e.pageX,top:e.pageY};(0,_jquery2.default)(this.colorpicker.picker).on({'mousemove.colorpicker':_jquery2.default.proxy(this.moved,this),'touchmove.colorpicker':_jquery2.default.proxy(this.moved,this),'mouseup.colorpicker':_jquery2.default.proxy(this.released,this),'touchend.colorpicker':_jquery2.default.proxy(this.released,this)}).trigger('mousemove');}},{key:'moved',value:function moved(e){this.colorpicker.lastEvent.alias='moved';this.colorpicker.lastEvent.e=e;if(!e.pageX&&!e.pageY&&e.originalEvent&&e.originalEvent.touches){e.pageX=e.originalEvent.touches[0].pageX;e.pageY=e.originalEvent.touches[0].pageY;}
e.preventDefault();var left=Math.max(0,Math.min(this.currentSlider.maxLeft,this.currentSlider.left+((e.pageX||this.mousePointer.left)-this.mousePointer.left)));var top=Math.max(0,Math.min(this.currentSlider.maxTop,this.currentSlider.top+((e.pageY||this.mousePointer.top)-this.mousePointer.top)));this.onMove(top,left);}},{key:'released',value:function released(e){this.colorpicker.lastEvent.alias='released';this.colorpicker.lastEvent.e=e;(0,_jquery2.default)(this.colorpicker.picker).off({'mousemove.colorpicker':this.moved,'touchmove.colorpicker':this.moved,'mouseup.colorpicker':this.released,'touchend.colorpicker':this.released});}}]);return SliderHandler;}();exports.default=SliderHandler;module.exports=exports.default;}),(function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});var _createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value"in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor);}}return function(Constructor,protoProps,staticProps){if(protoProps)defineProperties(Constructor.prototype,protoProps);if(staticProps)defineProperties(Constructor,staticProps);return Constructor;};}();var _jquery=__webpack_require__(0);var _jquery2=_interopRequireDefault(_jquery);var _options=__webpack_require__(3);var _options2=_interopRequireDefault(_options);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj};}
function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function");}}
var PopupHandler=function(){function PopupHandler(colorpicker,root){_classCallCheck(this,PopupHandler);this.root=root;this.colorpicker=colorpicker;this.popoverTarget=null;this.popoverTip=null;this.clicking=false;this.hidding=false;this.showing=false;}
_createClass(PopupHandler,[{key:'bind',value:function bind(){var cp=this.colorpicker;if(cp.options.inline){cp.picker.addClass('colorpicker-inline colorpicker-visible');return;}
cp.picker.addClass('colorpicker-popup colorpicker-hidden');if(!this.hasInput&&!this.hasAddon){return;}
if(cp.options.popover){this.createPopover();}
if(this.hasAddon){if(!this.addon.attr('tabindex')){this.addon.attr('tabindex',0);}
this.addon.on({'mousedown.colorpicker touchstart.colorpicker':_jquery2.default.proxy(this.toggle,this)});this.addon.on({'focus.colorpicker':_jquery2.default.proxy(this.show,this)});this.addon.on({'focusout.colorpicker':_jquery2.default.proxy(this.hide,this)});}
if(this.hasInput&&!this.hasAddon){this.input.on({'mousedown.colorpicker touchstart.colorpicker':_jquery2.default.proxy(this.show,this),'focus.colorpicker':_jquery2.default.proxy(this.show,this)});this.input.on({'focusout.colorpicker':_jquery2.default.proxy(this.hide,this)});}
(0,_jquery2.default)(this.root).on('resize.colorpicker',_jquery2.default.proxy(this.reposition,this));}},{key:'unbind',value:function unbind(){if(this.hasInput){this.input.off({'mousedown.colorpicker touchstart.colorpicker':_jquery2.default.proxy(this.show,this),'focus.colorpicker':_jquery2.default.proxy(this.show,this)});this.input.off({'focusout.colorpicker':_jquery2.default.proxy(this.hide,this)});}
if(this.hasAddon){this.addon.off({'mousedown.colorpicker touchstart.colorpicker':_jquery2.default.proxy(this.toggle,this)});this.addon.off({'focus.colorpicker':_jquery2.default.proxy(this.show,this)});this.addon.off({'focusout.colorpicker':_jquery2.default.proxy(this.hide,this)});}
if(this.popoverTarget){this.popoverTarget.popover('dispose');}
(0,_jquery2.default)(this.root).off('resize.colorpicker',_jquery2.default.proxy(this.reposition,this));(0,_jquery2.default)(this.root.document).off('mousedown.colorpicker touchstart.colorpicker',_jquery2.default.proxy(this.hide,this));(0,_jquery2.default)(this.root.document).off('mousedown.colorpicker touchstart.colorpicker',_jquery2.default.proxy(this.onClickingInside,this));}},{key:'isClickingInside',value:function isClickingInside(e){if(!e){return false;}
return this.isOrIsInside(this.popoverTip,e.currentTarget)||this.isOrIsInside(this.popoverTip,e.target)||this.isOrIsInside(this.colorpicker.picker,e.currentTarget)||this.isOrIsInside(this.colorpicker.picker,e.target);}},{key:'isOrIsInside',value:function isOrIsInside(container,element){if(!container||!element){return false;}
element=(0,_jquery2.default)(element);return element.is(container)||container.find(element).length>0;}},{key:'onClickingInside',value:function onClickingInside(e){this.clicking=this.isClickingInside(e);}},{key:'createPopover',value:function createPopover(){var cp=this.colorpicker;this.popoverTarget=this.hasAddon?this.addon:this.input;cp.picker.addClass('colorpicker-bs-popover-content');this.popoverTarget.popover(_jquery2.default.extend(true,{},_options2.default.popover,cp.options.popover,{trigger:'manual',content:cp.picker,html:true}));this.popoverTip=(0,_jquery2.default)(this.popoverTarget.popover('getTipElement').data('bs.popover').tip);this.popoverTip.addClass('colorpicker-bs-popover');this.popoverTarget.on('shown.bs.popover',_jquery2.default.proxy(this.fireShow,this));this.popoverTarget.on('hidden.bs.popover',_jquery2.default.proxy(this.fireHide,this));}},{key:'reposition',value:function reposition(e){if(this.popoverTarget&&this.isVisible()){this.popoverTarget.popover('update');}}},{key:'toggle',value:function toggle(e){if(this.isVisible()){this.hide(e);}else{this.show(e);}}},{key:'show',value:function show(e){if(this.isVisible()||this.showing||this.hidding){return;}
this.showing=true;this.hidding=false;this.clicking=false;var cp=this.colorpicker;cp.lastEvent.alias='show';cp.lastEvent.e=e;if(e&&(!this.hasInput||this.input.attr('type')==='color')&&e&&e.preventDefault){e.stopPropagation();e.preventDefault();}
if(this.isPopover){(0,_jquery2.default)(this.root).on('resize.colorpicker',_jquery2.default.proxy(this.reposition,this));}
cp.picker.addClass('colorpicker-visible').removeClass('colorpicker-hidden');if(this.popoverTarget){this.popoverTarget.popover('show');}else{this.fireShow();}}},{key:'fireShow',value:function fireShow(){this.hidding=false;this.showing=false;if(this.isPopover){(0,_jquery2.default)(this.root.document).on('mousedown.colorpicker touchstart.colorpicker',_jquery2.default.proxy(this.hide,this));(0,_jquery2.default)(this.root.document).on('mousedown.colorpicker touchstart.colorpicker',_jquery2.default.proxy(this.onClickingInside,this));}
this.colorpicker.trigger('colorpickerShow');}},{key:'hide',value:function hide(e){if(this.isHidden()||this.showing||this.hidding){return;}
var cp=this.colorpicker,clicking=this.clicking||this.isClickingInside(e);this.hidding=true;this.showing=false;this.clicking=false;cp.lastEvent.alias='hide';cp.lastEvent.e=e;if(clicking){this.hidding=false;return;}
if(this.popoverTarget){this.popoverTarget.popover('hide');}else{this.fireHide();}}},{key:'fireHide',value:function fireHide(){this.hidding=false;this.showing=false;var cp=this.colorpicker;cp.picker.addClass('colorpicker-hidden').removeClass('colorpicker-visible');(0,_jquery2.default)(this.root).off('resize.colorpicker',_jquery2.default.proxy(this.reposition,this));(0,_jquery2.default)(this.root.document).off('mousedown.colorpicker touchstart.colorpicker',_jquery2.default.proxy(this.hide,this));(0,_jquery2.default)(this.root.document).off('mousedown.colorpicker touchstart.colorpicker',_jquery2.default.proxy(this.onClickingInside,this));cp.trigger('colorpickerHide');}},{key:'focus',value:function focus(){if(this.hasAddon){return this.addon.focus();}
if(this.hasInput){return this.input.focus();}
return false;}},{key:'isVisible',value:function isVisible(){return this.colorpicker.picker.hasClass('colorpicker-visible')&&!this.colorpicker.picker.hasClass('colorpicker-hidden');}},{key:'isHidden',value:function isHidden(){return this.colorpicker.picker.hasClass('colorpicker-hidden')&&!this.colorpicker.picker.hasClass('colorpicker-visible');}},{key:'input',get:function get(){return this.colorpicker.inputHandler.input;}},{key:'hasInput',get:function get(){return this.colorpicker.inputHandler.hasInput();}},{key:'addon',get:function get(){return this.colorpicker.addonHandler.addon;}},{key:'hasAddon',get:function get(){return this.colorpicker.addonHandler.hasAddon();}},{key:'isPopover',get:function get(){return!this.colorpicker.options.inline&&!!this.popoverTip;}}]);return PopupHandler;}();exports.default=PopupHandler;module.exports=exports.default;}),(function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});var _createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value"in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor);}}return function(Constructor,protoProps,staticProps){if(protoProps)defineProperties(Constructor.prototype,protoProps);if(staticProps)defineProperties(Constructor,staticProps);return Constructor;};}();var _jquery=__webpack_require__(0);var _jquery2=_interopRequireDefault(_jquery);var _ColorItem=__webpack_require__(2);var _ColorItem2=_interopRequireDefault(_ColorItem);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj};}
function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function");}}
var InputHandler=function(){function InputHandler(colorpicker){_classCallCheck(this,InputHandler);this.colorpicker=colorpicker;this.input=this.colorpicker.element.is('input')?this.colorpicker.element:this.colorpicker.options.input?this.colorpicker.element.find(this.colorpicker.options.input):false;if(this.input&&this.input.length===0){this.input=false;}
this._initValue();}
_createClass(InputHandler,[{key:'bind',value:function bind(){if(!this.hasInput()){return;}
this.input.on({'keyup.colorpicker':_jquery2.default.proxy(this.onkeyup,this)});this.input.on({'change.colorpicker':_jquery2.default.proxy(this.onchange,this)});}},{key:'unbind',value:function unbind(){if(!this.hasInput()){return;}
this.input.off('.colorpicker');}},{key:'_initValue',value:function _initValue(){if(!this.hasInput()){return;}
var val='';[this.input.val(),this.input.data('color'),this.input.attr('data-color')].map(function(item){if(item&&val===''){val=item;}});if(val instanceof _ColorItem2.default){val=this.getFormattedColor(val.string(this.colorpicker.format));}else if(!(typeof val==='string'||val instanceof String)){val='';}
this.input.prop('value',val);}},{key:'getValue',value:function getValue(){if(!this.hasInput()){return false;}
return this.input.val();}},{key:'setValue',value:function setValue(val){if(!this.hasInput()){return;}
var inputVal=this.input.prop('value');val=val?val:'';if(val===(inputVal?inputVal:'')){return;}
this.input.prop('value',val);this.input.trigger({type:'change',colorpicker:this.colorpicker,color:this.colorpicker.color,value:val});}},{key:'getFormattedColor',value:function getFormattedColor(){var val=arguments.length>0&&arguments[0]!==undefined?arguments[0]:null;val=val?val:this.colorpicker.colorHandler.getColorString();if(!val){return'';}
val=this.colorpicker.colorHandler.resolveColorDelegate(val,false);if(this.colorpicker.options.useHashPrefix===false){val=val.replace(/^#/g,'');}
return val;}},{key:'hasInput',value:function hasInput(){return this.input!==false;}},{key:'isEnabled',value:function isEnabled(){return this.hasInput()&&!this.isDisabled();}},{key:'isDisabled',value:function isDisabled(){return this.hasInput()&&this.input.prop('disabled')===true;}},{key:'disable',value:function disable(){if(this.hasInput()){this.input.prop('disabled',true);}}},{key:'enable',value:function enable(){if(this.hasInput()){this.input.prop('disabled',false);}}},{key:'update',value:function update(){if(!this.hasInput()){return;}
if(this.colorpicker.options.autoInputFallback===false&&this.colorpicker.colorHandler.isInvalidColor()){return;}
this.setValue(this.getFormattedColor());}},{key:'onchange',value:function onchange(e){this.colorpicker.lastEvent.alias='input.change';this.colorpicker.lastEvent.e=e;var val=this.getValue();if(val!==e.value){this.colorpicker.setValue(val);}}},{key:'onkeyup',value:function onkeyup(e){this.colorpicker.lastEvent.alias='input.keyup';this.colorpicker.lastEvent.e=e;var val=this.getValue();if(val!==e.value){this.colorpicker.setValue(val);}}}]);return InputHandler;}();exports.default=InputHandler;module.exports=exports.default;}),(function(module,exports,__webpack_require__){"use strict";var colorString=__webpack_require__(17);var convert=__webpack_require__(20);var _slice=[].slice;var skippedModels=['keyword','gray','hex'];var hashedModelKeys={};Object.keys(convert).forEach(function(model){hashedModelKeys[_slice.call(convert[model].labels).sort().join('')]=model;});var limiters={};function Color(obj,model){if(!(this instanceof Color)){return new Color(obj,model);}
if(model&&model in skippedModels){model=null;}
if(model&&!(model in convert)){throw new Error('Unknown model: '+model);}
var i;var channels;if(obj==null){this.model='rgb';this.color=[0,0,0];this.valpha=1;}else if(obj instanceof Color){this.model=obj.model;this.color=obj.color.slice();this.valpha=obj.valpha;}else if(typeof obj==='string'){var result=colorString.get(obj);if(result===null){throw new Error('Unable to parse color from string: '+obj);}
this.model=result.model;channels=convert[this.model].channels;this.color=result.value.slice(0,channels);this.valpha=typeof result.value[channels]==='number'?result.value[channels]:1;}else if(obj.length){this.model=model||'rgb';channels=convert[this.model].channels;var newArr=_slice.call(obj,0,channels);this.color=zeroArray(newArr,channels);this.valpha=typeof obj[channels]==='number'?obj[channels]:1;}else if(typeof obj==='number'){obj&=0xFFFFFF;this.model='rgb';this.color=[(obj>>16)&0xFF,(obj>>8)&0xFF,obj&0xFF];this.valpha=1;}else{this.valpha=1;var keys=Object.keys(obj);if('alpha'in obj){keys.splice(keys.indexOf('alpha'),1);this.valpha=typeof obj.alpha==='number'?obj.alpha:0;}
var hashedKeys=keys.sort().join('');if(!(hashedKeys in hashedModelKeys)){throw new Error('Unable to parse color from object: '+JSON.stringify(obj));}
this.model=hashedModelKeys[hashedKeys];var labels=convert[this.model].labels;var color=[];for(i=0;i<labels.length;i++){color.push(obj[labels[i]]);}
this.color=zeroArray(color);}
if(limiters[this.model]){channels=convert[this.model].channels;for(i=0;i<channels;i++){var limit=limiters[this.model][i];if(limit){this.color[i]=limit(this.color[i]);}}}
this.valpha=Math.max(0,Math.min(1,this.valpha));if(Object.freeze){Object.freeze(this);}}
Color.prototype={toString:function(){return this.string();},toJSON:function(){return this[this.model]();},string:function(places){var self=this.model in colorString.to?this:this.rgb();self=self.round(typeof places==='number'?places:1);var args=self.valpha===1?self.color:self.color.concat(this.valpha);return colorString.to[self.model](args);},percentString:function(places){var self=this.rgb().round(typeof places==='number'?places:1);var args=self.valpha===1?self.color:self.color.concat(this.valpha);return colorString.to.rgb.percent(args);},array:function(){return this.valpha===1?this.color.slice():this.color.concat(this.valpha);},object:function(){var result={};var channels=convert[this.model].channels;var labels=convert[this.model].labels;for(var i=0;i<channels;i++){result[labels[i]]=this.color[i];}
if(this.valpha!==1){result.alpha=this.valpha;}
return result;},unitArray:function(){var rgb=this.rgb().color;rgb[0]/=255;rgb[1]/=255;rgb[2]/=255;if(this.valpha!==1){rgb.push(this.valpha);}
return rgb;},unitObject:function(){var rgb=this.rgb().object();rgb.r/=255;rgb.g/=255;rgb.b/=255;if(this.valpha!==1){rgb.alpha=this.valpha;}
return rgb;},round:function(places){places=Math.max(places||0,0);return new Color(this.color.map(roundToPlace(places)).concat(this.valpha),this.model);},alpha:function(val){if(arguments.length){return new Color(this.color.concat(Math.max(0,Math.min(1,val))),this.model);}
return this.valpha;},red:getset('rgb',0,maxfn(255)),green:getset('rgb',1,maxfn(255)),blue:getset('rgb',2,maxfn(255)),hue:getset(['hsl','hsv','hsl','hwb','hcg'],0,function(val){return((val%360)+360)%360;}),saturationl:getset('hsl',1,maxfn(100)),lightness:getset('hsl',2,maxfn(100)),saturationv:getset('hsv',1,maxfn(100)),value:getset('hsv',2,maxfn(100)),chroma:getset('hcg',1,maxfn(100)),gray:getset('hcg',2,maxfn(100)),white:getset('hwb',1,maxfn(100)),wblack:getset('hwb',2,maxfn(100)),cyan:getset('cmyk',0,maxfn(100)),magenta:getset('cmyk',1,maxfn(100)),yellow:getset('cmyk',2,maxfn(100)),black:getset('cmyk',3,maxfn(100)),x:getset('xyz',0,maxfn(100)),y:getset('xyz',1,maxfn(100)),z:getset('xyz',2,maxfn(100)),l:getset('lab',0,maxfn(100)),a:getset('lab',1),b:getset('lab',2),keyword:function(val){if(arguments.length){return new Color(val);}
return convert[this.model].keyword(this.color);},hex:function(val){if(arguments.length){return new Color(val);}
return colorString.to.hex(this.rgb().round().color);},rgbNumber:function(){var rgb=this.rgb().color;return((rgb[0]&0xFF)<<16)|((rgb[1]&0xFF)<<8)|(rgb[2]&0xFF);},luminosity:function(){var rgb=this.rgb().color;var lum=[];for(var i=0;i<rgb.length;i++){var chan=rgb[i]/255;lum[i]=(chan<=0.03928)?chan/12.92:Math.pow(((chan+0.055)/1.055),2.4);}
return 0.2126*lum[0]+0.7152*lum[1]+0.0722*lum[2];},contrast:function(color2){var lum1=this.luminosity();var lum2=color2.luminosity();if(lum1>lum2){return(lum1+0.05)/(lum2+0.05);}
return(lum2+0.05)/(lum1+0.05);},level:function(color2){var contrastRatio=this.contrast(color2);if(contrastRatio>=7.1){return'AAA';}
return(contrastRatio>=4.5)?'AA':'';},isDark:function(){var rgb=this.rgb().color;var yiq=(rgb[0]*299+rgb[1]*587+rgb[2]*114)/1000;return yiq<128;},isLight:function(){return!this.isDark();},negate:function(){var rgb=this.rgb();for(var i=0;i<3;i++){rgb.color[i]=255-rgb.color[i];}
return rgb;},lighten:function(ratio){var hsl=this.hsl();hsl.color[2]+=hsl.color[2]*ratio;return hsl;},darken:function(ratio){var hsl=this.hsl();hsl.color[2]-=hsl.color[2]*ratio;return hsl;},saturate:function(ratio){var hsl=this.hsl();hsl.color[1]+=hsl.color[1]*ratio;return hsl;},desaturate:function(ratio){var hsl=this.hsl();hsl.color[1]-=hsl.color[1]*ratio;return hsl;},whiten:function(ratio){var hwb=this.hwb();hwb.color[1]+=hwb.color[1]*ratio;return hwb;},blacken:function(ratio){var hwb=this.hwb();hwb.color[2]+=hwb.color[2]*ratio;return hwb;},grayscale:function(){var rgb=this.rgb().color;var val=rgb[0]*0.3+rgb[1]*0.59+rgb[2]*0.11;return Color.rgb(val,val,val);},fade:function(ratio){return this.alpha(this.valpha-(this.valpha*ratio));},opaquer:function(ratio){return this.alpha(this.valpha+(this.valpha*ratio));},rotate:function(degrees){var hsl=this.hsl();var hue=hsl.color[0];hue=(hue+degrees)%360;hue=hue<0?360+hue:hue;hsl.color[0]=hue;return hsl;},mix:function(mixinColor,weight){if(!mixinColor||!mixinColor.rgb){throw new Error('Argument to "mix" was not a Color instance, but rather an instance of '+typeof mixinColor);}
var color1=mixinColor.rgb();var color2=this.rgb();var p=weight===undefined?0.5:weight;var w=2*p-1;var a=color1.alpha()-color2.alpha();var w1=(((w*a===-1)?w:(w+a)/(1+w*a))+1)/2.0;var w2=1-w1;return Color.rgb(w1*color1.red()+w2*color2.red(),w1*color1.green()+w2*color2.green(),w1*color1.blue()+w2*color2.blue(),color1.alpha()*p+color2.alpha()*(1-p));}};Object.keys(convert).forEach(function(model){if(skippedModels.indexOf(model)!==-1){return;}
var channels=convert[model].channels;Color.prototype[model]=function(){if(this.model===model){return new Color(this);}
if(arguments.length){return new Color(arguments,model);}
var newAlpha=typeof arguments[channels]==='number'?channels:this.valpha;return new Color(assertArray(convert[this.model][model].raw(this.color)).concat(newAlpha),model);};Color[model]=function(color){if(typeof color==='number'){color=zeroArray(_slice.call(arguments),channels);}
return new Color(color,model);};});function roundTo(num,places){return Number(num.toFixed(places));}
function roundToPlace(places){return function(num){return roundTo(num,places);};}
function getset(model,channel,modifier){model=Array.isArray(model)?model:[model];model.forEach(function(m){(limiters[m]||(limiters[m]=[]))[channel]=modifier;});model=model[0];return function(val){var result;if(arguments.length){if(modifier){val=modifier(val);}
result=this[model]();result.color[channel]=val;return result;}
result=this[model]().color[channel];if(modifier){result=modifier(result);}
return result;};}
function maxfn(max){return function(v){return Math.max(0,Math.min(max,v));};}
function assertArray(val){return Array.isArray(val)?val:[val];}
function zeroArray(arr,length){for(var i=0;i<length;i++){if(typeof arr[i]!=='number'){arr[i]=0;}}
return arr;}
module.exports=Color;}),(function(module,exports,__webpack_require__){var colorNames=__webpack_require__(5);var swizzle=__webpack_require__(18);var reverseNames={};for(var name in colorNames){if(colorNames.hasOwnProperty(name)){reverseNames[colorNames[name]]=name;}}
var cs=module.exports={to:{},get:{}};cs.get=function(string){var prefix=string.substring(0,3).toLowerCase();var val;var model;switch(prefix){case'hsl':val=cs.get.hsl(string);model='hsl';break;case'hwb':val=cs.get.hwb(string);model='hwb';break;default:val=cs.get.rgb(string);model='rgb';break;}
if(!val){return null;}
return{model:model,value:val};};cs.get.rgb=function(string){if(!string){return null;}
var abbr=/^#([a-f0-9]{3,4})$/i;var hex=/^#([a-f0-9]{6})([a-f0-9]{2})?$/i;var rgba=/^rgba?\(\s*([+-]?\d+)\s*,\s*([+-]?\d+)\s*,\s*([+-]?\d+)\s*(?:,\s*([+-]?[\d\.]+)\s*)?\)$/;var per=/^rgba?\(\s*([+-]?[\d\.]+)\%\s*,\s*([+-]?[\d\.]+)\%\s*,\s*([+-]?[\d\.]+)\%\s*(?:,\s*([+-]?[\d\.]+)\s*)?\)$/;var keyword=/(\D+)/;var rgb=[0,0,0,1];var match;var i;var hexAlpha;if(match=string.match(hex)){hexAlpha=match[2];match=match[1];for(i=0;i<3;i++){var i2=i*2;rgb[i]=parseInt(match.slice(i2,i2+2),16);}
if(hexAlpha){rgb[3]=Math.round((parseInt(hexAlpha,16)/255)*100)/100;}}else if(match=string.match(abbr)){match=match[1];hexAlpha=match[3];for(i=0;i<3;i++){rgb[i]=parseInt(match[i]+match[i],16);}
if(hexAlpha){rgb[3]=Math.round((parseInt(hexAlpha+hexAlpha,16)/255)*100)/100;}}else if(match=string.match(rgba)){for(i=0;i<3;i++){rgb[i]=parseInt(match[i+1],0);}
if(match[4]){rgb[3]=parseFloat(match[4]);}}else if(match=string.match(per)){for(i=0;i<3;i++){rgb[i]=Math.round(parseFloat(match[i+1])*2.55);}
if(match[4]){rgb[3]=parseFloat(match[4]);}}else if(match=string.match(keyword)){if(match[1]==='transparent'){return[0,0,0,0];}
rgb=colorNames[match[1]];if(!rgb){return null;}
rgb[3]=1;return rgb;}else{return null;}
for(i=0;i<3;i++){rgb[i]=clamp(rgb[i],0,255);}
rgb[3]=clamp(rgb[3],0,1);return rgb;};cs.get.hsl=function(string){if(!string){return null;}
var hsl=/^hsla?\(\s*([+-]?(?:\d*\.)?\d+)(?:deg)?\s*,\s*([+-]?[\d\.]+)%\s*,\s*([+-]?[\d\.]+)%\s*(?:,\s*([+-]?[\d\.]+)\s*)?\)$/;var match=string.match(hsl);if(match){var alpha=parseFloat(match[4]);var h=(parseFloat(match[1])+360)%360;var s=clamp(parseFloat(match[2]),0,100);var l=clamp(parseFloat(match[3]),0,100);var a=clamp(isNaN(alpha)?1:alpha,0,1);return[h,s,l,a];}
return null;};cs.get.hwb=function(string){if(!string){return null;}
var hwb=/^hwb\(\s*([+-]?\d*[\.]?\d+)(?:deg)?\s*,\s*([+-]?[\d\.]+)%\s*,\s*([+-]?[\d\.]+)%\s*(?:,\s*([+-]?[\d\.]+)\s*)?\)$/;var match=string.match(hwb);if(match){var alpha=parseFloat(match[4]);var h=((parseFloat(match[1])%360)+360)%360;var w=clamp(parseFloat(match[2]),0,100);var b=clamp(parseFloat(match[3]),0,100);var a=clamp(isNaN(alpha)?1:alpha,0,1);return[h,w,b,a];}
return null;};cs.to.hex=function(){var rgba=swizzle(arguments);return('#'+
hexDouble(rgba[0])+
hexDouble(rgba[1])+
hexDouble(rgba[2])+
(rgba[3]<1?(hexDouble(Math.round(rgba[3]*255))):''));};cs.to.rgb=function(){var rgba=swizzle(arguments);return rgba.length<4||rgba[3]===1?'rgb('+Math.round(rgba[0])+', '+Math.round(rgba[1])+', '+Math.round(rgba[2])+')':'rgba('+Math.round(rgba[0])+', '+Math.round(rgba[1])+', '+Math.round(rgba[2])+', '+rgba[3]+')';};cs.to.rgb.percent=function(){var rgba=swizzle(arguments);var r=Math.round(rgba[0]/255*100);var g=Math.round(rgba[1]/255*100);var b=Math.round(rgba[2]/255*100);return rgba.length<4||rgba[3]===1?'rgb('+r+'%, '+g+'%, '+b+'%)':'rgba('+r+'%, '+g+'%, '+b+'%, '+rgba[3]+')';};cs.to.hsl=function(){var hsla=swizzle(arguments);return hsla.length<4||hsla[3]===1?'hsl('+hsla[0]+', '+hsla[1]+'%, '+hsla[2]+'%)':'hsla('+hsla[0]+', '+hsla[1]+'%, '+hsla[2]+'%, '+hsla[3]+')';};cs.to.hwb=function(){var hwba=swizzle(arguments);var a='';if(hwba.length>=4&&hwba[3]!==1){a=', '+hwba[3];}
return'hwb('+hwba[0]+', '+hwba[1]+'%, '+hwba[2]+'%'+a+')';};cs.to.keyword=function(rgb){return reverseNames[rgb.slice(0,3)];};function clamp(num,min,max){return Math.min(Math.max(min,num),max);}
function hexDouble(num){var str=num.toString(16).toUpperCase();return(str.length<2)?'0'+str:str;}}),(function(module,exports,__webpack_require__){"use strict";var isArrayish=__webpack_require__(19);var concat=Array.prototype.concat;var slice=Array.prototype.slice;var swizzle=module.exports=function swizzle(args){var results=[];for(var i=0,len=args.length;i<len;i++){var arg=args[i];if(isArrayish(arg)){results=concat.call(results,slice.call(arg));}else{results.push(arg);}}
return results;};swizzle.wrap=function(fn){return function(){return fn(swizzle(arguments));};};}),(function(module,exports,__webpack_require__){"use strict";module.exports=function isArrayish(obj){if(!obj){return false;}
return obj instanceof Array||Array.isArray(obj)||(obj.length>=0&&obj.splice instanceof Function);};}),(function(module,exports,__webpack_require__){var conversions=__webpack_require__(6);var route=__webpack_require__(21);var convert={};var models=Object.keys(conversions);function wrapRaw(fn){var wrappedFn=function(args){if(args===undefined||args===null){return args;}
if(arguments.length>1){args=Array.prototype.slice.call(arguments);}
return fn(args);};if('conversion'in fn){wrappedFn.conversion=fn.conversion;}
return wrappedFn;}
function wrapRounded(fn){var wrappedFn=function(args){if(args===undefined||args===null){return args;}
if(arguments.length>1){args=Array.prototype.slice.call(arguments);}
var result=fn(args);if(typeof result==='object'){for(var len=result.length,i=0;i<len;i++){result[i]=Math.round(result[i]);}}
return result;};if('conversion'in fn){wrappedFn.conversion=fn.conversion;}
return wrappedFn;}
models.forEach(function(fromModel){convert[fromModel]={};Object.defineProperty(convert[fromModel],'channels',{value:conversions[fromModel].channels});Object.defineProperty(convert[fromModel],'labels',{value:conversions[fromModel].labels});var routes=route(fromModel);var routeModels=Object.keys(routes);routeModels.forEach(function(toModel){var fn=routes[toModel];convert[fromModel][toModel]=wrapRounded(fn);convert[fromModel][toModel].raw=wrapRaw(fn);});});module.exports=convert;}),(function(module,exports,__webpack_require__){var conversions=__webpack_require__(6);function buildGraph(){var graph={};var models=Object.keys(conversions);for(var len=models.length,i=0;i<len;i++){graph[models[i]]={distance:-1,parent:null};}
return graph;}
function deriveBFS(fromModel){var graph=buildGraph();var queue=[fromModel];graph[fromModel].distance=0;while(queue.length){var current=queue.pop();var adjacents=Object.keys(conversions[current]);for(var len=adjacents.length,i=0;i<len;i++){var adjacent=adjacents[i];var node=graph[adjacent];if(node.distance===-1){node.distance=graph[current].distance+1;node.parent=current;queue.unshift(adjacent);}}}
return graph;}
function link(from,to){return function(args){return to(from(args));};}
function wrapConversion(toModel,graph){var path=[graph[toModel].parent,toModel];var fn=conversions[graph[toModel].parent][toModel];var cur=graph[toModel].parent;while(graph[cur].parent){path.unshift(graph[cur].parent);fn=link(conversions[graph[cur].parent][cur],fn);cur=graph[cur].parent;}
fn.conversion=path;return fn;}
module.exports=function(fromModel){var graph=deriveBFS(fromModel);var conversion={};var models=Object.keys(graph);for(var len=models.length,i=0;i<len;i++){var toModel=models[i];var node=graph[toModel];if(node.parent===null){continue;}
conversion[toModel]=wrapConversion(toModel,graph);}
return conversion;};}),(function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});var _createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value"in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor);}}return function(Constructor,protoProps,staticProps){if(protoProps)defineProperties(Constructor.prototype,protoProps);if(staticProps)defineProperties(Constructor,staticProps);return Constructor;};}();var _jquery=__webpack_require__(0);var _jquery2=_interopRequireDefault(_jquery);var _ColorItem=__webpack_require__(2);var _ColorItem2=_interopRequireDefault(_ColorItem);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj};}
function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function");}}
var ColorHandler=function(){function ColorHandler(colorpicker){_classCallCheck(this,ColorHandler);this.colorpicker=colorpicker;}
_createClass(ColorHandler,[{key:'bind',value:function bind(){if(this.colorpicker.options.color){this.color=this.createColor(this.colorpicker.options.color);return;}
if(!this.color&&!!this.colorpicker.inputHandler.getValue()){this.color=this.createColor(this.colorpicker.inputHandler.getValue(),this.colorpicker.options.autoInputFallback);}}},{key:'unbind',value:function unbind(){this.colorpicker.element.removeData('color');}},{key:'getColorString',value:function getColorString(){if(!this.hasColor()){return'';}
return this.color.string(this.format);}},{key:'setColorString',value:function setColorString(val){var color=val?this.createColor(val):null;this.color=color?color:null;}},{key:'createColor',value:function createColor(val){var fallbackOnInvalid=arguments.length>1&&arguments[1]!==undefined?arguments[1]:true;var color=new _ColorItem2.default(this.resolveColorDelegate(val),this.format);if(!color.isValid()){if(fallbackOnInvalid){color=this.getFallbackColor();}
this.colorpicker.trigger('colorpickerInvalid',color,val);}
if(!this.isAlphaEnabled()){color.alpha=1;}
return color;}},{key:'getFallbackColor',value:function getFallbackColor(){if(this.fallback&&this.fallback===this.color){return this.color;}
var fallback=this.resolveColorDelegate(this.fallback);var color=new _ColorItem2.default(fallback,this.format);if(!color.isValid()){console.warn('The fallback color is invalid. Falling back to the previous color or black if any.');return this.color?this.color:new _ColorItem2.default('#000000',this.format);}
return color;}},{key:'assureColor',value:function assureColor(){if(!this.hasColor()){this.color=this.getFallbackColor();}
return this.color;}},{key:'resolveColorDelegate',value:function resolveColorDelegate(color){var realColor=arguments.length>1&&arguments[1]!==undefined?arguments[1]:true;var extResolvedColor=false;_jquery2.default.each(this.colorpicker.extensions,function(name,ext){if(extResolvedColor!==false){return;}
extResolvedColor=ext.resolveColor(color,realColor);});return extResolvedColor?extResolvedColor:color;}},{key:'isInvalidColor',value:function isInvalidColor(){return!this.hasColor()||!this.color.isValid();}},{key:'isAlphaEnabled',value:function isAlphaEnabled(){return this.colorpicker.options.useAlpha!==false;}},{key:'hasColor',value:function hasColor(){return this.color instanceof _ColorItem2.default;}},{key:'fallback',get:function get(){return this.colorpicker.options.fallbackColor?this.colorpicker.options.fallbackColor:this.hasColor()?this.color:null;}},{key:'format',get:function get(){if(this.colorpicker.options.format){return this.colorpicker.options.format;}
if(this.hasColor()&&this.color.hasTransparency()&&this.color.format.match(/^hex/)){return this.isAlphaEnabled()?'rgba':'hex';}
if(this.hasColor()){return this.color.format;}
return'rgb';}},{key:'color',get:function get(){return this.colorpicker.element.data('color');},set:function set(value){this.colorpicker.element.data('color',value);if(value instanceof _ColorItem2.default&&this.colorpicker.options.format==='auto'){this.colorpicker.options.format=this.color.format;}}}]);return ColorHandler;}();exports.default=ColorHandler;module.exports=exports.default;}),(function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});var _createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value"in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor);}}return function(Constructor,protoProps,staticProps){if(protoProps)defineProperties(Constructor.prototype,protoProps);if(staticProps)defineProperties(Constructor,staticProps);return Constructor;};}();var _jquery=__webpack_require__(0);var _jquery2=_interopRequireDefault(_jquery);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj};}
function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function");}}
var PickerHandler=function(){function PickerHandler(colorpicker){_classCallCheck(this,PickerHandler);this.colorpicker=colorpicker;this.picker=null;}
_createClass(PickerHandler,[{key:'bind',value:function bind(){var picker=this.picker=(0,_jquery2.default)(this.options.template);if(this.options.customClass){picker.addClass(this.options.customClass);}
if(this.options.horizontal){picker.addClass('colorpicker-horizontal');}
if(this._supportsAlphaBar()){this.options.useAlpha=true;picker.addClass('colorpicker-with-alpha');}else{this.options.useAlpha=false;}}},{key:'attach',value:function attach(){var pickerParent=this.colorpicker.container?this.colorpicker.container:null;if(pickerParent){this.picker.appendTo(pickerParent);}}},{key:'unbind',value:function unbind(){this.picker.remove();}},{key:'_supportsAlphaBar',value:function _supportsAlphaBar(){return(this.options.useAlpha||this.colorpicker.colorHandler.hasColor()&&this.color.hasTransparency())&&this.options.useAlpha!==false&&(!this.options.format||this.options.format&&!this.options.format.match(/^hex([36])?$/i));}},{key:'update',value:function update(){if(!this.colorpicker.colorHandler.hasColor()){return;}
var vertical=this.options.horizontal!==true,slider=vertical?this.options.sliders:this.options.slidersHorz;var saturationGuide=this.picker.find('.colorpicker-saturation .colorpicker-guide'),hueGuide=this.picker.find('.colorpicker-hue .colorpicker-guide'),alphaGuide=this.picker.find('.colorpicker-alpha .colorpicker-guide');var hsva=this.color.toHsvaRatio();if(hueGuide.length){hueGuide.css(vertical?'top':'left',(vertical?slider.hue.maxTop:slider.hue.maxLeft)*(1-hsva.h));}
if(alphaGuide.length){alphaGuide.css(vertical?'top':'left',(vertical?slider.alpha.maxTop:slider.alpha.maxLeft)*(1-hsva.a));}
if(saturationGuide.length){saturationGuide.css({'top':slider.saturation.maxTop-hsva.v*slider.saturation.maxTop,'left':hsva.s*slider.saturation.maxLeft});}
this.picker.find('.colorpicker-saturation').css('backgroundColor',this.color.getCloneHueOnly().toHexString());var hexColor=this.color.toHexString();var alphaBg='';if(this.options.horizontal){alphaBg='linear-gradient(to right, '+hexColor+' 0%, transparent 100%)';}else{alphaBg='linear-gradient(to bottom, '+hexColor+' 0%, transparent 100%)';}
this.picker.find('.colorpicker-alpha-color').css('background',alphaBg);}},{key:'options',get:function get(){return this.colorpicker.options;}},{key:'color',get:function get(){return this.colorpicker.colorHandler.color;}}]);return PickerHandler;}();exports.default=PickerHandler;module.exports=exports.default;}),(function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});var _createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value"in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor);}}return function(Constructor,protoProps,staticProps){if(protoProps)defineProperties(Constructor.prototype,protoProps);if(staticProps)defineProperties(Constructor,staticProps);return Constructor;};}();function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function");}}
var AddonHandler=function(){function AddonHandler(colorpicker){_classCallCheck(this,AddonHandler);this.colorpicker=colorpicker;this.addon=null;}
_createClass(AddonHandler,[{key:'hasAddon',value:function hasAddon(){return!!this.addon;}},{key:'bind',value:function bind(){this.addon=this.colorpicker.options.addon?this.colorpicker.element.find(this.colorpicker.options.addon):null;if(this.addon&&this.addon.length===0){this.addon=null;}}},{key:'unbind',value:function unbind(){if(this.hasAddon()){this.addon.off('.colorpicker');}}},{key:'update',value:function update(){if(!this.colorpicker.colorHandler.hasColor()||!this.hasAddon()){return;}
var colorStr=this.colorpicker.colorHandler.getColorString();var styles={'background':colorStr};var icn=this.addon.find('i').eq(0);if(icn.length>0){icn.css(styles);}else{this.addon.css(styles);}}}]);return AddonHandler;}();exports.default=AddonHandler;module.exports=exports.default;})]);});;;(function(global,$){$.extend($.expr[':'],{'impressor':function(a,i,m){var top=$(window).scrollTop(),fold=$(window).height()+top;return(!(fold-75<=$(a).offset().top)&&!(top+150>=$(a).offset().top+$(a).height()));}});var Impressor={};Impressor.VERSION='1.0.1';Impressor.TOPIC='impressor';Impressor.LOGGER=log.getLogger('impressor');navigator.sendBeacon=(navigator.sendBeacon||function(url,data){$.ajax({'contentType':'text/plain;charset=UTF-8','async':false,'type':'POST','data':data,'url':url});});var Collector=function(){this.parse=_.throttle(_.bind(this._parse,this),350);this.logger=Impressor.LOGGER;};Collector.prototype={'data':null,'time_out':0,'options':null,'defaults':{'impress_key':'im','data_key':'id','selector':'','data':{}},'setup':function(options){this.options=_.extend({},this.defaults,options||{});PubSub.subscribe(Impressor.TOPIC,_.bind(this.add,this));$(window).on('unload',_.bind(this.store,this));$(window).on('resize scroll',this.parse);this.logger.info('SETUP:',this.options);this.update();},'add':function(msg,data){if(_.has(data,'tag')&&_.has(data,'id')){if(!_.isArray(this.data[data.tag])){this.data[data.tag]=[];}
if(!_.contains(this.data[data.tag],data.id)){this.logger.debug('ADD:',data,this.data[data.tag].length);this.data[data.tag].push(data.id);}}},'push':function(tag,id){PubSub.publish(Impressor.TOPIC,{'tag':tag,'id':id});},'_parse':function(){this.logger.info('PARSING DOCUMENT');var items=$(document).find(this.options.selector+'[data-'+this.options.data_key+']:impressor');_.each(items,function(item){this.push(this.options.impress_key,$(item).data(this.options.data_key));},this);},'update':function(data){var old_data=_.pick(this.data,_.keys(this.options.data)),new_data=_.extend({},this.options.data,data||{});if(!_.isEqual(old_data,new_data)){this.store();this.data=new_data;}},'store':function(event){if(!_.isEmpty(this.data)){this.logger.info('STORE DATA');var url=this.options.url+'?_ts='+_.now(),data=JSON.stringify(this.data);navigator.sendBeacon(url,data);}}};var collector=new Collector();Impressor.update=_.bind(collector.update,collector);Impressor.setup=_.bind(collector.setup,collector);Impressor.parse=_.bind(collector.parse,collector);Impressor.push=_.bind(collector.push,collector);global.Impressor=Impressor;}(this,jQuery));;;(function(global,$){var Zoom={};Zoom.VERSION='2.0.0';Zoom.LOGGER=log.getLogger('zoom');Zoom.Scales=function(options){this.initialize.apply(this,arguments);this.idx=0;};Zoom.Scales.prototype=Array.prototype;_.extend(Zoom.Scales.prototype,Backbone.Events,{initialize:function(options){this.listenTo(options.view,'reset',this.reset);var prev_scale=1,long_side=Math.max(options.width,options.height);_.each(options.sizes,function(size){var scale=(size.size/long_side);this.push({adjust:(scale/prev_scale),display:size.name,scale:scale});prev_scale=scale;},this);},current:function(){return this[this.idx-1];},next:function(){return this[this.idx];},params:function(){return{scale:this.next().scale};},increment:function(){this.idx++;},reset:function(){this.idx=0;},hasNext:function(){return(this.idx<this.length);}});Zoom.Box=Backbone.View.extend({tagName:'div',className:'zoom-box',offset:{left:0,top:0},initialize:function(options){this.view=options.view;this.view.$el.on('mousemove',_.throttle(_.bind(this.mousemove,this),25));this.view.$el.on('mouseenter',_.bind(this.mouseenter,this));this.view.$el.on('mouseleave',_.bind(this.mouseleave,this));this.listenTo(this.view,'reset',this.reset,this);this.listenTo(this.view,'loading',this.loading,this);this.listenTo(this.view,'load',this.load,this);this.offset.left=this.offset.top=0;this.setup();},setup:function(){var scale=this.view.scales.next();this.$el.width(Math.floor(this.view.width/scale.adjust));this.$el.height(Math.floor(this.view.height/scale.adjust));this.data={max_left:(this.view.width-this.$el.outerWidth()),max_top:(this.view.height-this.$el.outerHeight()),center_left:(this.$el.width()/2),center_top:(this.$el.height()/2)};if(this.view.$el.is(':hover'))this.mouseenter();},mousemove:function(event){var offset=this.view.$el.offset();var mouseLeft=Math.floor(event.clientX-offset.left+$(document).scrollLeft()),mouseTop=Math.floor(event.clientY-offset.top+$(document).scrollTop());this.$el.css({left:Math.max(Math.min((mouseLeft-this.data.center_left),this.data.max_left),0),top:Math.max(Math.min((mouseTop-this.data.center_top),this.data.max_top),0)});},mouseenter:function(event){if(this.view.scales.hasNext()){this.$el.show();}},mouseleave:function(event){this.$el.hide();},params:function(){return{left:this.offset.left,top:this.offset.top};},loading:function(event){var position=this.$el.position();var scale=this.view.scales.next();this.offset.left=parseInt((this.offset.left+position.left)*scale.adjust);this.offset.top=parseInt((this.offset.top+position.top)*scale.adjust);this.$el.hide();},load:function(event){if(this.view.scales.hasNext()){if(this.view.$el.is(':hover'))this.$el.show();this.setup();}},reset:function(event){this.offset.left=this.offset.top=0;this.setup();}});Zoom.Details=Backbone.View.extend({tagName:'div',className:'zoom-details',initialize:function(options){this.view=options.view;this.listenTo(this.view,'reset',this.reset);this.listenTo(this.view,'load',this.load);},reset:function(){this.$el.hide();},load:function(){var scale=this.view.scales.current();this.$el.html(scale.display).show();}});Zoom.Loading=Backbone.View.extend({tagName:'div',className:'zoom-loading',initialize:function(options){this.view=options.view;this.listenTo(this.view,'load reset',this.load);this.listenTo(this.view,'loading',this.loading);},loading:function(event){this.$el.show();},load:function(){this.$el.hide();}});Zoom.Image=Backbone.View.extend({tagName:'img',className:'zoom-img',events:{'error':'error','load':'load'},initialize:function(options){this.view=options.view;this.listenTo(this.view,'reset',this.reset);},reset:function(event){this.$el.hide();},error:function(event){this.trigger('error');},load:function(event){this.view.trigger('load');this.$el.show();}});Zoom.View=Backbone.View.extend({defaults:{message:'Zoom Error',url:'/zoom/'},events:{'mouseup':'mouseup'},initialize:function(options){_.bindAll(this,'setup','reset');_.defaults(this,options,this.defaults);$(document).on('mouseup',this.reset);this.$('img').each(_.bind(function(idx,el){if(el.complete)this.setup();},this)).on('load',this.setup);},setup:function(){this.width=this.$el.width();this.height=this.$el.height();Zoom.LOGGER.info('Zoom Width:'+this.width+' Zoom Height:'+this.height);this.scales=new Zoom.Scales({height:this.height,width:this.width,sizes:this.sizes,view:this});this.box_view=new Zoom.Box({view:this});this.$el.append(this.box_view.$el);this.image_view=new Zoom.Image({view:this});this.$el.append(this.image_view.$el);this.details_view=new Zoom.Details({view:this});this.$el.append(this.details_view.$el);this.loading_view=new Zoom.Loading({view:this});this.$el.append(this.loading_view.$el);this.listenTo(this.image_view,'error',this.error);},mouseup:function(event){event.stopPropagation();if(this.scales.hasNext()){this.zoom(event);}else{this.reset(event);}},params:function(){return _.extend({height:this.height,width:this.width,id:this.id,_ts:_.now()},this.scales.params(),this.box_view.params());},zoom:function(event){this.trigger('loading');var params=this.params();Zoom.LOGGER.info('Zoom Params:',params);this.image_view.$el.attr('src',this.url+'?'+$.param(params));this.scales.increment();},reset:function(event){this.trigger('reset');},error:function(){Zoom.LOGGER.info('Zoom Error:',arguments);this.reset();this.details_view.remove();this.loading_view.remove();this.image_view.remove();this.box_view.remove();this.undelegateEvents();this.$el.append('<div class="zoom-message">'+'<div class="zoom-error">'+'<p>'+this.message+'</p>'+'</div>'+'</div>');$(document).on('mouseup',_.bind(function(){this.$('div.zoom-message').remove();},this));}});global.Zoom=Zoom;$.fn.zoom=function(options){return this.each(function(){if(!$(this).data('zoom')){$(this).data('zoom',new Zoom.View(_.extend({el:$(this)},options)));}});};}(this,jQuery));;;(function($,undefined){var Detailed=Backbone.View.extend({events:{'click span.contributor em':'contributor','grid:resize':'resize'},initialize:function(){var resize=_.throttle(_.bind(this.resize,this),250);$(window).on('resize load',resize);$(document).on('ready',resize);},resize:function(){if(this.$el.data('mode')==='det'){this.$('img[data-ratio]').bannerhide({mask:'span.thumb-mask',maxWidth:150,height:150});var columns=Math.floor(this.$el.width()/170),cells=this.$('img[data-ratio]').length,remaining=(columns-(cells%columns)),width=(remaining*170)-(2+10+20+70);if(remaining!==columns){this.$('.next-results').css({paddingTop:58,width:'auto'}).removeClass('hidden');this.$('div.next-results-arrow').css({textIndent:(width<110)?'-9999px':'0px',width:width});}else{this.$('.next-results').hide();}}},contributor:function(event){var url=jslink({viewname:'profile',kwargs:{username:$(event.currentTarget).text()}});window.open(url,'_self');}});$.fn.detailed=function(options){return this.each(function(){if(!$(this).data('detailed')){var view=new Detailed({el:$(this)});$(this).data('detailed',view);}});};})(jQuery);;;(function($,undefined){var GridNext=function($container,options){this.options=_.extend({},this.defaults,options);this.$el=$container.find('.next-results');this.$arrow=this.$el.find('div.next-results-arrow');};GridNext.prototype={defaults:{arrow_min_text_width:110,arrow_padding:20,arrow_height:90,arrow_width:70,spacing:10},update:function(row){var bar_width=(row.remaining-(this.options.spacing+this.options.arrow_padding+this.options.arrow_width));if(bar_width>0){var padding=Math.floor((row.height-this.options.arrow_height)/2);this.$el.css({paddingBottom:padding,paddingTop:padding}).removeClass('d-none');this.$arrow.css({textIndent:(bar_width<this.options.arrow_min_text_width)?'-9999px':'0px',width:bar_width});}else{this.$el.addClass('d-none');}}};var GridCell=function($el,c_ratio,i_ratio,options){this.options=_.extend({},this.defaults,options);this.c_ratio=c_ratio;this.i_ratio=i_ratio;this.$el=$el;};GridCell.prototype={defaults:{process_cell:null,max_width:350},process:function(row_height){var cell_width=Math.min(Math.floor(row_height*this.c_ratio),this.options.max_width);var $container=this.$el.parent();$container.parent().css('height',row_height);$container.find(this.options.mask).css({height:row_height,width:cell_width});$container.css({height:row_height,width:cell_width,marginTop:0});if((Math.round(this.c_ratio*100)/100)<1){this.$el.css({height:row_height,width:'auto'});}else{var s_height=Math.floor(cell_width/this.i_ratio)
if(s_height<row_height){if((row_height-s_height)<3){cell_width=Math.ceil(cell_width*(row_height/s_height));}else{$container.css({marginTop:Math.floor((row_height-s_height)/2),height:s_height});}}
this.$el.css({height:'auto',width:cell_width});}
if(this.options.process_cell){this.options.process_cell.call(this,cell_width,row_height);}
return cell_width;}};var GridRow=function(options){this.options=_.extend({},this.defaults,options);this.cells=[];this.remaining=0;this.spacing=0;this.height=0;this.width=0;};GridRow.prototype={defaults:{max_height:200,max_width:350,spacing:10},add:function($elem){var ratio=parseFloat($elem.data('ratio'));var width=Math.min(Math.floor(ratio*this.options.max_height),this.options.max_width);this.cells.push(new GridCell($elem,(width/this.options.max_height),ratio,this.options));this.spacing+=this.options.spacing;this.width+=width;},process:function(c_width){this.remaining=(c_width-this.spacing);this.height=Math.min(Math.floor(this.options.max_height*this.remaining/this.width),this.options.max_height);_.each(this.cells,function(cell){this.remaining-=cell.process(this.height);},this);}};var Grid=function(element,options){var resize=_.throttle(_.bind(this.resize,this),500);this.options=_.extend({},this.defaults,options);this.$el=$(element);$(window).on('resize load',resize);$(document).on('ready',resize);this.$el.on('grid:resize',resize);this.grid_next=new GridNext(this.$el,this.options);};Grid.prototype={defaults:{mask:'span.thumb-mask',selector:'img'},resize:function(){if(this.$el.data('mode')==='grd'){var c_width=this.$el.get(0).clientWidth,row=new GridRow(this.options);if(c_width<=10){_.delay(_.bind(this.resize,this),500);return;}
_.each(this.$el.find(this.options.selector),function(element,index,list){row.add($(element));if((row.width+row.spacing)>=c_width){row.process(c_width);if((index+1)<list.length){row=new GridRow(this.options);}}},this);row.process(c_width);this.grid_next.update(row);this.$el.trigger('grid:resized');}}};$.fn.grid=function(option){return this.each(function(){var options=typeof option==='object'&&(option||{}),grid=$.data(this,'grid');if(!grid)$.data(this,'grid',(grid=new Grid(this,_.extend({},$(this).data(),options))));if(typeof option==='string')grid[option]();});};})(jQuery);;;(function(csp,$,undefined){csp.SearchRouter=Backbone.Router.extend({initialize:function(options){this.route(new RegExp('^(.+)$'),'search');Backbone.history.start({hashChange:false,pushState:true,silent:true});}});})(window.canstockphoto=window.canstockphoto||{},jQuery);;;(function(csp,$,undefined){csp.SearchJumpView=Backbone.View.extend({enabled:true,events:{'click':'click'},initialize:function(options){$(window).on('scroll',_.debounce(_.bind(this.scroll,this),300));this.scroll();},scroll:function(event){if(this.enabled&&$(window).scrollTop()>320&&!$('body,html').is(':animated')){this.$el.slideDown(200);}else{this.$el.slideUp(200);}},click:function(event){$('body,html').animate({scrollTop:0},300);event.preventDefault();this.$el.hide();},hide:function(){this.enabled=false;this.scroll();},show:function(){this.enabled=true;this.scroll();}});})(window.canstockphoto=window.canstockphoto||{},jQuery);;;(function(csp,$,undefined){csp.SearchParams=Backbone.Model.extend({top:0,defaults:{search_phrase:'',search_type:'ALL',search_page:1,search_exact:'',search_orientation:[],search_exclude:'',search_artist:'',search_artist_exclude:[],search_mode:'best',search_color:null,search_size:null,search_copyspace:[],search_people:[],search_people_exact:'',content_filter:null},tag_filters:['search_exact','search_orientation','search_exclude','search_artist','search_artist_exclude','search_color','search_size','search_copyspace','search_people'],parse:function(response){if(response.search_phrase){response.search_phrase=_.unescape(response.search_phrase);}
return response;},toDATA:function(){var data={};_.each(this.toJSON(),function(value,key){if(!_.isEqual(this.defaults[key],value)){data[key]=value;}},this);return data;},reset:function(key,options){this.set(key,this.defaults[key],options);},resetAll:function(options){this.set(_.pick(this.defaults,this.tag_filters),options);},tags:function(iteratee,context){_.each(this.pick(this.tag_filters),function(value,key){if(!_.isEqual(this.defaults[key],value)){_.bind(iteratee,context)(value,key);}},this);},set:function(key,val,options){var attrs;if(typeof key==='object'){options=val;attrs=key;}else{(attrs={})[key]=val;}
_.defaults(attrs,{search_page:1});options=options||{};_.defaults(options,{loading:false});Backbone.Model.prototype.set.call(this,attrs,options);}});})(window.canstockphoto=window.canstockphoto||{},jQuery);;;(function(csp,$,undefined){csp.SearchHeaderView=Backbone.View.extend({initialize:function(options){_.bindAll(this,'submit','change','load');this.$('input[name="search_phrase"]').on('change:suggest paste',this.change);this.$('input[name="search_type"]').on('change',this.change);this.listenTo(this.model,'search:load',this.load);this.$el.on('submit',this.submit);},load:function(model,value,option){var search_type=this.model.get('search_type');if(this.$('input[name="search_type"]:checked').val()!==search_type){this.$('input[name="search_type"][value="'+search_type+'"]').prop('checked',true).trigger('change');}
if(!this.$('input[name="search_phrase"]').is(':focus')){this.$('input[name="search_phrase"]').val(this.model.get('search_phrase'));}},submit:function(event){event.preventDefault();this.change();return false;},change:function(event){this.model.set(_.extend({search_page:1},this.$el.serializeObject()));}});})(window.canstockphoto=window.canstockphoto||{},jQuery);;;(function(csp){var GENDER={MA:gettext('Male'),FE:gettext('Female')};var ETHNICITY={AF:gettext('African'),AS:gettext('Asian'),CA:gettext('Caucasian'),HI:gettext('Hispanic'),MU:gettext('Multi-Ethnic'),OT:gettext('Other')};var AGE={IN:gettext('Infant'),CH:gettext('Child'),TE:gettext('Teenager'),YA:gettext('Young Adult'),MA:gettext('Middle Aged'),SR:gettext('Senior')};var PersonView=Backbone.View.extend({className:'input-group mb-1',template:_.template('<% _.each(modes, function (mode, idx) { %>'+'<select class="custom-select" name="<%= mode.key %>">'+'<option value="XX"><%= mode.label %></option>'+'<% _.each(mode.values, function (value, key) { %>'+'<option value="<%= key %>"<% if (model.get(mode.key) == key) { %> selected="selected"<% } %>>'+'<%= value %>'+'</option>'+'<% }); %>'+'</select>'+'<% }); %>'+'<span class="input-group-append">'+'<span class="btn btn-default btn-remove" title="<%= remove_text %>">'+'<span class="cspicon icon-times-circle"></span>'+'</span>'+'</span>'),events:{'click span.btn.btn-remove':'destroy','change select':'update'},initialize:function(options){var html=this.template({remove_text:gettext('Remove Person'),model:this.model,modes:[{label:gettext('Any Gender'),values:GENDER,key:'gender'},{label:gettext('Any Ethnicity'),values:ETHNICITY,key:'ethnicity'},{label:gettext('Any Age'),values:AGE,key:'age'}]});this.$el.html(html);},update:function(event){var key=this.$(event.currentTarget).attr('name');var value=this.$(event.currentTarget).val();this.model.set(key,value);},destroy:function(){this.model.destroy();this.remove();}});var Person=Backbone.Model.extend({defaults:{ethnicity:'XX',gender:'XX',age:'XX',},initialize:function(){this.view=new PersonView({model:this});},toString:function(){return this.get('gender')+':'+this.get('ethnicity')+':'+this.get('age');}});csp.People=Backbone.Collection.extend({model:Person,parse:function(response){return _.map(response,function(data){return _.object(['gender','ethnicity','age'],data.split(':'))});},results:function(){return this.map(function(model){return model.toString();});}});})(window.canstockphoto=window.canstockphoto||{});;;(function(csp){var Filter=Backbone.View.extend({tagName:'form',className:'form-group col-md-6 col-xl-4',initialize:function(options){_.extend(this,options);this.listenTo(this.model,'change:'+this.name,this.render);this.$el.on('submit',_.bind(this.submit,this));this.$el.attr('data-filter',this.name);},submit:function(event){event.preventDefault();this.change();return false;},change:function(){var data=this.$el.serializeObject();this.model.set(this.parse(data));},value:function(){return this.model.get(this.name);},parse:function(value){return value;},render:function(){this.$el.html(this.template(this));return this;}});var ButtonGroupFilter=Filter.extend({template:_.template('<label><%= label %></label>'+'<div class="input-group">'+'<div class="btn-group btn-group-sm btn-group-toggle" data-toggle="buttons">'+'<% _.each(buttons, function (button) { %>'+'<label class="btn btn-default<% if (selected(button.value)) { %> active<% } %><% if (button.disabled) { %> disabled<% } %>" title="<%= button.title %>">'+'<input name="<%= name %>" value="<%= button.value %>"<% if (selected(button.value)) { %> checked="checked"<% } %> type="radio"<% if (button.disabled) { %> disabled="disabled"<% } %>/>'+'<span><%= button.text %></span>'+'</label>'+'<% }); %>'+'</div>'+'</div>'),events:{'click .btn.disabled':'disable','change input':'change'},disable:function(event){event.stopPropagation();},selected:function(value){return _.isEqual(this.value(),value);}});var InputFilter=Filter.extend({template:_.template('<label><%= label %></label><br/>'+'<input name="<%= name %>" value="<%= value() %>" type="text" class="form-control" placeholder="<%= placeholder %>" title="<%= title %>" />'),initialize:function(options){Filter.prototype.initialize.call(this,options);this.delegate('change paste','input',_.debounce(_.bind(this.change,this),750));},render:function(){if(!this.$('input').is(':focus')){this.$el.html(this.template(this));}
return this;}});var ArtistFilter=InputFilter.extend({template:_.template('<label><%= label %></label>'+'<div class="dropdown">'+'<input name="<%= name %>" value="<%= value() %>" type="text" class="form-control" placeholder="<%= placeholder %>" title="<%= title %>" />'+'</div>'),initialize:function(options){Filter.prototype.initialize.call(this,options);this.delegate('change:suggest','input',_.debounce(_.bind(this.change,this),750));},render:function(){if(!this.$('input').is(':focus')){this.$el.html(this.template(this));this.$('input').suggest({url:'/suggest/artist/'});}
return this;}});var ColorFilter=InputFilter.extend({template:_.template('<label><%= label %></label>'+'<div class="input-group">'+'<input name="<%= name %>" value="<%= value() %>" type="text" class="form-control" placeholder="<%= placeholder %>" maxlength="7" />'+'<span class="input-group-append">'+'<span class="input-group-text">'+'<span class="cspicon icon-eyedropper"></span>'+'</span>'+'</span>'+'</div>'),colorpicker:null,initialize:function(options){InputFilter.prototype.initialize.call(this,options);this.delegate('changeColor','input',_.debounce(_.bind(this.change,this),750));},render:function(){if(!this.$('input').is(':focus')){this.$el.html(this.template(this));if(this.colorpicker){this.colorpicker.popupHandler.popoverTip.remove();this.colorpicker.destroy();}
this.colorpicker=this.$('div.input-group').colorpicker({customClass:'colorpicker-2x',useAlpha:false,format:'hex',sliders:{saturation:{maxLeft:200,maxTop:200},hue:{maxTop:200}}}).data('colorpicker');}
return this;}});var ContentFilter=ButtonGroupFilter.extend({render:function(){var buttons=[{title:gettext('Block nude content'),text:gettext('Moderate'),value:1},{title:gettext('Block all potentially offensive content'),text:gettext('Strict'),value:2}];if(csp.user.is_logged_in()){buttons.unshift({title:gettext('Show all results'),text:gettext('Off'),value:0});}else{buttons.unshift({text:gettext('Off'),disabled:true,value:0});}
this.$el.html(this.template($.extend({buttons:buttons,},this)));var register=jslink({viewname:'member:register:index'});this.$('.btn.disabled').popover({content:'You must be signed into an account to disable the content filter. <a href="'+register+'">Create Free Account</a>',container:'body',placement:'top',html:true,});return this;},parse:function(value){value[this.name]=parseInt(value[this.name]);this.model.trigger('reset:cache');return value;},disable:function(event){$(window).one('click',_.bind(function(){this.$(event.currentTarget).popover('hide');},this));this.$(event.currentTarget).popover('toggle');event.stopPropagation();}});var OrientationFilter=ButtonGroupFilter.extend({template:_.template('<label><%= label %></label>'+'<div class="input-group">'+'<div class="btn-group btn-group-toggle orientations" data-toggle="buttons">'+'<% _.each(buttons, function (button) { %>'+'<label class="btn btn-default<% if (selected(button.value)) { %> active<% } %>" title="<%= button.text %>">'+'<input type="checkbox" name="<%= name %>" value="<%= button.value %>"<% if (selected(button.value)) { %> checked="checked"<% } %> />'+'<span class="orient-<%= button.value.toLowerCase() %>"></span>'+'<span class="sr-only"><%= button.text %></span>'+'</label>'+'<% }); %>'+'</div>'+'</div>'),parse:function(value){if(_.isUndefined(value[this.name]))value[this.name]=[];if(!_.isArray(value[this.name]))value[this.name]=[value[this.name]];return value;},selected:function(value){return _.contains(this.value(),value);}});var SizeFilter=InputFilter.extend({template:_.template('<label><%= label %></label>'+'<div class="input-group">'+'<input name="width" value="<%= width %>" type="text" class="form-control" placeholder="<%= plh_width %>" />'+'<span class="input-group-append">'+'<span class="input-group-text border-right-0">&times;</span>'+'</span>'+'<input name="height" value="<%= height %>" type="text" class="form-control" placeholder="<%= plh_height %>" />'+'<div class="input-group-append">'+'<input name="mode" value="<%= mode %>" type="hidden" />'+'<button type="button" class="btn btn-default dropdown-toggle" data-toggle="dropdown">'+'<%= _.find(modes, function (row) {return (row.value === mode)}).label %>'+'&nbsp;<span class="caret"></span>'+'</button>'+'<ul class="dropdown-menu dropdown-menu-right">'+'<% _.each(modes, function (row) { %>'+'<% if (row.value !== mode) { %>'+'<li class="dropdown-item" data-value="<%= row.value %>">'+'<%= row.label %>'+'</li>'+'<% } %>'+'<% }); %>'+'</ul>'+'</div>'+'</div>'),events:{'click ul.dropdown-menu li':'click'},mode:'px',click:function(event){this.mode=this.$(event.currentTarget).data('value');this.$('input[name="mode"]').val(this.mode);this.change();this.render();},render:function(){var value=this.value();var html=this.template({plh_height:gettext('Height'),plh_width:gettext('Width'),label:this.label,height:value.height,width:value.width,mode:value.mode,modes:[{label:gettext('pixels'),value:'px'},{label:gettext('inches')+' @ 300 DPI',value:'in300'},{label:gettext('inches')+' @ 70 DPI',value:'in70'},{label:'cm @ 300 DPI',value:'cm300'},{label:'cm @ 70 DPI',value:'cm70'}]});this.$el.html(html);return this;},value:function(){var value=InputFilter.prototype.value.call(this),width=null,height=null,mode=this.mode;if(value){var initial=value.split('|'),output=initial[0].split('x');if(output[0])width=parseInt(output[0]);if(output[1])height=parseInt(output[1]);mode=initial[1];}
return{height:height,width:width,mode:mode};},parse:function(value){var search_size=null;if(value.width||value.height){search_size='{width:d}x{height:d}|{mode:s}'.format({height:value.height||'',width:value.width||'',mode:value.mode,});}
return{search_size:search_size};}});var PeopleFilter=Filter.extend({template:_.template('<label><%= label %></label>'+'<div class="people mb-2"></div>'+'<div class="d-flex">'+'<span class="btn btn-sm btn-default btn-add" title="<%= add_title %>">'+'<span class="cspicon icon-plus-circle"></span>'+'</span>'+'<div class="ml-auto people-exact d-none">'+'<div class="btn-group btn-group-sm btn-group-toggle" data-toggle="buttons">'+'<% var is_exact = (model.get("search_people_exact") === "1") %>'+'<label class="btn btn-default<% if (!is_exact) { %> active<% } %>">'+'<input name="people_exact" value=""<% if (!is_exact) { %> checked="checked"<% } %> type="radio" />'+'<span><%= min_text %></span>'+'</label>'+'<label class="btn btn-default<% if (is_exact) { %> active<% } %>">'+'<input name="people_exact" value="1"<% if (is_exact) { %> checked="checked"<% } %> type="radio" />'+'<span><%= max_text %></span>'+'</label>'+'</div>'+'</div>'+'</div>'),events:{'change input[name="people_exact"]':'update','click span.btn.btn-add':'add'},initialize:function(options){Filter.prototype.initialize.call(this,options);this.listenTo(this.model,'change:search_people_exact',this.render);this.collection=new csp.People();this.listenTo(this.collection,'update change',this.update);this.listenTo(this.collection,'add',this.append);},render:function(){this.$el.html(this.template({min_text:gettext('At least these People'),max_text:gettext('Only these People'),add_title:gettext('Add Person'),model:this.model,label:this.label}));this.collection.set(this.value(),{parse:true});return this;},update:function(){var search_people=this.collection.results();this.$('div.people-exact').toggleClass('d-none',search_people.length);var mode=this.$('input[name="people_exact"]:checked').val();this.model.set({search_people_exact:(search_people.length)?mode:'',search_people:search_people});},append:function(model){this.$('div.people').append(model.view.el);},add:function(){this.collection.add([null]);},change:function(){return null;}});var CopyspaceFilter=ButtonGroupFilter.extend({template:_.template('<label><%= label %></label>'+'<div class="input-group d-block">'+'<% _.each(_.range(0, 9, 3), function (row) { %>'+'<div class="btn-group btn-group-toggle d-block" data-toggle="buttons">'+'<% _.each(_.range(3), function (col) { %>'+'<% key = "ABCDEFGHI".charAt(row + col); %>'+'<label class="btn btn-default <% if (selected(key)) { %> active<% } %>" >'+'<input name="<%= name %>" value="<%= key %>"<% if (selected(key)) { %> checked="checked"<% } %> type="checkbox" />'+'<span>&nbsp;</span>'+'</label>'+'<% }); %>'+'</div>'+'<% }); %>'+'</div>'),parse:function(value){if(_.isUndefined(value[this.name]))value[this.name]=[];if(!_.isArray(value[this.name]))value[this.name]=[value[this.name]];return value;},selected:function(value){return _.contains(this.value(),value);}});csp.search_filters=function(model){return[new ButtonGroupFilter({model:model,name:'search_type',label:gettext('Content Type'),buttons:[{title:gettext('All Image Types'),text:gettext('All Images'),value:'ALL'},{title:gettext('Photos Only'),text:gettext('Photos'),value:'PHOTO'},{title:gettext('Illustrations Only'),text:gettext('Illustrations'),value:'ILLUST'},{title:gettext('Vectors Only'),text:gettext('Vectors'),value:'VECTOR'},{title:gettext('Video Only'),text:gettext('Video'),value:'VIDEO'}]}),new ButtonGroupFilter({model:model,name:'search_exact',label:gettext('Search Type'),buttons:[{title:gettext('Contains the keywords entered, in any order (more broad)'),text:gettext('Containing Words'),value:''},{title:gettext('Must match the exact search phrase entered (more specific)'),text:gettext('Exact Phrase'),value:'1'}]}),new ContentFilter({model:model,name:'content_filter',label:gettext('Content Filter'),}),new OrientationFilter({model:model,name:'search_orientation',label:gettext('Specific Orientation'),buttons:[{text:gettext('Vertical'),value:'V'},{text:gettext('Square'),value:'S'},{text:gettext('Horizontal'),value:'H'},{text:gettext('Panorama'),value:'P'}]}),new InputFilter({model:model,name:'search_exclude',label:gettext('Exclude From Results'),placeholder:gettext('Keywords'),title:gettext('Enter any keywords you would like to exclude.')}),new ArtistFilter({model:model,name:'search_artist',label:gettext('Search By Contributor'),placeholder:gettext('User Name'),title:gettext('Enter Contributor\'s User Name')}),new ColorFilter({model:model,name:'search_color',label:gettext('Primary Color'),placeholder:gettext('Hex Code')}),new SizeFilter({model:model,name:'search_size',label:gettext('Minimum Image Size')}),new PeopleFilter({model:model,name:'search_people',label:gettext('People Search'),}),new CopyspaceFilter({model:model,name:'search_copyspace',label:gettext('Empty Space'),})]};})(window.canstockphoto=window.canstockphoto||{});;;(function(csp,$){var RefineTag=function(data){this.data=data};_.extend(RefineTag.prototype,{text:function(key,value){var data=this.data[key];return _.isFunction(data)?data(value):data;},className:function(key){if(_.contains(['search_exclude','search_artist_exclude'],key)){return'badge badge-danger';}
return'badge badge-csp-blue';}});var refine=new RefineTag({search_exact:gettext('Exact Phrase'),search_orientation:function(value){var $span=$('<span/>').addClass('orientations');_.each(value,function(key){$span.append($('<span />').addClass('orient-'+key.toLowerCase()));});return interpolate(gettext('Orientation: %(orientations)s'),{orientations:$span.wrap('<div/>').parent().html()},true);},search_copyspace:function(value){var $span=$('<span/>').addClass('copyspace');_.each(_.range(0,9,3),function(row){var $row=$('<span/>').addClass('c-row');_.each(_.range(3),function(col){var key="ABCDEFGHI".charAt(row+col);var $col=$('<span />').toggleClass('active',_.contains(value,key));$row.append($col.addClass('c-cell'));});$span.append($row);});return gettext('Empty Space')+': '+$span.wrap('<div/>').parent().html();},search_people:function(value){return gettext('People Search');},search_exclude:function(value){return interpolate(gettext('Exclude: %(phrase)s'),{phrase:value},true);},search_artist:function(value){return interpolate(gettext('Artist: %(username)s'),{username:value},true);},search_artist_exclude:function(value){return interpolate(gettext('Artist: %(username)s'),{username:value},true);},search_color:function(value){return interpolate(gettext('Color: %(color)s'),{color:'<span class="color" style="background-color:'+value+';"></span>'},true);},search_size:function(value){var initial=value.split('|'),output=initial[0].split('x'),size='{width} &times; {height} {mode}'.format({height:output[1]?parseInt(output[1]):'&infin;',width:output[0]?parseInt(output[0]):'&infin;',mode:{px:'px',in300:'in @ 300 DPI',in70:'in @ 70 DPI',cm300:'cm @ 300 DPI',cm70:'cm @ 70 DPI',}[initial[1]]});return gettext('Minimum Image Size')+':'+size;}});var Tag=Backbone.View.extend({tagName:'span',className:'badge badge-csp-blue',events:{'click button.close':'close'},template:_.template('<%= text %> <button type="button" class="close">&times;</button>'),initialize:function(options){this.$el.addClass('refine-'+options.key);this.text=options.text;this.key=options.key;},close:function(){this.trigger('remove',this.key);this.remove();},render:function(){this.$el.html(this.template({text:this.text}));return this;}});var TagSet=Backbone.View.extend({tagName:'span',initialize:function(options){this.value=options.value;this.key=options.key;},remove:function(value,key){this.model.set(key,_.without(this.model.get(key),value))},render:function(){this.$el.empty();_.each(this.value,function(value){var view=new Tag({className:refine.className(this.key),text:refine.text(this.key,value),key:this.key});this.listenTo(view,'remove',_.bind(this.remove,this,value));this.$el.append(view.render().$el);},this);return this;}});csp.search_tags=function(key,value,model){if(key==='search_artist_exclude'){return new TagSet({value:value,model:model,key:key});}
return new Tag({className:refine.className(key),text:refine.text(key,value),key:key});};})(window.canstockphoto=window.canstockphoto||{},jQuery);;;(function(csp,$,undefined){csp.SearchRefineTagsView=Backbone.View.extend({events:{'click button':'removeAll'},initialize:function(options){this.listenTo(this.model,'change',_.bind(this.render,this));this.render();},removeTag:function(key){this.model.reset(key);},removeAll:function(){this.model.resetAll();},render:function(){this.$el.empty();this.model.tags(function(value,key){var tag=csp.search_tags(key,value,this.model);this.listenTo(tag,'remove',_.bind(this.removeTag,this));this.$el.append(tag.render().$el);},this);if(this.$el.children().length>1){this.$el.append('<button class="btn btn-sm btn-default" title="'+gettext('Reset all filters')+'">'+'<span class="cspicon icon-undo cspicon-lg"></span>'+'</button>');}}});csp.SearchRefineView=Backbone.View.extend({initialize:function(options){this.listenTo(this.model,'refine:toggle',_.bind(this.toggle,this));this.filters=csp.search_filters(this.model);this.collapse();this.render();},toggle:function(event){csp.search_data.set({'refine-open':!csp.search_data.get('refine-open'),'refine-hint':false});$(window).scrollTop(0);this.collapse();},collapse:function(){var open_state=csp.search_data.get('refine-open');$('[data-toggle="refine"]').toggleClass('active',open_state);this.$el.collapse(open_state?'show':'hide');},render:function(){_.each(this.filters,function(filter){this.$('> div').append(filter.render().el);},this);}});})(window.canstockphoto=window.canstockphoto||{},jQuery);;;(function(csp,$,undefined){$.fn.changeType=function(new_type){var attrs={};$.each(this[0].attributes,function(idx,attr){attrs[attr.nodeName]=attr.nodeValue;});this.replaceWith(function(){return $('<'+new_type+'/>',attrs).append($(this).contents());});};csp.SearchPaging=Backbone.Model.extend({page:function(tag){var url=this.get_url(tag);if(url)this.trigger('paging:search',url);},get_url:function(tag){var url=this.get(tag);return(url)?url:null;}});csp.SearchNavbarView=Backbone.View.extend({events:{'switchChange.bootstrapSwitch form.display-form input':'change','change input[name="search_mode"]':'change_mode','change form.display-form select':'change','click [data-toggle="refine"]':'toggle','click [data-page]':'page'},initialize:function(options){this.paging=options.paging;this.$('input[name="display_preview"]').bootstrapSwitch({offText:gettext('Off'),onText:gettext('On')});this.$('input[name="search_page"]').on('keyup',_.debounce(_.bind(this.keyup,this),500));this.listenTo(this.model,'results:load',this.load);this.$('div.refine-form span.btn').toggleClass('active',csp.search_data.get('refine-open'));this.listenTo(this.model,'refine:toggle',function(){this.$('div.refine-form span.btn').toggleClass('active',csp.search_data.get('refine-open'));});$(document).on('click','.next-results',_.bind(this.page,this));$(document).on('keyup',_.bind(this.arrow,this));if(csp.search_data.get('refine-hint')){this.listenTo(this.model,'results:load',_.bind(this.load_hint,this));this.$('div.refine-form:first span.btn').tooltip({title:gettext("That's a lot of results")+' &nbsp;'+gettext('Narrow them down here'),container:'div.refine-form:first span.btn',placement:'right',trigger:'manual',html:true});if(this.$('div.refine-form:first span.btn').hasClass('show-tooltip')){this.hint();}
csp.search_data.on('change:refine-hint',_.bind(function(){this.$('div.refine-form:first span.btn').tooltip('dispose');},this));}},toggle:function(event){this.model.trigger('refine:toggle');},load:function(data){if($('.next-results a').length>0){$('.next-results').html($('.next-results a').html());}
if(data.results.hits>10000){this.hint();}
this.$('.btn-prev').toggleClass('invisible',this.paging.get('prev')==null);this.$('.btn-next').toggleClass('invisible',this.paging.get('next')==null);this.$('.btn-prev').changeType(this.paging.get('prev_link')?'a':'button');this.$('.btn-next').changeType(this.paging.get('next_link')?'a':'button');var $rel_prev=$('link[rel="prev"]');if(this.paging.get('prev_link')){var prev_url=this.paging.get_url('prev');this.$('a.btn-prev').attr('href',prev_url);if(!$rel_prev.length){$('head').append($('<link/>',{rel:'prev',href:prev_url}));}else{$rel_prev.attr('href',prev_url);}}else{$rel_prev.remove();}
var $rel_next=$('link[rel="next"]');if(this.paging.get('next_link')){var next_url=this.paging.get_url('next');this.$('a.btn-next').attr('href',next_url);if(!$rel_next.length){$('head').append($('<link/>',{rel:'next',href:next_url}));}else{$rel_next.attr('href',next_url);}}else{$rel_next.remove();}},load_hint:function(data){if(data.results.hits>10000)this.hint();},show_hint_timeout:null,show_hint:function(){if(this.$('div.refine-form:first span.btn div.tooltip.in').length===0){this.$('div.refine-form:first span.btn').tooltip('show');}
if(this.hide_hint_timeout)clearTimeout(this.hide_hint_timeout);this.hide_hint_timeout=_.delay(_.bind(this.hide_hint,this),15000);},hide_hint_timeout:null,hide_hint:function(){this.$('div.refine-form:first span.btn').tooltip('hide');},hint:function(){if(this.show_hint_timeout)clearTimeout(this.show_hint_timeout);this.show_hint_timeout=_.delay(_.bind(this.show_hint,this),1000);},page:function(event){var direction=$(event.currentTarget).data('page');this.paging.page(direction);event.preventDefault();return false;},arrow:function(event){if(!$(event.target).is('input')){var page={37:'prev',39:'next'}[event.which];if(page)this.paging.page(page);}},keyup:function(event){var search_page=parseInt(this.$(event.currentTarget).val());search_page=_.isNaN(search_page)?1:search_page;this.model.set('search_page',search_page);event.preventDefault();return false;},change:function(event){var data=this.$(event.currentTarget).closest('form.display-form').serializeObject();data.display_preview=(data.display_preview==='on');data.display_sort=parseInt(data.display_sort);data.display_rows=parseInt(data.display_rows);csp.preferences.set(data);},change_mode:function(event){this.model.set('search_mode',this.$(event.currentTarget).val());}});})(window.canstockphoto=window.canstockphoto||{},jQuery);;;(function(csp,$,undefined){csp.DetailView=Backbone.View.extend({events:{'click button.btn-back-to-results':'back','click ul.list-keywords a':'search'},initialize:function(options){this.listenTo(this.model,'load:results',function(){this.$el.addClass('loading');});},search:function(event){var url=this.$(event.currentTarget).attr('href');this.trigger('search',url);this.model.top=0;return false;},back:function(event){window.history.back();},hide:function(){var detail_view=this.$('div.image-detail').data('detail');if(!_.isUndefined(detail_view))detail_view.remove();this.$('div.detail-results').empty();this.$el.hide();},load:function(data){this.model.set('search_page',0,{silent:true});this.model.trigger('detail:load',data);this.$el.removeClass('loading').show();this.$('div.detail-results').html(data.body);document.title=data.title;$(window).scrollTop(0);this.$('div.image-detail').detail(data.detail,false);}});})(window.canstockphoto=window.canstockphoto||{},jQuery);;;(function(csp,$,undefined){csp.RelatedSearchesView=Backbone.View.extend({template:_.template('<li class="list-inline-item" data-phrase="<%= phrase %>">'+'<span class="phrase"><%= phrase %></span>'+'<div class="images">'+'<% _.each(images, function (image) { %>'+'<span class="image">'+'<img<%= image.data %>>'+'</span>'+'<% }); %>'+'</div>'+'</li>'),events:{'click li[data-phrase]':'click'},initialize:function(options){this.photoreel=this.$el.photoreel().data('photoreel');this.render();},click:function(event){var phrase=this.$(event.currentTarget).data('phrase');this.model.set('search_phrase',phrase);},load:function(searches){this.$('ul').empty();var results=document.createDocumentFragment();_.each(searches,function(row){results.appendChild($(this.template(row)).get(0));},this);this.$('ul').html(results);this.render();},render:function(){this.$el.toggleClass('d-none',this.$('ul').is(':empty'));this.$('img').bannerhide({height:72});this.photoreel.update();}});})(window.canstockphoto=window.canstockphoto||{},jQuery);;;(function(csp,$){csp.SearchResult=Backbone.View.extend({tagName:'article',template:_.template('<a href="<%= url %>" class="thumb-preview thumb-favorites">'+'<span class="thumb-container">'+'<span class="thumb-mask"></span>'+'<img <%= data %>/>'+'</span>'+'<span class="title"><%= title %></span>'+'</a>'+'<span class="contributor"><%= contributor %></span>'+'<span class="details">'+'<span class="downloads"><%= downloads %></span>'+'<span>/</span>'+'<span class="views"><%= views %></span>'+'</span>'),initialize:function(options){this.result=options.result;},render:function(){this.result.contributor=interpolate(gettext('by %(username)s'),{username:'<em>'+this.result.username+'</em>'},true);this.$el.html(this.template(this.result));return this;}});csp.SearchResultsView=Backbone.View.extend({is_ajax_results:false,events:{'mouseenter a.thumb-preview':'mouseenter','mouseleave a.thumb-preview':'mouseleave','click a.thumb-preview':'click'},initialize:function(options){_.bindAll(this,'exclude');this.listenTo(csp.preferences,'change:display_mode',this.change);this.listenTo(this.model,'load:results',this.loading);this.$next=this.$('section.list-results article.next-results');this.$exclude=$('<div/>').addClass('exclude-artist').attr('title',gettext('Exclude results from this artist'));this.$('section.list-results').grid().trigger('grid:resize').detailed();this.jump=options.jump;},hide:function(){this.jump.hide();this.$el.hide();},loading:function(){this.$('section.list-results').addClass('loading');},clear:function(){this.$next.detach();this.$('section.list-results').empty();},change:function(model,value){this.$('section.list-results').attr('data-mode',value);this.$('section.list-results').data('mode',value);this.$('section.list-results').trigger('grid:resize');},load:function(data){this.is_ajax_results=true;this.$('section.list-results').removeClass('loading');this.model.trigger('results:load',data);this.jump.show();this.$el.show();this.$('h1').html(data['metadata'].heading);document.title=data['metadata'].title;this.$('input[name="search_phrase"]').val(data.params.search_phrase);this.$('span.pages').html(format_number(data['metadata']['pages']));this.$('input[name="search_page"]').val(data.params.search_page);if(data.results['docs'].length>0){var results=document.createDocumentFragment();_.each(data.results['docs'],function(doc){var search_result=new csp.SearchResult({result:doc});results.appendChild(search_result.render().el);});if(data.paging.next){results.appendChild(this.$next.show().get(0));}
this.$('section.list-results').html(results);this.$('section.list-results').trigger('grid:resize');$(window).scrollTop(this.model.top);}else{this.$next.detach();if(data.results['hits']===0){this.$('section.list-results').html('<article class="no-results">'+'<strong>'+gettext('No results found!')+'</strong>'+'<p>'+gettext('Please try another search')+'</p>'+'</article>');}else{this.$('section.list-results').html('<div class="more-results">'+'<strong>'+interpolate(gettext('There are %(pages)s more pages of results for %(phrase)s.'),{pages:data.results['pages']-data.params['search_page'],phrase:data.params['search_phrase'],},true)+'</strong>'+'<p>'+
gettext('To continue, please sign in.')+'<span>&nbsp;</span>'+'<a href="'+jslink({viewname:'member:auth:login'})+'">'+gettext('Sign In')+'</a>'+'<span>&nbsp;|&nbsp;</span>'+'<a href="'+jslink({viewname:'member:register:index'})+'">'+gettext('Create Free Account')+'</a>'+'</p>'+'</div>');}}
Backbone.trigger('results:loaded');},click:function(event){var url=this.$(event.currentTarget).attr('href');this.model.trigger('view:detail',url);return false;},mouseenter:function(event){var $elem=this.$(event.currentTarget);this.$exclude.on('click',this.exclude);this.$exclude.appendTo($elem);},mouseleave:function(){this.$exclude.off('click',this.exclude);this.$exclude.detach();},exclude:function(event){event.stopPropagation();event.preventDefault();var artist=this.$(event.currentTarget).closest('a').find('img[data-id]').data('artist');var search_artist_exclude=_.clone(this.model.get('search_artist_exclude'));search_artist_exclude.push(artist);this.model.set({'search_artist_exclude':search_artist_exclude,});}});})(window.canstockphoto=window.canstockphoto||{},jQuery);;;(function(csp,$,undefined){csp.SearchCache=function(options){this.options=_.extend({},this.defaults,options);this.reset();};_.extend(csp.SearchCache.prototype,{defaults:{size:10},reset:function(){this._cache_keys=[];this._cache={};},has:function(key){return _.contains(this._cache_keys,key);},get:function(key){return(this.has(key))?this._cache[key]:null;},set:function(key,val){if(!this.has(key)){this._cache_keys.push(key);this._cache[key]=val;if(this._cache_keys.length>this.options.size){delete this._cache[this._cache_keys.shift()];}}}});})(window.canstockphoto=window.canstockphoto||{},jQuery);;;(function(csp,$,globals){csp.search_data=new CookieData('search',{defaults:{'refine-hint':true,'refine-open':false}});csp.Search=function(options){this.params=new csp.SearchParams(options.params,{parse:true});this.paging=new csp.SearchPaging(options.paging);this.header=new csp.SearchHeaderView({el:$('form#header_search'),model:this.params});this.refine_tags=new csp.SearchRefineTagsView({el:$('div#refine_tags'),model:this.params});this.refine=new csp.SearchRefineView({el:$('div#refine_form'),model:this.params});this.navbar=new csp.SearchNavbarView({el:$('div.search-results nav.navbar'),paging:this.paging,model:this.params});this.results=new csp.SearchResultsView({jump:new csp.SearchJumpView({el:$('span#jump')}),el:$('div.search-view'),model:this.params});this.detail=new csp.DetailView({el:$('div.detail-view'),model:this.params});this.related=new csp.RelatedSearchesView({el:$('div.related-searches'),model:this.params});this.router=new csp.SearchRouter({model:this.params});this.listenTo(csp.preferences,'change:display_sort change:display_rows',this.resetSearch);this.listenTo(this.params,'reset:cache',this.resetCache);this.listenTo(this.paging,'paging:search',this.research);this.listenTo(this.params,'view:detail',this.viewDetail);this.listenTo(this.router,'route:search',this.research);this.listenTo(this.detail,'search',this.research);this.listenTo(this.params,'change',this.search);this.preload();Impressor.setup({url:'/impressor/',selector:'img',data:{sp:options.params.search_phrase,st:options.params.search_type}});$('section.list-results').on('grid:resized',Impressor.parse);};_.extend(csp.Search.prototype,Backbone.Events,{cache:new csp.SearchCache(),url:'/search.php',resetCache:function(){this.cache.reset();},resetSearch:function(){this.resetCache();this.params.set('search_page',1,{silent:true});this.search(null,{});},search:function(model,options){if(!options.loading){var prefs=_.pick(csp.preferences.toJSON(),'display_sort','display_rows'),data=_.extend(prefs,this.params.toDATA());if(this.xhr)this.xhr.abort();this.params.trigger('load:results');this.fetch(this.url,data,_.bind(this.load,this));}},research:function(url){url='/'+url.replace(/(^\/)/g,'');if(this.cache.has(url)){this.load(this.cache.get(url));}else{this.params.trigger('load:results');this.fetch(url,{},_.bind(this.load,this));}},fetch:function(url,data,callback){this.xhr=$.ajax({traditional:true,success:callback,data:data,url:url});},preload:function(){var url=this.paging.get_url('next');if(url&&!this.cache.has(url)){this.fetch(url,{},_.bind(function(data){this.cache.set(data.url,data);_.each(data.results.docs,function(doc){$('<img'+doc.data+' />');});},this));}},load:function(data){this.cache.set(data.url,data);var $meta_robots=$('meta[name="robots"]');if(data.meta_robots&&data.meta_robots.length){if(!$meta_robots.length){$('head').append($('<meta/>',{name:'robots',content:data.meta_robots.join(',')}));}else{$meta_robots.attr('content',data.meta_robots.join(','));}}else{$meta_robots.remove();}
if(data.type==='SEARCH'){Impressor.update({sp:data.params.search_phrase,st:data.params.search_type});this.router.navigate(data.url);this.params.set(this.params.parse(data.params),{loading:true,});this.params.trigger('search:load');this.related.load(data.related);this.paging.set(data.paging);this.results.load(data);this.detail.hide();this.preload();this.params.top=0;ga('send','pageview',data.analytics_id);if(data.matomo_search){_paq.push(_.flatten(['trackSiteSearch',data.matomo_search]));}}else if(data.type==='DETAIL'){this.params.top=$(window).scrollTop();this.router.navigate(data.url);this.detail.load(data);this.results.hide();Impressor.push('v',data.detail.image_id);ga('send','pageview','Comp');}
_paq.push(['setCustomUrl',data.matomo_url]);_paq.push(['trackPageView'])},viewDetail:function(url){if(this.cache.has(url)){this.load(this.cache.get(url));}else{this.params.trigger('load:results');this.fetch(url,{},_.bind(this.load,this));}}});globals.CspSearch=csp.Search;})(window.canstockphoto=window.canstockphoto||{},jQuery,this);;;(function(csp,$,undefined){csp.DownloadRequestModel=Backbone.Model.extend({xhr:null,defaults:{is_locked:false,is_ready:false,is_slow:false,attribution:'',downloads:[],address:'',send:false,url:null},is_polling:false,initialize:function(attributes,options){this.on('sync',_.bind(this.polling,this));},start_polling:function(){this.is_polling=true;this.fetch();},stop_polling:function(){this.is_polling=false;if(this.xhr)this.xhr.abort();},polling:function(model,resp,options){if(!this.get('is_locked')&&!this.get('is_ready')&&this.is_polling){_.delay(_.bind(this.fetch,this),1000);}},sync:function(method,model,options){if(this.xhr)this.xhr.abort();_.defaults(options||(options={}),{contentType:'application/json; charset=UTF-8',data:JSON.stringify(model),method:'POST',headers:{'X-CSRFToken':Cookies.get('csrftoken')},url:jslink({viewname:'download:api'})});this.xhr=$.ajax(options);return this.xhr;},email:function(address){$.ajax({url:jslink({viewname:'download:email'}),data:{hash:this.get('hash'),address:address}});},footer_text:function(){var text=gettext('Your download should start automatically, if it does not please click %(link_start)shere%(link_end)s.');return interpolate(text,{link_start:'<a class="text-bold" href="'+this.get('url')+'">',link_end:'</a>'},true);},support_text:function(){var text=gettext('Please contact %(link_start)ssupport%(link_end)s if this problem persists.');return interpolate(text,{link_start:'<a class="text-bold" href="/support.php?md12=true">',link_end:'</a>'},true);}});var EmailDownloadRequestView=Backbone.View.extend({tagName:'div',events:{'click span.btn':'submit'},template:_.template('<strong class="font-weight-bold"><%= title %></strong>'+'<% if (!send) { %>'+'<div class="input-group">'+'<input class="form-control" name="address" type="email" value="<%= address %>" placeholder="<%= placeholder %>" />'+'<span class="input-group-append">'+'<span class="btn btn-default">'+'<i class="cspicon icon-envelope"></i>'+'<span>'+'&nbsp;&nbsp;'+
gettext('Email me')+'</span>'+'</span>'+'</span>'+'</div>'+'<% } else { %>'+'<p class="text-success">'+
gettext('Sent! Please check your email in a couple minutes')+'</p>'+'<% } %>'),initialize:function(options){this.listenTo(this.model,'change:address change:send',this.render);this.render();},render:function(){var html=this.template({placeholder:gettext('Email Address'),address:this.model.get('address'),send:this.model.get('send'),title:ngettext('Email me this file','Email me these files',this.model.get('downloads').length)});this.$el.html(html);return this;},submit:function(){var address=this.$('input[name="address"]').val();this.model.set('send',true);this.model.email(address);}});csp.DownloadRequestView=Backbone.View.extend({tagName:'div',className:'download-modal modal',events:{'hidden.bs.modal':'hide',},template:_.template('<div class="modal-dialog modal-lg">'+'<div class="modal-content">'+'<div class="modal-header">'+'<h3 class="modal-title">'+gettext('Thank you for your download')+'</h3>'+'<button type="button" class="close" data-dismiss="modal">&times;</button>'+'</div>'+'<div class="modal-body">'+'<% if (request.get("is_locked")) { %>'+'<div class="alert alert-danger m-0 text-center">'+'<strong>'+
gettext('We are having trouble with your last request.')+'</strong>'+'<br/>'+'<%= request.support_text() %>'+'</div>'+'<% } else { %>'+'<ul class="list-inline text-center">'+'<% _.each(request.get("downloads"), function (download) { %>'+'<li class="list-inline-item img-thumbnail<% print(download.is_ready ? \'\' : \' loading\') %>">'+'<img src="<%= download.src %>" alt=""/>'+'</li>'+'<% }); %>'+'</ul>'+'<% if (!request.get("is_ready")) { %>'+'<h3 class="text-center">'+
gettext("We're creating your download.")+'<% if (request.get("is_slow")) { %>'+' '+gettext('It will start in a few minutes.')+'<% } %>'+'</h3>'+'<p class="text-center">'+
gettext("Don't want to wait?")+' '+
gettext("No problem, we can email you as soon as it's ready.")+'</p>'+'<% } else { %>'+'<%= request.get("attribution") %>'+'<% } %>'+'<% } %>'+'</div>'+'<% if (!request.get("is_locked")) { %>'+'<div class="modal-footer">'+'<% if (request.get("is_ready")) { %>'+'<div><%= request.footer_text() %></div>'+'<% } else { %>'+'<div>'+'<span class="text-bold">'+
gettext('Processing')+'...&nbsp;'+'</span>'+'<span class="cspicon cspicon-spin icon-refresh"></span>'+'</div>'+'<% } %>'+'</div>'+'<% } %>'+'</div>'+'</div>'),initialize:function(options){this.listenTo(this.model,'change',this.render);this.listenTo(this.model,'sync',this.sync);this.email_view=new EmailDownloadRequestView({model:this.model});},sync:function(model,resp,options){if(this.model.get('is_ready')&&!this.model.get('is_locked')){var url=this.model.get('url');download(url);}},render:function(){var html=this.template({request:this.model});this.$el.html(html);if(!this.model.get('is_locked')){this.$('div.modal-body').append(this.email_view.el);this.email_view.delegateEvents();}},show:function(){$('body').append(this.$el);this.model.start_polling();this.render();this.$el.modal();},hide:function(event){this.model.stop_polling();this.trigger('hide');this.$el.detach();}});var DownloadView=Backbone.View.extend({events:{'click':'click'},initialize:function(options){this.modal=new csp.DownloadRequestView({model:new csp.DownloadRequestModel({downloads:[options.data]})});},click:function(event){this.modal.show();}});$.fn.download=function(params){return this.each(function(){if(!$(this).data('dl')){var options=_.extend(params||{},{el:$(this)});options['data']=$(this).data('download');$(this).data('dl',new DownloadView(options));}});};var DownloadsView=Backbone.View.extend({events:{'change thead input[type="checkbox"]':'toggle','change tbody input[type="checkbox"]':'update','click button.btn-selected':'submit'},toggle:function(event){var checked=this.$(event.currentTarget).is(':checked');this.$('tbody input[type="checkbox"]').prop('checked',checked).trigger('change');},update:function(event){var not_checked=this.$('tbody input[type="checkbox"]:not(:checked)').length,checked=this.$('tbody input[type="checkbox"]:checked').length;this.$('thead input[type="checkbox"]').prop('checked',(not_checked===0));this.$('thead button').prop('disabled',(checked===0));},submit:function(event){event.preventDefault();var downloads=_.map(this.$('input[data-download]:checked'),function(elem){return $(elem).data('download');});(new csp.DownloadRequestView({model:new csp.DownloadRequestModel({downloads:downloads})})).show();}});$.fn.downloads=function(params){return this.each(function(){if(!$(this).data('dls')){var options=_.extend(params||{},{el:$(this)});$(this).data('dls',new DownloadsView(options));}});};var InfluentialView=Backbone.View.extend({events:{'change input[name="url"]':'change','keyup input[name="url"]':'change','input input[name="url"]':'change','click button.btn-refund':'refund','submit':'submit'},initialize:function(options){this.store();},store:function(){this.initial=this.$('input[name="url"]').val();},change:function(event){var disabled=(this.$('input[name="url"]').val()===this.initial);this.$('button.btn-save').prop('disabled',disabled);},submit:function(event){event.preventDefault();this.store();this.change();$.ajax({data:this.$('form').serialize(),url:jslink({viewname:'download:influential'})});},refund:function(event){if(confirm(gettext('Are you sure?'))){$.ajax({data:this.$('form').serialize(),url:jslink({viewname:'download:refund',}),success:function(data){if(!data.can_refund){$('button.btn-refund').prop('disabled',true);}}});$('tr[data-download_id="'+this.$el.data('download_id')+'"]').remove();}}});$.fn.influential=function(params){return this.each(function(){if(!$(this).data('influential')){var options=_.extend(params||{},{el:$(this)});$(this).data('influential',new InfluentialView(options));}});};})(window.canstockphoto=window.canstockphoto||{},jQuery);;;(function(csp,$,undefined){csp.DetailRouter=Backbone.Router.extend({initialize:function(){this.route(new RegExp('^(.+)$'),'all');this.on('route:all',_.bind(this.load,this));Backbone.history.start({hashChange:false,pushState:true,silent:true});},load:function(url){window.location.href='/'+url;}});})(window.canstockphoto=window.canstockphoto||{},jQuery);;;(function(csp,$,undefined){var FormView=Backbone.View.extend({events:{'change input[name="display_size"]':'display','show.bs.collapse tbody#addons':'toggle','change tbody input':'update','click tbody tr':'select','submit':'submit'},initialize:function(options){this.$('tr td span[data-modal]').on('click',AjaxModal.onClick);this.update();},toggle:function(event){this.$('[data-target="#addons"]').remove();},select:function(event){if(this.$(event.target).is('input'))return;var $input=this.$(event.currentTarget).find('input:not(:disabled)'),checked=$input.is(':radio')?true:!$input.is(':checked');$input.prop('checked',checked).trigger('change');event.stopPropagation();event.preventDefault();},display:function(event){var mode=this.$('input[name="display_size"]:checked').val();this.$('span.px,span.cm,span.in').hide();this.$('span.'+mode).show();},total:function(){var cash=0,credits=0;this.$('tbody tr input[data-cash]:checked').each(function(idx,elem){credits+=parseFloat($(elem).data('credits'));cash+=parseFloat($(elem).data('cash'));});return{cash:format_price(cash,{verbose:true}),credits:credits};},can_buy_with_subscription:function(){var subscription=csp.user.get('subscription'),data=this.$el.serializeObject();return(!_.has(data,'addons')&&subscription.remaining()>0&&subscription.is_valid(parseInt(data.product)));},can_buy_with_credits:function(){return csp.user.has_credits(this.total().credits);},update:function(){var total=this.total(),has_credits=csp.user.has_credits(1),can_credits_buy=this.can_buy_with_credits(),can_subscription_buy=this.can_buy_with_subscription(),amount=(has_credits)?total.credits:total.cash;this.$('span.purchase-total').toggleClass('danger',(has_credits&&!can_credits_buy));this.$('div.purchase-terms').toggle(can_credits_buy||can_subscription_buy);this.$('span.purchase-total').toggle(!can_subscription_buy);this.$('tbody tr.active').removeClass('active');this.$('tbody tr input:checked').closest('tr').addClass('active');var text=interpolate(gettext('Total: %(amount)s'),{amount:'<span>'+amount+'</span>'},true);this.$('span.purchase-total').html(text);},submit:function(event){if(!this.can_buy_with_subscription()&&!this.can_buy_with_credits()){this.$('button.btn-download').prop('disabled',true);return true;}
if(!this.$('input[name="accept"]').is(':checked')){toastr.error(gettext('You must agree to our license terms in order to download this file.'),gettext('Error'),{extendTimeOut:5000,timeOut:5000});}else{this.$('button.btn-download').prop('disabled',true);$.ajax({success:_.bind(this.success,this),data:this.$el.serializeObject(),url:location.href,traditional:true,method:'POST',});}
return false;},success:function(data){if(data.success){(new csp.DownloadRequestView({model:new csp.DownloadRequestModel({downloads:[data]})})).once('hide',function(){this.$('button.btn-download').prop('disabled',false);},this).show();}else{this.$('button.btn-download').prop('disabled',false);toastr.error(gettext('We are having trouble with your last request.'),gettext('Error'),{extendTimeOut:5000,timeOut:5000});}}});var Detail=Backbone.View.extend({initialize:function(options){this.options=options;this._resize=_.throttle(_.bind(this.resize,this),500);$(window).on('resize',this._resize);if(this.options.enable_router){new csp.DetailRouter();}
this.form=new FormView({el:this.$('form.purchase')});this.$('div.relatedreel img').bannerhide({applyHeightContainer:true,maxWidth:190,center:true,height:129});this.$('div.relatedreel').css('height',(129+(47+2))).photoreel({container:'div.relatedscroll'});if(this.options.zoom_sizes.length>0){this.$('div.zoom').zoom({message:gettext('Sorry, you have reached your zoom limit for this image. Thank you.'),sizes:this.options.zoom_sizes,id:this.options.image_id});}
this.$('label span[data-modal]').on('click',AjaxModal.onClick);this.$('li[title]').tooltip({container:'body'});this.resize();this.$('[data-download]').download();},resize:function(event){var width=$(window).width();$('div.image-purchase').appendTo((width<980)?'#purchase_mobile':'#purchase_full');this.$('div.preview').find('img[data-ratio]').bannerhide({maxWidth:Math.min((width-30),450),bannerVertical:false,height:450});},remove:function(){this.$('li[title]').tooltip('dispose');$(window).off('resize',this._resize);Backbone.View.prototype.remove.apply(this,arguments);}});$.fn.detail=function(options,enable_router){return this.each(function(){if(!$(this).data('detail')){var params=_.extend(options||{},{enable_router:enable_router,el:$(this)});$(this).data('detail',new Detail(params));}});};})(window.canstockphoto=window.canstockphoto||{},jQuery);;