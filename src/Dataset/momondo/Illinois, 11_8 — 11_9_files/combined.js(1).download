(new R9.logger).time("combined");(function(a,e){a.createWidgetClass("dropdown.StyleJamDropdownDialogTrigger",{options:{states:null,showFocusIndication:!1,useValueLabel:!1},isFocused:!1,isOpen:!1,cover:null,init:function(){this.options.useCover&&(this.cover=this.getChildElement("cover"))},addEventHandlers:function(){var d=this,c=this.options.states||{};this.element.on("focus",this.onFocus.bind(this));this.element.on("blur",this.onBlur.bind(this));this.options.showFocusIndication&&this.subscribe("body.accessibilityMode.enabled",function(b){b?
a.dom.swapClasses(d.element,"",c.focusModeHighlight):a.dom.swapClasses(d.element,c.focusModeHighlight,"")});this.subscribe("hotels.detailsv2.sticky.toggle",function(b){b?a.dom.swapClasses(this.element,this.options.styles.dropdownTrigger,this.options.styles.dropdownTriggerSticky):a.dom.swapClasses(this.element,this.options.styles.dropdownTriggerSticky,this.options.styles.dropdownTrigger)}.bind(this))},onFocus:function(){this.isFocused||(this.setView("focused"),this.isFocused=!0)},onBlur:function(a){if(a||
this.isFocused&&!this.isOpen)this.setView("blurred"),this.isFocused=!1},focus:function(){this.element.focus()},blur:function(){this.element.blur()},open:function(){this.isOpen=!0;this.element.attr("aria-pressed")&&this.element.attr("aria-pressed",!0);this.element.attr("aria-expanded",!0);this.setView("opened");this.onFocus()},close:function(){this.isOpen=!1;this.element.attr("aria-pressed")&&this.element.attr("aria-pressed",!1);this.element.attr("aria-expanded",!1);this.setView("closed");if(!this.element.is(":focus"))this.onBlur()},
setView:function(d){var c=this,b=this.options.states||{};a.dom.schedule(function(){switch(d){case "opened":a.dom.swapClasses(c.element,b.closed,b.opened);c.options.useCover&&(a.dom.swapClasses(c.cover,b.coverClosed,b.coverOpened),c.getChildElement("cover-inner").css("transform","scale("+(c.cover.outerWidth()+2)/c.element.outerWidth()+", 1.333)"));break;case "closed":a.dom.swapClasses(c.element,b.opened,b.closed);c.options.useCover&&(a.dom.swapClasses(c.cover,b.coverOpened,b.coverClosed),c.getChildElement("cover-inner").css("transform",
"scale(1)"));break;case "focused":a.dom.swapClasses(c.element,b.notFocused,b.focused);break;case "blurred":a.dom.swapClasses(c.element,b.focused,b.notFocused)}})},removeHasValue:function(){},addHasValue:function(){},hasValue:function(){return!0},enabled:e.noop,disable:e.noop,isVisible:function(){return this.element.is(":visible")},updateValueText:function(a){this.options.useValueLabel&&this.getChildElement("display-text").attr("aria-label",a)}})})(R9,jQuery);(function(b,c){b.createWidgetClass("button.StyleJamButton",{options:{inactiveStlBlock:"",activeStlBlock:"",canPulse:!1,showFocusOutlines:!1,activeCssClass:""},init:function(){},addEventHandlers:function(){this.options.inactiveStlBlock&&this.options.activeStlBlock&&(this.subscribe("button.deactivate",{id:this.id()},this.toggleActivation.bind(this,!1)),this.subscribe("button.activate",{id:this.id()},this.toggleActivation.bind(this,!0)));this.options.canPulse&&(this.subscribe("button.pulse",{id:this.id()},
this.pulse.bind(this,!0)),this.subscribe("button.pulse.reset",{id:this.id()},this.pulse.bind(this,!1)));this.options.showFocusOutlines&&(this.element.on("focus",this.toggleFocus.bind(this,!0)),this.element.on("blur",this.toggleFocus.bind(this,!1)))},toggleFocus:function(a){a&&!document.body.classList.contains(this.options.activeCssClass)||this.swapClassesToggle(this.element,"Button--with-focus-outline","Button--no-focus-outline",a)},toggleActivation:function(a){this.swapClassesToggle(this.element,
this.options.inactiveStlBlock,this.options.activeStlBlock,!a)},pulse:function(a){this.swapClassesToggle(this.element,"","Button--pulse",!a)}})})(R9,jQuery);(function(b){R9.extend("Widgets",{TextInput:function(a,c){this.elementNode=a;this.element=b(this.elementNode);this.validateElement()&&(this.options=b.extend({},this.options,c),this.init())}});R9.extend("Widgets.TextInput",{isTextInput:function(a){return a&&a.nodeName&&"input"==a.nodeName.toLowerCase()&&"text"==a.type.toLowerCase()},isWidgetControlled:function(a){return"undefined"==typeof document.createElement("input").placeholder}});R9.extend("Widgets.TextInput.prototype",{widgetName:"textinput",
widgetBaseClass:"r9-textinput",widgetPlaceholderClass:"r9-textinput-placeholder-active",elementNode:null,element:null,options:{click:null,change:null},init:function(){this.bindInputEvent("focus",this.handleElementFocusEvent);this.bindInputEvent("smartyfocus",this.handleElementFocusEvent);this.bindInputEvent("blur",this.handleElementBlurEvent);this.bindFormSubmission();this.element.data(this.widgetName,this);this.element.is(":focus")||this.handleElementBlurEvent(this.elementNode)},validateElement:function(){return R9.Widgets.TextInput.isTextInput(this.elementNode)&&
R9.Widgets.TextInput.isWidgetControlled(this.elementNode)&&void 0===this.element.data(this.widgetName)},bindInputEvent:function(a,b){var c=this;a+="."+this.widgetName;this.element.unbind(a).bind(a,function(a){b.call(c,this,a)})},bindFormSubmission:function(){var a=this,b="submit."+a.widgetName+a.element.attr("id"),d="form-pre-submit."+a.widgetName+a.element.attr("id");this.element.parents("form").off(b).on(b,function(b){a.element.val()==a.element.attr("placeholder")&&a.clearPlaceholderText(a.element)});
this.element.parents("form").off(d).on(d,function(b){a.element.val()==a.element.attr("placeholder")&&a.clearPlaceholderText(a.element)})},handleElementFocusEvent:function(a,c){a.disabled||(b(a).val()==b(a).attr("placeholder")&&this.clearPlaceholderText(b(a)),this.options.focus&&this.options.focus.apply(this,arguments))},handleElementBlurEvent:function(a,c){a.disabled||(0==b.trim(b(a).val()).length&&this.setPlaceholderText(a),this.options.blur&&this.options.blur.apply(this,arguments))},clearPlaceholderText:function(a){a.removeClass(this.widgetPlaceholderClass).val("")},
setPlaceholderText:function(a){b(a).addClass(this.widgetPlaceholderClass).val(b(a).attr("placeholder"))}})})(jq||jQuery);
(function(b){R9.createWidgetClass("text.StyleJamTextInput",b.extend({},R9.Widgets.TextInput.prototype,{widgetPlaceholderClass:"vs-placeholder",inputElement:null,inputState:null,options:{needsPlaceholderSupport:!1,selectOnFocus:!1,inputValidationEnabled:!1,presentationStates:{}},init:function(){this.inputElement=this.inputElement||this.element;this.elementNode=this.inputElement.get(0);this.options.inputValidationEnabled&&(this.inputState=this.getChildElement("inputState"),this.inputError=this.getChildElement("inputError"),
this.inputSuccess=this.getChildElement("inputSuccess"))},addEventHandlers:function(){var a=this;(this.options.needsPlaceholderSupport||this.options.presentationStates)&&this.bindInputEvent("focus",this.handleElementFocusEvent);this.options.needsPlaceholderSupport&&(this.element.is(":focus")||this.handleElementBlurEvent(this.elementNode),this.bindInputEvent("smartyfocus",this.handleElementFocusEvent),this.bindInputEvent("blur",this.handleElementBlurEvent));if(this.options.selectOnFocus)a.inputElement.on("focus",
function(){a.inputElement.on("mouseup.a keyup.a",function(b){a.elementNode.setSelectionRange(0,9999);a.inputElement.off("mouseup.a keyup.a").select()})});this.options.inputValidationEnabled&&null!==this.inputState&&this.subscribe("input.validation",a.handleValidation.bind(this));this.options.presentationStates&&this.styleInvalidState()},getValue:function(){return b(this.inputElement).val()},handleElementFocusEvent:function(a,b){this.options.presentationStates&&this.styleInvalidState(!1);R9.Widgets.TextInput.prototype.handleElementFocusEvent.call(this,
a,b)},styleInvalidState:function(a){a?R9.dom.swapClasses(b(this.elementNode),this.options.presentationStates.regular,this.options.presentationStates.invalid):R9.dom.swapClasses(b(this.elementNode),this.options.presentationStates.invalid,this.options.presentationStates.regular)},handleValidation:function(a){a&&a.state&&a.inputEl===this.element.id()&&("error"===a.state&&this.swapClasses(this.inputError,"TextInput__State--hidden","TextInput__State--visible"),"success"===a.state&&this.swapClasses(this.inputSuccess,
"TextInput__State--hidden","TextInput__State--visible"))}}))})(jq||jQuery);(function(c){R9.extend("Widgets",{NumberBox:function(b,a){this.inputNode=c(b).find("input")[0];this.jqNode=c(b);if(!this.isValidElement())return this;this.options=c.extend({},this.options,a);this.init()}});R9.extend("Widgets.NumberBox.prototype",{widgetName:"r9NumberBox",inputNode:null,jqNode:null,options:{min:0,max:6,defaultValue:0,callback:c.noop,validator:null,onlyDecorateDisabledButtons:!1},boxValue:0,incrButton:null,decrButton:null,styleJamButton:null,isValidElement:function(){return this.jqNode&&
this.jqNode.children().hasClass("incrementor")&&this.jqNode.children().hasClass("decrementor")&&this.jqNode.children().hasClass("numberHolder")},canChange:function(b){return"function"===typeof this.options.validator?this.options.validator.call(this,b,this.boxValue):!0},getStyleJamButton:function(){return R9.stylejam&&R9.stylejam.common&&R9.stylejam.common.widgets&&R9.stylejam.common.widgets.button?R9.stylejam.common.widgets.button.StyleJamButton:null},increment:function(){if(this.boxValue<this.options.max&&
this.canChange(1))return this.boxValue+=1,this.updateView(),this.options.callback.call(this,1,this.boxValue),!0;this.disableButton(this.incrButton);return!1},decrement:function(){if(this.boxValue>this.options.min&&this.canChange(-1))return--this.boxValue,this.updateView(),this.options.callback.call(this,-1,this.boxValue),!0;this.disableButton(this.decrButton);return!1},updateView:function(){c(this.inputNode).val(this.boxValue);c(this.inputNode).trigger("change");c(this.jqNode).attr("aria-valuenow",
this.boxValue);c(this.jqNode).attr("aria-valuemin",this.options.min).attr("aria-valuemax",this.options.max);this.boxValue===this.options.max?(this.enableButton(this.decrButton),this.disableButton(this.incrButton)):(this.boxValue===this.options.min?this.disableButton(this.decrButton):this.enableButton(this.decrButton),this.enableButton(this.incrButton));this.ariaLabel&&this.ariaLabel.length&&this.ariaLabelMessage&&this.updateAriaLabel()},updateAriaLabel:function(){this.ariaLabelUpdateId&&(window.clearTimeout(this.ariaLabelUpdateId),
this.ariaLabelUpdateId=null);this.ariaLabelUpdateId=window.setTimeout(function(){var b;b=-1<this.ariaLabelMessage.indexOf("|")?R9.Common.Utils.String.formatChoice(this.ariaLabelMessage,this.boxValue,this.boxValue):R9.Common.Utils.String.formatString(this.ariaLabelMessage,this.boxValue);this.ariaLabel.html(b)}.bind(this),200)},getValue:function(){return this.boxValue},setValue:function(b,a){b=parseInt(b);if(isNaN(b)||this.boxValue===b)return!1;var c=b-this.boxValue;if(!a&&!this.canChange(c))return!1;
this.boxValue=b;this.updateView();this.options.callback&&this.options.callback.call(this,c);return!0},init:function(){this.styleJamButton=this.getStyleJamButton();this.boxValue=""!=this.inputNode.value?parseInt(this.inputNode.value,10):0;this.incrButton=this.jqNode.find(".incrementor");this.decrButton=this.jqNode.find(".decrementor");this.jqNode.data(this.widgetName,this);0<this.options.defaultValue?this.setValue(this.options.defaultValue):!isNaN(this.options.max)&&this.boxValue>this.options.max&&
(this.boxValue=this.options.max);c(this.inputNode).prop("readonly","readonly");this.inputNode.value=this.boxValue;var b=this;this.incrButton.unbind("click").click(function(a){b.increment();jq(b.jqNode).trigger("increment");return!1});this.decrButton.unbind("click").click(function(a){b.decrement();jq(b.jqNode).trigger("decrement");return!1});this.updateView()},enableButton:function(b){b.removeClass("NumberBox-disabled").prop("disabled",!1).attr("aria-disabled","false");this.styleJamButton&&R9.dom.swapClasses(b,
this.styleJamButton.plusMinusButtonDisabled,this.styleJamButton.plusMinusButtonEnabled)},disableButton:function(b){b.addClass("NumberBox-disabled");this.options.onlyDecorateDisabledButtons||b.prop("disabled",!0).attr("aria-disabled","true");this.styleJamButton&&R9.dom.swapClasses(b,this.styleJamButton.plusMinusButtonEnabled,this.styleJamButton.plusMinusButtonDisabled)},disableDecrement:function(){this.disableButton(this.decrButton)},enableDecrement:function(){this.enableButton(this.decrButton)},disableIncrement:function(){this.disableButton(this.incrButton)},
enableIncrement:function(){this.enableButton(this.incrButton)}})})(jq||jQuery);
(function(c,b){c.createWidgetClass("number.StyleJamNumberBox",b.extend({},c.Widgets.NumberBox.prototype,{init:function(a,c){this.styleJamButton=this.getStyleJamButton();this.inputNode=b(a).find("input")[0];this.jqNode=b(a);this.styleJamButton&&this.jqNode.data("presentation")&&(a=this.jqNode.data("presentation"),this.styleJamButton.hasOwnProperty(a)&&(this.styleJamButton=this.styleJamButton[a]));if(!this.isValidElement())return this;this.inputNode&&(this.boxValue=""!==this.inputNode.value?parseInt(this.inputNode.value,
10):0);this.incrButton=this.jqNode.find(".incrementor-js");this.decrButton=this.jqNode.find(".decrementor-js");this.ariaLabel=this.getChildElement("ariaLabel");this.ariaLabelMessage=this.ariaLabel.data("msg");this.ariaLabel.attr("data-msg",null);0<this.options.defaultValue&&0===this.boxValue&&this.setValue(this.options.defaultValue,!0);this.options.withConstant&&(this.options=b.extend({withConstant:!1,descriptionWords:[]},this.options,c),this.index=0,this.countWord=this.jqNode.find(".count-word-js"),
this.options.min=0,this.options.max=this.options.descriptionWords.length-1,this.updateConstantValue(0));b(this.inputNode).prop("readonly","readonly");this.updateView()},isValidElement:function(){return!0},canChange:function(a){return"function"===typeof this.options.validator?this.options.validator.call(this,a,this.boxValue):!0},addEventHandlers:function(a){var d=this;this.incrButton.unbind("click").click(function(a){d.options.withConstant?(d.updateConstantValue(1),d.options.callback.call(d)):d.increment();
jq(d.jqNode).trigger("increment");c.globals.keyboardNav||b(this).blur();return!1});this.decrButton.unbind("click").click(function(a){d.options.withConstant?(d.updateConstantValue(-1),d.options.callback.call(d)):d.decrement();jq(d.jqNode).trigger("decrement");c.globals.keyboardNav||b(this).blur();return!1});this.element.keyup(function(a){if(a.altKey||a.ctrlKey||a.shiftKey)return!0;switch(a.keyCode){case c.globals.keyCodes.DOWN:case c.globals.keyCodes.LEFT:case c.globals.keyCodes.PAGE_DOWN:return d.decrement(),
jq(d.jqNode).trigger("decrement"),a.preventDefault(),a.stopPropagation(),!1;case c.globals.keyCodes.UP:case c.globals.keyCodes.RIGHT:case c.globals.keyCodes.PAGE_UP:return d.increment(),jq(d.jqNode).trigger("increment"),a.preventDefault(),a.stopPropagation(),!1}});this.element.on("keydown",function(a){if(a.altKey||a.ctrlKey||a.shiftKey)return!0;switch(a.keyCode){case c.globals.keyCodes.PAGE_UP:case c.globals.keyCodes.PAGE_DOWN:case c.globals.keyCodes.HOME:case c.globals.keyCodes.END:case c.globals.keyCodes.LEFT:case c.globals.keyCodes.UP:case c.globals.keyCodes.RIGHT:case c.globals.keyCodes.DOWN:return a.preventDefault(),
a.stopPropagation(),!1}});this.options.showFocusOutlines&&(this.element.on("focus",this.toggleFocus.bind(this,!0)),this.element.on("blur",this.toggleFocus.bind(this,!1)))},toggleFocus:function(a){a&&!document.body.classList.contains(this.options.activeCssClass)||this.swapClassesToggle(this.element,"TravelerDropdown__NumberBox","TravelerDropdown__NumberBox--focus",a)},setValue:function(a,b){a=parseInt(a);if(isNaN(a)||this.boxValue===a)return!1;var c=this.boxValue>a?0===a?a:this.boxValue-a:a-this.boxValue;
if(b||this.canChange(c))this.boxValue=a,this.updateView(),this.options.callback&&!b&&this.options.callback.call(this,c)},getIndex:function(){return this.index},setIndex:function(a,b){a=parseInt(a);if(isNaN(a)||this.index===a)return!1;a-=this.index;b&&(this.updateConstantValue(a),this.options.callback&&!b&&this.options.callback.call(this,a))},updateConstantValue:function(a){a=this.index+a;0<=a&&a<this.options.descriptionWords.length&&(this.index=a,this.countWord.text(this.options.descriptionWords[this.index]));
this.index===this.options.max?(this.enableButton(this.decrButton),this.disableButton(this.incrButton)):(this.index===this.options.min?this.disableButton(this.decrButton):this.enableButton(this.decrButton),this.enableButton(this.incrButton))}}))})(window.R9,window.jQuery);(function(b,d){b.createComponentClass("framework.JavaScriptComponent",{options:{vertical:null,global:!1},addEventHandlers:function(){var a=this;this.subscribe("resultspage.JavaScriptComponent.cleanup",function(c){a.options.vertical===c||a.options.global?a.options.vertical=c:a.options.singleton?b.ComponentManager.removeSingleton(a._namespace):a.destroy()})}})})(R9,jQuery);(function(d){d.createComponentClass("hotels.search.HotelPlannerHelper","framework.JavaScriptComponent",{addEventHandlers:function(){var b=this;this.base();this.subscribe("hotelplanner.open",function(c){c&&b.open(c.location,c.startDate,c.endDate)})},open:function(b,c,e){b="/k/redirect/out?url\x3d"+encodeURIComponent(this.buildHotelPlannerMaxRoomsURL(b,c,e));d.Common.Utils.Browsers.isIE(11)||d.Common.Utils.Browsers.isEdge()?window.open("","title").location.href=b:open(b)},buildHotelPlannerMaxRoomsURL:function(b,
c,e){var f="www",g="",a=d.globals&&d.globals.locale?d.globals.locale:null;a&&a.lc&&"string"===typeof a.lc&&"en"!==a.lc.toLowerCase()&&(f=a.lc.toLowerCase());a&&a.loc&&"string"===typeof a.loc&&(g=a.loc);return"https://"+f+".hotelplanner.com/GroupForm.cfm?sc\x3dKayak\x26City\x3d"+encodeURIComponent(b)+"\x26InDate\x3d"+encodeURIComponent(c)+"\x26OutDate\x3d"+encodeURIComponent(e)+"\x26locale\x3d"+g}})})(window.R9);(function(f,e){f.createWidgetClass("dropdown.StyleJamDropdownDialog",{element:null,trigger:null,rtlAlignment:void 0,triggerObj:void 0,elementNode:null,content:null,label:null,value:null,icon:null,isOpen:!1,leftOffset:0,ajaxLoadFailed:!1,eventSuffix:null,subValue:null,animationDuration:200,interactedWithRecently:!1,options:{autoOpen:!1,alignment:null,direction:"down",isPopover:!1,showIcon:!0,matchWidth:!1,isFixedWidth:!1,loadWithAjaxOnInit:!1,ajaxUrl:"",ajaxData:{},iconClass:"",contentClass:"",triggerElemId:null,
content:null,onInit:null,onOpen:null,onClose:null,text:"",coverTrigger:!1,topOffset:0,topOffsetFromTrigger:0,leftOffset:0,removeZIndex:!1,flippable:!0,delayShowDropdown:e.noop,showDropdownDelay:200,hasSubValue:!1,animateClose:null,expandTo:null,forceTriggerWidth:!1,openDisabled:!1,staticPosition:!1,subtractContainerOffset:!1},states:null,init:function(){!this.options.alignment&&this.element&&this.element.data("alignment")&&(this.options.alignment=this.element.data("alignment"));!this.options.expandTo&&
this.element&&this.element.data("expandto")&&(this.options.expandTo=this.element.data("expandto"));this.options.alignment||(this.options.alignment="left");this.eventSuffix=".DropdownDialog."+this.id();this.options.autoOpen?this.open():this.element.addClass(this.options.closedStateClzs);this.options.coverTrigger&&(this.cover=this.getChildElement("cover"),this.innerContent=this.getChildElement("inner"));if(this.options.onInit)this.options.onInit(this);this.options.target?this.trigger=this.options.target:
this.createTrigger();f.globals.testMode&&this.trigger.attr("data-test-popover-trigger","");this.elementNode=this.element[0];this.createContent();this.popoverArrow=this.getChildElement("popover-arrow");this.options.loadWithAjaxOnInit&&this.options.ajaxUrl&&this.loadAjax();this.options.alignment||(this.options.alignment="left");if(this.options.coverTrigger)this.trigger.one("mouseover",this.reposition.bind(this))},addEventHandlers:function(){function a(a){if(b.isOpen){a=e(a.target);var c=b.content.add(b.trigger);
a.closest(c).length||b.close()}}var b=this,c=e("body"),d=this.trigger;c.on("click"+this.eventSuffix,a);c.on("touchstart"+this.eventSuffix,a);this.subscribe("trips.menu.open",e.proxy(this.close,this));this.subscribe("authentication.showLogin",this.close.bind(this,null,!0));this.registerEvent("click",d,function(){b.toggleContent()});this.registerEvent("keydown",d,function(d){if(13===d.which||32===d.which)b.toggleContent(),setTimeout(function(){c.on("click",a)},10),d.preventDefault(),d.stopImmediatePropagation(),
d.stopPropagation()});this.registerEvent("keydown"+this.eventSuffix,e(document),function(a){27===a.which&&b.close(a,null,!0)});this.registerEvent("resize"+this.eventSuffix,e(window),function(){b.isOpen&&b.reposition(!0)});this.registerEvent("scroll"+this.eventSuffix,e(document),function(){b.isOpen&&b.reposition(!0)});this.registerEvent("scroll"+this.eventSuffix,e(".viewport"),function(){b.isOpen&&b.reposition(!0)});var l=null,d=function(){b.triggerObj&&!b.triggerObj.isVisible()||l||f.Common.Utils.Browsers.isIE(11)||
(l=setTimeout(function(){b.reposition(!0);l=null},25))};this.registerEvent("click",this.content.find(".close"),this.close.bind(this));this.subscribe("common.dropdown.closeAll",this.close.bind(this));this.registerEvent("mouseup touchend",this.content,d);this.subscribe("horizon.dropdownDialog.reposition",d)},destroy:function(){this.base();this.trigger.off("mouseover");e(".viewport").off("scroll"+this.eventSuffix);e(window).off("resize"+this.eventSuffix);e(document).off("scroll"+this.eventSuffix).off("keydown"+
this.eventSuffix);e(document.body).off("click"+this.eventSuffix).off("touchstart"+this.eventSuffix);this.content.off("keydown")},createContent:function(){this.content=this.options.content&&this.options.content.length?e(this.options.content):e("#"+this.element.attr("id")+"_content");this.options.isFixedWidth&&this.content.css("width",this.getTriggerWidth()+"px")},createTrigger:function(){if(null!=this.options.triggerElemId)this.trigger=e("#"+this.options.triggerElemId);else{var a=this.element.data("trigger-id");
null!=a&&""!==a&&(this.trigger=e("#"+a))}null!=this.trigger&&this.trigger.length?this.triggerObj=this.trigger.getWidget():this.trigger=this.element;this.label=this.trigger.find(".js-label");this.options.showIcon&&(this.icon=this.trigger.find(".js-icon"));this.options.hasSubValue&&(this.subValue=this.label.find(".js-subValue"));if(this.options.text)this[this.options.hasSubValue?"updateValue":"updateLabel"](this.options.text);else this.options.hasSubValue||(a=this.label.html())&&a.trim()&&this.updateLabel(a.trim())},
open:function(){if(!this.options.openDisabled){this.isOpen=!0;var a=this,b=f.config.getString("ui.horizon.output.container","body");if("function"===typeof this.options.delayShowDropdown&&this.options.delayShowDropdown()&&!this.showDropdownTimeout)this.showDropdownTimeout=setTimeout(this.open.bind(this),this.options.showDropdownDelay);else{null!==this.showDropdownTimeout&&(clearTimeout(this.showDropdownTimeout),this.showDropdownTimeout=null);this.options.container&&""!==this.options.container&&(b=
this.options.container,e(a.options.container).off("scroll."+a.id()).on("scroll."+a.id(),function(){a.isOpen&&a.reposition()}));this.options.isPopover&&this.popoverArrow.show();this.content.appendTo(b);if(this.options.onOpen)this.options.onOpen(this);a.triggerObj&&a.triggerObj.open();this.reposition();f.dom.swapClasses(a.content,this.getStateClasses("closed"),this.getStateClasses("open"));this.options.coverTrigger&&(this.content.removeClass("closed").addClass("open"),f.dom.swapClasses(this.cover,this.getStateClasses("coverClosed"),
this.getStateClasses("coverOpened")),f.dom.swapClasses(this.innerContent,this.getStateClasses("contentClosed"),this.getStateClasses("contentOpened")));this.content.attr("aria-expanded",!0);f.globals.testMode&&this.element.add(this.content).attr("data-test-popover-open",!0);f.events.publish("DropdownDialog.open",{id:a.id()});window.setTimeout(this.setupTabKeyHandling.bind(this),1)}}},setupTabKeyHandling:function(){var a=this,b=this.getFocusableElements();b.length&&(b.first().focus(),this.content.off("keydown").on("keydown",
function(b){var d=a.getFocusableElements(),c=e(b.target),h=d.first().is(c)&&b.shiftKey,c=d.last().is(c)&&!b.shiftKey;b.which===f.globals.keyCodes.TAB&&(1===d.length||h||c)&&a.close(b,!1,!0)}))},getFocusableElements:function(){return this.content.find(":input:visible,[tabindex]:visible").not("[tabindex\x3d-1],[disabled]")},_close:function(a,b,c){var d=this.isOpen,e=this;this.isOpen=!1;this.options.isPopover&&this.popoverArrow.hide();this.triggerObj&&this.triggerObj.close();f.dom.swapClasses(this.content,
this.getStateClasses("open"),this.getStateClasses("closed"));this.options.coverTrigger&&(this.content.removeClass("open").addClass("closed"),f.dom.swapClasses(this.cover,this.getStateClasses("coverOpened"),this.getStateClasses("coverClosed")),f.dom.swapClasses(this.innerContent,this.getStateClasses("contentOpened"),this.getStateClasses("contentClosed")));this.content.css({top:"",right:"",left:"",bottom:""});this.options.coverTrigger?setTimeout(function(){e.element.append(e.content)},200):this.element.append(this.content);
this.content.off("keydown");c&&e.triggerObj&&e.triggerObj.focus();if(this.options.onClose)this.options.onClose(d,this,a);f.events.publish("DropdownDialog.close",{id:this.id(),silent:!!b});this.content.attr("aria-expanded",!1);f.globals.testMode&&this.element.add(this.content).attr("data-test-popover-open",!1)},close:function(a,b,c){if(this.options.animateClose){var d=this;this.animateClose(function(){d._close(a,b,c)})}else this.isOpen&&this._close(a,b,c)},toggleContent:function(){this.isOpen?this.close(null,
null,!0):this.open()},updateLabel:function(a,b,c){var d=a;b&&(d+=(c||"")+b);this.label.html(d);"0"===d+""||d?this.triggerObj&&this.triggerObj.addHasValue():this.triggerObj&&this.triggerObj.removeHasValue();this.triggerObj&&a&&this.triggerObj.updateValueText(a)},updateValue:function(a){var b=a||"";this.value.html(a);"0"===b+""||a?this.triggerObj&&this.triggerObj.addHasValue():this.triggerObj&&this.triggerObj.removeHasValue()},hasValue:function(){return this.triggerObj?this.triggerObj.hasValue():!1},
reposition:function(a){if(this.options.staticPosition)this.content.css(this.options.staticPosition);else{this.rtlAlignment="rtl"!==document.dir||"left"!==this.options.alignment&&"right"!==this.options.alignment?void 0:"right"===this.options.alignment?"left":"right";var b=this.options.direction,c=this.rtlAlignment||this.options.alignment,d=this.trigger.offset(),l=e(this.options.container),h=e(this.options.expandTo),m=h.length&&h.is(":visible"),g=e(window).outerWidth(),n=m?h.offset():null;if(l.length)var k=
l.offset(),d={top:d.top-k.top+l.scrollTop(),left:d.left-k.left};else l=e(window);k=d.top+this.trigger.outerHeight();k+=this.options.topOffsetFromTrigger;0===this.trigger.width()&&0!==this.trigger.position().top&&(k+=window.scrollY);if(this.options.coverTrigger)m=0,h=e(this.options.container),this.options.subtractContainerOffset&&h.length&&(m=h.offset().left),h=this.content.outerWidth(),c=this.trigger.offset().left,m="rtl"===document.dir?-1*Math.floor(window.innerWidth-(c+this.getTriggerWidth())-m):
Math.floor(this.trigger.offset().left-m),k=Math.floor(k)-this.trigger.outerHeight(),c=m+"px",m+h>g&&(h=g-h-10,c=(0<h?h:0)+"px"),this.options.newSearchHeaderDesign&&568>g&&(c=0),this.content.css({transform:"translate("+c+","+(k+"px")+")",top:0,right:"inherit !important"}),this.cover.css({width:this.trigger.outerWidth()-16,height:this.trigger.outerHeight()-16});else{this.shouldFlipDirection(b)&&(b=this.getReversedDirection(b));this.shouldFlipAlignment(c)&&(c=this.getReversedDirection(c));this.updateAnimationClass(b,
c);this.content.toggleClass("noAnimation",!!a);"up"===b?(f.dom.swapClasses(this.content,this.getStateClasses("default"),this.getStateClasses("up")),k=d.top-this.content.outerHeight()):f.dom.swapClasses(this.content,this.getStateClasses("up"),this.getStateClasses("default"));if("left"===b||"right"===b)k="up"===this.options.alignment?d.top-this.trigger.outerHeight()/2:"down"===this.options.alignment?d.top-this.content.outerHeight()+this.trigger.outerHeight():d.top+this.trigger.outerHeight()/2-this.content.outerHeight()/
2;g={top:Math.floor(k)+"px"};m?"right"===c?g.right=Math.floor(l.width()-h.width()-n.left)+"px":g.left=Math.floor(n.left)+"px":"left"===b?g.right=Math.floor(l.width()-d.left)+"px":"right"===b?g.left=Math.floor(d.left+this.trigger.width())+"px":"right"===c?(b=this.getTriggerWidth(),38>b&&!this.options.forceTriggerWidth&&(b=38),g.right=Math.floor(l.width()-(d.left+b))+"px"):g.left="center"===c?Math.floor(d.left-this.content.outerWidth()/2)+this.getTriggerWidth()/2+"px":Math.floor(d.left)+"px";this.options.topOffset&&
0!==this.options.topOffset&&(g.marginTop=this.options.topOffset+"px");this.options.leftOffset&&0!==this.options.leftOffset&&(g.right?g.right=parseInt(g.right.replace("px",""),10)-this.options.leftOffset+"px":g.left&&(g.left=parseInt(g.left.replace("px",""),10)+this.options.leftOffset+"px"));this.leftOffset&&(g.marginLeft=this.leftOffset+"px");this.options.isPopover&&"right"===c&&(g.left=Math.floor(d.left+this.getTriggerWidth()+22)+"px",g.top=Math.floor(k-45)+"px");k=this.options.isFixedWidth?"width":
"minWidth";this.options.matchWidth?g[k]=this.getTriggerWidth()+"px":m?g[k]=h.outerWidth()+"px":g.minWidth="";this.options.removeZIndex||(g.zIndex=this.trigger.zIndex()+9999);this.content.css(g)}}},shouldFlipDirection:function(a){if(this.options.flippable){var b=e(window).scrollTop(),c=b+e(window).outerHeight(),d=this.content.outerHeight(),f=this.trigger.offset().top,c=f+this.trigger.outerHeight()+d>c,b=f-d<b;if("down"===a)return c&&!b;if("up"===a)return b&&!c}return!1},shouldFlipAlignment:function(a){if(this.options.flippable){var b=
e(window).width(),c=this.content.width(),d=this.trigger.offset().left,f=this.trigger.width(),f=0>=d+("left"===a?0:f)-c,b=d+("left"===a?c:0)>=b;if("left"===a)return!f&&b;if("right"===a)return f&&!b}return!1},getReversedDirection:function(a){switch(a){case "down":return"up";case "up":return"down";case "left":return"right";case "right":return"left";case "bottom":return"top";case "top":return"bottom";case "center":return"center"}return a},updateAnimationClass:function(a,b){a=this.getDirectionClass(a,
b);this.content.hasClass(a)||this.content.removeClass(function(a,b){return(b.match(/\banimate-\S+/g)||[]).join(" ")}).addClass(a).removeAttr("style")},getDirectionClass:function(a,b){var c;"left"===a||"right"===a?(c="down"===b?"top":"bottom",a="center"===a?"right":this.getReversedDirection(a)):(c="down"===a?"top":"bottom",a="center"===b?"right":b);return"animate-"+c+"-"+a},loadAjax:function(){var a=this;return f.ajax.execute(this.options.ajaxUrl,{data:this.options.ajaxData,customUpdate:function(b){b.innerHTML&&
""!==b.innerHTML?a.content.html(b.innerHTML):(a.element.remove(),a.ajaxLoadFailed=!0);return!0}})},getTriggerWidth:function(){if(null!=this.trigger){var a=this.trigger[0].getBoundingClientRect();return a?a.right-a.left:this.trigger.outerWidth()}return 0},disableDropdown:function(){this.options.openDisabled=!0;this.element.addClass("disabled");this.triggerObj&&this.triggerObj.disable()},enableDropdown:function(){this.options.openDisabled=!1;this.element.removeClass("disabled");this.triggerObj&&this.triggerObj.enable()},
animateClose:function(a){var b=this,c=this.content.attr("class").match(/\banimate-\S+/);c&&c.length&&(this.content.removeClass(c[0]),window.setTimeout(function(){b.content.addClass(c[0]+" close-animation")},1),window.setTimeout(function(){a();b.content.removeClass("close-animation")},this.animationDuration))},getStateClasses:function(a){null===this.states&&(this.states=f.question.ask("dropdown.dialog.states"));return this.states?this.states[a]:""}})})(R9,jQuery);(function(a,c){var d=a.config.getString("ui.horizon.common.core.focusOutlineClass","a11y-focused");a.createWidgetClass("dropdown.StyleJamDropdown",{status:null,select:null,selectEl:null,refreshTimer:null,lastSelectedIndex:-1,options:{click:null,change:null,statusClientTemplate:"",presentationStates:{}},init:function(){this.status=this.getChildElement("status");this.status.length||(this.status=this.element.find(".status"));this.select=this.getChildElement("select");this.select.length||(this.select=
this.element.find("select"));this.selectEl=this.select.get(0)},addEventHandlers:function(){this.select.click(this.handleSelectClickEvent.bind(this));this.select.keydown(this.handleSelectKeydownEvent.bind(this));this.select.keyup(this.handleSelectKeyupEvent.bind(this));this.select.focus(this.handleSelectFocusEvent.bind(this));this.select.blur(this.handleSelectBlurEvent.bind(this));this.select.change(this.handleSelectChangeEvent.bind(this));this.options.presentationStates&&this.styleInvalidState()},
refresh:function(){this.select.is(":disabled")?this.element.addClass("disabled"):this.element.removeClass("disabled");var b=this.selectEl.selectedIndex;0>b&&(b=0);b=this.selectEl.options[b];"undefined"!==typeof b&&(this.options.statusClientTemplate?this.status.html(a.template.render(this.options.statusClientTemplate,b)):(this.status.html(a.utils.escapeHTML(b.title||b.text||b.value)),this.selectEl.title=b.title||b.text||b.value))},startRefreshLoop:function(){var b=this;this.lastSelectedIndex=this.selectEl.selectedIndex;
this.refreshTimer=setInterval(function(){b.doRefresh()},100)},stopRefreshLoop:function(){null!=this.refreshTimer&&(clearTimeout(this.refreshTimer),this.refreshTimer=null,this.lastSelectedIndex=-1)},doRefresh:function(){this.selectEl.selectedIndex!==this.lastSelectedIndex&&(this.lastSelectedIndex=this.selectEl.selectedIndex,this.refresh())},handleSelectClickEvent:function(){"function"===typeof this.options.click&&this.options.click(this);this.stopRefreshLoop()},handleSelectKeydownEvent:function(){this.startRefreshLoop()},
handleSelectKeyupEvent:function(){this.refresh();this.stopRefreshLoop()},handleSelectFocusEvent:function(){this.selectEl.disabled||(this.element.addClass("focused").addClass(d),this.options.presentationStates?(this.element.removeClass(this.options.presentationStates.invalid),a.dom.swapClasses(this.element,this.options.presentationStates.regular,this.options.presentationStates.focus)):this.element.is(".TEXT")?(a.dom.swapClasses(c(this.element),a.stylejam.common.widgets.dropdown.StyleJamDropdown.dropdownTextBlurred,
a.stylejam.common.widgets.dropdown.StyleJamDropdown.dropdownTextFocused),a.dom.swapClasses(this.element.children(".icon"),a.stylejam.common.widgets.dropdown.StyleJamDropdown.dropdownIconText,a.stylejam.common.widgets.dropdown.StyleJamDropdown.dropdownIconTextFocused)):a.dom.swapClasses(c(this.element),a.stylejam.common.widgets.dropdown.StyleJamDropdown.dropdownBlurred,a.stylejam.common.widgets.dropdown.StyleJamDropdown.dropdownFocused))},handleSelectBlurEvent:function(){this.selectEl.disabled||(this.element.removeClass("focused").removeClass(d),
this.options.presentationStates?a.dom.swapClasses(this.element,this.options.presentationStates.focus,this.options.presentationStates.regular):(this.element.is(".TEXT")?(a.dom.swapClasses(c(this.element),a.stylejam.common.widgets.dropdown.StyleJamDropdown.dropdownTextFocused,a.stylejam.common.widgets.dropdown.StyleJamDropdown.dropdownTextBlurred),a.dom.swapClasses(this.element.children(".icon"),a.stylejam.common.widgets.dropdown.StyleJamDropdown.dropdownIconTextFocused,a.stylejam.common.widgets.dropdown.StyleJamDropdown.dropdownIconText)):
a.dom.swapClasses(c(this.element),a.stylejam.common.widgets.dropdown.StyleJamDropdown.dropdownFocused,a.stylejam.common.widgets.dropdown.StyleJamDropdown.dropdownBlurred),this.refresh(),this.stopRefreshLoop()))},handleSelectChangeEvent:function(b){"function"===typeof this.options.change&&this.options.change.call(this,b);this.refresh();this.stopRefreshLoop()},styleInvalidState:function(b){b?a.dom.swapClasses(this.element,this.options.presentationStates.regular,this.options.presentationStates.invalid):
a.dom.swapClasses(this.element,this.options.presentationStates.invalid,this.options.presentationStates.regular)},getSelectedElement:function(){return this.selectEl.options[0<=this.selectEl.selectedIndex?this.selectEl.selectedIndex:0]},getName:function(){return this.selectEl.name},hasOptions:function(){return 0!==this.selectEl.options.length},getValue:function(){return this.hasOptions()?this.getSelectedElement().value:null},val:function(b){"undefined"!==typeof b&&this.setValue(b);return this.getValue()},
getText:function(){return c(this.getSelectedElement()).text()},setText:function(b){this.status.text(b)},setValue:function(b,a){this.select.val(b);a?this.select.trigger("change"):this.refresh()},setOptions:function(a,d){var b=c("\x3cselect\x3e");(a||[]).forEach(function(a){a.value===d&&(a.selected=!0);b.append(c("\x3coption\x3e",a))});this.select.html(b.html());this.refresh()}})})(R9,jQuery);(function(b,d){var c=b.config.getString("ui.horizon.common.core.focusOutlineClass","a11y-focused");b.createWidgetClass("dropdown.Dropdown",{status:null,select:null,selectEl:null,refreshTimer:null,lastSelectedIndex:-1,options:{click:null,change:null,statusClientTemplate:""},init:function(){this.status=this.getChildElement("status");this.status.length||(this.status=this.element.find(".status"));this.select=this.getChildElement("select");this.select.length||(this.select=this.element.find("select"));
this.selectEl=this.select.get(0)},addEventHandlers:function(){this.select.click(this.handleSelectClickEvent.bind(this));this.select.keydown(this.handleSelectKeydownEvent.bind(this));this.select.keyup(this.handleSelectKeyupEvent.bind(this));this.select.focus(this.handleSelectFocusEvent.bind(this));this.select.blur(this.handleSelectBlurEvent.bind(this));this.select.change(this.handleSelectChangeEvent.bind(this))},refresh:function(){this.select.is(":disabled")?this.element.addClass("disabled"):this.element.removeClass("disabled");
var a=this.selectEl.selectedIndex;0>a&&(a=0);a=this.selectEl.options[a];"undefined"!==typeof a&&(this.options.statusClientTemplate?this.status.html(b.template.render(this.options.statusClientTemplate,a)):(this.status.html(b.utils.escapeHTML(a.title||a.text||a.value)),this.selectEl.title=a.title||a.text||a.value))},startRefreshLoop:function(){var a=this;this.lastSelectedIndex=this.selectEl.selectedIndex;this.refreshTimer=setInterval(function(){a.doRefresh()},100)},stopRefreshLoop:function(){null!=
this.refreshTimer&&(clearTimeout(this.refreshTimer),this.refreshTimer=null,this.lastSelectedIndex=-1)},doRefresh:function(){this.selectEl.selectedIndex!=this.lastSelectedIndex&&(this.lastSelectedIndex=this.selectEl.selectedIndex,this.refresh())},handleSelectClickEvent:function(){"function"===typeof this.options.click&&this.options.click(this);this.stopRefreshLoop()},handleSelectKeydownEvent:function(){this.startRefreshLoop()},handleSelectKeyupEvent:function(){this.refresh();this.stopRefreshLoop()},
handleSelectFocusEvent:function(){this.selectEl.disabled||this.element.addClass("focused").addClass(c)},handleSelectBlurEvent:function(){this.selectEl.disabled||(this.element.removeClass("focused").removeClass(c),this.refresh(),this.stopRefreshLoop())},handleSelectChangeEvent:function(a){"function"===typeof this.options.change&&this.options.change.call(this,a);this.refresh();this.stopRefreshLoop()},getSelectedElement:function(){return this.selectEl.options[0<=this.selectEl.selectedIndex?this.selectEl.selectedIndex:
0]},getName:function(){return this.selectEl.name},hasOptions:function(){return 0!==this.selectEl.options.length},getValue:function(){return this.hasOptions()?this.getSelectedElement().value:null},val:function(a){if("undefined"!==typeof a)this.setValue(a);else return this.getValue()},getText:function(){return d(this.getSelectedElement()).text()},setText:function(a){this.status.text(a)},setValue:function(a,b){this.select.val(a);b?this.select.trigger("change"):this.refresh()},setOptions:function(a,b){var c=
d("\x3cselect\x3e");d.each(a,function(a,e){e.value===b&&(e.selected=!0);c.append(d("\x3coption\x3e",e))});this.select.html(c.html());this.refresh()}})})(R9,jQuery);(function(e,g){e.createComponentClass("hotels.search.HotelTravelersDropdown",{roomsGuestsDropdown:null,rooms:null,guests:null,adults:null,children:null,hotelPlanner:null,travelersAgeContainer:null,renderedTravelerDropdowns:[],trigger:null,isOnStickyForm:!1,isOnDialog:!1,options:{autoSubmit:!1,namespace:null,specifyChildAges:!1,subtractOffsetFromDropdown:!1,defaultRooms:1,defaultGuests:5,defaultAdults:1,defaultChildren:1,maxRooms:8,maxGuests:32,maxAdults:32,maxChildren:32,childrenAges:[],maxPerRoom:4,
travelersDataQuestion:"hotels.searchform.travelers",roomsQuestion:"hotel-rooms-selected",travelerAgeTemplateId:"travelerAgeDropdown",hotelPlannerTrigger:0,updateAll:!1,numberBoxMsg:{roomsOverMax:function(){var a=this.adults.getValue()+this.children.getValue();return e.Common.Utils.String.formatString(this.options.msg.roomsOverMax,this.rooms.getValue(),a)},roomsBelowMin:function(){var a=this.adults.getValue()+this.children.getValue();return e.Common.Utils.String.formatChoice(this.options.msg.roomsBelowMin,
this.rooms.getValue(),this.rooms.getValue(),a)},guestsOverMax:function(){var a=this.adults.getValue()+this.children.getValue();return e.Common.Utils.String.formatString(this.options.msg.guestsOverMax,a,this.rooms.getValue())},guestsBelowMin:function(){var a=this.adults.getValue()+this.children.getValue();return e.Common.Utils.String.formatChoice(this.options.msg.guestsBelowMin,a,a,this.rooms.getValue())}}},init:function(){this.bindRoomsGuestsDropdown();this.options.specifyChildAges&&(this.travelersAgeContainer=
this.getChildElement("travelersAgeContainer"))},addEventHandlers:function(){var a=this;this.subscribe("hotelsearchform.close.roomsGuestsDropdown",function(){a.roomsGuestsDropdown.close()});this.subscribe("hotels.frontdoor.form.sticky",{namespace:this.options.namespace},function(b){a.isOnStickyForm=b.isSticky;a.setMaxAgeContainerHeight()});this.subscribe("hotels.dialog.form.open",{id:this.options.namespace},function(){a.isOnDialog=!0;a.setMaxAgeContainerHeight()});e.events.subscribe("select.force.close",
function(){a.roomsGuestsDropdown.close()});this.answer(this.options.travelersDataQuestion,this.serialize.bind(this));var b=this.options.updateAll?{}:{namespace:this.options.namespace};this.subscribe("hotels.frontdoor.rooms.onChange",b,this.onRoomsChange.bind(this));this.subscribe("hotels.frontdoor.guests.onChange",b,this.onGuestsChange.bind(this));this.subscribe("hotels.frontdoor.childrenAges.onChange",b,this.onChildrenAgesChange.bind(this));this.answer(this.options.roomsQuestion,function(){return a.rooms.getValue()})},
setMaxAgeContainerHeight:function(){if((this.isOnStickyForm||this.isOnDialog)&&this.travelersAgeContainer&&this.roomsGuestsDropdown.cover&&this.travelersAgeContainer.prev()&&this.roomsGuestsDropdown.element){var a=this.roomsGuestsDropdown.cover[0].getBoundingClientRect().top,b=this.travelersAgeContainer.prev()[0].getBoundingClientRect().height,c=parseInt(window.getComputedStyle(this.roomsGuestsDropdown.cover[0])["padding-top"],10)+parseInt(window.getComputedStyle(this.roomsGuestsDropdown.cover[0])["padding-bottom"],
10);this.travelersAgeContainer.css("maxHeight","calc(100vh - "+(a+b+c+64)+"px)").css("overflow-y","auto")}else this.travelersAgeContainer.css("maxHeight","unset").css("overflow-y","unset")},inlineComponentsReady:function(){if(this.options.specifyChildAges){var a=this.children.getValue();0<a&&this.displayTravelersAgeSection(a,this.options.childrenAges)}this.trigger=this.getChildElement("roomsGuestsDropdown-trigger");this.rooms&&this.rooms.getValue()&&this.updateHotelPlanner(this.rooms.getValue())},
bindRoomsGuestsDropdown:function(){var a=this,b,c;this.roomsGuestsDropdown=this.getChildElement("roomsGuestsDropdown").getWidget();this.roomsGuestsDropdown.setOption("onOpen",function(){a.roomsGuestChanged=!1;setTimeout(function(){g(a.rooms).focus()},100);a.getChildElement("roomsGuestsDropdown").attr("aria-expanded","true");setTimeout(function(){a.setMaxAgeContainerHeight()},0)});this.roomsGuestsDropdown.setOption("onClose",function(b,c,d){b&&d&&setTimeout(function(){a.trigger.focus()},100);a.roomsGuestChanged&&
a.options.autoSubmit&&e.events.publish("hotels.frontdoor.form.autoSubmit",{});a.roomsGuestsDropdown.element.find(".focused").removeClass("focused");a.trigger.focus();a.getChildElement("roomsGuestsDropdown").attr("aria-expanded","false")});c=function(a){return(a.styleJamNumberBox||a.numberBox).bind(a)};this.rooms=c(this.getChildElement("rooms"))({min:1,max:a.options.maxRooms,defaultValue:a.options.defaultRooms,callback:function(){a.updateBoxButtonStates();a.roomsGuestChanged=!0;e.events.publish("hotels.frontdoor.form.rooms",
{namespace:a.options.namespace,id:a.options.namespace,rooms:this.getValue()});e.Analytics.api.trackEvent("hotels/form/changerooms")}}).getWidget();b=this.rooms.decrButton;this.adults=c(this.getChildElement("adults"))({min:1,max:a.options.maxAdults,defaultValue:a.options.defaultAdults,callback:function(){a.roomsGuestChanged=!0;e.events.publish("hotels.frontdoor.form.guests.adults",{namespace:a.options.namespace,id:a.options.namespace,adults:this.getValue()});e.Analytics.api.trackEvent("hotels/form/changeguests_adults")}}).getWidget();
c=(this.children=c(this.getChildElement("children"))({min:0,max:a.options.maxChildren,defaultValue:a.options.defaultChildren,callback:function(){a.roomsGuestChanged=!0;e.events.publish("hotels.frontdoor.form.guests.children",{namespace:a.options.namespace,id:a.options.namespace,children:this.getValue()});e.Analytics.api.trackEvent("hotels/form/changeguests_children")}}).getWidget())&&this.children.incrButton;var d=function(b,c){b&&b.off("keydown").keydown(function(b){9===b.which&&(c?b.shiftKey:!b.shiftKey)&&
(b.preventDefault(),b.stopPropagation(),setTimeout(function(){a.roomsGuestsDropdown.element.focus();a.roomsGuestsDropdown.toggleContent(!1)},100))})};d(b,!0);d(c,!1);this.hotelPlanner=this.getChildElement("hotelPlanner");this.hotelPlanner.on("click",function(b){b.preventDefault();b=a.serialize();e.events.publish("hotelplanner.open",{location:b.location,startDate:b.checkInDate,endDate:b.checkOutDate})});this.updateBoxButtonStates()},updateBoxButtonStates:function(){var a=this.adults.getValue(),b=this.children.getValue();
a+b===Math.min(this.options.maxGuests,this.options.maxRooms*this.options.maxPerRoom)?(this.adults.disableIncrement(),this.children.disableIncrement()):(this.adults.enableIncrement(),this.children.enableIncrement())},onRoomsChange:function(a){var b=this.options.maxPerRoom;a.rooms>this.rooms.options.max?this.rooms.setValue(this.rooms.options.max,!0):a.rooms<this.rooms.options.min?this.rooms.setValue(this.rooms.options.min,!0):this.rooms.setValue(a.rooms,!0);var c=this.rooms.getValue(),d=this.adults.getValue(),
f=this.children.getValue();d<c&&(d=c);c*b<d+f&&(f=c*b-d,0>f&&(f=0,d=c*b));this.children.setValue(f,!0);this.options.specifyChildAges&&this.displayTravelersAgeSection(f);this.adults.setValue(d,!0);this.refreshRoomsGuestsDropdownDisplay(a)},onGuestsChange:function(a){var b,c;"undefined"!==typeof a.guests?(b=a.guests,a.adults=b,c=0):(b=a.adults,c=a.children);if("undefined"!==typeof b)this.onAdultsFieldChange(a);if("undefined"!==typeof c)this.onChildrenFieldChange(a);this.updateBoxButtonStates()},onChildrenAgesChange:function(a){if(this.options.specifyChildAges){var b=
[];"undefined"!==typeof a.childrenAges&&(""!==a.childrenAges&&(b=a.childrenAges.split("-")),this.displayTravelersAgeSection(b.length,b))}},onChildrenFieldChange:function(a){var b=this.options.maxPerRoom;a.children>this.children.options.max?this.children.setValue(this.children.options.max,!0):a.children<this.children.options.min?this.children.setValue(this.children.options.min,!0):this.children.setValue(a.children,!0);var c=this.adults.getValue(),d=this.children.getValue(),f=this.rooms.getValue(),
b=Math.ceil((d+c)/b);f<b&&(f=b);f>c&&(c=f);this.adults.setValue(c,!0);this.rooms.setValue(f,!0);this.options.specifyChildAges&&this.displayTravelersAgeSection(this.children.getValue());this.refreshRoomsGuestsDropdownDisplay(a)},onAdultsFieldChange:function(a){var b=this.options.maxPerRoom;a.adults>this.adults.options.max?this.adults.setValue(this.adults.options.max,!0):a.adults<this.adults.options.min?this.adults.setValue(this.adults.options.min,!0):this.adults.setValue(a.adults,!0);var c,d=this.adults.getValue(),
f=this.children.getValue();a=this.rooms.getValue();c=Math.ceil((d+f)/b);c>d&&(c=d);a<c?a=c:a>d&&(a=d,b=a*b-d,f=b<f?b:f);this.children.setValue(f,!0);this.rooms.setValue(a,!0);this.options.specifyChildAges&&this.displayTravelersAgeSection(f);this.refreshRoomsGuestsDropdownDisplay()},onGuestsFieldChange:function(a){var b=this.options.maxPerRoom;a.guests>this.guests.options.max?this.guests.setValue(this.guests.options.max,!0):a.guests<this.guests.options.min?this.guests.setValue(this.guests.options.min,
!0):this.guests.setValue(a.guests,!0);var c=this.guests.getValue(),d=this.rooms.getValue();d*b<c?(d=Math.ceil(c/b),this.rooms.setValue(d),this.options.showNumberboxTooltips&&this.showTooltip(this.guests.incrButton,this.options.numberBoxMsg.guestsOverMax.call(this))):d>c?(this.rooms.setValue(c),this.options.showNumberboxTooltips&&this.showTooltip(this.guests.incrButton,this.options.numberBoxMsg.guestsBelowMin.call(this))):this.options.showNumberboxTooltips&&this.clearTooltips();this.refreshRoomsGuestsDropdownDisplay(a)},
refreshRoomsGuestsDropdownDisplay:function(){var a=this.rooms.getValue(),b=this.adults.getValue()+this.children.getValue(),a=e.Common.Utils.String.formatChoice(this.options.msg.roomsChoiceLabel,a,a);(b=e.Common.Utils.String.formatChoice(this.options.msg.guestsChoiceLabel,b,b))&&a&&this.roomsGuestsDropdown.updateLabel(a+", "+b);this.updateHotelPlanner(this.rooms.getValue());this.setMaxAgeContainerHeight()},updateHotelPlanner:function(a){0<this.options.hotelPlannerTrigger&&(a>=this.options.hotelPlannerTrigger?
(this.hotelPlanner.addClass("visible"),this.swapClasses(this.hotelPlanner,"RoomsGuestsDropdown__HotelPlanner--hidden","RoomsGuestsDropdown__HotelPlanner--visible")):(this.hotelPlanner.removeClass("visible"),this.swapClasses(this.hotelPlanner,"RoomsGuestsDropdown__HotelPlanner--visible","RoomsGuestsDropdown__HotelPlanner--hidden")))},getRoomsData:function(){return{rooms:this.rooms.getValue()}},getGuestsData:function(){return{adults:this.adults.getValue(),children:this.children.getValue()}},getTravelersAgeData:function(){var a=
this.travelersAgeContainer.children().length,b=this.children.getValue(),c="";if(b<=a)for(a=0;a<b;a++){var d=this.renderedTravelerDropdowns[a].getValue();"undefined"!==typeof d&&(c+=d,a<b-1&&(c+="-"))}return{childrenAges:c}},showTooltip:function(a,b){a.toolTip({content:b,position:"right",showImmediately:!0})},clearTooltips:function(){this.rooms.incrButton.data("toolTip")&&this.rooms.incrButton.data("toolTip").removeWidget();this.guests&&this.guests.incrButton.data("toolTip")&&this.guests.incrButton.data("toolTip").removeWidget();
this.children&&this.children.incrButton.data("toolTip")&&this.children.incrButton.data("toolTip").removeWidget();this.adults&&this.adults.incrButton.data("toolTip")&&this.adults.incrButton.data("toolTip").removeWidget()},displayTravelersAgeSection:function(a,b){0<a?this.swapClasses(this.travelersAgeContainer,"TravelersAgeContainer--hidden","TravelersAgeContainer--visible"):this.swapClasses(this.travelersAgeContainer,"TravelersAgeContainer--visible","TravelersAgeContainer--hidden");this.renderTravelerDropdowns(a,
b)},renderTravelerDropdowns:function(a,b){var c;c=this.travelersAgeContainer.children().length;for(var d=c>a?c:a,f="#traveler-"+this.id()+"-",e=0;e<d;e++)c=g(f+e),0<c.length?e<a?(this.swapClasses(c,"TravelersAgeItem--hidden","TravelersAgeItem--visible"),"undefined"!==typeof b&&"undefined"!==typeof b[e]&&this.renderedTravelerDropdowns[e].setValue(b[e],!1)):(this.swapClasses(c,"TravelersAgeItem--visible","TravelersAgeItem--hidden"),this.renderedTravelerDropdowns[e].setValue("0",!1)):null!=b&&"undefined"!==
typeof b[e]?this.renderNewTravelerAgeDropdown(e,b[e]):this.renderNewTravelerAgeDropdown(e)},renderNewTravelerAgeDropdown:function(a,b){var c=this,d="#traveler-"+this.id()+"-",f=e.template.render(c.options.travelerAgeTemplateId,{id:this.id(a),index:a+1});this.travelersAgeContainer.append(f);this.renderedTravelerDropdowns[a]=g(d+a+"-dropdown").dropdown({change:function(){var a=g.extend({namespace:c.options.namespace,id:c.options.namespace},c.getTravelersAgeData());e.events.publish("hotels.frontdoor.form.guests.childrenAges",
a)}}).getWidget();"undefined"!==typeof b&&this.renderedTravelerDropdowns[a].setValue(b);return f},serialize:function(){var a={};g.extend(a,this.getRoomsData());g.extend(a,this.getGuestsData());this.options.specifyChildAges&&g.extend(a,this.getTravelersAgeData());return a}})})(R9,jQuery);(function(d,e){d.createWidgetClass("text.InputModal",{display:null,displayInner:null,smartyWindow:null,smartyContent:null,smartyBackground:null,pillsContainerDisplay:null,pillsContainerModal:null,placeholderUpdateInterval:null,smartyInit:!1,triggeringFocus:!1,clicking:!1,open:!1,focusTimeout:-1,initialSmartyChecked:!1,oldValue:"",multiSelectActive:!1,multiSelectCompactLayout:!1,multiSelectContainers:null,hasMultiSelections:!1,options:{mobileBreakpoint:568,desktopBreakpoint:1024,openSmartyDelay:null,
delayOpenSmarty:null,alignment:"left",maxWidth:516,smartyEnabled:!0,displayPresentation:"",inputPresentations:{},useInstantFocus:!1,cleanAfterFocus:!1,pillsEnabled:!1,multiSelectEnabled:!1,multiNearbySelectEnabled:!1,isStickyEnabled:!1,removeOnPollingStart:!1,backspaceDeletingEnabled:!1,isForTags:!1,repositionOnScroll:!1,onTabBack:null,inContentSmarty:!1,mcFly:!1},init:function(){var a=this;this.options.mcFly&&(this.stlNamespace+=".MCFLY");this.display=this.getChildElement("display");this.plusIcon=
this.options.mcFly?this.getChildElement("plus-icon"):this.display.find(".js-plus-icon");this.displayInner=this.getChildElement("display-inner");this.smartyWindow=this.getChildElement("smarty-window");this.smartyContent=this.getChildElement("smarty-content");this.smartyWrapper=this.getChildElement("smarty-wrapper");this.smartyBackground=this.getChildElement("smarty-bg");this.message=this.getChildElement("message");this.close=this.getChildElement("close");this.options.pillsEnabled&&(this.pillsContainerDisplay=
this.getChildElement("pills-container-display"),this.pillsContainerModal=this.getChildElement("pills-container-modal"));this.multiDisplayContainer=this.getChildElement("display-multi-container");this.smartyMultiContainer=this.getChildElement("smarty-multi-container");this.multiSelectContainers=this.multiDisplayContainer.add(this.smartyMultiContainer);setTimeout(function(){a.smartyWindow.css("display","block")},200)},bindComponent:function(){this.element.data("inputModal",this)},inlineComponentsReady:function(){var a=
this;this.options.inContentSmarty&&!this.isFullScreen()||d.dom.schedule(function(){a.positionSmartyWindow()})},addEventHandlers:function(){var a=this;this.registerEvent("mousedown",this.display,function(){a.clicking=!0});this.registerEvent("click",this.display,function(){a.toggleSmartyWindow(!0)});this.registerEvent("mouseup",this.display,function(){a.clicking=!1});this.registerEvent("click",this.close,function(){a.toggleSmartyWindow(!1)});this.registerEvent("focus",this.display,function(){a.clicking||
(a.triggeringFocus?(a.toggleSmartyWindow(!1),a.triggeringFocus=!1,clearTimeout(a.focusTimeout)):a.toggleSmartyWindow(!0))});this.options.backspaceDeletingEnabled&&this.registerEvent("focus",this.element,function(){a.multiSelectSelected&&a.unselectMultiSelections()});this.registerEvent("keydown",this.display,function(c){13===c.which?(clearTimeout(a.focusTimeout),a.toggleSmartyWindow(!0)):9===c.which&&(clearTimeout(a.focusTimeout),a.toggleSmartyWindow(!1))});this.subscribe("smarty.setitem.complete",
function(){a.toggleSmartyWindow(!1)});this.registerEvent("keydown.inputmodal",this.element,function(c){switch(c.which){case 13:case 27:a.toggleSmartyWindow(!1);a.triggeringFocus=!0;a.display.focus();break;case 9:if(c.shiftKey&&a.options.onTabBack)return window.setTimeout(a.options.onTabBack,100),!1;a.triggeringFocus=!0;a.display.focus()}return!0});this.options.backspaceDeletingEnabled&&this.registerEvent("keydown",e(document),function(c){if(a.open&&a.hasMultiSelections)switch(c.which){case 39:a.selectNextMultiSelection();
break;case 37:a.selectNextMultiSelection(!0);break;case 8:a.handleMultiSelectionBackspace(c)}});this.subscribe("InputModal.lastSelectionClosed",function(c){c.id!==a.id()&&a.open&&a.toggleSmartyWindow(!1)});this.registerEvent("click.smarty",e(document),function(c){var b=e(c.target);a.options.backspaceDeletingEnabled&&this.multiSelectSelected&&0===b.closest("#"+a.id("smarty-multi-container")+", #"+a.id("display-multi-container")).length&&a.unselectMultiSelections();0!==b.closest("#"+a.id("smarty-window")+
", #"+a.id("display")).length||a.options.inContentSmarty&&0!==b.closest("#"+a.id("smartbox-dropdown")).length||(a.open&&a.options.preventClickoutPropagation&&0===e(c.target).closest(a.options.allowedClickoutEl).length&&(c.preventDefault(),c.stopPropagation(),c.stopImmediatePropagation()),a.isMobileSafari()||a.toggleSmartyWindow(!1))});this.registerEvent("resize",e(window),this.positionSmartyWindow.bind(this));this.options.repositionOnScroll&&this.registerEvent("scroll",e(window),function(){a.open&&
d.dom.schedule(a.positionSmartyWindow.bind(a))});var b=null;this.placeholderUpdateInterval=window.setInterval(function(){a.elementNode.value!==b&&(b=a.elementNode.value,a.updatePlaceholder())},50);this.subscribe("flights.search.form.sticky.toggle",function(b){if(a.options.isStickyEnabled){var c=a.options.inputPresentations[a.options.displayPresentation],e=a.options.inputPresentations[a.options.displayPresentation+"_STICKY"];c&&e&&(b?(d.dom.swapClasses(a.display,c.presentation,e.presentation),d.dom.swapClasses(a.display.find(".js-display-icon"),
c.svg,e.svg)):(d.dom.swapClasses(a.display,e.presentation,c.presentation),d.dom.swapClasses(a.display.find(".js-display-icon"),e.svg,c.svg)))}});this.options.removeOnPollingStart&&d.events.subscribe("resultspage.streaming.start",this.resetSmartyWindowPosition.bind(this));if(this.options.multiSelectEnabled)this.multiSelectContainers.on("click",".js-remove-selection",this.onRemoveMultiSelectionClick.bind(this));if(this.options.backspaceDeletingEnabled)this.multiSelectContainers.on("click",".js-selection",
this.onMultiSelectionClick.bind(this))},isMobileSafari:function(){return/iP(ad|hone|od).+Version\/[\d\.]+.*Safari/i.test(navigator.userAgent)},destroy:function(){this.base();this.element.data("inputModal",null);window.clearInterval(this.placeholderUpdateInterval);this.multiSelectContainers.off("click")},resetSmartyWindowPosition:function(){setTimeout(function(){this.smartyWindow.removeAttr("style")}.bind(this),750)},positionSmartyWindow:function(){var a=this.display.offset(),b=this.display.outerWidth(!0),
c=Math.max(b,this.options.maxWidth),f=parseInt(this.display.css("margin-left"),10),d=e(window).outerWidth(),f="right"===this.options.alignment&&this.canRightAlign()?Math.floor(a.left+(b-(c+8))):"left"===this.options.alignment&&a.left+40+c>d?"rtl"===document.dir?-Math.floor(d-a.left-b):Math.floor(a.left+(d-(a.left+c+40))):"rtl"===document.dir?-Math.floor(d-a.left-b-8-f):Math.floor(a.left-f);"rtl"===document.dir&&Math.abs(f)+c>e(window).innerWidth()&&(f=e(window).innerWidth()-c,f=0<f?-f:0);this.options.mcFly&&
!this.isFullScreen()?(d=this.display.outerHeight(!0),this.smartyWindow.css({transform:"translate("+f+"px,"+Math.floor(a.top+d)+"px)"})):this.smartyWindow.css({transform:"translate("+f+"px,"+Math.floor(a.top-4)+"px)"});this.smartyBackground.css({width:b-16,height:this.options.mcFly?0:this.display.outerHeight()-16});this.isFullScreen()?this.smartyContent.css({minWidth:0}):this.smartyContent.css({minWidth:c});this.options.pillsEnabled&&this.smartyWrapper.css({maxWidth:c});this.open&&"parentIFrame"in
window&&window.parentIFrame.sendMessage({action:"InputModal.opened",mode:this.isFullScreen()?"FullScreen":"Normal"});this.open&&this.options.mcFly&&(this.smartyWrapper.css({width:this.isFullScreen()?"auto":b}),this.options.inContentSmarty&&window.parent.postMessage({action:"McFlySearchDialogFrameDisplay",fullScreen:this.isFullScreen()},window.location.href))},toggleSmartyWindow:function(a){a!==this.open&&(this.open=a,this.options.mcFly&&this.options.multiNearbySelectEnabled&&this.togglePlusIconVisibility(!a),
a?(this.multiSelectActive&&this.toggleSmartyMultiSelect(!0),"function"===typeof this.options.delayOpenSmarty&&this.options.delayOpenSmarty()?setTimeout(this._openSmartyWindow.bind(this),this.options.openSmartyDelay):this._openSmartyWindow(),this.multiSelectActive&&this.toggleDisplayMultiSelect(!1),this.options.cleanAfterFocus&&(this.oldValue=this.element.val(),this.element.val("")),d.events.publish("InputModal.opened")):(this.element.data("val-close",this.element.val()),!this.element.val()&&this.oldValue&&
this.element.val(this.oldValue),this.multiSelectActive&&(this.element.val(""),this.toggleDisplayMultiSelect(!0)),this.options.backspaceDeletingEnabled&&this.multiSelectSelected&&this.unselectMultiSelections(),d.dom.swapChildrenClasses(this.smartyWindow,this.getStlClasses().SmartyWindow,"visible","hidden"),this.updatePlaceholder(),this.smartyContent.removeClass("visible"),this.multiSelectActive&&this.toggleSmartyMultiSelect(!1),d.events.publish("InputModal.closed",{id:this.id()}),"parentIFrame"in window&&
window.parentIFrame.sendMessage({action:"InputModal.closed"}),this.options.mcFly&&this.options.inContentSmarty&&(this.element.blur(),window.parent.postMessage({action:"McFlySearchDialogFrameDisplay",fullScreen:!1},window.location.href))))},_openSmartyWindow:function(){var a=this,b=this.isFullScreen()?1:200;this.initialSmartyChecked||(this.element.val()&&this.options.smartyEnabled&&this.element.getWidget().runSearch(!1),this.initialSmartyChecked=!0);this.positionSmartyWindow();d.dom.swapChildrenClasses(this.smartyWindow,
this.getStlClasses().SmartyWindow,"hidden","visible");this.smartyContent.addClass("visible");this.multiSelectActive&&!this.options.isForTags&&this.element.getWidget().showAirportMultiSelections();this.options.backspaceDeletingEnabled&&this.multiSelectSelected||(this.options.useInstantFocus?a.element.focus().select():this.focusTimeout=setTimeout(function(){a.element.focus().select()},b))},updatePlaceholder:function(){var a=this.element.val();this.options.presentation?a?(this.swapClasses(this.display,
"DisplayInput--empty","DisplayInput--full"),this.displayInner.text(a)):(this.swapClasses(this.display,"DisplayInput--full","DisplayInput--empty"),this.displayInner.html(this.display.attr("data-placeholder"))):a?(d.dom.swapChildrenClasses(this.display,this.getStlClasses().DisplayInput,"empty","full"),this.displayInner.text(a)):(d.dom.swapChildrenClasses(this.display,this.getStlClasses().DisplayInput,"full","empty"),this.displayInner.html(this.display.attr("data-placeholder")))},getSmartyWrapper:function(){return this.smartyContent},
getSmartyWindow:function(){return this.smartyWindow},getDisplay:function(){return this.display},getPillsContainerDisplay:function(){return this.pillsContainerDisplay},getPillsContainerModal:function(){return this.pillsContainerModal},focus:function(){this.display.focus()},toggleInputVisibility:function(a,b){this.element.prop("disabled",!a);a&&b?this.element.fadeTo(b,1):this.element.css("opacity",a?1:0)},isFullScreen:function(){return this.getFullScreenBreakpoint()>e(window).outerWidth()},canRightAlign:function(){return this.getFullScreenBreakpoint()<=
e(window).outerWidth()},getFullScreenBreakpoint:function(){return this.options.mcFly?this.options.desktopBreakpoint:this.options.mobileBreakpoint},pulseDisplay:function(){var a=this;this.options.presentation&&(this.swapClasses(this.display,"DisplayInput--unpulse","DisplayInput--pulse"),window.setTimeout(function(){a.swapClasses(a.display,"DisplayInput--pulse","DisplayInput--unpulse")},1E3))},onTextInputWrapperClick:function(){var a=this.element.getWidget();this.element.prop("disabled")&&a&&a.highlightMultiCheckboxMessage()},
toggleMultiSelectVisibility:function(a){this.multiSelectActive=a;this.open?this.toggleSmartyMultiSelect(a):this.toggleDisplayMultiSelect(a);this.displayInner.prop("hidden",a);this.display.find(".js-display-icon").attr("visibility",a?"hidden":"visible");this.onToggleMultiSelectVisibility(a);var b=this.getChildElement("textInputWrapper"),c=this.onTextInputWrapperClick.bind(this);a?this.registerEvent("click",b,c):b.off("click",c)},onToggleMultiSelectVisibility:function(){},toggleDisplayMultiSelect:function(a){this.options.mcFly?
this.multiDisplayContainer.toggleClass(this.scoped("mod-hidden"),!a):this.swapClassesToggle(this.multiDisplayContainer,"DisplayMultiSelectContainer--hidden","DisplayMultiSelectContainer--visible",!a)},toggleSmartyMultiSelect:function(a){this.options.mcFly?this.smartyMultiContainer.toggleClass(this.scoped("mod-hidden"),!a):this.swapClassesToggle(this.smartyMultiContainer,"SmartyMultiSelectContainer--hidden","SmartyMultiSelectContainer--visible",!a)},getMultiSelectionValue:function(){return this.multiSelectContainers.find(".js-selection").map(function(){return e(this).data("value")}).join(",")},
hasMultiSelection:function(a){return this.multiSelectContainers.find('.js-selection[data-value\x3d"'+a+'"]').length},addMultiSelection:function(a,b,c,e){if(this.options.multiSelectEnabled){this.multiSelectActive||this.toggleMultiSelectVisibility(!0);var f="DisplaySelection--input DisplaySelection--input--visible "+(this.options.backspaceDeletingEnabled?"DisplaySelection--input--border-selectable":"DisplaySelection--input--border-regular"),g=a,h=/^[A-Z]{3}a$/.test(a);h&&(g=a.replace("a","+"));f=d.template.renderElement("displaySelection",
{value:a,valueDisplay:g,fullDisplay:b,compact:this.multiSelectCompactLayout&&!e,stateClasses:this.getStlBlocks(f)});h&&this.swapClasses(f.find(".js-selection-text-container"),"DisplaySelection__TextContainer--normal","DisplaySelection__TextContainer--wide");f.appendTo(this.multiDisplayContainer);a=d.template.renderElement("displaySelection",{value:a,valueDisplay:g,fullDisplay:b,compact:this.multiSelectCompactLayout&&!e,stateClasses:this.getStlBlocks("DisplaySelection--modal "+(c?"DisplaySelection--invisible ":
"DisplaySelection--modal--visible ")+(this.options.backspaceDeletingEnabled?"DisplaySelection--modal--border-selectable":"DisplaySelection--modal--border-regular")),preventCompact:e});h&&this.swapClasses(a.find(".js-selection-text-container"),"DisplaySelection__TextContainer--normal","DisplaySelection__TextContainer--wide");a.appendTo(this.smartyMultiContainer);c&&d.dom.schedule(this.swapClasses.bind(this,a,"DisplaySelection--invisible","DisplaySelection--modal--visible"));this.hasMultiSelections||
(this.hasMultiSelections=!0);this.options.mcFly&&this.options.multiNearbySelectEnabled&&this.togglePlusIconVisibility(!0)}},onRemoveMultiSelection:function(a,b){this.removeMultiSelection(a,b)},onRemoveMultiSelectionClick:function(a){a.stopPropagation();a=e(a.target).closest(".js-selection").data("value");this.onRemoveMultiSelection(a,"brick");this.element.focus()},onMultiSelectionClick:function(a){a=e(a.target).closest(".js-selection");this.selectMultiSelection(a)},selectMultiSelection:function(a){this.multiSelectSelected=
!0;var b=this;this.multiSelectContainers.find(".js-selection").each(function(){var c=e(this),d=c.data("value")===a.data("value");c.hasClass(b.getStlBlock("DisplaySelection--input--border-selectable"))&&d?b.swapClasses(c,"DisplaySelection--input--border-selectable","DisplaySelection--input--border-selected"):c.hasClass(b.getStlBlock("DisplaySelection--input--border-selected"))&&!d?b.swapClasses(c,"DisplaySelection--input--border-selected","DisplaySelection--input--border-selectable"):c.hasClass(b.getStlBlock("DisplaySelection--modal--border-selectable"))&&
d?b.swapClasses(c,"DisplaySelection--modal--border-selectable","DisplaySelection--modal--border-selected"):c.hasClass(b.getStlBlock("DisplaySelection--modal--border-selected"))&&!d&&b.swapClasses(c,"DisplaySelection--modal--border-selected","DisplaySelection--modal--border-selectable")})},unselectMultiSelections:function(){var a=this;this.multiSelectContainers.find(".js-selection").each(function(){var b=e(this);b.hasClass(a.getStlBlock("DisplaySelection--input--border-selected"))?a.swapClasses(b,
"DisplaySelection--input--border-selected","DisplaySelection--input--border-selectable"):b.hasClass(a.getStlBlock("DisplaySelection--modal--border-selected"))&&a.swapClasses(b,"DisplaySelection--modal--border-selected","DisplaySelection--modal--border-selectable")});this.multiSelectSelected=!1},selectNextMultiSelection:function(a){if(!this.element.is(":focus")&&this.multiSelectSelected){a=a?e(this.smartyMultiContainer.find(".js-selection").get().reverse()):this.smartyMultiContainer.find(".js-selection");
var b=a.length,c=!1,d=this;a.each(function(a){var f=e(this);if(c)return d.swapClasses(f,"DisplaySelection--modal--border-selectable","DisplaySelection--modal--border-selected"),!1;a<b-1&&f.hasClass(d.getStlBlock("DisplaySelection--modal--border-selected"))&&(d.swapClasses(f,"DisplaySelection--modal--border-selected","DisplaySelection--modal--border-selectable"),c=!0);return!0})}},handleMultiSelectionBackspace:function(a){if(!this.element.is(":focus")||!this.element.val()){a.preventDefault();var b=
this;this.multiSelectSelected?(this.smartyMultiContainer.find(".js-selection").each(function(){var a=e(this);return a.hasClass(b.getStlBlock("DisplaySelection--modal--border-selected"))?(b.swapClasses(a,"DisplaySelection--modal--border-selected","DisplaySelection--modal--border-selectable"),b.onRemoveMultiSelection(a.data("value"),"brick"),b.element.focus(),!1):!0}),this.multiSelectSelected=!1):(this.multiSelectSelected=!0,a=this.smartyMultiContainer.find(".js-selection").filter(function(){return!e(this).hasClass("js-removed")}).last(),
this.swapClasses(a,"DisplaySelection--modal--border-selectable","DisplaySelection--modal--border-selected"))}},removeMultiSelection:function(a,b){var c=this;this.multiSelectContainers.find(".js-selection").filter(function(){return e(this).data("value")===a}).each(function(){c.removeMultiSelectionElement(e(this),b)});this.multiSelectContainers.find(".js-selection:not(.js-removed)").length||(this.toggleMultiSelectVisibility(!1),this.hasMultiSelections=!1,this.toggleSmartyWindow(!0),this.element.prop("disabled")||
this.element.focus(),d.events.publish("InputModal.lastSelectionClosed",{id:this.id()}))},removeMultiSelectionElement:function(a,b){b?(a.removeClass(this.getStlBlocks("DisplaySelection--input--visible DisplaySelection--modal--visible")).addClass(this.getStlBlock("DisplaySelection--invisible")+" js-removed"),window.setTimeout(function(){a.remove()},500)):a.remove()},resetMultiSelection:function(){this.multiSelectContainers.find(".js-selection").remove();this.toggleMultiSelectVisibility(!1);this.toggleInputVisibility(!0);
this.toggleMessage(!1);this.options.multiNearbySelectEnabled&&this.togglePlusIconVisibility(!this.options.mcFly)},toggleMultiSelectionCompactLayout:function(a){if(this.multiSelectCompactLayout!==a){this.multiSelectCompactLayout=a;var b=this.multiSelectContainers.find(".js-selection:not([data-prevent-compact])"),c=b.find(".js-selection-value"),b=b.find(".js-selection-display");d.dom.schedule(this.swapClassesToggle.bind(this,b,"DisplaySelection__Display--visible","DisplaySelection__Display--hidden",
!a));d.dom.schedule(this.swapClassesToggle.bind(this,c,"DisplaySelection__Value--hidden","DisplaySelection__Value--visible",!a))}},toggleMessage:function(a){this.options.mcFly?this.message.toggleClass(this.scoped("mod-hidden"),!a):this.swapClassesToggle(this.message,"SmartyInput__Message--visible","SmartyInput__Message--hidden",a)},togglePlusIconVisibility:function(a){this.options.mcFly?this.plusIcon.toggleClass(this.scoped("mod-hidden"),!a||!this.hasMultiSelections):this.plusIcon.attr("visibility",
a?"visible":"hidden")}})})(R9,jQuery);(function(e,f){e.publish("SmartyLogger",{loggingCategory:"Smarty",inputDefault:"destination",selectedIndex:"",subscribedLogSearchId:void 0,locationTypeIdLookupMap:{ap:"lmid",lm:"lmid",hotel:"hid",freereg:"frid",hood:"nhid",ctry:"cid"},_save:function(a){this.setStorage(a)},_log:function(a){a&&(this.logData(a,"origin"),this.logData(a,"destination"))},logData:function(a,c){var b=this;a=this.getLoggingObj(a,c);f.isEmptyObject(a)||e.Analytics.api.trackEvent(a,function(){b.cleanUpSmartyLogger(c)})},makeOptionsStr:function(a,
c){var b=this,d,f,k,g=[],l=!1;a.each(function(h){d=e.common.widgets.smarty.FlareSmarty.prototype.translateItem.call(this,a[h]);null==c||l||d.id!==c.id||d.type!==c.type||(b.selectedIndex=h+1,l=!0);f=d.id.split("/");1<f.length&&(d.idCode=f[1],d.apCode=f[0]);k="ap"===d.type?"airport":d.type;g.push("pos: "+(h+1));g.push("text: "+b.cleanString(d.short_str||d.str));g.push("locid: "+b.getBestItemId.call(b,d));g.push("loc_type: "+k)});return g.join("|")},getBestItemId:function(a){return a&&a.type?this.cleanString(a[this.locationTypeIdLookupMap[a.type]||
"id"]||a.id||""):""},getLoggingObj:function(a,c){var b=this.getStorage(c),d={};f.isEmptyObject(b)||(d={searchid:a,category:this.loggingCategory,params:{point:c}},b.hasOwnProperty("vertical")&&(d.params.vertical=b.vertical),b.hasOwnProperty("prefix")&&(d.params.prefix=b.prefix),b.hasOwnProperty("selected")&&(d.params.selected=b.selected),b.hasOwnProperty("options")&&(d.params.options=b.options));return d},setStorage:function(a){if(a&&e.storage.isAvailable()){var c=(a.inputType||this.inputDefault)+
"SmartyLogging",b=this.getStorageObj(a.inputType);a.hasOwnProperty("vertical")&&(b.vertical=a.vertical);a.hasOwnProperty("prefix")&&(b.prefix=this.cleanString(a.prefix));a.hasOwnProperty("options")&&(b.options=this.makeOptionsStr(a.options,a.selectedElem||null),b.selected=this.selectedIndex,this.selectedIndex="");e.storage.set(c,b)}},getStorageObj:function(a){a=(a||this.inputDefault)+"SmartyLogging";var c={};e.storage.isAvailable()&&(c=e.storage.get(a),f.isEmptyObject(c)&&(e.storage.set(a,{}),c=e.storage.get(a)));
return c},getStorage:function(a){var c={};e.storage.isAvailable()&&(c=e.storage.get(a+"SmartyLogging"));return c},cleanString:function(a){return"string"===typeof a?a.trim().replace(/&/g,"\\\x26"):""},cleanUpSmartyLogger:function(a){e.storage.remove(a+"SmartyLogging");this.selectedIndex=""},onLogSearchId:function(a){a&&this._log(a)}});e.SmartyLogger.subscribedLogSearchId||(e.SmartyLogger.subscribedLogSearchId=1,e.events.subscribe("smartylogger.log.searchId",f.proxy(e.SmartyLogger.onLogSearchId,e.SmartyLogger)))})(R9,
jQuery);(function(l){var m={},n=function(a,c){var b=JSON.stringify(a,Object.keys(a).sort());if(m.hasOwnProperty(b))m[b].callbacks.push(c);else{var d={key:b,callbacks:[c],request:l.ajax({type:"GET",dataType:"json",url:"/s/run/recentsearchhistory/gethistory",data:a,success:function(a){for(;d.callbacks.length;)d.callbacks.pop()(a)},complete:function(){delete m[b]}})};m[b]=d}};R9.extend("Common",{SmartyHistory:function(a){var c=a.historyType;c||(c="flight");var b=R9.Common.SmartyHistory.prototype["_"+c+"Instance"];
if(b)return b.init(),R9.Common.SmartyHistory.prototype["_"+c+"Instance"];this.options=l.extend({},this.options,a);this.init();R9.Common.SmartyHistory.prototype["_"+c+"Instance"]=this}});R9.extend("Common.SmartyHistory",{SmartyFlightHistory:function(a){return R9.Common.SmartyHistory.call(this,l.extend({historyType:"flight"},a))},SmartyHotelHistory:function(a){return R9.Common.SmartyHistory.call(this,l.extend({historyType:"hotel"},a))},SmartyCarHistory:function(a){return R9.Common.SmartyHistory.call(this,
l.extend({historyType:"car"},a))},SmartyClearHistory:function(){this.currentSmartyHistory&&(this.currentSmartyHistory.clearHistory(),this.currentSmarty.hideDropdown(),this.currentSmarty.runSearch(!1));R9.Analytics.api.trackEvent("smartyHistory/click/clearHistory")}});R9.extend("Common.SmartyHistory.prototype",{history:null,received:!1,options:{historyType:"flight",maxSearchHistory:30,searchHistorySubtype:"",showPastDates:R9.config.getBoolean("ui.smarty-history.showPastDates",!1)},init:function(){this.received&&
null!==this.history||setTimeout(this.update.bind(this),1)},update:function(){var a=this;n({searchType:a.options.historyType,maxSearchHistoryNum:a.options.maxSearchHistory,searchHistorySubtype:a.options.searchHistorySubtype},function(c){if(c)for(a.history=c,a.processPastDates(),a.received=!0,c=0;c<a.history.length;c++)a.history[c].idx=c})},clearHistory:function(){this.history=[];var a=this;l.ajax({type:"POST",url:"/s/run/recentsearchhistory/clearhistory",data:{searchType:a.options.historyType},success:function(c){a.history=
[];R9.Analytics.api.trackEvent({category:"Smarty-History",action:"clear-history"})}})},matchWord:function(a,c){var b=a.indexOf(c);0!==b&&(b=a.indexOf(" "+c),-1<b&&(b+=1));return b},processPastDates:function(){var a=[];if(null!==this.history){for(var c=0;c<this.history.length;c++){var b=this.history[c],d=b.startDate||b.checkinDate,e=b.endDate||b.checkoutDate;if(d&&e){var d=new moment(d),e=new moment(e),g=new moment;d.isBefore(g,"day")||e.isBefore(g,"day")?this.options.showPastDates&&(b.isPast=!0,a.push(b)):
a.push(b)}}this.history=a}}});R9.extend("Common.SmartyHistory.SmartyFlightHistory.prototype",!0,R9.Common.SmartyHistory.prototype,{filter:function(a,c,b,d,e){b=b||Infinity;var g=[];if(null===this.history)return[];var h=[];if(c||""===e)h=this.history;else for(var f=0;f<this.history.length;f++){var k=this.history[f];k.departCode===e&&h.push(k)}h=this.filterByRoundTrip(h,d);if(""===a)return h.slice(0,b);for(e=0;e<h.length&&!(f=h[e],k=f.departShortName+" "+f.departAirportName.toUpperCase(),c||(k=f.destShortName+
" "+f.destAirportName.toUpperCase()),-1<this.matchWord(k.toUpperCase(),a.toUpperCase())&&(g.push(f),g.length>=b));e++);return this.filterByRoundTrip(g,d).slice(0,b)},filterByRoundTrip:function(a,c){if(null===a)return[];if(R9.config.getBoolean("ui.flight.smarty-history.separateRTOW",!1)){for(var b=[],d=0;d<a.length;d++){var e=a[d];e.isRoundTrip===c&&b.push(e)}return b}return a}});R9.extend("Common.SmartyHistory.SmartyHotelHistory.prototype",!0,R9.Common.SmartyHistory.prototype,{filter:function(a,c){c=
c||Infinity;var b=[];if(null===this.history)return[];if(""===a)return this.history.slice(0,c);for(var d=0;d<this.history.length;d++){var e=this.history[d],g=e.location.toUpperCase();if(-1<this.matchWord(g,a)&&(b.push(e),b.length>=c))break}return b.slice(0,c)}});R9.extend("Common.SmartyHistory.SmartyCarHistory.prototype",!0,R9.Common.SmartyHistory.prototype,{filter:function(a,c,b,d){b=b||Infinity;var e=[];if(null===this.history)return[];var g=this.filterByOneWay(this.history,d);if(""===a)return g.slice(0,
b);for(var h=0;h<g.length;h++){var f=g[h],k=null===f.airportCode?f.location.toUpperCase():f.location.toUpperCase()+" "+f.airportCode;!c&&f.location2&&(k=null===f.airportCode2?f.location2.toUpperCase():f.location2.toUpperCase()+" "+f.airportCode2);if(-1<this.matchWord(k,a)&&(e.push(f),e.length>=b))break}return this.filterByOneWay(e,d).slice(0,b)},filterByOneWay:function(a,c){if(null===a)return[];for(var b=[],d=0;d<a.length;d++){var e=a[d];e.oneWay===c&&b.push(e)}return b}})})(jq||jQuery);(function(b){R9.extend("Common",{SmartyControlGroup:function(a){this.options=b.extend({},this.options,a);null===this.options.startFormat&&(this.options.startFormat=R9.Widgets.DaterangePicker.prototype.options.startFormat);null===this.options.endFormat&&(this.options.endFormat=R9.Widgets.DaterangePicker.prototype.options.endFormat);this.init()}});R9.extend("Common.SmartyControlGroup.prototype",{options:{form:"",smartyHistory:null,smartyTopDestinations:null,daterangePicker:"",startDate:"",endDate:"",
datePicker:"",startFormat:null,endFormat:null,useLegacyDatePicker:null},type:"flight",getHistory:function(){return this.options.smartyHistory&&this.options.smartyHistory()},getTopDestinations:function(){return this.options.smartyTopDestinations&&this.options.smartyTopDestinations()},getTime:function(a){return null==a?null:a.getTime()},validateDate:function(a){return null==a?null:this.datepicker().utils?this.datepicker().utils.validate(new Date(a)):this.options.datePicker&&this.options.datePicker.validateDate(a)?
new Date(a):null},datepicker:function(){return b(this.options.daterangePicker).data("datepicker")}});R9.extend("Common.SmartyControlGroup",{SmartyFlightControlGroup:function(a){R9.Common.SmartyControlGroup.call(this,a)},SmartyHotelControlGroup:function(a){R9.Common.SmartyControlGroup.call(this,a)},SmartyCarControlGroup:function(a){R9.Common.SmartyControlGroup.call(this,a)}});R9.extend("Common.SmartyControlGroup.SmartyFlightControlGroup.prototype",!0,R9.Common.SmartyControlGroup.prototype,{options:b.extend(R9.Common.SmartyControlGroup.prototype.options,
{form:null,formObject:null,originInput:"",destInput:"",originCode:"",destCode:"",daterangePicker:"",cabin:null,travelers:"",nearbyDeparture:"",nearbyArrival:"",smartyObject:"",maxHistory:5,state:null,isRoundTrip:null}),init:function(){this.type="flight"},setFieldsFromHistoryItem:function(a,c){a.isRoundTrip?(R9.events.publish("flights.search.form.display.change",{value:"roundtrip"}),R9.events.publish("flights.search.form.display.set","roundtrip")):(R9.events.publish("flights.search.form.display.change",
{value:"oneway"}),R9.events.publish("flights.search.form.display.set","oneway"));c&&!R9.config.getBoolean("ui.smarty.previewUpdatesForm.enabled",!1)||null==this.options.formObject||this.options.formObject.updateTravelDateState(this.validateDate(a.startDate),this.validateDate(a.endDate));this.options.useLegacyDatePicker?(this.datepicker().setStartDate(this.validateDate(a.startDate)),this.datepicker().setEndDate(this.validateDate(a.endDate))):(this.startDate().setDate(a.startDate),this.endDate().setDate(a.endDate));
b(this.options.nearbyDeparture).prop("checked",a.departureAllowNearby);b(this.options.nearbyArrival).prop("checked",a.arrivalAllowNearby);this.setTravelersFromHistoryItem(a);c?(b(this.options.originInput).val(a.departAirportName),b(this.options.destInput).val(a.destAirportName),b(this.options.originCode).val(a.departCode),b(this.options.destCode).val(a.destCode)):this.options.airportMultiSelectEnabled?(this.options.originField.resetAirportMultiSelect(),this.isMultiAirportOrigin(a)?this.options.originField.addAirportMultiSelections(this.getAirportMultiSelections(a.departAirportName)):
this.options.originField.addAirportMultiSelection(a.departCode,a.departAirportName,a.depSmartyDisplay),this.options.destField.resetAirportMultiSelect(),this.isMultiAirportDestination(a)?this.options.destField.addAirportMultiSelections(this.getAirportMultiSelections(a.destAirportName)):this.options.destField.addAirportMultiSelection(a.destCode,a.destAirportName,a.dstSmartyDisplay)):(c={type:"ap",id:a.departCode,short_str:a.departAirportName},this.options.originInput.getWidget().setItem(c),a={type:"ap",
id:a.destCode,short_str:a.destAirportName},this.options.destInput.getWidget().setItem(a))},saveFieldsToHistoryItem:function(){var a={};a.departAirportName=b(this.options.originInput).val();a.destAirportName=b(this.options.destInput).val();a.departCode=b(this.options.originCode).val();a.destCode=b(this.options.destCode).val();this.options.useLegacyDatePicker?(a.startDate=this.getTime(this.datepicker().getStartDate()),a.endDate=this.getTime(this.datepicker().getEndDate())):(a.startDate=this.startDate().getValue(),
a.endDate=this.endDate().getValue());a.departureAllowNearby=b(this.options.nearbyDeparture).prop("checked");a.arrivalAllowNearby=b(this.options.nearbyArrival).prop("checked");this.options.travelers&&b(".Common-Widgets-Number-NumberBox, .Common-Widgets-Number-StyleJamNumberBox",this.options.travelers.elementNode).each(function(){var c=b(this).getWidget(),e=b(this).attr("id").split("-").pop().toLowerCase();a[e]=c.getValue()});this.options.cabin&&(a.cabin=this.options.cabin.getValue());a.isRoundTrip=
"function"===typeof this.options.isRoundTrip?this.options.isRoundTrip():this.options.isRoundTrip;return a},isRoundTrip:function(){return"function"===typeof this.options.isRoundTrip?this.options.isRoundTrip():"checked"===b("#roundtrip").attr("checked")?!0:0<b(".roundtrip").length?!0:0<b(".inlineSearchAgainView").length&&"y"!==b('[name\x3d"oneway"]',".inlineSearchAgainView").val()?!0:!1},setTravelersFromHistoryItem:function(a){if(this.options.cabin){this.options.cabin.setButtonCheckedByValue(a.cabin);
var c=this.options.cabin.getCheckedPair();this.options.state.cabinDisplayType=c.title;this.options.state.cabin=c.value}this.options.travelers&&b(".Common-Widgets-Number-NumberBox, .Common-Widgets-Number-StyleJamNumberBox",this.options.travelers.elementNode).each(function(){var c=b(this).getWidget(),d=b(this).attr("id").split("-").pop().toLowerCase(),d=a[d];void 0!=c&&c.setValue(d)})},datepicker:function(){return this.options.daterangePicker},startDate:function(){return this.options.startDate},endDate:function(){return this.options.endDate},
setSmarty:function(a){this.options.smartyObject=a},getMaxHistory:function(){return this.options.maxHistory},isMultiAirportOrigin:function(a){return null===a.departCode&&3===a.departAirportName.indexOf(",")},isMultiAirportDestination:function(a){return null===a.destCode&&3===a.destAirportName.indexOf(",")},getAirportMultiSelections:function(a){var b=[];a.split(",").forEach(function(a){b.push({code:a,display:a,description:a})});return b},statusMessage:{adults:"{0} adult",seniors:"{0} senior",children:"{0} child",
traveler_count:"1#1 traveler|2#{0} travelers"}});R9.extend("Common.SmartyControlGroup.SmartyHotelControlGroup.prototype",!0,R9.Common.SmartyControlGroup.prototype,{options:b.extend(R9.Common.SmartyControlGroup.prototype.options,{form:null,locationInput:"",ctid:"",lmid:"",hid:"",nhid:"",rooms:"",adults:"",children:"",guests:"",minStars:"",priceRange:"",rating:"",smartyObject:"",maxHistory:5}),init:function(){this.type="hotel"},setSmarty:function(a){this.options.smartyObject=a},validateDate:function(a){return null==
a?null:this.options.daterangePicker.utils?this.options.daterangePicker.utils.validate(new Date(a)):this.options.datePicker?this.options.datePicker.validateDate(a):null},getMaxHistory:function(){return this.options.maxHistory},setFieldsFromHistoryItem:function(a,c){this.options.useLegacyDatePicker?(this.options.daterangePicker.setStartDate(this.validateDate(a.checkinDate)),this.options.daterangePicker.setEndDate(this.validateDate(a.checkoutDate))):(this.options.startDate.setDate(a.checkinDate),this.options.endDate.setDate(a.checkoutDate));
this.options.rooms&&this.options.rooms.setValue(a.rooms);this.options.adults&&this.options.adults.setValue(a.adults);this.options.children&&this.options.children.setValue(a.children);this.options.minStars&&b(this.options.minStars).val(a.minStars);this.options.rating&&b(this.options.rating).val(Math.floor(a.rating/10));c?(b(this.options.locationInput).val(a.location),b(this.options.ctid).val(a.ctid),b(this.options.lmid).val(a.lmid),b(this.options.hid).val(a.hid),b(this.options.nhid).val(a.nhid),b(this.options.frid).val(a.frid),
b(this.options.rid).val(a.rid),b(this.options.cid).val(a.cid)):(a={id:a.ctid,str:a.location,lmid:a.lmid,hid:a.hid,nhid:a.nhid,frid:a.frid,rid:a.rid,cid:a.cid},this.options.locationInput.getWidget().setItem(a))},saveFieldsToHistoryItem:function(){var a={};a.location=b(this.options.locationInput).val();a.ctid=b(this.options.ctid).val();a.lmid=b(this.options.lmid).val();a.hid=b(this.options.hid).val();a.nhid=b(this.options.nhid).val();a.frid=b(this.options.frid).val();a.rid=b(this.options.rid).val();
a.cid=b(this.options.cid).val();this.options.useLegacyDatePicker?(a.checkinDate=this.getTime(this.options.daterangePicker.getStartDate()),a.checkoutDate=this.getTime(this.options.daterangePicker.getEndDate())):(a.checkinDate=this.options.startDate.getValue(),a.checkoutDate=this.options.endDate.getValue());this.options.rooms&&(a.rooms=this.options.rooms.getValue());this.options.adults&&(a.adults=this.options.adults.getValue());this.options.children&&(a.children=this.options.children.getValue());this.options.minStars&&
(a.minStars=b(this.options.minStars).val());this.options.rating&&(a.rating=Math.floor(10*b(this.options.rating).val()));return a}});R9.extend("Common.SmartyControlGroup.SmartyCarControlGroup.prototype",!0,R9.Common.SmartyControlGroup.prototype,{options:{form:null,location:"",location2:"",ctid1:"",ctid2:"",datePicker:"",pickupDate:"",dropoffDate:"",locationSmarty:null,location2Smarty:null},init:function(){this.type="car"},setLocationSmarty:function(a){this.options.locationSmarty=a},setLocation2Smarty:function(a){this.options.location2Smarty=
a},getMaxHistory:function(){return this.options.maxHistory},datepicker:function(){return this.options.datePicker},validateDate:function(a){return null==a?null:this.options.datePicker?this.options.datePicker.validateDate(a):null},isOneWay:function(){return"function"===typeof this.options.isOneWay?this.options.isOneWay():"true"==b(".formType.active").attr("data-oneway")?!0:0<b(".inlineSearchAgainView").length&&"y"===b('[name\x3d"oneway"]',".inlineSearchAgainView").val()?!0:!1},setFieldsFromHistoryItem:function(a,
c){this.options.pickupDate.setDate(a.startDate);this.options.dropoffDate.setDate(a.endDate);this.options.pickupDate.setTime(a.pickupHour);this.options.dropoffDate.setTime(a.dropoffHour);c?(a.airportName?b(this.options.location).val(a.airportDisplayName):b(this.options.location).val(a.location),a.airportName2?b(this.options.location2).val(a.airportDisplayName2):b(this.options.location2).val(a.location2),b(this.options.ctid1).val(a.cityCode),b(this.options.ctid2).val(a.cityCode2)):(this.options.locationSmarty.setItem({id:a.cityCode,
str:a.airportDisplayName||a.location}),a={id:a.cityCode2,str:a.airportDisplayName2||a.location2},null!=this.options.location2Smarty&&null!=a&&null!=a.str&&this.options.location2Smarty.setItem(a))},saveFieldsToHistoryItem:function(){var a={};a.location=b(this.options.location).val();a.location2=b(this.options.location2).val();a.cityCode=b(this.options.ctid1).val();a.cityCode2=b(this.options.ctid2).val();a.startDate=this.options.pickupDate.getValue();a.endDate=this.options.dropoffDate.getValue();a.pickupHour=
this.options.pickupDate.getTime();a.dropoffHour=this.options.dropoffDate.getTime();return a}})})(jq||jQuery);(function(b){R9.extend("Widgets.Smarty",{Smarty:function(a,c){this.elementNode=a;this.element=b(this.elementNode);this.validateElement()&&(this.options=b.extend({},this.options,c),this.init())}});R9.extend("Widgets.Smarty.Smarty",{isInput:function(a){return a&&a.nodeName&&"input"==a.nodeName.toLowerCase()},isWidgetControlled:function(a){return b(a).hasClass(R9.Widgets.Smarty.Smarty.prototype.widgetBaseClass+"-input")},getDropdownEl:function(a){return jq(a).find("#smartbox")},getDropdownId:function(a){return"smartbox"}});
R9.extend("Widgets.Smarty.Smarty.prototype",{widgetName:"smarty",widgetBaseClass:"r9-smarty",elementNode:null,element:null,dropdown:null,lastValue:null,lastRequestedValue:null,aria:!1,trimInputElements:"span.nearbyHotels, span.nearbyRentals, span.showRank",lastClickOnScrollbar:!1,keyTimeout:null,isHighlightKeyPressed:!1,isItemSet:!1,backgroundAutocomplete:null,trackInteraction:!1,trackSetItemDuplicate:!1,trackSetItemDuplicateTimeout:void 0,initialList:null,options:{minLength:0,appendTo:"body",dropdown:null,
fixedDropdown:!1,initialData:null,initialDataLoadWithCallback:null,searchOnFocus:!1,showDropdownWhenEmpty:!1,dataSource:null,dataSourceList:[],dataType:"text",minWidth:10,maxWidth:1024,noAutoWidth:!1,position:"left",dropdownClass:null,setItem:null,beforeStart:null,afterDone:null,dropdownListSelector:"ul li[class!\x3d'separator']",keyDelay:200,forceSelection:!1,makeHTML:null,translateItem:null,display:"inline",showBackgroundAutocomplete:!1,backgroundAutocompleteMinLength:3,getBackgroundAutocompletePositionProps:null,
delayShowDropdown:null,showDropdownDelay:200,enableRemoteHide:!1,zIndex:9999,continents:[],showContinents:!1,onInputValueChange:function(a){},forceSelectionOfHighlightedItem:!0,trackingType:"destination",simplifiedValueChange:!1,e2eTestMode:!1,isDialog:!1,autoSelectFirstOption:!0,windowDataTestTagName:null,windowDataTestTagValue:null,onHighlightedOptionChange:function(a,c){}},init:function(){var a=this;R9.config&&(this.options.zIndex=R9.config.getInt("ui.smarty.zIndex",9999),this.trackInteraction=
R9.config.getBoolean("ui.smarty.trackInteraction",!0),this.aria=R9.config.getBoolean("ui.smarty.aria",!0));this.initDropdown();R9.globals.browserCapabilities.scrollbarRetainsInputFocus&&"false"!==R9.globals.browserCapabilities.scrollbarRetainsInputFocus||this.trackScrollbarClick();this.bindInputEvent("focus",this.handleInputFocusEvent);this.bindInputEvent("blur",this.handleInputBlurEvent);this.bindInputEvent("keydown",this.handleInputKeydownEvent);this.bindInputEvent("textchange",this.handleInputChangeEvent);
b(window).on("scroll.smarty",function(){a.position()});b(window).resize(this.handleWindowResize.bind(a));this.element.attr({autocomplete:"off",autocapitalize:"off",autocorrect:"off"});this.aria&&this.element.attr({role:"combobox","aria-autocomplete":this.options.showBackgroundAutocomplete?"both":"list"});this.element.data(this.widgetName,this);this.element.is(":focus")&&this.element.focus();this.initBackgroundAutocomplete()},unInit:function(){this.unbindInputEvent("focus");this.unbindInputEvent("blur");
this.unbindInputEvent("keydown");this.unbindInputEvent("textchange");b(window).off("scroll.smarty");this.dropdown.off("mousedown.trackScrollbarClick");jq("body").off("click.trackScrollbarClick")},initDropdown:function(){var a=R9.Widgets.Smarty.Smarty.getDropdownEl(this.element),c=R9.Widgets.Smarty.Smarty.getDropdownId(this.element),b=jq(a)[0];null==b&&(a=R9.Widgets.Smarty.Smarty.prototype.widgetBaseClass,this.options.dropdownClass&&(a=a+" "+this.options.dropdownClass),c={id:c,css:{display:"none",
position:"absolute",width:"auto",zIndex:1E4},role:"dialog",tabindex:"0"},this.options.e2eTestMode&&this.options.windowDataTestTagName&&(c[this.options.windowDataTestTagName]=this.options.windowDataTestTagValue||""),b=jq("\x3cdiv\x3e\x3c/div\x3e",c).appendTo(this.options.appendTo)[0],jq(b).addClass(a));this.dropdown=jq(b)},validateElement:function(){return R9.Widgets.Smarty.Smarty.isInput(this.elementNode)&&R9.Widgets.Smarty.Smarty.isWidgetControlled(this.element)},trackScrollbarClick:function(){var a=
this;a.dropdown.on("mousedown.trackScrollbarClick",function(c){a.lastClickOnScrollbar=!0;c.stopPropagation();jq("body").trigger("event",[c])});jq("body").on("click.trackScrollbarClick",function(c){R9.Common.Utils.Browsers.isIE()&&a.lastClickOnScrollbar&&(a.lastClickOnScrollbar=!1,a.element.blur());a.lastClickOnScrollbar=!1})},bindInputEvent:function(a,c){var b=this;a+="."+this.widgetName;this.element.off(a).on(a,function(a){return c.call(b,this,a)})},unbindInputEvent:function(a){a+="."+this.widgetName;
this.element.off(a)},bindDropdownEvent:function(a,c){var b=this;this.dropdown.off(a,this.options.dropdownListSelector).on(a,this.options.dropdownListSelector,function(a){c.call(b,this,a)})},handleInputKeydownEvent:function(a,c){this.focusEventHandled=!1;var d=c.keyCode?c.keyCode:c.which;switch(d){case 38:return this.highlitePrevItem(),!1;case 40:return this.highliteNextItem(),!1;case 27:return!this.hideDropdown();case 13:return this.selectHighlightedItemWhenSearchCompleted(d,this.isDropdownHidden()&&
!b(a).val()&&!b(a).data("val-close"));case 9:this.canItemBeActivatedByTab()&&this.options.forceSelectionOfHighlightedItem&&this.selectHighlitedItem(d);this.hideDropdown();break;default:this.handleKeydownBeforeAutocomplete(a,c),this.abortSearchCompletedEventListeners()}},isItAnywhereItem:function(){var a=this.getItemList(),c=this.getHighlitedItemIndex();return(a=a[c])?"anywhere"===a.getAttribute("data-short-name"):!1},canItemBeActivatedByTab:function(){var a=this.getItemList(),c=this.getHighlitedItemIndex();
return(a=b(a[c]))?!(a.hasClass("signupnow")||a.hasClass("signup")||a.hasClass("showHistory")||a.hasClass("js-not-selectable")||"anywhere"===a.attr("data-short-name")):!1},handleInputChangeEvent:function(a,c){if(this.options.simplifiedValueChange)this.onInputChange(),this.handleInputValue();else if(this.focusEventHandled)this.focusEventHandled=!1;else if(!R9.Common.Utils.Browsers.isIE(10)&&!R9.Common.Utils.Browsers.isIE(11)||this.element.is(":focus")){this.abortKeyTimeout();this.abortRequest();this.onInputChange();
var b=this;this.keyTimeout=setTimeout(function(){b.keyTimeout=null;b.handleInputValue()},this.options.keyDelay)}},onInputChange:function(){this.isItemSet=!1;if(!this.options.simplifiedValueChange){var a=this.getHighlitedItem();a&&!this.itemMatches(a,this.element.val())&&this.removeItemHighlight();"function"===typeof this.options.clearItem&&this.options.clearItem(this);try{this.element&&(jq(this.element).removeClass("smarty-complete").addClass("smarty-incomplete"),R9.events.publish("smarty.setitem.incomplete",
{id:this.element.attr("id")}))}catch(c){}}},handleInputValue:function(){var a=this.element.val();this.options.onInputValueChange(a);this.trackFirstLetter(a);this.element.length&&0<a.length?(this.options.simplifiedValueChange||this.abortRequest(),this.runSearch(!0)):this.options.showDropdownWhenEmpty?(this.abortRequest(),this.showInitialDropdown()):(this.dropdown[0].innerHTML="",this.hideDropdown())},trackFirstLetter:function(a){if(R9.VestigoEvents&&"none"!==this.options.trackingType&&1===a.length){a=
this.getActiveFormTrackingData();var c="destination"===this.options.trackingType?R9.VestigoType.LocationType.destination:R9.VestigoType.LocationType.origin,b=this.loadPrefilledItem();R9.VestigoEvents.smarty.input(c,b?b.name:this.initalValue||this.initialCode,b?b.type:"",a.id)}},loadPrefilledItem:function(){this.initialList||(this.initialList=this.getItemList());var a=this.initialList&&this.initialList[0];return a&&this.translateItem(a)},handleInputFocusEvent:function(a,c){jq(a).trigger("smartyfocus");
var b=this;if(!b.lastClickOnScrollbar){var e=function(){b.checkAlive()&&setTimeout(e,250)};setTimeout(e,250);this.onBeforeStart(c);this.focusEventHandled=!0;this.runSearchOnFocus()&&(0!=this.element.val().length||this.runNoQuerySearch()?this.runSearch(!!c):null!==this.options.initialDataLoadWithCallback?this.options.initialDataLoadWithCallback(function(a){b.showInitialDropdownForData(a)}):this.showInitialDropdown())}},runSearchOnFocus:function(){return this.options.searchOnFocus},runNoQuerySearch:function(){return this.options.searchNoQuery},
onBeforeStart:function(a){"function"===typeof this.options.beforeStart&&this.options.beforeStart(this,a)},handleInputBlurEvent:function(a,b){this.focusEventHandled=!1;var c=this;setTimeout(function(){if(c.lastClickOnScrollbar)R9.Common.Utils.Browsers.isIE()||(c.element.focus(),c.lastClickOnScrollbar=!1);else{c.stopInputProcessing();if(c.hideDropdown()&&c.options.forceSelection)c.onForceSelection();c.onAfterDone()}},10)},stopInputProcessing:function(){this.isUpdateInProgress()&&(this.abortKeyTimeout(),
this.abortRequest(),this.removeItemHighlight())},isUpdateInProgress:function(){return this.keyTimeout||this.request},onForceSelection:function(){if(!this.isItemSet&&""!==this.element.val()){var a=this.getHighlitedItem();a&&this.selectItem(a,null)}},onAfterDone:function(){this.options.simplifiedValueChange&&!this.isItemSet&&this.options.clearItem&&this.options.clearItem(this);"function"===typeof this.options.afterDone&&this.options.afterDone(this)},handleItemMouseoverEvent:function(a,c){this.getItemList().removeClass("selected");
jq(a).not(".js-not-selectable").addClass("selected")},handleItemMouseoutEvent:function(a,c){jq(a).removeClass("selected")},handleItemMousedownEvent:function(a,c){c.stopPropagation();jq("body").trigger("event",[c]);this.selectItem(a,null);this.hideDropdown()},selectHighlitedItem:function(a,c){var b=this.getItemList();b?(c=this.getHighlitedItemIndex(c&&13===a),0>c?13===a&&this.noItemToSelect():(b=b[c])&&this.selectItem(b,a)):13===a&&this.noItemToSelect()},selectHighlightedItemWhenSearchCompleted:function(a,
c){var b=this;if(this.isItemSet&&!this.isHighlightKeyPressed){if(this.isDropdownHidden()&&13===a)return!0;this.hideDropdown();return!1}this.selectHighlitedItem(a,c);this.hideDropdown(!this.isItemSet);if(this.isItemSet)return!1;this.element.one("searchCompleted",function(){b.selectHighlitedItem(a,c);b.hideDropdown()});return!1},noItemToSelect:function(){},selectItem:function(a,b){a=this.translateItem(a);this.setItem(a,b)},translateItem:function(a){return"function"===typeof this.options.translateItem?
this.options.translateItem(a):a},setItem:function(a,b){if(this.element)try{jq(this.element).toggleClass("smarty-complete",!!a).toggleClass("smarty-incomplete",!a),R9.events.publish(a?"smarty.setitem.complete":"smarty.setitem.incomplete",{id:this.element.attr("id")}),a&&this.trackInteraction&&this.trackSetItem(a)}catch(d){}"function"===typeof this.options.setItem?(this.isItemSet=!0,this.options.setItem(this,a,b)):a?(this.isItemSet=!0,this.element.val(jq(a).text())):(this.isItemSet=!1,this.element.val(""))},
trackSetItem:function(a){if(R9.VestigoEvents&&"none"!==this.options.trackingType){var b=this;if(this.trackSetItemDuplicate)clearTimeout(this.trackSetItemDuplicateTimeout),this.trackSetItemDuplicateTimeout=setTimeout(function(){b.trackSetItemDuplicate=!1},200);else{this.trackSetItemDuplicate=!0;this.trackSetItemDuplicateTimeout=setTimeout(function(){b.trackSetItemDuplicate=!1},200);var d=this.getHighlitedItemIndex(),e=void 0;"hotel"===a.type?e=a.hid:"rest"===a.type?e=a.rtid:"freereg"===a.type?e=a.frid:
"reg"===a.type?e=a.rid:"ctry"===a.type?e=a.cid:"ctgroup"===a.type?e=a.cgid:"hood"===a.type?e=a.nhid:"lm"===a.type&&(e=a.lmid);"addr"===a.type?e=void 0:void 0===e&&(e=a.apicode||a.id);this.element.attr("id");var f=this.element.val(),d=-1<d?d+1:d;a=this.isItAnywhereItem()?"anywhere":a.type;var g=!!this.isNearbyChecked,h=this.getActiveFormTrackingData();"destination"===this.options.trackingType?R9.VestigoEvents.smarty.destination(f,d,a,e,g,h.id,h.type):R9.VestigoEvents.smarty.origin(f,d,a,e,g,h.id,h.type)}}},
showInitialDropdown:function(){this.showInitialDropdownForData(this.onInitialData())},showInitialDropdownForData:function(a){a&&this.searchCompleted(a,!1)},onInitialData:function(){return"function"===typeof this.options.initialData?this.options.initialData(this):this.options.initialData},runSearch:function(a){var b=this.element.val(),d=this.options.simplifiedValueChange?this.lastRequestedValue===b:this.lastValue===b;if(!(b.length<this.options.minLength||d)){d=this.getRequestData();d=this.preprocessRequest(d);
this.options.e2eTestMode&&this.element.attr("data-request-pending","");this.options.simplifiedValueChange&&(this.lastRequestedValue=b,this.abortRequest());var e=this,f=function(c){e.request=null;e.lastValue=b;c=e.postprocessResponse(c,a);e.searchCompleted(c,a);e.options.e2eTestMode&&e.element.removeAttr("data-request-pending")};if("function"===typeof this.options.dataSource)this.options.dataSource(d,f,this,a);else if(R9.config.getBoolean("ui.common.smarty.get.enabled",!1)){var g=this.getDataSource();
d.cv=R9.config.getString("ui.common.smarty.get.version","1");this.request=jq.ajax({type:"GET",url:g,data:d,dataType:this.options.dataType,cache:!0,success:f,error:function(){e.lastRequestedValue=null}})}else this.request=jq.post(this.getDataSource(),d,f,this.options.dataType)}},getDataSource:function(){return this.options.dataSource},preprocessRequest:function(a){return a},getRequestData:function(){return{value:this.element.val(),formtoken:R9.globals.formtoken}},searchCompleted:function(a,b){(a=this.canShowDropdown(a))?
this.showDropdown(a,b):(this.dropdown[0].innerHTML="",this.hideDropdown());this.element.trigger("searchCompleted",!!a)},canShowDropdown:function(a){return a},abortSearchCompletedEventListeners:function(){this.element.off("searchCompleted")},postprocessResponse:function(a,b){return a},makeHTML:function(a){return"function"===typeof this.options.makeHTML?this.options.makeHTML(a):a},showDropdown:function(a,b){if("function"===typeof this.options.delayShowDropdown&&this.options.delayShowDropdown()&&!this.showDropdownTimeout)this.showDropdownTimeout=
setTimeout(this.showDropdown.bind(this,a,b),this.options.showDropdownDelay);else{null!==this.showDropdownTimeout&&(clearTimeout(this.showDropdownTimeout),this.showDropdownTimeout=null);b=this.dropdown[0].style;var c=this.makeHTML(a);this.dropdown[0].innerHTML=c;c=R9.Widgets.Smarty.Smarty.prototype.widgetBaseClass;this.options.dropdownClass&&(c=c+" "+this.options.dropdownClass);this.dropdown.attr("class",c);a.length?this.dropdown.removeClass("empty"):this.dropdown.addClass("empty");this.position();
this.aria&&(this.element.attr({"aria-expanded":!0}),this.dropdown.find("ul").attr("role","listbox"),this.dropdown.find("li").not(".js-not-option").attr("role","option"));b.visibility="visible";b.display=this.options.display;jq.fn.zIndex&&(b.zIndex=jq(this.element).zIndex()+this.options.zIndex);this.bindDropdownEvent("mousedown",this.handleItemMousedownEvent);this.bindDropdownEvent("mouseover",this.handleItemMouseoverEvent);this.bindDropdownEvent("mouseout",this.handleItemMouseoutEvent);this.removeItemHighlight();
""!==this.element.val()&&this.highlightFirstSelectableItem()}},position:function(){this.dropdown.removeClass("up");var a=this.dropdown[0].style,b=0;this.dropdown.parent()[0]===jq(document.body)[0]&&(b=parseInt((jq(document.body).css("top")||"0").replace("-",""))||0);this.dropdown.css("width","auto");var d=this.dropdown.outerWidth(!0),e=!1;this.options.minWidth&&d<=this.options.minWidth&&(d=Math.max(this.options.minWidth,d),e=!0);this.options.maxWidth&&d>=this.options.maxWidth&&(d=Math.min(this.options.maxWidth,
d),e=!0);a.width=e||this.options.noAutoWidth?d+"px":"auto";var e=this.element.offset(),f=jq(this.options.appendTo).offset(),g=e.left-f.left;"right"===this.options.position&&(g+=this.element.width()-d-2);a.left=g+"px";a.top=b+e.top+this.element.outerHeight()-f.top+"px"},isDropdownHidden:function(){return"none"==this.dropdown.css("display")||"hidden"==this.dropdown.css("visibility")},hideDropdown:function(a){a||(this.abortKeyTimeout(),this.abortRequest());this.isHighlightKeyPressed=!1;this.lastRequestedValue=
this.lastValue=null;if(this.isDropdownHidden()&&!this.options.isDialog)return!1;this.dropdown.hide();this.aria&&this.element.attr({"aria-expanded":!1});this.setBackgroundAutocomplete();return!0},abortRequest:function(){if(this.request){try{this.request.abort()}catch(a){}this.request=null}},abortKeyTimeout:function(){this.keyTimeout&&(clearTimeout(this.keyTimeout),this.keyTimeout=null)},highliteNextItem:function(){var a=this.getItemList(),b=nsel=this.getHighlitedItemIndex();-1==b?nsel=0:b<a.length-
1&&(nsel=b+1);b!=nsel&&(jq(a[b]).removeClass("selected"),jq(a[b]).trigger("mouseout"),jq(a[nsel]).addClass("selected"),jq(a[nsel]).trigger("mouseover"),this.isHighlightKeyPressed=!0,this.setBackgroundAutocomplete(a[nsel]),this.options.onHighlightedOptionChange(jq(a[nsel]),jq(a[b])))},highlitePrevItem:function(){var a=this.getItemList(),b=nsel=this.getHighlitedItemIndex();-1==b?nsel=0:0<b&&(nsel=b-1);b!=nsel&&(jq(a[b]).removeClass("selected"),jq(a[b]).trigger("mouseout"),jq(a[nsel]).addClass("selected"),
jq(a[nsel]).trigger("mouseover"),this.isHighlightKeyPressed=!0,this.setBackgroundAutocomplete(a[nsel]),this.options.onHighlightedOptionChange(jq(a[nsel]),jq(a[b])))},highlightFirstSelectableItem:function(){for(var a=this.getItemList(),b=0;b<a.length;b++){var d=jq(a[b]);if(!(d.hasClass("hist")||d.hasClass("js-not-selectable")||d.hasClass("js-nearby-select-all"))){d.addClass("selected");this.setBackgroundAutocomplete(a[b]);return}}jq(a[0]).addClass("selected");this.setBackgroundAutocomplete(a[0])},
removeItemHighlight:function(){jq(this.getItemList()).removeClass("selected")},getHighlitedItemIndex:function(a){for(var b=this.getItemList(),d=b.length,e=0;e<d;e++)if(jq(b[e]).hasClass("selected"))return e;return!a&&R9.config.getBoolean("ui.smarty.auto.select.1st",!1)&&this.options.autoSelectFirstOption&&0<d?0:-1},getHighlitedItem:function(){for(var a=this.getItemList(),b=a.length,d=0;d<b;d++)if(jq(a[d]).hasClass("selected"))return a[d];return R9.config.getBoolean("ui.smarty.auto.select.1st",!1)&&
0<b?a[0]:null},getItemList:function(){return this.dropdown.find(this.options.dropdownListSelector)},itemMatches:function(a,b){return a?0<=jq(a).text().toLowerCase().indexOf(b.toLowerCase()):!1},checkAlive:function(){return this.element.closest("html").length?this.element.is(":visible")?!0:(this.hideDropdown(),!1):(this.hideDropdown(),this.unInit(),!1)},initBackgroundAutocomplete:function(){!this.backgroundAutocomplete&&this.options.showBackgroundAutocomplete&&(this.options.backgroundAutocompleteMinLength=
R9.config.getInt("ui.common.smarty.background.autocomplete.min.length",3),this.backgroundAutocomplete=jq("\x3cinput/\x3e",{id:this.element.attr("id")+"-bg-autocomplete","class":this.element.attr("class"),type:"text",tabindex:"-1"}).insertBefore(this.element),this.updateBackgroundAutocompletePosition(),this.backgroundAutocomplete.css("color",this.element.css("color").replace(")",", 0.27)").replace("rgb","rgba")),this.backgroundAutocomplete.addClass("smarty-bg-autocomplete"),this.element.addClass("smarty-with-bg-autocomplete"))},
updateBackgroundAutocompletePosition:function(){if(this.options.showBackgroundAutocomplete)if("function"===typeof this.options.getBackgroundAutocompletePositionProps)this.backgroundAutocomplete.css(this.options.getBackgroundAutocompletePositionProps());else{var a=this.element.is(":visible")?this.element.outerHeight():this.element.height();this.backgroundAutocomplete.css({"margin-bottom":"-"+a+"px"})}},handleKeydownBeforeAutocomplete:function(a,b){if(this.options.showBackgroundAutocomplete){var c=
this;setTimeout(function(){var a=c.backgroundAutocomplete.val(),b=c.element.val();b.length>=c.options.backgroundAutocompleteMinLength&&b.length<a.length&&!c.isDropdownHidden()?c.backgroundAutocomplete.val(b+a.substr(b.length)):c.backgroundAutocomplete.val("")},1)}},setBackgroundAutocomplete:function(a){if(this.options.showBackgroundAutocomplete){var b=this.element.val();if(a&&b.length>=this.options.backgroundAutocompleteMinLength){var d=this.getBackgroundAutocompleteText(a);if(0<d.length){a=d.toUpperCase().indexOf(b.toUpperCase());
this.backgroundAutocomplete.val(-1===a?"":b+d.substr(a+b.length));return}}this.backgroundAutocomplete.val("")}this.aria&&a&&a.attributes.id&&(b=jq(a).find(this.trimInputElements).filter(function(){return jq(this).is(":visible")}),0<b.length&&(d=jq(a).clone(),d.find(this.trimInputElements).remove(),jq(a).attr("aria-label",d.text()+" "+b.text())),this.element.attr({"aria-activedescendant":a.attributes.id.value}))},getBackgroundAutocompleteText:function(a){a=this.translateItem(a);return"string"===typeof a.str?
a.str:""},handleWindowResize:function(){this.updateBackgroundAutocompletePosition()},getActiveFormTrackingData:function(){if(R9&&R9.question&&R9.VestigoType){var a=R9.question.ask("base.search.SearchForm.id")||"";return{id:a,type:a?R9.VestigoType.SearchFormType[R9.question.ask("base.search.SearchForm.type."+a)]:""}}return{}}})})(jq||jQuery);R9.extend("Widgets.Smarty",{FlareSmarty:function(b,a){R9.Widgets.Smarty.Smarty.call(this,b,jq.extend({dataSource:"/mv/marvel"},a));var c=this;jq(".mapViewOuter .filterWrapper").scroll(function(){R9.Widgets.Smarty.Smarty.prototype.handleInputBlurEvent.call(c)})}});
R9.extend("Widgets.Smarty.FlareSmarty",!0,{setRunSearchNextFocus:function(b){R9.Widgets.Smarty.FlareSmarty.runSearchNextFocus=b},runSearchNextFocus:!0});
R9.extend("Widgets.Smarty.FlareSmarty.prototype",!0,R9.Widgets.Smarty.Smarty.prototype,{translateItem:function(b){if(!b)return null;var a=jq(b).clone()[0];b=a.id.split("-");var c="";1<b.length&&0>b[1].indexOf(" ")&&(c=b[1]);jq(a).find("span.airportCode, span.region-label, span.nearbyHotels, span.nearbyRentals, span.smarty-emoji, span.smarty-label, span.smarty-popular, span.smarty-city-popular, span.smarty-air-popular, span.showRank").remove();var d=jq(a).attr("data-text-to-select"),d=d&&0<jq.trim(d).length?
d:jq(a).text(),c={type:b[0],id:c,str:d,name:d,short_str:jq(a).attr("data-short-name"),cc:jq(a).attr("data-cc")||"",apicode:a.getAttribute("data-apicode")};c.apicode&&"a"===c.apicode.slice(-1)&&(c.iatadisplay=a.getAttribute("data-iatadisplay"));"isl"===c.type&&1<b.length&&(d=b[1].split("/"),c.str=d[0]);"addr"===c.type&&(a=a.getAttribute("data-ctid"))&&(c.id=a);2<b.length&&(c.hc=b[2]);3<b.length&&("hotel"===c.type?c.hid=b[3]:"rest"===c.type?c.rtid=b[3]:"freereg"===c.type?c.frid=b[3]:"reg"===c.type?
c.rid=b[3]:"ctry"===c.type?c.cid=b[3]:"ctgroup"===c.type?c.cgid=b[3]:"hood"===c.type?c.nhid=b[3]:c.lmid=b[3]);return c},preprocessRequest:function(b){var a={};this.options.extendRequest&&(a="function"===typeof this.options.extendRequest?this.options.extendRequest(this,b):this.options.extendRequest);var c={};this.options.v&&(c.v=this.options.v);c.f="h";this.options.f&&(c.f=this.options.f);c.where=b.value;c.s=this.getFlareSmartyType()||-1;c.lc_cc=R9.globals.locale.lc_cc;c.lc=R9.globals.locale.lc;return jq.extend(c,
a)},runSearchOnFocus:function(){var b=R9.Widgets.Smarty.FlareSmarty.runSearchNextFocus;R9.Widgets.Smarty.FlareSmarty.runSearchNextFocus=!0;return R9.Widgets.Smarty.Smarty.prototype.runSearchOnFocus.call(this)&&b},onInitialData:function(){var b=this.generateTopDestinations()||R9.Widgets.Smarty.Smarty.prototype.onInitialData.call(this)||this.makeRecentList(null,!0),a=this.generateAnywhereMarkup(),c=this.generateContinentsMarkup(),d;if(b)return d=this.generateLoginBar(b||a),this.placeAnywhereMarkup(b,
(a?a:"")+d);b=[];this.appendToInitialData(b);d=0<b.length;d=this.generateLoginBar(a||d);a&&b.push(a);c&&b.push(c);this.options.smartyControlGroup&&R9.globals.canLogin&&"undefined"!==typeof d&&b.push(d);return b.length?"\x3cul\x3e"+b.join("")+"\x3c/ul\x3e":""},appendToInitialData:function(b){},generateTopDestinations:function(){if(this.options.smartyControlGroup){var b=this.options.smartyControlGroup.getTopDestinations();if(b){var a=b.getItems(),c=b.getMaxItems();return(b=a&&a.filter(function(a,b){return b<
c}).map(this.createTopDestinationItem.bind(this)).join(""))&&""!==b?"\x3cul\x3e"+b+"\x3c/ul\x3e":null}}},createTopDestinationItem:function(b){return""},generateAnywhereMarkup:function(b){},generateContinentsMarkup:function(){},placeAnywhereMarkup:function(b,a){return b?R9.config.getBoolean("ui.smarty.anywhereFirst",!1)?b.replace("\x3cul\x3e","\x3cul\x3e"+a):b.replace("\x3c/ul\x3e",a+"\x3c/ul\x3e"):b},placeContinentsMarkup:function(b,a){return b?b.replace("\x3c/ul\x3e",a+"\x3c/ul\x3e"):b},postprocessResponse:function(b,
a){var c=b&&/<li/i.test(b),d=this.makeRecentList(a?this.element.val().toUpperCase():null,!c),e=this.generateOtherMarkup(c);a=this.generateAnywhereMarkup(c);var f=this.generateContinentsMarkup();if(!d&&!c&&!a)return null;if(!c)return b=d?d:"\x3cul\x3e\x3c/ul\x3e",b=e?b.replace("\x3c/ul\x3e",e+"\x3c/ul\x3e"):b,b=this.placeAnywhereMarkup(b,a?a:""),b=this.placeContinentsMarkup(b,f),b+this.generateLoginBar(!1);b=e?b.replace("\x3c/ul\x3e",e+"\x3c/ul\x3e"):b;b=this.placeAnywhereMarkup(b,a?a:"");d&&(b=b.replace("\x3c/ul\x3e",
d+"\x3c/ul\x3e"));return b.replace("\x3c/ul\x3e",this.generateLoginBar(!0)+"\x3c/ul\x3e")},generateOtherMarkup:function(b){return null},selectItem:function(b,a){jq(b).hasClass("hist")&&this.options.smartyControlGroup?(b=jq(b).data("history-idx"),b=this.options.smartyControlGroup.getHistory().history[b],this.options.smartyControlGroup.setFieldsFromHistoryItem(b,!1),"undefined"!==typeof this.tempState&&delete this.tempState,R9.Analytics.api.trackEvent("smartyHistory/click/historyItem"),this.trackRecentLocation(b)):
jq(b).hasClass("showHistory")?(window.location.assign("/history"),R9.Analytics.api.trackEvent("smartyHistory/click/seeAllHistory")):jq(b).hasClass("signup")?(AjaxReg.ui.register({promoType:"smarty"}),R9.Analytics.api.trackEvent("smartyHistory/click/signUp")):jq(b).hasClass("signupnow")?(R9.config.getBoolean("ui.login.staticSignUp")?R9.authentication.showDefault({promoType:"smarty"}):R9.authentication.showSignup(),R9.Analytics.api.trackEvent("smartyHistory/click/signUp"),R9.events.publish("smarty.setitem.complete",
{id:this.element.attr("id")})):(b=this.translateItem(b),this.setItem(b,a))},trackRecentLocation:function(b){if(this.trackInteraction&&R9.Vestigo&&R9.VestigoType&&b){var a=R9.question.ask("base.search.SearchForm.id")||"",c=b.isRoundTrip?R9.VestigoType.SearchFormType.RT:R9.VestigoType.SearchFormType.OW;b.dstSearchFormPrimary&&R9.VestigoEvents.smarty.destination(b.dstSearchFormPrimary,"","ap",b.destShortName,b.arrivalAllowNearby,a,c,"recentsearches");b.depSearchFormPrimary&&R9.VestigoEvents.smarty.origin(b.depSearchFormPrimary,
"","ap",b.departShortName,b.departureAllowNearby,a,c,"recentsearches")}},makeRecentList:function(b,a){var c=this.options.recentList,d=null;if(c&&0<c.length){for(var d="",e=0;e<c.length;e++)if(!b||-1!=c[e].display.toUpperCase().indexOf(b)){var f=c[e].display;b&&(f=this.highliteText(f,b));d+="\x3cli id\x3d'"+c[e].code+"' class\x3d'"+c[e].className+"' data-short-name\x3d'"+c[e].shortName+"'\x3e"+f+"\x3c/li\x3e"}d=""!=d?(a?"\x3cul\x3e":"")+"\x3cli class\x3d'separator'\x3e\x3cb\x3eRecently searched:\x3c/b\x3e\x3c/li\x3e"+
d+(a?"\x3c/ul\x3e":""):null}return d},highliteText:function(b,a){a&&(a=a.replace(/[-[\]{}()*+?.,\\^$|#\s]/g,"\\$\x26"),b=b.replace(new RegExp("("+a+")","ig"),"\x3cb\x3e$1\x3c/b\x3e"));return b},getFlareSmartyType:function(){return this.options.flareSmartyType},setFlareSmartyType:function(b){this.options.flareSmartyType=b},matchAndBold:function(b,a,c,d){if(!b||!a)return a;c=c||"\x3cb\x3e";d=d||"\x3c/b\x3e";var e=0,f=0,g="",h=a,k=b.length;for(b=b.toUpperCase();;){if(0!==e||0!==(f=a.toUpperCase().indexOf(b,
e)))if(-1<(f=a.toUpperCase().indexOf(" "+b,e)))f++;else break;e=a.substring(e,f);h=a.substring(f,f+k);g+=e+c+h+d;h=a.substring(f+k,a.length);e=f+k}return g+h},handleItemMouseoverEvent:function(b,a){this.getItemList().removeClass("selected");jq(b).addClass("selected");!this.isDisabledHistoryPreview()&&jq(b).hasClass("hist")&&this.options.smartyControlGroup&&"undefined"===typeof this.tempState&&(this.tempState=this.options.smartyControlGroup.saveFieldsToHistoryItem(),b=jq(b).data("history-idx"),a=this.options.smartyControlGroup.getHistory(),
this.options.smartyControlGroup.setFieldsFromHistoryItem(a.history[b],!0))},handleItemMouseoutEvent:function(b,a){jq(b).removeClass("selected");this.isDisabledHistoryPreview()||"undefined"===typeof this.tempState||(this.options.smartyControlGroup.setFieldsFromHistoryItem(this.tempState,!0),delete this.tempState)},isDisabledHistoryPreview:function(){return!1},generateLoginBar:function(b){if(!this.options.smartyControlGroup||!R9.globals.canLogin)return"";var a="admin";b&&(a+=" addSeparation");return"undefined"!==
typeof R9Anon&&R9Anon?"\x3cli class\x3d'signup "+a+"'\x3eSign up to access recent searches anywhere\x3c/li\x3e":"\x3cli class\x3d'showHistory "+a+"'\x3e See all search history\x3c/li\x3e"},generateRecentHeader:function(){R9.Common.SmartyHistory.currentSmarty=this;R9.Common.SmartyHistory.currentSmartyHistory=this.options.smartyControlGroup.getHistory();this.hasClearRecentEvent||(this.hasClearRecentEvent=!0,this.dropdown.on("click","ul li.searchHistorySeparator",function(b){b.stopPropagation();b.stopImmediatePropagation()}),
this.dropdown.on("mousedown","ul li .clearRecent",function(b){b.stopPropagation();jq("body").trigger("event",[b]);R9.Common.SmartyHistory.SmartyClearHistory()}));return"\x3cli class\x3d'separator searchHistorySeparator'\x3e\x3cspan class\x3d'separatorLabel'\x3eRecent Searches\x3c/span\x3e\x3ca class\x3d'clearRecent'\x3eclear\x3c/a\x3e\x3c/li\x3e"}});
(function(b,a){b.createWidgetClass("smarty.SmartyBaseLoader",a.extend({},b.Widgets.Smarty.Smarty.prototype));b.createWidgetClass("smarty.FlareSmartyBaseLoader","common.widgets.smarty.Smarty",a.extend({},b.Widgets.Smarty.FlareSmarty.prototype,{constructor:function(c,d){this.base(c,a.extend({},b.Widgets.Smarty.FlareSmarty.prototype.options,d))}}))})(window.R9,window.jq||window.jQuery);(function(e,f){e.createWidgetClass("smarty.Smarty","common.widgets.smarty.SmartyBaseLoader",{loggingPrefix:"smarty",setItemTriggered:!1,focusEventHandled:!1,updateDropdownTop:!0,options:{flippable:!0,direction:"down",repositionDropdownOnResize:e.config.getBoolean("ui.smarty.repositionDropdownOnResize",!0),alternateSmartyInputElement:null,mcFlyInline:!1,messages:{SMARTY_HOTELS_NEAR_CITY:"",SMARTY_RENTALS_NEAR_CITY:"",SMARTY_LOCATION_TYPE_HOTEL:"",SMARTY_LOCATION_TYPE_AIRPORT:"",SMARTY_LOCATION_TYPE_NEIGHBORHOOD:"",
SMARTY_LOCATION_TYPE_CITY:"",SMARTY_LOCATION_TYPE_LANDMARK:"",SMARTY_LOCATION_TYPE_COUNTRY:"",SMARTY_LOCATION_TYPE_COUNTRY_GROUP:"",SMARTY_LOCATION_TYPE_REGION:"",SMARTY_LOCATION_TYPE_FREE_REGION:"",SMARTY_LOCATION_TYPE_RAIL:"",SMARTY_LOCATION_TYPE_RESTAURANT:"",SMARTY_LOCATION_TYPE_AIRLINE:"",SMARTY_LOCATION_TYPE_BRAND:"",SMARTY_LOCATION_TYPE_BRAND_GROUP:"",SMARTY_LOCATION_TYPE_AIRPORT_NEAR_CITY:"",SMARTY_LOCATION_TYPE_PLACE:"",SMARTY_LOCATION_TYPE_POI:"",SMARTY_LOCATION_TYPE_WORLD:"",SMARTY_CONTINENTS_LABEL:"",
SMARTY_NEARBY_DISTANCE_FROM:"",SMARTY_NEARBY_DISPLAY:"",SMARTY_NO_RECENT_SEARCHES:""}},locationTypeMessages:{},constructor:function(a,b){this.base(a,b);this.applyJsonOptions();this.locationTypeMessages={ap:this.options.messages.SMARTY_LOCATION_TYPE_AIRPORT,hood:this.options.messages.SMARTY_LOCATION_TYPE_NEIGHBORHOOD,lm:this.options.messages.SMARTY_LOCATION_TYPE_LANDMARK,ctry:this.options.messages.SMARTY_LOCATION_TYPE_COUNTRY,cg:this.options.messages.SMARTY_LOCATION_TYPE_REGION,ctgroup:this.options.messages.SMARTY_LOCATION_TYPE_REGION,
reg:this.options.messages.SMARTY_LOCATION_TYPE_REGION,subreg:this.options.messages.SMARTY_LOCATION_TYPE_REGION,freereg:this.options.messages.SMARTY_LOCATION_TYPE_FREE_REGION,city:this.options.messages.SMARTY_LOCATION_TYPE_CITY,hotel:this.options.messages.SMARTY_LOCATION_TYPE_HOTEL,rail:this.options.messages.SMARTY_LOCATION_TYPE_RAIL,rest:this.options.messages.SMARTY_LOCATION_TYPE_RESTAURANT,addr:this.options.messages.SMARTY_LOCATION_TYPE_PLACE}},init:function(){this.options.zIndex=e.config.getInt("ui.smarty.zIndex",
9999);this.options.simplifiedValueChange=e.config.getBoolean("ui.smarty.simplifiedValueChange",!0);this.options.e2eTestMode=e.globals.testMode;this.aria=e.config.getBoolean("ui.smarty.aria",!0);this.trackInteraction=e.config.getBoolean("ui.smarty.trackInteraction",!0);this.dropdown=this.options.dropdown;this.initSmartyDropdown();this.element.attr("smarty",!0);!0===this.options.enableRemoteHide&&this.id()&&e.events.subscribe("Smarty.hide",f.proxy(this.hideSmartyById,this));this.subscribe("Smarty.change.style",
this.changeSmartyStyle.bind(this))},changeSmartyStyle:function(a){var b=this.dropdown[0].id;b.includes(a.id)&&(this.updateDropdownTop=a.updateDropdownTop,b.includes("origin")?this.dropdown.css(a.originCss):b.includes("destination")?this.dropdown.css(a.destinationCss):b.includes("location")&&this.dropdown.css(a.locationCss))},hideSmartyById:function(a){this.id()!==a&&this.hideDropdown(!1)},inlineComponentsReady:function(){var a=this;setTimeout(function(){a.element.attr({autocomplete:"off",autocapitalize:"off",
autocorrect:"off"});a.aria&&a.element.attr({role:"combobox","aria-autocomplete":a.options.showBackgroundAutocomplete?"both":"list"});a.element.is(":focus")?a.element.focus():a.element.attr("autofocus")&&a.element.focus();a.options.showBackgroundAutocomplete&&(a.options.getBackgroundAutocompletePositionProps=function(){return{"margin-bottom":"-"+a.element.outerHeight(!0)+"px"}});a.initBackgroundAutocomplete();a.initialVal=a.element.val();a.initialCode=a.element.next(".aircode").val();""!==a.initialVal&&
(a.isItemSet=!0)},1)},concatExtraDropdownClasses:function(a,b){if(f.isArray(a)&&b)for(var c=0;c<a.length;c++)a[c]&&a[c].dropdownClass&&(a[c].dropdownClass+=b)},extraIconClasses:function(a){return a?" "+e.config.getString("ui.smarty.iconClasses","greyIcons")+" ":""},extraLabelClasses:function(){return e.config.getBoolean("ui.smarty.labels",!1)&&this.options.extendRequest&&"v2"===this.options.extendRequest.v?e.config.getString("ui.smarty.labelsClasses","greyLabels"):""},addEventHandlers:function(){this.bindInputEvent("keydown",
this.handleInputKeydownEvent);this.addDelegateEventHandlers()},addDelegateEventHandlers:e.Common.Utils.limit(1,function(){this.bindDelegateInputEvent("focus",this.handleInputFocusEvent);this.bindDelegateInputEvent("mousedown touchstart",this.handleInputFocusEvent);this.bindDelegateInputEvent("blur",this.handleSmartyInputBlurEvent);this.bindDelegateInputEvent("keyup",this.handleInputKeyUp);this.options.simplifiedValueChange||this.bindDelegateInputEvent("textchange",this.handleInputChangeEvent)}),bindDelegateInputEvent:function(a,
b){f("body").off(a,'input[smarty\x3d"true"]').on(a,'input[smarty\x3d"true"]',function(a){var c=f(this).getWidget();return c?b.call(c,a):!1})},initDropdown:function(){this.initSmartyDropdown()},initSmartyDropdown:function(){if(!this.dropdown){var a={id:this.id("smartbox-dropdown"),css:{display:"none",position:"absolute",width:"auto"},role:"dialog",tabindex:"0"};this.options.e2eTestMode&&this.options.windowDataTestTagName&&(a[this.options.windowDataTestTagName]=this.options.windowDataTestTagValue||
"");var b=this.widgetBaseClass||"";this.options.dropdownClass&&(b=b+" "+this.options.dropdownClass);this.dropdown=f("\x3cdiv\x3e\x3c/div\x3e",a).addClass(b);this.dropdown.addClass("R9-Overlay");this.dropdown.addClass(this.extraIconClasses());this.dropdown.addClass(this.extraLabelClasses())}},setDropdownContent:function(a){this.dropdown[0].innerHTML=a},setDropdownPosition:function(){var a=this.widgetBaseClass;this.options.dropdownClass&&(a=a+" "+this.options.dropdownClass);a=a+" "+this.extraIconClasses()+
" "+this.extraLabelClasses();this.dropdown.attr("class",a);var a=this.dropdown[0].style,b=this.dropdown.outerWidth(!0),c=!1;this.options.minWidth&&b<this.options.minWidth&&(b=Math.max(this.options.minWidth,b),c=!0);this.options.maxWidth&&b>this.options.maxWidth&&(b=Math.min(this.options.maxWidth,b),c=!0);a.width=c?b+"px":"auto";if(this.options.fixedDropdown)a.position="relative";else{var c=this.options.positionTarget||this.element,d=c.offset(),e=f(this.options.appendTo).offset(),h=0,l=d.left-e.left,
k=this.options.direction;this.dropdown.parent()[0]===f(document.body)[0]&&(h=parseInt((f(document.body).css("top")||"0").replace("-",""),10)||0);"right"===this.options.position&&(l+=c.width()-b-2);this.shouldFlipDirection(k)&&(k="down"===k?"up":"down");"up"===k?this.updateDropdownTop&&(this.dropdown.addClass("up"),this.element.addClass("up"),a.top=d.top-this.dropdown.outerHeight()-h+"px"):this.updateDropdownTop&&(this.dropdown.removeClass("up"),this.element.removeClass("up"),a.top=h+d.top+c.outerHeight()-
e.top+"px");"rtl"===document.dir?(b=f(window).width()-(d.left+c.outerWidth()),a.right=b+"px"):a.left=l+"px"}a.display=this.options.mcFlyInline?"block":"inline";this.aria&&(this.element.attr({"aria-expanded":!0}),this.dropdown.find("ul").attr("role","listbox"),this.dropdown.find("li").attr("role","option"));a.zIndex=this.element.zIndex()+this.options.zIndex;this.options.boundToScreen&&(this.dropdown.css("height","auto"),b=f(window).height(),c=f(window).scrollTop(),d=this.dropdown.outerHeight(),a=parseInt(a.top,
10),d+a+10-c>b&&(this.dropdown.height(b+c-a-10),this.dropdown.css("overflow-y","auto")))},shouldFlipDirection:function(a){if(this.options.flippable){var b=f(window).scrollTop(),c=b+f(window).outerHeight(),d=this.dropdown.outerHeight(),e=this.element.offset().top,c=e+this.element.outerHeight()+d>c,b=e-d<b;if("down"===a)return c&&!b;if("up"===a)return b&&!c}return!1},showDropdown:function(a,b){this.options.enableRemoteHide&&e.events.publish("Smarty.hide",this.id());this.deferredSmartyAppend||(this.deferredSmartyAppend=
1,this.dropdown.appendTo(this.options.appendTo));var c=this;this.showDropdownTimeout&&(clearTimeout(this.showDropdownTimeout),this.showDropdownTimeout=null);if("function"===typeof this.options.delayShowDropdown&&this.options.delayShowDropdown()){var d=this.showDropdownLast?Date.now()-this.showDropdownLast:null;if(!this.showDropdownLast||0===d||d&&0<d&&d<this.options.showDropdownDelay){this.showDropdownLast=this.showDropdownLast||Date.now();this.showDropdownTimeout=setTimeout(this.showDropdown.bind(this,
a,b),d||this.options.showDropdownDelay);return}}this.showDropdownLast=null;this.setDropdownContent(this.makeHTML(a));this.setDropdownPosition();this.bindDropdownEvent("click",this.handleItemClickEvent);this.bindDropdownEvent("mouseover",this.handleItemMouseoverEvent);this.bindDropdownEvent("mouseout",this.handleItemMouseoutEvent);if(this.options.repositionDropdownOnResize)f(window).off("resize.smarty").on("resize.smarty",this.handleWindowResizeSmarty.bind(this));clearTimeout(this.clickDropdownSetID);
this.clickDropdownSetID=setTimeout(function(){if(c.isSmartyActiveElement())f(document).off("click.Smarty"+c.id()).on("click.Smarty"+c.id(),function(){c.onDocumentClicked()})},400);this.initFirstHighlight();this.options.positionOnScroll&&(a=function(){c.position()},f(window).off("scroll.smarty",a).on("scroll.smarty",a),f(".col-left-rail").off("scroll.colSmarty").on("scroll.colSmarty",a),f(".filterList").off("scroll.colSmarty").on("scroll.colSmarty",a),f(".Common-Widgets-Dialog-Dialog.visible\x3e.viewport").off("scroll.dialogSmarty").on("scroll.dialogSmarty",
a))},initFirstHighlight:function(){this.removeItemHighlight();""!==this.element.val()&&this.highlightFirstSelectableItem()},hideDropdown:function(a){f(window).off("resize.smarty");this.base(a);if(e.config.getBoolean("ui.smarty.auto.select.1st",!1))return!0},toggleAnywhere:function(a){this.options.showAnywhere=a},stopInputProcessing:function(){this.setItemTriggered||this.smartyLoggerSave();this.setItemTriggered=!1;this.base()},handleItemClickEvent:function(a,b){this.selectItem(a,null);this.hideDropdown();
this.options.stopPropagation&&b&&"function"===typeof b.stopPropagation&&b.stopPropagation()},handleInputBlurEvent:function(a,b){this.handleSmartyInputBlurEvent(a,b)},handleSmartyInputBlurEvent:function(){var a=this;this.focusEventHandled=!1;setTimeout(function(){if(!a.isSmartyActiveElement()){a.stopInputProcessing();if(a.hideDropdown()&&a.options.forceSelection)a.onForceSelection();a.onAfterDone()}},10)},handleInputKeyUp:function(a){var b=[e.globals.keyCodes.TAB,e.globals.keyCodes.RETURN,e.globals.keyCodes.ESC];
e.config.getBoolean("ui.smarty.ignoreArrowsInKeyUp",!0)&&(b=b.concat(e.globals.keyCodes.UP,e.globals.keyCodes.DOWN));var c=a.keyCode?a.keyCode:a.which,d=this.options.simplifiedValueChange||this.dropdown&&this.dropdown.is(":visible");0<=b.indexOf(c)||!d||(this.options.simplifiedValueChange?this.handleInputChangeEvent():this.handleInputFocusEvent(this.element,a))},onDocumentClicked:function(){if(!this.isSmartyActiveElement())if(f(document).off("click.Smarty"+this.id()),this.options.cleanUpInputFieldOnFocus){if(this.lastValue&&
!this.element.val()&&this.element.val(this.lastValue),!this.isSmartyActiveElement()){this.stopInputProcessing();if(this.hideDropdown()&&this.options.forceSelection)this.onForceSelection();this.onAfterDone()}}else this.hideDropdown()},isSmartyActiveElement:function(){return this.dropdown&&this.element?document.activeElement===this.dropdown.get(0)||document.activeElement===this.element.get(0)||this.options.alternateSmartyInputElement&&document.activeElement===this.options.alternateSmartyInputElement||
0<this.dropdown.find(f(document.activeElement)).length:!1},setItem:function(a,b){this.smartyLoggerSave(a);this.setItemTriggered=!0;this.base(a,b)},smartyLoggerSave:function(a){if(e.config.getBoolean("ui.smarty.r9LogOptions",!0)){var b={vertical:this._logPath,inputType:this.element.attr("name")||"destination",prefix:this.isItemSet||!this.setItemTriggered&&this.initialVal&&this.initialVal===this.element.val()?"":this.element.val()||"",options:this.getSmartyLoggerItems()||[]};a&&(b.selectedElem=a);e.SmartyLogger._save(b)}},
getSmartyLoggerItems:function(){return this.dropdown&&this.dropdown.children&&this.dropdown.children("ul").children("li")},handleWindowResize:function(){this.handleWindowResizeSmarty()},handleWindowResizeSmarty:function(){if(!this.isDropdownHidden()){var a=this.options.positionTarget||this.element,b=a.offset().left-f(this.options.appendTo).offset().left,c=a.offset().top+a.outerHeight()-f(this.options.appendTo).offset().top;"right"===this.options.position&&(b+=a.width()-2);this.dropdown.css("left",
b+"px");this.dropdown.css("top",c+"px")}this.updateBackgroundAutocompletePosition()},destroy:function(){this.base();this.hideDropdown();this.abortSearchCompletedEventListeners();this.unInit();this.unbindInputEvent("mousedown touchstart");this.unbindInputEvent("keyup");this.element.removeData("widget");this.element.attr("smarty",!1);f(document).off("click.Smarty"+this.id());f(window).off("resize.smarty");!0===this.options.enableRemoteHide&&this.id()&&e.events.unsubscribe("Smarty.hide",this.hideSmartyById)},
isJSON:function(){var a=this.options.extendRequest;return a&&"j"===a.f},isJsonResponse:function(a){return this.isJSON()&&"string"!==typeof a},applyJsonOptions:function(){this.isJSON()&&(this.options.dataType="json",this.options.extendRequest=f.extend({},this.options.extendRequest,{v:"v1"}),this.options.dropdownClass+=" smartbox-js")},postprocessResponse:function(a,b){return this.isJsonResponse(a)?a:this.base(a,b)},makeHTML:function(a){if(!this.isJsonResponse(a))return this.base(a);var b=this,c=this.getRequestData(),
d=c&&c.value||"",e=this.getMaxItemsToShow();return'\x3cul role\x3d"listbox"\x3e'+a.map(function(a,c){return 0<e&&c>=e?null:b.formatItem(a,d)}).filter(function(a){return!!a}).join("")+"\x3c/ul\x3e"},getMaxItemsToShow:function(){return-1},formatItem:function(a,b){var c=a.cc&&"ctry"===a.loctype&&e.config&&e.config.getBoolean("ui.smarty.hideCountryFeatures."+a.cc,!1);if(!a||!a.loctype)return"";var d=this.getDisplayName(a),g=this.getNearbyHotels(a),h=this.getNearbyRentals(a),d=f.extend({},a,{id:this.getItemId(a),
name:d,label:[d,g,h].filter(function(a){return!!a}).join(" "),highlighting:this.highlight(d,b),parentPath:a.parentPath||a.rc||"",nearbyHotels:g,nearbyRentals:h}),g='\x3cdiv class\x3d"smarty-city"\x3e'+d.highlighting+"\x3c/div\x3e";"ap"===a.loctype?(d.shortName=a.shortdisplayname||"",g+='\x3cspan class\x3d"airportCode"\x3e'+this.highlight(a.ap,b)+"\x3c/span\x3e"):"city"===a.loctype?d.shortName=a.cityonly||"":"ctry"===a.loctype&&a.cc&&!c&&(d.icon="/images/flags/a-small-flag."+a.cc.toLowerCase()+".png");
(b=this.locationTypeMessages[a.loctype]||"")&&!c&&(g+='\x3cspan class\x3d"smarty-label '+a.loctype+'"\x3e'+b+"\x3c/span\x3e");"ap"!==a.loctype&&"hotel"!==a.loctype&&(g+=this.formatNearbyDetails(a,d));b=a.loctype||"city";"cg"===b&&(b="ctgroup");c&&(b+=" noBackgroundIcon");c=['id\x3d"'+this.formatListItemId(a,d)+'"','class\x3d"'+b+'"','role\x3d"option"','tabindex\x3d"0"'];a.cc&&c.push('data-cc\x3d"'+a.cc+'"');a.rc&&c.push('data-rc\x3d"'+a.rc+'"');d.shortName&&c.push('data-short-name\x3d"'+d.shortName+
'"');d.label&&c.push('aria-label\x3d"'+d.label+'"');d.icon&&c.push('style\x3d"background-image:url('+d.icon+')"');c.push('data-attr\x3d"'+this.htmlEscape(JSON.stringify(d))+'"');this.options.e2eTestMode&&c.push("data-test-item");return"\x3cli "+c.join(" ")+"\x3e"+g+"\x3c/li\x3e"},getDisplayName:function(a){var b=a.displayname||"";if(a.ap){a="("+a.ap+")";var c=b.length,d=c-a.length;b&&b.substring(d,c)===a&&(b=b.substring(0,d).trim())}return b},getNearbyHotelsCount:function(a){return a.hotelCount||
a.nearbyHotels||0},getNearbyHotels:function(){return""},getNearbyRentalsCount:function(a){return a.rentalCount||a.nearbyRentals||0},getNearbyRentals:function(){return""},formatNearbyDetails:function(a,b){a="";b.nearbyHotels&&(a+='\x3cspan class\x3d"smarty-label hotels"\x3e'+b.nearbyHotels+"\x3c/span\x3e");b.nearbyRentals&&(a+='\x3cspan class\x3d"smarty-label rentals"\x3e'+b.nearbyRentals+"\x3c/span\x3e");return a},getItemId:function(a){return""+(("ap"===a.loctype?a.ap:"city"===a.loctype?a.ctid:"ctry"===
a.loctype?a.cid:"hotel"===a.loctype?a.hid:"reg"===a.loctype?a.rid:"freereg"===a.loctype?a.frid:"cg"===a.loctype?a.cgid:"hood"===a.loctype?a.sid:"lm"===a.loctype?a.lmid:a.id)||"")},formatListItemId:function(a,b){return a.loctype+"-"+b.id},htmlEscape:function(a){var b={"\x26":"\x26amp;","\x3c":"\x26lt;","\x3e":"\x26gt;",'"':"\x26quot;","'":"\x26#39;"};return a.replace(/[&<>"']/g,function(a){return b[a]})},highlight:function(a,b){var c=a.toLowerCase().indexOf(b.toLowerCase());b=c+b.length;return 0>c?
a:a.substring(0,c)+"\x3cb\x3e"+a.substring(c,b)+"\x3c/b\x3e"+a.substring(b)}})})(window.R9,window.jq||window.jQuery);(function(d,e){d.createWidgetClass("smarty.PopularDestinationsSmarty","common.widgets.smarty.FlareSmarty",{currentOrigin:null,hideDropdown:function(){this.base();if(d.config.getBoolean("ui.smarty.auto.select.1st",!1))return!0},checkAndSetItem:function(a,b){a=e(b);if(a.hasClass("anywhere")&&a.hasClass("selected")&&a.is(":visible"))return a={id:"",short_str:"anywhere",str:a[0].innerText,type:""},this.setItem(a),!1;if("undefined"!==a.attr("id")&&a.is(":visible")&&(a=this.extractFirstListItemData(a)))return this.setItem(a),
!1},extractFirstListItemData:function(a){if(a.hasClass("anywhere")&&a.hasClass("selected")&&a.is(":visible"))return{id:"",short_str:"anywhere",str:a[0].innerText,type:""};if(d.config.getBoolean("ui.smarty.populardestinations.1st.translate",!0))return(a=this.translateItem(a))?a:!1;var b=a[0].id.split("-"),c=a[0].id;return c.startsWith("ap")?{id:b[1],short_str:a.attr("data-short-name"),str:a.clone().find("span").remove().end().text(),type:"ap"}:c.startsWith("freereg")?{frid:b[3],hc:b[2],id:b[1],str:a.children("div")[0].innerText,
type:"freereg"}:c.startsWith("ctry")?{cid:b[3],hc:b[2],id:b[1],str:a.children("div")[0].innerText,type:"ctry"}:c.startsWith("reg")?{rid:b[3],hc:b[2],id:b[1],str:a.children("div")[0].innerText,type:"reg"}:c.startsWith("city")?{hc:b[2],id:b[1],str:a.children("div")[0].innerText,type:"city"}:c.startsWith("lm")?{hc:b[2],lmid:b[3],id:b[1],str:a.children("div")[0].innerText,type:"lm"}:!1},isSelectOnCloseSupported:function(){return 51===this.options.flareSmartyType||50===this.options.flareSmartyType||58===
this.options.flareSmartyType},drawDestinationsContent:function(a){this.lastValue=null;this.currentOrigin&&this.currentOrigin===a||(this.currentOrigin=a,this.dropdown[0].innerHTML="");this.hideDropdown()}})})(window.R9,window.jq||window.jQuery);(function(e,f){e.createWidgetClass("smarty.HotelSmarty","common.widgets.smarty.PopularDestinationsSmarty",{constructor:function(a,b){var c={dropdownClass:" smartbox smartbox-v2 smartbox-hotel R9-Overlay ",forceSelection:!0,minWidth:377,searchOnFocus:!0,extendRequest:{v:"v2"},showDropdownWhenEmpty:!1,showPopularDestinationsList:!1,showPopularDestinationsPictures:!1},d=b.limitToCtids;d&&d.length&&(c.extendRequest.ctids=d.join(","));d=!0;a&&a[0]&&a[0].id&&(-1!=a[0].id.indexOf("hotelchain")||-1!=a[0].id.indexOf("hotelname"))&&
(d=!1);d&&this.concatExtraDropdownClasses([c,b],this.extraIconClasses(e.config.getBoolean("ui.smarty.hotels.greyIcons",!1)));c.isBusinessMode=e.question.ask("common.business.BusinessIsBusinessMode");c.isBusinessMode&&(c.showDropdownWhenEmpty=!0,c.businessOffices=e.question.ask("common.business.BusinessOffices"),c.businessOfficesHeader=e.question.ask("common.business.BusinessOfficesHeader"),c.businessSmartyMatchOffices=e.question.ask("common.business.BusinessSmartyMatchOffices"));this.base(a,f.extend(c,
b))},searchCompleted:function(a,b){this.shouldDisplayBusinessOffices()?this.showDropdown(a||"\x3cul\x3e\x3c/ul\x3e",b):this.base(a,b)},postprocessResponse:function(a,b){var c=this;!a&&e.config.getBoolean("ui.hotel.smarty-addresses",!0)&&e.Maps&&e.Maps.Google&&e.Maps.Google.load&&e.Maps.Google.load(function(){if(c.lastValue){var d=c.getAddressSuggestions(c.lastValue),e=c.searchCompleted,g=c.base,f=c.matchAndBold,n=c.lastValue;d.done(function(a){if(a&&0<a.length){for(var d="\x3cul\x3e",l=0;l<a.length;l++){var h=
a[l],m=!1;if(h.types)for(var k=0;k<h.types.length;k++)if("street_address"===h.types[k]||"route"===h.types[k]){m=!0;break}m&&(d+="\x3cli tabindex\x3d'0' class\x3d'map'\x3e\x3cdiv class\x3d\"smarty-city\"\x3e"+f.call(c,n,h.description)+"\x3c/div\x3e\x3c/li\x3e")}e.call(c,g.call(c,d+"\x3c/ul\x3e",b),b)}});return a}},c.widgetName);return this.base(a,b)},getAddressSuggestions:function(a){var b=f.Deferred();e.config.getBoolean("ui.hotel.googleAddressSuggestions",!0)&&window.google&&google.maps&&google.maps.places&&
google.maps.places.AutocompleteService&&(new google.maps.places.AutocompleteService).getPlacePredictions({input:a},function(a,d){d===google.maps.places.PlacesServiceStatus.OK?b.resolve(a):b.reject(d)});return b.promise()},createTopDestinationItem:function(a){var b=[];b.push(a.name);a.stateCode&&""!==a.stateCode?b.push(a.stateCode):a.state&&b.push(a.state);a.country&&b.push(a.country);return('\x3cli tabindex\x3d"0" id\x3d"city-%s" class\x3d"city" data-cc\x3d"%s" role\x3d"option" aria-label\x3d"%s"\x3e\x3cspan class\x3d"nearbyHotels"\x3e%s\x3c/span\x3e\x3cdiv class\x3d"smarty-city"\x3e%s\x3c/div\x3e\x3cspan class\x3d"smarty-label city"\x3e'+
this.options.messages.SMARTY_LOCATION_TYPE_CITY+"\x3c/span\x3e\x3c/li\x3e").format(a.ctId,a.cid,b.join(", "),a.hotelCountDisplay,b.join(", "))},makeHTML:function(a){if(!this.isJsonResponse(a))return this.shouldDisplayBusinessOffices()&&(a='\x3cul role\x3d"listbox" class\x3d"hotel-smarty"\x3e'+this.makeBusinessOfficeList()+"\x3c/ul\x3e"),this.base(a);a=this.base(a);this.shouldDisplayBusinessOffices()&&(a=a.slice(0,-5)+this.makeBusinessOfficeList()+"\x3c/ul\x3e");return a},makeBusinessOfficeList:function(){if(this.shouldDisplayBusinessOffices()){var a;
a=null!==this.lastValue&&this.element[0].value.length?this.options.businessSmartyMatchOffices(this.lastValue):this.options.businessOffices;return 0<a.length?e.template.render("hotelBusinessOffices",{businessOfficesHeader:this.options.businessOfficesHeader,offices:a}):""}},makeRecentList:function(a,b){if(this.shouldDisplayBusinessOffices())return"";if(this.options.smartyControlGroup){var c=this.options.smartyControlGroup.getHistory();if(c){var d=this.options.smartyControlGroup.getMaxHistory();a=jq.trim(a);
for(var c=c.filter(a,""===a?d:3),d="",e=0;e<c.length;e++){var g=c[e],f=!1;e===c.length-1&&(f=!0);d+=this.generateSmartyItem(this.matchAndBold(a,g.location),g.checkinDate,g.checkoutDate,g.idx,g.isPast,f)}return d=""!==d?(b?"\x3cul\x3e":"")+this.generateRecentHeader()+d+(b?"\x3c/ul\x3e":""):null}}},generateSmartyItem:function(a,b,c,d,f,g){b=new moment(b);c=new moment(c);g=g?" last":"";a='\x3cspan class\x3d"smartyRecentHotels"\x3e'+a+'\x3c/span\x3e\x3cspan class\x3d"smartyRecentDate '+(f?"past":"")+
'"\x3e'+b.format(this.options.smartyControlGroup.options.startFormat)+" - "+c.format(this.options.smartyControlGroup.options.endFormat)+"\x3c/span\x3e";return this.isSmartyUIV1()?'\x3cli tabindex\x3d"0" class\x3d"hist '+g+'" data-history-idx\x3d"'+d+'"\x3e\x3cdiv class\x3d"icon-wrapper"\x3e'+e.template.render("smartyHotelHistorySVG")+'\x3c/div\x3e\x3cdiv class\x3d"hist-info"\x3e'+a+"\x3c/div\x3e\x3c/li\x3e":'\x3cli tabindex\x3d"0" class\x3d"hist '+g+'" data-history-idx\x3d"'+d+'"\x3e\x3c/li\x3e'},
generateLoginBar:function(a){if(!this.options.smartyControlGroup)return"";var b="admin";a&&(b+=" addSeparation");return"notloggedin"===e.globals.analytics.loginState?(a="\x3cli tabindex\x3d'0' class\x3d'signupnow "+b+"'\x3e"+this.options.messages.loginForSearchHistory+"\x3c/li\x3e",this.isSmartyUIV1()&&(a=e.template.render("smartySignUpIn",{extraClasses:b})),a):"\x3cli class\x3d'click-disabled'\x3e\x3cdiv class\x3d'no-searches'\x3e"+(this.isSmartyUIV1()?'\x3cdiv class\x3d"icon-wrapper"\x3e'+e.template.render("smartyHistorySVG")+
"\x3c/div\x3e":"")+"\x3cspan\x3e"+this.options.messages.SMARTY_NO_RECENT_SEARCHES+"\x3c/span\x3e\x3c/div\x3e\x3c/li\x3e"},handleInputFocusEvent:function(a,b){!this.options.showPopularDestinationsList&&!this.options.showPopularDestinationsPictures||this.startedSearching&&0!==this.element[0].value.length?this.base(a,b):(this.options.searchOnFocus=!1,this.base(a,b),this.showPopularDestinations())},showInitialDropdownForData:function(a){this.shouldDisplayBusinessOffices()?this.searchCompleted(a,!1):this.base(a)},
showDropdown:function(a,b){this.base(a,b);if(this.options.showPopularDestinationsList||this.options.showPopularDestinationsPictures)0!==this.element[0].value.length&&this.startedSearchings?this.options.showPopularDestinationsPictures&&this.dropdown.removeClass("smartbox-pictures"):(this.dropdown[0].style.minimumWidth="420px",!this.options.showPopularDestinationsPictures||this.startedSearching&&0!==this.element[0].value.length||this.dropdown.addClass("smartbox-pictures"))},onInputChange:function(){if(this.options.showPopularDestinationsList||
this.options.showPopularDestinationsPictures)this.startedSearching=!0,this.options.searchOnFocus=!0,this.options.showPopularDestinationsPictures&&this.dropdown.removeClass("smartbox-pictures");this.base()},getItemList:function(){return this.options.showPopularDestinationsList||this.options.showPopularDestinationsPictures?this.dropdown.find(this.options.dropdownListSelector+", .destinationItem"):this.base()},selectItem:function(a,b){var c=-1<a.className.indexOf("destinationItem");(this.options.showPopularDestinationsList||
this.options.showPopularDestinationsPictures)&&c?e.question.ask("hotel.search.popularDestinationSelected",a):this.base(a,b)},showPopularDestinations:function(){if(!this.options.showPopularDestinationsList||!this.options.showPopularDestinationsPictures){var a;this.options.showPopularDestinationsList?a=f(".Hotels-Search-PopularDestinationsList"):this.options.showPopularDestinationsPictures&&(a=f(".Hotels-Search-PopularDestinationsPictures"));if(a&&a[0]){a=a.clone().removeAttr("hidden")[0].outerHTML;
var b=this.makeRecentList(null,!1);null==b?b="":0>b.indexOf("\x3cul\x3e")&&(b="\x3cul\x3e"+b+"\x3c/ul\x3e");var c="\x3cul\x3e"+this.generateLoginBar(!1)+"\x3c/ul\x3e";this.showDropdown(b+a+c,!1);var d=this;e.question.ask("hotel.search.popularDestinationsAppended",{smarty:d,after:function(){d.startedSearching=!0;d.options.searchOnFocus=!0;d.hideDropdown()}})}}},setItem:function(a,b){a&&"easter"===a.type?(e.events.publish("smarty.easteregg.found",f.extend(a,{vertical:"hotels"})),this.element.val(""),
this.element.trigger("textchange")):this.base(a,b)},formatListItemId:function(a){switch(a.loctype){case "ap":case "apnc":return[a.loctype,a.ctid,a.nearbyHotels,a.ap].join("-");case "hotel":return[a.loctype,a.ctid,0,a.id].join("-");default:return this.base(a)}},getMaxItemsToShow:function(){return-1},shouldDisplayBusinessOffices:function(){return e.config.getBoolean("ui.smarty.hotels.business.showOffices",!1)&&this.options.isBusinessMode&&-1===this._id.indexOf("Input")},onInitialData:function(){var a,
b=this.generateAnywhereMarkup(),c=this.generateContinentsMarkup(),d;if(a="loggedin"===e.globals.analytics.loginState?this.generateTopDestinations()||e.Widgets.Smarty.Smarty.prototype.onInitialData.call(this)||this.makeRecentList(null,!0):this.generateTopDestinations()||e.Widgets.Smarty.Smarty.prototype.onInitialData.call(this))return d=this.generateLoginBar(a||b),this.placeAnywhereMarkup(a,(b?b:"")+d);a=[];this.appendToInitialData(a);d=0<a.length;d=this.generateLoginBar(b||d);b&&a.push(b);c&&a.push(c);
this.options.smartyControlGroup&&e.globals.canLogin&&"undefined"!==typeof d&&a.push(d);return a.length?"\x3cul\x3e"+a.join("")+"\x3c/ul\x3e":""}})})(window.R9,window.jq||window.jQuery);(function(d,h){var k=d.config.getBoolean("ui.horizon.flights.smarty.iataCity.fullDisplay",!1);d.createWidgetClass("smarty.FlareSmarty","common.widgets.smarty.FlareSmartyBaseLoader",{constructor:function(a,b){this.base(a,h.extend({dataSource:"/f/smarty",appendTo:"body"},b))},init:function(){d.common.widgets.smarty.Smarty.prototype.init.apply(this,arguments)},showDropdown:function(){d.common.widgets.smarty.Smarty.prototype.showDropdown.apply(this,arguments)},translateItem:function(a){var b=d.Widgets.Smarty.FlareSmarty.prototype.translateItem.call(this,
a);(a=h(a).data("attr"))&&(b=h.extend(b,a));return b},setItem:function(){d.common.widgets.smarty.Smarty.prototype.setItem.apply(this,arguments)},handleItemClickEvent:function(a,b){this.isSmartyUIV1()?h(a).hasClass("sign-up-in")?(this.openSignUpInPopup(h(b.target).hasClass("sign-up")),this.hideDropdown()):this.base(a,b):this.base(a,b)},getDataSource:function(){return this.isSmartyUIV1()?d.config.getString("ui.common.smarty.get.url",this.options.dataSource):this.base()},postprocessResponse:function(a,
b){return this.isJsonResponse(a)?d.common.widgets.smarty.Smarty.prototype.postprocessResponse.call(this,a,b):this.base(a,b)},makeHTML:function(a){return this.isJsonResponse(a)?d.common.widgets.smarty.Smarty.prototype.makeHTML.call(this,a):this.base(a)},getMaxItemsToShow:function(){return d.config.getInt("ui.smarty.json.itemLimit",-1)},openSignUpInPopup:function(a){a?d.authentication.showSignup():d.authentication.showLogin()},isSmartyUIV1:function(){return this.isJSON()&&this.options.smartyUIUpdateEnabled},
isDestinationImagesEnabled:function(){return this.isSmartyUIV1()&&d.config.getBoolean("ui.smarty.destinationimages.enabled",!1)},formatItem:function(a,b){if(!this.isSmartyUIV1())return this.base(a,b);var c=a.cc&&"ctry"===a.loctype&&d.config&&d.config.getBoolean("ui.smarty.hideCountryFeatures."+a.cc,!1);if(!a||!a.loctype)return"";b=this.getItemAttrs(a);var g=this.getDisplayNameHtml(a),e=this.getAirportCodeHtml(a),g=g+e,e=a.loctype||"city";"cg"===e&&(e="ctgroup");c&&(e+=" noBackgroundIcon");c=this.options.allAirportsLocalizedText===
a.airportname;if(("ap"===a.loctype||"apnc"===a.loctype)&&c||this.itemIsCustomMetro(a))e+=" aap";c=['role\x3d"option"','tabindex\x3d"0"','data-short-name\x3d"'+(b.shortName||"")+'"','data-text-to-select\x3d"'+(b.displayName||"")+'"'];b.hasOwnProperty("apicode")?(c.push("data-apicode\x3d"+b.apicode),k&&c.push("data-iatadisplay\x3d'"+(b.locationname||b.searchFormSecondary)+"'")):"rail"===a.loctype&&b.hasOwnProperty("ap")&&c.push("data-apicode\x3d"+b.ap);"number"===typeof b.airportCount&&c.push("data-airportcount\x3d"+
b.airportCount);var m=this.getDestinationImages(a);"ctry"===a.loctype&&b.icon?(c.push('style\x3d"background-image:url('+b.icon+')"'),e+=" with-icon"):g=m&&!a.sub?m+g:b.svgIcon+g;c.push('class\x3d"'+e+(a.sub?" sub":"")+'"');e=this.formatListItemId(a);this.addItemAttributes(a,c);e&&c.push('id\x3d"'+e+'"');a.cc&&c.push('data-cc\x3d"'+a.cc+'"');a.rc&&c.push('data-rc\x3d"'+a.rc+'"');b.shortName&&c.push('data-short-name\x3d"'+b.shortName+'"');"addr"===a.loctype&&c.push('data-ctid\x3d"'+a.ctid+'"');b.label&&
(e=this.locationTypeMessages[a.loctype],c.push('aria-label\x3d"'+(e?b.label+" - "+e:b.label)+'"'));c.push('data-attr\x3d"'+this.htmlEscape(JSON.stringify({entityKey:a.entityKey,objectID:a.objectID}))+'"');this.options.e2eTestMode&&c.push("data-test-item");return"\x3cli "+c.join(" ")+"\x3e"+g+"\x3c/li\x3e"},addItemAttributes:function(a,b){},formatListItemId:function(a){var b=this.getItemId(a);switch(a.loctype){case "ap":case "apnc":return[a.loctype,[a.ap||a.airportcode,a.ctid].join("/")].join("-");
case "freereg":case "reg":case "ctry":return[a.loctype,0,a.nearbyHotels,b].join("-");case "hood":case "lm":return[a.loctype,a.ctid,a.nearbyHotels,b].join("-");case "ctgroup":return[a.loctype,0,0,a.cg].join("-");default:return b?[a.loctype,b].join("-"):null}},getItemAttrs:function(a){var b=a.cc&&"ctry"===a.loctype&&d.config&&d.config.getBoolean("ui.smarty.hideCountryFeatures."+a.cc,!1),c=this.getDisplayName(a),g=this.getNearbyHotels(a),e=this.getNearbyRentals(a),c=h.extend({},a,{id:this.getItemId(a),
displayName:c,label:[c,g,e].filter(function(a){return!!a}).join(" "),parentPath:a.parentPath||a.rc||"",nearbyHotels:g,nearbyRentals:e});"ap"===a.loctype||"apnc"===a.loctype?c.shortName=a.shortdisplayname||"":"city"===a.loctype?c.shortName=a.cityonly||"":"geocode"===a.loctype&&(c.shortName=a.structured_formatting.main_text);"ctry"===a.loctype&&a.cc&&!b&&(c.icon="/images/flags/a-small-flag."+a.cc.toLowerCase()+".png");c.svgIcon=this.getSvgIcon(a);return c},getDisplayName:function(a){return"geocode"===
a.loctype?a.description:this.base(a)},getItemId:function(a){if(this.isSmartyUIV1())switch(a.loctype){case "hotel":case "hood":case "lm":case "freereg":return a.id;case "addr":return a.displayname;case "rest":return a.rtid}return this.base(a)},getDisplayNameHtml:function(a){var b=a.locationname||a.searchFormSecondary,c=a.airportname,g=a.cityname,e=a.smartyDisplay,h=a.displayname,k=a.nearbyInfo,l=this.getItemId(a),l=d.config.getBoolean("ui.smarty.hideTypeFeatures."+a.loctype+"."+l,!1),n=a.cc&&"ctry"===
a.loctype&&d.config&&d.config.getBoolean("ui.smarty.hideCountryFeatures."+a.cc,!1);if("ap"===a.loctype||"apnc"===a.loctype){var f=[];"apnc"!==a.loctype&&c===this.options.allAirportsLocalizedText?f.push("\x3cdiv\x3e%s\x3c/div\x3e".format([g,c].join(", "))):(f.push("\x3cdiv\x3e%s\x3c/div\x3e".format("apnc"===a.loctype?e||c:a.sub?c:b)),f.push("\x3cdiv\x3e%s\x3c/div\x3e".format("apnc"===a.loctype?k||b:a.sub?b:c)));return"\x3cdiv class\x3d'item-info'\x3e%s\x3c/div\x3e".format(f.join(""))}if("ctgroup"===
a.loctype)return"\x3cdiv class\x3d'item-info'\x3e\x3cdiv\x3e%s\x3c/div\x3e\x3c/div\x3e".format(h);"hotel"===a.loctype?(f=[],f.push("\x3cdiv\x3e%s\x3c/div\x3e".format(a.hotelname||a.name)),f.push("\x3cdiv\x3e%s\x3c/div\x3e".format(g))):"geocode"===a.loctype?(f=[],f.push("\x3cdiv\x3e%s\x3c/div\x3e".format(a.structured_formatting.main_text)),f.push("\x3cdiv\x3e%s\x3c/div\x3e".format(a.structured_formatting.secondary_text))):"addr"===a.loctype?(f=[],f.push("\x3cdiv\x3e%s\x3c/div\x3e".format(a.searchFormPrimary)),
f.push("\x3cdiv\x3e%s\x3c/div\x3e".format(a.searchFormSecondary))):"rail"===a.loctype?f=["\x3cdiv\x3e%s\x3c/div\x3e".format(this.getDisplayName(a)),"\x3cdiv\x3e%s\x3c/div\x3e".format(this.locationTypeMessages[a.loctype])]:(f=[],f.push("\x3cdiv\x3e%s\x3c/div\x3e".format(h)),n||l||f.push("\x3cdiv\x3e%s\x3c/div\x3e".format(this.locationTypeMessages[a.loctype])));return"\x3cdiv class\x3d'item-info'\x3e%s\x3c/div\x3e".format(f.join(""))},getAirportCodeHtml:function(a,b){return"ap"===a.loctype||"apnc"===
a.loctype?"\x3cdiv class\x3d'ap-code'\x3e\x3cspan\x3e"+(a.ap||a.airportcode)+"\x3c/span\x3e\x3c/div\x3e":""},getSvgIcon:function(a){var b;switch(a.loctype){case "ap":case "apnc":b="smartyFlightSVG";a.nearby?b="smartyNearbySVG":this.options.allAirportsLocalizedText&&a.airportname===this.options.allAirportsLocalizedText&&(b="smartyCitySVG");break;case "hotel":b="smartyHotelSVG";break;case "rail":b="smartyTrainSVG";break;case "city":b="smartyCitySVG";break;case "ctgroup":b=this.getCtGroupIcon(a);break;
default:b="smartyMapSVG"}return"\x3cdiv class\x3d'smarty-icon-wrapper'\x3e"+d.template.render(b)+"\x3c/div\x3e"},getDestinationImages:function(a){if(!this.isDestinationImagesEnabled())return null;switch(a.loctype){case "city":case "ctry":case "reg":case "freereg":case "lm":case "hood":return this.createDestinationImageNode(a)}return null},createDestinationImageNode:function(a){return(a=a.destination_images)&&a.image_jpeg?a.image_webp?'\x3cdiv class\x3d"destination-images"\x3e\x3cdiv class\x3d"img-wrapper"\x3e\x3cpicture\x3e'+
'\x3csource srcset\x3d"%s" type\x3d"image/webp"\x3e'.format(a.image_webp)+'\x3csource srcset\x3d"%s" type\x3d"image/jpeg"\x3e'.format(a.image_jpeg)+'\x3cimg src\x3d"%s" onerror\x3d"this.style.display\x3d\'none\'" onload\x3d"this.style.opacity\x3d1" alt\x3d""/\x3e'.format(a.image_jpeg)+"\x3c/picture\x3e\x3c/div\x3e\x3c/div\x3e":'\x3cdiv class\x3d"destination-images"\x3e\x3cdiv class\x3d"img-wrapper"\x3e'+'\x3cimg src\x3d"%s" onerror\x3d"this.style.display\x3d\'none\'" onload\x3d"this.style.opacity\x3d1" alt\x3d""/\x3e'.format(a.image_jpeg)+
"\x3c/div\x3e\x3c/div\x3e":null},getCtGroupIcon:function(a){switch(a.cg){case "AS":case "AF":case "EU":case "NA":case "SA":case "SP":case "CB":case "ME":return"smartyCtGroup"+a.cg;default:return"smartyCtGroup"}},generateContinentsMarkup:function(){var a="",b=this.options.continents;0<b.length&&this.options.showContinents&&(a+='\x3cdiv class\x3d"separator continents-separator"\x3e\x3cspan class\x3d"separatorLabel"\x3e'+this.options.messages.SMARTY_CONTINENTS_LABEL+"\x3c/span\x3e\x3c/div\x3e",b.forEach(function(b,
d){a="oceania"===b.id?a+('\x3cli  id\x3d"freereg-0-0-'+b.destinyId+'" class\x3d"freereg continent-item" tabindex\x3d"'+d+'"\x3e'+b.message+"\x3c/li\x3e"):a+('\x3cli  id\x3d"ctgroup-0-0-'+b.destinyId+'" class\x3d"ctgroup continent-item" tabindex\x3d"'+d+'"\x3e'+b.message+"\x3c/li\x3e")}));return a},itemIsCustomMetro:function(a){return this.options.useApiAirportCode&&a.apicode&&4===a.apicode.length&&"a"===a.apicode.slice(-1)}})})(window.R9,window.jq||window.jQuery);(function(c,e){c.createWidgetClass("datepicker.StyleJamDateInput",{options:{placeholder:"",displayFormat:"ddd M/D",inputFormat:"MM/DD/YYYY",field:"startDate",group:"",updateGroup:"",isoDate:"",rising:!1,change:null,wrapper:null,minDateFunc:null,flexDisplayEnabled:!1,responsive:!1,responsiveMobileOnly:!0,optional:!1,elementFocused:null,elementBlurred:null,inputFull:null,inputEmpty:null,spinners:!1,showFocusIndication:!1,showToolTipImmediately:!1,focusedElementClass:"",mwebOrTweb:!1,hideKeyboardOnTouchDevices:!1,
noDateSetup:!1,maxDateIso:null,isValid:null,allowFocusDelay:c.config.getBoolean("ui.horizon.common.widgets.datepicker.dateInput.allowFocusDelay",!0),fallbackFocusHandler:c.config.getBoolean("ui.horizon.common.widgets.datepicker.dateInput.fallbackFocusHandler",!0),mcfly:!1,inContent:!1},inputElement:null,date:null,previewDate:null,now:null,maxDate:null,minDate:null,tempDate:null,inModal:!1,inSticky:!1,flexDisplay:null,clearIcon:null,focusData:null,Keys:{LEFT:37,UP:38,RIGHT:39,DOWN:40,TAB:9,RETURN:13,
PAGE_UP:33,PAGE_DOWN:34,SPACE:32,HOME:36,SHIFT:16,END:35,ESC:27},currentEvent:null,focusTriggered:!1,init:function(){this.focusData={data:null,triggering:!1};this.inputElement=this.getChildElement("input");this.inModal=1===this.element.closest(".R9-Overlay").length;this.inSticky=1===this.element.closest(".R9-Sticky").length;this.now=moment().startOf("day");this.options.maxDateIso&&(this.maxDate=moment(this.options.maxDateIso,"YYYY-MM-DD"));this.maxDate&&this.maxDate.isValid()||(this.maxDate=moment().add(1,
"year"));this.flexDisplay=this.getChildElement("flexDisplay");if(!this.options.noDateSetup){var a=moment(this.options.isoDate);this.validateDate(a)?this.setDate(a.valueOf()):this.showPlaceholder()}this.options.spinners&&(this.decSpinner=this.getChildElement("spinner-dec"),this.incSpinner=this.getChildElement("spinner-inc"));this.options.optional&&(this.clearIcon=this.getChildElement("clear"))},inlineComponentsReady:function(){var a=moment(this.options.isoDate);!this.options.noDateSetup&&this.validateDate(a)&&
this.afterSetDate(a.valueOf());this.options.optional&&(a=this.clearIcon.data("message"))&&this.clearIcon.toolTip({content:a,showImmediately:this.options.showToolTipImmediately,position:"bottom",size:"s",delay:1E3})},addEventHandlers:function(){var a=this;this.subscribe("DatePicker.update",{updateGroup:this.options.updateGroup},this.onDatePickerUpdate.bind(this));this.subscribe("DateInput.%s.focus".format(this.options.field),this.options.group,function(){a.focus()});this.registerEvent("focus",this.inputElement,
this.handleFocusEvent.bind(this));this.registerEvent("blur",this.inputElement,function(b){a.onBlur.call(a,this,b)});this.registerEvent("keydown",this.inputElement,function(b){a.onKeydown.call(a,this,b)});this.registerEvent("keyup",this.inputElement,function(b){a.onKeyup(this,b)});this.registerEvent("click",this.element,function(b){e(b.target).is("#"+a.id("input"))||a.inputElement.focus()});this.answer("DateInput.%s.%s".format(this.options.group,this.options.field),this.getInputData.bind(this));this.options.optional&&
this.clearIcon&&this.registerEvent("click",this.clearIcon,function(){a.onClearIconClick()});this.options.spinners&&(this.bindSpinners(),this.options.showFocusIndication&&this.subscribe("body.accessibilityMode.enabled",function(b){b?(c.dom.swapClasses(a.decSpinner,"",a.options.focusedElementClass),c.dom.swapClasses(a.incSpinner,"",a.options.focusedElementClass)):(c.dom.swapClasses(a.decSpinner,a.options.focusedElementClass,""),c.dom.swapClasses(a.incSpinner,a.options.focusedElementClass,""))}))},bindSpinners:function(){var a=
function(a){this.publishUpdate({action:"change",currentValue:this.getDate(),delta:a,field:this.options.field,picking:this.options.field,spinner:!0,force:!0});c.Analytics.api.trackEvent({category:this.options.field,label:"arrow",action:"click",value:0<a?"inc":"dec"})};this.incSpinner&&(this.registerEvent("click",this.incSpinner,a.bind(this,1)),this.registerEvent("keydown",this.incSpinner,this.handleKeyboardSpinner.bind(this,this.incSpinner)));this.decSpinner&&(this.registerEvent("click",this.decSpinner,
a.bind(this,-1)),this.registerEvent("keydown",this.decSpinner,this.handleKeyboardSpinner.bind(this,this.decSpinner)))},handleKeyboardSpinner:function(a,b){switch(a.which){case this.Keys.SPACE:case this.Keys.RETURN:a.preventDefault();b.click();break;case this.Keys.TAB:this.onKeydown.call(this,b,a)}},handleFocusEvent:function(a){this.focusTriggered=!0;this.focusData.refocus||this.onFocus.call(this,this.inputElement[0],a,this.focusData.data);this.focusData.triggering=!1;this.focusData.data=null;delete this.focusData.refocus},
getInputData:function(){var a={offset:this.element.offset(),width:this.element.outerWidth(),height:this.element.outerHeight(),value:this.getValue()};this.options.wrapper&&(a.wrapper="#%s".format(this.options.wrapper));return a},onDatePickerUpdate:function(a){if(a&&a.group===this.options.group&&a.fields&&a.fields.hasOwnProperty(this.options.field))switch(a.action){case "change":this.receiveDateChange(a);break;case "preview":this.receiveDatePreview(a);break;case "focus":this.options.group===a.group&&
(this.focusData={data:a,triggering:!0},this.focus());this.toggleInputFocused(!0);break;case "blur":this.showDate();this.toggleInputFocused(!1);c.events.publish("DateInput.%s.onBlur".format(this.options.field),this.options.group);a.tabForward&&(this.focusData={refocus:!0},this.options.spinners?this.incSpinner.focus():this.focus());break;case "flex":this.options.flexDisplayEnabled&&this.receiveFlexChange(a)}},focus:function(){var a=this;this.focusTriggered=!1;this.options.allowFocusDelay&&this.isTouchDevice()?
window.setTimeout(function(){a.inputElement.trigger("focus")},200):(this.inputElement.trigger("focus"),!1===this.focusTriggered&&this.options.phoenixRising&&(c.globals.isSeo||this.options.fallbackFocusHandler)&&this.handleFocusEvent())},isTouchDevice:function(){return"ontouchstart"in window||navigator&&0<navigator.maxTouchPoints},onFocus:function(a,b,d){var g=this;(this.options.mwebOrTweb||this.options.hideKeyboardOnTouchDevices&&this.isTouchDevice())&&g.hideKeyboard(this.inputElement);b="input";
d&&d.format&&(b=d.format);"function"===typeof this.options.minDateFunc&&this.options.minDateFunc.call(this,this);this.focusData.triggering||setTimeout(function(){g.summonDatePicker()},100);(d=this.getValue())&&this.showDate(d,b);"input"!==b||this.isPlaceholder||this.selectAll(a);this.toggleInputFocused(!0);c.dom.swapClasses(this.inputElement,this.options.inputEmpty,this.options.inputFull);c.events.publish("DateInput.%s.onFocus".format(this.options.field),this.options.group)},hideKeyboard:function(a){a.attr("contenteditable",
"false");setTimeout(function(){a.blur();a.attr("contenteditable","true")},100)},toggleInputFocused:function(a){a?c.dom.swapClasses(this.element,this.options.elementBlurred,this.options.elementFocused):c.dom.swapClasses(this.element,this.options.elementFocused,this.options.elementBlurred)},onBlur:function(a,b){},onKeydown:function(a,b){a=this.getDate()||moment(this.inputElement.html(),this.options.inputFormat);this.currentEvent=null;switch(b.which){case this.Keys.RETURN:this.handleKeyboardNavigationReturn(b,
a);break;case this.Keys.TAB:this.handleKeyboardNavigationTab(b,a);break;case this.Keys.ESC:this.dismissDatePicker(!1,!1,!1,!0);this.inputElement.trigger("blur");break;case this.Keys.UP:this.handleKeyboardIncrementDate(b,a,-7);break;case this.Keys.DOWN:this.handleKeyboardIncrementDate(b,a,7);break;case this.Keys.LEFT:this.handleKeyboardIncrementDate(b,a,-1);break;case this.Keys.RIGHT:this.handleKeyboardIncrementDate(b,a,1)}this.isPlaceholder&&this.hidePlaceholder()},handleKeyboardNavigationTab:function(a,
b){this.validateDate(b)?(this.currentEvent=a,a.shiftKey||!this.options.spinners||this.incSpinner.is(a.target)?this.publishUpdate({action:"tab",value:b.valueOf(),field:this.options.field,focused:!0,tabForward:!a.shiftKey,tabBackward:a.shiftKey,event:a}):this.decSpinner.focus()):a.shiftKey&&"startDate"===this.options.field&&this.dismissDatePicker(!0,!0,!1,!1)},handleKeyboardNavigationReturn:function(a,b){this.currentEvent=a;a.preventDefault();this.validateDate(b)&&this.sendDateChange(b,!1,!1);this.dismissDatePicker(!1,
!1,!0)},handleKeyboardIncrementDate:function(a,b,c){a.preventDefault();a=moment(b).add(c,"d");this.validateDate(a)&&this.sendDateChange(a,!0)},onKeyup:function(a,b){0<=[this.Keys.TAB,this.Keys.SHIFT,this.Keys.RETURN,this.Keys.ESC,this.Keys.UP,this.Keys.DOWN,this.Keys.RIGHT,this.Keys.LEFT].indexOf(b.which)||(a=moment(this.inputElement.html(),this.options.inputFormat,!0),this.validateDate(a)&&this.sendDateChange(a,!0))},setDate:function(a,b){var c=moment(a);a&&this.validateDate(c)?this.date=c:null!==
a&&""!==a||this.clearDate();this.afterSetDate(a,b)},afterSetDate:function(a,b){if(this.date&&this.validateDate(this.date))c.events.publish("DateInput.%s.%s.setDate".format(this.options.group,this.options.field),{date:this.date}),this.options.optional&&this.toggleClearIcon(!1);else if(null===a||""===a)c.events.publish("DateInput.%s.%s.clearDate".format(this.options.group,this.options.field)),"endDate"===this.options.field&&this.options.optional&&this.toggleClearIcon(!0);b||this.showDate()},setMinDate:function(a){a&&
this.validateDate(moment(a))&&(this.minDate=a)},clearDate:function(){this.date=null},getValue:function(){return this.date?this.date.valueOf():0},getDate:function(){return this.date?this.date.clone():null},validateDate:function(a){return a.isValid()&&(a.isSame(this.now)||a.isAfter(this.now))&&!a.isAfter(this.maxDate)&&(!this.options.isValid||this.options.isValid(a))},receiveDatePreview:function(a){var b=a.fields[this.options.field];a=this.options.field===a.picking&&!a.clear;b?this.showDate(b,"input"):
this.getValue()?this.showDate(this.getValue(),a?"input":"display"):this.showPlaceholder()},receiveDateChange:function(a){var b=a.fields[this.options.field],c=this.options.field===a.picking;a.tabForward&&(this.focusData={refocus:!0},this.focus());this.setDate(b,!0);"function"===typeof this.options.change&&this.date&&this.options.change.call(this,{field:this.options.field,date:this.date.format("YYYY-MM-DD")});this.showDate(c?"input":"display")},sendDatePreview:function(a,b,c){var d={action:"preview",
date:0,field:this.options.field};a&&(d.value=a.valueOf(),b&&e.extend(d,{previous:b.valueOf()}),e.extend(d,c));this.publishUpdate(d)},receiveFlexChange:function(a){var b=a.data;switch(a.flex){case "plusminusthree":case "weekend":case "openflex":case "duration":b.inputDisplay&&b.inputDisplay.hasOwnProperty(this.options.field)?(this.element.addClass("show-flex-display"),this.flexDisplay.html(b.inputDisplay[this.options.field]).show()):(this.element.removeClass("show-flex-display"),this.flexDisplay.html("").hide());
break;default:this.element.removeClass("show-flex-display"),this.flexDisplay.html("").hide()}c.events.publish("DateInput."+this.options.group+"."+this.options.field+".flexChange",this.flexDisplay.html())},sendDateChange:function(a,b,c){this.publishUpdate({action:"change",value:a.valueOf(),field:this.options.field,focused:!!b,tabForward:!!c,event:this.currentEvent})},publishUpdate:function(a){e.extend(a,{updateGroup:this.options.updateGroup,group:this.options.group});c.events.publish("DateInput.update",
a)},summonDatePicker:function(){var a={modal:this.inModal,mcfly:this.options.mcfly,inContent:this.options.inContent,sticky:this.inSticky,updateGroup:this.options.updateGroup,group:this.options.group,field:this.options.field,rising:this.options.rising};this.minDate&&e.extend(a,{minDate:this.minDate});c.events.publish("DateInput.summon",a)},dismissDatePicker:function(a,b,d,e){var f={updateGroup:this.options.updateGroup,group:this.options.group,field:this.options.field};a&&!b?(f.tabForward=!0,f.event=
this.currentEvent):a&&b&&(f.tabBackward=!0);d&&(f.returnEvent=d);e&&(f.focusDisplay=!0);c.events.publish("DateInput.dismiss",f)},showDate:function(a,b){0===arguments.length?(b="display",a=this.getValue()):"string"===typeof arguments[0]?(b=a,a=this.getValue()):"undefined"===typeof b&&(b="display");a?(this.hidePlaceholder(),"input"===b?this.inputElement.html(moment(a).format(this.options.inputFormat)):"display"===b&&this.inputElement.html(moment(a).format(this.options.displayFormat))):this.showPlaceholder()},
showPlaceholder:function(){this.inputElement.html(this.options.placeholder);this.isPlaceholder=!0;c.dom.swapClasses(this.inputElement,this.options.inputFull,this.options.inputEmpty)},hidePlaceholder:function(){this.inputElement.html("");this.isPlaceholder=!1;c.dom.swapClasses(this.inputElement,this.options.inputEmpty,this.options.inputFull)},selectAll:function(a){var b=document.createRange();b.selectNodeContents(a);a=window.getSelection();a.removeAllRanges();try{a.addRange(b)}catch(d){}},clearOptional:function(){this.clearIcon.trigger("click")},
onClearIconClick:function(){var a={updateGroup:this.options.updateGroup,group:this.options.group,field:this.options.field};this.clearDate();this.dismissDatePicker();this.toggleClearIcon(!0);c.events.publish("DateInput.clear",a);c.Analytics.api.trackEvent({category:"Date-Input",action:"click",label:"clear-optional"})},toggleClearIcon:function(a){null==this.clearIcon&&(this.clearIcon=this.getChildElement("clear"));this.clearIcon.toggleClass("hidden",a)},destroy:function(){this.base();c.events.publish("DateInput.destroy",
{group:this.options.group})}})})(R9,jQuery);(function(e,f){e.createWidgetClass("datepicker.DateInput",{options:{placeholder:"",displayFormat:"ddd M/D",inputFormat:"MM/DD/YYYY",maxDateIso:null,field:"startDate",group:"",updateGroup:"",isoDate:"",change:null,wrapper:null,minDateFunc:null,flexDisplayEnabled:!1,responsive:!1,responsiveMobileOnly:!1,optional:!1,notEditableInputInMobile:!1,isMobileOrTablet:!1,noDateSetup:!1},inputElement:null,date:null,previewDate:null,now:null,maxDate:null,minDate:null,tempDate:null,inModal:!1,inSticky:!1,flexDisplay:null,
clearIcon:null,focusData:null,Keys:{LEFT:37,UP:38,RIGHT:39,DOWN:40,TAB:9,RETURN:13,PAGE_UP:33,PAGE_DOWN:34,SPACE:32,HOME:36,SHIFT:16,END:35,ESC:27},currentEvent:null,init:function(){this.focusData={data:null,triggering:!1};this.inputElement=this.getChildElement("input");this.inModal=1===this.element.closest(".R9-Overlay").length;this.inSticky=1===this.element.closest(".R9-Sticky").length;this.now=moment().startOf("day");this.options.maxDateIso&&(this.maxDate=moment(this.options.maxDateIso,"YYYY-MM-DD"));
this.maxDate&&this.maxDate.isValid()||(this.maxDate=moment().add(1,"year"));this.flexDisplay=this.getChildElement("flexDisplay");this.options.optional&&(this.clearIcon=this.getChildElement("clear"))},inlineComponentsReady:function(){this.options.noDateSetup||(this.validateDate(moment(this.options.isoDate))?this.setDate(moment(this.options.isoDate).valueOf()):this.showPlaceholder());if(this.options.optional){var a=this.clearIcon.data("message");if(a){var b=this.clearIcon.is(":visible")&&this.options.showToolTipImmediately;
this.clearIcon.toolTip({content:a,showImmediately:b,position:"bottom",size:"s",delay:b?1E3:200})}}},addEventHandlers:function(){var a=this;this.subscribe("DatePicker.update",{updateGroup:this.options.updateGroup},this.onDatePickerUpdate.bind(this));this.subscribe("DateInput.%s.focus".format(this.options.field),this.options.group,function(){a.focus()});this.inputElement.on("focus",function(b,c){a.focusData.refocus||a.onFocus.call(a,this,b,a.focusData.data);a.focusData.triggering=!1;a.focusData.data=
null;delete a.focusData.refocus});this.inputElement.on("blur",function(b){a.onBlur.call(a,this,b)});this.inputElement.on("keydown",function(b){a.onKeydown.call(a,this,b)});this.inputElement.on("keyup",function(b){a.onKeyup.call(a,this,b)});this.element.find("[data-proxy-click]").click(function(){a.inputElement.trigger("click")});this.answer("DateInput.%s.%s".format(this.options.group,this.options.field),this.getInputData.bind(this));if(this.options.optional)this.clearIcon.on("click",function(b){a.onClearIconClick(a,
this,b)})},getInputData:function(){var a={offset:this.element.offset(),width:this.element.outerWidth(),height:this.element.outerHeight(),value:this.getValue()};this.options.wrapper&&(a.wrapper="#%s".format(this.options.wrapper));return a},onDatePickerUpdate:function(a){if(a&&a.fields&&a.fields.hasOwnProperty(this.options.field)&&a.group&&a.group===this.options.group)switch(a.action){case "change":this.receiveDateChange(a);break;case "preview":this.receiveDatePreview(a);break;case "focus":this.options.group===
a.group&&(this.focusData={data:a,triggering:!0},this.focus());break;case "blur":this.showDate();this.element.removeClass("focused");e.events.publish("DateInput.%s.onBlur".format(this.options.field),this.options.group);a.tabForward&&(this.focusData={refocus:!0},this.focus());break;case "flex":this.options.flexDisplayEnabled&&this.receiveFlexChange(a)}},focus:function(){this.inputElement.trigger("focus")},onFocus:function(a,b,c){var d=this;!0===this.options.isMobileOrTablet&&!0===this.options.notEditableInputInMobile&&
d.hideKeyboard(a);b="input";c&&c.format&&(b=c.format);"function"===typeof this.options.minDateFunc&&this.options.minDateFunc.call(this,this);this.focusData.triggering||setTimeout(function(){d.summonDatePicker()},100);(c=this.getValue())&&this.showDate(c,b);"input"!==b||this.isPlaceholder||this.selectAll(a);this.element.addClass("focused");e.events.publish("DateInput.%s.onFocus".format(this.options.field),this.options.group)},hideKeyboard:function(a){a.setAttribute("contenteditable","false");setTimeout(function(){a.blur();
a.setAttribute("contenteditable","true")},100)},onBlur:function(a,b){},onKeydown:function(a,b){var c=a=!1;switch(b.which){case this.Keys.RETURN:c=a=!0;this.currentEvent=b;break;case this.Keys.TAB:c=!0;this.currentEvent=b;b.shiftKey||(a=!0);break;case this.Keys.ESC:c=!0}this.isPlaceholder&&this.hidePlaceholder();var d=moment(this.inputElement.html(),this.options.inputFormat);if(this.validateDate(d)||c)this.handleKeyboardNavigation(b,d),a&&b.preventDefault()},handleKeyboardNavigation:function(a,b){var c,
d=b.clone();switch(a.which){case this.Keys.TAB:c=!1;a.shiftKey?"startDate"===this.options.field&&this.dismissDatePicker(!0,!0):this.publishUpdate({field:this.options.field,action:"tab",tabForward:!0});break;case this.Keys.RETURN:c=!1;this.validateDate(b)?this.sendDateChange(b):this.dismissDatePicker(!1,!1,!0);break;case this.Keys.ESC:c=!1;this.dismissDatePicker(!1,!1,!0);this.inputElement.trigger("blur");break;default:c=!1}c&&this.sendDatePreview(b,d)},onKeyup:function(a,b){a=moment(this.inputElement.html(),
this.options.inputFormat);this.validateDate(a)&&b.which!==this.Keys.TAB&&b.which!==this.Keys.RETURN&&this.sendDatePreview(a,this.date?this.date.clone():null,{preventUpdate:!0})},setDate:function(a,b){if(a&&this.validateDate(moment(a)))this.date=moment(a),e.events.publish("DateInput.%s.%s.setDate".format(this.options.group,this.options.field),{date:this.date}),this.options.optional&&this.toggleClearIcon(!1);else if(null===a||""===a)this.clearDate(),"endDate"===this.options.field&&this.options.optional&&
this.toggleClearIcon(!0);b||this.showDate()},setMinDate:function(a){a&&this.validateDate(moment(a))&&(this.minDate=a)},clearDate:function(){this.date=null},getValue:function(){return this.date?this.date.valueOf():0},getDate:function(){return this.date?this.date.clone():null},validateDate:function(a){return this.hasFunctions(a,"isValid","isSameOrAfter","isBefore")?a.isValid()&&a.isSameOrAfter(this.now)&&!a.isAfter(this.maxDate):!1},hasFunctions:function(){var a=Array.prototype.slice.call(arguments);
return a.slice(1).reduce(function(b,c){return b&&a[0][c]&&"function"===typeof a[0][c]},!!a[0])},receiveDatePreview:function(a){var b=a.fields[this.options.field];a=this.options.field===a.picking&&!a.clear;b?this.showDate(b,"input"):this.getValue()?this.showDate(this.getValue(),a?"input":"display"):this.showPlaceholder()},receiveDateChange:function(a){var b=a.fields[this.options.field],c=this.options.field===a.picking;a.tabForward&&(this.focusData={refocus:!0},this.focus());this.setDate(b,!0);"function"===
typeof this.options.change&&this.options.change.call(this,{field:this.options.field,date:this.date.format("YYYY-MM-DD")});this.showDate(c?"input":"display")},sendDatePreview:function(a,b,c){var d={action:"preview",date:0,field:this.options.field};a&&(d.value=a.valueOf(),b&&f.extend(d,{previous:b.valueOf()}),f.extend(d,c));this.publishUpdate(d)},receiveFlexChange:function(a){var b=a.data;switch(a.flex){case "plusminusthree":case "weekend":case "openflex":b.inputDisplay&&b.inputDisplay.hasOwnProperty(this.options.field)?
(this.element.addClass("show-flex-display"),this.flexDisplay.html(b.inputDisplay[this.options.field])):(this.element.removeClass("show-flex-display"),this.flexDisplay.html(""));break;default:this.element.removeClass("show-flex-display"),this.flexDisplay.html("")}},sendDateChange:function(a,b,c){this.publishUpdate({action:"change",value:a.valueOf(),field:this.options.field,focused:!!b,tabForward:!!c,event:this.currentEvent})},publishUpdate:function(a){f.extend(a,{updateGroup:this.options.updateGroup,
group:this.options.group});e.events.publish("DateInput.update",a)},summonDatePicker:function(){var a={modal:this.inModal,sticky:this.inSticky,updateGroup:this.options.updateGroup,group:this.options.group,field:this.options.field};this.minDate&&f.extend(a,{minDate:this.minDate});e.events.publish("DateInput.summon",a)},dismissDatePicker:function(a,b,c){var d={updateGroup:this.options.updateGroup,group:this.options.group,field:this.options.field};a&&!b?(d.tabForward=!0,d.event=this.currentEvent):a&&
b&&(d.tabBackward=!0);c&&(d.focusDisplay=!0);e.events.publish("DateInput.dismiss",d)},showDate:function(a,b){0===arguments.length?(b="display",a=this.getValue()):"string"===typeof arguments[0]?(b=a,a=this.getValue()):"undefined"===typeof b&&(b="display");0!==a?(this.hidePlaceholder(),"input"===b?this.inputElement.html(moment(a).format(this.options.inputFormat)):"display"===b&&this.inputElement.html(moment(a).format(this.options.displayFormat))):this.showPlaceholder()},showPlaceholder:function(){this.inputElement.html(this.options.placeholder);
this.isPlaceholder=!0;this.element.addClass("Placeholder")},hidePlaceholder:function(){this.inputElement.html("");this.isPlaceholder=!1;this.element.removeClass("Placeholder")},selectAll:function(a){var b=document.createRange();b.selectNodeContents(a);a=window.getSelection();a.removeAllRanges();try{a.addRange(b)}catch(c){}},clearOptional:function(){this.clearIcon.trigger("click")},onClearIconClick:function(a,b){a={updateGroup:this.options.updateGroup,group:this.options.group,field:this.options.field};
this.clearDate();this.dismissDatePicker();this.toggleClearIcon(!0);e.events.publish("DateInput.clear",a);e.Analytics.api.trackEvent({category:"Date-Input",action:"click",label:"clear-optional"})},toggleClearIcon:function(a){null==this.clearIcon&&(this.clearIcon=this.getChildElement("clear"));this.clearIcon.toggleClass("hidden",a)},destroy:function(){this.base();e.events.publish("DateInput.destroy",{group:this.options.group})}})})(R9,jQuery);(function(m,e){m.createWidgetClass("datepicker.Calendar",{aboveCalendarContainer:null,belowCalendarContainer:null,months:null,currentPickerId:null,animate:!0,animating:!1,isOpen:!1,DateMode:{SINGLE:"single",RANGE:"range",WEEKEND:"weekend",OPENFLEX:"openflex"},now:null,maxDate:null,leftArrow:'\x3csvg xmlns\x3d"http://www.w3.org/2000/svg" viewBox\x3d"0 0 26 26" fill\x3d"currentColor"\x3e\x3cpath d\x3d"M16.49 20.89L7.89 13l8.6-7.89 1.02 1.11-7.4 6.78 7.4 6.78-1.02 1.11z"/\x3e\x3c/svg\x3e',rightArrow:'\x3csvg xmlns\x3d"http://www.w3.org/2000/svg" viewBox\x3d"0 0 26 26" fill\x3d"currentColor"\x3e\x3cpath d\x3d"M9.91 20.87l-1.07-1.05L15.57 13 8.84 6.18l1.07-1.05L17.68 13l-7.77 7.87"/\x3e\x3c/svg\x3e',
pickers:{},options:{monthTitleFormat:"MMMM YYYY",allowPastDates:!1,fullCssClass:"Common-Widgets-Datepicker-Calendar",shortDayNameLen:1,mobileBreakpoint:568,monthWidth:260,maxDateIso:null,isMobile:!1,flexRadioButtons:!1,forceDownwards:!1,removeOnPollingStart:!1,inContent:!1},daysSelector:".col-day[data-val]:not(.disabled)",mobileHtml:null,dataTestTagDay:"",dataTestTagMonth:"",getCssClass:function(){var a=this.getCurrentPicker(),b=this.options.fullCssClass;a&&a.cssClass()&&(b+=" "+a.cssClass());this.options.inContent&&
(b+=" InContent");this.options.mcfly&&(b+=" mcfly");return b},addPicker:function(a){var b=a.dateMode,c=a.group;if("undefined"===typeof a.id||"undefined"===typeof b||"undefined"===typeof c)throw Error("id, dateMode and group should not be empty.");this.pickers[a.id]=e.extend({},a,{state:{currentDate:this.getInitDate(a.initDate),minDate:null}})},init:function(){this.now=moment().startOf("day");this.options.maxDateIso&&(this.maxDate=moment(this.options.maxDateIso,"YYYY-MM-DD"));this.maxDate&&this.maxDate.isValid()||
(this.maxDate=moment().add(1,"year"));this.createCalendar();m.events.ready("common.widgets.datepicker.calendar.initialized",{instance:this});this.dataTestTagMonth=this.dataTestTag("month");this.dataTestTagDay=this.dataTestTag("day")},createCalendar:function(){this.element=e(this.createSkeleton(this.now));this.aboveCalendarContainer=this.element.find(".aboveCalendar");this.belowCalendarContainer=this.element.find(".belowCalendar");this.pointer=this.element.find(".pointer");this.title=this.element.find(".title");
this.displayWrapper=this.element.find(".displayWrapper");this.next=this.element.find(".nextMonth");this.prev=this.element.find(".prevMonth");this.months=this.element.find(".monthsGrid");this.animation=this.element.find(".animationWrapper");this.defaultView=this.element.find(".default-view")},addEventHandlers:function(){var a=this,b=function(b){return function(c){b.call(a,this,c)}};this.element.on("click.next",".nextMonth",this.onNextClick.bind(this));this.element.on("click.prev",".prevMonth",this.onPrevClick.bind(this));
this.element.on("keypress.next",".nextMonth",this.proxyClick.bind(this));this.element.on("keypress.prev",".prevMonth",this.proxyClick.bind(this));this.element.on("click.day",this.daysSelector,b(this.onDayClick));this.element.on("mouseenter.day",this.daysSelector,b(this.onDayOver));this.element.on("mouseleave.day",this.daysSelector,b(this.onDayOut));this.element.on("keydown.day",this.daysSelector,b(this.onDayKeydown));this.options.removeOnPollingStart&&m.events.subscribe("resultspage.streaming.start",
this.resetPosition.bind(this))},proxyClick:function(a){32!=a.which&&13!=a.which||this.trigger("click")},changeMonth:function(a){var b=this,c=this.getCurrentDate(),d=c.add(a,"month");1!==Math.abs(a)||500>this.animation.outerWidth()?(this.update(d),this.onMonthChange()):(this.animating=!0,this.animation.addClass("animating").css("transform","translateX(%spx)".format(a*("rtl"===document.dir?this.options.monthWidth:-this.options.monthWidth))),setTimeout(function(){b.animating=!1;b.animation.removeClass("animating").css("transform",
"translateX(0px)");-1==a?(b.removeMonth(b.months.children().last()),b.addMonth(b.makeMonthHTML(c.clone(),-1),!0),b.months.children().eq(1).attr("aria-hidden","false").removeClass("col-hidden"),b.months.children().eq(3).attr("aria-hidden","true").addClass("col-hidden"),b.dataTestTagMonth&&(b.months.children().eq(1).attr(b.dataTestTagMonth,""),b.months.children().eq(3).removeAttr(b.dataTestTagMonth))):1==a&&(b.removeMonth(b.months.children().first()),b.addMonth(b.makeMonthHTML(c.clone(),2),!1),b.months.append(),
b.months.children().eq(2).attr("aria-hidden","false").removeClass("col-hidden"),b.months.children().eq(0).attr("aria-hidden","true").addClass("col-hidden"),b.dataTestTagMonth&&(b.months.children().eq(2).attr(b.dataTestTagMonth,""),b.months.children().eq(0).removeAttr(b.dataTestTagMonth)));b.setDisplayHeight();b.onMonthChange()},200),this.updateNav())},removeMonth:function(a){a.remove()},addMonth:function(a,b){b?this.months.prepend(a):this.months.append(a)},onNextClick:function(a){e(a.currentTarget).is(".disabled")||
this.animating?a.preventDefault():this.changeMonth(1)},onPrevClick:function(a){e(a.currentTarget).is(".disabled")||this.animating?a.preventDefault():this.changeMonth(-1)},onDayClick:function(a,b){var c=this.getCurrentPicker();if(c.onDayClick)c.onDayClick(a,b)},onDayOver:function(a,b){var c=this.getCurrentPicker();if(c.onDayOver)c.onDayOver(a,b)},onDayOut:function(a,b){var c=this.getCurrentPicker();if(c.onDayOut)c.onDayOut(a,b)},onDayKeydown:function(a,b){var c=this.getCurrentPicker();if(c.onDayKeydown)c.onDayKeydown(a,
b)},setMinDate:function(a,b){if(b=this.pickers[b]){var c=b.state.currentDate,d=b.state.minDate;null!=d&&d.isSame(a,"d")||(d=moment(a),b.state.minDate=d,a=d.clone().startOf("month"),a.isAfter(c)&&(b.state.currentDate=a))}},getMinDate:function(a){return a&&this.pickers[a]?this.pickers[a].state.minDate:this.getCurrentPicker()?this.getCurrentPicker().state.minDate:null},setCurrentDate:function(a){this.getCurrentPicker().state.currentDate=a},getCurrentDate:function(){return this.getCurrentPicker().state.currentDate},
checkDate:function(a){return!this.options.allowPastDates&&a.isBefore(this.now)||a.isAfter(this.maxDate)||null!==this.getMinDate()&&a.isBefore(this.getMinDate())?!1:!0},makeNavHTML:function(a){var b=this.checkDate(a.clone().add(-1,"month"))?"":"disabled";a=this.checkDate(a.clone().add(1,"month"))?"":"disabled";var c=[];c.push('\x3cdiv id\x3d"%s" tabindex\x3d"0" role\x3d"button" %s aria-label\x3d"Previous month" class\x3d"navItem prevMonth %s" %s\x3e%s\x3c/div\x3e'.format(this.id("prev"),b?'disabled\x3d"disabled"':
"",b,this.dataTestTag("previous-month"),this.leftArrow));c.push('\x3cdiv id\x3d"%s" tabindex\x3d"0" role\x3d"button" %s aria-label\x3d"Next month" class\x3d"navItem nextMonth %s" %s\x3e%s\x3c/div\x3e'.format(this.id("next"),a?'disabled\x3d"disabled"':"",a,this.dataTestTag("next-month"),this.rightArrow));return c.join("")},makeWeekHeaderHTML:function(a,b,c){var d=[];d.push('\x3cdiv class\x3d"keel-grid weekDayGrid %s" %s\x3e'.format((a?"hide":"")+" "+(c||""),a?'role\x3d"row"':'aria-hidden\x3d"true"'));
c=moment().startOf("week");for(var e=0;7>e;e++)d.push('\x3cdiv class\x3d"col-weekDay"\x3e\x3cdiv %s class\x3d"weekDay" %s aria-label\x3d"%s"\x3e%s\x3c/div\x3e\x3c/div\x3e'.format(b?'id\x3d"%s-%s"'.format(b,e):"",a?'role\x3d"columnheader"':"",c.format("dddd"),c.format("dd").substr(0,this.options.shortDayNameLen))),c.add(1,"day");d.push("\x3c/div\x3e");return d.join("")},makeMobileCalendarHTML:function(a){this.isMobileModeLoaded=!0;if(!this.mobileHtml){this.mobileHtml=[];for(var b=-1;13>b;b++)this.mobileHtml.push(this.makeMonthHTML(a.clone(),
b,!0))}return this.mobileHtml},makeCalendarHTML:function(a){var b=[];b.push(this.makeMonthHTML(a.clone(),-1));b.push(this.makeMonthHTML(a.clone(),0));b.push(this.makeMonthHTML(a.clone(),1));b.push(this.makeMonthHTML(a.clone(),2));return b.join("")},makeMonthHTML:function(a,b,c){var d=[];a=a.clone().add(b,"month").startOf("month");var e=a.month(),g=this.id(a.format("YYYYMM"));b=(-1===b||2===b)&&!c;d.push('\x3cdiv id\x3d"'+g+'" class\x3d"col col-month col-month-m '+(b?"col-hidden":"")+'" role\x3d"grid" aria-readonly\x3d"true" aria-hidden\x3d"'+
b+'" '+(b?"":this.dataTestTagMonth)+"\x3e");d.push('\x3cdiv class\x3d"month"\x3e');d.push('\x3cdiv class\x3d"monthDisplay"\x3e'+a.format(this.options.monthTitleFormat)+"\x3c/div\x3e");d.push(this.makeWeekHeaderHTML(!0,g));d.push('\x3cdiv class\x3d"weeks"\x3e');d.push('\x3cdiv class\x3d"keel-grid weekGrid" role\x3d"row"\x3e');for(b=0;b<a.weekday();b++)d.push(this.makeDayHTML(g));for(;a.month()==e;)d.push(this.makeDayHTML(g,a)),6===a.weekday()&&d.push('\x3c/div\x3e\x3cdiv class\x3d"keel-grid weekGrid" role\x3d"row"\x3e'),
a.add(1,"day");a.add(-1,"day");d.push("\x3c/div\x3e");d.push("\x3c/div\x3e");d.push("\x3c/div\x3e");d.push("\x3c/div\x3e");return d.join("")},makeDayHTML:function(a,b){var c="",d="",e="",g=-1,l="",h="",n=this.dataTestTagDay;b?(this.checkDate(b)?(b.isSame(this.now)&&(c="today"),g=0):(c="disabled",n=""),d=b.date(),l='aria-describedby\x3d"'+a+"-"+b.weekday()+'"',h=' aria-label\x3d"'+b.format("MMMM D")+'"',e='data-val\x3d"'+b.valueOf()+'"'):(c="empty",n="");return"\x3cdiv "+e+' class\x3d"col-day '+c+
'" role\x3d"gridcell" '+l+h+'tabindex\x3d"'+g+'" '+n+'\x3e\x3cdiv class\x3d"day"\x3e'+d+"\x3c/div\x3e\x3c/div\x3e"},createSkeleton:function(a){var b=this.makeWeekHeaderHTML(!1);a=this.makeNavHTML(a);var c=this.options.flexRadioButtons?"flexRadioButtons":"";return'                \x3cdiv id\x3d"'+this.id()+'" class\x3d"'+this.getCssClass()+'" aria-expanded\x3d"false" role\x3d"dialog" '+this.dataTestTag("calendar")+'\x3e                    \x3cdiv id\x3d"'+this.id("pointer")+'" class\x3d"pointer hidden"\x3e\x3c/div\x3e                    \x3cdiv id\x3d"'+
this.id("title")+'" class\x3d"title"\x3e\x3c/div\x3e                    \x3cdiv class\x3d"innerWrapper"\x3e                        \x3cdiv class\x3d"contentContainer"\x3e                            \x3cdiv id\x3d"'+this.id("above")+'" class\x3d"aboveCalendar hidden '+c+'"\x3e\x3c/div\x3e                            '+(this.options.mcfly?a:"")+'                            \x3cdiv id\x3d"'+this.id("displayWrapper")+'" class\x3d"displayWrapper"\x3e                                \x3cdiv class\x3d"default-view"\x3e                                    '+
(this.options.mcfly?"":a)+'                                    \x3cdiv class\x3d"keel-grid weekDaysGrid"\x3e                                        \x3cdiv class\x3d"col-hidden col-weekHeader col-weekHeader-m"\x3e'+b+'\x3c/div\x3e                                        \x3cdiv class\x3d"col-hidden col-weekHeader col-weekHeader-m"\x3e'+b+'\x3c/div\x3e                                    \x3c/div\x3e                                    \x3cdiv id\x3d"'+this.id("animation")+'" class\x3d"animationWrapper"\x3e                                        \x3cdiv id\x3d"'+
this.id("months")+'" class\x3d"keel-grid monthsGrid"\x3e\x3c/div\x3e                                    \x3c/div\x3e                                \x3c/div\x3e                            \x3c/div\x3e                            \x3cdiv id\x3d"'+this.id("below")+'" class\x3d"belowCalendar hidden"\x3e\x3c/div\x3e                        \x3c/div\x3e                    \x3c/div\x3e                \x3c/div\x3e            '},getCurrentPicker:function(){return this.pickers[this.currentPickerId]},setTitle:function(){var a=
this.getCurrentPicker().title;"undefined"===typeof a||""===a?this.title.addClass("hidden"):this.title.text(a)},setClass:function(){this.element.removeClass().addClass(this.getCssClass())},populateMonthsGrid:function(a){a=a||this.getCurrentPicker().initDate||this.now;var b=this.makeCalendarHTML(a);this.setCurrentDate(a.clone());this.months.html(b)},switchPicker:function(a){if(null!==this.currentPickerId){var b=this.pickers[this.currentPickerId];if(b.onUnload)b.onUnload(this)}if(b=this.pickers[a]){this.currentPickerId=
a;this.setTitle();this.setClass();0===this.element.closest(m.config.getString("ui.horizon.output.container","body")).length&&this.element.appendTo(m.config.getString("ui.horizon.output.container","body"));if(b.onLoad)b.onLoad(this);b.afterLoad&&b.afterLoad(this);this.update(b.state.minDate);this.element.attr("data-date-group",b.group)}},update:function(a){this.populateMonthsGrid(a);this.updateNav();this.setDisplayHeight()},updateNav:function(){this.checkDate(this.getMonthDate(-1,!0))?this.prev.removeClass("disabled").removeAttr("disabled"):
this.prev.addClass("disabled").attr("disabled","disabled");this.checkDate(this.getMonthDate(2))?this.next.removeClass("disabled").removeAttr("disabled"):this.next.addClass("disabled").attr("disabled","disabled")},setDisplayHeight:function(){if(this.displayWrapper.is(":visible")){var a=0;this.months.children().each(function(b){if(1==b||2==b)a=Math.max(a,e(this).find(".month").outerHeight())});this.displayWrapper.height(a);this.getCurrentPicker()&&this.getCurrentPicker().setDisplayHeight&&this.getCurrentPicker().setDisplayHeight()}},
resetPosition:function(){setTimeout(function(){this.element.removeAttr("style")}.bind(this),750)},position:function(a,b){if(this.isOpen){var c=this.getCurrentPicker(),d=c.dateMode,t=c.group,c=c.hasPointer,g={},l=0,h=0,n=0,r=Math.round(e(window).outerWidth()),f=m.question.ask("DateInput.%s.startDate".format(t));if(r<this.options.mobileBreakpoint&&this.isOpen)this.element.removeAttr("style");else{if(d===this.DateMode.RANGE){var q=m.question.ask("DateInput.%s.endDate".format(t)),k,p;q||console.error('Missing end input field, if this is a single date, set the dateMode parameter to "single"');
var u=q.offset.left-f.offset.left;f.wrapper&&f.wrapper===q.wrapper&&e(f.wrapper).length&&(k=e(f.wrapper),p=k.offset());k?(g.left=p.left,l=p.top,h=k.outerHeight(),n="endDate"===a?q.offset.left-p.left:f.offset.left-p.left):f.height===q.height&&f.offset.top===q.offset.top&&this.element.outerWidth()-60>u&&(g.left=f.offset.left,l=f.offset.top,h=f.height,n="endDate"===a?u:0)}else f.wrapper&&e(f.wrapper).length&&(k=e(f.wrapper),p=k.offset()),k&&(g.left=p.left,l=p.top,h=k.outerHeight(),n=f.offset.left-p.left);
g.hasOwnProperty("left")&&"undefined"!==typeof h||(a=m.question.ask("DateInput.%s.%s".format(t,d===this.DateMode.RANGE?a:"startDate")),l=a.offset.top,h=a.height,g.left=a.offset.left);(a=this.shouldFlipDirection(l,h))&&!this.options.forceDownwards?(g.top=l-this.element.outerHeight(),this.element.addClass("up")):(g.top=l+h,this.element.removeClass("up"));l=Math.round(g.left);g=Math.round(g.top);n=Math.round(n);h=Math.round(this.element.outerWidth())+l-r;0<h&&(l-=h,n+=h);h=0;this.element.parent()[0]===
jq(document.body)[0]&&(h=parseInt((jq(document.body).css("top")||"0").replace("-",""))||0);"rtl"===document.dir&&(l=k?-(r-k.offset().left-k.outerWidth()):-(r-f.offset.left-f.width));k="translateX(%spx) translateY(%spx)".format(l,g+h);f="translateX(%spx)".format(n);k={transform:k,msTransform:k};f={transform:f,msTransform:f};b||this.options.inContent||this.element.css(k);c?this.pointer.css(f).removeClass("hidden"):this.pointer.addClass("hidden");this.animate=!0;!a&&this.getCurrentPicker()&&this.getCurrentPicker().autoScrollPosition&&
r>this.options.mobileBreakpoint&&(b=this.scrollToCalendar(g),0<b&&e("html, body").animate({scrollTop:e(window).scrollTop()+b},1E3));setTimeout(function(){this.animate&&this.element.addClass("animate")}.bind(this),1)}}},scrollToCalendar:function(a){a=e(window).scrollTop()+e(window).outerHeight()-a;return this.element.outerHeight(!0)-a},shouldFlipDirection:function(a,b){var c=e(window).scrollTop(),d=c+e(window).outerHeight(),m=this.element.outerHeight();return a+b+m>d&&!(a-m<c)},getMonthDate:function(a,
b){a=this.getCurrentDate().clone().add(a,"month");return b?a.endOf("month"):a.startOf("month")},onMonthChange:function(){m.events.publish("Calendar.monthchange",{group:this.getCurrentPicker().group})},open:function(a){if("undefined"===typeof this.pickers[a])throw Error('Picker %s not attached to the calendar. Please use "addPicker" to attach it to the calendar',a);a!==this.currentPickerId&&(this.switchPicker(a),this.animate=!1);this.element.attr("aria-expanded",!0);this.element.addClass("Summon");
setTimeout(function(){this.animate&&this.element.addClass("animate")}.bind(this),1);this.isOpen=!0},close:function(a){this.isOpen&&this.currentPickerId===a&&(this.element.attr("aria-expanded",!1),this.element.removeClass("Summon animate"),this.isOpen=!1)},getInitDate:function(a){a=a?moment(a):this.now.clone();a.isBefore(this.now)&&!this.options.allowPastDates&&(a=this.now.clone());return a},getSelectableDays:function(a){var b=this.months.children().find(".col-day[data-val]").not(".disabled");return a&&
0>a.indexOf("%s")?b.filter(a):b},getDayElement:function(a){a=moment(a).valueOf();return this.element.find(".col-day[data-val\x3d%s]".format(a))},hideTooltip:function(){this.element.find(".dayTip").hide()},highlightDates:function(a){this.getSelectableDays(a.join(",")).addClass("highlighted")},markFlex:function(a){this.getSelectableDays(a.join(",")).addClass("flex")},markStartDate:function(a){this.selectDate(a).addClass("startDate")},selectDates:function(a){return this.getSelectableDays(a.join(",")).addClass("selected").attr("aria-selected",
"true")},selectDate:function(a){a=this.getDayElement(a);a.addClass("selected").attr("aria-selected","true");return a},markEndDate:function(a){this.selectDate(a).addClass("endDate")},markPreviewDates:function(a){this.getSelectableDays(a.join(",")).addClass("preview")},isDifferentPicker:function(a){return this.currentPickerId!==a},calculateMonthOffset:function(a){a=moment(a).startOf("month").diff(this.getCurrentDate().startOf("month"));a=Math.round(moment.duration(a).asMonths());0<a&&--a;return a},
offset:function(){return this.element.offset()},append:function(a){var b=this.getAppendElement(a);return null!==b&&this.appended!==a?(b.append(this.element.detach()),this.appended=a,!0):!1},buffer:function(a){return null!==this.getAppendElement(a)&&this.appended===a?(e("body").append(this.element.detach()),this.appended=null,!0):!1},getAppendElement:function(a){return a&&e(a).length?e(a):null}})})(R9,jQuery);(function(d,c){d.extend("DatePicker.BuzzData",{});var a={},b=null,e=null,g=d.DatePicker.BuzzData=function(){if(e)return e;e=this;return this};g.prototype={constructor:g,datePicker:null,form:null,vertical:"",update:function(a,b){this.datePicker=a;this.form=b;this.vertical=b.vertical;a=d.config.getBoolean("ui.calendar.buzz.hotels.enabled",!1);b=d.config.getBoolean("ui.calendar.buzz.flights.enabled",!1);a&&"hotels"===this.vertical&&this.updatePickerAccordingData(this.form.cityId,this.updateDatePicker.bind(this));
b&&"flights"===this.vertical&&this.updatePickerAccordingData(this.getFlightUrl(),this.updateDatePicker.bind(this))},fetch:function(a,b){this.form=a;this.vertical=a.vertical;a=d.config.getBoolean("ui.calendar.buzz.hotels.enabled",!1);var e=d.config.getBoolean("ui.calendar.buzz.flights.enabled",!1);a&&"hotels"===this.vertical&&this.updatePickerAccordingData(this.form.cityId,b);e&&"flights"===this.vertical&&this.updatePickerAccordingData(this.getFlightUrl(),b)},getFlightUrl:function(){var a=this.form,
b=this.getAirportCode(a.origin),e=this.getAirportCode(a.destination),c=a.departDate,a=a.isOneWay,g="";if(this.isEmpty(b))return null;g+=b+"/";if(this.isEmpty(e))return null;g=g+(e+"")+("?oneWay\x3d"+(a?"true":"false"));c&&(g+="\x26departDate\x3d"+c);return g},isEmpty:function(a){return!a||0===a.length},getAirportCode:function(a){if("undefined"!==typeof a){var b=/(([A-Z]{3}))/g,e=a.substr(0,3);if(""==e||0==e.indexOf("C-"))e=a.value+"",e=e.replace(/ /g,""),-1!=e.indexOf("(")&&(a=b.exec(e),null!=a&&
(e=a[0]));return c.trim(e)}return null},updatePickerAccordingData:function(a,e){if(a){var g=this.getCacheData(a),f=this;null!==g?e(g):(b&&4!==b.readyState&&b.abort(),b=c.ajax({type:"GET",url:"/api/search/buzzCalendar/"+this.vertical+"/"+a,dataType:"json"}).done(function(b){b.success&&(f.putCacheData(a,b),e(b))}))}},getCacheData:function(b){b=this.getKey(b);return a.hasOwnProperty(b)?a[b]:null},putCacheData:function(b,e){b=this.getKey(b);a[b]=e},getKey:function(a){return this.vertical+"_"+a},updateDatePicker:function(a){var b=
d.config.getBoolean("ui.calendar.buzz.prices",!1),e=d.config.getBoolean("ui.calendar.buzz.prices.low",!1),g="buzz-date-low";b&&(g="buzz-prices-low");c(".r9-datepicker-item",this.datePicker).each(function(){var f=c(this);f.removeClass(g);b&&c(".buzz-price",f).html("");var d=f.data("val");"undefined"!==typeof d&&(d=moment(d).format("YYYY-MM-DD"),a.dates&&a.dates.hasOwnProperty(d)&&"LOW"===a.dates[d]&&f.addClass("buzz-date-low"),b&&a.prices&&a.prices.hasOwnProperty(d)&&(d=a.prices[d],c(".buzz-price",
f).html(d.price),e&&"LOW"===d.rate&&f.addClass("buzz-prices-low")))})}}})(window.R9,window.jq||window.jQuery);
(function(d){R9.extend("Widgets.BaseCalendarWidget",{});(R9.Widgets.BaseCalendarWidget=function(){this.updateSettings()}).prototype={advanceStyling:!0,loadBuzzData:!1,buzzDataClass:"",buzzPrices:!1,updateSettings:function(){this.advanceStyling=R9.config.getBoolean("ui.calendar.advanceStyling",!0);this.loadBuzzData=R9.config.getBoolean("ui.calendar.loadBuzzData",!1);this.buzzDataClass=(this.buzzPrices=R9.config.getBoolean("ui.calendar.buzz.prices",!1))?"datepicker-buzz-prices":"datepicker-buzz-data";
this.wholeMonthSearch=!1;jq("body").hasClass("FlightsSearch")&&0<jq(".flexOpenflex").length&&0<jq(".Flights-Search-FlightSearchPage.vm-fd").length&&(this.wholeMonthSearch=R9.config.getBoolean("ui.flights.whole-month-search.enabled",!1),this.daterangePickerDefaultNavTab="specificDate",this.noOfNightsValue="6-8",this.flexSelectedYear=this.flexSelectedMonth="",this.flexPlusMinusChecked=!1)},buzzGraph:jq("\x3cdiv\x3e",{"class":"r9-datepicker-buzz-graph"}),buzzGraphFooter:jq("\x3cdiv\x3e",{"class":"r9-datepicker-buzz-graph-footer"}),
buzzGraphFooterInner1:jq("\x3cdiv\x3e",{"class":"noairports hidden"}),buzzGraphFooterInner2:jq("\x3cdiv\x3e",{"class":"duration hidden"}),buzzGraphFooterInner3:jq("\x3cdiv\x3e",{"class":"fixedstart hidden"}),buzzGraphFooterInner4:jq("\x3cdiv\x3e",{"class":"oneway hidden"}),buzzGraphFooterDetail:jq("\x3cspan\x3e",{"class":"detail"}),buzzGraphPriceRule:jq("\x3cdiv\x3e",{id:"graphpricebar","class":"r9-datepicker-buzz-graph-price"}),buzzGraphLowestPriceRule:jq("\x3cdiv\x3e",{id:"graphlowpricebar","class":"r9-datepicker-buzz-graph-price"}),
buzzGraphPriceValue:jq("\x3cdiv\x3e",{id:"graphprice","class":"r9-datepicker-buzz-graph-price-value"}),makeCalendarHTML:function(c){var a=function(){var a=this.makeBelowCalendarHTML();a&&0<a.length&&(b.push("\x3cdiv id\x3d'%s' class\x3d'belowCalendar'\x3e".format("below")),b.push(a),b.push("\x3c/div\x3e"))},b=[];this.options.showBuzzGraph&&(this.buzzGraph.html(this.buzzGraphPriceRule.prop("outerHTML")+this.buzzGraphLowestPriceRule.prop("outerHTML")+this.buzzGraphPriceValue.prop("outerHTML")),this.buzzGraphFooterInner1.html("Select airports to see recent best prices. \x3cspan class\x3d'detail'\x3e\x3c/span\x3e"),
this.buzzGraphFooterInner2.html("Best prices for \x3cspan id\x3d\"durationNumber\"\x3e\x3c/span\x3e day trips. \x3cspan class\x3d'detail'\x3e\x3c/span\x3e"),this.buzzGraphFooterInner3.html("Best prices for trips departing on \x3cspan id\x3d\"flexDepartDate\"\x3e\x3c/span\x3e. \x3cspan class\x3d'detail'\x3e\x3c/span\x3e"),this.buzzGraphFooterInner4.html("Best prices for one-way trips \x3cspan class\x3d'detail'\x3e\x3c/span\x3e"),this.buzzGraphFooter.html(this.buzzGraphFooterInner1.prop("outerHTML")+
this.buzzGraphFooterInner2.prop("outerHTML")+this.buzzGraphFooterInner3.prop("outerHTML")+this.buzzGraphFooterInner4.prop("outerHTML")));b.push("\x3cdiv class\x3d'r9-datepicker-pointer'\x3e\x3c/div\x3e");b.push("\x3cspan role\x3d'button' class\x3d'r9-datepicker-close'\x3e\x26times;\x3c/span\x3e");!0===this.options.belowContentOnTop&&a.call(this);b.push(this.makeTitleHTML(this.options.title));this.wholeMonthSearch&&b.push(this.makeCalendarTabNavHTML());var e=moment().startOf("day"),g=this.minDate,
g=g?moment(g):e;c=c?moment(c):g;if(null==c||!this.isPastDateAllowed()&&c<e)c=e;e=moment(c).subtract(1,"months");g=moment(c).add(1,"months");b.push(this.makeMonthCalendarHTML(c,e,"r9-datepicker-month-first",this.options.prevTitle));c.add(1,"months");b.push(this.makeMonthCalendarHTML(c,g,"r9-datepicker-month-last",this.options.nextTitle));b.push("\x3cdiv class\x3d'r9-datepicker-month-break'\x3e\x3c/div\x3e");this.options.showBuzzGraph&&(b.push(this.buzzGraph.prop("outerHTML")),b.push(this.buzzGraphFooter.prop("outerHTML")));
this.wholeMonthSearch&&b.push(this.makeCalendarSelectMonthHTML());this.options.belowContentOnTop||a.call(this);return b.join("")},makeTitleHTML:function(c){return'\x3cdiv class\x3d"r9-datepicker-title"\x3e\x3cspan\x3e'+c+'\x3c/span\x3e\x3ca class\x3d"r9-datepicker-title-close"\x3eX\x3c/a\x3e\x3c/div\x3e'},makeCalendarTabNavHTML:function(){var c=jq(document.createElement("div")),a=jq(document.createElement("div")).addClass("CalendarWidget-TabNav"),b=jq(document.createElement("div")).addClass("keel-grid distribute mainGrid"),
e=jq(document.createElement("div")).addClass("col-auto leftNavItems"),g=jq(document.createElement("div")).addClass("col-auto rightNavItems"),f=jq(document.createElement("div")).addClass("keel-grid leftNavItemsGrid"),d=jq(document.createElement("div")).addClass("keel-grid rightNavItemsGrid"),h=jq(document.createElement("div")).addClass("tabWrapper specificDate"),n=jq(document.createElement("div")).addClass("col-auto dateCol"),m=jq(document.createElement("span")).addClass("icon calendar").html('\x3csvg viewBox\x3d"0 0 13 14" xmlns\x3d"http://www.w3.org/2000/svg"\x3e\x3cpath d\x3d"M9.75 1.647h1.247c1.106 0 2.003.888 2.003 1.999v8.356A1.999 1.999 0 0 1 10.997 14H2.003A1.997 1.997 0 0 1 0 12.002V3.646a2 2 0 0 1 2.003-1.999H3.25V0h.813v1.647h4.875V0h.812v1.647zm0 .824h1.428c.558 0 1.01.446 1.01 1.007v8.691c0 .557-.446 1.007-1.01 1.007H1.822c-.558 0-1.01-.446-1.01-1.007V3.478c0-.556.446-1.007 1.01-1.007H3.25v.823h.813v-.823h4.875v.823h.812v-.823zM.812 4.94h11.376v.824H.812V4.94zM2.6 6.364h2v2h-2v-2z" fill\x3d"currentColor" fill-rule\x3d"evenodd"/\x3e\x3c/svg\x3e'),
l=jq(document.createElement("div")).addClass("tabWrapper wholeMonth"),r=jq(document.createElement("div")).addClass("col-auto dateMonth"),w=jq(document.createElement("span")).addClass("icon trend").html('\x3csvg viewBox\x3d"0 0 15 12" xmlns\x3d"http://www.w3.org/2000/svg"\x3e\x3cpath d\x3d"M0 12V5h3v7H0zm4 0V0h3v12H4zm4 0V5h3v7H8zm4 0V8h3v4h-3z" fill\x3d"currentColor" fill-rule\x3d"evenodd"/\x3e\x3c/svg\x3e'),p=jq(document.createElement("div")).addClass("col-auto plusMinus"),q=jq(document.createElement("span")).addClass("input flexPlusMinus"),
u=jq(document.createElement("div")).addClass("tabUnderlay no-transition");"undefined"!==typeof R9.storage&&(null!==R9.storage.get("daterangePickerDefaultNavTab")&&"wholeMonth"!==R9.storage.get("daterangePickerDefaultNavTab")||R9.storage.set("daterangePickerDefaultNavTab","specificDate"),this.daterangePickerDefaultNavTab=R9.storage.get("daterangePickerDefaultNavTab"),null===R9.storage.get("flexPlusMinusChecked")&&R9.storage.set("flexPlusMinusChecked",!1),this.flexPlusMinusChecked=R9.storage.get("flexPlusMinusChecked"));
"wholeMonthSearch"==this.daterangePickerDefaultNavTab?(l.addClass("selected"),u.addClass("wholeMonth"),p.hide()):(h.addClass("selected"),u.addClass("specificDate"));this.flexPlusMinusChecked&&q.addClass("checked");c.append(a.append(b.append(e.append(f.append(n.append(h.text("Date").addClass("v-c-p").prepend(m)),r.append(l.text("Flex Month").prepend(w).append(jq(document.createElement("span")).addClass("newTag").text("new"))))),g.append(d.append(p.append(jq(document.createElement("div")).addClass("likeTabWrapper").append(q.text("\u00b1 3 days")))))),
u));return c.html()},makeCalendarSelectMonthHTML:function(){"undefined"!==typeof R9.storage&&(null===R9.storage.get("flexNoOfNights")&&R9.storage.set("flexNoOfNights","6-8"),this.noOfNightsValue=R9.storage.get("flexNoOfNights"));var c=jq(document.createElement("div")),a=jq(document.createElement("div")).addClass("CalendarWidget-MonthSelect"),b=jq(document.createElement("div")).addClass("keel-grid mainGrid"),e=jq(document.createElement("div")).addClass("col"),g=jq(document.createElement("div")).addClass("col"),
f=jq(document.createElement("div")).addClass("keel-grid keel-form topColGrid"),d=jq(document.createElement("div")).addClass("keel-grid bottomColGrid"),h=jq(document.createElement("div")).addClass("col"),n=jq(document.createElement("div")).addClass("col noOfNightsInputCol"),m=jq(document.createElement("input")).addClass("Common-Widgets-Text-TextInput selectTextOnFocus noOfNightsInput").attr({type:"text",id:"noOfNightsInput",name:"noOfNightsInput",value:this.noOfNightsValue}),l=jq(document.createElement("label")).addClass("nightsAtDestination").text("nights"),
r=jq(document.createElement("div")).addClass("col subTextCol"),w=jq(document.createElement("div")).addClass("col"),p=jq(document.createElement("div")).addClass("keel-grid monthSelectGrid");c.append(a.append(b.append(e.append(f.append(h.text("Number of nights:"),n.append(m,l),r.text("Not sure how long? Use a range, like 10-12 nights."))),g.append(d.append(w.append(p))))));for(a=0;12>a;a++)"undefined"!==typeof R9.storage&&(null===R9.storage.get("flexSelectedMonth")&&R9.storage.set("flexSelectedMonth",
moment().format("M")),null===R9.storage.get("flexSelectedYear")&&R9.storage.set("flexSelectedYear",moment().format("Y")),this.flexSelectedMonth=R9.storage.get("flexSelectedMonth"),this.flexSelectedYear=R9.storage.get("flexSelectedYear")),b=jq(document.createElement("div")).addClass("col-1-3 col-1-4-l centre"),e=jq(document.createElement("div")).addClass("monthWrapper"),g=moment().add(a,"M").format("M"),f=moment().add(a,"M").daysInMonth(),d=moment().add(a,"M").format("Y"),h=jq(document.createElement("div")).addClass("monthName").text(moment().add(a,
"M").format("MMMM")),n=jq(document.createElement("div")).addClass("shortMonthName").text(moment().add(a,"M").format("MMM")),m=jq(document.createElement("div")).addClass("monthYear").text(moment().add(a,"M").format("Y")),this.flexSelectedMonth==g&&this.flexSelectedYear==d&&e.addClass("selected"),p.append(b.append(e.append(h,n,m).attr("data-month",g).attr("data-year",d).attr("data-end-of-month",f)));return c.html()},makeBelowCalendarHTML:function(){return""},runBelowCalendarCallback:function(){},makeMonthCalendarHTML:function(c,
a,b,e){var g=[];g.push("\x3cdiv class\x3d'r9-datepicker-month "+b+"'\x3e");g.push(this.makeMonthHeaderHTML(c,a,e));g.push(this.makeMonthBodyHTML(c,e));g.push("\x3c/div\x3e");return g.join("")},showMonth:function(c){var a=[];a.push("\x3cspan class\x3d'r9-datepicker-month-name'\x3e");a.push(c.format(this.options.titleMonthFormat).substring(0,1).toUpperCase()+c.format(this.options.titleMonthFormat).substring(1,this.options.titleMonthFormatLen));a.push("\x3c/span\x3e");return a.join("")},showYearWithSpecialSymbol:function(c){var a=
[],b;R9&&R9.globals&&(b=R9.globals.reverseDatePickerMonthAndYear);a.push("\x3cspan class\x3d'r9-datepicker-year'\x3e");a.push(c.format(this.options.titleYearFormat)+b+" ");a.push("\x3c/span\x3e");return a.join("")},showMonthAndYear:function(c){var a=[];a.push(this.showMonth(c));a.push(this.showYearWithSpecialSymbol(c));return a.join("")},makeMonthHeaderHTML:function(c,a,b){var e=[],g=moment().startOf("month"),f=moment().add(11,"months"),d=moment(a).startOf("month"),h=moment(a).endOf("month"),n=this.maxDate,
m=this.minDate,l=this.getStartDate&&moment(this.getStartDate()),r=this.getEndDate&&moment(this.getEndDate()),l=l&&h.isBefore(l)&&this.isPastDateAllowed(),r=r&&h.isBefore(r),m=m&&h.isBefore(m),n=n&&d.isAfter(n),g=!l&&!r&&(m||n||!this.isPastDateAllowed()&&h.isBefore(g)||d.isAfter(f));e.push("\x3cspan class\x3d'r9-datepicker-month-header'\x3e");e.push("\x3ca title\x3d'"+b+"' class\x3d'r9-datepicker-switch-month "+(g?"r9-datepicker-disabled":"r9-datepicker-enabled")+"' data-val\x3d'"+a.valueOf()+"'\x3e");
e.push(this.makeMonthHeaderPickerHTML(b));e.push("\x3c/a\x3e");e.push("\x3cspan class\x3d'r9-datepicker-month-title'\x3e");e.push(this.showMonthAndYear(c));e.push("\x3c/span\x3e");e.push("\x3c/span\x3e");return e.join("")},makeMonthHeaderPickerHTML:function(c){var a=[];a.push("\x3cspan\x3e");a.push(c);a.push("\x3c/span\x3e");return a},makeMonthBodyHTML:function(c,a){var b=[];b.push("\x3cspan class\x3d'r9-datepicker-month-body'\x3e");b.push(this.makeWeekDaysHTML(c));b.push(this.makeMonthDatesHTML(c,
a));b.push("\x3c/span\x3e");return b.join("")},makeWeekDaysHTML:function(c){c=[];c.push("\x3cspan class\x3d'r9-datepicker-month-days'\x3e");for(var a=0+this.getFirstWeekDay();a<7+this.getFirstWeekDay();a++){var b=a%7;c.push("\x3cspan class\x3d'r9-datepicker-day'\x3e");c.push(this.getVeryShortDayName(b));c.push("\x3c/span\x3e")}c.push("\x3c/span\x3e");return c.join("")},makeMonthDatesHTML:function(c,a){var b=[];b.push("\x3cspan class\x3d'r9-datepicker-month-dates'\x3e");var e=this.getMonthLeadDays(c),
g=this.getDaysInMonth(c),f=moment().startOf("day"),d=moment(c).subtract(1,"months").startOf("month"),h=d.daysInMonth(),n=moment(c).add(1,"months").startOf("month"),m=moment(f).add(1,"year"),l=this.maxDate,r,w,p,q,u=this.minDate,t=1;a=a.toLowerCase();this.getStartDate&&this.getStartDate();for(var v=0;42>v;v++){r=v-e+1;q=moment([c.year(),c.month(),r]);w=v%7;p=Math.ceil((v+1)/7);0==w&&b.push("\x3cspan class\x3d'r9-datepicker-month-row "+(this.loadBuzzData?this.buzzDataClass:"")+"' aria-label\x3d'Week "+
p+"' role\x3d'week'\x3e");if(v<e&&"prev"===a&&!this.advanceStyling){var x=moment([d.year(),d.month(),h+v-e+1]);p="r9-datepicker-item r9-datepicker-othermonth-item";p=(q.isBefore(f)||q.isAfter(m))&&!this.isPastDateAllowed()||u&&q.isBefore(u)||l&&q.isAfter(l)?p+" r9-datepicker-disabled":p+" r9-datepicker-enabled";this.addGraphBar(!1,x.valueOf());b.push("\x3cspan role\x3d'gridcell' class\x3d'"+p+"' data-val\x3d'"+x.valueOf()+"'\x3e");b.push("\x3cspan\x3e"+(h+v-e+1));this.loadBuzzData&&(this.buzzPrices?
b.push("\x3cspan class\x3d'buzz-price'\x3e\x3c/span\x3e"):(b.push("\x3cspan class\x3d'buzz-message'\x3eGreat price\x3c/span\x3e"),b.push("\x3ci\x3e\x3c/i\x3e")));b.push("\x3c/span\x3e\x3c/span\x3e")}else if(v>=e+g&&"next"===a&&!this.advanceStyling)x=moment([n.year(),n.month(),t]),p="r9-datepicker-othermonth-item r9-datepicker-item",p=(q.isBefore(f)||q.isAfter(m))&&!this.isPastDateAllowed()||u&&q.isBefore(u)||l&&q.isAfter(l)?p+" r9-datepicker-disabled":p+" r9-datepicker-enabled",b.push("\x3cspan role\x3d'gridcell' class\x3d'"+
p+"' data-val\x3d'"+x.valueOf()+"'\x3e"),b.push("\x3cspan\x3e"+t++),this.loadBuzzData&&(this.buzzPrices?b.push("\x3cspan class\x3d'buzz-price'\x3e\x3c/span\x3e"):(b.push("\x3cspan class\x3d'buzz-message'\x3eGreat price\x3c/span\x3e"),b.push("\x3ci\x3e\x3c/i\x3e"))),b.push("\x3c/span\x3e\x3c/span\x3e"),this.addGraphBar(!1,x.valueOf());else if(v>=e+g&&("next"!==a||this.advanceStyling))break;else v<e&&("Prev"!==a||this.advanceStyling)?b.push("\x3cspan role\x3d'gridcell' class\x3d'r9-datepicker-item r9-datepicker-disabled'\x3e\x3cspan\x3e\x26nbsp;\x3c/span\x3e\x3c/span\x3e"):
(p="r9-datepicker-item",(q.isBefore(f)||q.isAfter(m))&&!this.isPastDateAllowed()||u&&q.isBefore(u)||l&&q.isAfter(l)?(p+=" r9-datepicker-disabled",x=!1):(p+=" r9-datepicker-enabled",x=!0),q.isSame(f)&&(p+=" r9-datepicker-today"),b.push("\x3cspan role\x3d'gridcell' class\x3d'"+p+"' "),this.addGraphBar(x,q.valueOf()),b.push("data-val\x3d'"+q.valueOf()+"'"),b.push("\x3e\x3cspan\x3e"),b.push(r),this.loadBuzzData&&(this.buzzPrices?b.push("\x3cspan class\x3d'buzz-price'\x3e\x3c/span\x3e"):(b.push("\x3cspan class\x3d'buzz-message'\x3eGreat price\x3c/span\x3e"),
b.push("\x3ci\x3e\x3c/i\x3e"))),b.push("\x3c/span\x3e\x3c/span\x3e"));if(6==w&&(b.push("\x3c/span\x3e"),r===g||1<t))break}b.push("\x3c/span\x3e");return b.join("")},getFirstWeekDay:function(){return moment().startOf("week").day()},getVeryShortDayName:function(c){return moment().day(c).format("dd").substring(0,this.options.shortDayNameLen)},getMonthLeadDays:function(c){c=this.getFirstMonthDay(c)-this.getFirstWeekDay();0>c&&(c=6);return c},getFirstMonthDay:function(c){c=moment(c);c.startOf("month");
return c.day()},getDaysInMonth:function(c){return c.daysInMonth()},insideLastCalendar:function(c){return!!this.dropdown.find(".r9-datepicker-item-"+c).closest(".r9-datepicker-month").hasClass("r9-datepicker-month-last")},isPastDateAllowed:function(){return"undefined"!=this.options.allowPastDate?this.options.allowPastDate:!1},addGraphBar:function(c,a){this.options.showBuzzGraph&&(c=jq("\x3cdiv\x3e",{"class":"r9-datepicker-buzz-day "+(c?"r9-datepicker-enabled":"r9-datepicker-disabled"),"data-val":a}),
c.append(jq("\x3cdiv\x3e",{"class":"r9-datepicker-buzz-bar"})),this.buzzGraph.append(c))}}})(jq||jQuery);
(function(d){function c(a,b,e){var c,f,d,h,n,m=Date.now||function(){return(new Date).getTime()},l=function(){var g=m()-h;g<b&&0<=g?c=setTimeout(l,b-g):(c=null,e||(n=a.apply(d,f),c||(d=f=null)))};return function(){d=this;f=arguments;h=m();var g=e&&!c;c||(c=setTimeout(l,b));g&&(n=a.apply(d,f),d=f=null);return n}}R9.extend("Widgets",{DaterangePicker:function(a,b){R9.Widgets.BaseCalendarWidget.apply(this);this.elementNode=a;this.element=d(this.elementNode);this.validateElement()&&(this.startSection=d(R9.Widgets.DaterangePicker.findStartSection(this.elementNode)),
this.startDisplay=d(R9.Widgets.DaterangePicker.findStartDisplay(this.elementNode)),this.startPlaceholderDisplay=d(R9.Widgets.DaterangePicker.findStartPlaceholderDisplay(this.elementNode)),this.endSection=d(R9.Widgets.DaterangePicker.findEndSection(this.elementNode)),this.endDisplay=d(R9.Widgets.DaterangePicker.findEndDisplay(this.elementNode)),this.endPlaceholderDisplay=d(R9.Widgets.DaterangePicker.findEndPlaceholderDisplay(this.elementNode)),this.summaryDisplay=d(R9.Widgets.DaterangePicker.findSummaryDisplay(this.elementNode)),
this.clearDisplay=d(R9.Widgets.DaterangePicker.findClearDisplay(this.elementNode)),this.closeLink=d(R9.Widgets.DaterangePicker.findCloseLink(this.elementNode)),this.tabInput=d(R9.Widgets.DaterangePicker.findTabInput(this.elementNode)),this.startInput=d(R9.Widgets.DaterangePicker.findStartInput(this.elementNode)),this.endInput=d(R9.Widgets.DaterangePicker.findEndInput(this.elementNode)),this.options=d.extend({},this.options,b),this.init())}});R9.extend("Widgets.DaterangePicker",{isDatepicker:function(a){return a&&
a.nodeName&&"div"==a.nodeName.toLowerCase()},isWidgetControlled:function(a){return d(a).hasClass(R9.Widgets.DaterangePicker.prototype.widgetBaseClass+"-wrapper")},findStartSection:function(a){return d(a).closest("form").find("#"+a.id+"-start")},findStartDisplay:function(a){return d(a).closest("form").find("#"+a.id+"-start-display")},findStartPlaceholderDisplay:function(a){return d(a).closest("form").find("#"+a.id+"-start-placeholder")},findEndSection:function(a){return d(a).closest("form").find("#"+
a.id+"-end")},findEndDisplay:function(a){return d(a).closest("form").find("#"+a.id+"-end-display")},findEndPlaceholderDisplay:function(a){return d(a).closest("form").find("#"+a.id+"-end-placeholder")},findSummaryDisplay:function(a){return d(a).closest("form").find("#"+a.id+"-summary-display")},findClearDisplay:function(a){return d(a).closest("form").find("#"+a.id+"-clear")},findCloseLink:function(a){return d(a).closest("form").find("#"+a.id+" .r9-datepicker-title-close")[0]},findStartInput:function(a){return d(a).closest("form").find("#"+
a.id+" .r9-datepicker-input.r9-datepicker-start")[0]},findEndInput:function(a){return d(a).closest("form").find("#"+a.id+" .r9-datepicker-input.r9-datepicker-end")[0]},findTabInput:function(a){return d(a).closest("form").find("#"+a.id+"-tab")},getDropdownId:function(a){return"datepicker"},getDropdownEl:function(a){return jq(a).find("#datepicker")}});R9.extend("Widgets.DaterangePicker.prototype",!0,R9.Widgets.BaseCalendarWidget.prototype,{widgetName:"datepicker",widgetId:"datepicker",widgetBaseClass:"r9-datepicker",
accessibilityBreakpoint:768,elementNode:null,element:null,startSection:null,startDisplay:null,startPlaceholderDisplay:null,endSection:null,endDisplay:null,endPlaceholderDisplay:null,summaryDisplay:null,clearDisplay:null,closeLink:null,startInput:null,endInput:null,tabInput:null,clicks:[],timers:null,hideTimeoutValue:100,unitFormat:null,unitAdjustment:0,preventBlur:!1,actOnStart:!0,buzzCall:!1,canShowCalendar:!0,canCloseCalendar:!0,options:{initAccessibility:!1,accessible:!0,appendTo:"body",dateItemsSelector:"span.r9-datepicker-item",
shortDayNameLen:1,title:"Prev",prevTitle:"Prev",nextTitle:"Next",offsetWidth:0,titleMonthFormat:"MMMM",titleYearFormat:"YYYY",startFormat:"ddd MMM D",startInputFormat:"YYYY/M/D",endFormat:"ddd MMM D",endInputFormat:"YYYY/M/D",nightsFormat:"0#same day|1#{0} night|2#{0} nights",daysFormat:"0#same day|1#{0} day|2#{0} days",useDaysFormat:!1,secondClickHideDelay:200,minRangeDays:0,change:null,show:null,hide:null,minDateFunc:null,focusAfterClick:!0,allowPastDate:!1,widgetId:null,useLongDisplayFormat:!1,
singlePickerWithSingleField:!1,showBuzzGraph:!1,originControl:!1,destControl:!1,isOneWay:!1,skipForceSetDefaultStartOnFocusBlur:!1,skipForceSetDefaultEndOnFocusBlur:!1,doNotFillWhenEmpty:!1,datepickerWrapperSelector:".r9-datepicker-wrapper",handleNegativeSummary:!0,delayShowDropdown:null,showDropdownDelay:200},getWidgetId:function(){this.options&&this.options.widgetId&&(this.widgetId=this.options.widgetId);return this.widgetId},getDropdownId:function(a){return this.options&&this.options.widgetId?
this.options.widgetId:R9.Widgets.DaterangePicker.getDropdownId(a)},getDropdownEl:function(a){return this.options&&this.options.widgetId?jq(a).find("#"+this.options.widgetId):R9.Widgets.DaterangePicker.getDropdownEl(a)},isAccessibilityEnabled:function(){return this.options.initAccessibility},init:function(){this.options.useDaysFormat?(this.unitFormat=this.options.daysFormat,this.unitAdjustment=1):(this.unitFormat=this.options.nightsFormat,this.unitAdjustment=0);this.options.useLongDisplayFormat&&(this.options.startFormat=
this.options.startInputFormat,this.options.endFormat=this.options.endInputFormat);this.advanceStyling&&(this.options.skipForceSetDefaultStartOnFocusBlur=!0,this.options.skipForceSetDefaultEndOnFocusBlur=!0,this.options.doNotFillWhenEmpty=!0);this.options.offsetWidth=2;this.initDropdown();this.timers={};this.bindEvent(this.tabInput,"focus",this.handleInputFocusEvent);this.bindEvent(this.tabInput,"blur",this.handleInputBlurEvent);this.bindEvent(this.tabInput,"keydown",this.handleInputKeydownEvent);
this.bindEvent(this.element,"mousedown",this.handleElementClickEvent);this.endStartIsSameField()||this.bindEvent(this.endSection,"mousedown",this.handleEndClickEvent);this.bindEvent(this.startSection,"mousedown",this.handleStartClickEvent);this.bindEvent(this.clearDisplay,"mousedown",this.handleClearClickEvent);this.bindEvent(this.closeLink,"mousedown",this.handleClearClickEvent);this.bindEvent(this.dropdown,"mousedown",this.handleDropdownClickEvent);this.bindEvent(this.overlay,"mousedown",this.handleItemClickEvent);
this.element.data(this.widgetName,this);this.update();var a=this.element.find(".r9-datepicker-display");void 0!==a&&1<a.length||(this.element.off("mousedown focus").on("mousedown focus",function(a){a.preventDefault();a.stopPropagation();jq(this).find(".r9-datepicker-display").focus();jq("body").trigger("event",[a])}),this.bindCommandUtilities(),this.start_custom_value=this.end_custom_value="",this.utils=this.options.commands.utilities,this.today=moment().startOf("day").toDate(),this.bindAccessibilityEvents(),
this.updateClicks(),this.updateDOM())},validateElement:function(){return R9.Widgets.DaterangePicker.isDatepicker(this.elementNode)&&R9.Widgets.DaterangePicker.isWidgetControlled(this.elementNode)&&void 0===this.element.data(this.widgetName)},bindEvent:function(a,b,e){var c=this;b+="."+this.getWidgetId();a.off(b).on(b,function(a){return e.call(c,this,a)})},bindCommandUtilities:function(){var a=this;this.options.commands={keys:{TAB:9,ENTER:13,UP:38,DOWN:40,LEFT:37,RIGHT:39,DOLLAR:52,CARAT:54,ESC:27},
utilities:{changeCalendar:function(b,e){e=e||1;var c=a.dropdown.find(".r9-datepicker-switch-month.r9-datepicker-enabled"),c="prev"===b?c.first():c.last();for(b=Math.abs(e);0<b;b--)a.handleNextPrevClickEvent(c);return a},isCharacterKeyPress:function(b){var e=a.options.commands.keys;return"undefined"==typeof b.which?!0:"number"==typeof b.which&&0<b.which?!b.ctrlKey&&!b.metaKey&&!b.altKey&&b.keyCode!=e.TAB&&b.keyCode!=e.ENTER&&16!=b.keyCode&&b.keyCode!=e.UP&&b.keyCode!=e.DOWN&&b.keyCode!=e.LEFT&&b.keyCode!=
e.RIGHT:!1},getRowInfo:function(b){b=a.dropdown.find(".r9-datepicker-item-"+b);var e=b.parent().children().not(".r9-datepicker-disabled");return{len:e.length-1,index:e.index(b)}},isValidDateObject:function(a){return a instanceof Date?!isNaN(a.getTime()):this.isValidDate(new Date(a))},isValidDatePair:function(a,e){return moment(a).isBefore(moment(e))},isValidDate:function(b){return this.isValidDateObject(b)&&(this.isValidDatePair(moment().subtract(1,"d"),moment(b))||a.isPastDateAllowed())},applyEndVal:function(){if(""!==
a.end_custom_value&&moment(a.end_custom_value,a.options.endInputFormat).isValid()){var b=this.formatLocaleDate(a.end_custom_value,a.options.endInputFormat);if(b&&this.isValidDate(b)){var e=a.getStartDate()||a.today;this.isValidDatePair(e,b)&&a.setEndDate(b);a.fetchBuzzData();a.options.change&&a.options.change.call(a);a.end_custom_value=""}}},applyStartVal:function(){if(""!==a.start_custom_value&&moment(a.start_custom_value,a.options.startInputFormat).isValid()){var b=this.formatLocaleDate(a.start_custom_value,
a.options.startInputFormat);if(b&&this.isValidDate(b)){a.setStartDate(b);var e=a.getEndDate()||a.today;this.isValidDatePair(b,e)||a.setEndDate(b);a.start_custom_value="";a.fetchBuzzData();a.options.change&&a.options.change.call(a)}}},validate:function(b){b=b||moment().startOf("day").toDate();return!a.isPastDateAllowed()&&b.getTime()<=a.today.getTime()?a.today:b},formatLocaleDate:function(b,e){e=e||a.options.startInputFormat;try{var c=b.split(/\D+/g)[2];4!==c.length&&(b=b.substr(0,b.length-2)+"20"+
c);return moment(b,e).toDate()}catch(f){return new Date}},incrementDay:function(b,e,c){c=c||jq.noop;b=moment(b).add(e||1,"days");c.call(a,this.validate(b.toDate()));return b},decrementDay:function(b,e,c){c=c||jq.noop;b=moment(b).subtract(e||1,"days");c.call(a,this.validate(b.toDate()));return b},dateDiff:function(a,e){return(a.getTime()-e.getTime())/864E5}}};this.utils=this.options.commands.utilities;return this},bindAccessibilityEvents:function(){var a=this;this.options.accessible="true"===jq(this.startDisplay).attr("contenteditable");
jq(this.startDisplay).attr("aria-label")||jq(this.startDisplay).attr({"aria-label":this.options.startLabel||"Start Date"});jq(this.endDisplay).attr("aria-label")||jq(this.endDisplay).attr({"aria-label":this.options.endLabel||"End Date"});this.clickTarget=this.blurTarget=null;jq(document).mousedown(function(b){a.clickTarget=jq(b.target);a.isDropdownVisible()&&jq(a.blurTarget).blur()}).mouseup(function(b){a.clickTarget=null});this.endStartIsSameField()||(this.bindEvent(this.endDisplay,"focus",this.handleEndDisplayFocusEvent),
this.bindEvent(this.endDisplay,"blur",this.handleEndDisplayBlurEvent),this.bindEvent(this.endDisplay,"keydown",this.handleEndDisplayKeydownEvent),this.bindEvent(this.endDisplay,"keyup",this.handleEndDisplayKeyupEvent));this.bindEvent(this.startDisplay,"focus",this.handleStartDisplayFocusEvent);this.bindEvent(this.startDisplay,"blur",this.handleStartDisplayBlurEvent);this.bindEvent(this.startDisplay,"keydown",this.handleStartDisplayKeydownEvent);this.bindEvent(this.startDisplay,"keyup",this.handleStartDisplayKeyupEvent);
this.isAccessibilityEnabled()&&(this.bindEvent(jq(document),"keypress",this.handleItemKeypressEvent),this.bindEvent(jq(document),"click",this.handleOutsideClickEvent))},handleClearClickEvent:function(a,b){this.clearDaterange();b.stopPropagation();this.fetchBuzzData();this.options.change&&this.options.change.apply(this,arguments);jq("body").trigger("event",[b]);return!this.element.hasClass("r9-datepicker-focus")},handleElementClickEvent:function(a,b){return this.isDropdownVisible()?this.handleClickEvent(a,
b,this.actOnStart):this.handleStartClickEvent(a,b)},handleStartClickEvent:function(a,b){return this.handleClickEvent(a,b,!0)},handleEndClickEvent:function(a,b){return this.handleClickEvent(a,b,!1)},handleClickEvent:function(a,b,e){this.actOnStart=e;var c=this.getWrapperElement(),f=this;!this.isDropdownVisible()&&this.options.focusAfterClick?setTimeout(function(){f.isDropdownVisible()||c.find(".r9-datepicker-tab").focus()},1):(this.markDropdownElements(),this.preventBlur=!0);b.stopPropagation();jq("body").trigger("event",
[b]);return!0},getWrapperElement:function(){return this.element},getStartWrapperElement:function(){return this.element},getEndWrapperElement:function(){return this.element},handleDropdownClickEvent:function(a,b){return!1},handleInputKeydownEvent:function(a,b){if(!a.disabled){var e=b.keyCode?b.keyCode:b.which,c=jq(a).parent();switch(e){case 9:return!0;case 27:this.isDropdownVisible()&&this.hideDropdown(c);break;case 32:this.isDropdownVisible()?this.hideDropdown(c):(this.actOnStart=!0,this.showDropdown(c));
break;case 8:this.clearDaterange(),this.fetchBuzzData(),this.options.change&&this.options.change.apply(this,arguments)}return!1}},handleInputFocusEvent:function(a,b){if(!a.disabled){this.preventBlur=!1;var e=jq(a).parent();this.addFocusClass(e);this.isDropdownVisible()||this.showDropdown(e);this.options.focus&&this.options.focus.apply(this,arguments)}},handleInputBlurEvent:function(a,b){if(this.preventBlur)return this.preventBlur=!1,setTimeout(function(){a.focus()},1),!1;if(a.disabled)return!0;this.hideDropdown(jq(a).parent());
this.options.blur&&this.options.blur.apply(this,arguments);return!0},handleItemHoverEvent:function(a,b){a=jq(a);a.hasClass("r9-datepicker-enabled")&&this.updateDropdownSelection(a);jq(".r9-datepicker-buzz-day[data-val\x3d%s]".format(a.attr("data-val"))).addClass("hover");return!1},handleItemHoverEndEvent:function(a,b){this.updateDropdownSelection(null);jq(".r9-datepicker-buzz-day[data-val\x3d%s]".format(jq(a).attr("data-val"))).removeClass("hover");return!1},handleItemKeypressEvent:function(a,b){if(13===
b.which&&jq(b.target).is(this.options.dateItemsSelector))return a=jq(b.target).closest(this.options.dateItemsSelector),b.stopPropagation(),b.preventDefault(),b.cancelBubble=!0,this.clickTarget=a,this.handleItemClickEvent(a,b),!1;if(13===b.which&&jq(b.target).is(".r9-datepicker-switch-month.r9-datepicker-enabled"))return a=jq(b.target).closest(".r9-datepicker-switch-month.r9-datepicker-enabled"),b.stopPropagation(),b.preventDefault(),b.cancelBubble=!0,this.clickTarget=a,this.handleNextPrevClickEvent(a,
b),!1},handleOutsideClickEvent:function(a,b){this.clickTarget=d(b.target);this.isDropdownVisible()&&!this.clickTarget.closest(".r9-datepicker, .r9-datepicker-wrapper").length&&(this.clickTarget=null,b.stopPropagation(),this.hideDropdown())},focusSelectedDay:function(a){var b=this;this.isAccessibilityEnabled()&&a&&a.length&&(this.clickTarget=null,this.dropdown.attr("tabindex",-1),this.dropdown.removeClass("r9-calendar-no-outline").addClass("r9-calendar-no-outline"),this.setTabIndexes(this.dropdown.find(".r9-datepicker-switch-month.r9-datepicker-enabled, .r9-datepicker-item.r9-datepicker-enabled")),
this.timers.focusTimeout&&clearTimeout(this.timers.focusTimeout),b.setCanClose(!1),this.timers.focusTimeout=window.setTimeout(function(){var e=b.isEndWrapper(a)?b.dropdown.find(".r9-datepicker-item-end"):b.dropdown.find(".r9-datepicker-item-start");e.length||(e=b.dropdown.find(".r9-datepicker-item.r9-datepicker-enabled").first()||null);e&&e.length&&e.focus();b.timers.setCanClose&&clearTimeout(b.timers.setCanClose);b.timers.setCanClose=setTimeout(function(){b.setCanClose(!0)},200)},300))},isEndWrapper:function(a){return a&&
this.isEndWrapperId(a.attr("id"))},isEndWrapperId:function(a){return a&&"travel_dates-end-wrapper"==a},setTabIndexes:function(a){(a=jq(a))&&0!==a.length&&a.each(function(){jq(this).attr("tabindex","0")})},focusDisplay:function(a){var b=this;if(this.isAccessibilityEnabled()){var e=jq("#"+a);e&&0!==e.length&&(this.timers.focusDisplayTimeout&&clearTimeout(this.timers.focusDisplayTimeout),!this.isDropdownVisible()&&this.clickTarget&&this.clickTarget.closest(".r9-datepicker").length&&(this.clickTarget=
null,this.addFocusClass(e),this.setCanShow(!1),this.setCanClose(!1),this.timers.focusDisplayTimeout=window.setTimeout(function(){e.find(".r9-datepicker-tab").focus();b.timers.setCanShow&&clearTimeout(b.timers.setCanShow);b.timers.setCanShow=setTimeout(function(){b.setCanShow(!0);b.setCanClose(!0)},200)},1)))}},canShow:function(){return!this.isAccessibilityEnabled()||this.canShowCalendar},setCanShow:function(a){this.canShowCalendar=a},canClose:function(){return!this.isAccessibilityEnabled()||this.canCloseCalendar},
setCanClose:function(a){this.canCloseCalendar=a},clearFocusClass:function(){this.removeFocusClass(jq(".r9-datepicker-focus"))},removeFocusClass:function(a){a.removeClass("r9-datepicker-focus")},addFocusClass:function(a){this.clearFocusClass();a.addClass("r9-datepicker-focus")},handleItemClickEvent:function(a,b){if(!0===this.isBeforeStart(a)&&!1===this.actOnStart)return this.preventBlur=!0,b.preventDefault(),this;var e=this,c=jq(a),f,d;if(c.hasClass("r9-datepicker-enabled")){f=parseInt(c.attr("data-val"));
var h=this.actOnStart;d=h?1:0;this.clicks[h?0:1]=f;this.clicks[0]&&this.clicks[1]&&(c=moment(this.clicks[1]).diff(this.clicks[0],"days"),c<this.options.minRangeDays&&(this.clicks[d]=0));this.updateDropdownSelection(null);this.clicks[0]&&this.clicks[1]?setTimeout(function(){e.hideDropdown(e.element);e.options.change&&e.options.change.apply(e,[f,h]);e.options.nextFieldSelector&&jq(e.options.nextFieldSelector).focus()},this.options.secondClickHideDelay):this.switchActOn()}this.updateDOM();jq(a).trigger("daterangepicker.itemclicked");
jq("body").trigger("event",[b]);return!1},switchActOn:function(){this.actOnStart=!this.actOnStart;this.markDropdownElements()},computeHighlitedRange:function(a){var b=[this.clicks[0],this.clicks[1]];return b[0]&&b[1]?b:0==a?[0,0]:this.actOnStart?[a,this.clicks[1]]:this.clicks[0]?[this.clicks[0],a]:[0,0]},computeItemState:function(a,b,e,c,f){var g=!1;this.advanceStyling||(a==b?this.actOnStart?(c.hover=!0,c.start=!0):(c.hover=!0,c.end=!0,c.highlighted=f&&f.highlighted):(c.beforeStart=a<this.clicks[0]&&
!this.actOnStart,a==this.clicks[0]?(c.start=!0,c.selected=!0):a==this.clicks[1]&&(c.selected=!0,c.end=!0,c.highlighted=f&&f.highlighted,f&&f.selected&&(c.tight=!0,g=f.tight=!0)),a>e[0]&&a<e[1]&&(c.highlighted=!0,f&&f.start&&(g=f.highlighted=!0))));this.advanceStyling&&(delete c.beforeStart,delete c.hover,a>e[0]&&a<e[1]&&(c.highlighted=!0),a===this.clicks[0]&&(c.start=!0,c.selected=!0),a===this.clicks[1]&&(c.selected=!0,c.end=!0),0<b&&(e=this.getStateStartPoint(b),(this.actOnStart&&e===this.clicks[0]||
!this.actOnStart&&e===this.clicks[1])&&e&&(f=Math.max(e,b),a>Math.min(e,b)&&a<f&&(c.tempHighlight=!0))));return g},getStateStartPoint:function(a){var b=[],e=!0,c=!0,f=this.clicks[0];0<f&&(e=e&&f<a,c=c&&f>a,b.push(f));f=this.clicks[1];0<f&&(e=e&&f<a,c=c&&f>a,b.push(f));a=e?Math.max.apply(null,b):Math.min.apply(null,b);e=!(!1===c&&!1===e);return isFinite(a)?e?a:0:null},updateItem:function(a,b){var e,c;e=[];c=[];b.highlighted?e.push("r9-datepicker-item-highlighted"):c.push("r9-datepicker-item-highlighted");
b.hover?e.push("r9-datepicker-item-hover"):c.push("r9-datepicker-item-hover");b.selected?(e.push("r9-datepicker-item-selected"),a.attr("aria-selected",!0)):(c.push("r9-datepicker-item-selected"),a.attr("aria-selected",!1));b.start?e.push("r9-datepicker-item-start"):c.push("r9-datepicker-item-start");b.beforeStart?e.push("r9-datepicker-before-start"):c.push("r9-datepicker-before-start");b.end?e.push("r9-datepicker-item-end"):c.push("r9-datepicker-item-end");b.tight?e.push("r9-datepicker-item-tight"):
c.push("r9-datepicker-item-tight");this.advanceStyling&&(b.tempHighlight?e.push("r9-datepicker-item-tempHighlight"):c.push("r9-datepicker-item-tempHighlight"));a.removeClass(c.join(" "));a.addClass(e.join(" "))},updateDropdownSelection:function(a){if(!this.advanceStyling&&!0===this.isBeforeStart(a)&&!1===this.actOnStart)return this;var b=this,c=[0,0],g=null,f=null,d=this.dropdown.find(this.options.dateItemsSelector),h=0;a&&(h=parseInt(jq(a).attr("data-val")));c=this.computeHighlitedRange(h);d.each(function(a,
e){e=jq(e);a=parseInt(e.attr("data-val"));var d={};b.computeItemState(a,h,c,d,f)&&b.updateItem(g,f);b.updateItem(e,d);g=e;f=d});this.updateHoverDOM(a)},clearDaterange:function(a){"undefined"!=typeof a?this.clicks[a]=0:this.clicks=[0,0];this.isDropdownVisible()&&this.updateDropdownSelection();this.updateDOM()},updateHoverDOM:function(a){var b,c,d,f;c=this.clicks[0];d=this.clicks[1];a&&(b=parseInt(a.attr("data-val")),this.actOnStart?c=b:d=b);c?(f=moment(c),this.startDisplay.text(f.format(this.options.startFormat)),
this.getStartWrapperElement().removeClass("r9-datepicker-start-empty")):this.getStartWrapperElement().addClass("r9-datepicker-start-empty");d?(b=moment(d),this.endDisplay.text(b.format(this.options.endFormat)),this.summaryDisplay&&(f=b.diff(f,"days"),(b=this.options.handleNegativeSummary&&0>f)&&a&&this.actOnStart?(this.endDisplay.text(this.endPlaceholderDisplay.text()),this.summaryDisplay.text("")):b||this.summaryDisplay.text(R9.Common.Utils.String.formatChoice(this.unitFormat,f+this.unitAdjustment,
f+this.unitAdjustment))),this.getEndWrapperElement().removeClass("r9-datepicker-end-empty")):this.getEndWrapperElement().addClass("r9-datepicker-end-empty")},updateDOM:function(){var a,b,c;if(0!=this.clicks[0]){if(a=moment(this.clicks[0]),this.startDisplay.text(a.format(this.options.startFormat)),this.startInput.val(a.format(this.options.startInputFormat)),this.wholeMonthSearch){var d,f;"wholeMonthSearch"==("undefined"!==typeof R9.storage.get("daterangePickerDefaultNavTab")?R9.storage.get("daterangePickerDefaultNavTab"):
"specificDate")&&jq(".searchform.rtow").hasClass("roundtrip")&&("undefined"!==typeof R9.storage&&(null===R9.storage.get("flexSelectedMonth")&&R9.storage.set("flexSelectedMonth",moment(this.clicks[0]).format("M")),null===R9.storage.get("flexSelectedYear")&&R9.storage.set("flexSelectedYear",moment(this.clicks[0]).format("Y")),null===R9.storage.get("flexNoOfNights")&&R9.storage.set("flexNoOfNights","6-8"),d=R9.storage.get("flexSelectedMonth"),f=R9.storage.get("flexSelectedYear"),c=R9.storage.get("flexNoOfNights")),
a=moment(new Date(f,d-1,1)),a.isBefore(moment())&&(a=moment().add(1,"d")),d="string"===typeof c?c.replace("-"," to "):c,c=1==c?"night":"nights",this.startDisplay.text(a.format("MMMM")+" "+a.format("Y")+", "+d+" "+c),this.startInput.val(a.format(this.options.startInputFormat)))}}else this.startDisplay.text(""),this.startInput.val("");this.endStartIsSameField()||(0!=this.clicks[1]?(b=moment(this.clicks[1]),this.endDisplay.text(b.format(this.options.endFormat)),this.endInput.val(b.format(this.options.endInputFormat))):
(this.endDisplay.text(""),this.endInput.val("")));this.summaryDisplay&&(null!=a&&null!=b?(c=b.diff(a,"days"),this.summaryDisplay.text(R9.Common.Utils.String.formatChoice(this.unitFormat,c+this.unitAdjustment,c+this.unitAdjustment))):this.summaryDisplay.text(""));null==a?this.getStartWrapperElement().addClass("r9-datepicker-start-empty"):this.getStartWrapperElement().removeClass("r9-datepicker-start-empty");this.endStartIsSameField()||(null==b?this.getEndWrapperElement().addClass("r9-datepicker-end-empty"):
this.getEndWrapperElement().removeClass("r9-datepicker-end-empty"))},endStartIsSameField:function(){var a=this.getStartWrapperElement().get(0).id,b=this.getEndWrapperElement().get(0).id;return a===b&&!0===this.options.singlePickerWithSingleField},updateClicks:function(){this.clicks=[0,0];var a;this.startInput.val()&&(a=moment(this.startInput.val(),this.options.startInputFormat),null!=a&&a.isValid()&&(this.clicks[0]=a.valueOf()));this.endInput.val()&&(a=moment(this.endInput.val(),this.options.endInputFormat),
null!=a&&a.isValid()&&(this.clicks[1]=a.valueOf()))},handleNextPrevClickEvent:function(a,b){a=moment(parseInt(jq(a).attr("data-val")));this.dropdown[0].innerHTML=this.makeCalendarHTML(a);this.runBelowCalendarCallback();this.options.showBuzzGraph&&(this.bindBuzzGraphEvents(),this.displayBuzzGraph());this.updateDropdownSelection(null);this.loadBuzzData&&this.displayBuzzData();this.focusSelectedDay(jq("#"+this.dropdown.prop("data-owner")));return!1},bindItemEvent:function(a,b){var c=this;this.dropdown.off(a,
this.options.dateItemsSelector).on(a,this.options.dateItemsSelector,function(a){return b.call(c,this,a)})},bindOverlayEvent:function(a,b){var c=this;this.overlay.off(a).on(a,function(a){return b.call(c,this,a)})},bindNextPrevEvent:function(a,b){var c=this;this.dropdown.off(a,".r9-datepicker-switch-month.r9-datepicker-enabled").on(a,".r9-datepicker-switch-month.r9-datepicker-enabled",function(a){return b.call(c,this,a)})},bindCloseEvent:function(a,b){var c=this;this.dropdown.off(a,".r9-datepicker-close").on(a,
".r9-datepicker-close",function(a){return b.call(c,this,a)})},initDropdown:function(){var a=this.getDropdownId(this.element),b=this.getDropdownEl(this.element).get(0);if(null==b){var c=R9.Widgets.DaterangePicker.prototype.widgetBaseClass;this.options.dropdownClass&&(c=c+" "+this.options.dropdownClass);b=jq("\x3cdiv\x3e\x3c/div\x3e",{id:a,css:{display:"none",position:"absolute",zIndex:10009}}).appendTo(this.options.appendTo)[0];jq(b).addClass(c);this.advanceStyling&&jq(b).addClass("r9-advance-styling");
this.wholeMonthSearch&&jq(b).addClass("CalendarWidget-WholeMonthSearch")}this.dropdown=jq(b);this.overlay=jq("#"+this.widgetBaseClass+"-overlay");this.overlay.length||(this.overlay=jq('\x3cdiv id\x3d"'+this.widgetBaseClass+'-overlay" class\x3d"'+this.widgetBaseClass+'-overlay"\x3e\x3c/div\x3e').appendTo(this.options.appendTo))},debounceChangeFn:function(){this._debouncedChange&&this._debouncedChange.apply(this,arguments);this._debouncedChange=c(this.options.change||function(){},20);this._debouncedChange.apply(this,
arguments)},isDropdownVisible:function(){return"none"!=this.dropdown.css("display")},markDropdownElements:function(){this.unmarkDropdownElements();this.element.addClass("r9-datepicker-dropdown");this.actOnStart?this.element.addClass("r9-datepicker-dropdown-start"):this.element.addClass("r9-datepicker-dropdown-end")},unmarkDropdownElements:function(){this.element.removeClass("r9-datepicker-dropdown r9-datepicker-dropdown-start r9-datepicker-dropdown-end")},positionDropdown:function(a){var b=a.offset(),
c=jq(this.options.appendTo).offset(),d=0,f=this.dropdown[0].style;this.dropdown.parent()[0]===jq(document.body)[0]&&(d=parseInt((jq(document.body).css("top")||"0").replace("-",""))||0);jq("#datepicker").removeClass("r9-datepicker-responsive-right-position");if(606>jq(window).width()&&jq(".fdSearchForm-hotel").length&&jq("#travel_dates-end-wrapper").hasClass("r9-datepicker-focus")){jq("#datepicker").addClass("r9-datepicker-responsive-right-position");var k=b.left-c.left-144}else{var k=b.left-c.left,
h=k+this.dropdown.outerWidth();h>window.innerWidth&&(h-=window.innerWidth,k=k-h-15,this.dropdown.find(".r9-datepicker-pointer").css("left",h+36+"px"))}f.left=k+"px";f.top=d+b.top+a.outerHeight()-c.top+"px"},_hideDropdown:function(a){if("none"==this.dropdown.css("display")||null!=a&&this.dropdown.prop("data-owner")!=a.attr("id"))return!1;this.clearFocusClass();this.options.hide&&this.options.hide.apply(this,arguments);this.hideOverlay();this.preventBlur=!1;this.updateDOM();this.unmarkDropdownElements();
this.dropdown.hide();this.actOnStart=!0;this.focusDisplay(this.dropdown.prop("data-owner"));jq(window).unbind("resize",this.resizeHandler);return!0},hideDropdown:function(a){var b=this;if(!this.canClose())return!1;this.clearFocusClass();if("none"==this.dropdown.css("display")||null!=a&&this.dropdown.prop("data-owner")!=a.attr("id")||this.preventBlur)return this.preventBlur=!1;this.options.hide&&this.options.hide.apply(this,arguments);this.preventBlur=!1;this.updateDOM();this.unmarkDropdownElements();
this.actOnStart=!0;this.timers.hideTimeout&&clearTimeout(this.timers.hideTimeout);this.timers.hideTimeout=setTimeout(function(){b._hideDropdown.call(b,a)},this.hideTimeoutValue)},hideMultipleDropdowns:function(){this.options.datepickerWrapperSelector&&jq(this.options.datepickerWrapperSelector).not(this.getStartWrapperElement()).not(this.getEndWrapperElement()).each(function(a,b){jq(b).daterangePickerTwoFields("hideDropdown")})},showDropdown:function(a){this.timers.hideTimeout&&clearTimeout(this.timers.hideTimeout);
if("function"===typeof this.options.delayShowDropdown&&this.options.delayShowDropdown()&&!this.showDropdownTimeout)this.showDropdownTimeout=setTimeout(this.showDropdown.bind(this,a),this.options.showDropdownDelay);else if(null!==this.showDropdownTimeout&&(clearTimeout(this.showDropdownTimeout),this.showDropdownTimeout=null),this.canShow()){this.options.show&&this.options.show.apply(this,arguments);this.hideMultipleDropdowns();this.showOverlay();this.markDropdownElements();this.updateClicks();"function"===
typeof this.options.minDateFunc&&this.options.minDateFunc(this);this.dropdown[0].innerHTML=this.makeCalendarHTML(!this.actOnStart&&this.clicks[1]?this.clicks[1]:this.clicks[0]);this.updateDropdownSelection(null);var b=R9.Widgets.DaterangePicker.prototype.widgetBaseClass;this.options.dropdownClass&&(b=b+" "+this.options.dropdownClass);this.addFocusClass(a);this.dropdown.addClass(b);b=this.dropdown[0].style;this.runBelowCalendarCallback();this.positionDropdown(a);var c=this,d=jq(window).width();this.resizeHandler=
function(){var b=jq(window).width();10<Math.abs(b-d)&&(d=b,c.positionDropdown(a))};jq(window).on("resize",this.resizeHandler);this.bindItemEvent("mousedown",this.handleItemClickEvent);if(R9.globals.isTouch){var f=this;this.bindOverlayEvent("mousedown",function(){f.hideDropdown(f.element)})}else this.bindItemEvent("mouseover",this.handleItemHoverEvent),this.bindItemEvent("mouseout",this.handleItemHoverEndEvent);this.options.showBuzzGraph&&(this.bindBuzzGraphEvents(),this.displayBuzzGraph());this.bindNextPrevEvent("mousedown",
this.handleNextPrevClickEvent);this.bindCloseEvent("mousedown",function(){c.hideDropdown(c.element)});this.dropdown.prop("data-owner",a.attr("id"));this.loadBuzzData&&this.displayBuzzData();b.display="inline";this.focusSelectedDay(a)}},showOverlay:function(){this.overlay.show()},displayBuzzData:function(){"function"===typeof this.options.getFormData&&(new R9.DatePicker.BuzzData).update(this.dropdown,this.options.getFormData(this.actOnStart))},hideOverlay:function(){this.overlay.hide()},getStartDate:function(){this.updateClicks();
return 0!=this.clicks[0]?new Date(this.clicks[0]):null},getEndDate:function(){this.updateClicks();return 0!=this.clicks[1]?new Date(this.clicks[1]):null},parseDateString:function(a,b){try{return moment(a,b||this.options.startInputFormat)._d}catch(e){return""}},setFocusAfterClick:function(a){this.options.focusAfterClick=a},setStartDate:function(a){a?("string"===typeof a?a=this.parseDateString(a,this.options.startInputFormat):"number"===typeof a?a=new Date(a):"object"===typeof a?moment.isMoment(a)?
a.isValid()&&(a=a.toDate()):moment(a).isValid()&&(a="toDate"in a?a.toDate():a):a=new Date(0),void 0!=a.getTime&&(this.clicks[0]=a.getTime())):this.clicks[0]=0;this.updateDOM()},setEndDate:function(a){a?("string"===typeof a?a=this.parseDateString(a,this.options.endInputFormat):"number"===typeof a?a=new Date(a):"object"===typeof a?moment.isMoment(a)?a.isValid()&&(a=a.toDate()):moment(a).isValid()&&(a="toDate"in a?a.toDate():a):a=new Date(0),void 0!=a.getTime&&(this.clicks[1]=a.getTime())):this.clicks[1]=
0;this.updateDOM()},setUseDaysFormat:function(a){this.options.useDaysFormat=a;this.options.useDaysFormat?(this.unitFormat=this.options.daysFormat,this.unitAdjustment=1):(this.unitFormat=this.options.nightsFormat,this.unitAdjustment=0)},update:function(){this.updateClicks();this.updateDOM()},isBeforeStart:function(a){a instanceof jq&&(a=jq(a).attr("data-val"));return a&&null!==this.getStartDate()&&moment(parseInt(a)).isBefore(this.getStartDate())?!0:!1},decrementEndDay:function(a){var b=this.insideLastCalendar("end"),
c=this.getEndDate()||this.today,d=this.getStartDate()||this.today;a=this.utils.decrementDay(c,a);a.date()!==a.daysInMonth()||b||this.prevCalendar();d&&moment(c)>moment(d)&&this.setEndDate(a.toDate());this.fetchBuzzData();this.debounceChangeFn();this.updateDropdownSelection();return this.getEndDate()},decrementStartDay:function(a){var b=this.insideLastCalendar("start");a=this.utils.decrementDay(this.utils.validate(this.getStartDate()),a,this.setStartDate);a.date()!==a.daysInMonth()||b||this.prevCalendar();
this.fetchBuzzData();this.debounceChangeFn();this.updateDropdownSelection();return this.getEndDate()},incrementEndDay:function(a){var b=this.insideLastCalendar("end"),c=this.getEndDate();a=this.utils.incrementDay(c||this.today,a,this.setEndDate);1<=a.date()&&a.month()!==c.getMonth()&&b&&this.nextCalendar();this.fetchBuzzData();this.debounceChangeFn();this.updateDropdownSelection();return this.getEndDate()},incrementStartDay:function(a){var b=this.insideLastCalendar("start"),c=this.getStartDate()||
this.today,d=this.getEndDate();1===this.utils.incrementDay(c,a,this.setStartDate).date()&&b&&this.nextCalendar();(!d||moment(c)>=moment(d))&&this.setEndDate(this.getStartDate());this.fetchBuzzData();this.debounceChangeFn();this.updateDropdownSelection();return this.getStartDate()},handleStartDisplayFocusEvent:function(a,b){var c="",d=this.getStartWrapperElement(),f=this;this.markDropdownElements();this.addFocusClass(d);var k=jq(a);k.text()||!0!==this.options.skipForceSetDefaultStartOnFocusBlur&&this.setStartDate(this.today);
null!==(startdate=this.getStartDate())&&(c=jq(this.startInput).val()||moment(startdate).format(this.options.startInputFormat));this.actOnStart=!0;this.hideDropdown(this.getEndWrapperElement());this.showDropdown(d);this.options.accessible&&setTimeout(function(){k.text(c);f.selectDisplayBox(a)},1);b.stopPropagation();b.stopImmediatePropagation();jq("body").trigger("event",[b]);return this},handleStartDisplayBlurEvent:function(a,b){if(null!==this.clickTarget&&0<this.clickTarget.closest(".r9-datepicker").length)this.blurTarget=
a;else{var c=this.getStartWrapperElement(),d=this.getStartDate();this.hideDropdown(c);a=jq(a);""===a.text()&&!0===this.options.doNotFillWhenEmpty&&(this.setStartDate(null),this.options.change&&this.options.change.apply(this,arguments));""===a.text()&&null===d?!0!==this.options.skipForceSetDefaultStartOnFocusBlur&&this.setStartDate(this.today):""!==this.start_custom_value&&this.utils.applyStartVal();this.updateDropdownSelection();this.updateClicks();return this}},callNTimes:function(a,b){for(var c=
0;c<b;c++)a.call(this)},handleStartDisplayKeydownEvent:function(a,b){var c=b.keyCode||b.which,g=this.options.commands.keys,f=jq(this.endDisplay);a=jq(a);var k=0!==f.length&&!f.is(":hidden");if((c===g.TAB&&k||c===g.ENTER)&&!b.shiftKey){if(!1===f.is(":hidden")){var k=d(this.options.nextFieldAfterStartDateSelector),h=d(".gridCellFlexDepartPlusMinus").first();k.length?k.focus():0===h.length||!1===h.is(":visible")?(b.preventDefault(),b.stopPropagation(),setTimeout(function(){f.focus()},1)):0<h.length&&
h.find("select").focus()}if(c===g.ENTER&&f.is(":hidden"))return a.closest("form").find("[type\x3dsubmit]").trigger("click"),b.preventDefault(),b.stopPropagation(),!1;this.utils.applyStartVal();this.updateDropdownSelection();return!1}a=this.options.commands.keys;switch(c){case a.UP:this.callNTimes(this.decrementStartDay,7);b.preventDefault();b.stopPropagation();break;case a.RIGHT:this.incrementStartDay();b.preventDefault();b.stopPropagation();break;case a.LEFT:this.decrementStartDay();b.preventDefault();
b.stopPropagation();break;case a.DOWN:this.callNTimes(this.incrementStartDay,7);b.preventDefault();b.stopPropagation();break;case a.ESC:this.isDropdownVisible()&&this.hideDropdown(this.getStartWrapperElement())}this.vim(b,"start");jq("body").trigger("event",[b]);return this},handleEndDisplayFocusEvent:function(a,b){var c="",d=this.getEndWrapperElement(),f=this;f.markDropdownElements();this.addFocusClass(jq(d));var k=jq(a),h=f.clicks[0]||f.today.getTime();(!k.text()||f.clicks[1]<=h)&&!0!==this.options.skipForceSetDefaultEndOnFocusBlur&&
f.setEndDate(moment(h).toDate());null!==(enddate=f.getEndDate())&&(c=jq(f.endInput).val()||moment(enddate).format(f.options.endInputFormat));f.actOnStart=!1;f.showDropdown(d);f.options.accessible&&(jq(f.endDisplay).attr("contenteditable","true"),setTimeout(function(){k.text(c);f.selectDisplayBox(a)},1));b.stopPropagation();b.stopImmediatePropagation();jq("body").trigger("event",[b]);return this},handleEndDisplayBlurEvent:function(a,b){var c=this.getEndWrapperElement();this.options.accessible&&jq(this.endDisplay).attr("contenteditable",
"false");if(null!==this.clickTarget&&0<this.clickTarget.closest(".r9-datepicker").length)this.blurTarget=a;else return this.hideDropdown(c),a=jq(a),""===a.text()&&!0===this.options.doNotFillWhenEmpty&&(this.setEndDate(null),this.options.change&&this.options.change.apply(this,arguments)),""==a.text()&&null===this.getEndDate()?!0!==this.options.skipForceSetDefaultEndOnFocusBlur&&(null!==this.getStartDate()?this.setEndDate(moment(this.getStartDate()).add(1,"days")):this.setEndDate(moment().toDate())):
this.utils.applyEndVal(),this.updateDropdownSelection(),this},handleEndDisplayKeydownEvent:function(a,b){var c=b.keyCode||b.which;a=jq(a);a.text();var g=this.options.commands.keys;if(c===g.TAB&&!0===b.shiftKey){var f=d(this.options.nextFieldAfterStartDateSelector),k=d(".gridCellFlexDepartPlusMinus").first(),h=jq(this.startDisplay);f.length?setTimeout(function(){f.focus()}):k.is(":visible")?setTimeout(function(){k.children(".flexPlusMinusChoices").focus()}):!1===h.is(":hidden")&&(b.preventDefault(),
b.stopPropagation(),setTimeout(function(){h.focus()}))}else{if(c===g.ENTER)return this.utils.applyEndVal(),a.closest("form").find("[type\x3dsubmit]").trigger("click"),this.updateDropdownSelection(),b.preventDefault(),b.stopPropagation(),this.hideDropdown(this.getEndWrapperElement()),!1;a=this.options.commands.keys||{};switch(c){case a.UP:this.callNTimes(this.decrementEndDay,7);b.preventDefault();b.stopPropagation();break;case a.RIGHT:this.incrementEndDay();b.preventDefault();b.stopPropagation();break;
case a.LEFT:this.decrementEndDay();b.preventDefault();b.stopPropagation();break;case a.DOWN:this.callNTimes(this.incrementEndDay,7);b.preventDefault();b.stopPropagation();break;case a.ESC:this.isDropdownVisible()&&this.hideDropdown(this.getEndWrapperElement())}this.vim(b,"end")}jq("body").trigger("event",[b]);return this},handleStartDisplayKeyupEvent:function(a,b){this.utils.isCharacterKeyPress(b)&&(this.start_custom_value=jq(a).text());return this},handleEndDisplayKeyupEvent:function(a,b){this.utils.isCharacterKeyPress(b)&&
(this.end_custom_value=jq(a).text());return this},nextCalendar:function(a){return this.utils.changeCalendar("next",a)},prevCalendar:function(a){return this.utils.changeCalendar("prev",a)},selectDisplayBox:function(a){clearTimeout(this.timers.selectDisplayBox);this.timers.selectDisplayBox=window.setTimeout(function(){var b,c;window.getSelection&&document.createRange?(b=window.getSelection(),b.removeAllRanges(),c=document.createRange(),c.selectNodeContents(a),b.addRange(c)):document.body.createTextRange&&
(c=document.body.createTextRange(),c.moveToElementText(a),R9.Common.Utils.Browsers.isIE(8)||c.select())},1)},vim:function(a,b){var c=this.options.commands.keys||{};switch(a.keyCode||a.which){case c.DOLLAR:a.shiftKey&&(this.endOfLine(b),a.preventDefault());break;case c.CARAT:a.shiftKey&&(this.startOfLine(b),a.preventDefault())}return this},startOfLine:function(a){var b=this.utils.getRowInfo(a);"start"==a?this.decrementStartDay(b.index):this.decrementEndDay(b.index)},endOfLine:function(a){var b=this.utils.getRowInfo(a),
b=b.len-b.index;"start"==a?this.incrementStartDay(b):this.incrementEndDay(b)},bindBuzzGraphEvents:function(){var a=this;jq(".r9-datepicker-buzz-day").hover(function(){jq(".r9-datepicker-item[data-val\x3d%s]".format(jq(this).attr("data-val"))).addClass("r9-datepicker-item-hover");jq(".r9-datepicker-buzz-graph-footer \x3e div \x3e .detail").html(jq(this).children(".r9-datepicker-buzz-bar").attr("footertitle"))},function(){jq(".r9-datepicker-item[data-val\x3d%s]".format(jq(this).attr("data-val"))).removeClass("r9-datepicker-item-hover");
jq(".r9-datepicker-buzz-graph-footer \x3e div \x3e .detail").html("")});jq(".r9-datepicker-buzz-day").click(function(){var b=Number(jq(this).children(".r9-datepicker-buzz-bar").attr("dtstart"));if(a.actOnStart){var c=Number(jq(this).children(".r9-datepicker-buzz-bar").attr("dtend"));a.clearDaterange();a.setStartDate(b);a.options.isOneWay||a.setEndDate(c);a.updateDropdownSelection(null);a.options.isOneWay?(a.setEndDate(b),jq(".r9-datepicker-item[data-val\x3d%s]".format(jq(this).attr("data-val"))).mousedown(),
R9.Analytics.api.trackEvent("/flexgraph/oneway/click")):(a.endDisplay.focus(),R9.Analytics.api.trackEvent("/flexgraph/startdate/click"))}else a.setEndDate(b),jq(".r9-datepicker-item[data-val\x3d%s]".format(jq(this).attr("data-val"))).mousedown(),R9.Analytics.api.trackEvent("/flexgraph/enddate/click")})},fetchBuzzGraphData:function(){var a=this;jq("#flexgraphOK").size();var b="y"==jq("#onewaytrip").filter(":checked").val()||"y"==jq("#multi").filter(":checked").val();a.options.isOneWay=b;var c=a.getStartDate()||
a.today,d=a.getEndDate(),f=b?1:3;null==d||b||(f=Math.floor(a.utils.dateDiff(d,c)+1));var k=Number(jq(".r9-datepicker-month-first").find(".r9-datepicker-enabled:first").attr("data-val"));if(""==a.options.originControl.val()||""==a.options.destControl.val())jq(".r9-datepicker-buzz-graph-footer \x3e div").addClass("hidden"),jq(".r9-datepicker-buzz-graph-footer .noairports").removeClass("hidden");else if(a.actOnStart){var h=moment(k).format("YYYY-MM-DD");a.buzzCall&&a.buzzCall.abort();a.buzzCall=b?jq.ajax({type:"GET",
url:"/h/run/flexgraph",data:{q:"oneway",o:a.options.originControl.val().substr(0,3),d:a.options.destControl.val().substr(0,3),depart:h,daysout:70,duration:f,json:1},dataType:"json",success:function(b){try{responseObject=b,a.graphDataReadyCallback(responseObject,f,k,!0,c.getTime())}catch(l){}a.buzzCall=!1},error:function(b,c,e){a.buzzCall=!1},cache:!1}):jq.ajax({type:"GET",url:"/h/run/flexgraph",data:{q:"fixed",o:a.options.originControl.val().substr(0,3),d:a.options.destControl.val().substr(0,3),depart:h,
daysout:70,duration:f,json:1},dataType:"json",success:function(b){try{responseObject=b,a.graphDataReadyCallback(responseObject,f,k,!1,c.getTime())}catch(l){}a.buzzCall=!1},error:function(b,c,e){a.buzzCall=!1},cache:!1})}else{var h=moment(c.getTime()).format("YYYY-MM-DD"),n=(d||a.today).getTime();a.buzzCall&&a.buzzCall.abort();a.buzzCall=jq.ajax({type:"GET",url:"/h/run/flexgraph",data:{q:"start",o:a.options.originControl.val().substr(0,3),d:a.options.destControl.val().substr(0,3),depart:h,daysout:70,
json:1},dataType:"json",success:function(b){try{responseObject=b,a.graphDataReadyCallback(responseObject,f,c.getTime(),!1,n)}catch(l){}a.buzzCall=!1},error:function(b,c,e){a.buzzCall=!1},cache:!1})}},displayBuzzGraph:function(){this.fetchBuzzData(!0)},fetchBuzzData:function(a){this.options.showBuzzGraph&&a&&(jq(".r9-datepicker-buzz-day.r9-datepicker-enabled .r9-datepicker-buzz-bar").each(function(){jq(this).css("height","2px").attr("footertitle","")}),this.fetchBuzzGraphData())},graphDataReadyCallback:function(a,
b,c,d,f){this.actOnStart?d?(jq(".r9-datepicker-buzz-graph-footer \x3e div").addClass("hidden"),jq(".r9-datepicker-buzz-graph-footer .oneway").removeClass("hidden")):(jq(".r9-datepicker-buzz-graph-footer \x3e div").addClass("hidden"),jq(".r9-datepicker-buzz-graph-footer .duration #durationNumber").html(b),jq(".r9-datepicker-buzz-graph-footer .duration").removeClass("hidden")):(jq(".r9-datepicker-buzz-graph-footer \x3e div").addClass("hidden"),jq(".r9-datepicker-buzz-graph-footer .fixedstart #flexDepartDate").html(moment(c).format(this.options.startInputFormat)),
jq(".r9-datepicker-buzz-graph-footer .fixedstart").removeClass("hidden"));c=b=500;var e=0,g=0,n=0,m;for(m in a){n++;var l=Number(a[m].localPrice);l>b&&(b=l);l<c&&1<l&&(c=l,g=m);m==f&&(e=l)}if(0==n)jq(".r9-datepicker-buzz-graph").hide(),jq(".r9-datepicker-buzz-graph-footer").hide();else{n=0;for(m in a){var l=a[m].localPrice,r=a[m].localPriceAsString,w=a[m].departMilli,p=a[m].returnMilli,q=moment(a[m].departMilli).format(this.options.startInputFormat),u=moment(a[m].returnMilli).format(this.options.startInputFormat),
t=this.actOnStart?jq(".r9-datepicker-buzz-day[data-val\x3d'"+m+"']").find("div"):jq(".r9-datepicker-buzz-day[data-val\x3d'"+p+"']").find("div");1==t.size()&&(l=Math.floor(l/b*100),t.css("height",l+"%"),n++,d?t.attr("footertitle",q+" "+r):t.attr("footertitle",q+"-"+u+" "+r),this.actOnStart?t.attr("dtstart",w):t.attr("dtstart",p),t.attr("dtend",p),this.actOnStart?m==f&&(t.addClass("selected"),jq("#graphpricebar").css("bottom",l-1+"px").show(),jq("#graphprice").html(r).css("bottom",l-7+"px").show()):
p==f&&(t.addClass("selected"),jq("#graphpricebar").css("bottom",l-1+"px").show(),jq("#graphprice").html(r).css("bottom",l-7+"px").show()),m==g&&(0<e&&e>c&&c<.9*e?jq("#graphlowpricebar").css("bottom",l-1+"px").show():jq("#graphlowpricebar").hide()))}0==n?(jq(".r9-datepicker-buzz-graph").hide(),jq(".r9-datepicker-buzz-graph-footer").hide()):jq(".r9-datepicker-buzz-graph").is(":visible")||(jq(".r9-datepicker-buzz-graph").show(),jq(".r9-datepicker-buzz-graph-footer").show())}}})})(jq||jQuery);
(function(d){d.extend("Widgets.DaterangePicker.prototype.options",{prevTitle:"Prev",nextTitle:"Next",nightsFormat:"0#same day|1#1 night|2#{0} nights",daysFormat:"0#same day|1#1 day|2#{0} days",startInputFormat:"MM/DD/YYYY",endInputFormat:"MM/DD/YYYY",startFormat:"ddd M/D",endFormat:"ddd M/D"})})(window.R9);
(function(d){R9.extend("Widgets",{DaterangePickerTwoFields:function(c,a){R9.Widgets.BaseCalendarWidget.apply(this);this.endNode=c;this.endElement=d(this.endNode);this.startElement=jq(this.endElement).closest("form").find('[id$\x3d"start-wrapper"]');1!=this.startElement.length&&(this.startElement=jq("#"+this.endElement.attr("id").replace("end-wrapper","start-wrapper")));this.validateElement()&&(this.startDisplay=d(R9.Widgets.DaterangePickerTwoFields.findDisplay(this.startElement[0])),this.startClearDisplay=
d(R9.Widgets.DaterangePickerTwoFields.findClearDisplay(this.startElement[0])),this.startPlaceholderDisplay=d(R9.Widgets.DaterangePickerTwoFields.findPlaceholderDisplay(this.startElement[0])),this.startInputTab=d(R9.Widgets.DaterangePickerTwoFields.findInputTab(this.startElement[0])),this.startInput=d(R9.Widgets.DaterangePickerTwoFields.findInput(this.startElement[0])),this.endDisplay=d(R9.Widgets.DaterangePickerTwoFields.findDisplay(this.endElement[0])),this.endClearDisplay=d(R9.Widgets.DaterangePickerTwoFields.findClearDisplay(this.endElement[0])),
this.endPlaceholderDisplay=d(R9.Widgets.DaterangePickerTwoFields.findPlaceholderDisplay(this.endElement[0])),this.endInputTab=d(R9.Widgets.DaterangePickerTwoFields.findInputTab(this.endElement[0])),this.endInput=d(R9.Widgets.DaterangePickerTwoFields.findInput(this.endElement[0])),this.options=d.extend({},this.options,a),this.init())}});R9.extend("Widgets.DaterangePickerTwoFields",{isDatepicker:function(c){return c&&c.nodeName&&"div"==c.nodeName.toLowerCase()},isWidgetControlled:function(c){return d(c).hasClass(R9.Widgets.DaterangePicker.prototype.widgetBaseClass+
"-wrapper")},findDisplay:function(c){var a=d(c).closest("form").find("#"+c.id.replace("wrapper","display"))[0];a||(a=document.getElementById(c.id.replace("wrapper","display")));return a},findClearDisplay:function(c){var a=d(c).closest("form").find("#"+c.id.replace("wrapper","clear"))[0];a||(a=document.getElementById(c.id.replace("wrapper","clear")));return a},findPlaceholderDisplay:function(c){var a=d(c).closest("form").find("#"+c.id.replace("wrapper","placeholder"))[0];a||(a=document.getElementById(c.id.replace("wrapper",
"placeholder")));return a},findInputTab:function(c){var a=d(c).closest("form").find("#"+c.id.replace("wrapper","tab"))[0];a||(a=document.getElementById(c.id.replace("wrapper","tab")));return a},findInput:function(c){var a=jq(c).closest("form").find("#"+c.id+" .r9-datepicker-input")[0];a||(a=jq("#"+c.id+" .r9-datepicker-input")[0]);return a},getDropdownId:function(c){return"datepicker"}});R9.extend("Widgets.DaterangePickerTwoFields.prototype",!0,R9.Widgets.DaterangePicker.prototype,{endNode:null,startElement:null,
endElement:null,startDisplay:null,startClearDisplay:null,startPlaceholderDisplay:null,startInputTab:null,startInput:null,endDisplay:null,endClearDisplay:null,endPlaceholderDisplay:null,endInputTab:null,endInput:null,singleDateMode:!1,init:function(){this.advanceStyling&&(this.options.skipForceSetDefaultStartOnFocusBlur=!0,this.options.skipForceSetDefaultEndOnFocusBlur=!0,this.options.doNotFillWhenEmpty=!0);this.initDropdown();this.timers={};this.options.useLongDisplayFormat&&(this.options.startFormat=
this.options.startInputFormat,this.options.endFormat=this.options.endInputFormat);this.endStartIsSameField()||(this.bindEvent(this.endInputTab,"focus",this.handleEndInputFocusEvent),this.bindEvent(this.endInputTab,"blur",this.handleInputBlurEvent),this.bindEvent(this.endInputTab,"keydown",this.handleInputKeydownEvent),this.bindEvent(this.endElement,"mousedown",this.handleEndClickEvent),this.bindEvent(this.endClearDisplay,"mousedown",this.handleEndClearClickEvent));this.bindEvent(this.startInputTab,
"focus",this.handleStartInputFocusEvent);this.bindEvent(this.startInputTab,"blur",this.handleInputBlurEvent);this.bindEvent(this.startInputTab,"keydown",this.handleInputKeydownEvent);this.bindEvent(this.startElement,"mousedown",this.handleStartClickEvent);this.bindEvent(this.startClearDisplay,"mousedown",this.handleStartClearClickEvent);this.endElement.data(this.widgetName,this);jq(".r9-datepicker-wrapper").each(function(){var c=jq(this).find(".r9-datepicker-display");if(!(void 0!==c&&1<c.length))jq(this).off("mousedown focus").on("mousedown focus",
function(a){a.preventDefault();a.stopPropagation();jq("body").trigger("event",[a]);jq(this).find(".r9-datepicker-display").focus()})});this.bindCommandUtilities();this.start_custom_value=this.end_custom_value="";this.utils=this.options.commands.utilities;this.today=moment().startOf("day").toDate();this.bindAccessibilityEvents();this.updateClicks();this.updateDOM()},validateElement:function(){return R9.Widgets.DaterangePicker.isDatepicker(this.endNode)&&R9.Widgets.DaterangePicker.isWidgetControlled(this.endNode)&&
void 0===this.endElement.data(this.widgetName)},getWrapperElement:function(){return this.actOnStart?this.startElement:this.endElement},getStartWrapperElement:function(){return this.startElement},getEndWrapperElement:function(){return this.endElement},switchActOn:function(){var c=!this.actOnStart;this.hideDropdown(this.getWrapperElement());this.actOnStart=c;(this.actOnStart?this.startInputTab:this.endInputTab).focus()},markDropdownElements:function(){this.unmarkDropdownElements();this.actOnStart?this.startElement.addClass("r9-datepicker-dropdown r9-datepicker-dropdown-start"):
this.endElement.addClass("r9-datepicker-dropdown r9-datepicker-dropdown-end")},unmarkDropdownElements:function(){this.startElement.removeClass("r9-datepicker-dropdown r9-datepicker-dropdown-start");this.endElement.removeClass("r9-datepicker-dropdown r9-datepicker-dropdown-end")},setSingleDateMode:function(c,a){this.singleDateMode!=c&&(this.singleDateMode=c,a||this.updateDOM())},getSingleDateMode:function(){return this.singleDateMode},handleStartClearClickEvent:function(c,a){this.clearDaterange(0);
this.options.change&&this.options.change.apply(this,arguments);return!this.startElement.hasClass("r9-datepicker-focus")},handleEndClearClickEvent:function(c,a){this.clearDaterange(1);this.options.change&&this.options.change.apply(this,arguments);return!this.endElement.hasClass("r9-datepicker-focus")},handleStartInputFocusEvent:function(c,a){if(!c.disabled){this.preventBlur=!1;var b=this.getStartWrapperElement();b.addClass("r9-datepicker-focus");this.startDisplay.text()||this.setStartDate(this.today);
this.actOnStart=!0;this.showDropdown(b);this.options.focus&&this.options.focus.apply(this,arguments)}},handleEndInputFocusEvent:function(c,a){if(!c.disabled){this.preventBlur=!1;var b=this.getEndWrapperElement();b.addClass("r9-datepicker-focus");this.endDisplay.text()||this.setEndDate(moment(this.getStartDate()).toDate());this.actOnStart=!1;this.showDropdown(b);this.options.focus&&this.options.focus.apply(this,arguments)}},handleItemClickEvent:function(c,a){var b=this,e=jq(c);return this.singleDateMode?
(e.hasClass("r9-datepicker-enabled")&&(c=parseInt(e.attr("data-val")),this.clicks[0]=c,this.clicks[1]<this.clicks[0]&&(this.clicks[1]=this.clicks[0]),this.updateDropdownSelection(null),setTimeout(function(){b.hideDropdown(null);b.options.change&&b.options.change.apply(b,arguments);b.options.nextFieldSelector&&jq(b.options.nextFieldSelector).focus()},this.options.secondClickHideDelay)),this.updateDOM(),!1):R9.Widgets.DaterangePicker.prototype.handleItemClickEvent.call(this,c,a)},handleClickEvent:function(c,
a,b){return!0},updateItem:function(c,a){this.singleDateMode?(a.hover?c.addClass("r9-datepicker-item-hover"):c.removeClass("r9-datepicker-item-hover"),c.removeClass("r9-datepicker-item-selected"),c.removeClass("r9-datepicker-item-start"),a.selected&&!a.end?(c.addClass("r9-datepicker-item-selected"),c.attr("aria-selected",!0)):a.selected||c.attr("aria-selected",!1),a.start&&c.addClass("r9-datepicker-item-start")):R9.Widgets.DaterangePicker.prototype.updateItem.call(this,c,a)}})})(jq||jQuery);
(function(d){R9.extend("Widgets",{DaterangePickerFixed:function(c,a){this.elementNode=c;this.element=d(this.elementNode);this.validateElement()&&(this.startDisplay=d(R9.Widgets.DaterangePicker.findStartDisplay(this.elementNode)),this.sepDisplay=d(R9.Widgets.DaterangePicker.findSepDisplay(this.elementNode)),this.endDisplay=d(R9.Widgets.DaterangePicker.findEndDisplay(this.elementNode)),this.clearDisplay=d(R9.Widgets.DaterangePicker.findClearDisplay(this.elementNode)),this.nightsDisplay=d(R9.Widgets.DaterangePicker.findNightsDisplay(this.elementNode)),
this.placeholderDisplay=d(R9.Widgets.DaterangePicker.findPlaceholderDisplay(this.elementNode)),this.input=d(R9.Widgets.DaterangePicker.findInputNode(this.elementNode)),this.startInput=d(R9.Widgets.DaterangePicker.findStartInput(this.elementNode)),this.endInput=d(R9.Widgets.DaterangePicker.findEndInput(this.elementNode)),this.options=d.extend({},this.options,a),this.init())}});R9.extend("Widgets.DaterangePickerFixed",{isDatepicker:function(c){return c&&c.nodeName&&"div"==c.nodeName.toLowerCase()},
isWidgetControlled:function(c){return d(c).hasClass(R9.Widgets.DaterangePicker.prototype.widgetBaseClass+"-wrapper")},findStartDisplay:function(c){return document.getElementById(c.id+"-start")},findEndDisplay:function(c){return document.getElementById(c.id+"-end")},findSepDisplay:function(c){return document.getElementById(c.id+"-sep")},findClearDisplay:function(c){return document.getElementById(c.id+"-clear")},findNightsDisplay:function(c){return document.getElementById(c.id+"-nights")},findPlaceholderDisplay:function(c){return document.getElementById(c.id+
"-placeholder")},findStartInput:function(c){return jq("#"+c.id+" .r9-datepicker-input.r9-datepicker-start")[0]},findEndInput:function(c){return jq("#"+c.id+" .r9-datepicker-input.r9-datepicker-end")[0]},findInputNode:function(c){return document.getElementById(c.id+"-tab")},getDropdownId:function(c){return"datepicker"}});R9.extend("Widgets.DaterangePickerFixed.prototype",!0,R9.Widgets.DaterangePicker.prototype,{options:{rangeDays:34},handleItemClickEvent:function(c,a){var b=this;c=jq(c);c.hasClass("r9-datepicker-enabled")&&
(c=parseInt(c.attr("data-val")),this.clicks[0]=c,this.clicks[1]=moment(c).add(this.options.rangeDays,"days").valueOf(),this.updateDropdownSelection(null),setTimeout(function(){b.hideDropdown(null);b.options.change&&b.options.change.apply(b,arguments);b.options.nextFieldSelector&&jq(b.options.nextFieldSelector).focus()},this.options.secondClickHideDelay));this.updateDOM();return!1},getHighlitedRange:function(c,a){c=[0,0];if(null==a)return c;c[0]=parseInt(a.attr("data-val"));c[1]=moment(c[0]).add(34,
"days").valueOf();return c},setStartDate:function(c){null!=c&&(this.clicks[0]=c.getTime(),this.clicks[1]=moment(this.clicks[0]).add(this.options.rangeDays,"days").valueOf(),this.updateDOM())},setEndDate:function(c){null!=c&&(this.clicks[1]=c.getTime(),this.clicks[0]=moment(this.clicks[1]).subtract(this.options.rangeDays,"days").valueOf(),this.updateDOM())}})})(jq||jQuery);
(function(d){R9.extend("Widgets",{DaterangePickerOrSingleDate:function(c,a){R9.Widgets.DaterangePicker.call(this,c,a)}});R9.extend("Widgets.DaterangePickerOrSingleDate",{});R9.extend("Widgets.DaterangePickerOrSingleDate.prototype",!0,R9.Widgets.DaterangePicker.prototype,{minDate:null,singleDateMode:!1,setSingleDateMode:function(c,a){this.singleDateMode=c;a||this.updateDOM()},getSingleDateMode:function(){return this.singleDateMode},updateDOM:function(){var c;this.singleDateMode?(this.element.addClass("r9-datepicker-single-date-mode"),
this.dropdown.addClass("r9-datepicker-single-date-mode"),this.endDisplay.text(""),this.endInput.val(""),0!=this.clicks[0]?(c=moment(this.clicks[0]),this.startDisplay.text(c.format(this.options.startFormat)),this.startInput.val(c.format(this.options.startInputFormat))):(this.startDisplay.text(""),this.startInput.val("")),null==c?this.element.addClass("r9-datepicker-start-empty"):this.element.removeClass("r9-datepicker-start-empty")):(this.element.removeClass("r9-datepicker-single-date-mode"),this.dropdown.removeClass("r9-datepicker-single-date-mode"),
R9.Widgets.DaterangePicker.prototype.updateDOM.call(this))},updateHoverDOM:function(c){this.singleDateMode||R9.Widgets.DaterangePicker.prototype.updateHoverDOM.call(this,c)},computeState:function(c,a,b,e,d,f){this.singleDateMode?a==b[0]?d.start=!0:a==c&&(d.highlited=!0):R9.Widgets.DaterangePicker.prototype.computeState.call(this,c,a,b,e,d,f)},handleItemClickEvent:function(c,a){var b=this,e=jq(c);return this.singleDateMode?(e.hasClass("r9-datepicker-enabled")&&(c=parseInt(e.attr("data-val")),this.clicks[0]=
c,this.updateDropdownSelection(null),setTimeout(function(){b.hideDropdown(null);b.options.change&&b.options.change.apply(b,arguments);b.options.nextFieldSelector&&jq(b.options.nextFieldSelector).focus()},this.options.secondClickHideDelay)),this.updateDOM(),!1):R9.Widgets.DaterangePicker.prototype.handleItemClickEvent.call(this,c,a)}})})(jq||jQuery);
(function(d,c){d.publish("common.widgets.datepicker.BaseCalendar.prototype",c.extend({},d.Widgets.BaseCalendarWidget.prototype,{useSpecialCharacters:!1,options:{language:null,title:"",prevTitle:"",nextTitle:"",titleYearFormat:"YYYY",titleMonthFormat:"MMMM",reverseMonthAndYearOrder:!1,yearSymbol:null},showYearWithSpecialSymbol:function(a){var b=[],c=this.getYearSymbol();b.push("\x3cspan class\x3d'r9-datepicker-year'\x3e");b.push(a.format(this.options.titleYearFormat)+c+" ");b.push("\x3c/span\x3e");
return b.join("")},showMonthAndYear:function(a){var b=[];this.isReverseMonthAndYearOrder()?(b.push(this.showYearWithSpecialSymbol(a)),b.push(this.showMonth(a))):(b.push(this.showMonth(a)),b.push(this.showYearWithSpecialSymbol(a)));return b.join("")},isReverseMonthAndYearOrder:function(){return!0===this.options.reverseMonthAndYearOrder||!0===d.config.getBoolean("ui.datepicker.reverse.order.month.year",!1)},getYearSymbol:function(){return null!=this.options.yearSymbol?this.options.yearSymbol:this.isReverseMonthAndYearOrder()?
d.config.getString("ui.datepicker.year.symbol",""):""}}));d.createWidgetClass("datepicker.DaterangePicker",c.extend({},d.Widgets.DaterangePickerTwoFields.prototype,d.common.widgets.datepicker.BaseCalendar.prototype,{widgetName:"daterangePicker",widgetBaseClass:"r9-datepicker",calendarBaseClass:"r9-datepicker-calendar",dropdownId:"datepicker",html:null,singleDateMode:!1,maxDate:null,options:c.extend({},d.common.widgets.datepicker.BaseCalendar.prototype.options,d.Widgets.DaterangePickerTwoFields.prototype.options,
{skipForceSetDefaultStartOnFocusBlur:!1,skipForceSetDefaultEndOnFocusBlur:!1,doNotFillWhenEmpty:!1,minRangeDays:1,alwaysShowEndDatepicker:!1,responsive:!1,presentationCheck:function(){return d.utils.presentation.isTablet()}}),init:function(a){this.html=c("html");d.Widgets.BaseCalendarWidget.apply(this);this.options.useDaysFormat?(this.unitFormat=this.options.daysFormat,this.unitAdjustment=1):(this.unitFormat=this.options.nightsFormat,this.unitAdjustment=0);this.advanceStyling&&(this.options.skipForceSetDefaultStartOnFocusBlur=
!0,this.options.skipForceSetDefaultEndOnFocusBlur=!0,this.options.doNotFillWhenEmpty=!0);this.options.maxDate&&(this.maxDate=this.options.maxDate);this.elementNode=this.element.get(0);a=this.element.closest(".R9-Overlay");0<a.length&&(this.options.appendTo="#%s".format(a.attr("id")));this.startSection=this.findStartSection();this.startDisplay=this.findStartDisplay();this.startPlaceholderDisplay=this.findStartPlaceholderDisplay();this.startElement=this.startWrapper=this.findStartWrapperElement();this.startInput=
this.findStartInput();this.startInputTab=this.findStartInputTab();this.endSection=this.findEndSection();this.endDisplay=this.findEndDisplay();this.endPlaceholderDisplay=this.findEndPlaceholderDisplay();this.endElement=this.endWrapper=this.findEndWrapperElement();this.endInput=this.findEndInput();this.endInputTab=this.findEndInputTab();this.element.hasClass("singleDate")&&this.setSingleDateMode(!0,!0);this.summaryDisplay=this.findSummaryDisplay();this.setUseDaysFormat(this.options.useDaysFormat);this.initDropdown();
this.timers={};this.bindCommandUtilities();this.start_custom_value=this.end_custom_value="";this.utils=this.options.commands.utilities;this.today=moment().startOf("day").toDate();this.isResponsive()&&this.handleResponsive();this.wholeMonthSearch&&(this.options.skipForceSetDefaultStartOnFocusBlur=!0,this.options.skipForceSetDefaultEndOnFocusBlur=!0,this.options.doNotFillWhenEmpty=!0);this.update();this.updateClicks();this.updateDOM()},addEventHandlers:function(){var a=function(a){a.off("mousedown focus").on("mousedown focus",
function(b){b.preventDefault();b.stopPropagation();a.removeClass("r9-datepicker-end-empty r9-datepicker-start-empty");c(this).find(".r9-datepicker-display").focus()})};a(this.startWrapper);a(this.endWrapper);this.bindAccessibilityEvents();this.bindEvent(this.startInputTab,"focus",this.handleStartInputFocusEvent);this.bindEvent(this.startInputTab,"blur",this.handleInputBlurEvent);this.bindEvent(this.startInputTab,"keydown",this.handleInputKeydownEvent);this.bindEvent(this.startElement,"mousedown",
this.handleStartClickEvent);this.bindEvent(this.endInputTab,"focus",this.handleEndInputFocusEvent);this.bindEvent(this.endInputTab,"blur",this.handleInputBlurEvent);this.bindEvent(this.endInputTab,"keydown",this.handleInputKeydownEvent);this.bindEvent(this.endElement,"mousedown",this.handleEndClickEvent);this.bindEvent(this.dropdown,"mousedown",this.handleDropdownClickEvent);this.bindEvent(this.overlay,"mousedown",this.handleItemClickEvent);this.isResponsive()&&c(window).resize(this.handleResponsive.bind(this))},
handleDropdownClickEvent:function(){return!!this.wholeMonthSearch},isSelectingEndDate:function(){return this.endWrapper.hasClass("r9-datepicker-focus")},handleCloseEvent:function(){this.isDropdownVisible()&&this.hideDropdown()},handleItemClickEvent:function(a,b){if(!0===this.isBeforeStart(a)&&!1===this.actOnStart)return this.preventBlur=!0,this.wholeMonthSearch&&(this.preventBlur=!1),b.preventDefault(),this;var e=this;b=c(a);var d,f,k;b.hasClass("r9-datepicker-enabled")&&(f=parseInt(b.attr("data-val")),
d=(k=this.actOnStart)?0:1,b=this.actOnStart?1:0,this.clicks[d]=f,this.clicks[0]&&this.clicks[1]&&(d=moment(this.clicks[1]).diff(this.clicks[0],"days"),d<this.options.minRangeDays&&(this.clicks[b]=0)),this.updateDropdownSelection(null),!this.options.alwaysShowEndDatepicker||this.singleDateMode||this.isSelectingEndDate()?!this.singleDateMode&&this.clicks[0]&&this.clicks[1]||this.singleDateMode&&this.clicks[0]?setTimeout(function(){e.hideDropdown();e.options.change&&e.options.change.apply(e,[f,k]);e.options.nextFieldSelector&&
c(e.options.nextFieldSelector).focus()},this.options.secondClickHideDelay):this.switchActOn():(this.switchActOn(),e.options.change&&e.options.change.apply(e,[f,k]),this.loadBuzzData&&k&&this.displayBuzzData()));this.updateDOM();c(a).trigger("daterangepicker.itemclicked");return!1},handleStartDisplayFocusEvent:function(a,b){if(this.clickTarget&&c(this.clickTarget[0]).hasClass("FormView"))return this;var e=null,g="",f=this.getStartWrapperElement(),k=this;this.markDropdownElements();c(".r9-datepicker-focus").removeClass("r9-datepicker-focus");
c(f).addClass("r9-datepicker-focus");var h=c(a);h.text()||!0!==this.options.skipForceSetDefaultStartOnFocusBlur&&this.setStartDate(this.today);null!==(e=this.getStartDate())&&(g=c(this.startInput).val()||moment(e).format(this.options.startInputFormat));this.actOnStart=!0;this.hideDropdown(this.getEndWrapperElement());this.showDropdown(f);this.options.accessible&&setTimeout(function(){h.text(g);k.wholeMonthSearch&&("wholeMonthSearch"===(null!==d.storage.get("daterangePickerDefaultNavTab")?d.storage.get("daterangePickerDefaultNavTab"):
"specificDate")?k.startDisplay.text("Select a month..."):h.text(g));k.selectDisplayBox(a)},1);b.stopPropagation();b.stopImmediatePropagation();c("body").trigger("event",[b]);return this},handleStartDisplayBlurEvent:function(a,b){if(null!==this.clickTarget&&(0<this.clickTarget.closest(".r9-datepicker").length||this.wholeMonthSelect))this.blurTarget=a;else{var e=this.getStartWrapperElement(),d=this.getStartDate();a=c(a);""===a.text()&&!0===this.options.doNotFillWhenEmpty&&(this.setStartDate(null),this.options.change&&
this.options.change.apply(this,arguments));this.hideDropdown(e);c(e).removeClass("r9-datepicker-focus");""===a.text()&&null===d?!0!==this.options.skipForceSetDefaultStartOnFocusBlur&&this.setStartDate(this.today):""!==this.start_custom_value?this.utils.applyStartVal():(null===this.getEndDate()||moment(this.getStartDate()).isSame(this.getEndDate()))&&this.setEndDate(moment(this.getStartDate()).add(1,"days").toDate());this.updateDropdownSelection();this.updateClicks();return this}},handleEndDisplayFocusEvent:function(a,
b){var c="",d=this.getEndWrapperElement(),f=this;f.markDropdownElements();jq(".r9-datepicker-focus").removeClass("r9-datepicker-focus");jq(d).addClass("r9-datepicker-focus");var k=jq(a),h=f.clicks[0]||f.today.getTime();(!k.text()||f.clicks[1]<=h)&&!0!==this.options.skipForceSetDefaultEndOnFocusBlur&&f.setEndDate(moment(h).toDate());var n;null!==(n=f.getEndDate())&&(c=jq(f.endInput).val()||moment(n).format(f.options.endInputFormat));f.actOnStart=!1;f.showDropdown(d);f.options.accessible&&(jq(f.endDisplay).attr("contenteditable",
"true"),setTimeout(function(){k.text(c);f.selectDisplayBox(a)},1));b.stopPropagation();b.stopImmediatePropagation();jq("body").trigger("event",[b]);return this},handleEndDisplayBlurEvent:function(a,b){var c=this.getEndWrapperElement();this.options.accessible&&jq(this.endDisplay).attr("contenteditable","false");if(null!==this.clickTarget&&0<this.clickTarget.closest(".r9-datepicker").length)this.blurTarget=a;else return a=jq(a),""===a.text()&&!0===this.options.doNotFillWhenEmpty&&(this.setEndDate(null),
this.options.change&&this.options.change.apply(this,arguments)),this.hideDropdown(c),""===a.text()&&null===this.getEndDate()?!0!==this.options.skipForceSetDefaultEndOnFocusBlur&&(null!==this.getStartDate()?this.setEndDate(moment(this.getStartDate()).add(1,"days")):this.setEndDate(moment().toDate())):this.utils.applyEndVal(),this.updateDropdownSelection(),this},switchActOn:function(){var a=!this.actOnStart;this.hideDropdown(this.getWrapperElement());this.actOnStart=a;c(this.actOnStart?this.startInputTab:
this.endInputTab).focus()},findStartSection:function(){return this.getChildElement("start")},findStartDisplay:function(){return this.getChildElement("start-display")},findStartPlaceholderDisplay:function(){return this.getChildElement("start-placeholder")},findEndSection:function(){return this.getChildElement("end")},findEndDisplay:function(){return this.getChildElement("end-display")},findEndPlaceholderDisplay:function(){return this.getChildElement("end-placeholder")},findSummaryDisplay:function(){return this.getChildElement("summary-display")},
findClearDisplay:function(){return this.getChildElement("clear")},findCloseLink:function(){return c(".r9-datepicker-title-close",this.dropdown)},findTitle:function(){return c(".r9-datepicker-title \x3e span",this.dropdown)},findStartInput:function(){return this.getChildElement("start-formField")},findEndInput:function(){return this.getChildElement("end-formField")},findTabInput:function(){return this.getChildElement("tab")},findStartInputTab:function(){return this.getChildElement("start-tab")},findEndInputTab:function(){return this.getChildElement("end-tab")},
findStartWrapperElement:function(){return this.getChildElement("start-wrapper")},findEndWrapperElement:function(){return this.getChildElement("end-wrapper")},getDropdownEl:function(){return c("#datepicker")},getWrapperElement:function(){return this.actOnStart?this.startWrapper:this.endWrapper},getStartWrapperElement:function(){return this.startWrapper},getEndWrapperElement:function(){return this.endWrapper},handleNextPrevClickEvent:function(a,b){b=this.saveDropdownPositionState(this.dropdown);a=moment(parseInt(c(a).attr("data-val")));
this.dropdown[0].innerHTML=this.makeCalendarHTML(a);this.restoreDropdownPositionState(this.dropdown,b);this.runBelowCalendarCallback();this.updateDropdownSelection(null);this.loadBuzzData&&this.displayBuzzData();this.isResponsive()&&this.presentationCheck()&&(this.updateTitle(),this.bindEvent(this.findCloseLink(),"click",this.handleCloseEvent));this.wholeMonthSearch&&(this.createCalendarTabNavBindings(),this.createWholeMonthClickBindings(),this.createNoOfNightsChangedBinding(),jq(".tabWrapper.wholeMonth").hasClass("selected")?
jq(".tabWrapper.wholeMonth").trigger("click"):jq(".tabWrapper.specificDate").trigger("click"),jq(".searchform.rtow").hasClass("oneway")&&(jq(".tabWrapper.wholeMonth").hide(),jq(".tabWrapper.specificDate").click()));return!1},saveDropdownPositionState:function(a){if(a){var b=a.find(".r9-datepicker-pointer");a=c(a);if(0<b.length&&0<a.length)return{pointerPos:b.position(),wrapperPos:a.position(),wrapperHeight:a.height(),topPointer:0>b.position().top}}return null},restoreDropdownPositionState:function(a,
b){if(b&&a){var e=c(a);if(0<e.length){if(!b.topPointer){var d=e.height()-b.wrapperHeight;e.css("top",b.wrapperPos.top-d+"px")}a.find(".r9-datepicker-pointer").css("left",b.pointerPos.left+"px")}}},showDropdown:function(a){this.hideTimeout&&clearTimeout(this.hideTimeout);this.options.show&&this.options.show.apply(this,arguments);this.dropdown.parent().is(this.options.appendTo)||this.dropdown.appendTo(this.options.appendTo);this.showOverlay();this.markDropdownElements();this.updateClicks();"function"===
typeof this.options.minDateFunc&&this.options.minDateFunc(this);this.wholeMonthSearch&&jq(".searchform.rtow").hasClass("oneway")&&(d.events.publish("flights.search.rt.form.wholeMonthSelect.setSpecificDateCategory",{group:"wholeMonthSelect"}),this.daterangePickerDefaultNavTab="specificDate");this.dropdown[0].innerHTML=this.makeCalendarHTML(!this.actOnStart&&this.clicks[1]?this.clicks[1]:this.clicks[0]);this.updateDropdownSelection(null);this.runBelowCalendarCallback();this.wholeMonthSearch&&(this.createCalendarTabNavBindings(),
this.createWholeMonthClickBindings(),this.createNoOfNightsChangedBinding(),jq(".tabWrapper.wholeMonth").hasClass("selected")?jq(".tabWrapper.wholeMonth").trigger("click"):jq(".tabWrapper.specificDate").trigger("click"),jq(".searchform.rtow").hasClass("oneway")&&(jq(".tabWrapper.wholeMonth").hide(),jq(".tabWrapper.specificDate").click()));var b=this.calendarBaseClass;this.options.dropdownClass&&(b=b+" "+this.options.dropdownClass);c(a).addClass("r9-datepicker-focus");this.dropdown.addClass(b);this.advanceStyling&&
this.dropdown.addClass("r9-advance-styling");this.wholeMonthSearch?this.dropdown.addClass("CalendarWidget-WholeMonthSearch"):this.dropdown.hasClass("CalendarWidget-WholeMonthSearch")&&this.dropdown.removeClass("CalendarWidget-WholeMonthSearch");b=this.dropdown[0].style;this.positionDropdown(a);d.events.publish("common.widgets.datepicker.DaterangePicker.showDropdown",{wrapper:a});var e=this,g=c(window).width();this.resizeHandler=function(){var b=c(window).width();10<Math.abs(b-g)&&(g=b,e.positionDropdown(a))};
c(window).on("resize",this.resizeHandler);this.bindItemEvent("mousedown",this.handleItemClickEvent);if("ontouchstart"in document.documentElement){var f=this;this.overlay.addClass("touch");this.bindOverlayEvent("mousedown",function(){f.hideDropdown()})}else this.bindItemEvent("mouseover",this.handleItemHoverEvent),this.bindItemEvent("mouseout",this.handleItemHoverEndEvent);this.isResponsive()&&this.presentationCheck()&&(this.updateTitle(),this.bindEvent(this.findCloseLink(),"click",this.handleCloseEvent));
this.bindNextPrevEvent("mousedown",this.handleNextPrevClickEvent);this.dropdown.prop("data-owner",a.attr("id"));this.loadBuzzData&&this.displayBuzzData();b.display=this.isResponsive()&&this.presentationCheck()?"block":"inline";this.wholeMonthSearch&&(e=this,jq(".noOfNightsInput").on("click",function(){jq(this).change().select()}),setTimeout(function(){jq(".noOfNightsInput").is(":focus")||(e.clickTarget=jq(".noOfNightsInput"),jq(".noOfNightsInput").trigger("click"))},300));this.isResponsive()&&(this.presentationCheck()?
this.html.addClass("mobile-overlay-fix-content"):this.html.removeClass("mobile-overlay-fix-content"))},createCalendarTabNavBindings:function(){var a=this;jq(a.dropdown).find(".tabWrapper").on("click",function(){var b=this;jq(a.dropdown).find(".tabWrapper:not(no-click)").removeClass("selected");jq(this).addClass("selected");jq(a.dropdown).removeClass("SelectedNavTab-Date").removeClass("SelectedNavTab-Month");if(jq(this).hasClass("specificDate"))setTimeout(function(){var c=jq(b).width(),e=jq(b).position().left-
25;jq(a.dropdown).find(".tabUnderlay").css({left:e,width:c})},10),setTimeout(function(){var b=jq(a.dropdown).find(".tabUnderlay");b.hasClass("no-transition")&&b.removeClass("no-transition")},100),jq(a.dropdown).addClass("SelectedNavTab-Date"),jq(a.dropdown).find(".plusMinus").stop().fadeIn(),"undefined"!==typeof d.storage&&d.storage.set("daterangePickerDefaultNavTab","specificDate"),d.events.publish("flights.search.rt.form.wholeMonthSelect.setSpecificDateCategory",{group:"wholeMonthSelect"}),this.daterangePickerDefaultNavTab=
"specificDate";else{var c=jq(a.dropdown).find(".tabUnderlay");setTimeout(function(){var a=jq(b).width(),e=jq(b).position().left-25;c.css({left:e,width:a})},10);setTimeout(function(){var b=jq(a.dropdown).find(".tabUnderlay");b.hasClass("no-transition")&&b.removeClass("no-transition")},100);jq(a.dropdown).addClass("SelectedNavTab-Month");jq(a.dropdown).find(".plusMinus").stop().fadeOut();"undefined"!==typeof d.storage&&d.storage.set("daterangePickerDefaultNavTab","wholeMonthSearch");setTimeout(function(){jq(".noOfNightsInput").is(":focus")||
(a.clickTarget=jq(".noOfNightsInput"),jq(".noOfNightsInput").trigger("click"))},300);d.events.publish("flights.search.rt.form.wholeMonthSelect.setWholeMonthCategory",{group:"wholeMonthSelect"});this.daterangePickerDefaultNavTab="wholeMonthSearch"}});jq(a.dropdown).find(".input.flexPlusMinus").on("click",function(){jq(this).toggleClass("checked");jq(this).hasClass("checked")?("undefined"!==typeof d.storage&&d.storage.set("flexPlusMinusChecked",!0),d.events.publish("flights.search.rt.form.wholeMonthSelect.enablePlusMinusSearch",
{group:"wholeMonthSelect"})):("undefined"!==typeof d.storage&&d.storage.set("flexPlusMinusChecked",!1),d.events.publish("flights.search.rt.form.wholeMonthSelect.disablePlusMinusSearch",{group:"wholeMonthSelect"}))})},createWholeMonthClickBindings:function(){var a=this;jq(a.dropdown).off("click").on("click",".monthWrapper",function(){jq(a.dropdown).find(".monthWrapper").removeClass("selected");jq(this).addClass("selected");var b=jq(this).data("month"),c=jq(this).data("end-of-month"),g=jq(this).data("year"),
f=new Date(g,b-1,1),c=new Date(g,b-1,c);moment(f).isBefore(moment())&&(f=moment().toDate());"undefined"!==typeof d.storage&&(d.storage.set("flexSelectedMonth",b),d.storage.set("flexSelectedYear",g));d.events.publish("flights.search.rt.form.wholeMonthSelect",{group:"wholeMonthSelect",startDate:f,endDate:c});d.Analytics.api.trackEvent({category:"sw16-flex-to-the-max",action:"searchByWholeMonthClick",label:"month",value:b-1});a.handleCloseEvent()})},createNoOfNightsChangedBinding:function(){var a=jq(this.dropdown).find(".noOfNightsInput");
jq(this.dropdown).off("change").on("change",".noOfNightsInput",function(){var b,c;b=a.val().replace(" ","").replace("nights","").split("-");1<b.length?(c=b[0],b=b[1]):(c=b[0],b=b[0]);7<b-c&&(c=b-7);var g=c+"-"+b;c===b&&(g=c);a.val(g);"undefined"!==typeof d.storage&&d.storage.set("flexNoOfNights",g);d.events.publish("flights.search.rt.form.noOfNightsChanged",{group:"wholeMonthSelect",noOfNights:a.val()})})},endStartIsSameField:function(){return this.options.singleDateMode||this.options.singlePickerWithSingleField},
refreshWidth:function(){var a=this.dropdown[0].style;a.width="inherit";var b=this.dropdown.outerWidth();this.options.minWidth&&(b=Math.max(this.options.minWidth,b));this.options.maxWidth&&(b=Math.min(this.options.maxWidth,b));a.width=b+this.options.offsetWidth+"px"},positionDropdown:function(a){var b=a.offset(),e=jq(this.options.appendTo).offset(),g=this.dropdown[0].style;g.zIndex=10009;c("#datepicker").removeClass("r9-datepicker-responsive-right-position");if(this.isResponsive()&&this.presentationCheck())this.dropdown.css({left:"0",
top:d.utils.presentation.isMobile()?"0":"4%"});else{var f=b.left-e.left,k=f+this.dropdown.outerWidth();k>window.innerWidth&&(k-=window.innerWidth,f=f-k-15,this.dropdown.find(".r9-datepicker-pointer").css("left",k+36+"px"));g.left=f+"px";f=0;this.element.parent()[0]===jq(document.body)[0]&&(f=parseInt((jq(document.body).css("top")||"0").replace("-",""))||0);this.shouldFlipDirection()?(this.dropdown.addClass("up"),g.top=f+b.top-this.dropdown.outerHeight()-e.top+"px"):(this.dropdown.removeClass("up"),
g.top=f+b.top+a.outerHeight()-e.top+"px")}},shouldFlipDirection:function(){var a=c(window).scrollTop(),b=a+c(window).outerHeight(),e=this.dropdown.outerHeight(),d=this.element.offset().top;return d+this.element.outerHeight()+e>b&&!(d-e<a)},initDropdown:function(){var a=this.getDropdownId(this.element),b=this.getDropdownEl(this.element).get(0);if("undefined"===typeof b){var c=d.Widgets.DaterangePicker.prototype.widgetBaseClass+" R9-Overlay";this.options.dropdownClass&&(c=c+" "+this.options.dropdownClass);
b=jq("\x3cdiv\x3e\x3c/div\x3e",{id:a,css:{display:"none",position:"absolute"}}).appendTo(this.options.appendTo)[0];jq(b).addClass(c);this.advanceStyling&&jq(b).addClass("r9-advance-styling");this.wholeMonthSearch&&(jq(b).addClass("CalendarWidget-WholeMonthSearch"),a="specificDate","undefined"!==typeof d.storage&&(a="undefined"!==typeof d.storage.get("daterangePickerDefaultNavTab")?d.storage.get("daterangePickerDefaultNavTab"):"specificDate"),"wholeMonthSearch"===a?jq(b).addClass("SelectedNavTab-Month"):
jq(b).addClass("SelectedNavTab-Date"))}this.dropdown=jq(b);this.overlay=jq("#"+this.widgetBaseClass+"-overlay");this.overlay.length||(this.overlay=jq('\x3cdiv id\x3d"'+this.widgetBaseClass+'-overlay" class\x3d"'+this.widgetBaseClass+'-overlay R9-Overlay"\x3e\x3c/div\x3e').appendTo(this.options.appendTo))},isResponsive:function(){return this.options.responsive},presentationCheck:function(){return this.options.presentationCheck()},handleResponsive:function(){this.presentationCheck()?(this.dropdown.addClass("mobile-datepicker"),
this.overlay.addClass("mobile-overlay"),this.isDropdownVisible()&&!this.html.hasClass("mobile-overlay-fix-content")&&(this.html.addClass("mobile-overlay-fix-content"),this.updateTitle(),this.bindEvent(this.findCloseLink(),"click",this.handleCloseEvent))):(this.dropdown.removeClass("mobile-datepicker"),this.overlay.removeClass("mobile-overlay"),this.html.removeClass("mobile-overlay-fix-content"));this.positionDropdown(this.actOnStart?this.getStartWrapperElement():this.getEndWrapperElement())},updateTitle:function(){var a=
"",b,c="";null!==(b=this.getStartDate())&&(a=moment(b).format(this.options.titleFormat));null!==(c=this.getEndDate())&&b!==c&&(a+=(a?" - ":"")+moment(c).format(this.options.titleFormat));this.findTitle().text(a)}}))})(R9,jQuery);(function(d){d.extend("common.widgets.datepicker.DaterangePicker.prototype.options",{startInputFormat:"MM/DD/YYYY",endInputFormat:"MM/DD/YYYY",startFormat:"ddd M/D",endFormat:"ddd M/D",inlineDisplayFormat:"MMM D",titleFormat:"MMM D"})})(window.R9);(function(c){c.createWidgetClass("datepicker.DatePickerTrackFormatter",{dateFormat:"YYYY-MM-DD",formatCommonData:function(a){var b=this.getParentId(),d=b?c.question.ask("base.search.SearchForm.type."+b):"";return{from:this.formatDateType(a.options.startDate,a.startDate),to:a.dateMode===a.DateMode.SINGLE?void 0:this.formatDateType(a.options.endDate,a.endDate),searchformId:b,searchformType:c.VestigoType.SearchFormType[d]}},getParentId:function(){return c.question.ask("base.search.SearchForm.id")||""},
formatDateType:function(a,b){return new c.VestigoType.DateType(a?this.formatDate(a):"",b?this.formatDate(b):"")},formatDate:function(a){return a&&moment(a).format(this.dateFormat)}})})(R9);(function(d,f){d.createWidgetClass("datepicker.DatePicker",{DateMode:{SINGLE:"single",RANGE:"range",WEEKEND:"weekend",OPENFLEX:"openflex"},Keys:{LEFT:37,UP:38,RIGHT:39,DOWN:40,TAB:9,RETURN:13,PAGE_UP:33,PAGE_DOWN:34,SPACE:32,HOME:36,SHIFT:16,END:35,ESC:27},options:{msg:{},title:"",initDate:"",fullCssClass:"Common-Widgets-Datepicker-DatePicker",startDate:"",endDate:"",dateMode:"range",group:"",updateGroup:"",minRange:0,change:null,dismiss:null,closeDelay:0,rising:!1,getFormData:null,consecutive:!0,
delayShowDropdown:f.noop,showDropdownDelay:200,keepOpenOnRangeStartChange:!0,hasPointer:!0,mobileBreakpoint:568,optionalReturn:!1,markOpenFlexDates:!1,markWeekendDates:!1,hasCloseButton:!0,mobileFriendly:!1,autoScrollPosition:!1,trackEnabled:!0,allowNullDates:!1},dateMode:"range",startDate:0,endDate:0,tempDate:0,weekendStartTime:{day:4,partial:""},weekendEndTime:{day:0,partial:""},picking:"startDate",prevState:null,visible:!1,html:null,fullScreen:!1,calendar:null,cssClasses:[],lastAboveMobileContent:null,
addFixedClass:!1,calendarElementCss:{},dateTrackFormatter:null,init:function(){this.cssClasses=[];this.html=f("html");this.addCssClass(this.options.fullCssClass);this.options.getFormData&&this.addCssClass("Buzz");this.makeAboveCalendarContent();this.makeBelowCalendarContent();d.events.when("common.widgets.datepicker.calendar.initialized",function(a){this.calendar=a.instance;this.options.startDate&&this.validateDate(this.options.startDate)&&(this.startDate=moment(this.options.startDate).valueOf());
this.options.endDate&&this.validateDate(this.options.endDate)&&(this.endDate=moment(this.options.endDate).valueOf());this.options.dateMode&&this.setDateMode(this.options.dateMode);this.addMeToCalendar()}.bind(this));this.dateTrackFormatter=this.options.trackEnabled?new d.common.widgets.datepicker.DatePickerTrackFormatter:null},addMeToCalendar:function(){var a=this.getExtraOptions();this.calendar.addPicker(f.extend({},{id:this.id(),dateMode:this.dateMode,initDate:this.options.initDate,title:this.options.title,
cssClass:this.getCssClass.bind(this),group:this.options.group,onLoad:this.onLoad.bind(this),afterLoad:this.afterLoad.bind(this),onUnload:this.onUnload.bind(this),onDayClick:this.onDayClick.bind(this),onDayOver:this.onDayPreviewOver.bind(this),onDayOut:this.onDayPreviewOut.bind(this),onDayKeydown:this.onDayKeydown.bind(this),autoScrollPosition:this.options.autoScrollPosition},a))},onLoad:function(a){this.addAboveCalendarContent(a.aboveCalendarContainer,a.leftContainer);this.addBelowCalendarContent(a.belowCalendarContainer,
a.leftContainer)},afterLoad:function(a){},onUnload:function(){this.removeAboveCalendarContent();this.removeBelowCalendarContent();this.updatePickingVal("startDate")},addAboveCalendarContent:function(a){var b=this.element.find(".aboveCalContent");b.length&&(this.aboveCalContent=b,a.append(b))},addBelowCalendarContent:function(){},removeAboveCalendarContent:function(){this.aboveCalContent&&this.element.append(this.aboveCalContent);this.lastAboveMobileContent&&this.element.append(this.lastAboveMobileContent)},
removeBelowCalendarContent:function(){},addEventHandlers:function(){this.subscribe("DateInput.update",{group:this.options.group},this.onDateInputUpdate.bind(this));this.subscribe("DateInput.summon",{group:this.options.group},this.onSummon.bind(this));this.subscribe("DateInput.dismiss",{group:this.options.group},this.onDismiss.bind(this));this.subscribe("Calendar.monthchange",{group:this.options.group},this.onMonthChange.bind(this));this.subscribe("forceDismiss.DatePicker",this.onDismiss.bind(this));
this.subscribe("DateInput.change.element.style",this.changeElementStyle.bind(this));f(document).on("click.DatePicker",this.hideOnClickOut.bind(this));f(window).on("resize.DatePicker",this.handleWindowResize.bind(this));this.options.optionalReturn&&this.subscribe("DateInput.clear",{group:this.options.group},this.onClear.bind(this))},destroy:function(){f(window).off("resize.DatePicker"+this.id());f(document).off("click.DatePicker"+this.id());this.base();this.element.remove()},getCssClass:function(){return[this.cssClasses.join(" "),
"R9-Overlay"].join(" ")},hideOnClickOut:function(a){var b=f(a.target).closest("[data-date-group\x3d%s]".format(this.options.group));if((a.originalEvent||!d.config.getBoolean("ui.xp.autoopen-dp",!1))&&this.isCalendarOpen()&&0===b.length)this.onDismiss()},handleWindowResize:function(){this.isCalendarOpen()&&(this.calendar.append(this.options.appendTo)||this.calendar.position(this.picking))},publishUpdate:function(a){f.extend(a,{updateGroup:this.options.updateGroup,group:this.options.group});d.events.publish("DatePicker.update",
a)},onDateInputUpdate:function(a){if(this.isCalendarOpen()||a.force)switch(a.clear&&this.clear(),a.picking&&this.updatePickingVal(a.picking),a.weekendStartTime&&(this.weekendStartTime=this.parseWeekendTimes(a.weekendStartTime)),a.weekendEndTime&&(this.weekendEndTime=this.parseWeekendTimes(a.weekendEndTime)),a.dateMode&&this.setDateMode(a.dateMode),a.action){case "preview":this.updatePickingVal(a.field);!a.previous&&a.value||this.removeDatePreview(a.previous,!0);a.value&&this.previewDate(a.value,a.preventUpdate);
break;case "change":a.spinner&&this.handleSpinnerUpdate(a);this.changeDate(a.value,a.focused||a.spinner,a.tabForward,a.event);break;case "tab":this.handleTabIntoEvent(a)}},addCssClass:function(a){a.split(" ").forEach(function(a){0<=this.cssClasses.indexOf(a)||this.cssClasses.push(a)}.bind(this))},changeElementStyle:function(a){this.addFixedClass=a.addFixedClass;this.calendarElementCss=a.calendarElementCss},removeCssClass:function(a){a.split(" ").forEach(function(a){for(var b=this.cssClasses.indexOf(a);0<=
b;)this.cssClasses.splice(b,1),b=this.cssClasses.indexOf(a)}.bind(this))},onSummon:function(a){if(this.calendar)if(this.tempDate=0,"function"===typeof this.options.delayShowDropdown&&this.options.delayShowDropdown()&&!this.showDropdownTimeout)this.showDropdownTimeout=setTimeout(this.onSummon.bind(this,a),this.options.showDropdownDelay);else{null!==this.showDropdownTimeout&&(clearTimeout(this.showDropdownTimeout),this.showDropdownTimeout=null);this.setPicking(a.field,!0);null!==this.options.getFormData?
this.addCssClass("Buzz"):this.removeCssClass("Buzz");a.modal?this.addCssClass("InModal"):this.removeCssClass("InModal");a.mcfly?this.addCssClass("mcfly"):this.removeCssClass("mcfly");a.inContent?this.addCssClass("InContent"):this.removeCssClass("InContent");this.addFixedClass?this.addCssClass("calendar-fixed"):this.removeCssClass("calendar-fixed");a.rising?this.addCssClass("Rising"):this.removeCssClass("Rising");a.sticky?this.addCssClass("InSticky"):this.removeCssClass("InSticky");this.validateDate(a.minDate,
!0)&&this.setMinDate(a.minDate);!0===this.options.mobileFriendly&&this.addCssClass("mobile-friendly");!0===this.options.seoDatepicker&&this.addCssClass("seo-datepicker");if(!this.isCalendarOpen()||this.calendar.isDifferentPicker(this.id())){this.calendar.open(this.id());var b=d.question.ask("DateInput.%s.startDate".format(this.options.group));b&&(this.startDate=b.value);if(this.dateMode===this.DateMode.RANGE){var c=d.question.ask("DateInput.%s.endDate".format(this.options.group));this.validateDateRange(b.value,
c.value)&&(this.startDate=b.value,this.endDate=c.value);c&&(this.endDate=c.value)}d.events.publish("DatePicker.opened",this.options.group);this.setDateMode(this.dateMode,!1,!0)}this.calendar.setDisplayHeight();this.calendar.append(this.options.appendTo)||this.calendar.position(this.getPicking());this.moveDateIntoView(this[a.field]);this.markSelectedDays();this.updateBuzzData();this.options.hasCloseButton&&this.bindEvent(this.findCloseLink(),"click",this.handleCloseEvent);f(".Common-Widgets-Datepicker-Calendar.Common-Widgets-Datepicker-DatePicker").css(this.calendarElementCss)}},
dismissDatePicker:function(a){this.calendar&&(this.trackInteraction(),this.visible=!1,this.hideTooltip(),0!==this.tempDate&&this.changeDate(this.tempDate,!1,!1,null),this.calendar.buffer(this.options.appendTo),this.calendar.close(this.id()),this.publishUpdate(f.extend(a,{action:"blur",fields:{startDate:!0,endDate:!0},format:"display"})),"function"===typeof this.options.dismiss&&this.options.dismiss(),d.events.publish("DatePicker.closed",f.extend({},a,{group:this.options.group})))},onDismiss:function(a){this.shouldDismiss(a)&&
(this.options.closeDelay?setTimeout(this.dismissDatePicker.bind(this,a),this.options.closeDelay):this.dismissDatePicker(a))},shouldDismiss:function(a){return this.dateMode===this.DateMode.RANGE&&a&&this.options.consecutive&&(a.tabForward&&"startDate"===this.getPicking()||a.tabBackward&&"endDate"===this.getPicking())?!1:!0},onClear:function(a){},onDayClick:function(a){a=f(a).data("val");this.changeDate(a)},changeDate:function(a,b,c,e){moment(a);var g=!1,k=!0,f=this.getPicking(),d={action:"change",
fields:{}};this.tempDate=0;if(this.dateMode===this.DateMode.RANGE){if("startDate"===this.getPicking()&&this.validateDate(a))this.startDate===a&&this.options.consecutive?this.setPicking("endDate",c,void 0,c):(this.startDate=a,d.fields.startDate=a,this.validateDateRange(a,this.endDate)||(this.endDate=0,this.options.optionalReturn?d.fields.endDate=null:(d.fields.endDate=this.getMinEndDate(),this.endDate=d.fields.endDate)),this.moveDateIntoView(a),this.markSelectedDays(),!b&&this.isCalendarOpen()&&((0===
this.endDate||this.options.keepOpenOnRangeStartChange)&&this.options.consecutive?this.setPicking("endDate",c,void 0,c):g=!0)),"endDate"===this.wasPicking&&this.endDate&&(d.fields.endDate=this.endDate);else if("endDate"===this.getPicking()&&this.validateDate(a))if(this.endDate===a)k=!1,0===this.startDate&&this.options.consecutive?this.setPicking("startDate"):g=!0;else{if(this.validateDateRange(this.startDate,a)||!this.startDate)this.endDate=a,d.fields.endDate=a;this.startDate||(this.startDate=this.getMinStartDate(),
d.fields.startDate=this.startDate);this.moveDateIntoView(this.endDate);this.markSelectedDays();b||(0===this.startDate&&this.options.consecutive?this.setPicking("startDate"):g=!0)}d.picking=this.getPicking()}else{this.moveDateIntoView(a);d.fields.startDate=a;if(this.validateDate(this.endDate)&&!this.validateDateRange(a,this.endDate)){var l=Math.max(this.options.minRange,1),l=moment(a).add(l,"days");d.fields.endDate=l.valueOf();this.endDate=d.fields.endDate}this.startDate=a;this.markSelectedDays();
b||(g=!0)}d.tabForward=c;k&&this.publishUpdate(d);"function"===typeof this.options.change&&(a=[this.startDate],a.push(this.endDate?this.endDate:null),a.push(f),this.options.change.apply(this,a));g&&(g={},g.field=this.picking,g.tabForward=c,g.event=e,g.focusDisplay=!0,this.onDismiss(g))},moveDateIntoView:function(a){0!==a&&this.isCalendarOpen()&&(a=this.calendar.calculateMonthOffset(a),0!==a&&this.calendar.changeMonth(a))},clear:function(){this.endDate=this.startDate=0;this.setPicking("startDate");
this.clearDayState("preview");this.clearDayState("hover");this.clearDayState("highlighted");this.clearDayState("selected");this.clearDayState("startDate");this.clearDayState("endDate");this.publishUpdate({action:"clear",fields:{startDate:0,endDate:0}})},onMonthChange:function(){this.updateBuzzData();this.markSelectedDays()},clearDayState:function(a){var b=this.calendar.getSelectableDays(".%s".format(a)).removeClass(a);"selected"===a&&(b.removeAttr("aria-selected"),this.calendar.getSelectableDays(".flex").removeClass("flex"))},
validateDate:function(a,b){if("undefined"===typeof a||0===a)return!1;a=moment(a);var c=this.calendar.getMinDate(this.id());if(a.isValid()){if(a.isBefore(this.calendar.now)&&!this.options.allowPastDates||!b&&null!==c&&a.isBefore(c))return!1}else return!1;return!0},validateDateRange:function(a,b){return a&&b?this.validateMinRange(a,b)&&this.validateDate(a)&&this.validateDate(b):!1},validateMinRange:function(a,b){a=moment(a);return moment(b).diff(a,"days")>=this.options.minRange},getMinStartDate:function(){return this.endDate?
moment(this.endDate).subtract(this.options.minRange,"days").valueOf():0},getMinEndDate:function(){return this.startDate?moment(this.startDate).add(this.options.minRange,"days").valueOf():0},onDayPreviewOver:function(a){a=f(a).data("val");this.previewDate(a)},previewDate:function(a,b){var c=moment(a),e={action:"preview",fields:{},picking:this.getPicking()};if(!a||c.isBefore(this.calendar.now))c=this.calendar.now.clone(),a=c.valueOf();else if(c.isSame(this.calendar.maxDate)||c.isAfter(this.calendar.maxDate))c=
this.calendar.maxDate.clone(),a=c.valueOf();this.dateMode===this.DateMode.RANGE?"endDate"===this.getPicking()&&0!==this.startDate?this.validateMinRange(this.startDate,a)?this.validateDateRange(this.startDate,a)?e.fields[this.getPicking()]=a:e.endDate=this.getMinEndDate():(0===this.endDate?(this.endDate=this.startDate,this.startDate=0,e.fields={startDate:a,endDate:this.endDate}):e.fields={startDate:a,endDate:0},this.wasPicking=this.getPicking(),this.setPicking("startDate",!0,!0),e.picking="startDate"):
e.fields[this.getPicking()]=a:e.fields.startDate=a;b||this.publishUpdate(e);this.moveDateIntoView(a);this.markPreviewedDays(a)},removeDatePreview:function(a,b){if(this.isCalendarOpen()){a={action:"preview",fields:{startDate:0,endDate:0},clear:!0};this.clearDayState("preview");this.clearDayState("hover");this.hideTooltip();if(this.wasPicking){var c=this[this.wasPicking],e=this[this.getPicking()];if(0===e||0===c)this[this.wasPicking]=e,this[this.getPicking()]=c;delete a.fields[this.wasPicking];this.setPicking(this.wasPicking,
!1,!0);this.wasPicking=null;this.markSelectedDays()}a.picking=this.getPicking();b||this.publishUpdate(a)}},onDayPreviewOut:function(a){a=f(a).data("val");this.removeDatePreview(a)},setDateMode:function(a,b,c){this.dateMode=a;c||this.dateMode===this.DateMode.RANGE||this.setPicking("startDate");this.isCalendarOpen()&&this.markSelectedDays()},computeActiveDates:function(a,b){var c=function(){return a?[a.format(b)]:[b]};switch(this.dateMode){case this.DateMode.RANGE:return this.computeActiveRangeDates(a,
b);case this.DateMode.WEEKEND:return this.options.markWeekendDates?this.computeActiveWeekendDates(a,b):c();case this.DateMode.OPENFLEX:return this.options.markOpenFlexDates?this.computeActiveOpenFlexDates(a,b):c();default:return c()}},computeActiveRangeDates:function(a,b){var c;b||(b=this[this.getPicking()]);b&&(c=moment(b));var e=[];if(c)if("startDate"===this.getPicking()&&this.endDate&&c.valueOf()<=this.endDate){b=this.endDate;var g=this.calendar.getMonthDate(3),d=moment(this.endDate);if(g.isSame(d)||
g.isBefore(d))b=this.calendar.getMonthDate(3).valueOf();for(;c.valueOf()<=b;)a?e.push(a.format(c.valueOf())):e.push(c.valueOf()),c.add(1,"day")}else if("endDate"===this.getPicking()&&this.startDate&&c.valueOf()>=this.startDate){b=this.startDate;g=this.calendar.getMonthDate(-1);d=moment(this.startDate);if(g.isSame(d)||g.isAfter(d))b=this.calendar.getMonthDate(-1).valueOf();for(;c.valueOf()>=b;)a?e.unshift(a.format(c.valueOf())):e.unshift(c.valueOf()),c.add(-1,"day")}else a?e.push(a.format(b)):e.push(b);
return e},computeActiveWeekendDates:function(a,b){b=b?moment(b):moment(this.startDate);for(var c=b.clone().add(5,"weeks"),e={selected:[],highlighted:[]},d=!1,f=[],h=[];b.isSame(c)||b.isBefore(c);)!d&&b.day()>this.weekendStartTime.day||(b.day()===this.weekendStartTime.day?(d=!0,f=[],h=[],a?f.push(a.format(b.valueOf())):f.push(b.valueOf())):b.day()===this.weekendEndTime.day&&d?(a?f.push(a.format(b.valueOf())):f.push(b.valueOf()),e.selected=e.selected.concat(f),e.highlighted=e.highlighted.concat(h)):
(b.day()>this.weekendStartTime.day||b.day()<this.weekendEndTime.day)&&d&&(a?h.push(a.format(b.valueOf())):h.push(b.valueOf()))),b.add(1,"day");return e},computeActiveOpenFlexDates:function(a,b){b=b?moment(b):moment(this.startDate);for(var c=b.clone().add(5,"weeks"),e=[];b.isSame(c)||b.isBefore(c);)a?e.push(a.format(b.valueOf())):e.push(b.valueOf()),b.add(1,"day");return e},parseWeekendTimes:function(a){var b=a.split("_");a=b[0];b=b[1];return{day:moment().set("day",a).day(),partial:"ANYTIME"!==b?b:
""}},markSelectedDays:function(){var a;if(this.isCalendarOpen())switch(this.clearDayState("highlighted"),this.clearDayState("preview"),this.clearDayState("hover"),this.clearDayState("selected"),this.clearDayState("startDate"),this.clearDayState("endDate"),this.dateMode){case this.DateMode.RANGE:a=this.computeActiveDates("[data-val\x3d%s]");1<a.length&&this.calendar.highlightDates(a);this.startDate&&(a=this.getStartDayElements(),a.flex&&this.calendar.markFlex(a.flex),a.exact&&this.calendar.markStartDate(a.exact));
this.endDate&&(a=this.getEndDayElements(),a.flex&&this.calendar.markFlex(a.flex),a.exact&&this.calendar.markEndDate(a.exact));break;case this.DateMode.OPENFLEX:this.options.markOpenFlexDates&&(a=this.computeActiveDates("[data-val\x3d%s]"),this.calendar.getSelectableDays(a.join(",")).addClass("highlighted"));this.calendar.getDayElement(this.startDate).addClass("selected").attr("aria-selected","true");break;case this.DateMode.WEEKEND:this.options.markWeekendDates&&(a=this.computeActiveDates("[data-val\x3d%s]"),
this.calendar.getSelectableDays(a.selected.join(",")).addClass("highlighted"),a.highlighted.length&&this.calendar.getSelectableDays(a.highlighted.join(",")).addClass("highlighted"));this.calendar.getDayElement(this.startDate).addClass("selected").attr("aria-selected","true");break;default:this.calendar.selectDate(this.startDate)}},getStartDayElements:function(){return{exact:this.startDate}},getEndDayElements:function(){return{exact:this.endDate}},markPreviewedDays:function(a){this.clearDayState("preview");
this.clearDayState("hover");var b=this.computeActiveDates("[data-val\x3d%s]",a);this.calendar.markPreviewDates(b);a=this.calendar.getDayElement(a);a.addClass("hover");a.attr("data-tip")&&this.showTooltip(a)},setPicking:function(a,b,c,e){if(this.getPicking()!==a){this.tempDate=0;var d={},f={};d[this.getPicking()]=!0;f[a]=!0;this.updatePickingVal(a);this.calendar.position(this.getPicking(),c);b||this.publishUpdate({action:"focus",fields:f,format:"input"});this.publishUpdate({action:"blur",fields:d,
tabForward:e})}},updatePickingVal:function(a){this.picking=a},getPicking:function(){return this.picking},findCloseLink:function(){return f(".DatePickerTitleClose",this.calendar.element)},handleCloseEvent:function(){this.onDismiss()},bindEvent:function(a,b,c){var e=this;b+="."+this.id();a.off(b).on(b,function(a){return c.call(e,this,a)})},isBuzzEnabled:function(){return"function"===typeof this.options.getFormData&&d.DatePicker&&d.DatePicker.BuzzData},updateBuzzData:function(){this.isBuzzEnabled()&&
(new d.DatePicker.BuzzData).fetch(this.options.getFormData(),this.handleBuzzUpdate.bind(this))},handleBuzzUpdate:function(a){var b=this,c=this.calendar.months.find("[data-tip\x3dBUZZ_LOW]"),e=[];window.subData&&(a=window.subData);if("object"===typeof a.dates)for(var d in a.dates)a.dates.hasOwnProperty(d)&&"LOW"===a.dates[d]&&e.push(moment(d).valueOf());0<c.length&&c.each(function(a,b){a=f(b);b=e.indexOf(a.attr("data-val"));-1==b?a.removeClass("buzz-date-low").removeAttr("data-tip"):e.splice(b,1)});
f.each(e,function(a,c){b.calendar.getDayElement(c).addClass("buzz-date-low").attr("data-tip","BUZZ_LOW")})},makeAboveCalendarContent:function(){f("\x3cdiv class\x3d'aboveCalContent'\x3e"+(this.options.hasCloseButton?"\x3ca class\x3d'DatePickerTitleClose'\x3eX\x3c/a\x3e":"")+"\x3cdiv id\x3d'"+this.id("BUZZ_LOW")+"' class\x3d'dayTip buzzMsg'\x3e"+this.options.msg.BUZZ_MESSAGE_LOW+"\x3c/div\x3e\x3c/div\x3e").appendTo(this.element)},makeBelowCalendarContent:function(){},showTooltip:function(a){var b=
this.getChildElement(a.attr("data-tip"));a=a.offset();var c=this.calendar.element.offset();b.css({top:Math.round(a.top-c.top),left:Math.round(a.left-c.left)}).show()},hideTooltip:function(){this.calendar.hideTooltip()},setMinDate:function(a){this.calendar.setMinDate(a,this.id())},onDayKeydown:function(a,b){a=moment(this.getCurrentDayVal());var c=!0,d=!1,f=!1,k=!0,h=!1;switch(b.which){case this.Keys.UP:a.subtract(1,"week");break;case this.Keys.DOWN:a.add(1,"week");break;case this.Keys.LEFT:a.subtract(1,
"day");break;case this.Keys.RIGHT:a.add(1,"day");break;case this.Keys.PAGE_UP:b.ctrlKey||b.metaKey?a.subtract(1,"year"):a.subtract(1,"month");break;case this.Keys.PAGE_DOWN:b.ctrlKey||b.metaKey?a.add(1,"year"):a.add(1,"month");break;case this.Keys.HOME:a=a.startOf("month");break;case this.Keys.END:a=a.endOf("month");break;case this.Keys.SPACE:this.tempDate=0;d=!0;c=!1;f=!0;break;case this.Keys.TAB:this.tempDate=0;c=!1;b.shiftKey?this.handleDayTabBackward():(h=d=!0,k=!1);break;case this.Keys.RETURN:this.tempDate=
0;c=!1;d=!0;break;case this.Keys.ESC:this.tempDate=0;this.onDismiss({focusDisplay:!0});break;default:c=k=!1}c&&this.validateDate(a.valueOf(),!1)&&("endDate"!==this.picking||this.validateDateRange(this.startDate,a.valueOf())||this.options.allowNullDates)&&(this.tempDate=a.valueOf(),this.previewDate(this.tempDate),this.calendar.getDayElement(this.tempDate).focus());d&&this.changeDate(a.valueOf(),f,h,b);k&&b.preventDefault()},getCurrentDayVal:function(){var a=this.tempDate?this.tempDate:this[this.getPicking()];
0===a&&(a="startDate"===this.getPicking()||0===this.startDate?moment().startOf("day").valueOf():this.getMinEndDate());return a},publishCurrentInputFocus:function(){var a={};a[this.picking]=!0;this.publishUpdate({action:"focus",fields:a,format:"input"})},handleTabIntoEvent:function(a){this.setPicking(a.field);var b=a&&a.event&&a.event.shiftKey,c;if("startDate"===this.getPicking())if(b)this.onDismiss(a);else c=!0,this.calendar.getDayElement(this.startDate).focus();else"endDate"===this.getPicking()&&
(c=!0,b?(this.setPicking("startDate"),this.calendar.getDayElement(this.startDate).focus()):this.calendar.getDayElement(this.endDate).focus());c&&a&&a.event&&a.event.preventDefault()},handleDayTabBackward:function(){this.publishCurrentInputFocus()},handleSpinnerUpdate:function(a){var b=a.currentValue,c=a.delta;b||("endDate"===this.getPicking()&&this.startDate?b=this.getMinEndDate():(b=(new Date).valueOf(),c=1));a.value=moment(b).add(c,"day").valueOf()},isCalendarOpen:function(){return this.calendar&&
this.calendar.isOpen&&this.calendar.currentPickerId===this.id()},getExtraOptions:function(){return{}},trackInteraction:function(){if(this.dateTrackFormatter&&this.isCalendarOpen()){var a=this.dateTrackFormatter.formatCommonData(this),b=new d.VestigoType.DatePrecisionHistory(d.VestigoType.DatePrecision.exact);d.VestigoEvents.calendarpicker.dates(a.from,b,a.searchformId,a.searchformType,a.to,b)}}})})(R9,jQuery);(function(b,c){b.createWidgetClass("datepicker.StyleJamDateRangeInput",{separator:null,options:{group:"",dateMode:"range",datePickerId:null,responsive:!1,responsiveMobileOnly:!1,dateRangeInputFlex:null,dateRangeInputBlurred:null,dateRangeInputFocused:null,flexIconVisible:null,flexIconHidden:null,displayFlexHidden:null,endInputHidden:null,presentationBase:"",changeEvent:null},startWrapper:null,endWrapper:null,flexWrapper:null,suspendBlur:!1,init:function(){this.separator=this.getChildElement("separator");
this.$flexIcon=this.element.find(".js-flexIcon");this.endCol=this.getChildElement("end");this.endWrapper=this.getChildElement("endWrapper");this.flexWrapper=this.getChildElement("flexWrapper")},addEventHandlers:function(){var a=this;this.subscribe("DatePicker.update",{group:this.options.group},this.onDatePickerUpdate.bind(this));this.options.changeEvent&&(this.subscribe(this.options.changeEvent+".change",function(b){if(!b.namespace||a.id().startsWith(b.namespace))a.onDisplayCatChange(b.value)}),this.subscribe(this.options.changeEvent+
".set",this.onDisplayCatChange.bind(this)));this.subscribe("DatePicker.opened",this.options.group,this.toggleFocusState.bind(this,!0));this.subscribe("DatePicker.closed",{group:this.options.group},this.toggleFocusState.bind(this,!1))},toggleFocusState:function(a){a?(b.dom.swapClasses(this.element,this.options.dateRangeInputBlurred,this.options.dateRangeInputFocused),b.events.publish("DateRangeInput.opened",this.options.group)):(b.dom.swapClasses(this.element,this.options.dateRangeInputFocused,this.options.dateRangeInputBlurred),
b.events.publish("DateRangeInput.closed",this.options.group))},onInputFocus:function(){var a=this;this.toggleFocusState(!0);this.suspendBlur=!0;setTimeout(function(){a.suspendBlur=!1},100)},onInputBlur:function(){this.suspendBlur||this.toggleFocusState(!1)},onDatePickerUpdate:function(a){"flex"===a.action&&("openflex"===a.data.flex_category||"weekend"==a.data.flex_category?(this.setDateMode("range",a.data.flex_category),this.showFlexDisplay()):(this.toggleFlex(a.data.flex_category),this.hideFlexDisplay()),
this.options.flexDisplayEnabled&&("plusminusthree"===a.data.flex_category?"exact"===a.data.depart_date_flex&&"exact"===a.data.return_date_flex?this.hideFlexIcon():this.showFlexIcon():"exact"===a.data.flex_category?this.hideFlexIcon():this.showFlexIcon()))},onDisplayCatChange:function(a){switch(a){case "oneway":this.setDateMode("single");break;case "roundtrip":this.setDateMode("range")}},getField:function(a){return"range"===this.options.dateMode?a.offsetX<=this.separator.position().left?"startDate":
"endDate":"startDate"},setDateMode:function(a,b){this.options.dateMode=a;"single"===a?(this.endCol.attr("aria-hidden","true"),this.separator.attr("aria-hidden","true"),this.hideEndDate()):(this.endCol.attr("aria-hidden","false"),this.separator.attr("aria-hidden","false"),this.showEndDate(),this.options.changeEvent&&this.subscribe(this.options.changeEvent,this.onDisplayCatChange.bind(this)));"undefined"!==typeof b&&this.toggleFlex(b)},toggleFlex:function(a){"weekend"===a||"openflex"===a?(this.element.addClass("mode-flex"),
this.flexWrapper.attr("aria-hidden","false"),this.endWrapper.attr("aria-hidden","true")):(this.element.removeClass("mode-flex"),this.flexWrapper.attr("aria-hidden","true"),this.endWrapper.attr("aria-hidden","false"))},getStlChildrenClasses:function(){return b.stylejam.common.widgets.datepicker.StyleJamDateRangeInput[this.options.presentationBase]},showEndDate:function(){b.dom.swapChildrenClasses(this.element,this.getStlChildrenClasses(),"single","range")},hideEndDate:function(){b.dom.swapChildrenClasses(this.element,
this.getStlChildrenClasses(),"range","single")},showFlexIcon:function(){b.dom.swapChildrenClasses(this.element,this.getStlChildrenClasses(),"noflex","flex")},hideFlexIcon:function(){b.dom.swapChildrenClasses(this.element,this.getStlChildrenClasses(),"flex","noflex")},showFlexDisplay:function(){b.dom.swapClasses(this.endWrapper,"",this.options.endInputHidden);b.dom.swapClasses(this.flexWrapper,this.options.displayFlexHidden,"")},hideFlexDisplay:function(){b.dom.swapClasses(this.flexWrapper,"",this.options.displayFlexHidden);
b.dom.swapClasses(this.endWrapper,this.options.endInputHidden,"")},focus:function(){var a=this.element.data("dateModal");a?a.toggleOverlayWindow(!0):b.events.publish("DateInput.startDate.focus",{group:this.options.group})}})})(R9,jQuery);(function(a,d){a.createWidgetClass("datepicker.DateModal",{display:null,overlayWindow:null,overlayContent:null,overlayBackground:null,inputWrapper:null,endInput:null,placeholderUpdateInterval:null,overlayInit:!1,triggeringFocus:!1,clicking:!1,open:!1,focusTimeout:-1,onBrowserWindowRefocus:null,browserWindowRefocused:null,spinnerIds:null,startDate:null,startTime:null,startTimeSelect:null,endDate:null,endTime:null,endTimeSelect:null,endTimeWasChangedByUser:!1,timeValuesMap:null,displayMode:null,options:{mobileBreakpoint:568,
desktopBreakpoint:1024,dateFormat:"ddd M/D",spinners:!1,isDateTime:!1,isSingle:!1,timeDropdown:!1,timeDropdownOpenStartAfterDate:!1,timeDropdownOpenEndAfterStart:!1,timeDropdownSyncEndToStart:!1,syncChangedByUserEndTimeToStart:!0,flexEnabled:!1,alignment:"left",responsive:!1,compressedLayout:!1,repositionOnScroll:!1,startDateField:"",startDateId:"",endDateField:"",endDateId:"",datePickerId:"",datePickerClassName:"",group:"",updateGroup:"",scrollLockEnabled:!1,dayOfWeekEnabled:!1,modal:!1,openModalOnInitialisation:!1,
searchInputContainerId:void 0,mcfly:!1},displayStart:null,inputStartDec:null,inputStartInc:null,inputSeparator:null,displayEnd:null,inputEndDec:null,inputEndInc:null,displayStartIcon:null,displayEndIcon:null,displayStartChevron:null,displayEndChevron:null,scrollPosition:void 0,previousOverflow:void 0,inContent:!1,init:function(){var b=this;this.options.mcfly&&(this.stlNamespace+=".MCFLY");this.display=this.getChildElement("display");this.displayStartInner=this.getChildElement("display-start-inner");
this.displayEndInner=this.getChildElement("display-end-inner");this.overlayWindow=this.getChildElement("overlay-window");this.overlayContent=this.options.searchInputContainerId?d("#"+this.options.searchInputContainerId):this.getChildElement("overlay-content");this.overlayBackground=this.getChildElement("overlay-bg");this.inputWrapper=this.getChildElement("input-wrapper");this.close=this.getChildElement("close");this.options.startDate&&this.setStartDate(moment(this.options.startDate).valueOf());this.options.endDate&&
this.setEndDate(moment(this.options.endDate).valueOf());this.options.spinners&&(this.spinnerIds="#"+this.id("start-inc")+", #"+this.id("end-inc")+", #"+this.id("start-dec")+", #"+this.id("end-dec"));this.inContent=!!this.options.searchInputContainerId;this.displayMode=this.options.dateMode;this.options.flexEnabled&&(this.flexStartDisplay=this.getChildElement("start-flex"),this.flexEndDisplay=this.getChildElement("end-flex"));this.endInput=this.inputWrapper.find(".js-end-input");this.startTime=this.getChildElement("start-time");
this.startTimeSelect=this.getChildElement("start-time-select").getWidget();this.endTime=this.getChildElement("end-time");this.endTimeSelect=this.getChildElement("end-time-select").getWidget();setTimeout(function(){b.overlayWindow.css("display","block")},200);this.options.compressedLayout&&(this.displayStart=this.getChildElement("display-start"),this.inputStartDec=this.getChildElement("start-dec"),this.inputStartInc=this.getChildElement("start-inc"),this.inputSeparator=this.getChildElement("input-separator"),
this.displayEnd=this.getChildElement("display-end"),this.inputEndDec=this.getChildElement("end-dec"),this.inputEndInc=this.getChildElement("end-inc"),this.displayStartIcon=this.getChildElement("display-start-icon-wrapper"),this.displayEndIcon=this.getChildElement("display-end-icon-wrapper"),this.displayStartChevron=this.getChildElement("display-start-chevron-wrapper"),this.displayEndChevron=this.getChildElement("display-end-chevron-wrapper"));this.onBrowserWindowRefocus=this.handleBrowserFocus.bind(this)},
bindComponent:function(){(this.options.isSingle||this.options.isDateTime)&&this.base();this.element.data("dateModal",this)},inlineComponentsReady:function(){var b=this;a.dom.schedule(function(){b.positionOverlayWindow()});this.options.openModalOnInitialisation&&(a.utils.presentation.isSmallTablet()||a.utils.presentation.isMobile()||b.toggleOverlayWindow(!0))},addEventHandlers:function(){var b=this;this.registerEvent("mousedown",this.display,function(){b.clicking=!0});this.registerEvent("click",this.display,
function(a){b.clicking=!1;d(a.target).closest("#"+b.id("start-time-select")+",#"+b.id("end-time-select")).length||b.options.spinners&&0!==d(a.target).closest(b.spinnerIds).length||b.toggleOverlayWindow(!0,0<d(a.target).closest("#"+b.id("display-end")).length)});this.registerEvent("mouseup",function(){b.clicking=!1});this.registerEvent("click",this.close,function(){b.toggleOverlayWindow(!1)});this.registerEvent("focus",this.display,function(){if(!b.clicking&&(!b.browserWindowRefocused||b.inContent))if(b.triggeringFocus)b.onFocus(!1),
b.triggeringFocus=!1,clearTimeout(b.focusTimeout);else b.onFocus(!0)});this.registerEvent("keydown",this.display,function(c){c.which===a.globals.keyCodes.TAB?(clearTimeout(b.focusTimeout),b.toggleOverlayWindow(!1)):c.which===a.globals.keyCodes.RETURN&&(clearTimeout(b.focusTimeout),b.toggleOverlayWindow(!0))});this.subscribe("overlay.setitem.complete",function(){b.toggleOverlayWindow(!1)});this.subscribe("DateModal.toggleOverlayWindow",function(a){b.toggleOverlayWindow(a)});this.subscribe("DateInput."+
this.options.group+".setDateMode",function(a){b.setDateMode(a)});this.options.flexEnabled&&(this.subscribe("DateInput."+this.options.group+".startDate.flexChange",function(a){b.flexStartDisplay.html(a)}),this.subscribe("DateInput."+this.options.group+".endDate.flexChange",function(a){b.flexEndDisplay.html(a)}));this.subscribe("DateInput."+this.options.group+".startDate.setDate",function(a){var c=a&&a.date&&a.date.valueOf();null!==c&&b.setStartDate(c);b.refreshInput(b.displayStartInner,a.date)});this.subscribe("DateInput."+
this.options.group+".startDate.clearDate",function(a){b.setStartDate(null);b.refreshInput(b.displayStartInner,null)});this.subscribe("DateInput."+this.options.group+".endDate.setDate",function(a){var c=a&&a.date&&a.date.valueOf();null!==c&&b.setEndDate(c);b.refreshInput(b.displayEndInner,a.date)});this.subscribe("DateInput."+this.options.group+".endDate.clearDate",function(a){b.setEndDate(null);b.refreshInput(b.displayEndInner,null)});this.options.compressedLayout&&this.subscribe("DatePicker.layout.compressed.toggle",
function(a){b.toggleCompressedLayout(a)});this.options.isDateTime&&(this.timeValuesMap={},this.options.timeValues.forEach(function(b){this.timeValuesMap[b.value]=b},this),this.subscribe("DateInput.update",{group:this.options.group,action:"time"},function(a){var c=a.fields.startDate;if(c||0===c)b.startTimeSelect?b.startTimeSelect.setValue(c):(c=b.getTimeDisplay(c),b.startTime.html(c));if((a=a.fields.endDate)||0===a)b.endTimeSelect?b.endTimeSelect.setValue(a):(a=b.getTimeDisplay(a),b.endTime.html(a))}),
this.startTimeSelect&&(this.startTimeSelect.options.change=this.onStartTimeChange.bind(this)),this.endTimeSelect&&(this.endTimeSelect.options.change=this.onEndTimeChange.bind(this)));this.options.flexEnabled&&this.subscribe("DatePicker.update",{group:this.options.group,action:"flex"},this.onFlexUpdate.bind(this));this.subscribe("DatePicker.closed",{group:this.options.group},function(a){b.toggleOverlayWindow(!1);if(a.tabForward||a.tabBackward||a.focusDisplay||a.returnEvent)b.triggeringFocus=!0,b.display.focus();
var c=b.startTimeSelect;b.options.isDateTime&&b.openTimeDropdown&&(b.startDateChanged||b.endDateChanged)&&c&&setTimeout(function(){b.openTimeDropdown=!1;c.focusInlineElement();c.open()},100)});this.subscribe("DateInput.startDate.focus",b.options.group,function(){b.openTimeDropdown=b.options.timeDropdownOpenStartAfterDate;b.startDateChanged=!1;b.endDateChanged=!1});this.options.spinners&&(this.bindSpinner("start-inc","startDate",1),this.bindSpinner("start-dec","startDate",-1),this.bindSpinner("end-inc",
"endDate",1),this.bindSpinner("end-dec","endDate",-1));this.registerEvent("click.overlay",d(document),function(a){b.options.dayOfWeekEnabled&&d(a.target).parents().is(".Common-Widgets-Tip-RichToolTip")||0===d(a.target).closest("#"+b.id("overlay-window")+", #"+b.id("display")+", [data-date-group\x3d"+b.options.group+"]").length&&b.toggleOverlayWindow(!1)});this.registerEvent("resize",d(window),this.positionOverlayWindow.bind(this));this.options.changeEvent&&(this.subscribe(this.options.changeEvent+
".change",function(a){if(!a.namespace||b.id().startsWith(a.namespace))b.onDisplayCatChange(a.value)}),this.subscribe(this.options.changeEvent+".set",this.onDisplayCatChange.bind(this)));this.options.compressedLayout&&this.subscribe("hotels.detailsv2.sticky.toggle",function(b){b?this.hotelDetailsStickyShow():this.hotelDetailsStickyHide()}.bind(this));this.options.repositionOnScroll&&this.registerEvent("scroll",d(window),function(){b.open&&a.dom.schedule(b.positionOverlayWindow.bind(b))});window.addEventListener("focus",
this.onBrowserWindowRefocus)},onStartTimeChange:function(b,a,g){if((g=d("#"+this.options.startDateId).getWidget())&&g.setTime){g.setTime(a);var c=this.options,f=this.endTimeSelect;f&&(c.timeDropdownOpenEndAfterStart?setTimeout(function(){c.timeDropdownSyncEndToStart&&!this.endTimeWasChangedByUser&&(this.onEndTimeChange(b,a,!0),f.val(a));f.focusInlineElement();f.open()}.bind(this),100):c.timeDropdownSyncEndToStart&&!this.endTimeWasChangedByUser&&setTimeout(function(){this.onEndTimeChange(b,a,!0);f.val(a)}.bind(this),
100))}},onEndTimeChange:function(b,a,g){(b=d("#"+this.options.endDateId).getWidget())&&b.setTime&&b.setTime(a);this.shouldMarkEndTimeChangedByUser(g)&&(this.endTimeWasChangedByUser=!0)},shouldMarkEndTimeChangedByUser:function(b){return!this.options.syncChangedByUserEndTimeToStart&&!this.endTimeWasChangedByUser&&!0!==b},bindSpinner:function(b,c,d){var e=this;this.registerEvent("click",this.getChildElement(b),function(){e.publishEvent("DateInput.update",{action:"change",currentValue:e[c],delta:d,field:c,
picking:c,force:!0,spinner:!0});a.Analytics.api.trackEvent({category:c,label:"arrow",action:"click",value:0<d?"inc":"dec"})})},destroy:function(){this.base();this.element.data("dateModal",null);window.clearInterval(this.placeholderUpdateInterval);window.removeEventListener("focus",this.onBrowserWindowRefocus)},positionOverlayWindow:function(){var b=this.display.offset(),c=this.display.outerWidth(!0),g=parseInt(this.display.css("margin-left"),10),e=this.options.mcfly?0:16,f;if(this.options.openModalOnInitialisation&&
a.utils.presentation.isSmallTablet())this.onFocus(!1);if(b){var k=d(window).width();f="right"===this.options.alignment&&this.canRightAlign()?"rtl"===document.dir?-(Math.floor(k-b.left-c)+(c-this.overlayWindow.outerWidth())-e/2):Math.floor(b.left+(c-this.overlayWindow.outerWidth())-e/2):"center"===this.options.alignment?"rtl"===document.dir?-(Math.floor(k-b.left-c)+(c-this.overlayWindow.outerWidth())-e/2):Math.floor(b.left+(c-this.overlayWindow.outerWidth())/2):"rtl"===document.dir?-Math.floor(k-b.left-
c+e/2):Math.floor(b.left-g+e/2);this.overlayBackground.css({width:c-e,height:this.display.outerHeight()-e});this.positionOverlayInputWrapper(c);this.isFullScreen()?this.overlayContent.css({minWidth:0}):this.overlayContent.css({minWidth:Math.max(c,this.options.mcfly?842:532)});"rtl"!==document.dir&&f+this.overlayWindow.outerWidth()+e>d(window).innerWidth()&&(c=d(window).innerWidth()-this.overlayWindow.outerWidth()-e,f=0<c?c:0);"rtl"===document.dir&&Math.abs(f)+this.overlayWindow.outerWidth()+e>d(window).innerWidth()&&
(c=d(window).innerWidth()-this.overlayWindow.outerWidth()-e,f=0<c?-c:0);"rtl"!==document.dir&&(f=Math.max(f,0));this.open&&"parentIFrame"in window&&window.parentIFrame.sendMessage({action:"DatePicker.opened",mode:this.isFullScreen()?"FullScreen":"Normal"});this.options.mcfly&&this.inContent&&this.open&&window.parent.postMessage({action:"McFlySearchDialogFrameDisplay",fullScreen:this.isFullScreen()},window.location.href);var h=Math.floor(b.top+e/2);this.options.modal&&(e=window.scrollY+window.innerHeight,
c=b.top+this.overlayWindow.outerHeight(),e<c&&(h=Math.floor(b.top-this.overlayWindow.outerHeight())));this.options.mcfly&&(this.isFullScreen()?this.inputWrapper.css({left:0}):(this.inputWrapper.css({left:b.left-f}),h=Math.floor(b.top+this.display.outerHeight(!0))));this.overlayWindow.css({maxWidth:d(window).outerWidth(),transform:"translate("+f+"px,"+h+"px)"});if(this.options.mcfly&&!this.isFullScreen()&&this.inContent){var l=this;setTimeout(function(){var a=l.display.offset().top;b.top!==a&&(h=Math.floor(a+
l.display.outerHeight(!0)),l.overlayWindow.css({transform:"translate("+f+"px,"+h+"px)"}))},0)}}},toggleOverlayWindow:function(b,c){var d=this.isFullScreen()?1:200;if(b!==this.open)if(this.open=b,this.options.scrollLockEnabled&&window.innerWidth<this.getFullScreenBreakpoint()&&(b?this.lockScroll():this.unlockScroll()),b){if(this.positionOverlayWindow(),a.dom.swapChildrenClasses(this.overlayWindow,this.getStlClasses().OverlayWindow,"hidden","visible"),this.overlayContent.addClass("visible"),this.overlayBackground.addClass("OverlayWindow__Background-"+
this.options.alignment+"--visible"),this.overlayBackground.removeClass("OverlayWindow__Background-"+this.options.alignment+"--hidden"),this.focusTimeout=setTimeout(function(){c?this._publishDateInputFocus("DateInput.endDate.focus"):this._publishDateInputFocus("DateInput.startDate.focus")}.bind(this),d),this.options.mcfly&&!this.isFullScreen()&&this.inContent&&a.Common.Utils.Browsers.isIE(11)){var e=this;setTimeout(function(){e.positionOverlayWindow()},500)}}else a.dom.swapChildrenClasses(this.overlayWindow,
this.getStlClasses().OverlayWindow,"visible","hidden"),this.overlayContent.removeClass("visible"),this.overlayBackground.removeClass("OverlayWindow__Background-"+this.options.alignment+"--visible"),this.overlayBackground.addClass("OverlayWindow__Background-"+this.options.alignment+"--hidden"),this.publishEvent("DatePicker.dismiss",{}),"parentIFrame"in window&&window.parentIFrame.sendMessage({action:"DatePicker.closed"}),this.options.mcfly&&this.inContent&&(this.publishEvent("DateInput.dismiss",{}),
window.parent.postMessage({action:"McFlySearchDialogFrameDisplay",fullScreen:!1},window.location.href))},onFocus:function(b){this.toggleOverlayWindow(b)},lockScroll:function(){var b=d("html");this.scrollPosition={x:window.pageXOffset||document.documentElement.scrollLeft||document.body.scrollLeft,y:window.pageYOffset||document.documentElement.scrollTop||document.body.scrollTop};this.previousOverflow=b.css("overflow");b.css("overflow","hidden")},unlockScroll:function(){var b=d("html");this.previousOverflow&&
b.css("overflow",this.previousOverflow);this.scrollPosition&&window.scrollTo(this.scrollPosition.x,this.scrollPosition.y)},_publishDateInputFocus:function(b){a.events.publish(b,this.options.group)},positionOverlayInputWrapper:function(b){"undefined"===typeof b&&(b=this.display.outerWidth(!0));this.inputWrapper.css({width:b})},refreshInput:function(b,a){null!==a?(b.html(a.format(this.options.dateFormat)),this.swapClasses(b,this.getStlClasses().inputDateEmpty,this.getStlClasses().inputDateFull)):(b.html(b.attr("data-placeholder")),
this.swapClasses(b,this.getStlClasses().inputDateFull,this.getStlClasses().inputDateEmpty))},getOverlayWrapper:function(){return this.overlayContent},focus:function(){var a=this;setTimeout(function(){a.display.trigger("focus")},50)},isFullScreen:function(){return this.getFullScreenBreakpoint()>=d(window).outerWidth()},canRightAlign:function(){return this.getFullScreenBreakpoint()<=d(window).outerWidth()},getFullScreenBreakpoint:function(){return this.options.mcfly?this.options.desktopBreakpoint:this.options.mobileBreakpoint},
publishEvent:function(b,c){d.extend(c,{updateGroup:this.options.updateGroup,group:this.options.group});a.events.publish(b,c)},getTimeDisplay:function(a){return this.timeValuesMap[a].text},onDisplayCatChange:function(a){switch(a){case "oneway":this.setDateMode("single");break;case "roundtrip":this.setDateMode("range")}},setDateMode:function(a){this.setDisplayMode(a);this.options.dateMode=a},setDisplayMode:function(b){var c=this.displayMode;a.dom.swapChildrenClasses(this.display,this.getStlClasses().DisplayInput,
c,b);this.displayMode=b;this.endInput&&this.endInput.length&&this.endInput.toggleClass(this.getStlBlock("OverlayInput--hidden"),"single"===b);this.swapClasses(this.overlayContent,"Overlay-"+this.options.datePickerClassName+"--"+c,"Overlay-"+this.options.datePickerClassName+"--"+b)},onFlexUpdate:function(a){switch(a.flex){case "weekend":case "openflex":this.setFlex(!0);break;case "duration":break;default:this.setFlex(!1)}this.options.mcfly&&setTimeout(function(){this.positionOverlayWindow()}.bind(this),
0);setTimeout(function(){this.positionOverlayInputWrapper()}.bind(this),0)},setFlex:function(a){(this.options.flex=a)?this.setDisplayMode("flex"):this.setDisplayMode(this.options.dateMode)},toggleCompressedLayout:function(b){b?(a.dom.swapClasses(this.display,a.stylejam.common.widgets.datepicker.DateModal.inputResponsive,a.stylejam.common.widgets.datepicker.DateModal.inputStatic),a.dom.swapClasses(this.displayStart,a.stylejam.common.widgets.datepicker.DateModal.inputDateResponsive,a.stylejam.common.widgets.datepicker.DateModal.inputDateStatic),
a.dom.swapClasses(this.displayStart,a.stylejam.common.widgets.datepicker.DateModal.inputDateStartResponsive,a.stylejam.common.widgets.datepicker.DateModal.inputDateStartStatic),a.dom.swapClasses(this.inputStartDec,a.stylejam.common.widgets.datepicker.DateModal.inputDateSpinnerResponsive,a.stylejam.common.widgets.datepicker.DateModal.inputDateSpinnerStatic),a.dom.swapClasses(this.inputStartInc,a.stylejam.common.widgets.datepicker.DateModal.inputDateSpinnerResponsive,a.stylejam.common.widgets.datepicker.DateModal.inputDateSpinnerStatic),
a.dom.swapClasses(this.inputSeparator,a.stylejam.common.widgets.datepicker.DateModal.inputSeparatorResponsive,a.stylejam.common.widgets.datepicker.DateModal.inputSeparatorStatic),a.dom.swapClasses(this.displayEnd,a.stylejam.common.widgets.datepicker.DateModal.inputDateResponsive,a.stylejam.common.widgets.datepicker.DateModal.inputDateStatic),a.dom.swapClasses(this.inputEndDec,a.stylejam.common.widgets.datepicker.DateModal.inputDateSpinnerResponsive,a.stylejam.common.widgets.datepicker.DateModal.inputDateSpinnerStatic),
a.dom.swapClasses(this.inputEndInc,a.stylejam.common.widgets.datepicker.DateModal.inputDateSpinnerResponsive,a.stylejam.common.widgets.datepicker.DateModal.inputDateSpinnerStatic),a.dom.swapClasses(this.displayStartIcon,a.stylejam.common.widgets.datepicker.DateModal.inputDisplayIcon,a.stylejam.common.widgets.datepicker.DateModal.inputDisplayIconHidden),a.dom.swapClasses(this.displayEndIcon,a.stylejam.common.widgets.datepicker.DateModal.inputDisplayIcon,a.stylejam.common.widgets.datepicker.DateModal.inputDisplayIconHidden)):
(a.dom.swapClasses(this.display,a.stylejam.common.widgets.datepicker.DateModal.inputStatic,a.stylejam.common.widgets.datepicker.DateModal.inputResponsive),a.dom.swapClasses(this.displayStart,a.stylejam.common.widgets.datepicker.DateModal.inputDateStatic,a.stylejam.common.widgets.datepicker.DateModal.inputDateResponsive),a.dom.swapClasses(this.displayStart,a.stylejam.common.widgets.datepicker.DateModal.inputDateStartStatic,a.stylejam.common.widgets.datepicker.DateModal.inputDateStartResponsive),a.dom.swapClasses(this.inputStartDec,
a.stylejam.common.widgets.datepicker.DateModal.inputDateSpinnerStatic,a.stylejam.common.widgets.datepicker.DateModal.inputDateSpinnerResponsive),a.dom.swapClasses(this.inputStartInc,a.stylejam.common.widgets.datepicker.DateModal.inputDateSpinnerStatic,a.stylejam.common.widgets.datepicker.DateModal.inputDateSpinnerResponsive),a.dom.swapClasses(this.inputSeparator,a.stylejam.common.widgets.datepicker.DateModal.inputSeparatorStatic,a.stylejam.common.widgets.datepicker.DateModal.inputSeparatorResponsive),
a.dom.swapClasses(this.displayEnd,a.stylejam.common.widgets.datepicker.DateModal.inputDateStatic,a.stylejam.common.widgets.datepicker.DateModal.inputDateResponsive),a.dom.swapClasses(this.inputEndDec,a.stylejam.common.widgets.datepicker.DateModal.inputDateSpinnerStatic,a.stylejam.common.widgets.datepicker.DateModal.inputDateSpinnerResponsive),a.dom.swapClasses(this.inputEndInc,a.stylejam.common.widgets.datepicker.DateModal.inputDateSpinnerStatic,a.stylejam.common.widgets.datepicker.DateModal.inputDateSpinnerResponsive),
a.dom.swapClasses(this.displayStartIcon,a.stylejam.common.widgets.datepicker.DateModal.inputDisplayIconHidden,a.stylejam.common.widgets.datepicker.DateModal.inputDisplayIcon),a.dom.swapClasses(this.displayEndIcon,a.stylejam.common.widgets.datepicker.DateModal.inputDisplayIconHidden,a.stylejam.common.widgets.datepicker.DateModal.inputDisplayIcon));a.dom.swapClasses(this.displayStartChevron,a.stylejam.common.widgets.datepicker.DateModal.inputDisplayChevronHidden,a.stylejam.common.widgets.datepicker.DateModal.inputDisplayChevron);
a.dom.swapClasses(this.displayEndChevron,a.stylejam.common.widgets.datepicker.DateModal.inputDisplayChevronHidden,a.stylejam.common.widgets.datepicker.DateModal.inputDisplayChevron)},hotelDetailsStickyShow:function(){a.dom.swapClasses(this.inputStartDec,this.options.styles.dateSpinner,this.options.styles.dateSpinnerSticky);a.dom.swapClasses(this.inputStartInc,this.options.styles.dateSpinner,this.options.styles.dateSpinnerSticky);a.dom.swapClasses(this.inputEndInc,this.options.styles.dateSpinner,this.options.styles.dateSpinnerSticky);
a.dom.swapClasses(this.inputEndDec,this.options.styles.dateSpinner,this.options.styles.dateSpinnerSticky);a.dom.swapClasses(this.displayEndIcon,this.options.styles.iconWrapper,this.options.styles.iconWrapperSticky);a.dom.swapClasses(this.inputSeparator,this.options.styles.inputSeparator,this.options.styles.inputSeparatorSticky);a.dom.swapClasses(this.displayEnd,this.options.styles.displayEnd,this.options.styles.displayEndSticky)},hotelDetailsStickyHide:function(){a.dom.swapClasses(this.inputStartDec,
this.options.styles.dateSpinnerSticky,this.options.styles.dateSpinner);a.dom.swapClasses(this.inputStartInc,this.options.styles.dateSpinnerSticky,this.options.styles.dateSpinner);a.dom.swapClasses(this.inputEndInc,this.options.styles.dateSpinnerSticky,this.options.styles.dateSpinner);a.dom.swapClasses(this.inputEndDec,this.options.styles.dateSpinnerSticky,this.options.styles.dateSpinner);a.dom.swapClasses(this.displayEndIcon,this.options.styles.iconWrapperSticky,this.options.styles.iconWrapper);a.dom.swapClasses(this.inputSeparator,
this.options.styles.inputSeparatorSticky,this.options.styles.inputSeparator);a.dom.swapClasses(this.displayEnd,this.options.styles.displayEndSticky,this.options.styles.displayEnd)},getStartDate:function(){return this.startDate},setStartDate:function(a){this.startDateChanged|=this.open&&this.getStartDate()!==a;this.startDate=a;return!0},getEndDate:function(){return this.endDate},setEndDate:function(a){this.endDateChanged|=this.open&&this.getEndDate()!==a;this.endDate=a;return!0},handleBrowserFocus:function(){var a=
this;this.browserWindowRefocused=!0;setTimeout(function(){a.browserWindowRefocused=!1},100)}})})(R9,jQuery);/*
 @r9/cmp2-ui - 2.3.0 generated: 2020-03-02T08:20:15.864Z */
(function(e){function b(h){if(a[h])return a[h].exports;var f=a[h]={i:h,l:!1,exports:{}};return e[h].call(f.exports,f,f.exports,b),f.l=!0,f.exports}var a={};b.m=e;b.c=a;b.d=function(a,f,l){b.o(a,f)||Object.defineProperty(a,f,{configurable:!1,enumerable:!0,get:l})};b.n=function(a){var f=a&&a.__esModule?function(){return a.default}:function(){return a};return b.d(f,"a",f),f};b.o=function(a,b){return Object.prototype.hasOwnProperty.call(a,b)};b.p="";b(b.s=30)})([function(e,b,a){function h(d){var c="function"==
typeof Symbol&&d[Symbol.iterator],a=0;return c?c.call(d):{next:function(){return d&&a>=d.length&&(d=void 0),{value:d&&d[a++],done:!d}}}}function f(d,c){var a="function"==typeof Symbol&&d[Symbol.iterator];if(!a)return d;var b,g;d=a.call(d);var k=[];try{for(;(void 0===c||0<c--)&&!(b=d.next()).done;)k.push(b.value)}catch(m){g={error:m}}finally{try{b&&!b.done&&(a=d.return)&&a.call(d)}finally{if(g)throw g.error;}}return k}function l(d){return this instanceof l?(this.v=d,this):new l(d)}Object.defineProperty(b,
"__esModule",{value:!0});b.__extends=function(d,c){function a(){this.constructor=d}k(d,c);d.prototype=null===c?Object.create(c):(a.prototype=c.prototype,new a)};a.d(b,"__assign",function(){return g});b.__rest=function(d,c){var a={},b;for(b in d)Object.prototype.hasOwnProperty.call(d,b)&&0>c.indexOf(b)&&(a[b]=d[b]);if(null!=d&&"function"==typeof Object.getOwnPropertySymbols){var g=0;for(b=Object.getOwnPropertySymbols(d);g<b.length;g++)0>c.indexOf(b[g])&&(a[b[g]]=d[b[g]])}return a};b.__decorate=function(d,
c,a,b){var g,p=arguments.length,q=3>p?c:null===b?b=Object.getOwnPropertyDescriptor(c,a):b;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)q=Reflect.decorate(d,c,a,b);else for(var k=d.length-1;0<=k;k--)(g=d[k])&&(q=(3>p?g(q):3<p?g(c,a,q):g(c,a))||q);return 3<p&&q&&Object.defineProperty(c,a,q),q};b.__param=function(d,c){return function(a,b){c(a,b,d)}};b.__metadata=function(a,c){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(a,c)};b.__awaiter=
function(a,c,b,g){return new (b||(b=Promise))(function(d,p){function q(c){try{n(g.next(c))}catch(r){p(r)}}function k(c){try{n(g.throw(c))}catch(r){p(r)}}function n(c){c.done?d(c.value):(new b(function(a){a(c.value)})).then(q,k)}n((g=g.apply(a,c||[])).next())})};b.__generator=function(a,c){function d(c){return function(a){return b([c,a])}}function b(d){if(g)throw new TypeError("Generator is already executing.");for(;f;)try{if(g=1,k&&(m=k[2&d[0]?"return":d[0]?"throw":"next"])&&!(m=m.call(k,d[1])).done)return m;
switch(k=0,m&&(d=[0,m.value]),d[0]){case 0:case 1:m=d;break;case 4:return f.label++,{value:d[1],done:!1};case 5:f.label++;k=d[1];d=[0];continue;case 7:d=f.ops.pop();f.trys.pop();continue;default:if(m=f.trys,!(m=0<m.length&&m[m.length-1])&&(6===d[0]||2===d[0])){f=0;continue}if(3===d[0]&&(!m||d[1]>m[0]&&d[1]<m[3]))f.label=d[1];else if(6===d[0]&&f.label<m[1])f.label=m[1],m=d;else if(m&&f.label<m[2])f.label=m[2],f.ops.push(d);else{m[2]&&f.ops.pop();f.trys.pop();continue}}d=c.call(a,f)}catch(r){d=[6,r],
k=0}finally{g=m=0}if(5&d[0])throw d[1];return{value:d[0]?d[1]:void 0,done:!0}}var g,k,m,l,f={label:0,sent:function(){if(1&m[0])throw m[1];return m[1]},trys:[],ops:[]};return l={next:d(0),throw:d(1),return:d(2)},"function"==typeof Symbol&&(l[Symbol.iterator]=function(){return this}),l};b.__exportStar=function(d,c){for(var a in d)c.hasOwnProperty(a)||(c[a]=d[a])};b.__values=h;b.__read=f;b.__spread=function(){for(var d=[],c=0;c<arguments.length;c++)d=d.concat(f(arguments[c]));return d};b.__await=l;b.__asyncGenerator=
function(d,c,a){function b(c){e[c]&&(h[c]=function(d){return new Promise(function(a,b){1<r.push([c,d,a,b])||g(c,d)})})}function g(c,d){try{var a=e[c](d);a.value instanceof l?Promise.resolve(a.value.v).then(p,k):f(r[0][2],a)}catch(x){f(r[0][3],x)}}function p(c){g("next",c)}function k(c){g("throw",c)}function f(c,d){c(d);r.shift();r.length&&g(r[0][0],r[0][1])}if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var h,e=a.apply(d,c||[]),r=[];return h={},b("next"),b("throw"),
b("return"),h[Symbol.asyncIterator]=function(){return this},h};b.__asyncDelegator=function(d){function c(c,g){d[c]&&(a[c]=function(a){return(b=!b)?{value:l(d[c](a)),done:"return"===c}:g?g(a):a})}var a,b;return a={},c("next"),c("throw",function(c){throw c;}),c("return"),a[Symbol.iterator]=function(){return this},a};b.__asyncValues=function(d){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var c=d[Symbol.asyncIterator];return c?c.call(d):"function"==typeof h?h(d):
d[Symbol.iterator]()};b.__makeTemplateObject=function(d,c){return Object.defineProperty?Object.defineProperty(d,"raw",{value:c}):d.raw=c,d};b.__importStar=function(d){if(d&&d.__esModule)return d;var c={};if(null!=d)for(var a in d)Object.hasOwnProperty.call(d,a)&&(c[a]=d[a]);return c.default=d,c};b.__importDefault=function(a){return a&&a.__esModule?a:{default:a}};var k=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,c){a.__proto__=c}||function(a,c){for(var d in c)c.hasOwnProperty(d)&&
(a[d]=c[d])},g=Object.assign||function(a){for(var c,d=1,b=arguments.length;d<b;d++){c=arguments[d];for(var g in c)Object.prototype.hasOwnProperty.call(c,g)&&(a[g]=c[g])}return a}},function(e,b,a){Object.defineProperty(b,"__esModule",{value:!0});var h=function(){function a(){}return a.getInstance=function(){return this._instance||(this._instance=new this),this._instance},a.prototype.setLogger=function(a){this._method=a},a.prototype.getLogger=function(){return this._method||this._methodPlaceholder()},
a.prototype._methodPlaceholder=function(){return{debug:f,error:f,info:f,warn:f}},a}(),f=function(){console.error("cmp2-ui: You should really consider adding logger")};b.getLogger=function(){return h.getInstance().getLogger()};b.setLogger=function(a){return h.getInstance().setLogger(a)}},function(e,b,a){Object.defineProperty(b,"__esModule",{value:!0});var h=a(0);e=a(19);var f=a(6),l=a(5),k=a(3),g=a(4).default(),d=k.default();a=function(c){function a(a){var d=c.call(this)||this;return d.options=a,d}
return h.__extends(a,c),a.prototype.onDirectClick=function(a,c){a=d.forDirect(a);a=new l.default(this.options,a);(new f.default(a)).start(!1)},a.prototype.onDirectMouseUp=function(a,c){},a.prototype.onDirectMouseDown=function(a,c){},a.prototype.onItemChange=function(a,c,d){},a.prototype.onItemMouseDown=function(a,c){},a.prototype.onItemMouseUp=function(a,c){},a.prototype.onFormClick=function(a,c,d){d([],[])},a.prototype.onFormButtonMouseDown=function(a){},a.prototype.onFormButtonMouseUp=function(a){},
a.prototype.navigateToResults=function(a,c,d){return!1},a.prototype.showRPCompareAll=function(){return!0},a.prototype.pushHandleHistory=function(a,c){c&&g.addHistory(a,c)},a.prototype.getWindowNamePrefix=function(){return d.getWindowNamePrefix()},a.prototype.onResultPageOpen=function(a,c,b){void 0===b&&(b="");a=new l.default(this.options,d.forSubmit(a));a=new f.default(a);a.setWindowNamePrefix(b);a.start(!0)},a.prototype.setIgnoreWindowErrors=function(a){g.setIgnoreWindowErrors(a)},a}(e.Observer);
b.Base=a;b.default=a},function(e,b,a){Object.defineProperty(b,"__esModule",{value:!0});var h=a(14),f=a(15),l=a(8),k=a(27).default(),g=function(){function a(){this.windowNamePrefix="k"+(new Date).getTime()+l.default.randomString(8)}return a.getInstance=function(){return this._instance||(this._instance=new this),this._instance},a.prototype.getWindowNamePrefix=function(){return this.windowNamePrefix},a.prototype.hidden=function(a,d){return{url:this.getUrl(a),name:a.code,features:k.hidden(!1,d)}},a.prototype.hiddenSmall=
function(a,d){return{url:this.getUrl(a),name:a.code,features:k.hidden(!0,d)}},a.prototype.tiled=function(a,d,b,g){return{url:this.getUrl(a),name:a.code,features:k.tiled(d,b,g)}},a.prototype.empty=function(a){return{url:this.getUrl(a),name:a.code,features:{}}},a.prototype.forDirect=function(a){for(var c=[],d=k.getWindowHandleInformation(),b=0,g=0,f;f=a[g];g++)f.visible&&b++;for(g=0;f=a[g];g++)f.visible&&c.push(this.tiled(f,g,b,d));return c},a.prototype.forBlank=function(a){return[{url:a||this.getUrl(),
name:"_blank",features:{}}]},a.prototype.forMultiProviderWindow=function(a,d){void 0===a&&(a=[]);void 0===d&&(d={});var c,b=[];if(0<a.length){for(var g=0,k;k=a[g];g++)k.deepLink&&"CLOSE"!==k.deepLink&&(b.push(k.code),c=k.deepLink);if(0<b.length)return 1===b.length&&c?h.formatUrl(c):h.formatUrl("/s/compareresults/multi",f.extend({providerCodes:b.join(",")},d||{}))}return""},a.prototype.forSubmit=function(a,d){void 0===d&&(d=0);for(var c=[],b=k.getWindowHandleInformation(),g=0,p=0,f;f=a[p];p++)f.visible&&
f.checked&&g++;for(p=0;f=a[p];p++)f.visible&&f.checked&&(4===d&&c.push(this.empty(f)),0===d&&c.push(this.tiled(f,p,g,b)),2===d&&c.push(this.hidden(f,b)),3===d&&c.push(this.hiddenSmall(f,b)));return c},a.prototype.getSpinnerPath=function(){return h.formatUrl("/s/compareresults/spinner")},a.prototype.getUrl=function(a){return a?a.deepLink?h.formatUrl(a.deepLink):h.formatUrl("/s/compareresults/spinner",{code:a.code}):this.getSpinnerPath()},a}();b.WindowHandleOptions=g;b.default=function(){return g.getInstance()}},
function(e,b,a){Object.defineProperty(b,"__esModule",{value:!0});var h=a(20),f=a(1);e=a(26);b.isSystemTargetName=function(a){return void 0===a&&(a=""),-1!==["_blank","_parent","_self","_top"].indexOf(a)};b.getWindowName=function(a){return void 0===a&&(a=""),b.isSystemTargetName(a)?a:a.replace(/[^a-z0-9]+/gi,"")};"undefined"!=typeof window&&e.addEvent(window,"popstate",function(a){(a=a.originalEvent?a.originalEvent:a)&&a.state&&a.state.hasOwnProperty("cmp2-workaround-back-Key")&&window.location.replace(a.state["cmp2-workaround-back-Key"])});
var l=function(){function a(){this._ignoreWindowErrors=!1}return a.getInstance=function(){return this._instance||(this._instance=new this),this._instance},a.prototype.getIgnoreWindowErrors=function(){return this._ignoreWindowErrors},a.prototype.setIgnoreWindowErrors=function(a){this._ignoreWindowErrors=a},a.prototype.open=function(a,d,c){void 0===d&&(d="");void 0===c&&(c={});"object"==typeof c&&(c=h.param(c,!0,","));return(a=open(a,b.getWindowName(d),c))&&!a.closed?a:null},a.prototype.getActiveWindowHandles=
function(a){for(var d=[],c=0,b;b=a[c];c++)(b=this.getWindowHandle(b))&&d.push(b);return d},a.prototype.getFirstActiveHandle=function(a){for(var d=0,c;c=a[d];d++)if(this.getWindowHandle(c))return c;return null},a.prototype.getLastActiveHandle=function(a){for(var d=a.length-1,c;c=a[d];d--)if(this.getWindowHandle(c))return c;return null},a.prototype.getWindowHandle=function(a){try{return!a||a.closed?null:a}catch(d){return null}},a.prototype.addHistory=function(a,d){if(a&&d&&void 0!==history.pushState&&
void 0!==history.replaceState)try{var c=a.location.href;a.history.replaceState((b={},b["cmp2-workaround-back-Key"]=d,b),"",d);a.history.pushState((g={},g["cmp2-workaround-back-Key"]=c,g),a.document.title,c)}catch(n){f.getLogger().warn("cmp2-workaround: WindowHandle unable to add history",n)}var b,g},a.prototype.updateHandleName=function(a,d,c){void 0===c&&(c="");a=this.getWindowHandle(a);if(!a)return f.getLogger().warn("cmp2-workaround: WindowHandle handle is not found",c),!1;try{if(a.name=d,a.name!==
d)return f.getLogger().warn("cmp2-workaround: WindowHandle unable to change name",c),!1}catch(p){return f.getLogger().warn("cmp2-workaround: WindowHandle unable to change name",p,c),!1}return!0},a.prototype.resizeBeforeMove=function(a,d){var c=this.getWindowHandle(a);if(c)try{if(void 0!==d.left&&void 0!==d.top){c.resizeTo(100,100);var b=this.moveToLeftTop(a);c.moveTo(b[0]+d.left,b[1]+d.top)}void 0!==d.width&&void 0!==d.height&&c.resizeTo(d.width,d.height)}catch(q){f.getLogger().warn("cmp2-workaround: WindowHandle unable resize handler in resizeBeforeMove",
q,q.stack)}},a.prototype.moveAccordingFeatures=function(a,d){if((a=this.getWindowHandle(a))&&d)try{void 0!==d.left&&void 0!==d.top&&a.moveTo(d.left,d.top),void 0!==d.width&&void 0!==d.height&&a.resizeTo(d.width,d.height)}catch(c){f.getLogger().warn("cmp2-workaround: WindowHandle unable resize handler in moveAccordingFeatures",c,c.stack)}},a.prototype.moveToLeftTop=function(a){if(a=this.getWindowHandle(a))try{return a.moveTo(-1E7,-1E7),["screenX"in a?a.screenX:a.screenLeft,"screenY"in a?a.screenY:
a.screenTop]}catch(d){f.getLogger().warn("cmp2-workaround: WindowHandle unable to move handler in moveToLeftTop",d,d.stack)}return[0,0]},a}();b.WindowHandle=l;b.default=function(){return l.getInstance()}},function(e,b,a){Object.defineProperty(b,"__esModule",{value:!0});e=function(){return function(a,b){this.items=[];this.options=a;this.items=b;this.resize=a.resizeWindows||!1}}();b.WindowHandleConstructor=e;b.default=e},function(e,b,a){Object.defineProperty(b,"__esModule",{value:!0});var h=a(0);e=
a(19);var f=a(1),l=a(4);a=a(3);var k=l.default(),g=a.default();a=function(a){function c(c){var d=a.call(this)||this;return d.windowNamePrefix="",d.windowHandleInformation=c,d.items=c.items,c.resize&&d.resizeHandle(c),c.preOpen&&d.preOpen(c.preOpen),c.postOpen&&d.postOpen(c.postOpen),c.preItemOpen&&d.preItemOpen(c.preItemOpen),c.postItemOpen&&d.postItemOpen(c.postItemOpen),d}return h.__extends(c,a),c.prototype.setWindowNamePrefix=function(a){void 0===a&&(a="");a&&(this.windowNamePrefix=a)},c.prototype.getWindowNamePrefix=
function(){return this.windowNamePrefix||(this.windowNamePrefix=g.getWindowNamePrefix()),this.windowNamePrefix},c.prototype.start=function(a){var c=this.items;this.publish("preOpen",[c]);for(var d=this.getWindowNamePrefix(),b=[],g=[],p=0,h;h=c[p];p++){this.publish("preItemOpen",[h,c]);var e=l.isSystemTargetName(h.name)?h.name:l.getWindowName(d+h.name),r=k.open(h.url,e,h.features),y=this.windowHandleInformation.options;if(y.expectWindowReference)if(r)b.push(e),g.push(r),this.publish("handleCreated",
[h,c,r]);else if(!k.getIgnoreWindowErrors()){var w=a?"":" in the RP";f.getLogger().warn("cmp2-workaround: unable to open handle in StandardWindowHandleExecutor"+w,{workaround:y,name:e,item:h})}this.publish("postItemOpen",[h,c,r])}this.publish("postOpen",[g,b])},c.prototype.handleCreated=function(a){return this.subscribe("handleCreated",a),this},c.prototype.preOpen=function(a){return this.subscribe("preOpen",a),this},c.prototype.postOpen=function(a){return this.subscribe("postOpen",a),this},c.prototype.preItemOpen=
function(a){return this.subscribe("preItemOpen",a),this},c.prototype.postItemOpen=function(a){return this.subscribe("postItemOpen",a),this},c.prototype.getItems=function(){return this.items},c.prototype.resizeHandle=function(a){this.postItemOpen(function(c,d,b){(d=k.getWindowHandle(b))&&c.features&&(c=c.features,a.options.resizeBeforeOpening?k.resizeBeforeMove(d,c):k.moveAccordingFeatures(d,c))})},c}(e.Observer);b.StandardWindowHandleExecutor=a;b.default=a},function(e,b,a){Object.defineProperty(b,
"__esModule",{value:!0});e=a(35);var h=a(2);b.Base=h.default;var f=e.default();b.setWorkaround=function(a){f.setWorkaround(a,!1)};b.getWorkaround=function(){return f.getWorkaround()};e=a(1);b.getLogger=e.getLogger;b.setLogger=e.setLogger;e=a(15);b.extend=e.extend;a=a(14);b.updateBasePath=a.updateBasePath},function(e,b,a){Object.defineProperty(b,"__esModule",{value:!0});e=function(){function a(){}return a.UUID=function(){var a=(new Date).getTime();return"xxxxxxxxxxxx4xxxyxxxxxxxxxxxxxxx".replace(/[xy]/g,
function(b){var k=(a+16*Math.random())%16|0;return a=Math.floor(a/16),("x"===b?k:3&k|8).toString(16)})},a.randomString=function(a){void 0===a&&(a=6);for(var b="",k=0;k<a;k++)b+="abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789".charAt(Math.floor(62*Math.random()));return b},a}();b.StringGenerators=e;b.default=e},function(e,b,a){Object.defineProperty(b,"__esModule",{value:!0});var h=a(10),f=a(11),l=a(7);e=function(){function a(){this._client="other";this._queue=[];this._isInProgress=
!1}return a.getInstance=function(){return this._instance||(this._instance=new this),this._instance},a.prototype.setClient=function(a){this._client=a},a.prototype.getClient=function(){return this._client},a.prototype.setSettings=function(a){this._settings=a;l.setWorkaround(a.workaround)},a.prototype.isSettings=function(){return!!this._settings},a.prototype.getSettings=function(a,d){var c=this;if(this._settings)return void a(this._settings);if(this._queue.push({onSuccess:a,onError:d}),!this._isInProgress){this._isInProgress=
!0;a=h.Settings.getConfig();var b=function(){c._isInProgress=!1;c._queue.forEach(function(a){a.onError&&a.onError(void 0)});c._queue=[]};f.Ajax.getInstance().request(a,function(a){if(!a||!a.success)return l.getLogger().error("cmp2-ui: AJAX error on getSettings",a.errors),void b();var d=a.content;c.setSettings(d);c._isInProgress=!1;c._queue.forEach(function(a){a.onSuccess(d)});c._queue=[]},function(a){l.getLogger().error("cmp2-ui: AJAX error on getSettings",a);b()},b)}},a.prototype.getSettingsSync=
function(){return this.isSettings()?this._settings:void l.getLogger().error("cmp2-ui: getSettingsSync failed. Refactor")},a}();b.CompareToSettings=e},function(e,b,a){Object.defineProperty(b,"__esModule",{value:!0});e=a(32);b.List=e.List;e=a(33);b.WindowInfo=e.WindowInfo;a=a(34);b.Settings=a.Settings},function(e,b,a){Object.defineProperty(b,"__esModule",{value:!0});var h,f=a(0),l=a(7),k=a(52);e=function(){function a(){var a=k.StorageSessionHelper.getInstance().getItem("cmp2.headers");a&&(this._headers=
a)}return a.getInstance=function(){return h||(h=new this),h},a.prototype.setMethod=function(a){this._method=a},a.prototype.request=function(a,c,b,g){var d=this;return this._method?(this._headers&&(a.headers=f.__assign({},a.headers,this._headers)),this._method(a,function(a){if(a&&a.headers){var b=a.headers;d._headers=b;k.StorageSessionHelper.getInstance().setItem("cmp2.headers",b)}c&&c(a)},b),!0):(l.getLogger().error("cmp2-ui: Ajax method is not set"),g&&g(),!1)},a}();b.Ajax=e},function(e,b,a){Object.defineProperty(b,
"__esModule",{value:!0});b.isFunction=function(a){return"function"==typeof a&&"number"!=typeof a.nodeType}},function(e,b,a){Object.defineProperty(b,"__esModule",{value:!0});b.class2Type={}},function(e,b,a){function h(a){a=a.split("/");for(var c=a.length,d=[],b=0;b<c;b++){var g=a[b];0!==g.length&&d.push(g)}return d.join("/").replace(/^(https?:)([\/])*/g,"$1//")}Object.defineProperty(b,"__esModule",{value:!0});var f=a(20);b.updateBasePath=function(a){return b.BASE_PATH=h(a),-1===b.BASE_PATH.indexOf("http")&&
(b.BASE_PATH="/"+b.BASE_PATH),b.BASE_PATH};var l=/#.*$/,k=/\?/,g=/([?&])_=[^&]*/;b.formatUrl=function(a,c,p){void 0===c&&(c="");void 0===p&&(p=!0);a=(a=h(a))?a&&0===a.indexOf("http")?a:b.BASE_PATH.replace(/[\/]$/g,"")+"/"+a:b.BASE_PATH;if(c){var d=p;void 0===a&&(a="");void 0===c&&(c="");void 0===d&&(d=!0);p=a.replace(l,"");a=a.slice(p.length);c&&(c="object"==typeof c?f.param(c):c,p+=(k.test(p)?"\x26":"?")+c);c=(!1===d&&(p=p.replace(g,"$1"),a=(k.test(p)?"\x26":"?")+"_\x3d"+(new Date).getTime()+a),
p+a)}else c=a;return c};b.BASE_PATH=""},function(e,b,a){function h(){for(var a=[],b=0;b<arguments.length;b++)a[b]=arguments[b];var d,c,p,e,n,t=a.length,m=a[0]||{},u=1,v=!1;"boolean"==typeof m&&(v=m,m=a[u]||{},u++);"object"==typeof m||l.isFunction(m)||(m={});for(u===t&&(m=this,u--);u<t;u++)if(null!=(b=a[u]))for(d in b)b.hasOwnProperty(d)&&(c=m[d],p=b[d],m!==p)&&(v&&p&&(f.isPlainObject(p)||(e=Array.isArray(p)))?(e?(e=!1,n=c&&Array.isArray(c)?c:[]):n=c&&f.isPlainObject(c)?c:{},m[d]=h(v,n,p)):void 0!==
p&&(m[d]=p));return m}Object.defineProperty(b,"__esModule",{value:!0});var f=a(23),l=a(12);b.extend=h},function(e,b,a){Object.defineProperty(b,"__esModule",{value:!0});var h=a(29),f=a(9);b.invokeLoadingTrackingUrl=function(a){(new Image(1,1)).src=a};e=function(){function a(){var a=h.StorageHelper.getInstance().getItem("cmp2.state");this._setCompareToState(a)}return a.getInstance=function(){return this._instance||(this._instance=new this),this._instance},a.prototype.getImpressionRequestState=function(a){for(var b=
[],d=0;d<a.length;d++){var c=a[d];b.push({checked:c.checked,code:c.code,id:c.id,prechecked:c.prechecked,rank:c.rank,termId:c.termId,visible:c.visible})}return b},a.prototype.getVisibleItem=function(a){var b=[];if(a&&"object"==typeof a&&a.constructor===Array&&0<a.length)for(var d=0;d<a.length;d++){var c=a[d];c.visible&&b.push(c)}return b},a.prototype.getVisibleItemCount=function(a){return this.getVisibleItem(a).length},a.prototype.isCheckedItem=function(a){for(var b=0;b<a.length;b++){var d=a[b];if(d.visible&&
d.checked)return!0}return!1},a.prototype.updateCheckedItemState=function(a,b){if(b.id&&b.idInState)this._compareTosStates[b.id]=b.checked;else{var d=b.code;if(d){var c=this._getMediaAlphaProviderName(d);c&&(d=c);this._compareTosStates[d]=b.checked}}b=h.StorageHelper.getInstance();b.setItem("cmp2.state",this._compareTosStates);var g=0;a.forEach(function(a){a.visible&&a.checked&&g++});0===g?b.setItem("cmp2.check.all","false"):this.getVisibleItemCount(a)===g?b.setItem("cmp2.check.all","true"):b.removeItem("cmp2.check.all")},
a.prototype.prepareItemsToDisplay=function(a){var g=this,d=f.CompareToSettings.getInstance().getSettingsSync();if(!d)return[];var c=[],k=h.StorageHelper.getInstance().getItem("cmp2.check.all"),d=d.rendering,l=d.storeStateSession,n=d.limited,e=d.usePreCheckItems,m=d.maxCheckedItems,u=d.loadTrackingUrl,v=0;return a.forEach(function(a){var d=!1;(!n||v<m)&&(d=g._isItemChecked(a,l,e,k))&&v++;d={name:a.name,code:a.code,id:a.id,visible:a.visible,checked:d,prechecked:e&&a.prechecked,termId:a.termId,idInState:a.idInState,
rank:a.rank,logo:a.logo,logoLarge:a.logoLarge};"deepLink"in a&&(d.deepLink=a.deepLink);"clickToCall"in a&&(d.clickToCall=a.clickToCall);"svgLogo"in a&&(d.svgLogo=a.svgLogo);"phoneNumber"in a&&(d.phoneNumber=a.phoneNumber);u?a.visible&&a.trackingUrl&&b.invokeLoadingTrackingUrl(a.trackingUrl):"trackingUrl"in a&&(d.trackingUrl=a.trackingUrl);c.push(d)}),c},a.prototype.getCompareToItemsFromImpressionState=function(a){var b=[];return a.forEach(function(a){b.push({name:"",logo:"",logoLarge:"",code:a.code,
id:a.id,visible:a.visible,checked:a.checked,prechecked:a.prechecked,idInState:!0,termId:a.termId,rank:a.rank})}),b},a.prototype.mapDeepLinkToItems=function(a,b){var d=[];return this.getCompareToItemsFromImpressionState(a).forEach(function(a){a.visible&&a.checked&&b[a.code]&&b[a.code].deepLink&&(a.deepLink=b[a.code].deepLink,d.push(a))}),d},a.prototype._getMediaAlphaProviderName=function(a){return(a=/^([a-zA-Z]*-[0-9]*-[0-9]*)/.exec(a))?a[1]:null},a.prototype._isItemChecked=function(a,b,d,c){if(!a.visible)return!1;
if(b){if(null!==c)return!0===c;b=this._compareTosStates;if(a.idInState){if(a.id&&b.hasOwnProperty(a.id))return b[a.id]}else if(c=a.code){var g=this._getMediaAlphaProviderName(c);if(g&&(c=g),b.hasOwnProperty(c))return b[c]}}return a.prechecked&&d},a.prototype._setCompareToState=function(a){this._compareTosStates=a&&"object"==typeof a?a:{}},a}();b.CompareToList=e},function(e,b,a){function h(a){var b=[];if(a.placement){var c=a.placement;b.push(c.vertical?c.vertical:a.type);b.push(c.type||"");b.push(f(c.showOn)||
"");b.push(c.page||"");b.push(l(c.displayRail)+(c.position||0))}return b.join(".")}function f(a){switch(a){case "fd":case "pn":return"FD";case "bb":case "rr":case "sa":case "pu":case "md":return"RP"}}function l(a){switch(a){case "right":return"R";case "top":case "inline":case "panel":case "fdct":return"M";case "bottom":return"B";case "popup":return"P"}return""}Object.defineProperty(b,"__esModule",{value:!0});var k=a(9);b.isEnabled=function(a,b){return b&&b.enabled&&(!b.verticals||b.verticals[a])||
!1};b.excludeRequest=function(a,b,c){if(!c)return!1;var d=a.clientDisplayRails;a=a.displayRails;return d&&d[b]&&!1===d[b][c.displayRail]||a&&!1===a[c.displayRail]||!1};b.buildWindowOpenerRequest=function(){return{event:b.WINDOW_OPENER_REQUEST_EVENT}};b.buildWindowOpenerResponse=function(a){return{event:b.WINDOW_OPENER_EVENT,windowInfo:a}};b.extractWindowOpenerRequest=function(a){a=a&&a.data;return!(!a||!a.event||a.event!==b.WINDOW_OPENER_REQUEST_EVENT)&&a};b.extractWindowOpenerResponse=function(a){a=
a&&a.data;return!(!a||!a.event||a.event!==b.WINDOW_OPENER_EVENT)&&a};b.getMultiProviderWindowExtra=function(a,b,c){c={searchId:void 0!==c?c:a.searchId};var d=k.CompareToSettings.getInstance().getSettingsSync();if(!d||!(b="rp"===b?d.multiProviderWindowRP:d.multiProviderWindowFD))return c;d=a.placement;return d&&(b.pageOrigin&&(c.pageOrigin=h(a)),b.showOn&&(c.showOn=d.showOn),b.displayRail&&(c.displayRail=d.displayRail),b.vertical&&(c.vertical=a.type),b.position&&(c.position=d.displayRail)),c};b.getPageOrigin=
h;b.WINDOW_OPENER_REQUEST_EVENT="FD_CMP2_ITEMS_REQUEST";b.WINDOW_OPENER_EVENT="FD_CMP2_ITEMS"},function(e,b,a){Object.defineProperty(b,"__esModule",{value:!0});b.getPostHeader=function(){return{"Content-Type":"application/json; charset\x3dUTF-8"}}},function(e,b,a){Object.defineProperty(b,"__esModule",{value:!0});e=function(){function a(){this.events={}}return a.prototype.on=function(a,b){var f=this.events[a];return f||(this.events[a]=f=[]),f.push(b),this},a.prototype.off=function(a,b){var f=this.events[a];
return f?(void 0===b?delete this.events[a]:this.events[a]=f.filter(function(a){if(a!==b)return a}),this):this},a.prototype.subscribe=function(a,b){return this.on(a,b)},a.prototype.unSubscribe=function(a,b){return this.off(a,b)},a.prototype.publish=function(a,b){a=this.events[a];if(!a)return this;for(var f=0,g;g=a[f];f++)g.apply(this,b||[]);return this},a.prototype.notify=function(a,b){return this.publish(a,b)},a}();b.Observer=e},function(e,b,a){function h(a,b,g,n){var c;if(Array.isArray(b))f.each(b,
function(b,c){g||d.test(a)?n(a,c):h(a+"["+("object"==typeof c&&null!=c?b:"")+"]",c,g,n)});else if(g||"object"!==l.toType(b))n(a,b);else for(c in b)b.hasOwnProperty(c)&&h(a+"["+c+"]",b[c],g,n)}Object.defineProperty(b,"__esModule",{value:!0});var f=a(36),l=a(21),k=a(23),g=a(12),d=/\[\]$/;b.param=function(a,b,d){void 0===b&&(b=!1);void 0===d&&(d="\x26");var c,e=[],m=function(a,b){b=g.isFunction(b)?b():b;e[e.length]=encodeURIComponent(a)+"\x3d"+encodeURIComponent(null==b?"":b)};if(Array.isArray(a)||!k.isPlainObject(a))f.each(a,
function(a,b){m(a,b)});else for(c in a)a.hasOwnProperty(c)&&h(c,a[c],b,m);return e.join(d)}},function(e,b,a){Object.defineProperty(b,"__esModule",{value:!0});var h=a(13),f=a(22);b.toType=function(a){return null==a?a+"":"object"==typeof a||"function"==typeof a?h.class2Type[f.toString.call(a)]||"object":typeof a}},function(e,b,a){Object.defineProperty(b,"__esModule",{value:!0});e=a(13);b.toString=e.class2Type.toString},function(e,b,a){Object.defineProperty(b,"__esModule",{value:!0});var h=a(24),f=a(39),
l=a(25),k=a(22);b.isPlainObject=function(a){var b,c;return!(!a||"[object Object]"!==k.toString.call(a))&&(!(b=Object.getPrototypeOf(a))||"function"==typeof(c=l.hasOwn.call(b,"constructor")&&b.constructor)&&h.functionToString.call(c)===f.objectFunctionString)}},function(e,b,a){Object.defineProperty(b,"__esModule",{value:!0});e=a(25);b.functionToString=e.hasOwn.toString},function(e,b,a){Object.defineProperty(b,"__esModule",{value:!0});e=a(13);b.hasOwn=e.class2Type.hasOwnProperty},function(e,b,a){Object.defineProperty(b,
"__esModule",{value:!0});b.addEvent=function(a,b,e){void 0===a._eventListeners&&(a._eventListeners=[]);a.addEventListener(b,e,!1);var f=a._eventListeners;f.push({type:b,fn:e});a._eventListeners=f};b.removeEvent=function(a,b,e){if(void 0!==a._eventListeners){a.removeEventListener(b,e);for(var f,g=a._eventListeners,d=[],c=g.length,l=0;l<c;l++)f=g[l],f.type!==b&&f.fn!==e&&d.push(g[l]);a._eventListeners=g}}},function(e,b,a){Object.defineProperty(b,"__esModule",{value:!0});var h=a(15),f=a(1),l={scrollbars:1,
location:1,statusbar:1,menubar:0,resizable:1},k=function(){function a(){}return a.getInstance=function(){return this._instance||(this._instance=new this),this._instance},a.prototype.getWindowHandleInformation=function(a){try{a=a||window;var b=a.document,d=a.screen,g=b.documentElement,n=b.getElementsByTagName("body")[0];return{y:"screenY"in a?a.screenY:a.screenTop,x:"screenX"in a?a.screenX:a.screenLeft,width:a.innerWidth||g.clientWidth||n.clientWidth,height:a.innerHeight||g.clientHeight||n.clientHeight,
screenWidth:d.availWidth,screenHeight:d.availHeight}}catch(t){f.getLogger().error("cmp2-workaround: WindowHandleFeatures unable to access window/handle information",t)}try{return{y:0,x:0,width:window.screen.availWidth,height:window.screen.availHeight,screenWidth:window.screen.availWidth,screenHeight:window.screen.availHeight}}catch(t){f.getLogger().error("cmp2-workaround: WindowHandleFeatures unable to access window information",t)}return{y:0,x:0,width:800,height:600,screenWidth:800,screenHeight:600}},
a.prototype.hidden=function(a,b){var c=Math.min(1024,b.height-20),d=Math.min(1280,b.width-20),f=b.y+10,g=b.x+10;return a&&(c=160,d=160,f=b.y+(b.height-110),g=b.x+(b.width-185)),h.extend({},l,{top:f,left:g,height:c,width:d})},a.prototype.tiled=function(a,b,f){b=Math.floor(f.screenWidth/b-10);return h.extend({},l,{left:Math.floor((b+5)*a),top:-999999999,height:Math.abs(-1*f.screenHeight),width:Math.abs(b)})},a}();b.WindowHandleFeatures=k;b.default=function(){return k.getInstance()}},function(e,b,a){Object.defineProperty(b,
"__esModule",{value:!0});var h=a(0),f=a(1),l=a(4);e=a(6);var k=l.default();e=function(a){function b(){var b=null!==a&&a.apply(this,arguments)||this;return b.windowHandleNames=[],b.windowHandles=[],b}return h.__extends(b,a),b.prototype.start=function(a){var b=this,c=this.getItems();this.windowHandleNames=[];this.windowHandles=[];this.publish("preOpen",[c]);var d=this.windowHandleInformation.options,f=1;void 0!==d.delay&&(f=d.delay);for(var d=0,g=void 0;g=c[d];d++)this._open(g,a);setTimeout(function(){b.publish("postOpen",
[b.windowHandles,b.windowHandleNames])},f)},b.prototype._open=function(a,b){var c=this,d=this.getItems(),g=this.getWindowNamePrefix(),e=this.windowHandleInformation.options,h=0;void 0!==e.timer&&(h=e.timer);setTimeout(function(){c.publish("preItemOpen",[a,d]);var m=l.isSystemTargetName(a.name)?a.name:l.getWindowName(g+a.name),n=k.open(a.url,m,a.features);if(e.expectWindowReference)if(n)c.addHandleName(m),c.addHandle(n),c.publish("handleCreated",[a,d,n]);else{var h=b?"":" in the RP";f.getLogger().warn("cmp2-workaround: unable to open handle in TimeoutWindowHandleExecutor"+
h,{workaround:e,name:m,item:a})}c.publish("postItemOpen",[a,d,n])},h)},b.prototype.addHandleName=function(a){this.windowHandleNames.push(a)},b.prototype.addHandle=function(a){this.windowHandles.push(a)},b}(e.default);b.TimeoutWindowHandleExecutor=e;b.default=e},function(e,b,a){Object.defineProperty(b,"__esModule",{value:!0});var h,f=a(7);e=function(){function a(){this._available=!1;this.setStorage(this._getWindowStorage())}return a.getInstance=function(){return h||(h=new this),h},a.prototype.setStorage=
function(a){var b;try{a&&(a.setItem("vendor-support-test","success?"),b=a.getItem("vendor-support-test"),a.removeItem("vendor-support-test"),this._storage=a),"success?"===b&&(this._available=!0)}catch(d){}},a.prototype.getItem=function(a){if(this._available&&this._storage){var b=this._storage.getItem(a);if(b)try{return JSON.parse(b)}catch(d){return f.getLogger().error("cmp2-ui: StorageHelper unable to parse value",{key:a,value:b,error:d}),b}}return null},a.prototype.setItem=function(a,b){if(this._available&&
this._storage)try{null!==b&&"object"==typeof b?this._storage.setItem(a,JSON.stringify(b)):this._storage.setItem(a,b)}catch(d){f.getLogger().error("cmp2-ui: StorageHelper unable to set item",{key:a,data:b})}},a.prototype.removeItem=function(a){try{this._available&&this._storage&&this._storage.removeItem(a)}catch(g){f.getLogger().error("cmp2-ui: StorageHelper unable to remove item",{key:a})}},a.prototype.clear=function(){if(this._available&&this._storage)try{this._storage.clear()}catch(k){f.getLogger().error("cmp2-ui: StorageHelper unable to clear")}},
a.prototype._getWindowStorage=function(){var a;try{a=window.localStorage}catch(g){}return a},a}();b.StorageHelper=e},function(e,b,a){Object.defineProperty(b,"__esModule",{value:!0});e=a(31);window["@r9/cmp2-ui"]||(window["@r9/cmp2-ui"]=e)},function(e,b,a){Object.defineProperty(b,"__esModule",{value:!0});var h=a(10),f=a(7),l=a(11),k=a(9),g=a(16),d=a(17);e=a(7);b.updateBasePath=e.updateBasePath;e=a(7);b.getWorkaround=e.getWorkaround;e=a(53);b.onItemMouseUp=e.onItemMouseUp;b.onItemMouseDown=e.onItemMouseDown;
b.onItemChange=e.onItemChange;b.onFormClick=e.onFormClick;b.onFormButtonMouseDown=e.onFormButtonMouseDown;b.onFormButtonMouseUp=e.onFormButtonMouseUp;a=a(54);b.onDirectMouseUp=a.onDirectMouseUp;b.onDirectMouseDown=a.onDirectMouseDown;b.onDirectClick=a.onDirectClick;b.onResultPage=a.onResultPage;b.registerImpression=a.registerImpression;b.setModuleConfig=function(a){a.ajax&&l.Ajax.getInstance().setMethod(a.ajax);a.logger&&f.setLogger(a.logger);a.settings&&k.CompareToSettings.getInstance().setSettings(a.settings);
a.client&&k.CompareToSettings.getInstance().setClient(a.client)};b.showRPCompareAll=function(a){var b=k.CompareToSettings.getInstance();return b.isSettings()?f.getWorkaround().showRPCompareAll()&&(a=g.CompareToList.getInstance().getVisibleItemCount(a),(b=b.getSettingsSync())&&a>=b.rendering.minItemsForCompareAll)?!0:!1:(f.getLogger().error("cmp2-ui: settings are not set to execute showRPCompareAll"),!1)};b.showMultiActions=function(a,b){var c=k.CompareToSettings.getInstance();if(!c.isSettings())return f.getLogger().error("cmp2-ui: settings are not set to execute showMultiActions"),
!1;if(!f.getWorkaround().showRPCompareAll())return!1;a=g.CompareToList.getInstance().getVisibleItemCount(a);c=c.getSettingsSync();if(!c)return!1;var d=c.rendering,c=d.minItemsForCompareAll,d=d.placementMinItemsForMultiActions;b=b&&d&&d[b];return void 0!==b?a>=b:a>=c};b.getCompareTo=function(a,b,e){if(!a.placement)return b([]),void f.getLogger().error("cmp2-ui: placement information is missing",a);if(!a.url)return b([]),void f.getLogger().error("cmp2-ui: missing url",a);var c=k.CompareToSettings.getInstance();
if(c.isSettings()){var t=c.getSettingsSync();if(!d.isEnabled(a.type,t)||d.excludeRequest(t,c.getClient(),a.placement))return void b([])}a.registerImpression=!!a.registerImpression;a.deepLink=!!a.deepLink;a.convertUrl=a.convertUrl;a.list=!0;a.config=!c.isSettings();var m=h.List.getConfig(a);l.Ajax.getInstance().request(m,function(n){if(!n||!n.success)return f.getLogger().error("cmp2-ui: Received an unexpected response",m,n,a),void e();if(n.config){c.setSettings(n.config);var h=c.getSettingsSync();
if(!d.isEnabled(a.type,h)||d.excludeRequest(h,c.getClient(),a.placement))return void b([])}return c.isSettings()?n.content?void b(g.CompareToList.getInstance().prepareItemsToDisplay(n.content)):void b([]):(f.getLogger().error("cmp2-ui: expected to have settings after getCompareTo request",m,n,a),void b([]))},function(a){f.getLogger().error("cmp2-ui: AJAX error on getCompareTo",a,m);e()},e)}},function(e,b,a){Object.defineProperty(b,"__esModule",{value:!0});var h=a(18);e=function(){function a(){}return a.getConfig=
function(a){return{method:"POST",headers:h.getPostHeader(),url:"/s/horizon/compareTo/list",data:a}},a}();b.List=e},function(e,b,a){Object.defineProperty(b,"__esModule",{value:!0});var h=a(18);e=function(){function a(){}return a.getStoreConfig=function(a,b,f){return void 0===f&&(f={}),{method:"POST",url:"/s/horizon/compareTo/WindowInformation/add",headers:h.getPostHeader(),data:{type:a.type,placement:a.placement,convertUrl:a.convertUrl,url:a.url?a.url:"",items:b,other:f}}},a.getRetrieveConfig=function(a){return{method:"POST",
url:"/s/horizon/compareTo/WindowInformation/list",headers:h.getPostHeader(),data:a}},a}();b.WindowInfo=e},function(e,b,a){Object.defineProperty(b,"__esModule",{value:!0});e=function(){function a(){}return a.getConfig=function(){return{method:"GET",url:"/s/horizon/compareTo/config"}},a}();b.Settings=e},function(e,b,a){Object.defineProperty(b,"__esModule",{value:!0});var h=a(2),f=a(40),l=a(41),k=a(42),g=a(43),d=a(45),c=a(46),p=a(1),q=a(47),n=a(48),t=a(49),m=a(50),u=a(51),v=function(){function a(){}
return a.getInstance=function(){return this._instance||(this._instance=new this),this._instance},a.prototype.setWorkaround=function(a,b){switch(b?a.fallbackName:a.name){case "AsyncOpen":this.workaround=new f.default(a);break;case "AsyncOpenMobile":this.workaround=new l.default(a);break;case "ChangeWindowNameLast":this.workaround=new k.default(a);break;case "ChangeWindowNameSequence":this.workaround=new g.default(a);break;case "DocumentFocus":this.workaround=new d.default(a);break;case "HandleOpen":this.workaround=
new c.default(a);break;case "RegularOpenCloseLast":this.workaround=new q.default(a);break;case "Swapper":this.workaround=new n.default(a);break;case "SwapperMultipleWindows":this.workaround=new t.default(a);break;case "SwapperMultipleWindowsNoSpinner":this.workaround=new u.default(a);break;case "SwapperNoSpinner":this.workaround=new m.default(a);break;default:if(!b&&a.fallbackName)return p.getLogger().warn("cmp2-workaround: unable to find workaround. Trying to fallback",a),void this.setWorkaround(a,
!0);p.getLogger().error("cmp2-workaround: unable to find workaround",a.name);this.workaround=new h.default(a)}},a.prototype.getWorkaround=function(){return this.workaround||(p.getLogger().error("cmp2-workaround: workaround is not set"),this.workaround=new h.default({name:""})),this.workaround},a}();b.Workaround=v;b.default=function(){return v.getInstance()}},function(e,b,a){Object.defineProperty(b,"__esModule",{value:!0});var h=a(37);b.each=function(a,b){if(h.isArrayLike(a))for(var f=a.length,g=0;g<
f&&!1!==b.call(a[g],g,a[g]);g++);else for(g in a)if(a.hasOwnProperty(g)&&!1===b.call(a[g],g,a[g]))break;return a}},function(e,b,a){Object.defineProperty(b,"__esModule",{value:!0});var h=a(12),f=a(21),l=a(38);b.isArrayLike=function(a){var b=!!a&&"length"in a&&a.length,d=f.toType(a);return!h.isFunction(a)&&!l.isWindow(a)&&("array"===d||0===b||"number"==typeof b&&0<b&&b-1 in a)}},function(e,b,a){Object.defineProperty(b,"__esModule",{value:!0});b.isWindow=function(a){return null!=a&&a===a.window}},function(e,
b,a){Object.defineProperty(b,"__esModule",{value:!0});e=a(24);b.objectFunctionString=e.functionToString.call(Object)},function(e,b,a){Object.defineProperty(b,"__esModule",{value:!0});var h=a(0);e=a(2);var f=a(5),l=a(3),k=a(7),g=a(28),d=l.default();a=function(a){function b(){return null!==a&&a.apply(this,arguments)||this}return h.__extends(b,a),b.prototype.onDirectClick=function(a,b){a=d.forDirect(a);a=new f.default(this.options,a);(new g.default(a)).start(!1)},b.prototype.onFormClick=function(a,b,
c){var e=this;a=d.forSubmit(b);b={url:"",name:"_self",features:{}};delete b.features;a.push(b);a=new f.default(this.options,a);a.postItemOpen=function(a,b,c){a.features||(c&&!c.closed?c.focus():k.getLogger().warn("cmp2-workaround: AsyncOpen unable to focus",{workaround:e.options}))};a.postOpen=function(a,b){c(a,b)};(new g.default(a)).start(!0)},b}(e.default);b.AsyncOpen=a;b.default=a},function(e,b,a){Object.defineProperty(b,"__esModule",{value:!0});var h=a(0);e=a(2);var f=a(5),l=a(3),k=a(7),g=a(28),
d=a(4),c=a(8),p=d.default(),q=l.default();a=function(a){function b(){return null!==a&&a.apply(this,arguments)||this}return h.__extends(b,a),b.prototype.onDirectClick=function(a,b){a=q.forDirect(a);a=new f.default(this.options,a);(new g.default(a)).start(!1)},b.prototype.navigateToResults=function(a,b,c){return!(!c||0===c.length)||(k.getLogger().warn("cmp2-workaround: AsyncOpenMobile navigateToResults using fallback. There is no window handles available.",{workaround:this.options}),!1)},b.prototype.onFormClick=
function(a,b,e){var m=this,n=q.forSubmit(b,4),h=n.shift();h?(b=this.getWindowNamePrefix(),p.updateHandleName(window,d.getWindowName(b+h.name),1),n.push({url:a,name:"k"+c.default.randomString(8),features:{}}),n=new f.default(this.options,n),n.postOpen=function(b,d){var f=p.getActiveWindowHandles(b),g=p.getLastActiveHandle(f);f.length!==b.length&&k.getLogger().warn("cmp2-workaround: AsyncOpenMobile some windows are closed",{workaround:m.options,activeWindowHandlesLength:f.length,windowHandlesLength:b.length});
g&&(p.updateHandleName(g,"k"+c.default.randomString(8),2),g.location.href=a);e(b,d)},n=new g.default(n),n.setWindowNamePrefix(b),n.start(!0)):(k.getLogger().error('cmp2-workaround: AsyncOpenMobile "firstItem" is undefined',{workaround:this.options}),e([],[]))},b}(e.default);b.AsyncOpenMobile=a;b.default=a},function(e,b,a){Object.defineProperty(b,"__esModule",{value:!0});var h=a(0);e=a(2);var f=a(6),l=a(5),k=a(4);a=a(3);var g=k.default(),d=a.default();a=function(a){function b(){return null!==a&&a.apply(this,
arguments)||this}return h.__extends(b,a),b.prototype.onResultPageOpen=function(a,b,c){void 0===b&&(b={});void 0===c&&(c="");b=this.options;a=new l.default(b,d.forSubmit(a));b.resultPageFocus&&(a.postOpen=function(){g.open("",name)});a=new f.default(a);a.setWindowNamePrefix(c);a.start(!0)},b.prototype.onFormClick=function(a,b,c){a=d.forSubmit(b);var e=this.getWindowNamePrefix();g.updateHandleName(window,e,1);a=new l.default(this.options,a);a.postOpen=function(a,b){g.open("",e);c(a,b)};(new f.default(a)).start(!0)},
b}(e.default);b.ChangeWindowNameLast=a;b.default=a},function(e,b,a){Object.defineProperty(b,"__esModule",{value:!0});var h=a(0),f=a(44);e=a(2);var l=a(1),k=a(6),g=a(8),d=a(5),c=a(4),p=a(27),q=a(3),n=a(14),t=c.default(),m=p.default(),u=q.default();a=function(a){function b(){return null!==a&&a.apply(this,arguments)||this}return h.__extends(b,a),b.prototype.onDirectClick=function(a,b){var c=this;void 0===b&&(b={});var f=m.getWindowHandleInformation(),e=g.default.UUID(),f=[{url:u.getSpinnerPath(),name:"provider",
features:m.hidden(!1,f)}],f=new d.default(this.options,f);f.postOpen=function(){c.onResultPageOpen(a,b,e)};f=new k.default(f);f.setWindowNamePrefix(e);f.start(!1)},b.prototype.onResultPageOpen=function(a,b,c){void 0===b&&(b={});void 0===c&&(c="");var d=u.forMultiProviderWindow(a,b);if(d){var f=g.default.UUID();t.updateHandleName(window,f,1);c+="provider";var e=t.open(u.getSpinnerPath(),c),m=this.options;if(!m.expectWindowReference)return void l.getLogger().warn("cmp2-workaround: ChangeWindowNameSequence not expecting window reference. Refactor",
{workaround:m,windowName:c,items:a,extra:b});if(!e)return void(t.getIgnoreWindowErrors()||l.getLogger().error("cmp2-workaround: ChangeWindowNameSequence unable to open window",{workaround:m,windowName:c,items:a,extra:b}));t.open("",f);this.createSequence(e,a,d,function(a,b){a=t.getWindowHandle(a);return!!a&&(a.location.href=b,!0)})}},b.prototype.createSequence=function(a,b,c,d){var e=this;if(1===b.length)return void d.apply(e,[a,c,-1,-1]);var g=new f.TimedQueue(this.options.delay);g.setOnError(function(){l.getLogger().error("cmp2-workaround: ChangeWindowNameSequence unable finish sequence",
{workaround:e.options,items:b,index:g.getIndex(),total:g.getTotal()})});for(var h=0,k=void 0;k=b[h];h++)g.add(d,e,[a,n.formatUrl(k.deepLink||"")]);g.add(d,e,[a,u.getSpinnerPath()]);g.add(function(a){if(a=t.getWindowHandle(a)){try{var c=m.getWindowHandleInformation(window);t.moveAccordingFeatures(a,m.tiled(0,1,c))}catch(A){l.getLogger().error("cmp2-workaround: ChangeWindowNameSequence unable to change position",{workaround:e.options,items:b,index:g.getIndex(),total:g.getTotal()},A)}return!0}return!1},
e,[a]);g.add(d,e,[a,c,-1]);g.run()},b.prototype.onFormClick=function(a,b,c){a=m.getWindowHandleInformation();a=[{url:u.getSpinnerPath(),name:"provider",features:m.hidden(!1,a)}];var f=g.default.UUID();t.updateHandleName(window,f,1);a=new d.default(this.options,a);a.postOpen=function(a,b){t.open("",f);c(a,b)};(new k.default(a)).start(!0)},b}(e.default);b.ChangeWindowNameSequence=a;b.default=a},function(e,b,a){Object.defineProperty(b,"__esModule",{value:!0});e=function(){function a(a){void 0===a&&(a=
3E3);this._index=0;this._defaultDelay=a;this._queue=[]}return a.prototype.add=function(a,b,e,g){void 0===b&&(b=this);void 0===e&&(e=[]);void 0===g&&(g=this._defaultDelay);this._queue.push({fn:a,caller:b,delay:g,args:e})},a.prototype.run=function(a){void 0===a&&(a=0);this._index=a;this.next()},a.prototype.next=function(){var a=this,b=this._index++,e=this._queue[b],b=this._queue[this.getIndex()];if(e){var e=e.fn.apply(e.caller,e.args),g="boolean"!=typeof e||e;!1===e&&this.onError&&this.onError();b&&
g&&setTimeout(function(){a.next()},b.delay)}},a.prototype.setOnError=function(a){this.onError=a},a.prototype.reset=function(){this._index=0},a.prototype.getDefaultDelay=function(){return this._defaultDelay},a.prototype.getIndex=function(){return this._index},a.prototype.getTotal=function(){return this._queue.length},a.prototype.cleanUp=function(){this._index=0;this._queue=[]},a}();b.TimedQueue=e},function(e,b,a){Object.defineProperty(b,"__esModule",{value:!0});var h=a(0),f=a(26);e=a(2);var l=a(1),
k=a(6),g=a(5),d=a(4),c=a(3).default(),p=d.default();a=function(a){function b(b){var c=a.call(this,b)||this;return c.submitEvent=!1,c.opened={},f.addEvent(window,"unload",function(){c.closeAllOpened()}),c}return h.__extends(b,a),b.prototype.showRPCompareAll=function(){return!1},b.prototype.onItemChange=function(a,b,c){var d=this;c.checked?this._openAndFocus([c],function(a){(a=p.getWindowHandle(a[0]))&&(d.opened[c.code]=a);d.submitEvent=!1}):this.close(c.code,this.opened[c.code]?this.opened[c.code]:
null)},b.prototype.onFormClick=function(a,b,c){this._openAndFocus(b,c)},b.prototype._openAndFocus=function(a,b){var d=this,e=c.forSubmit(a,3),e=new g.default(this.options,e);e.postItemOpen=function(a,b,c){return d._windowFocus(c)};e.postOpen=function(c,e){d.submitEvent=!0;d.closeNotActive(a);b(c,e)};(new k.default(e)).start(!0)},b.prototype.closeAllOpened=function(){if(!this.submitEvent){var a=this.opened,b;for(b in a)a.hasOwnProperty(b)&&this.close(b,a[b])}},b.prototype.closeNotActive=function(a){for(var b=
0,c;c=a[b];b++)!c.checked&&this.opened[c.code]&&this.close(c.code,this.opened[c.code])},b.prototype.close=function(a,b){if(b){b=p.getWindowHandle(b);try{b?(b.close(),delete this.opened[a]):l.getLogger().warn("cmp2-workaround: unable to close handle handle is not exists",{workaround:this.options})}catch(u){l.getLogger().warn("cmp2-workaround: error in closing handle",{workaround:this.options})}}},b.prototype._windowFocus=function(a){var b=this;this.focusInterval&&clearInterval(this.focusInterval);
var c=0,d=setInterval(function(){try{var e=p.getWindowHandle(a);e&&(e.blur(),e.opener.focus());window.self.focus();window.focus();document.focus()}catch(r){l.getLogger().warn("cmp2-workaround: DocumentFocus - windowFocus",{workaround:b.options},r)}10<++c&&d&&clearInterval(d)},300);this.focusInterval=d},b}(e.default);b.DocumentFocus=a;b.default=a},function(e,b,a){Object.defineProperty(b,"__esModule",{value:!0});var h=a(0);e=a(2);var f=a(1),l=a(6),k=a(5),g=a(3).default();a=function(a){function b(){return null!==
a&&a.apply(this,arguments)||this}return h.__extends(b,a),b.prototype.onFormClick=function(a,b,c){var d=this;a=g.forSubmit(b);a=new k.default(this.options,a);a.postItemOpen=function(a,b,c){c&&!c.closed&&((a=c.open(g.getSpinnerPath()))?a.close():f.getLogger().warn("cmp2-workaround: HandleOpen unable to focus",{workaround:d.options}))};a.postOpen=function(a,b){return c(a,b)};(new l.default(a)).start(!0)},b}(e.default);b.HandleOpen=a;b.default=a},function(e,b,a){Object.defineProperty(b,"__esModule",{value:!0});
var h=a(0);e=a(2);var f=a(1),l=a(6),k=a(5),g=a(4);a=a(3);var d=g.default(),c=a.default();a=function(a){function b(){return null!==a&&a.apply(this,arguments)||this}return h.__extends(b,a),b.prototype.onFormClick=function(a,b,e){var g=this;a=c.forSubmit(b);a=new k.default(this.options,a);a.postOpen=function(a,b){var h=d.open(c.getSpinnerPath()),n=g.options;n.expectWindowReference?h?h.close():f.getLogger().warn("cmp2-workaround: RegularOpenCloseLast unable to focus",{workaround:n}):f.getLogger().warn("cmp2-workaround: RegularOpenCloseLast not expecting window reference. Refactor",
{workaround:n});e(a,b)};(new l.default(a)).start(!0)},b}(e.default);b.RegularOpenCloseLast=a;b.default=a},function(e,b,a){Object.defineProperty(b,"__esModule",{value:!0});var h=a(0);e=a(2);var f=a(1),l=a(6),k=a(5),g=a(4);a=a(3);var d=g.default(),c=a.default();a=function(a){function b(){return null!==a&&a.apply(this,arguments)||this}return h.__extends(b,a),b.prototype.onDirectClick=function(a,b){void 0===b&&(b={});a=[{url:c.forMultiProviderWindow(a,b),name:"_blank",features:{}}];a=new k.default(this.options,
a);(new l.default(a)).start(!1)},b.prototype.onResultPageOpen=function(a,b,e){void 0===b&&(b={});void 0===e&&(e="");if(b=c.forMultiProviderWindow(a,b)){var g=this.options,h=d.getWindowHandle(window.opener);if(g.windowLocationHref&&h&&h!==window)try{return g.locationTopHref&&h.top!==h.self?void(h.top.location.href=b):void(h.location.href=b)}catch(z){}h=d.open(b,e);!g.expectWindowReference||d.getIgnoreWindowErrors()||h||f.getLogger().info("cmp2-workaround: Swapper unable to open window",{workaround:g,
items:a,url:b,windowNamePrefix:e})}},b.prototype.navigateToResults=function(a,b,e){return(e=d.getFirstActiveHandle(e))?(e.location.href=a,this.options.method||(window.location.href=c.getSpinnerPath()),!0):(f.getLogger().error("cmp2-workaround: Swapper unable to navigate to RP",{workaround:this.options,items:b,url:a}),!1)},b.prototype.onFormClick=function(a,b,e){a=c.forBlank();d.updateHandleName(window,this.getWindowNamePrefix(),1);a=new k.default(this.options,a);a.postOpen=function(a,b){return e(a,
b)};(new l.default(a)).start(!0)},b}(e.default);b.Swapper=a;b.default=a},function(e,b,a){Object.defineProperty(b,"__esModule",{value:!0});var h=a(0);e=a(2);var f=a(1),l=a(6),k=a(8),g=a(5),d=a(4);a=a(3);var c=d.default(),p=a.default();a=function(a){function b(){return null!==a&&a.apply(this,arguments)||this}return h.__extends(b,a),b.prototype.navigateToResults=function(a,b,d){b=c.getActiveWindowHandles(d);var e=c.getLastActiveHandle(b);return e?(b.length!==d.length&&f.getLogger().warn("cmp2-workaround: SwapperMultipleWindows some windows are closed",
{workaround:this.options,activeWindowHandlesLength:b.length,windowHandlesLength:d.length}),c.updateHandleName(e,"k"+k.default.randomString(8),2),e.location.href=a,this.options.method||(window.location.href=p.getSpinnerPath()),!0):(f.getLogger().error("cmp2-workaround: SwapperMultipleWindows unable to found active window",{workaround:this.options}),!1)},b.prototype.onFormClick=function(a,b,e){b=p.forSubmit(b,4);var h=b.shift();if(!h)return f.getLogger().error('cmp2-workaround: SwapperMultipleWindows "firstItem" is undefined',
{workaround:this.options}),void e([],[]);a=this.getWindowNamePrefix();c.updateHandleName(window,d.getWindowName(a+h.name),1);b.push({url:p.getSpinnerPath(),name:"k"+k.default.randomString(8),features:{}});b=new g.default(this.options,b);b.postOpen=function(a,b){e(a,b)};b=new l.default(b);b.setWindowNamePrefix(a);b.start(!0)},b}(e.default);b.SwapperMultipleWindows=a;b.default=a},function(e,b,a){Object.defineProperty(b,"__esModule",{value:!0});var h=a(0);e=a(2);var f=a(1),l=a(6),k=a(5),g=a(4);a=a(3);
var d=g.default(),c=a.default();a=function(a){function b(){return null!==a&&a.apply(this,arguments)||this}return h.__extends(b,a),b.prototype.onDirectClick=function(a,b){void 0===b&&(b={});a=[{url:c.forMultiProviderWindow(a,b),name:"_blank",features:{}}];a=new k.default(this.options,a);(new l.default(a)).start(!1)},b.prototype.onResultPageOpen=function(a,b,e){void 0===b&&(b={});void 0===e&&(e="");if(b=c.forMultiProviderWindow(a,b)){var g=this.options,h=d.getWindowHandle(window.opener);if(g.windowLocationHref&&
h&&h!==window)try{return g.locationTopHref&&h.top!==h.self?void(h.top.location.href=b):void(h.location.href=b)}catch(z){}h=d.open(b,e);!g.expectWindowReference||d.getIgnoreWindowErrors()||h||f.getLogger().error("cmp2-workaround: SwapperNoSpinner unable to open window",{workaround:g,items:a,url:b,windowNamePrefix:e})}},b.prototype.navigateToResults=function(a,b,c){return!(!c||0===c.length)||(f.getLogger().warn("cmp2-workaround: SwapperNoSpinner navigateToResults using fallback. There is no window handles available.",
{workaround:this.options}),!1)},b.prototype.onFormClick=function(a,b,e){a=c.forBlank(a);d.updateHandleName(window,this.getWindowNamePrefix(),1);a=new k.default(this.options,a);a.postOpen=function(a,b){return e(a,b)};(new l.default(a)).start(!0)},b}(e.default);b.SwapperNoSpinner=a;b.default=a},function(e,b,a){Object.defineProperty(b,"__esModule",{value:!0});var h=a(0);e=a(2);var f=a(1),l=a(6),k=a(8),g=a(5),d=a(4);a=a(3);var c=d.default(),p=a.default();a=function(a){function b(){return null!==a&&a.apply(this,
arguments)||this}return h.__extends(b,a),b.prototype.navigateToResults=function(a,b,c){return!(!c||0===c.length)||(f.getLogger().warn("cmp2-workaround: SwapperMultipleWindowsNoSpinner navigateToResults using fallback. There is no window handles available.",{workaround:this.options}),!1)},b.prototype.onFormClick=function(a,b,e){var h=this,n=p.forSubmit(b,4),m=n.shift();if(!m)return f.getLogger().error('cmp2-workaround: SwapperMultipleWindowsNoSpinner "firstItem" is undefined',{workaround:this.options}),
void e([],[]);b=this.getWindowNamePrefix();c.updateHandleName(window,d.getWindowName(b+m.name),1);n.push({url:a,name:"k"+k.default.randomString(8),features:{}});n=new g.default(this.options,n);n.postOpen=function(b,d){var g=c.getActiveWindowHandles(b),l=c.getLastActiveHandle(g);g.length!==b.length&&f.getLogger().warn("cmp2-workaround: SwapperMultipleWindowsNoSpinner some windows are closed",{workaround:h.options,activeWindowHandlesLength:g.length,windowHandlesLength:b.length});l&&(c.updateHandleName(l,
"k"+k.default.randomString(8),2),l.location.href=a);e(b,d)};n=new l.default(n);n.setWindowNamePrefix(b);n.start(!0)},b}(e.default);b.SwapperMultipleWindowsNoSpinner=a;b.default=a},function(e,b,a){Object.defineProperty(b,"__esModule",{value:!0});var h,f=a(0);e=function(a){function b(){return null!==a&&a.apply(this,arguments)||this}return f.__extends(b,a),b.getInstance=function(){return h||(h=new this),h},b.prototype._getWindowStorage=function(){var a;try{a=window.sessionStorage}catch(d){}return a},
b}(a(29).StorageHelper);b.StorageSessionHelper=e},function(e,b,a){function h(a){window.removeEventListener("message",f,!1);q=a;window.addEventListener("message",f,!1)}function f(a){c.extractWindowOpenerRequest(a)&&(q||l.getLogger().error("cmp2-ui: Did not expect FD data to be empty"),a.source.postMessage(c.buildWindowOpenerResponse(q),"*"),q=void 0,window.removeEventListener("message",f,!1))}Object.defineProperty(b,"__esModule",{value:!0});var l=a(7),k=a(10),g=a(16),d=a(9),c=a(17),p=a(11);b.onItemMouseUp=
function(a,b){return l.getWorkaround().onItemMouseUp(a,b)};b.onItemMouseDown=function(a,b){return l.getWorkaround().onItemMouseDown(a,b)};b.onItemChange=function(a,b,c){return g.CompareToList.getInstance().updateCheckedItemState(a,c),l.getWorkaround().onItemChange(a,b,c)};b.onFormClick=function(a,b,e,f){var n=function(){f&&f()};if(!a.placement)return n(),void l.getLogger().error("cmp2-ui: placement information is missing in onFormClick method",a);var m=a.type,r=d.CompareToSettings.getInstance();if(!r.isSettings())return 0<
b.length&&l.getLogger().error("cmp2-ui: settings is missing in onFormClick method with items",a,b),void n();var q=r.getSettingsSync();if(!c.isEnabled(m,q)||c.excludeRequest(q,r.getClient(),a.placement))return void n();a.url=e;var m=g.CompareToList.getInstance().getImpressionRequestState(b),r={windowNamePrefix:l.getWorkaround().getWindowNamePrefix(),referer:q.uiReferer?window.location.href:""},w=k.WindowInfo.getStoreConfig(a,m,r);a=a.urlPrefix?a.urlPrefix:"";if(g.CompareToList.getInstance().isCheckedItem(b)){var t=
q.parentWindowOpener;t&&h(w.data);var x=a+e;return void l.getWorkaround().onFormClick(x,b,function(a){if(t)return void(l.getWorkaround().navigateToResults(x,b,a)||n());p.Ajax.getInstance().request(w,function(c){if(!c||!c.success)return l.getLogger().error("cmp2-ui: AJAX error on Store WindowInfo",c.errors),void n();l.getWorkaround().navigateToResults(x,b,a)||n()},function(a){l.getLogger().error("cmp2-ui: AJAX error on Store WindowInfo",a);n()},n)})}p.Ajax.getInstance().request(w,function(a){a&&a.success||
l.getLogger().error("cmp2-ui: AJAX error on Store WindowInfo",a.errors);n()},function(a){l.getLogger().error("cmp2-ui: AJAX error on Store WindowInfo",a);n()},n)};b.onFormButtonMouseDown=function(a){if(g.CompareToList.getInstance().isCheckedItem(a))return d.CompareToSettings.getInstance().isSettings()?void l.getWorkaround().onFormButtonMouseDown(a):void l.getLogger().error("cmp2-ui: settings are not set to execute form mouse down")};b.onFormButtonMouseUp=function(a){if(g.CompareToList.getInstance().isCheckedItem(a))return d.CompareToSettings.getInstance().isSettings()?
void l.getWorkaround().onFormButtonMouseUp(a):void l.getLogger().error("cmp2-ui: settings are not set to execute form mouse up")};var q=void 0},function(e,b,a){function h(a,b,c,d,e){var g=t.WindowInfo.getRetrieveConfig(d);m.Ajax.getInstance().request(g,function(h){if(!h||!h.success)return void q.getLogger().error("cmp2-ui: errors in Storage",h.errors,g);if((h=h.content||[],"object"==typeof h)&&h.constructor===Array&&0<h.length){var k=h[h.length-1];k&&f(a,c,b,k.items||[],k.other);var n=h.length;h.forEach(function(c,
f){l(a,b,f+1!==n,c.items,d,c,e)})}},function(a){q.getLogger().error("cmp2-ui: AJAX error on Retrieve WindowInfo V3",a,g)})}function f(a,b,c,d,e){d=a.getCompareToItemsFromImpressionState(d||[]);(void 0===b.workaround.updateHistory||b.workaround.updateHistory)&&a.isCheckedItem(d)&&c.pushHandleHistory(window,e.referer||"")}function l(a,b,c,d,e,f,g){var h=e.searchId||f&&f.searchId,l=k(e.type,f&&f.placement||e.placement,h,f&&f.url||e.url,d),p=t.List.getConfig(l);m.Ajax.getInstance().request(p,function(e){if(!e||
!e.success)return void q.getLogger().error("cmp2-ui: ResultPage error",p,e);var k=a.mapDeepLinkToItems(d||[],e.content||{});a:if(e=e.content||{},g)for(var m=0;m<k.length;m++){var r=k[m];if(r.visible&&r.checked&&(r=e[r.code])){g(r.name);break a}}b.setIgnoreWindowErrors(c);b.onResultPageOpen(k,n.getMultiProviderWindowExtra(l,"fd",h),f.other.windowNamePrefix);b.setIgnoreWindowErrors(!1)},function(a){q.getLogger().error("cmp2-ui: AJAX error on onResultPage",a,p)})}function k(a,b,d,e,f){return{type:a,
placement:b,searchId:d,url:e,compareTos:c.CompareToList.getInstance().getCompareToItemsFromImpressionState(f||[]),registerImpression:!0,includeCloseDeepLinks:!1,deepLink:!0,list:!1}}function g(a){(a=n.extractWindowOpenerResponse(a))&&(window.removeEventListener("message",g,!1),v(a.windowInfo),v=u)}function d(a,b,c,d,e){window.removeEventListener("message",g,!1);var f=setTimeout(function(){window.removeEventListener("message",g,!1);e()},c);v=function(b){return clearTimeout(f),b?a.type!==b.type?void q.getLogger().error("cmp2-ui: window opener returned an unexpected vertical",
b,a):void d(b):void q.getLogger().error("cmp2-ui: Received incomplete information from the parent")};window.addEventListener("message",g,!1);b.postMessage(n.buildWindowOpenerRequest(),"*")}Object.defineProperty(b,"__esModule",{value:!0});var c=a(16),p=a(9),q=a(7),n=a(17),t=a(10),m=a(11);b.onDirectMouseUp=function(a,b){if(!p.CompareToSettings.getInstance().isSettings())return void q.getLogger().error("cmp2-ui: settings are not set to execute direct mouse up");q.getWorkaround().onDirectMouseUp(c.CompareToList.getInstance().getVisibleItem(a),
n.getMultiProviderWindowExtra(b,"rp"))};b.onDirectMouseDown=function(a,b){if(!p.CompareToSettings.getInstance().isSettings())return void q.getLogger().error("cmp2-ui: settings are not set to execute direct mouse down");q.getWorkaround().onDirectMouseDown(c.CompareToList.getInstance().getVisibleItem(a),n.getMultiProviderWindowExtra(b,"rp"))};b.onDirectClick=function(a,b){if(!p.CompareToSettings.getInstance().isSettings())return void q.getLogger().error("cmp2-ui: settings are not set to execute direct click");
q.getWorkaround().onDirectClick(c.CompareToList.getInstance().getVisibleItem(a),n.getMultiProviderWindowExtra(b,"rp"))};b.onResultPage=function(a,b){var e=p.CompareToSettings.getInstance(),g=e.getSettingsSync();if(!g)return void q.getLogger().error("cmp2-ui: errors config is not defined can't make request on ResultPage");if(n.isEnabled(a.type,g)&&!n.excludeRequest(g,e.getClient(),a.placement)){var k=c.CompareToList.getInstance(),m=q.getWorkaround();return(e=window.opener)&&e===window&&(g.logSameWindowOpener&&
q.getLogger().warn("cmp2-ui: window.opener is the same as window"),g.excludeSameWindowOpener)?void h(k,m,g,a,b):g.childWindowOpener&&e?void d(a,e,g.childWindowOpenerWait||1E3,function(c){var d=c.items||[];f(k,g,m,d,c.other);l(k,m,!1,d,a,c,b)},function(){h(k,m,g,a,b)}):void h(k,m,g,a,b)}};b.registerImpression=function(a,b){var c=p.CompareToSettings.getInstance();c.getSettings(function(d){if(n.isEnabled(a.type,d)&&!n.excludeRequest(d,c.getClient(),a.placement)){d=k(a.type,a.placement,a.searchId,a.url,
b);var e=t.List.getConfig(d);m.Ajax.getInstance().request(e,function(a){a&&a.success||q.getLogger().error("cmp2-ui: Error on registerImpression",e,a)},function(a){q.getLogger().error("cmp2-ui: AJAX error on registerImpression",a,e)})}})};var u=function(a){q.getLogger().error("cmp2-ui: noop was called")},v=u}]);(function(f,g){f.createComponentClass("common.compareto.v3.CompareToModuleSettings",{options:{config:null,prefix:null,addType:!1,advanceError:!1},moduleLoaded:!1,ajaxCall:function(a,b,c){var e=this.options,d=g.extend(!0,{},a.params,a.data);"GET"!==a.method&&(d=JSON.stringify(d));g.ajax({url:a.url,method:a.method,dataType:"json",contentType:"application/json; charset\x3dutf-8",data:d,headers:a.headers,success:function(a){b&&b(a)},error:function(a,b,d){c&&(e.advanceError?c({jqXHR:a,status:a.status,
responseText:a.responseText,textStatus:b,errorThrown:d}):c(a))}})},init:function(){var a=this,b=a.options,c=b.config,e=b.prefix,d=a.log;f.question.answer("cmp2.module.loaded",function(){return a.moduleLoaded});f.question.answer("cmp2.module.config",function(){return c});c?a.setConfig(c):(e={method:"GET",url:e+"compareTo/config",success:function(b){b&&b.content?a.setConfig(b.content):(d.error("cmp2-module: unexpected response in config",b),a.setConfig(null))},error:function(b){d.error("cmp2-module: error loading config",
b);a.setConfig(null)}},b.addType&&(e.dataType="json",e.contentType="application/json;charset\x3dutf-8"),g.ajax(e))},setConfig:function(a){var b=this,c=b.log;f.events.publish("cmp2.module.config",a);window["@r9/cmp2-ui"].setModuleConfig({ajax:function(a,d,c){b.ajaxCall(a,d,c)},logger:c,settings:a,client:"desktop"});b.moduleLoaded=!0;f.events.publish("cmp2.module.loaded",!0)},addEventHandlers:function(){}})})(window.R9,window.jQuery||window.jq);(function(d,g){d.createComponentClass("common.compareto.v3.Items",{options:{navigateToResults:!1,placement:{},hiddenClass:"",visibleClass:"",hiddenControls:"",visibleControls:"",itemChecked:"",defaultStyle:"",itemUnChecked:"",useOnlyVisible:!1,e2eTesting:!1},lastRequest:null,lastRequestData:null,lastResponse:null,itemsInProgress:!1,cleanupTimer:null,init:function(){this.cmp2ItemsElement=this.getChildElement("checkbox-row");this.cmp2ModuleLoaded=!0===d.question.ask("cmp2.module.loaded")},shouldUpdate:function(a){return-1<
this.id().indexOf(a.id)},addEventHandlers:function(){var a=this;a.subscribe("cmp2.module.loaded",function(b){a.cmp2ModuleLoaded=b;a.lastRequestData&&a.cmp2ModuleLoaded&&(d.events.publish("cmp2.getItems",a.lastRequestData),a.lastRequestData=null)});a.subscribe("cmp2.getItems",function(b){a.shouldUpdate(b)&&(a.cmp2ModuleLoaded?(a.cleanupTimer&&clearTimeout(a.cleanupTimer),b=a.sanitizeFormData(b),a.lastRequest===g.param(b)?a.itemsInProgress||a.printResponse(a.lastResponse):(a.lastRequest=g.param(b),
a.lastResponse=[],a.itemsInProgress=!0,window["@r9/cmp2-ui"].getCompareTo(b,function(b){a.printResponse(b);a.lastResponse=b;a.itemsInProgress=!1},function(){a.lastResponse=[];a.itemsInProgress=!1;a.printResponse([])}))):a.lastRequestData=b)});a.subscribe("cmp2.cleanUp",function(b){a.shouldUpdate(b)&&(a.cleanupTimer=setTimeout(function(){a.printResponse([])},50))});a.subscribe("cmp2.submit",function(b){if(a.shouldUpdate(b)){var c=a.items||[],d=b.url&&b.url.startsWith("http")?b.url:"/"+b.url,h=a.sanitizeFormData(b);
a.isVisible()||(c=[]);a.onFormSubmit(b,h,c,d)}});var c=a.id(),c=c.substr(0,c.lastIndexOf("-"));g("#"+c+" button[type\x3dsubmit]").on("mousedown",function(){var b=a.items||[];a.isVisible()||(b=[]);window["@r9/cmp2-ui"].onFormButtonMouseDown(b)});g("#"+c+" button[type\x3dsubmit]").on("mouseup",function(){var b=a.items||[];a.isVisible()||(b=[]);window["@r9/cmp2-ui"].onFormButtonMouseUp(b)});a.getChildElement("allLink").on("click",function(b){b.preventDefault();a.toggleCheckedItems(!0)});a.getChildElement("noneLink").on("click",
function(b){b.preventDefault();a.toggleCheckedItems(!1)});a.subscribe("cmp2.uncheckAll",function(){a.toggleCheckedItems(!1)});a.subscribe("cmp2.checkAll",function(){a.toggleCheckedItems(!0)});a.subscribe("cmp2.update.component.options",function(b){if(b||b.navigateToResults)a.options.navigateToResults=b.navigateToResults})},isVisible:function(){var a=this.element,c=this.elementNode;return this.options.useOnlyVisible?a.length&&!!(c.offsetWidth||c.offsetHeight||c.getClientRects().length):!0},onFormSubmit:function(a,
c,b,e){var f=this,h=f.options.navigateToResults;window["@r9/cmp2-ui"].onFormClick(c,b||[],e||"",function(){h?e&&e.startsWith("http")?f.redirectPage(e):f.redirectPage("/"+e.replace(/^[/]*/g,"")):d.events.publish("searchform.submit",a)})},redirectPage:function(a){window.location.href=a},toggleCheckedItems:function(a){(!a||this.items&&window["@r9/cmp2-ui"].showRPCompareAll(this.items))&&this.cmp2ItemsElement.find(".item").each(function(){var c=g(this);"true"===c.attr("aria-checked")!==a&&c.trigger("click")})},
renderItemTemplate:function(a){var c=this.options;return g("\x3cspan /\x3e").addClass(c.defaultStyle).addClass("item").addClass(a.checked?c.itemChecked:c.itemUnChecked).attr("role","checkbox").attr("aria-checked",a.checked).attr("data-code",a.code).attr("tabindex","0").text(a.name)},printResponse:function(a){var c=this.options,b=0;d.dom.swapClasses(this.element,c.visibleClass,c.hiddenClass);d.events.publish("cmp2.hidden",{id:this.id(),visible:!1});this.cmp2ItemsElement.empty();if(a&&0<a.length){for(var e=
0,f=a.length,h;e<f;e++)(h=a[e])&&h.visible&&(b=this.renderItemTemplate(h),this.cmp2ItemsElement.append(b),this.updateElementState(b,h),b=1);b&&(this.updateControlsState(a),d.events.publish("cmp2.shown",{id:this.id(),visible:!0}),d.dom.swapClasses(this.element,c.hiddenClass,c.visibleClass))}this.items=a;d.events.publish("cmp2.rendering.finished",{id:this.id(),items:a})},updateControlsState:function(a){this.options.e2eTesting?this.getChildElement("controls").addClass(this.options.visibleControls):d.dom.swapClassesToggle(this.getChildElement("controls"),
this.options.visibleControls,this.options.hiddenControls,window["@r9/cmp2-ui"].showRPCompareAll(a))},updateElementState:function(a,c){var b=this,e=b.options,f=g(a);f.on("click",function(){var a=g.extend(!0,{},c);c.checked=!c.checked;d.dom.swapClassesToggle(f,e.itemChecked,e.itemUnChecked,c.checked);f.attr("aria-checked",c.checked);window["@r9/cmp2-ui"].onItemChange(b.items,a,c)}).on("mousedown",function(){window["@r9/cmp2-ui"].onItemMouseDown(b.items,c)}).on("mouseup",function(){window["@r9/cmp2-ui"].onItemMouseUp(b.items,
c)}).on("keydown",function(a){return a.keyCode===d.globals.keyCodes.SPACE||a.keyCode===d.globals.keyCodes.RETURN?(f.trigger("click"),!1):!0})},sanitizeFormData:function(a){var c;switch(a.vertical){case "flights":c="F";break;case "hotels":c="H";break;case "cars":c="C";break;case "packages":c="P";break;case "cruises":c="R";break;case "trains":c="T";break;default:c=a.vertical}return{type:c,placement:this.options.placement,url:a.url,requestInformation:null}}})})(window.R9,window.jQuery||window.jq);(function(e,g){e.publish("hotels.search.HotelSearchFormUrls",{generateUrl:function(a,c){var b=(a.urlPrefix||"hotels")+"/",d=a.location,f="-c";this._isEmpty(a.address)||(d=a.address,-1===a.address.indexOf(a.location)&&(d+=","+a.location),f="-a");b+=this._encodeLocation(d,a.useFullSearchUrl);this._isEmpty(a.frid)?this._isEmpty(a.srid)?this._isEmpty(a.rid)?this._isEmpty(a.cid)?!this._isEmpty(a.placeId)&&e.config.getBoolean("ui.hotels.searchUrlPlace.enabled",!1)?b+="-p"+a.placeId:this._isEmpty(a.ctid)||
(b+=f+a.ctid):b+="-u"+a.cid:b+="-r"+a.rid:b+="-s"+a.srid:b+="-e"+a.frid;this._isEmpty(a.hid)?this._isEmpty(a.lmid)||"custom"===a.lmid?this._isEmpty(a.nhid)||(b+="-n"+a.nhid):b+="-l"+a.lmid:(b+="-h"+a.hid,a.goToHotelDetailsPage&&(a.smartyItemChanged||a.fromRatesTable)&&(b+="-details"));this._isEmpty(a.amenity)||(b+="-f"+a.amenity);!this._isEmpty(a.minStars)&&0<=a.minStars&&5>=a.minStars&&(b+="-"+a.minStars+"stars");a.starsAndAbove&&0<a.starsAndAbove&&(b+="-"+a.starsAndAbove+"starsAA");a.minGuestRating&&
0<a.minGuestRating&&(b+="-mgRating"+a.minGuestRating);this._isEmpty(a.checkin)||this._isEmpty(a.checkout)||(b+="/"+a.checkin+"/"+a.checkout);this._isEmpty(a.adults)||(0<a.adults&&(b+="/"+a.adults+"adults"),!this._isEmpty(a.children)&&0<a.children&&(b+="/"+a.children+"children",a.childAges&&(b+="-"+a.childAges)));a.rooms&&1<a.rooms&&(b+="/"+a.rooms+"rooms");a.lmName&&a.lmid&&"custom"===a.lmid&&(b+="/at-"+this._cleanString(a.lmName));if(a.placeId||a.placeName||a.stars)if(b+="?",a.placeId&&(b+="placeId\x3d"+
a.placeId),a.placeName&&(a.placeId&&(b+="\x26"),b+="placeName\x3d"+a.placeName),a.stars){if(a.placeId||a.placeName)b+="\x26";b+="stars\x3d"+a.stars}b=this.appendFilterStateParam(b,c);"map"===a.view&&(b+=";map");return b},appendFilterStateParam:function(a,c){if(!c||g.isEmptyObject(c)||!e.config.getBoolean("ui.hotels.searchUrlFS.enabled",!0))return a;var b=[];Object.keys(c).each(function(a){a&&"string"===typeof c[a]&&""!==c[a]&&b.push(a+"\x3d"+c[a])});if(b.length){var d=-1<a.indexOf("\x26")?"\x26":
"?";return a+d+"fs\x3d"+b.join(";")}return a},_cleanString:function(a){return a.replace(/, /g,",").replace(/ - /g,",").replace(/ /g,"-").replace(/[^A-Za-z0-9_\-,.]/g,"")},_isEmpty:function(a){return a?"string"===typeof a&&(""===a.trim()||0>=parseInt(a)):!0},_encodeLocation:function(a,c){a=this._mapAccentedChars((a+"").replace(/, /g,",").replace(/ - /g,",").replace(/ /g,"-"));c||(a=a.replace(/[^A-Za-z0-9_\-,.]/g,""));return a},_mapAccentedChars:function(a){return e.Common.RemoveAccents.removeAccentedChars(a)}})})(R9,
jQuery);(function(g,f,h){g.publish("common.maps.Geocoding",h.extend({_channel:null,_context:null,loggingBase:"/common/maps/Geocoding/",_data:{location:null,postalCode:null,address:null,addressNickname:null,lat:null,lng:null,isAddress:!1},constructor:function(a,b){this._channel=a;this._context="string"===typeof b?b:null},initGeocoder:function(a){var b=f.Deferred(),c;c="initialize/"+(g.Maps.Google.isLoaded()?"already_loaded":"api_request_made");g.Maps.Google.load(function(){b.resolve(new google.maps.Geocoder)},
this._channel);this.logAnalytics(c,"undefined"!==typeof a?a:null);return b.promise()},clear:function(){for(var a in this._data)this._data.hasOwnProperty(a)&&(this._data[a]=null)},getLastResult:function(){return this._data},makeRequest:function(a,b){var c=this,e=f.Deferred();this.initGeocoder().then(function(d){c.logAnalytics("findAddress/api_request_started",b);d.geocode({address:a},function(a,d){d===google.maps.GeocoderStatus.OK?(c.logAnalytics("findAddress/api_request_successful",b),c.formatGeometry(a),
e.resolve(c.getLastResult(),b)):(c.logAnalytics("findAddress/api_request_failed",b,"string"===typeof d?{status:"/"+d}:null),e.reject(d))})});return e.promise()},findAddress:function(a,b,c){var e=this,d=f.Deferred();this.makeRequest(a).then(function(a){e.parseResult(a,b,c)}).then(function(){d.resolve(e.getLastResult())});return d.promise()},parseResult:function(a,b,c){this._data.isAddress=!1;var e=this.getValidatedPlace(a,b);if(e){this._data.location=e.formatted_address;b=this.getAddressFragments(e,
c);this._data.location="US"===b.country||"CA"===b.country?b.city+","+b.state+","+b.country:b.city+","+b.country;var e=e.formatted_address.split(", "),d=e.length;b="US"===b.country||"CA"===b.country?3:2;d<b?this.logAnalytics("parseResult/location_length_too_short",c):(this._data.isAddress=!0,d>=b+1&&(this._data.address=e[d-b-1]),d>=b+2&&(this._data.addressNickname=e[0]),this.formatGeometry(a),this.logAnalytics("parseResult/success",c))}else this.logAnalytics("parseResult/invalid_result",c)},getValidatedPlace:function(a,
b){a=f.isArray(a)?a[0]:a||{};var c=["street_address","premise","route"];if(!a||!a.formatted_address||b&&0<=c.indexOf(a.types[0]))a=null;return a},getAddressFragments:function(a,b){for(var c={city:null,state:null,country:null},e=0;e<a.address_components.length;e++)for(var d=a.address_components[e],f=0;f<d.types.length;f++){var g=d.types[f];if("country"===g){c.country="US"===d.short_name||"UK"===d.short_name?d.short_name:d.long_name;break}else if("administrative_area_level_1"===g){c.state=d.short_name;
break}else if("locality"===g){c.city=d.long_name;break}else if("postal_code"===g){this._data.postalCode=d.long_name;break}}return"undefined"===typeof c.country||"undefined"===typeof c.city?(this.logAnalytics("parseResult/invalid_country_or_city",b),null):c},formatGeometry:function(a){a=f.isArray(a)?a[0]:a||{};var b={};if(a.geometry&&a.geometry.location){b.lat=a.geometry.location.lng();b.lng=a.geometry.location.lat();var c=a.geometry.bounds||a.geometry.viewport||null;if(c){var e=c.getNorthEast(),c=
c.getSouthWest();b.bounds={neBounds:{lat:e.lat(),lng:e.lng()},swBounds:{lat:c.lat(),lng:c.lng()}}}}this._data=f.extend({},a,b)},logAnalytics:function(a,b,c){a={category:this.loggingBase+a,channel:this._channel,parentComponent:this._context};"undefined"!==typeof b&&(a.callerComponent=b);"object"===typeof c&&(a=f.extend(a,c));g.Analytics.api.trackEvent(a)}}))})(R9,jQuery,base2.Base);(function(c,d){var f=c.config.getBoolean("ui.horizon.searchForm.includePageTypeCookie",!0);c.createComponentClass("base.search.SearchForm",{vertical:null,searchForm:null,submitButton:null,errorContainer:null,searchFormFilterState:null,animationInterval:null,isFormChanged:!1,isScrollUserAction:!1,timers:{selectAll:null},sticky:!1,stickyAfterElement:null,options:{loadCmp2WhenVisible:!1,suppressCmp2s:!1,cleanUpInputFieldOnFocus:!1,useCmp2Submit:!0,navigateToResults:!1,pageOrigin:"",useHistory:!0,inlineErrorEnabled:!1,
sync:!0,forceSearchFormSubmit:!1,loggingPrefix:"",isSeo:!1,isCmp2Tooltip:!1,autofocusViaJs:!1,multiSearcherEnabled:!1,useSelectWidget:!1,useDialogQuestions:!1,displayDateFormat:"MMM D",enableSmartyRemoteHide:!1,hasSubscriptionPanel:!1,formChangedClass:"formChangedState",singlePulseAnimation:!1,showTopDestinations:!1,continents:[],smartyInnerScrollEnabled:!1,smartyUIUpdateEnabled:!1,searchFormFilterState:null,useStyleJamInlineSearchButton:!1,useMultipleSubmitIds:!1,scrollLoggingEnabled:!1,isSEM:!1,
semZoomAuditParams:null,isStickySearchFormEnabled:!1,stickyAfterCssSelector:null,stickySearchFormAdditionalPadding:!1,searchInputContainerId:null,mcFlySearch:!1,cmp2LoadOnChangesOnly:!1},scrollSearchToggleHeight:200,didUpdateHistory:!1,localHistory:null,isSubmitted:!1,consentGranted:!1,init:function(a){this.searchForm=this.element.find(".searchform");this.submitButton=this.options.useMultipleSubmitIds?this.getChildElements("submit,submit-multi"):this.getChildElement("submit");this.errorContainer=
this.getChildElement("error");this.searchFormFilterState=this.options.searchFormFilterState;var b=this;this.answer(this.id(),function(){return b.serialize()});this.answer("base.search.SearchForm.type."+b.id(),function(){return b._formType()});b.element.is(":visible")&&this.answer("base.search.SearchForm.id",function(){return b.id()});this.options.mcFlySearch&&(this.answer("searchForm.searchUrl",function(){return b.buildSearchURL(b.serialize())}),this.answer("searchForm.valid",function(){return b.isValid()}))},
addEventHandlers:function(){var a=this;this.bindLocalHistory();this.bindSelectTextOnFocus();this.loadFromStorage();this.options.useStyleJamInlineSearchButton&&(this.registerEvent("click",this.submitButton,function(){a.searchForm.submit();return!0}),this.registerEvent("keyup",this.submitButton,function(b){0<=[c.globals.keyCodes.RETURN,c.globals.keyCodes.SPACE].indexOf(b.keyCode)&&a.searchForm.submit()}));this.subscribe("submit.search.form",this.submitSearchForm.bind(this));this.subscribe("submit.search.form.force",
{id:this.id()},function(){a.isFormChanged=!0;a.submitSearchForm()});this.searchForm.on("submit",function(b){b.preventDefault();a.logUserImpressionForScrollSearchBanner();a.trackSubmitEvent();return a.onSubmit(b)});c.events.subscribe("search.form.clear",d.proxy(this.onClear,this));c.events.subscribe("common.compareto.focusout",{id:this.id()+"-compareTo"},function(){a.submitButton.focus()});c.events.subscribe("search.form.button.enable",function(){a.enableSearchButton()});this.setUpSEMStickyListener()},
enableSearchButton:function(){this.submitButton.prop("disabled",!1).attr("aria-disabled",!1);this.isSubmitted=!1},disableSearchButton:function(){this.submitButton.prop("disabled",!0).attr("aria-disabled",!0);this.isSubmitted=!0},inlineComponentsReady:function(){c.events.publish("searchform.initialized",this);this.loadCompareToItems();if(this.options.autofocusViaJs){var a=this;setTimeout(function(){a.autofocus()},10)}},loadCompareToItems:function(){var a=this;if(!c.config.getBoolean("ui.cmp2.searchform.defer",
!0)||!this.deferCmp2Id&&this.deferCmp2Init)if(this.isEnoughInformationForCompareToRequest()){var b=this.serialize()||{};b.relativeUrl=!0;var e=this.buildSearchURL(b);b.id=this.id();b.url=e;b.vertical=this.vertical;c.events.publish("cmp2.getItems",b);c.events.publish("search.form.clear",this.id())}else c.events.publish("cmp2.cleanUp",{id:this.id()});else this.deferCmp2Init=1,this.deferCmp2Id&&clearTimeout(this.deferCmp2Id),this.deferCmp2Id=setTimeout(function(){clearTimeout(a.deferCmp2Id);a.deferCmp2Id=
null;a.loadCompareToItems()},100)},shouldUpdate:function(a){a=a||{};return!!a.forceUpdate||this.options.sync||this.id()===a.id},updateLogging:function(a){a.loggingPrefix&&a.loggingPrefix!==this.options.loggingPrefix&&(this.options.loggingPrefix=a.loggingPrefix)},getCompareToFormData:function(){return{}},isEnoughInformationForCompareToRequest:function(){return!1},serialize:function(){return{tab:this.vertical,pageOrigin:this.options.pageOrigin,src:"",searchingAgain:"",c2s:"",po:"",personality:"",provider:"-1",
searchFormFilterState:this.getSearchFormFilterState(),pageType:f?this.getPageType():null}},load:function(a){},buildSearchURL:function(a){},onClear:function(){this.clearErrors()},clearErrors:function(){this.errorContainer.html("")},validate:function(){return!1},isValid:function(){var a=this.validate();return!a||!a.length},showError:function(a){if(this.options.inlineErrorEnabled)if(0<this.errorContainer.length)this.errorContainer.html(a),c.events.publish("search.submit.error",this.errorContainer);else throw"Missing container with id: "+
this.id("error");else c.events.publish("error.alert",{messages:a})},onSubmit:function(a,b){if(this.isSubmitted)return!1;this.clearErrors();this.disableSearchButton();if((a=this.validate())&&a.length)return this.enableSearchButton(),this.showError(a),!1;this.saveToStorage(!0);c.storage.set("search_submit_pageId",c.globals.analytics.pageId);b=b||this.serialize()||{};b.vertical=this.vertical;b.url=this._generate(b);b.id=this.id();this.triggerConsentGranted();this.publishSubmitEvent(b);c.config.getBoolean("ui.horizon.common.results.tooltip-reset.enabled",
!0)&&c.events.publish("resultItem.alert.tooltip.reset");c.storage.remove("p13n.results.saveToTrips.tripId");var e=this;setTimeout(function(){e.enableSearchButton()},2500);return!1},triggerConsentGranted:function(){c.config.getBoolean("ui.gtm.useConsent",!1)&&c.config.getBoolean("ui.consent.submit.publish",!0)&&!this.consentGranted&&(this.consentGranted=!0,c.events.publish("consent.granted"))},notValidSubscription:function(){return!0===this.options.hasSubscriptionPanel?c.question.ask("email.subscription.validate."+
this.id("subscription-panel")):!1},submitSubscription:function(){return!0===this.options.hasSubscriptionPanel?c.question.ask("email.subscription.submit."+this.id("subscription-panel")):!0},publishSubmitEvent:function(a){var b;b=this.options.multiSearcherEnabled?"multilocale.search.submit":this.options.useCmp2Submit&&!this.options.forceSearchFormSubmit?"cmp2.submit":"searchform.submit";a.navigateToResults=this.options.navigateToResults;c.events.publish(b,a)},bindSelectTextOnFocus:function(){var a=
this;this.searchForm.find("input.selectTextOnFocus").on("focus.selectAll",function(){a.selectInput(this)});var b=this.searchForm.find("input[autofocus]");b.length&&a.selectInput(b.get(0))},selectInput:function(a){if(!d(a).data("disabledSelect")){var b=this;clearTimeout(this.timers.selectAll);this.timers.selectAll=window.setTimeout(function(){a.select();b.options.cleanUpInputFieldOnFocus&&(a.value="")},50)}},bindLocalHistory:function(){var a=this;this.didUpdateHistory=!1;this.localHistory=new c.common.utils.history.UserHistory({tab:a.vertical,
persistLocalStorage:!0,onSave:function(){a.didUpdateHistory||a.saveToStorage(!1)}})},trackSubmitEvent:function(){c.Analytics.api.trackEvent("%s/searchform/submit".format(this.options.loggingPrefix))},getCookieData:function(){var a=this.serialize(),b={page_origin:a.pageOrigin,src:a.src,searchingagain:a.searchingAgain,c2s:a.c2s,po:a.po,personality:a.personality,provider:a.provider};f&&(b.pageType=a.pageType);return b},getPageType:function(){var a;a=c.question.ask("SearchPage.view");a||(a=(a=c.globals.analytics&&
c.globals.analytics.pageId)?"results"===a?"RP":"FD":data.pageOrigin.contains(".FD")?"FD":"RP");return a},getSearchFormFilterState:function(){return d.extend({},this.searchFormFilterState)},_formType:function(){return""},_generate:function(a){a=this.buildSearchURL(a);this.setCookies(a);if(this.options.isSEM&&this.options.semZoomAuditParams){var b=this.options.semZoomAuditParams,e;for(e in b)a=c.Common.Utils.URL.addQueryParameter(a,e,b[e])}this.options.isSEM&&(a=c.Common.Utils.URL.addQueryParameter(a,
"isSEM","true"));return a},setCookies:function(a){var b=this.getCookieData();b.id=this.id();c.events.publish("update.cookies",b);document.cookie=this._generateCookie(a,this.vertical,b)},_generateCookie:function(a,b,c){if(""!==a){b="/"+b+"/";var e=encodeURIComponent(a.substring(a.indexOf(b)+b.length));0>a.indexOf(b)&&(e=encodeURIComponent(a.substring(a.indexOf("/",1)+1)));a="hiddenParams"+e;b=new Date;e=b.getTime();b.setTime(e+3E4);c=encodeURIComponent(decodeURIComponent(d.param(c)));return a+"\x3d"+
c+"; expires\x3d"+b.toGMTString()+"; path\x3d/"}},getStorageProps:function(){return null},getStorageExceptions:function(){return null},loadFromStorage:function(){this.loadingHistory=!0;this.options.useHistory&&this.localHistory.wasLastUsedPage&&this.loadFromHistory(this.localHistory.getRecentHistory());this.loadingHistory=!1},loadFromHistory:function(a){this.load(d.extend({},{id:this.id()},a))},saveToStorage:function(a){this.didUpdateHistory=!0;if(a){a=this.serialize()||{};var b=this.getStorageProps()||
{},c=this.getStorageExceptions()||[],g={};b||(b=d.map(a,function(a,b){return b}));c&&d.map(c,function(a){a=d.inArray(a,b);0<=a&&b.splice(a,1)});for(c=0;c<b.length;c++)if(a.hasOwnProperty(b[c])){var h=b[c],f=a[h];this.localHistory.set(h,f);g[h]=f}d.isEmptyObject(g)||this.localHistory.pushSearchHistory(g)}},autofocus:function(){return null},isNull:function(a){return null===a},isUndefined:function(a){return"undefined"===typeof a},isEmpty:function(a){return this.isNull(a)||this.isUndefined(a)||"string"===
typeof a&&""===a.trim()},checkFormChanges:function(){return null},destroy:function(){this.options.scrollLoggingEnabled&&d(window).off("scroll.logListener");null!==this.animationInterval&&clearInterval(this.animationInterval);this.base()},setFormChangedState:function(a){a=this.checkFormChanges()?a:!1;c.events.publish("searchForm.changed",a&&this.searchForm.is(":visible"));this._trackEvent("formChanged","stateChange",a);(this.isFormChanged=a)&&this.enableScrollLoggingEvent();if(this.options.useStyleJamInlineSearchButton)return this.setStyleJamButtonActivation(a,
this.id("submit"));c.events.publish("button.formChangedState",{changed:a});this.element.toggleClass(this.options.formChangedClass,a);this.options.singlePulseAnimation&&this.submitButton.toggleClass("pulse",a)},setStyleJamButtonActivation:function(a,b){c.events.publish(a?"button.activate":"button.deactivate",{id:b});this.options.singlePulseAnimation&&c.events.publish(a?"button.pulse":"button.pulse.reset",{id:b})},checkAndSetDropdownSmartyInnerScrollOpts:function(a){this.options.smartyInnerScrollEnabled&&
(a.boundToScreen=!0)},checkAndSetSmartyUIUpdateOpts:function(a){this.options.smartyUIUpdateEnabled&&(a.extendRequest={f:"j"},a.dropdownClass+=" ui-update-v1",a.smartyUIUpdateEnabled=!0);this.options.mcFlySearch&&(a.dropdownClass+=" mcfly",a.repositionDropdownOnResize=!1,this.options.searchInputContainerId&&(a.mcFlyInline=!0,a.dropdownClass+=" mcfly-inline"))},submitSearchForm:function(){this._isFormChanged()&&this.searchForm.submit()},_isFormChanged:function(){return this.isFormChanged&&this.searchForm.is(":visible")},
logUserImpressionForScrollSearchBanner:function(){c.question.ask("was.user.shown.scrollSearch.banner")&&(this._trackEvent("userSubmitAfterSeeingScrollBanner","searchFormSubmit","manual"),c.events.publish("reset.scrollSearch.banner.shown"))},enableScrollLoggingEvent:function(){d(window).off("scroll.logListener").on("scroll.logListener",this.onScrollSearchEventLog.bind(this))},onScrollSearchEventLog:function(){c.dom.schedule(this.logUserScrollInteraction.bind(this))},logUserScrollInteraction:function(){d(window).scrollTop()>
this.scrollSearchToggleHeight&&this._isFormChanged()&&(this._trackEvent("scrollBeforeSubmit","outsideScrollSearchXp",d(window).scrollTop()),this.isScrollUserAction=!0,d(window).off("scroll.logListener"))},setSmartyContainer:function(a){if(a&&this.options.dialog&&this.options.dialogId){a.isDialog=!0;var b="#"+this.options.dialogId+"-dialog-viewport";d(b).length&&(a.appendTo=b,a.stopPropagation=!0)}},_trackEvent:function(a,b,d){c.Analytics.api.trackEvent({category:"searchForm",action:a,label:b,value:d})},
setUpSEMStickyListener:function(){if(this.options.isStickySearchFormEnabled&&this.options.isSEM)if(void 0!==this.options.stickyAfterCssSelector&&(this.stickyAfterElement=d(this.options.stickyAfterCssSelector)),void 0===this.options.stickyAfterCssSelector||void 0===this.stickyAfterElement)(new c.logger("SEM")).error("You need to setup the stickyAfterElement");else{var a=this;window.addEventListener("scroll",function(){var b=a.stickyAfterElement.offset().top,c=a.stickyAfterElement.outerHeight(!0);window.pageYOffset>
b+c?a.sticky||(a.setMinHeightOnElement(a),a.setSticky(!0)):a.sticky&&a.setSticky(!1)})}},setMinHeightOnElement:function(a){var b=a.element.outerHeight(!0);a.element.parent().css("min-height",b+"px")},setSticky:function(a){this.sticky=a;c.events.publish("select.force.close");a?d(".r9-tooltip-wrapper").css("z-index","9000"):d(".r9-tooltip-wrapper").css("z-index","9999999");this.element.click();if(this.options.stickySearchFormAdditionalPadding)if(a){this.element.addClass("desktop-of-the-future");var b=
this;setTimeout(function(){b.element.addClass("desktop-of-the-future-transition")},200)}else this.element.removeClass("desktop-of-the-future"),this.element.removeClass("desktop-of-the-future-transition")}})})(window.R9,window.jq||window.jQuery);(function(c,f){function h(a){return(a.styleJamNumberBox||a.numberBox).bind(a)}function g(a){return a?"string"===typeof a&&(""===a.trim()||0>=parseInt(a,10)):!0}var l={landmarkId:"lm",countryId:"ctry",hotelId:"hotel",neighbourhoodId:"hood",regionId:"reg",freeRegionId:"freereg",cityId:"city",subRegionId:"subreg",address:"addr"},n={lm:"landmarkId",ctry:"countryId",hotel:"hotelId",hood:"neighbourhoodId",reg:"regionId",freereg:"freeRegionId",city:"cityId",addr:"location",subreg:"subRegionId"},m="landmarkId countryId hotelId neighbourhoodId regionId freeRegionId subRegionId cityId".split(" ");
c.createComponentClass("hotels.search.StyleJamHotelSearchForm","base.search.SearchForm",{formQuestion:"hotels.fd.searchform",formCitycodeQuestion:"hotels.fd.searchform.citycode",formCitynameQuestion:"hotels.fd.searchform.cityname",formLocationQuestion:"hotels.fd.searchform.location",travelersDataQuestion:"hotels.searchform.travelers.",numNightsDataQuestion:"hotels.fd.searchform.numNights",daysOutQuestion:"hotels.fd.searchform.daysOut",searchTypeQuestion:"hotels.results.searchType",locationIdQuestion:"hotels.results.locationId",
options:{doubleDatesUpdate:!1,isSEM:!1,defaultRooms:1,defaultGuests:5,defaultAdults:1,defaultChildren:1,flareSmartyType:30,useJSONSmartyData:!1,smartyUrl:"/mv/marvel",locationType:"",maxRooms:8,maxGuests:32,maxAdults:32,maxChildren:32,forceOpen:!1,filterTemplateName:null,hotelPlannerTrigger:0,useLegacySearchUrl:!1,actionUrl:"hotels",msg:{location:"",city:"",checkinDate:"",checkoutDate:"",roomsChoiceLabel:"",guestsChoiceLabel:"",roomsOverMax:"",roomsBelowMin:"",guestsOverMax:"",guestsBelowMin:"",loyaltyProgram:""},
formQuestion:"hotels.fd.searchform",isSingleHotel:!1,isDisabledAdvanced:!1,isTravelerTypeEnabled:!1,loggingPrefix:"",dotfStickyEnabled:!1,goToHotelDetailsPage:!1,keepLocation:!0,showSmartyHistory:!1,showTopDestinations:!1,maxHistoryItems:5,controlGroup:null,urlParams:void 0,autofocusDestination:!1,autoOpenDatepicker:!1,isFdForm:!1,isRegionSearchEnabled:!1,showNumberboxTooltips:!1,useLocalStorageHistory:!1,numberBoxMsg:{roomsOverMax:function(){var a=this.adults.getValue()+this.children.getValue();
return c.Common.Utils.String.formatString(this.options.msg.roomsOverMax,this.rooms.getValue(),a)},roomsBelowMin:function(){var a=this.adults.getValue()+this.children.getValue();return c.Common.Utils.String.formatChoice(this.options.msg.roomsBelowMin,this.rooms.getValue(),this.rooms.getValue(),a)},guestsOverMax:function(){var a=this.adults.getValue()+this.children.getValue();return c.Common.Utils.String.formatString(this.options.msg.guestsOverMax,a,this.rooms.getValue())},guestsBelowMin:function(){var a=
this.adults.getValue()+this.children.getValue();return c.Common.Utils.String.formatChoice(this.options.msg.guestsBelowMin,a,a,this.rooms.getValue())}},showNeedIdeasButton:!1,showPopularDestinationsList:!1,showPopularDestinationsPictures:!1,searchAutoExecute:!1,searchAutoExecuteAfterCmp2:!1,subtractOffsetFromDropdown:!1,sticky:!1,hotelTravelersDropdownEnabled:!1,addHtcPlaceParams:!1,stlPresentation:"",stickyPresentation:"",dotfStickyPresentation:"",collapsibleStickyForm:!1,useAlgoliaSmarty:!1,cmp2LoadOnChangesOnly:!1},
filtersContainerEl:null,amenity:null,neighbourhoodId:null,neighbourhood:null,ambiance:null,location:null,cityId:null,hotelId:null,freeRegionId:null,subRegionId:null,regionId:null,countryId:null,locationType:"",entityKey:"",objectID:"",daterangePicker:null,datePicker:null,rooms:null,guests:null,adults:null,children:null,roomsGuestsDropdown:null,traveler:null,hotelPlanner:null,vertical:"hotels",_dateFormat:"YYYY-MM-DD",extraFiltersData:{},advancedFilterState:null,searchFormFilterState:null,lastCheckInDate:null,
lastCheckOutDate:null,searchAutoExecuteOnChangeCount:3,searchAutoExecuteChanged:[],cmp2Items:void 0,sticked:!1,formRoomsGuestsAbove:null,formGrid:null,formGridFieldCol:null,formFieldGrid:null,formFieldGridDataPickerCol:null,formGridButtonCol:null,formGridSearchBtn:null,startingForm:null,init:function(){this.base();this.hcPlacesEnabled=c.config.getBoolean("ui.hc.places.enabled",!1);this.locationType=this.options.locationType||"";this.formQuestion=this.options.formQuestion;this.formCitycodeQuestion=
this.formQuestion+".citycode";this.formLocationQuestion=this.formQuestion+".location";this.numNightsDataQuestion=this.formQuestion+".numNights";this.daysOutQuestion=this.formQuestion+".daysOut";this.bindDaterangePicker();this.options.hotelTravelersDropdownEnabled||this.bindRoomsGuestsDropdown();this.bindLocationField();this.bindTravelerTypeRadios();if(!this.options.loggedIn&&this.options.privateDealsPromoEnabled){var a=this.getChildElement("privatedeals");a.on("click",function(){c.Analytics.api.trackEvent("hotels/form/private-deals-promo/click");
c.authentication.showLogin({success:function(){c.Analytics.api.trackEvent("hotels/form/private-deals-promo/success");location.reload()}})});if(this.options.isFdForm){var b=c.storage.get("fd.privatedeals.promo.viewcount");b||(a.addClass("first-time-user"),b=0);c.storage.set("fd.privatedeals.promo.viewcount",++b)}c.Analytics.api.trackEvent("hotels/form/private-deals-promo/impression")}this.options.useDialogQuestions&&(this.formQuestion+=".dialog",this.formCitycodeQuestion+=".dialog",this.formLocationQuestion+=
".dialog",this.searchTypeQuestion+=".dialog",this.locationIdQuestion+=".dialog");this.filtersContainerEl=this.getChildElement("filtersContainer");this.searchFormFilterState=f.extend({},this.searchFormFilterState);this.options.sticky&&(this.formRoomsGuestsAbove=this.getChildElement("roomsGuestsAboveForm"),this.formGrid=this.getChildElement("formGrid"),this.formGridFieldCol=this.getChildElement("formGridFieldCol"),this.formFieldGrid=this.getChildElement("fieldGrid"),this.formFieldGridDataPickerCol=
this.getChildElement("fieldGridDatePickerCol"),this.formGridButtonCol=this.getChildElement("formGridButtonCol"),this.formGridSearchBtn=this.getChildElement("formGridSearchBtn"),this.formGridSearchBtnText=this.formGridSearchBtn.find(".text"),this.formGridSearchBtnIcon=this.formGridSearchBtn.find(".icon"),this.formGridSearchBtnTextWithIcon=this.formGridSearchBtnIcon.children(),this.innerSearchFormElement=this.getChildElement("innerSearchForm"),this.searchFormElement=this.getChildElement("searchform"),
this.formFieldGridLocationCol=this.getChildElement("fieldGridLocationCol"),this.formCollapseBtn=this.getChildElement("collapseFormButton"));this.options.cmp2LoadOnChangesOnly&&(this.startingForm=this.serialize())},inlineComponentsReady:function(){this.base();this.options.autoOpenDatepicker&&this.openDatepicker();c.globals&&c.globals.isSeo&&this.isValidDates()},vsLog:function(a){this.searchForm.is(":visible")&&0<=this.searchForm.offset().top&&"complete"===document.readyState&&c.Analytics.api.trackEvent(["hotels/form",
a].join("/"))},getSearchType:function(){for(var a=this.serialize(),b=0;b<m.length;b++){var c=m[b];if(!g(a[c]))return l[c]}return l.address},getLocationId:function(){var a=this.getSearchType();return"hood"===a?this.neighbourhoodId:this[n[a]].val()},addEventHandlers:function(){this.base();var a=this;this.answer(this.searchTypeQuestion,this.getSearchType.bind(this));this.answer(this.locationIdQuestion,this.getLocationId.bind(this));this.subscribe("hotels.frontdoor.form.location hotels.frontdoor.form.rooms hotels.frontdoor.form.guests hotels.frontdoor.form.guests.adults hotels.frontdoor.form.guests.children hotels.frontdoor.form.guests.childrenAges hotels.frontdoor.form.dates hotels.frontdoor.form.traveler hotels.frontdoor.form.all cmp2.form.fill".split(" "),
f.proxy(this.onChange,this));this.bindAdvancedFilter();this.subscribe("hotels.frontdoor.form.location hotels.frontdoor.form.rooms hotels.frontdoor.form.guests hotels.frontdoor.form.guests.adults hotels.frontdoor.form.guests.children hotels.frontdoor.form.guests.childrenAges hotels.frontdoor.form.dates hotels.frontdoor.form.traveler hotels.frontdoor.form.all cmp2.form.fill".split(" "),{id:this.id()},f.proxy(this.onInternalChange,this));this.subscribe("hotels.frontdoor.filter.TOGGLE",f.proxy(this.toggleAdvanced,
this));this.subscribe("intentmedia.submit.handler",f.proxy(this.onHookSubmitForIntentMedia,this));this.subscribe("hotels.frontdoor.form.autoSubmit",this.autoSubmit.bind(this));this.subscribe("omni.vertical.changed",function(b){"hotels"===b&&a.focusFirstElement()});this.options.sticky&&this.subscribe("hotels.frontdoor.form.presentation.sticky.toggle",function(b){a.toggleStickyPresentation(b)});this.answer(this.formQuestion,function(){return a.serialize()});this.answer(this.formLocationQuestion,function(){var b=
"\x3cdiv\x3e"+a.location.val()+"\x3c/div\x3e";return f(b).text()});this.answer(this.formCitycodeQuestion,function(){return a.cityId.val()});this.answer(this.formCitynameQuestion,function(){return a.cityName.val()});this.answer(this.numNightsDataQuestion,this.calculateNumNights.bind(this));this.answer(this.daysOutQuestion,this.calculateDaysOut.bind(this));this.options.showNeedIdeasButton&&(this.needIdeasButton=this.getChildElement("need-ideas"),this.needIdeasButton.click(this.needIdeas),a.needIdeasButton.removeClass("hidden"));
this.options.searchAutoExecuteAfterCmp2&&this.subscribe("cmp2.rendering.finished",function(b){!a.isNewCmp2CheckAdded(b)&&a.canExecuteAutoSearch()&&(a.searchAutoExecuteChanged=[],a.onSubmit())});this.options.sticky&&this.subscribe("hotels.detailsv2.sticky.toggle",function(a){return a?this.stickyShow():this.stickyHide()}.bind(this));this.options.hotelTravelersDropdownEnabled||(this.subscribe("hotels.frontdoor.rooms.onChange",{namespace:this.id()},this.onRoomsChange.bind(this)),this.subscribe("hotels.frontdoor.guests.onChange",
{namespace:this.id()},this.onGuestsChange.bind(this)));a.searchForm.is(":visible")&&c.question.answer("date.input.wrapper.width",function(){return a.checkIn.element.width()});this.subscribe("hotels.search.StyleJamHotelSearchForm.enableSearchButton",function(b){b===a.id()&&a.enableSearchButton()});if(this.options.collapsibleStickyForm){var b=this.getChildElement("collapseFormButton");b.length&&b.click(function(){a.toggleStickyPresentation(!1);c.events.publish("hotels.frontdoor.form.sticky.collapsed",
!0)})}this.options.showFlexOptionDropdown&&this.subscribe("common.search.flexOption.change",{namespace:this.id()},this.updateFlexOptions.bind(this))},refreshHistory:function(){if(this.options.controlGroup){var a=this.options.controlGroup.getHistory();a&&a.update()}},setupLocationFields:function(){this.location=this.getChildElement("location");this.cityId=this.getChildElement("city-id");this.cityName=this.getChildElement("city-name");this.hotelId=this.getChildElement("hotel-id");this.landmarkId=this.getChildElement("landmark-id");
this.neighbourhoodId=this.getChildElement("neighborhood-id");this.regionId=this.getChildElement("regionId");this.freeRegionId=this.getChildElement("freeRegionId");this.subRegionId=this.getChildElement("subRegionId");this.addr=this.getChildElement("addr");this.countryId=this.getChildElement("countryId");this.stars=this.getChildElement("star-wrapped");this.price=this.getChildElement("price-wrapped");this.rating=this.getChildElement("rating-wrapped");this.dates=this.daterangePicker;this.hcPlacesEnabled&&
(this.placeName=this.getChildElement("placeName"),this.placeId=this.getChildElement("placeId"))},bindLocationField:function(){var a=this;this.setupLocationFields();this.options.autoOpenDatepicker&&(f(this.location).on("keyup",function(b){13===b.which&&a.cityId.val()&&a.openDatepicker()}),f(this.location).on("mousedown touchstart",function(){f(this).focus()}));var b={minWidth:420,smartyControlGroup:a.smartyControlGroup(),flareSmartyType:a.options.flareSmartyType,dataSource:a.options.smartyUrl,messages:a.options.msg,
clearItem:function(){a.smartyItemChanged=!0;a.locationType="";a.entityKey="";a.objectID="";a.cityId.val("");a.landmarkId.val("");a.hotelId.val("");a.neighbourhoodId.val("");a.freeRegionId.val("");a.subRegionId.val("");a.addr.val("");a.regionId.val("");a.countryId.val("");a.hcPlacesEnabled&&(a.placeName.val(""),a.placeId.val(""));c.events.publish("hotels.frontdoor.form.location",{id:a.id(),locationType:"",location:"",cityId:"",landmarkId:"",hotelId:"",entityKey:"",objectID:"",placeName:"",placeId:""})},
showPopularDestinationsList:a.options.showPopularDestinationsList&&this.options.isFdForm,showPopularDestinationsPictures:a.options.showPopularDestinationsPictures&&this.options.isFdForm,showBackgroundAutocomplete:c.config.getBoolean("ui.common.smarty.background.autocomplete.enabled",!1),setItem:c.Common.Utils.throttle(50,function(b,d){a.smartyItemChanged=!0;b=d||{};d=b.id||b.lmid||b.hid||b.frid||b.rid||b.cid||b.nhid||b.entityKey||b.objectID;a.options.keepHotelIdOnCitySearch&&b.id===a.options.citycode&&
"city"===b.type&&(b.hid=b.hid||a.options.hotelId||"",b.hid===a.options.hotelId&&(a.smartyItemChanged=!1));"subreg"===b.type&&(b.srid=b.id,b.id="0");c.events.publish("hotels.frontdoor.form.location",{id:a.id(),locationType:b.type||"",location:b.str,locationName:b.short_str,cityId:b.id||(d?"0":""),landmarkId:b.lmid||(d?"0":""),hotelId:b.hid||(d?"0":""),freeRegionId:b.frid||(d?"0":""),subRegionId:b.srid||(d?"0":""),regionId:b.rid||(d?"0":""),countryId:b.cid||(d?"0":""),neighbourhoodId:b.nhid||(d?"0":
""),entityKey:b.entityKey||(d?"0":""),objectID:b.objectID||(d?"0":"")});d=a.checkIn.getValue()&&a.checkOut.getValue();a.options.autoOpenDatepicker&&!d&&a.openDatepicker();a.options.autoSubmit&&b.str&&a.autoSubmit();a.vsLog("location")}),afterDone:function(){""===a.location.val()&&(a.smartyItemChanged=!0,a.locationType="",a.entityKey="",a.objectID="",a.cityId.val(""),a.landmarkId.val(""),a.hotelId.val(""),a.neighbourhoodId.val(""),a.freeRegionId.val(""),a.subRegionId.val(""),a.addr.val(""),a.regionId.val(""),
a.countryId.val(""),a.hcPlacesEnabled&&(a.placeName.val(""),a.placeId.val("")),c.events.publish("hotels.frontdoor.form.location",{id:a.id(),locationType:"",location:"",cityId:"",landmarkId:"",hotelId:"",entityKey:"",objectID:"",placeName:"",placeId:""}))}},d=this.location.data("inputModal");a.options.searchInputContainerId?(b.appendTo=f("#"+a.options.searchInputContainerId),b.fixedDropdown=!0):d&&(b.appendTo=d.getSmartyWrapper(),b.fixedDropdown=!0,b.minWidth=null,b.maxWidth=null);this.checkAndSetSmartyUIUpdateOpts(b);
this.locationSmarty=a.options.useAlgoliaSmarty?this.location.algoliaHotelSmarty(b).getWidget():this.location.hotelSmarty(b).getWidget();c.question._questionAnswerMap.searchForm_buildSearchUrl||c.question.answer("searchForm.buildSearchUrl",function(a){return this.buildSearchURL(a)}.bind(this))},smartyControlGroup:function(){if(!this.options.showSmartyHistory&&!this.options.showTopDestinations)return null;var a={form:this,locationInput:this.location,ctid:this.cityId,lmid:this.landmarkId,hid:this.hotelId,
nhid:this.neighbourhoodId,frid:this.freeRegionId,srid:this.subRegionId,rid:this.regionId,cid:this.countryId,rooms:this.rooms,minStars:this.stars,priceRange:this.price,rating:this.rating,maxHistory:this.options.maxHistoryItems,useLegacyDatePicker:!1};this.hcPlacesEnabled&&(a.entityKey=this.placeName,a.objectID=this.placeId);if(this.options.showSmartyHistory){var b=new c.Common.SmartyHistory.SmartyHotelHistory;a.smartyHistory=function(){return b}}if(this.options.showTopDestinations){var d=new c.Common.SmartyTopDestinations.SmartyHotelTopDestinations;
a.smartyTopDestinations=function(){return d}}a.adults=this.adults;a.children=this.children;a.startDate=this.checkIn;a.endDate=this.checkOut;a.datePicker=this.datePicker;a=new c.Common.SmartyControlGroup.SmartyHotelControlGroup(a);return this.options.controlGroup=a},openDatepicker:function(){var a=this;setTimeout(function(){a.checkIn&&a.checkIn.trigger&&a.checkIn.trigger("focus")},25)},bindAdvancedFilter:function(){var a=this;this.subscribe("hotels.frontdoor.form.location",function(b){a.shouldUpdate(b)&&
c.events.publish("hotels.frontdoor.updateFilters",b)})},bindDaterangePicker:function(){var a=this,b=function(a){var b=this.serialize();c.events.publish("hotels.frontdoor.form.dates",{id:this.id(),checkInDate:b.checkInDate,checkOutDate:b.checkOutDate,actOnStart:a,hotelLocationFilterUrl:b.hotelLocationFilterUrl});this.vsLog("checkout")};this.checkIn=this.getChildElement("checkIn").getWidget();this.checkOut=this.getChildElement("checkOut").getWidget();this.checkIn.options.change=b.bind(this,!0);this.checkOut.options.change=
b.bind(this,!1);this.datePicker=this.getChildElement("datePicker").getWidget();this.options.autoSubmit&&(this.datePicker.setOption("change",function(b,c,k){a.options.autoSubmit&&b&&c&&"endDate"===k&&a.autoSubmit()}),this.datePicker.setOption("dismiss",function(){a.autoSubmit()}))},bindRoomsGuestsDropdown:function(){var a=this,b,d;b=this.searchForm.closest(".viewport").find(".content");this.roomsGuestsDropdown=this.getChildElement("roomsGuestsDropdown").styleJamDropdownDialog({container:b.length?b:
void 0,expandTo:this.options.phoenixRising?null:this.id("hotelguestsdropdown-trigger-cover"),coverTrigger:this.options.phoenixRising,subtractContainerOffset:this.options.subtractOffsetFromDropdown,onOpen:function(){a.roomsGuestChanged=!1;setTimeout(function(){f(a.rooms).focus()},100);a.getChildElement("roomsGuestsDropdown").attr("aria-expanded","true")},onClose:function(b,c,d){b&&d&&27===d.which&&setTimeout(function(){a.roomsGuestsDropdown.element.focus()},100);a.roomsGuestChanged&&a.options.autoSubmit&&
a.autoSubmit();a.getChildElement("roomsGuestsDropdown").attr("aria-expanded","false")}}).getWidget();this.roomsGuestsDropdown.element.off("keydown").keydown(function(b){if(40===b.which||32===b.which)b.preventDefault(),b.stopPropagation(),a.roomsGuestsDropdown.toggleContent(!0)});c.events.subscribe("hotelsearchform.close.roomsGuestsDropdown",function(){a.roomsGuestsDropdown.close()});this.rooms=h(this.getChildElement("rooms"))({min:1,max:a.options.maxRooms,defaultValue:a.options.defaultRooms,callback:function(){a.updateBoxButtonStates();
a.roomsGuestChanged=!0;c.events.publish("hotels.frontdoor.form.rooms",{id:a.id(),rooms:this.getValue()});a.vsLog("changerooms")}}).getWidget();b=this.rooms.decrButton;this.adults=h(this.getChildElement("adults"))({min:1,max:a.options.maxAdults,defaultValue:a.options.defaultAdults,callback:function(){a.roomsGuestChanged=!0;c.events.publish("hotels.frontdoor.form.guests.adults",{id:a.id(),adults:this.getValue()});a.vsLog("changeguests_adults")}}).getWidget();d=(this.children=h(this.getChildElement("children"))({min:0,
max:a.options.maxChildren,defaultValue:a.options.defaultChildren,callback:function(){a.roomsGuestChanged=!0;c.events.publish("hotels.frontdoor.form.guests.children",{id:a.id(),children:this.getValue()});a.vsLog("changeguests_children")}}).getWidget())&&this.children.incrButton;var e=function(b,c){b&&b.off("keydown").keydown(function(b){9===b.which&&(c?b.shiftKey:!b.shiftKey)&&(b.preventDefault(),b.stopPropagation(),setTimeout(function(){a.roomsGuestsDropdown.element.focus();a.roomsGuestsDropdown.toggleContent(!1)},
100))})};e(b,!0);e(d,!1);this.hotelPlanner=this.getChildElement("hotelPlanner");this.hotelPlanner.on("click",function(){var b=a.serialize();c.events.publish("hotelplanner.open",{location:b.location,startDate:b.checkInDate,endDate:b.checkOutDate})});this.updateBoxButtonStates()},updateBoxButtonStates:function(){var a=this.adults.getValue(),b=this.children.getValue(),d=c.config.getInt("ui.hotels.max.per.room",4);a+b===Math.min(this.options.maxGuests,this.options.maxRooms*d)?(this.adults.disableIncrement(),
this.children.disableIncrement()):(this.adults.enableIncrement(),this.children.enableIncrement())},bindTravelerTypeRadios:function(){if(this.options.isTravelerTypeEnabled&&this.getChildElement("traveler").length){var a=this;this.traveler=this.getChildElement("traveler").radioButtonSet({change:function(b){b="traveler/"+(b.value||"");f.proxy(a.dataChanged,a);a.vsLog(b)}}).getWidget()}},onHookSubmitForIntentMedia:function(a){a&&"function"===typeof a.callOnSubmit&&(this.intentMediaCallOnSubmit=a.callOnSubmit)},
updateFlexOptions:function(a){var b=this.searchFormFilterState.freebies;"y"===a.value?this.searchFormFilterState.freebies=b?b+",freecancellation":"freecancellation":"n"===a.value&&(a=b?b.split(","):[],b=a.indexOf("freecancellation"),-1<b&&a.splice(b,1),0<a.length?this.searchFormFilterState.freebies=a.join(","):delete this.searchFormFilterState.freebies)},onSubmit:function(a){var b=this.base;this.isSubmitted||(this.syncFilters(),this.setYandexTracking(),this.submitIntentMedia(),b.call(this,a),this.options.autoSubmit&&
(this.isSubmitted=!1),this.options.cmp2LoadOnChangesOnly&&this.isValid()&&(this.startingForm=this.serialize()));return!1},isRegionSearch:function(a){return(a.regionId||a.freeRegionId||a.countryId||a.subRegionId)&&(0!==a.regionId||0!==a.freeRegionId||0!==a.countryId||0!==a.subRegionId)},publishSubmitEvent:function(a){a&&a.url&&0<=a.url.indexOf("%s")&&(new c.logger).error("StyleJamHotelSearchForm submit url has invalid %s parameter");this.isRegionSearch(a)&&this.options.isRegionSearchEnabled?window.location.href=
"/"+a.url:this.base(a)},autoSubmit:function(){if(this.checkFormChanges())this.onSubmit()},checkFormChanges:function(){var a=this.serialize();if(a.location&&a.checkInDate&&a.checkOutDate){var b=moment(a.checkInDate,this._dateFormat),a=moment(a.checkOutDate,this._dateFormat);if(0>b.diff(a,"days"))return!0}return!1},hasFormChanged:function(){var a=this.serialize();this.cmp2ChangeOnly=!1;if(a&&this.startingForm){var b=a.location===this.startingForm.location,c=a.checkInDate===this.startingForm.checkInDate,
e=a.checkOutDate===this.startingForm.checkOutDate,k=1!=a.cmp2dirty,f;f=a.adults===this.startingForm.adults&&a.children===this.startingForm.children;this.options.specifyChildAges&&(f=f&&a.childrenAges===this.startingForm.childrenAges);var g=a.rooms===this.startingForm.rooms,a=this.options.priceTypeEnabled&&"undefined"===typeof a.priceType;b&&c&&e&&f&&g&&!a&&!k&&(this.cmp2ChangeOnly=!0);if(b&&c&&e&&f&&g&&k&&!a)return!1;this.preserveFilters=this.options.preserveFiltersOnSearchChange&&b}return!0},onChange:function(a){this.shouldUpdate(a)&&
(this.updateLogging(a),this.load(a),this.saveToStorage(),this.refreshHistory())},registerAndCheckAutoSearch:function(a){var b=this,c=function(a,c){var d=b.searchAutoExecuteChanged.indexOf(a);(c=0===c.length)&&-1!==d?b.searchAutoExecuteChanged.splice(d,0):-1!==d||c||b.searchAutoExecuteChanged.push(a)};a.hasOwnProperty("location")&&(b.searchAutoExecuteChanged=[],c("location",a.location));a.hasOwnProperty("checkInDate")&&c("checkInDate",a.checkInDate);a.hasOwnProperty("checkOutDate")&&!a.actOnStart&&
c("checkOutDate",a.checkOutDate);return this.canExecuteAutoSearch()},canExecuteAutoSearch:function(){return!this.element.hasClass("Advanced")&&this.searchAutoExecuteChanged.length===this.searchAutoExecuteOnChangeCount},isNewCmp2CheckAdded:function(a){var b;if(this.cmp2Items){var c=this.cmp2Items;b=function(a){return a.checked&&!c.some(function(b){return a.id===b.id&&b.checked})}}else b=function(a){return a.checked};this.cmp2Items=a.items;return a.items.some(b)},onInternalChange:function(a){if(this.options.searchAutoExecute&&
this.registerAndCheckAutoSearch(a))this.searchAutoExecuteChanged=[],this.onSubmit();else{for(var b=this.options.searchAutoExecuteAfterCmp2&&this.registerAndCheckAutoSearch(a),c="location checkInDate checkOutDate refreshCmp2sOnOpen rooms adults children childrenAges".split(" "),e=0;e<c.length;e++)if(a.hasOwnProperty(c[e])){this.loadCompareToItems();break}if(!b&&(b={location:"location",checkInDate:"checkin",checkOutDate:"checkout",rooms:"rooms",guests:"guests",adults:"adults",children:"children",traveler:"traveler"},
c=null,a.hasOwnProperty("checkInDate")&&(a.checkInDate!==this.lastCheckInDate&&(c="checkInDate"),this.lastCheckInDate=a.checkInDate),a.hasOwnProperty("checkOutDate")&&(a.checkOutDate!==this.lastCheckOutDate&&(c="checkOutDate"),this.lastCheckOutDate=a.checkOutDate),null===c||this.options.doubleDatesUpdate||delete a["checkOutDate"===c?"checkInDate":"checkOutDate"],!a.silent))for(var f in b)a.hasOwnProperty(f)&&this.submitPreload(b[f])}},onRoomsChange:function(a){a.rooms>this.rooms.options.max?this.rooms.setValue(this.rooms.options.max,
!0):a.rooms<this.rooms.options.min?this.rooms.setValue(this.rooms.options.min,!0):this.rooms.setValue(a.rooms,!0);a=c.config.getInt("ui.hotels.max.per.room",4);var b=this.rooms.getValue(),d=this.adults.getValue(),e=this.children.getValue();d<b&&(d=b);b*a<d+e&&(e=b*a-d,0>e&&(e=0,d=b*a));this.children.setValue(e,!0);this.adults.setValue(d,!0);this.refreshRoomsGuestsDropdownDisplay()},onGuestsFieldChange:function(a){a.guests>this.guests.options.max?this.guests.setValue(this.guests.options.max,!0):a.guests<
this.guests.options.min?this.guests.setValue(this.guests.options.min,!0):this.guests.setValue(a.guests,!0);a=c.config.getInt("ui.hotels.max.per.room",4);var b=this.guests.getValue(),d=this.rooms.getValue();d*a<b?(d=Math.ceil(b/a),this.rooms.setValue(d),this.options.showNumberboxTooltips&&this.showTooltip(this.guests.incrButton,this.options.numberBoxMsg.guestsOverMax.call(this))):d>b?(this.rooms.setValue(b),this.options.showNumberboxTooltips&&this.showTooltip(this.guests.incrButton,this.options.numberBoxMsg.guestsBelowMin.call(this))):
this.options.showNumberboxTooltips&&this.clearTooltips();this.refreshRoomsGuestsDropdownDisplay()},onAdultsFieldChange:function(a){a.adults>this.adults.options.max?this.adults.setValue(this.adults.options.max,!0):a.adults<this.adults.options.min?this.adults.setValue(this.adults.options.min,!0):this.adults.setValue(a.adults,!0);var b=c.config.getInt("ui.hotels.max.per.room",4),d=this.adults.getValue();a=this.children.getValue();var e=this.rooms.getValue(),f=Math.ceil((d+a)/b);f>d&&(f=d);e<f?e=f:e>
d&&(e=d,b=e*b-d,a=b<a?b:a);this.children.setValue(a,!0);this.rooms.setValue(e,!0);this.refreshRoomsGuestsDropdownDisplay()},onChildrenFieldChange:function(a){a.children>this.children.options.max?this.children.setValue(this.children.options.max,!0):a.children<this.children.options.min?this.children.setValue(this.children.options.min,!0):this.children.setValue(a.children,!0);var b=c.config.getInt("ui.hotels.max.per.room",4);a=this.adults.getValue();var d=this.children.getValue(),e=this.rooms.getValue(),
b=Math.ceil((d+a)/b);e<b&&(e=b);e>a&&(a=e);this.adults.setValue(a,!0);this.rooms.setValue(e,!0);this.refreshRoomsGuestsDropdownDisplay()},onGuestsChange:function(a){var b,c;"undefined"!==typeof a.guests?(b=a.guests,c=0):(b=a.adults,c=a.children);if("undefined"!==typeof b)this.onAdultsFieldChange(a);else if("undefined"!==typeof c)this.onChildrenFieldChange(a)},calculateNumNights:function(){var a=1,b,c;this.options.useLegacyDatePicker?(b=moment(this.daterangePicker.getStartDate()),c=moment(this.daterangePicker.getEndDate())):
(b=this.checkOut.getDate(),c=this.checkIn.getDate());null!=b&&null!=c&&(a=b.diff(c,"days",!0));return Math.ceil(a)},calculateDaysOut:function(){var a=0,b;b=this.options.useLegacyDatePicker?moment(this.daterangePicker.getStartDate()):this.checkIn.getDate();null!=b&&(a=moment(moment.now()),a=b.diff(a,"days",!0));return Math.ceil(a)},getExtraFilterData:function(){var a=c.question.ask("hotels.frontdoor.filter.DATA");this.extraFiltersData=a||{};var b={};if(null!=a&&("0"!==a.stars||"-10"!==a.rating||a.price&&
a.price.max!==a.price.min||null!=a.priceType)){if("0"!==a.stars){b.stars={};var d=parseInt(a.stars,10);[0,2,3,4,5].forEach(function(a){b.stars[a]=a>=d?1:0})}if("-10"!==a.rating){b.rating={};var e={horrible:20,mediocre:40,okay:60,good:80,excellent:100},f;for(f in e)if(e.hasOwnProperty(f)){var g=parseInt(a.rating,10);b.rating[f]=g<=e[f]?1:0}}a.price&&a.price.max!==a.price.min&&(b.price={min:parseInt(a.price.min,10),max:parseInt(a.price.max,10)});null!=a.priceType&&(b.priceType={code:a.priceType})}this.advancedFilterState=
b},syncFilters:function(){var a=this;this.getExtraFilterData();this.advancedFilterState&&Object.keys(this.advancedFilterState).forEach(function(b){c.events.publish("resultspage.filters.sync",{name:b,state:a.advancedFilterState[b]})})},toggleStickyPresentation:function(a){this.options.hotelTravelersDropdownEnabled&&c.events.publish("hotels.frontdoor.form.sticky",{namespace:this.id(),isSticky:a});this.options.stickyPresentation&&this.options.stlPresentation?this.swapStickyPresentationBlocks(a):a?this.applyStickyPresentation():
this.removeStickyPresentation()},swapStickyPresentationBlocks:function(a){var b=this.options.dotfStickyEnabled?this.options.dotfStickyPresentation.toLowerCase():this.options.stickyPresentation.toLowerCase();this.swapPresentationBlocksForChildIds(a?b:this.options.stlPresentation.toLowerCase(),{hotelSearchForm__inner:this.innerSearchFormElement,"hotelSearchForm-rising__form":this.searchFormElement,"hotelSearchFormGrid--rising":this.formGrid,"hotelSearchFormGrid--rising__fieldsCol":this.formGridFieldCol,
"hotelSearchFormGrid--rising__buttonCol":this.formGridButtonCol,"hotelSearchFormGrid__fieldsGrid--rising":this.formFieldGrid,"hotelSearchFormGrid__fieldsGrid--rising__locationCol":this.formFieldGridLocationCol,"hotelSearchFormGrid__fieldsGrid--rising__datePickerCol":this.formFieldGridDataPickerCol,hotelSearchFormGrid__collapseFormButton:this.formCollapseBtn,hotelSearchForm__searchButtonText:this.formGridSearchBtnText,hotelSearchForm__searchButtonIcon:this.formGridSearchBtnIcon,"hotelSearchForm__searchIcon--text-and-icon":this.formGridSearchBtnTextWithIcon,
hotelSearchForm__button:this.formGridSearchBtn})},swapPresentationBlocksForChildIds:function(a,b){var c=this,e=Object.keys(b).map(function(a){return{blockName:a,blockClass:c.getStlBlock(a)}});this.options.presentation=a;e.forEach(function(a){var d=b[a.blockName];a.blockName&&d&&d.length&&(a.blockClass&&d.removeClass(a.blockClass),(a=c.getStlBlock(a.blockName))&&d.addClass(a))})},applyStickyPresentation:function(){this.sticked||(this.sticked=!0,c.events.publish("DatePicker.layout.compressed.toggle",
!0),c.dom.swapClasses(this.formRoomsGuestsAbove,c.stylejam.hotels.search.StyleJamHotelSearchForm.formRoomsGuestsAbove,c.stylejam.hotels.search.StyleJamHotelSearchForm.formRoomsGuestsAboveSticky),c.dom.swapClasses(this.formGridButtonCol,c.stylejam.hotels.search.StyleJamHotelSearchForm.formGridButtonCol,c.stylejam.hotels.search.StyleJamHotelSearchForm.formGridButtonColSticky),c.dom.swapClasses(this.formGridSearchBtn,c.stylejam.hotels.search.StyleJamHotelSearchForm.formButton,c.stylejam.hotels.search.StyleJamHotelSearchForm.formButtonSticky),
c.dom.swapClasses(this.formGrid,c.stylejam.hotels.search.StyleJamHotelSearchForm.formGrid,c.stylejam.hotels.search.StyleJamHotelSearchForm.formGridSticky),c.dom.swapClasses(this.formGridFieldCol,c.stylejam.hotels.search.StyleJamHotelSearchForm.formGridFieldsCol,c.stylejam.hotels.search.StyleJamHotelSearchForm.formGridFieldsColSticky),c.dom.swapClasses(this.formFieldGrid,c.stylejam.hotels.search.StyleJamHotelSearchForm.formGridFieldsGrid,c.stylejam.hotels.search.StyleJamHotelSearchForm.formGridFieldsGridSticky),
c.dom.swapClasses(this.formFieldGridDataPickerCol,c.stylejam.hotels.search.StyleJamHotelSearchForm.formGridFieldsGridDataPickerCol,c.stylejam.hotels.search.StyleJamHotelSearchForm.formGridFieldsGridDataPickerColSticky))},removeStickyPresentation:function(){this.sticked&&(this.sticked=!1,c.events.publish("DatePicker.layout.compressed.toggle",!1),c.dom.swapClasses(this.formRoomsGuestsAbove,c.stylejam.hotels.search.StyleJamHotelSearchForm.formRoomsGuestsAboveSticky,c.stylejam.hotels.search.StyleJamHotelSearchForm.formRoomsGuestsAbove),
c.dom.swapClasses(this.formGridButtonCol,c.stylejam.hotels.search.StyleJamHotelSearchForm.formGridButtonColSticky,c.stylejam.hotels.search.StyleJamHotelSearchForm.formGridButtonCol),c.dom.swapClasses(this.formGridSearchBtn,c.stylejam.hotels.search.StyleJamHotelSearchForm.formButtonSticky,c.stylejam.hotels.search.StyleJamHotelSearchForm.formButton),c.dom.swapClasses(this.formGrid,c.stylejam.hotels.search.StyleJamHotelSearchForm.formGridSticky,c.stylejam.hotels.search.StyleJamHotelSearchForm.formGrid),
c.dom.swapClasses(this.formGridFieldCol,c.stylejam.hotels.search.StyleJamHotelSearchForm.formGridFieldsColSticky,c.stylejam.hotels.search.StyleJamHotelSearchForm.formGridFieldsCol),c.dom.swapClasses(this.formFieldGrid,c.stylejam.hotels.search.StyleJamHotelSearchForm.formGridFieldsGridSticky,c.stylejam.hotels.search.StyleJamHotelSearchForm.formGridFieldsGrid),c.dom.swapClasses(this.formFieldGridDataPickerCol,c.stylejam.hotels.search.StyleJamHotelSearchForm.formGridFieldsGridDataPickerColSticky,c.stylejam.hotels.search.StyleJamHotelSearchForm.formGridFieldsGridDataPickerCol))},
stickyShow:function(){c.dom.swapClasses(this.formGridFieldCol,this.options.styles.formGridFieldsCol,this.options.styles.formGridFieldsColSticky);c.dom.swapClasses(this.formGrid,this.options.styles.formGrid,this.options.styles.formGridSticky);c.dom.swapClasses(this.formRoomsGuestsAbove,this.options.styles.formRoomsGuestsAbove,this.options.styles.formRoomsGuestsAboveSticky);c.dom.swapClasses(this.formGridButtonCol,this.options.styles.formGridButtonCol,this.options.styles.formGridButtonColSticky);c.dom.swapClasses(this.formGridSearchBtn,
this.options.styles.formButton,this.options.styles.formButtonSticky)},stickyHide:function(){c.dom.swapClasses(this.formGridFieldCol,this.options.styles.formGridFieldsColSticky,this.options.styles.formGridFieldsCol);c.dom.swapClasses(this.formGrid,this.options.styles.formGridSticky,this.options.styles.formGrid);c.dom.swapClasses(this.formRoomsGuestsAbove,this.options.styles.formRoomsGuestsAboveSticky,this.options.styles.formRoomsGuestsAbove);c.dom.swapClasses(this.formGridButtonCol,this.options.styles.formGridButtonColSticky,
this.options.styles.formGridButtonCol);c.dom.swapClasses(this.formGridSearchBtn,this.options.styles.formButtonSticky,this.options.styles.formButton)},serialize:function(){var a=this.base(),b=moment(this.checkIn.getDate()),d=moment(this.checkOut.getDate()),e=this.checkIn&&!moment(Date.now()).isAfter(b,"day");c&&c.globals&&c.globals.isSeo&&!e&&(b=moment().add(1,"day").format("YYYY-MM-DD"),d=moment().add(2,"day").format("YYYY-MM-DD"),this.checkIn.setDate(b),this.checkOut.setDate(d));this.getExtraFilterData();
this.options.hotelTravelersDropdownEnabled?e=c.question.ask(this.travelersDataQuestion+this.id("form")):(e={adults:this.adults.getValue(),children:this.children.getValue()},f.extend(e,{rooms:this.rooms.getValue()}));this.advancedFilterState&&this.advancedFilterState.hasOwnProperty("priceType")&&this.advancedFilterState.priceType.code&&(a.priceType=this.advancedFilterState.priceType.code);a.goToHotelDetailsPage=this.options.goToHotelDetailsPage&&this.smartyItemChanged;f.extend(a,{locationType:this.locationType,
location:this.location.val(),cityId:this.cityId.val(),landmarkId:this.landmarkId.val(),hotelId:this.hotelId.val(),checkInDate:b.format(this._dateFormat),checkOutDate:d.format(this._dateFormat),freeRegionId:this.freeRegionId.val(),subRegionId:this.subRegionId.val(),amenity:this.amenity,regionId:this.regionId.val(),countryId:this.countryId.val(),neighbourhoodId:this.neighbourhoodId.val(),neighbourhood:this.neighbourhood,ambiance:this.ambiance,searchType:"C",citycode:this.cityId.val(),applyFilters:!0,
filterState:JSON.stringify(this.advancedFilterState),hotelLocationFilterUrl:this.hotelLocationFilterUrl},e);this.hcPlacesEnabled&&f.extend(a,{placeName:this.placeName.val(),placeId:this.placeId.val()});this.locationType!==l.address&&this.hasLocationId()||f.extend(a,{searchType:"A",address:this.location.val()});return a},serializeForCompareTo:function(){var a=this.serialize();delete a.checkInDate;delete a.checkOutDate;a.checkin_date=moment(this.checkIn.getDate()).format(c.globals.apiDateFormat);a.checkout_date=
moment(this.checkOut.getDate()).format(c.globals.apiDateFormat);return a},load:function(a){a.hasOwnProperty("searchDialog")&&a.searchDialog&&this.resetFieldsForSearchDialog();a.locationType&&(this.locationType=a.locationType);a.location&&this.location.val(a.location);a.cityId&&this.cityId.val(a.cityId);a.landmarkId&&this.landmarkId.val(a.landmarkId);a.hotelId&&this.hotelId.val(a.hotelId);a.freeRegionId&&this.freeRegionId.val(a.freeRegionId);a.subRegionId&&this.subRegionId.val(a.subRegionId);a.regionId&&
this.regionId.val(a.regionId);a.countryId&&this.countryId.val(a.countryId);this.hcPlacesEnabled&&(a.entityKey&&this.placeName.val(a.entityKey),a.objectID&&this.placeId.val(a.objectID));a.neighbourhoodId&&this.neighbourhoodId.val(a.neighbourhoodId);if(a.checkInDate){var b=moment(a.checkInDate,this._dateFormat);b.isValid()&&this.checkIn.setDate(b)}a.checkOutDate&&(b=moment(a.checkOutDate,this._dateFormat),b.isValid()&&this.checkOut.setDate(b));a.rooms&&c.events.publish("hotels.frontdoor.rooms.onChange",
f.extend({namespace:this.id()},a));"undefined"===typeof a.guests&&"undefined"===typeof a.adults&&"undefined"===typeof a.children||c.events.publish("hotels.frontdoor.guests.onChange",f.extend({namespace:this.id()},a));this.options.hotelTravelersDropdownEnabled&&this.options.specifyChildAges&&"undefined"!==typeof a.childrenAges&&c.events.publish("hotels.frontdoor.childrenAges.onChange",f.extend({namespace:this.id()},a));a.urlParams&&(this.options.urlParams=a.urlParams);this.hotelLocationFilterUrl=a.hotelLocationFilterUrl?
a.hotelLocationFilterUrl:null;this.options.hotelTravelersDropdownEnabled||(this.refreshRoomsGuestsDropdownDisplay(),this.updateBoxButtonStates());a.skipSemEvent||c.events.publish("notify.sem.datepicker",{startDate:moment(a.checkInDate,this._dateFormat),endDate:moment(a.checkOutDate,this._dateFormat)})},resetFieldsForSearchDialog:function(){this.options.keepLocation||(this.locationType="",this.location.val(""),this.cityId.val(""),this.landmarkId.val(""),this.hotelId.val(""));this.freeRegionId.val("");
this.subRegionId.val("");this.regionId.val("");this.countryId.val("");this.neighbourhoodId.val("")},getCookieData:function(){var a=this.base();this.options.isDisabledAdvanced||(this.extraFiltersData.price&&(a.filterMinPrice=this.extraFiltersData.price.min,a.filterMaxPrice=this.extraFiltersData.price.max),a.filterPriceType=this.extraFiltersData.priceType,a.filterMinStars=this.extraFiltersData.stars,a.filterMinGuestRating=this.extraFiltersData.rating);return a},loadFromHistory:function(a){this.options.useLocalStorageHistory&&
this.base(a);a=this.localHistory.reduceTravelersObjectToTotal();if(0<a){var b;b=this.options.hotelTravelersDropdownEnabled?c.question.ask("hotel-rooms-selected"):this.rooms.getValue();this.load({guests:a,rooms:Math.min(Math.max(b||0,Math.ceil(a/4)),a)})}},getStorageProps:function(){return"checkInDate checkOutDate location locationType cityId landmarkId hotelId rooms guests searchType".split(" ")},mapSearchUrlData:function(a){var b={urlPrefix:c.config.getString("ui.hotels.searchUrlPath","hotels").replace(/\//g,
""),location:a.location,ctid:a.cityId,frid:a.freeRegionId,srid:a.subRegionId,rid:a.regionId,cid:a.countryId,hid:a.hotelId,lmid:a.landmarkId,nhid:a.neighbourhoodId,adults:a.adults,children:a.children,childAges:a.childrenAges,guests:a.guests,rooms:a.rooms,checkin:a.checkInDate,checkout:a.checkOutDate,address:a.address,amenity:a.amenity,minStars:a.minStars,view:c.question.ask("hotels.resultspage.pageView"),useFullSearchUrl:c.globals&&c.globals.useFullSearchUrl,goToHotelDetailsPage:this.options.goToHotelDetailsPage,
smartyItemChanged:this.smartyItemChanged};this.options.addHtcPlaceParams&&(b.placeName=a.placeName,b.placeId=a.placeId);return b},buildSearchURL:function(a){if(this.options.useLegacySearchUrl)return this.legacyBuildSearchUrl(a);c.storage.remove("hotels.results.saveToTrips.tripId");return c.hotels.search.HotelSearchFormUrls.generateUrl(this.mapSearchUrlData(a),this.getSearchFormFilterState())},getSearchFormFilterState:function(){return f.extend({},this.searchFormFilterState)},legacyBuildSearchUrl:function(a){c.storage.remove("hotels.results.saveToTrips.tripId");
var b=[this.options.actionUrl],d=a.location,e=[],k="-c%s";this.options.isRegionSearchEnabled&&this.isRegionSearch(a)&&b.push("region");var h=a.address||"";g(h)||(d=h,-1===h.indexOf(a.location)&&(d+=","+a.location),k="-a%s");e.push(c.utils.search.encodeLocation(d));g(a.freeRegionId)?g(a.regionId)?g(a.subRegionId)?g(a.countryId)?g(a.cityId)||e.push(k.format(a.cityId)):e.push("-u%s".format(a.countryId)):e.push("-s%s".format(a.subRegionId)):e.push("-r%s".format(a.regionId)):e.push("-e%s".format(a.freeRegionId));
g(a.hotelId)?g(a.landmarkId)?g(a.neighbourhoodId)||e.push("-n%s".format(a.neighbourhoodId)):e.push("-l%s".format(a.landmarkId)):(e.push("-h%s".format(a.hotelId)),this.options.goToHotelDetailsPage&&this.smartyItemChanged&&e.push("-details"));g(a.amenity)||e.push("-f%s".format(a.amenity));b.push(e.join(""));g(a.checkInDate)||g(a.checkOutDate)||(b.push(a.checkInDate),b.push(a.checkOutDate));1<a.guests&&b.push("%sguests".format(a.guests));a.adults&&b.push("%sadults".format(a.adults));a.children&&(this.options.specifyChildAges&&
this.options.hotelTravelersDropdownEnabled&&a.childrenAges?b.push("%schildren-%s".format(a.children,a.childrenAges)):b.push("%schildren".format(a.children)));1<a.rooms&&b.push("%srooms".format(a.rooms));b=b.join("/");d={};g(a.neighbourhood)?g(a.ambiance)||(d=f.extend(d,{ambiance:a.ambiance,filterType:"A"})):d=f.extend(d,{neighborhood:a.neighbourhood,filterType:"N"});if(!g(this.options.urlParams))try{d=f.extend(d,JSON.parse(this.options.urlParams))}catch(p){}f.isEmptyObject(d)&&f.isEmptyObject(a.urlParams)||
(b+="?");f.isEmptyObject(d)||(b+=f.param(d));g(a.urlParams)||(b+=a.urlParams);this.hotelLocationFilterUrl&&(-1===b.indexOf("?")&&(b+="?"),b+=this.hotelLocationFilterUrl);!this.options.addHtcPlaceParams||g(a.placeName)&&g(a.placeId)||(b+=-1===b.indexOf("?")?"?":"\x26",b+=this.addPlaceParams(a.placeId,a.placeName));return b},addPlaceParams:function(a,b){var c="";g(a)||(c+="placeId\x3d"+a);g(b)||(c+=(g(a)?"":"\x26")+"placeName\x3d"+this.htmlEscape(b));return c},htmlEscape:function(a){var b={"\x26":"\x26amp;",
"\x3c":"\x26lt;","\x3e":"\x26gt;",'"':"\x26quot;","'":"\x26#39;",":":"%3A"};return a.replace(/[&<>"':]/g,function(a){return b[a]})},submitPreload:function(a){if(c.config.getBoolean("ui.submitpreload")&&!this.loadingHistory){var b=this.serialize()||{};b.changed_field=a;b["rooms-input"]=b.rooms;b["guests-input"]=b.guests;b.checkin_date=moment(b.checkInDate,this._dateFormat).format(c.globals.apiDateFormat);b.checkout_date=moment(b.checkOutDate,this._dateFormat).format(c.globals.apiDateFormat);c.action.execute("common.search.PreloadAction",
b)}},validate:function(){var a=this.checkIn.getDate(),b=this.checkOut.getDate();if(!this.options.isSingleHotel&&!this.hasLocationId()&&!this.location.val())return this.options.msg.city;if(null===a)return this.options.msg.checkinDate;if(null===b||a.isAfter(b.subtract(1,"day")))return this.options.msg.checkoutDate;if(g(this.location.val()))return this.options.msg.location},isEnoughInformationForCompareToRequest:function(){if(this.options.cmp2LoadOnChangesOnly&&!this.hasFormChanged()||this.options.loadCmp2WhenVisible&&
!this.element.is(":visible"))return!1;var a=this.hasLocationId()||!g(this.locationType);return!this.options.suppressCmp2s&&a&&void 0===this.validate()},setYandexTracking:function(){if(window.yaCounter16685854)try{window.yaCounter16685854.reachGoal("Hotel_Search_Button_Click")}catch(a){return 0}return 1},toggleAdvanced:function(a){this.shouldUpdate(a)&&(this.options.showNeedIdeasButton&&(!0===a.state?this.needIdeasButton.addClass("hidden"):this.needIdeasButton.removeClass("hidden")),this.element.toggleClass("Advanced",
a.state))},refreshRoomsGuestsDropdownDisplay:function(){var a=c.Common.Utils.String.formatChoice(this.options.msg.roomsChoiceLabel,this.rooms.getValue(),this.rooms.getValue()),b=this.adults.getValue()+this.children.getValue(),b=c.Common.Utils.String.formatChoice(this.options.msg.guestsChoiceLabel,b,b);this.roomsGuestsDropdown.updateLabel(a,b,", ");this.updateHotelPlanner(this.rooms.getValue())},getCompareToFormData:function(){var a=this.serializeForCompareTo();return f.extend({vertical:this.vertical},
a)},submitIntentMedia:function(){"function"===typeof this.intentMediaCallOnSubmit&&this.intentMediaCallOnSubmit.call(null,this.serialize())},updateHotelPlanner:function(a){0<this.options.hotelPlannerTrigger&&(a>=this.options.hotelPlannerTrigger?(this.hotelPlanner.addClass("visible"),f(this.element).is(".Hotels-Search-StyleJamHotelSearchForm")&&c.dom.swapClasses(this.hotelPlanner,c.stylejam.hotels.search.StyleJamRoomsGuestsDropdown.hotelPlannerHidden,c.stylejam.hotels.search.StyleJamRoomsGuestsDropdown.hotelPlannerVisible)):
(this.hotelPlanner.removeClass("visible"),f(this.element).is(".Hotels-Search-StyleJamHotelSearchForm")&&c.dom.swapClasses(this.hotelPlanner,c.stylejam.hotels.search.StyleJamRoomsGuestsDropdown.hotelPlannerVisible,c.stylejam.hotels.search.StyleJamRoomsGuestsDropdown.hotelPlannerHidden)))},showTooltip:function(a,b){a.toolTip({content:b,position:"right",showImmediately:!0})},clearTooltips:function(){this.rooms.incrButton.data("toolTip")&&this.rooms.incrButton.data("toolTip").removeWidget();this.guests&&
this.guests.incrButton.data("toolTip")&&this.guests.incrButton.data("toolTip").removeWidget();this.children&&this.children.incrButton.data("toolTip")&&this.children.incrButton.data("toolTip").removeWidget();this.adults&&this.adults.incrButton.data("toolTip")&&this.adults.incrButton.data("toolTip").removeWidget()},needIdeas:function(){var a=f(".destinationTiles");f("html, body").animate({scrollTop:a.offset().top-10},1200);c.Analytics.api.trackEvent("hotels/form/needidesbutton")},autofocus:function(){this.options.autofocusDestination&&
this.location.focus()},getStorageExceptions:function(){},isValidDates:function(){if(this.checkIn&&0===this.checkIn.getValue()){var a=1,b=2;c&&c.config&&(a=c.config.getInt("ui.horizon.hotels.search.form.checkIn.date.adjustment",a),b=c.config.getInt("ui.horizon.hotels.search.form.checkOut.date.adjustment",b));a=moment().startOf("day").add(a,"d");b=moment().startOf("day").add(b,"d");b={id:this.id(),checkInDate:a,checkOutDate:b,silent:!0};c.events.publish("hotels.frontdoor.form.dates",b)}},hasLocationId:function(){return[this.hotelId,
this.cityId,this.neighbourhoodId,this.regionId,this.freeRegionId,this.subRegionId,this.landmarkId,this.countryId].some(function(a){return null!==a&&!g(a.val?a.val():a)})},focusFirstElement:function(){this.location.get(0).focus()}})})(window.R9,window.jQuery);(function(c,e,f){c.publish("common.utils.history.UserHistory",f.extend({constructor:function(a){this.options=e.extend({},this.options,a);this.init()},pageTab:"other",wasLastUsedPage:!1,searchHistoryLimit:3,options:{defaultCookiExpire:10,defaultSearchExpire:100,persistLocalStorage:!0,onSave:e.noop},_storageTemplate:{sticky:{origin:"",destination:"",guests:"",depart_date:"",return_date:"",travelersObject:""},lastUsedTab:"",canary:4},_storageKey:"BKHISTORY2",hasSearchHistory:!1,searchHistoryMoreRecent:!1,
_loadStorageInstance:function(){var a=this._storageTemplate.canary,b=c.storage.get(this._storageKey);c.common.utils.history.UserHistory.storageSync=b&&b.canary&&b.canary===a?b:e.extend(!0,{},this._storageTemplate)},getStorage:function(){c.common.utils.history.UserHistory.storageSync||(c.common.utils.history.UserHistory.storageSync=e.extend(!0,{},this._storageTemplate));return c.common.utils.history.UserHistory.storageSync},initStorageInstance:function(){var a=this.getStorage();a[this.pageTab]||(a[this.pageTab]=
{searches:[],last_updated:null},c.storage.set(this._storageKey,a))},_createExpirationTimestamp:function(a){return moment().add(a||0,"hours").toDate()},init:function(){this.dirty=!1;this.pageTab=this.options.tab||this.pageTab;this._loadStorageInstance();this.initStorageInstance();this.getStorage().lastUsedTab===this.pageTab&&(this.wasLastUsedPage=!0);this.evictExpiredSearches();var a=this.getStorage()[this.pageTab];a&&a.searches&&0<a.searches.length&&(this.hasSearchHistory=!0,a.last_updated&&a.searches[0]&&
1>moment(a.last_updated).diff(a.searches[0].createdAt)&&(this.searchHistoryMoreRecent=!0));var b=this;e(window).bind("beforeunload",function(){try{b.save()}catch(d){}})},save:function(){if(this.dirty)try{this.options.onSave.call(this),this.dirty&&this.options.persistLocalStorage&&(this.dirty=!1,this.getStorage().lastUsedTab=this.pageTab,this.getStorage().common=this.common,c.storage.set(this._storageKey,this.getStorage()))}catch(a){return!1}return!0},get:function(a){if(this.getStorage()[this.pageTab])return this.getStorage()[this.pageTab][a]},
set:function(a,b){var d=this.getStorage()[this.pageTab];d&&d[a]!==b&&(this.dirty=!0,d.last_updated=this._createExpirationTimestamp(),d[a]=b);clearTimeout(this._saveTimeout);this._saveTimeout=setTimeout(e.proxy(this,"save"),100)},reduceTravelersObjectToTotal:function(){var a=0;if(this.getStorage().sticky){var b=this.getStorage().sticky.travelersObject;b&&(a+=parseInt(b.adults),a+=parseInt(b.youth),a+=parseInt(b.children),a+=parseInt(b.infants),a+=parseInt(b.lapinfants),a+=parseInt(b.seniors))}return a},
getRecentHistory:function(){var a=this.getStorage()[this.pageTab],b=this.hasSearchHistory&&this.searchHistoryMoreRecent&&a&&a.searches?a.searches[0]:null;if(!b&&a&&(!a.last_updated||moment().diff(a.last_updated,"hours")<this.options.defaultSearchExpire)){var b={},d;for(d in a)a.hasOwnProperty(d)&&(b[d]=this.get(d));delete b.last_updated;delete b.searches}return b},evictExpiredSearches:function(){var a=this.getStorage(),b=a[this.pageTab]?a[this.pageTab].searches:null,d=this;b&&0!==b.length&&(b.length>
this.searchHistoryLimit&&a[this.pageTab].searches&&(b=b.slice(0,this.searchHistoryLimit)),a[this.pageTab].searches=b.filter(function(a){return!d._shouldExpire(a.expiresBy)}))},pushSearchHistory:function(a){var b=this.getStorage();b[this.pageTab]&&b[this.pageTab].searches&&(a.expiresBy=this._createExpirationTimestamp(this.options.defaultSearchExpire),a.createdAt=this._createExpirationTimestamp(),b[this.pageTab].searches.splice(0,0,a),this.dirty=!0);this.save()},_shouldExpire:function(a){return 0<moment().diff(moment(a))},
purge:function(){c.storage.remove(this._storageKey);c.common.utils.history.UserHistory.storageSync=null;this.initStorageInstance();this.options.persistLocalStorage=!1},pushHotelInteractHistoryItem:function(a,b,d){var c=this.getStorage()[this.pageTab];c&&(this.dirty=!0,c.last_updated=this._createExpirationTimestamp(),c[a]?(c[a]=c[a].filter(function(a){return a.hotelId!==b.hotelId}),c[a].length>=d&&c[a].pop()):c[a]=[],c[a].push(b),this.save())}}))})(R9,jQuery,base2.Base);(function(e){R9.createComponentClass("common.frontdoor.HeroPhotoCover",{options:{backgroundImagePaths:[],lowerQualBackgroundImagePath:"",maskImagePath:"",carouselInterval:8E3},addEventHandlers:function(){this.bindImageLoad.call(this,"img2",this.options.maskImagePath);this.bindImageLoad.call(this,"img1",this.options.lowerQualBackgroundImagePath,"bgSvg");0<this.options.backgroundImagePaths.length&&this.bindImageLoad.call(this,"img3",this.options.backgroundImagePaths[0].imagePath,"circleSvg");1<this.options.backgroundImagePaths.length&&
this.loopCarouselImages()},bindImageLoad:function(a,b,c){0<b.length&&(a=e("#"+a),c?a.one("load",function(){e("."+c).show()}).attr("src",b):a.attr("src",b))},loopCarouselImages:function(){var a=this,b=this.getChildElement("js-images").children(),c=this.getChildElement("js-texts").children(),f=this.options.backgroundImagePaths.length,d=0;setInterval(function(){a.swapClasses(e(b[d]),"CoverWrapper__layout__circleImgLayer__svgWrap__image--active","CoverWrapper__layout__circleImgLayer__svgWrap__image");
a.swapClasses(e(c[d]),"CoverWrapper__layout__circleImgLayer__text__paragraph--active","CoverWrapper__layout__circleImgLayer__text__paragraph");d++;d>=f&&(d=0);a.swapClasses(e(b[d]),"CoverWrapper__layout__circleImgLayer__svgWrap__image","CoverWrapper__layout__circleImgLayer__svgWrap__image--active");a.swapClasses(e(c[d]),"CoverWrapper__layout__circleImgLayer__text__paragraph","CoverWrapper__layout__circleImgLayer__text__paragraph--active")},a.options.carouselInterval)},swapClasses:function(a,b,c){a.removeClass(b);
a.addClass(c)}})})(jQuery);(function(b,c){b.createComponentClass("common.frontdoor.FrontDoorAdDisplay",{columns:{left:null,middle:null,right:null},init:function(){this.columns.left=this.getChildElement("left");this.columns.middle=this.getChildElement("middle");this.columns.right=this.getChildElement("right")},addEventHandlers:function(){this.subscribe("fd.ad.display.left",this.adLoadedCallback.bind(this,"left"));this.subscribe("fd.ad.display.middle",this.adLoadedCallback.bind(this,"middle"));this.subscribe("fd.ad.display.right",
this.adLoadedCallback.bind(this,"right"))},adLoadedCallback:function(a,b){(a=this.columns[a])&&a.length&&(b.isEmpty?a.addClass("col-hidden"):a.removeClass("col-hidden"))}})})(R9,jQuery);(function(a,c){a.createComponentClass("common.personalization.CovidExploreGrid",{options:{},init:function(){a.Analytics.api.trackEvent({subPageId:"personalization",category:"covidExplore",action:"shown"})},addEventHandlers:function(){this.registerEvent("click",this.element.find(".clickSection"),function(b){b=c(b.currentTarget).data("title");a.Analytics.api.trackEvent({subPageId:"personalization",category:"covidExplore",action:"click",label:b})})}})})(R9,jQuery);(function(a){a.createComponentClass("common.personalization.SearchHistory",{init:function(){},addEventHandlers:function(){this.subscribe("searchHistory.tileClicked",function(){a.Analytics.api.trackEvent({subPageId:"personalization",category:"searchHistory",action:"itemClicked"})})}})})(R9);(function(a){var c=a.config.getBoolean("ui.horizon.personalization.ajaxLoader.combine",!1);a.createComponentClass("common.personalization.AjaxLoader",{options:{action:"",params:{}},inlineComponentsReady:function(){var b=this;a.ajax.execute(this.options.action,{appendTo:this.element,replaceContainer:!0,combinable:c,data:this.options.params}).then(function(a){a.id||b.element.remove()}).fail(function(){b.element.remove()})}})})(R9);(function(b,c){b.createComponentClass("common.seo.LazyImage",{options:{isBackgroundImage:!1},placeholder:void 0,image:void 0,observer:void 0,init:function(){this.placeholder=this.getChildElement("placeholder");this.image=this.getChildElement("image")},addEventHandlers:function(){b.config.getBoolean("ui.horizon.common.momondo.lazyload.pagelevel.enabled",!1)||("IntersectionObserver"in window?this.initIntersectionObserver():this.preloadImage())},initIntersectionObserver:function(){var a=this;this.observer=
new IntersectionObserver(function(b,c){b.forEach(function(b){0<b.intersectionRatio&&(c.unobserve(b.target),a.preloadImage())})});this.observer.observe(c(this.element)[0])},preloadImage:function(){if(this.options.isBackgroundImage)this.element.css("background-image","url("+this.checkWebpFeature(this.element.data("src"))+")"),this.element.fadeTo("slow",1),this.placeholder.remove();else{var a=this;this.image.attr("src",this.checkWebpFeature(this.image.data("src")));this.image.attr("srcset",this.image.data("srcset"));
c(this.image).on("load",function(){a.placeholder.remove();a.image.fadeTo("slow",1)})}},checkWebpFeature:function(a){return"undefined"!==typeof seoR9&&seoR9.webpSupport?(a+=-1!==a.indexOf("?")?"\x26":"?",a+"outputtype\x3dwebp"):a}})})(R9,jQuery);(function(a,b){a.createComponentClass("common.frontdoor.brands.momondo.brandonly.DestinationsSection",{linksCards:void 0,moduleName:void 0,options:{type:void 0,vertical:void 0},init:function(){this.options.type&&this.options.vertical&&(this.linksCards=this.element.find(".js-link-card-with-image"),this.moduleName="trending-"+this.options.vertical+"-"+this.options.type.toLowerCase())},addEventHandlers:function(){this.linksCards&&this.linksCards.length&&this.linksCards.click(function(){a.VestigoActions.click(this.moduleName+
"-link-click")}.bind(this))},inlineComponentsReady:function(){this.moduleName&&a.VestigoActions.log("render",this.moduleName)}})})(R9,jQuery||window.jQuery);(function(b,c){b.createComponentClass("common.seo.ExpandableContent",{collapsedClassName:"ExpandableContent--collapsed",expandedClassName:"ExpandableContent--expanded",container:void 0,chevronButton:void 0,content:void 0,init:function(){this.container=this.element.find(".js-container");this.chevronButton=this.element.find(".js-chevron");this.content=this.element.find(".js-content")},addEventHandlers:function(){this.chevronButton.click(this.handleExpand.bind(this))},handleExpand:function(){var a=this.container.hasClass(this.expandedClassName);
b.dom.swapClassesToggle(this.container,this.collapsedClassName,this.expandedClassName,a);this.chevronButton.attr("aria-expanded",a?"false":"true");this.content.attr("aria-hidden",a?"true":"false");b.events.publish("ExpandableContent.expanded",{id:this.id(),expanded:!a})}})})(R9,jQuery);(function(d,e){d.createComponentClass("seo.common.destinationtiles.SeoLinksContainer",{collapsedClassName:"ExpandableContent--collapsed",expandedClassName:"ExpandableContent--expanded",init:function(){this.subscribe("ExpandableContent.expanded",function(b){d.Analytics.api.trackEvent({category:"seolinks",subPageId:"destinationTile",action:"toggle"});if(b.expanded){var c=this.element.find("#"+b.id);c.length&&(c=c.parent().parent(".js-column"),c.length&&Array.from(c.find(".js-container")).map(function(a){a=
e(a);a.parent().length&&a.parent()[0].id!==b.id&&a.hasClass(this.expandedClassName)&&(d.dom.swapClassesToggle(a,this.collapsedClassName,this.expandedClassName,!0),a.find(".js-chevron").attr("aria-expanded",!1),a.find(".js-content").attr("aria-hidden",!0))}.bind(this)))}}.bind(this))},addEventHandlers:function(){this.element.on("click",".js-title-link, .js-link",function(b){d.Analytics.api.trackEvent({category:"seocitylink",subPageId:"destinationTile",action:"click",label:e(b.currentTarget).data("type")})})}})})(R9,
jQuery);(function(c,d){c.createComponentClass("common.frontdoor.FrontDoorContent",{init:function(){this.element.find("img").unveil(500,function(){d(this).on("load",function(){this.style.opacity=1})}).trigger("unveil")},addEventHandlers:function(d){var a=this;c.events.subscribe("frontdoor.vertical.changed",function(b){b.vertical===a.vertical?a.show():a.hide()});c.events.subscribe(["frontdoor.view.changed","fdcontent.view.setview"],function(b){"inline"===b.view||"hidden"===b.view?a.hide():a.show()})},show:function(){this.element.removeClass("hidden")},
hide:function(){this.element.addClass("hidden")}})})(R9,jQuery);(function(a){a.createComponentClass("common.frontdoor.HarmonizedFrontDoorContent",{options:{outlineParams:{dataTag:""}},init:function(){},addEventHandlers:function(){this.subscribe("authentication.state.changed",this.reload.bind(this))},reload:function(){var b=this.element.find("["+this.options.outlineParams.dataTag+"]");b.length&&a.ajax.execute("common/personalization/OutlineFrontDoorContent",{method:"GET",data:this.options.outlineParams,allowRobots:!1,highPriority:!0,appendTo:b,replaceContainer:!0,
customUpdate:function(){a.ComponentManager.remove(b,!1);return!1}})}})})(R9);(function(b,c){b.createComponentClass("common.authentication.GoogleOneTap",{options:{googleClientId:"",handleReload:!1,autoSignIn:!1,isDevEnvironment:!1,showNativeCredentialManager:!1,useAuthContainer:!1,isLoggedIn:!1,showYoloEmailSubscriptionPopUp:!1,userEmail:void 0,cancelOnTapOutside:!1},disabled:!1,init:function(){this.disabled=this.options.isDevEnvironment&&0>window.location.host.indexOf("localhost")||this.options.isLoggedIn;this.options.showYoloEmailSubscriptionPopUp?this.setupEmailSubscription():
this.disabled||c.getScript("https://accounts.google.com/gsi/client").then(window.setTimeout(this.onGoogleLibraryLoad.bind(this),2500))},addEventHandlers:function(){this.disabled||this.subscribe("authentication.showLogin",this.hidePrompt.bind(this))},setupEmailSubscription:function(){return b.ajax.execute("common/authentication/GoogleYoloEmailSubscription",{data:{email:this.options.userEmail},appendTo:c("body")}).then(function(){window.deleteMetaCookie("showYoloEmailSubscriptionPopUp");b.storage.set("yolo-subscription-hide",
!0)})},setEmailSubscriptionState:function(a){return 0!==a.status||b.storage.get("yolo-subscription-hide")?a:c.ajax({type:"GET",url:"/a/api/subscription/",headers:{"X-CSRF":b.globals.formtoken}}).then(function(b){b.subscriptions&&0===b.subscriptions.length&&window.setMetaCookie("showYoloEmailSubscriptionPopUp",!0);return a}).catch(this.log.error.bind(this,"Error setting Google One Tap email subscription state")).then(function(){return a})},onGoogleLibraryLoad:function(){if(window.google){var a={client_id:this.options.googleClientId,
auto_select:this.options.autoSignIn,callback:this.handleCredentialResponse.bind(this),cancel_on_tap_outside:this.options.cancelOnTapOutside},d=this.options.useAuthContainer?b.question.ask("header.auth.thirdPartyContainerId"):null;d&&(a.prompt_parent_id=d);this.options.showNativeCredentialManager&&(a.native_callback=this.handleNativeCredential.bind(this));window.google.accounts.id.initialize(a);window.google.accounts.id.prompt(this.onNotification.bind(this))}else this.track("load-failed")},handleCredentialResponse:function(a){b.authentication.external.googleOneTap.login(a).then(this.setEmailSubscriptionState.bind(this)).then(this.onAuthComplete.bind(this)).catch(this.log.error.bind(this,
"Error handling Google One Tap credential response"))},handleNativeCredential:function(a){b.Social.WebCredentials.postPasswordLoginForm(a).then(this.setEmailSubscriptionState.bind(this)).then(this.onAuthComplete.bind(this)).catch(this.log.error.bind(this,"Error handling Google One Tap native credential response"))},onNotification:function(a){a.isDisplayed()?this.track("show"):a.isNotDisplayed()?this.track("not-displayed",a.getNotDisplayedReason()):a.isSkippedMoment()?this.track("skip",a.getSkippedReason()):
a.isDismissedMoment()&&this.track("dismiss",a.getDismissedReason())},hidePrompt:function(){try{window.google.accounts.id.cancel()}catch(a){}},onAuthComplete:function(a){-1===a.status?this.handleError(a.message):this.handleSuccess()},handleSuccess:function(){var a="FD"===b.question.ask("SearchPage.view");this.options.handleReload||!a?setTimeout(function(){window.location.reload()},300):b.authentication.setAuthenticationStatus(!0)},handleError:function(a){a?b.events.publish("error.alert",{messages:a}):
this.log.error("Google One Tap login failed without a user-facing error")},track:function(a,d,c){b.Analytics.api.trackEvent({category:"googleOneTap",action:a,label:d,value:c})}})})(R9,jQuery);(function(a,c){a.createComponentClass("base.frontdoor.FrontDoor",{options:{vertical:null},init:function(a){},addEventHandlers:function(c){var d=this;a.events.subscribe("frontdoor.view.changed",function(b){d.element.toggleClass("InlineView","inline"===b.view);a.events.publish("frontdoor.setview",b.view)})}})})(R9,jq||jQuery);(function(a,b){a.createComponentClass("hotels.frontdoor.HotelFrontDoor","base.frontdoor.FrontDoor",{inlineComponentsReady:function(){a.events.publish("hotels.frontdoor.init")},addEventHandlers:function(){this.base()}})})(R9,jQuery);(function(c,h,g){c.publish("common.kn.Mixin",g.extend({loadGPT:function(){if(!c.common.kn.Mixin.loadedGPT&&c.config&&c.config.getBoolean("ui.gpt.loadOnce",!0)||!window.googletag){c.common.kn.Mixin.loadedGPT=1;window.googletag||(window.googletag={cmd:[]});var a=document.createElement("script");a.async=!0;a.type="text/javascript";a.src="//www.googletagservices.com/tag/js/gpt.js";var f=document.getElementsByTagName("script")[0];f.parentNode.insertBefore(a,f)}window.googletag.cmd=window.googletag.cmd||
[]},loadAdsense:function(){window._googCsa||function(a,f,d,b,e,c){a[b]=a[b]||function(){(a[b].q=a[b].q||[]).push(arguments)};a[b].t=1*new Date;e=f.createElement(d);c=f.getElementsByTagName(d)[0];e.async=1;e.src="//www.google.com/adsense/search/async-ads.js";c.parentNode.insertBefore(e,c)}(window,document,"script","_googCsa")},findAdDataForType:function(a,c,d){if(!(d&&a&&c&&d[a]))return null;var b,e;for(e in d[a])if(d[a].hasOwnProperty(e)){b=d[a][e];if("string"===typeof b)try{b=JSON.parse(b)}catch(k){b=
null}if(b&&b.pageLocation&&b.pageLocation===c)return b}return null}}))})(R9,jQuery,window.base2.Base);(function(g,f){g.createComponentClass("common.kn.DisplaySra",{options:{slots:null,slotKeyDelim:"",slotsLoadedTimerMS:400,deferGPTLoad:!1,deferUserInteractMS:3E3,eventsEnable:null,eventsDisable:null,lazyLoad:!1,lazyFetch:-999,lazyRender:-999,renderIfNotEmpty:!1,checkRegisteredSlotMatch:!0,altAdBlockedContent:!1,dataSharingOptOut:!1},enabled:1,delayedGptApiCt:0,hasSlots:0,pendingSlotInfo:null,registeredSlots:null,definedSlots:null,allSlotsRegistered:null,allSlotsRegisteredTimerID:null,allSlotsLoaded:null,
boundSlotRenderedListener:null,boundWindowSmartAdResize:null,pageTargetingLast:null,dfpHideData:null,adBlocked:null,useSlotGroups:!1,intersectionObserver:null,observingSlots:null,waitingSlotGroups:null,init:function(){this.pendingSlotInfo=[];this.registeredSlots={};this.definedSlots={};this.hasSlots=f.isArray(this.options.slots)&&this.options.slots.length},addEventHandlers:function(){this.hasSlots&&(this.subscribe("displayad.sra.register",this.onSraSlotRegisterEvent.bind(this)),this.subscribe("displayad.sra.unregisterAll",
this.unregisterAllSlots.bind(this)),this.subscribe("displayad.sra.destroy",this.onSraSlotDestroyEvent.bind(this)),this.subscribe("displayad.sra.slots.broadcast",this.onSraSlotsBroadcast.bind(this)),this.subscribe("resultspage.adinfo.empty",this.publishAllAdsRequests.bind(this)),this.subscribe("resultspage.ads.update",this.onResultsPageAdsUpdate.bind(this)),this.subscribe("resultspage.ads.options",this.onResultsPageAdsPoll.bind(this)),this.subscribe("adblock.detected",this.onAdBlockDetected.bind(this)),
this.options.eventsEnable&&this.options.eventsEnable.pop&&this.options.eventsEnable.length&&(this.enabled=0,this.subscribe(this.options.eventsEnable,this.onSraEnable.bind(this))),this.options.eventsDisable&&this.options.eventsDisable.pop&&this.options.eventsDisable.length&&this.subscribe(this.options.eventsDisable,this.onSraDisable.bind(this)))},inlineComponentsReady:function(){if(this.hasSlots){g.events.publish("displayad.sra.slots.broadcast",{owner:this,slots:[].concat(this.options.slots)});var a=
this,b=g.question.ask("adblock.detected");if(b&&b.adblock)this.onAdBlockDetected();else this.options.deferGPTLoad?g.events.when("ajaxComponent.highPriority.initialized",function(){a.loadGPT()}):this.loadGPT()}},destroy:function(){f(window).off(this.getWindowMessageEventName());this.boundWindowSmartAdResize&&this.boundWindowSmartAdResize===window.resizeIframeToContents&&(window.resizeIframeToContents=null);this.boundWindowSmartAdResize=null;this.base();this.cleanupSlots()},loadGPT:function(){this.loadedGPT||
(this.loadedGPT=1,(new g.common.kn.Mixin).loadGPT())},onSraSlotDestroyEvent:function(a){if(a&&a.adDivId){var b=this;this.pendingSlotInfo=this.pendingSlotInfo.filter(function(b){return b&&b.adDivId!==a.adDivId});Object.keys(this.registeredSlots).forEach(function(c){c&&b.registeredSlots[c]&&b.registeredSlots[c].adDivId===a.adDivId&&delete b.registeredSlots[c]});this.destroyDefinedSlot(a.adDivId)}},destroyDefinedSlot:function(a){if(window.googletag){var b=this;googletag.cmd.push(function(){b.definedSlots&&
b.definedSlots[a]&&(b.intersectionObserver&&b.intersectionObserver.unobserve(document.getElementById(a)),b.observingSlots&&b.observingSlots.hasOwnProperty(a)&&delete b.observingSlots[a],googletag.destroySlots([b.definedSlots[a]]),delete b.definedSlots[a])})}},onSraSlotsBroadcast:function(a){a&&this!==a.owner&&f.isArray(a.slots)&&(this.options.slots=this.options.slots.filter(function(b){return 0>a.slots.indexOf(b)}),1>this.options.slots.length&&(this.hasSlots=0,this.cleanupSlots(),this.registeredSlots=
{},this.pendingSlotInfo=[],this.enabled=this.allSlotsRegistered=0))},onSraEnable:function(){this.enabled||(this.enabled=1,this.checkLoadSlots())},onSraDisable:function(){this.enabled&&(this.enabled=0,this.cleanupSlots())},setupPrivacyProcessing:function(){this.options.dataSharingOptOut&&googletag.pubads().setPrivacySettings({restrictDataProcessing:!0})},handleMissingOrigin:function(a){this.loggedMissingParams||(this.loggedMissingParams=1,a&&this.logError("Ad params without origin"))},onSraSlotRegisterEvent:function(a){a&&
a.adDivId?a.adBlockOptions?(this.augmentPageOptions(a),a.adBlockOptions.origin?this.updateSlotDataAndLoad(a):this.handleMissingOrigin(a.gptAdID)):a.isAvoidResults?this.logError("No ad targeting for non-results ad"):(this.pendingSlotInfo.push(a),this.publishOneAdsRequest(a)):this.logError("Missing adOptions ID")},publishAllAdsRequests:function(){var a=[];this.pendingSlotInfo&&this.pendingSlotInfo.length&&(a=this.pendingSlotInfo.filter(function(a){return a&&!a.isAvoidResults}));a=a.concat(Object.values(this.registeredSlots).map(function(a){return a&&
!a.isAvoidResults?a:null}));a.forEach(this.publishOneAdsRequest.bind(this))},publishOneAdsRequest:function(a){a&&!a.isAvoidResults&&g.events.publish("ads.request",{adType:"displayAd",pageLocation:a.pageLocation,now:!a.gptAdID,events:["searchform.submit","resultsHeader.changed","filters.changed","paginator.change"],minRefreshRate:this.options.minRefreshRate})},onResultsPageAdsUpdate:function(a){if(this.enabled){var b=this,c=new g.common.kn.Mixin,d=function(a,c){Object.keys({gptAdID:null,gptTargetID:null,
gptAdWidth:null,gptAdHeight:null,gptAdSizes:null,gptPageURL:null,adBlockOptions:null,pageOptions:null,slotGroup:0}).forEach(function(b){c.hasOwnProperty(b)&&"undefined"!==typeof c[b]&&(a[b]=c[b])});b.augmentPageOptions(a);return a};this.pendingSlotInfo&&this.pendingSlotInfo.length&&this.pendingSlotInfo.forEach(function(e){if(e){var h=c.findAdDataForType("displayAd",e.pageLocation,a);h&&h.adBlockOptions&&h.adBlockOptions.origin&&b.hasSlots&&0<=b.options.slots.indexOf(b.makeSlotKey(h))&&b.updateSlotDataAndLoad(d(e,
h))}});this.pendingSlotInfo.length&&(this.pendingSlotInfo=this.pendingSlotInfo.filter(function(a){return!Object.values(b.registeredSlots).some(function(b){return!b||a.adDivId===b.adDivId})}));this.pendingSlotInfo.length&&f.isEmptyObject(this.registeredSlots)&&this.pendingSlotInfo.some(function(a){return a&&!a.isAvoidResults})&&this.hasSlots?this.publishAllAdsRequests():Object.values(this.registeredSlots).forEach(function(e){var h=c.findAdDataForType("displayAd",e.pageLocation,a);h&&b.updateSlotDataAndLoad(d(e,
h))})}},makeSlotKey:function(a){var b=this.getAdSizes(a);return b[0][0]+"x"+b[0][1]+this.options.slotKeyDelim+a.pageLocation+this.options.slotKeyDelim+a.adBlockOptions.origin},updateSlotDataAndLoad:function(a){var b=this;if(a&&a.adBlockOptions&&a.adDivId&&(a=f.extend({slotKey:this.makeSlotKey(a),adSize:this.getAdSizes(a),adDivId:a.adDivId,smartAd:null},a),a.slotKey&&this.hasSlots&&!(0>this.options.slots.indexOf(a.slotKey)))){var c=this.registeredSlots[a.slotKey];c&&c.adDivId!==a.adDivId&&this.definedSlots&&
this.definedSlots[c.adDivId]&&this.destroyDefinedSlot(c.adDivId);this.registeredSlots[a.slotKey]=f.extend({},a);!this.allSlotsRegistered&&0<this.options.slotsLoadedTimerMS&&(clearTimeout(this.allSlotsRegisteredTimerID),this.allSlotsRegisteredTimerID=setTimeout(function(){var a=g.question.ask("adblock.detected");a&&a.adblock||b.setAllSlotsRegistered()},this.options.slotsLoadedTimerMS));this.checkLoadSlots()}},onSlotRenderedEvent:function(a){this.enabled&&(g.events.publish("displayad.loaded",{slotElementId:a.slot.getSlotElementId()}),
!0===this.options.renderIfNotEmpty&&!1===a.isEmpty&&f("#"+a.slot.getSlotElementId()).show())},checkLoadSlots:function(){if(this.enabled&&this.hasSlots){if(this.options.checkRegisteredSlotMatch)for(var a,b=0;b<this.options.slots.length;b++){if((a=this.options.slots[b])&&!this.registeredSlots[a])return}else if(!this.registeredSlots||f.isEmptyObject(this.registeredSlots))return;this.setAllSlotsRegistered()}},unregisterAllSlots:function(){this.registeredSlots={};this.pendingSlotInfo=[];this.allSlotsRegistered=
0;clearTimeout(this.allSlotsRegisteredTimerID)},setAllSlotsRegistered:function(){this.allSlotsRegistered=1;clearTimeout(this.allSlotsRegisteredTimerID);this.loadAllSlots()},loadAllSlots:function(a){if(this.enabled){var b=this.adBlocked&&this.options.altAdBlockedContent;this.adBlocked&&!b?this.replaceAllAdBlockedSlots():window.googletag&&(window.googletag.apiReady||b)?a?(this.setupAllSlots(),this.allSlotsLoaded=1):this.deferUserInteractID?this.handleDelayedSlotLoad():this.handleDelayedSlotLoad(null,
1):this.handleDelayedSlotLoad(1)}},handleDelayedSlotLoad:function(a,b){var c=this,d=b;this.delayedSlotLoadID&&clearTimeout(this.delayedSlotLoadID);this.delayedSlotLoadID=setTimeout(function(){if(a&&(c.delayedGptApiCt+=1,100<=c.delayedGptApiCt)){var b=g.question.ask("adblock.detected"),h=c.options.altAdBlockedContent;100!==c.delayedGptApiCt||h||b&&b.adblock||g.Analytics.api.trackEvent({category:"sra",action:"error",label:"gptapi"});if(h)d=!0;else return}c.loadAllSlots(d)},200)},onResultsPageAdsPoll:function(){if(this.options.deferUserInteractMS&&
!f.isEmptyObject(this.definedSlots)){var a=this;this.deferUserInteractID&&clearTimeout(this.deferUserInteractID);this.deferUserInteractID=setTimeout(function(){a.deferUserInteractID=null},this.options.deferUserInteractMS)}},compareSlotOrder:function(a,b){a=parseInt(a&&a.adBlockOptions&&a.adBlockOptions.tile);b=parseInt(b&&b.adBlockOptions&&b.adBlockOptions.tile);return isNaN(a)?isNaN(b)?0:1:isNaN(b)?-1:a-b},setupAllSlots:function(){var a=this,b,c=Object.values(this.registeredSlots);g.config.getBoolean("ui.ads.orderSlots")&&
(c=c.sort(this.compareSlotOrder));c.forEach(function(c){!c||a.pageTargetingLast&&a.sameObjectProperties(a.pageTargetingLast,c.pageOptions,["tile"])||(a.pageTargetingLast=f.extend({},c.pageOptions),b=c)});this.pageTargetingLast?"function"!==typeof googletag.pubads?this.logError("Bad googletag pubads"):(this.setWindowEvents(),googletag.cmd.push(function(){b&&a.setupPageTargeting(b);a.boundSlotRenderedListener||(a.boundSlotRenderedListener=a.onSlotRenderedEvent.bind(a),googletag.pubads().addEventListener("slotRenderEnded",
a.boundSlotRenderedListener));c.forEach(function(b){b&&a.setupSlot(b);a.allSlotsLoaded&&f("#"+b.adDivId).show()});a.allSlotsLoaded?a.useSlotGroups?(a.waitingSlotGroups=!0,a.refreshSlotGroups()):googletag.pubads().refresh():(a.useSlotGroups&&googletag.pubads().disableInitialLoad(),googletag.enableServices(),Object.keys(a.definedSlots).forEach(function(a){a&&googletag.display(a)}),a.useSlotGroups&&(a.waitingSlotGroups=!0,a.refreshSlotGroups()))})):this.errPageOptions||(this.errPageOptions=1,this.logError("Missing slot data page options"))},
refreshSlotGroups:function(){var a=this,b=this.observingSlots,c,d,e;this.waitingSlotGroups&&(f.isEmptyObject(b)?this.waitingSlotGroups=this.waitingSlotGroups||!0:(c=Object.values(this.registeredSlots).filter(function(a){return a&&b[a.adDivId]}).map(function(a){return a.slotGroup||-1}).filter(function(b,c,d){return d.indexOf(b)===c&&(!0===a.waitingSlotGroups||0<=a.waitingSlotGroups.indexOf(b))}),c.length&&(d=[],c.forEach(function(b){d=d.concat(Object.values(a.registeredSlots).filter(function(a){return-1===
b?!a.slotGroup:a.slotGroup===b}).map(function(b){return a.definedSlots[b.adDivId]}))}),e=Object.values(this.registeredSlots).filter(function(a){return 0>c.indexOf(a.slotGroup||-1)}).map(function(a){return a.slotGroup||-1}).filter(function(a,b,c){return c.indexOf(a)===b}),e.length?!0===this.waitingSlotGroups?this.waitingSlotGroups=e:(this.waitingSlotGroups=this.waitingSlotGroups.filter(function(a){return 0<=e.indexOf(a)}),this.waitingSlotGroups.length||(this.waitingSlotGroups=!1)):this.waitingSlotGroups=
!1,d.length&&googletag.cmd.push(function(){googletag.pubads().refresh(d)}))))},onObserverEvent:function(a){var b=this;this.observingSlots&&a&&a.forEach(function(a){a&&a.target&&a.target.id&&(b.observingSlots[a.target.id]=a.isIntersecting)});this.refreshSlotGroups()},setupSlotGroupObserver:function(a){if(!(a.slotGroup&&"IntersectionObserver"in window))return!1;var b=document.getElementById(a.adDivId);if(!b)return!1;this.intersectionObserver||(this.intersectionObserver=new IntersectionObserver(this.onObserverEvent.bind(this),
{root:null,threshold:.1}),this.observingSlots={});this.observingSlots.hasOwnProperty(a.adDivId)||(this.observingSlots[a.adDivId]=!1,this.intersectionObserver.observe(b));return!0},augmentPageOptions:function(a){a&&a.pageOptions&&("undefined"===typeof a.pageOptions.xp&&(a.pageOptions.xp=g.globals.experiment),a.isAvoidResults&&"undefined"===typeof a.pageOptions.host&&(a.pageOptions.host="http://"+window.location.hostname))},setupPageTargeting:function(a){var b=window.googletag;b.pubads().clearTargeting();
b.pubads().enableSingleRequest();this.options.gptIframeTitle&&b.setAdIframeTitle(this.options.gptIframeTitle);this.options.isForceSafeFrame&&(this.options.altAdBlockedContent&&this.adBlocked?b.pubads().setForceSafeFrame(!1):b.pubads().setForceSafeFrame(!0));this.setupPrivacyProcessing();if(this.options.lazyLoad){var c={};!isNaN(this.options.lazyFetch)&&-1<=this.options.lazyFetch&&(c.fetchMarginPercent=this.options.lazyFetch);!isNaN(this.options.lazyRender)&&-1<=this.options.lazyRender&&(c.renderMarginPercent=
this.options.lazyRender);b.pubads().enableLazyLoad(c)}a.gptPageURL&&b.pubads().set("page_url",a.gptPageURL);b.pubads().collapseEmptyDivs();Object.keys(a.pageOptions).forEach(function(c){c&&b.pubads().setTargeting(c,a.pageOptions[c])})},setupSlot:function(a){if(a&&a.adDivId&&a.adBlockOptions){var b=this.definedSlots[a.adDivId],c;b||(c=1,b=googletag.defineSlot(a.gptTargetID,a.adSize,a.adDivId));b?(this.setupSlotGroupObserver(a)&&(this.useSlotGroups=!0),b.clearTargeting(),Object.keys(a.adBlockOptions).forEach(function(c){c&&
b.setTargeting(c,a.adBlockOptions[c])}),c&&(b.addService(googletag.pubads()),this.definedSlots[a.adDivId]=b)):this.errSlotDefine||(this.errSlotDefine=1,this.logError("defineSlot failed"))}else this.errSlotOptions||(this.errSlotOptions=1,this.logError("Missing slot ID or data ad options"))},cleanupSlots:function(){this.boundSlotRenderedListener=this.pageTargetingLast=null;this.intersectionObserver&&(this.intersectionObserver.disconnect(),this.intersectionObserver=null,this.useSlotGroups=!1,this.waitingSlotGroups=
this.observingSlots=null);if(window.googletag&&googletag.cmd){var a=this;googletag.cmd.push(function(){var b=[];Object.keys(a.definedSlots).forEach(function(c){b.push(a.definedSlots[c]);delete a.definedSlots[c]});b.length&&googletag.destroySlots(b);a.definedSlots={};a.allSlotsLoaded=0})}},onAdBlockDetected:function(){this.adBlocked||(this.adBlocked=1,this.replaceAllAdBlockedSlots())},replaceAllAdBlockedSlots:function(){if(this.enabled&&!this.options.altAdBlockedContent){var a=this;Object.values(this.registeredSlots).forEach(function(b){a.replaceAdBlockedContent(b)})}},
replaceAdBlockedContent:function(a){var b,c=" width\x3d'%s' height\x3d'%s' ",d=a&&a.adDivId?f("#"+a.adDivId):null;a&&a.adBlockedURL&&a.gptAdID&&d?(b=this.getAdSizes(a),c=f.isArray(b)?b[0]&&f.isArray(b[0])?c.format(b[0][0],b[0][1]):c.format(b[0],b[1]):c.format(a.gptAdWidth,a.gptAdHeight),d.html("\x3ciframe class\x3d'had-frame' frameborder\x3d'0' "+c+" scrolling\x3d'no' src\x3d'"+a.adBlockedURL+"'\x3e\x3c/iframe\x3e")):d&&d.hide()},setWindowEvents:function(){var a=this,b=this.getWindowMessageEventName(),
c;this.dfpHideData={};Object.values(this.registeredSlots).forEach(function(b){b&&b.adBlockOptions&&b.adBlockOptions.pos&&b.adBlockOptions.origin&&(c=b.adBlockOptions.origin.match(/\w+\.\w*\.(\w+)\./))&&1<c.length&&c[1]&&(a.dfpHideData[c[1]+"."+b.adBlockOptions.pos+".NoAd"]=f.extend({},b))});f(window).off(b).on(b,this.onWindowMessage.bind(this))},getWindowMessageEventName:function(){return"message.displayad-"+this.id()},onWindowMessage:function(a){var b,c,d;this.enabled&&a&&a.originalEvent&&((c=this.options.smartAdWinMessageHosts||
"")&&(c=c.replace(/(http(s)?:)?\/\//g,window.location.protocol+"//")),c+=","+window.location.protocol+"//"+window.location.host,this.dfpHideData&&a.originalEvent.data&&this.dfpHideData[a.originalEvent.data]?(c=this.dfpHideData[a.originalEvent.data])&&c.adDivId&&(f("#"+c.adDivId).hide(),g.config.getBoolean("ui.horizon.ads.trackCollapse",!0)&&g.Analytics.api.trackEvent({category:"sra",action:"adcollapse",label:c.pageLocation})):a.originalEvent.origin&&0<=c.indexOf(a.originalEvent.origin)&&this.options.smartAdWinMessageID&&
a.originalEvent.data[this.options.smartAdWinMessageID]&&((d=a.originalEvent.data[this.options.smartAdWinMessageID].pos)?(b=this,Object.values(this.registeredSlots).forEach(function(c){c.adBlockOptions&&d===c.adBlockOptions.pos&&b.kickoffSmartAd(a.originalEvent.data[b.options.smartAdWinMessageID],c)})):this.logError("No pos for smartad data: "+d)))},kickoffSmartAd:function(a,b){if(g.config.getBoolean("ui.horizon.ads.loadSmartAd",!0)&&a&&b&&b.adDivId&&(a.searchid||(a.searchid=this.options&&this.options.pageOptions?
this.options.pageOptions.searchid:null),a.provider_code&&a.searchid)){var c=this.getSmartAdURL(a);if(c){this.boundWindowSmartAdResize||(this.boundWindowSmartAdResize=this.onSmartAdGlobalResize.bind(this),window.resizeIframeToContents=this.boundWindowSmartAdResize);window.R9.Ads=window.R9.Ads||{};window.R9.Ads.SmartAd=window.R9.Ads.SmartAd||{slots:{R0:{},R1:{},M0:{}},adjustBannerContainerSize:f.noop()};var d="",e=b.adBlockOptions&&b.adBlockOptions.origin;"string"===typeof a.sz&&(d=(d=a.sz.split("x"))&&
2===d.length&&parseInt(d[0])&&parseInt(d[1])?" width\x3d'"+d[0]+"' height\x3d'"+d[1]+"' ":"");b.smartAd=f.extend({rank:b.gptAdID?b.gptAdID.substr(b.gptAdID.length-1,1):null,origin:e&&1<e.length?e.substr(e.length-2,2):null,reloaded:0,sized:0},a);this.subscriptions&&this.subscriptions["search.poll.response"]||this.subscribe("search.poll.response",this.onSmartAdSearchPoll.bind(this));f("#"+b.adDivId).html("\x3ciframe class\x3d'smartad-frame' frameborder\x3d'0' "+d+" scrolling\x3d'no' src\x3d'"+c+"'\x3e\x3c/iframe\x3e")}else g.Analytics.api.trackEvent({category:"smartad",
action:"urlfail",label:b.pageLocation})}},onSmartAdSearchPoll:function(a){if(a&&a.completed){this.unsubscribe("search.poll.response");var b=this;Object.values(this.registeredSlots).forEach(function(a){a&&a.smartAd&&!a.smartAd.reloaded&&(a.smartAd.reloaded=1,a.smartAd.sized=0,setTimeout(function(){a.smartAd&&f("#"+a.adDivId).find(".smartad-frame").attr("src",b.getSmartAdURL(a.smartAd,"false")+"\x26reload\x3d1")},100))})}},onSmartAdGlobalResize:function(){var a=this;Object.values(this.registeredSlots).forEach(function(b){a.resizeSmartAd(b)})},
resizeSmartAd:function(a){if(a&&a.adDivId&&a.smartAd&&!a.smartAd.sized){var b=f("#"+a.adDivId),c=b.find("iframe.smartad-frame").first(),d,e,h;if(c.length){try{d=c.contents().find("body")}catch(k){return}a.smartAd.sized=1;a=c.outerWidth();e=c.outerHeight();h=d.outerWidth();d=d.outerHeight();2>h||2>d?b.hide():(a!==h&&c.attr("width",h),e!==d&&c.attr("height",d),b.outerWidth()!==h&&(b.width("auto"),b.css("max-width","none")),b.outerHeight()!==d&&(b.height("auto"),b.css("max-height","none")))}}},getSmartAdURL:function(a,
b){if(!a)return null;"true"!==b&&"false"!==b&&(b="true");var c=a.rank||0,d=a.origin||"R0",e=a.provider_code?encodeURIComponent(a.provider_code):"",f=a.click_tracking?encodeURIComponent(a.click_tracking):"",g=a.sz?encodeURIComponent(a.sz):"";return"/h/ads/smartad?provider_code\x3d"+e+"\x26searchid\x3d"+a.searchid+"\x26clicktracking\x3d"+f+"\x26sz\x3d"+g+"\x26rank\x3d"+c+"\x26logimpr\x3d"+b+"\x26strm\x3d\x26pageorigin_location\x3d"+d+"\x26isstreaming\x3d"},getAdSizes:function(a){var b;a.gptAdSizes&&
(b=this.validateAdSizes(a.gptAdSizes));return b||this.validateAdSizes([parseInt(a.gptAdWidth),parseInt(a.gptAdHeight)])},validateAdSizes:function(a){var b=function(a){return!isNaN(a)&&0<a&&9999>a&&a===parseInt(a,10)},c=function(a){return a&&a.pop&&2===a.length&&b(a[0])&&b(a[1])};if(!a||!a.pop)return null;if(c(a))return a;for(var d=0;d<a.length;d++)if(!c(a[d]))return null;return a},sameObjectProperties:function(a,b,c){if(!a||!b)return!1;var d;c=c||[];for(d in a)if(a.hasOwnProperty(d)&&!b.hasOwnProperty(d))return!1;
for(d in b)if(b.hasOwnProperty(d)){if(!a.hasOwnProperty(d))return!1;if(!(0<=c.indexOf(d))&&a[d]!==b[d]){var e=a[d];if(e=e!==e)e=b[d],e=e!==e;if(!e)return!1}}return!0},logError:function(a){g.config.getBoolean("ui.ads.sra.log",!0)&&this.log.error(a)}})})(window.R9,window.jQuery);(function(a){a.createComponentClass("common.layout.SiteWideMessage",$.extend({},a.Common.RedirectMessage.prototype,{redirectMessage:void 0,options:{redirectFromTo:void 0,redirectFromToAlt:void 0,upgradeBrowserEnabled:!1},upgradeId:void 0,init:function(){var a=this;this.upgradeId=this.id("upgrade");this.containerId=this.id();this.redirectFromTo=this.options.redirectFromTo;this.redirectFromToAlt=this.options.redirectFromToAlt;this.updateRedirectUrl();this.bindRedirectAdt();this.answer("languageBar.height",
function(){return a.element.outerHeight(!0)})},addEventHandlers:function(){this.subscribe("frontdoor.view.changed",this.updateRedirectUrl.bind(this));null!==document.getElementById(this.upgradeId)&&a.ajax.execute("common/upgrade/UpgradeBrowser",{appendTo:this.upgradeId});this.registerEvent("click",this.element.find(".js-close"),function(){$(this).closest(".js-msgContainer").slideUp("slow");var a=$(this).attr("data-mc");setMetaCookie(a,!0)})}}))})(R9);function ConsentHandler(c){this.consentExpires=c&&0<=c.consentExpires?c.consentExpires:15552E6;this.declinedExpires=6048E5;this.CONSENT_NAME="DATA_CONSENT"}ConsentHandler.prototype.setConsentToCookie=function(c,d){d="undefined"===typeof d?!0:d;var a=new Date;a.setTime(a.getTime()+this.consentExpires);document.cookie=this.CONSENT_NAME+"\x3d"+d+";path\x3d/;expires\x3d"+a;c&&c({dataConsent:d})};
ConsentHandler.prototype.setDeclinedConsentCookie=function(c){var d=new Date;d.setTime(d.getTime()+this.declinedExpires);document.cookie=this.CONSENT_NAME+"\x3dfalse;path\x3d/;expires\x3d"+d;c&&c({dataConsent:!1})};ConsentHandler.prototype.getConsentFromCookie=function(){if(document.cookie){var c=this.CONSENT_NAME+"\x3dtrue";return document.cookie.split(";").some(function(d){return d&&d.trim&&d.trim()===c})}return!1};
ConsentHandler.prototype.getConsentCookieValue=function(){var c=this;if(document.cookie){var d=document.cookie.split(";").filter(function(a){return a&&a.trim&&0===a.trim().indexOf(c.CONSENT_NAME)});if(d.length)return"true"===d[0].trim().split("\x3d")[1]?!0:!1}return null};
(function(c,d){c.createComponentClass("common.tags.DataLayer",{ENDUSER_CONSENT_NAME:"DATA_ENDUSER_CONSENT",SHARING_CONSENT_NAME:"consent",consented:!1,ready:!1,consentHandler:null,consentEvents:null,gtmSourceSetup:!1,gtm:null,queue:null,options:{useStandardizedConsent:!1,useConsentSetup:!1,consentExpires:0,noConsentDefersLoad:!1},affiliateDataLayerSchema:{common:"presentation placement locale vertical screenId eventName event currency dataConsent dataSharingOptOut kmkid".split(" "),clickOut:["eventName",
"startDate","endDate","price"],expandDetails:["eventName","screenId","price"],flight:{results:"startDate endDate originAirportCode originCityName originCountryCode destinationAirportCode destinationCityName destinationCountryCode cabinClass roundTrip tripType totalTravelers adultTravelers youthTravelers childTravelers seatInfantTravelers lapInfantTravelers legs".split(" "),clickOut:"originAirportCode originCityName originCountryCode destinationAirportCode destinationCityName destinationCountryCode roundTrip tripType totalTravelers seniorTravelers adultTravelers youthTravelers childTravelers seatInfantTravelers lapInfantTravelers airlineName cabinClass legs".split(" ")},
hotel:{results:"rooms guests cityName countryCode hotelName adultTravelers childTravelers startDate endDate".split(" "),details:"hotelName starRating rooms guests cityName countryCode startDate endDate".split(" "),clickOut:"hotelName starRating rooms guests cityName countryCode startDate endDate".split(" ")},car:{results:"pickupTime dropoffTime sameLocation pickupAirportCode pickupCityName pickupCountryCode dropoffAirportCode dropoffCityName dropoffCountryCode".split(" "),clickOut:["carClass"]},packagetour:{results:"originAirportCode originCityName originCountryCode destinationAirportCode destinationCityName destinationCountryCode totalTravelers seniorTravelers adultTravelers youthTravelers childTravelers infantTravelers".split(" "),
clickOut:"originCityId originRegionName originRegionCode destinationCityId destinationRegionName destinationRegionCode hotelId brandName brandId parentBrandId".split(" ")},unknown:{}},init:function(a){c.globals.analytics.gtmDisabled||(this.queue=[],this.options.useStandardizedConsent||(this.options.useConsentSetup?(this.consentHandler=new ConsentHandler({consentExpires:this.options.consentExpires}),this.consented=this.consentHandler.getConsentFromCookie()):this.consented=!0),this.consentEvents=c.config.getString("ui.horizon.cookie.consent.events",
"").split(","),this.gtm=d(a)[0],d(this.gtm).on("load",d.proxy(this.onLoadIFrame,this)))},inlineComponentsReady:function(){c.globals.analytics.gtmDisabled||(!this.getConsent()&&this.options.noConsentDefersLoad||this.loadGtm(),c.question.ask("tags.dataLayer.hasCustomHandler")||this.updateDataLayer(this.getMainLayerParams()))},addEventHandlers:function(){if("undefined"!==typeof window.R9&&c.globals&&c.globals.analytics&&!0!==c.globals.analytics.gtmDisabled){var a=this;this.options.useStandardizedConsent?
this.subscribe(["gdpr.cookie.declined"].concat(this.consentEvents),this.onConsentChange.bind(this)):this.options.useConsentSetup&&(this.subscribe(this.consentEvents,this.consentSuccess.bind(this)),this.subscribe("gdpr.cookie.declined",this.declinedConsent.bind(this)));this.subscribe("sharing.cookie.update",this.sharingConsentUpdate.bind(this));c.events.subscribe("frontdoor.view.changed",function(){if(a.ready)try{var b=a.gtm.contentWindow;b.history&&b.history.replaceState&&b.history.replaceState("",
document.title,location.href);b.document.title=document.title}catch(l){}});this.subscribe("tags.dataLayer.push",function(b){b=b||{};b.attachMainParams&&(b=d.extend(a.getMainLayerParams(),b));b.hasOwnProperty("dataConsent")||(b.dataConsent=a.getConsent());delete b.attachMainParams;b.affiliateGoogleTagManagerId&&""!==b.affiliateGoogleTagManagerId&&(b.dataConsent=a.getEndUserConsentFromCookie(),b=a.getAffiliateDataLayer(b));c.config.getBoolean("ui.gtm.force.datalayer.presentation",!0)&&(b.presentation=
a.options.apPresentation);a.updateDataLayer(b)});this.subscribe("gtm.enduser.consent",function(b){b&&(a.setEndUserConsentCookie(),a.loadGtm())});this.options.useStandardizedConsent||c.question.answer("horizon.cookie.consent.value",function(){return a.consentHandler.getConsentCookieValue()})}},onLoadIFrame:function(){setTimeout(this.processQueue.bind(this),1)},processQueue:function(){this.ready=!0;for(var a=0;a<this.queue.length;a++)this.queue[a]&&this.updateDataLayer(this.queue[a])},cleanUndefinedVars:function(a){d.each(a,
function(b,c){""!==c&&null!==c||delete a[b]})},updateDataLayer:function(a){a&&!a.hasOwnProperty("dataConsent")&&(a.dataConsent=this.getConsent());if(this.ready)try{this.log.console("updating data layer",a);var b=this.gtm.contentWindow;b.unifiedDataLayer||(b.unifiedDataLayer=[]);this.cleanUndefinedVars(a);b.unifiedDataLayer.push(a)}catch(l){}else this.queue.push(a)},onConsentChange:function(){this.updateDataLayer({dataConsent:this.getConsent()});this.loadGtm()},consentSuccess:function(){var a=this;
!this.consented&&this.consentHandler&&this.consentHandler.setConsentToCookie(function(b){a.consented=!0;a.updateDataLayer(b);a.loadGtm()})},declinedConsent:function(){var a=this;this.consentHandler&&this.consentHandler.setDeclinedConsentCookie(function(b){a.consented=!1;a.updateDataLayer(b);a.loadGtm()},!1)},sharingConsentUpdate:function(){this.updateDataLayer({dataSharingOptOut:this.getDataSharingOptOutFromCookieValue()});this.loadGtm()},isIframe:function(){try{return window.self!==window.top}catch(a){return!0}},
getDataSharingOptOutFromCookieValue:function(){if(document.cookie){var a=("; "+document.cookie).split("; "+this.SHARING_CONSENT_NAME+"\x3d");if(2===a.length)return 1===a.pop().split(";").shift()}return!1},getEndUserConsentFromCookie:function(){if(document.cookie){var a=this.ENDUSER_CONSENT_NAME+"\x3dtrue";return document.cookie.split(";").some(function(b){return b&&b.trim&&b.trim()===a})}return!1},setEndUserConsentCookie:function(){var a=new Date,b=0<=this.options.consentExpires?this.options.consentExpires:
15552E6;a.setTime(a.getTime()+b);document.cookie=this.ENDUSER_CONSENT_NAME+"\x3dtrue;path\x3d/;expires\x3d"+a},isEndUserConsent:function(){var a=this.getEndUserConsentFromCookie(),b=window;if(!a){var c=b.setInterval(function(){"parentIFrame"in b&&(b.clearInterval(c),c=null,b.parentIFrame.sendMessage({action:"getGTMEndUserConsent"}))},500);b.setTimeout(function(){c&&b.clearInterval(c)},15E3)}return a},loadGtm:function(){if(!this.gtmSourceSetup){this.gtmSourceSetup=!0;var a=window.location,b="",c="",
d=this.options.affiliateGTMEndUserConsentFeature,e=this.options.affiliateGoogleTagManagerId;if(e&&(b=-1<a.search.indexOf("?")?"\x26":"?",c="gtmid\x3d"+e,d&&this.isIframe()&&!this.isEndUserConsent())){this.gtmSourceSetup=!1;return}a="/ugtm{pathname}{search}{hash}{sign}{gtmid}".replace("{pathname}",a.pathname).replace("{search}",a.search).replace("{hash}",a.hash).replace("{sign}",b).replace("{gtmid}",c);this.gtm.src=a}},cloneDataLayer:function(a,b){var c={};a.forEach(function(a){b.hasOwnProperty(a)&&
(c[a]=b[a])});return c},getAffiliateDataLayer:function(a){var b=c.globals.analytics||{},d=b.screenId||b.pageId||"unknown",f=b.vertical||"unknown",b=a.eventName||"screenView",e=this.affiliateDataLayerSchema,h=e.common||[],k="undefined"!==typeof e[f],d=k?e[f][d]:[],g={};k&&(h=h.concat(d),g=this.cloneDataLayer(h,a),a.hasOwnProperty("presentation")&&(g.presentation=this.options.apPresentation),"clickOut"===b&&(f=e[b].concat(e[f][b]),g=this.cloneDataLayer(f,a)),"expandDetails"===b&&(g=this.cloneDataLayer(e[b],
a)));return g},getMainLayerParams:function(){var a=c.globals.analytics||{},b=d.extend({},this.options,{vertical:a.vertical||"unknown",screenId:a.screenId||a.pageId||"unknown",subScreenId:a.subScreenId||a.subPageId,eventName:this.options.eventName||"screenView",dataConsent:this.getConsent(),placement:c.globals.placement||"",presentation:this.options.apPresentation});["apPresentation","useConsentSetup","consentExpires","noConsentDefersLoad"].forEach(function(a){delete b[a]});return b},getConsent:function(){if(this.options.useStandardizedConsent)try{return window["@r9/gdpr"].hasConsented()}catch(a){return this.log.error("GDPR not available in DataLayer",
a),!1}else if(this.options.useConsentSetup)return this.consentHandler.getConsentFromCookie();return!0}})})(R9,jQuery);(function(a,c){a.createComponentClass("common.privacy.StyleJamHeaderCookiesMessage",{options:{gdprEnabled:!1,ajaxComponent:"common/privacy/AjaxStyleJamHeaderCookiesMessage"},init:function(){var b=this.options.ajaxComponent||"common/privacy/AjaxStyleJamHeaderCookiesMessage",d={type:"GET",replace:!0,combinable:a.config.getBoolean("ui.horizon.common.header.cookieMessage.combinable",!1),cacheable:a.config.getBoolean("ui.horizon.common.header.cookieMessage.cacheable",!1)};if(this.options.gdprEnabled){var e=
window["@r9/gdpr"];e&&e.canShowConsentDialog()&&(b=a.config.getString("ui.horizon.common.gdpr.cookie.consent.dialog.url","common/gdpr/CookieConsentV2"),d={type:"GET",appendTo:c("body")})}this.toggleCookiesMessageLoading(!0);a.ajax.execute(b,d).always(this.toggleCookiesMessageLoading.bind(this,!1))},toggleCookiesMessageLoading:function(b){a.globals.testMode&&(b?c("body").attr("data-test-cookie-message-loading",""):c("body").removeAttr("data-test-cookie-message-loading"))}})})(window.R9,window.jQuery);(function(b,a){b.createComponentClass("common.currency.StyleJamCurrencyMessage",{options:{displayLater:!1,displayImmediately:!1,cookieName:"hideCurrencyMessage"},isVisible:!1,closeBtn:void 0,init:function(b){this.closeBtn=a("#"+this.id("close"));this.options.displayImmediately?this.showMessage():this.options.displayLater&&(this.subscribe("resultspage.view.setvisible",a.proxy(this.showMessage,this)),this.subscribe("header.view.set",{view:"results"},a.proxy(this.showMessage,this)),this.subscribe("pageContainers.changed",
{state:"results"},a.proxy(this.showMessage,this)),this.subscribe("resultspage.routed",a.proxy(this.showMessage,this)))},addEventHandlers:function(){this.closeBtn.bind("click",a.proxy(this.close,this))},showMessage:function(){this.isVisible||(this.element.slideDown("slow"),window.setMetaCookie(this.options.cookieName,!0),this.isVisible=!0)},close:function(){this.element.slideUp("slow")}})})(window.R9,window.jQuery);(function(c){R9.extend("Widgets",{Checkbox:function(a,b){this.elementNode=a;this.element=c(this.elementNode);this.icon=c(R9.Widgets.Checkbox.findIconNode(this.elementNode));this.validateElement()&&(this.options=c.extend({},this.options,b),this.init())}});R9.extend("Widgets.Checkbox",{isCheckbox:function(a){return a&&a.nodeName&&"input"==a.nodeName.toLowerCase()&&"checkbox"==a.type.toLowerCase()},isWidgetControlled:function(a){return c(a).hasClass(R9.Widgets.Checkbox.prototype.widgetBaseClass+"-input")},
refresh:function(a,b){b=c(b);b[a.checked?"addClass":"removeClass"](R9.Widgets.Checkbox.prototype.widgetBaseClass+"-icon-checked");b[a.disabled?"addClass":"removeClass"](R9.Widgets.Checkbox.prototype.widgetBaseClass+"-icon-disabled")},findIconNode:function(a){return c(a).closest("[id$\x3d'-icon']")},findElementNode:function(a){return document.getElementById(a.id.substring(0,a.id.lastIndexOf("-icon")))}});R9.extend("Widgets.Checkbox.prototype",{widgetName:"checkbox",widgetBaseClass:"r9-checkbox",elementNode:null,
element:null,icon:null,options:{click:null,change:null},init:function(){this.bindInputClickEvent();this.bindInputEvent("change",this.handleElementChangeEvent);this.bindInputEvent("focus",this.handleElementFocusEvent);this.bindInputEvent("blur",this.handleElementBlurEvent);this.element.data(this.widgetName,this)},validateElement:function(){return R9.Widgets.Checkbox.isCheckbox(this.elementNode)&&R9.Widgets.Checkbox.isWidgetControlled(this.elementNode)},bindInputEvent:function(a,b){var c=this;a+="."+
this.widgetName;this.element.unbind(a).bind(a,function(a){b.call(c,this,R9.Widgets.Checkbox.findIconNode(this),a)})},bindInputClickEvent:function(){this.bindInputEvent("click",this.handleElementClickEvent)},handleElementClickEvent:function(a,b,c){this.options.click&&this.options.click.apply(this,arguments)},handleElementChangeEvent:function(a,b,c){R9.Widgets.Checkbox.refresh(a,b);this.options.change&&this.options.change.apply(this,arguments)},handleElementFocusEvent:function(a,b,d){a.disabled||(c(b).addClass(this.widgetBaseClass+
"-state-focus"),this.options.focus&&this.options.focus.apply(this,arguments))},handleElementBlurEvent:function(a,b,d){a.disabled||(c(b).removeClass(this.widgetBaseClass+"-state-focus"),this.options.blur&&this.options.blur.apply(this,arguments))}})})(jq||jQuery);var FOCUSED_CLASS=R9.config.getString("ui.horizon.common.core.focusOutlineClass","a11y-focused");
(function(c){R9.createWidgetClass("checkbox.Checkbox",c.extend({},R9.Widgets.Checkbox.prototype,{isToggle:!1,options:{keydown:c.noop,click:null,change:null},init:function(){this.elementNode=this.element.get(0);this.element.parent().is(".toggle")&&(this.isToggle=!0);this.label=this.getChildElement("label")},addEventHandlers:function(){this.bindInputClickEvent();this.bindInputEvent("change",this._handleElementChangeEvent);this.bindInputEvent("focus",this.handleElementFocusEvent);this.bindInputEvent("blur",
this.handleElementBlurEvent)},_handleElementChangeEvent:function(a,b,d){this.handleElementChangeEvent(a,b,d);this.options.isToggle&&(b=c(a).prop("checked"),a.setAttribute("aria-checked",b))},setEnabled:function(a){a?this.element.removeAttr("disabled"):this.element.attr("disabled","disabled");this.element.attr("aria-disabled",!a);R9.Widgets.Checkbox.refresh(this.element,this.icon)},getValue:function(){return this.element.prop("checked")},setChecked:function(a){this.element.prop("checked",a);this.isToggle&&
this.elementNode.setAttribute("aria-checked",a)},handleElementFocusEvent:function(){this.base();this.toggleFocusOutline(!0)},handleElementBlurEvent:function(){this.base();this.toggleFocusOutline(!1)},toggleFocusOutline:function(a){this.element.closest(".js-checkbox-container").toggleClass(FOCUSED_CLASS,a)}}))})(jq||jQuery);(function(d,e){function k(a,b){if(a)for(var c=0,d=a.childElementCount;c<d;c++)if(a.children){var h=b?a.children[d-c-1]:a.children[c],f=h;if((f&&null!==f.getAttribute("tabindex")&&""!==f.getAttribute("tabindex")&&"-1"!==f.getAttribute("tabindex")||-1<l.indexOf(f.tagName)||"INPUT"===f.tagName&&"hidden"!==f.getAttribute("type"))&&e(f).is(":visible")||(h=k(h,b)))return h}}var l=["SELECT","A","BUTTON","TEXTAREA"];d.createWidgetClass("dialog.Dialog",{content:null,contentBody:null,closeButton:null,modalBackground:null,
focusBoundaries:null,initialFocus:null,lastFocus:null,options:{fullHeight:!1,customWidth:!1,modal:!0,blur:!1,onClose:null,onOpen:null,afterClose:null,afterOpen:null,initialFocusId:null,preventInitialFocus:!1,closeOnModalClick:!0,hasKeyboardControl:!0,openImmediately:!1,preventClose:!1,returnFocus:!0,scrollToTopOnMobile:!1,forceOpen:!1,renderInline:!1,isMobile:!1,isOpenTopZindex:!1,iframeResize:!0,iframeTopGapPercent:.08,preventClosingClickBubble:!1},topLevelComponent:null,returnElement:null,init:function(){this.resizeEventName=
"resize."+this.id();this.content=this.getChildElement("content");this.contentBody=this.getChildElement("body");this.closeButton=this.getChildElement("close");this.modalBackground=this.getChildElement("modal");this.viewport=this.getChildElement("viewport");this.modal=this.getChildElement("modal");this.modalUniqueClass="modal-class-"+this.modal.attr("id")},addEventHandlers:function(){var a=this,b=this.closeOnModalClick.bind(this);this.options.preventClose||(this.options.hasKeyboardControl&&(this.registerEvent("keydown",
e(document),function(b){a.options.preventClose||b.which!==d.globals.keyCodes.ESC||a.close(!0)}),this.registerEvent("keypress",this.closeButton,function(b){if(!a.options.preventClose)switch(b.which){case d.globals.keyCodes.RETURN:a.close(!0)}})),this.registerEvent("click",this.closeButton,function(){a.options.preventClose||a.close(!0)}));this.options.closeOnModalClick&&this.registerEvent("click",this.viewport,b);this.registerEvent("click",this.content,function(){a.viewport.off("click",b);setTimeout(function(){if(a.options.closeOnModalClick)a.viewport.on("click",
b)},50)});this.subscribe("dialogs.close",function(){a.isOpen()&&a.close()});this.options.preventClosingClickBubble&&this.registerEvent("click",this.element,function(a){a.stopPropagation()});this.content.one("transitionend",function(){d.events.publish("dialog.transitionend",a.content.attr("class"))})},inlineComponentsReady:function(){var a=this;this.options.modal||this.modalBackground.hide();this.topLevelComponent=this.contentBody.children("div").eq("0");this.options.renderInline&&e(d.config.getString("ui.horizon.output.container",
"body")).append(this.element);this.options.openImmediately?(this.element.addClass("animate"),d.dom.schedule(this.open.bind(this))):setTimeout(function(){a.element.addClass("animate")},100);this.getChildElement("focusStartBoundary").focus(this.resetFocus.bind(this,!1));this.getChildElement("focusEndBoundary").focus(this.resetFocus.bind(this,!0))},closeOnModalClick:function(a){a=e(a.target).closest(".content");this.content[0]===a[0]||this.options.preventClose||this.close(!0)},calculateDimensions:function(){if(this.topLevelComponent&&
this.topLevelComponent.length){var a=this.topLevelComponent[0].getBoundingClientRect(),b=this.content[0].getBoundingClientRect(),c="number"===typeof this.topLevelComponent.outerWidth()?Math.ceil(a.width):null,a="number"===typeof this.topLevelComponent.outerHeight()?Math.ceil(a.height):null;this.options.customWidth||c===Math.ceil(b.width)||this.content.width(c);this.options.fullHeight||a===Math.ceil(b.height)||this.content.height(a)}},resetFocus:function(a){(a=a?this.closeButton:this.lastFocus?this.lastFocus:
this.findFirstFocusableElement(!0))&&"function"===typeof a.focus&&a.focus();return!1},handleKeyPress:function(a){switch(a.which){case d.globals.keyCodes.ESC:this.close(!0)}},setContentDimensions:function(a,b,c){void 0!==a&&this.content.width(a);void 0!==b&&this.content.height(b);c&&this.content.css({maxWidth:c})},setViewPortOverflow:function(a,b){this.viewport&&this.viewport.length&&(a&&this.viewport.css({overflowX:a}),b&&this.viewport.css({overflowX:b}))},setContent:function(a){this.contentBody.html(a);
this.topLevelComponent=this.contentBody.children("div").eq("0")},close:function(a){var b=this;if(this.isOpen()&&!this.options.forceOpen){var c,g=e("body");this.isTouchDevice()&&(c=g.css("top").replace("-","").replace("px",""),g.css({overflow:"",position:"",width:""}));this.options.iframeResize&&window.parentIFrame&&"function"===typeof window.parentIFrame.getPageInfo&&window.parentIFrame.getPageInfo(!1);g.scrollTop(c);this.element.removeClass("visible");this.element.attr("aria-hidden",!0);d.globals.testMode&&
this.element.attr("data-test-popover-open",!1);if("function"===typeof this.options.onClose)this.options.onClose(this.element,a);d.events.publish("dialog.close",{id:b.id()});this.options.blur&&d.events.publish("pageContainer.contentBlur",!1);g.removeClass(this.modalUniqueClass);0>g.attr("class").indexOf("modal-class-")&&g.removeClass("hideOverflow modal-open");this.returnElement&&this.returnElement.length&&(this.returnElement.focus(),this.returnElement=null);e(window).off(this.resizeEventName);setTimeout(function(){"function"===
typeof b.options.afterClose&&b.options.afterClose()},50)}},open:function(a){if(!this.isOpen()){this.topLevelComponent&&0!==this.topLevelComponent.length||(this.topLevelComponent=this.contentBody.children("div").eq("0"));this.options.preventClose&&this.closeButton.hide();this.options.returnFocus&&(this.returnElement=e(document.activeElement));if(this.options.isOpenTopZindex){var b=0;this.element.siblings("[role\x3ddialog],[role\x3dalertdialog]").each(function(){var a=window.parseInt(e(this).css("z-index"));
a&&a>b&&(b=a)});0<b&&this.element.css("z-index",b+1)}d.events.publish(["common.dropdown.closeAll","common.widgets.tooltip.closeAll"]);this.element.addClass("visible");this.element.attr("aria-hidden",!1);d.globals.testMode&&this.element.attr("data-test-popover-open",!0);null===this.initialFocus&&this.setFocusTargets();this.options.preventInitialFocus||this.focusInitialElement();this.options.iframeResize&&window.parentIFrame&&"function"===typeof window.parentIFrame.getPageInfo&&window.parentIFrame.getPageInfo(this.positionOnIframe.bind(this));
if("function"===typeof this.options.onOpen)this.options.onOpen(this.element);"function"===typeof a&&a(this.element);this.modalBackground.length&&(e("body").addClass("hideOverflow modal-open"),e("body").addClass(this.modalUniqueClass));this.options.blur&&d.events.publish("pageContainer.contentBlur",!0);null!==this.topLevelComponent&&setTimeout(this.calculateDimensions.bind(this),1);this.isTouchDevice()&&this.options.scrollToTopOnMobile&&e("body").css({overflow:"hidden",position:"fixed",width:"100%"});
e(window).off(this.resizeEventName).on(this.resizeEventName,this.calculateDimensions.bind(this));"function"===typeof this.options.afterOpen&&this.options.afterOpen()}},positionOnIframe:function(a){if(a&&this.viewport){var b=a.clientHeight*this.options.iframeTopGapPercent,c=a.scrollTop;a=a.offsetTop;this.content.addClass("no-margin");c<a?this.viewport.css("top",0):c-a<b?this.viewport.css("top",2*(c-a)+"px"):c-a+b+this.content.height()>=this.modal.height()?this.viewport.css("top",this.modal.height()-
this.content.height()+"px"):this.viewport.css("top",c-a+Math.round(b)+"px")}},focusInitialElement:function(){var a=this;setTimeout(function(){var b=a.initialFocus&&a.initialFocus.get(0);b&&"function"===typeof b.focus&&b.focus()},501)},setFocusTargets:function(){this.focusBoundaries=this.getChildElement("focusStartBoundary").add(this.getChildElement("focusEndBoundary"));this.initialFocus=this.findFirstFocusableElement(!1);this.lastFocus=this.findFirstFocusableElement(!0)},findFirstFocusableElement:function(a){if(this.options.initialFocusId&&
!a)return e("#"+this.options.initialFocusId);a=k(this.contentBody[0],a);a||(a=this.closeButton);return e(a)},isOpen:function(){return this.element.hasClass("visible")},isTouchDevice:function(){return"ontouchstart"in window||navigator&&navigator.maxTouchPoints},destroy:function(){this.base();this.content.off("transitionend");this.element.remove()}})})(R9,jQuery);(function(c,d){c.createComponentClass("common.ccpa.CCPAConsent",{URL:"/i/api/account/dataSharing/v1/optOut",options:{visible:!1,isLoggedIn:!1,manageUrl:"/privacy/manage"},dialog:null,dialogElement:null,action:null,allowDataSharing:!0,init:function(){var a=this,b={preventClosingClickBubble:!0,onClose:this.dialogClose.bind(this),closeOnModalClick:!0,hasKeyboardControl:!1};this.dialogElement=this.getChildElement("ccpa-consent-dialog");this.dialog=this.dialogElement.dialog(b).getWidget();this.action=
this.getChildElement("ccpa-action").checkbox({change:function(){a.updateConsent(this.getValue())}}).getWidget()},addEventHandlers:function(){d(document).on("click","#ccpa-privacy-manage",this.handleLinkClick.bind(this))},handleLinkClick:function(a){a.preventDefault();this.open()},updateConsent:function(a){this.vsLog("optOut",a?"On":"Off");d.ajax({type:"PUT",dataType:"json",url:this.URL,success:function(a){this.updateConsentSuccess(a,!0)}.bind(this),data:JSON.stringify({allowDataSharing:!a}),headers:{"X-CSRF":c.globals.formtoken},
contentType:"application/json"})},getConsentStatus:function(a,b){d.ajax({type:"GET",dataType:"json",url:this.URL,success:a&&a.bind(this),error:b&&b.bind(this),headers:{"X-CSRF":c.globals.formtoken},contentType:"application/json"})},updateConsentSuccess:function(a,b){this.allowDataSharing=a.allowDataSharing;this.action.setChecked(!this.allowDataSharing);b&&(c.events.publish("sharing.cookie.update"),c.events.publish("consent.share.update"),c.events.publish("consent.ccpa.sync",this.allowDataSharing))},
open:function(){this.options.visible?this.getConsentStatus(function(a){this.updateConsentSuccess(a);this.dialog.open();this.vsLog("dialog","show")},function(){this.openPrivacyManage()}):this.openPrivacyManage()},openPrivacyManage:function(){window.open(this.options.manageUrl,"_self")},canShow:function(){return this.options.visible},dialogClose:function(){this.vsLog("dialog","hide")},vsLog:function(a,b){c.Analytics.api.trackEvent({category:"ccpa",action:"consent",label:a,value:b})}})})(R9,jQuery);(function(b,c){b.createComponentClass("common.errors.ErrorDialog",{dialog:null,dialogEl:null,title:null,messages:null,init:function(){this.dialogEl=this.getChildElement("dialog");this.dialog=this.dialogEl.dialog({}).getWidget();this.title=this.getChildElement("title");this.messages=this.getChildElement("messages")},addEventHandlers:function(){var a=this;this.subscribe("error.alert",this.show.bind(this));b.events.when("error.alert",this.show.bind(this));this.subscribe("error.dismiss",this.hide.bind(this));
this.getChildElement("close").on("click keydown",function(c){c.keyCode!==b.globals.keyCodes.TAB&&a.dialog.close()})},show:function(a){var b=this;a.title?(this.title.html(a.title),this.dialogEl.addClass("hasTitle")):(this.title.html(""),this.dialogEl.removeClass("hasTitle"));this.messages.html("");a.messages&&(c.isArray(a.messages)||(a.messages=[a.messages]),c.each(a.messages,function(a,d){a=c("\x3cli\x3e").html(d);b.messages.append(a)}));this.dialog.open()},hide:function(){this.dialog.close()}})})(R9,
jQuery);(function(a,b){a.createComponentClass("common.utils.admin.Tools",{options:{showExperimentSwitchTool:!1,showFeaturesSwitchTool:!1,showCookieControlTool:!1,showFindTemplateTool:!1,seoIndexDisabled:!1,currentExperiments:null,icon:null},legacyAdminToolsInstance:null,constructor:function(a,d,e){this._id=a;this.options=b.extend({},this.options,b.extend(d||{},e||{}));this.init()},init:function(){this.legacyAdminToolsInstance=a.Admin.AdminTools.getInstance({classNameMainContainer:"Common-Utils-Admin-Tools layer-sticky r9-admin-main"},
!0);this.options.showExperimentSwitchTool&&this.legacyAdminToolsInstance.addTool(new a.Admin.Tools.ExperimentTool({currentExperiments:this.options.currentExperiments}));this.options.showFeaturesSwitchTool&&this.legacyAdminToolsInstance.addTool(new a.Admin.Tools.FeatureTool);this.options.showCookieControlTool&&this.legacyAdminToolsInstance.addTool(new a.Admin.Tools.CookieTool);this.options.showServerTimingTool&&this.legacyAdminToolsInstance.addTool(new a.Admin.Tools.ServerTimingTool);this.options.showFindTemplateTool&&
this.legacyAdminToolsInstance.addTool(new a.Admin.Tools.FindTemplateTool);var c=this.getChildElement("chev").detach();if(c){var d=this;c.click(function(a){a.stopPropagation();a.stopImmediatePropagation();d.legacyAdminToolsInstance.getMenuContainer().toggleClass("collapsed")});this.legacyAdminToolsInstance.getMenuContainer().children().eq(0).prepend(c)}this.options.seoIndexDisabled&&(0<b("link[rel\x3d'canonical'][href$\x3d'/seonox']").length&&b("body").addClass("seonox"),b("a[href$\x3d'/seonox']").addClass("seonox"))}})})(window.R9,
window.jQuery);(function(b,c){b.createComponentClass("common.layout.StandardBody",{pageContentEl:null,allowMove:!1,noMoveClasses:{results:!0},stateClasses:{results:"ResultsPageBody"},options:{useReactHeaderV2:!1,isResponsivePage:!1},init:function(){this.options.useReactHeaderV2&&(this.pageContentEl=this.getChildElement("pageContent"),this.allowMove=this.options.isResponsivePage)},addEventHandlers:function(){this.options.useReactHeaderV2&&(this.subscribe(["header.view.set","pageContainers.changed"],function(a){Object.prototype.hasOwnProperty.call(this.noMoveClasses,
a.view)&&(this.allowMove=!this.noMoveClasses[a.view],b.events.publish("page.layout.responsive.changed",{responsive:!1}),this.pageContentEl.removeClass("moved"))}.bind(this)),this.subscribe("resultspage.view.setvisible",function(){this.allowMove=!1;b.events.publish("page.layout.responsive.changed",{responsive:!1});this.pageContentEl.removeClass("moved")}.bind(this)),this.subscribe("navigation.drawer.open",this.handleMovePageContent.bind(this)))},handleMovePageContent:function(a){this.allowMove&&this.pageContentEl.toggleClass("moved",
!!a.open);a.isMobile&&c("body").toggleClass("hideOverflow modal-open",!!a.open)}})})(R9,jQuery);(function(a,d){a.createComponentClass("common.layout.momondo.StandardBody","common.layout.StandardBody",{stateClasses:{results:"ResultsPageBody"},modalOverlay:null,init:function(){this.base();this.modalOverlay=this.getChildElement("modalOverlay")},addEventHandlers:function(){this.base();var b=this;a.events.subscribe("modalOverlay.visible",function(c){b.modalOverlay.toggleClass("OverlayVisible",c.open);c.event&&b.modalOverlay.click(function(){a.events.publish(c.event)})});b.modalOverlay.click(function(){d(this).removeClass("OverlayVisible")})}})})(R9,
jQuery);(function(e,g){g.openTooltipInstances={};var b=!1;R9.extend("Widgets",{Tooltip:function(a,d){this.element=e(a);this.element.data(this.widgetName,this);this.setOptions(d,!0)}});R9.extend("Widgets.Tooltip",{validateElement:function(a){return void 0===e(a).data(this.prototype.widgetName)},getInstance:function(a,d){return this.validateElement(a)?new R9.Widgets.Tooltip(a,d):(a=e(a).data(this.prototype.widgetName),d?a.setOptions(d):a)},removeWidget:function(a){this.validateElement(a)||this.getInstance(a).removeWidget()},
setDebug:function(a){b=a},isDebug:function(){return b}});R9.extend("Widgets.Tooltip.prototype",{element:null,widgetNamespace:"r9-tooltip",widgetBaseClass:"r9-tooltip",widgetName:"tooltip",positionTarget:"data-tooltip-position-target",isOpen:!1,options:{delay:200,fadeIn:200,fadeOut:200,edgeOffset:3,baseClass:null,content:null,positionTarget:null,position:"top",activation:"hover",showImmediately:!1,subNameSpace:"",onOpen:null,fixedPositioning:null,onClose:null,positionUpdate:!1,appendTo:"body",offsetLeft:0,
offsetAgainstEdge:!0,keepOpenOnContentHover:!1,keepOpenOnPositionTargetHover:!1,readContentOnOpen:!1,keepOpenOnRelatedTargetHover:!0,closeDelay:0,fallbackPosition:null,forceDesiredPosition:!1},_timer:null,_closeTimer:null,_originalTitle:null,_positionUpdater:null,init:function(){this._removeAllWidgetBindings();openTooltipInstances.hasOwnProperty(this.options.subNameSpace)||(openTooltipInstances[this.options.subNameSpace]=null);var a=this,d=a._getContainerElement(),c=a._getArrowElement();switch(this.options.activation){case "click":this.element.on("click."+
this.widgetName,function(c){null===openTooltipInstances[a.options.subNameSpace]&&(a.isOpen=!1);a.isOpen?a.close(c):setTimeout(a.open.bind(a,c),0)});this.options.keepOpenOnContentHover||this.bindContainerHoverEvents();this.options.showImmediately&&this.element.trigger("click."+this.widgetName);break;case "focus":this.element.on("focus."+this.widgetName,function(c){a.open(c)});this.element.on("blur."+this.widgetName,function(c){a.close(c)});this.options.showImmediately&&this.element.trigger("focus."+
this.widgetName);break;default:this.element.on("mouseenter."+this.widgetName,function(c){a.triggeredMouseOpen=!0;clearTimeout(a._closeTimer);a.open(c)});var b=this.options.keepOpenOnPositionTargetHover?this._getPositionTarget():this.element;b.on("mouseleave."+this.widgetName,function(b){a.triggeredMouseOpen=!1;a.options.keepOpenOnRelatedTargetHover&&(e(b.relatedTarget).closest(d).length||e(b.relatedTarget).closest(c).length)||(a.options.closeDelay?a._closeTimer=setTimeout(function(){a.close(b)},a.options.closeDelay):
a.close(b))});if(R9.config&&R9.config.getBoolean("ui.common.widgets.tooltip.touchend",!0))b.on("touchend."+this.widgetName,function(){a.triggeredMouseOpen&&(a.triggeredMouseOpen=!1,b.off("click.touchendfix").on("click.touchendfix",function(){b.off("click.touchendfix");a.element.trigger("mouseenter."+a.widgetName)}))});this.options.showImmediately&&this.element.trigger("mouseenter."+this.widgetName);this.options.keepOpenOnContentHover&&this.bindContainerHoverEvents()}return this},bindContainerHoverEvents:function(){var a=
this;this._getContainerElement().on("mouseenter."+this.widgetName,function(){a.isOpen&&clearTimeout(a._closeTimer)}).on("mouseleave."+this.widgetName,function(d){a.isOpen&&!e(d.relatedTarget).closest(a._getArrowElement()).length&&(a._closeTimer=setTimeout(function(){a.close(d)},a.options.closeDelay))})},setOptions:function(a,d){a&&(this.options=e.extend({},this.options,a));(a||d)&&this.init();return this},open:function(a){var d=this.getContent(a);if(!d||this.isOpen)return this;var c=!1;openTooltipInstances[this.options.subNameSpace]&&
openTooltipInstances[this.options.subNameSpace]!==this&&(c=!0,openTooltipInstances[this.options.subNameSpace].close(a,c));var b=this._getWrapperElement(),f=this._getContainerElement(),h=this._getArrowElement();this.renderContent(d,f);this._resetElements(b,f,h);d=this._getPositionMap(b,h);this._updateArrowElement(d,h);this._updateWrapperElement(d,b);this._updateContainerElement(d,f);if(this.options.fixedPositioning){var k=this;Object.keys(this.options.fixedPositioning).forEach(function(a){b.css(a,
k.options.fixedPositioning[a])});b.css("position","fixed")}this._timer&&clearTimeout(this._timer);this._closeTimer&&clearTimeout(this._closeTimer);this.isOpen=!0;openTooltipInstances[this.options.subNameSpace]=this;if(this.options.delay){var m=this;this._timer=setTimeout(function(){m._open(b,a,c)},this.options.delay)}else this._open(b,a,c);this._positionUpdater&&clearInterval(this._positionUpdater);e(g).on("resize",e.proxy(this._updatePosition,this));return this},renderContent:function(a,d){d.html(a)},
close:function(a,d){if(!R9.Widgets.Tooltip.isDebug()){this._timer&&clearTimeout(this._timer);this._closeTimer&&clearTimeout(this._closeTimer);this._positionUpdater&&clearInterval(this._positionUpdater);e(g).off("resize",this._updatePosition);a=this._getWrapperElement();a.stop(!0,!0);this.isOpen=!1;openTooltipInstances[this.options.subNameSpace]=null;var c=this;this.options.fadeOut&&!d?a.fadeOut(this.options.fadeOut,function(){c._close()}):(a.hide(),this._close());return this}},getContent:function(a){var d=
this.element.attr("title");d&&(this._originalTitle=d,this.element.removeAttr("title"));return this.options.content?"function"==typeof this.options.content?this.options.content.call(this,a):this.options.content:this._originalTitle?this._originalTitle:null!=this.element.data("title")?this.element.data("title"):this.element.text()},removeWidget:function(){this._removeAllWidgetBindings();this.element.removeData(this.widgetName);this.close();return this},_updatePosition:function(){var a=this._getWrapperElement(),
d=this._getContainerElement(),c=this._getArrowElement(),b=this._getPositioning(a,c);this._updateArrowElement(b,c);"rtl"!==document.dir&&a.css({top:b.newWrapperTop+"px",left:b.newWrapperLeft+"px"});this._updateContainerElement(b,d)},_getWrapperElement:function(){var a=e("#"+this._getIdValue("-wrapper"));a.length||(a=this._createDOMElement("-wrapper"),this.options.readContentOnOpen?a.attr("role","alert"):a.attr("role","tooltip"),e(this.options.appendTo).append(a));return a},_getContainerElement:function(){var a=
e("#"+this._getIdValue("-container"));a.length||(a=this._createDOMElement("-container"),this._getWrapperElement().append(a));return a},_getArrowElement:function(){var a=e("#"+this._getIdValue("-arrow"));a.length||(a=this._createDOMElement("-arrow"),this._getWrapperElement().append(a));return a},_createDOMElement:function(a){var d=e("\x3cdiv\x3e\x3c/div\x3e").attr("id",this._getIdValue(a));this._setStyleClasses(d,a);return d},_removeAllWidgetBindings:function(){this.element.off("click."+this.widgetName).off("focus."+
this.widgetName).off("blur."+this.widgetName).off("mouseenter."+this.widgetName).off("mouseleave."+this.widgetName).off("touchend."+this.widgetName);return this},_getPositionTarget:function(){var a=this.options.positionTarget||this.element.attr(this.positionTarget);return a&&(a=this.options.positionTarget?e("#"+this.options.positionTarget):e(a,this.element),0<a.length)?a:this.element},_getOffsetInformation:function(a,d,c){var b=this._getPositionTarget();this.options.fixedPositioning&&this._getContainerElement();
var f=b.outerWidth(),h=b.outerHeight();a="width"===a?c.outerWidth():c.outerHeight();return{arrowSize:Math.round(a/2),elementWidth:f,elementHeight:h,wrapperWidth:d.outerWidth(),wrapperHeight:d.outerHeight(),offset:{top:Math.floor(b.offset().top-e(this.options.appendTo).offset().top),left:Math.floor(b.offset().left-e(this.options.appendTo).offset().left)}}},_getPositionMap:function(a,b){a.attr("style","").css({top:"-1000px",left:"-5000px",display:"block"});return this._getPositioning(a,b)},_getPositioning:function(a,
b,c){switch(c||this.options.position){case "bottom":return this._getBottomPositioning(a,b);case "left":return this._getLeftPositioning(a,b);case "right":return this._getRightPositioning(a,b);default:return this._getTopPositioning(a,b)}},_getCommonPositioningMap:function(){return{newArrowTop:0,newArrowLeft:0,newWrapperTop:0,newWrapperLeft:0,wrapperClass:""}},getLeftRightOffsetAgainstEdge:function(a,b,c){if(this.options.offsetAgainstEdge){var d=e(this.options.appendTo).offset(),f=d?d.left+e(this.options.appendTo).width():
e(this.options.appendTo).width(),h,k=null!=d&&a<d.left,g=!isNaN(f)&&a+c.wrapperWidth>f;k?h=Math.floor(d.left+this.options.edgeOffset):g&&(h=Math.floor(f-c.wrapperWidth-this.options.edgeOffset));if(k||g)b=b+a-h,a=h}return{wrapperLeft:a,arrowLeft:b}},_getTopPositioning:function(a,b){var c=this._getOffsetInformation("height",a,b),d=c.elementWidth/2,f="-top",h=c.wrapperHeight,k=c.offset.top-this.options.edgeOffset-c.arrowSize-c.wrapperHeight;if(!this.options.forceDesiredPosition&&0>=k){if(this.options.fallbackPosition&&
"top"!==this.options.fallbackPosition)return this._getPositioning(a,b,this.options.fallbackPosition);f="-bottom";k=c.offset.top+c.elementHeight+this.options.edgeOffset+c.arrowSize;h=-1*c.arrowSize}a=this.getLeftRightOffsetAgainstEdge(c.offset.left+d-c.wrapperWidth/2+this.options.offsetLeft,c.wrapperWidth/2-c.arrowSize,c);return e.extend(this._getCommonPositioningMap(),{newArrowTop:Math.round(h),newArrowLeft:Math.round(a.arrowLeft),newWrapperTop:Math.round(k),newWrapperLeft:Math.round(a.wrapperLeft),
wrapperClass:f})},_getBottomPositioning:function(a,b){var c=this._getOffsetInformation("height",a,b),d=c.elementWidth/2,f="-bottom",h=-1*c.arrowSize,k=c.offset.top+c.elementHeight+this.options.edgeOffset+c.arrowSize;if(!this.options.forceDesiredPosition&&k+c.wrapperHeight>=jq(g).scrollTop()+e(g).height()){if(this.options.fallbackPosition&&"bottom"!==this.options.fallbackPosition)return this._getPositioning(a,b,this.options.fallbackPosition);f="-top";k=c.offset.top-this.options.edgeOffset-c.arrowSize-
c.wrapperHeight;h=c.wrapperHeight}a=this.getLeftRightOffsetAgainstEdge(c.offset.left+d-c.wrapperWidth/2+this.options.offsetLeft,c.wrapperWidth/2-c.arrowSize,c);return e.extend(this._getCommonPositioningMap(),{newArrowTop:Math.round(h),newArrowLeft:Math.round(a.arrowLeft),newWrapperTop:Math.round(k),newWrapperLeft:Math.round(a.wrapperLeft),wrapperClass:f})},_getLeftPositioning:function(a,b){var c=this._getOffsetInformation("width",a,b),d=c.elementHeight/2,f=c.wrapperHeight/2,h="-left",k="rtl"===document.dir?
-c.arrowSize:c.wrapperWidth,g="rtl"===document.dir?c.offset.left+this.options.edgeOffset+c.arrowSize+c.elementWidth:c.offset.left-this.options.edgeOffset-c.arrowSize-c.wrapperWidth;if(!this.options.forceDesiredPosition&&0>=g){if(this.options.fallbackPosition&&"left"!==this.options.fallbackPosition)return this._getPositioning(a,b,this.options.fallbackPosition);h="-right";g=c.offset.left+c.elementWidth+this.options.edgeOffset+c.arrowSize;k=-1*c.arrowSize}return e.extend(this._getCommonPositioningMap(),
{newArrowTop:Math.round(f-c.arrowSize),newArrowLeft:Math.round(k),newWrapperTop:Math.round(c.offset.top+d-f),newWrapperLeft:Math.round(g),wrapperClass:h})},_getRightPositioning:function(a,b){var c=this._getOffsetInformation("border-right-width",a,b),d=c.elementHeight/2,f=c.wrapperHeight/2,h="-right",k="rtl"===document.dir?c.wrapperWidth:-1*c.arrowSize,m="rtl"===document.dir?c.offset.left-c.wrapperWidth-c.arrowSize:c.offset.left+c.elementWidth+this.options.edgeOffset+c.arrowSize;if(!this.options.forceDesiredPosition&&
m+c.wrapperWidth>=e(g).width()){if(this.options.fallbackPosition&&"right"!==this.options.fallbackPosition)return this._getPositioning(a,b,this.options.fallbackPosition);a=c.offset.left-this.options.edgeOffset-c.arrowSize-c.wrapperWidth;0<=a&&(h="-left",m=a,k=c.wrapperWidth)}return e.extend(this._getCommonPositioningMap(),{newArrowTop:Math.round(f-c.arrowSize),newArrowLeft:Math.round(k),newWrapperTop:Math.round(c.offset.top+d-f),newWrapperLeft:Math.round(m),wrapperClass:h})},_setStyleClasses:function(a,
b,c){a.attr("class","");this._addStyleClasses(a,b,c);return this},_addStyleClasses:function(a,b,c){b&&(a.addClass(this.widgetBaseClass+b),c&&a.addClass(this.widgetBaseClass+b+c),this.options.baseClass&&(a.addClass(this.options.baseClass+b),c&&a.addClass(this.options.baseClass+b+c)));return this},_updateWrapperElement:function(a,b){this._addStyleClasses(b,"-wrapper",a.wrapperClass);b.attr("style","");"number"===typeof a.newWrapperTop&&b.css("top",a.newWrapperTop+"px");"number"===typeof a.newWrapperLeft&&
b.css({left:a.newWrapperLeft+"px",right:""});return this},_updateArrowElement:function(a,b){this._addStyleClasses(b,"-arrow",a.wrapperClass);b.css({top:a.newArrowTop+"px"});b.css({left:a.newArrowLeft+"px",right:""});return this},_updateContainerElement:function(a,b){this._addStyleClasses(b,"-container",a.wrapperClass);this.options.updateContainerOnResize&&b.css({top:a.newArrowTop+5+"px",left:a.newArrowLeft-b.width()+"px"});return this},_getIdValue:function(a){return this.widgetNamespace+this.options.subNameSpace+
a},_open:function(a,b,c){var d=this;a.stop(!0,!0);var f=function(a){this.options.onOpen&&this.options.onOpen.call(this,a);this.options.positionUpdate&&(this._positionUpdater=setInterval(e.proxy(this._updatePosition,this),1E3/60))};this.options.fadeIn&&!c?a.fadeIn(this.options.fadeIn,function(){f.call(d,b)}):(a.show(),f.call(d,b));return this},_close:function(){this._originalTitle&&(this.element.attr("title",this._originalTitle),this._originalTitle=null);this.options.onClose&&this.options.onClose.call(this,
null);return this},_resetElements:function(a,b,c){this._setStyleClasses(a,"-wrapper");this._setStyleClasses(b,"-container");this._setStyleClasses(c,"-arrow");return this}})})(jq||jQuery,window);
(function(e,g){e.createWidgetClass("tip.ToolTip",g.extend({},e.Widgets.Tooltip.prototype,{contentContainer:null,boundEvents:null,orientationOffset:null,rtlOrientation:void 0,trackEventId:null,options:g.extend({},e.Widgets.Tooltip.prototype.options,{showImmediately:!1,baseClass:"coolTip",extraClass:null,delay:200,position:"top",fallbackPosition:null,forceDesiredPosition:null,orientation:"middle",orientationOffset:null,onDestroy:null,activation:"hover",subNameSpace:"",alwaysRendered:!1,color:"black",
size:"l",closeOnBodyClick:!0,destroyAfterClose:!1,content:"",isComponent:!1,target:null,positionTarget:null,updateContainerOnResize:!1,track:null,testAttributes:null,setAriaContext:!1,readContentOnOpen:!1}),init:function(){this.base();if(this.options.alwaysRendered){this.contentContainer=this.getChildElement("rendered-content");var b=this.contentContainer.children().eq(0);b.attr({"data-test-popover-content":"","data-test-popover-open":this.options.showImmediately});this.setContent(b)}e.Widgets.Tooltip.prototype.init.call(this);
this.boundEvents={};this.rtlOrientation="rtl"===document.dir&&"middle"!==this.options.orientation?"start"===this.options.orientation?"end":"start":void 0;this.orientationOffset=this._getOrientationOffset()},addEventHandlers:function(){this.subscribe("common.widgets.tooltip.clearCloseTimers",this._clearCloseTimers.bind(this));var b=this;this.subscribe("common.widgets.tooltip.closeAll",function(){b.isOpen&&b.close()});this.subscribe("common.widgets.tooltip.closeSelf",b.options.subNameSpace,function(){b.isOpen&&
b.close()})},destroy:function(){if("function"===typeof this.options.onDestroy)this.options.onDestroy();this.options.fadeOut=!1;var b=this._getContainerElement();Object.keys(this.boundEvents).forEach(function(a){b.off(a,this.boundEvents[a])}.bind(this));this.isOpen&&this.close();this._removeAllWidgetBindings();this.element.removeData(this.widgetName);this.base()},bindComponent:function(){this.element.data("toolTip",this);this.element.data("widget")||this.element.data("widget",this);this._addTestAttributes(this.element,
"trigger");e.globals.testMode&&this.element.attr({"data-test-popover-widget":"","data-test-popover-triggerevent":this.options.activation});this.options.setAriaContext&&this.element.attr("aria-describedby",this._getWrapperElement().attr("id"))},bindEventHandler:function(b,a,d){b=b.replace(/\s|$/g,"."+this.id()+" ");this._getContainerElement().on(b,a,d);this.boundEvents[b]=a},setContent:function(b){this.options.content=b},renderContent:function(b,a){"string"===typeof b?e.Widgets.Tooltip.prototype.renderContent.call(this,
b,a):"object"===typeof b?g.contains(a,b)||(a.html(""),a.append(b)):this.log.errorInternal('Bad parameter passed to renderContent(): "content" param must be a String or a jQuery object');this._addTestAttributes(a,"content")},getOptionalTarget:function(b,a){return"string"===typeof b&&b.length?"#"===b[0]?g(b):g("#"+b):null!==b&&"object"===typeof b?g(b):a},_addTestAttributes:function(b,a){var d=this,c={};e.globals.testMode&&(c["data-test-popover-"+a]="");this.options.testAttributes&&Object.keys(this.options.testAttributes).forEach(function(a){var b=
/^data-/.test(a)?a:"data-"+a;c[b]=d.options.testAttributes[a]});b.attr(c)},_getOrientationOffset:function(){return null!==this.options.orientationOffset?this.options.orientationOffset:this.options.extraClass&&-1!==this.options.extraClass.indexOf("no-arrow")?0:{start:-15,middle:0,end:15}[this.rtlOrientation||this.options.orientation]},_getPositioning:function(b,a,d,c){d=d||this.options.position;var l=e.Widgets.Tooltip.prototype._getPositioning.call(this,b,a,d),f={top:0,left:0},h=this.orientationOffset*
(c?-1:1);if("middle"!==this.options.orientation){var k=this.rtlOrientation||this.options.orientation,m,n;c&&(k="start"===k?"end":"start");"left"===d||"right"===d?(n="top",m="outerHeight"):(n="left",m="outerWidth");var p=this.getOptionalTarget(this.options.positionTarget,this.element),r=p[m](),q=this._getWrapperElement()[m]();if(!c&&!this.options.forceDesiredPosition)if(c=p.offset()[n],p="scroll"+n.charAt(0).toUpperCase()+n.slice(1),"start"===k){if(c+q>g(window)[p]()+g(window)[m]())return this._getPositioning(b,
a,d,!0)}else if("end"===k&&c+r-q<g(window)[p]())return this._getPositioning(b,a,d,!0);b=r/2;q/=2;"start"===k?f[n]=Math.ceil(q-b+h):"end"===k&&(f[n]=Math.ceil(b-q+h))}l.newArrowTop-="rtl"===document.dir?-f.top:f.top;l.newArrowLeft-=f.left;l.newWrapperTop+="rtl"===document.dir?-f.top:f.top;l.newWrapperLeft+=f.left;return l},clearTrackEvent:function(){this.trackEventId&&(clearTimeout(this.trackEventId),this.trackEventId=null)},startTrackEvent:function(b){this.clearTrackEvent();if(b&&b.wait&&b.label){var a=
parseInt(b.wait);isNaN(a)||1>a||(this.trackEventId=setTimeout(this.triggerTrackEvent.bind(this,b),a))}},triggerTrackEvent:function(b){if(this.element&&this.element.hasClass("tooltip-open")&&b&&b.label){var a={category:b.category||"ToolTip",action:b.action||"open",label:b.label};b.hasOwnProperty("value")&&(a.value=b.value);e.Analytics.api.trackEvent(a)}},_open:function(b,a,d){var c=this,l="click."+this.id(),f=this._getContainerElement();e.Widgets.Tooltip.prototype._open.call(this,b,a,d);e.events.publish("common.widgets.tooltip.clearCloseTimers",
this.options.subNameSpace);this.element.addClass("tooltip-open");f.attr("aria-expanded",!0);e.globals.testMode&&this.element.add(f).attr("data-test-popover-open",!0);e.events.publish("common.widgets.tooltip.opened");var h=function(a){b[0].contains(a.target)||"click"===c.options.activation&&c.element[0].contains(a.target)||(g(document).off(l),c.close())};this.options.closeOnBodyClick&&setTimeout(function(){g(document).off(l).on(l,h)},1);this.options.track&&this.startTrackEvent(g.extend({wait:2E3},
this.options.track))},_close:function(b){var a=this.getContent(),d=this._getContainerElement();this.options.alwaysRendered&&"object"===typeof a&&this.contentContainer.append(a);e.Widgets.Tooltip.prototype._close.call(this,b);this.element.removeClass("tooltip-open");d.attr("aria-expanded",!1);e.globals.testMode&&this.element.add(d).attr("data-test-popover-open",!1);this.options.closeOnBodyClick&&e.dom.schedule(function(){g(document).off("click."+this.id())}.bind(this));this.options.track&&this.clearTrackEvent();
this.options.destroyAfterClose&&this.destroy()},closeAfter:function(b){this._forceCloseTimer&&clearTimeout(this._forceCloseTimer);this._forceCloseTimer=window.setTimeout(this.close.bind(this),b)},_clearCloseTimers:function(b){b===this.options.subNameSpace&&clearTimeout(this._closeTimer)},_addStyleClasses:function(b,a,d){a&&(b.addClass(this.widgetBaseClass+a),d&&b.addClass(this.widgetBaseClass+a+d),this.options.baseClass&&(b.addClass(this.options.baseClass+a),d&&b.addClass(this.options.baseClass+a+
d)),this.options.color&&b.addClass("Color-"+this.options.color));this.options.extraClass&&b.addClass(this.options.extraClass);this.options.size&&b.addClass("size-"+this.options.size);e.Common.Utils.Browsers.isIE()?b.addClass("ie"):e.Common.Utils.Browsers.isChrome()&&(b.addClass("chrome"),a=e.Common.Utils.Browsers.getChromeVersion(),65!==a&&66!==a||b.addClass("chrome65"));return this},_getOffsetInformation:function(b,a,d){var c=this.getOptionalTarget(this.options.positionTarget,this.element),e=c.outerWidth(),
f=c.outerHeight(),c={top:Math.floor(c.offset().top-g(this.options.appendTo).offset().top),left:Math.floor(c.offset().left-g(this.options.appendTo).offset().left)};b="width"===b?d.outerWidth():d.outerHeight();return{arrowSize:Math.round(b/2),elementWidth:e,elementHeight:f,wrapperWidth:a.outerWidth(),wrapperHeight:a.outerHeight(),offset:c}},_removeAllWidgetBindings:function(){e.Widgets.Tooltip.prototype._removeAllWidgetBindings.call(this);this.options.setAriaContext&&this.element.removeAttr("aria-describedby")}}))})(R9,
jQuery);(function(g,d){g.createWidgetClass("tip.StyleJamTooltip",{presentations:{wrapper:"Tooltip__Wrapper Tooltip__Wrapper--fixed Tooltip__Wrapper--hidden",visible:"Tooltip__Wrapper--visible",hidden:"Tooltip__Wrapper--hidden",content:"Tooltip__Content",pointer:"Tooltip__Pointer",above:"Tooltip__Pointer Tooltip__Pointer--down",right:"Tooltip__Pointer Tooltip__Pointer--left",below:"Tooltip__Pointer Tooltip__Pointer--up",left:"Tooltip__Pointer Tooltip__Pointer--right"},$targetElem:null,$triggerElem:null,$tooltipElem:null,
$tooltipPointerElem:null,state:null,options:{targetElem:null,triggerElem:null,triggerEvent:"hover",position:"above",fallbackPosition:void 0,positionOffsetX:50,positionOffsetY:50,showDelay:0,hideDelay:1E3,content:null,preRendered:!1},init:function(){this.base();this.state={afID:null,scrolling:!1,scrollTicker:null,visible:!1,showTimeout:0,hideTimeout:0,widthSet:!1};this.$targetElem=d("#"+this.options.targetElem);this.$triggerElem=null!==this.options.triggerElem?d("#"+this.options.triggerElem):this.$targetElem;
this.$targetElem.length&&this.$triggerElem.length?(this.options.preRendered?(this.$tooltipElem=d("#"+this.id()),this.$tooltipPointerElem=this.getChildElement("pointer")):(this.$tooltipElem=d(this.createTooltipElement()),this.$tooltipPointerElem=this.$tooltipElem.children("#"+this.id("pointer"))),this.options.preRendered&&this.$tooltipElem.appendTo(d("body"))):console.warn("StyleJamTooltip: Couldn't locate target element with id: %s",this.options.targetElem)},addEventHandlers:function(){var a=this;
switch(this.options.triggerEvent){case "click":this.options.hideDelay=0;this.$triggerElem.on("click",function(){a.show()});d(document).on("click",function(b){if(a.state.visible){var c=a.$targetElem[0],e=a.$tooltipElem[0],c=b.target===c||a.isDescendant(c,b.target);b=b.target===e||a.isDescendant(e,b.target);c||b||a.hide()}});break;case "hover":this.$triggerElem.on("mouseenter",function(){a.show()}).on("mouseleave",function(){a.hide()}),this.$tooltipElem.on("mouseenter",function(){a.show()}).on("mouseleave",
function(){a.hide()});case "focus":this.$triggerElem.on("focus",function(){a.show()}).on("blur",function(){a.hide()})}this.setupOnScroll();this.subscribe("common.widgets.tooltip.closeAll",this.hide.bind(this))},createTooltipElement:function(){var a=document.createElement("div");a.setAttribute("id",this.id());a.setAttribute("class",this.getStlBlocks(this.presentations.wrapper));var b=document.createElement("div");b.setAttribute("class",this.getStlBlock(this.presentations.content));b.innerHTML=this.options.content;
var c=document.createElement("div");c.setAttribute("id",this.id("pointer"));c.setAttribute("class",this.getStlBlock(this.presentations.pointer));a.appendChild(b);a.appendChild(c);return a},setupOnScroll:function(){var a=this;this.registerEvent("scroll resize",d(window),function(){clearTimeout(a.state.scrollTicker);!a.state.scrolling&&a.state.visible&&(a.state.scrolling=!0,a.position());a.state.scrollTicker=setTimeout(function(){a.state.scrolling=!1;cancelAnimationFrame(a.state.afID)},150)})},show:function(){var a=
this;this.state.visible=!0;this.options.preRendered||this.$tooltipElem.appendTo(d("body"));this.state.widthSet||(this.$tooltipElem.width(this.$tooltipElem.width()),this.state.widthSet=!0);this.position();this.resetTimers();this.state.showTimeout=setTimeout(function(){a.swapClasses(a.$tooltipElem,a.presentations.hidden,a.presentations.visible)},this.options.showDelay)},hide:function(){var a=this;this.resetTimers();this.state.hideTimeout=setTimeout(function(){a.state.visible=!1;a.swapClasses(a.$tooltipElem,
a.presentations.visible,a.presentations.hidden);a.options.preRendered||a.$tooltipElem.remove()},this.options.hideDelay)},resetTimers:function(){clearTimeout(this.state.showTimeout);clearTimeout(this.state.hideTimeout)},position:function(){var a=this;this.state.scrolling&&(this.state.afID=requestAnimationFrame(function(){a.position()}));var b=this.$targetElem[0].getBoundingClientRect(),c=this.$tooltipElem[0].getBoundingClientRect(),e=this.$tooltipElem[0].currentStyle||window.getComputedStyle(this.$tooltipElem[0]);
c.x=c.left-parseFloat(e.marginLeft);c.width=c.width+parseFloat(e.marginLeft)+parseFloat(e.marginRight);c.height=c.height+parseFloat(e.marginTop)+parseFloat(e.marginBottom);b=this.getRenderPosition(this.options.position,b,c);this.$tooltipElem.css({top:b.y+"px",left:b.x+"px"})},getRenderPosition:function(a,b,c){var e=b.left+this.options.positionOffsetX/100*b.width-c.width/2,d=b.top+this.options.positionOffsetY/100*b.height-c.height/2,f={left:[d,b.left-c.width,this.getInnerHeight()-(d+c.height)],below:[e,
this.getInnerHeight()-(b.top+b.height+c.height),this.getInnerWidth()-(e+c.width)],right:[d,this.getInnerWidth()-(b.left+b.width+c.width),this.getInnerHeight()-(d+c.height)],above:[e,b.top-c.height,this.getInnerWidth()-(e+c.width)]};a=f[a].every(function(a){return 0<=a})?a:Object.keys(f).reduce(function(a,b){return f[a].map(function(a){return 0<a?0:a}).reduce(function(a,b){return a+b})>f[b].map(function(a){return 0<a?0:a}).reduce(function(a,b){return a+b})?a:b});a!==this.options.position&&this.options.fallbackPosition&&
(a=this.options.fallbackPosition);this.$tooltipPointerElem.attr("class","").addClass(this.getStlBlocks(this.presentations[a]));switch(a){case "above":return{x:e,y:b.top-c.height};case "right":return{x:b.left+b.width,y:d};case "below":return{x:e,y:b.top+b.height};case "left":return{x:b.left-c.width,y:d}}},isDescendant:function(a,b){for(b=b.parentNode;null!=b;){if(b==a)return!0;b=b.parentNode}return!1},getInnerWidth:function(){return window.innerWidth||document.documentElement.clientWidth||document.body.clientWidth},
getInnerHeight:function(){return window.innerHeight||document.documentElement.clientHeight||document.body.clientHeight}})})(R9,jQuery);(function(c,d){c.createWidgetClass("tip.RichToolTip",{closeButton:null,subNameSpace:"-richToolTip",initialized:!1,options:{toolTipTarget:"",onHover:!1,lightTheme:!1,showCloseButton:!1,shouldShowImmediately:!0,hoverOpenDelay:200,closeOnBodyClick:!0},init:function(){this.options.showCloseButton&&(this.closeButton=this.getChildElement("closeButton"))},addEventHandlers:function(){var a=this;this.options.showCloseButton&&this.registerEvent("click",this.closeButton,function(){c.events.publish("common.widgets.tooltip.closeSelf",
a.subNameSpace)});this.subscribe("common.widgets.richToolTip.remoteInit",function(){a.initialized||a.remoteInit();a.initialized=!0})},remoteInit:function(){var a=d("#"+this.options.toolTipTarget),b=d("#"+this.options.toolTipTarget+"-rendered-content").children().eq(0);a.length&&b.length&&(a.toolTip({position:"right",orientation:"middle",activation:this.options.onHover?"hover":"click",color:this.options.lightTheme?"white":"black",role:"note",subNameSpace:this.subNameSpace,extraClass:"Common-Widgets-Tip-RichToolTip-tooltip-content",
content:b,showImmediately:this.options.shouldShowImmediately,delay:this.options.hoverOpenDelay,closeOnBodyClick:this.options.closeOnBodyClick,onOpen:this.onOpen}),this.options.shouldShowImmediately&&(a=JSON.stringify("false"),b=moment().add(1,"days").toDate().toUTCString(),document.cookie="day-of-week-new-user\x3d"+a+"; path\x3d/; expires\x3d"+b))},onOpen:function(){var a=d(this.getContent().find("button"));a.length&&this.registerEvent("click",a,function(){c.events.publish("common.widgets.tooltip.closeSelf",
"-richToolTip")})}})})(R9,jQuery);(function(c,e){c.createComponentClass("common.seo.SeoMetaTags",{addEventHandlers:function(){this.checkForAdWordsSearch()},checkForAdWordsSearch:function(){c.globals.isSeo&&this.subscribe("cmp2.rendering.finished",function(a){if(a&&a.items&&a.items.length){if(a=window.location.search.substring(1)){a=a.split("\x26");var b=c.config.getString("ui.cmp2.dynamic.search.ads","");if(b)for(var b=b.split(","),d=0;d<b.length;d++)if(-1<a.indexOf("a\x3d"+b[d])){c.events.publish("cmp2.checkAll");break}}this.destroy()}}.bind(this))}})})(R9,
jQuery);(function(a,b){a.createComponentClass("common.search.SearchErrorDialog",{options:{},init:function(){this.dialog=this.getChildElement("dialog").dialog({}).getWidget();this.bindEvents()},bindEvents:function(){a.events.subscribe("dialog.error.open",{id:this.id()},b.proxy(this.open,this));a.events.subscribe("dialog.error.close",{id:this.id()},b.proxy(this.close,this))},open:function(a){a.message&&this.dialog.setContent(a.message);this.dialog.open()},close:function(){this.dialog.close()}})})(window.R9,
window.jQuery);(function(e,d){e.createComponentClass("common.core.FastlyTiming",{options:{runTest:!1,measurementUrl:"/fastly-timer",logUrl:"/s/run/fastlytimerlog"},init:function(){this.options.runTest&&this.runTimingRequest()},runTimingRequest:function(){d.ajax({type:"POST",url:this.options.measurementUrl,success:this.logResult.bind(this)})},logResult:function(c,a,b){b&&c&&c.cluster&&(a=b.getResponseHeader("x-served-by"),b=b.getResponseHeader("x-timer"),a&&b&&(a=a.split(" "),a=a[a.length-1].split("-"),d.ajax({type:"POST",
url:this.options.logUrl,data:{cluster:c.cluster,timer:b,fastlyNode:a[a.length-1]}})))}})})(R9,jQuery);(function(e,c){e.createComponentClass("common.kn.SmarterTravel",{options:{apiKey:"",libraryUrl:"",locale:"",currency:"",placementId:"",adVertical:"",isPoppableState:function(){return!0},suppressSelectors:[],updateSelector:"",isRP:!1},leaveBehind:null,init:function(){this.options.isPoppableState()&&(this.loadLibrary(),this.bindEvents())},loadLibrary:function(){var a=document.createElement("script");a.src=this.options.libraryUrl;a.async=!0;var c=document.getElementsByTagName("script")[0];c.parentNode.insertBefore(a,
c)},extract:function(){return{}},bindEvents:function(){var a=this;window.SmarterTravelNetwork_ready=window.SmarterTravelNetwork_ready||[];window.SmarterTravelNetwork_ready.push(function(d){function e(a){switch(a){case "e":case "p":return"economy_coach";case "b":return"business";case "f":return"first_class";default:return null}}var h={apiKey:a.options.apiKey,contextData:function(){var b={currency:a.options.currency,locale:a.options.locale,ad_vertical:a.options.adVertical};c.extend(b,a.extract());if(b.hasOwnProperty("date1")){var f=
moment(b.date1).format("MM/DD/YYYY");b.date1=d.Util.formatDate(f,"MM/DD/YYYY")}b.hasOwnProperty("date2")&&(f=moment(b.date2).format("MM/DD/YYYY"),b.date2=d.Util.formatDate(f,"MM/DD/YYYY"));b.hasOwnProperty("flight_service_class")&&(b.flight_service_class=e(b.flight_service_class));return b},popupSuppressionPeriod:24,logLevel:d.Log.LOG_LEVELS.DEBUG};window.R9Admin&&c.extend(h,{logLevel:d.Log.LOG_LEVELS.DEBUG});d.init(h);a.leaveBehind=d.createLeaveBehind({placementId:a.options.placementId,clickEventSelector:!1,
redirectPageUrl:"/s/horizon/common/kn/SmarterTravelInterstitial"});d.loadPlacements([a.leaveBehind]);c(document).on("click",g)});var g=function(d){0<c(d.target).closest(a.options.suppressSelectors.join(",")).length||!a.options.isPoppableState()||(a.options.isRP?a.leaveBehind.launch():a.leaveBehind.launchHolder(),setTimeout(function(){c(document).off("click",g)},50))};c(".searchButton").click(function(){a.launch()})},launch:function(){this.options.isPoppableState()&&this.leaveBehind.launch()}})})(R9,
jQuery);(function(b,e){b.createComponentClass("hotels.ads.HotelSmarterTravel","common.kn.SmarterTravel",{city:"",state:"",country:"",extract:function(){var a;a=this.options.isRP?b.question.ask("hotels.rp.searchform"):b.question.ask("hotels.fd.searchform");var d=a.location;a.cityId&&this.lookupCity(a.cityId,!0)&&(d=this.city+", "+("US"===this.country?this.state:this.country));return{destination_name:d,date1:a.checkInDate,date2:a.checkOutDate,num_travelers:a.guests,num_rooms:a.rooms}},lookupCity:function(a,
d){var c=this,b=!1;e.ajax({async:!d,dataType:"json",url:"/f/smarty?f\x3dj\x26lc\x3den\x26lc_cc\x3dUS\x26s\x3d16\x26where\x3dc"+encodeURIComponent(a),success:function(a){a&&a.length?(b=!0,c.city=a[0].cityname?a[0].cityname.split(",")[0]:"",c.state=a[0].rc,c.country=a[0].cc):(c.city="",c.state="",c.country="")}});return b}})})(R9,jQuery);(function(b,e){var f=function(a){if(a){a=a.charAt(0).toUpperCase()+a.slice(1);var b="s"===a.slice(-1)?a.slice(0,-1):a;return"."+a+"-Results-"+b+"ResultsPage"}},g=void 0!==window.history.pushState,h=[b.globals.keyCodes.UP,b.globals.keyCodes.DOWN,b.globals.keyCodes.LEFT,b.globals.keyCodes.RIGHT,b.globals.keyCodes.TAB];b.createComponentClass("base.search.SearchPage",{options:{msg:{resultPageTitle:""},isFD:!0,lazyLoadRP:!1,pageVertical:"",analyticsVertical:"",preloadResourcesForRP:!1,resultsPageComponentsMap:{},
addClassDuringTransition:!0},rpLoaded:!1,rpRequest:null,init:function(a){this.rpContainer=this.getChildElement("rp");this.options.isFD?this.options.lazyLoadRP&&this.preloadComponents():this.rpLoaded=!0;""!==this.options.msg.resultPageTitle&&(document.title=this.options.msg.resultPageTitle)},addEventHandlers:function(a){var c=this;this.subscribe("pageContainer.contentBlur",function(a){c.element.toggleClass("Blur",a)});a=this.handleSearchSubmit.bind(this);a.priority=1;this.subscribe(["searchform.submit",
"multilocale.search.submit"],a);this.subscribe("omni.vertical.changed",function(a){c.cleanupResultsPage();c.abortActiveResultsPageRequest();b.config.getBoolean("ui.horizon.omni.loadRpOnVerticalChange",!0)&&c.options.resultsPageComponentsMap&&c.options.resultsPageComponentsMap.hasOwnProperty(a)&&c.loadResultsPageComponent(a)});b.question.answer("SearchPage.view",function(){return c.options.isFD?"FD":"RP"});b.config.getBoolean("ui.keyboard.show-focus",!0)&&this.bindAccessibilityHandlers();if(b.config.getBoolean("ui.horizon.modal.no-ad-click",
!0)){var d=this.element;this.subscribe(["InputModal.opened","Select.opened","DatePicker.opened","DropdownDialog.open"],function(){d.addClass("modalOpen")});this.subscribe(["InputModal.closed","Select.closed","DatePicker.closed","DropdownDialog.close"],function(){d.removeClass("modalOpen")})}},abortActiveResultsPageRequest:function(){this.rpTimerId&&clearTimeout(this.rpTimerId);this.rpRequest&&(this.rpRequest.abort(),delete this.rpRequest)},handleSearchSubmit:function(a){a.url&&a.url.startsWith("http")&&
(window.location=a.url);this.abortActiveResultsPageRequest();var b=a.url&&a.url.startsWith("/")?a.url:"/"+a.url;this.useSamePageTransition(a)?(window.history.pushState({view:"rp"},"",b),this.options.isFD&&this.switchToRP()):window.location.href=b},useSamePageTransition:function(a){return!a.navigateToResults&&g&&this.rpLoaded&&this.isCorrectRpLoaded(a.vertical)&&!b.authentication.needsRefresh},getAdditionalRPBodyClass:function(){return"wide"},getRPBodyClass:function(){var a=this.getAdditionalRPBodyClass(),
b=(document.body.getAttribute("class")||"").split(" ");-1!==b.indexOf("react")&&(a+=" react");-1!==b.indexOf("react-st")&&(a+=" react-st");return a},switchToRP:function(a){b.Analytics.api.setVertical(this.options.analyticsVertical);b.Analytics.api.setPageId("results");"requestId"in b.globals&&(b.globals.requestId=b.globals.requestId.replace("frontdoor","results").replace("main",b.globals.vertical||this.options.analyticsVertical));var c=this;window.setTimeout(function(){b.events.publish("frontdoor.view.changed",
{view:"inline"});c.element.removeClass("vm-fd");c.element.addClass("vm-rp");b.events.publish("resultspage.view.setvisible",!0);b.events.publish("header.view.set",{view:"results"});b.events.publish("pageContainers.changed",{state:"results"});c.options.addClassDuringTransition?b.events.publish("body.addClass",c.getAdditionalRPBodyClass()):b.events.publish("body.setClass",c.getRPBodyClass());b.events.publish("HorizontalFilterList.setClass");b.events.publish("resultspage.routed",!0);c.rpContainer.removeClass("hiddenFD");
c.options.isFD=!1;c.cleanupFrontDoor()},10)},preloadComponents:function(){var a=this;if(this.options.lazyLoadRP){var c=function(){b.globals.vertical===a.options.pageVertical&&a.loadResultsPageComponent(a.options.pageVertical)};"complete"===document.readyState?c():b.events.when("page.initialized",c)}e(document).ready(function(){a.element.hasClass("vm-fd")&&a.options.preloadResourcesForRP&&b.resources.preload("common.booking","styles")})},loadResultsPageComponent:function(a){var c=this.options.resultsPageComponentsMap[a];
if(c&&c.component){this.abortActiveResultsPageRequest();this.cleanupResultsPage();var d=this;this.rpTimerId=setTimeout(function(){d.rpRequest=b.ajax.execute(c.component,{appendTo:d.rpContainer});d.rpRequest.then(function(){d.rpLoaded=!0;b.globals.vertical=a;d.options.analyticsVertical=c.analyticsVertical;delete d.rpRequest})},100)}},cleanupResultsPage:function(){b.ComponentManager.remove(this.rpContainer,!1);this.rpContainer&&this.rpContainer.empty();this.rpLoaded=!1},cleanupFrontDoor:function(){var a=
this;setTimeout(function(){b.ComponentManager.remove(a.id("fd"))},800)},isCorrectRpLoaded:function(a){return 1===this.getChildElement("rp").find(".Base-Results-ResultsPage").length&&1===this.getChildElement("rp").find(f(a)).length},bindAccessibilityHandlers:function(){this.toggleKeyboardFocus(!1);e(document).on("keydown.ada",function(a){!b.globals.keyboardNav&&-1<h.indexOf(a.keyCode)&&this.toggleKeyboardFocus(!0)}.bind(this));e(document).on("mousemove.ada",this.toggleKeyboardFocus.bind(this,!1))},
toggleKeyboardFocus:function(a){b.globals.keyboardNav=a?!0:!1}})})(R9,jq||jQuery);(function(c,d){c.createComponentClass("hotels.search.HotelSearchPage","base.search.SearchPage",{options:{preloadResourcesForRP:c.config.getBoolean("ui.horizon.searchpage.hotels.preloadStyles",!0),isMomondo:!1,redirectSearchTypesToMap:[],openMapEvent:null},isMapOpen:!1,addEventHandlers:function(){var a=this;this.base();this.subscribe("searchform.submit",function(b){var c=b.url;a.cachedSearchData=b;c&&a.element.find(".Common-Layout-CountryPicker-Content .country-grid .link,.Common-Layout-CountryPicker-Content .country-grid .link .languageLink").each(function(){var a=
d(this),b=a.data("href");a.attr("href",[this.origin,c].join("/")).attr("data-href",b.substring(0,b.indexOf("\x26url\x3d")+5)+"/"+c)})});this.subscribe("hotels.results.dualViewMap.open",function(){a.isMapOpen=!0});this.subscribe("hotels.results.dualViewMap.closed",function(){a.isMapOpen=!1});c.question.answer("hotels.results.dualViewMap.isOpen",function(){return a.isMapOpen});this.subscribe("resultspage.streaming.start",function(b){b?a.cachedSearchData=b:a.cachedSearchData||(a.cachedSearchData={locationType:c.question.ask("hotels.results.searchType")});
a.isLocationSearch(a.cachedSearchData)!==a.isMapOpen&&c.events.publish("hotels.results.dualViewMap.toggle")});a.options.isMomondo&&this.subscribe("resultspage.filtersData.changed",function(b){0===Object.keys(b).length&&b.constructor===Object?a.element.addClass("filters-loading"):(a.element.removeClass("filters-loading"),0===Object.keys(b.neighborhoods.valueMap).length&&b.neighborhoods.valueMap.constructor===Object?a.element.addClass("no-neighborhood-filter"):a.element.removeClass("filters-loading"))});
this.subscribe("hotels.results.dualViewMap.open",function(){a.element.removeClass("map-closed");a.element.parent().removeClass("map-closed");a.element.addClass("map-open");a.element.parent().addClass("map-open")});this.subscribe("hotels.results.dualViewMap.closed",function(){a.element.removeClass("map-open");a.element.addClass("map-closed");a.element.parent().addClass("map-closed");a.element.parent().removeClass("map-open")})},useSamePageTransition:function(a){return a.goToHotelDetailsPage&&a.hotelId?
(a.navigateToResults=!0,a.stopSearch=!0,!1):this.base(a)},isLocationSearch:function(a){if(a&&a.locationType&&this.options.openMapEvent)for(var b=0;b<this.options.redirectSearchTypesToMap.length;b++)if(a.locationType===this.options.redirectSearchTypesToMap[b])return!0;return!1}})})(R9,jQuery);(function(d,e){R9.createComponentClass("common.maps.Styles",{init:function(){var b={BrownStyle:{styles:[{featureType:"landscape.man_made",elementType:"geometry",stylers:[{hue:"#996600"},{lightness:-10}]},{featureType:"administrative",elementType:"geometry",stylers:[{hue:"#996600"},{lightness:-10}]},{featureType:"poi.park",elementType:"geometry",stylers:[{hue:"#669900"},{lightness:-19}]},{featureType:"water",elementType:"geometry",stylers:[{hue:"#0099ff"},{lightness:43}]},{featureType:"poi.government",
elementType:"geometry",stylers:[{saturation:-100},{lightness:-15}]},{featureType:"poi.medical",elementType:"geometry",stylers:[{saturation:-100},{lightness:-15}]},{featureType:"poi.attraction",elementType:"geometry",stylers:[{saturation:-100},{lightness:-15}]},{featureType:"poi.place_of_worship",elementType:"geometry",stylers:[{saturation:-100},{lightness:-15}]},{featureType:"poi.school",elementType:"geometry",stylers:[{saturation:-100},{lightness:-15}]},{featureType:"poi.sports_complex",elementType:"geometry",
stylers:[{saturation:-100},{lightness:-15}]},{featureType:"road.highway",elementType:"geometry",stylers:[{lightness:38}]},{featureType:"road.arterial",elementType:"geometry",stylers:[{lightness:38}]}]},Satellite:{styles:[{featureType:"water",elementType:"geometry.fill",stylers:[{color:"#cdd9ea"},{saturation:-20}]},{featureType:"water",elementType:"labels.text.fill",stylers:[{color:"#95abcc"},{lightness:15}]},{featureType:"water",elementType:"labels.text.stroke",stylers:[{visibility:"off"},{saturation:-20},
{color:"#cdd9ea"}]},{featureType:"landscape",elementType:"geometry.fill",stylers:[{color:"#eeeeee"}]},{featureType:"road",elementType:"geometry.fill",stylers:[{color:"#e4e4e4"}]},{featureType:"road",elementType:"geometry.stroke",stylers:[{color:"#e4e4e4"}]},{featureType:"poi",elementType:"geometry.fill",stylers:[{color:"#dddddd"}]},{featureType:"poi.business",elementType:"geometry.fill",stylers:[{color:"#dddddd"}]},{featureType:"poi.government",elementType:"geometry.fill",stylers:[{color:"#dddddd"}]},
{featureType:"poi.medical",elementType:"geometry.fill",stylers:[{color:"#dddddd"}]},{featureType:"poi.park",elementType:"geometry.fill",stylers:[{color:"#e5e9db"}]},{featureType:"poi.place_of_worship",elementType:"geometry.fill",stylers:[{color:"#dddddd"}]},{featureType:"poi.school",elementType:"geometry.fill",stylers:[{color:"#dddddd"}]},{featureType:"poi.sports_complex",elementType:"geometry.fill",stylers:[{color:"#dddddd"}]},{featureType:"administrative",elementType:"labels.text.fill",stylers:[{color:"#686868"}]},
{featureType:"administrative",elementType:"labels.text.stroke",stylers:[{color:"#e4e4e4"},{visibility:"off"}]},{featureType:"road",elementType:"labels.text.fill",stylers:[{color:"#a8a8a8"}]},{featureType:"road",elementType:"labels.text.stroke",stylers:[{color:"#e4e4e4"},{visibility:"off"}]},{featureType:"poi",elementType:"labels.text.fill",stylers:[{color:"#686868"}]},{featureType:"poi",elementType:"labels.text.stroke",stylers:[{visibility:"off"},{color:"#e4e4e4"}]},{featureType:"poi",elementType:"labels.icon",
stylers:[{saturation:-100},{lightness:10},{gamma:1}]},{featureType:"transit",elementType:"labels.text.fill",stylers:[{color:"#686868"}]},{featureType:"transit",elementType:"labels.text.stroke",stylers:[{color:"#e4e4e4"},{visibility:"off"}]},{featureType:"transit",elementType:"labels.icon",stylers:[{saturation:-100},{lightness:20}]},{featureType:"administrative.country",elementType:"geometry.stroke",stylers:[{color:"#c8c8c8"},{weight:1}]},{featureType:"administrative.land_parcel",stylers:[{color:"#e4e4e4"}]}]}};
this.getStyle=function(a,c){return new google.maps.StyledMapType(a&&b[a]&&b[a].styles,{name:c||a})}}})})(R9,jQuery);(function(a,b){a.createComponentClass("common.maps.SinglePinpointMap",{map:void 0,mapElement:void 0,marker:void 0,options:{lat:void 0,lng:void 0,mapZoomLevel:void 0,iconUrl:void 0,fullscreenControl:!0,zoomControl:!0,draggable:!0,mapHeight:0},init:function(){a.Common.Widgets&&a.events.ready("common.maps.dependencies.loaded");this.mapElement=b("#"+this.id("map")).get(0);a.Maps.Google.load(b.proxy(this.initMap,this),this._namespace)},initMap:function(){var a=this,b={lat:this.options.lat,lng:this.options.lng};
this.map=new google.maps.Map(this.mapElement,{zoom:this.options.mapZoomLevel,center:b,scrollwheel:!1,mapTypeControl:!1,panControl:!1,scaleControl:!1,streetViewControl:!1,draggable:this.options.draggable,zoomControl:this.options.zoomControl,fullscreenControl:this.options.fullscreenControl,zoomControlOptions:{style:google.maps.ZoomControlStyle.SMALL,position:google.maps.ControlPosition.RIGHT_BOTTOM}});google.maps.event.addDomListener(window,"resize",function(){var b=a.map.getCenter();google.maps.event.trigger(a.map,
"resize");a.map.setCenter(b)});this.marker=new google.maps.Marker({position:b,map:this.map,icon:this.options.iconUrl});0<this.options.mapHeight&&(this.mapElement.style.height=this.options.mapHeight+"px")}})})(R9,jQuery);R9.events.when("common.maps.dependencies.loaded",function(){R9.Common.Widgets.Maps.InfoWindows.InfoWindowFactory.registerProduct("SEMTopAttractionDetails",{getMapElement:function(){return jq(".map")},selectLandmark:function(a){var b=this.getMapElement();b.find(".attractions .selected").removeClass("selected");b.find(".attractions [data-id\x3d"+a+"]").addClass("selected")},createProduct:function(a,b){jq.extend({},{},b);b=a.getData();var f=jq.extend(new R9.Common.Widgets.Maps.InfoWindows.Types.InfoWindowTypeBase,
{getMarker:function(){return a},getClass:function(){return"infoWindowBoxhotelMiniDetails SEMTopAttractionDetails clearfix"},canClose:function(){return c},getView:function(){return e}}),c=!0,e=jq("\x3cdiv/\x3e",{"class":"resultWrapper defaultWrapper"}).mouseenter(function(){c=!1}).mouseleave(function(){c=!0}),d=a.getData().getName?a.getData().getName():a.getData().name,d=jq("\x3cdiv/\x3e",{id:R9.Common.Utils.getId(),"class":"placeName",html:d});e.append(d);this.selectLandmark(b.getId());return f}})});(function(c){function d(a){this.nearbySearchRadius=600;if(!a.map)throw Error("PlacesService requires a Google Map Object to initialize");if(!a.logPrefix)throw Error("PlacesService requires a logPrefix for usage monitoring");if(window.google&&window.google.maps)this.map=a.map,this.statusCode=google.maps.places.PlacesServiceStatus,this.service=new google.maps.places.PlacesService(this.map);else throw Error("Cannot initialize PlacesService. Google Maps cannot be found.");this.asyncReqQueue=new c.utils.AsyncRequestQueue({})}
function f(a){if(!a.map)throw Error("PlacesService requires a Google Map Object to initialize");var b=a.map.getDiv();return b?(e[b]||(e[b]=new d(a)),e[b]):null}var e={};["nearbySearch","searchNearby","radarSearch","getPlacePredictions"].forEach(function(a){d.prototype[a]=function(b){var g=this;c.Analytics.api.trackEvent("placesServices/"+a+"/"+this.logPrefix);return this.asyncReqQueue.createRequest(function(c){g.service[a](b,function(a,b){g.processResult(a,b,c)});return c})}});d.prototype.processResult=
function(a,b,c){b===this.statusCode.OK?c.resolve(a):b===this.statusCode.OVER_QUERY_LIMIT?c.reject(this.asyncReqQueue.REQUEUE):b===this.statusCode.ZERO_RESULTS?c.resolve([]):c.reject(b)};c.publish("maps.PlacesService.getInstance",f);c.events.ready("maps.PlacesService.initialized",f)})(R9);(function(e,g){e.createComponentClass("common.maps.NearbyTransitDialog",{placesService:null,transitDialog:null,destroyed:!1,placeTypesToDisplay:["subway_station","train_station"],templates:{dialogContent:"dialogContent",googleAttribution:"googleAttribution"},options:{latitude:null,longitude:null,isMetricDistance:!1,proximityMessages:{shortUnits:"",longUnits:""},locationFormatString:"%l",distanceFormatString:"%d"},inlineComponentsReady:function(){this.options.latitude&&this.options.longitude&&e.events.when("hotels.results.search.finished",
this.initDialog.bind(this))},initDialog:function(){var a=this,b=this;e.events.when("horizon.hotels.maps.placesService.loaded",function(c){if(!b.destroyed){var d=a.setupRequest();b.placesService=c;b.placesService.searchNearby(d).then(b.createDialog.bind(b,d))}})},createDialog:function(a,b){this.destroyed||(a=this.sortResults(a,b),a=this.filterResults(a),0<a.length&&(a=this.generateTransitHtml(a),this.renderDialog(a)))},setupRequest:function(){var a=new google.maps.LatLng(this.options.latitude,this.options.longitude);
if(a&&a.lat()&&a.lng())return{location:a,radius:"2000",types:this.placeTypesToDisplay,rankBy:google.maps.places.RankBy.DISTANCE}},sortResults:function(a,b){return b.map(function(c){c.distance=google.maps.geometry.spherical.computeDistanceBetween(a.location,c.geometry.location);return c}).sort(function(a,b){return(a.distance||-1)-(b.distance||-1)})},filterResults:function(a){var b=a.map(function(a){return a.name});return a.filter(function(a,d){var c=null;b.some(function(b,d){return-1<a.name.indexOf(b)||
-1<b.indexOf(a.name)?(c=d,!0):!1});return c===d}).slice(0,4)},generateTransitHtml:function(a){var b=this,c=e.template.renderElement(this.templates.dialogContent),d=g("\x3cul\x3e").addClass("transitList"),f=this.generateAttributionHtml(a);a.forEach(function(a){var c=b.getNearbyMessage(a.distance,a.name),f=g("\x3cli\x3e").addClass("nearbyItem").attr("id",a.id).data("place",a.name);f.append("\x3cspan\x3e").addClass("nearbyName").html(a.name);f.append("\x3cspan\x3e").addClass("nearbyDistance").html(c);
d.append(f)});c.append(d);c.append(f);return c},generateAttributionHtml:function(a){var b=g("\x3cdiv\x3e").addClass("attribution"),c=e.template.renderElement(this.templates.googleAttribution);a=a.reduce(function(){var a=0<arguments.length&&void 0!==arguments[0]?arguments[0]:"",b=1<arguments.length?arguments[1]:void 0;return b.html_attributions&&b.html_attributions.length&&-1===a.indexOf(b.html_attributions)?a+b.html_attributions.concat():a},"");b.append(a);b.append(c);return b},getNearbyMessage:function(a,
b){var c;500>a?(a=(this.options.isMetricDistance?a:1.0936133*a).toFixed(0),c=this.options.proximityMessages.shortUnits):(a=Math.round(100*(this.options.isMetricDistance?.001*a:6.21371192E-4*a))/100,c=this.options.proximityMessages.longUnits);return this.replaceTemplatePlaceholders(c,b,a)},replaceTemplatePlaceholders:function(a,b,c){a=a.replace(this.options.locationFormatString,b);return a=a.replace(this.options.distanceFormatString,c)},renderDialog:function(a){a&&(this.transitDialog=this.element.toolTip({content:a,
extraClass:"Common-Maps-NearbyTransitDialog-tooltip looseMaxWidth",position:"right",showImmediately:!1,closeOnBodyClick:!1,keepOpenOnContentHover:!0,closeDelay:1E3}),this.element.removeClass("empty"))},destroy:function(){this.destroyed=!0;this.base()}})})(R9,$);(function(b,d){b.createComponentClass("common.maps.NearbyTransitBadge",{placesService:null,placeTypesToDisplay:["subway_station","train_station"],options:{latitude:null,longitude:null},inlineComponentsReady:function(){this.options.latitude&&this.options.longitude&&b.events.when("hotels.results.search.finished",this.setupBadge.bind(this))},setupBadge:function(){var a=this;b.events.when("horizon.hotels.maps.placesService.loaded",function(b){var c=a.setupRequest();a.placesService=b;a.placesService.searchNearby(c).then(function(b){0<
b.length&&a.element.removeClass("empty")})})},setupRequest:function(){var a=new google.maps.LatLng(this.options.latitude,this.options.longitude);if(a&&a.lat()&&a.lng())return{location:a,radius:"500",types:this.placeTypesToDisplay}}})})(R9,$);function validateEmail(a){if(!a||!a.match)return!1;a=a.match(/^[A-Z0-9._%+-]{1,63}@(?:[A-Z0-9-]+\.){1,125}[A-Z]{2,63}$/i);return!!(a&&a[0]&&a[0].length)}function replaceArgs(){for(var a=arguments[0],b=1;b<=arguments.length;b++)a=a.replace("{"+(b-1)+"}",arguments[b]);return a}R9.metacookie=R9.metacookie||{};R9.metacookie.saveQueue=R9.metacookie.saveQueue||[];
function saveQueuedMetaCookie(){if(0!=R9.metacookie.saveQueue.length){var a=R9.metacookie.saveQueue[0];jq.ajax({type:"POST",url:"/k/cookie",data:{action:"setmeta",metacookie:a.name,metavalue:a.value,formtoken:R9.globals.formtoken},complete:function(){R9.metacookie.saveQueue.shift();saveQueuedMetaCookie()},success:function(){a.callback()}})}}function setMetaCookie(a,b,c){R9.metacookie.saveQueue.push({name:a,value:b,callback:c||jq.noop});1==R9.metacookie.saveQueue.length&&saveQueuedMetaCookie()}
function deleteMetaCookie(a,b){"function"!==typeof b&&(b=$.noop);jq.ajax({type:"POST",url:"/k/cookie",data:{action:"deletemeta",metacookie:a,formtoken:R9.globals.formtoken},success:b})}jq.ajaxPrefilter("script",function(a){a.cache=!0});(function(c){c.createComponentClass("common.core.RealUserMeasurementsComponent",{options:{fullstoryEnabled:!1},trackedSubmit:!1,addEventHandlers:function(){this.base();this.subscribe("searchform.submit",this.onSearchSubmit.bind(this))},onSearchSubmit:function(a){if(!this.trackedSubmit&&this.options.fullstoryEnabled&&window&&"FS"in window&&a&&a.vertical){this.trackedSubmit=!0;a="did"+this.fixCase(a.vertical)+"Search_bool";var b={};b[a]=!0;FS.setUserVars(b)}},fixCase:function(a){return a.toLowerCase().replace(/(^| )(\w)/g,
function(a){return a.toUpperCase()})}})})(R9);(function(a,c){a.createComponentClass("common.core.MarketingId",{options:{syncUrl:"/s/run/kmkid/sync",setUrl:"/s/run/kmkid/set",suggestedKmkid:null,masterHost:null,runSyncScript:!1},init:function(){this.options.runSyncScript&&this.runSyncAndSet()},runSyncAndSet:function(){c.ajax({type:"POST",url:this.options.masterHost+this.options.syncUrl,data:{suggestedKmkid:this.options.suggestedKmkid},xhrFields:{withCredentials:!0},success:this.onSyncFinished.bind(this)})},onSyncFinished:function(b){b&&(window.R9&&
a.globals&&a.globals.analytics&&a.globals.analytics.pixelContext&&(a.globals.analytics.pixelContext.kmkid=b.kmkid),this.runSet(b.kmkid))},runSet:function(b){c.ajax({type:"POST",headers:{"X-CSRF":a.globals.formtoken},url:this.options.setUrl,data:{kmkid:b}})}})})(R9,jQuery);(function(d,f,e,c){d.createComponentClass("common.core.FullyInvisibleCaptcha",{options:{enabled:!1},init:function(){var a=this;this.options.enabled&&(this.setupCaptchaCallback(),this.initAPI().then(function(){a.fireCaptcha()}))},setupCaptchaCallback:function(){var a=this;c.onReCaptchaSubmit=function(b){a.captchaResult(b)};c.onReCaptchaError=function(a){console.log(a)}},initAPI:function(){var a=f.Deferred();c.recaptchaReady=function(){a.resolve()};var b=e.createElement("script");b.type="text/javascript";
b.async=!0;b.src="https://www.google.com/recaptcha/api.js?onload\x3drecaptchaReady\x26render\x3dexplicit";e.getElementById("recaptcha-root").appendChild(b);return a},fireCaptcha:function(){"undefined"!==typeof grecaptcha&&(grecaptcha.render("captcha",{},!0),grecaptcha.execute())},captchaResult:function(a){d.action.execute("common.core.FullyInvisibleCaptchaAction",{data:a})}})})(R9,jQuery,document,window);(function(e,d){e.createComponentClass("common.core.FastlyTiming",{options:{runTest:!1,measurementUrl:"/fastly-timer",logUrl:"/s/run/fastlytimerlog"},init:function(){this.options.runTest&&this.runTimingRequest()},runTimingRequest:function(){d.ajax({type:"POST",url:this.options.measurementUrl,success:this.logResult.bind(this)})},logResult:function(c,a,b){b&&c&&c.cluster&&(a=b.getResponseHeader("x-served-by"),b=b.getResponseHeader("x-timer"),a&&b&&(a=a.split(" "),a=a[a.length-1].split("-"),d.ajax({type:"POST",
url:this.options.logUrl,data:{cluster:c.cluster,timer:b,fastlyNode:a[a.length-1]}})))}})})(R9,jQuery);(new R9.logger).timeEnd("combined");