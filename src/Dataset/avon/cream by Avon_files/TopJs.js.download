function loadAppModules(){var n=["ngAria","ngSanitize","hmTouchEvents","ui.bootstrap"];return(isMobile()||n.push("ui.select2"),isHomepage())?n:(n.push("rzModule","ngclipboard"),n)}function certonaRecommendations(n){var t=angular.element(document.body).injector(),i=t.get("productRecommendationsService");i.LoadRecommendedProductsCertonaCallback(n.resonance)}function dropdownFormatting(n){var t=n.element,i=$(t).data("imagesrc"),r=$(t).data("displayimage"),u=$(t).data("imagealt");return i&&r===!0?"<img src='"+i+"' alt='"+u+"' />"+n.text:n.text}function Autofill(){return{require:"ngModel",link:function(n,t,i,r){n.$on("autofill:update",function(){r.$setViewValue(t.val())})}}}function BagQtyValidDirective(){return{require:"ngModel",link:function(n,t,i,r){r.$parsers.unshift(function(n){return/^[0-9]\d{0,1}$/.test(n)?(r.$setValidity("avonQtyValid",!0),n):(r.$setValidity("avonQtyValid",!1),undefined)})}}}function BagQtyChangeDirective(){return{restrict:"A",require:"ngModel",link:function(n,t,i,r){t.bind("keyup input",function(){r.$modelValue!=null&&onBagChangeQtyThrottled(n,t,i,r)})}}}function CaretFix(){return{restrict:"AC",link:function(n,t){var i=$(t);i.on("focus",function(){setTimeout(function(){var n=i[0],t;typeof n.selectionStart=="number"?n.selectionStart=n.selectionEnd=n.value.length:typeof n.createTextRange!="undefined"&&(n.focus(),t=n.createTextRange(),t.collapse(!1),t.select())},100)})}}}function CompileDirective(n){return function(t,i,r){t.$watch(function(n){return n.$eval(r.compile)},function(r){r&&(i.html(r),n(i.contents())(t))})}}function ConfirmFieldDirective(){return{restrict:"A",require:"ngModel",link:function(n,t,i,r){n.$watch(i.ngModel,function(){var t=n.$eval(i.confirmField),u=n[t.form],f=u[t.matchWith].$viewValue,e=u[i.name].$viewValue;f!==e?r.$setValidity("fieldMatch",!1):r.$setValidity("fieldMatch",!0)})}}}function ExpandableDirective(){return{restrict:"A",link:function(n,t,i){var r=$(t);r.addClass("Expandable");r.on("click",function(n){if(!i.expandable||i.expandable!=="false"){var t=$(n.target);t.parents(".ExpandableContent").closest(".Expandable")[0]!=r[0]&&r.toggleClass("Expanded")}});r.on("click",".ExpandableClose",function(){r.removeClass("Expanded")})}}}function FallbackSrcDirective(n){return{restrict:"A",link:function(t,i,r){i.on("load",function(){var r=i.attr("src"),t=new Image,u;if(t.src=r,t.width*t.height==1){i.trigger("error");return}u={element:i,src:r};n.$broadcast("FallbackSrc.ImageFound",u)});i.on("error",function(){var u,t;if(!n.IsPhantom&&(u=new Image,u.src=i.attr("src"),!(u.width*u.height>1))){t=angular.element(this);try{r.fallbackSrc.length>0?(t.attr("src",r.fallbackSrc),r.dontShow&&r.dontShow==="true"&&n.$broadcast("FallbackSrc.FallbackImageLoaded",t)):(t.css("display","none"),t.attr("data-removed","1"),n.$broadcast("FallbackSrc.NoImageFound",t))}catch(f){t.css("display","none");t.attr("data-removed","1");n.$broadcast("FallbackSrc.NoImageFound",t)}finally{t.off("error")}}})}}}function FocusMe(n){return{require:"ngModel",scope:{trigger:"@focusMe"},link:function(t,i){t.$watch("trigger",function(t){t==="true"&&n(function(){i[0].focus()},500)})}}}function IncludeRepIdDirective(n){return{restrict:"A",link:function(t,i,r){AvonModule.AvonScope.SessionService.WhenReady().then(function(){var t=r.src;if(t){t.match(/[?&]repid=/gi)||(t+=t.indexOf("?")<0?"?repid=":"&repid=");r.$set("src",n.appendRepIdToPassedUrl(t));return}})}}}function input(){return{require:"?ngModel",priority:1,restrict:"E",link:function(n,t,i,r){if(r&&i.type==="email"){r.$parsers.pop();var u=function(n){var i=r.$name,t=!n||/^[\w-]+(?:\.[\w-]+)*@(?:[\w-]+\.)+[a-zA-Z]{2,7}$/.test(n);return r.$setValidity("email",t),n};r.$parsers.push(u)}}}}function inputMaxlength(){return{restrict:"A",require:"ngModel",link:function(n,t,i,r){function f(n){var i=$(t).parent().find(".CharsRemaining");i.length&&i.html((u-n).toString())}function e(n){if(n.length>u){var t=n.substring(0,u);r.$setViewValue(t);r.$render();n=t}return f(n.length),n}var u=Number(i.inputMaxlength);$(t).attr("maxlength",u);_.defer(function(){f($(t).val().length)});r.$parsers.push(e)}}}function inputWaterMark(){return{require:"?ngModel",priority:1,restrict:"E",link:function(n,t,i,r){if(r&&(i.type==="email"||i.type==="text"||i.type==="password"||i.type==="tel")){if(t.parent(".InputContainer").find("label").length==0||t.hasClass("NoInlineWaterMark"))return;t.parent(".InputContainer").addClass("inlineWaterMark");_.defer(function(){var n=!t.val()||t.val().length==0;n===!1&&t.parent(".InputContainer").hasClass("applyInlineWaterMark")==!1&&t.parent(".InputContainer").addClass("applyInlineWaterMark")});t.bind("focus",function(){var n=t.parent(".InputContainer");n.hasClass("applyInlineWaterMark")==!1&&n.addClass("applyInlineWaterMark")}).bind("blur",function(){if(!t.val()||t.val().length==0){var i=t.parent(".InputContainer");n.IsIE11()?document.hasFocus()&&i.removeClass("applyInlineWaterMark"):i.removeClass("applyInlineWaterMark")}})}}}}function linenumberField(){return{restrict:"AC",priority:10,link:function(n,t,i){var u=i.linenumberField,r;if(u&&(r=n.$eval(u),r.MaxLength&&(t.attr("maxlength",r.MaxLength),r.AutotabTo)))t.on("keyup",function(n){var i=n.charCode||n.keyCode||0;i!=8&&t.val().length===r.MaxLength&&$(r.AutotabTo).focus()});t.on("keydown keypress",function(n){var i=n.charCode||n.keyCode||0,r=!0,f=$(this),u;switch(i){case 8:case 9:case 13:case 46:case 37:case 39:r=!0;break;default:n.shiftKey===!0&&(r=!1);r&&(u=f.data("maxlength")||t.attr("maxlength"),$.isNumeric(u)&&u>0&&f.val().length>=u&&(r=!1));r&&(r=i>=48&&i<=57||i>=96&&i<=105||i===173||i===45||i===189||i===109);n.ctrlKey===!0&&(r=!0)}return r?!0:(n.preventDefault(),!1)})}}}function numericField(){return{restrict:"AC",priority:10,link:function(n,t,i){var u=i.numericField,r;if(u&&(r=n.$eval(u),r.MaxLength&&(t.attr("maxlength",r.MaxLength),r.AutotabTo)))t.on("keyup",function(n){var i=n.charCode||n.keyCode||0;i!=8&&t.val().length===r.MaxLength&&$(r.AutotabTo).focus()});t.on("keydown keypress",function(n){var r=n.charCode||n.keyCode||0,i=!0,f=$(this),u,e;switch(r){case 8:case 9:case 13:case 46:case 37:case 39:i=!0;break;case 16:case 223:i=!1;break;default:i&&(u=f.data("maxlength")||t.attr("maxlength"),e=f.val().length-(t.get()[0].selectionEnd-t.get()[0].selectionStart),$.isNumeric(u)&&u>0&&e>=u&&window.getSelection().toString()===""&&(i=!1));i&&(i=r>=48&&r<=57||r>=96&&r<=105);n.ctrlKey===!0&&(i=!0);n.metaKey===!0&&(i=!0)}return i?!0:(n.preventDefault(),!1)})}}}function phoneNumber(n,t){return{restrict:"A",require:"ngModel",priority:1,link:{post:function(i,r,u,f){var e=function(){for(var t=r.val().replace(/[^0-9.]/g,""),i=r[0].selectionStart;t[0]==="0"||t[0]==="1";)t=t.substr(1);r.val(n("telephone")(t,!1));(i===4||i===8)&&i++;r[0].selectionStart=i;r[0].selectionEnd=i;f.$setViewValue(t)};f.$parsers.push(function(n){return n.replace(/[^0-9.]/g,"")});f.$render=function(){(f.$viewValue==="1"||f.$viewValue==="0")&&(f.$viewValue="");r.val(n("telephone")(f.$viewValue,!1))};r.bind("keydown",function(n){var i=n.keyCode;i===9||i===91||15<i&&i<19||37<=i&&i<=40||t.defer(e)});r.bind("paste cut",function(){t.defer(e)})}}}}function phonenumberField(){return{restrict:"AC",priority:10,link:function(n,t,i){var u=i.phonenumberField,r;if(u&&(r=n.$eval(u),r.MaxLength&&(t.attr("maxlength",r.MaxLength),r.AutotabTo)))t.on("keyup",function(n){var i=n.charCode||n.keyCode||0;i!=8&&t.val().length===r.MaxLength&&$(r.AutotabTo).focus()});t.on("keydown keypress",function(n){var i=n.keyCode||n.which||0,r=!0,f=$(this),u;switch(i){case 8:case 9:case 13:case 46:case 37:case 39:r=!0;break;default:n.shiftKey===!0&&(r=!1);r&&(u=f.data("maxlength")||t.attr("maxlength"),$.isNumeric(u)&&u>0&&f.val().length>=u&&(r=!1));r=r&&f.val().length>0?i>=48&&i<=57||i>=96&&i<=105||n.which==40||n.which==41||i===173||i===45||i===189||i===109:i>=48&&i<=57||i>=96&&i<=105||n.which==40||n.which==41;n.ctrlKey===!0&&(r=!0)}return r?!0:(n.preventDefault(),!1)})}}}function preventDefault(){return{restrict:"AC",link:function(n,t){t.on("click",function(n){return n.preventDefault(),!1})}}}function SecondaryImageDirective(n){return{restrict:"A",link:function(t,i){i[0].onload=function(){var t=i.attr("src"),f=t.lastIndexOf("_"),e=t.lastIndexOf("."),r={element:i,src:t},o=t.substring(f+1,e),u=parseInt(o);isNaN(u)?n.$broadcast("SecondaryImage.ImageFound",r,0):n.$broadcast("SecondaryImage.ImageFound",r,u)};i.on("error",function(){var r=new Image,u;if(r.src=i.attr("src"),!(r.width*r.height>1)){u=angular.element(this);try{var t=r.src,e=t.lastIndexOf("_"),o=t.lastIndexOf("."),f=t.substring(e+1,o);parseInt(f)<10?(t=t.substring(0,e+1)+(parseInt(f)+1)+t.substring(o),u.attr("src",t)):parseInt(f)>=10&&n.$broadcast("SecondaryImage.NoImageFound",u)}catch(s){n.$broadcast("SecondaryImage.NoImageFound",u)}}})}}}function SelectRegularExpressionValidator(){return{restrict:"A",require:"ngModel",link:function(n,t,i,r){n.$watch(i.ngModel,function(t){var u=n.$eval(i.ngPattern),f=new RegExp(u);f.test(t)?r.$setValidity("invalidValue",!0):r.$setValidity("invalidValue",!1)})}}}function SingleExpandableDirective(){return{restrict:"A",link:function(n,t){var i=$(t);i.addClass("SingleExpandable");$(document).on("click",function(){$(".SingleExpandable.Expanded").removeClass("Expanded")});i.on("click",function(n){n.stopPropagation();var t=$(n.target);t.hasClass("ExpandableClose")?i.removeClass("Expanded"):(t[0]==i[0]||t.parents(".SingleExpandable")[0]!=i[0])&&($(".SingleExpandable.Expanded").removeClass("Expanded"),i.toggleClass("Expanded"))})}}}function textareaWaterMark(){return{restrict:"E",require:"ngModel",link:function(n,t){t.parent(".InputContainer").find("label").length==0||t.hasClass("NoInlineWaterMark")||(t.attr("contact-us-form")?t.parent(".InputContainer").addClass("inlineWaterMark contactUsTextareaInlineWaterMark"):t.parent(".InputContainer").addClass("inlineWaterMark textareaInlineWaterMark"),_.defer(function(){var n=!t.val()||t.val().length==0;n===!1&&t.parent(".InputContainer").hasClass("applyInlineWaterMark")==!1&&t.parent(".InputContainer").addClass("applyInlineWaterMark")}),t.bind("focus",function(){var n=t.parent(".InputContainer");n.hasClass("applyInlineWaterMark")==!1&&(n.addClass("applyInlineWaterMark"),t.data("placeholder",t.attr("placeholder")).attr("placeholder",""))}).bind("blur",function(){if(!t.val()||t.val().trim().length==0){t.val().length>0&&t.val().trim().length==0&&t.val("");var n=t.parent(".InputContainer");n.removeClass("applyInlineWaterMark");t.attr("placeholder",t.data("placeholder"))}}))}}}function ViewmoreDirective(){return{restrict:"E",link:function(n,t,i){var r=$(t),s=i.moretext||"Read More�",e=i.lesstext,o=i.href,u=i.applyclass,f;u=u?" "+u:"";f=function(){var n=r.find(".ViewMoreContainer").height(),t=r.find(".ViewMoreContent").height();n>=t?r.addClass("FullyVisible"):r.removeClass("FullyVisible")};n.$watch(function(){r.hasClass("Expanded")||f()});r.addClass("ViewMore");r.wrapInner("<div class='ViewMoreContent'><\/div>");r.wrapInner("<div class='ViewMoreContainer"+u+"'><\/div>");r.append("<div class='fadeout'><\/div>");r.append("<div class='ViewMoreBtn'>");r.append("<a class='ViewMoreButton'>"+s+"<\/a>");e&&r.append("<a href='' class='ViewLessButton'>"+e+"<\/a>");r.append("<\/div>");r.find(".ViewMoreButton").click(function(t){o?n.RedirectToUrl(o,!0):(t.preventDefault(),r.removeClass("FullyVisible"),r.addClass("Expanded"))});r.find(".ViewLessButton").click(function(n){n.preventDefault();r.removeClass("Expanded");$("html").hasClass("IsMobileSite")&&$("#AddToBag").scrollintoview()});f()}}}function zipCode(n,t){return{restrict:"A",require:"ngModel",priority:1,link:{post:function(i,r,u,f){var e=function(){var i=r.val().replace(/[^0-9.]/g,""),t=r[0].selectionStart;r.val(n("formatzipcode")(i,!1));t===6&&t++;r[0].selectionStart=t;r[0].selectionEnd=t;f.$setViewValue(i)};f.$parsers.push(function(n){return n.replace(/[^0-9.]/g,"")});f.$render=function(){r.val(n("formatzipcode")(f.$viewValue,!1))};r.bind("keydown",function(n){var i=n.keyCode;i===91||15<i&&i<19||37<=i&&i<=40||t.defer(e)});r.bind("paste cut",function(){t.defer(e)})}}}}function validateAddress(){return{restrict:"A",require:"ngModel",link:function(n,t,i,r){r.$parsers.unshift(function(n){var i=r.$name,t=!n||/^[\\0-9A-Za-zñÑáÁéÉíÍóÓúÚüÜ\\/\\.\\'\\,\\#\\ \\s\\-]+$/.test(n);return r.$setValidity("validateAddress",t),n})}}}function validateCity(){return{restrict:"A",require:"ngModel",link:function(n,t,i,r){var u=function(n){var i=r.$name,t=!n||/^[A-Za-zñÑáÁéÉíÍóÓúÚüÜ\.\-\ ]+$/.test(n);return r.$setValidity("validateCity",t),n};r.$parsers.unshift(u);r.$formatters.unshift(u)}}}function validateMustqqualto(){return{restrict:"A",require:"ngModel",link:function(n,t,i,r){r.$parsers.unshift(function(t){var u=i.validateMustequalto,f=_.find(n,function(n){return n&&n[u]}),e=f[u].$viewValue,o=!t||t===e;return r.$setValidity("mustequalto",o),t})}}}function validateName(){return{restrict:"A",require:"ngModel",link:function(n,t,i,r){r.$parsers.unshift(function(n){var i=r.$name,t=!n||/^(-)?[A-Za-zñÑáÁéÉíÍóÓúÚüÜ'\\s\\ \\.]+(-)?[A-Za-zñÑáÁéÉíÍóÓúÚüÜ'\\s\\ \\.]*(-)?$/.test(n);return r.$setValidity("validateName",t),n})}}}function validatePhone(){return{restrict:"A",require:"ngModel",priority:0,scope:{field:"@validatePhone",maxlength:"@maxlength"},link:{pre:function(n,t,i,r){r.$parsers.unshift(function(t){n.maxlength||(n.maxlength=3);t.length===10&&t.indexOf("-")===-1&&(t=t.substr(0,3)+"-"+t.substr(3,3)+"-"+t.substr(6,4));var i=new RegExp("^[0-9-]{"+n.maxlength+"}$"),u=!t||i.test(t);return r.$setValidity("format",u),t&&n.field==="Area"&&parseInt(t.substr(0,1))<2&&r.$setValidity("format",!1),t})}}}}function validateRegex(){return{restrict:"A",require:"ngModel",link:function(n,t,i,r){r.$parsers.unshift(function(n){var f=r.$name,t=new RegExp(i.validateRegex),u=!n||t.test(n);return r.$setValidity("regex",u),n})}}}function validateZipcode(){return{restrict:"A",require:"ngModel",link:function(n,t,i,r){r.$parsers.unshift(function(n){var i=r.$name,t=new RegExp("^\\d{5}(-?\\d{4})?$");return r.$setValidity("validateZipcode",t.test(n)),n})}}}function validateZipCodeRecognized(n){return{restrict:"A",require:"ngModel",link:function(t,i,r,u){u.zipCodesValidated=[];var f=i,e=function(t){t=t.toString();var i=!0;return n.get("/api/validation/isrecognizedzipcode/"+t,{cache:!1}).then(function(n){n.data.valid||(i=!1)},function(){return!0}),i};u.$parsers.unshift(function(n){var o=u.$name,r=!0,t,i;return(o==="CheckoutStep1Model_BillingZip"&&(t=f.closest("form"),t&&(i=t.find("input#SharedAddressDetailsInput"),i&&(r=!i[0].checked))),!n||n.length!=5&&n.length!=10)?(u.$setValidity("validateZipcodeRecognized",!0),n):(r&&(e(n)?u.$setValidity("validateZipcodeRecognized",!0):u.$setValidity("validateZipcodeRecognized",!1)),n)})}}}function validateZipcodeRequired(){return{restrict:"A",require:"ngModel",link:function(n,t,i,r){var u=function(n){var u=r.$name,i=$(t).closest("form");i.hasClass("ZipCodeRequired")?n?r.$setValidity("zipcoderequired",!0):r.$setValidity("zipcoderequired",!1):r.$setValidity("zipcoderequired",!0)};r.$parsers.unshift(function(n){return u(n),n});r.$formatters.unshift(function(n){return u(n),n})}}}var __extends,AjaxError,BrandType,CategoryType,CanBuy,CreditCardDisplayMode,CreditCardType,DeliveryType,FindARepSearchType,ImageType,InterestType,Month,OrderStatus,OrderType,PaymentType,ApplePayClientStatus,ShippingOptionCode,PromoConditionalRuleReason,TabToggleMode,VariantType,RestrictedAutoRepType,CarouselType,BootstrapEnvironment,CustomerType,WishListItemActionButton,WishListShareType,DualPurchase,ConsolidationOption,AddressType,QuantityFieldAction,LineSeparatorType,AddBagItem,BaseAvonService,BagServiceModule,SessionServiceModule,CdnServiceModule,UrlServiceModule,BaseAngularController,BaseAnimations,AllCategoryModule,EnglishMessages,SpanishMessages,ModalServiceModule,ResetPasswordModel,LoginServiceModule,SubscribeServiceModule,KeyCode,AvonModule,ChangeRepModule,ContentModule,ContactModule,EarmarkModule,FindARepModule,FundraiserBannerModule,ProductRecommendationsServiceModule,Language,ProductServiceModule,ProductModule,JoinWaitlistTooltipModule,MiniSiteModule,NotifyMeModule,PageTimeoutWarningModule,PayPalServiceModule,PayPalSmartButtonModule,ProductDetailModule,ProductListServiceModule,ProductListControlModule,SortingCriteriaProviderModule,RepCouponModule,SearchResultsModule,SimpleProductListModule,SiteMapModule,EmailSubscriptionSource,SubscribeModule,VideoShareModule,WelcomeBackModule,SocialShareServiceModule,WishListItem,WishListServiceModule,WishListModule,WishListEmailShareModule,AccordionModule,HtmlEllipsisModule,AutoFocusModule,AvonFormModule,onBagChangeQtyThrottled,CarouselModule,clearServerValidationModule,CustomScrollbarModule,IframeModule,ImageLazyLoadModule,ModalDirectiveModule,NgFocusOutModule,LazyLoadModule,OnLoadDirectiveModule,PinchZoomCanvasModule,ProductImagesCarouselModule,StackGridModule,TooltipContainerModule,TooltipContentModule,ApplyCouponType,CouponValidationCode,AddressHelper,AutoReplenishStatusCode,AutoReplenishStatusCodeHelper,CreditCardUpdateStatus,BreadcrumbTypes,ProductCategorySection,Level,SortOption,SearchTermType,SliderFacetModelNames,HtmlTarget,Platform,AddingToBagStatus,PurchaseOption,VideoType,TrackingAddToCartType,TrackingEventType,NavigationModule,CertonaPageType,AddressVerificationModule,AnalyticsServiceModule,AutoReplenishModule,BlogServiceModule,CelebrosServiceModule,ChangeRepServiceModule,ConfirmationServiceModule,ContactServiceModule,CreditCardServiceModule,CustomerServiceModule,DigitalCatalogModule,FacebookServiceModule,FindARepServiceModule,FontTrackingServiceModule,FundraiserModule,OnlineStoreModule,HistoryServiceModule,IntersectionObserverModule,LoginModalServiceModule,LpmContextMenuServiceModule,NotifyMeSerivceModule,RegistrationServiceModule,RepQueryStringParameterModule,SearchServiceModule,SweepstakesModule,TooltipModule,TrackingServiceModule,WaitHelperModule,StringExtensions,ArrayExtensions,Geocode,ProductHelper,Directives,ValidateNotAvailableSoonModule,ValidateSkuNotSubscribedModule,ValidateZipCodeAndGetDetailsModule;!function(){var s="object"==typeof self&&self.self===self&&self||"object"==typeof global&&global.global===global&&global||this||{},gt=s._,a=Array.prototype,w=Object.prototype,rt="undefined"!=typeof Symbol?Symbol.prototype:null,ni=a.push,h=a.slice,c=w.toString,ut=w.hasOwnProperty,ti=Array.isArray,ft=Object.keys,et=Object.create,b=function(){},n=function(t){return t instanceof n?t:this instanceof n?void(this._wrapped=t):new n(t)},ot,o,t,d,l,ct,e,g,nt,tt,v,y,yt,pt,wt,dt,p;"undefined"==typeof exports||exports.nodeType?s._=n:("undefined"!=typeof module&&!module.nodeType&&module.exports&&(exports=module.exports=n),exports._=n);n.VERSION="1.9.1";o=function(n,t,i){if(void 0===t)return n;switch(null==i?3:i){case 1:return function(i){return n.call(t,i)};case 3:return function(i,r,u){return n.call(t,i,r,u)};case 4:return function(i,r,u,f){return n.call(t,i,r,u,f)}}return function(){return n.apply(t,arguments)}};t=function(t,i,r){return n.iteratee!==ot?n.iteratee(t,i):null==t?n.identity:n.isFunction(t)?o(t,i,r):n.isObject(t)&&!n.isArray(t)?n.matcher(t):n.property(t)};n.iteratee=ot=function(n,i){return t(n,i,1/0)};var r=function(n,t){return t=null==t?n.length-1:+t,function(){for(var u,f=Math.max(arguments.length-t,0),r=Array(f),i=0;i<f;i++)r[i]=arguments[i+t];switch(t){case 0:return n.call(this,r);case 1:return n.call(this,arguments[0],r);case 2:return n.call(this,arguments[0],arguments[1],r)}for(u=Array(t+1),i=0;i<t;i++)u[i]=arguments[i];return u[t]=r,n.apply(this,u)}},st=function(t){if(!n.isObject(t))return{};if(et)return et(t);b.prototype=t;var i=new b;return b.prototype=null,i},ht=function(n){return function(t){if(null!=t)return t[n]}},f=function(n,t){return null!=n&&ut.call(n,t)},k=function(n,t){for(var r=t.length,i=0;i<r;i++){if(null==n)return;n=n[t[i]]}if(r)return n},ii=Math.pow(2,53)-1,u=ht("length"),i=function(n){var t=u(n);return"number"==typeof t&&0<=t&&t<=ii};n.each=n.forEach=function(t,r,u){var f,e,s;if(r=o(r,u),i(t))for(f=0,e=t.length;f<e;f++)r(t[f],f,t);else for(s=n.keys(t),f=0,e=s.length;f<e;f++)r(t[s[f]],s[f],t);return t};n.map=n.collect=function(r,u,f){var s;u=t(u,f);for(var o=!i(r)&&n.keys(r),h=(o||r).length,c=Array(h),e=0;e<h;e++)s=o?o[e]:e,c[e]=u(r[s],s,r);return c};d=function(t){return function(r,u,f,e){var s=3<=arguments.length;return function(r,u,f,e){var s=!i(r)&&n.keys(r),c=(s||r).length,o=0<t?0:c-1,h;for(e||(f=r[s?s[o]:o],o+=t);0<=o&&o<c;o+=t)h=s?s[o]:o,f=u(f,r[h],h,r);return f}(r,o(u,e,4),f,s)}};n.reduce=n.foldl=n.inject=d(1);n.reduceRight=n.foldr=d(-1);n.find=n.detect=function(t,r,u){var f=(i(t)?n.findIndex:n.findKey)(t,r,u);if(void 0!==f&&-1!==f)return t[f]};n.filter=n.select=function(i,r,u){var f=[];return r=t(r,u),n.each(i,function(n,t,i){r(n,t,i)&&f.push(n)}),f};n.reject=function(i,r,u){return n.filter(i,n.negate(t(r)),u)};n.every=n.all=function(r,u,f){var s;u=t(u,f);for(var o=!i(r)&&n.keys(r),h=(o||r).length,e=0;e<h;e++)if(s=o?o[e]:e,!u(r[s],s,r))return!1;return!0};n.some=n.any=function(r,u,f){var s;u=t(u,f);for(var o=!i(r)&&n.keys(r),h=(o||r).length,e=0;e<h;e++)if(s=o?o[e]:e,u(r[s],s,r))return!0;return!1};n.contains=n.includes=n.include=function(t,r,u,f){return i(t)||(t=n.values(t)),("number"!=typeof u||f)&&(u=0),0<=n.indexOf(t,r,u)};n.invoke=r(function(t,i,r){var u,f;return n.isFunction(i)?f=i:n.isArray(i)&&(u=i.slice(0,-1),i=i[i.length-1]),n.map(t,function(n){var t=f;if(!t){if(u&&u.length&&(n=k(n,u)),null==n)return;t=n[i]}return null==t?t:t.apply(n,r)})});n.pluck=function(t,i){return n.map(t,n.property(i))};n.where=function(t,i){return n.filter(t,n.matcher(i))};n.findWhere=function(t,i){return n.find(t,n.matcher(i))};n.max=function(r,u,f){var h,o,e=-1/0,c=-1/0,s,l;if(null==u||"number"==typeof u&&"object"!=typeof r[0]&&null!=r)for(s=0,l=(r=i(r)?r:n.values(r)).length;s<l;s++)null!=(h=r[s])&&e<h&&(e=h);else u=t(u,f),n.each(r,function(n,t,i){o=u(n,t,i);(c<o||o===-1/0&&e===-1/0)&&(e=n,c=o)});return e};n.min=function(r,u,f){var s,h,e=1/0,c=1/0,o,l;if(null==u||"number"==typeof u&&"object"!=typeof r[0]&&null!=r)for(o=0,l=(r=i(r)?r:n.values(r)).length;o<l;o++)null!=(s=r[o])&&s<e&&(e=s);else u=t(u,f),n.each(r,function(n,t,i){((h=u(n,t,i))<c||h===1/0&&e===1/0)&&(e=n,c=h)});return e};n.shuffle=function(t){return n.sample(t,1/0)};n.sample=function(t,r,f){var e,s,c,o,h,l;if(null==r||f)return i(t)||(t=n.values(t)),t[n.random(t.length-1)];for(e=i(t)?n.clone(t):n.values(t),s=u(e),r=Math.max(Math.min(r,s),0),c=s-1,o=0;o<r;o++)h=n.random(o,c),l=e[o],e[o]=e[h],e[h]=l;return e.slice(0,r)};n.sortBy=function(i,r,u){var f=0;return r=t(r,u),n.pluck(n.map(i,function(n,t,i){return{value:n,index:f++,criteria:r(n,t,i)}}).sort(function(n,t){var i=n.criteria,r=t.criteria;if(i!==r){if(r<i||void 0===i)return 1;if(i<r||void 0===r)return-1}return n.index-t.index}),"value")};l=function(i,r){return function(u,f,e){var o=r?[[],[]]:{};return f=t(f,e),n.each(u,function(n,t){var r=f(n,t,u);i(o,n,r)}),o}};n.groupBy=l(function(n,t,i){f(n,i)?n[i].push(t):n[i]=[t]});n.indexBy=l(function(n,t,i){n[i]=t});n.countBy=l(function(n,t,i){f(n,i)?n[i]++:n[i]=1});ct=/[^\ud800-\udfff]|[\ud800-\udbff][\udc00-\udfff]|[\ud800-\udfff]/g;n.toArray=function(t){return t?n.isArray(t)?h.call(t):n.isString(t)?t.match(ct):i(t)?n.map(t,n.identity):n.values(t):[]};n.size=function(t){return null==t?0:i(t)?t.length:n.keys(t).length};n.partition=l(function(n,t,i){n[i?0:1].push(t)},!0);n.first=n.head=n.take=function(t,i,r){return null==t||t.length<1?null==i?void 0:[]:null==i||r?t[0]:n.initial(t,t.length-i)};n.initial=function(n,t,i){return h.call(n,0,Math.max(0,n.length-(null==t||i?1:t)))};n.last=function(t,i,r){return null==t||t.length<1?null==i?void 0:[]:null==i||r?t[t.length-1]:n.rest(t,Math.max(0,t.length-i))};n.rest=n.tail=n.drop=function(n,t,i){return h.call(n,null==t||i?1:t)};n.compact=function(t){return n.filter(t,Boolean)};e=function(t,r,f,o){for(var s,l,a,h=(o=o||[]).length,c=0,v=u(t);c<v;c++)if(s=t[c],i(s)&&(n.isArray(s)||n.isArguments(s)))if(r)for(l=0,a=s.length;l<a;)o[h++]=s[l++];else e(s,r,f,o),h=o.length;else f||(o[h++]=s);return o};n.flatten=function(n,t){return e(n,t,!1)};n.without=r(function(t,i){return n.difference(t,i)});n.uniq=n.unique=function(i,r,f,e){var o,c;n.isBoolean(r)||(e=f,f=r,r=!1);null!=f&&(f=t(f,e));for(var s=[],l=[],h=0,a=u(i);h<a;h++)o=i[h],c=f?f(o,h,i):o,r&&!f?(h&&l===c||s.push(o),l=c):f?n.contains(l,c)||(l.push(c),s.push(o)):n.contains(s,o)||s.push(o);return s};n.union=r(function(t){return n.uniq(e(t,!0,!0))});n.intersection=function(t){for(var r,i,f=[],o=arguments.length,e=0,s=u(t);e<s;e++)if(r=t[e],!n.contains(f,r)){for(i=1;i<o&&n.contains(arguments[i],r);i++);i===o&&f.push(r)}return f};n.difference=r(function(t,i){return i=e(i,!0,!0),n.filter(t,function(t){return!n.contains(i,t)})});n.unzip=function(t){for(var r=t&&n.max(t,u).length||0,f=Array(r),i=0;i<r;i++)f[i]=n.pluck(t,i);return f};n.zip=r(n.unzip);n.object=function(n,t){for(var r={},i=0,f=u(n);i<f;i++)t?r[n[i]]=t[i]:r[n[i][0]]=n[i][1];return r};g=function(n){return function(i,r,f){r=t(r,f);for(var o=u(i),e=0<n?0:o-1;0<=e&&e<o;e+=n)if(r(i[e],e,i))return e;return-1}};n.findIndex=g(1);n.findLastIndex=g(-1);n.sortedIndex=function(n,i,r,f){for(var o,h=(r=t(r,f,1))(i),e=0,s=u(n);e<s;)o=Math.floor((e+s)/2),r(n[o])<h?e=o+1:s=o;return e};nt=function(t,i,r){return function(f,e,o){var c=0,s=u(f);if("number"==typeof o)0<t?c=0<=o?o:Math.max(o+s,c):s=0<=o?Math.min(o+1,s):o+s+1;else if(r&&o&&s)return f[o=r(f,e)]===e?o:-1;if(e!=e)return 0<=(o=i(h.call(f,c,s),n.isNaN))?o+c:-1;for(o=0<t?c:s-1;0<=o&&o<s;o+=t)if(f[o]===e)return o;return-1}};n.indexOf=nt(1,n.findIndex,n.sortedIndex);n.lastIndexOf=nt(-1,n.findLastIndex);n.range=function(n,t,i){null==t&&(t=n||0,n=0);i||(i=t<n?-1:1);for(var u=Math.max(Math.ceil((t-n)/i),0),f=Array(u),r=0;r<u;r++,n+=i)f[r]=n;return f};n.chunk=function(n,t){if(null==t||t<1)return[];for(var r=[],i=0,u=n.length;i<u;)r.push(h.call(n,i,i+=t));return r};tt=function(t,i,r,u,f){if(!(u instanceof i))return t.apply(r,f);var e=st(t.prototype),o=t.apply(e,f);return n.isObject(o)?o:e};n.bind=r(function(t,i,u){if(!n.isFunction(t))throw new TypeError("Bind must be called on a function");var f=r(function(n){return tt(t,f,i,this,u.concat(n))});return f});n.partial=r(function(t,i){var u=n.partial.placeholder,r=function(){for(var f=0,o=i.length,e=Array(o),n=0;n<o;n++)e[n]=i[n]===u?arguments[f++]:i[n];for(;f<arguments.length;)e.push(arguments[f++]);return tt(t,r,this,this,e)};return r});(n.partial.placeholder=n).bindAll=r(function(t,i){var r=(i=e(i,!1,!1)).length,u;if(r<1)throw new Error("bindAll must be passed function names");for(;r--;)u=i[r],t[u]=n.bind(t[u],t)});n.memoize=function(n,t){var i=function(r){var u=i.cache,e=""+(t?t.apply(this,arguments):r);return f(u,e)||(u[e]=n.apply(this,arguments)),u[e]};return i.cache={},i};n.delay=r(function(n,t,i){return setTimeout(function(){return n.apply(null,i)},t)});n.defer=n.partial(n.delay,n,1);n.throttle=function(t,i,r){var u,f,e,s,o=0,c,h;return r||(r={}),c=function(){o=!1===r.leading?0:n.now();u=null;s=t.apply(f,e);u||(f=e=null)},h=function(){var l=n.now(),h;return o||!1!==r.leading||(o=l),h=i-(l-o),f=this,e=arguments,h<=0||i<h?(u&&(clearTimeout(u),u=null),o=l,s=t.apply(f,e),u||(f=e=null)):u||!1===r.trailing||(u=setTimeout(c,h)),s},h.cancel=function(){clearTimeout(u);o=0;u=f=e=null},h};n.debounce=function(t,i,u){var f,e,o=function(n,i){f=null;i&&(e=t.apply(n,i))},s=r(function(r){if(f&&clearTimeout(f),u){var s=!f;f=setTimeout(o,i);s&&(e=t.apply(this,r))}else f=n.delay(o,i,this,r);return e});return s.cancel=function(){clearTimeout(f);f=null},s};n.wrap=function(t,i){return n.partial(i,t)};n.negate=function(n){return function(){return!n.apply(this,arguments)}};n.compose=function(){var n=arguments,t=n.length-1;return function(){for(var r=t,i=n[t].apply(this,arguments);r--;)i=n[r].call(this,i);return i}};n.after=function(n,t){return function(){if(--n<1)return t.apply(this,arguments)}};n.before=function(n,t){var i;return function(){return 0<--n&&(i=t.apply(this,arguments)),n<=1&&(t=null),i}};n.once=n.partial(n.before,2);n.restArguments=r;var lt=!{toString:null}.propertyIsEnumerable("toString"),at=["valueOf","isPrototypeOf","toString","propertyIsEnumerable","hasOwnProperty","toLocaleString"],vt=function(t,i){var u=at.length,e=t.constructor,o=n.isFunction(e)&&e.prototype||w,r="constructor";for(f(t,r)&&!n.contains(i,r)&&i.push(r);u--;)(r=at[u])in t&&t[r]!==o[r]&&!n.contains(i,r)&&i.push(r)};n.keys=function(t){var i,r;if(!n.isObject(t))return[];if(ft)return ft(t);i=[];for(r in t)f(t,r)&&i.push(r);return lt&&vt(t,i),i};n.allKeys=function(t){var i,r;if(!n.isObject(t))return[];i=[];for(r in t)i.push(r);return lt&&vt(t,i),i};n.values=function(t){for(var r=n.keys(t),u=r.length,f=Array(u),i=0;i<u;i++)f[i]=t[r[i]];return f};n.mapObject=function(i,r,u){var f;r=t(r,u);for(var o=n.keys(i),h=o.length,s={},e=0;e<h;e++)f=o[e],s[f]=r(i[f],f,i);return s};n.pairs=function(t){for(var r=n.keys(t),u=r.length,f=Array(u),i=0;i<u;i++)f[i]=[r[i],t[r[i]]];return f};n.invert=function(t){for(var u={},r=n.keys(t),i=0,f=r.length;i<f;i++)u[t[r[i]]]=r[i];return u};n.functions=n.methods=function(t){var i=[];for(var r in t)n.isFunction(t[r])&&i.push(r);return i.sort()};v=function(n,t){return function(i){var e=arguments.length,r,u;if(t&&(i=Object(i)),e<2||null==i)return i;for(r=1;r<e;r++)for(var o=arguments[r],s=n(o),h=s.length,f=0;f<h;f++)u=s[f],t&&void 0!==i[u]||(i[u]=o[u]);return i}};n.extend=v(n.allKeys);n.extendOwn=n.assign=v(n.keys);n.findKey=function(i,r,u){r=t(r,u);for(var f,o=n.keys(i),e=0,s=o.length;e<s;e++)if(r(i[f=o[e]],f,i))return f};pt=function(n,t,i){return t in i};n.pick=r(function(t,i){var s={},r=i[0],u,c,f,h;if(null==t)return s;for(n.isFunction(r)?(1<i.length&&(r=o(r,i[1])),i=n.allKeys(t)):(r=pt,i=e(i,!1,!1),t=Object(t)),u=0,c=i.length;u<c;u++)f=i[u],h=t[f],r(h,f,t)&&(s[f]=h);return s});n.omit=r(function(t,i){var u,r=i[0];return n.isFunction(r)?(r=n.negate(r),1<i.length&&(u=i[1])):(i=n.map(e(i,!1,!1),String),r=function(t,r){return!n.contains(i,r)}),n.pick(t,r,u)});n.defaults=v(n.allKeys,!0);n.create=function(t,i){var r=st(t);return i&&n.extendOwn(r,i),r};n.clone=function(t){return n.isObject(t)?n.isArray(t)?t.slice():n.extend({},t):t};n.tap=function(n,t){return t(n),n};n.isMatch=function(t,i){var e=n.keys(i),o=e.length,f,r,u;if(null==t)return!o;for(f=Object(t),r=0;r<o;r++)if(u=e[r],i[u]!==f[u]||!(u in f))return!1;return!0};y=function(n,t,i,r){if(n===t)return 0!==n||1/n==1/t;if(null==n||null==t)return!1;if(n!=n)return t!=t;var u=typeof n;return("function"===u||"object"===u||"object"==typeof t)&&yt(n,t,i,r)};yt=function(t,i,r,u){var h,a,o,s,e,l,v;if(t instanceof n&&(t=t._wrapped),i instanceof n&&(i=i._wrapped),h=c.call(t),h!==c.call(i))return!1;switch(h){case"[object RegExp]":case"[object String]":return""+t==""+i;case"[object Number]":return+t!=+t?+i!=+i:0==+t?1/+t==1/i:+t==+i;case"[object Date]":case"[object Boolean]":return+t==+i;case"[object Symbol]":return rt.valueOf.call(t)===rt.valueOf.call(i)}if(a="[object Array]"===h,!a&&("object"!=typeof t||"object"!=typeof i||(o=t.constructor,s=i.constructor,o!==s&&!(n.isFunction(o)&&o instanceof o&&n.isFunction(s)&&s instanceof s)&&"constructor"in t&&"constructor"in i)))return!1;for(u=u||[],e=(r=r||[]).length;e--;)if(r[e]===t)return u[e]===i;if(r.push(t),u.push(i),a){if((e=t.length)!==i.length)return!1;for(;e--;)if(!y(t[e],i[e],r,u))return!1}else{if(v=n.keys(t),e=v.length,n.keys(i).length!==e)return!1;for(;e--;)if(l=v[e],!f(i,l)||!y(t[l],i[l],r,u))return!1}return r.pop(),u.pop(),!0};n.isEqual=function(n,t){return y(n,t)};n.isEmpty=function(t){return null==t||(i(t)&&(n.isArray(t)||n.isString(t)||n.isArguments(t))?0===t.length:0===n.keys(t).length)};n.isElement=function(n){return!(!n||1!==n.nodeType)};n.isArray=ti||function(n){return"[object Array]"===c.call(n)};n.isObject=function(n){var t=typeof n;return"function"===t||"object"===t&&!!n};n.each(["Arguments","Function","String","Number","Date","RegExp","Error","Symbol","Map","WeakMap","Set","WeakSet"],function(t){n["is"+t]=function(n){return c.call(n)==="[object "+t+"]"}});n.isArguments(arguments)||(n.isArguments=function(n){return f(n,"callee")});wt=s.document&&s.document.childNodes;"function"!=typeof/./&&"object"!=typeof Int8Array&&"function"!=typeof wt&&(n.isFunction=function(n){return"function"==typeof n||!1});n.isFinite=function(t){return!n.isSymbol(t)&&isFinite(t)&&!isNaN(parseFloat(t))};n.isNaN=function(t){return n.isNumber(t)&&isNaN(t)};n.isBoolean=function(n){return!0===n||!1===n||"[object Boolean]"===c.call(n)};n.isNull=function(n){return null===n};n.isUndefined=function(n){return void 0===n};n.has=function(t,i){var u,r,e;if(!n.isArray(i))return f(t,i);for(u=i.length,r=0;r<u;r++){if(e=i[r],null==t||!ut.call(t,e))return!1;t=t[e]}return!!u};n.noConflict=function(){return s._=gt,this};n.identity=function(n){return n};n.constant=function(n){return function(){return n}};n.noop=function(){};n.property=function(t){return n.isArray(t)?function(n){return k(n,t)}:ht(t)};n.propertyOf=function(t){return null==t?function(){}:function(i){return n.isArray(i)?k(t,i):t[i]}};n.matcher=n.matches=function(t){return t=n.extendOwn({},t),function(i){return n.isMatch(i,t)}};n.times=function(n,t,i){var u=Array(Math.max(0,n)),r;for(t=o(t,i,1),r=0;r<n;r++)u[r]=t(r);return u};n.random=function(n,t){return null==t&&(t=n,n=0),n+Math.floor(Math.random()*(t-n+1))};n.now=Date.now||function(){return(new Date).getTime()};var bt={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#x27;","`":"&#x60;"},ri=n.invert(bt),kt=function(t){var r=function(n){return t[n]},i="(?:"+n.keys(t).join("|")+")",u=RegExp(i),f=RegExp(i,"g");return function(n){return n=null==n?"":""+n,u.test(n)?n.replace(f,r):n}};n.escape=kt(bt);n.unescape=kt(ri);n.result=function(t,i,r){var e,f,u;if(n.isArray(i)||(i=[i]),e=i.length,!e)return n.isFunction(r)?r.call(t):r;for(f=0;f<e;f++)u=null==t?void 0:t[i[f]],void 0===u&&(u=r,f=e),t=n.isFunction(u)?u.call(t):u;return t};dt=0;n.uniqueId=function(n){var t=++dt+"";return n?n+t:t};n.templateSettings={evaluate:/<%([\s\S]+?)%>/g,interpolate:/<%=([\s\S]+?)%>/g,escape:/<%-([\s\S]+?)%>/g};var it=/(.)^/,ui={"'":"'","\\":"\\","\r":"r","\n":"n","\u2028":"u2028","\u2029":"u2029"},fi=/\\|'|\r|\n|\u2028|\u2029/g,ei=function(n){return"\\"+ui[n]};n.template=function(t,i,r){var f,s;!i&&r&&(i=r);i=n.defaults({},i,n.templateSettings);var e,h=RegExp([(i.escape||it).source,(i.interpolate||it).source,(i.evaluate||it).source].join("|")+"|$","g"),o=0,u="__p+='";t.replace(h,function(n,i,r,f,e){return u+=t.slice(o,e).replace(fi,ei),o=e+n.length,i?u+="'+\n((__t=("+i+"))==null?'':_.escape(__t))+\n'":r?u+="'+\n((__t=("+r+"))==null?'':__t)+\n'":f&&(u+="';\n"+f+"\n__p+='"),n});u+="';\n";i.variable||(u="with(obj||{}){\n"+u+"}\n");u="var __t,__p='',__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,'');};\n"+u+"return __p;\n";try{e=new Function(i.variable||"obj","_",u)}catch(i){throw i.source=u,i;}return f=function(t){return e.call(this,t,n)},s=i.variable||"obj",f.source="function("+s+"){\n"+u+"}",f};n.chain=function(t){var i=n(t);return i._chain=!0,i};p=function(t,i){return t._chain?n(i).chain():i};n.mixin=function(t){return n.each(n.functions(t),function(i){var r=n[i]=t[i];n.prototype[i]=function(){var t=[this._wrapped];return ni.apply(t,arguments),p(this,r.apply(n,t))}}),n};n.mixin(n);n.each(["pop","push","reverse","shift","sort","splice","unshift"],function(t){var i=a[t];n.prototype[t]=function(){var n=this._wrapped;return i.apply(n,arguments),"shift"!==t&&"splice"!==t||0!==n.length||delete n[0],p(this,n)}});n.each(["concat","join","slice"],function(t){var i=a[t];n.prototype[t]=function(){return p(this,i.apply(this._wrapped,arguments))}});n.prototype.value=function(){return this._wrapped};n.prototype.valueOf=n.prototype.toJSON=n.prototype.value;n.prototype.toString=function(){return String(this._wrapped)};"function"==typeof define&&define.amd&&define("underscore",[],function(){return n})}();__extends=this&&this.__extends||function(n,t){function r(){this.constructor=n}for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i]);n.prototype=t===null?Object.create(t):(r.prototype=t.prototype,new r)},function(n){n[n.None=0]="None";n[n.ValidationErrors=1]="ValidationErrors";n[n.Exception=500]="Exception";n[n.InvalidParameter=3]="InvalidParameter";n[n.HandledException=4]="HandledException"}(AjaxError||(AjaxError={})),function(n){n[n.None=0]="None";n[n.Facet=1]="Facet";n[n.Minor=2]="Minor";n[n.Major=3]="Major";n[n.Mega=4]="Mega"}(BrandType||(BrandType={})),function(n){n[n.Category=1]="Category";n[n.Brand=2]="Brand"}(CategoryType||(CategoryType={})),function(n){n[n.Unknown=999]="Unknown";n[n.NotForIndividualSale=0]="NotForIndividualSale";n[n.Available=1]="Available";n[n.NoLongerAvailable=2]="NoLongerAvailable";n[n.AvailableSoon=3]="AvailableSoon";n[n.ConditionalProduct=5]="ConditionalProduct";n[n.AutoReplenishmentOnly=7]="AutoReplenishmentOnly";n[n.NotAvailableOnTheOnlineStore=9]="NotAvailableOnTheOnlineStore"}(CanBuy||(CanBuy={})),function(n){n[n.Standard=0]="Standard";n[n.StoredCreditCardSelection=1]="StoredCreditCardSelection";n[n.StoredCreditCardAdd=2]="StoredCreditCardAdd";n[n.StoredCreditCardEdit=3]="StoredCreditCardEdit"}(CreditCardDisplayMode||(CreditCardDisplayMode={})),function(n){n[n.Unknown=0]="Unknown";n[n.Visa=1]="Visa";n[n.MasterCard=2]="MasterCard";n[n.Discover=3]="Discover";n[n.Amex=4]="Amex";n[n.Jcb=5]="Jcb"}(CreditCardType||(CreditCardType={})),function(n){n[n.None=0]="None";n[n.RepOrDirect=1]="RepOrDirect";n[n.RepOnly=2]="RepOnly";n[n.DirectOnly=3]="DirectOnly"}(DeliveryType||(DeliveryType={})),function(n){n[n.ByName=0]="ByName";n[n.ByAddress=1]="ByAddress"}(FindARepSearchType||(FindARepSearchType={})),function(n){n[n.Original=0]="Original";n[n.XtraLarge=700]="XtraLarge";n[n.Large=420]="Large";n[n.Medium=240]="Medium";n[n.Small=67]="Small";n[n.XtraSmall=50]="XtraSmall"}(ImageType||(ImageType={})),function(n){n[n.Interest=0]="Interest";n[n.Reason=1]="Reason"}(InterestType||(InterestType={})),function(n){n[n.Jan=1]="Jan";n[n.Feb=2]="Feb";n[n.Mar=3]="Mar";n[n.Apr=4]="Apr";n[n.May=5]="May";n[n.Jun=6]="Jun";n[n.Jul=7]="Jul";n[n.Aug=8]="Aug";n[n.Sep=9]="Sep";n[n.Oct=10]="Oct";n[n.Nov=11]="Nov";n[n.Dec=12]="Dec"}(Month||(Month={})),function(n){n[n.OrderProcessing=1]="OrderProcessing";n[n.OrderShipped=2]="OrderShipped";n[n.CreditCardDenied=3]="CreditCardDenied";n[n.NotAvailable=4]="NotAvailable";n[n.AuthorizingCreditCard=5]="AuthorizingCreditCard";n[n.ReferredToCustomerServices=6]="ReferredToCustomerServices";n[n.InvalidShippingAddress=7]="InvalidShippingAddress";n[n.Cancelled=8]="Cancelled";n[n.OrderReturn=9]="OrderReturn";n[n.OrderOnHold=10]="OrderOnHold";n[n.PartialCredit=11]="PartialCredit";n[n.PartialReturn=12]="PartialReturn"}(OrderStatus||(OrderStatus={})),function(n){n[n.Customer=0]="Customer";n[n.Representative=1]="Representative"}(OrderType||(OrderType={})),function(n){n[n.Unknown=0]="Unknown";n[n.CreditCard=1]="CreditCard";n[n.PayPal=2]="PayPal";n[n.ApplePay=4]="ApplePay";n[n.GooglePay=5]="GooglePay";n[n.NotRequired=99]="NotRequired"}(PaymentType||(PaymentType={})),function(n){n[n.Unknown=0]="Unknown";n[n.NotAvailable=1]="NotAvailable";n[n.Available=2]="Available"}(ApplePayClientStatus||(ApplePayClientStatus={})),function(n){n[n.notyetspecified=0]="notyetspecified";n[n.shipping_method_1=1]="shipping_method_1";n[n.shipping_method_2=2]="shipping_method_2";n[n.shipping_method_3=3]="shipping_method_3";n[n.shipping_method_4=4]="shipping_method_4";n[n.shipping_method_10=10]="shipping_method_10";n[n.rep_delivery=11]="rep_delivery"}(ShippingOptionCode||(ShippingOptionCode={})),function(n){n[n.NotApplicable=0]="NotApplicable";n[n.CannotBuy=1]="CannotBuy";n[n.CanBuyWhenXaddedToYourBag=2]="CanBuyWhenXaddedToYourBag";n[n.CanBuyWhenSpentX=3]="CanBuyWhenSpentX";n[n.CanBuyWhenXConditionsMet=4]="CanBuyWhenXConditionsMet"}(PromoConditionalRuleReason||(PromoConditionalRuleReason={})),function(n){n[n.OnTabClick=0]="OnTabClick";n[n.OnTabMouseEnter=1]="OnTabMouseEnter";n[n.OnTabMouseLeave=2]="OnTabMouseLeave"}(TabToggleMode||(TabToggleMode={})),function(n){n[n.Unknown=-1]="Unknown";n[n.Fragrance=0]="Fragrance";n[n.Shade=1]="Shade";n[n.Size=2]="Size";n[n.Version=5]="Version";n[n.None=6]="None"}(VariantType||(VariantType={})),function(n){n[n.None=0]="None";n[n.IslandState=1]="IslandState";n[n.AlaskaHawaiiNoHazmat=2]="AlaskaHawaiiNoHazmat";n[n.AlaskaHawaiiSomeHazmat=3]="AlaskaHawaiiSomeHazmat";n[n.AlaskaHawaiiAllHazmat=4]="AlaskaHawaiiAllHazmat"}(RestrictedAutoRepType||(RestrictedAutoRepType={})),function(n){n[n.CrossSells=0]="CrossSells";n[n.CustomerBuys=1]="CustomerBuys"}(CarouselType||(CarouselType={})),function(n){n[n.Desktop=0]="Desktop";n[n.Tablet=1]="Tablet";n[n.Mobile=2]="Mobile"}(BootstrapEnvironment||(BootstrapEnvironment={})),function(n){n[n.AttachedEcommerce=0]="AttachedEcommerce";n[n.UnattachedEcommerce=1]="UnattachedEcommerce";n[n.TraditionalShopper=2]="TraditionalShopper";n[n.GuestShopper=3]="GuestShopper";n[n.Lead=4]="Lead";n[n.Unknown=5]="Unknown";n[n.RegisteredCustomerAsGuest=6]="RegisteredCustomerAsGuest"}(CustomerType||(CustomerType={})),function(n){n[n.AddToBag=0]="AddToBag";n[n.AddSubscriptionToBag=1]="AddSubscriptionToBag";n[n.NotifyMe=2]="NotifyMe";n[n.Remove=3]="Remove";n[n.SubscriptionInTheBag=4]="SubscriptionInTheBag";n[n.AlreadySubscribed=5]="AlreadySubscribed";n[n.FindARepresentative=6]="FindARepresentative"}(WishListItemActionButton||(WishListItemActionButton={})),function(n){n[n.Email=0]="Email";n[n.Facebook=1]="Facebook";n[n.Twitter=2]="Twitter"}(WishListShareType||(WishListShareType={})),function(n){n[n.OneTime=0]="OneTime";n[n.AutoReplenishment=1]="AutoReplenishment"}(DualPurchase||(DualPurchase={})),function(n){n[n.ShipToday=0]="ShipToday";n[n.ShipNextScheduledDate=1]="ShipNextScheduledDate"}(ConsolidationOption||(ConsolidationOption={})),function(n){n[n.Billing=0]="Billing";n[n.Shipping=1]="Shipping"}(AddressType||(AddressType={})),function(n){n[n.Increment=0]="Increment";n[n.Decrement=1]="Decrement"}(QuantityFieldAction||(QuantityFieldAction={})),function(n){n[n.None=0]="None";n[n.PartialWidth=1]="PartialWidth";n[n.FullWidth=2]="FullWidth"}(LineSeparatorType||(LineSeparatorType={})),function(n){var t=function(){function n(){}return n.prototype.centerModal=function(){$(".ModalContainer").center()},n.prototype.redirectTo=function(n){var t=top.location.href==n;top.location.href=n;t&&top.location.hash&&($("html, body").animate({scrollTop:0},0),top.location.reload())},n}();n.Common=t}(AvonModule||(AvonModule={})),function(n){var t=function(){function t(){this.buttonKeys={EnterKey:13}}return t.prototype.scrollToTop=function(n){var t=0;isMobile()&&(t=1);$("html, body").animate({scrollTop:t},400,"swing",function(){typeof n=="function"&&n.call(this)})},t.prototype.isQapEnvironment=function(){return location.href.indexOf("qap2.avon.com")>-1},t.prototype.isQafEnvironment=function(){var n=!1;return $.each(["qaf.avon.com","qaffeat.avon.com","qafpatch.avon.com"],function(t,i){if(location.href.indexOf(i)>-1)return n=!0,!1}),n},t.prototype.isLocalEnvironment=function(){return location.href.indexOf("localhost.avon.com")>-1},t.prototype.rebindAjaxForm=function(n){this.setupFormElements(n);this.setDefaultFormAction(n)},t.prototype.setupFormElements=function(n){var t=$(n),i=$(".FormItem select",t);$("input.NumberInput").handleNumberInput()},t.prototype.setDefaultFormAction=function(t){var i=t.find(".DefaultButton").first();i.length>0&&(t.keypress(function(t){if(t.which===this.buttonKeys.EnterKey&&!n.AvonScope.isLoading)return $("input").blur(),i.focus(),i.click(),!1}),t.find(".SelectBoxed").live("enter",function(){n.AvonScope.isLoading||(i.focus(),i.click())}))},t}();n.CommonMvc=t}(AvonModule||(AvonModule={}));"console"in window||(console={log:function(){}});"IntersectionObserver"in window&&"IntersectionObserverEntry"in window&&"intersectionRatio"in window.IntersectionObserverEntry.prototype&&!("isIntersecting"in IntersectionObserverEntry.prototype)&&Object.defineProperty(window.IntersectionObserverEntry.prototype,"isIntersecting",{get:function(){return this.intersectionRatio>0}}),function(n){var t=function(){function t(){this.setBreadcrumbs=!0;this.ShowProductList=null;this.CategoryDeepLinksModel=null;this.IsDescendantMegaBrand=null;this.ProductPromotionSpots=null;this.common=new n.Common;this.commonMvc=new n.CommonMvc}return t}();n.Avon=t}(AvonModule||(AvonModule={}));var AVON=new AvonModule.Avon,isMobile=function(){"use strict";return(navigator.userAgent.match(/Android/i)||navigator.userAgent.match(/webOS/i)||navigator.userAgent.match(/iPhone/i)||navigator.userAgent.match(/iPod/i)||navigator.userAgent.match(/iPad/i)||navigator.userAgent.match(/BlackBerry/)||navigator.userAgent.match(/Phone/i))!=null||window.IsMobile},isHomepage=function(){"use strict";return window.location.pathname==="/"||window.location.pathname==="/es"||window.location.href.indexOf("/myavon")>-1},isMobileSite=$("html").hasClass("IsMobileSite");app=angular.module("avonShopApp",loadAppModules());angular.element(document).ready(function(){blankshield($("a[target='_blank']"))});app.config(["$compileProvider",function(n){n.aHrefSanitizationWhitelist(/^\s*(https?|ftp|mailto|tel):/);n.debugInfoEnabled(!1)}]);app.config(["$ariaProvider",function(n){n.config({ariaHidden:!0,ariaChecked:!0,ariaDisabled:!0,ariaRequired:!0,ariaInvalid:!0,ariaMultiline:!0,ariaValue:!0,tabindex:!1,bindKeypress:!0})}]);app.tryLoadScriptBySrc=function(n){var i=document.querySelectorAll("script"),r=Array.prototype.map.call(i,function(n){return n.src}),t;_.include(r,n)||(t=document.createElement("script"),t.src=n,document.getElementsByTagName("body")[0].appendChild(t))};app.safeLoadImages=function(n){var i=n.find("img[data-src]").not(".ImageNotFound"),r,t,u;if(i.length)for(r=function(n){var t=$(i[n]),r=t.data("src");if(r==="loaded")return"continue";t.data("alt")==undefined&&t.data("alt",t.attr("alt"));t.attr("alt"," ");t.on("load",function(){t.hasClass("ImageNotFound")||(t.data("alt").length>0&&t.attr("alt",t.data("alt")),t.data("src","loaded"));t.data("alt","")});t.attr("src",r)},t=0;t<i.length;t++)u=r(t),u==="continue"};app.preloadImage=function(n){$("<img/>")[0].src=n};app.serializeDate=function(n){return n.toISOString()};app.parseDate=function(n){var t=/^(\d{4})-(\d{2})-(\d{2})T(\d{2}):(\d{2}):(\d{2}(?:\.\d*)?)Z$/.exec(n);return new Date(Date.UTC(+t[1],+t[2]-1,+t[3],+t[4],+t[5],0))};app.GetQuerystringParameterByName=function(n){n=n.replace(/[\[]/,"\\[").replace(/[\]]/,"\\]");var i=new RegExp("[\\?&]"+n+"=([^&#]*)"),t=i.exec(location.search);return t==null?"":decodeURIComponent(t[1].replace(/\+/g," "))};String.prototype.toTitleCase=function(){return this.replace(/\w\S*/g,function(n){return n.charAt(0).toUpperCase()+n.substr(1).toLowerCase()})};String.prototype.formatUrlNugget=function(){return(this||"").toLowerCase().replace(/[\u0061\u24D0\uFF41\u1E9A\u00E0\u00E1\u00E2\u1EA7\u1EA5\u1EAB\u1EA9\u00E3\u0101\u0103\u1EB1\u1EAF\u1EB5\u1EB3\u0227\u01E1\u00E4\u01DF\u1EA3\u00E5\u01FB\u01CE\u0201\u0203\u1EA1\u1EAD\u1EB7\u1E01\u0105\u2C65\u0250]/g,"a").replace(/[\u0065\u24D4\uFF45\u00E8\u00E9\u00EA\u1EC1\u1EBF\u1EC5\u1EC3\u1EBD\u0113\u1E15\u1E17\u0115\u0117\u00EB\u1EBB\u011B\u0205\u0207\u1EB9\u1EC7\u0229\u1E1D\u0119\u1E19\u1E1B\u0247\u025B\u01DD]/g,"e").replace(/[\u0069\u24D8\uFF49\u00EC\u00ED\u00EE\u0129\u012B\u012D\u00EF\u1E2F\u1EC9\u01D0\u0209\u020B\u1ECB\u012F\u1E2D\u0268\u0131]/g,"i").replace(/[\u006F\u24DE\uFF4F\u00F2\u00F3\u00F4\u1ED3\u1ED1\u1ED7\u1ED5\u00F5\u1E4D\u022D\u1E4F\u014D\u1E51\u1E53\u014F\u022F\u0231\u00F6\u022B\u1ECF\u0151\u01D2\u020D\u020F\u01A1\u1EDD\u1EDB\u1EE1\u1EDF\u1EE3\u1ECD\u1ED9\u01EB\u01ED\u00F8\u01FF\u0254\uA74B\uA74D\u0275]/g,"o").replace(/[\u0075\u24E4\uFF55\u00F9\u00FA\u00FB\u0169\u1E79\u016B\u1E7B\u016D\u00FC\u01DC\u01D8\u01D6\u01DA\u1EE7\u016F\u0171\u01D4\u0215\u0217\u01B0\u1EEB\u1EE9\u1EEF\u1EED\u1EF1\u1EE5\u1E73\u0173\u1E77\u1E75\u0289]/g,"u").replace(/[\u006E\u24DD\uFF4E\u01F9\u0144\u00F1\u1E45\u0148\u1E47\u0146\u1E4B\u1E49\u019E\u0272\u0149\uA791\uA7A5]/g,"n").replace(/[^a-zA-Z0-9\/\\\+\s+-]/g,"").replace(/[\/\\\s+]/g,"-").replace("--","-").replace("--","-")};String.prototype.format||(String.prototype.format=function(){for(var t=[],n=0;n<arguments.length;n++)t[+n]=arguments[n];return this.replace(/{(\d+)}/g,function(n,i){return typeof t[i]!="undefined"?t[i]:n})});AddBagItem=function(){function n(){}return n}();BaseAvonService=function(){function n(t,i,r){n.rootScope=t;n.http=i;n.q=r}return n.prototype.PostJson=function(t,i,r,u,f,e,o){var l=this,s,c,a,h;return r===void 0&&(r=null),u===void 0&&(u=!0),f===void 0&&(f=!0),e===void 0&&(e=null),o===void 0&&(o=!1),f&&n.rootScope.$broadcast("Do.ResetPageIdleTime"),s={"Content-Type":"application/json; charset=utf-8","Avon-Post-Type":"angular","X-Requested-With":"XMLHttpRequest"},angular.extend(s,e),r&&(c=r.find('input[name="__RequestVerificationToken"]'),c.length&&(a=c.val(),s.__RequestVerificationToken=a)),h=n.http({url:t,cache:!1,dataType:"json",method:"POST",data:JSON.stringify(i),headers:s}),h.success(function(t){t.HideLoading=u;t.IgnoreDelay=o;n.rootScope.$broadcast("BaseService.AjaxComplete",t);_.delay(function(){l.ProcessAvonResponse(t)},10)}),h.error(function(t){t.HideLoading=u;t.IgnoreDelay=o;n.rootScope.$broadcast("BaseService.AjaxComplete",t);_.delay(function(){l.ProcessAvonResponse(t)},10)}),h},n.prototype.GetJson=function(t,i,r,u,f,e,o){i===void 0&&(i=!0);r===void 0&&(r=!0);u===void 0&&(u=!0);f===void 0&&(f=!0);o===void 0&&(o=!1);f&&n.rootScope.$broadcast("Do.ResetPageIdleTime");var s=n.q.defer(),h=this;return $.ajax({async:i,cache:r,type:"GET",url:t,dataType:"json",beforeSend:function(n){n.setRequestHeader("X-Requested-With","XMLHttpRequest")},success:function(t){t.HideLoading=u;t.IgnoreDelay=o;n.rootScope.$broadcast("BaseService.AjaxComplete",t);s.resolve(t);_.delay(function(){h.ProcessAvonResponse(t,e)},10)},error:function(t){t.HideLoading=u;t.IgnoreDelay=o;n.rootScope.$broadcast("BaseService.AjaxComplete",t);s.reject(t);_.delay(function(){h.ProcessAvonResponse(t,e)},10)}}),s.promise},n.prototype.GetHtml=function(t,i,r,u,f){i===void 0&&(i=!0);r===void 0&&(r=!0);u===void 0&&(u=!0);f===void 0&&(f=!0);f&&n.rootScope.$broadcast("Do.ResetPageIdleTime");var e=n.q.defer(),o=this;return $.ajax({async:i,cache:r,type:"GET",url:t,dataType:"html",success:function(t){t.HideLoading=u;n.rootScope.$broadcast("BaseService.AjaxComplete",t);e.resolve(t)},error:function(t){t.HideLoading=u;t.IgnoreDelay=!1;n.rootScope.$broadcast("BaseService.AjaxComplete",t);e.reject(t);_.delay(function(){o.ProcessAvonResponse(t)},10)}}),e.promise},n.prototype.getBaseUrl=function(){var n=window.location.host;return window.location.protocol+"//"+n},n.prototype.RedirectToErrorPage=function(n){window.location.href="/error500.htm?id="+n},n.prototype.ProcessAvonResponse=function(t,i){var r,u;if(typeof t=="string"&&t.indexOf('id="page-error500"')>=0){this.RedirectToErrorPage("");return}if(r=t,typeof r.responseJSON!="undefined"&&(r=r.responseJSON),typeof r.responseText!="undefined"&&(r=JSON.parse(r.responseText)),!r.Processed)if(r.Processed=!0,typeof r.AngularResponse=="undefined")n.rootScope.Redirecting||t.status!=200&&t.status!=304||typeof t.status!="undefined"&&t.status!==null&&t.status!==0&&this.RedirectToErrorPage("AjaxError:"+t.status);else switch(r.ErrorCode){case AjaxError.None:case AjaxError.HandledException:r.IdToReplace?this.processAjaxReplacement(r,i):r.RedirectUrl!==null&&r.RedirectUrl!==""?(n.rootScope.isLoading||n.rootScope.ShowLoading(AVON.messages.spinner_loading,t.IgnoreDelay),AVON.common.redirectTo(r.RedirectUrl)):r.OpenModalId?(u={AllowExit:!1,Model:null,KeepLoaded:!1,UrlToLoad:null},r.ModalOptions&&(u=r.ModalOptions),n.rootScope.ShowLoading(AVON.messages.spinner_loading,t.IgnoreDelay),$("#"+r.OpenModalId).trigger("modal",u)):r.Processed=!1;break;case AjaxError.ValidationErrors:r.Processed=!1;break;case AjaxError.Exception:this.RedirectToErrorPage(r.ErrorId)}},n.prototype.processAjaxReplacement=function(n,t){var i,r=!1;n.IdToReplace==="(body)"?i=$("body"):n.IdToReplace==="(modal)"?($("#AjaxModal").closest(".ModalContainer").remove(),r=!0,$("#Modals").append("<div id='AjaxModal'><\/div>"),i=$("#AjaxModal")):i=$("#"+n.IdToReplace);AVON.TempModalModel=n.Data;var u=angular.element(n.Html),f=t?t:AvonModule.AvonScope,e=AvonModule.AvonScope.compileService(u)(f,function(n){i.replaceWith(n)});r&&e.trigger("modal",n.ModalOptions)},n}(),function(n){var t=function(n){function t(t,i,r,u){var e=this,f;n.call(this,t,i,r);this.$rootScope=t;this.$window=u;f=_.once(function(){e.Initialize()});t.$on("AvonController.PageCompete",function(){f()})}return __extends(t,n),Object.defineProperty(t.prototype,"UTagData",{get:function(){return this.$window.utag_data},enumerable:!0,configurable:!0}),t.prototype.TrackEvent=function(n){this.UTagLink(n)},t.prototype.TrackViewEvent=function(n){this.UTagView(n)},t.prototype.TrackEventItem=function(n){var t,i,r,u;switch(n.Type){case TrackingEventType.CartCheckout1:this.UTagLink({event_name:"checkout_billing_shipping"});break;case TrackingEventType.CartCheckout2:this.UTagLink({event_name:"checkout_billing_shipping"});break;case TrackingEventType.CartNewCustAcct:this.UTagLink({event_name:"new_customer_account_created",visitor_customer_id:AvonModule.AvonScope.Session.Customer.CustomerId});break;case TrackingEventType.CartViewBag:this.UTagLink({event_name:"cart_view",digital_catalog:this.UTagData.digital_catalog});this.UTagData.event_name="cart_view";break;case TrackingEventType.CartViewBagCheckoutButtonClick:this.UTagLink({event_name:"order_checkout",product_fsc:this.UTagData.product_fsc,product_sku:this.UTagData.product_sku,product_quantity:this.UTagData.product_quantity,checkout_button_type:"checkout"});break;case TrackingEventType.CartViewBagPayPalButtonClick:this.UTagLink({event_name:"order_checkout",product_fsc:this.UTagData.product_fsc,product_sku:this.UTagData.product_sku,product_quantity:this.UTagData.product_quantity,checkout_button_type:"paypal"});break;case TrackingEventType.CartViewBagSignInModal:this.UTagLink({event_name:"order_checkout_signin_modal"});break;case TrackingEventType.CartViewBagPayPalModal:t="paypal express modal";this.UTagLink({event_name:t});this.UTagData.order_payment_vendor_status=t;break;case TrackingEventType.CartViewBagPayPalContinue:t="paypal click modal continue";this.UTagLink({event_name:t});this.UTagData.order_payment_vendor_status=t;break;case TrackingEventType.CartViewBagPayPalCancel:t="paypal click modal cancel";this.UTagLink({event_name:t});this.UTagData.order_payment_vendor_status=t;break;case TrackingEventType.EmailConfirmMsg:this.UTagLink({event_name:"email_subscribe_success",email_subscription_type:"footer"});break;case TrackingEventType.EmailPopupServed:this.UTagLink({event_name:"email_modal_display"});break;case TrackingEventType.EmailPopupSubscribed:this.UTagLink({event_name:"email_subscribe_success",email_subscription_type:"modal"});break;case TrackingEventType.FarRecommendaRep:case TrackingEventType.FarLocateMyRep:this.FindARep(n);break;case TrackingEventType.ForgotPassword:this.UTagLink({event_name:"forget_password"});break;case TrackingEventType.HowMayIAssistThankYou:this.UTagData.howmayiassist=n.Data;break;case TrackingEventType.LoginSuccessful:this.UTagLink({event_name:"customer_sign_in_success",visitor_customer_id:AvonModule.AvonScope.Session.Customer.CustomerId});break;case TrackingEventType.ProductImageView:i=this.UTagData.product_image_urls?this.UTagData.product_image_urls:[];n.Data&&(r=n.Data.imageIndexes,u=n.Data.profileNumber,r.forEach(function(n){var r=n>1?"_"+n:"",t="prod_"+u+"_xl"+r+".jpg";_.contains(i,t)||i.push(t)}));this.UTagData.product_image_urls=i;break;case TrackingEventType.QuickShopProductView:this.TrackProductViewEvent("quickshop view");break;case TrackingEventType.RegistrationFullPage:this.UTagLink({event_name:"checkout_register_fullpage"});break;case TrackingEventType.ShopbyProductNumberSearchResults:this.UTagLink({event_name:"shop_product_number_search",shop_by_product_number_campaign:n.Data.campaignNumber,shop_by_product_number_query:n.Data.searchTerm,shop_by_product_number_results:n.Data.resultsNo});break;case TrackingEventType.WishListItemsAdded:this.UTagData.product_finding_method=n.Data.findingMethod;this.UTagLink({event_name:"wishlist_add",product_sku:n.Data.trackingItems,wishlist_state:n.Data.wishListState,product_finding_method:n.Data.findingMethod});break;case TrackingEventType.WishListShared:this.UTagLink({event_name:"wishlist_shared",product_sku:n.Data.trackingItems,social_share_method:n.Data.shareMethod});break;case TrackingEventType.EcommerceCheckoutData:this.UTagLink({event_name:n.Data.event_name,event_category:n.Data.event_category,event_action:n.Data.event_action,product_name:n.Data.product_name,product_short_sku:n.Data.product_short_sku,product_brand_name:n.Data.product_brand_name,product_quantity:n.Data.product_quantity,product_price:n.Data.product_price,product_category:n.Data.product_category,product_variant:n.Data.product_variant})}},t.prototype.TrackCartAddEvent=function(n,t,i,r){this.TrackEvent({event_name:"cart_add",product_fsc:[n],product_sku:[t],product_quantity:[i],product_finding_method:[r]})},t.prototype.TrackCartRemoveEvent=function(n,t,i,r,u,f){this.TrackEvent({event_name:"cart_remove",product_fsc:[n],product_sku:[t],product_quantity:[i],product_business_segment_name:[f.toLowerCase()],product_business_category_name:[r.toLowerCase()],product_business_unit_name:[u.toLowerCase()]});AvonModule.AvonScope.Session.Cart.OrderDetails.ItemCount===1&&i===0&&this.TrackCartClearEvent()},t.prototype.TrackCartClearEvent=function(){this.TrackEvent({event_name:"cart_clear"})},t.prototype.TrackProductViewEvent=function(n){var t=this.GetTrackingProductCategory();this.TrackEvent({event_name:"product_view",event_label:n?n:"product view",event_category:"cart actions",event_action:"product_view",product_brand_name:this.UTagData.product_brand_name,product_category_name:t,product_business_segment_name:this.UTagData.product_business_segment_name,product_business_category_desc:this.UTagData.product_business_category_desc,product_business_unit_name:this.UTagData.product_business_unit_name,product_fsc:this.UTagData.product_pfid,digital_catalog:this.UTagData.digital_catalog})},t.prototype.TrackVideoClickEvent=function(n){this.TrackEvent({event_name:"video_play",event_label:n,event_category:"Videos",event_action:"video_play"})},t.prototype.GetTrackingProductCategory=function(){var n=this.$rootScope.GetValueFromSessionStorage("AvonBreadcrumbs");if(!n)return"";while(!n[n.length-1].HasUrl)n.pop();return _.map(n,function(n){return n.Text}).splice(1).join(">")},t.prototype.UTagLink=function(n){var t=this;n&&(n.server_platform=this.UTagData.server_platform,_.delay(function(){t.WindowUtagLink(n)},250))},t.prototype.WindowUtagLink=function(n){this.$window.utag&&this.$window.utag.link(n)},t.prototype.UTagView=function(n){var t=this;n&&(n.server_platform=this.UTagData.server_platform,_.delay(function(){t.WindowUtagView(n)},250))},t.prototype.WindowUtagView=function(n){this.$window.utag&&this.$window.utag.view(n)},t.prototype.Initialize=function(){var r=$('.Slide[data-module="Featured Shops:"]'),u,n,t,i;r.length>0&&_.each(r,function(n){var t=$(n),i=t.find("img");t.attr("data-module",t.attr("data-module")+i.prop("alt"))});u=$(".ContentModule.GenericGrid");u.each(function(n,t){var i=$(t),r=i.find("div.StackCell");r.each(function(n,t){var i=$(t);i.each(function(n,t){var r=$(t),u=r.find(".ProductItemContainer"),f=u.attr("data-productid");i.attr("data-module",i.attr("data-module")+f)})})});n=$('img[alt="Promotion Banner"]');n.length>0&&n.attr("data-module","promobar");t=$('a[title="Details &amp; Exclusions"]');t.length>0&&t.attr("data-nav","promodetails");i=$("#BeautyProfileContainer a");i.length>0&&i.attr("data-actions","vmo:tryitnow")},t.prototype.FindARep=function(n){this.UTagData.find_a_rep_search_type=n.Data.searchType?n.Data.searchType:"";this.UTagData.find_a_rep_search_city=n.Data.model.City?n.Data.model.City:"";this.UTagData.find_a_rep_search_state=n.Data.model.State?n.Data.model.State:"";this.UTagData.find_a_rep_search_postal=n.Data.model.ZipCode?n.Data.model.ZipCode:"";this.UTagData.find_a_rep_search_status=n.Data.status?n.Data.status:"";this.UTagData.find_a_rep_search_results=n.Data.totalReps?n.Data.totalReps:0;var t="";this.$rootScope.IsCheckoutPage()?t="find a rep checkout":this.$rootScope.IsFindARepPage()||(t="find a rep pricing");this.UTagLink({event_name:"find_a_rep",event_category:t,find_a_rep_search_city:this.UTagData.find_a_rep_search_city,find_a_rep_search_postal:this.UTagData.find_a_rep_search_postal,find_a_rep_search_state:this.UTagData.find_a_rep_search_state,find_a_rep_search_results:this.UTagData.find_a_rep_search_results,find_a_rep_search_status:this.UTagData.find_a_rep_search_status,find_a_rep_search_type:this.UTagData.find_a_rep_search_type})},t.$inject=["$rootScope","$http","$q","$window"],t}(BaseAvonService);n.TrackingService=t}(TrackingServiceModule||(TrackingServiceModule={}));app.service("trackingService",TrackingServiceModule.TrackingService),function(n){var t=function(n){function t(t,i,r,u,f,e){n.call(this,t,i,f);this.$rootScope=t;this.$http=i;this.trackingService=r;this.addToBagTrackingService=u;this.modalService=e}return __extends(t,n),t.prototype.update=function(n){var t=this;return this.PostJson("/api/bag/update",n).success(function(n){var i=n.Data;t.$rootScope.$broadcast("BagService.Update",i)})},t.prototype.ApplyCoupon=function(n,t,i){var r=this;return this.PostJson("/api/bag/applycoupon",{couponCode:n,isPaymentPage:t,repCouponId:i}).then(function(n){return n.data.Data&&(n.data.Data.Type=ApplyCouponType.Add,r.$rootScope.$broadcast("BagService.ApplyCouponSuccess",n.data)),n.data.Data})},t.prototype.RemoveCoupon=function(n){var t=this;return this.PostJson("/api/bag/removecoupon",{isPaymentPage:n}).then(function(n){var i=n.data.Data;return i&&(i.Type=ApplyCouponType.Remove,t.$rootScope.$broadcast("BagService.ApplyCouponSuccess",n.data)),n.data.Data})},t.prototype.setPromoCoupon=function(n){this.PostJson("/api/bag/setpromocoupon",{couponCode:n})},t.prototype.updateAutoReplenishmentConsolidationItems=function(){var n=this;return this.PostJson("/api/bag/updateautoreplenishmentconsolidationitems",{}).success(function(){n.$rootScope.$broadcast("BagService.UpdateAutoReplenishmentConsolidationItems")})},t.prototype.autoSubscribeToBagItems=function(n){return this.PostJson("/api/myaccount/autosubscribetoitems",{autoSubscribeToItems:n})},t.prototype.changeRepModal=function(n){this.PostJson("/api/bag/changerep",{returnUrl:n})},t.prototype.addItemToBag=function(n,t,i){var r=this;return this.PostJson("/api/bag/additemtobag",{bagItem:n,displayModal:t}).success(function(n){var t=n.Data;t&&t.ItemsAdded.length>0&&(r.$rootScope.$broadcast("BagService.AddToBagSuccess",t),r.addToBagTrackingService.TrackItemsAddedToBag(t.ItemsAdded,i,r.$rootScope.Session.Cart.OrderDetails.SubTotal,r.$rootScope.Session.Cart.OrderDetails.ItemCount))}).error(function(){}).then(function(n){return n.data.Data})},t.prototype.addMultipleItemsToBag=function(n,t,i){var r=this;return this.PostJson("/api/bag/addmultipleitemstobag",{bagItems:n,displayModal:t}).success(function(n){var t=n.Data;t&&t.ItemsAdded.length>0&&(r.$rootScope.$broadcast("BagService.AddToBagSuccess",t),r.addToBagTrackingService.TrackItemsAddedToBag(t.ItemsAdded,i,r.$rootScope.Session.Cart.OrderDetails.SubTotal,r.$rootScope.Session.Cart.OrderDetails.ItemCount))}).error(function(){})},t.prototype.swapVariants=function(n){var t=this;this.PostJson("/api/bag/SwapVariants",{cartItem:n}).success(function(n){t.$rootScope.$broadcast("BagService.SwapVariantsSuccess",n)}).error(function(){})},t.prototype.lineEntryAddSingleProductToBag=function(n,t){var i=this,r=[n];return this.PostJson("/api/bag/lineentryaddtobag",{bagItems:r,conditionalProducts:[]}).success(function(n){var r=n.Data;r&&(i.$rootScope.$broadcast("BagService.LineEntryAddSingleProductToBag",n),i.addToBagTrackingService.TrackItemsAddedToBag(r.ItemsAdded,t,i.$rootScope.Session.Cart.OrderDetails.SubTotal,i.$rootScope.Session.Cart.OrderDetails.ItemCount))})},t.prototype.lineEntryAddProductsToBag=function(n,t){var i=this;this.PostJson("/api/bag/lineentryaddtobag",{bagItems:n,conditionalProducts:[]},null,!1).success(function(n){var r=n.Data;r!==null&&(i.$rootScope.$broadcast("BagService.LineEntryAddProductsToBag",n),i.addToBagTrackingService.TrackItemsAddedToBag(r.ItemsAdded,t,i.$rootScope.Session.Cart.OrderDetails.SubTotal,i.$rootScope.Session.Cart.OrderDetails.ItemCount))}).error(function(){})},t.prototype.addItemToWishlist=function(n){var t=this;this.PostJson("/api/bag/additemtowishlist",{productId:n}).success(function(n){n&&t.$rootScope.$broadcast("BagService.AddToWishlistSuccess",n)})},t.prototype.recalculateBag=function(n,t,i,r){var u=this;t===void 0&&(t=!0);i===void 0&&(i=!0);r===void 0&&(r=!1);this.PostJson("/api/bag/recalculate",{calculateShippingCosts:t,removeUnavailableProducts:i,shippingMethod:n}).success(function(n){u.$rootScope.$broadcast("BagService.RecalculateSuccess",n,r)})},t.prototype.getBag=function(){var n=this;this.GetJson("/api/bag/getbag",!0,!1).then(function(t){n.$rootScope.$broadcast("BagService.GetBagSuccess",t)})},t.prototype.loadWidgets=function(n){this.GetJson("/api/bag/loadwidgets",!0,!1,!1,!1,n)},t.prototype.RunPreCheckoutTests=function(){var n=this;this.PostJson("/api/bag/precheckouttests",{}).success(function(t){n.$rootScope.$broadcast("BagService.RunPreCheckoutTests",t)})},t.prototype.DisplayRepCouponModel=function(){if(this.$rootScope.Session.Rep.Id!=this.$rootScope.Session.RepCoupons[0].RepId)return this.changeRepModal(window.location.href);this.$rootScope.IsModalDisplayed=!0;this.modalService.ShowModalUrl("/api/bag/getrepcouponmodal")},t.$inject=["$rootScope","$http","trackingService","addToBagTrackingService","$q","modalService"],t}(BaseAvonService);n.BagService=t}(BagServiceModule||(BagServiceModule={}));app.service("bagService",BagServiceModule.BagService),function(n){var t=function(n){function t(t,i,r,u){n.call(this,t,i,r);this.$rootScope=t;this.trackingService=u;this.blankSession={Customer:this.getEmptyCustomer(),Rep:this.getEmptyRep(),LpmPreview:{Hash:0,IsPreviewMode:!1,PreviewAtDate:null},Cart:this.getEmptyCart(),NewHashes:this.getEmptyNewHashes(),ShopperSession:{BillingAddress:AddressHelper.CreateEmptyMyAddressModel(),ShippingAddress:AddressHelper.CreateEmptyMyAddressModel()},AutoReplenishSubscriptions:[],AutoReplenishmentConsolidation:[],Search:{SessionId:"",LogHandle:""},WebSessionId:"",PayPal:{IsAuthenticated:!1},Fundraiser:null,ShowEditLpmModuleButtons:!0,RepCoupons:null}}return __extends(t,n),t.prototype.UpdateBreadcrumbsInSession=function(n){this.PostJson("/api/session/updatebreadcrumbs",{breadcrumbs:n},null,!1)},t.prototype.Initialize=function(){this.$rootScope.SessionReady=!1;this.$rootScope.Session={};this.$rootScope.ExtendDeep(this.$rootScope.Session,this.blankSession);var n=this.$rootScope.GetValueFromSessionStorage(t.sessionName);n?(this.$rootScope.ExtendDeep(this.$rootScope.Session,n),this.$rootScope.SessionReady=!0,AVON.SessionHashes?(this.$rootScope.Session.NewHashes=AVON.SessionHashes,this.UpdateIfOld(this.$rootScope.Session.NewHashes)):this.UpdateFromServer()):this.UpdateFromServer()},t.prototype.UpdateIfOld=function(n){var r,i;return(r=this.$rootScope.Session.Customer.Hash!=n.CustomerHash||this.$rootScope.Session.Cart.Hash!=n.CartHash||this.$rootScope.Session.Rep.Hash!=n.RepHash||this.$rootScope.Session.LpmPreview.Hash!=n.LpmPreviewHash||(this.$rootScope.Session.Fundraiser?this.$rootScope.Session.Fundraiser.Hash:0)!=n.FundraiserHash,r)?(this.$rootScope.Session.NewHashes=n,this.$rootScope.SetValueIntoSessionStorage(t.sessionName,this.$rootScope.Session),this.UpdateFromServer()):(i=$.Deferred(),i.resolve(),i.promise())},t.prototype.UpdateFromServer=function(){var n=this;return t.waitingForServer||(this.$rootScope.SessionReady=!1,t.waitingForServer=$.Deferred(),this.$rootScope.Session.Customer.Hash!=this.$rootScope.Session.NewHashes.CustomerHash,this.$rootScope.Session.Cart.Hash!=this.$rootScope.Session.NewHashes.CartHash,this.$rootScope.Session.Rep.Hash!=this.$rootScope.Session.NewHashes.RepHash,this.GetJson("/api/session/usersession",!0,!1,!1).then(function(i){i.ErrorCode===AjaxError.None?(n.$rootScope.Session=i.Data,n.$rootScope.Session.NewHashes=i.SessionHashes,n.$rootScope.SetValueIntoSessionStorage(t.sessionName,n.$rootScope.Session),n.$rootScope.SessionReady=!0,n.$rootScope.SafeApply(),t.waitingForServer.resolve(n.$rootScope.Session),n.$rootScope.$broadcast("SessionService.SessionUpdated",n.$rootScope.Session),n.trackingService.UTagData&&!n.$rootScope.IsConfirmationPage()&&(n.trackingService.UTagData.cart_subtotal=n.$rootScope.Session.Cart.OrderDetails.SubTotal.toString(),n.trackingService.UTagData.cart_total_quantity=n.$rootScope.Session.Cart.OrderDetails.ItemCount.toString())):t.waitingForServer.reject(n.$rootScope.Session);t.waitingForServer=null})),t.waitingForServer.promise()},t.prototype.UpdateModel=function(n){this.$rootScope.Session=n;this.$rootScope.Session.NewHashes={CartHash:n.Cart.Hash,CustomerHash:n.Customer.Hash,RepHash:n.Rep.Hash,LpmPreviewHash:n.LpmPreview.Hash};this.$rootScope.SetValueIntoSessionStorage(t.sessionName,this.$rootScope.Session);this.$rootScope.SessionReady=!0;this.$rootScope.SafeApply();this.$rootScope.$broadcast("SessionService.SessionUpdated",this.$rootScope.Session)},t.prototype.WhenReady=function(){if(t.waitingForServer)return t.waitingForServer.promise();var n=$.Deferred();return n.resolve(this.$rootScope.Session),n.promise()},t.prototype.KeepAlive=function(){this.GetJson("/api/session/keepalive",!0,!1,!1,!1)},t.prototype.SetLanguage=function(n,t){t=t.toLowerCase().replace(/setlang=((en)|(es)|(1)|(2))[\&]?/g,"");t=t.replace(/\?$/,"");this.$rootScope.SetClientLanguage(n);this.$rootScope.ShowLoading(AVON.messages.spinner_loading);this.PostJson("/api/session/setlanguage",{language:n,redirectUrl:t},null,!1)},t.prototype.SwitchView=function(n){var t=window.location.href;this.$rootScope.ShowLoading(AVON.messages.spinner_loading);this.PostJson("/api/viewswitcher/switchview",{mobile:n,returnUrl:t},null,!1)},t.prototype.getEmptyCustomer=function(){return{Hash:0,FirstName:"",LastName:"",Email:"",Phone:"",PasswordHint:"",IsLoggedIn:!1,FacebookId:"0",IsFacebookUser:!1,IsPasswordSet:!1,IsPayPalCustomerLoggedIn:!1,IsAttached:!1,IsEligibleForGuestCheckout:!1,DeliveryType:DeliveryType.DirectOnly,Campaign:AVON.campaign,CustomerId:0,ShopperId:"",BillingAddress:AddressHelper.CreateEmptyAddressModel(),ShippingAddress:AddressHelper.CreateEmptyAddressModel(),IsNewVisitor:!1,IsEarmarkClosedPermanently:!1,WishList:null,DidA2HSBannerIOSShow:!1,IsA2HSBannerIOSDismissed:!1}},t.prototype.getEmptyRep=function(){return{Hash:0,Id:0,Name:"",FirstName:"",LastName:"",Address:"",CityStateZip:"",CityState:"",HomepageUrl:"",Phone:"",AlternativePhone:"",WebUrl:"",Status:"",IsInPilot:!1,IsGemini:!1}},t.prototype.getEmptyCart=function(){return{Hash:0,GiftMessage:{IsSet:!1,To:"",From:"",Message:""},OrderDetails:{ItemCount:0,HasHazmatItems:!1,HasRepOnlyItems:!1,HasDirectOnlyItems:!1,HasAutoReplenishItems:!1,HasNonDiscountableItems:!1,RepDeliveryEnabled:!0,DirectDeliveryEnabled:!0,IsShippingOverriddenToFree:!0,Discount:"",EstimatedTax:0,MerchandiseTotal:0,Shipping:0,ShippingSurcharge:0,SubTotal:0,HasRestrictedDeliveryItems:!1,Total:0},ShowPayPalExpress:!1,Campaigns:[],ConditionalProducts:[],OutOfStockProducts:[],UnDeliverableProducts:[],Coupon:{Code:"",Discount:null,DiscountType:null,Message:"",ErrorMessage:"",GiftAward:null},FreeShippingDetails:{IsQualified:!1,ShortFall:"",IsAvailable:!1},QtyItemsInCart:0,EstimatedTaxZipCode:"",IsPaymentRequired:!1,NumItemsInCart:0,IsAttached:!1}},t.prototype.getEmptyNewHashes=function(){return{CustomerHash:-1,CartHash:-1,RepHash:-1,LpmPreviewHash:-1,AutoReplenishmentSubscription:-1,AutoReplenishmentConsolidation:-1,FundraiserHash:-1}},t.$inject=["$rootScope","$http","$q","trackingService"],t.waitingForServer=null,t.sessionName="AvonShopSession",t}(BaseAvonService);n.SessionService=t}(SessionServiceModule||(SessionServiceModule={}));app.service("sessionService",SessionServiceModule.SessionService),function(n){var t=function(n){function t(i,r,u,f){n.call(this,i,r,u);this.generateHashCode=function(n){var t=0;try{t=n.split("").reduce(function(n,t){return n=(n<<5)-n+t.charCodeAt(0),n&n},0);t<0&&(t*=-1)}catch(i){t=0}return t};t.rootScope=i;t.http=r;t.q=u;t.SessionService=f;t.clientConfiguration=AVON.ClientConfiguration}return __extends(t,n),t.prototype.getHost=function(n){var i=this.generateHashCode(n),r=AVON.ClientConfiguration.CdnHostPaths.length;return"https://"+t.clientConfiguration.CdnHostPaths[i%r]+"/"},t.prototype.mediaImage=function(n){if(!n)return null;"/media/"!==t.clientConfiguration.LpmMediaFolder&&(n=n.replace("/media/",t.clientConfiguration.LpmMediaFolder));var i=this.getHost(n);return n.substr(0,1)=="/"&&(n=n.substr(1)),i+n},t.prototype.productImage=function(n,i,r){var f=i>1?"_"+(i-1):"",e="/prod_"+n+"_xl"+f+".jpg",u=this.getHost(n)+t.clientConfiguration.CdnPaths.Product.replace("[LANG]",AVON.LanguageCode)+e;return typeof r!="undefined"&&r!=null&&r!==0&&(u=u+"?w="+r),u},t.prototype.getProductImageBasedOnNameOrProfile=function(n,t,i,r){return t?this.getProductImage(t,i):this.productImage(n,r,i)},t.prototype.productImageXtraLarge=function(n){return this.getProductImage(n,ImageType.XtraLarge)},t.prototype.productImageLarge=function(n){return this.getProductImage(n,ImageType.Large)},t.prototype.productImageMedium=function(n){return this.getProductImage(n,ImageType.Medium)},t.prototype.productImageSmall=function(n){return this.getProductImage(n,ImageType.Small)},t.prototype.productImageXtraSmall=function(n){return this.getProductImage(n,ImageType.XtraSmall)},t.prototype.getProductImage=function(n,i){return n?this.getHost(n)+t.clientConfiguration.CdnPaths.Product.replace("[LANG]",AVON.LanguageCode)+"/"+n+"?w="+i:"/images/Responsive/Product/PhotoNotAvailable.png"},t.prototype.promoImage=function(n){return this.getHost(n.toString())+t.clientConfiguration.CdnPaths.Promotion.replace("[LANG]",AVON.LanguageCode)+"/promo_"+n+".jpg"},t.prototype.variantImage=function(n){return this.getHost(n)+t.clientConfiguration.CdnPaths.Variant.replace("[LANG]",AVON.LanguageCode)+"/shade_"+n+".gif"},t.prototype.representativeImage=function(n,t){if(t===void 0&&(t=null),!n)return null;var i=this.getHost(n)+"representative/"+n+".jpg";return t&&(i+="?timestamp="+encodeURIComponent(t)),i},t.prototype.fundraiserOrganisationImage=function(n,t){return n?t?this.getHost(n)+"fundraiser/"+n+".jpg?timestamp="+Date.now():this.getHost(n)+"fundraiser/"+n+".jpg":null},t.prototype.brochureImage=function(n){return this.getHost(n)+"catalog/"+AVON.campaign.toString().substring(0,4)+"/"+AVON.campaign.toString().substring(4,6)+"/"+AVON.LanguageCode+"/"+n},t.prototype.variantProductImage=function(n,i){return this.getHost(n)+t.clientConfiguration.CdnPaths.VariantProductImage.replace("[LANG]",AVON.LanguageCode)+"/VARIANT_"+n+".jpg?w="+i},t.$inject=["$rootScope","$http","$q","sessionService","trackingService"],t}(BaseAvonService);n.CdnService=t}(CdnServiceModule||(CdnServiceModule={}));app.service("cdnService",CdnServiceModule.CdnService),function(n){var t=function(n){function t(t,i,r,u){n.call(this,t,i,r);this.$rootScope=t;this.$window=u}return __extends(t,n),t.prototype.Action=function(n,t){for(var f,r=[],u=2;u<arguments.length;u++)r[u-2]=arguments[u];n=n.toLowerCase();t=t.toLowerCase();var e=$("html").attr("lang").substr(0,2),i="",o=_.find(this.$rootScope.ClientConfiguration.RouteTranslations,function(i){return i.Controller==t&&(i.Action==n||i.Action=="index"&&n=="")&&i.Language==e});if(o?i=o.Url:(i=e=="es"&&i.indexOf("/es/")===-1?"/es/":"/",i=n=="index"?i+t:i+t+"/"+n),i=i.replace(/{.*}/,""),i=i.replace(/\?.*/,""),i=i.replace(/\/*$/,""),r)for(f=0;f<r.length;f++)i+="/"+r[f];return i},t.prototype.ActionWithQueryString=function(n,t,i){for(var u,f=[],r=3;r<arguments.length;r++)f[r-3]=arguments[r];return u=this.Action(n,t,f),i.length>0&&(u+="?"+this.queryStringParametersToString(i)),u},t.prototype.SetQueryStringParameterToUrl=function(n,t,i,r){r===void 0&&(r=!0);var u=[{Key:t,Value:i}];return this.SetQueryStringParametersToUrl(n,u,r)},t.prototype.SetQueryStringParametersToUrl=function(n,t,i){var r;if(i===void 0&&(i=!0),t&&t.length>0){var u=this.getQueryStringParameters(n),f=this.GetPath(n),e=this.concatQueryStringParameters(u,t,i),o=this.GetHashValue(n);r=this.getUrlString(f,e,o)}else r=n;return r},t.prototype.RemoveQueryStringParameterFromUrl=function(n,t){var u,f=n.split("?"),r,o,s;if(f.length>=2){var e=f[1].split("#"),h=encodeURIComponent(t)+"=",i=e[0].split(/[&;]/g);for(r=i.length;r-->0;)i[r].lastIndexOf(h,0)!==-1&&i.splice(r,1);o=i.length>0?"?"+i.join("&"):"";s=e.length>1?"#"+e.slice(1).join("#"):"";u=""+f[0]+o+s}else u=n;return u},t.prototype.GetQueryStringParameterValue=function(n,t){for(var r,u=null,e=this.getQueryStringParameters(n),i=0,f=e;i<f.length;i++)if(r=f[i],r.Key==t){u=r.Value;break}return u},t.prototype.GetHashValue=function(n){var t=n.split("#");return t.length>1?t[1]:""},t.prototype.SetHashValue=function(n,t){var i=this.GetPath(n),r=this.getQueryStringParameters(n);return this.getUrlString(i,r,t)},t.prototype.IsUrlAbsolute=function(n){return n&&n.indexOf("http://")===0||n.indexOf("https://")===0},t.prototype.GetPath=function(n){var t=n.split(/[?#]/);return t[0]},t.prototype.getUrlString=function(n,t,i){var r=this.queryStringParametersToString(t),u=r?"?"+r:"",f=i?"#"+i:"";return""+n+u+f},t.prototype.concatQueryStringParameters=function(n,t,i){var r,u;return i?(u=n.filter(function(n){return!t.some(function(t){return n.Key==t.Key})}),r=u.concat(t)):r=n.concat(t),r},t.prototype.getQueryStringParameters=function(n){for(var o,r=[],s=n.split("#"),h=s[0],u=h.split("?"),c=u.length>1?u[1]:"",l=c.split("&"),t=0,f=l;t<f.length;t++){var a=f[t],i=a.split("="),e=i[0];e&&(o={Key:decodeURIComponent(e),Value:decodeURIComponent(i.length>1?i[1]:"")},r.push(o))}return r},t.prototype.queryStringParametersToString=function(n){var f="",r,i,u,t,e;if(n&&n.length>0){for(r=[],i=0,u=n;i<u.length;i++)t=u[i],t.Key&&(e=t.Value?t.Value:"",r.push(encodeURIComponent(t.Key)+"="+encodeURIComponent(e)));f+=r.join("&")}return f},t.$inject=["$rootScope","$http","$q","$window"],t}(BaseAvonService);n.UrlService=t}(UrlServiceModule||(UrlServiceModule={}));app.service("urlService",UrlServiceModule.UrlService);BaseAngularController=function(){function n(n,t,i){t===void 0&&(t=null);i===void 0&&(i=null);this.ConvertDateStringsToDates=function(n){var i,t,u,r;if(typeof n=="object")for(i in n)n.hasOwnProperty(i)&&(t=n[i],typeof t=="string"&&(u=t.match(this.regexIso8601))?(r=Date.parse(u[0]),isNaN(r)||(n[i]=new Date(r))):typeof t=="object"&&this.ConvertDateStringsToDates(t));return n};n.SafeApply=function(n){var t=this.$root.$$phase;t=="$apply"||t=="$digest"?n&&typeof n=="function"&&n():this.$apply(n)};n.HomePageUrl=AVON.languageId===Language.Spanish?"/es/":"/";n.DisplayCountryName=function(n){var t=AVON.Countries,i;return!t||t.length===0?n:(i=_.find(t,function(t){return t.IsoCode===n}),i)?i.Name:n};n.SignInPageUrl=function(t){var i=n.HomePageUrl+"signin";return t&&(i+="?mode="+t),i};n.SetValueIntoSessionStorage=function(n,t){try{window.sessionStorage[n]=JSON.stringify(t)}catch(i){}};n.GetValueFromSessionStorage=function(n){try{return JSON.parse(window.sessionStorage[n])}catch(t){return null}};n.ShowWishListTooltip=function(t){n.ShowTooltip(t)};n.HideWishListTooltip=function(t){n.HideTooltip(t)};n.ShowTooltip=function(t){var r=$(angular.element(t.currentTarget)[0]),i=r.find(".OverlayContainer");!i||AVON.IsTabletDevice||n.IsMobile||i.addClass("active")};n.HideTooltip=function(n){var i=$(angular.element(n.currentTarget)[0]),t=i.find(".OverlayContainer");t&&t.removeClass("active")};n.HideLineNumber=function(n){return _.contains(["991-025","000-000"],n)};n.UpdateInlineWaterMark=function(){$(".InputContainer.inlineWaterMark").each(function(){var n=$(this),t=n.find("input");t.val()&&t.val().length>0?n.hasClass("applyInlineWaterMark")===!1&&n.addClass("applyInlineWaterMark"):n.hasClass("applyInlineWaterMark")&&t.is(":focus")===!1&&n.removeClass("applyInlineWaterMark")})};n.SetCreditCardType=function(t){if(t){if(!t.CardNumber){t.Type="";return}var i=n.AutoDetectCreditCardType(t.CardNumber);t.Type=i!==CreditCardType.Unknown?i:""}};n.GetCreditCardTypeImageClass=function(n){if(!n||!n.Type||n.Type==CreditCardType.Unknown)return"";switch(n.Type){case CreditCardType.Amex:return"creditCardTypeImage imageForAmex";case CreditCardType.Jcb:case CreditCardType.Discover:return"creditCardTypeImage imageForDiscover";case CreditCardType.MasterCard:return"creditCardTypeImage imageForMasterCard";case CreditCardType.Visa:return"creditCardTypeImage imageForVisa";default:return""}};n.IsCreditCardTypeKnown=function(t){return t?t.CardNumber?t.CardNumber.length>6&&(t.Type==""||t.Type==CreditCardType.Unknown||n.AutoDetectCreditCardType(t.CardNumber)===CreditCardType.Unknown)?!0:!1:!1:!1};n.ExtendDeep=function(t){return angular.forEach(arguments,function(i){i!==t&&angular.forEach(i,function(i,r){t[r]&&t[r].constructor&&t[r].constructor===Object?n.ExtendDeep(t[r],i):t[r]=i})}),t};n.HideLoading=function(){n.$emit("HideLoading")};n.SecureHtml=function(t){return n.$sce.trustAsHtml(t)};n.RedirectToUrl=function(t,i){i&&n.ShowLoading(AVON.messages.spinner_loading);window.location.href=t};n.IsTouchDevice=function(){return $("html").hasClass("touch")};n.IsBlog=function(){return $("html").hasClass("Blog")};n.IsMobileOrTablet=AVON.IsTabletDevice||n.IsMobile;n.IsSafariBrowser=navigator.userAgent&&!!navigator.userAgent.match(/(iPad|iPhone|iPod)/g);n.IsIPad=navigator.platform.match(/(iPad)/i)||navigator.userAgent.match(/(iPad)/i)?!0:!1;n.IsIE9=function(){return $("html").hasClass("ie9")};n.IsIE11=function(){return!!window.MSInputMethodContext&&!!document.documentMode};n.IsEdge=function(){return navigator.userAgent.match(/(Edge)/i)?!0:!1};n.RefreshContextValues=function(n){$("input[ng-model]",n).each(function(){if(angular.element(this).attr("type")!=="checkbox"&&angular.element(this).attr("type")!=="radio"){var n=angular.element(this);n.controller("ngModel").$setViewValue($(this).val())}})};n.IsPoBoxAddress=function(n){for(var i,r=n.length,t=0;t<r;t++)if(i=/(P(\.|-|\/){0,1}(\s){0,1}O(\.|-|\/){0,1}(\s){0,1}(BX|ST OFFICE (BOX|BIN)|BOX|BIN|B(\.){0,1}|DRAWER)|(BOX|BIN)(\.|-|\/){0,1}(\s){0,1})(\.|-|\/){0,1}(\s){0,1}(#|NUMBER|NUM|NO){0,1}(\s){0,1}\d+/i.exec(n[t]),i!=null&&i.length>0)return!0;return!1};n.ScrollIntoView=function(n,t,i){var r;t==null&&(t=-90);r={duration:400,direction:"y",complete:null,offsetY:t};_.delay(function(){$(n).scrollintoview(i!=null?i:r)},100)};n.ScrollToTop=function(n,t,i){var r=0,u;n&&(r=n.offset().top,r+=-90,i&&(r-=90));t?$("html, body").animate({scrollTop:r+"px"},"fast"):$("html, body").animate({scrollTop:r+"px"},0);u=$(".ModalCloseIcon.Close");u==null||n||t||u.click()};n.BroadcastToElement=function(n,t,i){for(var u,f=[],r=3;r<arguments.length;r++)f[r-3]=arguments[r];return u=[i],f&&(u=u.concat(f)),n.$broadcast.apply(this,u)};n.ProcessAjaxValidationErrors=function(t,i){i?i.ServerErrors=t.ValidationErrors:n.ServerErrors=t.ValidationErrors;t.ValidationErrors&&t.ValidationErrors.length&&(i?i.ShowValidation=!0:n.ShowValidation=!0)};n.CleanPrivacyPolicy=function(n){_.isUndefined(n)===!1&&_.delay(function(){n.registrationModel_PrivacyPolicy.$invalid=!0;var t=$("input[name="+n.registrationModel_PrivacyPolicy.$name+"]");t.closest(".FormError").removeClass("FormError")},500)};n.ClearServerErrorsForForm=function(n){angular.forEach(n,function(t,i){_.isUndefined(t)===!1&&_.isEmpty(t)===!1&&_.has(t,"$invalid")&&t.$invalid&&n[i].$setValidity("server",!0)})};var r="xxxxxxxxxxxx",u="xxxxxxxxxxx";n.AppendPlaceholderToCreditCardNumber=function(n){n.CardNumber=r+n.LastFourDigits;n.Type===CreditCardType.Amex&&(n.CardNumber=u+n.LastFourDigits)};n.IsCreditCardNumberPlaceholderOnly=function(n){if(!n.CardNumber||n.CardNumber==null)return!1;var t=n.CardNumber.indexOf(r)>=0;return n.Type==CreditCardType.Amex&&(t=n.CardNumber.indexOf(u)>=0),t};n.SetLanguage=function(t,i){t.preventDefault();var r=$(angular.element(t.currentTarget)[0]).attr("href");r.indexOf("?")<0&&(r+=window.location.search);n.SessionService.SetLanguage(i,r)};n.IsEmailValid=function(n){return/^[\w-]+(?:\.[\w-]+)*@(?:[\w-]+\.)+[a-zA-Z]{2,7}$/.test(n)};n.CheckElementValue=function(t){var i=$(t).val();return!1==n.isNullOrWhiteSpace(i)};n.isNullOrWhiteSpace=function(n){return _.isUndefined(n)||_.isNull(n)||n.trim().length===0};n.isCustomerCookiedToRep=function(){return n.Session.Rep.Id>0};n.isCustomerAttachedToRep=function(){return n.Session.Customer.IsAttached};n.isCustomerAttachedOrCookiedToRep=function(){return n.isCustomerCookiedToRep()||n.isCustomerAttachedToRep()};n.isCustomerAttachedToRemovedRep=function(){return n.Session.Rep.Status=="R"};n.LeftNavigationFlatSelectedFacets=function(){return n.LeftNavigationSelectedFacets.length==0?[]:_(n.LeftNavigationSelectedFacets).chain().pluck("Facets").flatten().value()};n.getValidBagItems=function(n){return _.filter(n,function(n){var t=parseInt(String(n.qty),10);return n.qty==null||n.qty.toString()===""||t>0})};n.IsAndroid=navigator.userAgent.match(/Android/i)?!0:!1;n.isTouchCapableDevice="ontouchstart"in window||navigator.maxTouchPoints>0||navigator.msMaxTouchPoints>0;n.IsHomePage=function(){return window.location.pathname===n.HomePageUrl};n.IsHomePagePath=function(t){var i=document.createElement("a");return i.href=t,i.pathname===n.HomePageUrl};n.IsShoppingBagPage=function(){return window.location.pathname==="/bag"||window.location.pathname==="/es/bag"};n.IsConfirmationPage=function(){return window.location.pathname==="/checkout/confirmation"||window.location.pathname==="/es/checkout/confirmation"};n.IsCheckoutPage=function(){return window.location.pathname==="/checkout"||window.location.pathname==="/es/checkout"};n.IsFindARepPage=function(){return window.location.pathname==="/findarep"||window.location.pathname==="/es/findarep"};n.IsMyAccountPage=function(){return window.location.pathname.indexOf("/myaccount")>-1};n.IsSearchPage=function(){return window.location.pathname.indexOf("/search/")>-1};n.GetUpdatedUrl=function(t,i){var f=window.location.href.indexOf("?")>-1?"&":"?",r=window.location.href,u=i?i.join(","):null;return window.location.href.toLowerCase().indexOf(t)>-1?r=n.UpdateQueryStringParameter(window.location.href,t,u):u&&(r+=f+t+"="+u),r};n.UpdateQueryStringParameter=function(n,t,i){var f=new RegExp("([?&])"+t+"[^&]*","i"),e=new RegExp("([?&])"+t+"=[^&;]+[&;]?","i"),u=t+"="+i,r="?"+u;return(i?r=n.match(f)!==null?n.replace(f,"$1"+u):n+"&"+u:(r=n.replace(e,"$1"),r=r.replace(/[&;]$/,"")),r.substr(-1)==="?")?r.substr(0,r.length-1):r};n.RemoveQueryStringParameterByName=function(n,t){var u="",f,i,r;if(!t)return u;if(t=t.replace("?",""),t){for(f=encodeURIComponent(n)+"=",i=t.split(/[&;]/g),r=i.length;r-->0;)i[r].lastIndexOf(f,0)!==-1&&i.splice(r,1);return i.length>0?"?"+i.join("&"):""}return u};n.renderDataModPropertyAttribute=function(n){return n?"mp-"+AVON.campaignYear+":"+AVON.campaignNumber+":"+n:""};n.renderDataAnalyticsAttribute=function(t,i){return t?n.renderDataModPropertyAttribute(t):i};n.ShowProductRating=function(n){var t=window.ProductModule;return t!=null&&t.productScope!=null?t.productScope.displayProductBasedOnShowHideFlag(n,"IncludeInPowerReviews"):!0};n.ShowSearchBox=!0;n.IsLeavingFundraiserPageWithoutShopping=function(){var t=AVON.Fundraiser,i=window.location.pathname.search("fundraiser")>-1;return!t||!i||!t.IsActive?!1:n.Session.Fundraiser?n.Session.Fundraiser.VanityName!==t.VanityName?!0:!1:!0};n.openLpmContent=function(n,t,i){n.stopPropagation();window.open(t+"/Umbraco/#/content/content/edit/"+i,"_blank")}}return n.prototype.DefaultImageSize=function(n){n.animate({width:"100%"},300)},n.prototype.ExpandedImageSize=function(n){n.animate({width:ImageType.XtraLarge+"px"},300)},n.prototype.GetBaseUrl=function(){var n=window.location.host;return window.location.protocol+"//"+n},n.prototype.GetHostName=function(){return document.location.hostname},n.regexIso8601=/^(\d{4}|\+\d{6})(?:-(\d{2})(?:-(\d{2})(?:T(\d{2}):(\d{2}):(\d{2})\.(\d{1,})(Z|([\-+])(\d{2}):(\d{2}))?)?)?)?$/,n}();BaseAnimations=function(){function n(){}return n.prototype.enter=function(n,t,i,r){return r()},n.prototype.leave=function(n,t){return t()},n.prototype.move=function(n,t,i,r){return r()},n.prototype.beforeAddClass=function(n,t,i){i()},n.prototype.addClass=function(n,t,i){return i()},n.prototype.beforeRemoveClass=function(n,t,i){i()},n.prototype.removeClass=function(n,t,i){return i()},n.prototype.allowCancel=function(){return!0},n}(),function(n){"use strict";var r=function(){function n(){this.Caption="";this.Title="";this.IconCode="";this.AlternativeText="";this.IconUrl="";this.IconColor="";this.Url="";this.Id=null;this.Target="";this.SortOrder=null;this.AdditionalLinks=null;this.GroupNames=null;this.GroupedChildren=null;this.Children=null;this.TopPromotionThumbnails=null;this.IncludeInTopNavigation=null;this.IncludeInTopBrandsNavigation=null;this.IncludeInAllBrandsPage=null;this.IncludeInLeftNavigation=null;this.AlphabetLetter=null;this.Type=""}return n}(),t=function(){function n(){}return n.brands="brands",n.brandsES="marcas",n.category="category",n.categoryES="categoría",n.categories="categories",n.categoriesES="categorías",n}(),i;n.GroupNameLower=t;i=function(i){function u(u,f){i.call(this,u);n.allCategoryScope=u;n.allCategoryScope.TopMenuItems=AVON.TopNavigation;n.allCategoryScope.AllBrands=[];f.GetTopNavigationCategories();n.allCategoryScope.checkGroupName=function(n){var i=n.toLowerCase();return i===t.category||i===t.categoryES||i===t.categories||i===t.categoriesES};n.allCategoryScope.shouldSubCategoryShow=function(n){return n.IncludeInTopNavigation};n.allCategoryScope.$on("NavigationService.MenuLoaded",function(i,u){var o,e,f,s;for(n.allCategoryScope.TopMenuItems=u.Data.TopMenuItems,angular.forEach(n.allCategoryScope.TopMenuItems,function(i){i.Type=="Brand"&&i.Caption&&i.Caption.length>0&&n.allCategoryScope.shouldSubCategoryShow(i)&&(i.IncludeInAllBrandsPage=i.IncludeInTopNavigation,i.AlphabetLetter=i.Caption.charAt(0).toUpperCase(),n.allCategoryScope.AllBrands.push(i));angular.forEach(i.GroupNames,function(r){var u=r.toLowerCase();(u===t.brands||u===t.brandsES)&&angular.forEach(i.GroupedChildren[r],function(t){n.allCategoryScope.shouldSubCategoryShow(t)&&t.IncludeInAllBrandsPage&&t.Caption&&t.Caption.length>0&&(t.AlphabetLetter=t.Caption.charAt(0).toUpperCase(),n.allCategoryScope.AllBrands.push(t))})})}),o=4,e=Math.ceil(n.allCategoryScope.AllBrands.length/4),n.allCategoryScope.AllBrands.sort(function(n,t){var i=n.Caption.toUpperCase(),r=t.Caption.toUpperCase();return i<r?-1:i>r?1:0}),n.allCategoryScope.AllBrandsColumnGrouped=[],f=0;f<o;f++)n.allCategoryScope.AllBrandsColumnGrouped[f]=n.allCategoryScope.AllBrands.slice(e*f,e*(f+1));s="ABCDEFGHIJKLMNOPQRSTUVWXYZ".split("");angular.forEach(s,function(t){var u=_.where(n.allCategoryScope.AllBrands,{AlphabetLetter:t}).length,i;u===0&&(i=new r,i.AlphabetLetter=t,n.allCategoryScope.AllBrands.push(i))});n.allCategoryScope.AllBrandsAlphaGrouped=_.groupBy(n.allCategoryScope.AllBrands,"AlphabetLetter")})}return __extends(u,i),u.$inject=["$scope","NavigationService"],u}(BaseAngularController);n.AllCategoryController=i}(AllCategoryModule||(AllCategoryModule={}));app.controller("AllCategoryController",AllCategoryModule.AllCategoryController);EnglishMessages=function(){function n(){this.language="en";this.spinner_adding="Adding…";this.spinner_addingTextOnly="Adding";this.spinner_addingToBag="Adding item to bag…";this.spinner_addresses="Updating addresses…";this.spinner_coupon="Updating your Coupon Information…";this.spinner_facebook="Contacting Facebook";this.spinner_login="Signing In…";this.spinner_logout="Signing Out…";this.spinner_loading="Loading…";this.spinner_processing="Processing…";this.spinner_registering="Registering…";this.spinner_remove="Removing Item from bag…";this.spinner_saving="Saving…";this.spinner_searching="Searching…";this.spinner_subscribing="Subscribing…";this.spinner_updatingBag="Updating your bag…";this.spinner_vmo="Loading Virtual Makeover…";this.spinner_changingEmailAddress="Changing Email Address...";this.spinner_updatingEmailAddress="Updating Email Address...";this.spinner_unsubscribing="Unsubscribing...";this.notifyModal_enterValidEmail="Please enter a valid e-mail address";this.product_enterValidQty="You must specify a valid <b>quantity<\/b> of the product when adding to your bag";this.product_enterValidQtyMark="You must specify a valid <b>quantity<\/b> before adding to bag";this.productReviews_noReviewsAvailable="No reviews currently available";this.productTabs_readMore="Read More";this.productTabs_close="Close";this.commonscript_addedToBasketItemOne="Item Added";this.commonscript_addedToBasketItemsCount="Items Added";this.commonscript_mustSpecifyVersionMsg="You must specify a version of the product when adding to your bag";this.shareemail_subject="Check out this AVON product";this.shareemail_body="[PRODUCTNAME]: [PRODUCTURL]";this.validate_email_required="Email address can not be blank";this.validate_email_invalid="Invalid email address";this.validate_password_required="Password can not be blank";this.validate_password_invalid_format="Password format is not valid";this.validate_password_match="The passwords do not match";this.validate_passwordhint_required="Password hint can not be blank";this.validate_field_required="The field is required";this.validate_email_match="The emails do not match";this.validate_invalid_number="Invalid number";this.validate_invalid_phonenumber="Please adjust your telephone number. Do not use dashes or other symbols, or start the area code with a 0 or 1.";this.English="English";this.Spanish="Spanish";this.coupon_no_change="Coupon Code is not applicable.";this.commonscript_repCouponAdded="Code Added";this.reCaptchaNotChecked="Please confirm you are not a Robot.";this.reCaptchaErrorMessage="We're sorry, there was an error submitting the form. Please confirm you are not a robot and try submitting again."}return n}();SpanishMessages=function(){function n(){this.language="es";this.spinner_adding="Carga…";this.spinner_addingTextOnly="Añadiendo";this.spinner_addingToBag="Añadiendo a tu bolsa…";this.spinner_addresses="Actualizando direcciones…";this.spinner_coupon="Actualizando información del cupón";this.spinner_facebook="Contactando a Facebook";this.spinner_loading="Cargando…";this.spinner_processing="Procesando…";this.spinner_login="Iniciando sesión…";this.spinner_logout="Salir…";this.spinner_registering="Inscripción en proceso…";this.spinner_remove="Eliminación del artículo de cesta…";this.spinner_saving="Guardando…";this.spinner_searching="Búsqueda…";this.spinner_subscribing="Suscribirse…";this.spinner_updatingBag="Actualizando tu bolsa…";this.spinner_vmo="Cargando Maquillador Virtual…";this.spinner_changingEmailAddress="Cambiando correo electrónico...";this.spinner_updatingEmailAddress="Actualizando correo electrónico...";this.spinner_unsubscribing="Cancelando suscripción...";this.notifyModal_enterValidEmail="Por favor escribe un correo electrónico válido";this.product_enterValidQty="Debes especificar una <b>cantidad<\/b> válida del producto cuando agregas artículos a tu bolsa";this.product_enterValidQtyMark="You must specify a valid <b>quantity<\/b> before adding to bag";this.productReviews_noReviewsAvailable="No hay reseñas disponibles en este momento";this.productTabs_readMore="Seguir leyendo";this.productTabs_close="Contraer texto";this.commonscript_addedToBasketItemOne="añadido";this.commonscript_addedToBasketItemsCount="añadidos";this.commonscript_mustSpecifyVersionMsg="Debes especificar una versión válida del producto cuando lo añadas a tu bolsa";this.shareemail_subject="Mira este producto AVON";this.shareemail_body="[PRODUCTNAME]: [PRODUCTURL]";this.validate_email_required="Por favor, ingresa tu dirección de email";this.validate_email_invalid="Dirección de email no válida";this.validate_password_required="Por favor, ingresa tu contrasea tu contraseña";this.validate_password_invalid_format="Formato de password invalido";this.validate_password_match="Las contraseña no coincide";this.validate_passwordhint_required="La pista de contraseña no puede ser blanco";this.validate_field_required="El campo es obligatorio";this.validate_email_match="Los emails no coinciden";this.validate_invalid_number="Número invalido";this.validate_invalid_phonenumber="Ajuste por favor su número de teléfono. No use guiones u otros símbolos, o iniciar el código de área con un 1.";this.English="Inglés";this.Spanish="Español";this.coupon_no_change="El código de cupón no es aplicable.";this.commonscript_repCouponAdded="Código Agregado";this.reCaptchaNotChecked="Confirma que no eres un robot.";this.reCaptchaErrorMessage="Lo sentimos, hubo un error en el envío del formulario. Confirma que no eres un robot e inténtalo de nuevo."}return n}(),function(n){var t=function(n){function t(t,i,r){n.call(this,t,i,r)}return __extends(t,n),t.prototype.ShowModalUrl=function(n,t){t===void 0&&(t=!0);this.GetJson(n,!0,!1,!0,t).then(function(){})},t.prototype.ShowModal=function(n,t,i,r,u){t===void 0&&(t=null);i===void 0&&(i=!0);r===void 0&&(r=!0);u===void 0&&(u=!1);var f={AllowExit:r,KeepLoaded:i,ExtractModelToScope:u,Model:t};$(n).trigger("modal",f)},t.prototype.ShowModalWithOptions=function(n,t){$(n).trigger("modal",t)},t.prototype.CloseModal=function(n){n===void 0&&(n=null);n?$(n).trigger("close"):$(".Shown > *[modal]").trigger("close")},t.$inject=["$rootScope","$http","$q"],t}(BaseAvonService);n.ModalService=t}(ModalServiceModule||(ModalServiceModule={}));app.service("modalService",ModalServiceModule.ModalService);ResetPasswordModel=function(){function n(n,t,i,r,u,f){this.Id=n;this.SecurityToken=t;this.Email=i;this.Password=r;this.PasswordConfirm=u;this.PasswordHint=f}return n}(),function(n){var t=function(n){function t(t,i,r,u){n.call(this,t,i,r);this.$rootScope=t;this.emailSignUpTrackingService=u;this.displayForgotPassword=!1;this.forgotEmail=""}return __extends(t,n),t.prototype.login=function(n,t,i){var r=this;this.PostJson("/api/login/login",{loginModel:n},t).success(function(n){n.Data.CustomerSilentlyAttached&&r.emailSignUpTrackingService.TrackEmailSignUp(EmailSubscriptionSource.AttachRep);r.$rootScope.$broadcast("LoginService.LoginResponse",n,i)}).error(function(n){r.$rootScope.$broadcast("LoginService.LoginResponse",n,i)})},t.prototype.autoLogin=function(n,t){var i=this;this.PostJson("/api/logIn/logIn",{loginModel:n},t).success(function(n){i.$rootScope.$broadcast("LoginService.AutoLoginResponse",n)}).error(function(n){i.$rootScope.$broadcast("LoginService.AutoLoginResponse",n)})},t.prototype.loginWIthFacebook=function(n,t,i){var r=this;this.PostJson("/api/login/loginwithfacebook",{accessToken:n,password:t,returnUrl:i}).then(function(n){r.$rootScope.$broadcast("LoginService.FacebookLoginResponse",n)})},t.prototype.registerWithFacebook=function(n,t,i){var r=this;this.PostJson("/api/login/registerwithfacebook",{accessToken:n,notifySpecialOffers:t,returnUrl:i}).then(function(n){r.$rootScope.$broadcast("LoginService.FacebookRegisterResponse",n)})},t.prototype.verifySingleSignOn=function(n){this.PostJson("/api/login/verifysinglesignon",{securityToken:n})},t.prototype.updatePrivacyPolicy=function(n){this.PostJson("/api/login/updateprivacypolicy",{privacyPolicyModel:n}).success(function(){}).error(function(){})},t.prototype.convertEmail=function(n,t){var i=this;this.PostJson("/api/login/convertemail",{email:n}).success(function(n){n!==null&&i.$rootScope.$broadcast(t,n)}).error(function(n){i.$rootScope.$broadcast(t,n)})},t.prototype.forgotPassword=function(n,t){var i=this;this.PostJson("/api/login/forgotpassword",{email:t,returnUrl:n}).success(function(n){n!==null&&i.$rootScope.$broadcast("LoginService.ForgotPasswordResponse",n)}).error(function(n){i.$rootScope.$broadcast("LoginService.ForgotPasswordResponse",n)})},t.prototype.resetPassword=function(n,t){var i=this;this.PostJson("/api/login/changepassword",{changePasswordModel:n},t).success(function(n){n!==null&&i.$rootScope.$broadcast("LoginService.ResetPasswordResponse",n)}).error(function(n){i.$rootScope.$broadcast("LoginService.ResetPasswordResponse",n)})},t.prototype.changePassword=function(n,t){var i=this;this.PostJson("/api/login/changepassword",{changePasswordModel:n},t).success(function(n){n!==null&&i.$rootScope.$broadcast("LoginService.ChangePasswordResponse",n)}).error(function(n){i.$rootScope.$broadcast("LoginService.ChangePasswordResponse",n)})},t.prototype.sendNewPassword=function(n,t){var i=this;this.PostJson("/api/login/sendnewpassword",{ForgotPasswordModel:{email:n}},t).success(function(n){n!==null&&i.$rootScope.$broadcast("LoginService.SendNewPasswordResponse",n)}).error(function(n){i.$rootScope.$broadcast("LoginService.SendNewPasswordResponse",n)})},t.prototype.sendPasswordHint=function(n,t){var i=this;this.PostJson("/api/login/sendpasswordhint",{ForgotPasswordModel:{email:n}},t).success(function(n){n!==null&&i.$rootScope.$broadcast("LoginService.SendPasswordHintResponse",n)}).error(function(n){i.$rootScope.$broadcast("LoginService.SendPasswordHintResponse",n)})},t.prototype.logOut=function(n,t){n||(n=t);this.PostJson("/api/login/logout",{redirectUrl:n})},t.prototype.changeRepresentiveModal=function(n,t){var i=this;this.PostJson("/api/login/changerep",{returnUrl:n,mode:"",cookieRepId:t}).success(function(n){n!==null&&i.$rootScope.$broadcast("LoginService.ChangeRepModal",n)}).error(function(n){i.$rootScope.$broadcast("LoginService.ChangeRepModal",n)})},t.$inject=["$rootScope","$http","$q","emailSignUpTrackingService"],t}(BaseAvonService);n.LoginService=t}(LoginServiceModule||(LoginServiceModule={}));app.service("loginService",LoginServiceModule.LoginService),function(n){var t=function(n){function t(t,i,r,u){n.call(this,t,i,r);this.$rootScope=t;this.emailSignUpTrackingService=u}return __extends(t,n),t.prototype.subscribeEmail=function(n,t){var i=this;this.PostJson("/api/subscribe/subscribeemail",n,t).success(function(t){t!==null&&(i.emailSignUpTrackingService.TrackEmailSignUp(n.Source),i.$rootScope.$broadcast("SubscribeService.SubscribeResponse",t))}).error(function(n){i.$rootScope.$broadcast("SubscribeService.SubscribeResponse",n)})},t.prototype.emailSignup=function(n,t){var i=this;this.PostJson("/api/subscribe/emailsignup",n,t).success(function(n){n!==null&&i.$rootScope.$broadcast("EmailSignupService.EmailSignupResponse",n)}).error(function(n){i.$rootScope.$broadcast("EmailSignupService.EmailSignupResponse",n)})},t.$inject=["$rootScope","$http","$q","emailSignUpTrackingService"],t}(BaseAvonService);n.SubscribeService=t}(SubscribeServiceModule||(SubscribeServiceModule={}));app.service("subscribeService",SubscribeServiceModule.SubscribeService),function(n){var t=function(n){function t(i,r,u){n.call(this,i,r,u);this.$rootScope=i;this.$http=r;this.$q=u;t.rootScope=i}return __extends(t,n),t.prototype.ChangeOnlineStoreLanguage=function(){var n=AVON.LanguageCode==="es"?"en":"es";return this.PostJson("/myavon/api/changeonlinestorelanguage",{language:n},null,null,null,{JwtBearerToken:AVON.AuthenticationToken}).error(function(){t.rootScope.OpenDynamicModal("sessionTimeoutModal",null,t.rootScope)})},t.$inject=["$rootScope","$http","$q"],t}(BaseAvonService);n.NegotiateJwtService=t}(OnlineStoreModule||(OnlineStoreModule={}));app.service("negotiateJwtService",OnlineStoreModule.NegotiateJwtService),function(n){n[n.Backspace=8]="Backspace";n[n.Tab=9]="Tab";n[n.Enter=13]="Enter";n[n.Shift=16]="Shift";n[n.Ctrl=17]="Ctrl";n[n.Alt=18]="Alt";n[n.PauseBreak=19]="PauseBreak";n[n.CapsLock=20]="CapsLock";n[n.Escape=27]="Escape";n[n.Space=32]="Space";n[n.PageUp=33]="PageUp";n[n.PageDown=34]="PageDown";n[n.End=35]="End";n[n.Home=36]="Home";n[n.LeftArrow=37]="LeftArrow";n[n.UpArrow=38]="UpArrow";n[n.RightArrow=39]="RightArrow";n[n.DownArrow=40]="DownArrow";n[n.Insert=45]="Insert";n[n.Delete=46]="Delete";n[n.Zero=48]="Zero";n[n.ClosedParen=48]="ClosedParen";n[n.One=49]="One";n[n.ExclamationMark=49]="ExclamationMark";n[n.Two=50]="Two";n[n.AtSign=50]="AtSign";n[n.Three=51]="Three";n[n.PoundSign=51]="PoundSign";n[n.Hash=51]="Hash";n[n.Four=52]="Four";n[n.DollarSign=52]="DollarSign";n[n.Five=53]="Five";n[n.PercentSign=53]="PercentSign";n[n.Six=54]="Six";n[n.Caret=54]="Caret";n[n.Hat=54]="Hat";n[n.Seven=55]="Seven";n[n.Ampersand=55]="Ampersand";n[n.Eight=56]="Eight";n[n.Star=56]="Star";n[n.Asterik=56]="Asterik";n[n.Nine=57]="Nine";n[n.OpenParen=57]="OpenParen";n[n.A=65]="A";n[n.B=66]="B";n[n.C=67]="C";n[n.D=68]="D";n[n.E=69]="E";n[n.F=70]="F";n[n.G=71]="G";n[n.H=72]="H";n[n.I=73]="I";n[n.J=74]="J";n[n.K=75]="K";n[n.L=76]="L";n[n.M=77]="M";n[n.N=78]="N";n[n.O=79]="O";n[n.P=80]="P";n[n.Q=81]="Q";n[n.R=82]="R";n[n.S=83]="S";n[n.T=84]="T";n[n.U=85]="U";n[n.V=86]="V";n[n.W=87]="W";n[n.X=88]="X";n[n.Y=89]="Y";n[n.Z=90]="Z";n[n.LeftWindowKey=91]="LeftWindowKey";n[n.RightWindowKey=92]="RightWindowKey";n[n.SelectKey=93]="SelectKey";n[n.Numpad0=96]="Numpad0";n[n.Numpad1=97]="Numpad1";n[n.Numpad2=98]="Numpad2";n[n.Numpad3=99]="Numpad3";n[n.Numpad4=100]="Numpad4";n[n.Numpad5=101]="Numpad5";n[n.Numpad6=102]="Numpad6";n[n.Numpad7=103]="Numpad7";n[n.Numpad8=104]="Numpad8";n[n.Numpad9=105]="Numpad9";n[n.Multiply=106]="Multiply";n[n.Add=107]="Add";n[n.Subtract=109]="Subtract";n[n.DecimalPoint=110]="DecimalPoint";n[n.Divide=111]="Divide";n[n.F1=112]="F1";n[n.F2=113]="F2";n[n.F3=114]="F3";n[n.F4=115]="F4";n[n.F5=116]="F5";n[n.F6=117]="F6";n[n.F7=118]="F7";n[n.F8=119]="F8";n[n.F9=120]="F9";n[n.F10=121]="F10";n[n.F11=122]="F11";n[n.F12=123]="F12";n[n.NumLock=144]="NumLock";n[n.ScrollLock=145]="ScrollLock";n[n.SemiColon=186]="SemiColon";n[n.Equals=187]="Equals";n[n.Comma=188]="Comma";n[n.Dash=189]="Dash";n[n.Period=190]="Period";n[n.UnderScore=189]="UnderScore";n[n.PlusSign=187]="PlusSign";n[n.ForwardSlash=191]="ForwardSlash";n[n.Tilde=192]="Tilde";n[n.GraveAccent=192]="GraveAccent";n[n.OpenBracket=219]="OpenBracket";n[n.ClosedBracket=221]="ClosedBracket";n[n.Quote=222]="Quote"}(KeyCode||(KeyCode={})),function(n){var t=function(t){function i(r,u,f,e,o,s,h,c,l,a,v,y,p,w,b,k,d,g){function at(){window.YouTubePlayers&&$.each(window.YouTubePlayers,function(n,t){var i=t.getPlayerState();if(i&&i===1)try{this.pauseVideo()}catch(r){}})}function bt(){var n=$(".BannerItem");i.$html.hasClass("mac")&&i.$html.hasClass("safari")&&(n.css("display","none").height(),n.css("display","table-cell"))}function ht(t){nt.removeAttr("style").css({"background-color":n.AvonScope.BannerBackgroundColor,"min-height":n.AvonScope.BannerHeight-t>n.AvonScope.CollapsedBannerHeight?n.AvonScope.BannerHeight-t:n.AvonScope.CollapsedBannerHeight});t>nt.height()-t?(nt.addClass("CollapsedBanner"),n.AvonScope.DisplayCollapsedBannerOptions=!0,it.is(":visible")&&ot.hide(),et.removeAttr("style")):t>0?(nt.addClass("CollapsedBanner"),n.AvonScope.DisplayCollapsedBannerOptions=!0,it.removeAttr("style"),it.show().css({"margin-top":"-3px",top:n.AvonScope.BannerHeight/2-17}),n.AvonScope.ScrollPageTop=!1):(nt.removeClass(),n.AvonScope.DisplayCollapsedBannerOptions=!1)}function kt(){angular.element(".TopSearchContainer").removeClass("TopSearchResultsDisplayed");angular.element(".MainSearchContainer").hide().removeClass("MainSearchResultsDisplayed")}function ct(t){t<=0?(n.AvonScope.ScrollPageTop||(n.AvonScope.FullBannerSetup(),tt.removeClass("fixed-menu"),tt.removeAttr("style")),t>0&&(ht(t),tt.removeClass("fixed-menu"),tt.removeAttr("style")),bt()):t>0&&(tt.addClass("fixed-menu"),tt.removeAttr("style").css({"padding-top":angular.element(".fixed-top-banner").outerHeight()-10+"px"}))}function dt(t){t>=n.AvonScope.BannerHeight-20&&!n.AvonScope.ScrollDown?(n.AvonScope.CollapsedBannerSetup(),ct(t)):t<n.AvonScope.BannerHeight&&t>0&&ht(t)}function gt(){var i=_.include(["iPhone","iPad","iPod"],navigator.platform),t;return i?window.matchMedia("(display-mode: standalone)").matches||window.navigator.standalone===!0?!1:n.AvonScope.Session.Customer.IsA2HSBannerIOSDismissed?!1:(!n.AvonScope.Session.Customer.DidA2HSBannerIOSShow&&n.AvonScope.IsConfirmationPage()&&(t=n.AvonScope.SessionService.PostJson("/api/session/setAddToHomeScreenIOSBannerIOSShown",null),t.success(function(t){t.Data.didA2HSBannerIOSShow&&(n.AvonScope.Session.Customer.DidA2HSBannerIOSShow=!0)})),!0):!1}var rt=this,ut,lt,st,ft;t.call(this,r,null);this.$rootScope=r;this.sessionService=o;this.urlService=c;this.modalService=a;this.$window=v;this.fundraiserService=p;this.historyService=w;this.repQueryStringParameterService=d;this.openBrightCoveModalforContent=function(t,i,r,u,f){var o,s,h;u===void 0&&(u=!0);var c=n.AvonScope.IsMobile?345:950,l=n.AvonScope.IsMobile?185:534,e=n.AvonScope.BrightCoveUrl;e=f?e.replace("{PlayerId}",f):e.replace("{PlayerId}",n.AvonScope.BrightCoveDefaultPlayerId);e=e+t;u&&(e=e+"&autoplay=true");o=c;s=l;n.AvonScope.Session.Rep!=null&&(e=e+"&repid="+n.AvonScope.Session.Rep.Id);h={AllowExit:!0,Model:null,KeepLoaded:!1,UrlToLoad:e,UseIFrame:!0,IFrameWidth:o+"px",IFrameHeight:s+"px"};n.AvonScope.OpenDynamicModal("VideoModal",h)};this.loaderModalInitialization=function(){_.defer(function(){n.AvonScope.ModalBackground=$("#ModalBackground");n.AvonScope.LoaderElement=$("#Loader");n.AvonScope.MinimumTimeToDisplayModalInSeconds=1;n.AvonScope.IsMobile})};n.AvonScope=r;n.AvonScope.Redirecting=!1;n.AvonScope.bagService=u;n.AvonScope.LoginService=l;n.AvonScope.ModalService=a;n.AvonScope.$sce=e;n.AvonScope.campaign=AVON.campaign;n.AvonScope.campaignYear=AVON.campaignYear;n.AvonScope.campaignNumber=AVON.campaignNumber;n.AvonScope.messages=AVON.messages;n.AvonScope.ClientConfiguration=AVON.ClientConfiguration;n.AvonScope.cdn=s;n.AvonScope.SessionService=o;n.AvonScope.compileService=h;n.AvonScope.isPageComplete=!1;n.AvonScope.Url=c;n.AvonScope.IsPhantom=navigator.userAgent.match(/phantom/gi)!=null;n.AvonScope.PageTotalMinutes=0;n.AvonScope.PageIdleMinutes=0;n.AvonScope.SessionMinutes=0;n.AvonScope.YouTubeUrl="https://www.youtube.com/embed/";n.AvonScope.BrightCoveUrl="https://players.brightcove.net/5400155206001/{PlayerId}_default/index.html?videoId=";n.AvonScope.BrightCoveDefaultPlayerId="ByjMAo4Zb";n.AvonScope.LoadOperationsCount=0;n.AvonScope.LeftNavigationSelectedLink=-1;n.AvonScope.LeftNavigationPinkLink=-1;n.AvonScope.LeftNavigationSelectedLinkParent=-1;n.AvonScope.LeftNavigationSelectedFacets=[];n.AvonScope.LeftNavigationSelectedDepartmentFacets=[];n.AvonScope.FacetQueryStringParamName="facets";n.AvonScope.RatingsQueryStringParamName="ratings";n.AvonScope.PriceQueryStringParamName="price";n.AvonScope.DiscountQueryStringParamName="discount";n.AvonScope.SortByQueryStringParamName="sortby";n.AvonScope.viewportWidth=$(window).width();n.AvonScope.viewportHeight=$(window).height();n.AvonScope.isPortrait=!1;n.AvonScope.IsOnlineStoreOnEditMode=!1;n.AvonScope.ShowLpmEditModuleButtons={Show:!1};n.AvonScope.PaymentType=PaymentType;n.AvonScope.AjaxError=AjaxError;n.AvonScope.CanBuy=CanBuy;n.AvonScope.CreditCardDisplayMode=CreditCardDisplayMode;n.AvonScope.CreditCardType=CreditCardType;n.AvonScope.DeliveryType=DeliveryType;n.AvonScope.EmailSubscriptionSource=EmailSubscriptionSource;n.AvonScope.FindARepSearchType=FindARepSearchType;n.AvonScope.ImageType=ImageType;n.AvonScope.InterestType=InterestType;n.AvonScope.Month=Month;n.AvonScope.OrderStatus=OrderStatus;n.AvonScope.OrderType=OrderType;n.AvonScope.PaymentType=PaymentType;n.AvonScope.ShippingOptionCode=ShippingOptionCode;n.AvonScope.PromoConditionalRuleReason=PromoConditionalRuleReason;n.AvonScope.VariantType=VariantType;k.TrackFontsUsage();r.LoadedProducts={};ut=0;lt=!1;$(document).ajaxSend(function(){ut++});st=$('meta[name="viewport"]').attr("content");navigator.userAgent.match("CriOS")&&$('meta[name="viewport"]').attr("content",st+",initial-scale=1.0");$(document).ajaxComplete(function(){ut>0&&(ut--,ut==0&&n.AvonScope.$broadcast("AvonController.AjaxCallsFinished"))});navigator.userAgent.search("Safari")>=0&&navigator.userAgent.search("Chrome")<0&&$(window).bind("pageshow",function(n){n.originalEvent.persisted&&window.location.reload()});n.AvonScope.appendRepIdToPassedUrl=function(t){return n.AvonScope.Session.Rep!=null?e.trustAsResourceUrl(t+n.AvonScope.Session.Rep.Id):e.trustAsResourceUrl(t)};n.AvonScope.FormatZip=function(n){return b("formatzipcode")(n,!1)};n.AvonScope.SkipToContent=function(n,t){n.preventDefault();var i=angular.element($("#"+t));i.attr("tabindex","-1");i.focus()};n.AvonScope.QueryString=function(n){for(var t,r=window.location.search.substr(1).split("&"),u=[],i=0;i<r.length;++i)(t=r[i].split("="),t.length===2)&&(t[0]=n?t[0].toLowerCase():t[0],u[t[0]]=decodeURIComponent(t[1].replace(/\+/g," ")));return u};AVON.SessionModel?n.AvonScope.SessionService.UpdateModel(AVON.SessionModel):n.AvonScope.SessionService.Initialize();n.AvonScope.SetClientLanguage=function(t){t=="es"?(AVON.messages=new SpanishMessages,n.AvonScope.LanguageCode="es",AVON.LanguageCode="es"):(AVON.messages=new EnglishMessages,n.AvonScope.LanguageCode="en",AVON.LanguageCode="en")};i.$html.hasClass("LangES")?n.AvonScope.SetClientLanguage("es"):n.AvonScope.SetClientLanguage("en");document.addEventListener("keydown",function(n){var r=n.which||n.keyCode,t;r===KeyCode.Tab?(i.$html.removeClass("mouseFocusStyles").addClass("keyboardFocusStyles"),$(".topMenu:first-child").find(".miniMenuList").removeClass("MenuBoxShadowActive")):r===KeyCode.Escape&&(t=angular.element($(".ModalContainer.Shown>*[modal]")),t.length&&t.attr("modal").toLowerCase().indexOf("allowexit: false")===-1&&t.trigger("close"))});document.addEventListener("click",function(){i.$html.removeClass("keyboardFocusStyles").addClass("mouseFocusStyles")});document.addEventListener("mouseover",function(){i.$html.removeClass("keyboardFocusStyles").addClass("mouseFocusStyles")});n.AvonScope.YouTubeiFrameSrc=function(t){return e.trustAsResourceUrl(n.AvonScope.YouTubeUrl+t+"rel=0&showinfo=1&wmode=transparent&enablejsapi=1")};n.AvonScope.YouTubeVideoIdFromUrl=function(n){if(n){var t=n.match(/^.*(youtu.be\/|v\/|u\/\w\/|embed\/|watch\?v=|\&v=|\?v=)([^#\&\?]*).*/);if(t&&t[2].length===11)return t[2]}return""};n.AvonScope.ValidateYouTubeUrl=function(n){if(n)if(n.match(/^(?:https?:\/\/)?(?:m\.|www\.)?(?:youtu\.be\/|youtube\.com\/(?:embed\/|v\/|watch\?v=|watch\?.+&v=))((\w|-){11})(?:\S+)?$/))return!0;return!1};n.AvonScope.ImageThumb=function(n){return n.substring(0,n.lastIndexOf("."))+"_thumb."+n.substring(n.lastIndexOf(".")+1,n.length)};n.AvonScope.OpenVideoModal=function(n,t,i,r,u){at();var o=$("#MainContent").innerWidth(),f=Math.min(o,1200)-160,e=f*.5625;i===VideoType.Youtube?rt.openYouTubeModal(n,f,e,t):i===VideoType.BrightCove&&rt.openBrightCoveModalforContent(n,f,e,u,r)};n.AvonScope.OpenChatBotModal=function(){var t=window.innerHeight-100,i={AllowExit:!0,Model:null,KeepLoaded:!0,UrlToLoad:"https://avon-bot.azurewebsites.net/webclient/",UseIFrame:!0,IFrameWidth:"350px",IFrameHeight:t+"px",IgnoreBackground:!0};n.AvonScope.OpenDynamicModal("ChatBotModal",i)};n.AvonScope.OpenFindARepModal=function(t,i,r){t===void 0&&(t=1);i===void 0&&(i=!0);r===void 0&&(r="");event.preventDefault();event.stopPropagation();n.AvonScope.ShowLoading(AVON.messages.spinner_loading);a.CloseModal();var u={UrlToLoad:"/api/findarep/FindARepModal",AllowExit:!0,KeepLoaded:!1,IgnoreBackground:!0,Model:{findARepModal:{FindARepByNameModel:{FirstName:null,LastName:null,State:null},FindARepByAddressModel:{Address:null,State:null,ZipCode:null},FindARepResults:null,ReturnUrl:null,Mode:null,ContactOptions:null},display:t,reload:i,productUrl:r},CssClass:"full-size-modal-dialog"};n.AvonScope.OpenDynamicModal("FindARepModal",u,null);n.AvonScope.IsCheckoutPage()&&f.TrackEvent({event_name:"find rep button",event_category:"find a rep checkout",event_action:"click",event_label:"find rep button",find_a_rep_search_type:"modal name"})};n.AvonScope.OpenDynamicModal=function(t,i,r){var u,f;$("#Modals #"+t).length==0&&(u=n.AvonScope,r&&(u=r),f=$("<div>",{id:t,modal:"{}"}),$("#Modals.BodyContentModal").append(f),h($("#"+t))(u));_.defer(function(){$("#"+t).trigger("modal",i)})};n.AvonScope.SessionService.WhenReady().then(function(t){n.AvonScope.a2HSBannerForIOS={canShow:gt()};r.ShowLpmEditModuleButtons.Show=t.ShowEditLpmModuleButtons;_.defer(function(){n.AvonScope.FixedTopBannerContainerHeight={height:angular.element(".fixed-top-banner").outerHeight()}},250)});n.AvonScope.$on("ModalShown",function(t,i){i==="QuickView"&&(n.AvonScope.IsQuickShopModalOpen=!0);i==="FindARepModal"&&f.TrackEvent({event_name:"populated",event_category:r.IsCheckoutPage()?"find a rep checkout":"find a rep pricing",event_action:"modal",event_label:"populated",find_a_rep_search_type:r.IsCheckoutPage()?"modal name":"modal zip code"});_.delay(function(){n.AvonScope.UpdateInlineWaterMark()},250)});n.AvonScope.$on("ModalClosed",function(t,i){i==="QuickView"&&(n.AvonScope.IsQuickShopModalOpen=!1);i==="FindARepModal"&&(n.AvonScope.IsMobile!=undefined&&n.AvonScope.IsMobile==!0&&n.AvonScope.UnlockScroll(!0),f.TrackEvent({event_name:"closed",event_category:r.IsCheckoutPage()?"find a rep checkout":"find a rep pricing",event_action:"modal",event_label:"closed"}));v.LoginModalDisplayed&&(v.LoginModalDisplayed=!1);$("#QuickView.AddedToBag").removeClass("AddedToBag")});n.AvonScope.passwordRegularExpression=/(?!^[0-9]*$)(?!^[a-zA-Z]*$)^([a-zA-Z0-9]{6,18})/;n.AvonScope.positiveIntegerRegularExpression=/^[1-9]\d*$/;n.AvonScope.IsAutoReplenishmentInCart=function(){var t=!1;return $.each(n.AvonScope.Session.Cart.Campaigns,function(n,i){$.each(i.Items,function(n,i){i.AutoReplenishmentFrequency>0&&(i.ProductCanBuy===CanBuy.Available&&i.DualPurchaseSelected===DualPurchase.AutoReplenishment||i.ProductCanBuy===CanBuy.AutoReplenishmentOnly)&&(t=!0)})}),t};r.ShowLoading=function(n,t){var u,i;n===void 0&&(n=AVON.messages.spinner_loading);t===void 0&&(t=!1);u=2;r.isLoading=!0;i=function(){r.loadingMessage=n;r.SafeApply();$("body").addClass("ShowLoading");$("#Loading #LoadingMessage").html("")};n!==AVON.messages.spinner_loading||t?i():setTimeout(function(){r.isLoading&&i()},u*1e3)};n.AvonScope.$on("HideLoading",function(){n.AvonScope.isLoading=!1;n.AvonScope.SafeApply();$("body").removeClass("ShowLoading")});n.AvonScope.$on("Redirect",function(t,i){n.AvonScope.Redirecting=!0;_.defer(function(){AVON.common.redirectTo(i)})});n.AvonScope.$on("BaseService.AjaxComplete",function(t,i){i&&(i.SessionModel?n.AvonScope.SessionService.UpdateModel(i.SessionModel):i.SessionHashes&&n.AvonScope.SessionService.UpdateIfOld(i.SessionHashes),(i.RedirectUrl==null||i.RedirectUrl=="")&&(i.HideLoading&&n.AvonScope.isLoading&&_.delay(function(){n.AvonScope.$broadcast("HideLoading")},50),_.defer(function(){return app.safeLoadImages($("body"))})))});n.AvonScope.ShowContactRepModal=function(t,i){var r,u;n.AvonScope.ShowLoading(AVON.messages.spinner_loading);AVON.ContactMeFormModel||(AVON.ContactMeFormModel={RepUrl:"",FirstName:"",LastName:"",EmailAddress:"",Phone:"",PhoneDay:"",PhoneEvening:"",Subject:"",Message:""});r="";t&&t>0&&(r+="?repId="+t);i&&(AVON.ContactMeFormModel.Subject=i,r+=r.length>0?"&":"?",r+="subject="+i);u={AllowExit:!0,Model:null,KeepLoaded:!1,UrlToLoad:"/contact/contactmeform"+r};n.AvonScope.OpenDynamicModal("ContactMeRepModal",u)};n.AvonScope.numberRange=function(n,t){return _.range(n,t+1)};n.AvonScope.$on("AvonController.ShowRepresentativeContactMeForm",function(t,i,r){n.AvonScope.ShowContactRepModal(i,r)});n.AvonScope.checkBoxKeyPress=function(n){var t=$(n.target).find("input");n.which===32?t.length>0&&(n.preventDefault(),t.attr("type")==="checkbox"&&_.defer(function(){t.trigger("click")})):n.which===13&&t.length>0&&(n.preventDefault(),_.defer(function(){t.parents("form").find(".HiddenSubmit").click()}))};n.AvonScope.ieSubmitKeyPress=function(n){var t=$(n.target);n.which===13&&$(".ie").length>0&&t.length>0&&(n.preventDefault(),_.defer(function(){t.parents("form").find(".HiddenSubmit").click()}))};n.AvonScope.LockScroll=function(n){n===void 0&&(n=!1);var t=window.scrollY;i.$body.css({overflow:"hidden"});document.body.scrollTop=0;document.documentElement.scrollTop=0;n&&(document.body.style.top="-"+t+"px")};n.AvonScope.UnlockScroll=function(n){n===void 0&&(n=!1);var t=document.body.style.top;i.$body.css({height:"",overflow:"",position:"",top:""});n&&window.scrollTo(0,parseInt(t||"0")*-1+80)};n.AvonScope.ProcessDigitalCatalogLogOut=function(){if(parseInt(n.AvonScope.QueryString().dodclogout)===1){var t=window.document.createElement("iframe");t.style.display="none";window.document.body.appendChild(t);t.src=AVON.digitalCatalogLogOutUrl;rt.historyService.ReplaceStateUrl(c.RemoveQueryStringParameterFromUrl(location.href,"dodclogout"))}};_.defer(function(){n.AvonScope.ProcessDigitalCatalogLogOut();var t=app.GetQuerystringParameterByName("videoId"),i=parseInt(app.GetQuerystringParameterByName("videoType")),r=parseInt(app.GetQuerystringParameterByName("start"));t.length>0&&n.AvonScope.OpenVideoModal(t,r,i||0,null,!1)});n.AvonScope.$on("Do.ResetPageIdleTime",function(){n.AvonScope.PageIdleMinutes=0});n.AvonScope.ExpandTooltipInfo=!1;n.AvonScope.CloseTooltipInfo=function(){n.AvonScope.ExpandTooltipInfo=!1};n.AvonScope.OpenTooltipInfo=function(){n.AvonScope.ExpandTooltipInfo=!0;n.AvonScope.ScrollIntoView($(".InfoPanel"))};n.AvonScope.ToggleTooltipInfo=function(){n.AvonScope.ExpandTooltipInfo?n.AvonScope.CloseTooltipInfo():n.AvonScope.OpenTooltipInfo()};var nt=$("#BannerSection"),it=$("#CollapsedBannerOptions"),vt=$("#TopUtilityBarContainer"),tt=$("#TopNavigationContainer"),et=$(".BannerItem"),ot=$("#HeadLogoSection .search-container-inner"),yt=$(".BannerItemLine"),pt=$("#BannerPageWidth"),wt=AVON.IsTabletDevice||n.AvonScope.IsMobile;n.AvonScope.BannerHeight=isNaN(parseFloat(nt.data("height")))?0:parseFloat(nt.data("height"));n.AvonScope.CollapsedBannerHeight=parseFloat(nt.data("collapsedheight"));n.AvonScope.BannerBackgroundColor=nt.data("backgroundcolor");n.AvonScope.DisplayCollapsedBannerOptions=!1;n.AvonScope.FullBannerSetup=function(){n.AvonScope.ScrollPageTop||(nt.removeAttr("style").removeClass().css({height:n.AvonScope.BannerHeight,"background-color":n.AvonScope.BannerBackgroundColor}),it.hide(),n.AvonScope.DisplayCollapsedBannerOptions=!1,ot.show(),et.removeAttr("style"),n.AvonScope.ScrollPageTop=!0,n.AvonScope.ScrollDown=!1)};n.AvonScope.CollapsedBannerSetup=function(){if(!n.AvonScope.ScrollDown){nt.removeAttr("style").removeClass().addClass("CollapsedBanner").css({"min-height":n.AvonScope.CollapsedBannerHeight,"background-color":n.AvonScope.BannerBackgroundColor});et.removeAttr("style");it.removeAttr("style");it.show().css({"margin-top":"-3px",top:n.AvonScope.BannerHeight/2-17});n.AvonScope.IsIPad===!1&&ot.hide();var t=$("#BannerSearchContainer .search-container-inner .custom-popup-wrapper");t.removeAttr("style");t.show().css({top:n.AvonScope.BannerHeight-(n.AvonScope.BannerHeight/2-17)-3});n.AvonScope.DisplayCollapsedBannerOptions=!0;n.AvonScope.ScrollPageTop=!1;n.AvonScope.ScrollDown=!0}};n.AvonScope.BannerHeight===0?(vt.css("top","0"),tt.css("margin-top","6px"),nt.hide()):(yt.css("height",n.AvonScope.BannerHeight/2),pt.css("height",n.AvonScope.BannerHeight),ft=0,v.onscroll=wt?function(){var n=_.debounce(function(){var n=v.pageYOffset||document.documentElement.scrollTop;n>0?nt.hide():nt.show();ft=n},1e3,!0);n()}:function(){var n=_.debounce(function(){var n=v.pageYOffset||document.documentElement.scrollTop;kt();n>ft?dt(n):ct(n);ft=n},1e3,!0);n()});n.AvonScope.CenterModal=function(t){var r=$("#"+t).parent(),h=$(document).height(),e=r.height(),u=r.width(),f=$(window).scrollTop(),o=f,s=h-e,i;r.css("margin-left","-"+u+"px");u=r.width();i=f+n.AvonScope.viewportHeight*.1;e>n.AvonScope.viewportHeight&&(i=f+5);i<o?i=o:i>s&&(i=s);r.css("top",i+"px");r.css("margin-left","-"+u/2+"px")};n.AvonScope.UpdateCustomerType=function(t){n.AvonScope.SessionService.PostJson("/api/session/updatecustomertype",{customerType:t});n.AvonScope.Session.Customer.CustomerType=t};n.AvonScope.GetMaxHeight=function(n){var t=$(n).map(function(){var n=$(this).height();if(n>0)return n});return Math.max.apply(null,t)};n.AvonScope.ViewPrivacyPolicyUrl=function(t){n.AvonScope.IsMobile?n.AvonScope.RedirectToUrl(t):window.open(t,"AVONPop","toolbar=no,width=640,height=550,status=no,scrollbars=yes,resize=yes,menubar=no").focus()};n.AvonScope.ViewUrlInNewWindow=function(n){window.open(n,"_blank")};n.AvonScope.ViewConditionsOfUseUrl=function(t){n.AvonScope.IsMobile?n.AvonScope.RedirectToUrl(t):window.open(t,"AVONPop","toolbar=no,width=640,height=550,status=no,scrollbars=yes,resize=yes,menubar=no").focus()};n.AvonScope.InitSizeAndOrientation=function(){var t=n.AvonScope.GetDevicePixelDensity();t>=2?i.$html.addClass("HighDensity"):t>=1.5?i.$html.addClass("MedDensity"):i.$html.addClass("LowDensity");n.AvonScope.AdjustSize();window.addEventListener("orientationchange",function(){n.AvonScope.OnPhoneOrientationChange()})};n.AvonScope.trackPwaAddToHomeScreen=function(){window.addEventListener("beforeinstallprompt",function(t){t.preventDefault();AVON.AddToHomeScreenBannerPromptEvent=t;(n.AvonScope.IsHomePage()||n.AvonScope.IsConfirmationPage())&&(_.isUndefined(AVON.AddToHomeScreenBannerPromptEvent)||AVON.AddToHomeScreenBannerPromptEvent.prompt());AVON.AddToHomeScreenBannerPromptEvent.userChoice.then(function(n){var t={event_name:"pwa_add_to_homescreen",event_category:"PWA",event_action:""+n.outcome,event_label:"add to home screen"};f.TrackEvent(t);AVON.AddToHomeScreenBannerPromptEvent=null})});window.addEventListener("appinstalled",function(){f.TrackEvent({event_name:"pwa_installed_to_homescreen",event_category:"PWA",event_action:"installation",event_label:"installed to home screen"})})};n.AvonScope.dismissA2HSBannerForIOS=function(){var t=n.AvonScope.SessionService.PostJson("/api/session/dismissAddToHomeScreenIOSBanner",null);t.success(function(t){t.Data.isA2HSBannerIOSDismissed&&(n.AvonScope.Session.Customer.IsA2HSBannerIOSDismissed=!0,n.AvonScope.a2HSBannerForIOS={canShow:!1})})};n.AvonScope.GetDevicePixelDensity=function(){var n=1;return window.devicePixelRatio!==undefined&&(n=window.devicePixelRatio),n};n.AvonScope.AdjustSize=function(){var t=Math.min(n.AvonScope.viewportWidth,n.AvonScope.viewportHeight),r=(t/100*3).toFixed(2);i.$html.css("font-size",r+"px");n.AvonScope.viewportHeight>n.AvonScope.viewportWidth&&(n.AvonScope.isPortrait=!0);n.AvonScope.IsAndroid&&(n.AvonScope.isPortrait=screen.availHeight>screen.availWidth?!0:!1);n.AvonScope.isPortrait?(i.$html.addClass("Portrait"),i.$html.removeClass("Landscape")):(i.$html.addClass("Landscape"),i.$html.removeClass("Portrait"))};n.AvonScope.OnPhoneOrientationChange=function(){n.AvonScope.AdjustSize();n.AvonScope.$broadcast("AvonController.OrientationChange")};n.AvonScope.ModalCalled=!1;n.AvonScope.ShowImage=function(n,t){var i=$(n.currentTarget);i.prop("src",s.mediaImage(t))};n.AvonScope.IsScrolledIntoView=function(t){if(t.length>0){var i=$(window).scrollTop(),u=i+n.AvonScope.viewportHeight,r=t.offset().top,f=r+t.height();return f<=u&&r>=i}return!1};n.AvonScope.GetChangeLanguageUrl=function(){var u=AVON.languageId==Language.Spanish?"/":"/es",t=window.location.toString().replace(/^.*\/\/[^\/]+/,""),i,r;return t=t.replace(/^((\/)?(e[sn]|[1|2])(\/|(?=\?)))|^((\/)?(e[sn]|[1|2])\/?)$/,"/"),t=t.replace("^/e./","/"),t=u+t,t=t.replace("//","/").replace("&&","&"),i=app.GetQuerystringParameterByName("videoId"),i&&(t=n.AvonScope.Url.RemoveQueryStringParameterFromUrl(t,"videoId")),r=parseInt(app.GetQuerystringParameterByName("videoType")),r&&(t=n.AvonScope.Url.RemoveQueryStringParameterFromUrl(t,"videoType")),t};n.AvonScope.ChangeOnlineStoreLanguage=function(){y.ChangeOnlineStoreLanguage()};n.AvonScope.UpdateQuantityField=function(n,t,i,r){r===void 0&&(r=!1);n.preventDefault();var u=parseInt(i+"",10)||0;return t===QuantityFieldAction.Increment?u<99&&(u+=1):(u>0&&(u-=1),(u<0||u===0&&!r)&&(u=1)),u};n.AvonScope.FormatDate=function(t,i){return t=n.AvonScope.GetDate(t),b("date")(t,i)};n.AvonScope.FormatDateMMddyyyy=function(t){return n.AvonScope.FormatDate(t,"MM/dd/yyyy")};n.AvonScope.GetDate=function(n){var i,t;return typeof n=="string"?(t=/\/Date\((\d+)\)\//.exec(n),i=t&&t[1]?new Date(+t[1]):new Date(n)):i=n instanceof Date?new Date(n.getTime()):null,i};n.AvonScope.DigitalCatalogUrlFromQuerystring=this.urlService.GetQueryStringParameterValue(window.location.href,"dc_url")?this.urlService.GetQueryStringParameterValue(window.location.href,"dc_url"):null;n.AvonScope.GoBackToDigitalCatalog=function(t){n.AvonScope.RedirectToUrl(n.AvonScope.Url.Action("Index","DigitalCatalog")+"?dc_url="+encodeURIComponent(t))};n.AvonScope.SelectedDigitalCatalogFromQuerystring=this.urlService.GetQueryStringParameterValue(window.location.href,"dc_ref")&&document.referrer!==null&&document.referrer.indexOf("/digitalcatalog")>=0?this.urlService.GetQueryStringParameterValue(window.location.href,"dc_ref"):null;this.loaderModalInitialization();n.AvonScope.LoaderModal=function(t){rt.startLoaderModal(t);n.AvonScope.LoaderElement.trigger("modal")};n.AvonScope.CompleteLoaderModal=function(n){rt.completeLoaderModal(n)};r.SalePriceClicked=function(n,t){t===void 0&&(t="");f.TrackEvent({event_name:"pricing link",event_category:"find a rep pricing",event_action:"pricing link",event_label:"sale price"});r.OpenFindARepModal(1,!0,t)};r.ShowAttachedOnlyPromotionText=function(n){return n.CustomerType=="A"&&!r.isCustomerAttachedOrCookiedToRep()};r.AttachedOnlyPromotionClicked=function(){f.TrackEvent({event_name:"pricing link",event_category:"find a rep pricing",event_action:"pricing link",event_label:"promotion"});r.OpenFindARepModal()};r.ShowAttachedOnlyProductMessage=function(n){return n.AttachedOnlyProduct&&!r.isCustomerAttachedOrCookiedToRep()};r.FindRepresentativeClicked=function(n){n===void 0&&(n=!0);f.TrackEvent({event_name:"pricing link",event_category:"find a rep pricing",event_action:"pricing link",event_label:"product restriction"});r.OpenFindARepModal(1,n)};r.OpenFindARepFromLPM=function(){f.TrackEvent({event_name:"pricing link",event_category:"find a rep pricing",event_action:"pricing link",event_label:"LPM module"});r.OpenFindARepModal()};r.BackgroundOverlayClicked=function(){r.$broadcast("MobileMenuController.CloseMenu")};r.LeftMenuCloseButtonClicked=function(){r.$broadcast("MobileMenuController.CloseMenu")};r.ShowLpmEditButton=function(){var n=r.IsMobile&&window.navigator.platform!=="Win32"&&window.navigator.platform!=="Macintosh";return r.ShowLpmEditModuleButtons.Show&&!n};r.AutoDetectCreditCardType=function(n){return g.GetCreditCardType(n)};r.GetCreditCardMaxLength=function(n){return g.GetCreditCardMaxLength(n)};this.initPage(f);this.repQueryStringParameterService.Initialize()}return __extends(i,t),i.prototype.initPage=function(t){_.defer(function(){app.safeLoadImages($("body"))});$(function(){if(n.AvonScope.IsMobile=$("body").hasClass("Mobile"),n.AvonScope.IsMobile){$(document).on("focus","input",function(n){if($(n.currentTarget).prop("id")!="HeaderSearchInput"){if($(".CheckoutContainer").length){$(".CheckoutContainer").css("position","absolute");var t=-$(".CheckoutContainer").height()+$("#RepHeader").height();$(".CheckoutContainer").css("bottom",t)}$("html").hasClass("iphone")&&$("#FixedMenu").css("position","absolute")}}).on("blur","input",function(){$(".CheckoutContainer").length&&($(".CheckoutContainer").css("bottom",0),$(".CheckoutContainer").css("position","fixed"));$("html").hasClass("iphone")&&$("#FixedMenu").css("position","fixed")});if(n.AvonScope.IsSafariBrowser){var i=new RegExp("Version/.([.0-9]{1,})"),r=!!i.test(navigator.userAgent),t=0;r&&(document.documentElement.addEventListener("touchstart",function(n){n.touches.length>1&&n.preventDefault()},!1),document.documentElement.addEventListener("touchend",function(n){var i=(new Date).getTime();i-t<=300&&n.preventDefault();t=i},!1))}}if(typeof AVON.ShowOverlay=="string"&&AVON.ShowOverlay.length>0&&$("#"+AVON.ShowOverlay).trigger("modal"),n.AvonScope.IsMobile){n.AvonScope.InitSizeAndOrientation();n.AvonScope.trackPwaAddToHomeScreen();$(window).on("resize",function(){if(n.AvonScope.isPortrait){var t=!1;$(window).height()>n.AvonScope.viewportHeight&&(n.AvonScope.viewportHeight=$(window).height());$(window).width()!==n.AvonScope.viewportWidth&&(n.AvonScope.viewportWidth=$(window).width(),t=!0);t&&n.AvonScope.AdjustSize()}});$("body").on("change","select",function(){$(this).blur()})}$("header").height($("#FixedMenu").height())});this.initTracking(t);_.delay(function(){n.AvonScope.isPageComplete=!0;n.AvonScope.$broadcast("AvonController.PageCompete")},2e3);_.delay(function(){$("header").height($("#FixedMenu").height())},1e3);setInterval(function(){n.AvonScope.PageTotalMinutes+=1;n.AvonScope.PageIdleMinutes+=1;n.AvonScope.SessionMinutes+=1;var t;n.AvonScope.Session.Customer.IsLoggedIn&&(t=n.AvonScope.ClientConfiguration.PageTimeout.PageTimeoutMinutes-n.AvonScope.ClientConfiguration.PageTimeout.WarningMinutes);(n.AvonScope.Session.Customer.CustomerType===CustomerType.GuestShopper||n.AvonScope.Session.Customer.CustomerType===CustomerType.RegisteredCustomerAsGuest)&&(t=n.AvonScope.ClientConfiguration.PageTimeout.GuestTimeoutMinutes-n.AvonScope.ClientConfiguration.PageTimeout.WarningMinutes);window.location.toString().indexOf("/checkout")>-1&&(t=n.AvonScope.ClientConfiguration.PageTimeout.PaymentTimeoutMinutes-n.AvonScope.ClientConfiguration.PageTimeout.WarningMinutes);t!==undefined&&n.AvonScope.PageIdleMinutes==t&&($("#PageTimeoutWarningModal:visible").length!=0||n.AvonScope.Redirecting||n.AvonScope.ModalService.ShowModalUrl("/api/home/pagetimeoutwarningmodal",!1));n.AvonScope.SafeApply()},6e4);this.openFindARepModalIfQueryStringParameter();this.handleFundraiserBrowserHistoryState()},i.prototype.openFindARepModalIfQueryStringParameter=function(){var n=this.urlService.GetQueryStringParameterValue(window.location.href,"showFindARepModal");n=="1"&&this.$rootScope.OpenFindARepModal()},i.prototype.initTracking=function(n){var t=this;_.defer(function(){t.initTrackingItem(AVON.trackingTop);t.initTrackingItem(AVON.trackingBottom);$(".VideoThumbnailLink, span.play").click(function(){var i=document.createElement("div"),t,r;i.innerHTML=$(this).is(".VideoThumbnailLink")?$(this).html():$(this).parent().html();t=i.getElementsByTagName("img")[0];r=t?t.getAttribute("alt"):"";n.TrackVideoClickEvent(r)})})},i.prototype.initTrackingItem=function(n){n!=null&&(n.PageMarkup!=null&&$("body").append(n.PageMarkup),_.each(n.JavascriptFiles,function(n){var t=n;t=t.replace("~/","/");$.getScript(t)}),n.InlineJavascript!=null&&$("body").append("<script>"+n.InlineJavascript+"<\/script"))},i.prototype.openYouTubeModal=function(t,i,r,u){var f=u||0,e=n.AvonScope.YouTubeUrl+t+"?enablejsapi=1&start="+f+"&rel=0&wmode=transparent&autoplay=1",o={AllowExit:!0,Model:null,KeepLoaded:!1,UrlToLoad:e,UseIFrame:!0,IFrameWidth:i+"px",IFrameHeight:r+"px"};n.AvonScope.OpenDynamicModal("VideoModal",o)},i.prototype.handleFundraiserBrowserHistoryState=function(){var n=this,t="FundraiserState";this.sessionService.WhenReady().then(function(){var r,i;n.$rootScope.Session.Fundraiser?(r={FundraiserVanityName:n.$rootScope.Session.Fundraiser.VanityName},n.historyService.ReplaceState(t,r)):(i=n.historyService.GetStateData(t),i&&i.FundraiserVanityName&&n.fundraiserService.StartShoppingFundraiser(i.FundraiserVanityName))})},i.prototype.startLoaderModal=function(t){n.AvonScope.$on("ModalShown",function(i,r){r==="Loader"&&(setTimeout(function(){n.AvonScope.HasAddingToBagSpinnerTimerCompleted=!0},n.AvonScope.MinimumTimeToDisplayModalInSeconds*1e3),n.AvonScope.LoaderElement.parent().addClass("LoaderComplete"),n.AvonScope.LoaderElement.find(".Message").html(t),n.AvonScope.IsQuickShopModalOpen||n.AvonScope.IsModalDisplayed||n.AvonScope.ModalBackground.addClass("Transparent"))});n.AvonScope.HasAddingToBagSpinnerTimerCompleted=!1},i.prototype.completeLoaderModal=function(t){var i=setInterval(function(){if(n.AvonScope.HasAddingToBagSpinnerTimerCompleted){var u=$(".ModalContainer"),r=$(".CircleSpinner");r.addClass("LoadComplete");n.AvonScope.LoaderElement.find(".Message").html(t);setTimeout(function(){n.AvonScope.LoaderElement.trigger("close");n.AvonScope.LoaderElement.find(".Message").html(AVON.messages.spinner_addingTextOnly);u.removeClass("LoaderComplete");n.AvonScope.ModalBackground.removeClass("Transparent");r.removeClass("LoadComplete");n.AvonScope.HasAddingToBagSpinnerTimerCompleted=!1;n.AvonScope.IsModalDisplayed=!1;n.AvonScope.SetupModalBackgroundClick()},n.AvonScope.MinimumTimeToDisplayModalInSeconds*1e3);clearInterval(i)}},250)},i.$inject=["$rootScope","bagService","trackingService","$sce","sessionService","cdnService","$compile","urlService","loginService","modalService","$window","negotiateJwtService","fundraiserService","historyService","$filter","fontTrackingService","repQueryStringParameterService","creditCardService"],i.$html=$("html"),i.$body=$("body"),i}(BaseAngularController);n.AvonController=t}(AvonModule||(AvonModule={}));app.controller("AvonController",AvonModule.AvonController),function(n){"use strict";var t=function(t){function i(i,r){var u=this;t.call(this,i);this.$scope=i;n.changeRepScope=i;this.$scope.IsMobile||(i.ChangeRepModel=AVON.TempModalModel);i.ChangeRep=function(n,t,i,f,e){$("input").css("cursor","progress");r.ChangeRep(n,t,i,f,e).success(function(n){return u.handleChangeRepResponse(n)})};i.$on("FallbackSrc.ImageFound",function(n,t){u.$scope.IsMobile&&(t.src==$(".RepPanelCurrent img").attr("src")?$(".RepPanelCurrent .ImageAndDetails").addClass("HasImage"):t.src==$(".RepPanelNew img").attr("src")&&$(".RepPanelNew .ImageAndDetails").addClass("HasImage"))})}return __extends(i,t),i.prototype.handleChangeRepResponse=function(n){this.$scope.IsMobile||$("#ChangeRepContainer").trigger("close");n.ErrorCode===AjaxError.ValidationErrors&&this.$scope.ProcessAjaxValidationErrors(n);$("input").css("cursor","default")},i.$inject=["$scope","changeRepService"],i}(BaseAngularController);n.ChangeRepController=t}(ChangeRepModule||(ChangeRepModule={}));app.controller("ChangeRepController",ChangeRepModule.ChangeRepController),function(n){var t=function(n){function t(t,i){n.call(this,t);this.$scope=t;this.intersectionObserverService=i}return __extends(t,n),t.prototype.lazyLoadCuralate=function(){this.lazyLoadContent("CuralateModule",[.5,1],"100px",this.lazyLoadCuralateOnChangeAction)},t.prototype.lazyLoadCuralateOnChangeAction=function(n){var i=n.target.getElementsByClassName("curalate-code-snippet-template")[0],u=n.target.getElementsByClassName("curalate-script-template")[0],t,r;i&&(t=document.createElement("script"),r=document.createTextNode(u.innerText),t.appendChild(r),n.target.appendChild(t),n.target.innerHTML=i.innerHTML)},t.prototype.lazyLoadContent=function(n,t,i,r){var s=this,f=document.getElementsByClassName(n),e,o,u;if(f)for(e=function(n,t){for(var u,i=0,f=n;i<f.length;i++)u=f[i],u.isIntersecting&&(r(u),s.intersectionObserverService.Unobserve(t,u.target))},o={threshold:t,rootMargin:i},u=0;u<f.length;u++)this.intersectionObserverService.Observe(f[u],e,o)},t}(BaseAngularController);n.CommonContentController=t}(ContentModule||(ContentModule={})),function(n){"use strict";var t=function(t){function i(i,r,u,f){t.call(this,i);n.contactScope=i;n.contactScope.ContactMeFormModel=AVON.ContactMeFormModel;n.contactScope.invalidEmailFormat=AVON.messages.validate_email_invalid;n.contactScope.emailNotMatch=AVON.messages.validate_email_match;n.contactScope.IsGeminiRep=AVON.IsGeminiRep;n.contactScope.IsGeminiRep&&(n.contactScope.ReCaptchaEnabled=typeof grecaptcha!="undefined",n.contactScope.ReCaptchaCallback=function(){n.contactScope.ReCaptchaError="";n.contactScope.SafeApply()},f.ReCaptchaCallback=n.contactScope.ReCaptchaCallback,f.ReCaptchaError=n.contactScope.ReCaptchaError);n.contactScope.InputFocus=function(){n.contactScope.ShowValidation=!1;n.contactScope.ReCaptchaError=""};n.contactScope.SendContactRequest=function(){if(n.contactScope.ReCaptchaEnabled=typeof grecaptcha!="undefined",n.contactScope.ReCaptchaError="",n.contactScope.ContactMeForm.$valid){var t=n.contactScope.ReCaptchaEnabled?grecaptcha.getResponse():"ReCaptchaDisabled";if(!t&&n.contactScope.IsGeminiRep){n.contactScope.ReCaptchaError=AVON.messages.reCaptchaNotChecked;grecaptcha.reset();return}n.contactScope.ShowLoading("");r.SendContactRequest(i.ContactMeFormModel,t)}else n.contactScope.ReCaptchaEnabled&&grecaptcha.reset(),n.contactScope.LivePersonErrorTracking(),n.contactScope.ShowValidation=!0};n.contactScope.$on("ContactService.ContactRequestResponse",function(t,r){if(r.ErrorCode===AjaxError.ValidationErrors&&(n.contactScope.ProcessAjaxValidationErrors(r),$.each(r.ValidationErrors,function(t,i){i.FieldName.indexOf("ReCaptcha")>-1&&(n.contactScope.ReCaptchaError=AVON.messages.reCaptchaErrorMessage)})),r.ErrorCode===AjaxError.None){$("#ContactMeRepModal").trigger("close");i.OpenDynamicModal("ContactMeThankYouModal",{AllowExit:!0,Model:null,KeepLoaded:!1,UrlToLoad:"/contact/contactmethankyou"},i)}});i.CloseThankYou=function(){$("#ContactMeThankYouModal").trigger("close")};i.LivePersonErrorTracking=function(){_.defer(function(){window.lpTag!=undefined&&(window.lpTag.sdes=window.lpTag.sdes||[],window.lpTag.sdes.push({type:"error",error:{message:"Checkout Processing Issue",code:"AVON01"}}))})}}return __extends(i,t),i.$inject=["$scope","contactService","trackingService","$window"],i}(BaseAngularController);n.ContactController=t}(ContactModule||(ContactModule={}));app.controller("ContactController",ContactModule.ContactController),function(n){var t=function(n){function t(t,i,r){n.call(this,t,r);var u=t;$(function(){function s(n){n.stopPropagation();n.preventDefault();n.returnValue=!1;n.cancelBubble=!0}var n=$("#earmark-container"),w=$("#earmark-header"),b=$("#earmark-close"),h=n.data("pause"),c=n.data("is-home-page"),l=n.data("animate-earmark"),a=n.data("animate-only-on-home-page"),v=n.data("did-earmark-animated"),f=$("#earmark-body"),e=$("#earmark-arrow div"),o="earmark-out",y="arrow-down",p="arrow-up";u.closePermanently=n.data("close-permanently");u.openCloseEarmark=function(n){n===void 0&&(n=!1);n&&_.isUndefined(u.animateInPromise)===!1&&i.cancel(u.animateInPromise);f.toggleClass(o);r.IsEarmarkCollapsed=f.hasClass(o)?!0:!1;e.toggleClass(p);e.toggleClass(y)};u.animateInEarmark=function(){v===!1&&(u.SessionService.PostJson("/api/session/didEarmarkAnimated",null),u.openCloseEarmark(),u.animateInPromise=i(function(){u.openCloseEarmark()},h*2e3))};u.removeEarmark=function(){if(u.closePermanently===!1)n.hide();else{var t=u.SessionService.PostJson("/api/session/closeEarmarkPermanently",null);t.success(function(t){t.Data.isEarmarkClosedPermanently&&n.remove()})}};u.detectUrl=function(n){var i=n.target.pathname;(i==="/findarep"||i==="findarep")&&(s(n),t.RedirectToUrl(t.Url.Action("index","Findarep")),u.openCloseEarmark());(i==="/signin"||i==="signin")&&(s(n),$("#LoginModal").trigger("modal"),u.openCloseEarmark())};r.onload=function(){l===!0&&(c===!0?u.animateInEarmark():a===!1&&u.animateInEarmark())}})}return __extends(t,n),t.$inject=["$scope","$timeout","$window"],t}(BaseAngularController);n.EarmarkController=t}(EarmarkModule||(EarmarkModule={}));app.controller("EarmarkController",EarmarkModule.EarmarkController),function(n){var t=function(n){function t(t,i,r,u,f,e){var o=this;n.call(this,t);this.$scope=t;this.findARepService=r;this.trackingService=e;t.requiredField=AVON.messages.validate_field_required;t.DisplayResultsInModal=!1;AVON.findARepModel=AVON.findARepModel!=null?AVON.findARepModel:AVON.TempModalModel!=null?AVON.TempModalModel.findARepModal:null;this.defaultModalDisplay=AVON.TempModalModel!=null?AVON.TempModalModel.display:1;this.reloadForm=AVON.TempModalModel!=null?AVON.TempModalModel.reload:!1;t.FindARepByNameModel=AVON.findARepModel.FindARepByNameModel;t.FindARepByAddressModel=AVON.findARepModel.FindARepByAddressModel;AVON.findARepModel.FindARepByAddressModel.State==null&&(t.FindARepByNameModel.State="",t.FindARepByAddressModel.State="");t.findARepResults=AVON.findARepModel.FindARepResults;this.gocodeCached={hash:"",lat:0,lng:0};t.showResults=!1;t.showMap=!1;this.mapZoomSmall=6;this.mapZoomLarge=9;this.resultPageSize=10;t.visibleCount=this.resultPageSize;t.visibleCountModal=15;t.DeliveryTypes=["",AVON.DeliveryType_RepOrDirect,AVON.DeliveryType_RepOnly,AVON.DeliveryType_DirectOnly];t.LanguageNames=[AVON.LanguageName_English,AVON.LanguageName_Spanish];t.$on("FindARepModalClosed",function(){t.ClearNameForm();t.ClearAddressForm();t.$$listeners=[]});t.SelectRep=function(n){var s,u,f;t.ShowLoading(AVON.messages.spinner_processing);s=t.QueryString().ChangeRep==="1";t.DisplayResultsInModal&&!o.reloadForm?r.selectRep(n,null,s):r.selectRep(n,AVON.returnUrl,s);u="";f="";i.IsFindARepPage()?(u="find a rep",f=t.findARepSearchType==FindARepSearchType.ByName?"locate my rep":"recommend my rep"):(u=i.IsCheckoutPage()?"find a rep checkout":"find a rep pricing",f=t.findARepSearchType==FindARepSearchType.ByName?"modal name":"modal zip code");e.TrackEvent({event_name:"shopwithme",event_category:u,event_action:"shop with me",event_label:"shopwithme",find_a_rep_shopwithme:f,find_a_rep_shopwithme_count:1,find_a_rep_search_results:t.findARepResults.Reps.length})};t.SessionService.WhenReady().then(function(){o.findARepService.getRepStates();t.IsMobile&&t.$root.$broadcast("TopNav.ForceCollapseMobileSearch")});t.$on("FindARepService.SelectRepSuccess",function(){t.DisplayResultsInModal&&($("#FindARepModal").trigger("close"),o.reloadForm?setTimeout(function(){AvonModule.AvonScope.isLoading=!0;AvonModule.AvonScope.ShowLoading(AVON.messages.spinner_loading,!0)},500):t.SessionService.WhenReady().then(function(){u.recalculateBag(ShippingOptionCode.notyetspecified,!1,!1)}))});t.$on("FindARepService.FindARepStatesReturned",function(n,i){i.ErrorCode!==AjaxError.ValidationErrors&&i.Data&&(t.statesAll=i.Data,t.statesShipping=_.filter(t.statesAll,function(n){return n.IsShippingState}))});t.LoadMore=function(){t.visibleCount<t.findARepResults.Reps.length&&(t.visibleCount+=o.resultPageSize,t.visibleCount>t.findARepResults.Reps.length&&(t.visibleCount=t.findARepResults.Reps.length),t.SafeApply())};t.GrowMap=function(){$("#MapContainer").addClass("Expanded");$("#MapContainer").scrollintoview();google.maps.event.trigger(t.map,"resize");setTimeout(function(){t.map.setCenter(o.mapCenterPoint)},100);setTimeout(function(){t.map.setZoom(o.mapZoomLarge)},200)};t.ShrinkMap=function(){$("#MapContainer").removeClass("Expanded");google.maps.event.trigger(t.map,"resize");setTimeout(function(){t.map.setCenter(o.mapCenterPoint)},100);setTimeout(function(){t.map.setZoom(o.mapZoomSmall)},200)};t.GetGeminiRepImageUrl=function(n){return f.representativeImage(n)};t.ReturnToSearchForm=function(){t.FindARepByAddressModel.State="";t.showResults=!1};t.ClearNameForm=function(){o.$scope.FindARepByNameModel.FirstName="";o.$scope.FindARepByNameModel.LastName="";o.$scope.FindARepByNameModel.State="";o.$scope.SafeApply();o.$scope.IsMobile||_.defer(function(){o.$scope.UpdateInlineWaterMark()},200)};t.ClearAddressForm=function(){t.FindARepByAddressModel.Address="";t.FindARepByAddressModel.State="";t.FindARepByAddressModel.ZipCode="";t.SafeApply();t.IsMobile||_.defer(function(){t.UpdateInlineWaterMark()},200)};t.CheckGeolocateHash=function(n){var t=o.CalculateGeolocateHash(),r=o.gocodeCached.hash;if(t!=r){var u=new Geocode.GoogleGeocoder,f=o.$scope.FindARepByAddressModel.Address,e=o.$scope.FindARepByAddressModel.State,i=o.$scope.FindARepByAddressModel.ZipCode;i.length==5?u.geocodeAddress(f,e,i,function(i){o.gocodeCached.hash=t;o.gocodeCached.lat=i.lat;o.gocodeCached.lng=i.lng;o.$scope.FindARepByAddressModel.Latitude=o.gocodeCached.lat.toString();o.$scope.FindARepByAddressModel.Longitude=o.gocodeCached.lng.toString();n&&n()}):(o.gocodeCached.hash=t,n&&n())}else n&&n()};t.ChangeSearchType=function(n){t.findARepSearchType=n;t.showResults=!1;e.TrackEvent({event_name:n===FindARepSearchType.ByName?"search by name":"search by zip code",event_label:n===FindARepSearchType.ByName?"search by name":"search by zip code",event_category:t.IsCheckoutPage()?"find a rep checkout":"find a rep pricing",event_action:"modal links",find_a_rep_search_type:n===FindARepSearchType.ByName?"modal name":"modal zip code"})};t.GetFullName=function(){var n="";return o.$scope.FindARepByNameModel.FirstName!=null&&o.$scope.FindARepByNameModel.FirstName.length>0&&(n=o.$scope.FindARepByNameModel.FirstName+" "),n+o.$scope.FindARepByNameModel.LastName};t.GetStateName=function(){var n=_.filter(o.$scope.statesAll,function(n){return n.Code==o.$scope.FindARepByNameModel.State});return n.length>0?n[0].Name:o.$scope.FindARepByNameModel.State}}return __extends(t,n),t.prototype.setZipCode=function(){var n=this.$scope.Session.Customer;n&&n.IsLoggedIn&&this.$scope.Session.Customer.BillingAddress&&this.$scope.Session.Customer.BillingAddress.Country==="US"&&(this.$scope.FindARepByAddressModel.ZipCode=n.BillingAddress.Zip.substring(0,5))},t.prototype.CalculateGeolocateHash=function(){var n="";return n+=this.$scope.FindARepByAddressModel.Address+",",n+=this.$scope.FindARepByAddressModel.State+",",n+(this.$scope.FindARepByAddressModel.ZipCode||"")},t.prototype.FormatDistanceRange=function(n,t){var r=Math.floor(n/5)*5,u=r+5,i;return i=u.toString(),t&&(i+=" "+t),i},t.prototype.InitRanges=function(){for(var h,n,c,r,e,t,i,o=this.$scope.findARepResults.Reps,u=0,f=0,s=o;f<s.length;f++)t=s[f],t.Distance>u&&(u=t.Distance);for(this.ranges=[],h=$("html.LangEN").length>0?" miles":"millas",n=0;n<=25;n+=5)n<u&&(c={low:n,high:n+5,repCount:0,text:this.FormatDistanceRange(n,h)},this.ranges.push(c));for(r=0,e=o;r<e.length;r++)t=e[r],i=Math.floor(t.Distance/5),i>=this.ranges.length&&(i=this.ranges.length-1),this.ranges[i].repCount=this.ranges[i].repCount+1;this.ranges.reverse()},t.prototype.InitMap=function(){var n=this;this.$scope.showMap=!0;this.$scope.SafeApply();this.InitRanges();_.defer(function(){AVON.Maps.loadGoogleMapsApi().done(function(){var c,f,o;n.richMarkerLoaded||($("body").append('<script type="text/javascript" src="/Scripts/External/Maps/richmarker-compiled.js"><\/script>'),n.richMarkerLoaded=!0);var v=n.gocodeCached.lat,e=n.gocodeCached.lng,h=new google.maps.LatLng(v,e);n.mapCenterPoint=h;c={zoom:n.mapZoomSmall,center:n.mapCenterPoint,mapTypeId:google.maps.MapTypeId.ROADMAP,draggable:!0,mapTypeControl:!1,streetViewControl:!1,panControl:!1,rotateControl:!1,scaleControl:!1,scrollwheel:!1,zoomControl:!1};n.$scope.map=new google.maps.Map(document.getElementById("RepMap"),c);var i={strokeColor:"#f35e95",strokeWeight:.5,fillColor:"#f35e95",fillOpacity:.1,center:h,map:n.$scope.map,radius:0,visible:!0},l=1609.344,a=n.ranges[n.ranges.length-1],u;for(f=0,o=n.ranges;f<o.length;f++){var t=o[f],r=void 0,s=void 0;t.low>a.low&&(a=t);t.high<30&&(i.radius=t.high*l,i.visible=!0,u=new google.maps.Circle(i),r=new google.maps.LatLng(u.getBounds().getNorthEast().lat(),e),s=new RichMarker({position:r,map:n.$scope.map,content:'<span class="milesLabel">'+t.text+"<\/span>"}),s=new RichMarker({position:r,map:n.$scope.map,content:'<span class="repsLabel">'+t.repCount||"0<\/span>"}));t.high==30&&t.repCount>0&&(i.radius=t.high*l,i.visible=!1,u=new google.maps.Circle(i),r=new google.maps.LatLng(u.getBounds().getNorthEast().lat(),e),s=new RichMarker({position:r,map:n.$scope.map,content:'<span class="repsLabel">'+t.repCount+"<\/span>"}))}$("#MapContainer").hasClass("Expanded")&&n.$scope.GrowMap()})});window.addEventListener("resize",function(){$("#MapContainer").hasClass("Expanded")?n.$scope.GrowMap():n.$scope.ShrinkMap()})},t}(BaseAngularController);n.BaseFindARepController=t}(FindARepModule||(FindARepModule={})),function(n){var t=function(n){function t(t,i,r){n.call(this,t);t.ShowValidation=!1;t.FindByAddress=function(n,u){t.DisplayResultsInModal=!1;u!==undefined&&(t.DisplayResultsInModal=u);t&&(t.ShowValidation=!1);t.showResults=!1;t.DisplayResultsInModal||t.ClearNameForm();n.$valid?(t.ShowValidation=!1,t.$parent.findARepSearchType=FindARepSearchType.ByAddress,t.showMap=!1,t.ShowLoading(AVON.messages.spinner_searching),t.CheckGeolocateHash(function(){u?i.findByZip(t.FindARepByAddressModel.ZipCode,t.FindARepByAddressModel.Longitude,t.FindARepByAddressModel.Latitude):i.findByAddress(t.FindARepByAddressModel)}),t.IsFindARepPage()?r.TrackEvent({event_name:"search",event_label:"near me",event_category:"find a rep",event_action:"click",rep_address:t.FindARepByAddressModel.Address,rep_state:t.FindARepByAddressModel.State,rep_zip:t.FindARepByAddressModel.ZipCode}):r.TrackEvent({event_name:"search",event_label:"near me",event_category:t.IsCheckoutPage()?"find a rep checkout":"find a rep pricing",event_action:"click",find_a_rep_search_type:"modal zip code",rep_zip:t.FindARepByAddressModel.ZipCode})):t.ShowValidation=!0};t.$on("FormDirective.HidValidation",function(){t.ShowValidation&&(t.ShowValidation=!1)});t.$on("AddressesScope.ZipCodeDetails",function(n,i){i.IsValidZip||(t.ShowValidation=!0,t.FindByAddressForm.FindARepByAddressModel_ZipCode.$setValidity("validateZipcode",i.IsValidZip))})}return __extends(t,n),t.$inject=["$scope","findARepService","trackingService"],t}(BaseAngularController);n.FindARepByAddressController=t}(FindARepModule||(FindARepModule={}));app.controller("FindARepByAddressController",FindARepModule.FindARepByAddressController),function(n){var t=function(n){function t(t,i,r){n.call(this,t);t.ShowValidation=!1;t.$on("FormDirective.HidValidation",function(){t.ShowValidation&&(t.ShowValidation=!1)});t.FindByName=function(n,u){t.DisplayResultsInModal=!1;u!==undefined&&(t.DisplayResultsInModal=u);t&&(t.ShowValidation=!1);t.showResults=!1;t.DisplayResultsInModal||t.ClearAddressForm();n.$valid?(t.ShowValidation=!1,t.$parent.findARepSearchType=FindARepSearchType.ByName,t.showMap=!1,t.ShowLoading(AVON.messages.spinner_searching),i.findByName(t.FindARepByNameModel),r.TrackEvent({event_name:"search",event_label:"my rep",event_category:t.IsFindARepPage()?"find a rep":t.IsCheckoutPage()?"find a rep checkout":"find a rep pricing",event_action:"click",rep_firstname:t.FindARepByNameModel.FirstName,rep_surname:t.FindARepByNameModel.LastName,rep_state:t.FindARepByNameModel.State,find_a_rep_search_type:t.IsFindARepPage()?"locate my rep":"modal name"})):t.ShowValidation=!0}}return __extends(t,n),t.$inject=["$scope","findARepService","trackingService"],t}(BaseAngularController);n.FindARepByNameController=t}(FindARepModule||(FindARepModule={}));app.controller("FindARepByNameController",FindARepModule.FindARepByNameController),function(n){"use strict";var t=function(n){function t(t,i){var r=this;n.call(this,t);this.$scope=t;this.cacheBusterTimeStamp=(new Date).getTime().toString();t.IsCardExpanded=!1;t.OrganizatioImageLoaded=!1;t.$watch("Session.Fundraiser",function(){t.Fundraiser=t.Session.Fundraiser});t.BannerClicked=function(){t.IsCardExpanded=!t.IsCardExpanded};t.ShowFundraiserBanner=function(){return t.Fundraiser!=null};t.StopShoppingFundraiserClicked=function(){t.IsCardExpanded=!1;i.ShowModal("#FundraiserStopShoppingModal",null,!0,!0)};t.OrganizatioImageOnLoad=function(){t.OrganizatioImageLoaded=!0};t.GetFundraiserUrl=function(){return t.Url.Action("Index","Fundraiser",t.Fundraiser.VanityName)};t.GetOrganizationLogoPath=function(){return r.$scope.Fundraiser.OrganizationLogoPath+"?b="+r.cacheBusterTimeStamp};this.collapseCardOnClickOutsideBanner()}return __extends(t,n),t.prototype.collapseCardOnClickOutsideBanner=function(){var n=this;angular.element(window.document).bind("click",function(t){if(n.$scope.IsCardExpanded){var i=angular.element(".fundraiser-banner").find(t.target).length==0;i&&n.$scope.SafeApply(function(){n.$scope.IsCardExpanded=!1})}})},t.$inject=["$scope","modalService","sessionService"],t}(BaseAngularController);n.FundraiserBannerController=t}(FundraiserBannerModule||(FundraiserBannerModule={}));app.controller("FundraiserBannerController",FundraiserBannerModule.FundraiserBannerController),function(n){"use strict";var t=function(n){function t(t,i,r,u,f){var e=this;n.call(this,t);this.$scope=t;this.urlService=u;this.historyService=f;t.Fundraiser=t.Session.Fundraiser;t.StopShoppingFundraiserModalYesClicked=function(){t.ShowLoading(AVON.messages.spinner_processing);i.StopShoppingFundraiser().success(function(){e.redirectOnStopShoppingFundraiser();e.historyService.ReplaceState("FundraiserState",null)});r.CloseModal()};t.StopShoppingFundraiserModalNoClicked=function(){r.CloseModal()}}return __extends(t,n),t.prototype.redirectOnStopShoppingFundraiser=function(){var n=window.location.pathname,t,i;if(this.$scope.Fundraiser&&(t=this.$scope.Url.Action("Index","Fundraiser",this.$scope.Fundraiser.VanityName),n===t)){this.$scope.RedirectToUrl(this.$scope.HomePageUrl,!0);return}n===this.$scope.Session.Rep.HomepageUrl?this.$scope.RedirectToUrl(this.$scope.HomePageUrl,!0):(i=this.urlService.RemoveQueryStringParameterFromUrl(window.location.href,"rep"),this.$scope.RedirectToUrl(i,!0))},t.$inject=["$scope","fundraiserService","modalService","urlService","historyService"],t}(BaseAngularController);n.StopShoppingFundraiserController=t}(FundraiserModule||(FundraiserModule={}));app.controller("StopShoppingFundraiserController",FundraiserModule.StopShoppingFundraiserController),function(n){var t=function(n){function t(){n.apply(this,arguments)}return __extends(t,n),t}(Object);n.ResxObject=t}(ProductRecommendationsServiceModule||(ProductRecommendationsServiceModule={})),function(n){var t=function(n){function t(t,i,r,u,f){n.call(this,t,i,r);this.$rootScope=t;this.$q=r;this.$window=u;this.productService=f;this.ProductRecommendations={}}return __extends(t,n),t.prototype.SetCertonaObject=function(n){n.devicetype=this.getDeviceType();n.environment=this.getEnvironment();this.$window.certona=n;this.callCertona()},t.prototype.LoadRecommendedProductsCertonaCallback=function(n){var t=this;this.$rootScope.SafeApply(function(){t.LoadRecommendedProducts(n)})},t.prototype.LoadRecommendedProducts=function(n){for(var i,r,e,o=this,t=[],u=0,f=n.schemes;u<f.length;u++)i=f[u],i.display==="yes"&&(r=i.items.map(function(n){return Number(n.itemid)}),r.length>0&&(e=_(r).filter(function(n){return!o.$rootScope.LoadedProducts[n]}),t=t.concat(e),this.ProductRecommendations[i.scheme]={Title:this.getCarouselTitle(AVON.languageId,i.explanation),ProductIds:r}));t=_(t).uniq();t.length>0&&this.productService.GetProductsWithIds(t,!0)},t.prototype.GetRecommendedProducts=function(n){var u=[],t,i,r;if(this.ProductRecommendations[n])for(t=0,i=this.ProductRecommendations[n].ProductIds;t<i.length;t++)r=i[t],this.$rootScope.LoadedProducts[r]&&u.push(this.$rootScope.LoadedProducts[r]);return u},t.prototype.ShowProductRecommendations=function(n){var t=this.ProductRecommendations[n];return t&&this.isAnyRecommendedProductAvailable(t)},t.prototype.isAnyRecommendedProductAvailable=function(n){var t=!1;for(var i in this.$rootScope.LoadedProducts)if(this.$rootScope.LoadedProducts.hasOwnProperty(i)&&n.ProductIds.indexOf(+i)>=0){t=!0;break}return t},t.prototype.getCarouselTitle=function(n,t){var i,u,r=t.split("|");return r.length>0?(i=r[0].trim(),u=r.length>1?r[1].trim():i):(i=null,u=null),n==Language.English?i:u},t.prototype.callCertona=function(){var n=this.$window.certona.pagetype;this.waitForCallCertonaToBeDefined().then(function(t){t.callCertona(n)})},t.prototype.getDeviceType=function(){return this.$rootScope.IsMobile?"mobile":AVON.IsTabletDevice?"tablet":"desktop"},t.prototype.getEnvironment=function(){return this.$window.location.hostname=="www.avon.com"?"PRODUCTION":"QA"},t.prototype.waitForCallCertonaToBeDefined=function(){var n=this,t=this.$q.defer();return this.wait(function(){return n.$window.callCertona?!0:!1},function(){t.resolve(n.$window)}),t.promise},t.prototype.wait=function(n,t){var i=this;n()?t():setTimeout(function(){i.wait(n,t)},200)},t.$inject=["$rootScope","$http","$q","$window","productService"],t}(BaseAvonService);n.ProductRecommendationsService=t}(ProductRecommendationsServiceModule||(ProductRecommendationsServiceModule={}));app.service("productRecommendationsService",ProductRecommendationsServiceModule.ProductRecommendationsService),function(n){n[n.English=1]="English";n[n.Spanish=2]="Spanish"}(Language||(Language={})),function(n){var t=function(n){function t(t,i,r){n.call(this,t,i,r);this.$rootScope=t}return __extends(t,n),t.prototype.notifyMe=function(n){var i=this;this.PostJson("/api/product/notifymemodal",n).success(function(n){n!==null&&i.$rootScope.$broadcast(t.NotifyMeResponseBroadcastName,n)}).error(function(n){i.$rootScope.$broadcast(t.NotifyMeResponseBroadcastName,n)})},t.prototype.GetPromotionsWithIds=function(n){var i=this;n&&n.length>0?this.$rootScope.SessionService.WhenReady().then(function(){for(var f,r,u=0;u<n.length;u+=25)f=n.slice(u,u+25),r="/api/promotions/getpromotions",r+="?language="+AVON.languageId,r+="&campaign="+AVON.campaign,r+="&attached="+i.$rootScope.Session.Customer.IsAttached,r+="&deliverytype="+i.$rootScope.Session.Customer.DeliveryType,r+="&promotionIds="+f.join(","),i.GetJson(r,!0,!0,!1).then(function(n){i.$rootScope.$broadcast(t.PromotionsLoadedBroadcastName,n)})}):this.$rootScope.$broadcast(t.PromotionsLoadedBroadcastName,null)},t.prototype.GetProductWithId=function(n){var i=this,r;return n&&this.$rootScope.SessionService.WhenReady().then(function(){var u="/api/products/getproduct?language="+AVON.languageId+("&campaign="+AVON.campaign)+("&attached="+i.$rootScope.Session.Customer.IsAttached)+("&deliverytype="+i.$rootScope.Session.Customer.DeliveryType)+"&productId="+n;r=i.GetJson(u,!0,!0,!1).then(function(n){return i.$rootScope.$broadcast(t.ProductLoadedBroadcastName,n),n.Data})}),r},t.prototype.GetProductsWithIds=function(n,i){var r=this,u,f=70;return n&&n.length>0?(n=_.uniq(n.sort(),!0),this.$rootScope.SessionService.WhenReady().then(function(){for(var e=0;e<n.length;e+=f){var s=n.slice(e,e+f),h=e,o="/api/products/getproducts?language="+AVON.languageId+("&campaign="+AVON.campaign)+("&attached="+r.$rootScope.isCustomerAttachedOrCookiedToRep())+("&deliverytype="+r.$rootScope.Session.Customer.DeliveryType)+("&productIds="+s.join(","))+("&productIdSubsetIndex="+h);i&&(o=o+"&isexternalvendor=true");u=r.GetJson(o,!0,!0,!1).then(function(n){return r.$rootScope.$broadcast(t.ProductsLoadedBroadcastName,n),n.Data})}})):this.$rootScope.$broadcast(t.ProductsLoadedBroadcastName,null),u},t.prototype.GetProductLine=function(n,i){var r=this;n&&this.$rootScope.SessionService.WhenReady().then(function(){var u="/api/products/getproductline";u+="?language="+AVON.languageId;u+="&campaign="+AVON.campaign;u+="&attached="+r.$rootScope.Session.Customer.IsAttached;u+="&deliverytype="+r.$rootScope.Session.Customer.DeliveryType;u+="&lineId="+n;u+="&takeAmount="+i;r.GetJson(u,!0,!0,!1).then(function(i){r.$rootScope.$broadcast(t.ProductLineLoadedBroadcastName,n,i)})})},t.prototype.GetProductLines=function(n){var i=this,r=[],u=[];for(var f in n)r.push(f),u.push(n[f]);r.length>0&&this.$rootScope.SessionService.WhenReady().then(function(){var n="/api/products/getproductlines";n+="?language="+AVON.languageId;n+="&campaign="+AVON.campaign;n+="&attached="+i.$rootScope.Session.Customer.IsAttached;n+="&deliverytype="+i.$rootScope.Session.Customer.DeliveryType;n+="&lineIds="+r.join(",");n+="&takeAmounts="+u.join(",");i.GetJson(n,!0,!0,!1).then(function(n){i.$rootScope.$broadcast(t.ProductLinesLoadedBroadcastName,n)})})},t.$inject=["$rootScope","$http","$q"],t.NotifyMeResponseBroadcastName="ProductService.NotifyMeResponse",t.PromotionsLoadedBroadcastName="ProductService.PromotionsLoaded",t.ProductLoadedBroadcastName="ProductService.ProductLoaded",t.ProductsLoadedBroadcastName="ProductService.ProductsLoaded",t.ProductLineLoadedBroadcastName="ProductService.ProductLineLoaded",t.ProductLinesLoadedBroadcastName="ProductService.ProductLinesLoaded",t}(BaseAvonService);n.ProductService=t}(ProductServiceModule||(ProductServiceModule={}));app.service("productService",ProductServiceModule.ProductService),function(n){var t=function(){function n(){return{require:"^carousel",restrict:"E",replace:!0,scope:!1,transclude:!0,link:function(n,t,i,r){var u=$(t);u.find("a[href],[ng-click],[data-ng-click],*").on("click",function(n){var t=r.$scope;t.clickEnabled||n.preventDefault()});_.defer(function(){r.update()});n.$on("$destroy",function(){r.update()})},template:'<div class="Slide" ng-transclude><\/div>'}}return n}();n.SlideDirective=t}(CarouselModule||(CarouselModule={}));app.directive("slide",[CarouselModule.SlideDirective]),function(n){var t=function(){function t(){return{restrict:"E",replace:!1,scope:!0,transclude:!0,controller:n.CarouselDirectiveController,compile:function(){return{post:function(n,t){var i=n.IsPanEnabled?"panstart panmove panend panleft panright panup pandown swipeleft swiperight":"swipeleft swiperight";new Hammer(t[0],{}).on(i,n.throttledHammerHandler)}}},template:'<div class="ScrollClip" data-ng-mouseenter="mouseEnter()" data-ng-mouseleave="mouseLeave()" data-ng-click="onClick()">    <div class="ScrollContents">        <div class="WrapLeft"><\/div><div class="Slides" ng-transclude><\/div ><div class="WrapRight"><\/div>    <\/div> <\/div><div class="CarouselPrevious" data-ng-click="previousClicked()" data-analytics="prdctsldr-lft-arrw-btn" data-ng-class="{ Active: PreviousButtonActive() }"><\/div><div class="CarouselNext" data-ng-click="nextClicked()" data-analytics="prdctsldr-rght-arrw-btn" data-ng-class="{ Active: NextButtonActive() }"><\/div><nav class="CarouselPages" data-ng-class="{ HasPages : maxIndex > 0 }">    <ol>        <li data-ng-repeat="slide in slideRange()" data-ng-click="showSlide($index, true, true)" data-ng-class="{ Active : isPageActive($index) }">            <a href="">                <span>{{$index+1}}<\/span>            <\/a>        <\/li>    <\/ol><\/nav>'}}return t.ShowSlideBroadcastName="Carousel_ShowSlide",t}();n.CarouselDirective=t}(CarouselModule||(CarouselModule={}));app.directive("carousel",["$rootScope","$compile",CarouselModule.CarouselDirective]),function(n){"use strict";var t=function(t){function i(i,r,u,f,e,o,s,h,c){var y=this,v,l,a;if(t.call(this,i,e),this.$scope=i,this.trackingService=f,this.wishListService=o,v="https://www.paypalobjects.com/api/checkout.js",n.productScope=i,i.LoadedProductLines={},i.LoadedPromotions={},i.ProductRecommendations=h.ProductRecommendations,i.StarCount=_.range(5),i.AddingToBagButtonStatus={},AVON.productList)for(l=0;l<AVON.productList.length;l++)i.LoadedProducts[AVON.productList[l].Id]=AVON.productList[l];i.$on("GlobalProductController.LoadPromotions",function(n,t){i.LoadPromotions(t)});i.LoadPromotions=function(n){_.defer(function(){u.GetPromotionsWithIds(n)})};i.$on("ProductService.PromotionsLoaded",function(n,t){var u,r;if(t&&t.Data){for(u=t.Data,r=0;r<u.length;r++)i.LoadedPromotions[u[r].PromotionId]=u[r],u[r].PromotionLinkProductId>0&&!i.LoadedProducts[u[r].PromotionLinkProductId]&&i.LoadProduct(u[r].PromotionLinkProductId);i.SafeApply()}});i.LoadProduct=function(n){n&&!i.LoadedProducts[n]&&_.defer(function(){u.GetProductWithId(n)})};i.$on("ProductService.ProductLoaded",function(n,t){t.Data&&(i.LoadedProducts[t.Data.Id]=t.Data,i.SafeApply())});i.LoadProducts=function(n,t){_.defer(function(){u.GetProductsWithIds(n,t)})};i.$on("ProductService.ProductsLoaded",function(n,t){var u,r;if(t&&t.Data){for(u=t.Data,r=0;r<u.length;r++)i.LoadedProducts[u[r].Id]=u[r];i.SafeApply()}});i.LoadProductLine=function(n,t){n&&n>0&&_.defer(function(){u.GetProductLine(n,t)})};i.$on("ProductService.ProductLineLoaded",function(n,t,r){var f,u;if(r.Data)for(f=r.Data,i.LoadedProductLines[t]=[],u=0;u<f.length;u++)i.LoadedProducts[f[u].Id]=f[u],i.LoadedProductLines[t].push(f[u].Id)});i.LoadProductLines=function(n){n&&u.GetProductLines(n)};i.$on("ProductService.ProductLinesLoaded",function(n,t){var u,e,r,o,f;if(t.Data){u=t.Data;for(e in u)if(r=parseInt(e),!i.LoadedProductLines[r]||!(i.LoadedProductLines[r].length>u[r].length)){i.LoadedProductLines[r]=[];for(o in u[r])f=u[r][parseInt(o)],i.LoadedProducts[f.Id]=f,i.LoadedProductLines[r].push(f.Id)}}});i.GetLoadedLineProduct=function(n,t){if(i.LoadedProductLines[n])return i.LoadedProducts[i.LoadedProductLines[n][t]]};i.GetLoadedLineProducts=function(n){var r=[],t;if(i.LoadedProductLines[n])for(t=0;t<i.LoadedProductLines[n].length;t++)r.push(i.LoadedProducts[i.LoadedProductLines[n][t]]);return i.TotalProducts=r.length,r};i.GetRecommendedProducts=function(n){return h.GetRecommendedProducts(n)};i.GetLoadedAvailableProduct=function(n){var r=null,t=i.LoadedProducts[n];return t&&(t.CanBuy==CanBuy.Available||t.CanBuy==CanBuy.AutoReplenishmentOnly)&&(r=t),r};i.GetFullStarsFor=function(n){return new Array(Math.round(n.Rating))};i.GetEmptyStarsFor=function(n){return new Array(5-Math.round(n.Rating))};i.GetRatingArray=function(){return new Array(5)};i.GetProductPrice=function(n){return n.PriceModel?n.CanBuy==CanBuy.AutoReplenishmentOnly?"$"+n.PriceModel.AutoReplenishmentPrice.toFixed(2):"$"+n.PriceModel.ListPrice.toFixed(2):""};i.GetProductSalePrice=function(n){return n.PriceModel?"$"+n.PriceModel.SalePrice.toFixed(2):""};i.ProductUrlFor=function(n,t,r,u){var f;return r===void 0&&(r=!1),u===void 0&&(u=!1),f="",u&&(f=r?"?rrec=true":"?rrec=false"),i.Url.Action("Details","Product")+"/"+t.formatUrlNugget()+"-"+n+f};i.GoToProductPageFor=function(n,t,r){t===void 0&&(t=!1);r===void 0&&(r=!1);var u=i.ProductUrlFor(n.Id,n.Name,t,r);i.RedirectToUrl(u)};i.GoToProductPage=function(n,t,r,u){r===void 0&&(r=!1);u===void 0&&(u=!1);var f="";u&&(f=r?"?rrec=true":"?rrec=false");i.RedirectToUrl(i.Url.Action("Details","Product")+"/"+t.formatUrlNugget()+"-"+n+f)};i.GoToPromotionLink=function(n){i.LoadedPromotions[n]?i.LoadedPromotions[n].CustomerType!="A"||i.isCustomerAttachedOrCookiedToRep()?i.LoadedPromotions[n].PromotionLinkProductId>0?i.GoToProductPageFor(i.LoadedProducts[i.LoadedPromotions[n].PromotionLinkProductId]):i.LoadedPromotions[n].LandingPage&&i.LoadedPromotions[n].LandingPage.length>0?i.RedirectToUrl(i.LoadedPromotions[n].LandingPage):i.RedirectToUrl(i.Url.Action("Index","Promotions")+"/"+n):i.AttachedOnlyPromotionClicked(event):i.RedirectToUrl(i.Url.Action("Index","Promotions")+"/"+n)};i.ShowProductQuickView=function(n,t,r,u,f){var e,o,s;if($(".touch").length>0||i.IsMobile){e=i.Url.Action("Details","Product")+"/"+t.formatUrlNugget()+"-"+n;r&&(e+="?org="+r);i.RedirectToUrl(e);return}o=i.Url.Action("quickshop","Product")+"/"+n+"/"+t.formatUrlNugget();s={AllowExit:!0,Model:{DigitalCatalogUrl:u,DigitalCatalogReferrer:f},KeepLoaded:!1,UrlToLoad:o,IgnoreBackground:!1};i.ShowLoading(AVON.messages.spinner_loading);i.OpenDynamicModal("QuickView",s);a===undefined&&(a=_.throttle(function(){},500,{leading:!1}));a()};i.ShowPromotionOverlay=function(n,t,i){i===void 0&&(i=!1);var r={};i&&(r.Width="230px",r.Left=15);s.ShowTooltipWithModel("promotionTooltip",n.currentTarget,angular.element(n.currentTarget).closest(".SpecialOffer"),t,r)};i.HidePromotionOverlay=function(){s.MouseLeaveLink()};i.SpecialOfferClick=function(n){var r="promotionTooltip",u=s.Tooltips[r].Scope.IsVisible(),t;u?s.HideTooltip():(t={},i.IsMobile&&(t.ShowCloseButton=!0),s.ShowTooltipWithModel(r,event.currentTarget,null,n,t))};i.ShowNotifyOverlay=function(n){event.stopPropagation();s.ShowTooltipWithModel("joinWaitListTooltip",event.currentTarget,angular.element(event.currentTarget).closest(".SpecialOffer"),n,{ShowCloseButton:!0})};i.GetVariantTypeText=function(n){return VariantType[n]};i.ShowProductSummaryPromotion=function(n){var t=$(n.target);t.hasClass("Expandable")&&(t.hasClass("Expanded")?t.removeClass("Expanded"):t.addClass("Expanded"))};i.GoToPromotion=function(n){var t,r;i.LoadedPromotions[n].CustomerType!="A"||i.isCustomerAttachedOrCookiedToRep()?(i.ShowLoading(null),i.LoadedPromotions[n].PromotionLinkProductId>0?(r=i.LoadedProducts[i.LoadedPromotions[n].PromotionLinkProductId],t=i.ProductUrlFor(r.Id,r.Name)):t=i.LoadedPromotions[n].LandingPage&&i.LoadedPromotions[n].LandingPage.length>0?i.LoadedPromotions[n].LandingPage:i.Url.Action("Index","Promotions",n),i.RedirectToUrl(t)):i.AttachedOnlyPromotionClicked(event)};i.WriteAReview=function(n){n.preventDefault();i.ShowLoading(AVON.messages.spinner_loading);var t=$(n.currentTarget).attr("href");i.Session.Customer.IsLoggedIn?AVON.common.redirectTo(t):i.IsMobile?document.location.href="/signin?ReturnUrl="+encodeURIComponent(t):(AVON.RedirectToPowerReviews=!0,AVON.PowerReviewLink=t,c.ShowLoginModal())};i.AddToBag=function(n){var u=[],r,t;for(r in n)t=new AddBagItem,t.Sku=n[r].Sku,t.Quantity=n[r].Qty,u.push(t);i.bagService.addMultipleItemsToBag(u,!1,null)};i.AddProductByIdToBag=function(n,t){var f=1e3,r=_.throttle(function(t){i.SafeApply(function(){i.AddingToBagButtonStatus[n]=t});t==AddingToBagStatus.Added&&_.delay(function(){i.SafeApply(function(){i.AddingToBagButtonStatus[n]=AddingToBagStatus.None})},f)},1e3);i.IsMobile?r(AddingToBagStatus.Adding):i.LoaderModal(AVON.messages.spinner_addingTextOnly);u.GetProductWithId(+n).then(function(u){var f=new AddBagItem;f.Quantity=1;f.Id=n.toString();f.Sku=i.isNullOrWhiteSpace(t)?u.Sku:t;AVON.product=u;i.bagService.addItemToBag(f,!0,null).then(function(n){i.IsMobile&&(AVON.product.CrossSellProductIds=n.CrossSellProductIds,i.IsMobile&&r(AddingToBagStatus.Added))});app.tryLoadScriptBySrc(v)})};i.$on("BagService.AddToBagSuccess",function(n,t){var r=_.reduce(t.ItemsAdded,function(n,t){return n+t.Quantity},0),u=r+" "+(r>1?AVON.messages.commonscript_addedToBasketItemsCount:AVON.messages.commonscript_addedToBasketItemOne);i.CompleteLoaderModal(u)});i.DisplayWishList=function(n){return n.ShowHideProductFlags.IncludeInWishlist?(n.CanBuy===CanBuy.Available||n.CanBuy===CanBuy.AvailableSoon||n.CanBuy===CanBuy.AutoReplenishmentOnly)&&!i.IsDonationProduct(n):!1};i.displayProductBasedOnShowHideFlag=function(n,t){return n&&n.ShowHideProductFlags?n.ShowHideProductFlags[t]:!1};i.IsDonationProduct=function(n){return!(!n.IsFreeShipping||n.IsDiscountable)};i.IsInWishList=function(n){return o.CheckIfAnyVariantExistsInWishList(n.Id)};i.AddProductToWishList=function(n,t){var r,l,s,u,a,h,e,v;i.Session.Customer.IsLoggedIn?(r=angular.element(t.currentTarget),r.hasClass("heart-outline-icon")?(r.addClass("loading-spinner"),r.attr("disabled","true")):(l=r.closest(".OverlayContainer"),l&&(s=l.siblings(".heart-outline-icon"),s&&(s.addClass("loading-spinner"),s.attr("disabled","true")))),i.HideWishListTooltip(t),u=null,a=CanBuy.Available,!n.IsMultiVariantProduct&&n.Availability!=CanBuy.NoLongerAvailable&&n.VariantGroups.length>0&&(h=n.VariantGroups[0].Variants[0],h&&(u=h.Sku,a=h.Availability)),!u&&n.Sku&&n.VariantGroups.length===0&&(u=n.Sku),e=[new WishListItem(n.Id,u,null,a)],v=o.AddToWishList(e),v.finally(function(){var u,t,o;for(r.closest("carousel").triggerHandler("update"),r.removeClass("loading-spinner"),r.removeAttr("disabled"),u=[],t=0;t<e.length;t++)u.push(e[t].Sku===null?n.Sku:e[t].Sku);o={Type:TrackingEventType.WishListItemsAdded,Data:{trackingItems:u,wishListState:i.Session.Customer.WishList.Products.length>0?"exist":"new",findingMethod:"product carousel "+y.trackingService.UTagData.content_page_type}};f.TrackEventItem(o)})):($("#Loader").trigger("close"),i.IsMobile||i.IsBlog()&&$("html").hasClass("Mobile")?i.RedirectToUrl(i.SignInPageUrl("wishlist")):c.ShowLoginModal("wishlist"));t.preventDefault();t.stopPropagation()};i.RemoveAllVariantsFromWishList=function(n,t){var r,f,u,e;i.Session.Customer.IsLoggedIn?(r=angular.element(t.currentTarget),r.hasClass("heart-filled-icon")?(r.addClass("loading-spinner"),r.attr("disabled","true")):(f=r.closest(".OverlayContainer"),f&&(u=f.siblings(".heart-filled-icon"),u&&(u.addClass("loading-spinner"),u.attr("disabled","true")))),i.HideWishListTooltip(t),e=o.RemoveAllVariantsFromWishList(n.Id),e.finally(function(){r.closest("carousel").triggerHandler("update");r.removeClass("loading-spinner");r.removeAttr("disabled")})):i.IsMobile?i.RedirectToUrl(i.SignInPageUrl("wishlist")):c.ShowLoginModal("wishlist");t.preventDefault();t.stopPropagation()};i.$on("Carousel_SlideShown",function(n,t){t.container.find(".Expandable").removeClass("Expanded");t.container.find(".SingleExpandable").removeClass("Expanded")});_.defer(function(){var u=[],t,n;r.find("[data-promotionid]:not([data-promotionid=''])").each(function(){var n=parseInt($(this).attr("data-promotionid"),10);n>0&&u.push(n)});r.find("[data-promotionidlist]:not([data-promotionidlist=''])").each(function(){var n=$(this).attr("data-promotionidlist").split(",");n.forEach(function(n){var t=parseInt(n.trim(),10);t>0&&u.push(t)})});i.LoadPromotions(u);t=[];r.find("[data-productid]:not([data-productid=''])").each(function(){var n=parseInt($(this).attr("data-productid"),10);n>0&&t.push(n)});r.find("[data-productidlist]:not([data-productidlist=''])").each(function(){var n=$(this).attr("data-productidlist").split(",");n.forEach(function(n){var i=parseInt(n.trim(),10);i>0&&t.push(i)})});i.LoadProducts(t);n={};r.find("[data-lineid]:not([data-lineid=''])").each(function(){var t=parseInt($(this).attr("data-lineid"),10),i;t>0&&($(this).attr("data-lineamount")?(i=parseInt($(this).attr("data-lineamount"),10),(n[t]==null||i===0||n[t]!==0&&n[t]<i)&&(n[t]=i)):n[t]=0)});i.LoadProductLines(n)});i.certonaTimeoutElapsed=!1;_.delay(function(){i.certonaTimeoutElapsed=!0;i.$broadcast("Carousel_Update")},3e3);i.ShowProductRecommendations=function(n){return h.ShowProductRecommendations(n)};i.GetProductCarouselTitle=function(n,t){var r=i.ProductRecommendations[n];return r&&r.Title?i.ProductRecommendations[n].Title:t}}return __extends(i,t),i.$inject=["$scope","$element","productService","trackingService","$window","wishListService","tooltipService","productRecommendationsService","loginModalService"],i}(BaseAngularController);n.GlobalProductController=t}(ProductModule||(ProductModule={}));app.controller("GlobalProductController",ProductModule.GlobalProductController),function(n){var t=function(){function n(n,t){var i=this;this.$scope=n;n.ShowThankYouMessage=!1;n.ShowErrorMessage=!1;n.EmailAddress="";n.SendNotify=function(r){var u=n.EmailAddress,e=/^[\w-]+(?:\.[\w-]+)*@(?:[\w-]+\.)+[a-zA-Z]{2,7}$/.test(u),f;e?(f={Email:u,Fsc:"",ProductId:r.toString(),RepId:n.Session.Rep.Id},t.notifyMe(f),n.ShowThankYouMessage=!0,_.delay(function(){i.$scope.HideTooltip()},3e3)):n.ShowErrorMessage=!0};n.HideNotifyOverlay=function(){i.$scope.HideTooltip()};n.ClearEmailValidation=function(){n.ShowErrorMessage=!1}}return n.$inject=["$scope","productService"],n}();n.JoinWaitlistTooltipController=t}(JoinWaitlistTooltipModule||(JoinWaitlistTooltipModule={}));app.controller("JoinWaitlistTooltipController",JoinWaitlistTooltipModule.JoinWaitlistTooltipController),function(n){"use strict";var t=function(n){function t(t,i,r,u,f){function s(){return $("#HeadContainer").length?$("#HeadContainer").height():$("#FixedMenu").height()}n.call(this,t);var e=t,o=$(i);this.trackingService=r;this.bagService=u;this.customerService=f;e.GetPortHoleSite=function(){var n=document.createElement("a"),t;return n.href=o.find("iframe").attr("src"),t=n.protocol+"//"+n.hostname+"/proxy.html",new Porthole.WindowProxy(t,"iFrameContainer")};e.HandleMessageRecieved=function(n){var t,i,f,h;if(n&&n.data){t=JSON.parse(n.data);i=t.action;i||(i="vmoaddtobag");switch(i.toLowerCase()){case"addtobag":e.AddToBag(t.payload);break;case"sweepstakes_lead":e.SweepStakesRegisterLead(t.payload);break;case"getbag":e.HandleGetBag();break;case"showloading":e.HandleShowLoading(t.payload);break;case"hideloading":e.HideLoading();break;case"scroll":window.scrollTo(0,0);break;case"signin":f=t.securitykey;f&&e.LoginService.verifySingleSignOn(f);break;case"iframeheight":h=t.height;h&&(e.IFrameHeight=h,$(".MiniSiteModule").length?$(".MiniSiteModule").attr("style","padding-bottom:"+parseInt(e.IFrameHeight)/10+"rem"):o.find("iframe").attr("height",e.IFrameHeight));break;case"getmodalpositions":var r=$(window).height(),c=s(),l=o.find("iframe").offset(),u=r/2+($(window).scrollTop()-l.top);u=u<r/2?r/2:u;e.GetPortHoleSite().post('{"action":"positionvalues", "positions":{ "viewportHeight": '+r+', "scrollPositionFromTop": '+$(window).scrollTop()+', "headerheight": '+c+', "modalposition": '+u+" }}")}}};e.SweepStakesRegisterLead=function(n){e.ShowLoading(AVON.messages.spinner_loading);f.RegisterLead(n)};e.$on("CustomerService.RegisterLead",function(n,t){e.HideLoading();var i=e.GetPortHoleSite();if(t.ErrorCode==AjaxError.ValidationErrors){i.post('{"action":"validation","validationerrors": '+JSON.stringify(t.ValidationErrors)+" }");return}if(t.ErrorCode!=AjaxError.None){i.post('{"action":"error" }');return}i.post('{"action":"success"}')});e.HandleGetBag=function(){e.ShowLoading(AVON.messages.spinner_loading);e.bagService.getBag()};e.$on("BagService.GetBagSuccess",function(){e.HideLoading()});e.IsTabletDevice=function(){return e.IsTouchDevice()&&!e.IsAndroid};e.HandleShowLoading=function(n){n||(n=AVON.messages.spinner_loading);e.ShowLoading(n)};e.$on("BagService.AddToBagSuccess",function(n,t){var r=[],i;if(t&&t.ItemsFailed&&t.ItemsFailed.length>0)for(i=0;i<t.ItemsFailed.length;i++)r.push({Sku:t.ItemsFailed[i].Sku,LineNumber:t.ItemsFailed[i].LineNumber});e.GetPortHoleSite().post('{"action":"success", "itemsfailed" : '+JSON.stringify(r)+"}")});e.AddToBag=function(n){e.ShowLoading(AVON.messages.spinner_addingToBag);e.bagService.addMultipleItemsToBag(n,!1,TrackingAddToCartType.SkinCareAdvisor)};$(function(){e.GetPortHoleSite().addEventListener(t.HandleMessageRecieved)})}return __extends(t,n),t.$inject=["$scope","$element","trackingService","bagService","customerService"],t}(BaseAngularController);n.MiniSiteController=t}(MiniSiteModule||(MiniSiteModule={}));app.controller("MiniSiteController",MiniSiteModule.MiniSiteController),function(n){var t=function(t){function i(i,r,u,f){t.call(this,i);n.notifyMeScope=i;i.NotifyMeModel={Email:"",Fsc:"",ProductId:"",RepId:0};i.product=AVON.product;i.SessionService.WhenReady().then(function(){i.NotifyMeModel.Email=i.Session.Customer.Email;$("#NotifyMeModel_EmailInput").val(i.NotifyMeModel.Email);i.SafeApply()});i.NotifyMeSubmit=function(n){i.NotifyMeForm.$valid?(i.ShowValidation=!1,i.ShowLoading(AVON.messages.spinner_saving),i.NotifyMeModel.Email=$("#NotifyMeModel_EmailInput").val(),i.NotifyMeModel.Fsc=$("#NotifyMeModel_Fsc").val(),i.NotifyMeModel.ProductId=$("#NotifyMeModel_ProductId").val(),i.NotifyMeModel.RepId=$("#NotifyMeModel_RepId").val(),i.NotifyMeModel.CampaignNumber=$("#NotifyMeModel_CampaignNumber").val(),n?r.NotifyMeQuickShop(i.NotifyMeModel,$("form[name=NotifyMeForm]")):r.NotifyMe(i.NotifyMeModel,$("form[name=NotifyMeForm]"))):(i.ShowValidation=!0,i.TrackUserValidationErrors(i.NotifyMeForm.$error))};i.TrackUserValidationErrors=function(n){if(i.IsMobile!==!1){var t=[];n&&$.each(n,function(n,i){i&&(t.push("err-"+n),$.each(i,function(n,i){t.push(i.$name)}))});t=null}};i.NotifyMeThanksSubmit=function(){f.CloseModal()};i.$on(NotifyMeSerivceModule.NotifyMeService.NotifyMeResponseBroadcastName,function(n,t){t.ErrorCode===AjaxError.ValidationErrors&&i.ProcessAjaxValidationErrors(t);t.ErrorCode===AjaxError.None&&(f.CloseModal(),r.OpenNotifyMeModalSuccess(AVON.languageId))});i.$on(NotifyMeSerivceModule.NotifyMeService.NotifyMeQuickShopResponseBroadcastName,function(n,t){t.ErrorCode===AjaxError.ValidationErrors?(i.ProcessAjaxValidationErrors(t),i.HideLoading(),i.ShowValidation=!0,i.NotifyMeForm.$invalid=!0):($("#NotifyMeContainer").hide(),$(".NotifyMeContainer").hide(),$(".NotifyMeQuickShopForm .NotAvailableMessage").hide(),$(".NotifyMeSuccessQuickShopViewContainer").show(),setTimeout(function(){$(".NotifyMeQuickShopForm").hide();$(".NotifyMeSuccessQuickShopViewContainer").hide();i.product.Availability===1?($(".NotifyMeContainer").hide(),$(".NotifyMeQuickShopForm .NotAvailableMessage").show(),$(".AddToBagContainer").show()):($(".AddToBagContainer").hide(),$(".NotifyMeContainer").show(),$(".NotAvailableMessage").show(),$(".NotifyMeButton").show());i.SafeApply()},4e3))})}return __extends(i,t),i.$inject=["$scope","NotifyMeService","trackingService","modalService"],i}(BaseAngularController);n.NotifyMeController=t}(NotifyMeModule||(NotifyMeModule={}));app.controller("NotifyMeController",NotifyMeModule.NotifyMeController),function(n){var t=function(){function n(){}return n}();n.ProductAddModel=t}(NotifyMeModule||(NotifyMeModule={})),function(n){"use strict";var t=function(t){function i(i,r,u,f,e){t.call(this,r);n.PageTimeoutWarningScope=r;n.PageTimeoutWarningScope.SecondsRemaining=r.ClientConfiguration.PageTimeout.WarningMinutes*60;n.PageTimeoutWarningScope.LoginService=e;n.PageTimeoutWarningScope.RedirectUrl=n.PageTimeoutWarningScope.HomePageUrl+"?overlay=PageTimeoutModal";window.location.toString().indexOf("checkout")>-1&&(n.PageTimeoutWarningScope.RedirectUrl=n.PageTimeoutWarningScope.IsMobile?r.Url.Action("Index","Login")+"?mode=checkout&overlay=PageTimeoutModal":r.Url.Action("Index","Bag")+"?overlay=PageTimeoutModal");r.ContinueClicked=function(){clearInterval(n.PageTimeoutWarningScope.countdownTimer);$("#PageTimeoutWarningModal").remove();$("#AjaxModal").trigger("close");i.$broadcast("Do.ResetPageIdleTime")};n.PageTimeoutWarningScope.Countdown=function(){n.PageTimeoutWarningScope.SecondsRemaining=n.PageTimeoutWarningScope.SecondsRemaining-1;n.PageTimeoutWarningScope.SafeApply();n.PageTimeoutWarningScope.SecondsRemaining<1?(clearInterval(n.PageTimeoutWarningScope.countdownTimer),n.PageTimeoutWarningScope.Redirecting||n.PageTimeoutWarningScope.LoginService.logOut(n.PageTimeoutWarningScope.RedirectUrl,n.PageTimeoutWarningScope.HomePageUrl)):n.PageTimeoutWarningScope.countdownTimer=setTimeout(n.PageTimeoutWarningScope.Countdown,1e3)};n.PageTimeoutWarningScope.countdownTimer=setTimeout(n.PageTimeoutWarningScope.Countdown,1e3)}return __extends(i,t),i.$inject=["$rootScope","$scope","contactService","trackingService","loginService"],i}(BaseAngularController);n.PageTimeoutWarningController=t}(PageTimeoutWarningModule||(PageTimeoutWarningModule={}));app.controller("PageTimeoutWarningController",PageTimeoutWarningModule.PageTimeoutWarningController),function(n){var t=function(n){function t(t,i,r){n.call(this,t,i,r);this.$rootScope=t}return __extends(t,n),t.prototype.AuthenticatePayPalUser=function(n){return this.PostJson("/api/paypal/authorize",{payerId:n})},t.prototype.GetDetails=function(n){return this.PostJson("/api/paypal/basicdetails",{payerId:n})},t.$inject=["$rootScope","$http","$q"],t}(BaseAvonService);n.PayPalService=t}(PayPalServiceModule||(PayPalServiceModule={}));app.service("paypalService",PayPalServiceModule.PayPalService),function(n){var t=function(t){function i(i,r,u,f,e,o){var s=this;t.call(this,i);this.$window=r;this.$rootScope=f;this.paypalService=e;n.paypalSmartButtonScope=i;this.includePayPalSmartButtonJsScript();n.paypalSmartButtonScope.SessionService.WhenReady().then(function(){o.WaitFor(function(){return r.paypal},null,50).then(function(){s.renderPayPalSmartButton()})});n.paypalSmartButtonScope.IsEligible=function(){return r.paypal&&r.paypal.isEligible()}}return __extends(i,t),i.prototype.includePayPalSmartButtonJsScript=function(){var t,n,i;this.$window.paypal||(t=AVON.PayPalSmartButtonScript,t&&(n=document.createElement("script"),n.type="text/javascript",n.src=t,n.defer=!0,i=document.getElementsByTagName("body")[0],i.insertBefore(n,null)))},i.prototype.renderPayPalSmartButton=function(){try{this.$window.paypal&&this.$window.paypal.Button.render(this.getSettings(),"#paypal-button")}catch(n){}},i.prototype.getSettings=function(){var n=this,t=this.$window.paypal,i=AVON.IsCheckoutFlow?"/api/paypal/basicdetails":"/api/paypal/authorize";return{env:AVON.PayPalMode,client:{sandbox:AVON.PayPalClientId,production:AVON.PayPalClientId},locale:AVON.LanguageCode==="es"?"es_US":"en_US",style:{size:"responsive",color:"gold",shape:"rect",label:AVON.IsCheckoutFlow?"pay":"checkout",tagline:!1},commit:!1,funding:{disallowed:[t.FUNDING.CREDIT]},payment:function(){return t.request({method:"get",url:"/api/paypal/generatetoken",headers:{"Content-Type":"application/json; charset=utf-8","Avon-Post-Type":"angular","X-Requested-With":"XMLHttpRequest"}}).then(function(n){return n.token})},onAuthorize:function(t){$("#PayPalExpressModal").trigger("close");AVON.IsCheckoutFlow?n.paypalService.GetDetails(t.payerID).success(function(t){n.$rootScope.$broadcast("AvonController.PayPalLoginComplete",t.email)}):(n.$rootScope.ShowLoading(AVON.messages.spinner_loading),n.paypalService.AuthenticatePayPalUser(t.payerID).error(function(){n.$rootScope.HideLoading()}))}}},i.$inject=["$scope","$window","$compile","$rootScope","paypalService","waitHelperService"],i}(BaseAngularController);n.PayPalSmartButtonController=t}(PayPalSmartButtonModule||(PayPalSmartButtonModule={}));app.controller("PayPalSmartButtonController",PayPalSmartButtonModule.PayPalSmartButtonController),function(n){var t=function(t){function i(i,r,u,f){var e=this;t.call(this,i);this.$scope=i;n.productAddedToBagScope=i;n.productAddedToBagScope.product=AVON.product;n.productAddedToBagScope.AddToBagResult=AVON.TempModalModel;n.productAddedToBagScope.ShowPaypal=!0;PayPalSmartButtonModule.paypalSmartButtonScope&&!PayPalSmartButtonModule.paypalSmartButtonScope.IsEligible()&&(n.productAddedToBagScope.ShowPaypal=!1);n.productAddedToBagScope.CampaignIndexInCart=this.findCampaignIndexByNumber(n.productAddedToBagScope.Session.Customer.Campaign);n.productAddedToBagScope.VariantName=function(t){var r,i;try{for(r=e.findCampaignIndexByNumber(n.productAddedToBagScope.Session.Customer.Campaign),i=0;i<n.productAddedToBagScope.Session.Cart.Campaigns[r].Items.length;i++)if(n.productAddedToBagScope.Session.Cart.Campaigns[r].Items[i].Fsc===t&&n.productAddedToBagScope.Session.Cart.Campaigns[r].Items[i].VariantName)return n.productAddedToBagScope.Session.Cart.Campaigns[r].Items[i].VariantName.replace("Shade: ","")}catch(u){}return""};n.productAddedToBagScope.VariantType=function(t){var r,i;try{for(r=e.findCampaignIndexByNumber(n.productAddedToBagScope.Session.Customer.Campaign),i=0;i<n.productAddedToBagScope.Session.Cart.Campaigns[r].Items.length;i++)if(n.productAddedToBagScope.Session.Cart.Campaigns[r].Items[i].Fsc===t&&n.productAddedToBagScope.Session.Cart.Campaigns[r].Items[i].VariantName)return n.productAddedToBagScope.Session.Cart.Campaigns[r].Items[i].VariantType}catch(u){}return""};n.productAddedToBagScope.TotalQuantity=function(){for(var i=0,t=0;t<n.productAddedToBagScope.AddToBagResult.ItemsAdded.length;t++)i+=n.productAddedToBagScope.AddToBagResult.ItemsAdded[t].Quantity;return i};n.productAddedToBagScope.PayWithPal=function(){var t,i;$("#AjaxModal").trigger("close");n.productAddedToBagScope.ShowLoading(AVON.messages.spinner_loading);t={AllowExit:!0,Model:null,KeepLoaded:!1,UrlToLoad:"/paypal/confirm"};n.productAddedToBagScope.OpenDynamicModal("PayPalExpressModal",t);i={Type:TrackingEventType.CartViewBagPayPalButtonClick};u.TrackEventItem(i)};n.productAddedToBagScope.ShowLoadingToCheckout=function(){var t={Type:TrackingEventType.CartViewBagCheckoutButtonClick};u.TrackEventItem(t);n.productAddedToBagScope.ShowLoading(AVON.messages.spinner_loading)};n.productAddedToBagScope.ShowPromotionOverlay=function(n){var t=$(angular.element(n.currentTarget)[0]),i,r;t.siblings("div").addClass("active");i=t.siblings(".Overlay.active");i.width(t.width()-(i.outerWidth(!0)-i.width()));r=t.siblings(".RotatedCaret45.active");r.css({"margin-left":t.width()/2-r.width()/2})};n.productAddedToBagScope.HidePromotionOverlay=function(n){var t=$(angular.element(n.currentTarget)[0]);t.children(".active").removeClass("active")};n.productAddedToBagScope.$on("ModalClosed",function(){r.$broadcast("ProductAddedToBagModalClosed")});n.productAddedToBagScope.PromotionActive=function(){var i=!1,r=0,t;if(n.productAddedToBagScope.Session.Cart.Campaigns[n.productAddedToBagScope.CampaignIndexInCart])for(t=0;t<n.productAddedToBagScope.Session.Cart.Campaigns[n.productAddedToBagScope.CampaignIndexInCart].Items.length;t++)n.productAddedToBagScope.Session.Cart.Campaigns[n.productAddedToBagScope.CampaignIndexInCart].Items[t].PfId===n.productAddedToBagScope.product.Id&&(r+=n.productAddedToBagScope.Session.Cart.Campaigns[n.productAddedToBagScope.CampaignIndexInCart].Items[t].Quantity);return n.productAddedToBagScope.AddToBagResult.ProductPromotions.length>0&&r>=n.productAddedToBagScope.AddToBagResult.ProductPromotions[0].ConditionMinAmount&&(i=!0),i};i.ShowProductRecommendations=function(n){var t=f.ProductRecommendations[n];return i.product.CrossSellProductIds&&i.product.CrossSellProductIds.length>0||t&&t.ProductIds.length>0}}return __extends(i,t),i.prototype.findCampaignIndexByNumber=function(t){for(var i=0;i<n.productAddedToBagScope.Session.Cart.Campaigns.length;i++)if(n.productAddedToBagScope.Session.Cart.Campaigns[i].Number===t)return i},i.$inject=["$scope","$rootScope","trackingService","productRecommendationsService"],i}(BaseAngularController);n.ProductAddedToBagController=t}(ProductDetailModule||(ProductDetailModule={}));app.controller("ProductAddedToBagController",ProductDetailModule.ProductAddedToBagController),function(n){var t=function(n){function t(t,i,r){n.call(this,t,i,r);this.$rootScope=t}return __extends(t,n),t.prototype.LoadCategoryHeroAndPromoSpots=function(n,t,i){var u=this,r="/api/content/category";r+="?language="+AVON.languageId;r+="&campaignNumber="+AVON.campaign;r+="&level2="+n.formatUrlNugget();r+="&level3="+t.formatUrlNugget();r+="&level4="+i.formatUrlNugget();this.GetJson(r,!0,!0,!1).then(function(n){u.$rootScope.$broadcast("ProductListService.HeroSpotLoaded",n.Data.view);u.$rootScope.$broadcast("ProductListService.BottomContentLoaded",n.Data.bottomContainersView);u.$rootScope.$broadcast("ProductListService.ProductSpotsLoaded",n.Data.model)})},t.prototype.GetProductsInCategory=function(n){var t=this;n&&this.$rootScope.SessionService.WhenReady().then(function(){var i="/api/products/getproductsincategory";i+="?language="+AVON.languageId;i+="&campaign="+AVON.campaign;i+="&attached="+t.$rootScope.isCustomerAttachedOrCookiedToRep();i+="&deliverytype="+t.$rootScope.Session.Customer.DeliveryType;i+="&catId="+n;t.GetJson(i,!0,!0,!0).then(function(n){t.$rootScope.$broadcast("ProductListService.ProductCategoryLoaded",n.Data)})})},t.prototype.GetProductsBySearch=function(n){var i=this,r="/api/search/getproductsbysearch/"+n;return n.trim().length===0&&(r="/api/search/getproductsforemptysearch/"),this.GetJson(r,!0,!1,!0).then(function(n){return n.Data.RedirectionUrl!==undefined&&n.Data.RedirectionUrl!==null?i.$rootScope.$broadcast(t.ProductSearchRedirectionBroadcastName,n.Data.RedirectionUrl):i.$rootScope.$broadcast(t.ProductSearchLoadedBroadcastName,n),n})},t.$inject=["$rootScope","$http","$q"],t.ProductSearchLoadedBroadcastName="ProductListService.ProductSearchLoaded",t.ProductSearchRedirectionBroadcastName="ProductListService.ProductSearchRedirection",t}(BaseAvonService);n.ProductListService=t}(ProductListServiceModule||(ProductListServiceModule={}));app.service("productListService",ProductListServiceModule.ProductListService),function(n){var t=function(n){function t(t,i,r,u,f){function s(){var n=$("#model-values");return{showMoreProductsAfter:n.data("showMoreProductsAfter"),loadHowManyProducts:n.data("loadHowManyProducts"),productsLookup:n.data("productsLookup"),categoriesLookup:n.data("categoriesLookup"),productLineId:n.data("productLineId"),displaySortControl:n.data("displaySortControl")}}function o(n,t){if(t===void 0&&(t=!1),n){var r;r=t===!0?n.Products:n.Data;r.forEach(function(n){i.products.push(n)})}}n.call(this,i);i.products=[];i.promoSpots=[];AVON.Navigation&&AVON.Navigation.Content&&(i.promoSpots=AVON.Navigation.Content.ProductPromotionSpots);var e=s();i.showMoreProductsAfter=e.showMoreProductsAfter;i.loadHowManyProducts=e.loadHowManyProducts;i.productsLookup=e.productsLookup;i.categoriesLookup=e.categoriesLookup;i.productLineId=e.productLineId;i.displaySortControl=e.displaySortControl;u.GetProductLine(i.productLineId,0);f.GetProductsInCategory(i.categoriesLookup[i.categoriesLookup.length-1]);i.$on("ProductService.ProductsLoaded",function(n,t){t.Data.forEach(function(n){var t=$.inArray(n.Id,i.productsLookup);t>=0&&(i.products.push(n),i.productsLookup.splice(t,1))})});i.$on("ProductService.ProductLineLoaded",function(n,t,i){o(i)});i.$on("ProductListService.ProductCategoryLoaded",function(n,t){o(t,!0)});i.isSortControlShown=function(){return i.products.length===0?!1:i.displaySortControl};i.showMoreButton=function(){return i.products.length>i.showMoreProductsAfter};i.ExpandedAddToBagId=null;angular.forEach(i.products,function(n){n.Name=i.SecureHtml(n.Name)});i.IncreaseShowProductCount=function(){i.showMoreProductsAfter+=i.loadHowManyProducts;i.SafeApply()};i.getSortingCriteria=function(){switch(i.sortingCriteria){case"Price":return["-IsAvailable","PriceModel.ListPrice","-PriceModel.IsOnSale","-HasPromotion","PriceModel.ListPrice"];case"Rating":return["-IsAvailable","-HasRating","-Rating","-PriceModel.IsOnSale","-HasPromotion","PriceModel.ListPrice"];case"Name":return["-IsAvailable","Name","-PriceModel.IsOnSale","-HasPromotion","PriceModel.ListPrice"];default:return["-IsAvailable","ListIndex","-PriceModel.IsOnSale","-HasPromotion","PriceModel.ListPrice"]}};i.GoToProductPage=function(n,t){i.RedirectToUrl(i.Url.Action("Details","Product")+"/"+t+"-"+n)};i.GetSimplePromoSpot=function(n,t){for(var r=0;r<i.promoSpots.length;r++)if(i.promoSpots[r].IndexLocation==n||t&&i.promoSpots[r].IndexLocation>=n)return i.promoSpots[r];return null};i.AddToBag=function(n,t){var f=n.Sku,u;n.SelectedVariantSku&&(f=n.SelectedVariantSku);u=new AddBagItem;u.Quantity=t||1;u.Sku=f;u.Id=n.Id;AVON.product=n;i.ShowLoading(AVON.messages.spinner_adding);r.addItemToBag(u,!0)};i.ToggleAddToBag=function(n){i.ExpandedAddToBagId=i.ExpandedAddToBagId==n?null:n};i.ShowPromotionOverlay=function(n){var i=$(angular.element(n.currentTarget)[0]),t=$(i).parents(".ProductSummary").find(".Expandable");t.hasClass("Expanded")?t.removeClass("Expanded"):t.addClass("Expanded")};i.SortChanged=function(){i.SafeApply()}}return __extends(t,n),t.$inject=["$rootScope","$scope","bagService","productService","productListService"],t}(BaseAngularController);n.ProductListModuleController=t}(ProductListControlModule||(ProductListControlModule={}));app.controller("ProductListModuleController",ProductListControlModule.ProductListModuleController),function(n){var t=function(){function n(){}return n.GetSortingFilters=function(n){var t,i;return n?(i="PriceModel.IsOnSale ? PriceModel.SalePrice : PriceModel.ListPrice",t=["-IsAvailable",i,"-PriceModel.IsOnSale","-HasPromotion","PriceModel.ListPrice","ListIndex"]):t=["-IsAvailable","PriceModel.ListPrice","-PriceModel.IsOnSale","-HasPromotion","PriceModel.ListPrice","ListIndex"],{None:[],Default:["-IsAvailable","ListIndex","-PriceModel.IsOnSale","-HasPromotion","PriceModel.ListPrice"],Price:t,Rating:["-IsAvailable","-HasRating","-Rating","-PriceModel.IsOnSale","-HasPromotion","PriceModel.ListPrice","ListIndex"],Name:["-IsAvailable","Name","-PriceModel.IsOnSale","-HasPromotion","PriceModel.ListPrice"],Relevance:["-IsAvailable","-PriceModel.IsOnSale","-HasPromotion","PriceModel.ListPrice","ListIndex"],SearchRelevance:["ListIndex","-IsAvailable","-PriceModel.IsOnSale","-HasPromotion","PriceModel.ListPrice"],Discount:["-IsAvailable","-PriceModel.DiscountPercent","-HasPromotion","PriceModel.ListPrice"]}},n}();n.SortingCriteriaProvider=t}(SortingCriteriaProviderModule||(SortingCriteriaProviderModule={})),function(n){var t=function(n){function t(t,i,r,u){n.call(this,t,i);this.$scope=t;t.AddingToBagButtonStatus={};t.ApplyRepCouponToCart=function(n){var i;t.ThrottledChangeAddingToBagStatus=_.throttle(function(i){t.SafeApply(function(){t.AddingToBagButtonStatus[n.Id]=i})},1e3);t.IsMobile?t.ThrottledChangeAddingToBagStatus(AddingToBagStatus.Adding):t.LoaderModal(AVON.messages.spinner_addingTextOnly);i=$("body.Controller_Checkout").length>0&&$("body.Action_Index").length>0;u.ApplyCoupon(n.CouponCode,i,n.Id)};t.$on("BagService.ApplyCouponSuccess",function(){t.IsMobile?t.ThrottledChangeAddingToBagStatus(AddingToBagStatus.Added):AvonModule.AvonScope.CompleteLoaderModal(AVON.messages.commonscript_repCouponAdded)})}return __extends(t,n),t.$inject=["$scope","$window","$filter","bagService","sessionService","trackingService"],t}(BaseAngularController);n.RepCouponController=t}(RepCouponModule||(RepCouponModule={}));app.controller("RepCouponController",RepCouponModule.RepCouponController),function(n){var t=function(n){function t(t,i,r){var u=this;n.call(this,t);this.$scope=t;this.searchService=i;t.SearchTerm=AVON.SearchTerm;t.SearchShowAmountLimit=t.IsBlog()?t.ClientConfiguration.BlogProductListPageSize:t.ClientConfiguration.ProductListPageSize;t.UserIsLoggedInFromBlogSearchPageSessionKeyValue="UserIsLoggedInFromBlogSearchPage";t.NoSearchResultsLeftNavCategories=AVON.NoSearchResultsLeftNavCategories;t.SelectedResultsTab=SearchTermType.Celebros;t.SelectResultsTab=function(n){t.SelectedResultsTab=n};i.getArticleResults(t.SearchTerm).then(function(n){return t.ArticleResults=n,t.VisibleProductsCount=t.IsBlog()?t.ClientConfiguration.BlogProductListPageSize>t.ArticleResults.length?t.ArticleResults.length:t.ClientConfiguration.BlogProductListPageSize:t.ClientConfiguration.ProductListPageSize>t.ArticleResults.length?t.ArticleResults.length:t.ClientConfiguration.ProductListPageSize,n});t.IncreaseSearchShowAmountLimit=function(){t.SearchShowAmountLimit+=t.IsBlog()?t.ClientConfiguration.BlogProductListPageSize:t.ClientConfiguration.ProductListPageSize;t.VisibleProductsCount=t.SearchShowAmountLimit;t.VisibleProductsCount>t.ArticleResults.length&&(t.VisibleProductsCount=t.ArticleResults.length);t.VisibleProductsCountUpdated=!0;t.SafeApply()};t.Init=function(n){AVON.CelebrosSearchTerm?t.SelectResultsTab(SearchTermType.Celebros):t.SelectResultsTab(n)};this.userIsLoggedInFromBlogSearchPage=t.GetValueFromSessionStorage(t.UserIsLoggedInFromBlogSearchPageSessionKeyValue);this.userIsLoggedInFromBlogSearchPage?(this.saveSessionStorageValue(t.UserIsLoggedInFromBlogSearchPageSessionKeyValue,!1),t.Init(0)):t.Init(1);t.$on(ProductListServiceModule.ProductListService.ProductSearchLoadedBroadcastName,function(n,i){if(t.ProductResults=i.Data.products,t.ProductResults&&t.ProductResults[0]!=null){var u=void 0,f=_(i.Data.products).map(function(n){return n.Id});u=t.ProductResults.length<=8?!0:!1;r.SetCertonaObject(new SearchPageCertonaObject(u,f))}else r.SetCertonaObject(new NoSearchPageCertonaObject)});t.$on("LoginService.LoginResponse",function(n,i){i.ErrorCode===AjaxError.None&&u.saveSessionStorageValue(t.UserIsLoggedInFromBlogSearchPageSessionKeyValue,!0)});t.$on("LoginService.FacebookLoginResponse",function(n,i){i.status===200&&i.data.Data===""&&u.saveSessionStorageValue(t.UserIsLoggedInFromBlogSearchPageSessionKeyValue,!0)});t.$on("LoginService.AutoLoginResponse",function(n,i){i.ErrorCode===AjaxError.None&&u.saveSessionStorageValue(t.UserIsLoggedInFromBlogSearchPageSessionKeyValue,!0)})}return __extends(t,n),t.prototype.saveSessionStorageValue=function(n,t){this.$scope.SetValueIntoSessionStorage(n,t)},t.$inject=["$scope","searchService","productRecommendationsService"],t}(BaseAngularController);n.SearchResultsController=t}(SearchResultsModule||(SearchResultsModule={}));app.controller("SearchResultsController",SearchResultsModule.SearchResultsController),function(n){(function(n){n[n.None=0]="None";n[n.AddToBag=1]="AddToBag";n[n.SelectVariant=2]="SelectVariant";n[n.NotifyMe=3]="NotifyMe"})(n.PlpActionButton||(n.PlpActionButton={}));var t=n.PlpActionButton}(SimpleProductListModule||(SimpleProductListModule={})),function(n){var t=function(){function n(){}return n}();n.ProductListProductViewModel=t}(SimpleProductListModule||(SimpleProductListModule={})),function(n){var t=function(t){function i(i,r,u,f,e,o){var s=this;t.call(this,r);this.$scope=r;n.simpleProductListScope=r;r.products=[];r.mySimpleProductList=[];r.promoSpots=[];AVON.Navigation&&AVON.Navigation.Content&&(r.promoSpots=AVON.Navigation.Content.ProductPromotionSpots);r.SetValueIntoSessionStorage("SelectedProductLineId",AVON.SelectedProductLineId||"");r.ExpandedAddToBagId=null;angular.forEach(r.products,function(n){n.Name=r.SecureHtml(n.Name)});r.showProductCount=20;r.SessionService.WhenReady().then(function(){r.showProductCount=r.IsBlog()?r.ClientConfiguration.BlogProductListPageSize:r.ClientConfiguration.ProductListPageSize;r.SafeApply()});r.IncreaseShowProductCount=function(){r.showProductCount+=r.IsBlog()?r.ClientConfiguration.BlogProductListPageSize:r.ClientConfiguration.ProductListPageSize;r.SafeApply()};r.getSortingCriteria=function(){var n;switch(r.sortingCriteria){case"Price":n=s.sortingFilters.Price;break;case"Rating":n=s.sortingFilters.Rating;break;case"Name":n=s.sortingFilters.Name;break;default:n=s.sortingFilters.Default}return n};r.GoToProductPage=function(n,t){if($(".ie").length>0){var i=[];$("div[data-product-summary-id]").each(function(){var n=parseInt($(this).attr("data-product-summary-id"),10);n>0&&i.push(n)});r.SetValueIntoSessionStorage("ListedProductsIdsOrder",i)}r.RedirectToUrl(r.Url.Action("Details","Product")+"/"+t+"-"+n)};r.GetSimplePromoSpot=function(n,t){for(var i,u=0;u<r.promoSpots.length;u++)if(i=r.promoSpots[u],t){if(i.IndexLocation>n)return i}else if(i.IndexLocation==n)return i;return null};r.AddToBag=function(n,t){var u,i;!n.SelectedVariantSku&&n.VariantGroups.length>1||(u=n.Sku,n.SelectedVariantSku&&(u=n.SelectedVariantSku),i=new AddBagItem,i.Quantity=t||1,i.Sku=u,i.Id=n.Id,r.IsMobile?(r.ShowLoading(AVON.messages.spinner_adding),AVON.product=n):r.LoaderModal(AVON.messages.spinner_addingTextOnly),f.addItemToBag(i,!0))};$(u[0]).find("[data-productidlist]:not([data-productidlist=''])").each(function(){var n=$(this).attr("data-productidlist").split(",");n.forEach(function(n){var t=parseInt(n.trim(),10);r.mySimpleProductList.push(t)})});r.$on(ProductServiceModule.ProductService.ProductsLoadedBroadcastName,function(n,t){for(var u,e,f,o=s.initializeViewModel(t.Data),i=0;i<r.mySimpleProductList.length;i++)for(u=0,e=o;u<e.length;u++)f=e[u],f.Id==r.mySimpleProductList[i]&&(f.ListIndex=i,r.products.push(f))});r.SortChanged=function(){r.SafeApply()};r.SelectVariantClicked=function(n){n.VariantsContainerOpen=!n.VariantsContainerOpen;n.VariantsContainerOpen&&(n.ShowVariantsList=!0,n.VariantGroups&&n.VariantGroups.length!=0||(n.LoadingVariants=!0,o.GetProductWithId(n.Id).then(function(t){t?(n.VariantGroups=s.initializeVariantsViewModel(t.VariantGroups),n.LoadingVariants=!1):r.RedirectToUrl(r.Url.Action("Details","Product",n.SeoName+"-"+n.Id),!0)})))};r.VariantsCloseButtonClicked=function(n){n.VariantsContainerOpen=!1};r.VariantButtonClicked=function(n,t,i){t.SelectedVariant=i;t.ShowVariantsList=!1;var r=$(n.currentTarget).closest(".ProductSummary").offset().top-$("#FixedMenu").height();$("html, body").stop().animate({scrollTop:r},500,"swing")};r.VariantSelectButtonClicked=function(n){n.ShowVariantsList=!0};r.AddToBagButtonClicked=function(n){var h=1e3,o=_.throttle(function(t){n.AddingToBagStatus=t;r.SafeApply();t==AddingToBagStatus.Added&&_.delay(function(){n.AddingToBagStatus=AddingToBagStatus.None;r.SafeApply()},h)},1e3),t=new AddBagItem,i,u,e;t.Quantity=1;i=null;o(AddingToBagStatus.Adding);n.HasVariants&&n.TotalVariants>1?(i=n.SelectedVariant,u=i.Sku):n.Sku&&(u=n.Sku);u?(t.Sku=u,e=f.addItemToBag(t,!1,r.FindingMethod())):(t.LineNumber=n.DisplayLineNumber,e=f.lineEntryAddSingleProductToBag(t,r.FindingMethod()));e.then(function(t){t.ItemsFailed&&t.ItemsFailed.length?r.RedirectToUrl(r.Url.Action("Details","Product",n.SeoName+"-"+n.Id),!0):(s.incrementAndResetAddToBagButton(n,i),o(AddingToBagStatus.Added))})};r.FindingMethod=function(){return window.location.href.indexOf("/search")!==-1?TrackingAddToCartType.Search:window.location.href.indexOf("/category")!==-1||window.location.href.indexOf("/promotions")!==-1?TrackingAddToCartType.Category:TrackingAddToCartType.TrackingAddToCartType};r.DisplayVariantLineNumber=function(n,t){return ProductHelper.DisplayVariantLineNumber(n.LineNumber,t)};r.IsVariantAvailableSoon=function(n){return n.Availability==CanBuy.AvailableSoon};r.GetVariantSelectPlaceholderText=function(n,t,i){return t==VariantType.Unknown?i:n+" "+AVON.VariantTypesLocalized[t].toLocaleLowerCase()};r.NotifyMeButtonClicked=function(n,t){return e.OpenNotifyMeModal(n,t,null,0)};r.GetButtonToDisplay=function(t){return t.PriceModel.AutoReplenishmentPrice?n.PlpActionButton.None:t.IsAvailable||t.CanBuy!=CanBuy.AvailableSoon?t.HasVariants&&t.TotalVariants>1?n.PlpActionButton.SelectVariant:n.PlpActionButton.AddToBag:n.PlpActionButton.NotifyMe};r.ProductIsAvailableOrAvailableSoon=function(n){return n.IsAvailable||!n.IsAvailable&&n.CanBuy===CanBuy.AvailableSoon};r.ShowMobilePromotionOverlay=function(n){var i=$(angular.element(n.currentTarget)[0]),t=$(i).parents(".ProductSummary").find(".Expandable");t.hasClass("Expanded")?t.removeClass("Expanded"):t.addClass("Expanded")};r.HideMobilePromotionOverlay=function(n){var t=$(angular.element(n.currentTarget)[0]);$(t).parents(".Expandable.Expanded").removeClass("Expanded")};this.sortingFilters=SortingCriteriaProviderModule.SortingCriteriaProvider.GetSortingFilters(r.isCustomerAttachedOrCookiedToRep())}return __extends(i,t),i.prototype.initializeViewModel=function(n){var t=this;return _.map(n,function(n){var i=n;return i.SelectedVariant=null,i.AddedToBagCount=0,i.AddingToBagStatus=AddingToBagStatus.None,i.ShowVariantsList=!1,i.VariantsContainerOpen=!1,i.LoadingVariants=!1,i.VariantGroups=t.initializeVariantsViewModel(n.VariantGroups),i})},i.prototype.initializeVariantsViewModel=function(n){return _.map(n,function(n){var t=n;return t.Variants=_.map(t.Variants,function(n){var t=n;return t.AddedToBagCount=0,t}),t})},i.prototype.incrementAndResetAddToBagButton=function(n,t){t===void 0&&(t=null);t?t.AddedToBagCount=t.AddedToBagCount?t.AddedToBagCount+1:1:n.AddedToBagCount=n.AddedToBagCount?n.AddedToBagCount+1:1},i.$inject=["$rootScope","$scope","$element","bagService","NotifyMeService","productService"],i}(BaseAngularController);n.SimpleProductListCtrl=t}(SimpleProductListModule||(SimpleProductListModule={}));app.controller("SimpleProductListController",SimpleProductListModule.SimpleProductListCtrl),function(n){var t=function(n){function t(t,i,r){n.call(this,t,i,r);this.$rootScope=t}return __extends(t,n),t.prototype.GetMobileTopNavigationItems=function(){var n=this;this.$rootScope.SessionService.WhenReady().then(function(){var t="/api/category/topmenuitemsmobile";t+="?language="+AVON.languageId;t+="&campaign="+AVON.campaign;t+="&attached="+n.$rootScope.isCustomerAttachedOrCookiedToRep();t+="&deliverytype="+n.$rootScope.Session.Customer.DeliveryType;n.GetJson(t,!0,!0,!1).then(function(t){n.$rootScope.$broadcast("NavigationService.MobileMenuLoaded",t)})})},t.prototype.GetTopNavigationCategories=function(){var n=this;this.$rootScope.SessionService.WhenReady().then(function(){var t="/api/category/topmenuitems";t+="?language="+AVON.languageId;t+="&campaign="+AVON.campaign;t+="&attached="+n.$rootScope.isCustomerAttachedOrCookiedToRep();t+="&deliverytype="+n.$rootScope.Session.Customer.DeliveryType;n.GetJson(t,!0,!0,!1).then(function(t){n.$rootScope.$broadcast("NavigationService.MenuLoaded",t)})})},t.prototype.GetFeaturedBrands=function(){return this.GetJson("/api/category/featuredBrands",!0,!0,!1)},t.$inject=["$rootScope","$http","$q"],t}(BaseAvonService);n.NavigationService=t}(NavigationModule||(NavigationModule={}));app.service("NavigationService",NavigationModule.NavigationService),function(n){"use strict";var i=function(){function n(){this.Caption="";this.Title="";this.IconCode="";this.AlternativeText="";this.IconUrl="";this.IconColor="";this.Url="";this.Id=null;this.Target="";this.SortOrder=null;this.AdditionalLinks=null;this.GroupNames=null;this.GroupedChildren=null;this.Children=null;this.TopPromotionThumbnails=null;this.IncludeInTopNavigation=null;this.IncludeInTopBrandsNavigation=null;this.IncludeInAllBrandsPage=null;this.IncludeInLeftNavigation=null;this.AlphabetLetter=null;this.Type=""}return n}(),t=function(t){function i(i,r){function u(){$.ajax({url:"/api/home/gethtmlsitemaplandingpages",dataType:"json",success:function(t){n.siteMapScope.BalancedLandingPages=t.Data.LandingPages}})}t.call(this,i);n.siteMapScope=i;n.siteMapScope.AllCategories=AVON.TopNavigation;n.siteMapScope.AllBrands=[];r.GetFeaturedBrands();r.GetTopNavigationCategories();n.siteMapScope.$on("NavigationService.MenuLoaded",function(t,i){var e,a,o,u,r,l,f,y;for(n.siteMapScope.AllCategories=i.Data.TopMenuItems,n.siteMapScope.BlogTopNavigation=i.Data.BlogTopNavigation,angular.forEach(n.siteMapScope.AllCategories,function(t){t.Type==="Brand"&&t.Caption&&t.Caption.length>0&&(t.IncludeInAllBrandsPage=t.IncludeInTopNavigation,n.siteMapScope.AllBrands.push(t));angular.forEach(t.GroupNames,function(i){(i.toLowerCase()==="brands"||i.toLowerCase()==="marcas")&&angular.forEach(t.GroupedChildren[i],function(t){t.IncludeInAllBrandsPage&&t.Caption&&t.Caption.length>0&&n.siteMapScope.AllBrands.push(t)})})}),n.siteMapScope.AllCategories.sort(function(n,t){var i=n.Caption.toUpperCase(),r=t.Caption.toUpperCase();return i<r?-1:i>r?1:0}),n.siteMapScope.LanguageCode==="es"?(e=6,a=3):(e=5,a=3),n.siteMapScope.BalancedCategories=[],o=0;o<=e;o++)n.siteMapScope.BalancedCategories[o]=[];for(u=0,r=0;r<n.siteMapScope.AllCategories.length;r++){if(n.siteMapScope.AllCategories[r].Caption==="mark"||n.siteMapScope.AllCategories[r].Caption==="Cuidado Personal"){n.siteMapScope.BalancedCategories[u+1].push(n.siteMapScope.AllCategories[r]);u+=2;continue}r!==0&&r%a==0&&u++;u>e&&(u=e);n.siteMapScope.BalancedCategories[u].push(n.siteMapScope.AllCategories[r])}n.siteMapScope.AllBrands.sort(function(n,t){var i=n.Caption.toUpperCase(),r=t.Caption.toUpperCase();return i<r?-1:i>r?1:0});var s=0,v=3,p=16,h=0,c=0;for(n.siteMapScope.AllBrandsColumnBalanced=[],l=0;l<=v;l++)n.siteMapScope.AllBrandsColumnBalanced[l]=[];for(f=0;f<n.siteMapScope.AllBrands.length;f++){if(h++,n.siteMapScope.AllBrands[f].Children)for(y=0;y<n.siteMapScope.AllBrands[f].Children.length;y++)h++;c+=h;c>p&&(s++,c=c-p);s>v&&(s=v);n.siteMapScope.AllBrandsColumnBalanced[s].push(n.siteMapScope.AllBrands[f]);h=0}});u()}return __extends(i,t),i.$inject=["$scope","NavigationService"],i}(BaseAngularController);n.SiteMapController=t}(SiteMapModule||(SiteMapModule={}));app.controller("SiteMapController",SiteMapModule.SiteMapController),function(n){n[n.None=-1]="None";n[n.RegistrationViaCheckout=0]="RegistrationViaCheckout";n[n.PaymentPageModal=1]="PaymentPageModal";n[n.AttachRep=2]="AttachRep";n[n.EmailSignUp=4]="EmailSignUp";n[n.Registration=6]="Registration";n[n.MyPreferencesPage=7]="MyPreferencesPage";n[n.ForcedAttachmentConfirmation=9]="ForcedAttachmentConfirmation";n[n.RegistrationViaSweepstakes=12]="RegistrationViaSweepstakes";n[n.RegistrationViaAffiliate=13]="RegistrationViaAffiliate";n[n.AndroidMobileAppCreateCustomer=23]="AndroidMobileAppCreateCustomer";n[n.ApplePhoneMobileAppCreateCustomer=24]="ApplePhoneMobileAppCreateCustomer";n[n.ContactMePage=25]="ContactMePage";n[n.SignUpPopup=36]="SignUpPopup";n[n.Unknown=37]="Unknown"}(EmailSubscriptionSource||(EmailSubscriptionSource={})),function(n){var t=function(t){function i(i,r){function u(t,i){n.subscribeScope.subscribeService=i;n.subscribeScope.SubscribeModel={Email:"",Source:EmailSubscriptionSource.Unknown,FirstName:"",LastName:""};n.subscribeScope.ResponseCalled=!1;n.subscribeScope.DisplayEmailError=!1;n.subscribeScope.subscribeSuccess=!1;n.subscribeScope.subscribeSuccessShown=!1}function f(){var t=n.subscribeScope.IsEmailValid(n.subscribeScope.SubscribeModel.Email);t||(n.subscribeScope.SubscribeFormModal.SubscribeModel_Email.$invalid=!0,n.subscribeScope.SubscribeFormModal.SubscribeModel_Email.$error.email=!0,n.subscribeScope.SubscribeFormModal.$valid=!1)}t.call(this,i);n.subscribeScope=i;u(n.subscribeScope,r);n.subscribeScope.InputFocus=function(){n.subscribeScope.DisplayEmailError=!1};n.subscribeScope.openSubscribeModal=function(){n.subscribeScope.subscribeSuccessShown&&(n.subscribeScope.subscribeSuccess=!1,n.subscribeScope.ResponseCalled=!1,n.subscribeScope.DisplayEmailError=!1);n.subscribeScope.ShowValidation=!1;var t={AllowExit:!0,Model:n.subscribeScope,KeepLoaded:!1,UrlToLoad:"/api/subscribe/getSubscribeModal",CssClass:"full-size-modal-dialog"};n.subscribeScope.OpenDynamicModal("SubscribeModal",t,n.subscribeScope)};n.subscribeScope.closeSubscribeModal=function(){$("#SubscribeModal").trigger("close");n.subscribeScope.subscribeSuccess=!1};n.subscribeScope.subscribeSubmit=function(t){t===void 0&&(t=EmailSubscriptionSource.Unknown);n.subscribeScope.SubscribeFormModal=angular.element("form[name='SubscribeFormModal']").controller("form");f();n.subscribeScope.SubscribeFormModal.$valid?(n.subscribeScope.ResponseCalled=!1,n.subscribeScope.ShowValidation=!1,n.subscribeScope.SubscribeModel.Source=t,n.subscribeScope.ShowLoading(AVON.messages.spinner_subscribing),r.subscribeEmail(n.subscribeScope.SubscribeModel,$("form[name=SubscribeFormModal]"))):n.subscribeScope.ShowValidation=!0};n.subscribeScope.$on("SubscribeService.SubscribeResponse",function(t,i){n.subscribeScope.ResponseCalled||(n.subscribeScope.ResponseCalled=!0,i.ErrorCode===AjaxError.ValidationErrors?(n.subscribeScope.ProcessAjaxValidationErrors(i),n.subscribeScope.ShowValidation=!0):n.subscribeScope.subscribeSuccessShown||(u(n.subscribeScope,r),n.subscribeScope.subscribeSuccess=!0,n.subscribeScope.subscribeSuccessShown=!0,n.subscribeScope.SafeApply()))})}return __extends(i,t),i.$inject=["$scope","subscribeService"],i}(BaseAngularController);n.SubscribeController=t}(SubscribeModule||(SubscribeModule={}));app.controller("SubscribeController",SubscribeModule.SubscribeController),function(n){var t=function(t){function i(i,r,u,f,e){t.call(this,i,r);this.$scope=i;n.sweepstakesScope=i;n.sweepstakesScope.SocialShareService=f;n.sweepstakesScope.StatesAll=AVON.States;n.sweepstakesScope.SignUpForOffers=!0;n.sweepstakesScope.Over18Years=!1;n.sweepstakesScope.ReCaptchaEnabled=typeof grecaptcha!="undefined";n.sweepstakesScope.ReCaptchaCallback=function(){n.sweepstakesScope.ReCaptchaError="";n.sweepstakesScope.SafeApply()};r.ReCaptchaCallback=n.sweepstakesScope.ReCaptchaCallback;r.ReCaptchaError=n.sweepstakesScope.ReCaptchaError;n.sweepstakesScope.SubmitSweepstakesForm=function(){if(n.sweepstakesScope.ReCaptchaError="",n.sweepstakesScope.sweepstakesForm.$setSubmitted(),n.sweepstakesScope.IsEmailValid(n.sweepstakesScope.Email)||n.sweepstakesScope.sweepstakesForm.email.$setValidity("email",!1),n.sweepstakesScope.sweepstakesForm.$valid){var r={FirstName:i.FirstName,LastName:i.LastName,AddressLine1:i.AddressLine1,AddressLine2:i.AddressLine2,City:i.City,State:i.State,Zip:i.ZipCode,PhoneNumber:i.PhoneNumber,Email:i.Email,SignUpForOffers:i.SignUpForOffers,SweepsCode:AVON.SweepstakeCode,SweepstakeUrlName:AVON.SweepstakeUrlName},t=n.sweepstakesScope.ReCaptchaEnabled?grecaptcha.getResponse():"ReCaptchaDisabled";if(!t){n.sweepstakesScope.ReCaptchaError=AVON.messages.reCaptchaNotChecked;grecaptcha.reset();return}e.SubmitSweepstakesForm(r,t);n.sweepstakesScope.ShowLoading(AVON.messages.spinner_saving)}else n.sweepstakesScope.ReCaptchaError="",n.sweepstakesScope.ReCaptchaEnabled&&grecaptcha.reset(),i.ScrollIntoView($(".sweepstakes-form"),null,{duration:600,direction:"y",complete:null,offsetY:-100})};n.sweepstakesScope.$on("SweepstakesService.SubmitSweepstakesForm",function(t,i){i.ErrorCode===AjaxError.ValidationErrors&&($.each(i.ValidationErrors,function(t,i){i.FieldName.indexOf("ReCaptcha")>-1&&(n.sweepstakesScope.ReCaptchaError=AVON.messages.reCaptchaErrorMessage)}),n.sweepstakesScope.ReCaptchaEnabled&&grecaptcha.reset())});n.sweepstakesScope.$on("AddressesScope.ZipCodeDetails",function(t,i){i.IsValidZip&&(n.sweepstakesScope.State=i.State,n.sweepstakesScope.City=i.City);var r=i.IsValidZip;n.sweepstakesScope.sweepstakesForm.zipCode.$setValidity("validateZipcode",r);n.sweepstakesScope.SafeApply()});n.sweepstakesScope.CustomerInfoLoaded=!1;u.WhenReady().then(function(){var t=n.sweepstakesScope.Session.Customer,r;t&&t.IsLoggedIn&&(n.sweepstakesScope.FirstName=t.FirstName,n.sweepstakesScope.LastName=t.LastName,n.sweepstakesScope.PhoneNumber=t.Phone,n.sweepstakesScope.Email=t.Email,n.sweepstakesScope.Session.Customer.BillingAddress&&(n.sweepstakesScope.AddressLine1=t.BillingAddress.Address1,n.sweepstakesScope.AddressLine2=t.BillingAddress.Address2,n.sweepstakesScope.City=t.BillingAddress.City,r=_.find(n.sweepstakesScope.StatesAll,function(n){return n.Code===t.BillingAddress.State}),r&&(n.sweepstakesScope.State=r.Code),i.ZipCode=t.BillingAddress.Zip.substring(0,5)));n.sweepstakesScope.CustomerInfoLoaded=!0})}return __extends(i,t),i.$inject=["$scope","$window","sessionService","socialShareService","sweepstakesService"],i}(BaseAngularController);n.SweepstakesController=t}(SweepstakesModule||(SweepstakesModule={}));app.controller("SweepstakesController",SweepstakesModule.SweepstakesController),function(n){"use strict";var t=function(t){function i(i,r){t.call(this,i,r);this.$scope=i;n.videoShareScope=i;n.videoShareScope.account=AVON.brightCoveAccount;n.videoShareScope.player=n.videoShareScope.QueryString().player;n.videoShareScope.video=n.videoShareScope.QueryString().video;n.videoShareScope.videoLoaded=!1;n.videoShareScope.player||(n.videoShareScope.player=AVON.brightCoveDefaultPlayerId);this.loadScript(r)}return __extends(i,t),i.prototype.loadScript=function(t){var r=this,i=document.createElement("script");i.type="text/javascript";i.src="https://players.brightcove.net/"+n.videoShareScope.account+"/"+n.videoShareScope.player+"_default/index.min.js";document.getElementsByTagName("head")[0].appendChild(i);i.onerror=function(){n.videoShareScope.player!==AVON.brightCoveDefaultPlayerId&&(n.videoShareScope.player=AVON.brightCoveDefaultPlayerId,r.loadScript(t))};i.onload=function(){var i=document.getElementById("brightcovePlayerID"),r;i.setAttribute("data-account",n.videoShareScope.account);i.setAttribute("data-player",n.videoShareScope.player);i.setAttribute("data-video-id",n.videoShareScope.video);t.bc(i);r=videojs("brightcovePlayerID");r.ready(function(){var t=this;n.videoShareScope.videoLoaded=!0;document.getElementById("brightcovePlayerID").classList.remove("ng-hide");r.on("loadstart",function(){$("#videoTitle").text(t.mediainfo.name)});r.on("error",function(){var i=t.error();t.errorDisplay.hide();n.videoShareScope.RedirectToUrl("/error/error404",!0)})})}},i.$inject=["$scope","$window"],i}(BaseAngularController);n.VideoShareController=t}(VideoShareModule||(VideoShareModule={}));app.controller("VideoShareController",VideoShareModule.VideoShareController),function(n){var t=function(t){function i(i,r,u,f,e){t.call(this,i);n.welcomeBackScope=i;n.welcomeBackScope.$on("ModalShown",function(){n.welcomeBackScope.InitializeForm();_.delay(function(){$("#LoginModel_PasswordInput").focus()},200)});n.welcomeBackScope.ContinueAsGuest=function(){$("#WelcomeBack").trigger("close");r.$broadcast("WelcomeBackScope.ContinueAsGuest")};n.welcomeBackScope.Login=function(){if(n.welcomeBackScope.LoginForm.$valid===!1){n.welcomeBackScope.ShowValidation=!0;return}n.welcomeBackScope.ShowValidation=!1;n.welcomeBackScope.ShowLoading(AVON.messages.spinner_login);n.welcomeBackScope.LoginModel.ReturnUrl=n.welcomeBackScope.Url.Action("Index","Checkout");u.login(n.welcomeBackScope.LoginModel,$("form[name=LoginForm]"),n.welcomeBackScope)};n.welcomeBackScope.$on("LoginService.LoginResponse",function(t,i,r){i.ErrorCode===AjaxError.ValidationErrors?r==n.welcomeBackScope&&(n.welcomeBackScope.HideLoading(),n.welcomeBackScope.ShowValidation=!0,n.welcomeBackScope.ProcessAjaxValidationErrors(i),_.defer(function(){$.each(i.ValidationErrors,function(t,i){n.welcomeBackScope.LoginForm[i.FieldName]!==undefined&&(n.welcomeBackScope.LoginForm[i.FieldName].$invalid=!0);var u=$(".ErrorSummaryContainer .ValidationSummaryServer span a");e(u)(r)})})):(f.TrackEventItem({Type:TrackingEventType.LoginSuccessful}),(i.OpenModalId||i.IdToReplace&&i.IdToReplace!="WelcomeBack")&&$("#WelcomeBack").trigger("close"))});n.welcomeBackScope.ShowForgotPasswordForm=function(){n.welcomeBackScope.IsMobile?(n.welcomeBackScope.ShowLoading(AVON.messages.spinner_loading),u.convertEmail(n.welcomeBackScope.LoginModel.Email,"LoginService.ConvertEmailForWelcomeBack")):(n.welcomeBackScope.DisplayForgotPasswordForm=!0,n.welcomeBackScope.ShowValidation=!1)};n.welcomeBackScope.$on("LoginService.ConvertEmailForWelcomeBack",function(t,i){if(i.Data!=null){var r=n.welcomeBackScope.SignInPageUrl()+"/forgotpassword?tokenemail="+i.Data+"&returnurl="+n.welcomeBackScope.Url.Action("Index","Checkout")+"&mode="+n.welcomeBackScope.LoginModel.Mode;n.welcomeBackScope.RedirectToUrl(r)}});n.welcomeBackScope.InitializeForm=function(){var t=AVON.TempModalModel!=null?AVON.TempModalModel.CustomerType:6,i=AVON.TempModalModel!=null?AVON.TempModalModel.RepIdOnRecord:null;n.welcomeBackScope.RepSignIn=n.welcomeBackScope.isCustomerAttachedOrCookiedToRep()&&t==1;n.welcomeBackScope.ChangedRep=!n.welcomeBackScope.RepSignIn&&n.welcomeBackScope.isCustomerAttachedOrCookiedToRep()&&i!=n.welcomeBackScope.Session.Rep.Id&&n.welcomeBackScope.Session.Fundraiser==null;n.welcomeBackScope.SignInOnly=n.welcomeBackScope.IsAutoReplenishmentInCart()||n.welcomeBackScope.RepSignIn||n.welcomeBackScope.ChangedRep;n.welcomeBackScope.LoginModel={Email:AVON.TempModalModel!=null?AVON.TempModalModel.Email:"",Password:"",Mode:"WelcomeBack",ReturnUrl:""};n.welcomeBackScope.DisplayForgotPasswordForm=!1;_.defer(function(){n.welcomeBackScope.UpdateInlineWaterMark()},200)};$(document).on("click","#DisplayRegistrationModal",function(t){t.preventDefault();$("#LoginModal").trigger("close");n.welcomeBackScope.ShowLoading(AVON.messages.spinner_loading);var i={UrlToLoad:n.welcomeBackScope.SignInPageUrl()+"/registrationoverlay",AllowExit:!0,KeepLoaded:!1,Model:{Email:n.welcomeBackScope.LoginModel.Email}};$("#RegistrationModal").trigger("modal",i)})}return __extends(i,t),i.$inject=["$scope","$rootScope","loginService","trackingService","$compile"],i}(BaseAngularController);n.WelcomeBackController=t}(WelcomeBackModule||(WelcomeBackModule={}));app.controller("WelcomeBackController",WelcomeBackModule.WelcomeBackController),function(n){var t=function(t){function i(i,r,u,f,e,o){t.call(this,i,r,u);this.urlService=f;this.cdnService=e;this.$window=o;n.homePageUrl=AVON.LanguageCode==="es"?"/es/":"/"}return __extends(i,t),i.prototype.GetFacebookShareUrl=function(t,i,r){t===void 0&&(t=0);r===void 0&&(r=null);i||(i=this.$window.location.origin+this.$window.location.pathname);var u=n.homePageUrl+"socialmedia/share?url="+encodeURIComponent(i)+"&platform=facebook";return r&&(u+="&profileNumber="+encodeURIComponent(r)),t&&(u+="&repId="+encodeURIComponent(t.toString())),u},i.prototype.GetPinterestShareUrl=function(t,i,r,u,f){var e,o;return r===void 0&&(r=0),f===void 0&&(f=null),u||(u=this.$window.location.origin+this.$window.location.pathname),e=n.homePageUrl+"socialmedia/share?url="+encodeURIComponent(u)+"&platform=pinterest",f&&(e+="&profileNumber="+encodeURIComponent(f)),r&&(e+="&repId="+encodeURIComponent(r.toString())),i&&(o=void 0,o=this.urlService.IsUrlAbsolute(i)?i:this.cdnService.productImageXtraLarge(i),e+="&imageUrl="+encodeURIComponent(o)),t&&(e+="&description="+encodeURIComponent(this.TruncateIfNecessary(t.replace(/<\/?[^>]*>/g,""),500))),e},i.prototype.GetTumblrShareUrl=function(t,i,r,u,f){u===void 0&&(u=0);f===void 0&&(f=null);var e=null;return t&&(e=n.homePageUrl+"socialmedia/share?url="+encodeURIComponent(t)+"&platform=tumblr",f&&(e+="&profileNumber="+encodeURIComponent(f)),u&&(e+="&repId="+encodeURIComponent(u.toString())),e+="&name="+encodeURIComponent(i)+"&posttype=photo&description="+encodeURIComponent(this.TruncateIfNecessary(r.replace(/<\/?[^>]*>/g,"")))),e},i.prototype.GetTwitterShareUrl=function(t,i,r,u){i===void 0&&(i=0);u===void 0&&(u=null);r||(r=this.$window.location.origin+this.$window.location.pathname);var f=n.homePageUrl+"socialmedia/share?url="+encodeURIComponent(r)+"&platform=twitter";return u&&(f+="&profileNumber="+encodeURIComponent(u)),i&&(f+="&repId="+encodeURIComponent(i.toString())),f+("&description="+encodeURIComponent(this.TruncateIfNecessary(t)))},i.prototype.GetProductShareUrl=function(n,t,i){var u,f,r;return i===void 0&&(i=!0),u=null,n>0&&(r=this.urlService.Action(n.toString(),"Product"),f=AVON.LanguageCode,i&&(r=this.urlService.Action(t.formatUrlNugget()+"-"+n,"Product")),f=="es"&&r.indexOf("es/product")==-1&&(r=r.replace("product","es/product")),u="https://"+this.$window.location.host+r+"?s=s"),u},i.prototype.TruncateIfNecessary=function(n,t){return t===void 0&&(t=1024),n!=null&&n.length>t&&(n=n.substring(0,t-3)+"..."),n},i.$inject=["$rootScope","$http","$q","urlService","cdnService","$window"],i}(BaseAvonService);n.SocialShareService=t}(SocialShareServiceModule||(SocialShareServiceModule={}));app.service("socialShareService",SocialShareServiceModule.SocialShareService);WishListItem=function(){function n(n,t,i,r){this.ProductId=n;this.Sku=t;this.AutoReplenishmentFrequency=i;this.Availability=r}return n}(),function(n){(function(n){n[n.MyFavourites=0]="MyFavourites";n[n.MyRecommendation=1]="MyRecommendation"})(n.WishListMailingOption||(n.WishListMailingOption={}));var i=n.WishListMailingOption,t=function(n){function t(t,i,r,u){var f=this;n.call(this,t,i,r);this.$rootScope=t;this.$http=i;this.$q=r;this.productDic={};u.WhenReady().then(function(){f.RefreshWishListDic()})}return __extends(t,n),t.prototype.AddToWishList=function(n){var t=this,r,i;return this.$rootScope.Session&&this.$rootScope.Session.Customer.IsLoggedIn&&(i=n,i=this.DeduplicateVariants(i,this.$rootScope.Session.Customer.WishList.Products),r=this.PostJson("/api/wishlist/add",i).success(function(n){n&&!!n.Data&&(t.$rootScope.Session.Customer.WishList.Products=t.$rootScope.Session.Customer.WishList.Products.concat(n.Data),t.RefreshWishListDic(),t.$rootScope.SafeApply())}).error(function(){})),r},t.prototype.UpdateProductVariantInWishList=function(n,t){var i,r;return this.$rootScope.Session&&this.$rootScope.Session.Customer.IsLoggedIn&&(r={wishListProductId:n,sku:t},i=this.postAndBroadcast("/api/wishlist/updateproductvariant",r,"WishListService.UpdateProductInWishList")),i},t.prototype.UpdateProductFrequencyInWishList=function(n,t){var i,r;return this.$rootScope.Session&&this.$rootScope.Session.Customer.IsLoggedIn&&(r={wishListProductId:n,autoReplenishmentFrequency:t},i=this.postAndBroadcast("/api/wishlist/updateproductfrequency",r,"WishListService.UpdateProductFrequencyInWishList")),i},t.prototype.UpdateProductCommentInWishList=function(n,t){var i,r;return this.$rootScope.Session&&this.$rootScope.Session.Customer.IsLoggedIn&&(r={wishListProductId:n,comment:t},i=this.postAndBroadcast("/api/wishlist/updateproductcomment",r,"WishListService.UpdateProductCommentInWishList")),i},t.prototype.postAndBroadcast=function(n,t,i,r){var u=this;return this.PostJson(n,t,r).success(function(n){n&&u.$rootScope.$broadcast(i,n)}).error(function(n){u.$rootScope.$broadcast(i,n)})},t.prototype.CreateSharedWishList=function(n,t,i){var r=this,u,f;return this.$rootScope.Session&&this.$rootScope.Session.Customer.IsLoggedIn&&(f={wishListProductIds:n,shareType:t},u=this.PostJson("/api/wishlist/createsharedwishlist",f).success(function(n){n&&r.$rootScope.$broadcast("WishListService.CreateSharedWishList",n,t,i)}).error(function(n){r.$rootScope.$broadcast("WishListService.CreateSharedWishList",n,t,i)})),u},t.prototype.ShareWishListByEmail=function(n,t,i,r,u,f,e){var o,s;return this.$rootScope.Session&&this.$rootScope.Session.Customer.IsLoggedIn&&(s={recipients:n,sender:t,recommendTo:i,description:r,sendMeCopy:u,wishListProductIds:f},o=this.postAndBroadcast("/api/wishlist/sharewishlistbyemail",s,"WishListService.ShareWishListByEmail",e)),o},t.prototype.RemoveFromWishList=function(n){var i=this,r,t,u;return this.$rootScope.Session&&this.$rootScope.Session.Customer.IsLoggedIn&&(t=this.$rootScope.Session.Customer.WishList.Products,u={wishListProductId:n},r=this.PostJson("/api/wishlist/remove",u).success(function(r){if(r){var u=_.find(t,function(t){return t.WishlistProductId==n});t=_.without(t,u);i.$rootScope.Session.Customer.WishList.Products=t;i.RefreshWishListDic();i.$rootScope.SafeApply()}}).error(function(){})),r},t.prototype.RemoveSelectedProductsFromWishList=function(n){var r=this,u,t,i;return this.$rootScope.Session&&this.$rootScope.Session.Customer.IsLoggedIn&&(t=this.$rootScope.Session.Customer.WishList.Products,i=n,i=this.DeduplicateVariants(i,this.$rootScope.Session.Customer.WishList.Products),u=this.PostJson("/api/wishlist/removeselectedproducts",i).success(function(n){n&&(_.each(i,function(n){var i=_.find(t,function(t){return t.Variant.Sku===n.Sku});t=_.without(t,i)}),r.$rootScope.Session.Customer.WishList.Products=t,r.RefreshWishListDic(),r.$rootScope.SafeApply())}).error(function(){})),u},t.prototype.RemoveAllVariantsFromWishList=function(n){var t=this,i,r;return this.$rootScope.Session&&this.$rootScope.Session.Customer.IsLoggedIn&&(r={productId:n},i=this.PostJson("/api/wishlist/removeallvariants",r).success(function(i){i&&(t.removeAllVariants(n),t.$rootScope.SafeApply())}).error(function(){})),i},t.prototype.DeduplicateVariants=function(n,t){return _.filter(n,function(n){return!_.findWhere(t.map(function(n){return n.Variant}),n)})},t.prototype.removeAllVariants=function(n){for(var i=this.$rootScope.Session.Customer.WishList.Products,t=0;t<i.length;t++)i[t].Variant.ProductId==n&&(i.splice(t,1),t--);this.RefreshWishListDic()},t.prototype.CheckIfAnyVariantExistsInWishList=function(n){return this.$rootScope.Session&&this.$rootScope.Session.Customer.IsLoggedIn?!!this.productDic[n]:!1},t.prototype.CheckIfAllVariantsExistInWishList=function(n){var t,u,i,r,f;if(this.$rootScope.Session&&this.$rootScope.Session.Customer.IsLoggedIn)if(u=this.$rootScope.Session.Customer.WishList,t=!0,u.Products){for(i=0,r=n;i<r.length;i++)if(f=r[i],!this.CheckIfExactVariantExistsInWishList(f)){t=!1;break}}else t=!1;else t=!1;return t},t.prototype.GetWishListProduct=function(n,t){if(this.$rootScope.Session&&this.$rootScope.Session.Customer.WishList){var i=this.$rootScope.Session.Customer.WishList;return _.find(i.Products,function(i){return i.Variant.ProductId==n&&i.Variant.Sku==t})}return null},t.prototype.CheckIfExactVariantExistsInWishList=function(n){var t=!1,i;return this.$rootScope.Session&&this.$rootScope.Session.Customer.IsLoggedIn&&(i=this.GetWishListProduct(n.ProductId,n.Sku),i&&(t=!0)),t},t.prototype.RefreshWishListDic=function(){var n=this;this.productDic={};this.$rootScope.Session&&this.$rootScope.Session.Customer.IsLoggedIn&&_.each(this.$rootScope.Session.Customer.WishList.Products,function(t){n.productDic[t.Variant.ProductId]=t})},t.$inject=["$rootScope","$http","$q","sessionService"],t}(BaseAvonService);n.WishListService=t}(WishListServiceModule||(WishListServiceModule={}));app.service("wishListService",WishListServiceModule.WishListService),function(n){var t=function(t){function i(i,r,u,f,e,o,s,h){var c=this,l;t.call(this,i,u);this.$scope=i;this.wishListService=r;this.selectedProductsToShare=[];n.wishListScope=i;n.wishListScope.ErrorMessageText="";n.wishListScope.WishListSharedCustomerEntity=AVON.WishListSharedCustomerEntity;n.wishListScope.CustomerWishList=AVON.CustomerWishList;n.wishListScope.LanguageId=AVON.languageId;o.WhenReady().then(function(){n.wishListScope.WishList=AVON.SharedWishList?AVON.SharedWishList:AVON.CustomerWishList;n.wishListScope.WishList&&(n.wishListScope.ToggleSelectShareAll(),c.deselectInactiveVariants(n.wishListScope.WishList.Products),c.resetAddingToBagStatus(n.wishListScope.WishList.Products),c.originalItems=angular.copy(n.wishListScope.WishList.Products))});n.wishListScope.starRange=_.range(5);n.wishListScope.AddToWishList=function(n){var t=[new WishListItem(n.Id,null,null,CanBuy.Available)];c.wishListService.AddToWishList(t)};n.wishListScope.GetProductSku=function(n){return!n.Variant.Sku&&n.Product.VariantGroups&&n.Product.VariantGroups.length===1&&n.Product.VariantGroups[0].Variants&&n.Product.VariantGroups[0].Variants.length===1?n.Product.VariantGroups[0].Variants[0].Sku:n.Variant.Sku};n.wishListScope.AddToBag=function(t,r){var u,e;if(t.$setSubmitted(),t.$valid)if(u=new AddBagItem,u.Quantity=r.Quantity>0?r.Quantity:1,u.Id=r.Variant.ProductId.toString(),u.Sku=n.wishListScope.GetProductSku(r),u.AutoReplenishmentMultiBuy=r.Product.AutoReplenishmentMultibuy,u.AutoReplenishmentFrequency=r.Product.AutoReplenishmentFrequencyList&&r.Product.AutoReplenishmentFrequencyList.length===1&&r.Product.Availability===CanBuy.AutoReplenishmentOnly?r.Product.AutoReplenishmentFrequencyList[0]:r.Variant.AutoReplenishmentFrequency,e=n.wishListScope.WishListSharedCustomerEntity?TrackingAddToCartType.WishListShared:TrackingAddToCartType.WishListPersonal,n.wishListScope.IsMobile){var s=1e3,o=_.throttle(function(n){i.SafeApply(function(){r.AddingToBagStatus=n});n==AddingToBagStatus.Added&&_.delay(function(){i.SafeApply(function(){r.AddingToBagStatus=AddingToBagStatus.None})},s)},1e3);o(AddingToBagStatus.Adding);f.addItemToBag(u,!0,e).then(function(){o(AddingToBagStatus.Added)})}else n.wishListScope.LoaderModal(AVON.messages.spinner_addingTextOnly),f.addItemToBag(u,!1,e)};n.wishListScope.AddSubscriptionToBag=function(t,r){n.wishListScope.ErrorMessageText=n.wishListScope.GetErrorMessageText(r);i.AddToBag(t,r)};n.wishListScope.$on("BagService.AddToBagSuccess",function(t,i){for(var r,s,u,h,e=[],c=[],f=0,o=i.ItemsAdded;f<o.length;f++)r=o[f],s=_.find(n.wishListScope.WishList.Products,function(t){return t.Variant.ProductId.toString()==r.Id&&n.wishListScope.GetProductSku(t)==r.Sku}),e.push(s),c.push(r.Sku);u=angular.copy(e[0]);u.Quantity||(u.Quantity=1);n.wishListScope.IsMobile&&(h={AllowExit:!0,Model:u,KeepLoaded:!0},angular.element("#AddedToBagModal").trigger("modal",h))});n.wishListScope.RemoveFromWishList=function(t){var i=c.wishListService.RemoveFromWishList(t.WishlistProductId);i.success(function(i){if(i){n.wishListScope.WishList.Products=_.without(n.wishListScope.WishList.Products,t);var r=c.selectedProductsToShare.indexOf(t);r>-1&&c.selectedProductsToShare.splice(r,1)}})};n.wishListScope.GetErrorMessageText=function(n){return n.Product.AutoReplenishmentPrice>0&&(n.Product.Availability==CanBuy.AutoReplenishmentOnly||n.Product.Availability==CanBuy.Available)&&n.Variant.AutoReplenishmentFrequency==undefined?AVON.ErrorMessagesLocalized.Frequency:AVON.ErrorMessagesLocalized[n.Product.VariantType]};n.wishListScope.GetProductLink=function(t){return t&&t.IsActive?n.wishListScope.Url.Action("Details","Product")+"/"+t.Name.formatUrlNugget()+"-"+t.Id:""};n.wishListScope.GetVariantBySku=function(n,t){return c.getVariantBySku(n,t)};n.wishListScope.GetVariantSelectPlaceholderText=function(n,t,i,r){return(n?t:i)+" "+AVON.VariantTypesLocalized[r]};n.wishListScope.VariantChanged=function(t){n.wishListScope.ErrorMessageText=n.wishListScope.GetErrorMessageText(t);c.wishListService.UpdateProductVariantInWishList(t.WishlistProductId,t.Variant.Sku)};n.wishListScope.AutoReplenishmentFrequencyChanged=function(t){n.wishListScope.ErrorMessageText=n.wishListScope.GetErrorMessageText(t);c.wishListService.UpdateProductFrequencyInWishList(t.WishlistProductId,t.Variant.AutoReplenishmentFrequency)};n.wishListScope.UpdateComment=function(t,i){if(t.commentBox.$valid){n.wishListScope.ShowLoading(AVON.messages.spinner_saving);c.wishListService.UpdateProductCommentInWishList(i.WishlistProductId,i.Comment);var r=_.find(c.originalItems,function(n){return n.WishlistProductId==i.WishlistProductId});r&&(r.Comment=i.Comment);t.$setPristine()}};n.wishListScope.$on("WishListService.UpdateProductInWishList",function(){n.wishListScope.HideLoading()});n.wishListScope.CancelItem=function(n,t){var i=_.find(c.originalItems,function(n){return n.WishlistProductId==t.WishlistProductId});i&&(t.Comment=i.Comment);n.$setPristine()};n.wishListScope.CommentChanged=function(n){c.originalItems[n.WishlistProductId]||(c.originalItems[n.WishlistProductId]=angular.copy(n))};n.wishListScope.IsSelectedToShare=function(n){return c.selectedProductsToShare.indexOf(n)>-1};n.wishListScope.ToggleSelectionToShare=function(t){var i=c.selectedProductsToShare.indexOf(t);i>-1?c.selectedProductsToShare.splice(i,1):c.selectedProductsToShare.push(t);n.wishListScope.ShareAllSelected=!1};n.wishListScope.ToggleSelectShareAll=function(){c.selectedProductsToShare=n.wishListScope.ShareAllSelected?[]:_.filter(n.wishListScope.WishList.Products,function(t){var i=t;return n.wishListScope.IsAvailable(i)});n.wishListScope.ShareAllSelected=!n.wishListScope.ShareAllSelected};n.wishListScope.GetButtonToDisplay=function(t){return n.wishListScope.ShowFindARepresentativeHtmlElements(t)?WishListItemActionButton.FindARepresentative:c.IsAvailableSoon(t)?WishListItemActionButton.NotifyMe:c.isAutoReplenishProduct(t)?WishListItemActionButton.AddSubscriptionToBag:t.Product.Availability===CanBuy.NoLongerAvailable||t.Product.Availability===CanBuy.NotForIndividualSale?WishListItemActionButton.Remove:WishListItemActionButton.AddToBag};n.wishListScope.ShowFindARepresentativeHtmlElements=function(n){return n.Product.AttachedOnlyProduct&&!c.$scope.isCustomerAttachedOrCookiedToRep()};n.wishListScope.IsAvailable=function(t){return!n.wishListScope.IsNoLongerAvailable(t)};n.wishListScope.IsNoLongerAvailable=function(n){return c.isNoLongerAvailable(n)};n.wishListScope.IsVariantAvailableSoon=function(n){return n.Availability==CanBuy.AvailableSoon};n.wishListScope.IsOptionDisabled=function(n){return n==null||n.Availability==CanBuy.Available||n.Availability==CanBuy.AvailableSoon||n.Availability==CanBuy.AutoReplenishmentOnly?!1:!0};n.wishListScope.ShareWishList=function(t){var i=[],r=[],u,f,e,h,l,o,a,v,y;if(c.selectedProductsToShare.length===0&&n.wishListScope.ToggleSelectShareAll(),c.selectedProductsToShare.length>0)for(u=0,f=c.selectedProductsToShare;u<f.length;u++)e=f[u],i.push(e.WishlistProductId),r.push(e.Variant.Sku);else _.each(n.wishListScope.WishList.Products,function(n){i.push(n.WishlistProductId);r.push(n.Variant.Sku)});t===WishListShareType.Email?(h={WishListProductIdsToShare:i,TrackingItems:r},l={AllowExit:!0,Model:h,KeepLoaded:!0,UrlToLoad:null},$("#EmailWishListModal").trigger("modal",l),_.delay(function(){$("#EmailWishListModal").scrollintoview({duration:0,direction:"both",complete:null,offsetY:0})},200)):(n.wishListScope.ShowLoading(AVON.messages.spinner_saving),o=null,t!==WishListShareType.Email&&(a="menubar=no,toolbar=no,width=640,height=550,status=no,scrollbars=yes,resize=yes",v="AvonPop",o=window.open("",v,a)),c.wishListService.CreateSharedWishList(i,t,o),y={Type:TrackingEventType.WishListShared,Data:{trackingItems:r,shareMethod:c.GetShareTypeName(t)}},s.TrackEventItem(y))};n.wishListScope.$on("WishListService.CreateSharedWishList",function(t,i,r,u){if(n.wishListScope.HideLoading(),i.ErrorCode===AjaxError.None){if(i.Data){n.wishListScope.ShareWishListUrl=i.Data;var f=n.wishListScope.HomePageUrl+"socialmedia/sharewishlist?repId="+n.wishListScope.Session.Rep.Id+"&url="+encodeURIComponent(n.wishListScope.ShareWishListUrl)+"&platform=";switch(r){case WishListShareType.Facebook:u&&(u.location=f+"facebook",u.focus());break;case WishListShareType.Twitter:u&&(u.location=f+"twitter",u.focus())}}}else u.close()});n.wishListScope.CopyToClipboard=function(){n.wishListScope.SharedWishListUrlCopied=!0};n.wishListScope.$on("ModalClosed",function(){n.wishListScope.SharedWishListUrlCopied=!1;AVON.TempModalModel=null});n.wishListScope.NotifyMe=function(n){for(var f,i,r="",t=0,u=n.Product.VariantGroups;t<u.length;t++)if(f=u[t],i=_.find(f.Variants,function(t){return t.Sku==n.Variant.Sku}),i){r=i.Fsc;break}c.openNotifyMeModal(n.Variant.ProductId,r)};l=30;n.wishListScope.SortingCriteria="RecentlyAdded";n.wishListScope.NumberOfProductsShown=l;n.wishListScope.ShowMoreItems=function(){n.wishListScope.NumberOfProductsShown+=l};n.wishListScope.ShowSignIn=function(){n.wishListScope.IsMobile?n.wishListScope.RedirectToUrl(n.wishListScope.SignInPageUrl("wishlist")):h.ShowLoginModal("wishlist")};n.wishListScope.OrderByComparator=function(t){var i;switch(n.wishListScope.SortingCriteria){case"Name":i=t.Product.Name;break;case"Rating":i=t.Product.Rating?t.Product.Rating:0;break;case"RecentlyAdded":i=new Date(t.DateAdded);break;default:i=t.DateAdded}return i};n.wishListScope.ReverseSorting=function(){switch(n.wishListScope.SortingCriteria){case"Rating":case"RecentlyAdded":return!0;default:return!1}};n.wishListScope.SortWishlist=function(t){n.wishListScope.SortingCriteria=n.wishListScope.SortingCriteria=n.wishListScope.SetDefaultSortingOption?"RecentlyAdded":t;n.wishListScope.SetDefaultSortingOption=!1};n.wishListScope.SetDefaultSort=function(){n.wishListScope.SetDefaultSortingOption=!0};n.wishListScope.TempModalModel=function(){return AVON.TempModalModel};n.wishListScope.SocialShareService=e;n.wishListScope.IsVariantShade=function(n){return n===1?!0:!1};n.wishListScope.ShowPromotionOverlay=function(n){var i=$(angular.element(n.currentTarget)[0]),t,r,u;if(i.siblings("div").addClass("active"),t=i.siblings(".Overlay.active"),t.width(i.width()-(t.outerWidth(!0)-t.width())),r=$(".NavBar"),r.length>0){var e=r.offset().left+r.innerWidth(),o=t.offset().left+t.innerWidth(),f=o-e;f>0&&t.css({"margin-left":-f})}u=i.siblings(".RotatedCaret45.active");u.css({"margin-left":i.width()/2-u.width()/2})};n.wishListScope.HidePromotionOverlay=function(n){var t=$(angular.element(n.currentTarget)[0]);t.children(".active").removeClass("active")}}return __extends(i,t),i.prototype.IsAvailableSoon=function(n){var t=null,i;return n.Variant.Sku&&(i=_.flatten(_.pluck(n.Product.VariantGroups,"Variants")),t=_.find(i,function(t){return t.Sku===n.Variant.Sku})),n.Product.Availability==CanBuy.AvailableSoon||t&&t.Availability==CanBuy.AvailableSoon},i.prototype.openNotifyMeModal=function(t,i){var r=n.wishListScope.HomePageUrl+"product/notifymemodal?pfid="+t,u;i&&(r+="&fsc="+i);n.wishListScope.ShowLoading(AVON.messages.spinner_loading);u={AllowExit:!0,Model:null,KeepLoaded:!1,UrlToLoad:r};$("#ContentModal").trigger("modal",u)},i.prototype.isAutoReplenishProduct=function(n){return n.Product.Availability===CanBuy.AutoReplenishmentOnly?!0:!1},i.prototype.GetShareTypeName=function(n){switch(n){case 1:return"facebook";case 2:return"twitter";default:return"email"}},i.prototype.isAnyVariantAvailable=function(n){var t=_.flatten(n.VariantGroups),i=_.flatten(_.pluck(t,"Variants")),r=_.find(i,function(n){return n.Availability===CanBuy.Available});return r?!0:!1},i.prototype.isNoLongerAvailable=function(n){return n&&(n.Product.Availability===CanBuy.NoLongerAvailable||n.Product.Availability===CanBuy.NotAvailableOnTheOnlineStore||!this.isAnyVariantAvailable(n.Product)||n.Variant.Availability===CanBuy.NoLongerAvailable)},i.prototype.isAvailable=function(n){return!this.isNoLongerAvailable(n)},i.prototype.getVariantBySku=function(n,t){for(var f,i=null,r=0,u=t.VariantGroups;r<u.length;r++)if(f=u[r],i=_.find(f.Variants,function(t){return t.Sku==n}),i)break;return i},i.prototype.resetAddingToBagStatus=function(n){for(var r,t=0,i=n;t<i.length;t++)r=i[t],r.AddingToBagStatus=AddingToBagStatus.None},i.prototype.deselectInactiveVariants=function(n){for(var i=0,u=n;i<u.length;i++){var t=u[i],r=this.getVariantBySku(t.Variant.Sku,t.Product),f=!r||r.Availability==CanBuy.NoLongerAvailable||r.Availability==CanBuy.NotAvailableOnTheOnlineStore;this.isAvailable(t)&&(!r||f&&this.isAnyVariantAvailable(t.Product))&&(t.Variant.Sku="")}},i.$inject=["$scope","wishListService","$window","bagService","socialShareService","sessionService","trackingService","loginModalService"],i}(BaseAngularController);n.WishListController=t}(WishListModule||(WishListModule={}));app.controller("WishListController",WishListModule.WishListController),function(n){var i=function(){function n(){}return n}(),t;n.WishListEmailShareModalModel=i;t=function(n){function t(t,i,r,u,f){var e=this;n.call(this,t,i);this.$scope=t;t.DescriptionMaxLength=500;u.WhenReady().then(function(){e.userAccountFirstAndLastName=t.Session.Customer.FirstName+" "+t.Session.Customer.LastName;t.FromName||(t.FromName=e.userAccountFirstAndLastName)});this.formInitialization();t.InputFocus=function(){e.resetFormValidation()};t.SendEmailShare=function(n){if(e.resetFormValidation(),t.emailShareForm.$setSubmitted(),t.emailShareForm.$valid){var i=AVON.TempModalModel.TrackingItems,u=AVON.TempModalModel.WishListProductIdsToShare,o=r.ShareWishListByEmail(e.$scope.Recipients,e.$scope.FromName,e.$scope.RecommendTo,e.$scope.Description,e.$scope.SendMeCopy,u,$("form[name=emailShareForm]")),s={Type:TrackingEventType.WishListShared,Data:{trackingItems:i,shareMethod:"email"}};f.TrackEventItem(s);t.ShowLoading(AVON.messages.spinner_loading);t.CloseModal(n);o.then(function(){t.HideLoading();angular.element("#WishListEmailSentConfirmationModal").trigger("modal",{AllowExit:!0,KeepLoaded:!0,UrlToLoad:null})})}else(!e.$scope.Recipients||t.emailShareForm.$error.validateEmailList)&&(t.ShowValidation=!0,t.recipientInputError=!0,t.ScrollIntoView($("#EmailWishListModal"),null,{duration:600,direction:"y",complete:null,offsetY:-30}))};t.CloseModal=function(n){e.resetFormValidation();angular.element(n.currentTarget).closest("[modal]").trigger("close")};t.ContinueShopping=function(n){t.ShowLoading(AVON.messages.spinner_loading);t.CloseModal(n);t.RedirectToUrl(t.HomePageUrl)};t.$on("ModalClosed",function(){e.formInitialization()})}return __extends(t,n),t.prototype.resetFormValidation=function(){this.$scope.recipientInputError=!1;this.$scope.ShowValidation=!1},t.prototype.formInitialization=function(){this.$scope.Recipients="";this.$scope.RecommendTo=WishListServiceModule.WishListMailingOption.MyFavourites;this.$scope.FromName=this.userAccountFirstAndLastName;this.$scope.Description="";this.$scope.SendMeCopy=!1;this.$scope.emailShareForm&&this.$scope.emailShareForm.$setPristine();this.resetFormValidation()},t.$inject=["$scope","$window","wishListService","sessionService","trackingService"],t}(BaseAngularController);n.WishListEmailShareController=t}(WishListEmailShareModule||(WishListEmailShareModule={}));app.controller("WishListEmailShareController",WishListEmailShareModule.WishListEmailShareController),function(n){var t=function(){function t(t){var i=this;this.$rootScope=t;this.link=function(t,r){var u=$(r),e,f;u.addClass("Accordion");e=u.find("li > a,li > button,li > span > a,li > span > button, .AccordionHeader");e.on("click",i.OnElementClick);f=u.children(".DefaultSelected").first();f.length&&i.selectItem(f);t.$on(n.AccordionElementDirective.ClickEventName,function(n,t){i.selectItem(t)})};this.selectItem=function(n){var r={accordion:i,menuItem:n},t="";n.hasClass("MenuSelected")?(n.removeClass("MenuSelected"),n.children("ul,div").slideUp(),n.find(".PostionClass").removeClass("PostionAbsolute"),t="Accordion.ItemClosed"):(n.siblings("li.MenuSelected").each(function(n,t){var i=$(t);i.removeClass("MenuSelected");i.children("ul,div").slideUp();i.find(".PostionClass").removeClass("PostionAbsolute");i.scrollintoview()}),n.children().length>1&&n.addClass("MenuSelected"),n.children("ul,div").slideDown(),_.delay(function(){n.find(".PostionClass").addClass("PostionAbsolute")}),t="Accordion.ItemSelected");i.$rootScope.$broadcast(t,r)};this.OnElementClick=function(n){var t=$(n.currentTarget).closest("li");t.hasClass("Disabled")===!1&&i.selectItem(t)};this.restrict="A";this.compile=null}return t.Factory=function(){var n=function(n){return new t(n)};return n.$inject=["$rootScope"],n},t}();n.AccordionDirective=t}(AccordionModule||(AccordionModule={}));app.directive("accordion",AccordionModule.AccordionDirective.Factory()),function(n){var t=function(){function n(t){this.$rootScope=t;this.link=function(t,i){var r=i.children("a, button");r.on("click",function(i){var r=$(i.currentTarget).closest("li");t.$emit(n.ClickEventName,r)})};this.restrict="A";this.compile=null}return n.Factory=function(){var t=function(t){return new n(t)};return t.$inject=["$rootScope"],t},n.ClickEventName="AccordionModule.AccordionElementClickEvent",n}();n.AccordionElementDirective=t}(AccordionModule||(AccordionModule={}));app.directive("accordionElement",AccordionModule.AccordionElementDirective.Factory()),function(n){var t=function(){function n(n,t,i){return{restrict:"A",link:function(n,t){_.defer(function(){angular.element(t).ellipsis();angular.element(t).html().indexOf("...")<0&&angular.element(t).parent().find(".ReadMoreLink").hide();angular.element(t).html().indexOf("...")>-1&&angular.element(t).html(angular.element(t).html().replace("...",""));i.$broadcast("EllipsisComplete")})}}}return n.$inject=["$sce","$timeout","$rootScope"],n}();n.HtmlEllipsisDirective=t}(HtmlEllipsisModule||(HtmlEllipsisModule={}));app.directive("htmlEllipsis",["$sce","$timeout","$rootScope",HtmlEllipsisModule.HtmlEllipsisDirective]);app.directive("autofill",Autofill),function(n){var t=function(){function n(){this.restrict="A";this.link=function(n,t){$(t).focus();$("body").on("FocusReady",function(){$(t).focus()})}}return n.instance=function(){return function(){return new n}},n}();n.AutoFocusDirective=t}(AutoFocusModule||(AutoFocusModule={}));app.directive("autofocus",AutoFocusModule.AutoFocusDirective.instance()),function(n){var t=function(){function n(n,t,i){return{restrict:"A",priority:10,link:function(r,u){var f=$(u),s=r.innerForm?!0:!1,e=r,h,c,o,l;s&&(e=r.innerForm);u.prop("method","POST");f.attr("autocomplete")?f.attr("autocomplete")=="on"&&(this.watchAutoComplete=function(){$("input[ng-model],input[data-ng-model]",f).not("input[type=hidden],input[type=checkbox]").each(function(){if(angular.element(this).attr("type")!=="checkbox"){var n=$(this).val(),t=angular.element(this).controller("ngModel");t.$viewValue!=n&&t.$setViewValue(n)}});t(this.watchAutoComplete,350)},t(this.watchAutoComplete,100)):(f.attr("autocomplete","off"),f.find("input").attr("autocomplete","off"));u.on("submit",function(){$("input[ng-model]",f).each(function(){angular.element(this).attr("type")!=="checkbox"&&angular.element(this).controller("ngModel").$setViewValue($(this).val())})});f.attr("novalidate","novalidate");h=function(){e.ShowValidation=!1;e.ServerInvalid=!1;e.ServerErrors&&(e.ServerErrors=[]);s&&(e.innerForm.ShowValidation&&(e.innerForm.ShowValidation=!1),e.innerForm.ServerInvalid&&(e.innerForm.ServerInvalid=!1),e.innerForm.ServerErrors&&(e.innerForm.ServerErrors=[]));var n=u.inheritedData("$formController");angular.forEach(n,function(n,t){_.isUndefined(n)===!1&&_.isEmpty(n)===!1&&_.has(n,"$invalid")&&n.$invalid&&o[t].$setValidity("server",!0)});r.SafeApply();i.$broadcast("FormDirective.HidValidation",e)};f.on("focus","input,select,textarea",function(){$(this).is(":input[type=button], :input[type=submit], :input[type=reset]")||h()});f.on("click",".InputContainer_checkbox",function(){h()});f.on("change","select",function(){h()});f.on("keydown",function(n){var i=n.charCode||n.keyCode||0,t;i==13&&$(n.target).is("select")&&(t=f.find("input[type='submit']"),t.length&&(t.focus(),t.trigger("click")))});c=s?"innerForm.ShowValidation":"ShowValidation";r.$watch(c,function(n){if(n?(f.addClass("ShowValidation"),_.delay(function(){var n=$(".ValidationError:Visible").first();n.length&&n.scrollintoview({duration:400,direction:"both",complete:null,offsetY:-80})},50)):f.removeClass("ShowValidation"),f[0].getAttribute("name")!=="FacebookLoginForm"){var t=f.find(".ValidationType_required").length;r.RequiredInvalid=t>0}});o=u.inheritedData("$formController");o.ServerErrors={};o&&(l=s?"innerForm.ServerErrors":"ServerErrors",r.$watch(l,function(t){_.isUndefined(t)||t.length==0||(e.ServerInvalid=t.length>0,angular.forEach(t,function(t){var i=t.FieldName,r;i=i.replaceAll(".","_");r=t.Problem.trim();r&&(r=n.trustAsHtml(r),s?e.ServerErrors[i]={$invalid:!0,message:r,FieldName:null,Problem:null}:o.ServerErrors[i]={$invalid:!0,message:r},o[i]&&o[i].$setValidity("server",!1))}))}))}}}return n.$inject=["$sce","$timeout","$rootScope"],n}();n.AvonFormDirective=t}(AvonFormModule||(AvonFormModule={}));app.directive("avonForm",["$sce","$timeout","$rootScope",AvonFormModule.AvonFormDirective]);onBagChangeQtyThrottled=_.throttle(function(n,t,i,r){var e=r.$dirty,o=r.$valid,u,f;e&&o&&(u=$.parseJSON(i.campaign),f=$.parseJSON(i.item),n.UpdateCart(u,f),n.SafeApply(),$(t).is(":focus")&&$(t).val().length>0&&$(t).blur())},1e3,{leading:!1});app.directive("bagQtyValid",BagQtyValidDirective);app.directive("bagQtyChange",BagQtyChangeDirective);app.directive("caretFix",CaretFix),function(n){var t=function(){function t(t,i,r,u,f){var e=this,o,s,h;this.$rootScope=t;this.$scope=i;this.$element=r;this.$compile=u;this.isCurrentlyScrolling=!1;i.container=$(r);i.isProductCarousel=!1;o=i.container.closest(".ProductCarousel");o.length&&(i.isProductCarousel=!0);this.scrollContents=i.container.find(".ScrollContents");i.wrapLeft=i.container.find(".WrapLeft");i.wrapRight=i.container.find(".WrapRight");i.currentIndex=0;i.clickEnabled=!0;i.slides=null;i.dragging=!1;i.hovered=!1;i.gutterSize=40;i.deltaXTimesVelocityXNextSlideThreshold=10;i.dragMultiply=+(i.container.attr("drag-multiply")||1.4);i.scrollableSlideOffsetPercent=i.container.attr("scrollable-slide-offset-percent")||0;i.singleSlideAdvance=i.container.attr("single-slide-advance")==="true";i.snapEnabled=i.container.attr("snap")!=="false";i.autoAdvanceSeconds=+(i.container.attr("auto-advance-seconds")||0);i.slidesVisibleRequested=+(i.container.attr("slides-visible")||1);i.slidesVisibleTabletRequested=+(i.container.attr("slides-visible-tablet")||i.slidesVisibleRequested);i.slidesVisibleMobileRequested=+(i.container.attr("slides-visible-mobile")||i.slidesVisibleRequested);i.minSlideWidth=+(i.container.attr("min-slide-width")||0);i.wrapRequested=(i.container.attr("wrap")||"true")=="true";i.wrap=!1;i.imagesSlideLoaded=0;i.IsPanEnabled=f.panEnabled=="false"?!1:!0;i.container.on("update",function(){i.update()});this.scrollContents.bind("transitionend webkitTransitionEnd oTransitionEnd MSTransitionEnd",function(){e.onSlideTransitionEnd()});i.mouseEnter=function(){i.hovered=!0;e.stopAutoAdvanceTimer(!1)};i.mouseLeave=function(){i.hovered=!1;i.resetAutoAdvanceTimer()};i.onClick=function(){e.stopAutoAdvanceTimer(!0)};i.SafeApply=function(n){var r=t.$$phase;r=="$apply"||r=="$digest"?n&&typeof n=="function"&&n():i.$apply(n)};$(window).scroll(function(){e.scrollingDetectionTimerId&&clearTimeout(e.scrollingDetectionTimerId);e.isCurrentlyScrolling=!0;e.scrollingDetectionTimerId=_.delay(function(){e.isCurrentlyScrolling=!1},150)});i.scrollTo=function(n,t,i){e.scrollTo(n,t,i)};i.showSlide=function(n,t,i){e.showSlide(n,t,i)};i.$on(n.CarouselDirective.ShowSlideBroadcastName,function(n,t,i){e.showSlide(t,i)});i.$on("Carousel_ShowNext",function(n,t){e.scrollContents.context.id===t&&i.showNext()});i.$on("Carousel_ShowPrevious",function(n,t){e.scrollContents.context.id===t&&i.showPrevious()});i.$on("Carousel_Update",function(){i.update()});i.slideLoaded=function(){i.imagesSlideLoaded++};i.showNext=function(){var n=e.getNumberOfSlidesToAdvanceBy(),t=e.GetSnapIndex(),r=i.currentIndex+n,u=Math.min(Math.max(t,r),i.maxIndex+i.wrapSlideCount);e.showSlide(u,!0)};i.showPrevious=function(){var n=e.getNumberOfSlidesToAdvanceBy(),t=e.GetSnapIndex(),r=i.currentIndex-n,u=Math.max(Math.min(t,r),-i.wrapSlideCount);e.showSlide(u,!0)};i.PreviousButtonActive=function(){var n=e.$scope.isProductCarousel&&e.$scope.imagesSlideLoaded>5;return n||i.currentIndex>0||e.$scope.wrap};i.NextButtonActive=function(){var n=e.$scope.isProductCarousel&&e.$scope.imagesSlideLoaded>5;return n||i.currentIndex<e.$scope.maxIndex||e.$scope.wrap};i.updateCarouselSlides=function(){var n=i.scrollX;n<-(i.maxIndex+i.wrapSlideCount)*i.slideWidth?(n=n+i.slideCount*i.slideWidth,e.scrollContents.css("margin-left",n+"px")):n>=i.gutterSize&&(n=n-i.slideCount*i.slideWidth,e.scrollContents.css("margin-left",n+"px"));i.scrollX=n;i.SafeApply();t.$broadcast("Carousel_SlideShown",i)};i.clickEnable=function(n){n?_.delay(function(){i.clickEnabled=!0;i.container.addClass("ClickEnabled")},500):(i.clickEnabled=!1,i.container.removeClass("ClickEnabled"))};i.hammerHandler=function(n){if(n.isFinal)i.dragging&&(i.dragging=!1,i.clickEnable(!0),i.snapEnabled?e.snapNearestSlide(n.deltaX,n.velocityX):i.updateCarouselSlides());else if(!e.isCurrentlyScrolling&&n.direction&Hammer.DIRECTION_HORIZONTAL)switch(n.type){case"panright":case"panleft":e.wireDragging(i,!0);i.scrollTo(i.dragStartX+n.deltaX*i.dragMultiply,!1,!0);break;case"panup":case"pandown":e.wireDragging(i,!1);$(document).scrollTop(i.dragStartY-n.deltaY);break;case"swipeleft":e.wireSwipe(i,!0);break;case"swiperight":e.wireSwipe(i,!1)}else n.preventDefault()};i.throttledHammerHandler=_.throttle(i.hammerHandler,10);i.resetAutoAdvanceTimer=function(){e.stopAutoAdvanceTimer(!1);i.autoAdvanceSeconds>0&&(i.autoAdvanceTimer=setInterval(function(){var n=$("body");!n.hasClass("ModalVisible")&&!BaseAvonService.rootScope.isLoading&&i.autoAdvanceSeconds>0&&i.dragging!==!0&&!t.Redirecting&&(i.currentIndex<i.maxIndex||i.wrap?i.showNext():e.showSlide(0,!0))},i.autoAdvanceSeconds*1e3))};s=_.debounce(function(){e.stopAutoAdvanceTimer(!0);i.showPrevious()},250,!0);i.previousClicked=function(){s()};h=_.debounce(function(){e.stopAutoAdvanceTimer(!0);i.showNext()},250,!0);i.nextClicked=function(){h()};i.resetAutoAdvanceTimer();i.container.addClass("ClickEnabled");i.slideRange=function(){return i.slidesVisible&&i.slideCount?i.singleSlideAdvance?_.range(0,i.slideCount):_.range(0,Math.ceil(i.slideCount/i.slidesVisible)):[]};i.isPageActive=function(n){var t=(i.currentIndex+i.slideCount)%i.slideCount;return i.singleSlideAdvance?n==t:n==t/i.slidesVisible};this.update=_.debounce(function(){var n,r,u;if(i.slides=i.container.find(".Slides .Slide"),i.slideCount=i.slides.length,i.imagesSlideLoaded==i.slideCount&&(i.imagesSlideLoaded=0,t.$broadcast("Carousel_ImagesLoaded",i)),e.scrollContents.hide(),i.container.css({visibility:"visible"}),i.carouselWidth=i.container.find(".ScrollClip").width(),!i.container.is(":Visible")||i.carouselWidth===0){_.delay(function(){e.update()},100);return}for(i.slidesVisible=i.slidesVisibleRequested,i.slideWidth=i.carouselWidth/i.slidesVisible;i.slideWidth<i.minSlideWidth&&i.slidesVisible>1;)i.slidesVisible--,i.slideWidth=i.carouselWidth/i.slidesVisible;if(i.slidesVisible>i.slideCount&&(i.slidesVisible=i.slideCount,i.slideWidth=i.carouselWidth/i.slidesVisible),i.maxIndex=i.slideCount-i.slidesVisible,i.container.toggleClass("CanScroll",i.isProductCarousel||i.slideCount>i.slidesVisible),i.slides.width(i.slideWidth),i.wrapLeft.html(""),i.wrapRight.html(""),i.wrapSlideCount=0,i.wrap=i.wrapRequested&&i.slideCount>i.slidesVisible,i.wrap){for(i.wrapSlideCount=i.slidesVisible+2,n=0;n<i.wrapSlideCount;n++)r=i.slides.eq(i.slideCount-i.wrapSlideCount+n).html(),e.copySlideContents(r,!1),u=i.slides.eq(n).html(),e.copySlideContents(u,!0);i.wrapLeft.find(".Slide").width(i.slideWidth);i.wrapRight.find(".Slide").width(i.slideWidth)}e.scrollContents.width(i.slideWidth*(i.slideCount+i.wrapSlideCount*2)+2);e.scrollContents.show();e.showSlide(i.currentIndex,!1);i.SafeApply();t.$broadcast("Carousel_Updated",i);i.container.addClass("Ready")},250,!1);i.update=this.update;_.delay(function(){i.isProductCarousel&&i.container.addClass("CanScroll")},100);$(window).resize(this.update)}return t.prototype.wireSwipe=function(n,t){this.$scope.IsPanEnabled&&(this.stopAutoAdvanceTimer(!0),n.clickEnable(!1),t?n.showNext():n.showPrevious(),n.clickEnable(!0))},t.prototype.wireDragging=function(n,t){n.dragging!==!0&&(n.dragging=!0,n.dragStartX=n.scrollX,n.dragStartY=$(document).scrollTop(),n.clickEnable(!1),t&&this.stopAutoAdvanceTimer(t))},t.prototype.stopAutoAdvanceTimer=function(n){this.$scope.autoAdvanceTimer&&clearInterval(this.$scope.autoAdvanceTimer);n&&(this.$scope.autoAdvanceSeconds=0)},t.prototype.GetSnapIndex=function(){var n=this.$scope.scrollableSlideOffsetPercent/100*this.$scope.slideWidth;return Math.round((n-this.$scope.scrollX)/this.$scope.slideWidth)-this.$scope.wrapSlideCount},t.prototype.snapNearestSlide=function(n,t){var i,r=Math.abs(n)*t,u;Math.abs(r)>this.$scope.deltaXTimesVelocityXNextSlideThreshold?(u=this.getNumberOfSlidesToAdvanceBy(),i=this.$scope.currentIndex+u*this.getMathSign(r)):i=this.GetSnapIndex();this.showSlide(i,!0)},t.prototype.getMathSign=function(n){return n&&n/Math.abs(n)},t.prototype.BrochureShowChosenSlideAndSurroundingSlides=function(n){var t;if(this.$scope.container.closest("div#brochure").length&&(t=$("#brochureimage-"+n),t.length>0)){t.attr("src",t.attr("data-page-image"));var i=$("#brochureimage-"+(n+2)),r=$("#brochureimage-"+(n+1)),u=$("#brochureimage-"+(n-1)),f=$("#brochureimage-"+(n-2));i.length>0&&i.attr("src").indexOf("pages-loading.gif")>0&&i.attr("src",i.attr("data-page-image"));r.length>0&&r.attr("src").indexOf("pages-loading.gif")>0&&r.attr("src",r.attr("data-page-image"));u.length>0&&u.attr("src").indexOf("pages-loading.gif")>0&&u.attr("src",u.attr("data-page-image"));f.length>0&&f.attr("src").indexOf("pages-loading.gif")>0&&f.attr("src",f.attr("data-page-image"))}},t.prototype.showSlide=function(n,t,i){i===void 0&&(i=!1);i&&this.stopAutoAdvanceTimer(!0);this.BrochureShowChosenSlideAndSurroundingSlides(n);n=Math.max(Math.min(n,this.$scope.maxIndex+this.$scope.wrapSlideCount),-this.$scope.wrapSlideCount);this.$scope.slideCount>this.$scope.slidesVisible*2&&(this.$scope.currentIndex===0&&n===this.$scope.maxIndex||this.$scope.currentIndex===this.$scope.maxIndex&&n===0)&&(t=!1);this.$scope.currentIndex=n;var r=(this.$scope.scrollableSlideOffsetPercent/100-this.$scope.currentIndex-this.$scope.wrapSlideCount)*this.$scope.slideWidth;this.$scope.scrollTo(r,t,!1);this.$scope.SafeApply();this.$rootScope.$broadcast("Carousel_SlideShown",this.$scope)},t.prototype.copySlideContents=function(n,t){var i=$("<div class='Slide'>"+n+"<\/div>");i.find(".ng-scope").removeClass("ng-scope");this.$compile(i.find(".ProductSummaryName"))(this.$scope);this.$compile(i.find(".ProductItemImage"))(this.$scope);this.$compile(i.find(".OverlayContainer"))(this.$scope);this.$compile(i.find(".ImageType"))(this.$scope);t?this.$scope.wrapRight.append(i):this.$scope.wrapLeft.append(i)},t.prototype.scrollTo=function(n,t,i){var r=this.$scope.gutterSize,u,f;this.$scope.slideCount<=this.$scope.slidesVisible&&(r=0);(this.$scope.snapEnabled||i)&&(u=-this.scrollContents.width()+2+this.$scope.slideWidth*this.$scope.slidesVisible-r,f=r,n=Math.min(Math.max(n,u),f));this.scrollContents.toggleClass("Animate",t);this.scrollContents.css("margin-left",n+"px");this.$scope.scrollX=n},t.prototype.onSlideTransitionEnd=function(){if(this.$scope.snapEnabled){if(this.$scope.currentIndex<0&&this.$scope.currentIndex+this.$scope.slideCount<=this.$scope.maxIndex||this.$scope.currentIndex>this.$scope.maxIndex){var n=(this.$scope.currentIndex+this.$scope.slideCount)%this.$scope.slideCount;this.showSlide(n,!1)}}else this.$scope.updateCarouselSlides()},t.prototype.getNumberOfSlidesToAdvanceBy=function(){return this.$scope.singleSlideAdvance?1:this.$scope.slidesVisible},t.$inject=["$rootScope","$scope","$element","$compile","$attrs"],t}();n.CarouselDirectiveController=t}(CarouselModule||(CarouselModule={})),function(n){var t=function(){function n(n){return{restrict:"EAC",priority:20,link:function(t,i,r){var u=$(i),f=u.attr("data-ng-click")||u.attr("ng-click");f;u.on("click",function(){var i,f,e;t.ServerErrors=[];t.ServerInvalid&&(t.ServerInvalid=!1);t.innerForm&&(t.innerForm.ShowValidation=!1,t.innerForm.ServerErrors=[],t.innerForm.ServerInvalid&&(t.innerForm.ServerInvalid=!1));i=r.clearServerValidation;i||(f=u.closest("form"),f.length&&(i=f.attr("name")));i&&t[i].$setDirty();e=u.attr("clear-server-validation-click");e&&n(function(){n(function(){t.$eval(e)},10)},10)})}}}return n.$inject=["$timeout"],n}();n.clearServerValidation=t}(clearServerValidationModule||(clearServerValidationModule={}));app.directive("clearServerValidation",["$timeout",clearServerValidationModule.clearServerValidation]);app.directive("compile",["$compile",CompileDirective]);app.directive("confirmField",ConfirmFieldDirective),function(n){var t=function(){function n(n,t){n.ScrollbarControl={ScrollToTop:function(){t.mCustomScrollbar("scrollTo","top",{scrollInertia:0})}}}return n.$inject=["$scope","$element"],n}();n.CustomScrollbarController=t}(CustomScrollbarModule||(CustomScrollbarModule={})),function(n){var t=function(){function t(){var t=this;this.require="";this.restrict="A";this.scope={ScrollbarControl:"=?customScrollbarControl",PreventOutsideScrolling:"@customScrollbarPreventOutsideScrolling"};this.link=function(n,i){t.initializeCustomScrollbar(n,i)};this.controller=n.CustomScrollbarController}return t.Factory=function(){return function(){return new t}},t.prototype.initializeCustomScrollbar=function(n,t){if(typeof t.mCustomScrollbar=="function")t.mCustomScrollbar({advanced:{updateOnContentResize:!0}}),this.handleElementDestroy(n,t),this.preventScrollingOutside(n,t)},t.prototype.handleElementDestroy=function(n,t){t.on("$destroy",function(){t.mCustomScrollbar("destroy");n.$destroy()})},t.prototype.preventScrollingOutside=function(n,t){if(n.PreventOutsideScrolling)t.on("mousewheel",function(n){return n.preventDefault(),n.stopPropagation(),!1})},t}();n.CustomScrollbarDirective=t}(CustomScrollbarModule||(CustomScrollbarModule={}));app.directive("customScrollbar",[CustomScrollbarModule.CustomScrollbarDirective.Factory()]);app.directive("ngEnter",function(){return function(n,t,i){t.bind("keydown keypress",function(t){t.which===13&&(n.SafeApply(function(){n.$eval(i.ngEnter)}),t.preventDefault())})}});app.directive("expandable",ExpandableDirective);app.directive("fallbackSrc",["$rootScope",FallbackSrcDirective]);app.directive("focusMe",["$timeout",FocusMe]),function(n){var t=function(){function n(){this.require="";this.restrict="A";this.scope={callBack:"&iframeOnload"};this.link=function(n,t){t.on("load",function(){return n.callBack(t)});n.$on("destroy",function(){t.off("load")})}}return n.Factory=function(){return function(){return new n}},n}();n.IframeOnloadDirective=t}(IframeModule||(IframeModule={}));app.directive("iframeOnload",IframeModule.IframeOnloadDirective.Factory()),function(n){var t=function(){function n(t,i){var r=this;this.$rootScope=t;this.intersectionObserverService=i;this.imageObservedCallback=function(t,i){for(var o,u,f=0,e=t;f<e.length;f++)o=e[f],o.isIntersecting&&(u=angular.element(o.target),r.bindEventHandlers(u,function(n){r.setImageLoadedCssClass(n)},function(t){t.attr("src",n.ImageNotFoundSrc);r.setImageLoadErrorCssClass(t)}),u.attr("src",r.getImageSrc(u)),r.setImageLoadingCssClass(u),r.intersectionObserverService.Unobserve(i,u[0]))};this.require="";this.restrict="A";this.link=function(n,t,i){n.$watch(function(){return i.imgLazyLoadSrc},function(n,u){n!=u&&r.observeImage(t,i)});r.observeImage(t,i)}}return n.Factory=function(){return function(t,i){return new n(t,i)}},n.prototype.observeImage=function(n,t){var r=this.getImageSrc(n),i;this.resetCssClasses(n);n.removeAttr("src");r&&(i=this.getObserverOptions(t),this.intersectionObserverService.Observe(n,this.imageObservedCallback,i))},n.prototype.getObserverOptions=function(t){return{rootMargin:t.imgLazyLoadRootMargin?t.imgLazyLoadRootMargin:n.DefaultOptions.rootMargin,threshold:t.imgLazyLoadThreshold?[t.imgLazyLoadThreshold]:n.DefaultOptions.threshold}},n.prototype.bindEventHandlers=function(n,t,i){var f=n[0],r,u;if(f.src&&f.complete)f.naturalWidth>0?t(n):i(n);else{r="load.imglazyload";u="error.imglazyload";n.bind(r,function(){t(n);n.unbind(r).unbind(u)}).on(u,function(){i(n);n.unbind(r).unbind(u)})}},n.prototype.getImageSrc=function(n){var t=n.attr("img-lazy-load-src");return t||(t=n.attr("data-img-lazy-load-src")),t},n.prototype.resetCssClasses=function(n){n.addClass("img-lazy-load").removeClass("img-lazy-load-loading").removeClass("img-lazy-load-error").removeClass("img-lazy-load-loaded")},n.prototype.setImageLoadingCssClass=function(n){n.addClass("img-lazy-load-loading")},n.prototype.setImageLoadedCssClass=function(n){n.removeClass("img-lazy-load-loading").addClass("img-lazy-load-loaded")},n.prototype.setImageLoadErrorCssClass=function(n){n.removeClass("img-lazy-load-loading").addClass("img-lazy-load-error")},n.ImageNotFoundSrc="/images/Responsive/Product/PhotoNotAvailable.png",n.DefaultOptions={threshold:.01,rootMargin:"50px 0px"},n.ImageLoadingCssClass="img-lazy-load-loading",n.ImageLoadedCssClass="img-lazy-load-loaded",n.ImageLoadErrorCssClass="img-lazy-load-error",n}();n.ImageLazyLoadDirective=t}(ImageLazyLoadModule||(ImageLazyLoadModule={}));app.directive("imgLazyLoadSrc",["$rootScope","intersectionObserverService",ImageLazyLoadModule.ImageLazyLoadDirective.Factory()]);app.directive("includerepid",["$rootScope",IncludeRepIdDirective]);app.directive("input",input);app.directive("inputMaxlength",inputMaxlength);app.directive("input",inputWaterMark);app.directive("linenumberField",linenumberField),function(n){var t=function(){function n(t,i,r){var u=this;this.$rootScope=t;this.$compile=i;this.modalService=r;this.restrict="EAC";this.compile=function(){return{pre:function(n,t){var i=t.wrap('<div class="ModalContainer"><\/div>')},post:function(i,f){var e=$(f),o=e.closest(".ModalContainer"),l=$("#ModalBackground"),h=!0,c=!1,s;i.CloseModal=function(){r.CloseModal()};s=!1;e.on("modal",function(r,f){if(o.hasClass("Shown")){i.HideLoading();return}var a=e.attr("modal"),l;l=a?i.$eval(a):{};f&&f.UrlToLoad&&(l.UrlToLoad=f.UrlToLoad);u.SetModalModel(i,f);f&&f.UseIFrame&&(l.UseIFrame=f.UseIFrame,l.IFrameWidth=f.IFrameWidth,l.IFrameHeight=f.IFrameHeight,l.IFrameAttributes=f.IFrameAttributes);l.KeepLoaded!==undefined&&(c=l.KeepLoaded);l.AllowExit!==undefined&&(h=l.AllowExit);l.IgnoreBackground!==undefined&&(s=l.IgnoreBackground);f&&f.CssClass&&(l.CssClass=f.CssClass);f&&f.Position&&(l.Position=f.Position);f&&(h=f.AllowExit,c=f.KeepLoaded,s=f.IgnoreBackground);l&&l.UrlToLoad&&!e.data("isLoaded")?u.LoadModalFromUrl(i,e,l,c):e.trigger("loaded");$(window).resize(function(){_.delay(function(){u.centerElement(o)},50)});e.on("close",function(r,s,h){var a=o.context.id,y=h,l,v;(a==="AjaxModal"&&(l=o.find("div"),l&&l.length>1&&(v=l.eq(2),v&&(a=v.attr("id")))),o.hasClass("Shown"))&&(c||s||o.children().html(""),$("#select2-drop-mask").click(),o.removeClass("Shown"),$(".ModalContainer.Shown").length==0&&$("body").removeClass("ModalVisible"),e.data("isLoaded",!1),$("#ModalBackground").addClass("Shown"),$("#ModalBackground").removeAttr("style"),t.$broadcast(n.ModalClosedBroadcastName,a,i.ModalModel,y),t.$broadcast("Do.ResetPageIdleTime"),u.UnsetModalModel(i,f),i.SafeApply(),u.clearTextSelectionOnMsEdge())})});e.on("loaded",function(){var r=o.context.id;o.find(".hideUntilCentered").length>0&&o.hide();i.HideLoading();u.createCloseButton(e,f,o,l,h);u.bindCloseButton(e);_.defer(function(){u.centerElement(o)});_.delay(function(){u.centerElement(o);o.addClass("Shown");$("body").addClass("ModalVisible");var n=e.find("#ModalIFrameContainer");n.length>0&&n.attr("src",n.attr("data-urlToLoad"))},100);t.$broadcast(n.ModalShownBroadcastName,r,i.ModalModel)});o.on("click",function(n){s===!1&&h&&$(n.target).attr("class")==="ModalContainer Shown"&&(e.trigger("close",[!1,!0]),n.stopPropagation(),u.RemoveIframeAfterClose(e))});i.SetupModalBackgroundClick=function(){l.on("click",function(n){s===!1&&e.parent().hasClass("Shown")&&($("#ModalIFrameContainer").remove(),e.trigger("close",[!1,!0]),n.stopPropagation(),u.clearFormValues(),u.RemoveIframeAfterClose(e))})};i.SetupModalBackgroundClick()}}}}return n.Factory=function(){return function(t,i,r){return new n(t,i,r)}},n.prototype.clearTextSelectionOnMsEdge=function(){this.$rootScope.IsEdge()&&(window.getSelection?window.getSelection().empty?window.getSelection().empty():window.getSelection().removeAllRanges&&window.getSelection().removeAllRanges():document.selection&&document.selection.empty())},n.prototype.RemoveIframeAfterClose=function(n){var t=n.find("#ModalIFrameContainer");t.length>0&&t.remove()},n.prototype.LoadModalFromUrl=function(n,t,i,r){var u=this;t.addClass(i.CssClass);i.Position&&i.Position>0&&t.attr("position",i.Position);i.UseIFrame?(t.data("isLoaded",!1),$('<iframe id="ModalIFrameContainer" data-urlToLoad="'+i.UrlToLoad+'" style="width: '+i.IFrameWidth+"; height: "+i.IFrameHeight+';" width="'+i.IFrameWidth+'" height="'+i.IFrameHeight+'" allowfullscreen '+i.IFrameAttributes+" />").appendTo(t),t.trigger("loaded")):(r&&t.data("isLoaded",!0),i.UrlToLoad?this.modalService.GetHtml(i.UrlToLoad).then(function(i){t.html(i);u.$compile(t.contents())(n);t.trigger("loaded")}):t.trigger("loaded"))},n.prototype.SetModalModel=function(n,t){if(t&&t.Model)if(AVON.TempModalModel=t.Model,t.ExtractModelToScope)for(var i in t.Model)n[i]=t.Model[i];else n.ModalModel=t.Model},n.prototype.UnsetModalModel=function(n,t){if(t&&t.Model)if(delete AVON.TempModalModel,t.ExtractModelToScope)for(var i in t.Model)delete n[i];else delete n.ModalModel},n.prototype.bindCloseButton=function(n){var i=this,t=$(".Close",n);t&&t.click(function(t){n.parent().hasClass("Shown")&&($("#ModalIFrameContainer").remove(),$("#select2-drop-mask").click(),n.trigger("close",[!1,!0]),n.hasClass("AugmentedRealityModal")&&document.body.classList.remove("positionFixed"),t.stopPropagation(),i.clearFormValues())})},n.prototype.createCloseButton=function(n,t,i,r,u){t.hasClass("Close")||(u?(i.find(".ModalCloseIcon").length==0&&i.children().prepend('<div class="ModalCloseIcon Close"><\/div>'),i.find(".Close").show(),this.bindCloseButton(n)):(i.find(".Close").hide(),r.off("click")))},n.prototype.clearFormValues=function(){$("#FindARepModal").length&&this.$rootScope.$broadcast("FindARepModalClosed");$("#WelcomeBack").length&&this.$rootScope.$broadcast("WelcomeBackModalClosed")},n.prototype.centerElement=function(n){var e=$(window).height(),r=$(window).scrollTop(),f=r,t=r+e*.1,u,i;t<f&&(t=f);t<0&&(t=0);n.find(".centerModal").length>0?n.css("top",r+"px"):n.find(".modalTop").length>0?(u=n.find(".modalTop"),i=0,u.attr("position")&&(i=parseInt(u.attr("position"))),t<i?n.css("top",t+"px"):n.css("top",t-i+"px")):n.css("top",t+"px");n.find(".hideUntilCentered").length>0&&n.show()},n.ModalShownBroadcastName="ModalShown",n.ModalClosedBroadcastName="ModalClosed",n}();n.ModalDirective=t;app.directive("modal",["$rootScope","$compile","modalService",n.ModalDirective.Factory()]);$(document).ready(function(){var n=app.GetQuerystringParameterByName("overlay");n.length>0&&(n=="ForgottenPassword"?($("#LoginModal").trigger("modal"),_.delay(function(){$("#ForgotPasswordButton").click()},3e3)):AvonModule.AvonScope.SessionService.WhenReady().then(function(){if(n==="LoginModal"&&AvonModule.AvonScope.Session.Customer.IsLoggedIn){var t=app.GetQuerystringParameterByName("ReturnUrl");t&&(window.location.href=t);return}$("#"+n).trigger("modal")}))})}(ModalDirectiveModule||(ModalDirectiveModule={})),function(n){var t=function(){function n(){this.require="";this.restrict="A";this.link=function(n,t,i){t.on("focusout",function(t){n.SafeApply(function(){n.$eval(i.ngFocusOut,{$event:t})})})}}return n.Factory=function(){return function(){return new n}},n}();n.NgFocusOutDirective=t}(NgFocusOutModule||(NgFocusOutModule={}));app.directive("ngFocusOut",NgFocusOutModule.NgFocusOutDirective.Factory()),function(n){var t=function(){function n(n){var t=this;this.$timeout=n;this.restrict="A";this.link=function(n,i,r){t.$timeout(function(){n.$emit(r.ngRepeatCompleted)})}}return n.instance=function(){var t=function(t){return new n(t)};return t.$inject=["$timeout"],t},n}();n.NgRepeatCompleted=t}(LazyLoadModule||(LazyLoadModule={}));app.directive("ngRepeatCompleted",LazyLoadModule.NgRepeatCompleted.instance());app.directive("numericField",numericField),function(n){var t=function(){function n(){this.restrict="A";this.scope={callback:"&ngOnload"};this.link=function(n,t){var i=t[0];if(i.complete&&i.naturalWidth>0)n.callback({event:event});else t.on("load",function(t){n.$apply(function(){n.callback({event:t})})})}}return n.Factory=function(){return function(t){return new n(t)}},n}();n.OnLoadDirective=t}(OnLoadDirectiveModule||(OnLoadDirectiveModule={}));app.directive("ngOnload",["$rootScope",OnLoadDirectiveModule.OnLoadDirective.Factory()]);app.directive("phoneNumber",["$filter","$browser",phoneNumber]);app.directive("phonenumberField",phonenumberField),function(n){var t=function(){function n(n,t,i){var r=this;this.$interval=i;this.require="";this.restrict="A";this.scope={ZoomEnabled:"=?pinchZoomCanvasEnabled",ImagePath:"=pinchZoomCanvasImagePath",EmptyImagePath:"=?emptyImagePath"};this.link=function(n,u,f){n.ZoomEnabled==undefined&&(n.ZoomEnabled=!0);n.EmptyImagePath==undefined&&(n.EmptyImagePath="/images/Responsive/Product/PhotoNotAvailable.png");f.$observe("zoomImage",function(t){u.data("zoom-image",t);n.ZoomEnabled?r.createZoomCanvas(n,u,n.ImagePath):r.removeZoomCanvas(n)});n.$watch(function(){return{Width:u.width(),Height:u.height()}},function(n,t,i){r.removeZoomCanvas(i);n.Width>0&&n.Height>0&&r.createZoomCanvas(i,u,i.ImagePath)},!0);n.$watch("ZoomEnabled",function(n,t,f){n!=t&&(f.CustomOffsetListener&&(i.cancel(f.CustomOffsetListener),f.CustomOffsetListener=null),n&&(r.createZoomCanvas(f,u,f.ImagePath),r.calculateOffset(f),f.CustomOffsetListener=r.createCustomOffsetListener(f,u)))});n.$on("$destroy",function(){r.removeZoomCanvas(n)});u.on("$destroy",function(){n.$destroy()});angular.element(t).bind("scroll",function(){r.calculateOffset(n)})}}return n.Factory=function(){return function(t,i,r){return new n(t,i,r)}},n.prototype.createCustomOffsetListener=function(n,t){var r=this,i;return this.$interval(function(){var u=t.offset();i&&u.top==i.top&&u.left==i.left||(i=u,r.calculateOffset(n))},200,10,!1)},n.prototype.calculateOffset=function(n){n.PinchZoomCanvas&&n.PinchZoomCanvas.calculateOffset()},n.prototype.removeZoomCanvas=function(n){n.PinchZoomCanvas&&(n.PinchZoomCanvas.destroy(),n.PinchZoomCanvas=null)},n.prototype.createZoomCanvas=function(n,t,i){n.PinchZoomCanvas=new PinchZoomCanvas({canvas:t[0],path:i,momentum:!0,zoomMax:2,doubletap:!0,onZoomEnd:function(){},onZoom:function(){},emptyImage:n.EmptyImagePath});n.PinchZoomCanvas.calculateOffset()},n}();n.PinchZoomCanvasDirective=t}(PinchZoomCanvasModule||(PinchZoomCanvasModule={}));app.directive("pinchZoomCanvas",["$rootScope","$window","$interval",PinchZoomCanvasModule.PinchZoomCanvasDirective.Factory()]);app.directive("preventdefault",preventDefault),function(n){var t=function(){function n(n,t,i,r){var u=this;t.Cdn=r;t.ThumbnailSlideClick=function(n){u.productImagesLargeCarouselScope.showSlide(n,!0)};t.SetProductImagesLargeCarouselScope=function(n){u.productImagesLargeCarouselScope=n}}return n.$inject=["$rootScope","$scope","$element","cdnService"],n}();n.ProductImagesCarouselController=t}(ProductImagesCarouselModule||(ProductImagesCarouselModule={})),function(n){var t=function(){function t(){this.require="ng-model";this.restrict="EA";this.scope={Product:"=ngModel",ClickEnabled:"=productImagesClickEnabled"};this.controller=n.ProductImagesCarouselController;var t=angular.element("body").hasClass("Mobile");this.templateUrl=t?"/Scripts/Common/Core/Directives/ProductImagesCarousel/ProductImagesCarouselTemplate.mobile.html":"/Scripts/Common/Core/Directives/ProductImagesCarousel/ProductImagesCarouselTemplate.html"}return t.Factory=function(){return function(n){return new t(n)}},t}();n.ProductImagesCarouselDirective=t}(ProductImagesCarouselModule||(ProductImagesCarouselModule={}));app.directive("productImagesCarousel",["$rootScope",ProductImagesCarouselModule.ProductImagesCarouselDirective.Factory()]);app.directive("secondaryImage",["$rootScope",SecondaryImageDirective]);app.directive("selectRegularExpressionValidator",SelectRegularExpressionValidator);app.directive("singleexpandable",SingleExpandableDirective),function(n){var r=function(){function n(){this.restrict="E";this.link=function(n,t){t.attr("gridheight")&&(t.css("height",t.attr("gridheight")+"px"),t.attr("rowcount")&&t.attr("colcount")&&(isNaN(t.attr("gridheight"))||isNaN(t.attr("rowcount"))||isNaN(t.attr("colcount"))||t.css("width",parseInt(t.attr("gridheight"))/parseInt(t.attr("rowcount"))*parseInt(t.attr("colcount"))+"px")))}}return n.instance=function(){return function(){return new n}},n}(),t,i;n.StackGridDirective=r;t=function(){function n(n,t){this.$scope=n;this.$element=t;var r=function(n,t,i){return Math.abs(n*parseInt(t.attr(i)))},u=function(n,t){return 100/parseInt(n.attr(t))},i=$(t),f=i.parent("stackgrid"),e=u(f,"rowcount"),o=u(f,"colcount");n.cellTop=r(e,i,"row");n.cellLeft=r(o,i,"col");n.cellHeight=r(e,i,"rowspan");n.cellWidth=r(o,i,"colspan")}return n.$inject=["$scope","$element"],n}();n.StackCellController=t;i=function(){function t(){this.scope={};this.template='<div class="StackCell" ng-attr-style="height:{{cellHeight}}%; width:{{cellWidth}}%; top:{{cellTop}}%; left:{{cellLeft}}%;" ng-transclude><\/div>';this.restrict="E";this.require="^stackgrid";this.replace=!0;this.transclude=!0;this.controller=n.StackCellController}return t.instance=function(){return function(){return new t}},t}();n.StackCellDirective=i}(StackGridModule||(StackGridModule={}));app.directive("stackgrid",StackGridModule.StackGridDirective.instance());app.directive("stackcell",StackGridModule.StackCellDirective.instance());app.directive("textarea",textareaWaterMark),function(n){var t=function(){function n(n,t,i,r){var u=this;this.$scope=n;this.$element=t;this.intersectionObserverService=r;this.defaultOptions={ShowCloseButton:!1,PointerDirection:"outwards",Width:null,ZIndex:null,Left:null};this.updateTooltilVisibility=_.throttle(function(){u.setElementVisibility(u.$scope.IsOverLink||u.$scope.IsOverTooltip)},10);n.TooltipModel=null;n.Options=this.defaultOptions;n.IsOverLink=!1;n.IsOverTooltip=!1;this.onElement=null;this.intersectionObserver=null;n.Show=function(t,i,f,e){u.onElement=t;u.setOptions(e);f&&(n.TooltipModel=f);n.OnElement=t;n.HorizontalAlignReference=i;n.IsOverLink=!0;u.intersectionObserver=r.Observe(t,function(n){u.intersectionObserverCallback(n)},{threshold:[.01],rootMargin:"0px 0px"});u.immediatelyApplyStyles()};n.TooltipMouseEnter=function(){n.IsOverTooltip=!0};n.TooltipMouseLeave=function(){n.IsOverTooltip=!1};n.GetStyle=function(){return u.getTooltipStyle(n.OnElement,n.HorizontalAlignReference,t)};n.GetCssClasses=function(){return{"pointer-inwards":u.$scope.Options.PointerDirection=="inwards"}};n.IsVisible=function(){return n.IsOverLink||n.IsOverTooltip};n.GetPointerStyle=function(){var r={};if(n.OnElement){var u=n.OnElement.offset().left+n.OnElement.width()/2,f=t.offset().left,i=(u-f)/t.width()*100;i>=0&&i<=100&&(r.left=i+"%")}return r};n.HideTooltip=function(){n.IsOverLink=!1;n.IsOverTooltip=!1;u.intersectionObserver&&u.onElement&&(u.intersectionObserverService.Unobserve(u.intersectionObserver,u.onElement),u.intersectionObserver=null,u.onElement=null)};n.$watch(function(){return n.IsOverLink||n.IsOverTooltip},function(n,t){n!=t&&u.updateTooltilVisibility()});this.setElementVisibility(!1);i.RegisterTooltip(n.TooltipId,t,n)}return n.prototype.setElementVisibility=function(n){this.$element.toggle(n)},n.prototype.intersectionObserverCallback=function(n){for(var r,u=this,t=0,i=n;t<i.length;t++)r=i[t],r.isIntersecting||this.$scope.SafeApply(function(){u.$scope.HideTooltip()})},n.prototype.immediatelyApplyStyles=function(){var n=this;_.defer(function(){var i=n.$scope.GetStyle(),t;angular.element(".tooltip-overlay").css(i);t=n.$scope.GetPointerStyle();angular.element(".tooltip-pointer").css(t)})},n.prototype.setOptions=function(n){var t,i;if(n)for(t in this.$scope.Options)i=n[t],i!==undefined&&(this.$scope.Options[t]=i)},n.prototype.getTooltipStyle=function(n,t,i){var r={},u,f;return n&&(u=n.offset(),r.top=u.top+n.outerHeight(),f=t&&t.length>0?t:n,r.left=u.left+(f.outerWidth()-i.outerWidth())/2-(this.$scope.Options.Left?this.$scope.Options.Left:0)),this.$scope.Options&&(this.$scope.Options.Width&&(r.width=isNaN(this.$scope.Options.Width)?this.$scope.Options.Width:this.$scope.Options.Width+"px"),this.$scope.Options.ZIndex&&(r["z-index"]=this.$scope.Options.ZIndex)),r},n.$inject=["$scope","$element","tooltipService","intersectionObserverService"],n}();n.TooltipContainerController=t}(TooltipContainerModule||(TooltipContainerModule={}));app.controller("TooltipContainerController",TooltipContainerModule.TooltipContainerController),function(n){var t=function(){function n(n,t,i){var r=this;this.$rootScope=n;this.$compile=t;this.tooltipService=i;this.preLink=function(n,t){var u=r.createTooltipContainer(n.TooltipContentId,t),i=r.$rootScope.$new(!1);i.TooltipId=n.TooltipContentId;r.$compile(u)(i)};this.postLink=function(n,t){t.remove()};this.require="";this.restrict="A";this.terminal=!0;this.scope={TooltipContentId:"@tooltipContent"};this.compile=function(){return{pre:r.preLink,post:r.postLink}}}return n.Factory=function(){return function(t,i,r){return new n(t,i,r)}},n.prototype.createTooltipContainer=function(n,t){var r=angular.element('<div class="tooltip-content">\n                    <div class="tooltip-pointer" data-ng-style="GetPointerStyle()"><\/div>\n                    <button class="tooltip-close-button" data-ng-show="Options.ShowCloseButton" data-ng-click="HideTooltip()"><\/button>\n                <\/div>'),i;return r.append(t.contents()),i=angular.element('<div tooltipid="'+n+'" \n                      class="tooltip-overlay '+t.attr("class")+'"\n                      data-ng-controller="TooltipContainerController"\n                      data-ng-style="GetStyle()"\n                      data-ng-class="GetCssClasses()"\n                      data-ng-mouseenter="TooltipMouseEnter()"\n                      data-ng-mouseleave="TooltipMouseLeave()">\n                <\/div>'),i.append(r),i},n}();n.TooltipContentDirective=t}(TooltipContentModule||(TooltipContentModule={}));app.directive("tooltipContent",["$rootScope","$compile","tooltipService",TooltipContentModule.TooltipContentDirective.Factory()]),function(n){var i=function(){function n(n,t,i,r){this.$scope=n;this.$rootScope=t;this.$element=i;this.$transclude=r;n.CloseTooltipInfo=function(){n.ExpandTooltipInfo=!1};n.OpenTooltipInfo=function(){n.ExpandTooltipInfo=!0;t.ScrollIntoView(i)};n.ToggleTooltipInfo=function(){n.ExpandTooltipInfo?n.CloseTooltipInfo():n.OpenTooltipInfo()};r(function(t){n.content=angular.element("<div>").append(t).html()})}return n.$inject=["$scope","$rootScope","$element","$transclude"],n}(),t;n.TooltipController=i;t=function(){function t(){this.scope={};this.template="<i class='{{className}}' data-ng-click='ToggleTooltipInfo()' data-ng-class='{Expanded: ExpandTooltipInfo}' data-ng-mouseenter='OpenTooltipInfo()' data-ng-mouseleave='CloseTooltipInfo()'><span>i<\/span><div class='InfoPanel'><div class='RotatedCaret45'><\/div><div data-ng-bind-html='content'><\/div><\/div><\/i>";this.restrict="E";this.replace=!1;this.transclude=!0;this.controller=n.TooltipController;this.link=function(n,t,i){n.className=i.classname}}return t.instance=function(){return function(){return new t}},t}();n.TooltipDirective=t}(TooltipModule||(TooltipModule={}));app.directive("tooltip",TooltipModule.TooltipDirective.instance());app.directive("viewmore",[ViewmoreDirective]);app.directive("zipCode",["$filter","$browser",zipCode]);app.filter("noFractionCurrency",["$filter","$locale",function(n,t){var i=n("currency"),r=t.NUMBER_FORMATS;return function(n,t){var u=i(n,t),f=u.indexOf(r.DECIMAL_SEP);return n>=0?u.substring(0,f):u.substring(0,f)+")"}}]);app.filter("dayrange",function(){return function(n,t){var u=isNaN(t)?1:parseInt(t),r=31,i;switch(u){case 2:r=29;break;case 4:case 6:case 9:case 11:r=30}for(i=1;i<=r;i++)n.push(i);return n}});app.filter("htmlIsSafe",["$sce",function(n){return function(t){return n.trustAsHtml(t)}}]);app.filter("telephone",function(){return function(n){if(!n)return"";var t=n.toString().trim().replace(/^\+/,""),i="";return t.length>0&&(i=t.slice(0,3)),t.length>=4&&(i+="-"+t.slice(3,6)),t.length>=7&&(i+="-"+t.slice(6,10)),i}});app.filter("unique",[function(){return function(n,t){var i=[],r=[];return angular.forEach(n,function(n){var u=n[t];r.indexOf(u)===-1&&(r.push(u),i.push(n))}),i}}]);app.filter("formatzipcode",function(){return function(n){var i="",t;return n&&(t=n.toString().trim().replace(/^\+/,"").replace("-",""),t.length>0&&(i=t.slice(0,5)),t.length>=6&&(i+="-"+t.slice(5,10))),i}}),function(n){n[n.Add=0]="Add";n[n.Remove=1]="Remove"}(ApplyCouponType||(ApplyCouponType={})),function(n){n[n.None=0]="None";n[n.StandardCoupon=1]="StandardCoupon";n[n.DoesNotExist=2]="DoesNotExist";n[n.Expired=6]="Expired";n[n.SingleUseOnly=3]="SingleUseOnly";n[n.SpecificToEmailAddr=4]="SpecificToEmailAddr";n[n.SpecificToEmailAddrSc2=5]="SpecificToEmailAddrSc2";n[n.CustomerMustBeAttached=7]="CustomerMustBeAttached";n[n.CustomerMustBeUnAttached=8]="CustomerMustBeUnAttached";n[n.CustomerMustHaveSpecificShippingZipCode=11]="CustomerMustHaveSpecificShippingZipCode"}(CouponValidationCode||(CouponValidationCode={}));AddressHelper=function(){function n(){}return n.MapAddressIntoMyAddress=function(n,t){t===void 0&&(t=null);var i=n.PhoneNumber;return t!==null&&(i={FullNumber:t,Area:"",Number:"",Prefix:""}),{Address1:n.Address1,Address2:n.Address2,City:n.City,Province:n.Province,PostalCode:n.PostalCode,CityStateFormatted:n.CityStateFormatted,Country:n.Country,FirstName:n.FirstName,LastName:n.LastName,PhoneNumber:i,State:n.State,Type:n.Type,Zip:this.MapZipStringToZipObject(n.Zip),Name:n.Name,Email:"",IsGuestShopper:!1,IsCheckoutRegistration:!1,IsRegisteredGuestShopper:!1,Password:"",PasswordConfirm:"",PasswordHint:""}},n.MapMyAddressIntoAddress=function(n){return{Address1:n.Address1,Address2:n.Address2,City:n.City,Province:n.Province,PostalCode:n.PostalCode,CityStateFormatted:n.CityStateFormatted,Country:n.Country,FirstName:n.FirstName,LastName:n.LastName,PhoneNumber:n.PhoneNumber,State:n.State,Type:n.Type,Zip:this.MapZipObjectToString(n.Zip),Name:n.Name,Email:"",IsGuestShopper:!1,IsCheckoutRegistration:!1,IsRegisteredGuestShopper:!1,Password:"",PasswordConfirm:"",PasswordHint:""}},n.CreateEmptyAddressModel=function(){return{Address1:"",Address2:"",City:"",Province:"",PostalCode:"",CityStateFormatted:"",Country:"",FirstName:"",LastName:"",PhoneNumber:{Area:"",FullNumber:"",Number:"",Prefix:""},State:"",Type:0,Zip:"",Name:"",Email:"",IsGuestShopper:!1,IsCheckoutRegistration:!1,IsRegisteredGuestShopper:!1,Password:"",PasswordConfirm:"",PasswordHint:""}},n.CreateEmptyMyAddressModel=function(){return{Address1:"",Address2:"",City:"",Province:"",PostalCode:"",CityStateFormatted:"",Country:"",FirstName:"",LastName:"",PhoneNumber:{Area:"",FullNumber:"",Number:"",Prefix:""},State:"",Type:0,Zip:{Code:""},Name:"",Email:"",IsGuestShopper:!1,IsCheckoutRegistration:!1,IsRegisteredGuestShopper:!1,Password:"",PasswordConfirm:"",PasswordHint:""}},n.MapUpsAddressIntoIAddress=function(n,t){return{Address1:n.Address1,Address2:n.Address2,City:n.City,Province:n.Province,PostalCode:"",CityStateFormatted:"",Country:n.Country,FirstName:"",LastName:"",PhoneNumber:{Area:"",FullNumber:"",Number:"",Prefix:""},State:n.State,Type:t,Zip:n.Zip,Name:"",Email:"",IsGuestShopper:!1,IsCheckoutRegistration:!1,IsRegisteredGuestShopper:!1,Password:"",PasswordConfirm:"",PasswordHint:""}},n.MapBasicAddressIntoIAddress=function(n,t,i,r,u,f,e){return{Address1:n,Address2:t,City:i,Province:"",PostalCode:"",CityStateFormatted:"",Country:f,FirstName:"",LastName:"",PhoneNumber:{Area:"",FullNumber:"",Number:"",Prefix:""},State:r,Type:e,Zip:u,Name:"",Email:"",IsGuestShopper:!1,IsCheckoutRegistration:!1,IsRegisteredGuestShopper:!1,Password:"",PasswordConfirm:"",PasswordHint:""}},n.MapZipStringToZipObject=function(n){return{Code:n}},n.MapZipObjectToString=function(n){return n.Code},n}(),function(n){n[n.Inactive=0]="Inactive";n[n.Active=1]="Active";n[n.Suspended=2]="Suspended";n[n.UserDeleted=3]="UserDeleted";n[n.CustomerServiceDeleted=4]="CustomerServiceDeleted";n[n.AvailableSoon=5]="AvailableSoon"}(AutoReplenishStatusCode||(AutoReplenishStatusCode={}));AutoReplenishStatusCodeHelper=function(){function n(){}return n.IsActive=function(t){return n.ActiveOrSuspendedStatuses.indexOf(t)>-1},n.IsInactive=function(t){return n.InactiveStatuses.indexOf(t)>-1},n.ActiveOrSuspendedStatuses=[AutoReplenishStatusCode.Active,AutoReplenishStatusCode.Suspended,AutoReplenishStatusCode.AvailableSoon],n.InactiveStatuses=[AutoReplenishStatusCode.Inactive,AutoReplenishStatusCode.UserDeleted,AutoReplenishStatusCode.CustomerServiceDeleted],n}(),function(n){n[n.None=0]="None";n[n.Updating=1]="Updating";n[n.UpdateSuccess=2]="UpdateSuccess"}(CreditCardUpdateStatus||(CreditCardUpdateStatus={})),function(n){n[n.None=0]="None";n[n.Home=1]="Home";n[n.Category=2]="Category";n[n.Subcategory=3]="Subcategory";n[n.Search=4]="Search";n[n.SearchTerm=5]="SearchTerm";n[n.Brand=6]="Brand";n[n.ProductName=7]="ProductName"}(BreadcrumbTypes||(BreadcrumbTypes={})),function(n){n[n.None=0]="None";n[n.Featured=1]="Featured";n[n.Category=2]="Category";n[n.Brand=3]="Brand"}(ProductCategorySection||(ProductCategorySection={})),function(n){n[n.Level1=0]="Level1";n[n.Level2=1]="Level2";n[n.PDept=2]="PDept";n[n.Dept=3]="Dept"}(Level||(Level={})),function(n){n[n.None=0]="None";n[n.Default=1]="Default";n[n.Price=2]="Price";n[n.Rating=3]="Rating";n[n.Name=4]="Name";n[n.Relevance=5]="Relevance";n[n.Discount=6]="Discount";n[n.SearchRelevance=7]="SearchRelevance"}(SortOption||(SortOption={})),function(n){n[n.Celebros=0]="Celebros";n[n.Content=1]="Content";n[n.Default=2]="Default"}(SearchTermType||(SearchTermType={}));SliderFacetModelNames=function(){function n(){}return n.discountLevelModel="discountLevelModel",n.priceRangeModel="priceRangeModel",n}(),function(n){n[n.Self=8]="Self";n[n.Blank=9]="Blank"}(HtmlTarget||(HtmlTarget={})),function(n){n[n.Desktop=0]="Desktop";n[n.Mobile=1]="Mobile";n[n.Tablet=2]="Tablet"}(Platform||(Platform={})),function(n){n[n.None=0]="None";n[n.Adding=1]="Adding";n[n.Added=2]="Added"}(AddingToBagStatus||(AddingToBagStatus={})),function(n){n[n.None=0]="None";n[n.OneTimePurchase=1]="OneTimePurchase";n[n.AutoReplenishSubscription=2]="AutoReplenishSubscription"}(PurchaseOption||(PurchaseOption={})),function(n){n[n.Youtube=0]="Youtube";n[n.BrightCove=1]="BrightCove"}(VideoType||(VideoType={}));var EmptyCartCertonaObject=function(){function n(){this.pagetype="emptycart";this.recommendations=!0}return n}(),NoSearchPageCertonaObject=function(){function n(){this.pagetype="nosearch";this.recommendations=!0}return n}(),SearchPageCertonaObject=function(){function n(n,t){this.pagetype="search";this.recommendations=n;this.itemid=t.join(";")}return n}(),ShoppingCartPageCertonaObject=function(){function n(n,t){this.pagetype="cart";this.itemid=n.join(";");t&&(this.customerid=t);this.recommendations=!0}return n}(),QuizScreenType;(function(n){n[n.EntryScreen=0]="EntryScreen";n[n.QuestionScreen=1]="QuestionScreen";n[n.ResultsScreen=2]="ResultsScreen"})(QuizScreenType||(QuizScreenType={}));TrackingAddToCartType=function(){function n(){}return n.TrackingAddToCartType="",n.SearchResultsQuickshop="quickshop search results",n.ProductCategoryQuickshop="quick shop category",n.BrochureQuickshop="quickshop brochure",n.ProductDetailPage="product detail page",n.ProductDetailQuickshop="quickshop homepage",n.ProductDetailPageQuickShopModal="quick shop product detail",n.BlogQuickShop="blog",n.OrderHistoryQuickShop="order history",n.SkinCareAdvisor="skin care advisor app",n.WishListShared="wishlist-shared",n.WishListPersonal="wishlist-personal",n.ShopByProductNumber="shop by product number",n.ProductLinePage="product line",n.Causes="causes",n.Bag="bag",n.Category="category",n.Search="search",n}(),function(n){n[n.QuickShopProductView=0]="QuickShopProductView";n[n.ProductImageView=1]="ProductImageView";n[n.FarLocateMyRep=2]="FarLocateMyRep";n[n.FarRecommendaRep=3]="FarRecommendaRep";n[n.HowMayIAssistThankYou=4]="HowMayIAssistThankYou";n[n.EmailConfirmMsg=6]="EmailConfirmMsg";n[n.CartNewCustAcct=9]="CartNewCustAcct";n[n.CartViewBag=10]="CartViewBag";n[n.CartViewBagSignInModal=11]="CartViewBagSignInModal";n[n.CartViewBagPayPalModal=12]="CartViewBagPayPalModal";n[n.CartViewBagPayPalContinue=13]="CartViewBagPayPalContinue";n[n.CartViewBagPayPalCancel=14]="CartViewBagPayPalCancel";n[n.CartViewBagCheckoutButtonClick=18]="CartViewBagCheckoutButtonClick";n[n.CartViewBagPayPalButtonClick=19]="CartViewBagPayPalButtonClick";n[n.CartCheckout1=21]="CartCheckout1";n[n.CartCheckout2=22]="CartCheckout2";n[n.EmailPopupServed=23]="EmailPopupServed";n[n.EmailPopupSubscribed=24]="EmailPopupSubscribed";n[n.LoginSuccessful=25]="LoginSuccessful";n[n.ForgotPassword=26]="ForgotPassword";n[n.ShopbyProductNumber=27]="ShopbyProductNumber";n[n.ShopbyProductNumberSearchResults=28]="ShopbyProductNumberSearchResults";n[n.RegistrationFullPage=29]="RegistrationFullPage";n[n.UpdateItemInBag=30]="UpdateItemInBag";n[n.WishListItemsAdded=31]="WishListItemsAdded";n[n.WishListShared=32]="WishListShared";n[n.EcommerceCheckoutData=33]="EcommerceCheckoutData"}(TrackingEventType||(TrackingEventType={})),function(n){var t=function(n){function t(t){n.call(this,t);this.$baseScope=t}return __extends(t,n),t.prototype.updateRatings=function(n,t){_.each(n,function(n){var i=$("#rating-"+n);i&&i.is(":checked")&&t.indexOf(n.toString())===-1&&i.trigger("click");i&&!i.is(":checked")&&t.indexOf(n.toString())>=0&&i.trigger("click")})},t.$inject=["$scope"],t}(BaseAngularController);n.BaseNavigationController=t}(NavigationModule||(NavigationModule={})),function(n){n[n.Home=0]="Home";n[n.Product=1]="Product";n[n.Category=2]="Category";n[n.SubCategory=3]="SubCategory";n[n.SubSubCategory=4]="SubSubCategory";n[n.Productline=5]="Productline";n[n.LandingPage=6]="LandingPage";n[n.ShoppingCart=7]="ShoppingCart";n[n.PurchaseConfirmation=8]="PurchaseConfirmation";n[n.Search=9]="Search";n[n.NoSearch=10]="NoSearch";n[n.AccountPage=11]="AccountPage";n[n.Wishlist=12]="Wishlist";n[n.OrderHistory=13]="OrderHistory";n[n.Replenish=14]="Replenish";n[n.AddToCart=15]="AddToCart";n[n.EmptyCart=16]="EmptyCart";n[n.QuickViewPopUp=17]="QuickViewPopUp"}(CertonaPageType||(CertonaPageType={})),function(n){var t=function(n){function t(t,i,r){n.call(this,t,i,r);this.$rootScope=t}return __extends(t,n),t.prototype.UpsVerification=function(n){return this.PostJson("/api/addressVerification/upsrequest",{addressSupplied:n},null,!1,null,null,!0)},t.prototype.DisplayModal=function(n){return this.PostJson("/api/addressVerification/displaymodal",{addressVerificationModel:n},null,!1,null,null,!0)},t.ServiceName="addressVerificationService",t.$inject=["$rootScope","$http","$q"],t}(BaseAvonService);n.AddressVerificationService=t}(AddressVerificationModule||(AddressVerificationModule={}));app.service(AddressVerificationModule.AddressVerificationService.ServiceName,AddressVerificationModule.AddressVerificationService),function(n){var t=function(n){function t(t,i,r){var u=this;n.call(this,t,i,r);this.$rootScope=t;this.FormatNavigationText=function(n,t){for(var r,f=[],i=0,e=n;i<e.length;i++)r=e[i],r&&f.push(u.CleanNavigationCaption(r.toLocaleLowerCase()));return""+f.join(t)};this.GetAnalyticsAttributeValue=function(n,t){return n+":"+u.FormatNavigationText(t,">")}}return __extends(t,n),t.prototype.CleanNavigationCaption=function(n){for(var r,u=[],i=0,f=n;i<f.length;i++)r=f[i],t.IsLetterOrDigit(r)&&u.push(r);return u.join("")},t.IsLetterOrDigit=function(n){return t.IsDigit(n)||t.IsLetter(n)},t.IsDigit=function(n){return!isNaN(parseInt(n,10))},t.IsLetter=function(n){return n.toLowerCase()!=n.toLocaleUpperCase()},t.$inject=["$rootScope","$http","$q"],t}(BaseAvonService);n.AnalyticsService=t}(AnalyticsServiceModule||(AnalyticsServiceModule={}));app.service("analyticsService",AnalyticsServiceModule.AnalyticsService),function(n){var t=function(n){function t(t,i,r,u){n.call(this,t,i,r);this.$rootScope=t;this.$http=i;this.$q=r;this.sessionService=u}return __extends(t,n),t.prototype.IsSubscribedToProductWithSku=function(n){for(var u,t=!1,i=0,r=this.$rootScope.Session.AutoReplenishSubscriptions;i<r.length;i++)if(u=r[i],t=_.any(u.Products,function(t){return t.Product&&t.Sku==n&&AutoReplenishStatusCodeHelper.IsActive(t.StatusId)}),t)break;return t},t.prototype.IsSubscribedToProductWithProductId=function(n){for(var u,t=!1,i=0,r=this.$rootScope.Session.AutoReplenishSubscriptions;i<r.length;i++)if(u=r[i],t=_.any(u.Products,function(t){return t.Product&&t.Product.Id==n&&AutoReplenishStatusCodeHelper.IsActive(t.StatusId)}),t)break;return t},t.prototype.HasSubscriptionWithFrequency=function(n){return _.any(this.$rootScope.Session.AutoReplenishSubscriptions,function(t){return t.Frequency==n&&_.any(t.Products,function(n){return n.Product&&AutoReplenishStatusCodeHelper.IsActive(n.StatusId)})})},t.prototype.HasSubscriptionWithCreditCard=function(n){return _.any(this.$rootScope.Session.AutoReplenishSubscriptions,function(t){return t.CreditCardId==n&&_.any(t.Products,function(n){return n.Product&&AutoReplenishStatusCodeHelper.IsActive(n.StatusId)})})},t.prototype.HasActiveSubscriptions=function(){for(var r,n=!1,t=0,i=this.$rootScope.Session.AutoReplenishSubscriptions;t<i.length;t++)if(r=i[t],n=_.any(r.Products,function(n){return n.Product&&AutoReplenishStatusCodeHelper.IsActive(n.StatusId)}),n)break;return n},t.prototype.HasActiveHazardousSubscriptions=function(){for(var r,n=!1,t=0,i=this.$rootScope.Session.AutoReplenishSubscriptions;t<i.length;t++)if(r=i[t],n=_.any(r.Products,function(n){return n.Product&&n.Product.IsHazardous&&AutoReplenishStatusCodeHelper.IsActive(n.StatusId)}),n)break;return n},t.prototype.AreAllSubscriptionsHazardous=function(){var r=!1,t,n,i,u;if(this.HasActiveSubscriptions()){for(n=0,i=this.$rootScope.Session.AutoReplenishSubscriptions;n<i.length;n++)if(u=i[n],t=_.any(u.Products,function(n){return n.Product&&!n.Product.IsHazardous&&AutoReplenishStatusCodeHelper.IsActive(n.StatusId)}),t)break;r=!t}return r},t.prototype.GetActiveSubscriptionsProductIds=function(){var n=_.flatten(_.pluck(this.$rootScope.Session.AutoReplenishSubscriptions,"Products")),t=_.filter(n,function(n){return n.Product&&AutoReplenishStatusCodeHelper.IsActive(n.StatusId)});return _.unique(_.map(n,function(n){return n.Product.Id}))},t.prototype.GetProductSubscriptionFrequency=function(n){for(var i,f,r=null,t=0,u=this.$rootScope.Session.AutoReplenishSubscriptions;t<u.length;t++)if(i=u[t],f=_.any(i.Products,function(t){return t.Product&&t.Sku==n&&AutoReplenishStatusCodeHelper.IsActive(t.StatusId)}),f){r=i.Frequency;break}return r},t.prototype.GetNextShipmentDateByFrequency=function(n){var t=null,r=this.GetActiveSubscriptions(),i=_.find(r,function(t){return t.Frequency==n});return i&&(t=this.ConvertToDate(i.NextShipmentDate)),t},t.prototype.GetActiveSubscriptions=function(){return _.filter(this.$rootScope.Session.AutoReplenishSubscriptions,function(n){return _.any(n.Products,function(n){return n.Product&&AutoReplenishStatusCodeHelper.IsActive(n.StatusId)})})},t.prototype.GetCancelledSubscriptions=function(){return _.filter(this.$rootScope.Session.AutoReplenishSubscriptions,function(n){return _.any(n.Products,function(n){return AutoReplenishStatusCodeHelper.IsInactive(n.StatusId)})})},t.prototype.ConvertToDate=function(n){var r,i;return typeof n=="string"?(i=t.MicrosoftDateFormatRegex.exec(n),r=i&&i[1]?new Date(+i[1]):new Date(n)):r=n instanceof Date?new Date(n.getTime()):null,r},t.$inject=["$rootScope","$http","$q","sessionService"],t.MicrosoftDateFormatRegex=/\/Date\((\d+)\)\//,t}(BaseAvonService);n.AutoReplenishService=t}(AutoReplenishModule||(AutoReplenishModule={}));app.service("autoReplenishService",AutoReplenishModule.AutoReplenishService),function(n){var t=function(n){function t(i,r,u){n.call(this,i,r,u);t.rootScope=i;t.http=r;t.q=u}return __extends(t,n),t.prototype.GetCategoryPosts=function(n,i){this.GetJson("/blog/category/"+n+"/posts/page/"+i.Page).then(function(n){t.rootScope.$broadcast("BlogService.GetPostsResponse",n)})},t.$inject=["$rootScope","$http","$q"],t}(BaseAvonService);n.BlogService=t}(BlogServiceModule||(BlogServiceModule={}));app.service("blogService",BlogServiceModule.BlogService),function(n){var t=function(n){function t(i,r,u){n.call(this,i,r,u);t.rootScope=i;t.http=r;t.q=u}return __extends(t,n),t.prototype.Initialize=function(){return{ShowComments:!1,UseWebSessionId:!1,dopost:!1,customerid:"Avon",issecured:!0}},t.prototype.LogSearchResult=function(n){window.CelebrosAnalytics&&(this.MapAnalyticData(n),window.CelebrosAnalytics.AI_LogSearchResult())},t.prototype.LogProductResult=function(n){window.CelebrosAnalytics&&(this.MapAnalyticData(n),window.CelebrosAnalytics.AI_LogProduct())},t.prototype.MapAnalyticData=function(n){_.extend(window.CelebrosAnalytics,n)},t.$inject=["$rootScope","$http","$q"],t}(BaseAvonService);n.CelebrosService=t}(CelebrosServiceModule||(CelebrosServiceModule={}));app.service("celebrosService",CelebrosServiceModule.CelebrosService),function(n){var t=function(n){function t(t,i,r){n.call(this,t,i,r);this.$rootScope=t}return __extends(t,n),t.prototype.ChangeRep=function(n,t,i,r,u){var f={repId:n,isFundraiserRep:t,returnUrl:i,redirect:r,mode:u};return this.PostJson("/api/login/changerep",f,null,null,null,null,!0)},t.$inject=["$rootScope","$http","$q"],t}(BaseAvonService);n.ChangeRepService=t}(ChangeRepServiceModule||(ChangeRepServiceModule={}));app.service("changeRepService",ChangeRepServiceModule.ChangeRepService),function(n){var t=function(n){function t(i,r,u){n.call(this,i,r,u);t.rootScope=i;t.http=r;t.q=u}return __extends(t,n),t.$inject=["$rootScope","$http","$q"],t}(BaseAvonService);n.ConfirmationService=t}(ConfirmationServiceModule||(ConfirmationServiceModule={}));app.service("confirmationService",ConfirmationServiceModule.ConfirmationService),function(n){var t=function(n){function t(i,r,u){n.call(this,i,r,u);t.rootScope=i;t.http=r;t.q=u}return __extends(t,n),t.prototype.SendContactRequest=function(n,i){this.PostJson("/api/contact/contactmeform",{contactMeFormData:n,recaptchaEncodedResponse:i}).success(function(n){n!==null&&t.rootScope.$broadcast("ContactService.ContactRequestResponse",n)}).error(function(n){t.rootScope.$broadcast("ContactService.ContactRequestResponse",n)})},t.prototype.SaveContactPreferences=function(n,i){n.Source=i;this.PostJson("/api/contact/customercontactpreferencessave",n).success(function(n){n!==null&&(AVON.customerContactPreferences=n.Data,t.rootScope.$broadcast("ContactService.PreferencesUpdated",n))})},t.$inject=["$rootScope","$http","$q"],t}(BaseAvonService);n.ContactService=t}(ContactServiceModule||(ContactServiceModule={}));app.service("contactService",ContactServiceModule.ContactService),function(n){var t=function(){function n(){this.supportedIinRanges=AVON.SupportedIinRanges}return n.prototype.GetCreditCardMaxLength=function(n){var t,i=this.GetCreditCardType(n),r;switch(i){case CreditCardType.Unknown:t=this.getMaxCreditCardLength();break;case CreditCardType.Visa:case CreditCardType.MasterCard:t=16;break;case CreditCardType.Jcb:case CreditCardType.Discover:r=this.getIinRange(i,n);t=r.MaximumDigits;break;case CreditCardType.Amex:t=15}return t},n.prototype.GetCreditCardType=function(n){var t=CreditCardType.Unknown;return n&&(new RegExp("^4[0-9]{6,}$").test(n)?t=CreditCardType.Visa:new RegExp("^5[1-5][0-9]{5,}$").test(n)||new RegExp("^(222[1-9]|2[3-6][0-9]{2}|27[0-1][0-9]|2720)[0-9]{2,}$").test(n)?t=CreditCardType.MasterCard:new RegExp("^3[47][0-9]{5,}$").test(n)?t=CreditCardType.Amex:this.isIinSupported(CreditCardType.Discover,n)?t=CreditCardType.Discover:this.isIinSupported(CreditCardType.Jcb,n)&&(t=CreditCardType.Jcb)),t},n.prototype.isIinSupported=function(n,t){return this.getIinRange(n,t)!=null},n.prototype.getIinRange=function(n,t){var r=this,u=this.supportedIinRanges[CreditCardType[n]],i=null;return t&&(i=_(u).find(function(n){return r.isRangeValid(n,t)})),i},n.prototype.getMaxCreditCardLength=function(){var n=0,t,i,r;for(t in this.supportedIinRanges)i=this.supportedIinRanges[t],r=_(i).max(function(n){return n.MaximumDigits}).MaximumDigits,n=Math.max(n,r);return Math.max(n,16)},n.prototype.isRangeValid=function(n,t){var r=t.substr(0,n.RangeLength),u=Math.pow(10,n.RangeLength-r.length),i=parseInt(r)*u,f=i+u-1;return i>=n.Start&&i<=n.End&&f>=n.Start&&f<=n.End},n.$inject=[],n}();n.CreditCardService=t}(CreditCardServiceModule||(CreditCardServiceModule={}));app.service("creditCardService",CreditCardServiceModule.CreditCardService),function(n){var t=function(n){function t(i,r,u){n.call(this,i,r,u);t.rootScope=i;t.http=r;t.q=u}return __extends(t,n),t.prototype.SaveMyAddresses=function(n,i,r,u){this.PostJson("/api/customer/updatemyaddresses",{addresses:n,saveInDatabase:i,isRequestFromBillingAndShippingPage:r,isFirstTime:u}).success(function(n){n!==null&&t.rootScope.$broadcast("CustomerService.UpdateAddress",n)}).error(function(n){t.rootScope.$broadcast("CustomerService.UpdateAddress",n)})},t.prototype.RegisterLead=function(n){this.PostJson("/api/customer/registerlead",{lead:n}).success(function(n){n!==null&&t.rootScope.$broadcast("CustomerService.RegisterLead",n)}).error(function(n){t.rootScope.$broadcast("CustomerService.RegisterLead",n)})},t.prototype.DiscontinueAllAutoReplenishmentProducts=function(){this.PostJson("/api/myaccount/autoreplenishmentdiscontinueall",{}).success(function(n){n!==null&&t.rootScope.$broadcast("MyAccountService.DiscontinueAllAutoReplenishmentProducts",n)}).error(function(n){t.rootScope.$broadcast("MyAccountService.DiscontinueAllAutoReplenishmentProducts",n)})},t.prototype.DiscontinueHazmatAutoReplenishmentProducts=function(){this.PostJson("/api/myaccount/autoreplenishmentdiscontinuehazmats",{}).success(function(n){n!==null&&t.rootScope.$broadcast("MyAccountService.DiscontinueHazmatAutoReplenishmentProducts",n)}).error(function(n){t.rootScope.$broadcast("MyAccountService.DiscontinueHazmatAutoReplenishmentProducts",n)})},t.prototype.ShowRestrictedStateInline=function(n){t.rootScope.$broadcast("MyAccountService.ShowRestrictedStateInline",n)},t.$inject=["$rootScope","$http","$q"],t}(BaseAvonService);n.CustomerService=t}(CustomerServiceModule||(CustomerServiceModule={}));app.service("customerService",CustomerServiceModule.CustomerService),function(n){var t=function(n){function t(t,i,r){n.call(this,t,i,r);this.$rootScope=t}return __extends(t,n),t.prototype.GetCustomerToken=function(){return this.GetJson("/api/digitalcatalog/getcustomertoken",null,null,!1)},t.ServiceName="digitalCatalogService",t.$inject=["$rootScope","$http","$q"],t}(BaseAvonService);n.DigitalCatalogService=t}(DigitalCatalogModule||(DigitalCatalogModule={}));app.service(DigitalCatalogModule.DigitalCatalogService.ServiceName,DigitalCatalogModule.DigitalCatalogService),function(n){var t=function(n){function t(i,r,u){n.call(this,i,r,u);t.rootScope=i;t.http=r;t.q=u}return __extends(t,n),t.prototype.reDrawAllIcons=function(){try{window.FB&&window.FB.XFBML&&window.FB.XFBML.parse()}catch(n){}},t.$inject=["$rootScope","$http","$q"],t}(BaseAvonService);n.FacebookService=t}(FacebookServiceModule||(FacebookServiceModule={}));app.service("facebookService",FacebookServiceModule.FacebookService),function(n){var t=function(n){function t(t,i,r,u){n.call(this,t,i,r);this.$rootScope=t;this.emailSignUpTrackingService=u}return __extends(t,n),t.prototype.findByName=function(n){var t=this;this.PostJson("/api/findarep/findbyname",n).success(function(n){n!==null&&t.$rootScope.$broadcast("FindARepService.FindARepResponse",n)})},t.prototype.findByAddress=function(n){var t=this;this.PostJson("/api/findarep/findbyaddress",n).success(function(n){n!==null&&t.$rootScope.$broadcast("FindARepService.FindARepResponse",n)})},t.prototype.findByZip=function(n,t,i){var r=this;this.PostJson("/api/findarep/findbyzip",{zipCode:n,longitude:t,latitude:i}).success(function(n){n!==null&&r.$rootScope.$broadcast("FindARepService.FindARepResponse",n)})},t.prototype.selectRep=function(n,t,i){var r=this;this.PostJson("/api/findarep/selectrep",{repId:n.Id,setCustomerDirectDelivery:n.SetAttachingCustomerDirectDeliveryOnly,returnUrl:t,changeRepFlow:i},null,null,null,null,!0).success(function(n){r.$rootScope.$broadcast("FindARepService.SelectRepSuccess",n);r.emailSignUpTrackingService.TrackEmailSignUp(EmailSubscriptionSource.AttachRep)})},t.prototype.getRepStates=function(){var n=this;this.GetJson("/api/findarep/getRepStates",!0,!0,!1).then(function(t){t.ErrorCode===AjaxError.None&&n.$rootScope.$broadcast("FindARepService.FindARepStatesReturned",t)})},t.$inject=["$rootScope","$http","$q","emailSignUpTrackingService"],t}(BaseAvonService);n.FindARepService=t}(FindARepServiceModule||(FindARepServiceModule={}));app.service("findARepService",FindARepServiceModule.FindARepService),function(n){var t=function(){function n(){}return n}();n.MonotypeTrackingEntity=t}(FontTrackingServiceModule||(FontTrackingServiceModule={})),function(n){var t=function(n){function t(t,i,r){n.call(this,t,i,r);this.$rootScope=t;this.$http=i}return __extends(t,n),t.prototype.TrackFontsUsage=function(){this.trackMonotypeFonts()},t.prototype.trackMonotypeFonts=function(){for(var t,r,u={cache:!0},n=0,i=[{UserId:"7db878ba-d0fd-4e5a-b0ec-1d3133b7ef5c",FontIds:["692322","692325"]},{UserId:"d9790ada-acc0-47f4-82ad-ec87dcab2f2b",FontIds:["5730936","5730943","5730950","5730957"]}];n<i.length;n++)t=i[n],r="https://fast.fonts.net/lt/1.css?apiType=css&c="+t.UserId+"&fontids="+t.FontIds.join(","),this.$http.get(r,u)},t.$inject=["$rootScope","$http","$q"],t}(BaseAvonService);n.FontTrackingService=t}(FontTrackingServiceModule||(FontTrackingServiceModule={}));app.service("fontTrackingService",FontTrackingServiceModule.FontTrackingService),function(n){var t=function(n){function t(t,i,r,u){n.call(this,t,i,r);this.$rootScope=t;this.modalService=u}return __extends(t,n),t.prototype.StartShoppingFundraiser=function(n){return this.PostJson("/api/fundraiser/startshopping",{fundraiserVanityName:n},null,!1).error(function(){})},t.prototype.StopShoppingFundraiser=function(){return this.PostJson("/api/fundraiser/stopshopping",{},null,!1).error(function(){})},t.prototype.RefreshIdentityFundraiser=function(){return this.PostJson("/api/fundraiser/refreshidentityfundraiser",{}).error(function(){}).then(function(n){return n.data.Data})},t.prototype.DisplayFundraiserHasEndedModel=function(){this.modalService.ShowModalUrl("/api/fundraiser/getfundraiserhasendedmodal")},t.ServiceName="fundraiserService",t.$inject=["$rootScope","$http","$q","modalService"],t}(BaseAvonService);n.FundraiserService=t}(FundraiserModule||(FundraiserModule={}));app.service(FundraiserModule.FundraiserService.ServiceName,FundraiserModule.FundraiserService),function(n){var t=function(n){function t(t,i,r){n.call(this,t,i,r)}return __extends(t,n),t.prototype.getRepresentativeDetails=function(){return this.GetJson("/myavon/api/getrepresentativestoredetails",!0)},t.$inject=["$rootScope","$http","$q"],t}(BaseAvonService);n.GeminiRepDetailsService=t}(OnlineStoreModule||(OnlineStoreModule={}));app.service("geminiRepDetailsService",OnlineStoreModule.GeminiRepDetailsService),function(n){var t=function(n){function t(t,i,r,u){n.call(this,t,i,r);this.$window=u}return __extends(t,n),Object.defineProperty(t.prototype,"state",{get:function(){return this.$window.history.state},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"IsPushStateSupported",{get:function(){return this.$window.history.pushState?!0:!1},enumerable:!0,configurable:!0}),t.prototype.PushStateUrl=function(n){this.$window.history.pushState(this.state,"",n)},t.prototype.PushState=function(n,t,i,r){i===void 0&&(i=null);r===void 0&&(r=null);var u=this.mergeWithCurrentState(n,t);this.$window.history.pushState(u,i,r)},t.prototype.ReplaceStateUrl=function(n){this.$window.history.replaceState(this.state,"",n)},t.prototype.GetStateData=function(n){return this.state==null?null:this.state[n]},t.prototype.ReplaceState=function(n,t,i){i===void 0&&(i=null);var r=this.mergeWithCurrentState(n,t);this.$window.history.replaceState(r,"",i)},t.prototype.OnPopState=function(n,t){this.$window.addEventListener("popstate",function(i){var r,u;r=i.state?i.state[n]:null;u={state:r,originalEvent:i};t(u)})},t.prototype.Back=function(n){this.$window.history.back(n)},t.prototype.Forward=function(n){this.$window.history.forward(n)},t.prototype.Go=function(n){this.$window.history.go(n)},t.prototype.mergeWithCurrentState=function(n,t){var r={},i=this.state,u;if(i&&typeof i!="string")for(u in i)r[u]=i[u];return r[n]=t,r},t.$inject=["$rootScope","$http","$q","$window"],t}(BaseAvonService);n.HistoryService=t}(HistoryServiceModule||(HistoryServiceModule={}));app.service("historyService",HistoryServiceModule.HistoryService),function(n){var t=function(n){function t(t,i,r,u){n.call(this,t,i,r);this.$window=u;this.activeObservers=[];this.isIntersectingPolyfillFix()}return __extends(t,n),t.prototype.Observe=function(n,t,i){for(var u=this.getOrCreateIOInstance(t,i),f=angular.element(n),r=0;r<f.length;r++)this.observeSingleElement(u,f[r]);return u.Observer},t.prototype.Unobserve=function(n,i){var u=angular.element(i)[0],r;n.unobserve(u);angular.element(i).unbind(t.DestroyEventName);r=this.getInstaneByObserver(n);r&&(this.removeObservedElement(r.ElementsObserved,u),this.removeObserverIfInactive(r))},t.prototype.observeSingleElement=function(n,t){n.Observer.observe(t);n.ElementsObserved.push(t);this.unobserveOnDestroy(t,n.Observer)},t.prototype.unobserveOnDestroy=function(n,i){var r=this;angular.element(n).bind(t.DestroyEventName,function(){r.Unobserve(i,n)})},t.prototype.removeObserverIfInactive=function(n){if(n.ElementsObserved.length==0){var t=this.activeObservers.indexOf(n);this.activeObservers.splice(t,1)}},t.prototype.removeObservedElement=function(n,t){var i=n.indexOf(t);i>-1&&n.splice(i,1)},t.prototype.getInstaneByObserver=function(n){for(var i,r=null,t=0,u=this.activeObservers;t<u.length;t++)if(i=u[t],i.Observer==n){r=i;break}return r},t.prototype.getOrCreateIOInstance=function(n,t){var i=this.getIOInstance(n,t);return i||(i={Callback:n,Options:t,Observer:new IntersectionObserver(n,t),ElementsObserved:[]},this.activeObservers.push(i)),i},t.prototype.getIOInstance=function(n,t){for(var i,u,r=0,f=this.activeObservers;r<f.length;r++)if(i=f[r],i.Callback==n&&i.Options.root==t.root&&i.Options.rootMargin==t.rootMargin&&i.Options.threshold==t.threshold){u=i;break}return u},t.prototype.isIntersectingPolyfillFix=function(){"IntersectionObserver"in this.$window&&"IntersectionObserverEntry"in this.$window&&"intersectionRatio"in IntersectionObserverEntry.prototype&&!("isIntersecting"in IntersectionObserverEntry.prototype)&&Object.defineProperty(IntersectionObserverEntry.prototype,"isIntersecting",{get:function(){return this.intersectionRatio>0}})},t.$inject=["$rootScope","$http","$q","$window"],t.DestroyEventName="$destroy.IntersectionObserverService",t}(BaseAvonService);n.IntersectionObserverService=t}(IntersectionObserverModule||(IntersectionObserverModule={}));app.service("intersectionObserverService",IntersectionObserverModule.IntersectionObserverService),function(n){var t=function(){function n(n,t,i,r){this.$rootScope=n;this.$window=t;this.urlService=i;this.modalService=r}return n.prototype.ShowLoginModal=function(n,t){var u,i,r;n===void 0&&(n=null);t===void 0&&(t=null);this.$window&&(this.$window.LoginModalDisplayed=!0,this.$window.IsEarmarkCollapsed===!1&&$("#earmark-body").addClass("earmark-out"));this.$rootScope.ShowLoading(AVON.messages.spinner_loading);u=this.$rootScope.$eval(angular.element("#LoginModal").attr("modal"));i=u.UrlToLoad;i=n?this.urlService.SetQueryStringParameterToUrl(i,"mode",n):this.urlService.RemoveQueryStringParameterFromUrl(i,"mode");i=t?this.urlService.SetQueryStringParameterToUrl(i,"returnUrl",t):this.urlService.RemoveQueryStringParameterFromUrl(i,"returnUrl");r={AllowExit:!0,KeepLoaded:!1,UrlToLoad:i};angular.element("#LoginModal").attr("modal",JSON.stringify(r));this.modalService.ShowModalWithOptions("#LoginModal",r)},n.$inject=["$rootScope","$window","urlService","modalService"],n}();n.LoginModalService=t}(LoginModalServiceModule||(LoginModalServiceModule={}));app.service("loginModalService",LoginModalServiceModule.LoginModalService),function(n){var t=function(n){function t(t,i,r){n.call(this,t,i,r);this.$rootScope=t}return __extends(t,n),t.prototype.GetActiveCampaigns=function(){var n=this;this.GetJson("/api/getactivecampaigns",!0,!1,!1).then(function(t){t.ErrorCode===AjaxError.None&&n.$rootScope.$broadcast("LpmContextMenuService.ActiveCampaignsReceived",t)})},t.prototype.GetActiveLookup=function(){var n=this;this.GetJson("/api/lookups",!0,!1,!1).then(function(t){t.ErrorCode===AjaxError.None&&n.$rootScope.$broadcast("LpmContextMenuService.ActiveLookupReceived",t)})},t.prototype.GetEnvironmentInfo=function(){var n=this;this.GetJson("/api/environmentInfo",!0,!1,!1).then(function(t){t.ErrorCode===AjaxError.None&&n.$rootScope.$broadcast("LpmContextMenuService.EnvironmentInfoReceived",t)})},t.prototype.SetCampaign=function(n,t){this.PostJson("/admin/campaign",{id:n,redirectUrl:t})},t.prototype.SetShowEditLpmModuleButtons=function(n){return this.PostJson("/admin/setshoweditlpmmodulebuttons",{ShowEditLpmModuleButtons:n})},t.$inject=["$rootScope","$http","$q","$window"],t}(BaseAvonService);n.LpmContextMenuService=t}(LpmContextMenuServiceModule||(LpmContextMenuServiceModule={}));app.service("LpmContextMenuService",LpmContextMenuServiceModule.LpmContextMenuService),function(n){var t=function(n){function t(t,i,r,u){n.call(this,t,i,r);this.$rootScope=t;this.modalService=u}return __extends(t,n),t.prototype.NotifyMe=function(n){var i=this;return this.PostJson("/api/product/notifymemodal",n).then(function(n){return n!==null&&i.$rootScope.$broadcast(t.NotifyMeResponseBroadcastName,n.data),n.data.Data},function(n){i.$rootScope.$broadcast(t.NotifyMeResponseBroadcastName,n.data)})},t.prototype.NotifyMeQuickShop=function(n){var i=this;this.PostJson("/api/product/notifymemodal",n).success(function(n){n!==null&&i.$rootScope.$broadcast(t.NotifyMeQuickShopResponseBroadcastName,n)}).error(function(n){i.$rootScope.$broadcast(t.NotifyMeQuickShopResponseBroadcastName,n)})},t.prototype.OpenNotifyMeModal=function(n,t,i,r){var u,f,e;t===void 0&&(t=null);i===void 0&&(i=null);r===void 0&&(r=0);u="/product/notifymemodal?pfid="+n;t&&(u+="&fsc="+t);f="NotifyMeModal";i&&(f+=" "+i);this.$rootScope.ShowLoading(AVON.messages.spinner_loading);e={AllowExit:!0,Model:null,KeepLoaded:!1,UrlToLoad:u,CssClass:f,Position:r};this.modalService.ShowModalWithOptions("#ContentModal",e)},t.prototype.OpenNotifyMeModalSuccess=function(n){var i="/product/notifymemodalsuccess?lang="+n,t;this.$rootScope.ShowLoading(AVON.messages.spinner_loading);t={KeepLoaded:!1,AllowExit:!0,UrlToLoad:i};this.modalService.ShowModalWithOptions("#ContentModal",t)},t.$inject=["$rootScope","$http","$q","modalService"],t.NotifyMeResponseBroadcastName="NotifyMeService.NotifyMeResponse",t.NotifyMeQuickShopResponseBroadcastName="NotifyMeService.NotifyMeQuickShopResponse",t}(BaseAvonService);n.NotifyMeService=t}(NotifyMeSerivceModule||(NotifyMeSerivceModule={}));app.service("NotifyMeService",NotifyMeSerivceModule.NotifyMeService),function(n){var t=function(n){function t(t,i,r,u,f){n.call(this,t,i,r);this.$rootScope=t;this.trackingService=u;this.emailSignUpTrackingService=f}return __extends(t,n),t.prototype.register=function(n,t){var i=this;this.PostJson("/api/login/register",n,t).success(function(t){t!==null&&(t.ErrorCode!=AjaxError.None||n.IsGuestShopper||i.TrackRegisterEvent(n.mode,n.NotifySpecialOffers),i.$rootScope.$broadcast("RegistrationService.RegisterResponse",t))}).error(function(n){i.$rootScope.$broadcast("RegistrationService.RegisterResponse",n)})},t.prototype.getCustomerByEmail=function(n,t){var i=this;return this.PostJson("/api/login/getCustomerByEmail",{email:n,saveInSession:t}).success(function(n){n!==null&&i.$rootScope.$broadcast("RegistrationService.RegisteredCustomerAsGuestResponse",n)}).error(function(n){i.$rootScope.$broadcast("RegistrationService.RegisteredCustomerAsGuestResponse",n)})},t.prototype.TrackRegisterEvent=function(n,t){if(this.trackingService.TrackEventItem({Type:TrackingEventType.CartNewCustAcct}),t){var i=n=="Checkout"?EmailSubscriptionSource.RegistrationViaCheckout:EmailSubscriptionSource.Registration;this.emailSignUpTrackingService.TrackEmailSignUp(i)}},t.$inject=["$rootScope","$http","$q","trackingService","emailSignUpTrackingService"],t}(BaseAvonService);n.RegistrationService=t}(RegistrationServiceModule||(RegistrationServiceModule={}));app.service("registrationService",RegistrationServiceModule.RegistrationService),function(n){var t=function(n){function t(t,i,r,u,f,e){n.call(this,t,i,r);this.$rootScope=t;this.sessionService=u;this.historyService=f;this.urlService=e}return __extends(t,n),t.prototype.Initialize=function(){var n=this;this.sessionService.WhenReady().then(function(t){t.Rep&&t.Rep.WebUrl&&n.AppendRepParameterToUrl(t.Rep.WebUrl)});this.$rootScope.$watch("Session.Rep.WebUrl",function(t,i){t!=i&&n.AppendRepParameterToUrl(t)})},t.prototype.AppendRepParameterToUrl=function(n){var i=window.location.href,t=i,r=this.urlService.GetQueryStringParameterValue(i,"rep");r&&r==n||n&&(t=this.urlService.SetQueryStringParameterToUrl(i,"rep",n));t=this.removeRepIdFromUrlIfHasRepName(t);i!=t&&this.historyService.ReplaceStateUrl(t)},t.prototype.removeRepIdFromUrlIfHasRepName=function(n){var t=n,i=this.urlService.GetQueryStringParameterValue(t,"rep");return i&&(t=this.urlService.RemoveQueryStringParameterFromUrl(t,"repid"),t=this.urlService.RemoveQueryStringParameterFromUrl(t,"rep_id")),t},t.$inject=["$rootScope","$http","$q","sessionService","historyService","urlService"],t}(BaseAvonService);n.RepQueryStringParameterService=t}(RepQueryStringParameterModule||(RepQueryStringParameterModule={}));app.service("repQueryStringParameterService",RepQueryStringParameterModule.RepQueryStringParameterService),function(n){var t=function(n){function t(i,r,u,f){n.call(this,i,r,u);this.$http=r;this.urlService=f;this.searchTerm=this.getDefaultSearchTerm();this.searchContainsResults=!1;this.shopSearchActionUrl=""+this.getBaseUrl()+this.urlService.Action("Index","Search");this.activeClass="active";this.celebrosSearchRegex={searchValue:/[^0-9A-Za-z]/g,replaceValue:"_"};this.suppliedSearchRegex={searchValue:/[^0-9A-Za-zñÑáÁéÉíÍóÓúÚüÜ_ ]/g,replaceValue:""};this.xmlToJson=new X2JS;this.maxNumberOfSuggestionsPerType=5;t.rootScope=i;this.CelebrosSearchEnabled=AVON.CelebrosSearchEnabled}return __extends(t,n),t.prototype.getDefaultSearchTerm=function(){return{value:"",type:SearchTermType.Default,resultObject:null}},t.prototype.filterCelebrosSearchResults=function(n){return _.filter(n.AutoCompleteResultSet.SuggestionGroups.ArrayOfSug.sug,function(n){return n.r!=="0"})},t.prototype.mapCelebrosSearchSuggestions=function(n){return _.map(n,function(n){return{value:n.dc,id:n.r,type:SearchTermType.Celebros}})},t.prototype.getArticleResults=function(n){var t=this,i="/api/search/getarticlesbysearch/"+n,r={method:"GET",url:i,headers:{"Content-Type":"jsonp","X-Requested-With":"XMLHttpRequest"}},u=this.$http(r);return u.then(function(n){var r=[],u,o,i,f,e;if(t.searchContainsResults=r.length>0,u=n.data,u.Data)for(o=u.Data,i=0,f=o;i<f.length;i++)e=f[i],r.push({type:SearchTermType.Content,value:e.Title,resultObject:e});return r})},t.prototype.getCelebrosResults=function(n){var t=this,r,u,f,i;return this.CelebrosSearchEnabled?(r="https://avonv8-ac.celebros.com/AutoCompleteWebServiceV2/GetSuggestions.aspx?strPrefix="+n+"&strSiteKey=AvonV8",u=$.ajax({url:r,dataType:"jsonp"}),u.then(function(n){var i=[],f=n.data,r=t.xmlToJson.xml_str2json(f),u;return r.AutoCompleteResultSet.Succeeded==="true"&&(u=t.filterCelebrosSearchResults(r),i=t.mapCelebrosSearchSuggestions(u)),t.searchContainsResults=i.length>0,i})):(f=[],i=jQuery.Deferred(),i.resolve(f),i)},t.prototype.sanitizeSearchTerm=function(n,t){return n.replace(t.searchValue,t.replaceValue)},t.prototype.getSearchPageUrl=function(n,t,i){var r,u;return t.value?(r=this.sanitizeSearchTerm(t.value,this.celebrosSearchRegex),u=i+"/"+r+"?cel_id="+n+"%7CT_"+r):(r=this.sanitizeSearchTerm(n,this.suppliedSearchRegex),u=i+"/"+r),u},t.prototype.processSelectedSearchTermByType=function(n,t){return t===void 0&&(t={value:"",type:SearchTermType.Default,resultObject:null}),this.getSearchPageUrl(n.value,t,this.shopSearchActionUrl)},t.prototype.isMinimumInputLength=function(){return this.searchTerm.value.length>=1},t.$inject=["$rootScope","$http","$q","urlService"],t}(BaseAvonService);n.SearchService=t}(SearchServiceModule||(SearchServiceModule={}));app.service("searchService",SearchServiceModule.SearchService),function(n){var i=function(){function n(){}return n}(),t;n.SweepstakesFormData=i;t=function(n){function t(t,i,r,u){n.call(this,t,i,r);this.$rootScope=t;this.emailSignUpTrackingService=u}return __extends(t,n),t.prototype.SubmitSweepstakesForm=function(n,t){var i=this;this.PostJson("/api/sweepstakes/submit",{sweepstakesFormData:n,reCaptchaEncodedResponse:t}).success(function(n){i.$rootScope.$broadcast("SweepstakesService.SubmitSweepstakesForm",n);n&&i.emailSignUpTrackingService.TrackEmailSignUp(EmailSubscriptionSource.RegistrationViaSweepstakes)}).error(function(n){i.$rootScope.$broadcast("SweepstakesService.SubmitSweepstakesForm",n)})},t.$inject=["$rootScope","$http","$q","emailSignUpTrackingService"],t}(BaseAvonService);n.SweepstakesService=t}(SweepstakesModule||(SweepstakesModule={}));app.service("sweepstakesService",SweepstakesModule.SweepstakesService),function(n){var t=function(n){function t(t,i,r,u){var f=this;n.call(this,t,i,r);this.$rootScope=t;this.$compile=u;this.Tooltips={};this.tooltipBaseContainer=this.getBaseTooltipsContainer();angular.element(document).bind("click",function(n){var r,t,i;for(r in f.Tooltips)t=f.Tooltips[r],i=angular.element(n.target)[0],t.Scope.IsVisible()&&(t.Scope.OnElement[0]==i||t.Element[0]==i||jQuery.contains(t.Scope.OnElement[0],i)||jQuery.contains(t.Element[0],i)||t.Scope.$apply(function(n){n.IsOverLink=!1;n.IsOverTooltip=!1}))})}return __extends(t,n),t.prototype.RegisterTooltip=function(n,t,i){var r=this.Tooltips[n];r&&(r.Scope.$destroy(),r.Element.remove());this.tooltipBaseContainer.append(t);this.Tooltips[n]={Element:t,Scope:i}},t.prototype.ShowTooltip=function(n,t,i,r){this.ShowTooltipWithModel(n,t,i,null,r)},t.prototype.ShowTooltipWithModel=function(n,t,i,r,u){var e=this.getJQueryElement(t),o=this.getJQueryElement(i),f=this.Tooltips[n];f&&f.Scope.Show(e,o,r,u)},t.prototype.ShowBasicTooltip=function(n,t,i){var r="basicTooltip",u,f;this.Tooltips[r]||(u=angular.element('<div tooltip-content="'+r+'">\n                    <a data-ng-if="Model.Link" data-ng-href="{{ Model.Link }}">{{ Model.Label }}<\/a>\n                    <p data-ng-if="!Model.Link">{{ Model.Label }}<\/p>\n                 <\/div>'),this.$compile(u)(this.$rootScope.$new()));f={Label:t,Link:i};this.ShowTooltipWithModel(r,n,null,f)},t.prototype.MouseLeaveLink=function(n){var t,i;if(n)t=this.Tooltips[n],t&&(t.Scope.IsOverLink=!1);else for(i in this.Tooltips)this.Tooltips[i].Scope.IsOverLink=!1},t.prototype.HideTooltip=function(n){var t,i;if(n)t=this.Tooltips[n],t&&t.Scope.HideTooltip();else for(i in this.Tooltips)this.Tooltips[i].Scope.HideTooltip()},t.prototype.getJQueryElement=function(n){return n instanceof jQuery?n:angular.element(n)},t.prototype.getBaseTooltipsContainer=function(){var n=angular.element("#Tooltips");return n.length==0&&(n=angular.element('<div id="Tooltips" class="tooltips"><\/div>').appendTo("body")),n},t.$inject=["$rootScope","$http","$q","$compile"],t}(BaseAvonService);n.TooltipService=t}(TooltipModule||(TooltipModule={}));app.service("tooltipService",TooltipModule.TooltipService),function(n){var t=function(n){function t(t,i,r,u,f){n.call(this,t,i,r);this.$rootScope=t;this.trackingService=u;this.$window=f}return __extends(t,n),Object.defineProperty(t.prototype,"UTagData",{get:function(){return this.$window.utag_data},enumerable:!0,configurable:!0}),t.prototype.TrackItemsAddedToBag=function(n,t,i,r){for(var u,v,y,e=[],o=[],s=[],h=[],c=[],l=[],p=this.GetTrackingAddToBagFindingCategory(t),f=0,a=n;f<a.length;f++)u=a[f],h.push(u.Fsc),c.push(u.Sku),l.push(u.Quantity.toString()),e.push(u.ProductBusinessSegmentName.toLowerCase()),o.push(u.ProductBusinessCategoryName.toLowerCase()),s.push(u.ProductBusinessUnitName.toLowerCase());this.trackingService.UTagData&&(this.trackingService.UTagData.cart_subtotal=i.toString(),this.trackingService.UTagData.cart_total_quantity=r.toString(),this.trackingService.UTagData.product_finding_method=t);v=t===TrackingAddToCartType.ProductDetailPageQuickShopModal?"quickshop add":"product add";y={event_name:"cart_add",event_category:"cart actions",event_label:v,event_action:"cart add",product_fsc:h,product_sku:c,product_quantity:l,product_finding_method:t,product_finding_category:p,product_business_segment_name:e,product_business_category_desc:o,product_business_unit_name:s,digital_catalog:this.UTagData.digital_catalog};this.trackingService.TrackEvent(y)},t.prototype.GetTrackingAddToBagFindingCategory=function(n){var t,r=this.$rootScope.GetValueFromSessionStorage("AvonBreadcrumbs"),i,u,f,e;switch(n){case TrackingAddToCartType.ProductDetailQuickshop:t=r.length==1&&r[0].CrumbType==BreadcrumbTypes.Home?"homepage":""+this.GetFindingCategoryPath(!1);break;case TrackingAddToCartType.SearchResultsQuickshop:case TrackingAddToCartType.Search:t="Search: results page";break;case TrackingAddToCartType.ProductCategoryQuickshop:t=""+this.GetFindingCategoryPath(!1);break;case TrackingAddToCartType.ProductDetailPage:if(i=/^https?:\/\/[^\s\/]+?\/(?:es\/)?(product\/\S+?)(?:\?.*)?$/g.exec(document.referrer),i&&i.length){t="cross-sell-clickthru: "+i[1];break}if(u=/^https?:\/\/[^\s\/]+?\/(?:es\/)?(?:\?.*)?$/g.exec(document.referrer),u&&u.length){t="homepage";break}if(f=/^https?:\/\/[^\s\/]+?\/(?:es\/)?(products\/productline\/\S+?)(?:\?.*)?$/g.exec(document.referrer),f&&f.length){t="product line"+this.GetFindingProductLine();break}if(e=/^https?:\/\/[^\s\/]+?\/(?:es\/)?(blog\/search\/searchterm\/\S+?)(?:\?.*)?$/g.exec(document.referrer),e&&e.length){t="blog search";break}t=_.any(r,function(n){return n.CrumbType==BreadcrumbTypes.SearchTerm})?"Search: product detail page":""+this.GetFindingCategoryPath(!1);break;case TrackingAddToCartType.ProductLinePage:t="product line"+this.GetFindingProductLine();break;case TrackingAddToCartType.ProductDetailPageQuickShopModal:t="cross-sell: "+this.GetFindingCategoryPath(!0);break;default:t=n}return t},t.prototype.GetFindingProductLine=function(){return this.$rootScope.GetValueFromSessionStorage("SelectedProductLineId")?" "+this.$rootScope.GetValueFromSessionStorage("SelectedProductLineId"):""},t.prototype.GetFindingCategoryPath=function(n){var t=this.$rootScope.GetValueFromSessionStorage("AvonBreadcrumbs");if(!t)return"";if(!n)while(!t[t.length-1].HasUrl)t.pop();return _.map(t,function(n){return n.Text}).splice(1).join("/")},t.$inject=["$rootScope","$http","$q","trackingService","$window"],t}(BaseAvonService);n.AddToBagTrackingService=t}(TrackingServiceModule||(TrackingServiceModule={}));app.service("addToBagTrackingService",TrackingServiceModule.AddToBagTrackingService),function(n){var t=function(n){function t(t,i,r,u){n.call(this,t,i,r);this.$rootScope=t;this.trackingService=u}return __extends(t,n),t.prototype.TrackEmailSignUp=function(n){var t={event_name:"email_signup",visitor_email_subscription_type:EmailSubscriptionSource[n]};this.trackingService.TrackEvent(t)},t.$inject=["$rootScope","$http","$q","trackingService"],t}(BaseAvonService);n.EmailSignUpTrackingService=t}(TrackingServiceModule||(TrackingServiceModule={}));app.service("emailSignUpTrackingService",TrackingServiceModule.EmailSignUpTrackingService),function(n){var t=function(n){function t(t,i,r){n.call(this,t,i,r);this.$q=r}return __extends(t,n),t.prototype.WaitFor=function(n,i,r){i===void 0&&(i=null);r===void 0&&(r=t.DefaultCheckInterval);i<=0&&(i=null);r<=0&&(r=t.DefaultCheckInterval);var u=this.$q.defer();return this.wait(function(){return n()?!0:!1},function(){u.resolve()},function(){u.reject()},i),u.promise},t.prototype.wait=function(n,t,i,r,u,f){var o=this,e,s;u===void 0&&(u=null);f===void 0&&(f=0);n()?t():u?(e=f*r,e<u?(s=Math.min(r,r,u-e),setTimeout(function(){o.wait(n,t,i,r,u,++f)},s)):i()):setTimeout(function(){o.wait(n,t,i,r)},r)},t.$inject=["$rootScope","$http","$q"],t.DefaultCheckInterval=200,t}(BaseAvonService);n.WaitHelperService=t}(WaitHelperModule||(WaitHelperModule={}));app.service("waitHelperService",WaitHelperModule.WaitHelperService),function(){String.prototype.isNullOrEmpty=function(){return this==null||this.length===0};String.prototype.isNullOrWhiteSpace=function(){return!this||this.match(/^\s*$/)};String.prototype.startsWith=function(n){return this.match("^"+n)===n};String.prototype.endsWith=function(n,t){"use strict";return t!==undefined&&t?n===this.substring(this.length-n.length):n.toLowerCase()===this.substring(this.length-n.length).toLowerCase()};String.prototype.replaceAll=function(n,t){for(var i=this,r=i.indexOf(n);r!==-1;)i=i.replace(n,t),r=i.indexOf(n);return i.toString()};String.prototype.removeLastOccurence=function(n){var t=this,i=t.lastIndexOf(n);return i>-1?t.substring(0,i):t};String.prototype.capitalize=function(n){return(n?this.toLowerCase():this).replace(/(?:^|\s)\S/g,function(n){return n.toUpperCase()})};String.prototype.trim||(String.prototype.trim=function(){return this.replace(/^\s+|\s+$/g,"")})}(StringExtensions||(StringExtensions={})),function(){Array.prototype.forEach||(Array.prototype.forEach=function(n,t){for(var u=t||window,i=0,r=this.length;i<r;i+=1)n.call!==null&&n.call(u,this[i],i,this)})}(ArrayExtensions||(ArrayExtensions={})),function(n){var t=function(){function n(n,t,i){this.status=n;this.lat=t;this.lng=i}return n}(),i;n.GeocodeResult=t;i=function(){function n(){}return n.prototype.geocodeAddress=function(i,r,u,f){if(AVON.commonMvc.isQapEnvironment()){f(new t("OK",40.7121669,-73.9676956));return}AVON.Maps.loadGoogleMapsApi().done(function(){var e=[];i&&e.push(i);r&&(r=r.toUpperCase(),e.push(r));u&&e.push(u);var o=e.join(","),s={region:"US",address:o+",US"},h=new google.maps.Geocoder;h.geocode(s,function(e,o){var h,a,v,y,p;if(o==google.maps.GeocoderStatus.OK){var s=e[0],c=!1,l=!1;_.each(s.address_components,function(n){n.short_name==r?c=!0:n.short_name==u&&(l=!0)});h=!1;c&&l||i&&r&&u&&(i=null,h=!0);h?(a=new n,a.geocodeAddress(i,r,u,f)):(v=s.geometry.location.lat(),y=s.geometry.location.lng(),f(new t("OK",v,y)))}else p="Error: "+o,f(new t(p,0,0))})})},n}();n.GoogleGeocoder=i}(Geocode||(Geocode={}));ProductHelper=function(){function n(){}return n.DisplayVariantLineNumber=function(n,t){return(t===void 0&&(t=!1),!n||n=="000000"||n=="991025"||n.length<=3)?"":(t?" - ":"")+n.substr(0,3)+"-"+n.substr(n.length-3)},n}();app.directive("validateAddress",validateAddress);app.directive("validateCity",validateCity),function(n){var t=function(){function n(){var n=this;this.simpleEmailAddressValidationRegex=/^\s*(?!.{254})([\w\.\-]+)@([\w\-]+)((\.(\w){2,3})+)\s*$/;this.validateEmailList=function(t){return function(i){var f=0,r=!0,u;return i&&(u=n.getNonEmptyOrWhitespaceEmails(i),r=n.checkAllEmailsAreValid(u),f=u.length),r&&t.$setValidity("validateEmailList",r),t.$setValidity("validateMaxEmails",f<=n.maxNumberOfEmails),i}};this.checkAllEmailsAreValid=function(t){for(var f,r=!0,i=0,u=t;i<u.length;i++)if(f=u[i],!n.simpleEmailAddressValidationRegex.test(f)){r=!1;break}return r};this.getNonEmptyOrWhitespaceEmails=function(n){var u=[],f,t,i,r;if(n)for(f=n.split(/[,;]/),t=0,i=f;t<i.length;t++)r=i[t],r.isNullOrWhiteSpace()||u.push(r);return u};this.restrict="A";this.require="ngModel";this.link=function(t,i,r,u){n.maxNumberOfEmails=r.validateMaxEmails;i.on("blur",function(){var r=n.getNonEmptyOrWhitespaceEmails(i.val()),f=n.checkAllEmailsAreValid(r);u.$setValidity("validateEmailList",f);t.$apply()});u.$formatters.unshift(n.validateEmailList(u));u.$parsers.unshift(n.validateEmailList(u))}}return n.Factory=function(){return function(){return new n}},n}();n.ValidateEmailList=t}(Directives||(Directives={}));app.directive("validateEmailList",Directives.ValidateEmailList.Factory()),function(n){var t=function(){function n(){var n=this;this.validationRegex=/^[A-Za-zñÑáÁéÉíÍóÓúÚüÜ'\d\s\.\-!¡\""£$%^&*\(\)_\+€_-|\\,./\?\[\]{};:'@#~`¬¦¿\=]+$/;this.validateText=function(t){return function(i){var r=!i||n.validationRegex.test(i);return t.$setValidity("validateText",r),i}};this.restrict="A";this.require="ngModel";this.link=function(t,i,r,u){u.$formatters.unshift(n.validateText(u));u.$parsers.unshift(n.validateText(u))}}return n.Factory=function(){return function(){return new n}},n}();n.ValidateEnglishSpanishText=t}(Directives||(Directives={}));app.directive("validateText",Directives.ValidateEnglishSpanishText.Factory());app.directive("validateMustequalto",validateMustqqualto);app.directive("validateName",validateName),function(n){var t=function(){function n(){var n=this;this.validateTextNoUrl=function(n){return function(t){var i=!1,r=new RegExp("((((https?)(:)(/?/?))|(www\\.))[\\w]{1})","igm");return i=!t||!r.test(t),n.$setValidity("validateTextNoUrl",i),t}};this.restrict="A";this.require="ngModel";this.link=function(t,i,r,u){u.$formatters.unshift(n.validateTextNoUrl(u));u.$parsers.unshift(n.validateTextNoUrl(u))}}return n.Factory=function(){return function(){return new n}},n}();n.ValidateNoUrlsText=t}(Directives||(Directives={}));app.directive("validateNoUrls",Directives.ValidateNoUrlsText.Factory()),function(n){var t=function(){function n(){var n=this;this.validateNotAvailableSoonModel=function(n,t){return function(i){var r=!0,f=_.flatten(_.pluck(n.Product.VariantGroups,"Variants")),u;return i?(u=_.find(f,function(n){return n.Sku==i}),u&&u.Availability==CanBuy.AvailableSoon&&(r=!1)):n.Product.Availability==CanBuy.AvailableSoon&&(r=!1),t.$setValidity("availableSoon",r),i}};this.require="ng-model";this.restrict="A";this.scope={Product:"=validateNotAvailableSoon"};this.link=function(t,i,r,u){u.$formatters.unshift(n.validateNotAvailableSoonModel(t,u));u.$parsers.unshift(n.validateNotAvailableSoonModel(t,u))}}return n.Factory=function(){return function(t){return new n(t)}},n}();n.ValidateNotAvailableSoon=t}(ValidateNotAvailableSoonModule||(ValidateNotAvailableSoonModule={}));app.directive("validateNotAvailableSoon",["$rootScope",ValidateNotAvailableSoonModule.ValidateNotAvailableSoon.Factory()]);app.directive("validatePhone",validatePhone);app.directive("validateRegex",validateRegex),function(n){var t=function(){function n(n,t){var i=this;this.autoReplenishService=t;this.ValidateSkuNotSubscribedngModel=function(n,t){return function(n){var r=!0,u;return n&&(u=i.autoReplenishService.IsSubscribedToProductWithSku(n),r=u?!1:!0),t.$setValidity("skuNotSubscribed",r),n}};this.require="ng-model";this.restrict="A";this.link=function(n,t,r,u){u.$formatters.unshift(i.ValidateSkuNotSubscribedngModel(n,u));u.$parsers.unshift(i.ValidateSkuNotSubscribedngModel(n,u))}}return n.Factory=function(){return function(t,i){return new n(t,i)}},n}();n.ValidateSkuNotSubscribed=t}(ValidateSkuNotSubscribedModule||(ValidateSkuNotSubscribedModule={}));app.directive("validateSkuNotSubscribed",["$rootScope","autoReplenishService",ValidateSkuNotSubscribedModule.ValidateSkuNotSubscribed.Factory()]);app.directive("validateZipcode",validateZipcode),function(n){var t=function(){function n(n,t,i){return{restrict:"A",require:"ngModel",link:function(n,t,r,u){var f=t,e=function(n){n=n.toString();var r=!0;return t.addClass("LoadingImage"),$.ajax({async:!0,cache:!0,type:"GET",url:"/api/validation/validatezipandgetdetails/"+n,dataType:"json",success:function(n){n.zipDetails.IsValidZip||(r=!1);var u=t.parents(".billingAddress").length||t.context.id==="CheckoutStep1Model_BillingZipInput"||t.context.id==="CheckoutAddressesModel_BillingZipInput";i.$broadcast("AddressesScope.ZipCodeDetails",n.zipDetails,u);t.removeClass("LoadingImage")},error:function(){return t.removeClass("LoadingImage"),!0}}),r},o=function(n){var o=u.$name,r=!0,t,i;return(o==="CheckoutStep1Model_BillingZip"&&(t=f.closest("form"),t&&(i=t.find("input#SharedAddressDetailsInput"),i&&(r=!i[0].checked))),!n||n.length!=5&&n.length!=10)?(u.$setValidity("validateZipcodeRecognized",!0),n):(r&&(n.length===5||n.length===10)&&(e(n.substring(0,5))?u.$setValidity("validateZipcodeRecognized",!0):u.$setValidity("validateZipcodeRecognized",!1)),n)};u.$parsers.unshift(o);u.$formatters.unshift(function(n){return u.$setValidity("validateZipcodeRecognized",!0),n})}}}return n.$inject=["$sce","$timeout","$rootScope"],n}();n.ValidateZipCodeAndGetDetailsDirective=t}(ValidateZipCodeAndGetDetailsModule||(ValidateZipCodeAndGetDetailsModule={}));app.directive("validateZipcodeGetDetails",["$sce","$timeout","$rootScope",ValidateZipCodeAndGetDetailsModule.ValidateZipCodeAndGetDetailsDirective]);app.directive("validateZipcodeRecognized",validateZipCodeRecognized);validateZipCodeRecognized.$inject=["$http"];app.directive("validateZipcodeRequired",validateZipcodeRequired)