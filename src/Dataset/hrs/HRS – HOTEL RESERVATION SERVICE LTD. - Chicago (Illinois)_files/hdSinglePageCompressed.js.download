var HotelDetailsHDLayer=new Class({Extends:LightBox,options:{subMenuTrackingIds:{"#top":{},"#priceAnchor":{"#top":"BP","#priceAnchor":"BQ","#mapHdAnchor":"BS","#ratingAnchor":"BR","#infoAnchor":"BT"},"#mapHdAnchor":{"#top":"DP","#priceAnchor":"DQ","#mapHdAnchor":"DS","#ratingAnchor":"DR","#infoAnchor":"DT"},"#ratingAnchor":{"#top":"CP","#priceAnchor":"CQ","#mapHdAnchor":"CS","#ratingAnchor":"CR","#infoAnchor":"CT"},"#infoAnchor":{"#top":"EP","#priceAnchor":"EQ","#mapHdAnchor":"ES","#ratingAnchor":"ER","#infoAnchor":"ET"}},bookingButtonTrackingIds:{"#top":"AG","#priceAnchor":"BD","#mapHdAnchor":"DG","#ratingAnchor":"CD","#infoAnchor":"ED"}},createLightBox:function(){this.parent();this.hash=window.location.hash.substring(1);window.onhashchange=function(event){if(this.mediaPlayerLightBoxOpen&&window.location.hash.substring(1)===this.preMediaPlayerLightBoxHash){var mediaPlayerLightBox=$("mediaPlayerLightBox");
mediaPlayerLightBox.addClass("hide");mediaPlayerLightBox.getElement(".media").innerHTML="";mediaPlayerLightBox.removeClass("images");}if(window.location.hash.substring(1)==="mediaPlayerLightBox"){this.mediaPlayerLightBoxOpen=true;}else{this.preMediaPlayerLightBoxHash=window.location.hash.substring(1);}if(window.location.hash.substring(1)===this.hash&&!window.initBookingProcess&&!this.lightBoxClosed){this.closeLightBox();}}.bind(this);var handle=new Element("div",{"class":"handle"});handle.inject(this.wrap,"top");new Drag(this.wrap,{handle:handle});this.content.addEvent("click",function(event){var eventTarget=event.target;if(eventTarget.name&&eventTarget.name==="initBooking"){console.log(2,eventTarget,event);}else{if(eventTarget.id==="routingButton"){console.log(3,eventTarget,event);}else{if(eventTarget.id==="showHybrid"){console.log(4,eventTarget,event);
}else{if(eventTarget.hasClass("checkbox")||eventTarget.hasClass("tooltip")||eventTarget.getParent("div.mapContainer")||eventTarget.getParent("div.streetViewContainer")){}else{if(eventTarget.name&&eventTarget.name==="availability"){event.stop();var url,formData=$("jsContentForm").toQueryString().parseQueryString();formData["availability"]="Show Offers";url=window.HotelDetailsLayer.options.lightBoxEl+"&availability=ShowOffers";window.HotelDetailsLayer.getContent(url,formData);}else{event.stop();if(eventTarget.type==="submit"){}else{if(eventTarget.hasClass("print")){var popup=new Popup($$(".print"),{name:"print",width:740,height:648});popup.open(event,eventTarget);}}}}}}}}.bind(this));window.addEvents({resize:function(){this.position(false);}.bind(this),focus:function(){this.position(false);}.bind(this)});
var containerEl=$$(".lightboxContent")[0];new DeferredClickTracker(containerEl,{});},openLightBox:function(url){this.lightBoxClosed=false;window.scrollTo(0,0);document.body.addClass("hasDetailsLayer");window.mainPageNameForTracking=s.pageName;window.mainLinkTrackVars=s.linkTrackVars;this.setCurrentHotelPosition(url);this.setHotelDetailsPageSource(url);if(!this.wrap){this.createLightBox();}this.wrap.removeClass("hide");if(this.options.isParallax){this.wrap.addClass("isParallax");}this.isOpen=true;if(!this.dummy){this.getContent(url);}else{this.getDummyContent(url);}if(this.options.noEmpty){if(this.wrap.getStyle("top")=="-2000px"){this.position(true);}else{this.wrap.setStyle("display","block");}}else{this.wrap.setStyle("display","block");this.position(true);}this.position();this.options.beforOpen.bind(this);
this.showVeil();this.fireEvent("lightboxOpend");window.location.hash="#layer";var footerMenuWrap=$("footerMenuWrap");if(footerMenuWrap){this.footerMenuWrap=footerMenuWrap.addClass("notVisible");}var language=s.prop26,hotelNumberRegex=/hotelnumber=([0-9]+)/,matches=url.match(hotelNumberRegex),hotelId=matches&&matches[1];DY.API("spa_start",{context:{type:"PRODUCT",data:[hotelId],lng:language},countAsPageview:true});},closeLightBox:function(event){if(this.request&&this.request.isRunning()){this.request.cancel();this.loadingAnimation();}if(window.hdSinglePageTimeoutsArray){hdSinglePageTimeoutsArray.each(function(timeoutInstance){console.log("timeoutInstance",timeoutInstance);if(timeoutInstance){clearTimeout(timeoutInstance);}});hdSinglePageTimeoutsArray.length=0;}var ppvVal="";var origLinkType=s.linkType;
s.linkType="e";var ppvArray=s.getPercentPageViewed(s.pageName);if(ppvArray!=null&&ppvArray[0]!=null&&isPagePerViewTrackingEnabled(ppvArray[0])){ppvVal=ppvArray[1];}var closeTrackingVars={"linkTrackVars":"prop68","prop68":ppvVal};s.linkType=origLinkType;s_trackLink("closeHotelDetailsSinglePageLayer",true,closeTrackingVars,s.pageName);s.getPPVid=s.pageName;if(window.mainPageNameForTracking){s.pageName=window.mainPageNameForTracking;}if(window.mainLinkTrackVars){s.linkTrackVars=window.mainLinkTrackVars;}if(window.metaDataHotelList&&window.md){window.md=window.metaDataHotelList;}var hotelListGTMData=window.HRS_PUW.GTM.hotelListSearchDataLayer||{};if(hotelListGTMData){hotelListGTMData=Object.assign(hotelListGTMData,{event:"puwOverlayClosed"});}GTMHelper.pushData(hotelListGTMData);this.resetGTMHotelDetailsDataLayer();
this.wrap.removeClass("errorLayer");this.veil.removeClass("errorLayer");window.scrollTo(0,this.options.verticalScrollPosition);this.parent(event);window.location.hash="#"+this.hash;$(window).removeEvent("scroll",this.boundScrollBehavior);$("hotelDetailsHD").setStyle("margin-top",0);window.hdSinglePageMapInstance=false;if(this.footerMenuWrap){this.footerMenuWrap.removeClass("notVisible");}this.lightBoxClosed=true;if(window.wa){window.wa.viewChange("HotelDetailsLayerClose",{});}var language=s.prop26,locationID=document.getElementById("cLocationID").value.substr(1);DY.API("spa",{context:{type:"CATEGORY",data:[locationID],lng:language},countAsPageview:true});},setCurrentHotelPosition:function setCurrentHotelPosition(url){var urlParams=new URLSearchParams(url);var hotelNumber=urlParams.get("hotelnumber");
if(window.mainHotelListObject&&hotelNumber){var hotelPosition=window.mainHotelListObject.trueHotelData.findIndex(function(item){return item[0]===parseInt(hotelNumber);});window.HRS_PUW.GTM.currentHotelPosition=(hotelPosition>-1)&&(hotelPosition+1).toString();}},setHotelDetailsPageSource:function setHotelDetailsPageSource(url){if(window.HRS_PUW.GTM.hotelDetailPageSource){return;}var action=window.GTMHelper.Utils.getDataFromURL("actionDetails",url);window.HRS_PUW.GTM.hotelDetailPageSource=window.GTMHelper.Utils.mapActionDataToPageSource(action);},resetGTMHotelDetailsDataLayer:function resetGTMHotelDetailsDataLayer(){window.dataLayerHotelDetail=undefined;window.HRS_PUW.GTM.currentHotelId=undefined;window.HRS_PUW.GTM.currentHotelPosition=undefined;window.HRS_PUW.GTM.hotelDetailPageSource=undefined;
},getDummyContent:function(test){var request=new Request({url:"html/hoteldetails.html",evalScripts:true,onRequest:function(){this.loadingAnimation();}.bind(this),onSuccess:function(response){this.renderContent(response);}.bind(this),onFailure:function(){this.loadingAnimation();}.bind(this)});request.send();},getContent:function(url,formData){if(formData==null){formData="";}if(typeOf(url)!=="string"){var form,data,action;if(url.name&&url.value){form=this.wrap.getElement("form");data="&"+url.name+"="+url.value;}else{form=url;data="";}form.getElements("input").each(function(item){if(item.type==="text"||item.type==="hidden"){data+="&"+item.name+"="+item.value;}});form.getElements("select").each(function(item){data+="&"+item.name+"=";item.getElements("option").each(function(item){if(item.selected){data+=item.value;
}});});if(form.action.test(/(#.*)/)){action=form.action.replace(/(#.*)/,"&showSinglePage=true$1");}else{action=form.action+"&showSinglePage=true";}this.request=new Request({url:action,evalScripts:true,data:formData,onRequest:function(){this.loadingAnimation();}.bind(this),onSuccess:function(response){this.renderContent(response);}.bind(this),onFailure:function(){this.loadingAnimation();}.bind(this),onCancel:function(){this.loadingAnimation();}.bind(this)});this.request.send(data);}else{this.request=new Request({url:url,data:formData,evalScripts:true,onRequest:function(){this.loadingAnimation();}.bind(this),onSuccess:function(response){this.renderContent(response);}.bind(this),onFailure:function(){this.loadingAnimation();}.bind(this)});this.request.send();}},renderContent:function(response){this.loadingAnimation();
this.content.innerHTML=response;var form=this.wrap.getElement("form");if(form){form.addEvent("submit",function(event){if(event.type!=="submit"){event.stop();if(!this.dummy){this.getContent(form);}else{this.getDummyContent(form);}}}.bind(this));}var HotelDetailsHDLayerObject=this;prepareTooltipsForTariffs($("jsContentForm"));this.position();if(this.options.isParallax){setTimeout(function(){this.parallaxHeader();}.bind(this),1000);}this.setVeilSize();this.errorWrapper=this.content.getElement(".errorWrapper");if(this.errorWrapper){this.changeLayerStyle();}$$(".registerPopupLink").addEvent("click",function(e){e.preventDefault();if(window.isNewRegistrationEnabled){window.frameRegistration.open("HDetail:Loyalty-Notice","register");}else{window.registerForm.showAuthForm("register",undefined,undefined,"Loyalty-Notice");
}});},parallaxHeader:function(){if($("detailsHead")){this.parallax={};if($("detailsHead").hasClass("smallGallery")){var smallHeaderSize=this.wrap.getElement("h2").getSize().y+(this.wrap.getElement(".titleWrap").getSize().y-$("mediaPlayer").getSize().y);this.parallax.smallHeaderFullSize=$("detailsHead").getSize().y+parseInt(this.wrap.getElements(".detailsNav")[1].getStyle("margin-top"),10);}this.parallax.header=$("detailsHead");this.parallax.menu=$("hotelDetailsPriceNav");this.parallax.priceCoordinates=$("detailsHead").hasClass("smallGallery")?this.wrap.getElements(".detailsNav")[1].getCoordinates().top-87:$$(".summary .guarantee")[0].getCoordinates().top+45;this.parallax.navCoordinates=$("detailsHead").hasClass("smallGallery")?this.wrap.getElements(".detailsNav")[1].getCoordinates().height+18:this.wrap.getElements(".detailsNav")[1].getCoordinates().height+18;
this.parallax.headerSize=$("detailsHead").hasClass("smallGallery")?smallHeaderSize:this.parallax.header.getSize().y;this.parallax.threshold=this.parallax.priceCoordinates+this.parallax.navCoordinates-this.parallax.headerSize;if(!$("detailsHead").hasClass("smallGallery")){this.parallax.threshold=$$(".detailsNav")[1].getSize().y+$$(".detailsMedia")[0].getSize().y+$$(".summary")[0].getSize().y-50;}else{this.parallax.threshold=$$(".detailsNav")[1].getSize().y+$("detailsHead").getSize().y-this.parallax.menu.measure(function(){return this.getSize().y;});}this.parallax.menu.setStyle("display","none");this.parallax.navChildren=$$("ul.detailsNav").getChildren("li a.anchor");this.parallax.scrollList={};this.calculateCoordinates();this.boundScrollBehavior=this.scrollBehavior.bind(this);$(window).addEvent("scroll",this.boundScrollBehavior);
$$(".detailsNav")[0].getElement("li").removeClass("topArrow");this.scrollBehavior();}},calculateCoordinates:function(){for(i=0;i<this.parallax.navChildren[0].length;i++){this.parallax.scrollList[i]={};this.parallax.scrollList[i].coord=$$(this.parallax.navChildren[0][i].hash).getParent("div").getCoordinates();if(this.parallax.scrollList[i].coord[0]){this.parallax.scrollList[i].coord[0].top-=(Browser.ie8?220:200);}if(this.parallax.navChildren[0][i].hash==="#top"){this.parallax.scrollList[i].coord[0].height=$$(".detailsNav")[1].getCoordinates().top;}}},scrollBehavior:function(event){this.calculateCoordinates();var lastPosition=this.wrap.getSize().y-500,bottomFix=this.wrap.getSize().y+$("detailsHead").getSize().y-(window.innerHeight?window.innerHeight:document.documentElement.clientHeight),scroll=$(window).getScroll().y,winSize=$(window).getSize();
if(scroll>bottomFix){window.scrollTo(0,bottomFix);}if(scroll>this.parallax.threshold){this.parallax.menu.setStyle("display","block");$("detailsHead").addClass("setFixed");if(parseInt($("detailsHead").getStyle("left"),10)>300&&parseInt($("detailsHead").getStyle("margin-left"),10)>-21){$("detailsHead").setStyle("margin-left",this.wrap.getSize().x/-2);$("detailsHead").setStyle("left",winSize.x/2);}$$(".hideOnScroll").addClass("hide");$$(".showOnScroll").removeClass("hide");if($("detailsHead").hasClass("smallGallery")){$("mediaPlayer").addClass("hide");$("bookingField").addClass("hide");if(Browser.isMobile){$$(this.close,this.parallax.header).setStyles({"top":scroll,"position":"absolute"}).removeClass("jsSmall");}else{$$(this.close,this.parallax.header).setStyles({"top":0,"position":"fixed"}).removeClass("jsSmall");
}this.wrap.getElements(".detailsNav")[1].setStyles({"margin-top":this.parallax.smallHeaderFullSize+"px"});}if(Browser.isMobile){$$(this.close,this.parallax.header).setStyles({"top":scroll,"position":"absolute"}).removeClass("jsSmall");}else{$$(this.close,this.parallax.header).setStyles({"top":0,"position":"fixed"}).removeClass("jsSmall");}$$(".detailsMedia")[0].setStyle("margin-top",this.parallax.headerSize);}else{this.parallax.menu.setStyle("display","none");$("detailsHead").removeClass("setFixed");$$(".hideOnScroll").removeClass("hide");$$(".showOnScroll").addClass("hide");if(Browser.isMobile){$$(this.close).setStyles({"top":scroll,"position":"absolute"});this.parallax.header.setStyles({"top":"auto","position":"static"});}else{$$(this.close,this.parallax.header).setStyles({"top":0,"position":""});
}if($("detailsHead")&&!$("detailsHead").hasClass("setFixed")&&!Browser.isMobile){$("detailsHead").setStyle("margin-left","");}if($("detailsHead").hasClass("smallGallery")){this.parallax.header.setStyles({"top":"auto","position":"static"}).addClass("jsSmall");$("mediaPlayer").removeClass("hide");$("bookingField").removeClass("hide");this.wrap.getElements(".detailsNav")[1].setStyle("margin-top","auto");}$$(".detailsMedia")[0].setStyle("margin-top","");}for(var i=0;i<this.parallax.navChildren[0].length;i++){if(this.parallax.scrollList[i].coord[0]){if(scroll>this.parallax.scrollList[i].coord[0].top&&scroll<(this.parallax.scrollList[i].coord[0].top+this.parallax.scrollList[i].coord[0].height)){if(!this.parallax.navChildren[0][i].getParent("li").hasClass("active")){this.parallax.navChildren[0].each(function(item){item.getParent("li").removeClass("active");
});var activeNavEl=this.parallax.navChildren[0][i];activeNavEl.getParent("li").addClass("active");this.updateSubmenuAndBookingButtonTrackingIds(activeNavEl.getAttribute("href"),this.parallax.navChildren[0]);}}}}},updateSubmenuAndBookingButtonTrackingIds:function(activeNavKey,navElList){var activeList=this.options.subMenuTrackingIds[activeNavKey];if(activeList){navElList.each(function(el,i){var key=el.getAttribute("href");if(key){var val=activeList[key];if(val&&el){el.setAttribute("data-deferredTrackingId",activeList[key]);}}});if($("bookingButtonHeader")){$("bookingButtonHeader").setAttribute("data-bookingButtonTrackId",this.options.bookingButtonTrackingIds[activeNavKey]);}}},position:function(init){var elSize=this.wrap.getSize(),win=$(window),winSize=win.getSize(),winScroll=win.getScroll(),x=(winSize.x-winScroll.x)/2-elSize.x/2,y=(winScroll.y+winSize.y)/2-elSize.y/2;
if(x<this.options.posMin){x=this.options.posMin;}if(y<this.options.posMin){x=this.options.posMin;}if(winSize.x<elSize.x+18){this.wrap.setStyles({left:10,"margin-left":0});}else{if($("detailsHead")&&$("detailsHead").hasClass("setFixed")&&!Browser.isMobile){$("detailsHead").setStyles({left:winSize.x/2,"margin-left":elSize.x/-2});}this.wrap.setStyles({left:winSize.x/2,"margin-left":elSize.x/-2});}if(init){this.wrap.setStyles({top:0,height:"auto",left:winSize.x/2});}if(this.iframe){this.iframe.setStyles({width:elSize.x+4,height:elSize.y+4});}},loadingAnimation:function(){if(!this.loadingElement){this.loadingElement=new Element("div",{"class":"loadingElement"});this.loadingElement.inject(this.wrap);}this.loadingElement.toggleClass("active");},toElement:function(){return this.wrap;},changeLayerStyle:function(){this.errorWrapper.getElement(".errorLayerButton").addEvent("click",function(event){event.stop();
this.closeLightBox();}.bind(this));this.wrap.addClass("errorLayer");this.veil.addClass("errorLayer");var elSize=this.wrap.getSize(),win=$(window),winSize=win.getSize(),winScroll=win.getScroll();this.wrap.setStyles({top:winSize.y/2+winScroll.y,left:winSize.x/2,"margin-left":elSize.x/-2});}});var MediaPlayer=new Class({Implements:[Options],options:{mediaMargin:0,useThumbnails:false,deferredLoading:false},initialize:function(element,options){this.setOptions(options);if(this.options.deferredLoading){this.notLoadedItems={};this.allItemsLoaded=false;this.notLoadedNavItems={};this.allNavItemsLoaded=false;}this.imageWidths=[];var nav=element.getElement(".nav"),navHeight=nav.getStyle("height"),mediaWrapWidth=0;this.wrap=element;this.wrapWidth=this.wrap.getSize().x;this.mediaWrap=element.getElement(".mediaPlayerMedia");
this.navMediaWrap=nav.getElement(".media");this.navMediaWrapper=nav.getElement(".navMediaWrap");this.navMediaWrapperWidth=this.navMediaWrapper.getSize().x;var mediaItems=0;Object.each(this.options.media,function(itemOuter){Object.each(itemOuter,function(item){item.width=item.hd?400:256;this.imageWidths.push(item.width);mediaItems++;},this);},this);this.navMediaWrap.setStyle("width",mediaItems*63);this.imageWidths.each(function(item,index){mediaWrapWidth+=item+this.options.mediaMargin;},this);this.preloadQueue=0;this.mediaWrap.setStyle("width",mediaWrapWidth);this.loadMedia(this.options.media);if(this.max===-1){}else{this.navPrev=nav.getElement(".prev");this.navNext=nav.getElement(".next");this.prev=this.wrap.getElement(".mediaPlayerPrev");this.next=this.wrap.getElement(".mediaPlayerNext");this.navMedia=this.navMediaWrap.getElements("li");
this.media=this.mediaWrap.getElements("li");this.navMediaItemWidth=(this.navMedia[0].getSize().x+parseInt(this.navMedia[0].getStyle("margin-left"),10)+parseInt(this.navMedia[0].getStyle("margin-right"),10));this.navMediaWrapWidth=this.navMediaWrap.getParent().getSize().x;this.visibleNavMediaItems=Math.ceil(this.navMediaWrapWidth/this.navMediaItemWidth);this.mediaWrap.set("tween",{onComplete:function(){this.media[this.fxId].addClass("active");this.prev.removeClass("inactive");this.next.removeClass("inactive");}.bind(this)});this.checkImagesWidth();setTimeout(function(){this.showMedia(this.media.indexOf($("mediaItem"+this.activeId)),true);}.bind(this),0);this.wrap.addEvent("click",function(event){var target=event.target;if(!target.hasClass("inactive")){var direction=1;if(target==this.navPrev||target==this.navNext){if(target==this.navPrev){direction=-1;
}this.navigate(this.activeNavId+direction*this.visibleNavMediaItems);}else{if(target==this.prev||target==this.next){if(target==this.prev){direction=-1;}this.showMedia(this.activeId+direction);}else{if(target.hasClass("hdIcon")||target.hasClass("hdLink")){this.openLightBox(target.getParent("li").id.replace("mediaItem",""));}else{if(target.tagName.toLowerCase()=="img"){target=target.getParent();}if(target.hasClass("videoIcon")||target.hasClass("videoLink")){if(this.activeId===this.media.indexOf(target.getParent())){var tempId=target.getParent().id.replace("mediaItem","");this.openLightBox(tempId);}else{target=target.getParent();}}if(target.hasClass("hd")&&this.activeId===this.media.indexOf(target)){this.openLightBox(target.id.replace("mediaItem",""));}else{if(target.tagName.toLowerCase()=="li"&&this.activeId!==this.media.indexOf(target)){if(target.hasClass("mediaElement")){this.showMedia(this.media.indexOf(target));
}else{if(target.hasClass("navMediaElement")){var tempId=target.id.replace("navItem","");this.showMedia(this.media.indexOf($("mediaItem"+tempId)));}}}}}}}}}.bind(this));}},checkImagesWidth:function(){this.allImagesAreVisible=false;this.imageWidthsSum=0;this.imageWidths.each(function(item){this.imageWidthsSum+=item+this.options.mediaMargin;}.bind(this));if(this.wrapWidth>this.imageWidthsSum){this.allImagesAreVisible=true;this.next.setStyle("width","0");this.prev.setStyle("width","0");}},loadMedia:function(media){console.log(media);var index=this.min=0;this.mediaObjects=[];this.hdImages=[];this.maxOffset=-this.wrapWidth;var videoResort=[];Object.each(media,function(itemOuter,keyOuter){Object.each(itemOuter,function(item,key){var object={title:item.title,src:item.src,type:keyOuter,url:item.url,id:item.id,hd:item.hd,extern:item.extern,index:index};
this.mediaObjects.push(object);if(keyOuter==="videos"&&index>0){videoResort.push({object:object,index:index,item:item,keyOuter:keyOuter});}else{this.injectMedia(object,index,item,keyOuter);}index++;},this);},this);this.max=index-1;this.itemCount=index;videoResort.each(function(item,index){this.injectMedia(item.object,item.index,item.item,item.keyOuter);}.bind(this));},itemIsVisible:function(element,wrap){var coordinates=element.getCoordinates(wrap),wrapWidth=wrap.getSize().x;if(coordinates.right<0||coordinates.left>wrapWidth){return false;}else{return true;}},injectMedia:function(object,index,item,keyOuter){var liNav=new Element("li",{id:"navItem"+index,"class":item.extern?"extern":""}),li=liNav.clone();li.id="mediaItem"+index;var span=new Element("span",{html:item.title,"class":item.hd?"hdLink":""});
if(item.hd){li.addClass("hd");this.hdImages.push(object);new Element("span",{"class":"hdIcon","title":this.options.properties.openFullscreen}).inject(span);}liNav.addClass("navMediaElement");if(keyOuter==="videos"){span.addClass("videoLink");var videoDivNav=new Element("div",{"class":"videoIcon"});videoDivNav.inject(liNav);var videoDiv=videoDivNav.clone();videoDiv.inject(li);}li.addClass("mediaElement");item.width=item.hd?400:256;this.maxOffset+=item.width+this.options.mediaMargin;li.setStyle("width",item.width);span.inject(li);if(item.init){this.activeId=this.activeNavId=index;}liNav.inject(this.navMediaWrap);li.inject(this.mediaWrap);if(this.options.deferredLoading){if(this.itemIsVisible($("mediaItem"+index),this.wrap)){this.preloadQueue++;this.injectImage(item,keyOuter,li,liNav);}else{if(this.options.useThumbnails){this.notLoadedItems[index]={item:item,keyOuter:keyOuter,li:li,liNav:liNav};
if(this.itemIsVisible($("navItem"+index),this.navMediaWrapper)){this.preloadQueue++;this.injectNavImage(false,item,keyOuter,li,liNav);}else{this.notLoadedNavItems[index]={item:item,keyOuter:keyOuter,li:li,liNav:liNav};}}else{if(this.itemIsVisible($("navItem"+index),this.navMediaWrapper)){this.preloadQueue++;this.injectImage(item,keyOuter,li,liNav);}else{this.notLoadedItems[index]={item:item,keyOuter:keyOuter,li:li,liNav:liNav};}}}}else{this.injectImage(item,keyOuter,li,liNav);}},injectImage:function(item,keyOuter,li,liNav){var image=new Element("img",{events:{load:function(){if(item.extern||keyOuter!=="videos"){image.width=item.extern?"128":item.width;image.height=item.extern?"72":256;}image.inject(li);if(this.preloadQueue===0||!this.options.deferredLoading||!this.options.useThumbnails){window.fireEvent("loadSinglePageMap");
}this.injectNavImage(image,item,keyOuter,li,liNav);}.bind(this)}});image.setAttribute("src",item.src);},injectNavImage:function(image,item,keyOuter,li,liNav){if(this.options.useThumbnails){if(!liNav.retrieve("hasThumb")){var image=new Element("img",{events:{load:function(){if(item.extern||keyOuter!=="videos"){image.width=53;image.height=53;}image.inject(liNav);liNav.store("hasThumb",true);this.preloadQueue--;if(this.preloadQueue===0||!this.options.deferredLoading){window.fireEvent("loadSinglePageMap");}}.bind(this)}});image.setAttribute("src",item.thumb);}}else{var imageNav=image.clone();imageNav.inject(liNav);}},isInRange:function(id){if((id<=this.max)&&(id>=this.min)){return true;}else{return false;}},setRange:function(value,min,max){return(value<min?min:(value>max?max:value));},showMedia:function(id,initial){if(this.options.deferredLoading&&!this.allItemsLoaded){var i=this.activeId,itemArray=[],notLoadedItemsArray=Object.keys(this.notLoadedItems);
if(i===id||id===1||id===0){var j=notLoadedItemsArray.getLast()-3;for(j;j<=notLoadedItemsArray.getLast();j++){itemArray.push(j);}}for(i;i<=id+3;i++){itemArray.push(i);}itemArray.each(function(item,index){if(this.notLoadedItems[item]){this.injectImage(this.notLoadedItems[item].item,this.notLoadedItems[item].keyOuter,this.notLoadedItems[item].li,this.notLoadedItems[item].liNav);delete this.notLoadedItems[item];if(Object.getLength(this.notLoadedItems)===0){this.allItemsLoaded=true;}}},this);}if(this.isInRange(id)){var offset=this.wrapWidth/2,visiableDiff=offset-this.imageWidths[id]/2,direction=0;this.nextPrevImageWidth=0;if(this.activeId>id){direction=-1;}else{if(this.activeId<id){direction=1;}else{if(id===0){direction=-1;}else{direction=1;}}}while(this.nextPrevImageWidth<visiableDiff&&!this.allImagesAreVisible){this.imageWidths.each(function(width,index){if(direction===-1){if(index<id){this.nextPrevImageWidth+=width+this.options.mediaMargin;
}}else{if(direction===1){if(index>id){this.nextPrevImageWidth+=width+this.options.mediaMargin;}}}},this);if(this.nextPrevImageWidth<visiableDiff){if(direction===-1){var moveImageWidth=this.imageWidths[this.imageWidths.length-1]+this.options.mediaMargin;this.imageWidths.unshift(this.imageWidths[this.imageWidths.length-1]);this.imageWidths.pop();this.media[this.media.length-1].inject(this.mediaWrap,"top");var left=this.mediaWrap.getStyle("left");left=left==="auto"?0:left;this.mediaWrap.setStyle("left",parseInt(left,10)-moveImageWidth);this.media=this.mediaWrap.getElements("li");id+=1;}else{if(direction===1){var moveImageWidth=this.imageWidths[0]+this.options.mediaMargin;this.imageWidths.push(this.imageWidths[0]);this.imageWidths.shift();this.media[0].inject(this.mediaWrap);var left=this.mediaWrap.getStyle("left");
left=left==="auto"?0:left;this.mediaWrap.setStyle("left",parseInt(left,10)+moveImageWidth);this.media=this.mediaWrap.getElements("li");id-=1;}}}}this.imageWidths.each(function(width,index){if(index<id){offset-=width+this.options.mediaMargin;}else{if(index===id){offset-=(width+this.options.mediaMargin)/2;}}},this);if(offset>0&&!this.allImagesAreVisible){offset=0;}else{if(offset<-this.maxOffset&&!this.allImagesAreVisible){offset=-this.maxOffset;}}this.activeId=id;var tempId=this.media[id].id.replace("mediaItem","");this.navigate(this.navMedia.indexOf($("navItem"+tempId)),true);$$(this.media).removeClass("active");this.fxId=id;this.prev.addClass("inactive");this.next.addClass("inactive");if(initial){this.mediaWrap.setStyle("left",offset);this.mediaWrap.removeClass("notLoaded");this.prev.removeClass("inactive");
this.next.removeClass("inactive");}else{this.mediaWrap.tween("left",offset);}if(id===0){this.prev.addClass("inactive");}else{if(id===this.max){this.next.addClass("inactive");}}}},getNavMediaWrapSize:function(){var titleWrap=this.navMediaWrap.getParent(".titleWrap");titleWrap.setStyles({"position":"absolute","top":-1000000});titleWrap.removeClass("hide");var size=this.navMediaWrap.getSize().x;titleWrap.addClass("hide");titleWrap.setStyles({"position":"","top":"auto"});return size;},navigate:function(id,setActive){if(this.options.deferredLoading&&!this.allNavItemsLoaded){var i=id;if(i>this.max-4){Object.each(this.notLoadedItems,function(item,index){this.injectNavImage(false,item.item,item.keyOuter,item.li,item.liNav);delete this.notLoadedNavItems[index];if(Object.getLength(this.notLoadedNavItems)===0){this.allNavItemsLoaded=true;
}},this);}else{if(!setActive){i=i-Math.round(this.visibleNavMediaItems/2);}for(i;i<=id+Math.round(this.visibleNavMediaItems/2);i++){if(this.options.useThumbnails){if(this.notLoadedNavItems[i]){this.injectNavImage(false,this.notLoadedNavItems[i].item,this.notLoadedNavItems[i].keyOuter,this.notLoadedNavItems[i].li,this.notLoadedNavItems[i].liNav);delete this.notLoadedNavItems[i];if(Object.getLength(this.notLoadedNavItems)===0){this.allNavItemsLoaded=true;}}}else{if(this.notLoadedItems[i]){this.injectImage(this.notLoadedItems[i].item,this.notLoadedItems[i].keyOuter,this.notLoadedItems[i].li,this.notLoadedItems[i].liNav);delete this.notLoadedItems[i];if(Object.getLength(this.notLoadedItems)===0){this.allItemsLoaded=true;}}}}}}if(!this.isInRange(id)){if(id>this.max){id=this.max;}else{id=this.min;
}}this.activeNavId=id;if(id>this.navMedia.length-Math.round(this.visibleNavMediaItems/2)){this.activeNavId=this.navMedia.length-Math.round(this.visibleNavMediaItems/2);}else{if(id<Math.floor(this.visibleNavMediaItems/2)){this.activeNavId=Math.floor(this.visibleNavMediaItems/2);}}var scrollAmount=-id*this.navMediaItemWidth+this.navMediaWrapWidth/2-this.navMediaItemWidth/2,navMediaWrapSize=this.navMediaWrap.getSize().x,min=-((navMediaWrapSize===0?this.getNavMediaWrapSize():navMediaWrapSize)-this.navMediaWrapWidth);scrollAmount=this.setRange(scrollAmount,min,0);this.navPrev.removeClass("inactive");this.navNext.removeClass("inactive");if(setActive){$$(this.navMedia).removeClass("active");this.navMedia[id].addClass("active");}if(this.visibleNavMediaItems>=this.max+1){this.navPrev.addClass("inactive");
this.navNext.addClass("inactive");}else{if(scrollAmount===0){this.navPrev.addClass("inactive");}else{if(scrollAmount===min){this.navNext.addClass("inactive");}}this.navMediaWrap.tween("left",scrollAmount);}},initializeLightBox:function(){this.lightBox=new Element("div",{html:'<div class="wrap"><div class="close"></div><div class="info"></div><span class="prev"></span><span class="next"></span><ul class="media"></ul></div>',id:"mediaPlayerLightBox",styles:{height:$(window).getScrollSize().y}});if(!this.options.isLayer){this.hash=window.location.hash.substring(1);window.onhashchange=function(event){if(window.location.hash.substring(1)===this.hash){this.closeMediaPlayerLightBox();}}.bind(this);}this.lightBox.addEvent("click",function(event){if(event.target.hasClass("close")||event.target===this.lightBox){this.closeMediaPlayerLightBox();
}else{if(event.target.hasClass("bookingButton")){if(window.basket&&window.basket.submit){event.target=$$(".bookingButton")[0];window.basket.submit(event,"$1initBooking=true&");}}}}.bind(this));this.lightBoxContent=this.lightBox.getElement(".media");this.lightBox.inject($(document.body));},closeMediaPlayerLightBox:function(){this.lightBox.addClass("hide");this.lightBoxContent.innerHTML="";this.lightBoxInfo.innerHTML="";this.lightBox.removeClass("images");},getPrice:function(isVideo){var price=$("bookingField")?$$("#bookingField .price")[0]:$$("#detailsHead .price")[0],button=$("bookingField")?$$("#bookingField .bookingButton")[0]:$$("#detailsHead .bookingButton")[0];this.lightBoxInfo=this.lightBox.getElement(".info");if(button){$(button).clone().inject(this.lightBoxInfo);}var infoBox=new Element("div",{"class":"priceWrapMedia"}).inject(this.lightBoxInfo);
if(price){$(price).clone().inject(infoBox).removeClass("right");}infoBox.getElement("div.bookingButton")?infoBox.getElement("div.bookingButton").destroy():"";this.lightBoxInfo.getElement(".priceWrapMedia").dispose().inject(this.lightBoxInfo);this.lightBoxInfo.getElement(".hrsGuarantee")?this.lightBoxInfo.getElement(".hrsGuarantee").destroy():"";this.lightBoxInfo.getElement(".hrsGuaranteeList")?this.lightBoxInfo.getElement(".hrsGuaranteeList").destroy():"";this.lightBoxInfo.getElement(".insertTravelData")?this.lightBoxInfo.getElement(".insertTravelData").destroy():"";if(this.lightBoxInfo.getElement("[data-bookingButtonTrackId]")){var el=this.lightBoxInfo.getElement("[data-bookingButtonTrackId]");var layerIds=JSON.decode(el.getAttribute("data-trackingIdsForLayers"));var trackingId=isVideo?layerIds["videoLayer"]:layerIds["photoLayer"];
el.setAttribute("data-bookingButtonTrackId",trackingId);}},openLightBox:function(id){var item=this.mediaObjects[id];if(!this.lightBox){this.initializeLightBox();}else{this.lightBox.removeClass("hide");}window.location.hash="#mediaPlayerLightBox";var isVideo=item.type==="videos";this.getPrice(isVideo);this.lightBox.getElement(".close").title=isVideo?this.options.properties.closeVideo:this.options.properties.closeFullscreen;if(isVideo){this.lightBoxContent.innerHTML='<li><span class="title video">'+item.title+'</span><div id="mediacenterVideo"></div></li>';if(item.extern){var iframe=new Element("iframe",{"src":item.url,"border":0,"frameborder":0,"id":"externVideoIframe","styles":{"width":624,"height":422}});iframe.inject($("mediacenterVideo"),"inside");}else{flashVars.filmId=item.id;flashVars.hotelId=this.options.hotelId;
embedPlayer();}}else{var hdId=this.hdImages.indexOf(item);this.lightBox.addClass("images");var lis=[];this.hdImages.each(function(image,index){if(image.title=="Info"){var li=new Element("li",{html:'<img src="'+image.hd+'"/>',"class":(hdId==index?"":"hide"),id:"hdImage"+image.index});}else{var li=new Element("li",{html:'<span class="opEl">&nbsp;</span><span class="title">'+image.title+'</span><img src="'+image.hd+'"/>',"class":(hdId==index?"":"hide"),id:"hdImage"+image.index});}li.inject(this.lightBoxContent);lis.push(li);},this);var prev=this.lightBox.getElement(".prev"),next=this.lightBox.getElement(".next");prev.removeClass("hide");next.removeClass("hide");if(hdId===0){prev.addClass("hide");}else{if(hdId===this.hdImages.length-1){next.addClass("hide");}}prev.addEvent("click",function(event){lis.each(function(innerItem,innerIndex){innerItem.addClass("hide");
},this);hdId-=1;prev.removeClass("hide");next.removeClass("hide");if(hdId===0){prev.addClass("hide");}else{if(hdId===this.hdImages.length-1){next.addClass("hide");}}lis[hdId].removeClass("hide");}.bind(this));next.addEvent("click",function(event){lis.each(function(innerItem,innerIndex){innerItem.addClass("hide");},this);hdId+=1;prev.removeClass("hide");next.removeClass("hide");if(hdId===0){prev.addClass("hide");}else{if(hdId===this.hdImages.length-1){next.addClass("hide");}}lis[hdId].removeClass("hide");var tempId=lis[hdId].id.replace("hdImage","");this.showMedia(this.media.indexOf($("mediaItem"+tempId)));}.bind(this));}}});var hdSinglePageBasket=new Class({Extends:Basket,initialize:function(basketElement,options){this.parent(basketElement,options);$$(".bookingButton").addEvent("click",this.handleBookingBtnClick.bind(this));
$("submitAltCurr").addEvent("change",function(event){event.stop();this.isChangeEvent=true;(function(){$$("a[href=#priceAnchor]")[0].click();}).delay(200);BasketAjaxHandler.changeAltCurrency(this.detailsEntry,$("submitAltCurr").value,function(data){Object.each(data,function(item,index){var priceToManipulate=$$("#stickyBar .price");this.update(item);if($$("#stickyBar .basketTotalAltPrice.hide").length){priceToManipulate.removeClass("multiple");}else{priceToManipulate.addClass("multiple");}},this);var oldCur=window.alternativeCurrency;var newCur=$("submitAltCurr").value;window.alternativeCurrency=newCur;s_trackLink("ChangeCurrency;price;"+oldCur+"->"+newCur);}.bind(this));}.bind(this));},handleBookingBtnClick:function handleBookingBtnClick(event){function submitCallback(data){if(!data.success){return;
}var GTM=window.HRS_PUW.GTM;var bookNowHandler=new GTM.EventHandler.BookNowHandler();bookNowHandler.track();}if(window.HotelDetailsLayer){window.location.hash="hotelId"+window.HotelDetailsLayer.hotelId;}window.initBookingProcess=true;this.submit(event,"$1initBooking=true&",submitCallback);},jumpToAnchor:function(){var top=$$(".altErrorLayer")[0].getCoordinates().top;window.scroll(0,top-(window.innerHeight?window.innerHeight:document.documentElement.clientHeight)/2);},setTotalPrice:function(data){var newBasket=$$(".newOfferBasket").length>0?true:false;var strongPrice=this.formatNicePrice(data.basketTotalPrice.price);$$(".basketTotalPrice").set("html",strongPrice);if(data.basketTotalPrice.altPrice){$$(".basketTotalAltPrice").removeClass("hide");}else{$$(".basketTotalAltPrice").addClass("hide");
}$$(".basketTotalAltPrice").set("html",this.formatNicePrice(data.basketTotalPrice.altPrice));if(data.mealInfo){$$(".totalPrice").each(function(item){var i,pos,html,len,elements,parentItem=item.parentNode;elements=$(parentItem).getElements("> span");len=elements.length;for(i=0;i<len;i++){elements[i].destroy();}var div=new Element("div");div.innerHTML=data.mealInfo;div.getChildren().inject(parentItem,"bottom");if(!newBasket){return;}elements=$(parentItem).getElements("> span");len=elements.length;for(i=0;i<len;i++){html=elements[i].innerHTML;pos=html.indexOf("(");if(pos<0){continue;}html=html.substr(0,pos);elements[i].innerHTML=html;}});}if(data.singlePageBookingConditions){var ul=new Element("ul",{"class":"hrsGuaranteeList"});data.singlePageBookingConditions.each(function(item){new Element("li",{html:item}).inject(ul);
});$$(".hrsGuaranteeList").each(function(item){var clone=ul.clone();clone.replaces(item);});}},sendForm:function(event,parameter){this.isValid=true;var form=event.target.form||event.target.getParent("form");form.action=form.action.replace(/(\?clientId=.*&)/g,parameter);var hotelPosition=form.querySelector('input[name="position"]');var input=new Element("input",{type:"hidden",name:"initBooking",value:"true"});if(hotelPosition){hotelPosition.value=window.HRS_PUW.GTM.currentHotelPosition;}input.inject(form);form.submit();},formatNicePrice:function(price){var index,lastPart,currency,firstPart,curr={"eur":"€","usd":"$","gbp":"£"};if(price.indexOf("<sup>")>=0){return price;}price=price.replace(/[\(\)]+/g,"");index=price.lastIndexOf(" ");if(index==-1){return price;}currency=price.substr(index+1);price=price.substr(0,index);
index=price.lastIndexOf(",");if(index<price.lastIndexOf(".")){index=price.lastIndexOf(".");}if(index==-1){return price+" "+currency;}firstPart=price.substr(0,index);lastPart=price.substr(index+1);if(curr[currency.toLowerCase()]!=undefined){currency=curr[currency.toLowerCase()];}return firstPart+"<sup>"+lastPart+" </sup>"+currency;}});var SubmitFormLayer=new Class({Implements:[Events,Options],options:{eventType:"change",requestParam:"&",onSuccessCallback:function(){}},initialize:function(eventElement,containerToUpdate,form,options,isNotRating){this.setOptions(options);this.form=form;if(eventElement){if(typeOf(eventElement)==="elements"){Array.from(eventElement).each(function(item){item.addEvent(this.options.eventType,function(event){if(this.options.dynamicActiveAction){this.options.activeActionValue=(this.options.activeActionValuePrefix?this.options.activeActionValuePrefix:"")+item.name;
if(item.name==="changePageNumber.number"){this.options.activeActionValue+="_"+item.value;}}this.sendForm(event);}.bind(this));},this);}else{eventElement.addEvent(this.options.eventType,function(event){this.sendForm(event);}.bind(this));}}if(this.form){this.formUrl=this.form.action.replace(/(#.*)/,"")+this.options.requestParam;this.request=new Request.HTML({url:this.formUrl,data:this.form,onSuccess:function(responseTree,responseElements,responseHTML,responseJavaScript){for(var k=0;k<responseElements.length;k++){if((" "+responseElements[k].className+" ").indexOf(" basketWrap ")>-1||(" "+responseElements[k].className+" ").indexOf(" ratingsWrap ")>-1){containerToUpdate.innerHTML=responseElements[k].innerHTML;k=responseElements.length;}}this.fireEvent("successCallback");if($("setGroup")&&!isNotRating){var scrollH=$("ratingAnchor").getCoordinates().top;
window.scrollTo(0,scrollH);}}.bind(this),onRequest:function(){}.bind(this),onFailure:function(){}.bind(this)});}},sendForm:function(event){var activeAction=$("activeAction");if(!activeAction){this.activeAction=new Element("input",{type:"hidden",name:"activeAction",id:"activeAction",value:this.options.activeActionValue}).inject(this.form);}else{activeAction.value=this.options.activeActionValue;}if(event&&event.target&&event.type==="click"&&event.target.match("[type=submit]")){event.preventDefault();this.request.send({url:this.form.action.replace(/(#.*)/,"")+this.options.requestParam+"&"+event.target.name+"="+event.target.value});}else{this.request.send();}}});var StyleSelectBoxSinglePage=new Class({Extends:StyleSelectBox,initialize:function(el,elForm,groupEl,options){this.parent(el,elForm,groupEl,options);
this.form=elForm;this.formSubmit=new SubmitFormLayer(false,this.options.containerToUpdate,this.form,{requestParam:"",activeActionValue:this.options.activeActionValue,onSuccessCallback:function(){this.fireEvent("successCallback");}.bind(this),eventType:"click"});},sendForm:function(e,index){var event=e;event.preventDefault();this.el.selectedIndex=index;if(this.options.isGroup){this.groupEl.getElements("select").each(function(selectEl,index){if(selectEl!=this.el){selectEl.selectedIndex=0;}}.bind(this));}var targetID=this.el.id,inputId=targetID+".x";if(targetID=="changeHotelRating"){form.action+="#hRanking";}if(targetID=="submitChangeDimension"){form.action+="#h_distance";}this.form.appendChild(new Element("input",{type:"hidden",name:inputId,id:inputId,value:"submit"}));this.formSubmit.sendForm();
}});var ToogleGroupInContainer=new Class({Implements:[Events,Options],options:{},initialize:function(elements,options){Array.from(elements).each(function(toggleGroup){});},createToggle:function(element,textFull,textShort){var toggle=new Fx.Tween(item,{property:"height",onStart:function(){if(!toggle.isCut){item.set("html",fragment);toggleLink.inject(item).set("text",this.options.linkText[0]).removeClass("cutFull");}}.bind(this),onComplete:function(){if(toggle.isCut){item.set("html",cleanTxt);toggleLink.inject(item).set("text",this.options.linkText[1]).addClass("cutFull");}toggle.isCut=!toggle.isCut;}.bind(this)});element.store("Toggler",toggle);},showHide:function(toggleElement,fullTextSize,cutTextSize){toggleElement.start(toggleElement.isCut?fullTextSize:cutTextSize);}});var ToggleRatingComments=new Class({initialize:function(togglers){this.ratingObjects=[];
togglers.each(function(item,index){var comments=$("jsRatings").getElements("div.comments")[index],fullTexts=comments.getElements(".fullText"),toggleTexts=[];fullTexts.each(function(fullText){var obj={},shortText=fullText.getPrevious(".shortText");obj["full"]=fullText;obj["short"]=shortText;obj["openedHeight"]=fullText.measure(function(){return this.getSize().y;});obj["closedHeight"]=shortText.measure(function(){return this.getSize().y;});obj["full"]._fx=new Fx.Tween(obj["full"],{transition:"linear",duration:"short",property:"height",onStart:function(){}.bind(this),onComplete:function(){if(!this.openingComments){this.toggleDisplay(obj);}else{fullText.setStyle("height","auto");}}.bind(this)});fullText.addClass("hide");fullText.removeClass("nirwanaFullHeight");toggleTexts.push(obj);}.bind(this));
var ratingObject={"toggler":item,"toggleContainers":toggleTexts};this.ratingObjects.push(ratingObject);}.bind(this));this.ratingObjectsLength=this.ratingObjects.length;},openComments:function(obj){this.openingComments=true;this.tweenComments(obj);},closeComments:function(obj){this.openingComments=false;this.tweenComments(obj);},tweenComments:function(obj){var currObj,tempObj,i,len,toggleHeight=this.openingComments?"openedHeight":"closedHeight";for(i=0;i<this.ratingObjectsLength;i++){tempObj=this.ratingObjects[i];if(tempObj.toggler===obj){currObj=tempObj;break;}}len=currObj.toggleContainers.length;for(i=0;i<len;i++){tempObj=currObj.toggleContainers[i];if(this.openingComments){this.toggleDisplay(tempObj);}tempObj["full"]._fx.start(tempObj[toggleHeight]);}},toggleDisplay:function(obj){obj["short"].toggleClass("hide");
obj["full"].toggleClass("hide");}});var InteractionManager=new Class({Implements:Events,initialize:function(){this.observees=[];},observe:function(obj){var observee={"observee":obj.observee,"eventType":obj.eventType,"eventCallback":obj.eventCallback,"callbackObject":obj.callbackObject,"callbackMethod":obj.callbackMethod};observee.observee.addEvent(observee.eventType,this.executeAction.bind(this));this.observees.push(observee);},executeAction:function(evt){this.observees.each(function(item){if(item.eventType===evt.eventType){if(item.callbackObject&&item.callbackMethod){item.callbackObject[item.callbackMethod](evt.eventData);}else{if(!item.callbackObject&&item.callbackMethod){window[item.callbackMethod](evt.eventData);}}return;}}.bind(this));}});var ParallaxStandalone=new Class({Implements:[Events,Options],options:{subMenuTrackingIds:{"#top":{},"#priceAnchor":{"#top":"BP","#priceAnchor":"BQ","#mapHdAnchor":"BS","#ratingAnchor":"BR","#infoAnchor":"BT"},"#mapHdAnchor":{"#top":"DP","#priceAnchor":"DQ","#mapHdAnchor":"DS","#ratingAnchor":"DR","#infoAnchor":"DT"},"#ratingAnchor":{"#top":"CP","#priceAnchor":"CQ","#mapHdAnchor":"CS","#ratingAnchor":"CR","#infoAnchor":"CT"},"#infoAnchor":{"#top":"EP","#priceAnchor":"EQ","#mapHdAnchor":"ES","#ratingAnchor":"ER","#infoAnchor":"ET"}},bookingButtonTrackingIds:{"#top":"AG","#priceAnchor":"BD","#mapHdAnchor":"DG","#ratingAnchor":"CD","#infoAnchor":"ED"}},initialize:function(options){this.wrap=$("wrap");
this.setOptions(options);if($("detailsHead").hasClass("smallGallery")){var smallHeaderSize=this.wrap.getElement("h2").getSize().y+(this.wrap.getElement(".titleWrap").getSize().y-$("mediaPlayer").getSize().y),smallHeaderFullSize=$("detailsHead").getSize().y+parseInt(this.wrap.getElements(".detailsNav")[1].getStyle("margin-top"),10);this.smallHeaderFullSize=smallHeaderFullSize;}var header=$("detailsHead"),menu=$("hotelDetailsPriceNav"),priceCoordinates=$("detailsHead").hasClass("smallGallery")?$("mediaPlayer").getElement(".nav").getCoordinates():$$(".summary .hrsGuarantee")[0].getCoordinates(),navCoordinates=$("detailsHead").hasClass("smallGallery")?$("mediaPlayer").getElement(".nav").getCoordinates():this.wrap.getElements(".detailsNav")[1].getCoordinates(),headerSize=$("detailsHead").hasClass("smallGallery")?smallHeaderSize:header.getSize().y,threshold=(Browser.ie8?-20:0)+(priceCoordinates.top-70)+navCoordinates.height+18+($("detailsHead").hasClass("smallGallery")?($$(".hrsFreeServices.details")[0]?$$(".hrsFreeServices.details")[0].getSize().y:0)-headerSize+50+(Browser.ie8?20:0):0);
if(!$("detailsHead").hasClass("smallGallery")){threshold=headerSize+$$(".detailsMedia")[0].getSize().y+$$(".summary")[0].getSize().y-50;}menu.setStyle("display","none");this.menu=menu;this.header=header;var navChildren=$$("ul.detailsNav").getChildren("li a.anchor"),scrollList={};for(i=0;i<navChildren[0].length;i++){scrollList[i]={};scrollList[i].coord=$$(navChildren[0][i].hash).getParent("div").getCoordinates();scrollList[i].coord[0].top-=(Browser.ie8?220:200);if(navChildren[0][i].hash==="#top"){scrollList[i].coord[0].height=$$(".detailsNav")[1].getCoordinates().top;}}$$(".detailsNav")[0].getElement("li").removeClass("topArrow");var scroll=$(window).getScroll();if(scroll.y>500){if(!this.isParallaxShown){this.showParallax(scroll.y);this.isParallaxShown=true;}}$(window).addEvent("scroll",function(event){var lastPosition=this.wrap.getSize().y-500,scroll=$(window).getScroll().y;
if(scroll>threshold){if(!this.isParallaxShown){this.isParallaxShown=true;this.showParallax(scroll-65,headerSize);}}else{if(this.isParallaxShown){this.hideParallax();this.isParallaxShown=false;}}if(scroll>=lastPosition){$$(this.close,header).setStyles({"top":lastPosition,"position":"absolute"});}else{if(Browser.isMobile){if(!$("detailsHead").hasClass("smallGallery")){$$(this.close,header).setStyles({"top":scroll,"position":"absolute"});}}else{if(!$("detailsHead").hasClass("smallGallery")){$$(this.close,header).setStyles({"top":0,"position":"fixed"});}}}for(var i=0;i<navChildren[0].length;i++){if(scroll>scrollList[i].coord[0].top&&scroll<(scrollList[i].coord[0].top+scrollList[i].coord[0].height)){if(!navChildren[0][i].getParent("li").hasClass("active")){navChildren[0].each(function(item){item.getParent("li").removeClass("active");
});var activeNavEl=navChildren[0][i];activeNavEl.getParent("li").addClass("active");this.updateSubmenuAndBookingButtonTrackingIds(activeNavEl.getAttribute("href"),navChildren[0]);}}}}.bind(this));},updateSubmenuAndBookingButtonTrackingIds:function(activeNavKey,navElList){var activeList=this.options.subMenuTrackingIds[activeNavKey];if(activeList){navElList.each(function(el,i){var key=el.getAttribute("href");if(key){var val=activeList[key];if(val){el.setAttribute("data-deferredTrackingId",activeList[key]);}}});if($("bookingButtonHeader")){$("bookingButtonHeader").setAttribute("data-bookingButtonTrackId",this.options.bookingButtonTrackingIds[activeNavKey]);}}},showParallax:function(scroll,headerSize){this.menu.setStyle("display","block");$("detailsHead").addClass("setFixed");$("hotelDetailsHD").addClass("setReponsive");
$$(".hideOnScroll").addClass("hide");$$(".showOnScroll").removeClass("hide");if($("detailsHead").hasClass("smallGallery")){this.wrap.getElements(".detailsNav")[1].setStyles({"margin-top":this.smallHeaderFullSize+"px"});if(Browser.isMobile){this.header.setStyles({"top":scroll,"position":"absolute"});}else{this.header.setStyles({"top":0,"position":"fixed"});}}else{$("hotelDetailsHD").setStyle("margin-top",headerSize);}if(this.options.isLandingPage){if(Browser.isMobile){this.header.setStyles({"top":scroll,"position":"absolute"});}else{this.header.setStyles({"top":0,"position":"fixed"});}}},hideParallax:function(){this.menu.setStyle("display","none");$("detailsHead").removeClass("setFixed");$("hotelDetailsHD").removeClass("setReponsive");$$(".hideOnScroll").removeClass("hide");$$(".showOnScroll").addClass("hide");
if($("detailsHead").hasClass("smallGallery")){this.header.setStyles({"top":"auto","position":"static"});this.wrap.getElements(".detailsNav")[1].setStyle("margin-top","auto");}if(this.options.isLandingPage){this.header.setStyles({"top":"auto","position":"static"});}$("hotelDetailsHD").setStyle("margin-top",0);}});var HotelDetailsContentReload=new Class({Implements:[Events,Options],initialize:function(items,options){Object.each(items,function(item){item.elements.each(function(element){element.addEvent(item.event,function(event){event.stop();console.log(11111,event);}.bind(this));}.bind(this));}.bind(this));}});var stickyBar={init:function(){this.detectCollision();},detectCollision:function(){var stickyBar=$("stickyBar"),lastDetailsNav=$$(".detailsNav").getLast(),doElsCollide=function(el1,el2){var scrollTop=(window.pageYOffset||document.documentElement.scrollTop)-(document.documentElement.clientTop||0),offsetTopOfSecondElement=el2.offsetTop;
return scrollTop+el1.offsetHeight>=offsetTopOfSecondElement;};if(stickyBar!=="undefined"&&stickyBar!==null){window.addEvent("scroll",function(){if(this.getScroll().y>155){if(stickyBar.style.display=="none"){stickyBar.style.display="block";}}if(this.getScroll().y<155||doElsCollide(stickyBar,lastDetailsNav)){stickyBar.style.display="none";}});}}};function SearchWidgetHD(options){var self=null;var obj={options:{showSearchResult:"",fromList:false},interval:null,element:{doubleRoom:null,singleRoom:null,ageChildrenForm:null,totalAdults:null},childrenAgeFormHandling:function(childrenNrInput){var childrenNr=childrenNrInput.value;if(isNaN(childrenNr)){self.element.ageChildrenForm.style.display="none";childrenNrInput.value=0;return;}self.element.ageChildrenForm.style.display="block";var childrenAges=self.element.ageChildrenForm.getElementsByClassName("columnAge");
if(childrenNr>childrenAges.length){childrenNr=childrenAges.length;childrenNrInput.value=childrenNr;}for(var i=0;i<childrenAges.length;i++){if(i<childrenNr){childrenAges[i].style.display="block";}else{childrenAges[i].style.display="none";}}},updateTotalAdultsNrHD:function(){var doubleRoomNrHD=self.element.doubleRoom.value;var singleRoomNrHD=self.element.singleRoom.value;self.element.totalAdults.value=2*parseInt(doubleRoomNrHD>0?doubleRoomNrHD:0)+parseInt(singleRoomNrHD>0?singleRoomNrHD:0);},moveFocusToInputCalendar:function(thisEl){thisEl.getPrevious().focus();},initElements:function(){self.element.doubleRoom=document.getElementById("doubleRoomNrHD");self.element.singleRoom=document.getElementById("singleRoomNrHD");self.element.ageChildrenForm=document.getElementById("ageChildrenForm");self.element.totalAdults=document.getElementById("totalAdultsNrHD");
setTimeout(function(){self.childrenAgeFormHandling(document.getElementById("HDSearchBoxChildren"));},100);$$(".searchBoxHD")[0].style.display="block";$$(".nonCalendar").addEvents({click:closeCal,focus:closeCal});$$(".searchBoxHD #start_stayPeriod").addEvent("focus",function(e){ankerEl.endEl=$$(".searchBoxHD #end_stayPeriod")[0];});},rewriteSearchFormData:function(){$("searchForm").getElement("#start_stayPeriod").value=$$(".searchBoxHD #start_stayPeriod")[0].value;$("searchForm").getElement("#end_stayPeriod").value=$$(".searchBoxHD #end_stayPeriod")[0].value;$("searchForm").getElement("#doubleRooms").value=$$(".searchBoxHD #doubleRoomNrHD")[0].value;$("searchForm").getElement("#singleRooms").value=$$(".searchBoxHD #singleRoomNrHD")[0].value;$("searchForm").getElement("#adults").value=$$(".searchBoxHD #totalAdultsNrHD")[0].value;
var childValue=Number($$(".searchBoxHD #HDSearchBoxChildren")[0].value);var select=$("searchForm").getElement("#children");self.setSelectValue(select,childValue);var divs=$$("#childrenWrap div");var sourceDivs=$$("#ageChildrenForm div.columnAge");for(var i=0;i<divs.length;i++){var selectAge=$(divs[i]).getElement("#age_"+i);var selectAccomodation=$(divs[i]).getElement("#acc_"+i);var sourceSelectAge=$(sourceDivs[i]).getElement(".childAge select");var sourceSelectAccomodation=$(sourceDivs[i]).getElement(".childAcc select");self.setSelectValue(selectAge,Number(sourceSelectAge.value));self.setSelectValue(selectAccomodation,Number(sourceSelectAccomodation.value));}},setSelectValue:function(selectElement,value){var options=$(selectElement).getElements("option");for(var i=0;i<options.length;i++){if(Number(options[i].value)==value){options[i].setAttribute("selected","selected");
}else{options[i].removeAttribute("selected");}}},initErrors:function(){var containers=$$("#ageChildrenForm .columnAge");for(var i=0;i<containers.length;i++){var errors=$(containers[i]).getElements("span.error");if(errors.length<=0){continue;}$(containers[i]).grab(new Element("label",{"class":"errors"}));var errorsContainer=$(containers[i]).getElement("label.errors");for(var j=0;j<errors.length;j++){errorsContainer.grab(errors[j]);}}},initNotAvailable:function(){$("bookingField").removeClass("jsHideBookingEl");$$(".priceWrap")[0].style.display="none";$$(".priceWrapNoHotels")[0].style.display="block";},initErrorLink:function(){$$(".errorWrap a.input").addEvent("click",function(e){e.preventDefault();self.rewriteSearchFormData();$("searchForm").submit();});},initInterval:function(){if($$(".searchBoxHD").length<=0){return;
}clearInterval(self.interval);self.initElements();self.initErrors();if(self.options.showSearchResult=="notAvailable"){self.initNotAvailable();}if(self.options.fromList){self.initErrorLink();}return false;},init:function(options){self=this;self.options=options;self.interval=setInterval(self.initInterval,50);}};obj.init(options);return obj;}