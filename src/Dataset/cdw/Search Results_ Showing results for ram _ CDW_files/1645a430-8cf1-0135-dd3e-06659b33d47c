(function(win){var hostname_as_int=parseInt((location.hostname||"local").substring(0,10),36);var fn_name="sifi_att_"+hostname_as_int;if(typeof win[fn_name]!="undefined"){win[fn_name].run();return}class SifiCmpCompliance{constructor(tcData){this.tcData=tcData;this.sifiVendorId="73"}checkConsent(){return this.outOfBandConsent()||this.inBandConsent()}inBandConsent(){return this.purpose()&&this.vendor()&&this.customPurpose()&&this.noRestrictions()}outOfBandConsent(){return this.tcData.outOfBand&&(this.tcData.outOfBand.allowedVendors&&this.tcData.outOfBand.allowedVendors[this.sifiVendorId]&&this.tcData.outOfBand.disclosedVendors&&this.tcData.outOfBand.disclosedVendors[this.sifiVendorId])}purpose(){return this.tcData.purpose&&(this.tcData.purpose.consents&&!Object.values(this.tcData.purpose.consents).includes(false)&&this.tcData.purpose.legitimateInterests&&!Object.values(this.tcData.purpose.legitimateInterests).includes(false))}vendor(){return this.tcData.vendor&&(this.tcData.vendor.consents&&this.tcData.vendor.consents[this.sifiVendorId])}customPurpose(){return this.tcData.customPurpose&&(this.tcData.customPurpose.consents&&!Object.values(this.tcData.customPurpose.consents).includes(false)&&this.tcData.customPurpose.legitimateInterests&&!Object.values(this.tcData.customPurpose.legitimateInterests).includes(false))||!this.tcData.customPurpose}noRestrictions(){return this.tcData.restrictions&&!Object.values(this.tcData.restrictions).some(restriction=>Object.keys(restriction).includes(this.sifiVendorId))||!this.tcData.restrictions}}var dpx={pixels_url:"//i.simpli.fi/p?",pixels:[],matching_pixels:[],protocol:"https:",pixels_to_drop:[],dropping_pixels:false,rescue_pixel:null,company_id:"",run:function(){if(dpx._cmpPresent()){dpx._dropPixelsOnCmpConfirmation()}else{dpx.drop_pixels()}},drop_pixels:function(){var sifi_pixels=[];if(!dpx.already_dropped_matching&&!dpx.url_contains_email_address()){dpx.get_matching_pixels()}else{dpx._drop_matching_pixels()}},get_matching_pixels:function(){var script=document.createElement("script");script.src=dpx.protocol+dpx.pixels_url+"cid="+dpx.company_id+"&cb="+fn_name+"._hp";document.body.appendChild(script)},_cmpPresent:function(){return typeof __tcfapi!=="undefined"&&"function"===typeof __tcfapi},_dropPixelsOnCmpConfirmation:function(consentSuccess){__tcfapi("addEventListener",2,dpx._tcDataCallback)},_tcDataCallback:function(tcData,success){if(success&&tcData.eventStatus==="tcloaded"){if(dpx._checkCmpConsent(tcData)){dpx.drop_pixels()}__tcfapi("removeEventListener",2,success=>{},tcData.listenerId)}},_checkCmpConsent:function(tcData){let cmpChecker=new SifiCmpCompliance(tcData);return cmpChecker.checkConsent()},_hp:function(pixels){dpx.matching_pixels=pixels&&pixels["pixels"]||[];dpx._drop_matching_pixels()},_drop_matching_pixels:function(){if(!dpx.already_dropped_matching){for(var i=dpx.matching_pixels.length-1;i>=0;i--){dpx.pixels_to_drop.push(dpx.matching_pixels[i])}dpx.already_dropped_matching=true}dpx._next_pixel()},_next_pixel:function(){if(dpx.pixels_to_drop.length===0)return;var src=dpx.pixels_to_drop.shift(),img=new Image;img.onload=img.onerror=function(){dpx.rescue_pixel=null;dpx._next_pixel()};img.src=dpx.protocol+src;dpx.rescue_pixel=setTimeout(function(){img.onload=img.onerror=null;dpx._next_pixel()},1e3)},url_contains_email_address:function(){var re=/(([^<>()[\]\\.,;:\s@\"]+(\.[^<>()[\]\\.,;:\s@\"]+)*)|(\".+\"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))/;return re.test(dpx.unescaped_url())},unescaped_url:function(){var url=document.location.href;var escaped_url=decodeURIComponent(url);while(url!==escaped_url){url=escaped_url;escaped_url=decodeURIComponent(url)}return url}};win[fn_name]=dpx;if(!document.body){if(window.addEventListener){window.addEventListener("load",dpx.run,false)}else if(window.attachEvent){window.attachEvent("onload",dpx.run)}}else{dpx.run()}})(window);
